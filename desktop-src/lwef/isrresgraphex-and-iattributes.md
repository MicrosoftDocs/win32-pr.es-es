---
title: ISRResGraphEx y IAttributes
description: ISRResGraphEx y IAttributes
ms.assetid: 6eb37da1-5252-4c41-891c-c19cca6fb7d1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 659d7d4723bfc5145fb8abcc77043031a0e48e8b
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/19/2020
ms.locfileid: "104077580"
---
# <a name="isrresgraphex-and-iattributes"></a><span data-ttu-id="958d5-103">ISRResGraphEx y IAttributes</span><span class="sxs-lookup"><span data-stu-id="958d5-103">ISRResGraphEx and IAttributes</span></span>

<span data-ttu-id="958d5-104">\[Microsoft Agent está en desuso a partir de Windows 7 y puede que no esté disponible en versiones posteriores de Windows.\]</span><span class="sxs-lookup"><span data-stu-id="958d5-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="958d5-105">Los objetos de resultados devueltos por el motor deben admitir la interfaz ISRResGraphEx y la interfaz IAttributes.</span><span class="sxs-lookup"><span data-stu-id="958d5-105">The results objects returned by the engine must support the ISRResGraphEx interface and the IAttributes interface.</span></span> <span data-ttu-id="958d5-106">La simple compatibilidad con la interfaz ISRResGraphEx es suficiente para permitir que el editor de sonido proporcione información de separación de palabras, pero no proporciona la compatibilidad necesaria con la información de fonema.</span><span class="sxs-lookup"><span data-stu-id="958d5-106">Merely supporting the ISRResGraphEx interface is enough to enable the sound editor to provide word break information, but does not provide the necessary support for phoneme information.</span></span>

<span data-ttu-id="958d5-107">El editor de sonidos requiere que los motores también admitan un atributo DWord especial, **SRATTR \_ PHONESEG**.</span><span class="sxs-lookup"><span data-stu-id="958d5-107">The sound editor requires that engines also support a special DWord attribute, **SRATTR\_PHONESEG**.</span></span> <span data-ttu-id="958d5-108">El editor consulta los motores para ver la interfaz IAttributes e intenta establecer **SRATTR \_ PHONESEG** en 1.</span><span class="sxs-lookup"><span data-stu-id="958d5-108">The editor queries the engines to see IAttributes interface and attempts to set the **SRATTR\_PHONESEG** to 1.</span></span> <span data-ttu-id="958d5-109">Si la llamada se realiza correctamente, el editor de sonido supone que los resultados del motor admitirán la recopilación de información de segmentación de fonemas del objeto de resultados.</span><span class="sxs-lookup"><span data-stu-id="958d5-109">If that call succeeds, the sound editor assumes that the engine's results will support the gathering of phoneme-segmentation information from results object.</span></span>

`#define    SRATTR_PHONESEG    MAKELONG (1, SRVEN_MICROSOFT)`

<span data-ttu-id="958d5-110">Cuando un objeto de resultados se transmite al editor de sonido, consulta ese objeto para su implementación de ISRResGraphEx.</span><span class="sxs-lookup"><span data-stu-id="958d5-110">When a results object is transmitted to the sound editor, it queries that object for its implementation of ISRResGraphEx.</span></span> <span data-ttu-id="958d5-111">ISRResGraphEx contiene una función miembro, DataGet, con la signatura de tipo</span><span class="sxs-lookup"><span data-stu-id="958d5-111">ISRResGraphEx contains a member function, DataGet, with type signature</span></span>

`HRESULT  DataGet  (DWord, dwID, GUID gAttrib, SDATA *psData)`

<span data-ttu-id="958d5-112">Donde **dwID** es el identificador del objeto de gráfico, **GATTRIB** es un GUID que se corresponde con el atributo buscado y **psData** es un puntero a un objeto SDATA que contiene los datos devueltos.</span><span class="sxs-lookup"><span data-stu-id="958d5-112">Where **dwID** is the identifier of the graph object, **gAttrib** is a GUID corresponding to the attribute sought, and **psData** is a pointer to an SDATA object containing the data returned.</span></span> <span data-ttu-id="958d5-113">El motor es responsable de la asignación de los datos almacenados en **psData** a través de [**CoTaskMemAlloc**](/windows/desktop/api/combaseapi/nf-combaseapi-cotaskmemalloc).</span><span class="sxs-lookup"><span data-stu-id="958d5-113">The engine is responsible for allocating the data stored in **psData** through [**CoTaskMemAlloc**](/windows/desktop/api/combaseapi/nf-combaseapi-cotaskmemalloc).</span></span> <span data-ttu-id="958d5-114">La aplicación que realiza la llamada (en este caso, el editor de sonidos) es responsable de liberarla a través de [**CoTaskMemFree**](/windows/desktop/api/combaseapi/nf-combaseapi-cotaskmemfree) cuando ha finalizado.</span><span class="sxs-lookup"><span data-stu-id="958d5-114">The calling application (in this case the sound editor) is responsible for freeing it through [**CoTaskMemFree**](/windows/desktop/api/combaseapi/nf-combaseapi-cotaskmemfree) when it is finished.</span></span>

<span data-ttu-id="958d5-115">DataGet es necesario para reconocer tres GUID predefinidos, que se enumeran en la documentación de SAPI.</span><span class="sxs-lookup"><span data-stu-id="958d5-115">DataGet is required to recognize three predefined GUIDs, which are listed in the SAPI documentation.</span></span> <span data-ttu-id="958d5-116">Un motor que devuelve un código de operación correcta a la llamada a **DWORDSet (SRATTR \_ PHONESEG, 1)** también es necesario para reconocer un GUID específico, **SRGARC \_ PHONEMESEGMENTATION**, cuando se llama con un **dwID** que corresponde a un borde del gráfico.</span><span class="sxs-lookup"><span data-stu-id="958d5-116">An engine which returns a success code to the call to **DWORDSet(SRATTR\_PHONESEG, 1)** is also required to recognize a specific GUID, **SRGARC\_PHONEMESEGMENTATION**, when called with a **dwID** that corresponds to an edge in the graph.</span></span>

`DEFINE_GUID(SRGARC_PHONMESEGMENTATION, 0xd05405b0, 0x1db1, 0x11d2, 0x94, 0x2, 0x0, 0xc0, 0x4f, 0x8e, 0xf4, 0x8f);`

<span data-ttu-id="958d5-117">Cuando se devuelve la llamada, **psData** debe apuntar a una matriz de estructura alineada con DWORD de tipo **PHONESEG**, definida por:</span><span class="sxs-lookup"><span data-stu-id="958d5-117">When the call returns, **psData** should point to an array of DWORD-aligned structure of type **PHONESEG**, defined by:</span></span>

``` syntax
typedef struct tagSRPHONESEG {
   DWORD   dwSize;       // Size of the SRPHONESEG structure + phone data
   QWORD   qwStartTime;  // SAPI timestamp of the start of the seqment
   …QWORD   qwEndTime;    // SAPI timestamp of the end of the seqment
   int      nScore;      // The segment's score
   WCHAR   aPhones[0];   // Array of phone(s) making up the segment
} SRPHONESEG,  *PSRPHONESEG;
```

<span data-ttu-id="958d5-118">donde **qwStartTime** y **qwEndTime** apuntan al principio y al final de cada fonema que conforman la palabra incluida en el borde y **aPhones** es una matriz de caracteres Unicode correspondientes a la representación del IPA del teléfono, que se han producido en este segmento.</span><span class="sxs-lookup"><span data-stu-id="958d5-118">where **qwStartTime** and **qwEndTime** point to the beginning and end of each phoneme making up the word covered by the edge, and **aPhones** is an array of Unicode characters corresponding to the IPA representation of the phone, which were produced in this segment.</span></span> <span data-ttu-id="958d5-119">(En algunos idiomas, hay fonemas que están escritas con más de un fonema de IPA.</span><span class="sxs-lookup"><span data-stu-id="958d5-119">(In some languages, there are phonemes which are spelled with more than one IPA phoneme.</span></span> <span data-ttu-id="958d5-120">En inglés, por ejemplo, el sonido "Long I" de la palabra "Live" es realmente un diptongo, compuesto por dos fonemas más simples concatenados juntos). La matriz **aPhones** debe terminar en cero y rellenarse al final para que cada estructura **SRPHONESEG** de la matriz sea un múltiplo par de cuatro bytes de longitud.</span><span class="sxs-lookup"><span data-stu-id="958d5-120">In English, for instance, the "long I" sound in the word "live" is actually a diphthong, made up of two simpler phonemes concatenated together.) The **aPhones** array should be zero terminated and padded at the end to make each **SRPHONESEG** structure in the array an even multiple of four bytes long.</span></span>

<span data-ttu-id="958d5-121">Por ejemplo, supongamos que la palabra hablado en el arco 4 fue "hecha".</span><span class="sxs-lookup"><span data-stu-id="958d5-121">For example, suppose the word spoken on arc 4 was "made".</span></span> <span data-ttu-id="958d5-122">A continuación, la llamada a DataGet (4, **SRGARC \_ PHONEMESEGMENTATION**, &SD) puede devolver una matriz de tres segmentos de fonema,/m/que se ejecuta desde **qwStartTime**= 328434 bytes a **qwEndTime**= 330354 bytes,/1e/que se ejecuta desde **qwStartTime**= 330354 bytes hasta **qwEndTime**= 344114 bytes y/d/ejecutándose desde **qwStartTime**= 344114 bytes a **qwEndTime**= 347314 bytes.</span><span class="sxs-lookup"><span data-stu-id="958d5-122">Then the call to DataGet(4, **SRGARC\_PHONEMESEGMENTATION**, &sd) might return an array of three phoneme segments, /m/ running from **qwStartTime**=328434 bytes to **qwEndTime**=330354 bytes, /1e/ running from **qwStartTime**=330354 bytes to **qwEndTime**=344114 bytes, and /d/ running from **qwStartTime**=344114 bytes to **qwEndTime**=347314 bytes.</span></span> <span data-ttu-id="958d5-123">Estos se presentarían como una matriz empaquetada de tres estructuras **SRPHONESEG** de los tamaños 28, 32 y 28 bytes, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="958d5-123">These would be presented as a packed array of three **SRPHONESEG** structures of sizes 28, 32, and 28 bytes, respectively.</span></span> <span data-ttu-id="958d5-124">Observe que hay algún relleno al final de la estructura **SRPHONESEG** central, de modo que el siguiente elemento de la matriz se inicie en un límite de 4 bytes.</span><span class="sxs-lookup"><span data-stu-id="958d5-124">Notice that there is some padding at the end of the middle **SRPHONESEG** structure, so that the next item in the array starts at a 4-byte boundary.</span></span>

<span data-ttu-id="958d5-125">El SDK de SAPI 4,0 incluye una herramienta (SRFunc) para probar el cumplimiento con la especificación de SAPI 4,0. En esa herramienta se incluye una prueba para la compatibilidad con este conjunto de interfaces.</span><span class="sxs-lookup"><span data-stu-id="958d5-125">The SAPI 4.0 SDK includes a tool (SRFunc) for testing compliance with the SAPI 4.0 spec. Included in that tool is a test for compliance with this set of interfaces.</span></span> <span data-ttu-id="958d5-126">El código fuente de esa herramienta es un buen punto de partida para entender cómo interactúan estas interfaces con el editor de sonido y para depurar las interfaces durante el desarrollo.</span><span class="sxs-lookup"><span data-stu-id="958d5-126">The source code for that tool is a good place to start in order to understand how these interfaces will interact with the sound editor, and to debug the interfaces during development.</span></span>

 

 