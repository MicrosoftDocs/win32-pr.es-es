---
description: Proporcionar un Allocator-Presenter personalizado para VMR-7
ms.assetid: 19b43c9b-2578-418f-b03b-af7c7a3a46e4
title: Proporcionar un Allocator-Presenter personalizado para VMR-7
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1e79f191401f990214b2551f9210fab4dfe4d43b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "104571102"
---
# <a name="supplying-a-custom-allocator-presenter-for-vmr-7"></a><span data-ttu-id="9da44-103">Proporcionar un Allocator-Presenter personalizado para VMR-7</span><span class="sxs-lookup"><span data-stu-id="9da44-103">Supplying a Custom Allocator-Presenter for VMR-7</span></span>

<span data-ttu-id="9da44-104">Allocator-Presenter es responsable de asignar las superficies de DirectDraw y presentar los fotogramas de vídeo para su representación.</span><span class="sxs-lookup"><span data-stu-id="9da44-104">The allocator-presenter is responsible for allocating DirectDraw surfaces and presenting the video frames for rendering.</span></span> <span data-ttu-id="9da44-105">En la gran mayoría de los escenarios, la funcionalidad del asignador predeterminado será más que suficiente para las necesidades de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="9da44-105">In the vast majority of scenarios, the functionality of the default allocator-presenter will be more than sufficient for an application's needs.</span></span> <span data-ttu-id="9da44-106">Sin embargo, al conectar un asignador personalizado, una aplicación puede obtener acceso directo a los bits de vídeo y controlar completamente el proceso de representación.</span><span class="sxs-lookup"><span data-stu-id="9da44-106">But by plugging in a custom allocator-presenter, an application can obtain direct access to the video bits and completely control the rendering process.</span></span> <span data-ttu-id="9da44-107">La desventaja de este aumento de la eficacia es que la aplicación debe administrar la complejidad agregada de la administración de superficies de DirectDraw.</span><span class="sxs-lookup"><span data-stu-id="9da44-107">The trade-off for this increased power is that the application must handle the added complexity of DirectDraw surface management.</span></span>

![uso de un asignador personalizado: presentador](images/custom-ap.png)

<span data-ttu-id="9da44-109">En la ilustración anterior se muestran las interfaces de comunicación utilizadas por VMR y el presentador del asignador.</span><span class="sxs-lookup"><span data-stu-id="9da44-109">The preceding figure shows the communication interfaces used by the VMR and the allocator-presenter.</span></span> <span data-ttu-id="9da44-110">Un asignador personalizado que invalida toda la funcionalidad de asignación y presentación predeterminada debe implementar las interfaces [**IVMRImagePresenter**](/windows/desktop/api/Strmif/nn-strmif-ivmrimagepresenter) y [**IVMRSurfaceAllocator**](/windows/desktop/api/Strmif/nn-strmif-ivmrsurfaceallocator) y, opcionalmente, [**IVMRWindowlessControl**](/windows/desktop/api/Strmif/nn-strmif-ivmrwindowlesscontrol).</span><span class="sxs-lookup"><span data-stu-id="9da44-110">A custom allocator-presenter that overrides all of the default allocation and presentation functionality must implement the [**IVMRImagePresenter**](/windows/desktop/api/Strmif/nn-strmif-ivmrimagepresenter) and [**IVMRSurfaceAllocator**](/windows/desktop/api/Strmif/nn-strmif-ivmrsurfaceallocator) interfaces, and optionally, [**IVMRWindowlessControl**](/windows/desktop/api/Strmif/nn-strmif-ivmrwindowlesscontrol).</span></span>

<span data-ttu-id="9da44-111">Para reemplazar el valor predeterminado de allocator-Presenter, una aplicación llama al método [**IVMRSurfaceAllocatorNotify:: AdviseSurfaceAllocator**](/windows/desktop/api/Strmif/nf-strmif-ivmrsurfaceallocatornotify-advisesurfaceallocator) y pasa un puntero al nuevo asignador-presentador.</span><span class="sxs-lookup"><span data-stu-id="9da44-111">To replace the default allocator-presenter, an application calls the [**IVMRSurfaceAllocatorNotify::AdviseSurfaceAllocator**](/windows/desktop/api/Strmif/nf-strmif-ivmrsurfaceallocatornotify-advisesurfaceallocator) method and passes in a pointer to the new allocator-presenter.</span></span> <span data-ttu-id="9da44-112">En respuesta a esta llamada, VMR llamará al método [**IVMRSurfaceAllocator:: AdviseNotify**](/windows/desktop/api/Strmif/nf-strmif-ivmrsurfaceallocator-advisenotify) de allocator-Presenter para proporcionar el puntero a la interfaz [**IVMRSurfaceAllocatorNotify**](/windows/desktop/api/Strmif/nn-strmif-ivmrsurfaceallocatornotify) de VMR.</span><span class="sxs-lookup"><span data-stu-id="9da44-112">In response to this call, the VMR will call the allocator-presenter's [**IVMRSurfaceAllocator::AdviseNotify**](/windows/desktop/api/Strmif/nf-strmif-ivmrsurfaceallocator-advisenotify) method to provide the pointer to the VMR's [**IVMRSurfaceAllocatorNotify**](/windows/desktop/api/Strmif/nn-strmif-ivmrsurfaceallocatornotify) interface.</span></span> <span data-ttu-id="9da44-113">Allocator-Presenter usará este puntero de interfaz al pasar eventos a VMR con el método [**IVMRSurfaceAllocatorNotify:: NotifyEvent**](/windows/desktop/api/Strmif/nf-strmif-ivmrsurfaceallocatornotify-notifyevent) .</span><span class="sxs-lookup"><span data-stu-id="9da44-113">The allocator-presenter will use this interface pointer when passing events to the VMR with the [**IVMRSurfaceAllocatorNotify::NotifyEvent**](/windows/desktop/api/Strmif/nf-strmif-ivmrsurfaceallocatornotify-notifyevent) method.</span></span>

<span data-ttu-id="9da44-114">Como solución alternativa, una aplicación puede usar su propio asignador-presentador y el predeterminado del asignador.</span><span class="sxs-lookup"><span data-stu-id="9da44-114">As an alternate solution, an application can use both its own allocator-presenter and the default allocator-presenter.</span></span> <span data-ttu-id="9da44-115">En este escenario, el asignador personalizado controla solo las llamadas en las que se necesita una funcionalidad personalizada y pasa el resto de las llamadas desde la VMR hasta el asignador predeterminado.</span><span class="sxs-lookup"><span data-stu-id="9da44-115">In this scenario, the custom allocator-presenter handles only those calls where custom functionality is needed, and passes the rest of the calls from the VMR through to the default allocator-presenter.</span></span> <span data-ttu-id="9da44-116">En muchos casos, solo es necesario invalidar la interfaz [**IVMRImagePresenter**](/windows/desktop/api/Strmif/nn-strmif-ivmrimagepresenter) .</span><span class="sxs-lookup"><span data-stu-id="9da44-116">In many cases, it is only necessary to override the [**IVMRImagePresenter**](/windows/desktop/api/Strmif/nn-strmif-ivmrimagepresenter) interface.</span></span>

![uso de dos allocator-Presenter](images/custom-ap2.png)

<span data-ttu-id="9da44-118">Para usar un asignador personalizado y el presentador de asignador predeterminado, una aplicación llamaría primero a [**IVMRSurfaceAllocatorNotify:: AdviseSurfaceAllocator**](/windows/desktop/api/Strmif/nf-strmif-ivmrsurfaceallocatornotify-advisesurfaceallocator) para proporcionar un puntero al nuevo asignador-presentador ().</span><span class="sxs-lookup"><span data-stu-id="9da44-118">To use both a custom allocator-presenter and the default allocator-presenter, an application would first call [**IVMRSurfaceAllocatorNotify::AdviseSurfaceAllocator**](/windows/desktop/api/Strmif/nf-strmif-ivmrsurfaceallocatornotify-advisesurfaceallocator) to provide a pointer to the new allocator-presenter.</span></span> <span data-ttu-id="9da44-119">Esto hace que se destruya el asignador predeterminado, por lo que la aplicación debe crear otra instancia del mismo llamando a **QueryInterface** en la VMR y solicitando la interfaz [**IVMRSurfaceAllocator**](/windows/desktop/api/Strmif/nn-strmif-ivmrsurfaceallocator) .</span><span class="sxs-lookup"><span data-stu-id="9da44-119">This causes the default allocator-presenter to be destroyed, so the application must create another instance of it by calling **QueryInterface** on the VMR and requesting the [**IVMRSurfaceAllocator**](/windows/desktop/api/Strmif/nn-strmif-ivmrsurfaceallocator) interface.</span></span> <span data-ttu-id="9da44-120">Como se muestra en la ilustración anterior, el asignador personalizado invalida los métodos de la interfaz [**IVMRImagePresenter**](/windows/desktop/api/Strmif/nn-strmif-ivmrimagepresenter) y simplemente pasa todas las llamadas a la interfaz **IVMRSurfaceAllocator** a través de la implementación predeterminada.</span><span class="sxs-lookup"><span data-stu-id="9da44-120">As shown in the preceding figure, the custom allocator-presenter overrides the [**IVMRImagePresenter**](/windows/desktop/api/Strmif/nn-strmif-ivmrimagepresenter) interface methods, and simply passes all calls to the **IVMRSurfaceAllocator** interface through to the default implementation.</span></span> <span data-ttu-id="9da44-121">La ilustración también muestra la interfaz [**IVMRWindowlessControl**](/windows/desktop/api/Strmif/nn-strmif-ivmrwindowlesscontrol) que se implementa en allocator-Presenter.</span><span class="sxs-lookup"><span data-stu-id="9da44-121">The figure also shows the [**IVMRWindowlessControl**](/windows/desktop/api/Strmif/nn-strmif-ivmrwindowlesscontrol) interface as being implemented on the allocator-presenter.</span></span>

## <a name="related-topics"></a><span data-ttu-id="9da44-122">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="9da44-122">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="9da44-123">Suministro de un Allocator-Presenter personalizado para VMR-9</span><span class="sxs-lookup"><span data-stu-id="9da44-123">Supplying a Custom Allocator-Presenter for VMR-9</span></span>](supplying-a-custom-allocator-presenter-for-vmr-9.md)
</dt> <dt>

[<span data-ttu-id="9da44-124">Modo de reproducción no representativo de VMR (asignador personalizado)</span><span class="sxs-lookup"><span data-stu-id="9da44-124">VMR Renderless Playback Mode (Custom Allocator-Presenters)</span></span>](vmr-renderless-playback-mode--custom-allocator-presenters.md)
</dt> </dl>

 

 



