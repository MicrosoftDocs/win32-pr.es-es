---
description: Los contextos de secuencia controlan los protocolos orientados a secuencias seguros, como SSL o PCT.
ms.assetid: 05a6b036-1f7f-473f-9813-a1e1534e0f0d
title: Contextos de secuencia
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 53103dc1269c05e5a2c162133d21e167d8035c2c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104001562"
---
# <a name="stream-contexts"></a><span data-ttu-id="4a9ad-103">Contextos de secuencia</span><span class="sxs-lookup"><span data-stu-id="4a9ad-103">Stream Contexts</span></span>

<span data-ttu-id="4a9ad-104">Los contextos de secuencia controlan los protocolos orientados a secuencias seguros, como SSL o PCT.</span><span class="sxs-lookup"><span data-stu-id="4a9ad-104">Stream contexts handle the secure stream-oriented protocols such as SSL or PCT.</span></span> <span data-ttu-id="4a9ad-105">En interés de compartir la misma interfaz y la administración similar de credenciales, SSPI proporciona compatibilidad con los contextos de secuencia.</span><span class="sxs-lookup"><span data-stu-id="4a9ad-105">In the interest of sharing the same interface and similar credential management, SSPI provides support for stream contexts.</span></span> <span data-ttu-id="4a9ad-106">El [*Protocolo de seguridad*](../secgloss/s-gly.md) incorpora el esquema de autenticación de secuencias y los formatos de registro.</span><span class="sxs-lookup"><span data-stu-id="4a9ad-106">The [*security protocol*](../secgloss/s-gly.md) incorporates both the stream authentication scheme and record formats.</span></span>

<span data-ttu-id="4a9ad-107">Para proporcionar protocolos orientados a secuencias, los [*paquetes de seguridad*](../secgloss/s-gly.md) que admiten contextos de secuencia tienen las siguientes características de proceso:</span><span class="sxs-lookup"><span data-stu-id="4a9ad-107">To provide stream-oriented protocols, [*security packages*](../secgloss/s-gly.md) that support stream contexts have the following process characteristics:</span></span>

-   <span data-ttu-id="4a9ad-108">El paquete establece la marca de flujo de la \_ marca SECPKG \_ para indicar que admite la semántica de secuencias.</span><span class="sxs-lookup"><span data-stu-id="4a9ad-108">The package sets the SECPKG\_FLAG\_STREAM flag to indicate that it supports stream semantics.</span></span>
-   <span data-ttu-id="4a9ad-109">Las aplicaciones de transporte solicitan la semántica de los flujos estableciendo la secuencia de REQ de ISC \_ \_ y las \_ \_ marcas de flujo de REQ de ASC en las llamadas a las funciones [**InitializeSecurityContext (general)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) y [**AcceptSecurityContext (general)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) .</span><span class="sxs-lookup"><span data-stu-id="4a9ad-109">Transport applications requests stream semantics by setting the ISC\_REQ\_STREAM and ASC\_REQ\_STREAM flags in the calls to the [**InitializeSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) and [**AcceptSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) functions.</span></span>
-   <span data-ttu-id="4a9ad-110">La aplicación llama a la función [**QueryContextAttributes (general)**](/windows/win32/api/sspi/nf-sspi-querycontextattributesa) con una estructura [**SecPkgContext \_ StreamSizes**](/windows/desktop/api/Sspi/ns-sspi-secpkgcontext_streamsizes) para consultar el [*contexto de seguridad*](../secgloss/s-gly.md) para el número de búferes que se van a proporcionar y los tamaños que se reservan para los encabezados o finalizadores.</span><span class="sxs-lookup"><span data-stu-id="4a9ad-110">The application calls the [**QueryContextAttributes (General)**](/windows/win32/api/sspi/nf-sspi-querycontextattributesa) function with a [**SecPkgContext\_StreamSizes**](/windows/desktop/api/Sspi/ns-sspi-secpkgcontext_streamsizes) structure to query the [*security context*](../secgloss/s-gly.md) for the number of buffers to provide and the sizes to reserve for headers or trailers.</span></span>
-   <span data-ttu-id="4a9ad-111">La aplicación proporciona descriptores de búfer para la reserva durante el procesamiento real de los datos.</span><span class="sxs-lookup"><span data-stu-id="4a9ad-111">The application provides buffer descriptors to spare during the actual processing of the data.</span></span> <span data-ttu-id="4a9ad-112">Al especificar la semántica de los flujos, el autor de la llamada indica la disposición de realizar un procesamiento adicional para que el [*paquete de seguridad*](../secgloss/s-gly.md) pueda controlar el bloqueo de los mensajes.</span><span class="sxs-lookup"><span data-stu-id="4a9ad-112">By specifying stream semantics, the caller indicates willingness to do extra processing so that the [*security package*](../secgloss/s-gly.md) can handle the blocking of the messages.</span></span> <span data-ttu-id="4a9ad-113">En esencia, para las funciones [**MakeSignature**](/windows/desktop/api/Sspi/nf-sspi-makesignature) y [**VerifySignature**](/windows/desktop/api/Sspi/nf-sspi-verifysignature) , el autor de la llamada pasa una lista de búferes.</span><span class="sxs-lookup"><span data-stu-id="4a9ad-113">In essence, for the [**MakeSignature**](/windows/desktop/api/Sspi/nf-sspi-makesignature) and [**VerifySignature**](/windows/desktop/api/Sspi/nf-sspi-verifysignature) functions, the caller passes in a list of buffers.</span></span> <span data-ttu-id="4a9ad-114">Cuando se recibe un mensaje de un canal orientado a secuencias (por ejemplo, un puerto TCP), el autor de la llamada pasa una lista de búferes como se indica a continuación.</span><span class="sxs-lookup"><span data-stu-id="4a9ad-114">When a message is received from a channel that is stream-oriented (such as a TCP port), the caller passes in a buffer list as follows.</span></span>

    | <span data-ttu-id="4a9ad-115">Buffer</span><span class="sxs-lookup"><span data-stu-id="4a9ad-115">Buffer</span></span> | <span data-ttu-id="4a9ad-116">Length</span><span class="sxs-lookup"><span data-stu-id="4a9ad-116">Length</span></span>         | <span data-ttu-id="4a9ad-117">Tipo de búfer</span><span class="sxs-lookup"><span data-stu-id="4a9ad-117">Buffer type</span></span>      |
    |--------|----------------|------------------|
    | <span data-ttu-id="4a9ad-118">1</span><span class="sxs-lookup"><span data-stu-id="4a9ad-118">1</span></span>      | <span data-ttu-id="4a9ad-119">Longitud del mensaje</span><span class="sxs-lookup"><span data-stu-id="4a9ad-119">Message Length</span></span> | <span data-ttu-id="4a9ad-120">datos de SECBUFFER \_</span><span class="sxs-lookup"><span data-stu-id="4a9ad-120">SECBUFFER\_DATA</span></span>  |
    | <span data-ttu-id="4a9ad-121">2</span><span class="sxs-lookup"><span data-stu-id="4a9ad-121">2</span></span>      | <span data-ttu-id="4a9ad-122">0</span><span class="sxs-lookup"><span data-stu-id="4a9ad-122">0</span></span>              | <span data-ttu-id="4a9ad-123">SECBUFFER \_ vacío</span><span class="sxs-lookup"><span data-stu-id="4a9ad-123">SECBUFFER\_EMPTY</span></span> |
    | <span data-ttu-id="4a9ad-124">3</span><span class="sxs-lookup"><span data-stu-id="4a9ad-124">3</span></span>      | <span data-ttu-id="4a9ad-125">0</span><span class="sxs-lookup"><span data-stu-id="4a9ad-125">0</span></span>              | <span data-ttu-id="4a9ad-126">SECBUFFER \_ vacío</span><span class="sxs-lookup"><span data-stu-id="4a9ad-126">SECBUFFER\_EMPTY</span></span> |
    | <span data-ttu-id="4a9ad-127">4</span><span class="sxs-lookup"><span data-stu-id="4a9ad-127">4</span></span>      | <span data-ttu-id="4a9ad-128">0</span><span class="sxs-lookup"><span data-stu-id="4a9ad-128">0</span></span>              | <span data-ttu-id="4a9ad-129">SECBUFFER \_ vacío</span><span class="sxs-lookup"><span data-stu-id="4a9ad-129">SECBUFFER\_EMPTY</span></span> |
    | <span data-ttu-id="4a9ad-130">5</span><span class="sxs-lookup"><span data-stu-id="4a9ad-130">5</span></span>      | <span data-ttu-id="4a9ad-131">0</span><span class="sxs-lookup"><span data-stu-id="4a9ad-131">0</span></span>              | <span data-ttu-id="4a9ad-132">SECBUFFER \_ vacío</span><span class="sxs-lookup"><span data-stu-id="4a9ad-132">SECBUFFER\_EMPTY</span></span> |

    

     

    <span data-ttu-id="4a9ad-133">Después, el paquete de seguridad funciona en el [*BLOB*](../secgloss/b-gly.md).</span><span class="sxs-lookup"><span data-stu-id="4a9ad-133">The security package then works on the [*BLOB*](../secgloss/b-gly.md).</span></span> <span data-ttu-id="4a9ad-134">Si la función se devuelve correctamente, la lista de búferes tiene un aspecto similar al siguiente.</span><span class="sxs-lookup"><span data-stu-id="4a9ad-134">If the function returns successfully, the buffer list looks like the following.</span></span>

    

    | <span data-ttu-id="4a9ad-135">Buffer</span><span class="sxs-lookup"><span data-stu-id="4a9ad-135">Buffer</span></span> | <span data-ttu-id="4a9ad-136">Length</span><span class="sxs-lookup"><span data-stu-id="4a9ad-136">Length</span></span>         | <span data-ttu-id="4a9ad-137">Tipo de búfer</span><span class="sxs-lookup"><span data-stu-id="4a9ad-137">Buffer type</span></span>                |
    |--------|----------------|----------------------------|
    | <span data-ttu-id="4a9ad-138">1</span><span class="sxs-lookup"><span data-stu-id="4a9ad-138">1</span></span>      | <span data-ttu-id="4a9ad-139">Longitud del encabezado</span><span class="sxs-lookup"><span data-stu-id="4a9ad-139">Header Length</span></span>  | <span data-ttu-id="4a9ad-140">SECBUFFER \_ encabezado de secuencia \_</span><span class="sxs-lookup"><span data-stu-id="4a9ad-140">SECBUFFER\_STREAM\_HEADER</span></span>  |
    | <span data-ttu-id="4a9ad-141">2</span><span class="sxs-lookup"><span data-stu-id="4a9ad-141">2</span></span>      | <span data-ttu-id="4a9ad-142">Longitud de los datos</span><span class="sxs-lookup"><span data-stu-id="4a9ad-142">Data Length</span></span>    | <span data-ttu-id="4a9ad-143">datos de SECBUFFER \_</span><span class="sxs-lookup"><span data-stu-id="4a9ad-143">SECBUFFER\_DATA</span></span>            |
    | <span data-ttu-id="4a9ad-144">3</span><span class="sxs-lookup"><span data-stu-id="4a9ad-144">3</span></span>      | <span data-ttu-id="4a9ad-145">Longitud del finalizador</span><span class="sxs-lookup"><span data-stu-id="4a9ad-145">Trailer Length</span></span> | <span data-ttu-id="4a9ad-146">\_finalizador de flujo SECBUFFER \_</span><span class="sxs-lookup"><span data-stu-id="4a9ad-146">SECBUFFER\_STREAM\_TRAILER</span></span> |
    | <span data-ttu-id="4a9ad-147">4</span><span class="sxs-lookup"><span data-stu-id="4a9ad-147">4</span></span>      | <span data-ttu-id="4a9ad-148">0</span><span class="sxs-lookup"><span data-stu-id="4a9ad-148">0</span></span>              | <span data-ttu-id="4a9ad-149">SECBUFFER \_ vacío</span><span class="sxs-lookup"><span data-stu-id="4a9ad-149">SECBUFFER\_EMPTY</span></span>           |
    | <span data-ttu-id="4a9ad-150">5</span><span class="sxs-lookup"><span data-stu-id="4a9ad-150">5</span></span>      | <span data-ttu-id="4a9ad-151">0</span><span class="sxs-lookup"><span data-stu-id="4a9ad-151">0</span></span>              | <span data-ttu-id="4a9ad-152">SECBUFFER \_ vacío</span><span class="sxs-lookup"><span data-stu-id="4a9ad-152">SECBUFFER\_EMPTY</span></span>           |

    

     

    <span data-ttu-id="4a9ad-153">El paquete también podría haber devuelto el búfer \# 4 con la longitud x y el tipo de búfer SECBUFFER \_ extra, lo que indica que los datos de este búfer forman parte del Registro siguiente y aún no se han procesado.</span><span class="sxs-lookup"><span data-stu-id="4a9ad-153">The package could have also returned buffer \#4 with length x and buffer type SECBUFFER\_EXTRA indicating that the data in this buffer is part of the next record and has not yet been processed.</span></span> <span data-ttu-id="4a9ad-154">Por el contrario, si la función de mensaje devuelve el \_ código de error de mensaje s E \_ incompleto \_ , la lista de búferes devuelta sería similar a la siguiente.</span><span class="sxs-lookup"><span data-stu-id="4a9ad-154">Conversely, if the message function returns the SEC\_E\_INCOMPLETE\_MESSAGE error code, the returned buffer list would look like the following.</span></span>

    

    | <span data-ttu-id="4a9ad-155">Buffer</span><span class="sxs-lookup"><span data-stu-id="4a9ad-155">Buffer</span></span> | <span data-ttu-id="4a9ad-156">Length</span><span class="sxs-lookup"><span data-stu-id="4a9ad-156">Length</span></span> | <span data-ttu-id="4a9ad-157">Tipo de búfer</span><span class="sxs-lookup"><span data-stu-id="4a9ad-157">Buffer type</span></span>        |
    |--------|--------|--------------------|
    | <span data-ttu-id="4a9ad-158">1</span><span class="sxs-lookup"><span data-stu-id="4a9ad-158">1</span></span>      | <span data-ttu-id="4a9ad-159">x</span><span class="sxs-lookup"><span data-stu-id="4a9ad-159">x</span></span>      | <span data-ttu-id="4a9ad-160">\_falta SECBUFFER</span><span class="sxs-lookup"><span data-stu-id="4a9ad-160">SECBUFFER\_MISSING</span></span> |

    

     

    <span data-ttu-id="4a9ad-161">Esto indica que se necesitan más datos para procesar el registro.</span><span class="sxs-lookup"><span data-stu-id="4a9ad-161">This indicates that more data was needed to process the record.</span></span> <span data-ttu-id="4a9ad-162">A diferencia de la mayoría de los errores devueltos por una función de mensaje, este tipo de búfer no indica que el contexto se ha puesto en peligro.</span><span class="sxs-lookup"><span data-stu-id="4a9ad-162">Unlike most errors returned from a message function, this buffer type does not indicate that the context has been compromised.</span></span> <span data-ttu-id="4a9ad-163">En su lugar, indica que se necesitan más datos.</span><span class="sxs-lookup"><span data-stu-id="4a9ad-163">Instead, it indicates that more data is needed.</span></span> <span data-ttu-id="4a9ad-164">los [*paquetes de seguridad*](../secgloss/s-gly.md) no deben actualizar su [*Estado*](../secgloss/s-gly.md) en esta condición.</span><span class="sxs-lookup"><span data-stu-id="4a9ad-164">[*security packages*](../secgloss/s-gly.md) must not update their [*state*](../secgloss/s-gly.md) in this condition.</span></span>

    <span data-ttu-id="4a9ad-165">Del mismo modo, en el lado del remitente de la comunicación, el autor de la llamada puede llamar a la función [**MakeSignature**](/windows/desktop/api/Sspi/nf-sspi-makesignature) .</span><span class="sxs-lookup"><span data-stu-id="4a9ad-165">Similarly, on the sender side of the communication, the caller can call the [**MakeSignature**](/windows/desktop/api/Sspi/nf-sspi-makesignature) function.</span></span> <span data-ttu-id="4a9ad-166">Es posible que el paquete de seguridad tenga que reasignar el búfer o copiar los elementos.</span><span class="sxs-lookup"><span data-stu-id="4a9ad-166">The security package may need to reallocate the buffer or copy things around.</span></span> <span data-ttu-id="4a9ad-167">El autor de la llamada puede ser más eficaz al proporcionar una lista de búferes como se indica a continuación.</span><span class="sxs-lookup"><span data-stu-id="4a9ad-167">The caller can be more efficient by providing a buffer list as follows.</span></span>

    

    | <span data-ttu-id="4a9ad-168">Buffer</span><span class="sxs-lookup"><span data-stu-id="4a9ad-168">Buffer</span></span> | <span data-ttu-id="4a9ad-169">Length</span><span class="sxs-lookup"><span data-stu-id="4a9ad-169">Length</span></span>         | <span data-ttu-id="4a9ad-170">Tipo</span><span class="sxs-lookup"><span data-stu-id="4a9ad-170">Type</span></span>                       |
    |--------|----------------|----------------------------|
    | <span data-ttu-id="4a9ad-171">1</span><span class="sxs-lookup"><span data-stu-id="4a9ad-171">1</span></span>      | <span data-ttu-id="4a9ad-172">Longitud del encabezado</span><span class="sxs-lookup"><span data-stu-id="4a9ad-172">Header Length</span></span>  | <span data-ttu-id="4a9ad-173">SECBUFFER \_ encabezado de secuencia \_</span><span class="sxs-lookup"><span data-stu-id="4a9ad-173">SECBUFFER\_STREAM\_HEADER</span></span>  |
    | <span data-ttu-id="4a9ad-174">2</span><span class="sxs-lookup"><span data-stu-id="4a9ad-174">2</span></span>      | <span data-ttu-id="4a9ad-175">Longitud de los datos</span><span class="sxs-lookup"><span data-stu-id="4a9ad-175">Data Length</span></span>    | <span data-ttu-id="4a9ad-176">datos de SECBUFFER \_</span><span class="sxs-lookup"><span data-stu-id="4a9ad-176">SECBUFFER\_DATA</span></span>            |
    | <span data-ttu-id="4a9ad-177">3</span><span class="sxs-lookup"><span data-stu-id="4a9ad-177">3</span></span>      | <span data-ttu-id="4a9ad-178">Longitud del finalizador</span><span class="sxs-lookup"><span data-stu-id="4a9ad-178">Trailer Length</span></span> | <span data-ttu-id="4a9ad-179">\_finalizador de flujo SECBUFFER \_</span><span class="sxs-lookup"><span data-stu-id="4a9ad-179">SECBUFFER\_STREAM\_TRAILER</span></span> |

    

     

    <span data-ttu-id="4a9ad-180">Esto permite que el llamador utilice los búferes de manera más eficaz.</span><span class="sxs-lookup"><span data-stu-id="4a9ad-180">This allows the caller to use the buffers more efficiently.</span></span> <span data-ttu-id="4a9ad-181">Al llamar a la función [**QueryContextAttributes**](/windows/win32/api/sspi/nf-sspi-querycontextattributesa) para determinar la cantidad de espacio que se va a reservar antes de llamar a [**MakeSignature**](/windows/desktop/api/Sspi/nf-sspi-makesignature), la operación es más eficaz para la aplicación y el paquete de seguridad.</span><span class="sxs-lookup"><span data-stu-id="4a9ad-181">By calling the [**QueryContextAttributes**](/windows/win32/api/sspi/nf-sspi-querycontextattributesa) function to determine the amount of space to reserve before calling [**MakeSignature**](/windows/desktop/api/Sspi/nf-sspi-makesignature), the operation is more efficient for the application and the security package.</span></span>

 

 
