---
title: Registro de un dispositivo hospedado con el host del dispositivo
description: Registrar un dispositivo hospedado significa proporcionar al host del dispositivo la descripción del dispositivo y su objeto de control de dispositivo.
ms.assetid: 1d85b412-9b1b-415d-8664-8d96a6644793
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c4a607af4f6ada359a9ee32e98e416d8271fd502
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/16/2019
ms.locfileid: "104268697"
---
# <a name="registering-a-hosted-device-with-the-device-host"></a><span data-ttu-id="77c40-103">Registro de un dispositivo hospedado con el host del dispositivo</span><span class="sxs-lookup"><span data-stu-id="77c40-103">Registering a Hosted Device With the Device Host</span></span>

<span data-ttu-id="77c40-104">Registrar un dispositivo hospedado significa proporcionar al host del dispositivo la descripción del dispositivo y su objeto de control de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="77c40-104">Registering a hosted device means providing the device host with the device description and its device control object.</span></span> <span data-ttu-id="77c40-105">A continuación, el host del dispositivo crea una descripción completa del dispositivo UPnP, lo publica y anuncia el dispositivo en la red mediante el protocolo de detección UPnP.</span><span class="sxs-lookup"><span data-stu-id="77c40-105">The device host then constructs a complete UPnP device description, publishes it, and announces the device on the network using the UPnP discovery protocol.</span></span> <span data-ttu-id="77c40-106">Una vez que se publica un dispositivo, está disponible para los puntos de control.</span><span class="sxs-lookup"><span data-stu-id="77c40-106">Once a device is published, it is available to control points.</span></span>

<span data-ttu-id="77c40-107">Los dispositivos se registran de dos maneras:</span><span class="sxs-lookup"><span data-stu-id="77c40-107">Devices are registered in two ways:</span></span>

-   <span data-ttu-id="77c40-108">Una aplicación crea una instancia del objeto de control de dispositivo y le pasa un puntero al host del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="77c40-108">An application creates an instance of the device control object and passes a pointer to it to the device host.</span></span>
-   <span data-ttu-id="77c40-109">La aplicación pasa el identificador de programa (ProgID) de un objeto de control de dispositivo registrado al host del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="77c40-109">The application passes the ProgID for a registered device control object to the device host.</span></span> <span data-ttu-id="77c40-110">El host del dispositivo crea una instancia de ella cuando el host del dispositivo recibe la primera solicitud para el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="77c40-110">The device host instantiates it when the device host receives the first request for the device.</span></span>

<span data-ttu-id="77c40-111">Independientemente del método que se use, el host del dispositivo publica y anuncia el dispositivo en cuanto se registra.</span><span class="sxs-lookup"><span data-stu-id="77c40-111">Regardless of which method is used, the device host publishes and announces the device as soon as it is registered.</span></span> <span data-ttu-id="77c40-112">La diferencia entre los dos enfoques tiene que hacer con cuando se carga el código del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="77c40-112">The difference between the two approaches has to do with when the device code is loaded.</span></span> <span data-ttu-id="77c40-113">Cuando la aplicación pasa un puntero al objeto de control de dispositivo, el código del dispositivo se carga y se ejecuta en el momento del registro.</span><span class="sxs-lookup"><span data-stu-id="77c40-113">When the application passes in a pointer to the device control object, the device code is loaded and running at the time of registration.</span></span> <span data-ttu-id="77c40-114">Cuando la aplicación pasa un ProgID, el código del dispositivo solo se carga cuando se invoca una acción, se consulta una propiedad o llega una solicitud de suscripción de eventos.</span><span class="sxs-lookup"><span data-stu-id="77c40-114">When the application passes a ProgID, the device code is only loaded when an action is invoked, a property is queried, or an event subscription request arrives.</span></span> <span data-ttu-id="77c40-115">El segundo enfoque es ligeramente más eficaz.</span><span class="sxs-lookup"><span data-stu-id="77c40-115">The second approach is slightly more efficient.</span></span> <span data-ttu-id="77c40-116">Sin embargo, no es adecuado para dispositivos que deben estar en ejecución antes de que llegue cualquier solicitud de suscripción de control o evento, ya que el uso de este enfoque solo se crea cuando se necesitan.</span><span class="sxs-lookup"><span data-stu-id="77c40-116">However, it is not suitable for devices that must be running before any control or event subscription requests arrive, because using this approach, device control objects are only created when they are needed.</span></span> <span data-ttu-id="77c40-117">Este segundo método también puede crear problemas de rendimiento cuando recibe la primera solicitud para un tipo de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="77c40-117">This second method can also create performance issues when it receives the first request for a device type.</span></span>

<span data-ttu-id="77c40-118">Si desea asegurarse de que el host del dispositivo anuncia automáticamente un dispositivo en la red cuando se inicia el equipo, invoque [**IUPnPRegistrar:: RegisterDevice**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerdevice).</span><span class="sxs-lookup"><span data-stu-id="77c40-118">If you want to ensure that a device is announced by the device host on the network automatically when the computer is started, invoke [**IUPnPRegistrar::RegisterDevice**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerdevice).</span></span> <span data-ttu-id="77c40-119">**RegisterDevice** garantiza que el código del dispositivo solo se carga cuando se recibe una solicitud de suscripción de control o evento.</span><span class="sxs-lookup"><span data-stu-id="77c40-119">**RegisterDevice** ensures that your device code is only loaded when a control or event subscription request is received.</span></span>

<span data-ttu-id="77c40-120">Si los dispositivos son transitorios o con puentes, invoque [**IUPnPRegistrar:: RegisterRunningDevice**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerrunningdevice)y el dispositivo no se volverá a anunciar automáticamente cuando se reinicie el equipo.</span><span class="sxs-lookup"><span data-stu-id="77c40-120">If your devices are transient or bridged, invoke [**IUPnPRegistrar::RegisterRunningDevice**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerrunningdevice), and the device is not automatically re-advertised when the computer is restarted.</span></span>

## <a name="discovery-announcement-lifetime"></a><span data-ttu-id="77c40-121">Duración del anuncio de detección</span><span class="sxs-lookup"><span data-stu-id="77c40-121">Discovery Announcement Lifetime</span></span>

<span data-ttu-id="77c40-122">Cada dispositivo registrado con el host del dispositivo está asociado a una duración, que se especifica en el dispositivo tras el registro.</span><span class="sxs-lookup"><span data-stu-id="77c40-122">Each device registered with the device host is associated with a lifetime, which is specified by the device upon registration.</span></span> <span data-ttu-id="77c40-123">La duración del dispositivo es el período de tiempo durante el que son válidos los anuncios de detección del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="77c40-123">The lifetime of the device is the period of time for which the device's discovery announcements are valid.</span></span> <span data-ttu-id="77c40-124">La duración se pasa al punto de control como un encabezado en el anuncio de detección inicial.</span><span class="sxs-lookup"><span data-stu-id="77c40-124">The lifetime is passed to the control point as a header in the initial discovery announcement.</span></span> <span data-ttu-id="77c40-125">El host del dispositivo actualiza automáticamente el anuncio antes de la fecha de expiración.</span><span class="sxs-lookup"><span data-stu-id="77c40-125">The device host automatically refreshes the announcement prior to the expiration time.</span></span> <span data-ttu-id="77c40-126">Los valores de la duración del anuncio de detección deben ser de 15 minutos o más (el valor predeterminado es 30 minutos).</span><span class="sxs-lookup"><span data-stu-id="77c40-126">The values of the discovery announcement lifetime should be 15 minutes or more (the default is 30 minutes).</span></span>

## <a name="device-identifiers-created-at-registration"></a><span data-ttu-id="77c40-127">Identificadores de dispositivo creados en el registro</span><span class="sxs-lookup"><span data-stu-id="77c40-127">Device Identifiers Created at Registration</span></span>

<span data-ttu-id="77c40-128">Al crear una plantilla de descripción de dispositivo, el desarrollador de dispositivos debe proporcionar la ruta de acceso del recurso a la descripción del servicio y los iconos asociados.</span><span class="sxs-lookup"><span data-stu-id="77c40-128">When creating a device description template, the device developer must provide the resource path to the service description and associated icons.</span></span> <span data-ttu-id="77c40-129">La ruta de acceso del recurso viene determinada por la aplicación del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="77c40-129">The resource path is determined by the device application.</span></span>

<span data-ttu-id="77c40-130">Puesto que el mismo dispositivo se puede registrar varias veces en el mismo equipo, el UDN especificado en la plantilla de Descripción del dispositivo no es suficiente para identificar un dispositivo de forma única.</span><span class="sxs-lookup"><span data-stu-id="77c40-130">Since the same device can be registered multiple times on the same computer, the UDN specified in the device description template is not sufficient to uniquely identify a device.</span></span> <span data-ttu-id="77c40-131">Por lo tanto, cuando se registra un dispositivo, el host del dispositivo crea un identificador de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="77c40-131">Therefore, when a device is registered, the device host creates a device identifier.</span></span> <span data-ttu-id="77c40-132">Este identificador de dispositivo, en asociación con UDN en la plantilla de Descripción del dispositivo, se puede usar para identificar un dispositivo de forma única.</span><span class="sxs-lookup"><span data-stu-id="77c40-132">This device identifier, in association with the UDN in the device description template, can be used to uniquely identify a device.</span></span>

<span data-ttu-id="77c40-133">Este identificador también se usa cuando el dispositivo no está registrado temporalmente y luego se vuelve a registrar.</span><span class="sxs-lookup"><span data-stu-id="77c40-133">This identifier is also used when the device is temporarily unregistered and then re-registered.</span></span> <span data-ttu-id="77c40-134">Cuando se anula el registro de un dispositivo temporalmente, el host del dispositivo no elimina el UDN.</span><span class="sxs-lookup"><span data-stu-id="77c40-134">When a device is unregistered temporarily, the device host does not delete the UDN.</span></span> <span data-ttu-id="77c40-135">Entre las razones para no eliminar la UDN se incluyen:</span><span class="sxs-lookup"><span data-stu-id="77c40-135">Reasons for not deleting the UDN include:</span></span>

-   <span data-ttu-id="77c40-136">El dispositivo se está actualizando.</span><span class="sxs-lookup"><span data-stu-id="77c40-136">The device is being upgraded.</span></span>
-   <span data-ttu-id="77c40-137">Está cambiando las propiedades del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="77c40-137">You are changing the properties of the device.</span></span>
-   <span data-ttu-id="77c40-138">Un servicio no está disponible temporalmente.</span><span class="sxs-lookup"><span data-stu-id="77c40-138">A service is temporarily unavailable.</span></span>
-   <span data-ttu-id="77c40-139">Está agregando un nuevo servicio a un dispositivo.</span><span class="sxs-lookup"><span data-stu-id="77c40-139">You are adding a new service to a device.</span></span>
-   <span data-ttu-id="77c40-140">Está actualizando el archivo DLL.</span><span class="sxs-lookup"><span data-stu-id="77c40-140">You are updating the DLL.</span></span>
-   <span data-ttu-id="77c40-141">El dispositivo está en modo de suspensión.</span><span class="sxs-lookup"><span data-stu-id="77c40-141">The device is in stand-by mode.</span></span>

<span data-ttu-id="77c40-142">Consulte las secciones siguientes para obtener más información sobre el registro:</span><span class="sxs-lookup"><span data-stu-id="77c40-142">Refer to the following sections for further information on registration:</span></span>

-   [<span data-ttu-id="77c40-143">Cómo registrar un dispositivo con el host del dispositivo</span><span class="sxs-lookup"><span data-stu-id="77c40-143">How to Register a Device with the Device Host</span></span>](how-to-register-a-device-with-the-device-host.md)
-   [<span data-ttu-id="77c40-144">Anulación del registro de un dispositivo</span><span class="sxs-lookup"><span data-stu-id="77c40-144">Unregistering a Device</span></span>](unregistering-a-device.md)
-   [<span data-ttu-id="77c40-145">**IUPnPRegistrar::UnregisterDevice**</span><span class="sxs-lookup"><span data-stu-id="77c40-145">**IUPnPRegistrar::UnregisterDevice**</span></span>](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-unregisterdevice)
-   [<span data-ttu-id="77c40-146">**IUPnPReregistrar**</span><span class="sxs-lookup"><span data-stu-id="77c40-146">**IUPnPReregistrar**</span></span>](/windows/desktop/api/Upnphost/nn-upnphost-iupnpreregistrar)

 

 




