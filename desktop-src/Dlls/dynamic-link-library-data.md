---
description: Una biblioteca de Dynamic-Link (DLL) puede contener datos globales o datos locales.
ms.assetid: b1f6811e-c413-4124-9ccb-ea59b7a8a7ff
title: Datos de la biblioteca Dynamic-Link
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 83280d3bfc449061c44f9e8bfd9b47833e7eca19
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "105669705"
---
# <a name="dynamic-link-library-data"></a><span data-ttu-id="1d6b2-103">Datos de la biblioteca Dynamic-Link</span><span class="sxs-lookup"><span data-stu-id="1d6b2-103">Dynamic-Link Library Data</span></span>

<span data-ttu-id="1d6b2-104">Una biblioteca de Dynamic-Link (DLL) puede contener datos globales o datos locales.</span><span class="sxs-lookup"><span data-stu-id="1d6b2-104">A Dynamic-Link Library (DLL) can contain global data or local data.</span></span>

## <a name="variable-scope"></a><span data-ttu-id="1d6b2-105">Ámbito de variable</span><span class="sxs-lookup"><span data-stu-id="1d6b2-105">Variable Scope</span></span>

<span data-ttu-id="1d6b2-106">Las variables que se declaran como globales en un archivo de código fuente DLL se tratan como variables globales por parte del compilador y del enlazador, pero cada proceso que carga un archivo DLL determinado obtiene su propia copia de las variables globales de ese archivo DLL.</span><span class="sxs-lookup"><span data-stu-id="1d6b2-106">Variables that are declared as global in a DLL source code file are treated as global variables by the compiler and linker, but each process that loads a given DLL gets its own copy of that DLL's global variables.</span></span> <span data-ttu-id="1d6b2-107">El ámbito de las variables estáticas se limita al bloque en el que se declaran las variables estáticas.</span><span class="sxs-lookup"><span data-stu-id="1d6b2-107">The scope of static variables is limited to the block in which the static variables are declared.</span></span> <span data-ttu-id="1d6b2-108">Como resultado, cada proceso tiene su propia instancia de las variables globales y estáticas de DLL de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="1d6b2-108">As a result, each process has its own instance of the DLL global and static variables by default.</span></span>

> [!Note]  
> <span data-ttu-id="1d6b2-109">Las herramientas de desarrollo pueden permitirle invalidar el comportamiento predeterminado.</span><span class="sxs-lookup"><span data-stu-id="1d6b2-109">Your development tools may allow you to override the default behavior.</span></span> <span data-ttu-id="1d6b2-110">Por ejemplo, el compilador Visual C++ admite la **\# sección pragma** y el vinculador admite la opción/Section.</span><span class="sxs-lookup"><span data-stu-id="1d6b2-110">For example, the Visual C++ compiler supports **\#pragma section** and the linker supports the /SECTION option.</span></span> <span data-ttu-id="1d6b2-111">Para obtener más información, consulte la documentación que se incluye con las herramientas de desarrollo.</span><span class="sxs-lookup"><span data-stu-id="1d6b2-111">For more information, see the documentation included with your development tools.</span></span>

 

## <a name="dynamic-memory-allocation"></a><span data-ttu-id="1d6b2-112">Asignación Memoria dinámica</span><span class="sxs-lookup"><span data-stu-id="1d6b2-112">Dynamic Memory Allocation</span></span>

<span data-ttu-id="1d6b2-113">Cuando un archivo DLL asigna memoria mediante cualquiera de las funciones de asignación de memoria ([**GlobalAlloc**](/windows/desktop/api/winbase/nf-winbase-globalalloc), [**LocalAlloc**](/windows/desktop/api/winbase/nf-winbase-localalloc), [**HeapAlloc**](/windows/desktop/api/heapapi/nf-heapapi-heapalloc)y [**VirtualAlloc**](/windows/desktop/api/memoryapi/nf-memoryapi-virtualalloc)), la memoria se asigna en el espacio de direcciones virtuales del proceso de llamada y solo es accesible para los subprocesos de ese proceso.</span><span class="sxs-lookup"><span data-stu-id="1d6b2-113">When a DLL allocates memory using any of the memory allocation functions ([**GlobalAlloc**](/windows/desktop/api/winbase/nf-winbase-globalalloc), [**LocalAlloc**](/windows/desktop/api/winbase/nf-winbase-localalloc), [**HeapAlloc**](/windows/desktop/api/heapapi/nf-heapapi-heapalloc), and [**VirtualAlloc**](/windows/desktop/api/memoryapi/nf-memoryapi-virtualalloc)), the memory is allocated in the virtual address space of the calling process and is accessible only to the threads of that process.</span></span>

<span data-ttu-id="1d6b2-114">Un archivo DLL puede utilizar la asignación de archivos para asignar memoria que se puede compartir entre los procesos.</span><span class="sxs-lookup"><span data-stu-id="1d6b2-114">A DLL can use file mapping to allocate memory that can be shared among processes.</span></span> <span data-ttu-id="1d6b2-115">Para obtener una explicación general sobre cómo usar la asignación de archivos para crear memoria compartida con nombre, consulte [asignación de archivos](/windows/desktop/Memory/file-mapping).</span><span class="sxs-lookup"><span data-stu-id="1d6b2-115">For a general discussion of how to use file mapping to create named shared memory, see [File Mapping](/windows/desktop/Memory/file-mapping).</span></span> <span data-ttu-id="1d6b2-116">Para obtener un ejemplo en el que se usa la función [**DllMain**](dllmain.md) para configurar la memoria compartida mediante la asignación de archivos, vea [uso de memoria compartida en una biblioteca de Dynamic-Link](using-shared-memory-in-a-dynamic-link-library.md).</span><span class="sxs-lookup"><span data-stu-id="1d6b2-116">For an example that uses the [**DllMain**](dllmain.md) function to set up shared memory using file mapping, see [Using Shared Memory in a Dynamic-Link Library](using-shared-memory-in-a-dynamic-link-library.md).</span></span>

## <a name="thread-local-storage"></a><span data-ttu-id="1d6b2-117">Almacenamiento local para el subproceso</span><span class="sxs-lookup"><span data-stu-id="1d6b2-117">Thread Local Storage</span></span>

<span data-ttu-id="1d6b2-118">Las funciones de almacenamiento local de subprocesos (TLS) permiten a un archivo DLL asignar un índice para almacenar y recuperar un valor diferente para cada subproceso de un proceso multiproceso.</span><span class="sxs-lookup"><span data-stu-id="1d6b2-118">The thread local storage (TLS) functions enable a DLL to allocate an index for storing and retrieving a different value for each thread of a multithreaded process.</span></span> <span data-ttu-id="1d6b2-119">Por ejemplo, una aplicación de hoja de cálculo puede crear una nueva instancia del mismo subproceso cada vez que el usuario abra una nueva hoja de cálculo.</span><span class="sxs-lookup"><span data-stu-id="1d6b2-119">For example, a spreadsheet application can create a new instance of the same thread each time the user opens a new spreadsheet.</span></span> <span data-ttu-id="1d6b2-120">Un archivo DLL que proporciona las funciones para varias operaciones de hoja de cálculo puede utilizar TLS para guardar información sobre el estado actual de cada hoja de cálculo (fila, columna, etc.).</span><span class="sxs-lookup"><span data-stu-id="1d6b2-120">A DLL providing the functions for various spreadsheet operations can use TLS to save information about the current state of each spreadsheet (row, column, and so on).</span></span> <span data-ttu-id="1d6b2-121">Para obtener una explicación general del almacenamiento local de subprocesos, vea [almacenamiento local para el subproceso](/windows/desktop/ProcThread/thread-local-storage).</span><span class="sxs-lookup"><span data-stu-id="1d6b2-121">For a general discussion of thread local storage, see [Thread Local Storage](/windows/desktop/ProcThread/thread-local-storage).</span></span> <span data-ttu-id="1d6b2-122">Para obtener un ejemplo en el que se usa la función [**DllMain**](dllmain.md) para configurar el almacenamiento local de subprocesos, vea [usar el almacenamiento local para el subproceso en una biblioteca Dynamic-Link](using-thread-local-storage-in-a-dynamic-link-library.md).</span><span class="sxs-lookup"><span data-stu-id="1d6b2-122">For an example that uses the [**DllMain**](dllmain.md) function to set up thread local storage, see [Using Thread Local Storage in a Dynamic-Link Library](using-thread-local-storage-in-a-dynamic-link-library.md).</span></span>

<span data-ttu-id="1d6b2-123">**Windows Server 2003 y Windows XP:** El compilador Visual C++ admite una sintaxis que permite declarar variables locales de subproceso: **\_ declspec (Thread)**.</span><span class="sxs-lookup"><span data-stu-id="1d6b2-123">**Windows Server 2003 and Windows XP:** The Visual C++ compiler supports a syntax that enables you to declare thread-local variables: **\_declspec(thread)**.</span></span> <span data-ttu-id="1d6b2-124">Si utiliza esta sintaxis en un archivo DLL, no podrá cargar el archivo DLL explícitamente mediante [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) o [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) en versiones de Windows anteriores a Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="1d6b2-124">If you use this syntax in a DLL, you will not be able to load the DLL explicitly using [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) or [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) on versions of Windows prior to Windows Vista.</span></span> <span data-ttu-id="1d6b2-125">Si el archivo DLL se va a cargar explícitamente, debe usar las funciones de almacenamiento local para el subproceso en lugar de **\_ declspec (Thread)**.</span><span class="sxs-lookup"><span data-stu-id="1d6b2-125">If your DLL will be loaded explicitly, you must use the thread local storage functions instead of **\_declspec(thread)**.</span></span>

 

 
