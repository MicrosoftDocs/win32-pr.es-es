---
description: Registrar el controlador del menú contextual
ms.assetid: 0023004b-b6b3-486a-8b8c-8e63c5731206
title: Registrar el controlador del menú contextual
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aafd2798683b4bc291653bca34996f143fc36842
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "105648493"
---
# <a name="registering-your-context-menu-handler"></a><span data-ttu-id="1b770-103">Registrar el controlador del menú contextual</span><span class="sxs-lookup"><span data-stu-id="1b770-103">Registering Your Context Menu Handler</span></span>

<span data-ttu-id="1b770-104">Para que el espacio de nombres de WPD reconozca el controlador del menú contextual, debe registrarlo correctamente en el registro de Windows.</span><span class="sxs-lookup"><span data-stu-id="1b770-104">In order for your context menu handler to be recognized by the WPD namespace you must register it properly in the Windows registry.</span></span> <span data-ttu-id="1b770-105">Las entradas de registro de un controlador del menú contextual de WPD son similares a las del shell, pero se registran como tipos de archivo especiales.</span><span class="sxs-lookup"><span data-stu-id="1b770-105">The registration entries for a WPD context menu handler are similar to those for the shell, but they are registered as special file types.</span></span> <span data-ttu-id="1b770-106">Los controladores de menú contextual de WPD se registran según el tipo de contenido que representan.</span><span class="sxs-lookup"><span data-stu-id="1b770-106">WPD context menu handlers are registered according to the content type they represent.</span></span> <span data-ttu-id="1b770-107">A continuación se muestra un árbol de registro de ejemplo para un controlador del menú contextual de WPD:</span><span class="sxs-lookup"><span data-stu-id="1b770-107">Below is a sample registration tree for a WPD context menu handler:</span></span>


```C++
HKEY_CLASSES_ROOT
 \-- WPDContextMenu.Image
      \-- shellex
           \-- ContextMenuHandlers
                \-- ShImageViewer (Default)  REG_SZ {E847DA7C-1D6A-45F6-B725-CB260C236066}

```



<span data-ttu-id="1b770-108">En el ejemplo anterior se registra el visor de imágenes de Shell con el espacio de nombres WPD.</span><span class="sxs-lookup"><span data-stu-id="1b770-108">The above example registers the shell image viewer with the WPD namespace.</span></span> <span data-ttu-id="1b770-109">Cuando un usuario hace clic con el botón secundario o hace doble clic en el contenido de un dispositivo a través del shell de Windows Vista, invoca este controlador de menú contextual.</span><span class="sxs-lookup"><span data-stu-id="1b770-109">When a user right-clicks or double-clicks content on a device through the Windows Vista Shell, it invokes this context menu handler.</span></span> <span data-ttu-id="1b770-110">El espacio de nombres de WPD usa el \_ \_ tipo de contenido WPD para determinar qué controladores de menús contextuales se van a cargar.</span><span class="sxs-lookup"><span data-stu-id="1b770-110">The WPD namespace uses WPD\_CONTENT\_TYPE to determine which context menu handlers to load.</span></span> <span data-ttu-id="1b770-111">Si \_ \_ el tipo de contenido de WPD es igual al tipo de contenido de WPD sin \_ \_ \_ especificar, \_ \_ \_ \_ archivo genérico de tipo de contenido de WPD o \_ \_ \_ programa de tipo de contenido WPD, el espacio de nombres de WPD intentará encontrar la mejor coincidencia en función de la extensión del archivo seleccionado.</span><span class="sxs-lookup"><span data-stu-id="1b770-111">If WPD\_CONTENT\_TYPE is equal to WPD\_CONTENT\_TYPE\_UNSPECIFIED, WPD\_CONTENT\_TYPE\_GENERIC\_FILE or WPD\_CONTENT\_TYPE\_PROGRAM, then the WPD namespace will try to find the best match based on the extension of the selected file.</span></span> <span data-ttu-id="1b770-112">Si ni la extensión de archivo ni el tipo de contenido proporcionan una clasificación útil, el espacio de nombres de WPD cargará los controladores de menú contextual en la clave del registro **WPDContextMenu. Generic** .</span><span class="sxs-lookup"><span data-stu-id="1b770-112">If neither the file extension nor the content type provides a useful classification, the WPD namespace will load the context menu handlers under the **WPDContextMenu.Generic** registry key.</span></span> <span data-ttu-id="1b770-113">En la tabla siguiente se enumeran todas las clases de archivo disponibles para un controlador de menú contextual y qué tipos de contenido y extensiones de archivo representan:</span><span class="sxs-lookup"><span data-stu-id="1b770-113">The following table lists all of the file classes available to a context menu handler and what content types and file extensions they represent:</span></span>



| <span data-ttu-id="1b770-114">Clave del Registro</span><span class="sxs-lookup"><span data-stu-id="1b770-114">Registry Key</span></span>                           | <span data-ttu-id="1b770-115">Tipo de contenido de WPD</span><span class="sxs-lookup"><span data-stu-id="1b770-115">WPD Content Type</span></span>                                                                                               | <span data-ttu-id="1b770-116">Extensión de archivo</span><span class="sxs-lookup"><span data-stu-id="1b770-116">File Extension</span></span>                                                                                           |
|----------------------------------------|----------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="1b770-117">**WPDContextMenu. dispositivo**</span><span class="sxs-lookup"><span data-stu-id="1b770-117">**WPDContextMenu.Device**</span></span>              | <span data-ttu-id="1b770-118">Al registrarse en esta clave, se habilita el controlador de menú contextual en el nivel de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="1b770-118">Registering under this key enables your context menu handler at the device level.</span></span> <span data-ttu-id="1b770-119">(Haga clic con el botón derecho en un dispositivo).</span><span class="sxs-lookup"><span data-stu-id="1b770-119">(Right-click on a device.)</span></span>   | <span data-ttu-id="1b770-120">(No disponible)</span><span class="sxs-lookup"><span data-stu-id="1b770-120">(N/A)</span></span>                                                                                                    |
| <span data-ttu-id="1b770-121">**WPDContextMenu. Storage**</span><span class="sxs-lookup"><span data-stu-id="1b770-121">**WPDContextMenu.Storage**</span></span>             | <span data-ttu-id="1b770-122">Al registrarse en esta clave, se habilita el controlador de menú contextual en el nivel de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="1b770-122">Registering under this key enables your context menu handler at the storage level.</span></span> <span data-ttu-id="1b770-123">(Haga clic con el botón derecho en un almacenamiento).</span><span class="sxs-lookup"><span data-stu-id="1b770-123">(Right-click on a storage.)</span></span> | <span data-ttu-id="1b770-124">(No disponible)</span><span class="sxs-lookup"><span data-stu-id="1b770-124">(N/A)</span></span>                                                                                                    |
| <span data-ttu-id="1b770-125">**WPDContextMenu. carpeta**</span><span class="sxs-lookup"><span data-stu-id="1b770-125">**WPDContextMenu.Folder**</span></span>              | <span data-ttu-id="1b770-126">\_carpeta de \_ tipo de contenido de WPD \_</span><span class="sxs-lookup"><span data-stu-id="1b770-126">WPD\_CONTENT\_TYPE\_FOLDER</span></span>                                                                                     | <span data-ttu-id="1b770-127">(No disponible)</span><span class="sxs-lookup"><span data-stu-id="1b770-127">(N/A)</span></span>                                                                                                    |
| <span data-ttu-id="1b770-128">**WPDContextMenu. Image**</span><span class="sxs-lookup"><span data-stu-id="1b770-128">**WPDContextMenu.Image**</span></span>               | <span data-ttu-id="1b770-129">\_imagen de \_ tipo de contenido de WPD \_</span><span class="sxs-lookup"><span data-stu-id="1b770-129">WPD\_CONTENT\_TYPE\_IMAGE</span></span>                                                                                      | <span data-ttu-id="1b770-130">.bmp</span><span class="sxs-lookup"><span data-stu-id="1b770-130">.bmp</span></span> <br/> <span data-ttu-id="1b770-131">.gif</span><span class="sxs-lookup"><span data-stu-id="1b770-131">.gif</span></span> <br/> <span data-ttu-id="1b770-132">.png</span><span class="sxs-lookup"><span data-stu-id="1b770-132">.png</span></span> <br/> <span data-ttu-id="1b770-133">.jpg</span><span class="sxs-lookup"><span data-stu-id="1b770-133">.jpg</span></span> <br/> <span data-ttu-id="1b770-134">.jpe</span><span class="sxs-lookup"><span data-stu-id="1b770-134">.jpe</span></span> <br/> <span data-ttu-id="1b770-135">.jpeg</span><span class="sxs-lookup"><span data-stu-id="1b770-135">.jpeg</span></span> <br/>   |
| <span data-ttu-id="1b770-136">**WPDContextMenu. audio**</span><span class="sxs-lookup"><span data-stu-id="1b770-136">**WPDContextMenu.Audio**</span></span>               | <span data-ttu-id="1b770-137">tipo de contenido de WPD ( \_ \_ \_ audio)</span><span class="sxs-lookup"><span data-stu-id="1b770-137">WPD\_CONTENT\_TYPE\_AUDIO</span></span>                                                                                      | <span data-ttu-id="1b770-138">.aiff</span><span class="sxs-lookup"><span data-stu-id="1b770-138">.aiff</span></span> <br/> <span data-ttu-id="1b770-139">.mp3</span><span class="sxs-lookup"><span data-stu-id="1b770-139">.mp3</span></span> <br/> <span data-ttu-id="1b770-140">.wav</span><span class="sxs-lookup"><span data-stu-id="1b770-140">.wav</span></span> <br/> <span data-ttu-id="1b770-141">.wma</span><span class="sxs-lookup"><span data-stu-id="1b770-141">.wma</span></span> <br/>                                     |
| <span data-ttu-id="1b770-142">**WPDContextMenu. vídeo**</span><span class="sxs-lookup"><span data-stu-id="1b770-142">**WPDContextMenu.Video**</span></span>               | <span data-ttu-id="1b770-143">vídeo sobre el tipo de contenido de WPD \_ \_ \_</span><span class="sxs-lookup"><span data-stu-id="1b770-143">WPD\_CONTENT\_TYPE\_VIDEO</span></span>                                                                                      | <span data-ttu-id="1b770-144">.asf</span><span class="sxs-lookup"><span data-stu-id="1b770-144">.asf</span></span><br/> <span data-ttu-id="1b770-145">.avi</span><span class="sxs-lookup"><span data-stu-id="1b770-145">.avi</span></span> <br/> <span data-ttu-id="1b770-146">. DVR-MS</span><span class="sxs-lookup"><span data-stu-id="1b770-146">.dvr-ms</span></span> <br/> <span data-ttu-id="1b770-147">. MPEG</span><span class="sxs-lookup"><span data-stu-id="1b770-147">.mpeg</span></span> <br/> <span data-ttu-id="1b770-148">.mpg</span><span class="sxs-lookup"><span data-stu-id="1b770-148">.mpg</span></span> <br/> <span data-ttu-id="1b770-149">.wmv</span><span class="sxs-lookup"><span data-stu-id="1b770-149">.wmv</span></span> <br/> |
| <span data-ttu-id="1b770-150">**WPDContextMenu. Playlist**</span><span class="sxs-lookup"><span data-stu-id="1b770-150">**WPDContextMenu.Playlist**</span></span><br/> | <span data-ttu-id="1b770-151">\_lista de \_ reproducción de tipo de contenido de WPD \_</span><span class="sxs-lookup"><span data-stu-id="1b770-151">WPD\_CONTENT\_TYPE\_PLAYLIST</span></span>                                                                                   | <span data-ttu-id="1b770-152">. wpl</span><span class="sxs-lookup"><span data-stu-id="1b770-152">.wpl</span></span> <br/> <span data-ttu-id="1b770-153">.m3u</span><span class="sxs-lookup"><span data-stu-id="1b770-153">.m3u</span></span> <br/> <span data-ttu-id="1b770-154">.mpl</span><span class="sxs-lookup"><span data-stu-id="1b770-154">.mpl</span></span> <br/> <span data-ttu-id="1b770-155">.asx</span><span class="sxs-lookup"><span data-stu-id="1b770-155">.asx</span></span> <br/> <span data-ttu-id="1b770-156">. esperen</span><span class="sxs-lookup"><span data-stu-id="1b770-156">.pls</span></span> <br/>                     |
| <span data-ttu-id="1b770-157">**WPDContextMenu.Document**</span><span class="sxs-lookup"><span data-stu-id="1b770-157">**WPDContextMenu.Document**</span></span>            | <span data-ttu-id="1b770-158">\_documento de \_ tipo de contenido de WPD \_</span><span class="sxs-lookup"><span data-stu-id="1b770-158">WPD\_CONTENT\_TYPE\_DOCUMENT</span></span>                                                                                   | <span data-ttu-id="1b770-159">.doc</span><span class="sxs-lookup"><span data-stu-id="1b770-159">.doc</span></span> <br/> <span data-ttu-id="1b770-160">.txt</span><span class="sxs-lookup"><span data-stu-id="1b770-160">.txt</span></span> <br/> <span data-ttu-id="1b770-161">.rtf</span><span class="sxs-lookup"><span data-stu-id="1b770-161">.rtf</span></span> <br/> <span data-ttu-id="1b770-162">.xls</span><span class="sxs-lookup"><span data-stu-id="1b770-162">.xls</span></span> <br/> <span data-ttu-id="1b770-163">.ppt</span><span class="sxs-lookup"><span data-stu-id="1b770-163">.ppt</span></span> <br/>                     |
| <span data-ttu-id="1b770-164">**WPDContextMenu. contact**</span><span class="sxs-lookup"><span data-stu-id="1b770-164">**WPDContextMenu.Contact**</span></span><br/>  | <span data-ttu-id="1b770-165">\_contacto del \_ tipo de contenido de WPD \_</span><span class="sxs-lookup"><span data-stu-id="1b770-165">WPD\_CONTENT\_TYPE\_CONTACT</span></span>                                                                                    | <span data-ttu-id="1b770-166">None</span><span class="sxs-lookup"><span data-stu-id="1b770-166">None</span></span>                                                                                                     |
| <span data-ttu-id="1b770-167">**WPDContextMenu.Email**</span><span class="sxs-lookup"><span data-stu-id="1b770-167">**WPDContextMenu.Email**</span></span>               | <span data-ttu-id="1b770-168">\_ \_ correo electrónico de tipo de contenido de WPD \_</span><span class="sxs-lookup"><span data-stu-id="1b770-168">WPD\_CONTENT\_TYPE\_EMAIL</span></span>                                                                                      | <span data-ttu-id="1b770-169">None</span><span class="sxs-lookup"><span data-stu-id="1b770-169">None</span></span>                                                                                                     |
| <span data-ttu-id="1b770-170">**WPDContextMenu. appointment**</span><span class="sxs-lookup"><span data-stu-id="1b770-170">**WPDContextMenu.Appointment**</span></span>         | <span data-ttu-id="1b770-171">\_cita de \_ tipo de contenido de WPD \_</span><span class="sxs-lookup"><span data-stu-id="1b770-171">WPD\_CONTENT\_TYPE\_APPOINTMENT</span></span>                                                                                | <span data-ttu-id="1b770-172">None</span><span class="sxs-lookup"><span data-stu-id="1b770-172">None</span></span>                                                                                                     |
| <span data-ttu-id="1b770-173">**WPDContextMenu. Task**</span><span class="sxs-lookup"><span data-stu-id="1b770-173">**WPDContextMenu.Task**</span></span>                | <span data-ttu-id="1b770-174">tipo de contenido de WPD, \_ \_ \_ tarea</span><span class="sxs-lookup"><span data-stu-id="1b770-174">WPD\_CONTENT\_TYPE\_TASK</span></span>                                                                                       | <span data-ttu-id="1b770-175">None</span><span class="sxs-lookup"><span data-stu-id="1b770-175">None</span></span>                                                                                                     |
| <span data-ttu-id="1b770-176">**WPDContextMenu. Memo**</span><span class="sxs-lookup"><span data-stu-id="1b770-176">**WPDContextMenu.Memo**</span></span>                | <span data-ttu-id="1b770-177">tipo de contenido de WPD, \_ \_ \_ memorando</span><span class="sxs-lookup"><span data-stu-id="1b770-177">WPD\_CONTENT\_TYPE\_MEMO</span></span>                                                                                       | <span data-ttu-id="1b770-178">None</span><span class="sxs-lookup"><span data-stu-id="1b770-178">None</span></span>                                                                                                     |
| <span data-ttu-id="1b770-179">**WPDContextMenu.ImageAlbum**</span><span class="sxs-lookup"><span data-stu-id="1b770-179">**WPDContextMenu.ImageAlbum**</span></span>          | <span data-ttu-id="1b770-180">\_álbum de \_ imagen del tipo de contenido de WPD \_ \_</span><span class="sxs-lookup"><span data-stu-id="1b770-180">WPD\_CONTENT\_TYPE\_IMAGE\_ALBUM</span></span>                                                                               | <span data-ttu-id="1b770-181">None</span><span class="sxs-lookup"><span data-stu-id="1b770-181">None</span></span>                                                                                                     |
| <span data-ttu-id="1b770-182">**WPDContextMenu.AudioAlbum**</span><span class="sxs-lookup"><span data-stu-id="1b770-182">**WPDContextMenu.AudioAlbum**</span></span>          | <span data-ttu-id="1b770-183">tipo de contenido de WPD \_ \_ \_ álbum de audio \_</span><span class="sxs-lookup"><span data-stu-id="1b770-183">WPD\_CONTENT\_TYPE\_AUDIO\_ALBUM</span></span>                                                                               | <span data-ttu-id="1b770-184">None</span><span class="sxs-lookup"><span data-stu-id="1b770-184">None</span></span>                                                                                                     |
| <span data-ttu-id="1b770-185">**WPDContextMenu. videoalbum**</span><span class="sxs-lookup"><span data-stu-id="1b770-185">**WPDContextMenu.VideoAlbum**</span></span>          | <span data-ttu-id="1b770-186">tipo de contenido de WPD \_ \_ \_ álbum de vídeo \_</span><span class="sxs-lookup"><span data-stu-id="1b770-186">WPD\_CONTENT\_TYPE\_VIDEO\_ALBUM</span></span>                                                                               | <span data-ttu-id="1b770-187">None</span><span class="sxs-lookup"><span data-stu-id="1b770-187">None</span></span>                                                                                                     |
| <span data-ttu-id="1b770-188">**WPDContextMenu.MixedAlbum**</span><span class="sxs-lookup"><span data-stu-id="1b770-188">**WPDContextMenu.MixedAlbum**</span></span>          | <span data-ttu-id="1b770-189">\_álbum de \_ \_ contenido mixto \_ de tipo de contenido de \_ WPD</span><span class="sxs-lookup"><span data-stu-id="1b770-189">WPD\_CONTENT\_TYPE\_MIXED\_CONTENT\_ALBUM</span></span>                                                                      | <span data-ttu-id="1b770-190">None</span><span class="sxs-lookup"><span data-stu-id="1b770-190">None</span></span>                                                                                                     |
| <span data-ttu-id="1b770-191">**WPDContextMenu. Generic**</span><span class="sxs-lookup"><span data-stu-id="1b770-191">**WPDContextMenu.Generic**</span></span>             | <span data-ttu-id="1b770-192">tipo de contenido de WPD no \_ \_ \_ especificado</span><span class="sxs-lookup"><span data-stu-id="1b770-192">WPD\_CONTENT\_TYPE\_UNSPECIFIED</span></span>                                                                                | <span data-ttu-id="1b770-193">Todas las demás extensiones de archivo</span><span class="sxs-lookup"><span data-stu-id="1b770-193">All other file extensions</span></span>                                                                                |



 

 

 




