---
description: Es posible que una aplicación de copia de seguridad (solicitante) finalice y no genere un evento BackupComplete.
ms.assetid: 8e6a1f4f-ba62-46ea-965e-b0c6526ece89
title: Controlar eventos BackupShutdown
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 939e8e64ca9ee463b0b8331e607f8068c3325d5c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "105697012"
---
# <a name="handling-backupshutdown-events"></a><span data-ttu-id="d2aa5-103">Controlar eventos BackupShutdown</span><span class="sxs-lookup"><span data-stu-id="d2aa5-103">Handling BackupShutdown Events</span></span>

<span data-ttu-id="d2aa5-104">Es posible que una aplicación de copia de seguridad (solicitante) finalice y no genere un evento [*BackupComplete*](vssgloss-b.md) .</span><span class="sxs-lookup"><span data-stu-id="d2aa5-104">It is possible for a backup application (requester) to terminate and not generate a [*BackupComplete*](vssgloss-b.md) event.</span></span> <span data-ttu-id="d2aa5-105">La aplicación de copia de seguridad podría bloquearse o terminarse (desde el administrador de tareas, por ejemplo) y no poder llamar a [**IVssBackupComponents:: BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete).</span><span class="sxs-lookup"><span data-stu-id="d2aa5-105">The backup application could crash, or be terminated (from the Task Manager, for example) and not be able to call [**IVssBackupComponents::BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete).</span></span>

<span data-ttu-id="d2aa5-106">Por lo tanto, la infraestructura de VSS (en lugar del solicitante) genera un evento [*BackupShutdown*](vssgloss-b.md) cada vez que se libera una instancia de [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) que participa en una copia de seguridad, ya sea publicada por el solicitante o por el sistema.</span><span class="sxs-lookup"><span data-stu-id="d2aa5-106">Therefore, the VSS infrastructure (rather than the requester) generates a [*BackupShutdown*](vssgloss-b.md) event whenever an instance of [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) participating in a backup is released, whether it is released by the requester or by the system.</span></span>

<span data-ttu-id="d2aa5-107">Si una copia de seguridad se realiza correctamente, un escritor recibirá un evento BackupComplete seguido de un evento BackupShutdown.</span><span class="sxs-lookup"><span data-stu-id="d2aa5-107">If a backup proceeds properly, a writer will receive a BackupComplete event followed by a BackupShutdown event.</span></span>

<span data-ttu-id="d2aa5-108">Si la operación se anula (el solicitante genera un [*evento de anulación*](vssgloss-a.md) mediante una llamada a [**IVssBackupComponents:: AbortBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-abortbackup)) o produce un error repentinamente, es posible que un escritor solo reciba un evento BackupShutdown y que no reciba otros eventos que realicen operaciones de limpieza.</span><span class="sxs-lookup"><span data-stu-id="d2aa5-108">If the operation aborts (the requester generates an [*Abort event*](vssgloss-a.md) by calling [**IVssBackupComponents::AbortBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-abortbackup)) or fails abruptly, a writer may receive only a BackupShutdown event, and it may not receive other events that perform cleanup operations.</span></span> <span data-ttu-id="d2aa5-109">Es un escritor el que determina si un evento BackupShutdown sigue una secuencia de eventos adecuada o representa un error inesperado de las operaciones de copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="d2aa5-109">It is up to a writer to determine whether a BackupShutdown event follows a proper sequence of events, or represents an unexpected failure of the backup operations.</span></span>

<span data-ttu-id="d2aa5-110">El controlador de eventos BackupShutdown, [**CVssWriter:: OnBackupShutdown**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onbackupshutdown), recibe el \_ identificador de VSS (GUID) del conjunto de instantáneas de la operación de copia de seguridad que se está cerrando.</span><span class="sxs-lookup"><span data-stu-id="d2aa5-110">The BackupShutdown event handler, [**CVssWriter::OnBackupShutdown**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onbackupshutdown), receives the VSS\_ID (GUID) of the shadow copy set of the backup operation being shut down.</span></span> <span data-ttu-id="d2aa5-111">El escritor puede usarlo para determinar qué operación de copia de seguridad se está cerrando, si ha almacenado el identificador del conjunto de instantáneas durante su secuencia de copia de seguridad (por ejemplo, desde dentro de [**CVssWriter:: alfreeze**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onfreeze), [**CVssWriter::**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onthaw)UpDown o [**CVssWriter:: OnPostSnapshot**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostsnapshot)) mediante [**CVssWriter:: GetCurrentSnapshotSetId**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getcurrentsnapshotsetid).</span><span class="sxs-lookup"><span data-stu-id="d2aa5-111">The writer can use this to determine which backup operation is being shut down, if it has stored the shadow copy set ID during its backup sequence (for example, from within [**CVssWriter::OnFreeze**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onfreeze), [**CVssWriter::OnThaw**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onthaw), or [**CVssWriter::OnPostSnapshot**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostsnapshot)) by using [**CVssWriter::GetCurrentSnapshotSetId**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getcurrentsnapshotsetid).</span></span>

<span data-ttu-id="d2aa5-112">Sin embargo, un escritor no debe llamar a [**CVssWriter:: GetCurrentSnapshotSetId**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getcurrentsnapshotsetid) desde [**CVssWriter:: OnBackupShutdown**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onbackupshutdown).</span><span class="sxs-lookup"><span data-stu-id="d2aa5-112">However, a writer should not call [**CVssWriter::GetCurrentSnapshotSetId**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getcurrentsnapshotsetid) from within [**CVssWriter::OnBackupShutdown**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onbackupshutdown).</span></span> <span data-ttu-id="d2aa5-113">Además, no se puede llamar a **CVssWriter:: GetCurrentSnapshotSetId** después de que [**CVssWriter:: OnPostSnapshot**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostsnapshot) devuelva.</span><span class="sxs-lookup"><span data-stu-id="d2aa5-113">Also, **CVssWriter::GetCurrentSnapshotSetId** cannot be called after [**CVssWriter::OnPostSnapshot**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostsnapshot) returns.</span></span>

<span data-ttu-id="d2aa5-114">Es posible que el escritor esté implicado en varias operaciones de copia de seguridad y, si se llama a un evento BackupShutdown debido a un apagado brusco de un solicitante, el \_ ID. de VSS devuelto podría ser el de otra operación de copia de seguridad en la que estaba participando el escritor.</span><span class="sxs-lookup"><span data-stu-id="d2aa5-114">It is possible for the writer to be involved in multiple backup operations, and if a BackupShutdown event is called because of an abrupt shutdown of a requester, the VSS\_ID returned could be that of another backup operation the writer was participating in.</span></span>

 

 



