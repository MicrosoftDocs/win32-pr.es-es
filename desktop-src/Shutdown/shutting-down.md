---
description: 'Hay tres maneras de que una aplicación cierre los equipos locales o remotos: Apague el sistema y reinicie itshut la aplicación, apague y reinicie el sistema y reinicie las aplicaciones que se han registrado para reiniciarse.'
ms.assetid: acadf58f-3f68-4fa1-bdcf-8f85c8479263
title: Apagar
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e436dd9e3b115112e63b0440b4d51de4c7f9f619
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "105668453"
---
# <a name="shutting-down"></a><span data-ttu-id="13490-103">Apagar</span><span class="sxs-lookup"><span data-stu-id="13490-103">Shutting Down</span></span>

<span data-ttu-id="13490-104">Hay tres maneras de que una aplicación cierre los equipos locales o remotos:</span><span class="sxs-lookup"><span data-stu-id="13490-104">There are three ways for an application to shut down local or remote computers:</span></span>

-   <span data-ttu-id="13490-105">Apagar el sistema</span><span class="sxs-lookup"><span data-stu-id="13490-105">shut down the system</span></span>
-   <span data-ttu-id="13490-106">Apagar el sistema y reiniciarlo</span><span class="sxs-lookup"><span data-stu-id="13490-106">shut down the system and restart it</span></span>
-   <span data-ttu-id="13490-107">cierre la aplicación, apague y reinicie el sistema y reinicie las aplicaciones que se han registrado para reiniciarse.</span><span class="sxs-lookup"><span data-stu-id="13490-107">shut down the application, shut down and restart the system, and restart any applications that have been registered for restart</span></span>

<span data-ttu-id="13490-108">Para apagar el sistema, use la función [**ExitWindowsEx**](/windows/desktop/api/Winuser/nf-winuser-exitwindowsex) con la marca de \_ cierre EWX.</span><span class="sxs-lookup"><span data-stu-id="13490-108">To shut down the system, use the [**ExitWindowsEx**](/windows/desktop/api/Winuser/nf-winuser-exitwindowsex) function with the EWX\_SHUTDOWN flag.</span></span> <span data-ttu-id="13490-109">Para obtener un ejemplo, vea [Cómo apagar el sistema](how-to-shut-down-the-system.md).</span><span class="sxs-lookup"><span data-stu-id="13490-109">For an example, see [How to Shut Down the System](how-to-shut-down-the-system.md).</span></span> <span data-ttu-id="13490-110">Para apagar y reiniciar el sistema, use la marca de \_ REinicio de EWX.</span><span class="sxs-lookup"><span data-stu-id="13490-110">To shut down and restart the system, use the EWX\_REBOOT flag.</span></span> <span data-ttu-id="13490-111">Para reiniciar las aplicaciones que se han registrado para el reinicio mediante la función [**RegisterApplicationRestart**](/windows/win32/api/winbase/nf-winbase-registerapplicationrestart) , use la \_ marca RESTARTAPPS de EXW.</span><span class="sxs-lookup"><span data-stu-id="13490-111">To restart any applications that have been registered for restart using the [**RegisterApplicationRestart**](/windows/win32/api/winbase/nf-winbase-registerapplicationrestart) function, use the EXW\_RESTARTAPPS flag.</span></span>

<span data-ttu-id="13490-112">Las funciones [**InitiateShutdown**](/windows/desktop/api/Winreg/nf-winreg-initiateshutdowna), [**InitiateSystemShutdown**](/windows/desktop/api/Winreg/nf-winreg-initiatesystemshutdowna)y [**InitiateSystemShutdownEx**](/windows/desktop/api/Winreg/nf-winreg-initiatesystemshutdownexa) inician un temporizador y muestran un cuadro de diálogo que pide al usuario que cierre la sesión.</span><span class="sxs-lookup"><span data-stu-id="13490-112">The [**InitiateShutdown**](/windows/desktop/api/Winreg/nf-winreg-initiateshutdowna), [**InitiateSystemShutdown**](/windows/desktop/api/Winreg/nf-winreg-initiatesystemshutdowna), and [**InitiateSystemShutdownEx**](/windows/desktop/api/Winreg/nf-winreg-initiatesystemshutdownexa) functions start a timer and display a dialog box that prompts the user to log off.</span></span> <span data-ttu-id="13490-113">Mientras se muestra este cuadro de diálogo, la función [**AbortSystemShutdown**](/windows/desktop/api/Winreg/nf-winreg-abortsystemshutdowna) puede detener el temporizador y evitar que el equipo se apague.</span><span class="sxs-lookup"><span data-stu-id="13490-113">While this dialog box is displayed, the [**AbortSystemShutdown**](/windows/desktop/api/Winreg/nf-winreg-abortsystemshutdowna) function can stop the timer and prevent the computer from shutting down.</span></span> <span data-ttu-id="13490-114">Sin embargo, si el temporizador expira, el equipo se apaga.</span><span class="sxs-lookup"><span data-stu-id="13490-114">However, if the timer expires, the computer is shut down.</span></span> <span data-ttu-id="13490-115">Estas funciones también pueden reiniciar el equipo después de una operación de cierre.</span><span class="sxs-lookup"><span data-stu-id="13490-115">These functions can also restart the computer following a shutdown operation.</span></span> <span data-ttu-id="13490-116">Para obtener más información, vea [Mostrar el cuadro de diálogo de apagado](displaying-the-shutdown-dialog-box.md).</span><span class="sxs-lookup"><span data-stu-id="13490-116">For more information, see [Displaying the Shutdown Dialog Box](displaying-the-shutdown-dialog-box.md).</span></span>

## <a name="shutdown-notifications"></a><span data-ttu-id="13490-117">Notificaciones de apagado</span><span class="sxs-lookup"><span data-stu-id="13490-117">Shutdown Notifications</span></span>

<span data-ttu-id="13490-118">Las aplicaciones con una ventana y una cola de mensajes reciben notificaciones de cierre a través de los mensajes [**WM \_ QUERYENDSESSION**](wm-queryendsession.md) y [**WM \_ ENDSESSION**](wm-endsession.md) .</span><span class="sxs-lookup"><span data-stu-id="13490-118">Applications with a window and message queue receive shutdown notifications through the [**WM\_QUERYENDSESSION**](wm-queryendsession.md) and [**WM\_ENDSESSION**](wm-endsession.md) messages.</span></span> <span data-ttu-id="13490-119">Estas aplicaciones deben devolver **true** para indicar que se pueden terminar.</span><span class="sxs-lookup"><span data-stu-id="13490-119">These applications should return **TRUE** to indicate that they can be terminated.</span></span> <span data-ttu-id="13490-120">Las aplicaciones no deben bloquear el cierre del sistema a menos que sea absolutamente necesario.</span><span class="sxs-lookup"><span data-stu-id="13490-120">Applications should not block system shutdown unless it is absolutely necessary.</span></span> <span data-ttu-id="13490-121">Las aplicaciones deben realizar cualquier limpieza necesaria mientras se procesa **WM \_ ENDSESSION**.</span><span class="sxs-lookup"><span data-stu-id="13490-121">Applications should perform any required cleanup while processing **WM\_ENDSESSION**.</span></span> <span data-ttu-id="13490-122">Las aplicaciones que tienen datos no guardados pueden guardar los datos en una ubicación temporal y restaurarlos la próxima vez que se inicie la aplicación.</span><span class="sxs-lookup"><span data-stu-id="13490-122">Applications that have unsaved data could save the data to a temporary location and restore it the next time the application starts.</span></span> <span data-ttu-id="13490-123">Se recomienda que las aplicaciones guarden los datos y el estado con frecuencia. por ejemplo, guarde automáticamente los datos entre las operaciones de guardado iniciadas por el usuario para reducir la cantidad de datos que se van a guardar en el cierre.</span><span class="sxs-lookup"><span data-stu-id="13490-123">It is recommended that applications save their data and state frequently; for example, automatically save data between save operations initiated by the user to reduce the amount of data to be saved at shutdown.</span></span>

<span data-ttu-id="13490-124">Las aplicaciones de consola reciben notificaciones de cierre en sus rutinas de controlador.</span><span class="sxs-lookup"><span data-stu-id="13490-124">Console applications receive shutdown notifications in their handler routines.</span></span> <span data-ttu-id="13490-125">Para registrar un controlador de consola, use la función [**SetConsoleCtrlHandler**](/windows/console/setconsolectrlhandler) .</span><span class="sxs-lookup"><span data-stu-id="13490-125">To register a console handler, use the [**SetConsoleCtrlHandler**](/windows/console/setconsolectrlhandler) function.</span></span>

<span data-ttu-id="13490-126">Las aplicaciones de servicio reciben notificaciones de cierre en sus rutinas de controlador.</span><span class="sxs-lookup"><span data-stu-id="13490-126">Service applications receive shutdown notifications in their handler routines.</span></span> <span data-ttu-id="13490-127">Para registrar un controlador de control de servicio, utilice la función [**RegisterServiceCtrlHandlerEx**](/windows/win32/api/winsvc/nf-winsvc-registerservicectrlhandlerexa) .</span><span class="sxs-lookup"><span data-stu-id="13490-127">To register a service control handler, use the [**RegisterServiceCtrlHandlerEx**](/windows/win32/api/winsvc/nf-winsvc-registerservicectrlhandlerexa) function.</span></span>

## <a name="blocking-shutdown"></a><span data-ttu-id="13490-128">Bloqueo de cierre</span><span class="sxs-lookup"><span data-stu-id="13490-128">Blocking Shutdown</span></span>

<span data-ttu-id="13490-129">Si una aplicación debe bloquear un posible cierre del sistema, puede llamar a la función [**ShutdownBlockReasonCreate**](/windows/desktop/api/Winuser/nf-winuser-shutdownblockreasoncreate) .</span><span class="sxs-lookup"><span data-stu-id="13490-129">If an application must block a potential system shutdown, it can call the [**ShutdownBlockReasonCreate**](/windows/desktop/api/Winuser/nf-winuser-shutdownblockreasoncreate) function.</span></span> <span data-ttu-id="13490-130">El autor de la llamada proporciona una cadena de motivo que se mostrará al usuario.</span><span class="sxs-lookup"><span data-stu-id="13490-130">The caller provides a reason string that will be displayed to the user.</span></span> <span data-ttu-id="13490-131">La cadena de motivo debe ser breve y clara, lo que proporciona al usuario la información necesaria para decidir si continuar apagando el sistema.</span><span class="sxs-lookup"><span data-stu-id="13490-131">The reason string should be short and clear, providing the user with the information necessary to decide whether to continue shutting down the system.</span></span>

## <a name="related-topics"></a><span data-ttu-id="13490-132">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="13490-132">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="13490-133">Cómo apagar el sistema</span><span class="sxs-lookup"><span data-stu-id="13490-133">How to Shut Down the System</span></span>](how-to-shut-down-the-system.md)
</dt> </dl>

 

 
