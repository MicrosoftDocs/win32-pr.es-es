---
title: Interfaces de Transferencia de datos
description: Interfaces de Transferencia de datos
ms.assetid: c42e65a4-7b77-4f39-8323-04fa60c5b140
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 448e1a580880c7202ec67d12965f6db7e0be99d0
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/21/2020
ms.locfileid: "105714467"
---
# <a name="data-transfer-interfaces"></a><span data-ttu-id="a3a01-103">Interfaces de Transferencia de datos</span><span class="sxs-lookup"><span data-stu-id="a3a01-103">Data Transfer Interfaces</span></span>

<span data-ttu-id="a3a01-104">La interfaz [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) proporciona a los consumidores de datos métodos para obtener y establecer los datos de un objeto, determinar qué formatos admite el objeto y registrar y recibir notificaciones cuando cambian los datos en el objeto.</span><span class="sxs-lookup"><span data-stu-id="a3a01-104">The [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface provides consumers of data with methods for getting and setting an object's data, determining which formats the object supports, and registering for and receiving notifications when data in the object changes.</span></span> <span data-ttu-id="a3a01-105">Al obtener datos, un llamador puede especificar el formato en el que desea representar los datos.</span><span class="sxs-lookup"><span data-stu-id="a3a01-105">When obtaining data, a caller can specify the format in which it wants to render the data.</span></span> <span data-ttu-id="a3a01-106">El origen de los datos, sin embargo, determina el medio de almacenamiento, que devuelve en un parámetro out proporcionado por el autor de la llamada.</span><span class="sxs-lookup"><span data-stu-id="a3a01-106">The source of the data, however, determines the storage medium, which it returns in an out parameter provided by the caller.</span></span>

<span data-ttu-id="a3a01-107">Por sí solo, [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) proporciona todas las herramientas que necesita para implementar las transferencias del portapapeles de Windows o las transferencias de documentos compuestos en sus aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="a3a01-107">By itself, [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) supplies all the tools you need to implement Windows clipboard transfers or compound document transfers in your applications.</span></span> <span data-ttu-id="a3a01-108">Si también desea admitir las transferencias de arrastrar y colocar, debe implementar las interfaces [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource) e [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget) junto con **IDataObject**.</span><span class="sxs-lookup"><span data-stu-id="a3a01-108">If you also want to support drag and drop transfers, you need to implement the [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource) and [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget) interfaces along with **IDataObject**.</span></span>

<span data-ttu-id="a3a01-109">La interfaz [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) combinada con las API del portapapeles OLE proporciona todas las capacidades de las API del portapapeles de Windows.</span><span class="sxs-lookup"><span data-stu-id="a3a01-109">The [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface combined with OLE clipboard APIs provide all the capabilities of the Windows clipboard APIs.</span></span> <span data-ttu-id="a3a01-110">Por lo general, no es necesario usar ambas API del portapapeles.</span><span class="sxs-lookup"><span data-stu-id="a3a01-110">It is not generally necessary to use both clipboard APIs.</span></span> <span data-ttu-id="a3a01-111">Los proveedores de datos que admiten transferencias de arrastrar y colocar o documentos compuestos OLE deben implementar la interfaz **IDataObject** .</span><span class="sxs-lookup"><span data-stu-id="a3a01-111">Data suppliers that support either drag and drop transfers or OLE compound documents must implement the **IDataObject** interface.</span></span> <span data-ttu-id="a3a01-112">Si la aplicación solo admite las transferencias del portapapeles, pero tiene previsto agregar documentos de arrastrar y colocar o compuestos en versiones posteriores, puede que desee implementar **IDataObject** y las API del portapapeles OLE ahora para minimizar la cantidad de tiempo empleado en la recodificación y depuración más adelante.</span><span class="sxs-lookup"><span data-stu-id="a3a01-112">If your application supports only clipboard transfers now, but you intend to add drag and drop or compound documents in later releases, you may want to implement **IDataObject** and the OLE clipboard APIs now in order to minimize the amount of time spent recoding and debugging later.</span></span> <span data-ttu-id="a3a01-113">También puede implementar **IDataObject** para usar medios de transferencia distintos de la memoria global.</span><span class="sxs-lookup"><span data-stu-id="a3a01-113">You may also want to implement **IDataObject** in order to utilize transfer media other than global memory.</span></span>

<span data-ttu-id="a3a01-114">En la tabla siguiente se resumen las opciones que se deben usar, en función de los tipos de transferencia de datos que desee admitir:</span><span class="sxs-lookup"><span data-stu-id="a3a01-114">The following table summarizes which ones to use, depending on what types of data transfer you want to support:</span></span>



| <span data-ttu-id="a3a01-115">Para admitir</span><span class="sxs-lookup"><span data-stu-id="a3a01-115">To support</span></span>                                                                       | <span data-ttu-id="a3a01-116">Use</span><span class="sxs-lookup"><span data-stu-id="a3a01-116">Use</span></span>                                                                                                                                                                         |
|----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="a3a01-117">Documentos compuestos</span><span class="sxs-lookup"><span data-stu-id="a3a01-117">Compound documents</span></span><br/>                                                    | [<span data-ttu-id="a3a01-118">**IDataObject**</span><span class="sxs-lookup"><span data-stu-id="a3a01-118">**IDataObject**</span></span>](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                                                                               |
| <span data-ttu-id="a3a01-119">Arrastrar y colocar transferencias</span><span class="sxs-lookup"><span data-stu-id="a3a01-119">Drag and drop transfers</span></span><br/>                                               | <span data-ttu-id="a3a01-120">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource), [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget), [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) (o el equivalente)</span><span class="sxs-lookup"><span data-stu-id="a3a01-120">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource), [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget), [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) (or the equivalent)</span></span><br/> |
| <span data-ttu-id="a3a01-121">Transferencias del portapapeles mediante la memoria global exclusivamente</span><span class="sxs-lookup"><span data-stu-id="a3a01-121">Clipboard transfers using global memory exclusively</span></span><br/>                   | [<span data-ttu-id="a3a01-122">API del portapapeles</span><span class="sxs-lookup"><span data-stu-id="a3a01-122">Clipboard API</span></span>](../dataxchg/clipboard.md)<br/>                                                                                                                            |
| <span data-ttu-id="a3a01-123">Transferencias del Portapapeles con medios de Exchange distintos de la memoria global.</span><span class="sxs-lookup"><span data-stu-id="a3a01-123">Clipboard transfers using exchange mediums other than global memory.</span></span><br/>  | [<span data-ttu-id="a3a01-124">**IDataObject**</span><span class="sxs-lookup"><span data-stu-id="a3a01-124">**IDataObject**</span></span>](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                                                                               |
| <span data-ttu-id="a3a01-125">El portapapeles transfiere ahora, pero arrastra y coloca o documentos compuestos posteriormente</span><span class="sxs-lookup"><span data-stu-id="a3a01-125">Clipboard transfers now but drag and drop or compound documents later</span></span><br/> | <span data-ttu-id="a3a01-126">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) y las interfaces y funciones enumeradas anteriormente para "arrastrar y colocar transferencias"</span><span class="sxs-lookup"><span data-stu-id="a3a01-126">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) and the interfaces and function listed above for "Drag and drop transfers"</span></span><br/>                                                    |



 

<span data-ttu-id="a3a01-127">Cuando un usuario inicia una operación de transferencia de datos, la aplicación de origen crea una instancia de [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) y, a su vez, hace que los datos estén disponibles en uno o varios formatos.</span><span class="sxs-lookup"><span data-stu-id="a3a01-127">When a user initiates a data transfer operation, the source application creates an instance of [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) and through it makes the data available in one or more formats.</span></span> <span data-ttu-id="a3a01-128">En una transferencia del portapapeles, la aplicación llama a la función [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) para pasar un puntero de objeto de datos a OLE.</span><span class="sxs-lookup"><span data-stu-id="a3a01-128">In a clipboard transfer, the application calls the [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) function to pass a data-object pointer to OLE.</span></span> <span data-ttu-id="a3a01-129">(**OleSetClipboard** también ofrece formatos de datos de Portapapeles estándar para las aplicaciones OLE versión 1 y las que no son OLE). En una transferencia de arrastrar y colocar, la aplicación llama a la función [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) en su lugar.</span><span class="sxs-lookup"><span data-stu-id="a3a01-129">(**OleSetClipboard** also offers standard clipboard data formats for both OLE version 1 and non-OLE applications.) In a drag and drop transfer, the application calls the [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) function instead.</span></span>

<span data-ttu-id="a3a01-130">En el lado receptor de la transferencia, el destino recibe el puntero [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) como argumento para una invocación de [**IDropTarget::D ROP**](/windows/desktop/api/OleIdl/nf-oleidl-idroptarget-drop) o llamando a la función [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) , dependiendo de si la transferencia es por medio de arrastrar y colocar o del portapapeles.</span><span class="sxs-lookup"><span data-stu-id="a3a01-130">On the receiving side of the transfer, the destination receives the [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) pointer either as an argument to an invocation of [**IDropTarget::Drop**](/windows/desktop/api/OleIdl/nf-oleidl-idroptarget-drop) or by calling the [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) function, depending on whether the transfer is by means of drag and drop or the clipboard.</span></span> <span data-ttu-id="a3a01-131">Tras obtener este puntero, el destino llama a [**IDataObject:: del EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc) para obtener información sobre los formatos que están disponibles para la recuperación y los tipos de medios que se pueden obtener.</span><span class="sxs-lookup"><span data-stu-id="a3a01-131">Having obtained this pointer, the destination calls [**IDataObject::EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc) to learn what formats are available for retrieval and on what types of media they can be obtained.</span></span> <span data-ttu-id="a3a01-132">Con esta información, la aplicación receptora solicita los datos con una llamada a [**IDataObject:: GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata).</span><span class="sxs-lookup"><span data-stu-id="a3a01-132">Armed with this information, the receiving application requests the data with a call to [**IDataObject::GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata).</span></span>

## <a name="related-topics"></a><span data-ttu-id="a3a01-133">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="a3a01-133">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a3a01-134">Transferencia de datos</span><span class="sxs-lookup"><span data-stu-id="a3a01-134">Data Transfer</span></span>](data-transfer.md)
</dt> </dl>

 

