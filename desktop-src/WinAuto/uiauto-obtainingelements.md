---
title: Obtener elementos de UI Automation
description: En este tema se describen varias maneras de obtener interfaces de IUIAutomationElement para los elementos de la interfaz de usuario.
ms.assetid: 8675851a-4a72-4cbe-ab71-ed6fc891be17
keywords:
- clientes, obtener elementos de UI Automation
- clientes, elementos de UI Automation
- clientes, elementos raíz
- clientes, ámbito de búsqueda
- Automatización de la interfaz de usuario, obtener elementos
- Automatización de la interfaz de usuario, elementos
- Automatización de la interfaz de usuario, elementos raíz
- Automatización de la interfaz de usuario, condiciones
- Automatización de la interfaz de usuario, ámbito de búsqueda
- obtener elementos de UI Automation
- elementos raíz
- ámbito de búsqueda
ms.topic: article
ms.date: 05/31/2018
ms.custom: project-verbatim
ms.openlocfilehash: a1adbcea5cea81f97350ef15c491b289e07d3ee6
ms.sourcegitcommit: af120ad5c30da2fc5eb717ca2a1c4c45878efd71
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/20/2021
ms.locfileid: "105698466"
---
# <a name="obtaining-ui-automation-elements"></a><span data-ttu-id="413c8-115">Obtener elementos de UI Automation</span><span class="sxs-lookup"><span data-stu-id="413c8-115">Obtaining UI Automation Elements</span></span>

<span data-ttu-id="413c8-116">En este tema se describen varias maneras de obtener interfaces de [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) para los elementos de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="413c8-116">This topic describes various ways to obtain [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interfaces for UI elements.</span></span>

<span data-ttu-id="413c8-117">**IUIAutomationElement** se utiliza en la [aplicación de ejemplo cliente de contenido de documento de UI Automation](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/UIAutomationDocumentClient).</span><span class="sxs-lookup"><span data-stu-id="413c8-117">**IUIAutomationElement** is used in the [UI Automation document content client sample app](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/UIAutomationDocumentClient).</span></span>

## <a name="root-element"></a><span data-ttu-id="413c8-118">Elemento raíz</span><span class="sxs-lookup"><span data-stu-id="413c8-118">Root Element</span></span>

<span data-ttu-id="413c8-119">Aunque los elementos se pueden recuperar directamente mediante métodos, como [**IUIAutomation:: GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement), algunas aplicaciones cliente requieren una vista de la estructura jerárquica de los elementos, lo que se conoce como el árbol de automatización de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="413c8-119">Although elements can be retrieved directly by using methods, such as [**IUIAutomation::GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement), some client applications require a view of the hierarchical structure of elements, known as the UI Automation tree.</span></span> <span data-ttu-id="413c8-120">El elemento raíz de esta jerarquía es el escritorio.</span><span class="sxs-lookup"><span data-stu-id="413c8-120">The root element of this hierarchy is the desktop.</span></span> <span data-ttu-id="413c8-121">Puede obtener este elemento mediante el método [**IUIAutomation:: GetRootElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelement) o el método [**IUIAutomation:: GetRootElementBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelementbuildcache) .</span><span class="sxs-lookup"><span data-stu-id="413c8-121">You can obtain this element by using the [**IUIAutomation::GetRootElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelement) method or the [**IUIAutomation::GetRootElementBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelementbuildcache) method.</span></span> <span data-ttu-id="413c8-122">Ambos métodos recuperan un puntero de la interfaz [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) .</span><span class="sxs-lookup"><span data-stu-id="413c8-122">Both these methods retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface pointer.</span></span> <span data-ttu-id="413c8-123">Puede buscar elementos descendientes mediante métodos, como [**IUIAutomationElement:: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) y [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall).</span><span class="sxs-lookup"><span data-stu-id="413c8-123">You can search for descendant elements by using methods, such as [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) and [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall).</span></span>

> [!Note]  
> <span data-ttu-id="413c8-124">En general, debe intentar obtener solo elementos secundarios directos del elemento raíz.</span><span class="sxs-lookup"><span data-stu-id="413c8-124">In general, you should try to obtain only direct children of the root element.</span></span> <span data-ttu-id="413c8-125">Una búsqueda de descendientes puede iterar a través de cientos o miles de elementos.</span><span class="sxs-lookup"><span data-stu-id="413c8-125">A search for descendants may iterate through hundreds or thousands of elements.</span></span> <span data-ttu-id="413c8-126">Si intenta obtener un elemento concreto en un nivel inferior, debe iniciar la búsqueda desde la ventana de aplicación o desde un contenedor en un nivel inferior.</span><span class="sxs-lookup"><span data-stu-id="413c8-126">If you are attempting to obtain a specific element at a lower level, you should start your search from the application window or from a container at a lower level.</span></span>

 

## <a name="conditions"></a><span data-ttu-id="413c8-127">Condiciones</span><span class="sxs-lookup"><span data-stu-id="413c8-127">Conditions</span></span>

<span data-ttu-id="413c8-128">Para la mayoría de las técnicas que se usan para recuperar elementos de automatización de la interfaz de usuario, debe especificar una condición.</span><span class="sxs-lookup"><span data-stu-id="413c8-128">For most techniques you use to retrieve UI Automation elements, you must specify a condition.</span></span> <span data-ttu-id="413c8-129">Una condición es un conjunto de criterios que define los elementos que desea recuperar.</span><span class="sxs-lookup"><span data-stu-id="413c8-129">A condition is a set of criteria that defines the elements that you want to retrieve.</span></span> <span data-ttu-id="413c8-130">Una condición se representa mediante la interfaz [**IUIAutomationCondition**](/windows/win32/api/uiautomationclient/nn-uiautomationclient-iuiautomationcondition) .</span><span class="sxs-lookup"><span data-stu-id="413c8-130">A condition is represented by the [**IUIAutomationCondition**](/windows/win32/api/uiautomationclient/nn-uiautomationclient-iuiautomationcondition) interface.</span></span>

<span data-ttu-id="413c8-131">La condición más simple es la condición verdadera, que es un objeto predefinido que especifica que se devolverán todos los elementos del ámbito de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="413c8-131">The simplest condition is the true condition, which is a predefined object that specifies that all elements in the search scope are to be returned.</span></span> <span data-ttu-id="413c8-132">La condición falsa es el inverso de la condición verdadera y es menos útil, ya que impediría que se encontrara cualquier elemento.</span><span class="sxs-lookup"><span data-stu-id="413c8-132">The false condition is the inverse of the true condition and is less useful, because it would prevent any elements from being found.</span></span> <span data-ttu-id="413c8-133">Puede obtener una interfaz de la condición verdadera mediante [**IUIAutomation:: CreateTrueCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtruecondition).</span><span class="sxs-lookup"><span data-stu-id="413c8-133">You can obtain an interface to the true condition by using [**IUIAutomation::CreateTrueCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtruecondition).</span></span>

<span data-ttu-id="413c8-134">Otras tres condiciones predefinidas, disponibles como propiedades en el objeto [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) , se pueden usar solos o en combinación con otras condiciones: [**IUIAutomation:: ContentViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewcondition), [**ControlViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_controlviewcondition)y [**RawViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_rawviewcondition).</span><span class="sxs-lookup"><span data-stu-id="413c8-134">Three other predefined conditions, available as properties on the [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) object, can be used alone or in combination with other conditions: [**IUIAutomation::ContentViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewcondition), [**ControlViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_controlviewcondition), and [**RawViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_rawviewcondition).</span></span> <span data-ttu-id="413c8-135">**RawViewCondition**, que se usa por sí solo, es equivalente a la verdadera condición, porque no filtra los elementos por las propiedades [**IUIAutomationElement:: CurrentIsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) o [**CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) .</span><span class="sxs-lookup"><span data-stu-id="413c8-135">**RawViewCondition**, used by itself, is equivalent to the true condition, because it does not filter elements by the [**IUIAutomationElement::CurrentIsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) or [**CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) properties.</span></span>

<span data-ttu-id="413c8-136">Otras condiciones se crean a partir de objetos de condición, cada uno de los cuales especifica un valor de propiedad.</span><span class="sxs-lookup"><span data-stu-id="413c8-136">Other conditions are built from condition objects, each of which specifies a property value.</span></span> <span data-ttu-id="413c8-137">Por ejemplo, una condición de propiedad podría especificar que el elemento está habilitado o que admite un patrón de control determinado.</span><span class="sxs-lookup"><span data-stu-id="413c8-137">For example, a property condition might specify that the element is enabled or that it supports a certain control pattern.</span></span>

<span data-ttu-id="413c8-138">Las condiciones que usan la lógica booleana se pueden combinar llamando a [**IUIAutomation:: CreateAndCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createandcondition), [**CreateOrCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createorcondition), [**CreateNotCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createnotcondition)y métodos relacionados.</span><span class="sxs-lookup"><span data-stu-id="413c8-138">Conditions that use Boolean logic can be combined by calling [**IUIAutomation::CreateAndCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createandcondition), [**CreateOrCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createorcondition), [**CreateNotCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createnotcondition), and related methods.</span></span>

## <a name="search-scope"></a><span data-ttu-id="413c8-139">Ámbito de búsqueda</span><span class="sxs-lookup"><span data-stu-id="413c8-139">Search Scope</span></span>

<span data-ttu-id="413c8-140">Las búsquedas realizadas mediante [**IUIAutomationElement:: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) o [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) deben tener un ámbito y un lugar de inicio.</span><span class="sxs-lookup"><span data-stu-id="413c8-140">Searches that are performed by using [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) or [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) must have a scope and a starting place.</span></span>

> [!Note]  
> <span data-ttu-id="413c8-141">Los comentarios sobre estos dos métodos también se aplican a [**IUIAutomationElement:: FindFirstBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache) y [**FindAllBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findallbuildcache).</span><span class="sxs-lookup"><span data-stu-id="413c8-141">Any commentary about these two methods also applies to [**IUIAutomationElement::FindFirstBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache) and [**FindAllBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findallbuildcache).</span></span>

 

<span data-ttu-id="413c8-142">El ámbito define el espacio alrededor del lugar de inicio en el que se va a buscar.</span><span class="sxs-lookup"><span data-stu-id="413c8-142">The scope defines the space around the starting place that is to be searched.</span></span> <span data-ttu-id="413c8-143">Esto podría incluir el propio elemento, sus elementos relacionados, su elemento primario, sus elementos secundarios inmediatos y sus descendientes.</span><span class="sxs-lookup"><span data-stu-id="413c8-143">This might include the element itself, its siblings, its parent, its immediate children, and its descendants.</span></span> <span data-ttu-id="413c8-144">Tenga en cuenta que los métodos de **búsqueda** no admiten la búsqueda en el árbol de automatización de la interfaz de usuario de Microsoft. es decir, no se admite la búsqueda de elementos antecesores.</span><span class="sxs-lookup"><span data-stu-id="413c8-144">Be aware that the **Find** methods do not support searching up the Microsoft UI Automation tree; that is, searching for ancestor elements is not supported.</span></span>

<span data-ttu-id="413c8-145">El ámbito de una búsqueda se define mediante una combinación bit a bit de los valores del tipo enumerado [**TreeScope**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) .</span><span class="sxs-lookup"><span data-stu-id="413c8-145">The scope of a search is defined by a bitwise combination of values from the [**TreeScope**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) enumerated type.</span></span>

## <a name="finding-a-known-element"></a><span data-ttu-id="413c8-146">Búsqueda de un elemento conocido</span><span class="sxs-lookup"><span data-stu-id="413c8-146">Finding a Known Element</span></span>

<span data-ttu-id="413c8-147">Para buscar un elemento conocido que se identifica mediante el nombre, el ID. de automatización o alguna otra propiedad o combinación de propiedades, es más fácil usar el método [**IUIAutomationElement:: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) .</span><span class="sxs-lookup"><span data-stu-id="413c8-147">To find a known element that is identified by name, automation ID, or some other property or combination of properties, it is easiest to use the [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) method.</span></span> <span data-ttu-id="413c8-148">Si el elemento que se busca es una ventana de la aplicación, el punto inicial de la búsqueda puede ser el elemento raíz.</span><span class="sxs-lookup"><span data-stu-id="413c8-148">If the element sought is an application window, the starting point of the search can be the root element.</span></span>

<span data-ttu-id="413c8-149">Esta forma de buscar elementos de automatización de la interfaz de usuario es muy útil en escenarios de pruebas automatizadas.</span><span class="sxs-lookup"><span data-stu-id="413c8-149">This way of finding UI Automation elements is most useful in automated testing scenarios.</span></span>

<span data-ttu-id="413c8-150">Para obtener un ejemplo de código que muestra cómo buscar un elemento conocido, vea [Buscar un elemento por su nombre](uiauto-howto-find-ui-elements.md).</span><span class="sxs-lookup"><span data-stu-id="413c8-150">For a code example that shows how to find a know element, see [Finding an Element by Name](uiauto-howto-find-ui-elements.md).</span></span>

## <a name="finding-elements-in-a-subtree"></a><span data-ttu-id="413c8-151">Búsqueda de elementos en un subárbol</span><span class="sxs-lookup"><span data-stu-id="413c8-151">Finding Elements in a Subtree</span></span>

<span data-ttu-id="413c8-152">Para buscar todos los elementos que cumplen criterios específicos y que están relacionados con un elemento conocido, puede llamar a [**IUIAutomationElement:: FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) en el elemento conocido.</span><span class="sxs-lookup"><span data-stu-id="413c8-152">To find all elements that meet specific criteria and are related to a known element, you can call [**IUIAutomationElement::FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) on the known element.</span></span> <span data-ttu-id="413c8-153">Por ejemplo, use este método para recuperar elementos de lista o elementos de menú de una lista o un menú, o para identificar todos los controles de un cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="413c8-153">For example, use this method to retrieve list items or menu items from a list or menu, or to identify all controls in a dialog box.</span></span>

<span data-ttu-id="413c8-154">Para obtener un ejemplo de código que muestra cómo buscar elementos en un subárbol, vea [Buscar elementos relacionados](uiauto-howto-find-ui-elements.md).</span><span class="sxs-lookup"><span data-stu-id="413c8-154">For a code example that shows how to find elements in a subtree, see [Finding Related Elements](uiauto-howto-find-ui-elements.md).</span></span>

## <a name="walking-a-subtree"></a><span data-ttu-id="413c8-155">Recorrer un subárbol</span><span class="sxs-lookup"><span data-stu-id="413c8-155">Walking a Subtree</span></span>

<span data-ttu-id="413c8-156">Si no tiene conocimiento previo de las aplicaciones con las que se puede usar el cliente, puede construir un subárbol de todos los elementos de interés mediante [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker).</span><span class="sxs-lookup"><span data-stu-id="413c8-156">If you have no prior knowledge of the applications that your client may be used with, you can construct a subtree of all elements of interest by using [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker).</span></span> <span data-ttu-id="413c8-157">El cliente podría hacer esto, por ejemplo, en respuesta a un evento de cambio de foco. es decir, cuando una aplicación o un control recibe el foco de entrada, el cliente de automatización de la interfaz de usuario examina los elementos secundarios y quizás todos los descendientes del elemento que tiene el foco.</span><span class="sxs-lookup"><span data-stu-id="413c8-157">Your client might do this, for example, in response to a focus-changed event; that is, when an application or control receives input focus, the UI Automation client examines children and perhaps all descendants of the focused element.</span></span>

<span data-ttu-id="413c8-158">Tenga en cuenta que el recorrido del árbol de automatización de la interfaz de usuario consume muchos recursos.</span><span class="sxs-lookup"><span data-stu-id="413c8-158">Be aware that walking the UI Automation tree is resource-intensive.</span></span> <span data-ttu-id="413c8-159">Recorra el árbol solo cuando no sea factible usar los métodos [**IUIAutomationElement:: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst), [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall)o [**BuildUpdatedCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache) .</span><span class="sxs-lookup"><span data-stu-id="413c8-159">Walk the tree only when it is not feasible to use the [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst), [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall), or [**BuildUpdatedCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache) methods.</span></span>

<span data-ttu-id="413c8-160">Puede definir su propio rastreador de árboles pasando una condición personalizada a [**IUIAutomation:: CreateTreeWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtreewalker)o puede usar uno de los siguientes objetos predefinidos que se definen como propiedades de la [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation)base.</span><span class="sxs-lookup"><span data-stu-id="413c8-160">You can define your own tree walker by passing a custom condition to [**IUIAutomation::CreateTreeWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtreewalker), or you can use one of the following predefined objects that are defined as properties of the base [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation).</span></span>



| <span data-ttu-id="413c8-161">Object</span><span class="sxs-lookup"><span data-stu-id="413c8-161">Object</span></span>                                                              | <span data-ttu-id="413c8-162">Propósito</span><span class="sxs-lookup"><span data-stu-id="413c8-162">Purpose</span></span>                                                                                                                                                      |
|---------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="413c8-163">**ContentViewWalker**</span><span class="sxs-lookup"><span data-stu-id="413c8-163">**ContentViewWalker**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewwalker) | <span data-ttu-id="413c8-164">Busca solo los elementos cuya propiedad [**IUIAutomationElement:: CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) es **true**.</span><span class="sxs-lookup"><span data-stu-id="413c8-164">Finds only elements whose [**IUIAutomationElement::CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) property is **TRUE**.</span></span> |
| [<span data-ttu-id="413c8-165">**ControlViewWalker**</span><span class="sxs-lookup"><span data-stu-id="413c8-165">**ControlViewWalker**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_controlviewwalker) | <span data-ttu-id="413c8-166">Busca solo los elementos cuya propiedad [**IUIAutomationElement:: CurrentIsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) es **true**.</span><span class="sxs-lookup"><span data-stu-id="413c8-166">Finds only elements whose [**IUIAutomationElement::CurrentIsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) property is **TRUE**.</span></span> |
| [<span data-ttu-id="413c8-167">**RawViewWalker**</span><span class="sxs-lookup"><span data-stu-id="413c8-167">**RawViewWalker**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_rawviewwalker)         | <span data-ttu-id="413c8-168">Busca todos los elementos.</span><span class="sxs-lookup"><span data-stu-id="413c8-168">Finds all elements.</span></span>                                                                                                                                          |



 

<span data-ttu-id="413c8-169">Después de obtener un [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker), llame a los métodos **IUIAutomationTreeWalker:: GetXxx** para navegar por los elementos del subárbol, pasando el elemento desde el que se va a empezar a recorrer.</span><span class="sxs-lookup"><span data-stu-id="413c8-169">After you obtain an [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker), call the **IUIAutomationTreeWalker::GetXxx** methods to navigate elements of the subtree, passing in the element from which to start walking.</span></span>

<span data-ttu-id="413c8-170">El método [**IUIAutomationTreeWalker:: Normalize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-normalizeelement) se puede usar para desplazarse a un elemento del subárbol desde otro elemento que no forma parte de la vista.</span><span class="sxs-lookup"><span data-stu-id="413c8-170">The [**IUIAutomationTreeWalker::Normalize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-normalizeelement) method can be used for navigating to an element in the subtree from another element that is not part of the view.</span></span> <span data-ttu-id="413c8-171">Por ejemplo, supongamos que crea una vista de un subárbol mediante [**IUIAutomation:: ContentViewWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewwalker).</span><span class="sxs-lookup"><span data-stu-id="413c8-171">For example, suppose you create a view of a subtree by using [**IUIAutomation::ContentViewWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewwalker).</span></span> <span data-ttu-id="413c8-172">La aplicación recibe la notificación de que una barra de desplazamiento ha recibido el foco de entrada.</span><span class="sxs-lookup"><span data-stu-id="413c8-172">Your application receives notification that a scroll bar has received the input focus.</span></span> <span data-ttu-id="413c8-173">Como una barra de desplazamiento no es un elemento de contenido, no está presente en la vista del subárbol.</span><span class="sxs-lookup"><span data-stu-id="413c8-173">Because a scroll bar is not a content element, it is not present in your view of the subtree.</span></span> <span data-ttu-id="413c8-174">Sin embargo, puede pasar el [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) que representa la barra de desplazamiento a **IUIAutomationTreeWalker:: Normalize** y recuperar el antecesor más cercano que se encuentra en la vista de contenido.</span><span class="sxs-lookup"><span data-stu-id="413c8-174">However, you can pass the [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) that represents the scroll bar to **IUIAutomationTreeWalker::Normalize** and retrieve the nearest ancestor that is in the content view.</span></span>

<span data-ttu-id="413c8-175">Para ver ejemplos de código que muestran cómo usar la interfaz [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) , consulte [cómo recorrer el árbol de automatización de la interfaz de usuario](uiauto-howto-walk-uiautomation-tree.md).</span><span class="sxs-lookup"><span data-stu-id="413c8-175">For code examples that show how to use the [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) interface, see [How to Walk the UI Automation Tree](uiauto-howto-walk-uiautomation-tree.md).</span></span>

## <a name="other-ways-to-retrieve-an-element"></a><span data-ttu-id="413c8-176">Otras maneras de recuperar un elemento</span><span class="sxs-lookup"><span data-stu-id="413c8-176">Other Ways to Retrieve an Element</span></span>

<span data-ttu-id="413c8-177">Además de las búsquedas y la navegación, puede recuperar un [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) de las siguientes maneras.</span><span class="sxs-lookup"><span data-stu-id="413c8-177">In addition to searches and navigation, you can retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) in the following ways.</span></span>

### <a name="from-an-event"></a><span data-ttu-id="413c8-178">Desde un evento</span><span class="sxs-lookup"><span data-stu-id="413c8-178">From an Event</span></span>

<span data-ttu-id="413c8-179">Cuando la aplicación recibe un evento de automatización de la interfaz de usuario, el objeto de origen que se pasa al controlador de eventos se representa mediante un [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement).</span><span class="sxs-lookup"><span data-stu-id="413c8-179">When your application receives a UI Automation event, the source object passed to your event handler is represented by an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement).</span></span> <span data-ttu-id="413c8-180">Por ejemplo, si se suscribe a eventos de cambio de foco, el origen que se pasa a [**IUIAutomationFocusChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationfocuschangedeventhandler) es el elemento que recibió el foco.</span><span class="sxs-lookup"><span data-stu-id="413c8-180">For example, if you subscribe to focus-changed events, the source passed to your [**IUIAutomationFocusChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationfocuschangedeventhandler) is the element that received the focus.</span></span> <span data-ttu-id="413c8-181">Para obtener más información, vea [suscribirse a eventos de automatización de la interfaz de usuario](uiauto-eventsforclients.md).</span><span class="sxs-lookup"><span data-stu-id="413c8-181">For more information, see [Subscribing to UI Automation Events](uiauto-eventsforclients.md).</span></span>

### <a name="from-a-point"></a><span data-ttu-id="413c8-182">Desde un punto</span><span class="sxs-lookup"><span data-stu-id="413c8-182">From a Point</span></span>

<span data-ttu-id="413c8-183">Para recuperar un [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) de las coordenadas de pantalla (por ejemplo, una posición del cursor), use el método [**IUIAutomation:: ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint) .</span><span class="sxs-lookup"><span data-stu-id="413c8-183">To retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) from screen coordinates, for example, a cursor position, use the [**IUIAutomation::ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint) method.</span></span>

### <a name="from-a-window-handle"></a><span data-ttu-id="413c8-184">Desde un identificador de ventana</span><span class="sxs-lookup"><span data-stu-id="413c8-184">From a Window Handle</span></span>

<span data-ttu-id="413c8-185">Para recuperar un [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) de un **hWnd**, use el método [**IUIAutomation:: ElementFromHandle**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle) .</span><span class="sxs-lookup"><span data-stu-id="413c8-185">To retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) from an **HWND**, use the [**IUIAutomation::ElementFromHandle**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle) method.</span></span>

### <a name="from-the-focused-control"></a><span data-ttu-id="413c8-186">Desde el control con el foco</span><span class="sxs-lookup"><span data-stu-id="413c8-186">From the Focused Control</span></span>

<span data-ttu-id="413c8-187">Para recuperar un [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) que representa el control con el foco, use el método [**IUIAutomation:: GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement) .</span><span class="sxs-lookup"><span data-stu-id="413c8-187">To retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) that represents the focused control, use the [**IUIAutomation::GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement) method.</span></span>

## <a name="related-topics"></a><span data-ttu-id="413c8-188">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="413c8-188">Related topics</span></span>

[<span data-ttu-id="413c8-189">Información general sobre el árbol de la UI Automation</span><span class="sxs-lookup"><span data-stu-id="413c8-189">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)

[<span data-ttu-id="413c8-190">Aplicación de ejemplo de cliente de contenido de documento de UI Automation</span><span class="sxs-lookup"><span data-stu-id="413c8-190">UI Automation document content client sample app</span></span>](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/UIAutomationDocumentClient)
