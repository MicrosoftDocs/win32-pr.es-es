---
title: Información de módulos
description: Un módulo es un archivo ejecutable o DLL.
ms.assetid: e15b5e15-ca06-4733-bd0a-705058ba2db8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1625877832b7e57e68ec6baff79f0c34b4478176
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104420821"
---
# <a name="module-information"></a><span data-ttu-id="db66d-103">Información de módulos</span><span class="sxs-lookup"><span data-stu-id="db66d-103">Module Information</span></span>

<span data-ttu-id="db66d-104">Un *módulo* es un archivo ejecutable o dll.</span><span class="sxs-lookup"><span data-stu-id="db66d-104">A *module* is an executable file or DLL.</span></span> <span data-ttu-id="db66d-105">Cada proceso está compuesto por uno o más módulos.</span><span class="sxs-lookup"><span data-stu-id="db66d-105">Each process consists of one or more modules.</span></span> <span data-ttu-id="db66d-106">Puede recuperar la lista de identificadores de módulo para un proceso llamando a la función [**EnumProcessModules**](/windows/desktop/api/Psapi/nf-psapi-enumprocessmodules) .</span><span class="sxs-lookup"><span data-stu-id="db66d-106">You can retrieve the list of module handles for a process by calling the [**EnumProcessModules**](/windows/desktop/api/Psapi/nf-psapi-enumprocessmodules) function.</span></span> <span data-ttu-id="db66d-107">Esta función rellena una matriz de valores de **HMODULE** con los identificadores de módulo para el proceso especificado.</span><span class="sxs-lookup"><span data-stu-id="db66d-107">This function fills an array of **HMODULE** values with the module handles for the specified process.</span></span> <span data-ttu-id="db66d-108">El primer módulo es el archivo ejecutable.</span><span class="sxs-lookup"><span data-stu-id="db66d-108">The first module is the executable file.</span></span> <span data-ttu-id="db66d-109">Recuerde que estos identificadores de módulo son más probables de otro proceso, por lo que no puede usarlos con funciones como [**GetModuleFileName**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulefilenamea).</span><span class="sxs-lookup"><span data-stu-id="db66d-109">Remember that these module handles are most likely from some other process, so you cannot use them with functions such as [**GetModuleFileName**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulefilenamea).</span></span> <span data-ttu-id="db66d-110">Sin embargo, puede usar [las funciones de psapi](psapi-functions.md) para obtener información sobre un módulo de otro proceso.</span><span class="sxs-lookup"><span data-stu-id="db66d-110">However, you can use [PSAPI functions](psapi-functions.md) to obtain information about a module from another process.</span></span>

<span data-ttu-id="db66d-111">En el procedimiento siguiente se describe cómo obtener información del módulo de otro proceso.</span><span class="sxs-lookup"><span data-stu-id="db66d-111">The following procedure describes how to obtain module information from another process.</span></span>

<span data-ttu-id="db66d-112">**Para obtener información del módulo de otro proceso**</span><span class="sxs-lookup"><span data-stu-id="db66d-112">**To obtain module information from another process**</span></span>

1.  <span data-ttu-id="db66d-113">Llame a la función [**GetModuleBaseName**](/windows/desktop/api/Psapi/nf-psapi-getmodulebasenamea) .</span><span class="sxs-lookup"><span data-stu-id="db66d-113">Call the [**GetModuleBaseName**](/windows/desktop/api/Psapi/nf-psapi-getmodulebasenamea) function.</span></span> <span data-ttu-id="db66d-114">Esta función toma un identificador de proceso y un identificador de módulo como entrada y rellena un búfer con el nombre base de un módulo (por ejemplo, Kernel32.dll).</span><span class="sxs-lookup"><span data-stu-id="db66d-114">This function takes a process handle and a module handle as input and fills in a buffer with the base name of a module (for example, Kernel32.dll).</span></span> <span data-ttu-id="db66d-115">Una función relacionada, [**GetModuleFileNameEx**](/windows/desktop/api/Psapi/nf-psapi-getmodulefilenameexa), toma los mismos parámetros que la entrada, pero devuelve la ruta de acceso completa al módulo (por ejemplo, C: \\ Windows \\ system32 \\Kernel32.dll).</span><span class="sxs-lookup"><span data-stu-id="db66d-115">A related function, [**GetModuleFileNameEx**](/windows/desktop/api/Psapi/nf-psapi-getmodulefilenameexa), takes the same parameters as input but returns the full path to the module (for example, C:\\Windows\\System32\\Kernel32.dll).</span></span>
2.  <span data-ttu-id="db66d-116">Llame a la función [**GetModuleInformation**](/windows/desktop/api/Psapi/nf-psapi-getmoduleinformation) .</span><span class="sxs-lookup"><span data-stu-id="db66d-116">Call the [**GetModuleInformation**](/windows/desktop/api/Psapi/nf-psapi-getmoduleinformation) function.</span></span> <span data-ttu-id="db66d-117">Esta función toma un identificador de proceso y un identificador de módulo, y rellena una estructura [**MODULEINFO**](/windows/desktop/api/Psapi/ns-psapi-moduleinfo) con la dirección de carga del módulo, el tamaño del espacio de direcciones lineal que ocupa y un puntero a su punto de entrada.</span><span class="sxs-lookup"><span data-stu-id="db66d-117">This function takes a process handle and a module handle and fills a [**MODULEINFO**](/windows/desktop/api/Psapi/ns-psapi-moduleinfo) structure with the load address of the module, the size of the linear address space it occupies, and a pointer to its entry point.</span></span>

<span data-ttu-id="db66d-118">Si una aplicación requiere información del módulo para el proceso actual, debe usar la función [**GetModuleFileName**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulefilenamea) en lugar de las funciones del módulo psapi.</span><span class="sxs-lookup"><span data-stu-id="db66d-118">If an application requires module information for the current process, it should use the [**GetModuleFileName**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulefilenamea) function instead of the PSAPI module functions.</span></span> <span data-ttu-id="db66d-119">Esto ayuda al rendimiento de las aplicaciones de dos maneras: la función **GetModuleFileName** es más eficaz que las funciones del módulo psapi y una aplicación puede evitar la carga de psapi.dll si no usa ninguna función de psapi.</span><span class="sxs-lookup"><span data-stu-id="db66d-119">This helps application performance in two ways: The **GetModuleFileName** function is more efficient than the PSAPI module functions, and an application can avoid loading psapi.dll if it does not use any PSAPI functions.</span></span>

<span data-ttu-id="db66d-120">Las funciones [**GetModuleBaseName**](/windows/desktop/api/Psapi/nf-psapi-getmodulebasenamea) y [**GetModuleFileNameEx**](/windows/desktop/api/Psapi/nf-psapi-getmodulefilenameexa) se han diseñado principalmente para su uso por parte de depuradores y aplicaciones similares que deben extraer información de módulos de otro proceso.</span><span class="sxs-lookup"><span data-stu-id="db66d-120">The [**GetModuleBaseName**](/windows/desktop/api/Psapi/nf-psapi-getmodulebasenamea) and [**GetModuleFileNameEx**](/windows/desktop/api/Psapi/nf-psapi-getmodulefilenameexa) functions are primarily designed for use by debuggers and similar applications that must extract module information from another process.</span></span> <span data-ttu-id="db66d-121">Si la lista de módulos del proceso de destino está dañada o aún no se ha inicializado, o si la lista de módulos cambia durante la llamada de función como resultado de la carga o descarga de los archivos dll, es posible que estas funciones generen errores o devuelvan información incorrecta.</span><span class="sxs-lookup"><span data-stu-id="db66d-121">If the module list in the target process is corrupted or is not yet initialized, or if the module list changes during the function call as a result of DLLs being loaded or unloaded, these functions may fail or return incorrect information.</span></span>

 

 