---
title: Tareas del servidor HTTP
description: Normalmente, las tareas del servidor HTTP se realizan en un orden específico; es decir, se debe completar una tarea y la salida obtenida antes de que comience la siguiente tarea.
ms.assetid: 08f8e7e9-23b9-403f-b00c-8912919d65b1
keywords:
- Tareas del servidor HTTP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 22455dbda21aca32b26f586eed6e51cef7509af2
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/16/2019
ms.locfileid: "103780119"
---
# <a name="http-server-tasks"></a><span data-ttu-id="6c25f-104">Tareas del servidor HTTP</span><span class="sxs-lookup"><span data-stu-id="6c25f-104">HTTP Server Tasks</span></span>

<span data-ttu-id="6c25f-105">Normalmente, las tareas del servidor HTTP se realizan en un orden específico; es decir, se debe completar una tarea y la salida obtenida antes de que comience la siguiente tarea.</span><span class="sxs-lookup"><span data-stu-id="6c25f-105">Typically, HTTP server tasks are performed in a specific order; that is, one task must be completed and the output obtained before the next task begins.</span></span>

<span data-ttu-id="6c25f-106">Se crea una página de tareas para presentar código de ejemplo sobre tareas específicas que realiza una aplicación de servidor HTTP.</span><span class="sxs-lookup"><span data-stu-id="6c25f-106">A task page is created to present sample code about specific tasks that an HTTP Server application performs.</span></span> <span data-ttu-id="6c25f-107">Una página de tareas se vincula al archivo de extensión de C del ejemplo de servidor HTTP.</span><span class="sxs-lookup"><span data-stu-id="6c25f-107">A task page links to the C extension file of the HTTP server sample.</span></span> <span data-ttu-id="6c25f-108">Al instalar el PSDK en la unidad C: \\ de un equipo local, la aplicación de ejemplo de servidor completa se instala en C: \\ archivos de programa \\ Microsoft SDK \\ Samples \\ netds \\ http \\ Server.</span><span class="sxs-lookup"><span data-stu-id="6c25f-108">When you install the PSDK on drive C:\\ of a local computer, the complete server sample application is installed at C:\\Program Files\\Microsoft SDK\\Samples\\netds\\http\\server.</span></span>

<span data-ttu-id="6c25f-109">En la lista siguiente se identifican las tareas del servidor HTTP:</span><span class="sxs-lookup"><span data-stu-id="6c25f-109">The following list identifies the HTTP Server tasks:</span></span>

-   [<span data-ttu-id="6c25f-110">Inicializar el servicio HTTP</span><span class="sxs-lookup"><span data-stu-id="6c25f-110">Initialize the HTTP Service</span></span>](#initialize-the-http-service)
-   [<span data-ttu-id="6c25f-111">Registrar las direcciones URL para escuchar en</span><span class="sxs-lookup"><span data-stu-id="6c25f-111">Register the URLs to Listen On</span></span>](#register-the-urls-to-listen-on)
-   [<span data-ttu-id="6c25f-112">Llamar a la rutina para recibir una solicitud</span><span class="sxs-lookup"><span data-stu-id="6c25f-112">Call the Routine to Receive a Request</span></span>](#call-the-routine-to-receive-a-request)
-   [<span data-ttu-id="6c25f-113">Recibir la solicitud</span><span class="sxs-lookup"><span data-stu-id="6c25f-113">Receive the Request</span></span>](#receive-the-request)
-   [<span data-ttu-id="6c25f-114">Controlar la solicitud HTTP</span><span class="sxs-lookup"><span data-stu-id="6c25f-114">Handle the HTTP Request</span></span>](#handle-the-http-request)
-   [<span data-ttu-id="6c25f-115">Enviar la respuesta HTTP</span><span class="sxs-lookup"><span data-stu-id="6c25f-115">Send the HTTP Response</span></span>](#send-the-http-response)
-   [<span data-ttu-id="6c25f-116">Enviar la respuesta HTTP POST</span><span class="sxs-lookup"><span data-stu-id="6c25f-116">Send the HTTP POST Response</span></span>](#send-the-http-post-response)
-   [<span data-ttu-id="6c25f-117">Limpieza de la API del servidor HTTP</span><span class="sxs-lookup"><span data-stu-id="6c25f-117">Clean Up the HTTP Server API</span></span>](#clean-up-the-http-server-api)

## <a name="initialize-the-http-service"></a><span data-ttu-id="6c25f-118">Inicializar el servicio HTTP</span><span class="sxs-lookup"><span data-stu-id="6c25f-118">Initialize the HTTP Service</span></span>

<span data-ttu-id="6c25f-119">El servicio HTTP se inicializa con la función [**HttpInitialize**](/windows/desktop/api/Http/nf-http-httpinitialize) y el identificador de la cola de solicitudes se crea mediante [**HttpCreateHttpHandle**](/windows/desktop/api/Http/nf-http-httpcreatehttphandle).</span><span class="sxs-lookup"><span data-stu-id="6c25f-119">The HTTP service is initialized by using the [**HttpInitialize**](/windows/desktop/api/Http/nf-http-httpinitialize) function, and the handle to the request queue is created by using [**HttpCreateHttpHandle**](/windows/desktop/api/Http/nf-http-httpcreatehttphandle).</span></span> <span data-ttu-id="6c25f-120">El servidor debe inicializarse antes de que se pueda llamar a cualquier otra función de servidor.</span><span class="sxs-lookup"><span data-stu-id="6c25f-120">The server must be initialized before any other server functions can be called.</span></span> <span data-ttu-id="6c25f-121">La cola de solicitudes debe crearse antes de que el servicio pueda registrar las direcciones URL para escuchar las solicitudes HTTP entrantes.</span><span class="sxs-lookup"><span data-stu-id="6c25f-121">The request queue must be created before the service can register URLs to listen for incoming HTTP requests.</span></span>

<span data-ttu-id="6c25f-122">Para obtener más información y un ejemplo de código, consulte [inicializar el servicio http](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="6c25f-122">For more information and a code example, see [Initialize the HTTP Service](http-server-sample-application.md).</span></span>

## <a name="register-the-urls-to-listen-on"></a><span data-ttu-id="6c25f-123">Registrar las direcciones URL para escuchar en</span><span class="sxs-lookup"><span data-stu-id="6c25f-123">Register the URLs to Listen On</span></span>

<span data-ttu-id="6c25f-124">Para que la API del servidor HTTP escuche las solicitudes entrantes, las direcciones URL específicas se registran con la API mediante una llamada a la función [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) .</span><span class="sxs-lookup"><span data-stu-id="6c25f-124">For the HTTP Server API to listen for incoming requests, specific URLs are registered with the API by calling the [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) function.</span></span> <span data-ttu-id="6c25f-125">Las solicitudes entrantes que coincidan con estas direcciones URL se enrutan a la cola de solicitudes especificada en esta llamada.</span><span class="sxs-lookup"><span data-stu-id="6c25f-125">Incoming requests that match these URLs are routed to the request queue specified in this call.</span></span>

<span data-ttu-id="6c25f-126">Para obtener más información y un ejemplo de código, vea [registrar las direcciones URL para escuchar en](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="6c25f-126">For more information and a code example, see [Register the URLs to Listen On](http-server-sample-application.md).</span></span>

## <a name="call-the-routine-to-receive-a-request"></a><span data-ttu-id="6c25f-127">Llamar a la rutina para recibir una solicitud</span><span class="sxs-lookup"><span data-stu-id="6c25f-127">Call the Routine to Receive a Request</span></span>

<span data-ttu-id="6c25f-128">La función DoReceiveRequest asigna el búfer de solicitud, inicializa el identificador de solicitud e inicia el bucle para recibir solicitudes.</span><span class="sxs-lookup"><span data-stu-id="6c25f-128">The DoReceiveRequest function allocates the request buffer, initializes the request ID, and starts the loop to receive requests.</span></span>

<span data-ttu-id="6c25f-129">Para obtener más información y un ejemplo de código, consulte [llamar a la rutina para recibir una solicitud](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="6c25f-129">For more information and a code example, see [Call the Routine to Receive a Request](http-server-sample-application.md).</span></span>

## <a name="receive-the-request"></a><span data-ttu-id="6c25f-130">Recibir la solicitud</span><span class="sxs-lookup"><span data-stu-id="6c25f-130">Receive the Request</span></span>

<span data-ttu-id="6c25f-131">La API del servidor HTTP proporciona una estructura de solicitud para almacenar la solicitud de entrada analizada.</span><span class="sxs-lookup"><span data-stu-id="6c25f-131">The HTTP Server API supplies a request structure to store the parsed incoming request.</span></span> <span data-ttu-id="6c25f-132">La aplicación asigna esta estructura y se inicializa cuando se recibe una solicitud entrante.</span><span class="sxs-lookup"><span data-stu-id="6c25f-132">This structure is allocated by the application, and initialized when an incoming request is received.</span></span> <span data-ttu-id="6c25f-133">La aplicación llama a la función [**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) para recibir la solicitud.</span><span class="sxs-lookup"><span data-stu-id="6c25f-133">The application calls the [**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) function to receive the request.</span></span> <span data-ttu-id="6c25f-134">Si el búfer de solicitud es demasiado pequeño para recibir la solicitud, la aplicación puede aumentar el tamaño del búfer y volver a llamar a **HttpReceiveHttpRequest** para recibir la solicitud completa.</span><span class="sxs-lookup"><span data-stu-id="6c25f-134">If the request buffer is too small to receive the request, the application can increase the buffer size and call **HttpReceiveHttpRequest** again to receive the entire request.</span></span>

<span data-ttu-id="6c25f-135">Para obtener más información y un ejemplo de código, consulte [recibir una solicitud](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="6c25f-135">For more information and a code example, see [Receive a Request](http-server-sample-application.md).</span></span>

## <a name="handle-the-http-request"></a><span data-ttu-id="6c25f-136">Controlar la solicitud HTTP</span><span class="sxs-lookup"><span data-stu-id="6c25f-136">Handle the HTTP Request</span></span>

<span data-ttu-id="6c25f-137">En la aplicación de ejemplo se muestra cómo controlar los verbos de solicitud GET y POST de HTTP.</span><span class="sxs-lookup"><span data-stu-id="6c25f-137">The sample application shows how to handle the HTTP GET and POST request verbs.</span></span> <span data-ttu-id="6c25f-138">La aplicación envía un error 503 (**no \_ implementado**) si los verbos están presentes en la solicitud que la aplicación no controla.</span><span class="sxs-lookup"><span data-stu-id="6c25f-138">The application sends a 503 (**NOT\_IMPLEMENTED**) error if verbs are present in the request that the application does not handle.</span></span>

<span data-ttu-id="6c25f-139">Tenga en cuenta que la dirección URL que se usará en el control de solicitudes es la dirección URL procesada incluida en el miembro **CookedUrl** de la estructura de la [**\_ solicitud HTTP \_ v1**](/windows/desktop/api/Http/ns-http-http_request_v1) .</span><span class="sxs-lookup"><span data-stu-id="6c25f-139">Note that the URL to be used in handling requests is the processed URL contained in the **CookedUrl** member of the [**HTTP\_REQUEST\_V1**](/windows/desktop/api/Http/ns-http-http_request_v1) structure.</span></span> <span data-ttu-id="6c25f-140">No se trata de la dirección URL no procesada en el miembro **pRawUrl** , que es únicamente para fines estadísticos y de seguimiento.</span><span class="sxs-lookup"><span data-stu-id="6c25f-140">Do not the unprocessed URL in the **pRawUrl** member, which is solely for tracking and statistical purposes.</span></span>

<span data-ttu-id="6c25f-141">Para obtener más información y un ejemplo de código, vea [controlar la solicitud HTTP](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="6c25f-141">For more information and a code example, see [Handle the HTTP Request](http-server-sample-application.md).</span></span>

## <a name="send-the-http-response"></a><span data-ttu-id="6c25f-142">Enviar la respuesta HTTP</span><span class="sxs-lookup"><span data-stu-id="6c25f-142">Send the HTTP Response</span></span>

<span data-ttu-id="6c25f-143">La estructura de respuesta se asigna y se inicializa con el código de estado y una frase de motivo en la \_ macro Initialize http \_ Response.</span><span class="sxs-lookup"><span data-stu-id="6c25f-143">The response structure is allocated and initialized with the status code and a reason phrase in the INITIALIZE\_HTTP\_RESPONSE macro.</span></span> <span data-ttu-id="6c25f-144">Un encabezado HTTP conocido se agrega a la estructura de respuesta en la \_ \_ macro agregar encabezado conocido y el cuerpo de la entidad se agrega a la respuesta de un bloque de datos de la memoria.</span><span class="sxs-lookup"><span data-stu-id="6c25f-144">A known HTTP header is added into the response structure in the ADD\_KNOWN\_HEADER macro, and the entity body is added to the response from a data block from memory.</span></span> <span data-ttu-id="6c25f-145">Se llama a la función [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) para enviar la respuesta.</span><span class="sxs-lookup"><span data-stu-id="6c25f-145">The [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) function is called to send the response.</span></span> <span data-ttu-id="6c25f-146">En este ejemplo, la aplicación envía una respuesta sencilla 200 aceptar a la solicitud GET.</span><span class="sxs-lookup"><span data-stu-id="6c25f-146">In this example, the application sends a simple 200 OK response to the GET request.</span></span>

<span data-ttu-id="6c25f-147">Para obtener más información y un ejemplo de código, vea [enviar una respuesta http](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="6c25f-147">For more information and a code example, see [Send an HTTP Response](http-server-sample-application.md).</span></span>

## <a name="send-the-http-post-response"></a><span data-ttu-id="6c25f-148">Enviar la respuesta HTTP POST</span><span class="sxs-lookup"><span data-stu-id="6c25f-148">Send the HTTP POST Response</span></span>

<span data-ttu-id="6c25f-149">La solicitud POST requiere más procesamiento que la solicitud GET.</span><span class="sxs-lookup"><span data-stu-id="6c25f-149">The POST request requires more processing than the GET request.</span></span> <span data-ttu-id="6c25f-150">El cuerpo de la entidad de solicitud se recibe llamando a la función [**HttpReceiveRequestEntityBody**](/windows/desktop/api/Http/nf-http-httpreceiverequestentitybody) .</span><span class="sxs-lookup"><span data-stu-id="6c25f-150">The request entity body is received by calling the [**HttpReceiveRequestEntityBody**](/windows/desktop/api/Http/nf-http-httpreceiverequestentitybody) function.</span></span> <span data-ttu-id="6c25f-151">La aplicación envía la respuesta y el cuerpo de la entidad de respuesta en llamadas independientes a la API del servidor HTTP.</span><span class="sxs-lookup"><span data-stu-id="6c25f-151">The application sends the response and the response entity body in separate calls to the HTTP Server API.</span></span> <span data-ttu-id="6c25f-152">Los encabezados de respuesta se envían con [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse).</span><span class="sxs-lookup"><span data-stu-id="6c25f-152">The response headers are sent with the [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse).</span></span> <span data-ttu-id="6c25f-153">El cuerpo de la entidad se envía en un bloque de datos desde un identificador de archivo con la función [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) .</span><span class="sxs-lookup"><span data-stu-id="6c25f-153">The entity body is sent in a data block from a file handle with the [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) function.</span></span>

<span data-ttu-id="6c25f-154">Para obtener más información y un ejemplo de código, vea [enviar una respuesta http post](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="6c25f-154">For more information and a code example, see [Send an HTTP POST Response](http-server-sample-application.md).</span></span>

## <a name="clean-up-the-http-server-api"></a><span data-ttu-id="6c25f-155">Limpieza de la API del servidor HTTP</span><span class="sxs-lookup"><span data-stu-id="6c25f-155">Clean Up the HTTP Server API</span></span>

<span data-ttu-id="6c25f-156">Las operaciones de limpieza para la API del servidor HTTP incluyen:</span><span class="sxs-lookup"><span data-stu-id="6c25f-156">The cleanup operations for the HTTP Server API include:</span></span>

-   <span data-ttu-id="6c25f-157">Quitando todas las direcciones URL registradas.</span><span class="sxs-lookup"><span data-stu-id="6c25f-157">Removing all registered URLs.</span></span>
-   <span data-ttu-id="6c25f-158">Cerrando el identificador de la cola de solicitudes.</span><span class="sxs-lookup"><span data-stu-id="6c25f-158">Closing the handle to the request queue.</span></span>
-   <span data-ttu-id="6c25f-159">Finalización de los recursos creados por la API del servidor HTTP.</span><span class="sxs-lookup"><span data-stu-id="6c25f-159">Terminating the resources created by the HTTP Server API.</span></span>

<span data-ttu-id="6c25f-160">La aplicación llama a la función [**HttpRemoveUrl**](/windows/desktop/api/Http/nf-http-httpremoveurl) para anular el registro de las direcciones URL registradas por la función [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) inicial.</span><span class="sxs-lookup"><span data-stu-id="6c25f-160">The application calls the [**HttpRemoveUrl**](/windows/desktop/api/Http/nf-http-httpremoveurl) function to deregister URLs registered by the initial [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) function.</span></span> <span data-ttu-id="6c25f-161">La aplicación también llama a [**HttpTerminate**](/windows/desktop/api/Http/nf-http-httpterminate) para cada llamada a [**HttpInitialize**](/windows/desktop/api/Http/nf-http-httpinitialize) con la configuración de marca coincidente.</span><span class="sxs-lookup"><span data-stu-id="6c25f-161">The application also calls [**HttpTerminate**](/windows/desktop/api/Http/nf-http-httpterminate) for each call to [**HttpInitialize**](/windows/desktop/api/Http/nf-http-httpinitialize) with matching flag settings.</span></span> <span data-ttu-id="6c25f-162">Esta llamada finaliza todos los recursos creados por la llamada a **HttpInitialize**.</span><span class="sxs-lookup"><span data-stu-id="6c25f-162">This call terminates all resources created by the call to **HttpInitialize**.</span></span>

<span data-ttu-id="6c25f-163">Para obtener más información y un ejemplo de código, vea [Cleanup The http Server API](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="6c25f-163">For more information and a code example, see [Cleanup the HTTP Server API](http-server-sample-application.md).</span></span>

 

 




