---
title: Evitar la ocultación de información
description: En ocasiones, los programas ocultan información del motor de cálculo de referencias de RPC deliberadamente o accidentalmente.
ms.assetid: 016b9221-092d-4c25-a396-4f41dcdfb3cf
keywords:
- compatibilidad con versiones anteriores de 64 bits programación de Windows
- problemas de compatibilidad con la programación de Windows de 64 bits
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2f4b9e4ba7ed5165378beb93005243af03f9e469
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104420976"
---
# <a name="avoiding-information-hiding"></a><span data-ttu-id="9bceb-105">Evitar la ocultación de información</span><span class="sxs-lookup"><span data-stu-id="9bceb-105">Avoiding Information Hiding</span></span>

<span data-ttu-id="9bceb-106">En ocasiones, los programas ocultan información del motor de cálculo de referencias de RPC deliberadamente o accidentalmente.</span><span class="sxs-lookup"><span data-stu-id="9bceb-106">Occasionally, programs deliberately or inadvertently hide information from the RPC marshaling engine.</span></span> <span data-ttu-id="9bceb-107">Algunos ejemplos son los siguientes:</span><span class="sxs-lookup"><span data-stu-id="9bceb-107">Some examples are as follows:</span></span>

-   <span data-ttu-id="9bceb-108">Enviar una estructura de datos como un bloque de bytes no diferenciado</span><span class="sxs-lookup"><span data-stu-id="9bceb-108">Sending a data structure as an undifferentiated block of bytes</span></span>
-   <span data-ttu-id="9bceb-109">Aprovechar el rendimiento mediante el uso de un efecto secundario de un método para canalizar datos adicionales a través de la conexión</span><span class="sxs-lookup"><span data-stu-id="9bceb-109">Leveraging performance by using a side effect from a method to channel additional data across the wire</span></span>
-   <span data-ttu-id="9bceb-110">Intentando disfrazar un controlador pasándolo como **DWORD** o **ULong**</span><span class="sxs-lookup"><span data-stu-id="9bceb-110">Attempting to disguise a handle by passing it as a **DWORD** or a **ULONG**</span></span>

<span data-ttu-id="9bceb-111">Se garantiza que estas técnicas presentan problemas de compatibilidad incluso antes de migrar la aplicación a Windows de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="9bceb-111">These techniques are almost guaranteed to introduce compatibility problems even before you port your application to 64-bit Windows.</span></span>

<span data-ttu-id="9bceb-112">En lugar de enviar un contexto de servidor como **DWORD** en una llamada a procedimiento remoto estándar, use un identificador de contexto para proporcionar un identificador opaco a un contexto de servidor que se mantiene en nombre de un cliente.</span><span class="sxs-lookup"><span data-stu-id="9bceb-112">Instead of sending a server context as a **DWORD** in a standard remote procedure call, use a context handle to provide an opaque handle to a server context that is held on behalf of a client.</span></span> <span data-ttu-id="9bceb-113">Los contextos se identifican mediante GUID definidos por el tiempo de ejecución de RPC cuando un servidor crea un identificador de contexto para un cliente.</span><span class="sxs-lookup"><span data-stu-id="9bceb-113">Contexts are identified by GUIDs defined by the RPC run time when a server creates a context handle for a client.</span></span> <span data-ttu-id="9bceb-114">No se usa ningún puntero a través de la conexión y la operación es completamente transparente en los límites de 32 o 64 bits.</span><span class="sxs-lookup"><span data-stu-id="9bceb-114">No pointer is used over the wire and the operation is completely transparent across 32- or 64-bit boundaries.</span></span> <span data-ttu-id="9bceb-115">Para obtener más información sobre el uso de identificadores de contexto, vea [identificadores de contexto](/windows/desktop/Rpc/context-handles).</span><span class="sxs-lookup"><span data-stu-id="9bceb-115">For more information on using context handles, see [Context Handles](/windows/desktop/Rpc/context-handles).</span></span>

<span data-ttu-id="9bceb-116">Las interfaces DCOM no pueden usar identificadores de contexto porque COM proporciona su propia administración de contexto.</span><span class="sxs-lookup"><span data-stu-id="9bceb-116">DCOM interfaces cannot use context handles because COM provides its own context management.</span></span> <span data-ttu-id="9bceb-117">En lugar de crear un identificador de contexto, puede pasar un puntero de interfaz al objeto COM.</span><span class="sxs-lookup"><span data-stu-id="9bceb-117">Instead of creating a context handle, you can pass an interface pointer to the COM object.</span></span> <span data-ttu-id="9bceb-118">Después, puede llamar a los métodos directamente a través del puntero de interfaz o colocar el puntero dentro de otras llamadas.</span><span class="sxs-lookup"><span data-stu-id="9bceb-118">Then you can call the methods directly through the interface pointer or place the pointer inside other calls.</span></span> <span data-ttu-id="9bceb-119">Para liberar el objeto de servidor, el cliente llama al método de **liberación** de la interfaz a través del puntero de interfaz.</span><span class="sxs-lookup"><span data-stu-id="9bceb-119">To release the server object, the client calls the interface's **Release** method through the interface pointer.</span></span>

<span data-ttu-id="9bceb-120">De nuevo, puede haber ocasiones en las que no se pueda cambiar el diseño original del código que se está trasladando.</span><span class="sxs-lookup"><span data-stu-id="9bceb-120">Again, there may be times when you cannot change the original design of the code that you are porting.</span></span> <span data-ttu-id="9bceb-121">Si no hay ninguna manera de evitar el envío de un puntero a través de la conexión como **DWORD**, tendrá que implementar algún tipo de asignación del lado servidor entre los valores **DWORD** y los punteros.</span><span class="sxs-lookup"><span data-stu-id="9bceb-121">If there is no way to avoid sending a pointer across the wire as a **DWORD**, you will have to implement some form of server-side mapping between **DWORD** values and pointers.</span></span> <span data-ttu-id="9bceb-122">Una manera de hacerlo es cambiar los punteros en la aplicación del lado cliente a tipos de precisión de puntero, como **ULong \_ ptr** o **DWORD \_ ptr**.</span><span class="sxs-lookup"><span data-stu-id="9bceb-122">One way to do this is to change the pointers in the client side application to pointer-precision types, such as **ULONG\_PTR** or **DWORD\_PTR**.</span></span> <span data-ttu-id="9bceb-123">A continuación, use la llamada de MIDL \[ [**\_ como**](/windows/desktop/Midl/call-as) \] atributo para colocar los punteros en la conexión como valores **DWORD** .</span><span class="sxs-lookup"><span data-stu-id="9bceb-123">Then use the MIDL \[[**call\_as**](/windows/desktop/Midl/call-as)\] attribute to put the pointers on the wire as **DWORD** values.</span></span> <span data-ttu-id="9bceb-124">El contenedor del lado cliente solo necesita pasar los argumentos.</span><span class="sxs-lookup"><span data-stu-id="9bceb-124">The client-side wrapper need only pass the arguments along.</span></span> <span data-ttu-id="9bceb-125">El contenedor del servidor controla la asignación entre ambos tipos.</span><span class="sxs-lookup"><span data-stu-id="9bceb-125">The server-side wrapper handles the mapping between both types.</span></span> <span data-ttu-id="9bceb-126">De forma similar, puede usar el atributo de \[ [**transmisión \_ como**](/windows/desktop/Midl/transmit-as) \] o el atributo de \[ [**representación \_ como**](/windows/desktop/Midl/represent-as) \] para convertir los datos a un formato compatible con versiones anteriores para la representación de la conexión.</span><span class="sxs-lookup"><span data-stu-id="9bceb-126">In a similar way, you can use either the \[[**transmit\_as**](/windows/desktop/Midl/transmit-as)\] attribute or the \[[**represent\_as**](/windows/desktop/Midl/represent-as)\] attribute to convert your data to a backward-compatible format for wire representation.</span></span>

<span data-ttu-id="9bceb-127">Si la compatibilidad con el cable de retroceso no es un problema o si el identificador no se utiliza para las llamadas remotas y está seguro de que nunca se producirán llamadas remotas entre los procesos de 32 y 64 bits, puede volver a definir un argumento como **ULONG64**.</span><span class="sxs-lookup"><span data-stu-id="9bceb-127">If backward-wire compatibility is not an issue or if the handle is not used for remote calls and you are sure that remote calls between 32- and 64-bit processes will never happen, you can redefine an argument as a **ULONG64**.</span></span> <span data-ttu-id="9bceb-128">Si es necesario, puede modificar la aplicación de 32 bits para pasar un **valor DWORD** al usuario.</span><span class="sxs-lookup"><span data-stu-id="9bceb-128">If necessary, you can modify the 32-bit application to pass a **DWORD** to the user.</span></span> <span data-ttu-id="9bceb-129">Como alternativa, puede crear códigos auxiliares independientes a partir de archivos IDL independientes para cada plataforma mediante un **valor DWORD** en windows de 32 bits y un **ULONG64** en Windows de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="9bceb-129">Alternatively, you can build separate stubs from separate IDL files for each platform using a **DWORD** on 32-bit Windows and a **ULONG64** on 64-bit Windows.</span></span>

 

 