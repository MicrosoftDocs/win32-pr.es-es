---
title: Información general del código
description: La siguiente ilustración es una representación conceptual de los bloques de código necesarios para implementar el componente de proveedor de ejemplo de ADSI.
ms.assetid: b353c2d9-ef86-4e4c-ac00-4756fc9ec57d
ms.tgt_platform: multiple
keywords:
- Información general del código AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e99a4974ac97488fc051ea80dbde7a8a83fa329e
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/21/2020
ms.locfileid: "104078372"
---
# <a name="code-overview"></a><span data-ttu-id="7eeb7-104">Información general del código</span><span class="sxs-lookup"><span data-stu-id="7eeb7-104">Code Overview</span></span>

<span data-ttu-id="7eeb7-105">La siguiente ilustración es una representación conceptual de los bloques de código necesarios para implementar el componente de proveedor de ejemplo de ADSI.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-105">The following figure is a conceptual representation of the blocks of code necessary to implement the ADSI example provider component.</span></span> <span data-ttu-id="7eeb7-106">Cada sección se describe en la ilustración siguiente.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-106">Each section is described in the following figure.</span></span> <span data-ttu-id="7eeb7-107">Los programadores de COM experimentados pueden encontrar que se trata de una información general adecuada del componente de proveedor de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-107">Experienced COM programmers may find this is to be a suitable overview of the example provider component.</span></span> <span data-ttu-id="7eeb7-108">Para obtener más información, vea [detalles del código](code-details.md).</span><span class="sxs-lookup"><span data-stu-id="7eeb7-108">For more information, see [Code Details](code-details.md).</span></span>

![implementación del proveedor de ejemplo](images/dssmco.png)

<span data-ttu-id="7eeb7-110">Los elementos numerados siguientes corresponden a los elementos de bloque de la ilustración.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-110">The following numbered items correspond to block elements in the figure.</span></span>

1.  <span data-ttu-id="7eeb7-111">Cargar el archivo DLL (LibMain. cpp, GUID. cpp).</span><span class="sxs-lookup"><span data-stu-id="7eeb7-111">Loading the DLL (Libmain.cpp, Guid.cpp).</span></span> <span data-ttu-id="7eeb7-112">El punto de entrada del archivo DLL.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-112">The entry point for the DLL.</span></span> <span data-ttu-id="7eeb7-113">Definiciones de objetos estáticos de generador de clases para los dos objetos de proveedor: GUID. cpp contiene las definiciones de CLSID para las implementaciones de los diversos objetos de componente de proveedor de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-113">Class factory static object definitions for the two provider objects: Guid.cpp contains the CLSID definitions for the implementations of the various Example provider component objects.</span></span>
2.  <span data-ttu-id="7eeb7-114">Código de creación y generador de clases de objetos de proveedor (Cprovcf. cpp, Cprov. cpp, STDFact. cpp).</span><span class="sxs-lookup"><span data-stu-id="7eeb7-114">Provider object class factory and creation code (Cprovcf.cpp, Cprov.cpp, Stdfact.cpp).</span></span> <span data-ttu-id="7eeb7-115">El objeto de proveedor es el objeto que admite [**IParseDisplayName**](/windows/win32/api/oleidl/nn-oleidl-iparsedisplayname) durante las operaciones de enlace de moniker, como se describe en buscar y enlazar en el componente de proveedor de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-115">The provider object is the object that supports [**IParseDisplayName**](/windows/win32/api/oleidl/nn-oleidl-iparsedisplayname) during the moniker binding operations as discussed in Finding and Binding in the Example Provider Component.</span></span>
3.  <span data-ttu-id="7eeb7-116">Enlazar a un objeto (Getobj. cpp).</span><span class="sxs-lookup"><span data-stu-id="7eeb7-116">Binding to an object (Getobj.cpp).</span></span> <span data-ttu-id="7eeb7-117">Este código llama al analizador para comprobar que el ADsPath dado es sintácticamente correcto y, a continuación, realiza cualquier asignación necesaria desde ADsPath a la ruta de acceso del servicio de directorio nativo para el elemento que se va a crear como un objeto Active Directory.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-117">This code calls the parser to check that the given ADsPath is syntactically correct, and then performs any necessary mapping from the ADsPath to the native directory service path for the item being created as an Active Directory object.</span></span> <span data-ttu-id="7eeb7-118">Busca la definición de esquema para este tipo de objeto y rellena las propiedades obligatorias.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-118">It looks up the schema definition for this type of object and fills in the mandatory properties.</span></span> <span data-ttu-id="7eeb7-119">Después de crear el objeto de Active Directory, se recupera un puntero de interfaz a [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) para el autor de la llamada.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-119">After creating the Active Directory object, an interface pointer to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) is retrieved for the caller.</span></span>
4.  <span data-ttu-id="7eeb7-120">Analizador del espacio de nombres del proveedor (Parse. cpp).</span><span class="sxs-lookup"><span data-stu-id="7eeb7-120">Parser for the provider namespace (Parse.cpp).</span></span> <span data-ttu-id="7eeb7-121">Este es el código invocado por el elemento 3.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-121">This is the code invoked by item 3.</span></span> <span data-ttu-id="7eeb7-122">El analizador comprueba que la cadena ADsPath pasada es sintácticamente correcta para su propio espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-122">The parser verifies that the ADsPath string passed in is syntactically correct for its own namespace.</span></span>
5.  <span data-ttu-id="7eeb7-123">Generador de clases, creación y enumeración para el objeto de espacio de nombres (Cnamcf. cpp, Cnamesp. cpp, Cenumns. cpp).</span><span class="sxs-lookup"><span data-stu-id="7eeb7-123">Class factory, creation, and enumeration for the namespace object (Cnamcf.cpp, Cnamesp.cpp, Cenumns.cpp).</span></span> <span data-ttu-id="7eeb7-124">El objeto de espacio de nombres es un objeto contenedor que se puede enumerar para buscar todos los objetos de nodo raíz de este espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-124">The namespace object is a container object that can be enumerated to find all the root node objects for this namespace.</span></span>
6.  <span data-ttu-id="7eeb7-125">Generador de clases y código de creación para un objeto de Active Directory genérico, y el generador de clases, el código de creación y enumeración para un objeto contenedor ADs genérico (Cgenobj. cpp, Cenumobj. cpp, Common. cpp, Core. cpp).</span><span class="sxs-lookup"><span data-stu-id="7eeb7-125">Class factory and creation code for a generic Active Directory object, and class factory, creation and enumeration code for a generic ADs container object (Cgenobj.cpp, Cenumobj.cpp, Common.cpp, Core.cpp).</span></span> <span data-ttu-id="7eeb7-126">Este código se ejecuta cuando se crea un objeto de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-126">This code is executed when an Active Directory object is created.</span></span>
7.  <span data-ttu-id="7eeb7-127">Filtrar y enumerar variantes (Cenumvar. cpp, Object. cpp).</span><span class="sxs-lookup"><span data-stu-id="7eeb7-127">Filtering and enumerating VARIANTs (Cenumvar.cpp, Object.cpp).</span></span> <span data-ttu-id="7eeb7-128">Cuando una colección de elementos VARIANT de un solo tipo se administra en ADSI, se usa este código.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-128">When a collection of VARIANT elements of a single type are managed in within ADSI, this code is used.</span></span>
8.  <span data-ttu-id="7eeb7-129">GLOBALS (Globals. cpp).</span><span class="sxs-lookup"><span data-stu-id="7eeb7-129">Globals (Globals.cpp).</span></span> <span data-ttu-id="7eeb7-130">Palabras clave de espacio de nombres, las estructuras de asignación de sintaxis de formatos de datos nativos al tipo de variante de automatización ADs se definen aquí.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-130">Namespace keywords, syntax mapping structures from native data formats to the ADs Automation VARIANT type are all defined here.</span></span>
9.  <span data-ttu-id="7eeb7-131">Serialización/desserialización de datos (Pack. cpp, Property. cpp, Smpoper. cpp).</span><span class="sxs-lookup"><span data-stu-id="7eeb7-131">Marshaling/unmarshaling data (Pack.cpp, Property.cpp, Smpoper.cpp).</span></span> <span data-ttu-id="7eeb7-132">La conversión de formatos de datos nativos al conjunto compatible de tipos de variante de automatización se produce cuando las propiedades de un objeto se cargan en la memoria caché de propiedades.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-132">Conversion from native data formats to the supported set of Automation VARIANT types occurs when properties of an object are loaded into the property cache.</span></span> <span data-ttu-id="7eeb7-133">Se debe realizar otro control especial para los datos cuando las estructuras con punteros se copian, se eliminan o se mueven en memoria.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-133">Other special handling for data must be performed when structures with pointers are copied, deleted, or moved in memory.</span></span>
10. <span data-ttu-id="7eeb7-134">Caché de propiedades (Cprops. cpp).</span><span class="sxs-lookup"><span data-stu-id="7eeb7-134">Property cache (Cprops.cpp).</span></span> <span data-ttu-id="7eeb7-135">Propiedades de almacenamiento en caché es una característica del entorno ADSI.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-135">Caching properties is a feature of the ADSI environment.</span></span> <span data-ttu-id="7eeb7-136">Los métodos [**IADs:: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo), [**IADs:: GetInfoEx**](/windows/desktop/api/Iads/nf-iads-iads-getinfoex)y [**IADs:: SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) actúan en la caché de propiedades.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-136">The [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo), [**IADs::GetInfoEx**](/windows/desktop/api/Iads/nf-iads-iads-getinfoex), and [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) methods act on the property cache.</span></span>
11. <span data-ttu-id="7eeb7-137">Administración de memoria (Memory. cpp).</span><span class="sxs-lookup"><span data-stu-id="7eeb7-137">Memory management (Memory.cpp).</span></span> <span data-ttu-id="7eeb7-138">El uso de un conjunto de funciones de memoria para asignar y liberar memoria permite al componente de proveedor de ejemplo realizar un seguimiento del uso de la memoria y detener las pérdidas de memoria.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-138">Using one set of memory functions to allocate and free memory allows the example provider component to track memory use and stop memory leaks.</span></span>
12. <span data-ttu-id="7eeb7-139">Objetos de esquema y administración (Cschobj. cpp, Cprpobj. cpp, Cclsobj. cpp, Cenumsch. cpp).</span><span class="sxs-lookup"><span data-stu-id="7eeb7-139">Schema objects and management (Cschobj.cpp, Cprpobj.cpp, Cclsobj.cpp, Cenumsch.cpp).</span></span> <span data-ttu-id="7eeb7-140">Esto incluye rutinas para crear, administrar y enumerar los objetos de esquema.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-140">This includes routines to create, manage, and enumerate the schema objects.</span></span> <span data-ttu-id="7eeb7-141">Esto incluye objetos de clase de esquema, objetos de propiedad y objetos de sintaxis, además de poder enumerar el objeto contenedor de clase de esquema.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-141">This includes schema class objects, property objects, and syntax objects, in addition to being able to enumerate the schema class container object.</span></span>
13. <span data-ttu-id="7eeb7-142">Llamadas específicas del sistema operativo (RegDSAPI. cpp).</span><span class="sxs-lookup"><span data-stu-id="7eeb7-142">Operating-system specific calls (RegDSAPI.cpp).</span></span> <span data-ttu-id="7eeb7-143">Esto incluye todas las llamadas que hacen referencia al sistema operativo nativo.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-143">This includes all calls that reference the native operating system.</span></span> <span data-ttu-id="7eeb7-144">Entre otras funciones, incluyen funciones de apertura, cierre, lectura y modificación de objetos, así como de los que tienen acceso al esquema y a los datos de propiedades.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-144">Among other functions, they include functions opening, closing, reading, and modifying objects as well as those accessing the schema and property data.</span></span> <span data-ttu-id="7eeb7-145">El componente de proveedor de ejemplo se produjo para simular una jerarquía de directorios mediante el registro.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-145">The example provider component happened to simulate a directory hierarchy by using the registry.</span></span> <span data-ttu-id="7eeb7-146">Solo los nombres de función deben ser de gran interés para un escritor de proveedores.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-146">Only function names should be of much interest to a provider writer.</span></span>
14. <span data-ttu-id="7eeb7-147">Implementación de [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) (Cdispmgr. cpp).</span><span class="sxs-lookup"><span data-stu-id="7eeb7-147">[**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) implementation (Cdispmgr.cpp).</span></span> <span data-ttu-id="7eeb7-148">Este código tiene acceso a los datos de la biblioteca de tipos para permitir que se invoquen los métodos de interfaz de una manera compatible con la automatización.</span><span class="sxs-lookup"><span data-stu-id="7eeb7-148">This code accesses the type library data to allow interface methods to be invoked in an Automation-compatible way.</span></span>

 

 