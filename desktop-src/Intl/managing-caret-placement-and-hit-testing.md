---
description: Los lenguajes de script complejos se dividen en clústeres por ScriptShape. La reordenación de caracteres siempre se produce dentro de los límites del clúster. Se garantiza que los propios clústeres avanzan en la dirección del orden de lectura.
ms.assetid: 50b4b643-af96-4a6f-80f9-27a71ce16b0e
title: Administrar la ubicación del símbolo de intercalación y la prueba de posicionamiento
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 60396a668c89f7392b28adde0bb123060bf50348
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "105687091"
---
# <a name="managing-caret-placement-and-hit-testing"></a><span data-ttu-id="c50a4-105">Administrar la ubicación del símbolo de intercalación y la prueba de posicionamiento</span><span class="sxs-lookup"><span data-stu-id="c50a4-105">Managing Caret Placement and Hit Testing</span></span>

<span data-ttu-id="c50a4-106">Los lenguajes de script complejos se dividen en [clústeres](uniscribe-glossary.md) por [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape).</span><span class="sxs-lookup"><span data-stu-id="c50a4-106">Complex script languages are broken into [clusters](uniscribe-glossary.md) by [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape).</span></span> <span data-ttu-id="c50a4-107">La reordenación de caracteres siempre se produce dentro de los límites del clúster.</span><span class="sxs-lookup"><span data-stu-id="c50a4-107">Character reordering always occurs within cluster boundaries.</span></span> <span data-ttu-id="c50a4-108">Se garantiza que los propios clústeres avanzan en la dirección del orden de lectura.</span><span class="sxs-lookup"><span data-stu-id="c50a4-108">The clusters themselves are guaranteed to advance in the direction of the reading order.</span></span>

<span data-ttu-id="c50a4-109">La información del clúster en la matriz de clústeres lógicos se usa para compartir el ancho de un clúster de glifos equitativamente entre los caracteres lógicos que representan.</span><span class="sxs-lookup"><span data-stu-id="c50a4-109">Cluster information in the logical cluster array is used to share the width of a cluster of glyphs equally among the logical characters they represent.</span></span> <span data-ttu-id="c50a4-110">Por ejemplo, el glifo de Lam Alef se divide en cuatro áreas:</span><span class="sxs-lookup"><span data-stu-id="c50a4-110">For example, the lam alef glyph is divided into four areas:</span></span>

-   <span data-ttu-id="c50a4-111">La mitad inicial del Lam.</span><span class="sxs-lookup"><span data-stu-id="c50a4-111">The leading half of the lam.</span></span>
-   <span data-ttu-id="c50a4-112">La mitad final del Lam.</span><span class="sxs-lookup"><span data-stu-id="c50a4-112">The trailing half of the lam.</span></span>
-   <span data-ttu-id="c50a4-113">La mitad inicial del Alef.</span><span class="sxs-lookup"><span data-stu-id="c50a4-113">The leading half of the alef.</span></span>
-   <span data-ttu-id="c50a4-114">La mitad final del Alef.</span><span class="sxs-lookup"><span data-stu-id="c50a4-114">The trailing half of the alef.</span></span>

<span data-ttu-id="c50a4-115">Las convenciones de la ubicación del símbolo de intercalación dentro de los clústeres dependen del script.</span><span class="sxs-lookup"><span data-stu-id="c50a4-115">Conventions for caret placement within clusters depend on the script.</span></span> <span data-ttu-id="c50a4-116">En el caso del script árabe, si la posición del símbolo de intercalación se establece entre un carácter base y su marca de combinación, el símbolo de intercalación se muestra a la mitad del carácter base.</span><span class="sxs-lookup"><span data-stu-id="c50a4-116">For the Arabic script, if the caret position is set between a base character and its combining mark, the caret is displayed halfway through the base character.</span></span> <span data-ttu-id="c50a4-117">En el caso del script tailandés, el símbolo de intercalación no se puede colocar dentro de un clúster.</span><span class="sxs-lookup"><span data-stu-id="c50a4-117">For the Thai script, the caret cannot be positioned within a cluster.</span></span> <span data-ttu-id="c50a4-118">Por lo tanto, cuando el usuario avanza el símbolo de intercalación, la aplicación debe avanzar más allá de todos los glifos que componen el clúster.</span><span class="sxs-lookup"><span data-stu-id="c50a4-118">Thus, when the user advances the caret, the application must advance past all the glyphs that make up the cluster.</span></span>

<span data-ttu-id="c50a4-119">Las funciones [**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) y [**ScriptCPtoX**](/windows/desktop/api/Usp10/nf-usp10-scriptcptox) se convierten entre las posiciones del símbolo de intercalación (en desplazamientos de punto de código) y las posiciones x (en píxeles).</span><span class="sxs-lookup"><span data-stu-id="c50a4-119">The [**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) and [**ScriptCPtoX**](/windows/desktop/api/Usp10/nf-usp10-scriptcptox) functions translate between caret positions (in code point offsets) and x positions (in pixels).</span></span> <span data-ttu-id="c50a4-120">La función **ScriptXtoCP** tiene conocimiento de las convenciones de posición del símbolo de intercalación de cada script:</span><span class="sxs-lookup"><span data-stu-id="c50a4-120">The **ScriptXtoCP** function has knowledge of the caret position conventions of each script:</span></span>

-   <span data-ttu-id="c50a4-121">En el caso de India y tailandés, las posiciones del símbolo de intercalación se ajustan a los límites del clúster.</span><span class="sxs-lookup"><span data-stu-id="c50a4-121">For Indian and Thai, caret positions are snapped to cluster boundaries.</span></span>
-   <span data-ttu-id="c50a4-122">En el caso del árabe, las posiciones del símbolo de intercalación se interpolan con clústeres.</span><span class="sxs-lookup"><span data-stu-id="c50a4-122">For Arabic, caret positions are interpolated with clusters.</span></span>
-   <span data-ttu-id="c50a4-123">En el caso del hebreo, en las versiones anteriores a Usp10.dll, la versión 1,420, las posiciones del símbolo de intercalación se interpolan con los clústeres.</span><span class="sxs-lookup"><span data-stu-id="c50a4-123">For Hebrew, in versions prior to Usp10.dll, version 1.420, caret positions are interpolated with clusters.</span></span> <span data-ttu-id="c50a4-124">A partir de Usp10.dll, versión 1,420, las posiciones del símbolo de intercalación se ajustan a los límites del clúster.</span><span class="sxs-lookup"><span data-stu-id="c50a4-124">Beginning with Usp10.dll, version 1.420, caret positions are snapped to cluster boundaries.</span></span>

<span data-ttu-id="c50a4-125">Tanto [**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) como [**ScriptCPtoX**](/windows/desktop/api/Usp10/nf-usp10-scriptcptox) funcionan solo dentro de las ejecuciones.</span><span class="sxs-lookup"><span data-stu-id="c50a4-125">Both [**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) and [**ScriptCPtoX**](/windows/desktop/api/Usp10/nf-usp10-scriptcptox) operate only within runs.</span></span> <span data-ttu-id="c50a4-126">Las funciones requieren que determinados parámetros provienen de llamadas anteriores a la versión anterior, como se muestra en la tabla siguiente.</span><span class="sxs-lookup"><span data-stu-id="c50a4-126">The functions require that certain parameters come from earlier Uniscribe calls, as shown in the following table.</span></span>



| <span data-ttu-id="c50a4-127">Parámetro</span><span class="sxs-lookup"><span data-stu-id="c50a4-127">Parameter</span></span>                                        | <span data-ttu-id="c50a4-128">Source</span><span class="sxs-lookup"><span data-stu-id="c50a4-128">Source</span></span>                                                 |
|--------------------------------------------------|--------------------------------------------------------|
| <span data-ttu-id="c50a4-129">*PSA*</span><span class="sxs-lookup"><span data-stu-id="c50a4-129">*psa*</span></span>                                            | <span data-ttu-id="c50a4-130">Tal y como lo devuelve [**ScriptItemize**](/windows/desktop/api/Usp10/nf-usp10-scriptitemize).</span><span class="sxs-lookup"><span data-stu-id="c50a4-130">As returned by [**ScriptItemize**](/windows/desktop/api/Usp10/nf-usp10-scriptitemize).</span></span> |
| <span data-ttu-id="c50a4-131">*cGlyphspwLogClust*</span><span class="sxs-lookup"><span data-stu-id="c50a4-131">*cGlyphspwLogClust*</span></span><br/> <span data-ttu-id="c50a4-132">*psva*</span><span class="sxs-lookup"><span data-stu-id="c50a4-132">*psva*</span></span><br/> | <span data-ttu-id="c50a4-133">Tal y como lo devuelve [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape).</span><span class="sxs-lookup"><span data-stu-id="c50a4-133">As returned by [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape).</span></span>     |
| <span data-ttu-id="c50a4-134">*piAdvance*</span><span class="sxs-lookup"><span data-stu-id="c50a4-134">*piAdvance*</span></span>                                      | <span data-ttu-id="c50a4-135">Tal y como lo devuelve [**ScriptPlace**](/windows/desktop/api/Usp10/nf-usp10-scriptplace).</span><span class="sxs-lookup"><span data-stu-id="c50a4-135">As returned by [**ScriptPlace**](/windows/desktop/api/Usp10/nf-usp10-scriptplace).</span></span>     |



 

<span data-ttu-id="c50a4-136">La aplicación debe establecer la ejecución en la que un determinado desplazamiento de símbolo de intercalación o posición x es antes de pasar la información a [**ScriptCPtoX**](/windows/desktop/api/Usp10/nf-usp10-scriptcptox) o [**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp).</span><span class="sxs-lookup"><span data-stu-id="c50a4-136">The application must establish the run in which a given caret offset or x position is before passing the information to [**ScriptCPtoX**](/windows/desktop/api/Usp10/nf-usp10-scriptcptox) or [**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp).</span></span> <span data-ttu-id="c50a4-137">Si la aplicación no guarda la información de ancho, puede realizar la prueba de posicionamiento y la posición del símbolo de intercalación después de mostrar cada ejecución.</span><span class="sxs-lookup"><span data-stu-id="c50a4-137">If the application does not save the width information, it can do hit testing and caret placement after displaying each run.</span></span> <span data-ttu-id="c50a4-138">Como alternativa, la aplicación puede almacenar en memoria caché suficiente información para realizar la prueba de posicionamiento y la posición del símbolo de intercalación en la línea actual sin necesidad de volver a procesar el párrafo.</span><span class="sxs-lookup"><span data-stu-id="c50a4-138">As an alternative, the application can cache enough information to do hit testing and caret placement on the current line without requiring reprocessing of the paragraph.</span></span>

<span data-ttu-id="c50a4-139">[**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) devuelve un valor de borde final para que la aplicación conozca el lado del carácter o el clúster en el que el usuario ha haga clic.</span><span class="sxs-lookup"><span data-stu-id="c50a4-139">[**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) returns a trailing edge value so that the application knows the side of the character or cluster on which the user has clicked.</span></span> <span data-ttu-id="c50a4-140">El valor es 0 o el ancho del carácter o clúster en los puntos de código.</span><span class="sxs-lookup"><span data-stu-id="c50a4-140">The value is either 0 or the width of the character or cluster in code points.</span></span> <span data-ttu-id="c50a4-141">La posición del carácter devuelto es la posición del carácter en el que el usuario hizo clic.</span><span class="sxs-lookup"><span data-stu-id="c50a4-141">The returned character position is the position of the character on which the user clicked.</span></span> <span data-ttu-id="c50a4-142">Para obtener más información, vea [Mostrar el símbolo de intercalación en cadenas bidireccionales](displaying-the-caret-in-bidirectional-strings.md).</span><span class="sxs-lookup"><span data-stu-id="c50a4-142">For more information, see [Displaying the Caret in Bidirectional Strings](displaying-the-caret-in-bidirectional-strings.md).</span></span>

<span data-ttu-id="c50a4-143">En el caso de idiomas como el tailandés, para los que el usuario convencional no desea colocar el símbolo de intercalación en un clúster, [**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) establece la marca lateral final en 0 o en el ancho del clúster.</span><span class="sxs-lookup"><span data-stu-id="c50a4-143">For languages such as Thai, for which the user conventionally does not want to place the caret into a cluster, [**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) sets the trailing side flag to 0 or to the cluster width.</span></span> <span data-ttu-id="c50a4-144">En el caso de idiomas como el árabe, para los que el usuario espera poder editar dentro de un clúster, **ScriptXtoCP** establece la marca lateral final en 0 o en 1.</span><span class="sxs-lookup"><span data-stu-id="c50a4-144">For languages such as Arabic, for which the user expects to be able to edit within a cluster, **ScriptXtoCP** sets the trailing side flag to 0 or to 1.</span></span>

<span data-ttu-id="c50a4-145">Para ayudar a la aplicación a establecer ubicaciones válidas para el símbolo de intercalación al controlar las teclas de dirección, Uniscribe proporciona información sobre las posiciones de símbolo de intercalación válidas en el miembro **fCharStop** en los atributos lógicos devueltos por [**ScriptBreak**](/windows/desktop/api/Usp10/nf-usp10-scriptbreak).</span><span class="sxs-lookup"><span data-stu-id="c50a4-145">To help the application establish valid locations for the caret when handling the arrow keys, Uniscribe provides information on valid caret positions in the **fCharStop** member in the logical attributes returned by [**ScriptBreak**](/windows/desktop/api/Usp10/nf-usp10-scriptbreak).</span></span> <span data-ttu-id="c50a4-146">**True** se devuelve para la mayoría de los caracteres y **false** para los caracteres de interagrupación en scripts como tailandés.</span><span class="sxs-lookup"><span data-stu-id="c50a4-146">**TRUE** is returned for most characters and **FALSE** for intercluster characters in scripts such as Thai.</span></span> <span data-ttu-id="c50a4-147">La aplicación debe comprobar el valor de **fNeedsCaretInfo** en la estructura de [**\_ propiedades de script**](/windows/desktop/api/Usp10/ns-usp10-script_properties) de un elemento para ver si es necesario llamar a **ScriptBreak** para comprobar si hay posiciones de símbolo de intercalación válidas.</span><span class="sxs-lookup"><span data-stu-id="c50a4-147">The application should check the **fNeedsCaretInfo** value in the [**SCRIPT\_PROPERTIES**](/windows/desktop/api/Usp10/ns-usp10-script_properties) structure for an item to see if it is necessary to call **ScriptBreak** to check for valid caret positions.</span></span> <span data-ttu-id="c50a4-148">Si el valor de **fNeedsCaretInfo** es **false**, todos los puntos de código son posiciones de símbolo de intercalación válidas.</span><span class="sxs-lookup"><span data-stu-id="c50a4-148">If the **fNeedsCaretInfo** value is **FALSE**, all code points are valid caret positions.</span></span>

## <a name="related-topics"></a><span data-ttu-id="c50a4-149">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="c50a4-149">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c50a4-150">Usar Uniscribe</span><span class="sxs-lookup"><span data-stu-id="c50a4-150">Using Uniscribe</span></span>](using-uniscribe.md)
</dt> </dl>

 

 




