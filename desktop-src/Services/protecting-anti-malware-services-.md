---
description: Obtenga información acerca de cómo proteger los servicios de modo de usuario de antimalware (AM) y cómo puede optar por incluir esta característica en el servicio antimalware.
ms.assetid: 88875a0d-9027-43f2-8411-34f9ff428fe5
title: Protección de los servicios antimalware
ms.topic: article
ms.date: 08/02/2018
ms.openlocfilehash: 5e7783eb307381d368900332b5e761ad62785913
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "104083341"
---
# <a name="protecting-anti-malware-services"></a>Protección de los servicios antimalware

Windows 8.1 presentó un nuevo concepto de servicios protegidos para proteger los servicios antimalware, que son un objetivo frecuente de ataques por malware.

Obtenga información acerca de cómo proteger los servicios de modo de usuario de antimalware (AM) y cómo puede optar por incluir esta característica en el servicio antimalware.

Esta información se aplica a los siguientes sistemas operativos y sus sucesores:

-   Windows 8.1
-   Windows Server 2012 R2

Las referencias y los recursos que se describen aquí se enumeran al final de este tema.

## <a name="introduction"></a>Introducción

La mayoría de las soluciones antimalware incluyen un servicio de modo de usuario que realiza operaciones especializadas para detectar y quitar malware del sistema. Este servicio de modo de usuario también es responsable de descargar las últimas definiciones de virus y firmas. Este servicio de modo de usuario se convierte en un objetivo frecuente de malware porque es el único punto de error en la deshabilitación de la protección en un sistema. Para defenderse contra los ataques en el servicio de modo de usuario, los proveedores de protección contra malware tienen que agregar una gran cantidad de funcionalidad e heurística a su software. Sin embargo, estas técnicas no son completamente infalibles y tienden a ser propensas a errores porque tienen que identificar la funcionalidad que Windows realiza en su servicio y habilitar selectivamente esa funcionalidad.

En Windows 8.1, se ha introducido un nuevo concepto de servicio protegido para permitir que los servicios de modo de usuario antimalware se inicien como un servicio protegido. Una vez que el servicio se inicia como protegido, Windows usa la integridad del código para permitir que solo se cargue el código de confianza en el servicio protegido. Windows también protege estos procesos de la inyección de código y otros ataques desde los procesos de administración.

En este documento se describe el modo en que un proveedor de protección contra malware con un controlador antimalware de inicio temprano (ELAM) puede participar en esta característica e iniciar su servicio antimalware como un servicio protegido.

## <a name="system-protected-process"></a>Proceso protegido por el sistema

A partir de Windows 8.1, se ha puesto en marcha un nuevo modelo de seguridad en el kernel para defenderse mejor contra ataques malintencionados en componentes críticos del sistema. Este nuevo modelo de seguridad amplía la infraestructura de procesos protegidos versiones anteriores de Windows que se usan para escenarios específicos, como la reproducción de contenido DRM, en un modelo de uso general que pueden usar los proveedores de software antimalware de terceros. La infraestructura de procesos protegidos solo permite la carga de código de confianza y firmado, y tiene defensa integrada frente a los ataques por inyección de código.

Vea [procesos protegidos en Windows Vista](https://download.microsoft.com/download/a/f/7/af7777e5-7dcd-4800-8a0a-b18336565f5b/process_vista.doc) para obtener más información sobre los procesos protegidos.

El nuevo modelo de seguridad usa una variante ligeramente diferente de la infraestructura de proceso de protección denominada proceso protegido por el sistema, que es más adecuada para esta característica, ya que mantiene el contenido DRM separado. Cada proceso protegido por el sistema tiene un nivel o atributo asociado, que indica la Directiva de firma del código firmado que se permite cargar en el proceso. Una vez que los servicios antimalware han optado por el modo de servicio protegido, solo se permite cargar en ese proceso el código firmado de Windows o el código firmado con los certificados del proveedor de antimalware. Del mismo modo, otros niveles de proceso protegidos tienen directivas de código diferentes aplicadas por Windows.

## <a name="requirements"></a>Requisitos

Para que un servicio de modo de usuario antimalware se ejecute como un servicio protegido, el proveedor de protección contra malware debe tener un controlador ELAM instalado en la máquina Windows. Además de los requisitos de certificación existentes del controlador ELAM, el controlador debe tener una sección de recursos incrustados que contenga la información de los certificados utilizados para firmar los archivos binarios del servicio de modo de usuario.

> [!IMPORTANT]
> En Windows 8.1, la cadena de certificación debe ser una raíz conocida determinada por la comprobación del controlador, o bien se debe incluir el certificado raíz.

 

Durante el proceso de arranque, esta sección de recursos se extraerá del controlador ELAM para validar la información del certificado y registrar el servicio antimalware. El servicio antimalware también puede registrarse durante el proceso de instalación del software antimalware mediante una llamada a una API especial, como se describe más adelante en este documento.

Una vez que la sección de recursos se extrae correctamente del controlador ELAM y el servicio de modo de usuario está registrado, el servicio puede iniciarse como servicio protegido. Una vez que el servicio se inicia como protegido, otros procesos no protegidos del sistema no podrán inyectar subprocesos y no se les permitirá escribir en la memoria virtual del proceso protegido.

Además, cualquier dll que no sea de Windows que se cargue en el proceso protegido debe estar firmado con un certificado adecuado.

Vea [antimalware de inicio temprano](/windows/desktop/w8cookbook/secured-boot) para obtener más información sobre los controladores de Elam.

### <a name="anti-malware-service-signing-requirements"></a>Requisitos de firma del servicio antimalware

El servicio de modo de usuario que debe iniciarse como protegido debe estar firmado con certificados válidos. El archivo EXE del servicio debe tener la firma de hash de página y cualquier dll que no sea de Windows que se cargue en el servicio también debe estar firmado con los mismos certificados. El hash de estos certificados se debe agregar al archivo de recursos, que se vinculará al controlador ELAM.

> [!Note]  
> Los hashes de archivo o página SHA256 deben usarse, aunque los certificados pueden seguir siendo SHA1.

 

### <a name="primary-signature-recommended"></a>Firma principal (recomendado)

Se recomienda que los proveedores de protección contra malware utilicen su certificado Authenticode existente para firmar sus archivos binarios del servicio antimalware y que el hash de este certificado Authenticode se incluya en la sección de recursos para indicar el certificado que se usa para firmar los archivos binarios del servicio. Si actualiza este certificado, se debe liberar una versión más reciente del controlador ELAM con los hash de certificado actualizados.

### <a name="secondary-signature-optional"></a>Firma secundaria (opcional)

Los proveedores de protección contra malware tienen la opción de configurar una CA privada y usar certificados de esta CA para firmar el código de los binarios del servicio antimalware como una firma secundaria. La principal ventaja de utilizar la entidad de certificación privada es que permite a los proveedores crear certificados con una propiedad de EKU especializada, que se puede utilizar para diferenciar entre varios productos del mismo proveedor. También reduce la necesidad de actualizar el controlador de ELAM debido a la expiración del certificado, ya que los certificados de la entidad de certificación privada normalmente tienen fechas de expiración más largas.

Tenga en cuenta que si los archivos binarios de servicio están firmados con certificados de entidad de certificación privados, los archivos binarios también deben estar firmados con dos certificados de Authenticode. Si los archivos binarios no están firmados por una CA de confianza conocida (por ejemplo, VeriSign), el usuario del equipo no tiene confianza en los archivos binarios porque no pueden confiar en la CA privada. La firma doble de los binarios con el certificado Authenticode existente también permite que los archivos binarios se ejecuten en sistemas operativos de nivel inferior.

Para obtener más información sobre cómo configurar e instalar la entidad de certificación, consulte [configuración de una entidad](/previous-versions/windows/desktop/ms755466(v=vs.85)) de [certificación e instalación de la entidad de certificación](/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/jj125375(v=ws.11)).

> [!Note]  
> Por compatibilidad con Windows Vista o Windows XP (o Windows 7 sin la revisión SHA2), puede usar el modificador "/as" al firmar los archivos binarios con [SignTool.exe](/windows/desktop/SecCrypto/signtool) con los hashes de página o archivo SHA256. Esto agregará la firma como una firma secundaria al archivo. SHA1 firme primero el archivo, ya que Windows XP, Windows Vista y Windows 7 solo verán la primera firma.

 

### <a name="dll-signing-requirements"></a>Requisitos de firma de DLL

Como se mencionó anteriormente, todos los archivos DLL que no sean de Windows que se carguen en el servicio protegido deben estar firmados con el mismo certificado que se usó para firmar el servicio antimalware.

### <a name="catalog-signing"></a>Firma de catálogos

Los proveedores de protección contra malware pueden incluir paquetes desarrollados por otras compañías sin actualizar las firmas binarias. Esto puede lograrse incluyendo los archivos binarios en un catálogo que está firmado con su certificado Authenticode, para lo que debe seguir estos pasos:

1. Generación de un catálogo mediante [MakeCat](/windows/desktop/SecCrypto/makecat)
2. Agregar todos los archivos binarios sin una firma adecuada al catálogo
3. Firmar el catálogo con el certificado Authenticode, como haría con cualquier otro archivo binario
4. Utilice la función [Agregar Catálogo](/windows/desktop/api/Mscat/nf-mscat-cryptcatadminaddcatalog) para incluir el catálogo con la aplicación.

Cuando la integridad del código se encuentra entre los paquetes sin una firma adecuada, buscará un catálogo con una firma aprobada. Encontrará este catálogo siempre y cuando se sigan estos pasos y se instale con la aplicación.


## <a name="resource-file-info"></a>Información del archivo de recursos

Debe crearse un archivo de recursos y vincularse al controlador ELAM. El hash del certificado, junto con otra información del certificado, se debe agregar en el archivo de recursos.

La sección de recursos debe estar en el diseño siguiente para que el sistema Extraiga correctamente los recursos de la imagen binaria y valide la información del certificado insertado.

``` syntax
MicrosoftElamCertificateInfo  MSElamCertInfoID
{
      3, // count of entries
      L”CertHash1\0”,
      Algorithm,
      L”EKU1\0”,
      L”CertHash2\0”,
      Algorithm,
      L”\0”, //No EKU for cert hash 2
      L”CertHash3\0”,
      Algorithm,
      L”EKU3a;EKU3b;EKU3c\0”,  //multiple EKU entries supported (max: 3)
}
```

Para obtener más información sobre el archivo de recursos definido por el usuario, consulte [recurso definido por el usuario](/windows/desktop/menurc/user-defined-resource).

### <a name="certhash"></a>CertHash

El hash del certificado que se usa para firmar el servicio antimalware. La herramienta CertMgr.exe, que se incluye en el Windows SDK, se puede utilizar para obtener el hash.

``` syntax
certmgr.exe –v <path to the signed file>
```

Por ejemplo:

![hash de certificado de servicio protegido contra malware (certhash)](images/cert-hash-example.png)

### <a name="algorithm"></a>Algoritmo

El valor del algoritmo representa el algoritmo del certificado. Se admiten estos valores de algoritmo:

<dl> 0x8004: SHA1  
0x800c – SHA256  
0X800d: SHA384  
0x800e: SHA512  
</dl>

No olvide incluir el valor del algoritmo (como se mostró anteriormente) y no el nombre real del algoritmo. Por ejemplo, si el certificado se basa en el algoritmo SHA256, incluya 0x800c en la sección de recursos.

### <a name="eku"></a>EKU

El objeto EKU representa una única propiedad de uso de clave extendida (EKU) de un certificado. Esto es opcional y \\ se debe especificar "0" si no hay EKU asociados al certificado. En el caso de que haya varios productos y servicios de un solo proveedor de antimalware que se ejecute en el mismo sistema, el proveedor de antimalware puede usar la propiedad EKU del certificado de entidad de certificación privada para diferenciar un servicio de otro. Por ejemplo, si hay dos servicios que se ejecutan en el sistema desde el mismo proveedor de protección contra malware y están firmados por la misma CA, el servicio que debe iniciarse como protegido puede firmarse con un certificado emitido por una CA que contenga un EKU especial. Este EKU debe agregarse a la sección de recursos. Después, el sistema registra el EKU y se empareja con el hash del certificado para validar e iniciar el servicio como protegido.

Tenga en cuenta que la cadena de certificados debe incluir el EKU de firma de código (1.3.6.1.5.5.7.3.3), pero este EKU no debe incluirse en la sección de recursos del controlador ELAM.

> [!Note]  
> Si se incluye información de EKU en la información del certificado para el controlador ELAM, se debe usar el mismo EKU al firmar los archivos binarios.

 

### <a name="count"></a>Count

Si el binario del servicio antimalware está firmado con el certificado Authenticode y el certificado de entidad de certificación privada, solo se debe agregar la información del certificado de entidad de certificación privada en la sección de recursos.

## <a name="launching-anti-malware-services-as-protected"></a>Inicio de servicios antimalware protegidos

### <a name="registering-the-service"></a>Registrar el servicio

El servicio antimalware debe estar registrado con el sistema para que se pueda iniciar como protegido. Durante la instalación del software antimalware, el instalador puede instalar el controlador ELAM y reiniciar el sistema para registrar automáticamente el servicio. El sistema registrará el servicio en el momento del arranque mediante la extracción de la información del certificado del archivo de recursos mencionado anteriormente que está vinculado al controlador ELAM.

Durante la fase de instalación, se recomienda encarecidamente reiniciar el sistema para que se cargue el controlador ELAM y se valide el estado del sistema. Sin embargo, para los casos en los que se debe evitar un reinicio, Windows también expone un mecanismo para que el instalador antimalware registre el servicio como protegido mediante una API.

### <a name="registering-the-service-without-rebooting-the-system"></a>Registro del servicio sin reiniciar el sistema

Durante la instalación, un instalador de software antimalware puede llamar a la API [**InstallELAMCertificateInfo**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-installelamcertificateinfo) y proporcionar un identificador al archivo del controlador Elam. El sistema abre el controlador ELAM, llama a las rutinas internas para asegurarse de que el controlador ELAM está firmado correctamente y extrae la información del certificado de la sección de recursos asociada al controlador ELAM. Para ver la sintaxis de la función, vea [**InstallELAMCertificateInfo**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-installelamcertificateinfo).

Ejemplo de código:


```C++
HANDLE FileHandle = NULL;

FileHandle = CreateFile(<Insert Elam driver file name>,
                        FILE_READ_DATA,
                        FILE_SHARE_READ,
                        NULL,
                        OPEN_EXISTING,
                        FILE_ATTRIBUTE_NORMAL,
                        NULL
                        );

if (InstallElamCertificateInfo(FileHandle) == FALSE)
{
    Result = GetLastError();
    goto exitFunc;
}
```



### <a name="starting-the-service-as-protected"></a>Iniciar el servicio como protegido

El instalador puede seguir estos pasos para crear, configurar e iniciar el servicio como protegido:

1.  Llame a la API [**CreateService**](/windows/desktop/api/Winsvc/nf-winsvc-createservicea) para crear un objeto de servicio y agregarlo a la base de datos del administrador de control de servicios (SCM).
2.  Llame a la API [**SetServiceObjectSecurity**](/windows/desktop/api/winsvc/nf-winsvc-setserviceobjectsecurity) para establecer el descriptor de seguridad del objeto de servicio creado en el paso 1.
3.  Llame a la API de [**ChangeServiceConfig2**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a) para marcar el servicio como protegido, especificando el nuevo valor de enumeración protegido de inicio de configuración de servicio, que se ha agregado en Winsvc. h (a partir de Windows 8.1). **\_ \_ \_**

    Ejemplo de código:

    ```C++
    SERVICE_LAUNCH_PROTECTED_INFO Info;
    SC_HANDLE hService;

    Info.dwLaunchProtected = SERVICE_LAUNCH_PROTECTED_ANTIMALWARE_LIGHT;

    hService = CreateService (/* ... */);

    if (ChangeServiceConfig2(hService,
                             SERVICE_CONFIG_LAUNCH_PROTECTED,
                             &Info) == FALSE)
    {
        Result = GetLastError();
    }
    ```

    

4.  Llame a la API de [**StartService**](/windows/desktop/api/Winsvc/nf-winsvc-startservicea) para iniciar el servicio. Al iniciar el servicio como protegido, SCM comprueba con el subsistema de integridad de código (CI) para validar la información del certificado. Una vez que el CI valida la información del certificado, SCM inicia el servicio como protegido.
    1.  Tenga en cuenta que en este paso se produce un error si no ha registrado el servicio mediante una llamada a la API [**InstallELAMCertificateInfo**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-installelamcertificateinfo) .
    2.  Si el servicio se ha configurado para iniciarse automáticamente durante la fase de inicio del sistema, puede evitar este paso y simplemente reiniciar el sistema. Durante un reinicio, el sistema registra automáticamente el servicio (si el controlador ELAM se inicia correctamente) e inicia el servicio en modo protegido.

### <a name="launching-a-child-process-as-protected"></a>Iniciar un proceso secundario como protegido

El nuevo modelo de seguridad también permite que los servicios protegidos contra malware inicien procesos secundarios como protegidos. Estos procesos secundarios se ejecutarán en el mismo nivel de protección que el servicio primario y sus archivos binarios deben estar firmados con el mismo certificado que se ha registrado a través de la sección de recursos de ELAM.

Con el fin de permitir que el servicio protegido contra malware ejecute el proceso secundario como protegido, se ha expuesto una nueva clave de atributo extendido, el **nivel de protección de \_ \_ atributo \_ \_ de subprocesos**, y debe usarse con la API de [**UpdateProcThreadAttribute**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-updateprocthreadattribute) . Un puntero al valor de atributo de **nivel de protección \_ \_ igual** debe pasarse a la API **UpdateProcThreadAttribute** .

Notas:

-   Para usar este nuevo atributo, el servicio también debe especificar **Create \_ Protected \_ Process** en el parámetro flags de creación de procesos de la llamada [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa) .
-   Necesita que los archivos binarios del servicio estén firmados mediante el modificador/AC para incluir el certificado cruzado para encadenarlo a una CA conocida. El certificado autofirmado sin el encadenamiento adecuado a una CA raíz conocida no funcionará.

Ejemplo de código:


```C++
DWORD ProtectionLevel = PROTECTION_LEVEL_SAME;
SIZE_T AttributeListSize;

STARTUPINFOEXW StartupInfoEx = { 0 };

StartupInfoEx.StartupInfo.cb = sizeof(StartupInfoEx);

if (InitializeProcThreadAttributeList(NULL,
                                      1,
                                      0,
                                      &AttributeListSize) == FALSE)
{
    Result = GetLastError();
    goto exitFunc;
}

StartupInfoEx.lpAttributeList = (LPPROC_THREAD_ATTRIBUTE_LIST) HeapAlloc(
    GetProcessHeap(),
    0,
    AttributeListSize
    );

if (InitializeProcThreadAttributeList(StartupInfoEx.lpAttributeList,
                                      1,
                                      0,
                                      &AttributeListSize) == FALSE)
{
    Result = GetLastError();
    goto exitFunc;
}

if (UpdateProcThreadAttribute(StartupInfoEx.lpAttributeList,
                              0,
                              PROC_THREAD_ATTRIBUTE_PROTECTION_LEVEL,
                              &ProtectionLevel,
                              sizeof(ProtectionLevel),
                              NULL,
                              NULL) == FALSE)
{
    Result = GetLastError();
    goto exitFunc;
}

PROCESS_INFORMATION ProcessInformation = { 0 };

if (CreateProcessW(ApplicationName,
                   CommandLine,
                   ProcessAttributes,
                   ThreadAttributes,
                   InheritHandles,
                   EXTENDED_STARTUPINFO_PRESENT | CREATE_PROTECTED_PROCESS,
                   Environment,
                   CurrentDirectory,
                   (LPSTARTUPINFOW)&StartupInfoEx,
                   &ProcessInformation) == FALSE)
{
    Result = GetLastError();
    goto exitFunc;
}
```



## <a name="updates-and-servicing"></a>Actualizaciones y mantenimiento

Después de que el servicio antimalware se inicie como protegido, otros procesos no protegidos (e incluso administradores) no podrán detener el servicio. En el caso de las actualizaciones de los archivos binarios del servicio, el servicio antimalware debe recibir una devolución de llamada desde el instalador para detenerse para que se pueda atender. Una vez detenido el servicio, el instalador antimalware puede realizar actualizaciones y, a continuación, seguir los pasos descritos anteriormente en las secciones [registrar el servicio](https://www.bing.com/search?q=Registering+the+service) e [iniciar el servicio como protegido](#starting-the-service-as-protected) para registrar el certificado e iniciar el servicio como protegido.

Tenga en cuenta que el servicio debe asegurarse de que solo los llamadores de confianza pueden detener el servicio. Permitir a los autores de llamadas que no son de confianza anula el propósito de proteger el servicio.

### <a name="unregistering-the-service"></a>Anulando el registro del servicio

Al desinstalar un servicio protegido, el servicio debe marcarse como no protegido mediante una llamada a la API de [**ChangeServiceConfig2**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a) . Tenga en cuenta que, dado que el sistema no permite ningún proceso no protegido para modificar la configuración de un servicio protegido, el propio servicio protegido debe realizar la llamada a [**ChangeServiceConfig2**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a) . Una vez que el servicio se ha reconfigurado para ejecutarse como desprotegido, el desinstalador solo puede tomar los pasos adecuados para quitar el software antimalware del sistema.

## <a name="debugging-an-anti-malware-protected-service"></a>Depuración de un servicio protegido contra malware

Como parte del modelo de seguridad del proceso protegido, otros procesos no protegidos no pueden insertar subprocesos ni escribir en la memoria virtual del proceso protegido. Sin embargo, se permite un depurador de kernel (KD) para depurar los procesos protegidos contra malware. KD también se puede usar para comprobar si el servicio antimalware se está ejecutando como protegido o no:

``` syntax
dt –r1 nt!_EPROCESS <Process Address>
+0x67a Protection       : _PS_PROTECTION
      +0x000 Level            : 0x31 '1'
      +0x000 Type             : 0y0001
      +0x000 Signer           : 0y0011
```

Si el valor del miembro de *tipo* es 0y0001, el servicio se está ejecutando como protegido.

Además, solo se permiten los siguientes comandos de SC en el servicio protegido contra malware:

-   `sc config start=Auto`
-   `sc qc`
-   `sc start`
-   `sc interrogate`
-   `sc sdshow`

Si el depurador está asociado, use la siguiente marca del registro para interrumpir el depurador cuando se carguen binarios sin firmar (o firmados incorrectamente) en el servicio protegido contra malware.

``` syntax
Key:   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\CI
Value: DebugFlags      REG_DWORD
```

Establezca el valor en **00000400** para interrumpir el depurador cuando se produzca un error en la validación de la firma.

> [!Note]  
> Limitaciones del proceso protegido:
>
> 1.  Los procesos que tienen interfaz de usuario o GUI no se pueden proteger debido a la manera en que el kernel bloquea un proceso en la memoria y no permite escribir en él.
> 2.  Antes de Windows 10, versión 1703 (Creators Update), los procesos protegidos no pueden usar los protocolos de comunicación TLS o SSL debido a las limitaciones del uso compartido de certificados entre la autoridad de seguridad local (LSA) y un proceso protegido.

 

## <a name="resources"></a>Recursos

Para obtener más información, consulta:

-   [Antimalware de inicio temprano](/windows/desktop/w8cookbook/secured-boot)
-   [Procesos protegidos en Windows Vista](/previous-versions/windows/hardware/download/dn550976(v=vs.85))
-   [Configuración de una entidad de certificación](/previous-versions/windows/desktop/ms755466(v=vs.85))
-   [Instalar la entidad de certificación](/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/jj125375(v=ws.11))
-   [Recurso definido por el usuario](/windows/desktop/menurc/user-defined-resource)

En este artículo se hace referencia a estas funciones de la API de Windows:

-   [**ChangeServiceConfig2**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a)
-   [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa)
-   [**CreateService**](/windows/desktop/api/Winsvc/nf-winsvc-createservicea)
-   [**InitializeProcThreadAttributeList**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-initializeprocthreadattributelist)
-   [**InstallELAMCertificateInfo**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-installelamcertificateinfo)
-   [**SetServiceObjectSecurity**](/windows/desktop/api/winsvc/nf-winsvc-setserviceobjectsecurity)
-   [**StartService**](/windows/desktop/api/Winsvc/nf-winsvc-startservicea)
-   [**UpdateProcThreadAttribute**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-updateprocthreadattribute)

 

 
