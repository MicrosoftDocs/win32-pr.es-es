---
title: Configuración de la seguridad de Process-Wide con CoInitializeSecurity
description: La función CoInitializeSecurity permite controlar escenarios de seguridad complejos estableciendo la seguridad de una aplicación mediante programación.
ms.assetid: 20b66868-fb9a-489f-97a2-59a8a825c8d9
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 567a6dfaf47dbd278fc248558cd25969c733b24a
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/21/2020
ms.locfileid: "104421473"
---
# <a name="setting-process-wide-security-with-coinitializesecurity"></a><span data-ttu-id="07fc1-103">Configuración de la seguridad de Process-Wide con CoInitializeSecurity</span><span class="sxs-lookup"><span data-stu-id="07fc1-103">Setting Process-Wide Security with CoInitializeSecurity</span></span>

<span data-ttu-id="07fc1-104">La función [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) permite controlar escenarios de seguridad complejos estableciendo la seguridad de una aplicación mediante programación.</span><span class="sxs-lookup"><span data-stu-id="07fc1-104">The [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) function allows you to control complex security scenarios by setting security for an application programmatically.</span></span> <span data-ttu-id="07fc1-105">En este tema se describen los escenarios en los que puede usar **CoInitializeSecurity** y se proporcionan algunos detalles sobre su uso.</span><span class="sxs-lookup"><span data-stu-id="07fc1-105">This topic describes scenarios when you might use **CoInitializeSecurity** and provides some details on how you use it.</span></span>

<span data-ttu-id="07fc1-106">Hay varias razones por las que podría querer usar [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) para establecer la seguridad de todo el proceso en el programa.</span><span class="sxs-lookup"><span data-stu-id="07fc1-106">There are several reasons why you might want to use [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) to set process-wide security within your program.</span></span> <span data-ttu-id="07fc1-107">Por ejemplo, aunque puede establecer el nivel de autenticación y los permisos de acceso para la aplicación mediante dcomcnfg.exe, es posible que el nivel de suplantación predeterminado del equipo no sea el que desee para su proceso.</span><span class="sxs-lookup"><span data-stu-id="07fc1-107">For example, although you can set the authentication level and the access permissions for the application using dcomcnfg.exe, the default impersonation level for the computer might not be the one you want for your process.</span></span> <span data-ttu-id="07fc1-108">La única manera de cambiar esta configuración para el proceso es llamar a **CoInitializeSecurity**.</span><span class="sxs-lookup"><span data-stu-id="07fc1-108">The only way to change this setting for your process is to call **CoInitializeSecurity**.</span></span>

<span data-ttu-id="07fc1-109">Si desea utilizar el proveedor de seguridad Schannel, debe especificarlo como un servicio de autenticación en una llamada a [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity).</span><span class="sxs-lookup"><span data-stu-id="07fc1-109">If you want to use the Schannel security provider, you must specify it as an authentication service in a call to [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity).</span></span>

<span data-ttu-id="07fc1-110">Otro escenario común en el que podría establecer la seguridad de todo el proceso mediante programación es cuando desea establecer la seguridad predeterminada para todo el proceso, pero tiene uno o más objetos dentro de ese proceso que exponen interfaces con requisitos de seguridad especiales.</span><span class="sxs-lookup"><span data-stu-id="07fc1-110">Another common scenario in which you might set process-wide security programmatically is when you would like to set default security for the entire process but you have one or more objects within that process that expose interfaces with special security requirements.</span></span> <span data-ttu-id="07fc1-111">En este caso, puede llamar a [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) para establecer la seguridad del proceso, lo que permite a com controlar la mayoría de las comprobaciones de seguridad, y puede llamar a otros métodos para establecer la seguridad de los objetos con necesidades de seguridad especiales.</span><span class="sxs-lookup"><span data-stu-id="07fc1-111">In this case, you can call [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) to set security for the process, allowing COM to handle most of the security checks, and you can call other methods to set security for the objects with special security needs.</span></span> <span data-ttu-id="07fc1-112">La llamada a estos métodos y funciones se describe en [configuración de la seguridad en el nivel del proxy de la interfaz](setting-security-at-the-interface-proxy-level.md).</span><span class="sxs-lookup"><span data-stu-id="07fc1-112">Calling these methods and functions is described in [Setting Security at the Interface Proxy Level](setting-security-at-the-interface-proxy-level.md).</span></span>

<span data-ttu-id="07fc1-113">Si su aplicación tiene requisitos de seguridad muy especializados, como permitir que determinados grupos tengan acceso a objetos diferentes en función de la hora del día, es posible que desee controlar toda la seguridad mediante programación, asegurándose de que COM no realiza ninguna comprobación automática en absoluto.</span><span class="sxs-lookup"><span data-stu-id="07fc1-113">If your application has very specialized security requirements, such as allowing certain groups access to different objects depending on the time of day, you might want to handle all of your security programmatically, ensuring that COM does no automatic checking for you at all.</span></span> <span data-ttu-id="07fc1-114">Para ello, debe llamar a [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity), establecer el parámetro *dwAuthnLevel* en None y el parámetro *pVoid* en **null**.</span><span class="sxs-lookup"><span data-stu-id="07fc1-114">To do this, you must call [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity), setting the *dwAuthnLevel* parameter to none and the *pVoid* parameter to **NULL**.</span></span> <span data-ttu-id="07fc1-115">Si tiene su propio paquete de seguridad, también debe registrarlo en el parámetro *pAuthnSvc* .</span><span class="sxs-lookup"><span data-stu-id="07fc1-115">If you have your own security package you would also need to register it in the *pAuthnSvc* parameter.</span></span> <span data-ttu-id="07fc1-116">Después, puede administrar toda su propia seguridad mediante programación a través de llamadas a la interfaz de nivel de proxy y las funciones descritas en [configuración de la seguridad en el nivel de proxy de la interfaz](setting-security-at-the-interface-proxy-level.md).</span><span class="sxs-lookup"><span data-stu-id="07fc1-116">Then you can handle all of your own security programmatically through calls to the proxy-level interface and functions described in [Setting Security at the Interface Proxy Level](setting-security-at-the-interface-proxy-level.md).</span></span>

<span data-ttu-id="07fc1-117">[**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) ofrece un amplio conjunto de funcionalidades.</span><span class="sxs-lookup"><span data-stu-id="07fc1-117">[**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) offers a rich set of capabilities.</span></span> <span data-ttu-id="07fc1-118">Si se llama a **CoInitializeSecurity**, se omiten los valores del registro y se usan en su lugar los valores de inicialización de seguridad que se pasan a la llamada.</span><span class="sxs-lookup"><span data-stu-id="07fc1-118">If you call **CoInitializeSecurity**, the registry values are ignored and the security initialization values you pass in to the call are used instead.</span></span> <span data-ttu-id="07fc1-119">Dependiendo del resultado que desee, el primer parámetro, *pVoid*, puede apuntar a tres tipos diferentes de valores: un [**\_ descriptor de seguridad**](/windows/desktop/api/winnt/ns-winnt-security_descriptor) , un objeto [**IAccessControl**](/windows/desktop/api/IAccess/nn-iaccess-iaccesscontrol) o un puntero a un AppID.</span><span class="sxs-lookup"><span data-stu-id="07fc1-119">Depending on the result you want, the first parameter, *pVoid*, can point to three different types of values: a [**SECURITY\_DESCRIPTOR**](/windows/desktop/api/winnt/ns-winnt-security_descriptor) , an [**IAccessControl**](/windows/desktop/api/IAccess/nn-iaccess-iaccesscontrol) object, or a pointer to an AppID.</span></span> <span data-ttu-id="07fc1-120">En la mayoría de los casos, usará funciones de Windows para crear un **\_ descriptor de seguridad** al que apuntará *pVoid* .</span><span class="sxs-lookup"><span data-stu-id="07fc1-120">In most cases, you will use Windows functions to create a **SECURITY\_DESCRIPTOR** that *pVoid* will point to.</span></span>

<span data-ttu-id="07fc1-121">Sin embargo, *pVoid* también puede apuntar a un objeto [**IAccessControl**](/windows/desktop/api/IAccess/nn-iaccess-iaccesscontrol) .</span><span class="sxs-lookup"><span data-stu-id="07fc1-121">However, *pVoid* can also point to an [**IAccessControl**](/windows/desktop/api/IAccess/nn-iaccess-iaccesscontrol) object.</span></span>

<span data-ttu-id="07fc1-122">Para indicar a [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) que está pasando un objeto [**IAccessControl**](/windows/desktop/api/IAccess/nn-iaccess-iaccesscontrol) a *pVoid*, debe pasar el \_ valor de control de acceso EOAC \_ al parámetro *dwCapabilities* .</span><span class="sxs-lookup"><span data-stu-id="07fc1-122">To indicate to [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) that you are passing an [**IAccessControl**](/windows/desktop/api/IAccess/nn-iaccess-iaccesscontrol) object to *pVoid*, you must pass the EOAC\_ACCESS\_CONTROL value to the *dwCapabilities* parameter.</span></span> <span data-ttu-id="07fc1-123">Dado que **CoInitializeSecurity** almacena en caché los resultados de las comprobaciones de acceso, la lista de control de acceso no se debe cambiar después de llamar a **CoInitializeSecurity**.</span><span class="sxs-lookup"><span data-stu-id="07fc1-123">Since **CoInitializeSecurity** caches the results of access checks, the access control list must not be changed after calling **CoInitializeSecurity**.</span></span>

<span data-ttu-id="07fc1-124">Otro tipo de valor que se puede pasar al parámetro *pVoid* es un puntero a un GUID, que es el AppID de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="07fc1-124">Another type of value you can pass to the *pVoid* parameter is a pointer to a GUID, which is the AppID of your application.</span></span> <span data-ttu-id="07fc1-125">Si *pVoid* es un puntero a un AppID, debe especificar EOAC \_ AppID en el parámetro *pCapabilities* para que la función sepa qué valor se debe esperar en *pVoid*.</span><span class="sxs-lookup"><span data-stu-id="07fc1-125">If *pVoid* is a pointer to an AppID, you must specify EOAC\_APPID in the *pCapabilities* parameter so that the function knows what value to expect in *pVoid*.</span></span> <span data-ttu-id="07fc1-126">Si *pVoid* apunta a un AppID, [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) solo usa el registro para los valores de autenticación y omite todos los demás parámetros en **CoInitializeSecurity**.</span><span class="sxs-lookup"><span data-stu-id="07fc1-126">If *pVoid* points to an AppID, [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) uses only the registry for authentication values and ignores all other parameters to **CoInitializeSecurity**.</span></span>

## <a name="related-topics"></a><span data-ttu-id="07fc1-127">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="07fc1-127">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="07fc1-128">Configuración de la seguridad de Process-Wide</span><span class="sxs-lookup"><span data-stu-id="07fc1-128">Setting Process-Wide Security</span></span>](setting-processwide-security.md)
</dt> </dl>

 

 