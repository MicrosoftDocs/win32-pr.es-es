---
description: Puede importar y exportar claves simétricas y claves asimétricas con CNG. Y puede usar la funcionalidad de importación y exportación de claves para trasladar claves entre equipos.
ms.assetid: 37bda1e0-5dd2-455c-9627-4e7e1b0e04d3
title: Importación y exportación de claves
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8be59cc5f5c4b3d1a98fa30cf4e967d5469d2f1f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "105666218"
---
# <a name="key-import-and-export"></a><span data-ttu-id="9cc4c-104">Importación y exportación de claves</span><span class="sxs-lookup"><span data-stu-id="9cc4c-104">Key Import and Export</span></span>

<span data-ttu-id="9cc4c-105">Puede importar y exportar [*claves simétricas*](/windows/desktop/SecGloss/s-gly) y claves asimétricas con CNG.</span><span class="sxs-lookup"><span data-stu-id="9cc4c-105">You can import and export [*symmetric keys*](/windows/desktop/SecGloss/s-gly) and asymmetric keys with CNG.</span></span> <span data-ttu-id="9cc4c-106">Y puede usar la funcionalidad de importación y exportación de claves para trasladar claves entre equipos.</span><span class="sxs-lookup"><span data-stu-id="9cc4c-106">And you can use key export and import functionality to move keys between machines.</span></span>

## <a name="symmetric-keys"></a><span data-ttu-id="9cc4c-107">Claves simétricas</span><span class="sxs-lookup"><span data-stu-id="9cc4c-107">Symmetric keys</span></span>

<span data-ttu-id="9cc4c-108">Para importar o exportar claves simétricas (o de sesión) en las que se usa la misma clave para cifrar y descifrar algunos datos, puede usar las funciones [**BCryptImportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptimportkey) y [**BCryptExportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptexportkey) .</span><span class="sxs-lookup"><span data-stu-id="9cc4c-108">To import or export symmetric (or session) keys in which the same key is used to encrypt and decrypt some data, you can use the [**BCryptImportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptimportkey) and [**BCryptExportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptexportkey) functions.</span></span> <span data-ttu-id="9cc4c-109">Normalmente, primero se exporta una clave mediante la función **BCryptExportKey** antes de la importación mediante la función **BCryptImportKey** .</span><span class="sxs-lookup"><span data-stu-id="9cc4c-109">Typically, you first export a key by using the **BCryptExportKey** function before importing by using the **BCryptImportKey** function.</span></span> <span data-ttu-id="9cc4c-110">Las funciones están diseñadas para habilitar el cifrado de las claves exportadas y importadas mediante los parámetros *hExportKey* y *hImportKey* . sin embargo, la implementación de Microsoft de estas funciones no admite el cifrado de claves exportadas y importadas.</span><span class="sxs-lookup"><span data-stu-id="9cc4c-110">The functions are designed to enable encryption of exported and imported keys by using the *hExportKey* and *hImportKey* parameters; however, the Microsoft implementation of these functions does not support encryption of exported and imported keys.</span></span>

## <a name="asymmetric-keys"></a><span data-ttu-id="9cc4c-111">Claves asimétricas</span><span class="sxs-lookup"><span data-stu-id="9cc4c-111">Asymmetric keys</span></span>

<span data-ttu-id="9cc4c-112">Para importar pares de claves asimétricas (o [*públicas y privadas*](/windows/desktop/SecGloss/p-gly)) en las que se usa una clave para cifrar y la otra se usa para descifrar algunos datos, puede utilizar cualquiera de las funciones [**BCryptImportKeyPair**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptimportkeypair) o [**NCryptImportKey**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptimportkey) .</span><span class="sxs-lookup"><span data-stu-id="9cc4c-112">To import asymmetric (or [*public/private*](/windows/desktop/SecGloss/p-gly)) key pairs in which one key is used to encrypt and the other is used to decrypt some data, you can use either of the [**BCryptImportKeyPair**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptimportkeypair) or [**NCryptImportKey**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptimportkey) functions.</span></span> <span data-ttu-id="9cc4c-113">Un proveedor de CNG debe codificar el par de claves mediante un tipo de [*BLOB de clave*](/windows/desktop/SecGloss/k-gly) compatible.</span><span class="sxs-lookup"><span data-stu-id="9cc4c-113">A CNG provider must encode the key pair by using a supported [*key BLOB*](/windows/desktop/SecGloss/k-gly) type.</span></span> <span data-ttu-id="9cc4c-114">[**BCryptExportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptexportkey) se puede usar para crear el BLOB de clave codificado.</span><span class="sxs-lookup"><span data-stu-id="9cc4c-114">[**BCryptExportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptexportkey) can be used to create the encoded key BLOB.</span></span> <span data-ttu-id="9cc4c-115">Las [estructuras CNG](cng-structures.md) describen los tipos de BLOB de clave y las estructuras que admite el proveedor de almacenamiento de claves de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="9cc4c-115">[CNG Structures](cng-structures.md) describes the key BLOB types and structures that Microsoft Key Storage Provider supports.</span></span>

<span data-ttu-id="9cc4c-116">Para que [**BCryptExportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptexportkey) cree un par de claves persistentes, el BLOB de clave de entrada debe contener una [*clave privada*](/windows/desktop/SecGloss/p-gly).</span><span class="sxs-lookup"><span data-stu-id="9cc4c-116">For [**BCryptExportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptexportkey) to create a persisted key pair, the input key BLOB must contain a [*private key*](/windows/desktop/SecGloss/p-gly).</span></span> <span data-ttu-id="9cc4c-117">[*Las claves públicas*](/windows/desktop/SecGloss/p-gly) no se conservan.</span><span class="sxs-lookup"><span data-stu-id="9cc4c-117">[*Public keys*](/windows/desktop/SecGloss/p-gly) are not persisted.</span></span>

<span data-ttu-id="9cc4c-118">El nombre de clave y la Directiva de exportación no forman parte de la estructura de [*BLOB*](/windows/desktop/SecGloss/b-gly) definida en las [estructuras de CNG](cng-structures.md).</span><span class="sxs-lookup"><span data-stu-id="9cc4c-118">The key name and export policy are not part of the [*BLOB*](/windows/desktop/SecGloss/b-gly) structure defined in [CNG Structures](cng-structures.md).</span></span> <span data-ttu-id="9cc4c-119">Sin embargo, si un BLOB es de un tipo de BLOB opaco (como la imagen de memoria de un estado de clave interna), el BLOB podría contener el nombre de clave y las propiedades de la Directiva de exportación.</span><span class="sxs-lookup"><span data-stu-id="9cc4c-119">However, if a BLOB is of an opaque BLOB type (such as the memory image of an internal key state), the BLOB might contain the key name and export-policy properties.</span></span>

<span data-ttu-id="9cc4c-120">En el procedimiento siguiente se describe cómo importar una clave privada persistente con sus propiedades.</span><span class="sxs-lookup"><span data-stu-id="9cc4c-120">The following procedure describes how to import a persisted private key with its properties.</span></span>

<span data-ttu-id="9cc4c-121">**Para importar una clave persistente**</span><span class="sxs-lookup"><span data-stu-id="9cc4c-121">**To import a persisted key**</span></span>

1.  <span data-ttu-id="9cc4c-122">Cree una clave persistente mediante la función [**NCryptCreatePersistedKey**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptcreatepersistedkey) .</span><span class="sxs-lookup"><span data-stu-id="9cc4c-122">Create a persisted key by using the [**NCryptCreatePersistedKey**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptcreatepersistedkey) function.</span></span>
2.  <span data-ttu-id="9cc4c-123">Establezca las propiedades deseadas en el objeto de clave mediante la función [**NCryptSetProperty**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptsetproperty) .</span><span class="sxs-lookup"><span data-stu-id="9cc4c-123">Set any desired properties on the key object by using the [**NCryptSetProperty**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptsetproperty) function.</span></span>
3.  <span data-ttu-id="9cc4c-124">Establezca el BLOB de la clave de importación como una propiedad de la clave, con el tipo de BLOB como el nombre de la propiedad.</span><span class="sxs-lookup"><span data-stu-id="9cc4c-124">Set the import key BLOB as a property on the key, with the BLOB type as the property name.</span></span>
4.  <span data-ttu-id="9cc4c-125">Finalice la importación de clave conservada mediante la función [**NCryptFinalizeKey**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptfinalizekey) .</span><span class="sxs-lookup"><span data-stu-id="9cc4c-125">Finalize the persisted key import by using the [**NCryptFinalizeKey**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptfinalizekey) function.</span></span>

 

 
