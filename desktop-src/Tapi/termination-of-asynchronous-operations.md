---
description: Cuando una aplicación llama a la función lineClose con una o más operaciones asincrónicas pendientes, TAPI puede indicar al proveedor de servicios que termine las operaciones asincrónicas asociadas a una llamada.
ms.assetid: b26ce074-76dc-4a50-8c17-d3412c336d59
title: Terminación de operaciones asincrónicas
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f8ed2acb0f442e5f4f07427f0e224d7a288087d6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "105678555"
---
# <a name="termination-of-asynchronous-operations"></a><span data-ttu-id="9ff64-103">Terminación de operaciones asincrónicas</span><span class="sxs-lookup"><span data-stu-id="9ff64-103">Termination of Asynchronous Operations</span></span>

<span data-ttu-id="9ff64-104">Cuando una aplicación llama a la función [**lineClose**](/windows/win32/api/tapi/nf-tapi-lineclose) con una o más operaciones asincrónicas pendientes, TAPI puede indicar al proveedor de servicios que termine las operaciones asincrónicas asociadas a una llamada, en función de si la aplicación es el único propietario de la llamada y tiene el único identificador de la llamada.</span><span class="sxs-lookup"><span data-stu-id="9ff64-104">When an application calls the [**lineClose**](/windows/win32/api/tapi/nf-tapi-lineclose) function with one or more outstanding asynchronous operations, TAPI may direct the service provider to terminate asynchronous operations associated with a call, depending on whether the application is the sole owner of the call and has the only handle to the call.</span></span>

<span data-ttu-id="9ff64-105">Si la aplicación es el único propietario de una llamada, TAPI llama a [**TSPI \_ LineDropOnClose**](./tspi-linedroponclose.md) o [**TSPI \_ lineDrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop) (dependiendo del proveedor) para cada una de estas llamadas.</span><span class="sxs-lookup"><span data-stu-id="9ff64-105">If the application is the sole owner of a call, TAPI calls [**TSPI\_lineDropOnClose**](./tspi-linedroponclose.md) or [**TSPI\_lineDrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop) (depending on the provider) for each such call.</span></span> <span data-ttu-id="9ff64-106">El proveedor de servicios debe comprobar si hay operaciones asincrónicas pendientes asociadas a la llamada que se va a quitar.</span><span class="sxs-lookup"><span data-stu-id="9ff64-106">The service provider should check for any pending asynchronous operations associated with the call being dropped.</span></span> <span data-ttu-id="9ff64-107">Si existe una operación pendiente, el proveedor de servicios debe llevar a cabo la acción adecuada, posiblemente finalizando la operación en curso.</span><span class="sxs-lookup"><span data-stu-id="9ff64-107">If a pending operation exists, the service provider should take the appropriate action, possibly terminating the operation in progress.</span></span>

<span data-ttu-id="9ff64-108">Si la aplicación tiene el único identificador de una llamada (es decir, no hay otros propietarios o monitores), TAPI llama a la [**función \_ LineCloseCall de TSPI**](/windows/win32/api/tspi/nf-tspi-tspi_lineclosecall) .</span><span class="sxs-lookup"><span data-stu-id="9ff64-108">If the application has the only handle to a call (that is, there are no other owners or monitors), TAPI calls the [**TSPI\_lineCloseCall**](/windows/win32/api/tspi/nf-tspi-tspi_lineclosecall) function.</span></span> <span data-ttu-id="9ff64-109">El proveedor de servicios debe considerar que esta llamada es la indicación absoluta de que se deben abandonar las operaciones asincrónicas pendientes.</span><span class="sxs-lookup"><span data-stu-id="9ff64-109">The service provider must consider this call to be the absolute indication that pending asynchronous operations must be abandoned.</span></span> <span data-ttu-id="9ff64-110">El proveedor de servicios debe garantizar una finalización ordenada de la llamada y debe llamar a la función de devolución de llamada de [**\_ finalización asincrónica**](/windows/win32/api/tspi/nc-tspi-async_completion) para todas las operaciones asincrónicas pendientes, especificando el valor de error de LINEERR \_ OPERATIONFAILED.</span><span class="sxs-lookup"><span data-stu-id="9ff64-110">The service provider must ensure an orderly completion of the call, and must call the [**ASYNC\_COMPLETION**](/windows/win32/api/tspi/nc-tspi-async_completion) callback function for all outstanding asynchronous operations, specifying the LINEERR\_OPERATIONFAILED error value.</span></span> <span data-ttu-id="9ff64-111">Si TAPI anteriormente llamó a la función [**TSPI \_ LineDropOnClose**](./tspi-linedroponclose.md) o [**TSPI \_ lineDrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop) , llama a **TSPI \_ lineCloseCall** inmediatamente después de que el proveedor de servicios vuelva de la otra llamada; no espera a que se complete la operación asincrónica asociada a la función **TSPI \_ lineDrop** .</span><span class="sxs-lookup"><span data-stu-id="9ff64-111">If TAPI previously called the [**TSPI\_lineDropOnClose**](./tspi-linedroponclose.md) or [**TSPI\_lineDrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop) function, it calls **TSPI\_lineCloseCall** immediately after the service provider returns from the other call; it does not wait for the asynchronous operation associated with the **TSPI\_lineDrop** function to complete.</span></span>

<span data-ttu-id="9ff64-112">Si la aplicación no es el único propietario de la llamada, TAPI no llama a [**TSPI \_ LineDropOnClose**](./tspi-linedroponclose.md) o [**TSPI \_ lineDrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop).</span><span class="sxs-lookup"><span data-stu-id="9ff64-112">If the application is not the sole owner of the call, TAPI does not call [**TSPI\_lineDropOnClose**](./tspi-linedroponclose.md) or [**TSPI\_lineDrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop).</span></span> <span data-ttu-id="9ff64-113">Si la aplicación no tiene el único identificador de la llamada, TAPI no llama a la función [**\_ LineCloseCall de TSPI**](/windows/win32/api/tspi/nf-tspi-tspi_lineclosecall) .</span><span class="sxs-lookup"><span data-stu-id="9ff64-113">If the application does not have the only handle to the call, TAPI does not call the [**TSPI\_lineCloseCall**](/windows/win32/api/tspi/nf-tspi-tspi_lineclosecall) function.</span></span> <span data-ttu-id="9ff64-114">Si la aplicación no es el único propietario ni el único poseedor de un identificador de la llamada, TAPI no envía ninguna notificación al proveedor de servicios y, por tanto, las operaciones asincrónicas pendientes permanecen intactas.</span><span class="sxs-lookup"><span data-stu-id="9ff64-114">If the application is neither the sole owner nor the sole possessor of a handle to the call, TAPI sends no notification to the service provider, and therefore, any pending asynchronous operations remain intact.</span></span> <span data-ttu-id="9ff64-115">Esto significa que estas aplicaciones no pueden finalizar las operaciones asincrónicas que se han iniciado mediante la función [**lineClose**](/windows/win32/api/tapi/nf-tapi-lineclose) .</span><span class="sxs-lookup"><span data-stu-id="9ff64-115">This means that such applications cannot terminate asynchronous operations that they have started by using the [**lineClose**](/windows/win32/api/tapi/nf-tapi-lineclose) function.</span></span> <span data-ttu-id="9ff64-116">Sin embargo, dado que cada operación asincrónica requiere que la aplicación que realiza la invocación sea propietaria de la llamada, la probabilidad de que una aplicación no pueda finalizar las operaciones asincrónicas es muy poco frecuente.</span><span class="sxs-lookup"><span data-stu-id="9ff64-116">However, because every asynchronous operation requires the invoking application to be an owner of the call, the likelihood of an application not being able to terminate asynchronous operations is very rare.</span></span> <span data-ttu-id="9ff64-117">En caso de que se produzca, los demás propietarios de las llamadas deben asumir la responsabilidad de la disposición de las llamadas.</span><span class="sxs-lookup"><span data-stu-id="9ff64-117">If it does occur, the other owner(s) of the call(s) must take responsibility for the disposition of the call(s).</span></span>

<span data-ttu-id="9ff64-118">Si TAPI llama a [**TSPI \_ LineDropOnClose**](./tspi-linedroponclose.md) o [**TSPI \_ lineDrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop), el proveedor de servicios debe enviar finalmente un \_ mensaje de inactividad de LINECALLSTATE para la llamada asociada (a menos que se llame a [**TSPI \_ lineCloseCall**](/windows/win32/api/tspi/nf-tspi-tspi_lineclosecall) primero) para que los monitores de la llamada puedan realizar la limpieza.</span><span class="sxs-lookup"><span data-stu-id="9ff64-118">If TAPI calls [**TSPI\_lineDropOnClose**](./tspi-linedroponclose.md) or [**TSPI\_lineDrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop), the service provider must eventually send a LINECALLSTATE\_IDLE message for the associated call (unless [**TSPI\_lineCloseCall**](/windows/win32/api/tspi/nf-tspi-tspi_lineclosecall) is called first) so that monitors on the call can clean up.</span></span> <span data-ttu-id="9ff64-119">Cuando el último monitor ha llamado a la función [**lineDeallocateCall**](/windows/win32/api/tapi/nf-tapi-linedeallocatecall) , TAPI llama a la función **TSPI \_ lineCloseCall** ; todas las operaciones pendientes se deben completar o finalizar y se ha llamado a la [**\_ finalización asincrónica**](/windows/win32/api/tspi/nc-tspi-async_completion) , tal y como se ha descrito anteriormente.</span><span class="sxs-lookup"><span data-stu-id="9ff64-119">When the last monitor has called the [**lineDeallocateCall**](/windows/win32/api/tapi/nf-tapi-linedeallocatecall) function, TAPI calls the **TSPI\_lineCloseCall** function; any pending operations must be completed or terminated and [**ASYNC\_COMPLETION**](/windows/win32/api/tspi/nc-tspi-async_completion) called, as described earlier.</span></span>

 

 
