---
description: La asignación de archivos se puede usar para compartir un archivo o memoria entre dos o más procesos. Para compartir un archivo o memoria, todos los procesos deben usar el nombre o el identificador del mismo objeto de asignación de archivos.
ms.assetid: 942cb50d-df07-444f-bba5-58194556ae66
title: Compartir archivos y memoria
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 98d402eba3f87f1f799593ae0d6b23fba06124a8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "103809944"
---
# <a name="sharing-files-and-memory"></a><span data-ttu-id="f78ab-104">Compartir archivos y memoria</span><span class="sxs-lookup"><span data-stu-id="f78ab-104">Sharing Files and Memory</span></span>

<span data-ttu-id="f78ab-105">La asignación de archivos se puede usar para compartir un archivo o memoria entre dos o más procesos.</span><span class="sxs-lookup"><span data-stu-id="f78ab-105">File mapping can be used to share a file or memory between two or more processes.</span></span> <span data-ttu-id="f78ab-106">Para compartir un archivo o memoria, todos los procesos deben usar el nombre o el identificador del mismo objeto de asignación de archivos.</span><span class="sxs-lookup"><span data-stu-id="f78ab-106">To share a file or memory, all of the processes must use the name or the handle of the same file mapping object.</span></span>

<span data-ttu-id="f78ab-107">Para compartir un archivo, el primer proceso crea o abre un archivo mediante la función [**CreateFile**](/windows/win32/api/fileapi/nf-fileapi-createfilea) .</span><span class="sxs-lookup"><span data-stu-id="f78ab-107">To share a file, the first process creates or opens a file by using the [**CreateFile**](/windows/win32/api/fileapi/nf-fileapi-createfilea) function.</span></span> <span data-ttu-id="f78ab-108">A continuación, crea un objeto de asignación de archivos mediante la función [**CreateFileMapping**](/windows/desktop/api/WinBase/nf-winbase-createfilemappinga) , especificando el identificador de archivo y un nombre para el objeto de asignación de archivos.</span><span class="sxs-lookup"><span data-stu-id="f78ab-108">Next, it creates a file mapping object by using the [**CreateFileMapping**](/windows/desktop/api/WinBase/nf-winbase-createfilemappinga) function, specifying the file handle and a name for the file mapping object.</span></span> <span data-ttu-id="f78ab-109">Los nombres de los objetos de evento, semáforo, exclusión mutua, temporizador que se pueden esperar, trabajo y asignación de archivos comparten el mismo espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="f78ab-109">The names of event, semaphore, mutex, waitable timer, job, and file mapping objects share the same namespace.</span></span> <span data-ttu-id="f78ab-110">Por lo tanto, las funciones **CreateFileMapping** y [**OpenFileMapping**](/windows/desktop/api/WinBase/nf-winbase-openfilemappinga) producen un error si especifican un nombre que está en uso por un objeto de otro tipo.</span><span class="sxs-lookup"><span data-stu-id="f78ab-110">Therefore, the **CreateFileMapping** and [**OpenFileMapping**](/windows/desktop/api/WinBase/nf-winbase-openfilemappinga) functions fail if they specify a name that is in use by an object of another type.</span></span>

<span data-ttu-id="f78ab-111">Para compartir memoria que no está asociada a un archivo, un proceso debe usar la función [**CreateFileMapping**](/windows/desktop/api/WinBase/nf-winbase-createfilemappinga) y especificar \_ un valor de identificador no válido \_ como el parámetro *hFile* en lugar de un identificador de archivo existente.</span><span class="sxs-lookup"><span data-stu-id="f78ab-111">To share memory that is not associated with a file, a process must use the [**CreateFileMapping**](/windows/desktop/api/WinBase/nf-winbase-createfilemappinga) function and specify INVALID\_HANDLE\_VALUE as the *hFile* parameter instead of an existing file handle.</span></span> <span data-ttu-id="f78ab-112">El objeto de asignación de archivos correspondiente obtiene acceso a la memoria respaldada por el archivo de paginación del sistema.</span><span class="sxs-lookup"><span data-stu-id="f78ab-112">The corresponding file mapping object accesses memory backed by the system paging file.</span></span> <span data-ttu-id="f78ab-113">Debe especificar un tamaño mayor que cero cuando especifique un *hFile* de valor de identificador no válido \_ \_ en una llamada a **CreateFileMapping**.</span><span class="sxs-lookup"><span data-stu-id="f78ab-113">You must specify a size greater than zero when you specify an *hFile* of INVALID\_HANDLE\_VALUE in a call to **CreateFileMapping**.</span></span>

<span data-ttu-id="f78ab-114">La forma más fácil de que otros procesos obtengan un identificador del objeto de asignación de archivos creado por el primer proceso es usar la función [**OpenFileMapping**](/windows/desktop/api/WinBase/nf-winbase-openfilemappinga) y especificar el nombre del objeto.</span><span class="sxs-lookup"><span data-stu-id="f78ab-114">The easiest way for other processes to obtain a handle of the file mapping object created by the first process is to use the [**OpenFileMapping**](/windows/desktop/api/WinBase/nf-winbase-openfilemappinga) function and specify the object's name.</span></span> <span data-ttu-id="f78ab-115">Esto se conoce como *memoria compartida con nombre*.</span><span class="sxs-lookup"><span data-stu-id="f78ab-115">This is referred to as *named shared memory*.</span></span> <span data-ttu-id="f78ab-116">Si el objeto de asignación de archivos no tiene un nombre, el proceso debe obtener un identificador a través de la herencia o la duplicación.</span><span class="sxs-lookup"><span data-stu-id="f78ab-116">If the file mapping object does not have a name, the process must obtain a handle to it through inheritance or duplication.</span></span> <span data-ttu-id="f78ab-117">Para obtener más información sobre la herencia y la duplicación, vea [herencia](../procthread/inheritance.md).</span><span class="sxs-lookup"><span data-stu-id="f78ab-117">For more information on inheritance and duplication, see [Inheritance](../procthread/inheritance.md).</span></span>

<span data-ttu-id="f78ab-118">Los procesos que comparten archivos o memoria deben crear vistas de archivo mediante la función [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) o [**MapViewOfFileEx**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffileex) .</span><span class="sxs-lookup"><span data-stu-id="f78ab-118">Processes that share files or memory must create file views by using the [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) or [**MapViewOfFileEx**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffileex) function.</span></span> <span data-ttu-id="f78ab-119">Deben coordinar su acceso mediante semáforos, exclusiones mutuas, eventos u otra técnica de exclusión mutua.</span><span class="sxs-lookup"><span data-stu-id="f78ab-119">They must coordinate their access using semaphores, mutexes, events, or some other mutual exclusion technique.</span></span> <span data-ttu-id="f78ab-120">Para obtener más información, consulte [Synchronization](../sync/synchronization.md).</span><span class="sxs-lookup"><span data-stu-id="f78ab-120">For more information, see [Synchronization](../sync/synchronization.md).</span></span>

<span data-ttu-id="f78ab-121">Un objeto de asignación de archivos compartidos no se destruirá hasta que todos los procesos que lo utilicen cierren sus identificadores con la función [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle) .</span><span class="sxs-lookup"><span data-stu-id="f78ab-121">A shared file mapping object will not be destroyed until all processes that use it close their handles to it by using the [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle) function.</span></span>

<span data-ttu-id="f78ab-122">Para obtener más información sobre la seguridad de objetos de asignación de archivos, consulte [asignación de archivos seguridad y derechos de acceso](file-mapping-security-and-access-rights.md).</span><span class="sxs-lookup"><span data-stu-id="f78ab-122">For information about file mapping object security, see [File Mapping Security and Access Rights](file-mapping-security-and-access-rights.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="f78ab-123">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="f78ab-123">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f78ab-124">Crear memoria compartida con nombre</span><span class="sxs-lookup"><span data-stu-id="f78ab-124">Creating Named Shared Memory</span></span>](creating-named-shared-memory.md)
</dt> </dl>

 

 
