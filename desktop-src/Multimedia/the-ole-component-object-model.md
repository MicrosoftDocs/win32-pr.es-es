---
title: Modelo de objetos de componentes OLE
description: Modelo de objetos de componentes OLE
ms.assetid: f3200d81-c2fa-4cc7-bf85-54f6c753a529
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 211c41de8c16eb1cabb1e62f475adbbf603e2c92
ms.sourcegitcommit: 52d79b29f3b9933c8bef43207ff80c668a81cb73
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/20/2020
ms.locfileid: "103995726"
---
# <a name="the-ole-component-object-model"></a><span data-ttu-id="be7a8-103">Modelo de objetos de componentes OLE</span><span class="sxs-lookup"><span data-stu-id="be7a8-103">The OLE Component Object Model</span></span>

<span data-ttu-id="be7a8-104">Los objetos utilizados por la biblioteca AVIFile forman parte del modelo de objetos de componentes OLE.</span><span class="sxs-lookup"><span data-stu-id="be7a8-104">The objects used by the AVIFile library are all part of the OLE Component Object Model.</span></span> <span data-ttu-id="be7a8-105">Principalmente, esto significa que comparten ciertos métodos que facilitan el trabajo con y los valores que devuelven son comunes a la mayoría de los métodos de interfaz OLE.</span><span class="sxs-lookup"><span data-stu-id="be7a8-105">Primarily, this means they share certain methods that make them easier to work with, and the values they return are common to most OLE interface methods.</span></span>

<span data-ttu-id="be7a8-106">El modelo de objetos de componentes OLE de los controladores de archivos y secuencias utiliza la interfaz OLE **IClassFactory** para crear instancias de su clase de objeto.</span><span class="sxs-lookup"><span data-stu-id="be7a8-106">The OLE Component Object Model of the file and stream handlers uses the OLE **IClassFactory** interface to create instances of their object class.</span></span> <span data-ttu-id="be7a8-107">Como objetos de componente, implementan la interfaz [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) , que consta de los métodos [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(refiid_void)), [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release)y [**AddRef**](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) .</span><span class="sxs-lookup"><span data-stu-id="be7a8-107">As component objects, they implement the [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface, which consists of the [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(refiid_void)), [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release), and [**AddRef**](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) methods.</span></span> <span data-ttu-id="be7a8-108">La interfaz **IUnknown** permite a una aplicación obtener punteros a otras interfaces admitidas por el mismo objeto.</span><span class="sxs-lookup"><span data-stu-id="be7a8-108">The **IUnknown** interface lets an application obtain pointers to other interfaces supported by the same object.</span></span>

<span data-ttu-id="be7a8-109">Puede determinar si un objeto admite una interfaz concreta mediante el método **QueryInterface** .</span><span class="sxs-lookup"><span data-stu-id="be7a8-109">You can determine if an object supports a specific interface by using the **QueryInterface** method.</span></span> <span data-ttu-id="be7a8-110">Si un objeto admite una interfaz especificada, **QueryInterface** devuelve un puntero a esa interfaz.</span><span class="sxs-lookup"><span data-stu-id="be7a8-110">If an object supports a specified interface, **QueryInterface** returns a pointer to that interface.</span></span>

<span data-ttu-id="be7a8-111">Puede aumentar y disminuir el recuento de referencias asociado a un objeto mediante los métodos [**AddRef**](/previous-versions//dd757100(v=vs.85)) y [**Release**](/previous-versions//dd757102(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="be7a8-111">You can increment and decrement the reference count associated with an object by using the [**AddRef**](/previous-versions//dd757100(v=vs.85)) and [**Release**](/previous-versions//dd757102(v=vs.85)) methods.</span></span> <span data-ttu-id="be7a8-112">El recuento de referencias permite que varios clientes accedan a un objeto.</span><span class="sxs-lookup"><span data-stu-id="be7a8-112">The reference count lets multiple clients access an object.</span></span> <span data-ttu-id="be7a8-113">Cuando la primera aplicación usa un objeto, su recuento de referencias se establece en 1.</span><span class="sxs-lookup"><span data-stu-id="be7a8-113">When an object is used by the first application, its reference count is set to 1.</span></span> <span data-ttu-id="be7a8-114">Posteriormente, las aplicaciones usan el método **AddRef** para incrementar el recuento y permitir que el objeto realice un seguimiento del número de veces que se tiene acceso a él.</span><span class="sxs-lookup"><span data-stu-id="be7a8-114">Applications subsequently use the **AddRef** method to increment the count to let the object keep track of the number of times it is accessed.</span></span>

<span data-ttu-id="be7a8-115">Cuando una aplicación se realiza mediante un objeto, llama al método **Release** para reducir el recuento de referencias.</span><span class="sxs-lookup"><span data-stu-id="be7a8-115">When an application is done using an object, it calls the **Release** method to decrement the reference count.</span></span> <span data-ttu-id="be7a8-116">Cuando el recuento de referencias es cero, el objeto ya no es necesario y **Release** libera todos los recursos que utiliza y destruye el objeto.</span><span class="sxs-lookup"><span data-stu-id="be7a8-116">When the reference count is zero, the object is no longer needed and **Release** frees any resources it uses and destroys the object.</span></span> <span data-ttu-id="be7a8-117">Dado que un objeto utiliza recursos internos de forma transparente para la aplicación, el objeto es responsable de liberarlos.</span><span class="sxs-lookup"><span data-stu-id="be7a8-117">Because an object uses internal resources transparent to the application, the object is responsible for freeing them.</span></span> <span data-ttu-id="be7a8-118">Por ejemplo, un controlador de archivos podría necesitar cerrar archivos de disco abiertos y la memoria de búfer libre cuando se lancen.</span><span class="sxs-lookup"><span data-stu-id="be7a8-118">For example, a file handler might need to close open disk files and free buffer memory when released.</span></span>

<span data-ttu-id="be7a8-119">La mayoría de los métodos de interfaz OLE devuelven los identificadores de resultados que se definen mediante el tipo de datos **HRESULT** .</span><span class="sxs-lookup"><span data-stu-id="be7a8-119">Most OLE interface methods return result handles that are defined by using the **HRESULT** data type.</span></span> <span data-ttu-id="be7a8-120">Este tipo de datos se compone de un código de gravedad, información contextual, un código de instalación y un código de estado.</span><span class="sxs-lookup"><span data-stu-id="be7a8-120">This data type is made of a severity code, contextual information, a facility code, and a status code.</span></span> <span data-ttu-id="be7a8-121">Un identificador de resultado devuelto que indica que Success tiene el valor cero.</span><span class="sxs-lookup"><span data-stu-id="be7a8-121">A return result handle that indicates success has the value zero.</span></span> <span data-ttu-id="be7a8-122">Un valor distinto de cero indica un error y el miembro de código de estado del identificador de resultado devuelto proporciona una base para la interpretación adicional.</span><span class="sxs-lookup"><span data-stu-id="be7a8-122">A nonzero value indicates failure and the status code member of the return result handle provides a basis for additional interpretation.</span></span> <span data-ttu-id="be7a8-123">Para obtener más información sobre los identificadores de resultados devueltos de OLE, vea la *Referencia del programador de OLE*.</span><span class="sxs-lookup"><span data-stu-id="be7a8-123">For additional information about OLE return result handles, see the *OLE Programmer's Reference*.</span></span>

 

 