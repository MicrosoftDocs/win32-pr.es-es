---
title: Funciones auxiliares de creación de instancia
description: Funciones auxiliares de creación de instancia
ms.assetid: 0b9b7bcf-f0f0-42c4-945e-63a532640d4b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 84956f6040aaba13b46dea92bea611a49d5d8de3
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/21/2020
ms.locfileid: "104078415"
---
# <a name="instance-creation-helper-functions"></a><span data-ttu-id="1f48f-103">Funciones auxiliares de creación de instancia</span><span class="sxs-lookup"><span data-stu-id="1f48f-103">Instance Creation Helper Functions</span></span>

<span data-ttu-id="1f48f-104">En las versiones anteriores de COM, el mecanismo principal usado para crear una instancia de objeto era la función [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) .</span><span class="sxs-lookup"><span data-stu-id="1f48f-104">In previous releases of COM, the primary mechanism used to create an object instance was the [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) function.</span></span> <span data-ttu-id="1f48f-105">Esta función encapsula el proceso de creación de un objeto de clase, con el fin de crear una nueva instancia y liberar el objeto de clase.</span><span class="sxs-lookup"><span data-stu-id="1f48f-105">This function encapsulates the process of creating a class object, using that to create a new instance and releasing the class object.</span></span> <span data-ttu-id="1f48f-106">Otra función de este tipo es el [**OleCreate**](/windows/desktop/api/ole/nf-ole-olecreate)más específico, la aplicación auxiliar de documento compuesto OLE que crea un objeto de clase y recupera un puntero a un objeto solicitado.</span><span class="sxs-lookup"><span data-stu-id="1f48f-106">Another function of this kind is the more specific [**OleCreate**](/windows/desktop/api/ole/nf-ole-olecreate), the OLE compound document helper that creates a class object and retrieves a pointer to a requested object.</span></span>

<span data-ttu-id="1f48f-107">Para suavizar el proceso de creación de instancias en sistemas distribuidos, COM ha introducido cuatro mecanismos de creación de instancia nuevos importantes:</span><span class="sxs-lookup"><span data-stu-id="1f48f-107">To smooth the process of instance creation on distributed systems, COM has introduced four important new instance creation mechanisms:</span></span>

-   <span data-ttu-id="1f48f-108">Monikers y [ **IClassActivator** de clase](/windows/desktop/api/ObjIdl/nn-objidl-iclassactivator)</span><span class="sxs-lookup"><span data-stu-id="1f48f-108">Class monikers and [**IClassActivator**](/windows/desktop/api/ObjIdl/nn-objidl-iclassactivator)</span></span>
-   [<span data-ttu-id="1f48f-109">**CoCreateInstanceEx**</span><span class="sxs-lookup"><span data-stu-id="1f48f-109">**CoCreateInstanceEx**</span></span>](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex)
-   [<span data-ttu-id="1f48f-110">**CoGetInstanceFromFile**</span><span class="sxs-lookup"><span data-stu-id="1f48f-110">**CoGetInstanceFromFile**</span></span>](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromfile)
-   [<span data-ttu-id="1f48f-111">**CoGetInstanceFromIStorage**</span><span class="sxs-lookup"><span data-stu-id="1f48f-111">**CoGetInstanceFromIStorage**</span></span>](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromistorage)

<span data-ttu-id="1f48f-112">Un moniker de clase permite identificar la clase de un objeto y se utiliza normalmente con otro moniker, como un moniker de archivo, para indicar la ubicación del objeto.</span><span class="sxs-lookup"><span data-stu-id="1f48f-112">A class moniker permits you to identify the class of an object and is typically used with another moniker, like a file moniker, to indicate the location of the object.</span></span> <span data-ttu-id="1f48f-113">Esto le permite enlazar a un objeto y especificar el servidor que se va a iniciar para ese objeto.</span><span class="sxs-lookup"><span data-stu-id="1f48f-113">This permits you to bind to an object and specify the server that is to be launched for that object.</span></span> <span data-ttu-id="1f48f-114">Los monikers de clase también se pueden componer a la derecha de monikers que admiten enlaces a la interfaz [**IClassActivator**](/windows/desktop/api/ObjIdl/nn-objidl-iclassactivator) .</span><span class="sxs-lookup"><span data-stu-id="1f48f-114">Class monikers may also be composed to the right of monikers supporting binding to the [**IClassActivator**](/windows/desktop/api/ObjIdl/nn-objidl-iclassactivator) interface.</span></span> <span data-ttu-id="1f48f-115">Para obtener más información, vea [monikers de clase](class-monikers.md).</span><span class="sxs-lookup"><span data-stu-id="1f48f-115">For more information, see [Class Monikers](class-monikers.md).</span></span>

<span data-ttu-id="1f48f-116">[**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) extiende [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) para que pueda crear un único objeto sin inicializar asociado al CLSID dado en un equipo remoto especificado.</span><span class="sxs-lookup"><span data-stu-id="1f48f-116">[**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) extends [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) to make it possible to create a single uninitialized object associated with the given CLSID on a specified remote machine.</span></span> <span data-ttu-id="1f48f-117">Además, en lugar de solicitar una sola interfaz y obtener un único puntero a esa interfaz, **CoCreateInstanceEx** permite consultar varias interfaces y, si está disponible, recibir punteros a ellas en un solo recorrido de ida y vuelta, lo que permite menos recorridos de ida y vuelta entre máquinas.</span><span class="sxs-lookup"><span data-stu-id="1f48f-117">In addition, rather than requesting a single interface and obtaining a single pointer to that interface, **CoCreateInstanceEx** makes it possible to query for multiple interfaces and (if available) receive pointers to them in a single round-trip, thus permitting fewer round-trips between machines.</span></span> <span data-ttu-id="1f48f-118">Esto puede hacer que la interacción remota de objetos sea mucho más eficaz.</span><span class="sxs-lookup"><span data-stu-id="1f48f-118">This can make remote object interaction much more efficient.</span></span> <span data-ttu-id="1f48f-119">Para ello, la función utiliza una matriz de estructuras [**multi \_ Qi**](/windows/win32/api/objidlbase/ns-objidlbase-multi_qi) .</span><span class="sxs-lookup"><span data-stu-id="1f48f-119">To do this, the function uses an array of [**MULTI\_QI**](/windows/win32/api/objidlbase/ns-objidlbase-multi_qi) structures.</span></span>

<span data-ttu-id="1f48f-120">La creación de un objeto a través de [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) todavía requiere que el objeto se inicialice a través de una llamada a una de las interfaces de inicialización (como [**IPersistStorage:: Load**](/windows/desktop/api/ObjIdl/nf-objidl-ipersiststorage-load)).</span><span class="sxs-lookup"><span data-stu-id="1f48f-120">Creating an object through [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) still requires that the object be initialized through a call to one of the initialization interfaces (such as [**IPersistStorage::Load**](/windows/desktop/api/ObjIdl/nf-objidl-ipersiststorage-load)).</span></span> <span data-ttu-id="1f48f-121">Las funciones auxiliares [**CoGetInstanceFromFile**](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromfile) y [**CoGetInstanceFromIStorage**](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromistorage) encapsulan la potencia de creación de la instancia de **CoCreateInstanceEx** y la inicialización, la primera de un archivo y la última de un almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="1f48f-121">The helper functions [**CoGetInstanceFromFile**](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromfile) and [**CoGetInstanceFromIStorage**](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromistorage) encapsulate both the instance creation power of **CoCreateInstanceEx** and the initialization, the former from a file and the latter from a storage.</span></span>

## <a name="related-topics"></a><span data-ttu-id="1f48f-122">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="1f48f-122">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1f48f-123">Crear un objeto a través de un objeto de clase</span><span class="sxs-lookup"><span data-stu-id="1f48f-123">Creating an Object Through a Class Object</span></span>](creating-an-object-through-a-class-object.md)
</dt> </dl>

 

 