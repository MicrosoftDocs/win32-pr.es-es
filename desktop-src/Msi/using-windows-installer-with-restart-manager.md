---
description: Las aplicaciones que usan Windows Installer 4,0 para la instalación y el mantenimiento en Windows Vista usan automáticamente el administrador de reinicio para reducir los reinicios del sistema.
ms.assetid: 821739ff-f7a7-4192-ad34-254aa7d74d13
title: Usar Windows Installer con el administrador de reinicio
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4160b2241c75ec7305accd1ab4d1295a54fa9f65
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "105677460"
---
# <a name="using-windows-installer-with-restart-manager"></a><span data-ttu-id="2294d-103">Usar Windows Installer con el administrador de reinicio</span><span class="sxs-lookup"><span data-stu-id="2294d-103">Using Windows Installer with Restart Manager</span></span>

<span data-ttu-id="2294d-104">Las aplicaciones que usan Windows Installer 4,0 para la instalación y el mantenimiento en Windows Vista usan automáticamente el [Administrador de reinicio](../rstmgr/restart-manager-portal.md) para reducir los reinicios del sistema.</span><span class="sxs-lookup"><span data-stu-id="2294d-104">Applications that use Windows Installer 4.0 for installation and servicing on Windows Vista automatically use the [Restart Manager](../rstmgr/restart-manager-portal.md) to reduce system restarts.</span></span> <span data-ttu-id="2294d-105">El comportamiento predeterminado en Windows Vista es cerrar las aplicaciones en lugar de apagar y reiniciar el sistema operativo siempre que sea posible.</span><span class="sxs-lookup"><span data-stu-id="2294d-105">The default behavior on Windows Vista is to shut down applications rather than shut down and restart the operating system whenever possible.</span></span> <span data-ttu-id="2294d-106">En los casos en los que no se puede evitar el reinicio del sistema, los instaladores pueden usar la API del [Administrador de reinicio](../rstmgr/restart-manager-portal.md) para programar los reinicios de forma que se minimice la interrupción del flujo de trabajo del usuario.</span><span class="sxs-lookup"><span data-stu-id="2294d-106">In cases where a system restart is unavoidable, installers can use the [Restart Manager](../rstmgr/restart-manager-portal.md) API to schedule restarts in such a way that it minimizes the disruption of the user's work flow.</span></span>

<span data-ttu-id="2294d-107">Windows Installer los desarrolladores pueden realizar las siguientes acciones para preparar el paquete para que funcione con el [Administrador de reinicio](../rstmgr/restart-manager-portal.md).</span><span class="sxs-lookup"><span data-stu-id="2294d-107">Windows Installer developers can perform the following actions to prepare their package to work with the [Restart Manager](../rstmgr/restart-manager-portal.md).</span></span>

-   <span data-ttu-id="2294d-108">Agregue el cuadro de diálogo [MsiRMFilesInUse](msirmfilesinuse-dialog.md) al paquete.</span><span class="sxs-lookup"><span data-stu-id="2294d-108">Add the [MsiRMFilesInUse](msirmfilesinuse-dialog.md) dialog box to your package.</span></span> <span data-ttu-id="2294d-109">Si el cuadro de diálogo MsiRMFilesInUse está presente en el paquete, el usuario de Windows Vista que ejecuta una instalación en el [nivel de interfaz de usuario](user-interface-levels.md) completo de la interfaz de usuario tiene la opción de cerrar y reiniciar las aplicaciones automáticamente.</span><span class="sxs-lookup"><span data-stu-id="2294d-109">If the MsiRMFilesInUse dialog box is present in the package, the Windows Vista user running an installation at the Full UI [user interface level](user-interface-levels.md) is given the option to automatically close and restart applications.</span></span> <span data-ttu-id="2294d-110">Un paquete de instalación puede contener información para el cuadro de diálogo MsiRMFilesInUse y el cuadro de diálogo [FilesInUse](filesinuse-dialog.md) .</span><span class="sxs-lookup"><span data-stu-id="2294d-110">An installation package can contain information for both the MsiRMFilesInUse dialog box and the [FilesInUse](filesinuse-dialog.md) dialog box .</span></span> <span data-ttu-id="2294d-111">El cuadro de diálogo MsiRMFilesInUse solo se muestra si el paquete se instala con al menos Windows Installer 4,0 en Windows Vista y, de lo contrario, se omite.</span><span class="sxs-lookup"><span data-stu-id="2294d-111">The MsiRMFilesInUse dialog box is only displayed if the package is installed with at least Windows Installer 4.0 on Windows Vista, and is otherwise ignored.</span></span> <span data-ttu-id="2294d-112">Los paquetes existentes que no tienen el cuadro de diálogo MsiRMFilesInUse continúan funcionando mediante el cuadro de diálogo FilesInUse.</span><span class="sxs-lookup"><span data-stu-id="2294d-112">Existing packages that do not have the MsiRMFilesInUse dialog box continue to function using the FilesInUse dialog box.</span></span> <span data-ttu-id="2294d-113">Una transformación de personalización se puede utilizar para agregar un cuadro de diálogo MsiRMFilesInUse a los paquetes existentes.</span><span class="sxs-lookup"><span data-stu-id="2294d-113">A customization transform can be used to add an MsiRMFilesInUse dialog box to existing packages.</span></span>

    <span data-ttu-id="2294d-114">Los usuarios finales suelen ejecutar instalaciones en el nivel de [interfaz de usuario](user-interface-levels.md)de interfaz de usuario completa.</span><span class="sxs-lookup"><span data-stu-id="2294d-114">End-users typically run installations at the Full UI [user interface level](user-interface-levels.md).</span></span> <span data-ttu-id="2294d-115">La interfaz de usuario básica o las instalaciones de nivel de interfaz de usuario reducidas proporcionan al usuario la opción de usar el [Administrador de reinicio](../rstmgr/restart-manager-portal.md) para reducir los reinicios del sistema incluso si el cuadro de diálogo [MsiRMFilesInUse](msirmfilesinuse-dialog.md) no está presente.</span><span class="sxs-lookup"><span data-stu-id="2294d-115">Basic UI or Reduced UI level installations give the user the option of using the [Restart Manager](../rstmgr/restart-manager-portal.md) to reduce system restarts even if the [MsiRMFilesInUse](msirmfilesinuse-dialog.md) dialog box is not present.</span></span> <span data-ttu-id="2294d-116">Las instalaciones de nivel de interfaz de usuario silenciosa siempre cierran aplicaciones y servicios y, en Windows Vista, siempre usan el administrador de reinicio.</span><span class="sxs-lookup"><span data-stu-id="2294d-116">Silent UI level installations always shut down applications and services, and on Windows Vista, always use Restart Manager.</span></span>

-   <span data-ttu-id="2294d-117">Registre aplicaciones para un reinicio mediante la función [**RegisterApplicationRestart**](/windows/win32/api/winbase/nf-winbase-registerapplicationrestart) .</span><span class="sxs-lookup"><span data-stu-id="2294d-117">Register applications for a restart using the [**RegisterApplicationRestart**](/windows/win32/api/winbase/nf-winbase-registerapplicationrestart) function.</span></span> <span data-ttu-id="2294d-118">El administrador de reinicio solo puede reiniciar las aplicaciones que se han registrado para reiniciarse.</span><span class="sxs-lookup"><span data-stu-id="2294d-118">Restart Manager can only restart applications that have been registered for restart.</span></span> <span data-ttu-id="2294d-119">El administrador de reinicio reinicia las aplicaciones registradas después de la instalación.</span><span class="sxs-lookup"><span data-stu-id="2294d-119">Restart Manager restarts registered applications after the installation.</span></span> <span data-ttu-id="2294d-120">Si la instalación requiere un reinicio del sistema, el administrador de reinicio reinicia la aplicación registrada después del reinicio del sistema.</span><span class="sxs-lookup"><span data-stu-id="2294d-120">If the installation requires a system restart, Restart Manager restarts the registered application after the system restart.</span></span>
-   <span data-ttu-id="2294d-121">Especifique INSTALLLOGMODE \_ RMFILESINUSE al habilitar un controlador de interfaz de usuario externo con las funciones [**MsiSetExternalUI**](/windows/desktop/api/Msi/nf-msi-msisetexternaluia) y [**MsiSetExternalUIRecord**](/windows/desktop/api/Msi/nf-msi-msisetexternaluirecord) .</span><span class="sxs-lookup"><span data-stu-id="2294d-121">Specify INSTALLLOGMODE\_RMFILESINUSE when enabling an external user-interface handler with the [**MsiSetExternalUI**](/windows/desktop/api/Msi/nf-msi-msisetexternaluia) and [**MsiSetExternalUIRecord**](/windows/desktop/api/Msi/nf-msi-msisetexternaluirecord) functions.</span></span> <span data-ttu-id="2294d-122">Windows Installer enviará un \_ mensaje RMFILESINUSE de INSTALLMESSAGE para los controladores externos de la interfaz de usuario que admitan el [Administrador de reinicio](../rstmgr/restart-manager-portal.md).</span><span class="sxs-lookup"><span data-stu-id="2294d-122">Windows Installer will send a INSTALLMESSAGE\_RMFILESINUSE message for external user-interface handlers that support the [Restart Manager](../rstmgr/restart-manager-portal.md).</span></span> <span data-ttu-id="2294d-123">Si no hay ninguna interfaz de usuario registrada o interna que controle el \_ mensaje INSTALLMESSAGE RMFILESINUSE, el instalador envía un \_ mensaje FILESINUSE de INSTALLMESSAGE para los controladores de la interfaz de usuario que admiten el cuadro de diálogo [FILESINUSE](filesinuse-dialog.md) .</span><span class="sxs-lookup"><span data-stu-id="2294d-123">If no registered or internal user-interface handles the INSTALLMESSAGE\_RMFILESINUSE message, the installer sends a INSTALLMESSAGE\_FILESINUSE message for user-interface handlers that support the [FilesInUse](filesinuse-dialog.md) dialog box.</span></span> <span data-ttu-id="2294d-124">Para obtener más información, consulte [uso del administrador de reinicio con una interfaz de usuario externa](using-restart-manager-with-an-external-ui-.md).</span><span class="sxs-lookup"><span data-stu-id="2294d-124">For more information, see [Using Restart Manager with an External UI](using-restart-manager-with-an-external-ui-.md).</span></span>
-   <span data-ttu-id="2294d-125">Las acciones personalizadas pueden agregar recursos que pertenecen a una sesión del [Administrador de reinicio](../rstmgr/restart-manager-portal.md) .</span><span class="sxs-lookup"><span data-stu-id="2294d-125">Custom actions can add resources belonging to a [Restart Manager](../rstmgr/restart-manager-portal.md) session.</span></span> <span data-ttu-id="2294d-126">La acción personalizada se debe secuenciar antes de la acción [InstallValidate](installvalidate-action.md) .</span><span class="sxs-lookup"><span data-stu-id="2294d-126">The custom action should be sequenced before the [InstallValidate](installvalidate-action.md) action.</span></span> <span data-ttu-id="2294d-127">Las acciones personalizadas pueden usar la propiedad [**MsiRestartManagerSessionKey**](msirestartmanagersessionkey.md) para obtener la clave de sesión y deben llamar a las funciones [**RmJoinSession**](/windows/win32/api/restartmanager/nf-restartmanager-rmjoinsession) y [**RmEndSession**](/windows/win32/api/restartmanager/nf-restartmanager-rmendsession) de la API del administrador de reinicio.</span><span class="sxs-lookup"><span data-stu-id="2294d-127">Custom actions can use the [**MsiRestartManagerSessionKey**](msirestartmanagersessionkey.md) property to obtain the session key, and should call the [**RmJoinSession**](/windows/win32/api/restartmanager/nf-restartmanager-rmjoinsession) and [**RmEndSession**](/windows/win32/api/restartmanager/nf-restartmanager-rmendsession) functions of the Restart Manager API.</span></span> <span data-ttu-id="2294d-128">Las acciones personalizadas no pueden quitar recursos que pertenecen a una sesión del administrador de reinicio.</span><span class="sxs-lookup"><span data-stu-id="2294d-128">Custom actions cannot remove resources belonging to a Restart Manager session.</span></span> <span data-ttu-id="2294d-129">Las acciones personalizadas no deben intentar apagar o reiniciar las aplicaciones mediante las funciones [**RmShutdown**](/windows/win32/api/restartmanager/nf-restartmanager-rmshutdown), [**RmGetList**](/windows/win32/api/restartmanager/nf-restartmanager-rmgetlist) y [**RmRestart**](/windows/win32/api/restartmanager/nf-restartmanager-rmrestart) .</span><span class="sxs-lookup"><span data-stu-id="2294d-129">Custom actions should not attempt to shutdown or restart applications using the [**RmShutdown**](/windows/win32/api/restartmanager/nf-restartmanager-rmshutdown), [**RmGetList**](/windows/win32/api/restartmanager/nf-restartmanager-rmgetlist) and [**RmRestart**](/windows/win32/api/restartmanager/nf-restartmanager-rmrestart) functions.</span></span>
-   <span data-ttu-id="2294d-130">Los autores de paquetes pueden basar una condición en la [tabla LaunchCondition](launchcondition-table.md) de la propiedad [**MsiSystemRebootPending**](msisystemrebootpending.md) para evitar la instalación de su paquete cuando está pendiente un reinicio del sistema.</span><span class="sxs-lookup"><span data-stu-id="2294d-130">Package authors can base a condition in the [LaunchCondition table](launchcondition-table.md) on the [**MsiSystemRebootPending**](msisystemrebootpending.md) property to prevent the installation of their package when a system restart is pending.</span></span>
-   <span data-ttu-id="2294d-131">Los autores y administradores de paquetes pueden controlar la interacción del Windows Installer y reiniciar el administrador mediante las propiedades [**MSIRESTARTMANAGERCONTROL**](msirestartmanagercontrol.md), [**MSIDISABLERMRESTART**](msidisablermrestart.md), [**MSIRMSHUTDOWN**](msirmshutdown.md) y [DisableAutomaticApplicationShutdown](disableautomaticapplicationshutdown.md) .</span><span class="sxs-lookup"><span data-stu-id="2294d-131">Package authors and administrators can control the interaction of the Windows Installer and Restart Manager by using the [**MSIRESTARTMANAGERCONTROL**](msirestartmanagercontrol.md), [**MSIDISABLERMRESTART**](msidisablermrestart.md), [**MSIRMSHUTDOWN**](msirmshutdown.md) properties and the [DisableAutomaticApplicationShutdown](disableautomaticapplicationshutdown.md) policy.</span></span>
-   <span data-ttu-id="2294d-132">Las aplicaciones y los servicios deben seguir las instrucciones descritas en la sección [uso del administrador de reinicio](../rstmgr/using-restart-manager.md) de la documentación del [Administrador de reinicio](../rstmgr/restart-manager-portal.md) .</span><span class="sxs-lookup"><span data-stu-id="2294d-132">Applications and services should follow the guidelines described in the [Using Restart Manager](../rstmgr/using-restart-manager.md) section of the [Restart Manager](../rstmgr/restart-manager-portal.md) documentation.</span></span>

 

 
