---
description: El WiMakCab.vbs de archivos de VBScript se proporciona en los componentes de Windows SDK para Windows Installer desarrolladores. En este ejemplo se muestra cómo se usa el script para generar archivadores de archivos a partir de una base de datos de Windows Installer.
ms.assetid: 26671cb9-a200-4520-8b52-4cff3f71a2f2
title: Generar archivo. cab
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3df2355c247ff602d644d2865ec3b9d9a8447ca4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "104002265"
---
# <a name="generate-file-cabinet"></a><span data-ttu-id="89a30-104">Generar archivo. cab</span><span class="sxs-lookup"><span data-stu-id="89a30-104">Generate File Cabinet</span></span>

<span data-ttu-id="89a30-105">El WiMakCab.vbs de archivos de VBScript se proporciona en los [componentes de Windows SDK para Windows Installer desarrolladores](platform-sdk-components-for-windows-installer-developers.md).</span><span class="sxs-lookup"><span data-stu-id="89a30-105">The VBScript file WiMakCab.vbs is provided in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md).</span></span> <span data-ttu-id="89a30-106">En este ejemplo se muestra cómo se usa el script para generar archivadores de archivos a partir de una base de datos de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="89a30-106">This sample shows how script is used to generate file cabinets from a Windows Installer database.</span></span>

<span data-ttu-id="89a30-107">En este ejemplo se muestra:</span><span class="sxs-lookup"><span data-stu-id="89a30-107">This sample demonstrates:</span></span>

-   <span data-ttu-id="89a30-108">[**Método OpenDatabase (objeto Installer)**](installer-opendatabase.md) y el [**método LastErrorRecord**](installer-lasterrorrecord.md) del [**objeto Installer**](installer-object.md)</span><span class="sxs-lookup"><span data-stu-id="89a30-108">[**OpenDatabase method (Installer Object)**](installer-opendatabase.md) and the [**LastErrorRecord method**](installer-lasterrorrecord.md) of the [**Installer Object**](installer-object.md)</span></span>
-   <span data-ttu-id="89a30-109">[**Método commit**](database-commit.md), el [**método OpenView**](database-openview.md) y la [**propiedad SummaryInformation (objeto Database)**](database-summaryinformation.md) del [**objeto Database**](database-object.md)</span><span class="sxs-lookup"><span data-stu-id="89a30-109">[**Commit method**](database-commit.md), the [**OpenView method**](database-openview.md) and [**SummaryInformation property (Database Object)**](database-summaryinformation.md) of the [**Database Object**](database-object.md)</span></span>
-   <span data-ttu-id="89a30-110">[**Método fetch**](view-fetch.md), método [**Execute**](view-execute.md) y [**método Modify**](view-modify.md) del [**objeto View**](view-object.md)</span><span class="sxs-lookup"><span data-stu-id="89a30-110">[**Fetch method**](view-fetch.md), [**Execute method**](view-execute.md) and [**Modify method**](view-modify.md) of the [**View Object**](view-object.md)</span></span>
-   <span data-ttu-id="89a30-111">[**Propiedad StringData**](record-stringdata.md) y [**propiedad IntegerData**](record-integerdata.md) del [**objeto record**](record-object.md)</span><span class="sxs-lookup"><span data-stu-id="89a30-111">[**StringData property**](record-stringdata.md) and [**IntegerData property**](record-integerdata.md) of the [**Record Object**](record-object.md)</span></span>
-   <span data-ttu-id="89a30-112">[**Método OnAction**](session-doaction.md), [**propiedad Property (objeto Session)**](session-session.md)y la [**propiedad Mode**](session-mode.md) del [**objeto Session**](session-object.md)</span><span class="sxs-lookup"><span data-stu-id="89a30-112">[**DoAction method**](session-doaction.md), the [**Property property (Session Object)**](session-session.md), and the [**Mode property**](session-mode.md) of the [**Session Object**](session-object.md)</span></span>

<span data-ttu-id="89a30-113">Para usar este ejemplo, necesitará la versión CScript.exe o WScript.exe de Windows Script Host.</span><span class="sxs-lookup"><span data-stu-id="89a30-113">You'll require the CScript.exe or WScript.exe version of Windows Script Host to use this sample.</span></span> <span data-ttu-id="89a30-114">Para usar CScript.exe para ejecutar este ejemplo, escriba un comando en el símbolo del sistema con la siguiente sintaxis.</span><span class="sxs-lookup"><span data-stu-id="89a30-114">To use CScript.exe to run this sample, type a command at the command prompt using the following syntax.</span></span> <span data-ttu-id="89a30-115">La ayuda se muestra si el primer argumento es/?</span><span class="sxs-lookup"><span data-stu-id="89a30-115">Help is displayed if the first argument is /?</span></span> <span data-ttu-id="89a30-116">o si se especifican pocos argumentos.</span><span class="sxs-lookup"><span data-stu-id="89a30-116">or if too few arguments are specified.</span></span> <span data-ttu-id="89a30-117">Para redirigir la salida a un archivo, finalice la línea de comandos con VBS > \[ *ruta de acceso al archivo* \] .</span><span class="sxs-lookup"><span data-stu-id="89a30-117">To redirect the output to a file, end the command line with VBS > \[*path to file*\].</span></span> <span data-ttu-id="89a30-118">El ejemplo devuelve un valor de 0 para Success, 1 si se invoca la ayuda y 2 si se produce un error en el script.</span><span class="sxs-lookup"><span data-stu-id="89a30-118">The sample returns a value of 0 for success, 1 if help is invoked, and 2 if the script fails.</span></span>

<span data-ttu-id="89a30-119">**cscript WiMakCab.vbs \[ ruta de acceso a \] \[ las \] \[ ubicaciones de origen opcionales de nombre base de base de datos\]**</span><span class="sxs-lookup"><span data-stu-id="89a30-119">**cscript WiMakCab.vbs \[path to database\]\[base name\]\[optional source locations\]**</span></span>

<span data-ttu-id="89a30-120">Para generar un archivo. cab, Makecab.exe debe estar en la ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="89a30-120">In order to generate a cabinet, Makecab.exe must be on the PATH.</span></span> <span data-ttu-id="89a30-121">La utilidad de Makecab.exe se incluye en los [componentes de Windows SDK para Windows Installer desarrolladores](platform-sdk-components-for-windows-installer-developers.md).</span><span class="sxs-lookup"><span data-stu-id="89a30-121">The Makecab.exe utility is included in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md).</span></span> <span data-ttu-id="89a30-122">Tenga en cuenta que el ejemplo no actualiza la [tabla de medios](media-table.md) para controlar varios gabinetes.</span><span class="sxs-lookup"><span data-stu-id="89a30-122">Note that the sample does not update the [Media table](media-table.md) to handle multiple cabinets.</span></span> <span data-ttu-id="89a30-123">Para reemplazar un archivo. cab incrustado, incluya las opciones:/R/C/U/E.</span><span class="sxs-lookup"><span data-stu-id="89a30-123">To replace an embedded cabinet, include the options: /R /C /U /E.</span></span>

<span data-ttu-id="89a30-124">Especifique la ruta de acceso a la base de datos del instalador.</span><span class="sxs-lookup"><span data-stu-id="89a30-124">Specify the path to the installer database.</span></span> <span data-ttu-id="89a30-125">Debe estar ubicado en la raíz del árbol de origen.</span><span class="sxs-lookup"><span data-stu-id="89a30-125">This must be located at the root of the source tree.</span></span> <span data-ttu-id="89a30-126">Especifique el nombre base que distingue entre mayúsculas y minúsculas para los archivos. cab generados.</span><span class="sxs-lookup"><span data-stu-id="89a30-126">Specify the case-sensitive base name for the generated cabinet files.</span></span> <span data-ttu-id="89a30-127">Si el tipo de origen está comprimido, se abren todos los archivos en la raíz.</span><span class="sxs-lookup"><span data-stu-id="89a30-127">If the source type is compressed, all files are opened at the root.</span></span> <span data-ttu-id="89a30-128">Se pueden especificar las siguientes opciones en cualquier punto de la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="89a30-128">The following options may be specified at any point on the command line.</span></span>



| <span data-ttu-id="89a30-129">Opción</span><span class="sxs-lookup"><span data-stu-id="89a30-129">Option</span></span>              | <span data-ttu-id="89a30-130">Descripción</span><span class="sxs-lookup"><span data-stu-id="89a30-130">Description</span></span>                                                                                                                               |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="89a30-131">no se ha especificado ninguna opción</span><span class="sxs-lookup"><span data-stu-id="89a30-131">no option specified</span></span> |                                                                                                                                           |
| <span data-ttu-id="89a30-132">/C</span><span class="sxs-lookup"><span data-stu-id="89a30-132">/C</span></span>                  | <span data-ttu-id="89a30-133">Ejecute la compresión.</span><span class="sxs-lookup"><span data-stu-id="89a30-133">Run compression.</span></span> <span data-ttu-id="89a30-134">Si no se especifica/C, WiMakCab.vbs solo genera el archivo DDF.</span><span class="sxs-lookup"><span data-stu-id="89a30-134">If /C is not specified, WiMakCab.vbs only generates the DDF file.</span></span>                                                        |
| <span data-ttu-id="89a30-135">/L</span><span class="sxs-lookup"><span data-stu-id="89a30-135">/L</span></span>                  | <span data-ttu-id="89a30-136">Use la compresión LZX en lugar de MSZIP</span><span class="sxs-lookup"><span data-stu-id="89a30-136">Use LZX compression instead of MSZIP</span></span>                                                                                                      |
| <span data-ttu-id="89a30-137">/F</span><span class="sxs-lookup"><span data-stu-id="89a30-137">/F</span></span>                  | <span data-ttu-id="89a30-138">Limite el tamaño de los contenedores a un tamaño de disquete de 1,44 MB en lugar de a un CD-ROM</span><span class="sxs-lookup"><span data-stu-id="89a30-138">Limit cabinet size to 1.44 MB floppy size rather than CD-ROM</span></span>                                                                              |
| <span data-ttu-id="89a30-139">/U</span><span class="sxs-lookup"><span data-stu-id="89a30-139">/U</span></span>                  | <span data-ttu-id="89a30-140">Actualizar la base de datos para hacer referencia al archivo. cab generado</span><span class="sxs-lookup"><span data-stu-id="89a30-140">Update the database to reference the generated cabinet</span></span>                                                                                    |
| <span data-ttu-id="89a30-141">/E</span><span class="sxs-lookup"><span data-stu-id="89a30-141">/E</span></span>                  | <span data-ttu-id="89a30-142">Insertar el archivo. cab en el paquete del instalador como una secuencia</span><span class="sxs-lookup"><span data-stu-id="89a30-142">Embed the cabinet file in the installer package as a stream</span></span>                                                                               |
| <span data-ttu-id="89a30-143">/S</span><span class="sxs-lookup"><span data-stu-id="89a30-143">/S</span></span>                  | <span data-ttu-id="89a30-144">Usar números de secuencia en la tabla de archivos ordenados por directorios</span><span class="sxs-lookup"><span data-stu-id="89a30-144">Use sequence numbers in the File table ordered by directories</span></span>                                                                             |
| <span data-ttu-id="89a30-145">/R</span><span class="sxs-lookup"><span data-stu-id="89a30-145">/R</span></span>                  | <span data-ttu-id="89a30-146">Revertir a una instalación que no sea de archivador. Quite Cabinet si se especifica/E (la opción/R quita la propiedad bit comprimido-SummaryInfo 15 & 2)</span><span class="sxs-lookup"><span data-stu-id="89a30-146">Revert to non-cabinet install, remove cabinet if /E is specified (The /R option removes the compressed bit - SummaryInfo property 15 & 2)</span></span> |



 

<span data-ttu-id="89a30-147">Para obtener ejemplos de scripting adicionales, vea [ejemplos de scripting de Windows Installer](windows-installer-scripting-examples.md).</span><span class="sxs-lookup"><span data-stu-id="89a30-147">For additional scripting examples, see [Windows Installer Scripting Examples](windows-installer-scripting-examples.md).</span></span> <span data-ttu-id="89a30-148">Para ver utilidades de ejemplo que no requieren Windows Script Host, vea [Windows Installer herramientas de desarrollo](windows-installer-development-tools.md).</span><span class="sxs-lookup"><span data-stu-id="89a30-148">For sample utilities that do not require Windows Script Host, see [Windows Installer Development Tools](windows-installer-development-tools.md).</span></span>

 

 



