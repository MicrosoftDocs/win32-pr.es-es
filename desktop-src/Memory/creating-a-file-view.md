---
description: Para asignar los datos de un archivo a la memoria virtual de un proceso, debe crear una vista del archivo.
ms.assetid: b1ebd9a4-cde4-4c0c-80d2-5ccb655cd3a4
title: Crear una vista de archivo
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 498f7ba132efd9ecf82f9ec087492c9622824b51
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104001883"
---
# <a name="creating-a-file-view"></a><span data-ttu-id="b06c4-103">Crear una vista de archivo</span><span class="sxs-lookup"><span data-stu-id="b06c4-103">Creating a File View</span></span>

<span data-ttu-id="b06c4-104">Para asignar los datos de un archivo a la memoria virtual de un proceso, debe crear una vista del archivo.</span><span class="sxs-lookup"><span data-stu-id="b06c4-104">To map the data from a file to the virtual memory of a process, you must create a view of the file.</span></span> <span data-ttu-id="b06c4-105">Las funciones [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) y [**MapViewOfFileEx**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffileex) usan el identificador de objeto de asignación de archivos devuelto por [**CreateFileMapping**](/windows/desktop/api/WinBase/nf-winbase-createfilemappinga) para crear una vista del archivo o una parte del archivo en el espacio de direcciones virtuales del proceso.</span><span class="sxs-lookup"><span data-stu-id="b06c4-105">The [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) and [**MapViewOfFileEx**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffileex) functions use the file mapping object handle returned by [**CreateFileMapping**](/windows/desktop/api/WinBase/nf-winbase-createfilemappinga) to create a view of the file or a portion of the file in the process's virtual address space.</span></span> <span data-ttu-id="b06c4-106">Estas funciones producen un error si las marcas de acceso entran en conflicto con las especificadas cuando **CreateFileMapping** creó el objeto de asignación de archivos.</span><span class="sxs-lookup"><span data-stu-id="b06c4-106">These functions fail if the access flags conflict with those specified when **CreateFileMapping** created the file mapping object.</span></span>

<span data-ttu-id="b06c4-107">La función [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) devuelve un puntero a la vista de archivo.</span><span class="sxs-lookup"><span data-stu-id="b06c4-107">The [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) function returns a pointer to the file view.</span></span> <span data-ttu-id="b06c4-108">Al desreferenciar un puntero en el intervalo de direcciones especificado en **MapViewOfFile**, una aplicación puede leer datos del archivo y escribir datos en el archivo.</span><span class="sxs-lookup"><span data-stu-id="b06c4-108">By dereferencing a pointer in the range of addresses specified in **MapViewOfFile**, an application can read data from the file and write data to the file.</span></span> <span data-ttu-id="b06c4-109">Al escribir en la vista de archivos, se producen cambios en el objeto de asignación de archivos.</span><span class="sxs-lookup"><span data-stu-id="b06c4-109">Writing to the file view results in changes to the file mapping object.</span></span> <span data-ttu-id="b06c4-110">El sistema controla la escritura real en el archivo en disco.</span><span class="sxs-lookup"><span data-stu-id="b06c4-110">The actual writing to the file on disk is handled by the system.</span></span> <span data-ttu-id="b06c4-111">Los datos no se transfieren realmente en el momento en que se escribe el objeto de asignación de archivos.</span><span class="sxs-lookup"><span data-stu-id="b06c4-111">Data is not actually transferred at the time the file mapping object is written to.</span></span> <span data-ttu-id="b06c4-112">En su lugar, gran parte de la entrada y salida (e/s) de archivo se almacena en caché para mejorar el rendimiento general del sistema.</span><span class="sxs-lookup"><span data-stu-id="b06c4-112">Instead, much of the file input and output (I/O) is cached to improve general system performance.</span></span> <span data-ttu-id="b06c4-113">Las aplicaciones pueden invalidar este comportamiento mediante una llamada a la función [**FlushViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-flushviewoffile) para obligar al sistema a realizar las transacciones de disco inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="b06c4-113">Applications can override this behavior by calling the [**FlushViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-flushviewoffile) function to force the system to perform disk transactions immediately.</span></span>

<span data-ttu-id="b06c4-114">La función [**MapViewOfFileEx**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffileex) funciona exactamente igual que la función [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) , salvo que permite a un proceso especificar la dirección base de la vista del archivo en el espacio de direcciones virtuales del proceso en el parámetro *lpvBase* .</span><span class="sxs-lookup"><span data-stu-id="b06c4-114">The [**MapViewOfFileEx**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffileex) function works exactly like the [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) function except that it allows a process to specify the base address of the view of the file in the process's virtual address space in the *lpvBase* parameter.</span></span> <span data-ttu-id="b06c4-115">Si no hay espacio suficiente en la dirección especificada, se produce un error en la llamada.</span><span class="sxs-lookup"><span data-stu-id="b06c4-115">If there is not enough space at the specified address, the call fails.</span></span> <span data-ttu-id="b06c4-116">Por lo tanto, si debe asignar un archivo a la misma dirección en varios procesos, los procesos deben negociar una dirección adecuada: el parámetro *lpvBase* debe ser un múltiplo entero de la granularidad de asignación de memoria del sistema o se producirá un error en la llamada.</span><span class="sxs-lookup"><span data-stu-id="b06c4-116">Therefore, if you must map a file to the same address in multiple processes, the processes should negotiate an appropriate address: The *lpvBase* parameter must be an integral multiple of the system memory allocation granularity or the call fails.</span></span> <span data-ttu-id="b06c4-117">Para obtener la granularidad de asignación de memoria del sistema, use la función [**GetSystemInfo**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-getsysteminfo) , que rellena los miembros de una estructura [**de \_ información del sistema**](/windows/win32/api/sysinfoapi/ns-sysinfoapi-system_info) .</span><span class="sxs-lookup"><span data-stu-id="b06c4-117">To obtain the system's memory allocation granularity, use the [**GetSystemInfo**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-getsysteminfo) function, which fills in the members of a [**SYSTEM\_INFO**](/windows/win32/api/sysinfoapi/ns-sysinfoapi-system_info) structure.</span></span>

<span data-ttu-id="b06c4-118">Una aplicación puede crear varias vistas de archivo a partir del mismo objeto de asignación de archivos.</span><span class="sxs-lookup"><span data-stu-id="b06c4-118">An application can create multiple file views from the same file mapping object.</span></span> <span data-ttu-id="b06c4-119">Una vista de archivo puede tener un tamaño diferente que el objeto de asignación de archivos del que se deriva, pero debe ser menor que el objeto de asignación de archivos.</span><span class="sxs-lookup"><span data-stu-id="b06c4-119">A file view can be a different size than the file mapping object from which it is derived, but it must be smaller than the file mapping object.</span></span> <span data-ttu-id="b06c4-120">El desplazamiento especificado por los parámetros *dwOffsetHigh* y *dwOffsetLow* de [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) debe ser un múltiplo de la granularidad de asignación del sistema.</span><span class="sxs-lookup"><span data-stu-id="b06c4-120">The offset specified by the *dwOffsetHigh* and *dwOffsetLow* parameters of [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) must be a multiple of the allocation granularity of the system.</span></span>

## <a name="related-topics"></a><span data-ttu-id="b06c4-121">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="b06c4-121">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b06c4-122">Crear una vista dentro de un archivo</span><span class="sxs-lookup"><span data-stu-id="b06c4-122">Creating a View Within a File</span></span>](creating-a-view-within-a-file.md)
</dt> </dl>

 

 
