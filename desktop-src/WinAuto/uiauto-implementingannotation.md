---
title: Patrón de control Annotation
description: Describe las directrices y convenciones para implementar IAnnotationProvider, incluida información sobre propiedades y métodos. El patrón de control Annotation se usa para exponer las propiedades de una anotación en un documento.
ms.assetid: 5A334991-66AF-4A82-9A09-09D5BDAAA771
keywords:
- Automatización de la interfaz de usuario, implementar el patrón de control Annotation
- Automatización de la interfaz de usuario, patrón de control Annotation
- Automatización de la interfaz de usuario, IAnnotationProvider
- IAnnotationProvider
- implementar el patrón de control Annotation de UI Automation
- patrón de control Annotation
- patrones de control, IAnnotationProvider
- patrones de control, implementar la anotación de automatización de la interfaz de usuario
- patrones de control, anotación
- interfaces, IAnnotationProvider
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1c1a0441816e548faaa9076b3a9717c0aa76f08a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "105714407"
---
# <a name="annotation-control-pattern"></a><span data-ttu-id="26e08-114">Patrón de control Annotation</span><span class="sxs-lookup"><span data-stu-id="26e08-114">Annotation Control Pattern</span></span>

<span data-ttu-id="26e08-115">Describe las directrices y convenciones para implementar [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider), incluida información sobre propiedades y métodos.</span><span class="sxs-lookup"><span data-stu-id="26e08-115">Describes guidelines and conventions for implementing [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider), including information about properties and methods.</span></span> <span data-ttu-id="26e08-116">El patrón de control **Annotation** se usa para exponer las propiedades de una anotación en un documento.</span><span class="sxs-lookup"><span data-stu-id="26e08-116">The **Annotation** control pattern is used to expose the properties of an annotation in a document.</span></span>

<span data-ttu-id="26e08-117">Un ejemplo es un globo de comentarios que se encuentra en el margen de un documento y está conectado a algún texto del documento o a una celda de la hoja de cálculo.</span><span class="sxs-lookup"><span data-stu-id="26e08-117">One example is a comment balloon that is in the margin of a document and is connected to some document text or a spreadsheet cell.</span></span>

<span data-ttu-id="26e08-118">En la ilustración siguiente se muestra un ejemplo de una anotación.</span><span class="sxs-lookup"><span data-stu-id="26e08-118">The following illustration shows an example of an annotation.</span></span> <span data-ttu-id="26e08-119">Para obtener ejemplos de controles que implementan este patrón de control, vea [tipos de control y sus patrones de control admitidos](uiauto-controlpatternmapping.md).</span><span class="sxs-lookup"><span data-stu-id="26e08-119">For examples of controls that implement this control pattern, see [Control Types and Their Supported Control Patterns](uiauto-controlpatternmapping.md).</span></span>

![captura de pantalla que muestra un comentario BALOON en un documento](images/annotation.png)

<span data-ttu-id="26e08-121">En este tema se incluyen las siguientes secciones.</span><span class="sxs-lookup"><span data-stu-id="26e08-121">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="26e08-122">Directrices y convenciones de implementación</span><span class="sxs-lookup"><span data-stu-id="26e08-122">Implementation Guidelines and Conventions</span></span>](#implementation-guidelines-and-conventions)
-   [<span data-ttu-id="26e08-123">Miembros requeridos para **IAnnotationProvider**</span><span class="sxs-lookup"><span data-stu-id="26e08-123">Required Members for **IAnnotationProvider**</span></span>](#required-members-for-iannotationprovider)
-   [<span data-ttu-id="26e08-124">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="26e08-124">Related topics</span></span>](#related-topics)

## <a name="implementation-guidelines-and-conventions"></a><span data-ttu-id="26e08-125">Directrices y convenciones de implementación</span><span class="sxs-lookup"><span data-stu-id="26e08-125">Implementation Guidelines and Conventions</span></span>

<span data-ttu-id="26e08-126">Al implementar el patrón de control **Annotation** , tenga en cuenta las siguientes directrices y convenciones:</span><span class="sxs-lookup"><span data-stu-id="26e08-126">When implementing the **Annotation** control pattern, note the following guidelines and conventions:</span></span>

-   <span data-ttu-id="26e08-127">Hay muchos tipos diferentes de anotaciones.</span><span class="sxs-lookup"><span data-stu-id="26e08-127">There are many different kinds of annotations.</span></span> <span data-ttu-id="26e08-128">El archivo de encabezado UIAutomationClient. h define un conjunto de valores constantes con nombre que identifican los tipos de anotaciones que admite la automatización de la interfaz de usuario de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="26e08-128">The UIAutomationClient.h header file defines a set of named constant values that identify the types of annotations that Microsoft UI Automation supports.</span></span> <span data-ttu-id="26e08-129">Para obtener más información, vea [**identificadores de tipo de anotación**](uiauto-annotation-type-identifiers.md).</span><span class="sxs-lookup"><span data-stu-id="26e08-129">For more information, see [**Annotation Type Identifiers**](uiauto-annotation-type-identifiers.md).</span></span>
-   <span data-ttu-id="26e08-130">Si usa [**AnnotationType \_ Unknown**](uiauto-annotation-type-identifiers.md), debe implementar la propiedad [**IAnnotationProvider:: AnnotationTypeName**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_annotationtypename) para permitir que los clientes detecten el nombre del tipo de anotación.</span><span class="sxs-lookup"><span data-stu-id="26e08-130">If you use [**AnnotationType\_Unknown**](uiauto-annotation-type-identifiers.md), you must implement the [**IAnnotationProvider::AnnotationTypeName**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_annotationtypename) property to enable clients to discover the name of the annotation type.</span></span> <span data-ttu-id="26e08-131">No es necesario implementar **AnnotationTypeName** para un tipo de anotación estándar, ya que la automatización de la interfaz de usuario proporciona un nombre predeterminado, pero se puede implementar si es necesario reemplazar el nombre predeterminado.</span><span class="sxs-lookup"><span data-stu-id="26e08-131">You do not need to implement **AnnotationTypeName** for a standard annotation type because UI Automation provides a default name, but you can implement it if you need to override the default name.</span></span>
-   <span data-ttu-id="26e08-132">La propiedad [**IAnnotationProvider:: Author**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_author) es opcional.</span><span class="sxs-lookup"><span data-stu-id="26e08-132">The [**IAnnotationProvider::Author**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_author) property is optional.</span></span>
-   <span data-ttu-id="26e08-133">La propiedad [**IAnnotationProvider::D atetime**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_datetime) es opcional.</span><span class="sxs-lookup"><span data-stu-id="26e08-133">The [**IAnnotationProvider::DateTime**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_datetime) property is optional.</span></span>
-   <span data-ttu-id="26e08-134">La propiedad [**IAnnotationProvider:: target**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_target) es necesaria porque vincula una anotación a un elemento de la interfaz de usuario, lo que permite a un cliente navegar desde la anotación hasta el elemento de la interfaz de usuario al que hace referencia la anotación.</span><span class="sxs-lookup"><span data-stu-id="26e08-134">The [**IAnnotationProvider::Target**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_target) property is required because it links an annotation to a UI element, enabling a client to navigate from the annotation back to the UI element to which the annotation refers.</span></span>
-   <span data-ttu-id="26e08-135">Dado que las anotaciones pueden adoptar muchas formas diferentes, la interfaz [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) no define una propiedad para almacenar el valor o el texto de una anotación.</span><span class="sxs-lookup"><span data-stu-id="26e08-135">Because annotations can take many different forms, the [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) interface does not define a property for storing the value or text of an annotation.</span></span> <span data-ttu-id="26e08-136">Una anotación simple debe exponer la interfaz [**IValueProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider) y la propiedad [**IValueProvider:: Value**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivalueprovider-get_value) debe devolver un valor de solo lectura que especifique el texto de la anotación.</span><span class="sxs-lookup"><span data-stu-id="26e08-136">A simple annotation should expose the [**IValueProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider) interface, and the [**IValueProvider::Value**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivalueprovider-get_value) property should return a read-only value that specifies the annotation text.</span></span> <span data-ttu-id="26e08-137">Una anotación más enriquecida debe exponer la interfaz [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) para proporcionar texto más completo a los clientes.</span><span class="sxs-lookup"><span data-stu-id="26e08-137">A richer annotation should expose the [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) interface to provide richer text to clients.</span></span>
-   <span data-ttu-id="26e08-138">Desplazarse de un elemento de la interfaz de usuario a una anotación en el elemento depende del tipo de elemento que se va a anotar, como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="26e08-138">Navigating from a UI element to an annotation on the element depends on the kind of element being annotated, as follows:</span></span>
    -   <span data-ttu-id="26e08-139">En las celdas de la hoja de cálculo, implemente el método [**ISpreadsheetItemProvider:: GetAnnotationObjects**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-ispreadsheetitemprovider-getannotationobjects) para hacer referencia a la anotación.</span><span class="sxs-lookup"><span data-stu-id="26e08-139">For spreadsheet cells, implement the [**ISpreadsheetItemProvider::GetAnnotationObjects**](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-ispreadsheetitemprovider-getannotationobjects) method to refer to the annotation.</span></span>
    -   <span data-ttu-id="26e08-140">En el caso de contenido textual, implemente el atributo de texto [**AnnotationObjects**](uiauto-textattribute-ids.md) en la interfaz [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) para hacer referencia a la anotación.</span><span class="sxs-lookup"><span data-stu-id="26e08-140">For textual content, implement the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute on the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface to refer to the annotation.</span></span>
-   <span data-ttu-id="26e08-141">Algunos tipos de anotaciones no requieren una implementación completa de la interfaz [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) .</span><span class="sxs-lookup"><span data-stu-id="26e08-141">Some kinds of annotations do not require a full implementation of the [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) interface.</span></span> <span data-ttu-id="26e08-142">Por ejemplo, un indicador de error ortográfico simple podría representarse al tener la interfaz [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) que devuelve un atributo de texto [**AnnotationTypes**](uiauto-textattribute-ids.md) de [**AnnotationType \_ SpellingError**](uiauto-annotation-type-identifiers.md)y un valor null para el atributo de texto [**AnnotationObjects**](uiauto-textattribute-ids.md) .</span><span class="sxs-lookup"><span data-stu-id="26e08-142">For example, a simple spelling-error indicator could be represented by having the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface return an [**AnnotationTypes**](uiauto-textattribute-ids.md) text attribute of [**AnnotationType\_SpellingError**](uiauto-annotation-type-identifiers.md), and a null value for the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute.</span></span>
-   <span data-ttu-id="26e08-143">Puede ser útil implementar la interfaz [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) en un elemento de la interfaz de usuario que no está visible.</span><span class="sxs-lookup"><span data-stu-id="26e08-143">It can be useful to implement the [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) interface on a UI element that is not visible.</span></span> <span data-ttu-id="26e08-144">Por ejemplo, podría crear un elemento de automatización de la interfaz de usuario no visible que implementa **IAnnotationProvider** para proporcionar información extendida sobre un error gramatical.</span><span class="sxs-lookup"><span data-stu-id="26e08-144">For example, you could create a non-visible UI Automation element that implements **IAnnotationProvider** to provide extended information about a grammar error.</span></span>
-   <span data-ttu-id="26e08-145">Las anotaciones de un control basado en texto pueden ser complejas si el control contiene comentarios que se superponen.</span><span class="sxs-lookup"><span data-stu-id="26e08-145">Annotations in a text-based control can be complex if the control contains overlapping comments.</span></span> <span data-ttu-id="26e08-146">Utilice las siguientes directrices para administrar anotaciones complejas:</span><span class="sxs-lookup"><span data-stu-id="26e08-146">Use the following guidelines to handle complex annotations:</span></span>
    -   <span data-ttu-id="26e08-147">Un intervalo de texto sin anotaciones debe devolver una matriz vacía para el atributo de texto [**AnnotationTypes**](uiauto-textattribute-ids.md) y una matriz vacía para el atributo de texto [**AnnotationObjects**](uiauto-textattribute-ids.md) .</span><span class="sxs-lookup"><span data-stu-id="26e08-147">A text range with no annotations should return an empty array for the [**AnnotationTypes**](uiauto-textattribute-ids.md) text attribute and an empty array for the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute.</span></span>
    -   <span data-ttu-id="26e08-148">Un intervalo de texto con una anotación debe devolver una matriz de un valor entero para el atributo de texto [**AnnotationTypes**](uiauto-textattribute-ids.md) y una matriz de una interfaz [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) para el atributo de texto [**AnnotationObjects**](uiauto-textattribute-ids.md) .</span><span class="sxs-lookup"><span data-stu-id="26e08-148">A text range with one annotation should return an array of one integer value for the [**AnnotationTypes**](uiauto-textattribute-ids.md) text attribute and an array of one [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interface for the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute.</span></span>
    -   <span data-ttu-id="26e08-149">Un intervalo de texto con varias anotaciones debe devolver una matriz de varios valores enteros para el atributo de texto [**AnnotationTypes**](uiauto-textattribute-ids.md) y una matriz de un número coincidente de interfaces [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) para el atributo de texto [**AnnotationObjects**](uiauto-textattribute-ids.md) .</span><span class="sxs-lookup"><span data-stu-id="26e08-149">A text range with multiple annotations should return an array of multiple integer values for the [**AnnotationTypes**](uiauto-textattribute-ids.md) text attribute and an array of a matching number of [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interfaces for the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute.</span></span>
    -   <span data-ttu-id="26e08-150">Un intervalo de texto con anotaciones variables, como un intervalo con texto anotado y sin anotar, debe devolver la propiedad [**ReservedMixedAttributeValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservedmixedattributevalue) para [**AnnotationTypes**](uiauto-textattribute-ids.md) y [**AnnotationObjects**](uiauto-textattribute-ids.md).</span><span class="sxs-lookup"><span data-stu-id="26e08-150">A text range with varying annotations, such as a range with both annotated and non-annotated text, should return the [**ReservedMixedAttributeValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservedmixedattributevalue) property for both [**AnnotationTypes**](uiauto-textattribute-ids.md) and [**AnnotationObjects**](uiauto-textattribute-ids.md).</span></span> <span data-ttu-id="26e08-151">Un cliente que recibe esta respuesta puede subdividir el intervalo de texto para encontrar dónde comienzan y finalizan las anotaciones.</span><span class="sxs-lookup"><span data-stu-id="26e08-151">A client receiving this response can subdivide the text range to find where the annotations begin and end.</span></span>

## <a name="required-members-for-iannotationprovider"></a><span data-ttu-id="26e08-152">Miembros requeridos para **IAnnotationProvider**</span><span class="sxs-lookup"><span data-stu-id="26e08-152">Required Members for **IAnnotationProvider**</span></span>

<span data-ttu-id="26e08-153">Las siguientes propiedades son necesarias para implementar la interfaz [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) .</span><span class="sxs-lookup"><span data-stu-id="26e08-153">The following properties are required for implementing the [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider) interface.</span></span>



| <span data-ttu-id="26e08-154">Miembros requeridos</span><span class="sxs-lookup"><span data-stu-id="26e08-154">Required members</span></span>                                                                | <span data-ttu-id="26e08-155">Tipo de miembro</span><span class="sxs-lookup"><span data-stu-id="26e08-155">Member type</span></span> | <span data-ttu-id="26e08-156">Notas</span><span class="sxs-lookup"><span data-stu-id="26e08-156">Notes</span></span> |
|---------------------------------------------------------------------------------|-------------|-------|
| [<span data-ttu-id="26e08-157">**AnnotationTypeId**</span><span class="sxs-lookup"><span data-stu-id="26e08-157">**AnnotationTypeId**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_annotationtypeid)     | <span data-ttu-id="26e08-158">Propiedad</span><span class="sxs-lookup"><span data-stu-id="26e08-158">Property</span></span>    | <span data-ttu-id="26e08-159">Ninguno.</span><span class="sxs-lookup"><span data-stu-id="26e08-159">None.</span></span> |
| [<span data-ttu-id="26e08-160">**AnnotationTypeName**</span><span class="sxs-lookup"><span data-stu-id="26e08-160">**AnnotationTypeName**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_annotationtypename) | <span data-ttu-id="26e08-161">Propiedad</span><span class="sxs-lookup"><span data-stu-id="26e08-161">Property</span></span>    | <span data-ttu-id="26e08-162">Ninguno.</span><span class="sxs-lookup"><span data-stu-id="26e08-162">None.</span></span> |
| [<span data-ttu-id="26e08-163">**Autor**</span><span class="sxs-lookup"><span data-stu-id="26e08-163">**Author**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_author)                         | <span data-ttu-id="26e08-164">Propiedad</span><span class="sxs-lookup"><span data-stu-id="26e08-164">Property</span></span>    | <span data-ttu-id="26e08-165">Ninguno.</span><span class="sxs-lookup"><span data-stu-id="26e08-165">None.</span></span> |
| [<span data-ttu-id="26e08-166">**DateTime**</span><span class="sxs-lookup"><span data-stu-id="26e08-166">**DateTime**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_datetime)                     | <span data-ttu-id="26e08-167">Propiedad</span><span class="sxs-lookup"><span data-stu-id="26e08-167">Property</span></span>    | <span data-ttu-id="26e08-168">Ninguno.</span><span class="sxs-lookup"><span data-stu-id="26e08-168">None.</span></span> |
| [<span data-ttu-id="26e08-169">**Destino**</span><span class="sxs-lookup"><span data-stu-id="26e08-169">**Target**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-iannotationprovider-get_target)                         | <span data-ttu-id="26e08-170">Propiedad</span><span class="sxs-lookup"><span data-stu-id="26e08-170">Property</span></span>    | <span data-ttu-id="26e08-171">Ninguno.</span><span class="sxs-lookup"><span data-stu-id="26e08-171">None.</span></span> |



 

<span data-ttu-id="26e08-172">Este patrón de control no tiene eventos asociados.</span><span class="sxs-lookup"><span data-stu-id="26e08-172">This control pattern has no associated events.</span></span>

## <a name="related-topics"></a><span data-ttu-id="26e08-173">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="26e08-173">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="26e08-174">Tipos de control y sus patrones de control admitidos</span><span class="sxs-lookup"><span data-stu-id="26e08-174">Control Types and Their Supported Control Patterns</span></span>](uiauto-controlpatternmapping.md)
</dt> <dt>

[<span data-ttu-id="26e08-175">Información general acerca de los patrones de control de UI Automation</span><span class="sxs-lookup"><span data-stu-id="26e08-175">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="26e08-176">Información general sobre el árbol de la UI Automation</span><span class="sxs-lookup"><span data-stu-id="26e08-176">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)
</dt> </dl>

 

 