---
title: Obtener un puntero a un objeto
description: Obtener un puntero a un objeto
ms.assetid: 4af9d356-402b-4e69-9f6e-8589057d3ac4
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0476d36390e7077e7fdd75eef8d95e8173683891
ms.sourcegitcommit: 307b14e9847ced354a52a1ac12d7f659722d99bb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/06/2020
ms.locfileid: "105714343"
---
# <a name="getting-a-pointer-to-an-object"></a><span data-ttu-id="987b7-103">Obtener un puntero a un objeto</span><span class="sxs-lookup"><span data-stu-id="987b7-103">Getting a Pointer to an Object</span></span>

<span data-ttu-id="987b7-104">Dado que COM no tiene un modelo de clase estricto, hay cuatro maneras en las que un cliente puede crear instancias u obtener un puntero a una interfaz en un objeto:</span><span class="sxs-lookup"><span data-stu-id="987b7-104">Because COM does not have a strict class model, there are four ways that a client can instantiate or get a pointer to an interface on an object:</span></span>

-   <span data-ttu-id="987b7-105">Llamar a una función de biblioteca COM que crea un objeto de un tipo predeterminado; es decir, la función devolverá un puntero a una sola interfaz específica para una clase de objeto específica.</span><span class="sxs-lookup"><span data-stu-id="987b7-105">Call a COM library function that creates an object of a predetermined type; that is, the function will return a pointer to only one specific interface for a specific object class.</span></span>
-   <span data-ttu-id="987b7-106">Llamar a una función de biblioteca COM que puede crear un objeto basado en un identificador de clase (CLSID) y que devuelve cualquier tipo de puntero de interfaz solicitado.</span><span class="sxs-lookup"><span data-stu-id="987b7-106">Call a COM library function that can create an object based on a class identifier (CLSID) and that returns any type of interface pointer requested.</span></span>
-   <span data-ttu-id="987b7-107">Llame a un método de alguna interfaz que cree otro objeto (o se conecte a uno existente) y devuelva un puntero de interfaz en ese objeto independiente.</span><span class="sxs-lookup"><span data-stu-id="987b7-107">Call a method of some interface that creates another object (or connects to an existing one) and returns an interface pointer on that separate object.</span></span>
-   <span data-ttu-id="987b7-108">Implemente un objeto con una interfaz a través de la cual otros objetos pasan el puntero de interfaz al cliente directamente.</span><span class="sxs-lookup"><span data-stu-id="987b7-108">Implement an object with an interface through which other objects pass their interface pointer to the client directly.</span></span>

<span data-ttu-id="987b7-109">Para obtener información sobre cómo obtener punteros a otras interfaces en un objeto después de tener el primero, vea [QueryInterface: explorar en un objeto](queryinterface--navigating-in-an-object.md).</span><span class="sxs-lookup"><span data-stu-id="987b7-109">For information on getting pointers to other interfaces on an object after you have the first one, see [QueryInterface: Navigating in an Object](queryinterface--navigating-in-an-object.md).</span></span>

## <a name="creating-an-object-of-a-predetermined-type"></a><span data-ttu-id="987b7-110">Crear un objeto de un tipo predeterminado</span><span class="sxs-lookup"><span data-stu-id="987b7-110">Creating an Object of a Predetermined Type</span></span>

<span data-ttu-id="987b7-111">Hay numerosas funciones COM, como [**CoGetMalloc**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetmalloc), que devuelven punteros a implementaciones de interfaz específicas.</span><span class="sxs-lookup"><span data-stu-id="987b7-111">There are numerous COM functions, such as [**CoGetMalloc**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetmalloc), that return pointers to specific interface implementations.</span></span> <span data-ttu-id="987b7-112">(**CoGetMalloc** recupera un puntero al asignador de memoria com estándar). La mayoría de ellas son funciones auxiliares y la mayoría de estas funciones se describen en las secciones de referencia de esta documentación, en el área específica en la que están relacionadas, como almacenamiento o transferencia de datos.</span><span class="sxs-lookup"><span data-stu-id="987b7-112">(**CoGetMalloc** retrieves a pointer to the standard COM memory allocator.) Most of these are helper functions, and most of these functions are described in the reference sections of this documentation, under the specific area they are related to, such as storage or data transfer.</span></span>

## <a name="creating-an-object-based-on-a-clsid"></a><span data-ttu-id="987b7-113">Crear un objeto basado en un CLSID</span><span class="sxs-lookup"><span data-stu-id="987b7-113">Creating an Object Based on a CLSID</span></span>

<span data-ttu-id="987b7-114">Hay varias funciones que, dado un CLSID, un cliente puede llamar a para crear una instancia de objeto y obtener un puntero a ella.</span><span class="sxs-lookup"><span data-stu-id="987b7-114">There are several functions that, given a CLSID, a client can call to create an object instance and get a pointer to it.</span></span> <span data-ttu-id="987b7-115">Todas estas funciones se basan en la función [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject), que crea un objeto de clase y proporciona un puntero a una interfaz que le permite crear instancias de esa clase.</span><span class="sxs-lookup"><span data-stu-id="987b7-115">All of these functions are based on the function [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject), which creates a class object and supplies a pointer to an interface that allows you to create instances of that class.</span></span> <span data-ttu-id="987b7-116">Aunque debe haber información que indique en qué sistema reside el servidor, no es necesario que esa información esté contenida en el cliente.</span><span class="sxs-lookup"><span data-stu-id="987b7-116">While there must be information that says which system the server resides on, there is no need for that information to be contained in the client.</span></span> <span data-ttu-id="987b7-117">El cliente solo necesita conocer el CLSID y nunca la ruta de acceso absoluta del código de servidor.</span><span class="sxs-lookup"><span data-stu-id="987b7-117">The client needs to know only the CLSID and never the absolute path of the server code.</span></span> <span data-ttu-id="987b7-118">Para obtener más información, vea [crear un objeto a través de un objeto de clase](creating-an-object-through-a-class-object.md).</span><span class="sxs-lookup"><span data-stu-id="987b7-118">For more information, see [Creating an Object Through a Class Object](creating-an-object-through-a-class-object.md).</span></span>

## <a name="returning-a-pointer-to-a-separate-object"></a><span data-ttu-id="987b7-119">Devolver un puntero a un objeto independiente</span><span class="sxs-lookup"><span data-stu-id="987b7-119">Returning a Pointer to a Separate Object</span></span>

<span data-ttu-id="987b7-120">Entre los muchos métodos de interfaz que devuelven un puntero a un objeto independiente se encuentran varios que crean y devuelven un puntero a un *objeto de enumerador*, lo que permite determinar el número de elementos de un tipo determinado que mantiene un objeto.</span><span class="sxs-lookup"><span data-stu-id="987b7-120">Among the many interface methods that return a pointer to a separate object are several that create and return a pointer to an *enumerator object*, which allows you to determine how many items of a given type an object maintains.</span></span> <span data-ttu-id="987b7-121">COM define interfaces para enumerar una gran variedad de elementos, como cadenas, estructuras importantes, monikers y punteros de interfaz [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) .</span><span class="sxs-lookup"><span data-stu-id="987b7-121">COM defines interfaces for enumerating a wide variety of items, such as strings, important structures, monikers, and [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface pointers.</span></span> <span data-ttu-id="987b7-122">La forma habitual de crear una instancia de enumerador y obtener un puntero a su interfaz es llamar a un método desde otra interfaz.</span><span class="sxs-lookup"><span data-stu-id="987b7-122">The typical way to create an enumerator instance and get a pointer to its interface is to call a method from another interface.</span></span> <span data-ttu-id="987b7-123">Por ejemplo, la interfaz [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) define dos métodos, [**EnumDAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise) y [**del EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc), que devuelven punteros a interfaces en dos objetos de enumeración diferentes.</span><span class="sxs-lookup"><span data-stu-id="987b7-123">For example, the [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface defines two methods, [**EnumDAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise) and [**EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc), that return pointers to interfaces on two different enumeration objects.</span></span> <span data-ttu-id="987b7-124">Hay muchos otros ejemplos en COM de métodos que devuelven punteros a objetos, como la interfaz de documento compuesta OLE [**IOleObject:: GetClientSite**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getclientsite), que, cuando se llama en el objeto incrustado o vinculado, devuelve un puntero a la implementación de [**IOleClientSite**](/windows/desktop/api/OleIdl/nn-oleidl-ioleclientsite)del objeto contenedor.</span><span class="sxs-lookup"><span data-stu-id="987b7-124">There are many other examples in COM of methods that return pointers to objects, such as the OLE compound document interface [**IOleObject::GetClientSite**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getclientsite), which, when called on the embedded or linked object, returns a pointer to the container object's implementation of [**IOleClientSite**](/windows/desktop/api/OleIdl/nn-oleidl-ioleclientsite).</span></span>

## <a name="implementing-an-object-through-which-to-pass-an-interface-pointer-directly-to-the-client"></a><span data-ttu-id="987b7-125">Implementar un objeto a través del cual pasar un puntero de interfaz directamente al cliente</span><span class="sxs-lookup"><span data-stu-id="987b7-125">Implementing an Object Through Which to Pass an Interface Pointer Directly to the Client</span></span>

<span data-ttu-id="987b7-126">Cuando dos objetos, como un contenedor de documentos OLE compuesto y un servidor, necesitan una comunicación bidireccional, cada uno implementa un objeto que contiene un método de interfaz a través del cual puede pasar un puntero de interfaz al otro objeto.</span><span class="sxs-lookup"><span data-stu-id="987b7-126">When two objects, such as an OLE compound document container and server, need bidirectional communication, each implements an object containing an interface method through which it can pass an interface pointer to the other object.</span></span> <span data-ttu-id="987b7-127">El objeto de implementación, que también es el cliente del objeto creado, puede llamar al método y obtener el puntero que se pasó.</span><span class="sxs-lookup"><span data-stu-id="987b7-127">The implementing object, which is also the client of the created object, can then call the method and get the pointer that was passed.</span></span>

## <a name="related-topics"></a><span data-ttu-id="987b7-128">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="987b7-128">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="987b7-129">Clientes y servidores COM</span><span class="sxs-lookup"><span data-stu-id="987b7-129">COM Clients and Servers</span></span>](com-clients-and-servers.md)
</dt> <dt>

[<span data-ttu-id="987b7-130">Responsabilidades del servidor COM</span><span class="sxs-lookup"><span data-stu-id="987b7-130">COM Server Responsibilities</span></span>](com-server-responsibilities.md)
</dt> </dl>

 

 




