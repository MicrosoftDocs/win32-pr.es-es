---
title: Establecer y cambiar las contraseñas de usuario con el proveedor LDAP
description: Para establecer una contraseña de usuario, use el método IADsUser. SetPassword.
ms.assetid: da3d9861-dd04-406c-9356-db1e4ff0eebc
ms.tgt_platform: multiple
keywords:
- ADSI Provider de LDAP, objeto de usuario, establecer contraseñas
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5488146de271ac1108a904cd85163fad9d7dd205
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/21/2020
ms.locfileid: "104359410"
---
# <a name="setting-and-changing-user-passwords-with-the-ldap-provider"></a><span data-ttu-id="3acfa-104">Establecer y cambiar las contraseñas de usuario con el proveedor LDAP</span><span class="sxs-lookup"><span data-stu-id="3acfa-104">Setting and Changing User Passwords with the LDAP Provider</span></span>

<span data-ttu-id="3acfa-105">Para establecer una contraseña de usuario, use el método [**IADsUser. SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword) .</span><span class="sxs-lookup"><span data-stu-id="3acfa-105">To a set a user password, use the [**IADsUser.SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword) method.</span></span>

<span data-ttu-id="3acfa-106">El proveedor LDAP de Active Directory usa uno de tres procesos para establecer la contraseña (los directorios LDAP de terceros como iPlanet no usan este proceso de autenticación de contraseña).</span><span class="sxs-lookup"><span data-stu-id="3acfa-106">The LDAP provider for Active Directory uses one of three processes to set the password (third-party LDAP directories such as iPlanet do not use this password authentication process).</span></span> <span data-ttu-id="3acfa-107">El método puede variar según la configuración de red.</span><span class="sxs-lookup"><span data-stu-id="3acfa-107">The method may vary according to the network configuration.</span></span> <span data-ttu-id="3acfa-108">Los métodos set password se producen en el orden siguiente:</span><span class="sxs-lookup"><span data-stu-id="3acfa-108">The set password methods occur in the following order:</span></span>

-   <span data-ttu-id="3acfa-109">En primer lugar, el proveedor LDAP intenta usar LDAP a través de una conexión SSL de 128 bits.</span><span class="sxs-lookup"><span data-stu-id="3acfa-109">First, the LDAP provider attempts to use LDAP over a 128-bit SSL connection.</span></span> <span data-ttu-id="3acfa-110">Para que SSL de LDAP funcione correctamente, el servidor LDAP debe tener instalado el certificado de autenticación de servidor apropiado y los clientes que ejecutan el código ADSI deben confiar en la autoridad que emitió dichos certificados.</span><span class="sxs-lookup"><span data-stu-id="3acfa-110">For LDAP SSL to operate successfully, the LDAP server must have the appropriate server authentication certificate installed and the clients running the ADSI code must trust the authority that issued those certificates.</span></span> <span data-ttu-id="3acfa-111">Tanto el servidor como el cliente deben admitir el cifrado de 128 bits.</span><span class="sxs-lookup"><span data-stu-id="3acfa-111">Both the server and the client must support 128-bit encryption.</span></span>
-   <span data-ttu-id="3acfa-112">En segundo lugar, si la conexión SSL no se realiza correctamente, el proveedor LDAP intenta usar Kerberos.</span><span class="sxs-lookup"><span data-stu-id="3acfa-112">Second, if the SSL connection is unsuccessful, the LDAP provider attempts to use Kerberos.</span></span> <span data-ttu-id="3acfa-113">En Windows 2000, es posible que Kerberos no admita la autenticación entre bosques.</span><span class="sxs-lookup"><span data-stu-id="3acfa-113">On Windows 2000, Kerberos may not support cross-forest authentication.</span></span> <span data-ttu-id="3acfa-114">Las mejoras posteriores a Kerberos admiten la autenticación entre bosques.</span><span class="sxs-lookup"><span data-stu-id="3acfa-114">Later enhancements to Kerberos support cross-forest authentication.</span></span>
-   <span data-ttu-id="3acfa-115">En tercer lugar, si Kerberos no se realiza correctamente, el proveedor LDAP intenta una llamada a la API de [**NetUserSetInfo**](/windows/desktop/api/lmaccess/nf-lmaccess-netusersetinfo) .</span><span class="sxs-lookup"><span data-stu-id="3acfa-115">Third, if Kerberos is unsuccessful, the LDAP provider attempts a [**NetUserSetInfo**](/windows/desktop/api/lmaccess/nf-lmaccess-netusersetinfo) API call.</span></span> <span data-ttu-id="3acfa-116">En versiones anteriores, ADSI llamaba **NetUserSetInfo** en el contexto de seguridad en el que se estaba ejecutando el subproceso, y no el contexto de seguridad especificado en la llamada a [**IADsOpenDSObject. OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) o [**ADsOpenObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsopenobject).</span><span class="sxs-lookup"><span data-stu-id="3acfa-116">In previous releases, ADSI called **NetUserSetInfo** in the security context in which the thread was running, and not the security context specified in the call to [**IADsOpenDSObject.OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) or [**ADsOpenObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsopenobject).</span></span> <span data-ttu-id="3acfa-117">En versiones posteriores, se cambió para que el proveedor LDAP de ADSI suplante al usuario especificado en la llamada a **OpenDSObject** cuando llama a **NetUserSetInfo**.</span><span class="sxs-lookup"><span data-stu-id="3acfa-117">In later releases, this was changed so that the ADSI LDAP provider would impersonate the user specified in the **OpenDSObject** call when it calls **NetUserSetInfo**.</span></span>

<span data-ttu-id="3acfa-118">Para cambiar una contraseña de usuario, use el método [**IADsUser. ChangePassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-changepassword) .</span><span class="sxs-lookup"><span data-stu-id="3acfa-118">To change a user password, use the [**IADsUser.ChangePassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-changepassword) method.</span></span> <span data-ttu-id="3acfa-119">Como [**SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword), este método puede usar varios procesos para cambiar la contraseña.</span><span class="sxs-lookup"><span data-stu-id="3acfa-119">Like [**SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword), this method can use multiple processes to change the password.</span></span> <span data-ttu-id="3acfa-120">Los métodos de cambio de contraseña se producen en el orden siguiente:</span><span class="sxs-lookup"><span data-stu-id="3acfa-120">The change password methods occur in the following order:</span></span>

-   <span data-ttu-id="3acfa-121">En primer lugar, el proveedor LDAP intenta usar LDAP a través de una conexión SSL de 128 bits.</span><span class="sxs-lookup"><span data-stu-id="3acfa-121">First, the LDAP provider tries to use LDAP over a 128-bit SSL connection.</span></span>
-   <span data-ttu-id="3acfa-122">En segundo lugar, si la conexión 128-SSL no se realiza correctamente, el proveedor LDAP intenta una llamada a la API [**NetUserChangePassword**](/windows/desktop/api/lmaccess/nf-lmaccess-netuserchangepassword) .</span><span class="sxs-lookup"><span data-stu-id="3acfa-122">Second, if the 128-SSL connection is unsuccessful, the LDAP provider tries a [**NetUserChangePassword**](/windows/desktop/api/lmaccess/nf-lmaccess-netuserchangepassword) API call.</span></span> <span data-ttu-id="3acfa-123">Como [**SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword), en versiones anteriores, el proveedor LDAP de ADSI suplanta las credenciales de usuario pasadas mediante el método [**IADsOpenDSObject. OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) o la función [**ADsOpenObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsopenobject) .</span><span class="sxs-lookup"><span data-stu-id="3acfa-123">Like [**SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword), in earlier releases, the ADSI LDAP provider impersonates the user credentials passed using the [**IADsOpenDSObject.OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) method or the [**ADsOpenObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsopenobject) function.</span></span>

 

 