---
title: Algoritmos y esquema de perfil del modelo de mapa de gama de WCS
description: Algoritmos y esquema de perfil del modelo de mapa de gama de WCS
ms.assetid: 64b9871a-1b4f-4e9a-be4d-4c25b3198b91
keywords:
- Sistema de color de Windows (WCS), perfil de modelo de mapa de gama (GMMP)
- WCS (sistema de color de Windows), perfil de modelo de mapa de gama (GMMP)
- Administración del color de imagen, perfil de modelo de mapa de gama (GMMP)
- Administración del color, perfil de modelo de mapa de gamas (GMMP)
- colores, perfil de modelo de mapa de gama (GMMP)
- Sistema de color de Windows (WCS), perfiles
- WCS (sistema de colores de Windows), perfiles
- Administración del color de imagen, perfiles
- Administración del color, perfiles
- colores, perfiles
- Perfil de modelo de mapa de gamas (GMMP)
- GMMP (Perfil de modelo de mapa de gama)
- Perfil de modelo de mapa de gama WCS
- esquemas, perfil de modelo de mapa de gama (GMMP)
- algoritmos, perfil de modelo de mapa de gama (GMMP)
ms.localizationpriority: high
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3714e5d7592cb1fbbbfa98e238642a2fcb38bafd
ms.sourcegitcommit: de72a1294df274b0a71dc0fdc42d757e5f6df0f3
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/05/2021
ms.locfileid: "104568207"
---
# <a name="wcs-gamut-map-model-profile-schema-and-algorithms"></a><span data-ttu-id="8dfee-118">Algoritmos y esquema de perfil del modelo de mapa de gama de WCS</span><span class="sxs-lookup"><span data-stu-id="8dfee-118">WCS Gamut Map Model Profile Schema and Algorithms</span></span>

-   [<span data-ttu-id="8dfee-119">Información general</span><span class="sxs-lookup"><span data-stu-id="8dfee-119">Overview</span></span>](#overview)
-   [<span data-ttu-id="8dfee-120">Arquitectura de Perfil de modelo de mapa de gama</span><span class="sxs-lookup"><span data-stu-id="8dfee-120">Gamut Map Model Profile Architecture</span></span>](#gamut-map-model-profile-architecture)
-   [<span data-ttu-id="8dfee-121">Generación del límite de la gama</span><span class="sxs-lookup"><span data-stu-id="8dfee-121">Generation of the Gamut Boundary</span></span>](#generation-of-the-gamut-boundary)
-   [<span data-ttu-id="8dfee-122">El esquema GMMP</span><span class="sxs-lookup"><span data-stu-id="8dfee-122">The GMMP Schema</span></span>](#the-gmmp-schema)
-   [<span data-ttu-id="8dfee-123">Los elementos de esquema GMMP</span><span class="sxs-lookup"><span data-stu-id="8dfee-123">The GMMP Schema Elements</span></span>](#the-gmmp-schema-elements)
-   [<span data-ttu-id="8dfee-124">GamutMapModel</span><span class="sxs-lookup"><span data-stu-id="8dfee-124">GamutMapModel</span></span>](#defaultbaselinegamutmapmodel-type)
    -   [<span data-ttu-id="8dfee-125">Espacio de nombres</span><span class="sxs-lookup"><span data-stu-id="8dfee-125">Namespace</span></span>](#namespace)
    -   [<span data-ttu-id="8dfee-126">Versión</span><span class="sxs-lookup"><span data-stu-id="8dfee-126">Version</span></span>](#version)
    -   [<span data-ttu-id="8dfee-127">Documentación</span><span class="sxs-lookup"><span data-stu-id="8dfee-127">Documentation</span></span>](#documentation)
    -   [<span data-ttu-id="8dfee-128">Tipo DefaultBaselineGamutMapModel</span><span class="sxs-lookup"><span data-stu-id="8dfee-128">DefaultBaselineGamutMapModel type</span></span>](#defaultbaselinegamutmapmodel-type)
    -   [<span data-ttu-id="8dfee-129">PlugInGamutMapType</span><span class="sxs-lookup"><span data-stu-id="8dfee-129">PlugInGamutMapType</span></span>](#plugingamutmaptype)
    -   [<span data-ttu-id="8dfee-130">ExtensionType</span><span class="sxs-lookup"><span data-stu-id="8dfee-130">ExtensionType</span></span>](#extensiontype)
-   [<span data-ttu-id="8dfee-131">Algoritmos de línea de base de GMMP</span><span class="sxs-lookup"><span data-stu-id="8dfee-131">The GMMP Baseline Algorithms</span></span>](#the-gmmp-baseline-algorithms)
-   [<span data-ttu-id="8dfee-132">Alinear los ejes neutros</span><span class="sxs-lookup"><span data-stu-id="8dfee-132">Aligning the Neutral Axes</span></span>](#aligning-the-neutral-axes)
    -   [<span data-ttu-id="8dfee-133">Diferencia de color mínima (picada)</span><span class="sxs-lookup"><span data-stu-id="8dfee-133">Minimum Color Difference (MinCD)</span></span>](#minimum-color-difference-mincd)
    -   [<span data-ttu-id="8dfee-134">BasicPhoto</span><span class="sxs-lookup"><span data-stu-id="8dfee-134">BasicPhoto</span></span>](#basicphoto)
    -   [<span data-ttu-id="8dfee-135">Información general</span><span class="sxs-lookup"><span data-stu-id="8dfee-135">Overview</span></span>](#overview)
    -   [<span data-ttu-id="8dfee-136">El caso del shell de una sola gama</span><span class="sxs-lookup"><span data-stu-id="8dfee-136">The case of single gamut shell</span></span>](#the-case-of-single-gamut-shell)
    -   [<span data-ttu-id="8dfee-137">Mejora en negro</span><span class="sxs-lookup"><span data-stu-id="8dfee-137">Black enhancement</span></span>](#black-enhancement)
    -   [<span data-ttu-id="8dfee-138">El caso de los shells de doble gama</span><span class="sxs-lookup"><span data-stu-id="8dfee-138">The case of dual gamut shells</span></span>](#the-case-of-dual-gamut-shells)
    -   [<span data-ttu-id="8dfee-139">Motivos de los cambios de las recomendaciones de CIE TC8-03</span><span class="sxs-lookup"><span data-stu-id="8dfee-139">Reasons for changes from the CIE TC8-03 recommendations</span></span>](#reasons-for-changes-from-the-cie-tc8-03-recommendations)
    -   [<span data-ttu-id="8dfee-140">Asignación de matiz</span><span class="sxs-lookup"><span data-stu-id="8dfee-140">Hue mapping</span></span>](#hue-mapping)
-   [<span data-ttu-id="8dfee-141">Descripción de los límites de gama y algoritmos de Shell de gama</span><span class="sxs-lookup"><span data-stu-id="8dfee-141">Gamut Boundary Description and Gamut Shell Algorithms</span></span>](#gamut-boundary-description-and-gamut-shell-algorithms)
    -   [<span data-ttu-id="8dfee-142">Triangulación del límite de la gama</span><span class="sxs-lookup"><span data-stu-id="8dfee-142">Triangulation of the Gamut Boundary</span></span>](#triangulation-of-the-gamut-boundary)
    -   [<span data-ttu-id="8dfee-143">Elementos de línea de límite</span><span class="sxs-lookup"><span data-stu-id="8dfee-143">Boundary Line Elements</span></span>](#boundary-line-elements)
    -   [<span data-ttu-id="8dfee-144">Operación de gama: CheckGamut</span><span class="sxs-lookup"><span data-stu-id="8dfee-144">Gamut Operation: CheckGamut</span></span>](#gamut-operation-checkgamut)
    -   [<span data-ttu-id="8dfee-145">Plano de matiz completo: Intersect</span><span class="sxs-lookup"><span data-stu-id="8dfee-145">Full Hue Plane: Intersect</span></span>](#full-hue-plane-intersect)
    -   [<span data-ttu-id="8dfee-146">Operación de gama: CheckGamut (continuación)</span><span class="sxs-lookup"><span data-stu-id="8dfee-146">Gamut Operation: CheckGamut (continued)</span></span>](#gamut-operation-checkgamut-continued)
    -   [<span data-ttu-id="8dfee-147">Asignación mínima de gama de diferencias de color</span><span class="sxs-lookup"><span data-stu-id="8dfee-147">Minimum Color Difference Gamut Mapping</span></span>](#minimum-color-difference-gamut-mapping)
    -   [<span data-ttu-id="8dfee-148">Suavizado de matiz</span><span class="sxs-lookup"><span data-stu-id="8dfee-148">Hue Smoothing</span></span>](#hue-smoothing)
    -   [<span data-ttu-id="8dfee-149">Configuración de las principales y secundarias en la descripción del límite de la gama</span><span class="sxs-lookup"><span data-stu-id="8dfee-149">Setting Primaries and Secondaries in the Gamut Boundary Description</span></span>](#setting-primaries-and-secondaries-in-the-gamut-boundary-description)
    -   [<span data-ttu-id="8dfee-150">Establecimiento del eje neutro en la descripción del límite de la gama</span><span class="sxs-lookup"><span data-stu-id="8dfee-150">Setting the Neutral Axis in the Gamut Boundary Description</span></span>](#setting-the-neutral-axis-in-the-gamut-boundary-description)
-   [<span data-ttu-id="8dfee-151">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="8dfee-151">Related topics</span></span>](#related-topics)

## <a name="overview"></a><span data-ttu-id="8dfee-152">Información general</span><span class="sxs-lookup"><span data-stu-id="8dfee-152">Overview</span></span>

<span data-ttu-id="8dfee-153">Este esquema se utiliza para especificar el contenido de un perfil de modelo de mapa de gamas (GMMP).</span><span class="sxs-lookup"><span data-stu-id="8dfee-153">This schema is used to specify the content of a gamut map model profile (GMMP).</span></span> <span data-ttu-id="8dfee-154">En el tema siguiente se describen los algoritmos de línea de base asociados.</span><span class="sxs-lookup"><span data-stu-id="8dfee-154">The associated baseline algorithms are described in the following topic.</span></span>

<span data-ttu-id="8dfee-155">El esquema de GMMP básico se compone de información de encabezado común, una referencia opcional a un complemento de modelo de mapa de gamas preferido y etiquetas de extensión.</span><span class="sxs-lookup"><span data-stu-id="8dfee-155">The basic GMMP schema consists of common header information, an optional reference to a preferred Gamut Map Model plug-in, and extension tags.</span></span>

<span data-ttu-id="8dfee-156">Además, GMMP proporciona información explícita sobre el modelo de mapa de la gama de destino y proporciona una directiva sobre el modelo de mapa de la gama de reserva de línea de base para usar si el modelo de destino no está disponible.</span><span class="sxs-lookup"><span data-stu-id="8dfee-156">In addition, the GMMP provides explicit information on the targeted Gamut Map Model, and provides a policy on the baseline fallback Gamut Map Model to use if the targeted model is unavailable.</span></span> <span data-ttu-id="8dfee-157">El esquema puede incluir información de extensión privada, pero no incluye ninguna otra información extraña.</span><span class="sxs-lookup"><span data-stu-id="8dfee-157">The schema can include private extensional information, but will include no other extraneous information.</span></span>

## <a name="gamut-map-model-profile-architecture"></a><span data-ttu-id="8dfee-158">Arquitectura de Perfil de modelo de mapa de gama</span><span class="sxs-lookup"><span data-stu-id="8dfee-158">Gamut Map Model Profile Architecture</span></span>

![Diagrama que muestra el perfil del modelo de mapa de la gama.](images/gmmp-image002.png)

<span data-ttu-id="8dfee-160">El muestreo del espacio de Colorant del dispositivo de salida se realiza repitiendo el Colorants de 0,0 a 1,0 con un paso fraccionario, acumulando todas las combinaciones de cada Colorant en cada paso y, a continuación, convirtiéndolos desde el espacio de Colorant del dispositivo en el espacio de apariencia de color mediante el método DM::D eviceToColorimetricColors seguido del método CAM:: ColorimetricToAppearanceColors.</span><span class="sxs-lookup"><span data-stu-id="8dfee-160">The sampling of the output device colorant space is done by iterating through the colorants from 0.0 to 1.0 with a fractional step, accumulating all combinations of each colorant at each step, and then converting them from device colorant space to color appearance space using the DM::DeviceToColorimetricColors method followed by the CAM::ColorimetricToAppearanceColors method.</span></span> <span data-ttu-id="8dfee-161">A continuación se describe un ejemplo de cómo hacerlo para RGB.</span><span class="sxs-lookup"><span data-stu-id="8dfee-161">The following is an example of how this is done for RGB.</span></span>


```C++
For (red= 0.0; red <= 1.0; red += redStep) {

     For (green = 0.0; green <= 1.0; green += greenStep) {

          For (blue = 0.0; blue <= 1.0; blue += blueStep) {

               Colorants[0] = red; colorants[1] = green; colorants[2] = blue;

               pRGBDM->DeviceToColorimetricColors(1, colorants, &amp;XYZ);

               pCAM->ColorimetricToAppearanceColors(1, &amp;XYZ, &amp;JCh);

          }

     }

}

```



## <a name="generation-of-the-gamut-boundary"></a><span data-ttu-id="8dfee-162">Generación del límite de la gama</span><span class="sxs-lookup"><span data-stu-id="8dfee-162">Generation of the Gamut Boundary</span></span>

<span data-ttu-id="8dfee-163">Hay tres componentes en el límite de la gama: las principales, los ejemplos neutros y los shells.</span><span class="sxs-lookup"><span data-stu-id="8dfee-163">There are three components to the gamut boundary: the primaries, the neutral samples, and the shells.</span></span> <span data-ttu-id="8dfee-164">Los primarios se generan tomando las principales del dispositivo y aplicando la transformación DeviceToColorimetric/ColorimetricToAppearance.</span><span class="sxs-lookup"><span data-stu-id="8dfee-164">The primaries are generated by taking the device primaries and applying the DeviceToColorimetric/ColorimetricToAppearance transformation.</span></span> <span data-ttu-id="8dfee-165">Los ejemplos neutros se generan mediante el muestreo del espacio de Colorant del dispositivo en el área neutra y la aplicación de la misma transformación.</span><span class="sxs-lookup"><span data-stu-id="8dfee-165">The neutral samples are generated by sampling the device colorant space in the neutral area and applying the same transformation.</span></span> <span data-ttu-id="8dfee-166">En el caso de tres dispositivos Colorant (RGB o CMY), los ejemplos neutros se definen como que tienen todo el Colorants igual, por ejemplo, R = = G = = B. Para CMYK, los ejemplos neutros se definen como con C = = M = = Y = = 0.</span><span class="sxs-lookup"><span data-stu-id="8dfee-166">For three colorant devices (RGB or CMY), the neutral samples are defined as having all of the colorants equal, for example, R == G == B. For CMYK, the neutral samples are defined as having C == M == Y == 0.</span></span>

<span data-ttu-id="8dfee-167">Los factores que influyen en los datos usados para crear el límite de la gama son los ejemplos de datos (solo dispositivos de línea de base) y las condiciones de visualización.</span><span class="sxs-lookup"><span data-stu-id="8dfee-167">The factors that influence the data used to create the gamut boundary are the data samples (baseline devices only) and the viewing conditions.</span></span> <span data-ttu-id="8dfee-168">El tamaño del paso que se usa para realizar el muestreo completo del espacio Colorant (para monitores y para el shell de plausible) es una constante interna y no está disponible para manipulación externa.</span><span class="sxs-lookup"><span data-stu-id="8dfee-168">The step size used to do the full sampling of the colorant space (for monitors and for plausible shell) is an internal constant and isn't available for outside manipulation.</span></span> <span data-ttu-id="8dfee-169">Al cambiar las condiciones de visualización, se cambia el comportamiento del modelo de apariencia de color (CAM) y se modifica la forma del límite de la gama, por lo que debe generar un límite de gama vinculado al perfil de condiciones de visualización.</span><span class="sxs-lookup"><span data-stu-id="8dfee-169">Changing the viewing conditions changes the behavior of the color appearance model (CAM) and alters the shape of the gamut boundary, so you must generate a gamut boundary tied to the viewing conditions profile.</span></span> <span data-ttu-id="8dfee-170">Si se usan datos de ejemplo, como en el caso de las impresoras de línea de base y los dispositivos de captura, los ejemplos tendrán muchos efectos en la forma de la gama de referencia y afectarán al comportamiento del propio modelo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-170">If sample data is used, as in the case of baseline printers and capture devices, then the samples will have a lot of impact on the shape of the reference gamut and affect the behavior of the model itself.</span></span>

<span data-ttu-id="8dfee-171">En el caso de los dispositivos de entrada, como cámaras y escáneres, se usan diferentes muestras para generar el shell de referencia y el shell de plausible.</span><span class="sxs-lookup"><span data-stu-id="8dfee-171">For input devices, such as cameras and scanners, different samplings are used to generate the reference shell and the plausible shell.</span></span> <span data-ttu-id="8dfee-172">El shell de referencia se genera a partir de las medidas usadas para inicializar el modelo de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-172">The reference shell is generated from the measurements used to initialize the device model.</span></span> <span data-ttu-id="8dfee-173">El shell de plausible se genera de forma similar a la ilustración anterior de los dispositivos de salida.</span><span class="sxs-lookup"><span data-stu-id="8dfee-173">The plausible shell is generated similar to the prior illustration for output devices.</span></span> <span data-ttu-id="8dfee-174">La diferencia es que cuando se introduce un destino típico, no se obtienen valores totalmente saturados (donde R, G o B = 255).</span><span class="sxs-lookup"><span data-stu-id="8dfee-174">The difference it that when you input a typical target, you don't get fully saturated values (where R, G, or B = 255).</span></span> <span data-ttu-id="8dfee-175">Debe extrapolar el uso del modelo de dispositivo para calcular esos valores.</span><span class="sxs-lookup"><span data-stu-id="8dfee-175">You must extrapolate using the device model to estimate those values.</span></span>

## <a name="the-gmmp-schema"></a><span data-ttu-id="8dfee-176">El esquema GMMP</span><span class="sxs-lookup"><span data-stu-id="8dfee-176">The GMMP Schema</span></span>


```C++
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema 
  xmlns:gmm="http://schemas.microsoft.com/windows/2005/02/color/GamutMapModel"
  xmlns:wcs="http://schemas.microsoft.com/windows/2005/02/color/WcsCommonProfileTypes"
  targetNamespace="http://schemas.microsoft.com/windows/2005/02/color/GamutMapModel"
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  elementFormDefault="qualified"
  attributeFormDefault="unqualified"
  blockDefault="#all"
  version="1.0">

  <xs:annotation>
    <xs:documentation>
      Gamut Map Model profile schema.
      Copyright (C) Microsoft. All rights reserved.
    </xs:documentation>
  </xs:annotation>

  <xs:import namespace="http://schemas.microsoft.com/windows/2005/02/color/WcsCommonProfileTypes" />

  <xs:element name="GamutMapModel">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="ProfileName" type="wcs:MultiLocalizedTextType"/>
        <xs:element name="Description" type="wcs:MultiLocalizedTextType" minOccurs="0"/>
        <xs:element name="Author" type="wcs:MultiLocalizedTextType" minOccurs="0"/>
        <xs:element name="DefaultBaselineGamutMapModel">
          <xs:simpleType>
            <xs:restriction base="xs:string">
              <xs:enumeration value="HPMinCD_Absolute"/>
              <xs:enumeration value="HPMinCD_Relative"/>
              <xs:enumeration value="SGCK"/>
              <xs:enumeration value="HueMap"/>
            </xs:restriction>
          </xs:simpleType>
        </xs:element>
        <xs:element name="PlugInGamutMapModel" minOccurs="0">
          <xs:complexType>
            <xs:sequence>
              <xs:any namespace="##other" processContents="skip"
                minOccurs="0" maxOccurs="unbounded" />
            </xs:sequence>
            <xs:attribute name="GUID" type="wcs:GUIDType" use="required"/>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
      <xs:attribute name="ID" type="xs:string" use="optional" />
    </xs:complexType>
  </xs:element>
</xs:schema>
```



## <a name="the-gmmp-schema-elements"></a><span data-ttu-id="8dfee-177">Los elementos de esquema GMMP</span><span class="sxs-lookup"><span data-stu-id="8dfee-177">The GMMP Schema Elements</span></span>

## <a name="gamutmapmodel"></a><span data-ttu-id="8dfee-178">GamutMapModel</span><span class="sxs-lookup"><span data-stu-id="8dfee-178">GamutMapModel</span></span>

<span data-ttu-id="8dfee-179">Este elemento es una secuencia de los siguientes subelementos:</span><span class="sxs-lookup"><span data-stu-id="8dfee-179">This element is a sequence of the following sub-elements:</span></span>

1.  <span data-ttu-id="8dfee-180">Cadena de perfilename,</span><span class="sxs-lookup"><span data-stu-id="8dfee-180">ProfileName string,</span></span>
2.  <span data-ttu-id="8dfee-181">DefaultBaselineGamutMapModel,</span><span class="sxs-lookup"><span data-stu-id="8dfee-181">DefaultBaselineGamutMapModel,</span></span>
3.  <span data-ttu-id="8dfee-182">Cadena de descripción opcional,</span><span class="sxs-lookup"><span data-stu-id="8dfee-182">Optional Description string,</span></span>
4.  <span data-ttu-id="8dfee-183">Cadena de autor opcional,</span><span class="sxs-lookup"><span data-stu-id="8dfee-183">Optional Author string,</span></span>
5.  <span data-ttu-id="8dfee-184">PlugInGamutMap opcionales y</span><span class="sxs-lookup"><span data-stu-id="8dfee-184">Optional PlugInGamutMap, and</span></span>
6.  <span data-ttu-id="8dfee-185">ExtensionType opcional.</span><span class="sxs-lookup"><span data-stu-id="8dfee-185">Optional ExtensionType.</span></span>

<span data-ttu-id="8dfee-186">**Condiciones de validación** : cada subelemento se valida por su propio tipo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-186">**Validation conditions** : Each sub-element is validated by its own type.</span></span>

### <a name="namespace"></a><span data-ttu-id="8dfee-187">Espacio de nombres</span><span class="sxs-lookup"><span data-stu-id="8dfee-187">Namespace</span></span>

<span data-ttu-id="8dfee-188">xmlns: GMM = " http://schemas.microsoft.com/windows/2005/02/color/GamutMapModel "</span><span class="sxs-lookup"><span data-stu-id="8dfee-188">xmlns:gmm="http://schemas.microsoft.com/windows/2005/02/color/GamutMapModel"</span></span>

<span data-ttu-id="8dfee-189">targetNamespace = " http://schemas.microsoft.com/windows/2005/02/color/GamutMapModel "</span><span class="sxs-lookup"><span data-stu-id="8dfee-189">targetNamespace="http://schemas.microsoft.com/windows/2005/02/color/GamutMapModel"</span></span>

### <a name="version"></a><span data-ttu-id="8dfee-190">Versión</span><span class="sxs-lookup"><span data-stu-id="8dfee-190">Version</span></span>

<span data-ttu-id="8dfee-191">Versión "1,0" con la primera versión de Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="8dfee-191">Version "1.0" with the first release of Windows Vista.</span></span>

<span data-ttu-id="8dfee-192">**Condiciones de validación** : 1,0 en Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="8dfee-192">**Validation conditions** : 1.0 in Windows Vista.</span></span> <span data-ttu-id="8dfee-193">Las versiones &lt; 2,0 también son válidas para admitir cambios no importantes en el formato.</span><span class="sxs-lookup"><span data-stu-id="8dfee-193">Versions &lt;2.0 are also valid in order to support non-breaking changes to the format.</span></span>

### <a name="documentation"></a><span data-ttu-id="8dfee-194">Documentación</span><span class="sxs-lookup"><span data-stu-id="8dfee-194">Documentation</span></span>

<span data-ttu-id="8dfee-195">Esquema de Perfil de modelo de mapa de gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-195">Gamut Map Model Profile schema.</span></span>

<span data-ttu-id="8dfee-196">Copyright (C) Microsoft.</span><span class="sxs-lookup"><span data-stu-id="8dfee-196">Copyright (C) Microsoft.</span></span> <span data-ttu-id="8dfee-197">Todos los derechos reservados.</span><span class="sxs-lookup"><span data-stu-id="8dfee-197">All rights reserved.</span></span>

<span data-ttu-id="8dfee-198">**Condiciones de validación** : cada subelemento se valida por su propio tipo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-198">**Validation conditions** : Each sub-element is validated by its own type.</span></span>

### <a name="defaultbaselinegamutmapmodel-type"></a><span data-ttu-id="8dfee-199">Tipo DefaultBaselineGamutMapModel</span><span class="sxs-lookup"><span data-stu-id="8dfee-199">DefaultBaselineGamutMapModel type</span></span>

<span data-ttu-id="8dfee-200">Tipo UINT</span><span class="sxs-lookup"><span data-stu-id="8dfee-200">UINT type</span></span>

<span data-ttu-id="8dfee-201">Valores de enumeración:</span><span class="sxs-lookup"><span data-stu-id="8dfee-201">Enumeration values:</span></span>

<dl> <span data-ttu-id="8dfee-202">"Absoluta picada \_ "</span><span class="sxs-lookup"><span data-stu-id="8dfee-202">"MinCD\_Absolute"</span></span>  
<span data-ttu-id="8dfee-203">"Relativo picada \_ "</span><span class="sxs-lookup"><span data-stu-id="8dfee-203">"MinCD\_Relative"</span></span>  
<span data-ttu-id="8dfee-204">"SIG \_ Knee"</span><span class="sxs-lookup"><span data-stu-id="8dfee-204">"SIG\_KNEE"</span></span>  
<span data-ttu-id="8dfee-205">"HueMap"</span><span class="sxs-lookup"><span data-stu-id="8dfee-205">"HueMap"</span></span>  
</dl>

<span data-ttu-id="8dfee-206">**Condiciones de validación** : los valores deben coincidir con una de las enumeraciones anteriores.</span><span class="sxs-lookup"><span data-stu-id="8dfee-206">**Validation conditions** : The values must match one of the enumerations above.</span></span>

### <a name="plugingamutmaptype"></a><span data-ttu-id="8dfee-207">PlugInGamutMapType</span><span class="sxs-lookup"><span data-stu-id="8dfee-207">PlugInGamutMapType</span></span>

<span data-ttu-id="8dfee-208">Este elemento es una secuencia de un GUIDType de GUID y cualquier subelemento.</span><span class="sxs-lookup"><span data-stu-id="8dfee-208">This element is a sequence of a GUID GUIDType and any sub-elements.</span></span>

<span data-ttu-id="8dfee-209">**Condiciones de validación** : el GUID se usa para hacer coincidir el GUID de la dll del complemento de GMM.</span><span class="sxs-lookup"><span data-stu-id="8dfee-209">**Validation conditions** : The GUID is used to match the GMM PlugIn DLL GUID.</span></span> <span data-ttu-id="8dfee-210">Hay un máximo de 100.000 subelementos personalizados.</span><span class="sxs-lookup"><span data-stu-id="8dfee-210">There are a maximum of 100,000 custom sub-elements.</span></span>

### <a name="extensiontype"></a><span data-ttu-id="8dfee-211">ExtensionType</span><span class="sxs-lookup"><span data-stu-id="8dfee-211">ExtensionType</span></span>

<span data-ttu-id="8dfee-212">Este elemento es una secuencia opcional de cualquier subelemento.</span><span class="sxs-lookup"><span data-stu-id="8dfee-212">This element is a optional sequence of any sub-elements.</span></span>

<span data-ttu-id="8dfee-213">**Condiciones de validación** : puede haber un máximo de 100.000 subelementos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-213">**Validation conditions** : There can be a maximum of 100,000 sub-elements.</span></span>

## <a name="the-gmmp-baseline-algorithms"></a><span data-ttu-id="8dfee-214">Algoritmos de línea de base de GMMP</span><span class="sxs-lookup"><span data-stu-id="8dfee-214">The GMMP Baseline Algorithms</span></span>

## <a name="aligning-the-neutral-axes"></a><span data-ttu-id="8dfee-215">Alinear los ejes neutros</span><span class="sxs-lookup"><span data-stu-id="8dfee-215">Aligning the Neutral Axes</span></span>

<span data-ttu-id="8dfee-216">La mayoría de los algoritmos de asignación de gamas tienen el objetivo de asignar el eje neutro del dispositivo de origen al eje neutro del dispositivo de destino: es decir, el blanco va a blanco, de negro a negro y de gris a gris.</span><span class="sxs-lookup"><span data-stu-id="8dfee-216">Most gamut mapping algorithms have a goal of mapping the neutral axis of the source device to the neutral axis of the destination device: that is, white goes to white, black to black, and gray to gray.</span></span> <span data-ttu-id="8dfee-217">Esto se soluciona en parte mediante el escalado de la luminosidad de los colores de origen para que coincida con el intervalo de luminosidad del dispositivo de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-217">This is addressed in part by scaling the lightness of source colors to match the lightness range of the destination device.</span></span> <span data-ttu-id="8dfee-218">Pero eso no soluciona completamente el problema.</span><span class="sxs-lookup"><span data-stu-id="8dfee-218">But that does not completely address the problem.</span></span>

<span data-ttu-id="8dfee-219">Es una propiedad física de la mayoría de los dispositivos de imágenes que la cromaticidad del blanco del dispositivo no coincide exactamente con la cromaticidad del dispositivo negro.</span><span class="sxs-lookup"><span data-stu-id="8dfee-219">It is a physical property of most imaging devices that the chromaticity of the device white does not exactly match the chromaticity of the device black.</span></span> <span data-ttu-id="8dfee-220">Por ejemplo, el monitor blanco depende de la suma de las cromaticidad y la luminances relativa de los tres primarios, mientras que el monitor negro depende de la reflectancia de la superficie de la pantalla.</span><span class="sxs-lookup"><span data-stu-id="8dfee-220">For example, monitor white depends on the sum of the chromaticities and relative luminances of the three primaries, while monitor black depends on the reflectance of the display surface.</span></span> <span data-ttu-id="8dfee-221">La impresora blanca depende de la cromaticidad del papel, mientras que la impresora de color negro depende de la tinta o del tóner utilizado.</span><span class="sxs-lookup"><span data-stu-id="8dfee-221">Printer white depends on the chromaticity of the paper, while printer black depends on the ink or toner used.</span></span> <span data-ttu-id="8dfee-222">Un modelo de apariencia que asigna el dispositivo blanco exactamente al eje neutro del espacio de apariencia (croma exactamente igual a cero) no asignará el negro del dispositivo al eje neutro.</span><span class="sxs-lookup"><span data-stu-id="8dfee-222">An appearance model that maps device white exactly to the neutral axis of the appearance space (chroma exactly equal to zero) will not map device black to the neutral axis.</span></span> <span data-ttu-id="8dfee-223">Dado que el ojo es más sensible a las diferencias cromas, ya que los aumentos de luminosidad, los grises medios se representarán como más cromáticos que el dispositivo negro.</span><span class="sxs-lookup"><span data-stu-id="8dfee-223">Because the eye is more sensitive to chroma differences as lightness increases, mid-grays will be represented as even more chromatic than device black.</span></span> <span data-ttu-id="8dfee-224">(La figura 1 muestra la curvatura de los ejes neutros en dos dimensiones.</span><span class="sxs-lookup"><span data-stu-id="8dfee-224">(Figure 1 illustrates the curvature of the neutral axes in two dimensions.</span></span> <span data-ttu-id="8dfee-225">De hecho, los ejes neutros forman una curva más compleja en tres dimensiones).</span><span class="sxs-lookup"><span data-stu-id="8dfee-225">In fact, the neutral axes form a more complex curve in three dimensions.)</span></span>

<span data-ttu-id="8dfee-226">Aunque el CAM predice que estos colores neutros del dispositivo aparecerán en color cromático, los observadores reales parecen compensar esto.</span><span class="sxs-lookup"><span data-stu-id="8dfee-226">While the CAM predicts that these device neutral colors will appear chromatic, actual observers seem to compensate for this.</span></span> <span data-ttu-id="8dfee-227">La mayoría de los usuarios no tienen en cuenta que estos valores neutros de dispositivo son cromáticos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-227">Most people do not consider these device neutral values to be chromatic.</span></span> <span data-ttu-id="8dfee-228">En el caso de la mayoría de los modelos de asignación, por lo tanto, debe seguir asignando neutros de origen a neutros de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-228">For most gamut mapping models, therefore, you should continue to map source neutrals to device neutrals.</span></span>

<span data-ttu-id="8dfee-229">Para asignar neutros de origen a neutros de dispositivo, ajuste los límites de la gama de origen y de destino, y cada píxel al aplicar el algoritmo de asignación de gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-229">To map source neutrals to device neutrals, adjust the source and destination gamut boundaries and each pixel when you apply the gamut mapping algorithm.</span></span> <span data-ttu-id="8dfee-230">En primer lugar, ajuste cada valor en el color de origen para que el eje neutro del dispositivo de origen en la luminosidad del color de origen caiga directamente en el eje neutro del espacio de apariencia.</span><span class="sxs-lookup"><span data-stu-id="8dfee-230">First adjust each value in the source color so that the source device's neutral axis at the source color's lightness falls directly on the neutral axis of the appearance space.</span></span> <span data-ttu-id="8dfee-231">(Vea el lado izquierdo de la figura 1). A continuación, ajuste la descripción del límite de la gama del dispositivo de destino para que cada color del eje neutro del dispositivo de destino en el límite del color del límite de la gama del dispositivo de destino caiga directamente en el eje neutro del espacio de apariencia.</span><span class="sxs-lookup"><span data-stu-id="8dfee-231">(See the left side of Figure 1.) Then adjust the destination device's gamut boundary description so that each color on the destination device's neutral axis at the destination device gamut boundary color's lightness falls directly on the neutral axis of the appearance space.</span></span> <span data-ttu-id="8dfee-232">(Consulte el lado derecho de la figura 1).</span><span class="sxs-lookup"><span data-stu-id="8dfee-232">(See the right side of Figure 1.)</span></span>

![Diagrama que muestra el gráfico de límite de la gama de origen a la izquierda y el límite de la gama de destino a la derecha.](images/gmmp-image004.png)

<span data-ttu-id="8dfee-234">**Figura 1** : alineación de los ejes neutros mostrados.</span><span class="sxs-lookup"><span data-stu-id="8dfee-234">**Figure 1** : Alignment of the neutral axes illustrated.</span></span> <span data-ttu-id="8dfee-235">Izquierda: ajuste de los puntos de origen en relación con el eje neutro del dispositivo de origen.</span><span class="sxs-lookup"><span data-stu-id="8dfee-235">Left: Adjusting source points relative to the source device neutral axis.</span></span> <span data-ttu-id="8dfee-236">Right: ajuste de la descripción del límite de la gama de destino en relación con la descripción del límite de la gama de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-236">Right: Adjusting the destination gamut boundary description relative to the destination gamut boundary description.</span></span>

<span data-ttu-id="8dfee-237">Tenga en cuenta que ajusta cada valor de píxel de origen en relación con el eje neutro en ese valor de luminosidad.</span><span class="sxs-lookup"><span data-stu-id="8dfee-237">Note that you adjust each source pixel value relative to the neutral axis at that lightness value.</span></span> <span data-ttu-id="8dfee-238">Esto garantiza que los neutros del dispositivo de origen se encuentran en el eje neutro del modelo de apariencia.</span><span class="sxs-lookup"><span data-stu-id="8dfee-238">This assures that source device neutrals will fall on the neutral axis of the appearance model.</span></span> <span data-ttu-id="8dfee-239">También puede desplazar todos los demás colores en esa luminosidad en la misma cantidad, de modo que no haya ninguna discontinuidad en la representación de la gama de origen.</span><span class="sxs-lookup"><span data-stu-id="8dfee-239">You also shift all other colors at that lightness by the same amount, so that there are no discontinuities in the representation of the source gamut.</span></span> <span data-ttu-id="8dfee-240">Tiene que desplazarse por diferentes cantidades en diferentes niveles de luminosidad, ya que los neutros del dispositivo de origen no se representan de igual forma a los distintos niveles de luminosidad.</span><span class="sxs-lookup"><span data-stu-id="8dfee-240">You have to shift by different amounts at different lightness levels, because the source device neutrals are not represented as equally chromatic at the different lightness levels.</span></span> <span data-ttu-id="8dfee-241">Claramente, esto no es una transformación trivial.</span><span class="sxs-lookup"><span data-stu-id="8dfee-241">Clearly, this is not a trivial transformation.</span></span>

<span data-ttu-id="8dfee-242">Controlar los valores del dispositivo de destino es un poco más complicado.</span><span class="sxs-lookup"><span data-stu-id="8dfee-242">Handling the destination device values is a little more tricky.</span></span> <span data-ttu-id="8dfee-243">Inicialmente, se ajusta el límite completo de la gama de destino de manera similar, pero con respecto al eje neutro del dispositivo de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-243">Initially, you adjust the entire destination gamut boundary in a similar manner, but relative to the destination device neutral axis.</span></span> <span data-ttu-id="8dfee-244">Esto se muestra en la figura 1 del lado derecho.</span><span class="sxs-lookup"><span data-stu-id="8dfee-244">This is illustrated in Figure 1 on the right side.</span></span> <span data-ttu-id="8dfee-245">Ese ajuste garantiza que los valores de gris de origen se asignarán a los valores de gris de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-245">That adjustment assures that source gray values will map to destination gray values.</span></span> <span data-ttu-id="8dfee-246">Este es el espacio en el que operan los algoritmos de asignación de gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-246">This is the space in which the gamut mapping algorithms operate.</span></span>

<span data-ttu-id="8dfee-247">Sin embargo, este espacio no describe con precisión el comportamiento real del dispositivo de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-247">However, this space does not accurately describe the true behavior of the destination device.</span></span> <span data-ttu-id="8dfee-248">Debe invertir la asignación antes de que se entreguen los colores asignados a la gama en el modelo de apariencia y el modelo de dispositivo de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-248">You must invert the mapping before gamut mapped colors are handed to the appearance model and destination device model.</span></span> <span data-ttu-id="8dfee-249">Desplazará todos los valores asignados por el contrario del desplazamiento aplicado anteriormente al eje neutro del dispositivo de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-249">You offset all the mapped values by the opposite of the offset applied earlier to the destination device neutral axis.</span></span> <span data-ttu-id="8dfee-250">Esto asigna el eje neutro de destino de nuevo al valor representado originalmente por el CAM.</span><span class="sxs-lookup"><span data-stu-id="8dfee-250">This maps the destination neutral axis back to the value represented originally by the CAM.</span></span> <span data-ttu-id="8dfee-251">Hace lo mismo para el límite de la gama y para todos los valores intermedios.</span><span class="sxs-lookup"><span data-stu-id="8dfee-251">It does the same for the gamut boundary and all intermediate values.</span></span>

![Diagrama que muestra un gráfico para deshacer la alineación del eje neutro del dispositivo de destino.](images/gmmp-image008.png)

<span data-ttu-id="8dfee-253">**Figura 2** : deshacer la alineación del eje neutro del dispositivo de destino</span><span class="sxs-lookup"><span data-stu-id="8dfee-253">**Figure 2** : Undoing the alignment of the destination device neutral axis</span></span>

### <a name="minimum-color-difference-mincd"></a><span data-ttu-id="8dfee-254">Diferencia de color mínima (picada)</span><span class="sxs-lookup"><span data-stu-id="8dfee-254">Minimum Color Difference (MinCD)</span></span>

<span data-ttu-id="8dfee-255">Versión relativa y absoluta de diferencia de color (picada) equivalente a la intención colorimétrica de ICC.</span><span class="sxs-lookup"><span data-stu-id="8dfee-255">Minimum Color Difference(MinCD) Relative and Absolute versions - equivalent to the ICC colorimetric intent.</span></span>

> [!Note]  
> <span data-ttu-id="8dfee-256">La GMM picada es adecuada para la asignación de gráficos y líneas gráficas que contienen colores de "logotipo" (tintas puntuales), degradados de color de logotipo con algunos colores fuera de gama y la fase final de transformaciones de prueba.</span><span class="sxs-lookup"><span data-stu-id="8dfee-256">The MinCD GMM is suitable for mapping graphics and line art containing "logo" colors (spot colors), logo color gradients with some out-of-gamut colors, and for the final stage of proofing transforms.</span></span> <span data-ttu-id="8dfee-257">Aunque el GMM picado podría usarse para imágenes fotográficas que están completamente dentro de la gama de destino, no se recomienda para la representación general de imágenes fotográficas.</span><span class="sxs-lookup"><span data-stu-id="8dfee-257">While the MinCD GMM could be used for photographic images that are entirely within the destination gamut, it is not recommended for general rendering of photographic images.</span></span> <span data-ttu-id="8dfee-258">La asignación de colores fuera de la gama a los colores en la superficie de la gama de destino puede dar lugar a artefactos no deseados, como irregularidades de tono o croma en degradados suaves que cruzan el límite de la gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-258">The mapping of out-of-gamut colors to colors on the destination gamut surface can result in unwanted artifacts, such as tone or chroma irregularities in smooth gradients that cross the gamut boundary.</span></span> <span data-ttu-id="8dfee-259">Se recomienda BasicPhoto para las imágenes fotográficas.</span><span class="sxs-lookup"><span data-stu-id="8dfee-259">BasicPhoto is recommended for photographic images.</span></span> <span data-ttu-id="8dfee-260">Si una imagen fotográfica o de contonalidad requiere una asignación de gama distinta de BasicPhoto, la alternativa debe ser crear un complemento GMM que implemente esa asignación, en lugar de utilizar picado.</span><span class="sxs-lookup"><span data-stu-id="8dfee-260">If a photographic or contone image requires a gamut mapping other than BasicPhoto, then the alternative should be to create a plug-in GMM implementing that mapping, instead of using MinCD.</span></span>

 

<span data-ttu-id="8dfee-261">Los colores en la gama permanecen inalterados.</span><span class="sxs-lookup"><span data-stu-id="8dfee-261">In-gamut colors are left unchanged.</span></span> <span data-ttu-id="8dfee-262">En el caso de los colores fuera de gama, la luminosidad y el croma se ajustan buscando el punto de la gama de destino que tiene la distancia de color mínima de los puntos de entrada fuera de la gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-262">For out-of-gamut colors, lightness and chroma are adjusted by finding the point in the destination gamut that has the minimum color distance from out-of-gamut input points.</span></span> <span data-ttu-id="8dfee-263">La distancia del color se calcula en el espacio de JCh.</span><span class="sxs-lookup"><span data-stu-id="8dfee-263">The color distance is computed in JCh space.</span></span> <span data-ttu-id="8dfee-264">Sin embargo, se pondera la distancia en luminosidad (J) y la distancia en croma (C) o matiz (h) de manera diferente.</span><span class="sxs-lookup"><span data-stu-id="8dfee-264">However, you weight the distance in lightness (J) and the distance in chroma (C) or hue (h) differently.</span></span> <span data-ttu-id="8dfee-265">Una función de peso dependiente de croma se usa para la distancia en luminosidad, de modo que el peso sea menor para el grosor de croma pequeño y mayor para la intensidad de croma grande hasta que se alcance el cromado del umbral, después del cual el peso se mantiene en 1, es decir, el mismo peso como distancia en croma o matiz.</span><span class="sxs-lookup"><span data-stu-id="8dfee-265">A chroma-dependent weight function is used for the distance in lightness so that the weight is smaller for small chroma and larger for large chroma until a threshold chroma is reached, after which the weight stays at 1, that is, the same weight as distance in chroma or hue.</span></span> <span data-ttu-id="8dfee-266">Esto sigue el uso recomendado de CMC y CIEDE2000.</span><span class="sxs-lookup"><span data-stu-id="8dfee-266">This follows recommended usage for CMC and CIEDE2000.</span></span> <span data-ttu-id="8dfee-267">Hay dos variantes: colorimétrica relativa y colorimétrica absoluta.</span><span class="sxs-lookup"><span data-stu-id="8dfee-267">There are two variants: Relative colorimetric and absolute colorimetric.</span></span>

<span data-ttu-id="8dfee-268">**Colorimétrico relativo:** En primer lugar, alinee los ejes neutros de origen y destino tal y como se describió anteriormente.</span><span class="sxs-lookup"><span data-stu-id="8dfee-268">**Relative colorimetric:** First, align the source and destination neutral axes as described previously.</span></span> <span data-ttu-id="8dfee-269">A continuación, recorte el color de origen ajustado al límite de la gama de destino ajustada.</span><span class="sxs-lookup"><span data-stu-id="8dfee-269">Then clip the adjusted source color to the adjusted destination gamut boundary.</span></span> <span data-ttu-id="8dfee-270">(Consulte la figura 4.</span><span class="sxs-lookup"><span data-stu-id="8dfee-270">(See Figure 4.</span></span> <span data-ttu-id="8dfee-271">Asignación de cromas a lo largo de la luminosidad constante). Reajuste los valores del dispositivo de destino tal y como se describió anteriormente.</span><span class="sxs-lookup"><span data-stu-id="8dfee-271">Chroma mapping along constant lightness.) Readjust the destination device values as described previously.</span></span> <span data-ttu-id="8dfee-272">En el caso de un límite de gama de destino monocromo, el recorte de croma significa que el valor de croma (C) se establece en cero (0,0).</span><span class="sxs-lookup"><span data-stu-id="8dfee-272">In the case of a monochrome destination gamut boundary, the chroma clipping means that the chroma value (C) is set to zero (0.0).</span></span>

<span data-ttu-id="8dfee-273">**Colorimétrico absoluto:** Esto es similar a la colorimétrico relativa, pero sin la alineación del eje neutro de origen y de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-273">**Absolute colorimetric:** This is similar to relative colorimetric, but without the alignment of the source and destination neutral axis.</span></span> <span data-ttu-id="8dfee-274">El valor de origen se recorta directamente en el eje neutro de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-274">The source value is clipped directly to the destination neutral axis.</span></span> <span data-ttu-id="8dfee-275">Tenga en cuenta que si los límites de la gama de origen y de destino son monocromáticos, el comportamiento es idéntico al de la variante colorimétrica relativa; es decir, se realiza la alineación de los ejes neutros y, a continuación, el croma se recorta a cero.</span><span class="sxs-lookup"><span data-stu-id="8dfee-275">Note that if both the source and destination gamut boundaries are monochrome, the behavior is identical to the relative colorimetric variant; that is, the neutral axes alignment is performed, and then the chroma is clipped to zero.</span></span> <span data-ttu-id="8dfee-276">Esto garantiza que se alcanza una salida razonable incluso si los medios y Colorants son significativamente diferentes.</span><span class="sxs-lookup"><span data-stu-id="8dfee-276">This ensures that a reasonable output is attained even if the media and colorants are significantly different.</span></span>

![Diagrama que muestra un gráfico para el recorte picado en la gama ajustada.](images/gmmp-image010.png)

<span data-ttu-id="8dfee-278">**Figura 3** : recorte picado en la gama ajustada</span><span class="sxs-lookup"><span data-stu-id="8dfee-278">**Figure 3** : MinCD clipping to the adjusted gamut</span></span>

### <a name="basicphoto"></a><span data-ttu-id="8dfee-279">BasicPhoto</span><span class="sxs-lookup"><span data-stu-id="8dfee-279">BasicPhoto</span></span>

### <a name="overview"></a><span data-ttu-id="8dfee-280">Información general</span><span class="sxs-lookup"><span data-stu-id="8dfee-280">Overview</span></span>

<span data-ttu-id="8dfee-281">BasicPhoto: equivalente al objetivo de ICC preferido, de gráficos o perceptual.</span><span class="sxs-lookup"><span data-stu-id="8dfee-281">BasicPhoto - equivalent to the ICC preferred, pictorial, or perceptual intent.</span></span>

<span data-ttu-id="8dfee-282">Este algoritmo es una variante de la asignación de luminosidad de sigmoidal dependiente de croma y el escalado de Knee de cúspide (SGCK) descrito por CIE TC8-03 en CIE156:2004.</span><span class="sxs-lookup"><span data-stu-id="8dfee-282">This algorithm is a variant of the chroma-dependent sigmoidal lightness mapping and cusp knee scaling (SGCK) described by CIE TC8-03 in CIE156:2004.</span></span> <span data-ttu-id="8dfee-283">Este algoritmo variante admite descriptores de límite de gama (GBDs) con shells de doble gama; es decir, GBDs con un shell de referencia y un shell de plausible.</span><span class="sxs-lookup"><span data-stu-id="8dfee-283">This variant algorithm supports gamut boundary descriptors (GBDs) with dual gamut shells; that is, GBDs with a reference shell and a plausible shell.</span></span> <span data-ttu-id="8dfee-284">El algoritmo SGCK, que inicialmente supone que solo hay un shell de gama en el GBD, se basa en el algoritmo de Knee de SIG \_ (Braun 1999), que incorpora la asignación de luminosidad sigmoidal y el escalado de funciones de Knee propuestos por Braun y Fairchild (1999), combinados con la dependencia de croma de GCUSP (Morovic, 1998).</span><span class="sxs-lookup"><span data-stu-id="8dfee-284">The SGCK algorithm, which originally assumes only one gamut shell in the GBD, is based on the SIG\_KNEE algorithm (Braun 1999), that incorporates the sigmoidal lightness mapping and knee function scaling proposed by Braun and Fairchild (1999), combined with the chroma dependence from GCUSP (Morovic, 1998).</span></span> <span data-ttu-id="8dfee-285">Mantiene una constante de matiz percibida, por ejemplo, el ángulo de matiz en jabs corregidos por matiz, y usa una escala de luminosidad de sigmoidal genérica (independiente de la imagen) que se aplica de forma dependiente de croma y una función de Knee del 90 por ciento.</span><span class="sxs-lookup"><span data-stu-id="8dfee-285">It keeps perceived hue constant, for example, hue angle in hue-corrected Jab, and uses a generic (image-independent) sigmoidal lightness scaling which is applied in a chroma-dependent way and a 90 percent knee function chroma.</span></span> <span data-ttu-id="8dfee-286">La variante escala a lo largo de las líneas de luminosidad constante.</span><span class="sxs-lookup"><span data-stu-id="8dfee-286">The variant scales along lines of constant lightness.</span></span>

### <a name="the-case-of-single-gamut-shell"></a><span data-ttu-id="8dfee-287">El caso del shell de una sola gama</span><span class="sxs-lookup"><span data-stu-id="8dfee-287">The case of single gamut shell</span></span>

<span data-ttu-id="8dfee-288">Resulta útil revisar el algoritmo en caso de que los GBDs de origen y destino tengan solo un shell de gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-288">It is helpful to review the algorithm in the case where both source and destination GBDs have only one gamut shell.</span></span> <span data-ttu-id="8dfee-289">En este caso, el algoritmo consta de los siguientes cálculos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-289">In this case, the algorithm consists of the following calculations.</span></span>

<span data-ttu-id="8dfee-290">En primer lugar, realice la asignación de luminosidad inicial mediante la siguiente fórmula:</span><span class="sxs-lookup"><span data-stu-id="8dfee-290">First, perform initial lightness mapping using the following formula:</span></span>

![Muestra la fórmula para la asignación de luminosidad inicial.](images/gmmp-image012.png) <span data-ttu-id="8dfee-292">(1)</span><span class="sxs-lookup"><span data-stu-id="8dfee-292">(1)</span></span>

<span data-ttu-id="8dfee-293">donde *j ₒ* es la luminosidad original y *J <sub>R</sub>* es la luminosidad de la reproducción.</span><span class="sxs-lookup"><span data-stu-id="8dfee-293">where *Jₒ* is the original lightness and *J<sub>R</sub>* is the reproduction lightness.</span></span>

![Muestra la segunda fórmula de asignación de luminosidad.](images/gmmp-image014.png) <span data-ttu-id="8dfee-295">(2)</span><span class="sxs-lookup"><span data-stu-id="8dfee-295">(2)</span></span>

<span data-ttu-id="8dfee-296">Cuando el límite de la gama de origen es monocromo, el valor de croma será cero para el límite monocromo debido a la alineación del eje neutro.</span><span class="sxs-lookup"><span data-stu-id="8dfee-296">When the source gamut boundary is monochrome, the chroma value will be zero for the monochrome boundary due to neutral axis alignment.</span></span> <span data-ttu-id="8dfee-297">Esto producirá el caso degenerado, donde C es igual a cero.</span><span class="sxs-lookup"><span data-stu-id="8dfee-297">This will result in the degenerate case where C is equal to zero.</span></span> <span data-ttu-id="8dfee-298">En este caso, *p <sub>C</sub>* se establece en 1.</span><span class="sxs-lookup"><span data-stu-id="8dfee-298">In this case, *p<sub>C</sub>* is set to 1.</span></span>

<span data-ttu-id="8dfee-299">*p <sub>C</sub>* es un factor de ponderación dependiente de croma (Morovic, 1998) que depende de la intensidad del color original, mientras que C y *J <sub>S</sub>* son el resultado de la luminosidad original que se está asignando mediante una función sigmoidal.</span><span class="sxs-lookup"><span data-stu-id="8dfee-299">*p <sub>C</sub>* is a chroma-dependent weighting factor (Morovic, 1998) that depends on the chroma of the original color, C and *J<sub>S</sub>* are the result of the original lightness being mapped using a sigmoidal function.</span></span>

 

<span data-ttu-id="8dfee-300">Para calcular *J <sub>S</sub>* (Braun y Fairchild, 1999), se configura primero una tabla de búsqueda de una dimensión (LUT) entre los valores de luminosidad original y de reproducción, en función de una o varias funciones normales acumulativas.</span><span class="sxs-lookup"><span data-stu-id="8dfee-300">To calculate *J<sub>S</sub>* (Braun and Fairchild, 1999), a one-dimensional lookup table (LUT) between original and reproduction lightness values is first set up on the basis of a discrete cumulative normal function (S).</span></span>

![Muestra una fórmula para calcular J s.](images/gmmp-image016.png) <span data-ttu-id="8dfee-302">(3)</span><span class="sxs-lookup"><span data-stu-id="8dfee-302">(3)</span></span>

<span data-ttu-id="8dfee-303">donde x ₀ y S son la media y la desviación estándar de la distribución normal, respectivamente, y *i* = 0, 1, 2... *m*,*m* es el número de puntos que se usan en LUT.</span><span class="sxs-lookup"><span data-stu-id="8dfee-303">where x ₀ and S are the mean and standard deviation of the normal distribution respectively and *i* = 0,1,2... *m*,*m* is the number of points used in the LUT.</span></span> <span data-ttu-id="8dfee-304">*S <sub></sub>* es el valor de la función acumulativa acumulativa para *i*  / *m* por ciento.</span><span class="sxs-lookup"><span data-stu-id="8dfee-304">*S <sub>i</sub>* is the value of the cumulative normal function for *i* /*m* percent.</span></span> <span data-ttu-id="8dfee-305">Los parámetros dependen de la luminosidad del punto negro de la gama de reproducción y se pueden interpolar a partir de la tabla 1.</span><span class="sxs-lookup"><span data-stu-id="8dfee-305">The parameters depend on the lightness of the black point of the reproduction gamut and can be interpolated from Table 1.</span></span> <span data-ttu-id="8dfee-306">Para obtener información detallada sobre el cálculo de estos parámetros, vea Braun y Fairchild (1999, p.</span><span class="sxs-lookup"><span data-stu-id="8dfee-306">For details of calculating these parameters see Braun and Fairchild (1999, p.</span></span> <span data-ttu-id="8dfee-307">391).</span><span class="sxs-lookup"><span data-stu-id="8dfee-307">391).</span></span>

:::row:::
    :::column:::
        <span data-ttu-id="8dfee-308">J <sub>minOut</sub></span><span class="sxs-lookup"><span data-stu-id="8dfee-308">J <sub>minOut</sub></span></span>
    :::column-end:::
    :::column:::
       <span data-ttu-id="8dfee-309">5.0</span><span class="sxs-lookup"><span data-stu-id="8dfee-309">5.0</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="8dfee-310">10.0</span><span class="sxs-lookup"><span data-stu-id="8dfee-310">10.0</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="8dfee-311">15.0</span><span class="sxs-lookup"><span data-stu-id="8dfee-311">15.0</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="8dfee-312">20,0</span><span class="sxs-lookup"><span data-stu-id="8dfee-312">20.0</span></span>
    :::column-end:::
:::row-end:::
:::row:::
    :::column:::
        <span data-ttu-id="8dfee-313">x ₀</span><span class="sxs-lookup"><span data-stu-id="8dfee-313">x ₀</span></span>
    :::column-end:::
    :::column:::
       <span data-ttu-id="8dfee-314">53,7</span><span class="sxs-lookup"><span data-stu-id="8dfee-314">53.7</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="8dfee-315">56,8</span><span class="sxs-lookup"><span data-stu-id="8dfee-315">56.8</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="8dfee-316">58,2</span><span class="sxs-lookup"><span data-stu-id="8dfee-316">58.2</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="8dfee-317">60,6</span><span class="sxs-lookup"><span data-stu-id="8dfee-317">60.6</span></span>
    :::column-end:::
:::row-end:::
:::row:::
    :::column:::
        <span data-ttu-id="8dfee-318">S</span><span class="sxs-lookup"><span data-stu-id="8dfee-318">S</span></span>
    :::column-end:::
    :::column:::
       <span data-ttu-id="8dfee-319">43,0</span><span class="sxs-lookup"><span data-stu-id="8dfee-319">43.0</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="8dfee-320">40,0</span><span class="sxs-lookup"><span data-stu-id="8dfee-320">40.0</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="8dfee-321">35,0</span><span class="sxs-lookup"><span data-stu-id="8dfee-321">35.0</span></span>
    :::column-end:::
    :::column:::
        <span data-ttu-id="8dfee-322">34,5</span><span class="sxs-lookup"><span data-stu-id="8dfee-322">34.5</span></span>
    :::column-end:::
:::row-end:::


<span data-ttu-id="8dfee-323">**Tabla 1** : cálculo del parámetro de compresión BasicPhoto luminosidad</span><span class="sxs-lookup"><span data-stu-id="8dfee-323">**Table 1** : BasicPhoto lightness compression parameter calculation</span></span>

<span data-ttu-id="8dfee-324">Para usar S como LUT de asignación de luminosidad ( <sub>LUT</sub> ), primero se debe normalizar en el intervalo de luminosidad de \[ 0100 \] .</span><span class="sxs-lookup"><span data-stu-id="8dfee-324">To use S as a lightness mapping LUT (S <sub>LUT</sub> ) it must first be normalized into the lightness range of \[0,100\].</span></span> <span data-ttu-id="8dfee-325">A continuación, los datos normalizados se escalan en el intervalo dinámico del dispositivo de destino, como se muestra en la ecuación 4, donde *j*<sub>min \ *out*</sub> y *j*<sub>Max \ *out*</sub> son los valores de luminosidad del punto negro y el punto blanco del medio de reproducción, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="8dfee-325">The normalized data is then scaled into the dynamic range of the destination device, as shown in Equation 4, where *J*<sub>min\ *Out*</sub> and *J*<sub>max\ *Out*</sub> are the values of lightness of the black point and the white point of the reproduction medium, respectively.</span></span>

![Muestra la fórmula de S como LUT de asignación de luminosidad.](images/gmmp-image018.png) <span data-ttu-id="8dfee-327">(4)</span><span class="sxs-lookup"><span data-stu-id="8dfee-327">(4)</span></span>

<span data-ttu-id="8dfee-328">En este momento, se pueden obtener los valores de *j s* de los <sub>LUT</sub> de elementos mediante la interpolación entre los *m* puntos de los valores de *j o '* y *j s* que contiene y el uso de la siguiente ecuación como entrada.</span><span class="sxs-lookup"><span data-stu-id="8dfee-328">At this point, the *J S* values can be obtained from the S <sub>LUT</sub> by interpolating between the *m* points of corresponding *J O'* and *J S* values it contains, and using the following equation as the input.</span></span>

![Muestra la fórmula para obtener los valores de J S.](images/gmmp-image020.png) <span data-ttu-id="8dfee-330">(5)</span><span class="sxs-lookup"><span data-stu-id="8dfee-330">(5)</span></span>

<span data-ttu-id="8dfee-331">J <sub>Minin</sub> es el valor de luminosidad del punto negro del medio original, j <sub>maxin</sub> es el valor de luminosidad del punto blanco del medio original y j <sub>O</sub> es la luminosidad original.</span><span class="sxs-lookup"><span data-stu-id="8dfee-331">J <sub>minIn</sub> is the lightness value of the black point of the original medium, J <sub>maxIn</sub> is the lightness value of the white point of the original medium, and J <sub>O</sub> is the original lightness.</span></span> <span data-ttu-id="8dfee-332">Para una referencia posterior, puede indicar mediante la función sigmoidal definida *de la manera* que se describe en la siguiente ilustración 4.</span><span class="sxs-lookup"><span data-stu-id="8dfee-332">For later reference, you can denote by *S* the sigmoidal function defined in the manner just outlined, as illustrated in the following Figure 4.</span></span>

![Diagrama que muestra el gráfico para la asignación de cromas a lo largo de la luminosidad constante.](images/gmmp-image024.png)

<span data-ttu-id="8dfee-334">**Ilustración 4** : asignación de cromas a lo largo de la luminosidad constante</span><span class="sxs-lookup"><span data-stu-id="8dfee-334">**Figure 4** : Chroma mapping along constant lightness</span></span>

<span data-ttu-id="8dfee-335">En segundo lugar, si el límite de la gama de destino es cromático, comprima el croma a lo largo de las líneas de luminosidad constante (l) y realice la compresión como se indica a continuación.</span><span class="sxs-lookup"><span data-stu-id="8dfee-335">Second, if the destination gamut boundary is chromatic, compress chroma along lines of constant lightness (l) and perform the compression as follows.</span></span>

![Muestra la fórmula para realizar la compresión cromada.](images/gmmp-image026.png) <span data-ttu-id="8dfee-337"> (6)</span><span class="sxs-lookup"><span data-stu-id="8dfee-337">(6)</span></span>

<span data-ttu-id="8dfee-338">donde *d* representa la distancia desde *E* en *l*; *g* representa el límite de la gama mediana; *r* representa la reproducción; y *o* la figura 5 original.</span><span class="sxs-lookup"><span data-stu-id="8dfee-338">where *d* represents distance from *E* on *l*;*g* represents the medium gamut boundary; *r* represents the reproduction; and *o* the original Figure 5.</span></span>

![Diagrama que muestra el gráfico para la compresión croma y luminosidad en BasicPhoto.](images/gmmp-image028.png)

<span data-ttu-id="8dfee-340">**Figura 5** : compresión croma y luminosidad en BasicPhoto</span><span class="sxs-lookup"><span data-stu-id="8dfee-340">**Figure 5** : Chroma and lightness compression in BasicPhoto</span></span>

<span data-ttu-id="8dfee-341">Si el límite de la gama de destino es monocromo, el valor de croma se recorta a cero.</span><span class="sxs-lookup"><span data-stu-id="8dfee-341">If the destination gamut boundary is monochrome, then the chroma value is clipped to zero.</span></span>

<span data-ttu-id="8dfee-342">En tercer lugar, utilice un clip picado (descrito anteriormente) para eliminar cualquier error residual.</span><span class="sxs-lookup"><span data-stu-id="8dfee-342">Third, use a MinCD clip (described earlier) to eliminate any residual error.</span></span>

### <a name="black-enhancement"></a><span data-ttu-id="8dfee-343">Mejora en negro</span><span class="sxs-lookup"><span data-stu-id="8dfee-343">Black enhancement</span></span>

<span data-ttu-id="8dfee-344">El algoritmo anterior se puede modificar para mejorar el negro cuando el destino es un dispositivo de impresora.</span><span class="sxs-lookup"><span data-stu-id="8dfee-344">The preceding algorithm can be modified to improve the black when the destination is a printer device.</span></span> <span data-ttu-id="8dfee-345">El problema tiene que elegir *J <sub>minOut</sub>*, que normalmente no se corresponde con el color más oscuro que puede producir una impresora.</span><span class="sxs-lookup"><span data-stu-id="8dfee-345">The issue has to do with the choice of *J<sub>minOut</sub>*, which usually does not correspond to the darkest color a printer can produce.</span></span>

<span data-ttu-id="8dfee-346">Más concretamente, el color con mayor densidad que se obtiene al colocar las tintas del 100% (o la cobertura máxima posible, si la limitación de GCR/Ink está en vigor), no suele ser "neutral" en el espacio de apariencia del color.</span><span class="sxs-lookup"><span data-stu-id="8dfee-346">More specifically, the color with highest density, obtained by putting 100 percent inks (or maximum possible coverage, if GCR/ink limiting is in effect), is usually not "neutral" in the color appearance space.</span></span> <span data-ttu-id="8dfee-347">Vea la figura 6.</span><span class="sxs-lookup"><span data-stu-id="8dfee-347">See Figure 6.</span></span> <span data-ttu-id="8dfee-348">En otras palabras, si se usa la luminosidad mínima neutra para el dispositivo de destino, el Scaler de luminosidad construido se asignará a una luminosidad mínima que no sea la densidad más alta que pueda alcanzar la impresora.</span><span class="sxs-lookup"><span data-stu-id="8dfee-348">In other words, if neutral minimum lightness is used for the destination device, the lightness scaler constructed will map to a minimum lightness that is not the highest density that can be achieved by the printer.</span></span> <span data-ttu-id="8dfee-349">Considere el caso de uso adicional de monitor en la impresora.</span><span class="sxs-lookup"><span data-stu-id="8dfee-349">Consider the further use case of monitor to printer.</span></span> <span data-ttu-id="8dfee-350">El monitor Black, R = G = B = 0, se imprimirá como no la densidad más alta.</span><span class="sxs-lookup"><span data-stu-id="8dfee-350">The monitor black, R=G=B=0, will then be printed as not the highest density.</span></span> <span data-ttu-id="8dfee-351">El impacto en la calidad de la imagen es que hay una falta de profundidad y de contraste.</span><span class="sxs-lookup"><span data-stu-id="8dfee-351">The impact on the image quality is that there is a lack of depth and contrast.</span></span>

![Diagrama que muestra cómo el punto negro del dispositivo puede ser más oscuro que la luminosidad mínima neutra.](images/gmmp-seqfigure01.png)

<span data-ttu-id="8dfee-353">**Figura 6** : el punto negro del dispositivo puede ser más oscuro que la luminosidad mínima neutra.</span><span class="sxs-lookup"><span data-stu-id="8dfee-353">**Figure 6** : The device black point may be darker than the neutral minimum lightness.</span></span>

<span data-ttu-id="8dfee-354">Supongamos que el "punto negro del dispositivo" de destino es Jkakbk/JkCkh k.</span><span class="sxs-lookup"><span data-stu-id="8dfee-354">Suppose the destination "device black point" is Jₖaₖbₖ/JₖCₖh ₖ.</span></span> <span data-ttu-id="8dfee-355">Si C k no es cero, el punto negro del dispositivo no es neutro con respecto a CAM02.</span><span class="sxs-lookup"><span data-stu-id="8dfee-355">If C ₖ is not zero, then the device black point is not neutral relative to CAM02.</span></span> <span data-ttu-id="8dfee-356">Si utiliza J k para la "luminosidad mínima neutra" de destino en la construcción de la luminosidad Scaler; es decir, establecer</span><span class="sxs-lookup"><span data-stu-id="8dfee-356">If you use J ₖ for the destination "neutral minimum lightness" in the construction of the lightness scaler; that is, setting</span></span>

<span data-ttu-id="8dfee-357">*J <sub>minOut</sub> = JK*</span><span class="sxs-lookup"><span data-stu-id="8dfee-357">*J<sub>minOut</sub> = Jₖ*</span></span>

<span data-ttu-id="8dfee-358">y aplíquelo al shell de la gama de origen para obtener la configuración que se muestra en la figura 7.</span><span class="sxs-lookup"><span data-stu-id="8dfee-358">and apply it to the source gamut shell, you obtain the configuration depicted in Figure 7.</span></span> <span data-ttu-id="8dfee-359">En la ilustración, el plano de matiz corresponde a h k.</span><span class="sxs-lookup"><span data-stu-id="8dfee-359">In the figure, the hue plane corresponds to h ₖ.</span></span>

![Diagrama que muestra la luminosidad modificada Scaler con el punto negro del dispositivo de destino.](images/gmmp-seqfigure02.png)

<span data-ttu-id="8dfee-361">**Figura 7** : geometría mediante la luminosidad modificada Scaler con el punto negro del dispositivo de destino</span><span class="sxs-lookup"><span data-stu-id="8dfee-361">**Figure 7** : Geometry using the modified lightness scaler with destination device black point</span></span>

<span data-ttu-id="8dfee-362">Para permitir que el algoritmo de compresión de croma subsiguiente continúe, desea alinear los lightnesses máximo y mínimo en los shells de origen y de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-362">To allow the subsequent chroma compression algorithm to proceed, you want to align the maximum and minimum lightnesses on the source and destination shells.</span></span> <span data-ttu-id="8dfee-363">Esto puede lograrse ajustando el shell de destino entre J <sub>neutralMin</sub> y j k pasando los puntos hacia la izquierda.</span><span class="sxs-lookup"><span data-stu-id="8dfee-363">This can be achieved by adjusting the destination shell between J <sub>neutralMin</sub> and J ₖ by shifting points to the left.</span></span> <span data-ttu-id="8dfee-364">Además, esta transformación se debe aplicar en todo el espacio de jab, no solo en el plano de matiz correspondiente a h k.</span><span class="sxs-lookup"><span data-stu-id="8dfee-364">Furthermore, this transformation must be applied on the whole Jab space, not just the hue plane corresponding to h ₖ.</span></span>

<span data-ttu-id="8dfee-365">La transformación es</span><span class="sxs-lookup"><span data-stu-id="8dfee-365">The transformation is</span></span>

![Muestra la fórmula de la transformación.](images/gmmp-seqfigure03.png)

<span data-ttu-id="8dfee-367">En la ilustración 8 se muestra el efecto de la transformación.</span><span class="sxs-lookup"><span data-stu-id="8dfee-367">Figure 8 shows the effect of the transformation.</span></span>

![Diagrama que muestra el efecto de la luminosidad modificada Scaler con el punto negro del dispositivo de destino.](images/gmmp-seqfigure04.png)

<span data-ttu-id="8dfee-369">**Figura 8** : geometría mediante la luminosidad modificada Scaler con el punto negro del dispositivo de destino</span><span class="sxs-lookup"><span data-stu-id="8dfee-369">**Figure 8** : Geometry using the modified lightness scaler with destination device black point</span></span>

<span data-ttu-id="8dfee-370">Después de aplicar el algoritmo de compresión de croma habitual, el punto se debe "desplazar de nuevo", es decir, se debe aplicar la transformación inversa para obtener el color asignado final.</span><span class="sxs-lookup"><span data-stu-id="8dfee-370">After applying the usual chroma compression algorithm, the point must then be "shifted back;" that is, the inverse transformation must be applied to obtain the final mapped color.</span></span>

![Muestra la fórmula para la transformación inversa con el fin de obtener el color asignado final.](images/gmmp-seqfigure05.png)

### <a name="the-case-of-dual-gamut-shells"></a><span data-ttu-id="8dfee-372">El caso de los shells de doble gama</span><span class="sxs-lookup"><span data-stu-id="8dfee-372">The case of dual gamut shells</span></span>

<span data-ttu-id="8dfee-373">El objetivo es generalizar la \_ Knee de SIG para el shell de una sola gama en el caso en el que el dispositivo de origen gbd o el dispositivo de destino gbd tiene una estructura de dos Shell.</span><span class="sxs-lookup"><span data-stu-id="8dfee-373">The goal is to generalize SIG\_KNEE for single gamut shell to the case where either the source device GBD or the destination device GBD has a two-shell structure.</span></span> <span data-ttu-id="8dfee-374">El shell interno se llamará el shell de referencia, mientras que el Shell externo se llamará el shell de plausible.</span><span class="sxs-lookup"><span data-stu-id="8dfee-374">The inner shell will be called the Reference Shell, while the outer shell will be called the Plausible Shell.</span></span> <span data-ttu-id="8dfee-375">Desea tener en cuenta los siguientes casos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-375">You want to consider the following cases.</span></span>

<span data-ttu-id="8dfee-376">(a) tanto el GBD de origen como el GBD de destino tienen una estructura de dos shells.</span><span class="sxs-lookup"><span data-stu-id="8dfee-376">(a) Both the source GBD and destination GBD have a two-shell structure.</span></span>

<span data-ttu-id="8dfee-377">(b) el GBD de origen tiene una estructura de dos shells; el GBD de destino tiene solo un shell.</span><span class="sxs-lookup"><span data-stu-id="8dfee-377">(b) The source GBD has a two-shell structure; the destination GBD has only one shell.</span></span>

<span data-ttu-id="8dfee-378">(c) el GBD de origen tiene solo un shell; el GBD de destino tiene una estructura de dos Shell.</span><span class="sxs-lookup"><span data-stu-id="8dfee-378">(c) The source GBD has only one shell; the destination GBD has a two-shell structure.</span></span>

<span data-ttu-id="8dfee-379">(d) el origen GBD y el GBD de destino tienen solo un shell.</span><span class="sxs-lookup"><span data-stu-id="8dfee-379">(d) Both the source GBD and destination GBD have only one shell.</span></span>

<span data-ttu-id="8dfee-380">Case (d) es el caso del shell de una sola gama que se analizó anteriormente.</span><span class="sxs-lookup"><span data-stu-id="8dfee-380">Case (d) is the case of single gamut shell that was discussed previously.</span></span> <span data-ttu-id="8dfee-381">En el caso de los casos (a), (b) y (c), puede generalizar el cambio de escala de luminosidad para usar la información adicional de la estructura de Shell dual.</span><span class="sxs-lookup"><span data-stu-id="8dfee-381">For cases (a), (b), and (c), you can generalize the lightness rescaling to use the extra information from the dual shell structure.</span></span> <span data-ttu-id="8dfee-382">En los casos (b) y (c) en los que el origen o el destino solo tienen un shell, se introduce un "Shell de referencia inducida" que se tratará en una sección posterior, "Shell de referencia inducida".</span><span class="sxs-lookup"><span data-stu-id="8dfee-382">In cases (b) and (c) where either the source or the destination has only one shell, you introduce an "induced reference shell" which will be discussed in a subsequent section, "Induced Reference Shell."</span></span> <span data-ttu-id="8dfee-383">El algoritmo general para dos shells se describe para el caso (a).</span><span class="sxs-lookup"><span data-stu-id="8dfee-383">The general algorithm for two shells will be described for case (a).</span></span> <span data-ttu-id="8dfee-384">Una vez explicada la construcción del shell de referencia inducida, el algoritmo se puede aplicar también a las mayúsculas y minúsculas (b) y (c).</span><span class="sxs-lookup"><span data-stu-id="8dfee-384">After the Induced Reference Shell construction is explained, the algorithm can be applied to case (b) and (c), as well.</span></span> <span data-ttu-id="8dfee-385">En cuanto a la compresión cromada, la razón de compresión estará determinada por los shells más grandes disponibles.</span><span class="sxs-lookup"><span data-stu-id="8dfee-385">As for chroma compression, the compression ratio will be determined by the largest shells available.</span></span> <span data-ttu-id="8dfee-386">En otras palabras, si el shell de plausible y el shell de referencia están disponibles, se utilizará el shell de plausible. de lo contrario, se utilizará el shell de referencia.</span><span class="sxs-lookup"><span data-stu-id="8dfee-386">In other words, if both the Plausible Shell and Reference Shell are available, the Plausible Shell will be used; otherwise, the Reference Shell will be used.</span></span>

<span data-ttu-id="8dfee-387">*Escalado de luminosidad generalizada*</span><span class="sxs-lookup"><span data-stu-id="8dfee-387">*Generalized Lightness Rescaling*</span></span>

<span data-ttu-id="8dfee-388">La existencia de dos shells para GBD de origen y de destino significa que debe asignar un conjunto de cuatro puntos desde el GBD de origen a un conjunto correspondiente en el GBD de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-388">The existence of two shells for both source and destination GBD means that you must map a set of four points from the source GBD to a corresponding set in the destination GBD.</span></span>

![Muestra cómo asignar un conjunto de cuatro puntos a un conjunto correspondiente.](images/gmmp-image030.png)

<span data-ttu-id="8dfee-390">Los subíndices tienen los significados siguientes.</span><span class="sxs-lookup"><span data-stu-id="8dfee-390">The subscripts have the following meanings.</span></span>

<span data-ttu-id="8dfee-391">o o r: "original" (origen) o "reproducción" (destino)</span><span class="sxs-lookup"><span data-stu-id="8dfee-391">o or r: "original" (source) or "reproduction" (destination)</span></span>

<span data-ttu-id="8dfee-392">mín. o máx.: luminosidad neutra mínima o luminosidad neutra máxima</span><span class="sxs-lookup"><span data-stu-id="8dfee-392">min or max: minimum neutral lightness or maximum neutral lightness</span></span>

<span data-ttu-id="8dfee-393">Pla o Ref: Shell de plausible o shell de referencia</span><span class="sxs-lookup"><span data-stu-id="8dfee-393">pla or ref: Plausible Shell or Reference Shell</span></span>

<span data-ttu-id="8dfee-394">La ordenación en cada Quadruple es también la magnitud relativa esperada de estos puntos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-394">The ordering in each quadruple is also the expected relative magnitude of these points.</span></span>

<span data-ttu-id="8dfee-395">El mapa de cambio de escala de luminosidad utiliza las mismas dos primeras ecuaciones que el shell único, pero *J S* se define de forma a trozos como se indica a continuación.</span><span class="sxs-lookup"><span data-stu-id="8dfee-395">The Lightness Rescaling map uses the same first two equations as the single shell, but *J S* is defined in a piecewise manner as follows.</span></span>

![Muestra la fórmula de J S de una manera a trozos.](images/gmmp-image032.png) <span data-ttu-id="8dfee-397">(7)</span><span class="sxs-lookup"><span data-stu-id="8dfee-397">(7)</span></span>

<span data-ttu-id="8dfee-398">En otras palabras, es sigmoidal dentro del shell de referencia y lineal fuera de.</span><span class="sxs-lookup"><span data-stu-id="8dfee-398">In other words, it is sigmoidal within the reference shell, and linear outside.</span></span> <span data-ttu-id="8dfee-399">Vea la figura 9.</span><span class="sxs-lookup"><span data-stu-id="8dfee-399">See Figure 9.</span></span>

![Diagrama que muestra un gráfico para la función de cambio de escala de luminosidad para dos GBDs de Shell.](images/gmmp-image033.png)

<span data-ttu-id="8dfee-401">**Figura 9** : función de cambio de escala de luminosidad para dos shells de GBDs</span><span class="sxs-lookup"><span data-stu-id="8dfee-401">**Figure 9** : Lightness Rescaling function for two-shell GBDs</span></span>

<span data-ttu-id="8dfee-402">**SHELL DE REFERENCIA INDUCIDA**</span><span class="sxs-lookup"><span data-stu-id="8dfee-402">**INDUCED REFERENCE SHELL**</span></span>

<span data-ttu-id="8dfee-403">Si un GBD tiene un shell y el otro GBD tiene dos shells, debe crear un "Shell de referencia" para GBD con un solo Shell.</span><span class="sxs-lookup"><span data-stu-id="8dfee-403">Where one GBD has one shell and the other GBD has two shells, you must create a "Reference Shell" for the GBD with only one shell.</span></span> <span data-ttu-id="8dfee-404">El shell existente, que se denominará el shell de referencia, se cambiará al "Shell de plausible". De hecho, en realidad no tiene que crear un shell en el espacio de jab completo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-404">The existing shell, which would be called the Reference Shell, will be changed to the "Plausible Shell."In fact, you don't actually have to create a shell in the full Jab space.</span></span> <span data-ttu-id="8dfee-405">Dado que el cambio de escala de luminosidad solo usa *j Max* y *j min*, solo tiene que componer estos valores para el shell de referencia inducida.</span><span class="sxs-lookup"><span data-stu-id="8dfee-405">Because the lightness rescaling only uses *J max* and *J min*, you only have to make up these values for the induced Reference Shell.</span></span> <span data-ttu-id="8dfee-406">Hay dos casos, en función de qué GBD tiene dos shells.</span><span class="sxs-lookup"><span data-stu-id="8dfee-406">There are two cases, depending on which GBD has two shells.</span></span>

<span data-ttu-id="8dfee-407">Caso 1: el GBD de origen tiene dos shells; el GBD de destino tiene un shell.</span><span class="sxs-lookup"><span data-stu-id="8dfee-407">Case 1: Source GBD has two shells; destination GBD has one shell.</span></span>

<span data-ttu-id="8dfee-408">Determine el shell de referencia inducida de destino en el eje neutro; es decir, el J <sub>r, \ min, \ Ref</sub> y j <sub>r, \ Max, \ Ref</sub> del shell.</span><span class="sxs-lookup"><span data-stu-id="8dfee-408">Determine the destination induced Reference Shell on the neutral axis; that is, the J <sub>r,\ min,\ ref</sub> and J <sub>r,\ max,\ ref</sub> of the shell.</span></span> <span data-ttu-id="8dfee-409">Esto se hace mediante el siguiente algoritmo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-409">This is done using the following algorithm.</span></span>

![Muestra el algoritmo para determinar el shell de referencia inducida de destino.](images/gmmp-induced01.png)

<span data-ttu-id="8dfee-411">¿Los factores?</span><span class="sxs-lookup"><span data-stu-id="8dfee-411">The factors ?</span></span> <span data-ttu-id="8dfee-412">¿ <sub>bajo</sub> y?</span><span class="sxs-lookup"><span data-stu-id="8dfee-412"><sub>low</sub> and ?</span></span> <span data-ttu-id="8dfee-413">control <sub>alto</sub> la separación entre el shell de plausible y el shell de referencia.</span><span class="sxs-lookup"><span data-stu-id="8dfee-413"><sub>high</sub> control the separation between the Plausible Shell and the Reference Shell.</span></span> <span data-ttu-id="8dfee-414">Un valor de 1 significa que los valores J <sub>min</sub> o j m ₐ ₓ coinciden.</span><span class="sxs-lookup"><span data-stu-id="8dfee-414">A value of 1 means that the J <sub>min</sub> values or J ₘₐₓ values coincide.</span></span> <span data-ttu-id="8dfee-415">Sus valores se "inducidan" desde el shell de referencia de origen y el shell de plausible de origen.</span><span class="sxs-lookup"><span data-stu-id="8dfee-415">Their values are "induced" from the source Reference Shell and source Plausible Shell.</span></span>

![Muestra la fórmula para los valores del shell de referencia de origen y el shell de plausible de origen.](images/gmmp-induced02.png)

<span data-ttu-id="8dfee-417">Los "factores fudges" F <sub>Low</sub> y f <sub>High</sub> son *parámetros ajustables* que deben estar entre 0 y 1.</span><span class="sxs-lookup"><span data-stu-id="8dfee-417">The "fudge factors" F <sub>low</sub> and F <sub>high</sub> are *tunable parameters* that must lie between 0 and 1.</span></span> <span data-ttu-id="8dfee-418">Si el valor es 0, el ₓ de J <sub>min</sub> o j m ₐ se provoca directamente en los shells de origen.</span><span class="sxs-lookup"><span data-stu-id="8dfee-418">If the value is 0, then the J <sub>min</sub> or J ₘₐₓ are directly induced from the source shells.</span></span> <span data-ttu-id="8dfee-419">En este caso, elija F <sub>Low</sub> = 0,95 y f <sub>High</sub> = 0,1.</span><span class="sxs-lookup"><span data-stu-id="8dfee-419">For this case, choose F <sub>low</sub> = 0.95, and F <sub>high</sub> = 0.1.</span></span>

<span data-ttu-id="8dfee-420">Caso 2: el GBD de origen tiene un shell; el GBD de destino tiene dos shells.</span><span class="sxs-lookup"><span data-stu-id="8dfee-420">Case 2: Source GBD has one shell; destination GBD has two shells.</span></span>

<span data-ttu-id="8dfee-421">Determine el shell de referencia inducida de origen en el eje neutro; es decir, las J <sub>o, \ min, \ Ref</sub> y J <sub>o, \ Max, \ Ref</sub> del shell.</span><span class="sxs-lookup"><span data-stu-id="8dfee-421">Determine the source induced Reference Shell on the neutral axis; that is, the J <sub>o,\ min,\ ref</sub> and J <sub>o,\ max,\ ref</sub> of the shell.</span></span> <span data-ttu-id="8dfee-422">Esto se hace mediante el siguiente algoritmo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-422">This is done using the following algorithm.</span></span>

![Muestra el algoritmo para determinar el shell de referencia inducida de destino en el eje neutro.](images/gmmp-induced03.png)

<span data-ttu-id="8dfee-424">De nuevo, ¿los factores?</span><span class="sxs-lookup"><span data-stu-id="8dfee-424">Again, the factors ?</span></span> <span data-ttu-id="8dfee-425">¿ <sub>bajo</sub> y?</span><span class="sxs-lookup"><span data-stu-id="8dfee-425"><sub>low</sub> and ?</span></span> <span data-ttu-id="8dfee-426">control <sub>alto</sub> la separación entre el shell de plausible y el shell de referencia.</span><span class="sxs-lookup"><span data-stu-id="8dfee-426"><sub>high</sub> control the separation between the Plausible Shell and Reference Shell.</span></span> <span data-ttu-id="8dfee-427">Un valor de 1 significa que los valores J <sub>min</sub> o j m ₐ ₓ coinciden.</span><span class="sxs-lookup"><span data-stu-id="8dfee-427">A value of 1 means the J <sub>min</sub> values or J ₘₐₓ values coincide.</span></span> <span data-ttu-id="8dfee-428">Sus valores se "inducidan" desde el shell de referencia de origen y el shell de plausible de origen:</span><span class="sxs-lookup"><span data-stu-id="8dfee-428">Their values are "induced" from the source Reference Shell and source Plausible Shell:</span></span>

![Muestra el algoritmo para controlar la separación entre el shell de referencia y el shell de plausible de origen.](images/gmmp-induced04.png)

### <a name="reasons-for-changes-from-the-cie-tc8-03-recommendations"></a><span data-ttu-id="8dfee-430">Motivos de los cambios de las recomendaciones de CIE TC8-03</span><span class="sxs-lookup"><span data-stu-id="8dfee-430">Reasons for changes from the CIE TC8-03 recommendations</span></span>

<span data-ttu-id="8dfee-431">BasicPhoto difiere de las recomendaciones de CIE TC8-03 de las siguientes maneras.</span><span class="sxs-lookup"><span data-stu-id="8dfee-431">BasicPhoto differs from the CIE TC8-03 recommendations in the following ways.</span></span>

1.  <span data-ttu-id="8dfee-432">Croma no se comprime hacia la cúspide, sino a lo largo de líneas de luminosidad constante.</span><span class="sxs-lookup"><span data-stu-id="8dfee-432">Chroma is not compressed toward the cusp but along lines of constant lightness.</span></span>
2.  <span data-ttu-id="8dfee-433">El intervalo de luminosidad usa la luminosidad del color más oscuro de la gama en lugar del punto en el que el límite de la gama cruza el eje neutro.</span><span class="sxs-lookup"><span data-stu-id="8dfee-433">The lightness range uses the lightness of the darkest color in the gamut rather than the point at which the gamut boundary crosses the neutral axis.</span></span>
3.  <span data-ttu-id="8dfee-434">BasicPhoto admite un shell de gama de referencia y un shell de gama de plausible, si alguno de los límites de las gamas de la transformación tiene dos shells.</span><span class="sxs-lookup"><span data-stu-id="8dfee-434">BasicPhoto supports both a reference gamut shell and a plausible gamut shell, if either gamut boundary in the transform has two shells.</span></span>
4.  <span data-ttu-id="8dfee-435">BasicPhoto usa CIECAM02; en lugar de usar CIECAM97s para convertir a D65 en 400 cd/m2 y, a continuación, usar el espacio de colores de RIT IPT.</span><span class="sxs-lookup"><span data-stu-id="8dfee-435">BasicPhoto uses CIECAM02; instead of using CIECAM97s to convert to D65 at 400 cd/m2, and then using RIT IPT color space.</span></span>

<span data-ttu-id="8dfee-436">El primer cambio se realizó para evitar problemas de inversión de tono que se pueden producir al usar la compresión hacia una cúspide.</span><span class="sxs-lookup"><span data-stu-id="8dfee-436">The first change was made to prevent tone inversion problems that can occur when using compression toward a cusp.</span></span> <span data-ttu-id="8dfee-437">Como se muestra en la figura 10, la compresión de cúspide puede producir inversiones de tono.</span><span class="sxs-lookup"><span data-stu-id="8dfee-437">As shown in Figure 10, cusp compression can cause tone inversions.</span></span> <span data-ttu-id="8dfee-438">Esto puede ocurrir cuando los colores de intensidad de croma alto son más claros que los colores de intensidad de color inferior.</span><span class="sxs-lookup"><span data-stu-id="8dfee-438">This can happen when colors of high chroma are lighter than colors of lower chroma.</span></span> <span data-ttu-id="8dfee-439">Dado que SGCK comprime cada píxel independientemente en cuanto a luminosidad y croma, no se garantiza que conserve la relación de luminosidad entre los valores de píxel después de la compresión.</span><span class="sxs-lookup"><span data-stu-id="8dfee-439">Because SGCK compresses each pixel independently in both lightness and chroma, it is not guaranteed to preserve the lightness relationship between the pixel values after the compression.</span></span> <span data-ttu-id="8dfee-440">El inconveniente conocido de esta decisión de comprimir las líneas de luminosidad constante es que puede sufrir pérdidas de cromas, en particular en áreas en las que el límite de la gama de destino es muy plano, como sucede con los amarillos brillantes.</span><span class="sxs-lookup"><span data-stu-id="8dfee-440">The well-known downside to this decision to compress on lines of constant lightness is that you can suffer losses of chroma, particular in areas where the destination gamut boundary is very flat, as happens with bright yellows.</span></span>

![Diagrama que muestra la inversión de tono causada por SGCK.](images/gmmp-toneinversion.png)

<span data-ttu-id="8dfee-442">**Figura 10** : inversión de tono causada por SGCK</span><span class="sxs-lookup"><span data-stu-id="8dfee-442">**Figure 10** : Tone inversion caused by SGCK</span></span>

![Muestra una imagen original de un tetera.](images/originalteapot.jpg)![Muestra el resultado de SGCK de la imagen de tetera.](images/badteapot.jpg)![Muestra el resultado de BasicPhoto de la imagen de tetera.](images/betterteapot.jpg)

<span data-ttu-id="8dfee-446">**Figura 11** : imagen original, resultado de SGCK y resultado de BasicPhoto</span><span class="sxs-lookup"><span data-stu-id="8dfee-446">**Figure 11** : Original image, SGCK result, and BasicPhoto result</span></span>

<span data-ttu-id="8dfee-447">En la figura 11 se muestra esta inversión de tono.</span><span class="sxs-lookup"><span data-stu-id="8dfee-447">Figure 11 illustrates this tone inversion.</span></span> <span data-ttu-id="8dfee-448">A la izquierda hay una imagen original capturada por una cámara digital. en el centro, la imagen la reproduce SGCK; y a la derecha, la imagen tal como la reproduce BasicPhoto.</span><span class="sxs-lookup"><span data-stu-id="8dfee-448">On the left is an original image captured by a digital camera; in the center, the image as reproduced by SGCK; and on the right, the image as reproduced by BasicPhoto.</span></span> <span data-ttu-id="8dfee-449">La imagen de la izquierda está en el espacio de colores de la cámara digital, las imágenes central y derecha se encuentran en el espacio de colores de una pantalla de vídeo LCD.</span><span class="sxs-lookup"><span data-stu-id="8dfee-449">The image on the left is in the digital camera's color space, the center and right images are in the color space of an LCD video display.</span></span> <span data-ttu-id="8dfee-450">En la imagen original, la parte superior del tetera es más oscura que la parte inferior, porque la parte inferior refleja el mantel en el que está sentado.</span><span class="sxs-lookup"><span data-stu-id="8dfee-450">In the original image, the top part of the teapot is darker than the bottom, because the bottom is reflecting the tablecloth that it is sitting upon.</span></span> <span data-ttu-id="8dfee-451">En la imagen SGCK, la parte superior es realmente más clara que la parte inferior, debido a la inversión de tono.</span><span class="sxs-lookup"><span data-stu-id="8dfee-451">In the SGCK image, the top part is actually lighter than the bottom, because of the tone inversion.</span></span> <span data-ttu-id="8dfee-452">Además, es difícil ver los elementos reflejados en la parte inferior de tetera.</span><span class="sxs-lookup"><span data-stu-id="8dfee-452">Also, it is difficult to see the items reflected in the lower part of the teapot.</span></span> <span data-ttu-id="8dfee-453">A la derecha, BasicPhoto ha corregido la inversión de tono y los artículos reflejados son más claramente distinguibles.</span><span class="sxs-lookup"><span data-stu-id="8dfee-453">On the right, BasicPhoto has fixed the tone inversion and the reflected articles are more clearly distinguishable.</span></span>

<span data-ttu-id="8dfee-454">El segundo cambio se realizó para mejorar la reproducción de colores casi negros en impresoras en las que el negro más negro no se encuentra directamente en el eje neutro CIECAM02.</span><span class="sxs-lookup"><span data-stu-id="8dfee-454">The second change was made to improve the reproduction of nearly black colors on printers where the blackest black does not fall directly on the CIECAM02 neutral axis.</span></span> <span data-ttu-id="8dfee-455">En la ilustración 12 siguiente se muestra una imagen convertida en sRGB; se reproduce para una impresora de inyección de tinta RGB mediante SGCK; y se reproducen para la misma impresora mediante BasicPhoto.</span><span class="sxs-lookup"><span data-stu-id="8dfee-455">The following Figure 12 shows an image converted to sRGB; reproduced for an RGB inkjet printer using SGCK; and reproduced for the same printer using BasicPhoto.</span></span> <span data-ttu-id="8dfee-456">La imagen en el centro no está usando el dispositivo completo en negro, por lo que no tiene el contraste que se ha encontrado en el original.</span><span class="sxs-lookup"><span data-stu-id="8dfee-456">The image in the center is not using the full device black, and so it lacks the contrast seen in the original.</span></span> <span data-ttu-id="8dfee-457">El contraste se restaura con BasicPhoto.</span><span class="sxs-lookup"><span data-stu-id="8dfee-457">The contrast is restored with BasicPhoto.</span></span>

![Muestra la imagen original de un playset.](images/playstructure.jpg)![Muestra la imagen del PLAYSET reproducido para una impresora de inyección de tinta de R G B con SGCK.](images/playstructurebad.jpg)![Muestra la imagen del PLAYSET reproducido para una impresora de inyección de tinta de R G B con BasicPhoto.](images/betterplaystructure.jpg)

<span data-ttu-id="8dfee-461">**Figura 12** : negro mejorado</span><span class="sxs-lookup"><span data-stu-id="8dfee-461">**Figure 12** : Enhanced black</span></span>

<span data-ttu-id="8dfee-462">El tercer cambio se realizó para mejorar la reproducción de color de las cámaras digitales.</span><span class="sxs-lookup"><span data-stu-id="8dfee-462">The third change was made to improve the color reproduction for digital cameras.</span></span> <span data-ttu-id="8dfee-463">En particular, en los casos en los que se ha generado un perfiles de la cámara digital mediante un destino de referencia, una descripción de límite de gama creada a partir de colores medidos podría no incluir todos los colores que podrían capturarse en una escena real.</span><span class="sxs-lookup"><span data-stu-id="8dfee-463">Particularly in cases where the digital camera has been profiled using a reference target, a gamut boundary description built from measured colors might not include all the colors that might be captured in a real world scene.</span></span> <span data-ttu-id="8dfee-464">En lugar de recortar todos los colores a la gama del objetivo de color medido, permite que la extrapolación genere un límite de gama plausible.</span><span class="sxs-lookup"><span data-stu-id="8dfee-464">Rather than clipping all colors to the gamut of the measured color target, you allow for extrapolation to produce a plausible gamut boundary.</span></span> <span data-ttu-id="8dfee-465">El algoritmo BasicPhoto está diseñado para admitir este tipo de límite de gama extrapolada.</span><span class="sxs-lookup"><span data-stu-id="8dfee-465">The BasicPhoto algorithm is designed to support such an extrapolated gamut boundary.</span></span>

<span data-ttu-id="8dfee-466">El cuarto cambio se realizó porque CIECAM02 funciona bien para la asignación de gamas.</span><span class="sxs-lookup"><span data-stu-id="8dfee-466">The fourth change was made because CIECAM02 works well for gamut mapping.</span></span> <span data-ttu-id="8dfee-467">El proceso recomendado por TC8-03 de convertir los colores del dispositivo en D65 en 400 cd/m2 y, a continuación, usar el espacio de colores de RIT IPT es el que consume mucho tiempo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-467">The process recommended by TC8-03 of converting device colors to D65 at 400 cd/m2, and then using the RIT IPT color space is both computation-intensive and time-consuming.</span></span>

### <a name="hue-mapping"></a><span data-ttu-id="8dfee-468">Asignación de matiz</span><span class="sxs-lookup"><span data-stu-id="8dfee-468">Hue mapping</span></span>

<span data-ttu-id="8dfee-469">HueMap es el equivalente de la intención de saturación de ICC.</span><span class="sxs-lookup"><span data-stu-id="8dfee-469">HueMap is the equivalent of the ICC Saturation intent.</span></span>

<span data-ttu-id="8dfee-470">Si el límite de la gama de origen o el límite de la gama de destino no contiene los primarios, este modelo se revierte al modelo picado (relativo) descrito en la sección anterior; por ejemplo, los dispositivos para los que no se pueden determinar los primarios (perfiles ICC con más de cuatro canales) o los perfiles ICC monocromo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-470">If either the source gamut boundary or the destination gamut boundary does not contain primaries, this model reverts to the MinCD (relative) model described in a preceding section; for example, devices for which the primaries cannot be determined (ICC profiles with more than four channels) or monochrome ICC profiles.</span></span>

<span data-ttu-id="8dfee-471">Este algoritmo ajusta primero el matiz del valor del color de entrada.</span><span class="sxs-lookup"><span data-stu-id="8dfee-471">This algorithm first adjusts the hue of the input color value.</span></span> <span data-ttu-id="8dfee-472">A continuación, ajusta simultáneamente la luminosidad y croma mediante una asignación de recorte.</span><span class="sxs-lookup"><span data-stu-id="8dfee-472">Then it simultaneously adjusts the lightness and chroma, using a shearing mapping.</span></span> <span data-ttu-id="8dfee-473">Por último, recorta el valor de color para asegurarse de que está dentro de la gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-473">Finally, it clips color value to make sure it is within gamut.</span></span>

<span data-ttu-id="8dfee-474">El primer paso es determinar las "ruedas de matiz".</span><span class="sxs-lookup"><span data-stu-id="8dfee-474">The first step is to determine the "Hue Wheels."</span></span> <span data-ttu-id="8dfee-475">Busque los valores de JCh para los colores primario y secundario para el dispositivo de origen y de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-475">Find the JCh values for primary and secondary colors for both source and destination device.</span></span> <span data-ttu-id="8dfee-476">Solo está pensando en los componentes de matiz.</span><span class="sxs-lookup"><span data-stu-id="8dfee-476">You are only considering the hue components.</span></span> <span data-ttu-id="8dfee-477">Esto da como resultado una rueda de matiz principal o secundaria con seis puntos de color para cada dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-477">This results in a primary or secondary hue wheel with six color points for each device.</span></span> <span data-ttu-id="8dfee-478">(Consulte la figura 13).</span><span class="sxs-lookup"><span data-stu-id="8dfee-478">(See Figure 13.)</span></span>

![Diagrama que muestra las ruedas de matiz con seis puntos de color.](images/gmmp-figure12.png)

<span data-ttu-id="8dfee-480">**Figura 13** : ruedas de matiz</span><span class="sxs-lookup"><span data-stu-id="8dfee-480">**Figure 13** : Hue wheels</span></span>

<span data-ttu-id="8dfee-481">Se pueden obtener mejores resultados si el principal azul de origen no se gira a la principal azul de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-481">Better results can be obtained if the source blue primary is not rotated to the destination blue primary.</span></span> <span data-ttu-id="8dfee-482">En su lugar, se usa el ángulo de matiz principal azul de origen como el ángulo de matiz principal azul de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-482">Instead, the source blue primary hue angle is used as the destination blue primary hue angle.</span></span>

<span data-ttu-id="8dfee-483">A continuación, realice las rotaciones de matiz para cada color de entrada de la imagen de origen.</span><span class="sxs-lookup"><span data-stu-id="8dfee-483">Next, perform the hue rotations for each input color from the source image,</span></span>

<span data-ttu-id="8dfee-484">a) usar el ángulo de matiz del color de entrada, determine la ubicación del color en la rueda de matiz de origen en relación con los dos colores primarios o secundarios adyacentes.</span><span class="sxs-lookup"><span data-stu-id="8dfee-484">a)Using the hue angle of the input color, determine the location of the color on the source hue wheel relative to the two adjacent primary or secondary color.</span></span> <span data-ttu-id="8dfee-485">La ubicación se puede considerar como un porcentaje de la distancia entre las principales.</span><span class="sxs-lookup"><span data-stu-id="8dfee-485">The location can be thought of as a percentage of the distance between the primaries.</span></span> <span data-ttu-id="8dfee-486">Por ejemplo, el matiz del color de entrada es 40 por ciento de la forma del valor de matiz de magenta al valor de matiz de rojo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-486">For example, the input color hue is 40 percent of the way from the hue value of Magenta to the hue value of Red.</span></span>

<span data-ttu-id="8dfee-487">b) en la rueda de matiz de destino, busque el ángulo de matiz asociado, por ejemplo, 40 por ciento de fucsia a rojo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-487">b)On the destination hue wheel, find the associated hue angle, for example, 40 percent from Magenta to Red.</span></span> <span data-ttu-id="8dfee-488">Este valor será el ángulo de matiz de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-488">This value will be the destination hue angle.</span></span>

<span data-ttu-id="8dfee-489">En general, las principales y secundarias de origen no estarán en los mismos ángulos de matiz que las principales y secundarias de destino. es decir, el ángulo de matiz de destino normalmente será diferente del ángulo de matiz de origen.</span><span class="sxs-lookup"><span data-stu-id="8dfee-489">In general, the source primaries and secondaries will not be at the same hue angles as the destination primaries and secondaries; that is, the destination hue angle usually will be different from the source hue angle.</span></span>

<span data-ttu-id="8dfee-490">Por ejemplo, suponga que las ruedas de matiz producen los valores siguientes:</span><span class="sxs-lookup"><span data-stu-id="8dfee-490">For example, suppose the hue wheels produce the following values:</span></span>

<span data-ttu-id="8dfee-491">Origen M = 295 grados, R de origen = 355 grados.</span><span class="sxs-lookup"><span data-stu-id="8dfee-491">Source M = 295 degrees, Source R = 355 degrees.</span></span>

<span data-ttu-id="8dfee-492">Destino M = 290 grados, destino R = 346 grados.</span><span class="sxs-lookup"><span data-stu-id="8dfee-492">Destination M = 290 degrees, Destination R = 346 degrees.</span></span>

<span data-ttu-id="8dfee-493">Si el ángulo de matiz del color de entrada es de 319 grados, es 40 por ciento del ángulo (24 grados) del origen M al origen R. El ángulo de M a R es 60 grados y el ángulo de M a matiz de entrada es de 24 grados.</span><span class="sxs-lookup"><span data-stu-id="8dfee-493">If the hue angle of the input color is 319 degrees, it is 40 percent of the angle (24 degrees) from source M to source R. The angle from M to R is 60 degrees, and the angle from M to input hue is 24 degrees.</span></span> <span data-ttu-id="8dfee-494">Calcule el ángulo del destino que es 40 por ciento del destino M al destino R (22 grados), por lo que el ángulo de matiz del color de destino es de 312 grados.</span><span class="sxs-lookup"><span data-stu-id="8dfee-494">Calculate the angle on the destination that is 40 percent from destination M to destination R (22 degrees), so the hue angle of the destination color is 312 degrees.</span></span>

<span data-ttu-id="8dfee-495">A continuación, calcule los puntos de referencia de matiz para el matiz de origen y el matiz de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-495">Next, calculate the hue reference points for the source hue and the destination hue.</span></span> <span data-ttu-id="8dfee-496">Para calcular el punto de referencia de matiz para un valor de h (matiz) determinado, desea buscar el valor de J (luminosidad) y el valor de C (croma).</span><span class="sxs-lookup"><span data-stu-id="8dfee-496">To calculate the hue reference point for a particular h (hue) value, you want to find the J (lightness) value and C (chroma) value.</span></span>

-   <span data-ttu-id="8dfee-497">Busque el valor J del punto de referencia Hue mediante la interpolación entre los valores J de los puntos primarios o secundarios adyacentes, utilizando la posición relativa del matiz; por ejemplo, 40 por ciento en este ejemplo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-497">Find the J value of the hue reference point by interpolating between the J values for the adjacent primary or secondary points, using the relative position of the hue; for example, 40 percent in this example.</span></span>
-   <span data-ttu-id="8dfee-498">Busque el valor de C máximo en este valor J y el valor h.</span><span class="sxs-lookup"><span data-stu-id="8dfee-498">Find the maximum C value at this J value and h value.</span></span> <span data-ttu-id="8dfee-499">Ahora tiene el JCh del punto de referencia de matiz para ese matiz.</span><span class="sxs-lookup"><span data-stu-id="8dfee-499">You now have the JCh of the hue reference point for that hue.</span></span>

![Diagrama que muestra una hoja de matiz.](images/gmmp-figure13.png)

<span data-ttu-id="8dfee-501">**Figura 14** : una hoja de matiz (visualización de un segmento de límite de gama en un matiz específico)</span><span class="sxs-lookup"><span data-stu-id="8dfee-501">**Figure 14** : A hue leaf (visualization of a gamut boundary slice at a specific hue)</span></span>

<span data-ttu-id="8dfee-502">El siguiente paso consiste en calcular la asignación de recorte para cada píxel.</span><span class="sxs-lookup"><span data-stu-id="8dfee-502">The next step is to compute the shear mapping for each pixel.</span></span> <span data-ttu-id="8dfee-503">En primer lugar, visualice una hoja de matiz de la gama de origen para el ángulo de matiz del color de origen y una hoja de matiz de la gama de destino para el ángulo de matiz de destino calculado durante la rotación del matiz.</span><span class="sxs-lookup"><span data-stu-id="8dfee-503">First, visualize a hue leaf from the source gamut for the source color hue angle, and a hue leaf from the destination gamut for the destination hue angle computed during hue rotation.</span></span> <span data-ttu-id="8dfee-504">Las hojas de matiz se crean tomando un "segmento" de la superficie del límite de la gama JCh en un ángulo de matiz específico (consulte la figura 14).</span><span class="sxs-lookup"><span data-stu-id="8dfee-504">The hue leaves are created by taking a "slice" from the JCh gamut boundary surface at a specific hue angle (see Figure 14).</span></span>

<span data-ttu-id="8dfee-505">Nota: por motivos de optimización del rendimiento, no se crean realmente las hojas de matices. se describen y se muestran aquí solo con fines de visualización.</span><span class="sxs-lookup"><span data-stu-id="8dfee-505">NOTE: For performance optimization reasons, hue leaves are not actually created; they are described and shown here for visualization purposes only.</span></span> <span data-ttu-id="8dfee-506">Las operaciones se realizan directamente en la superficie del límite de la gama en el matiz especificado.</span><span class="sxs-lookup"><span data-stu-id="8dfee-506">The operations are performed directly on the gamut boundary surface at the specified hue.</span></span> <span data-ttu-id="8dfee-507">A continuación, calcula los puntos de referencia de matiz para determinar la asignación de recorte.</span><span class="sxs-lookup"><span data-stu-id="8dfee-507">You then compute the hue reference points to determine the shear mapping.</span></span>

-   <span data-ttu-id="8dfee-508">Realice un cambio de escala de luminosidad para asignar los puntos negros y blancos de la hoja de origen a la hoja de destino (vea la figura 15).</span><span class="sxs-lookup"><span data-stu-id="8dfee-508">Perform a lightness rescaling to map the black and white points of the source leaf to the destination leaf (see Figure 15).</span></span> <span data-ttu-id="8dfee-509">Los puntos negros y blancos de la hoja matiz de origen se asignan linealmente a los puntos blanco y negro de la hoja matiz de destino, mediante el escalado de todas las coordenadas J del límite de origen.</span><span class="sxs-lookup"><span data-stu-id="8dfee-509">The black and white points of the source hue leaf are mapped linearly to the black and white points of the destination hue leaf, by scaling all the J coordinates of the source boundary.</span></span> <span data-ttu-id="8dfee-510">El valor del color de entrada asignado al matiz se escala de la misma manera.</span><span class="sxs-lookup"><span data-stu-id="8dfee-510">The hue-mapped input color value is scaled in the same manner.</span></span>

![Diagrama que muestra la asignación de luminosidad.](images/gmmp-figure14.png)

<span data-ttu-id="8dfee-512">**Figura 15** : asignación de luminosidad</span><span class="sxs-lookup"><span data-stu-id="8dfee-512">**Figure 15** : Lightness mapping</span></span>

-   <span data-ttu-id="8dfee-513">Determine los puntos de referencia de matiz para cada hoja de matiz.</span><span class="sxs-lookup"><span data-stu-id="8dfee-513">Determine the hue reference points for each hue leaf.</span></span> <span data-ttu-id="8dfee-514">Aplique una asignación de recorte a la hoja de origen para que los puntos de referencia de origen y destino coincidan (vea la figura 16).</span><span class="sxs-lookup"><span data-stu-id="8dfee-514">Apply a shear mapping to the source leaf so that the source and destination reference points coincide (see Figure 16).</span></span> <span data-ttu-id="8dfee-515">El punto de referencia de una gama en un matiz específico es el punto de referencia de matiz interpolado entre las principales adyacentes.</span><span class="sxs-lookup"><span data-stu-id="8dfee-515">The reference point for a gamut at a specific hue is the interpolated hue reference point between the adjacent primaries.</span></span> <span data-ttu-id="8dfee-516">El punto de referencia de la hoja de matiz de origen se asigna linealmente al punto de referencia de la hoja de matiz de destino, mediante una operación de "recorte" que bloquea el eje J, manteniendo los puntos negros y los puntos blancos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-516">The reference point of the source hue leaf is mapped linearly to the reference point of the destination hue leaf, using a "shear" operation that locks the J axis, keeping the black points and the white points stationary.</span></span> <span data-ttu-id="8dfee-517">Los puntos negros, los puntos blancos y los puntos de referencia de las hojas de matiz de origen y de destino deben coincidir.</span><span class="sxs-lookup"><span data-stu-id="8dfee-517">The black points, white points, and reference points of the source and destination hue leaves should coincide.</span></span>
-   <span data-ttu-id="8dfee-518">Aplique la asignación de recorte al valor del color de entrada con ajuste de luminosidad.</span><span class="sxs-lookup"><span data-stu-id="8dfee-518">Apply the shear mapping to the lightness-adjusted input color value.</span></span> <span data-ttu-id="8dfee-519">Las coordenadas J y C del valor de color de origen se escalan proporcionalmente, con respecto a su distancia desde el eje J.</span><span class="sxs-lookup"><span data-stu-id="8dfee-519">The J and C coordinates of the source color value are proportionally scaled, relative to its distance from the J axis.</span></span>
-   <span data-ttu-id="8dfee-520">A continuación, se realiza una compresión sutil de luminosidad dependiente de croma hacia el valor J del punto de referencia de matiz en el punto de color asignado a distorsión.</span><span class="sxs-lookup"><span data-stu-id="8dfee-520">Next, a subtle chroma-dependent lightness compression toward the J-value of the hue reference point is performed on the shear-mapped color point.</span></span> <span data-ttu-id="8dfee-521">La compresión para la referencia de matiz J se realiza de forma gamma, en la que la referencia de matiz J no se ve afectada.</span><span class="sxs-lookup"><span data-stu-id="8dfee-521">The compression toward hue reference J is done in a gamma-like fashion, where white, black, grays, and points on the hue reference J are not affected.</span></span> <span data-ttu-id="8dfee-522">Todos los demás puntos tienden a la referencia de matiz J de un modo suave, lo que se aproxima ligeramente a la referencia de matiz J, con la constante de croma restante.</span><span class="sxs-lookup"><span data-stu-id="8dfee-522">All other points tend toward the hue reference J in a smooth fashion, slightly bunching up near the hue reference J, with chroma remaining constant.</span></span> <span data-ttu-id="8dfee-523">La dependencia de croma garantiza que los colores neutros no se ven afectados y el efecto se incrementa en los colores con intensidad de color superior.</span><span class="sxs-lookup"><span data-stu-id="8dfee-523">The chroma dependency assures that neutral colors are not affected, and the effect is increased on colors with higher chroma.</span></span>

<span data-ttu-id="8dfee-524">A continuación se describe una descripción matemática de la compresión de luminosidad hacia la referencia de matiz J o el ajuste del valor J del punto de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-524">The following is a mathematical description of the lightness compression toward the hue reference J, or adjusting the J-value of the destination point.</span></span> <span data-ttu-id="8dfee-525">Se denomina punto de destino porque se ha recortado en la gama de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-525">It is called the destination point because it has been shear mapped into the destination gamut.</span></span>

<span data-ttu-id="8dfee-526">En primer lugar, Compute "factorC" (factor de dependencia de croma) para el punto de destino, que determina cuánto efecto tendrá la compresión de luminosidad.</span><span class="sxs-lookup"><span data-stu-id="8dfee-526">First, compute "factorC" (chroma dependency factor) for the destination point, which determines how much effect the lightness compression will have.</span></span> <span data-ttu-id="8dfee-527">Los puntos cercanos o en el eje J tendrán poca o ninguna compresión; los puntos más alejados del eje J (alta intensidad) tendrán más compresión aplicada.</span><span class="sxs-lookup"><span data-stu-id="8dfee-527">Points near or on the J-axis will have little or no compression; points farther away from the J-axis (high-chroma) will have more compression applied.</span></span> <span data-ttu-id="8dfee-528">Multiplique por 0,5 para asegurarse de que factorC es menor que 1, ya que es posible que sourceC pueda ser ligeramente mayor que referenceC, pero no dos veces más grande.</span><span class="sxs-lookup"><span data-stu-id="8dfee-528">Multiply by 0.5 to ensure that factorC is less than 1, because it is possible that sourceC could be slightly greater than referenceC, but not twice as great.</span></span>

<span data-ttu-id="8dfee-529">factorC = (destinationC/referenceC)?</span><span class="sxs-lookup"><span data-stu-id="8dfee-529">factorC = (destinationC / referenceC) ?</span></span> <span data-ttu-id="8dfee-530">0,5</span><span class="sxs-lookup"><span data-stu-id="8dfee-530">0.5</span></span>

<span data-ttu-id="8dfee-531">donde:</span><span class="sxs-lookup"><span data-stu-id="8dfee-531">where:</span></span>

<span data-ttu-id="8dfee-532">destinationC es el valor de C del punto de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-532">destinationC is the C-value of the destination point.</span></span>

<span data-ttu-id="8dfee-533">referenceC es el valor de C del punto de referencia de matiz.</span><span class="sxs-lookup"><span data-stu-id="8dfee-533">referenceC is the C-value of the Hue Reference point.</span></span>

<span data-ttu-id="8dfee-534">A continuación, determine si el punto de destino J está por encima o por debajo de la referencia de matiz J. Si es anterior, haga lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="8dfee-534">Next, determine whether the destination point J is above or below the hue reference J. If it is above, do the following:</span></span>

1.  <span data-ttu-id="8dfee-535">Compute "factorJ" para el punto de destino relativo a referenceJ.</span><span class="sxs-lookup"><span data-stu-id="8dfee-535">Compute "factorJ" for the destination point relative to the referenceJ.</span></span> <span data-ttu-id="8dfee-536">Este valor factorJ estará entre 0 y 1 (0 si está en referenceJ; 1 si está en maxJ).</span><span class="sxs-lookup"><span data-stu-id="8dfee-536">This factorJ value will be between 0 and 1 (0 if on the referenceJ; 1 if at maxJ).</span></span>
2.  <span data-ttu-id="8dfee-537">factorJ = (destinationJ-referenceJ)/(maxJ-referenceJ)</span><span class="sxs-lookup"><span data-stu-id="8dfee-537">factorJ = (destinationJ - referenceJ) / (maxJ - referenceJ)</span></span>

    <span data-ttu-id="8dfee-538">donde:</span><span class="sxs-lookup"><span data-stu-id="8dfee-538">where:</span></span>

    <span data-ttu-id="8dfee-539">destinationJ es el valor J del punto de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-539">destinationJ is the J-value of the destination point.</span></span>

    <span data-ttu-id="8dfee-540">referenceJ es el valor J del punto de referencia de matiz.</span><span class="sxs-lookup"><span data-stu-id="8dfee-540">referenceJ is the J-value of the hue reference point.</span></span>

    <span data-ttu-id="8dfee-541">maxJ es el valor J máximo de la gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-541">maxJ is the maximum J-value of the gamut.</span></span>

3.  <span data-ttu-id="8dfee-542">Aplique una función de potencia de tipo gamma a factorJ, lo que reducirá el valor de factorJ en una cantidad determinada.</span><span class="sxs-lookup"><span data-stu-id="8dfee-542">Apply a gamma-like power function to factorJ, which will reduce factorJ by a certain amount.</span></span> <span data-ttu-id="8dfee-543">En este ejemplo se usa la potencia de 2 (el cuadrado).</span><span class="sxs-lookup"><span data-stu-id="8dfee-543">This example uses the power of 2 (the square).</span></span> <span data-ttu-id="8dfee-544">Reste el factorJ reducido de la factorJ original y multiplique el resultado por el total de J-intervalo por encima del referenceJ principal para encontrar el "deltaJ", que representa el cambio en J después de la compresión de luminosidad, pero sin incluir la dependencia de croma.</span><span class="sxs-lookup"><span data-stu-id="8dfee-544">Subtract the reduced factorJ from the original factorJ and multiply the result by the total J-range above the primary referenceJ to find the "deltaJ," which represents the change in J after the lightness compression, but not including the chroma dependency.</span></span>
4.  <span data-ttu-id="8dfee-545">deltaJ = (factorJ-(factorJ?</span><span class="sxs-lookup"><span data-stu-id="8dfee-545">deltaJ = (factorJ - (factorJ ?</span></span> <span data-ttu-id="8dfee-546">factorJ)) ?</span><span class="sxs-lookup"><span data-stu-id="8dfee-546">factorJ)) ?</span></span> <span data-ttu-id="8dfee-547">(maxJ - referenceJ)</span><span class="sxs-lookup"><span data-stu-id="8dfee-547">(maxJ - referenceJ)</span></span>

5.  <span data-ttu-id="8dfee-548">Aplique factorC a deltaJ (cuanto mayor sea el croma, mayor será el efecto) y calcule el nuevo valor J para el punto de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-548">Apply factorC to the deltaJ (the higher the chroma, the greater the effect), and compute the new J-value for the destination point.</span></span>
6.  <span data-ttu-id="8dfee-549">destinationJ = destinationJ-(deltaJ?</span><span class="sxs-lookup"><span data-stu-id="8dfee-549">destinationJ = destinationJ - (deltaJ ?</span></span> <span data-ttu-id="8dfee-550">factorC)</span><span class="sxs-lookup"><span data-stu-id="8dfee-550">factorC)</span></span>

<span data-ttu-id="8dfee-551">Si el valor J del punto de destino es inferior a referenceJ, se realiza un cálculo similar en los pasos anteriores a-C, utilizando minJ en lugar de maxJ para encontrar el intervalo en J para calcular el factorJ, y teniendo en cuenta la polaridad de las operaciones "debajo" de la referenceJ.</span><span class="sxs-lookup"><span data-stu-id="8dfee-551">If J-value for the destination point is below referenceJ, then a similar computation to the preceding steps A-C is performed, using minJ instead of maxJ to find the range in J to compute the factorJ, and taking into account the polarity of the operations "underneath" the referenceJ.</span></span>

<span data-ttu-id="8dfee-552">factorJ = (referenceJ-destinationJ)/(referenceJ-minJ)</span><span class="sxs-lookup"><span data-stu-id="8dfee-552">factorJ = (referenceJ - destinationJ) / (referenceJ - minJ)</span></span>

<span data-ttu-id="8dfee-553">deltaJ = (factorJ-(factorJ?</span><span class="sxs-lookup"><span data-stu-id="8dfee-553">deltaJ = (factorJ - (factorJ ?</span></span> <span data-ttu-id="8dfee-554">factorJ)) ?</span><span class="sxs-lookup"><span data-stu-id="8dfee-554">factorJ)) ?</span></span> <span data-ttu-id="8dfee-555">(referenceJ - minJ)</span><span class="sxs-lookup"><span data-stu-id="8dfee-555">(referenceJ - minJ)</span></span>

<span data-ttu-id="8dfee-556">destinationJ = destinationJ + (deltaJ?</span><span class="sxs-lookup"><span data-stu-id="8dfee-556">destinationJ = destinationJ + (deltaJ ?</span></span> <span data-ttu-id="8dfee-557">factorC)</span><span class="sxs-lookup"><span data-stu-id="8dfee-557">factorC)</span></span>

<span data-ttu-id="8dfee-558">donde:</span><span class="sxs-lookup"><span data-stu-id="8dfee-558">where:</span></span>

<span data-ttu-id="8dfee-559">minJ es el valor J mínimo de la gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-559">minJ is the minimum J-value of the gamut.</span></span>

<span data-ttu-id="8dfee-560">La intensidad de los puntos de color de entrada se expande linealmente (cuando es posible) a lo largo de la luminosidad constante proporcional al valor de croma máximo de las gamas de origen y de destino en ese matiz y luminosidad.</span><span class="sxs-lookup"><span data-stu-id="8dfee-560">The chroma for input color points is expanded linearly (when possible) along constant lightness proportional to the maximum chroma value of the source and destination gamuts at that hue and lightness.</span></span> <span data-ttu-id="8dfee-561">Combinado con la compresión de luminosidad dependiente del cromada anterior, esto ayuda a preservar la saturación, ya que la asignación de recorte mediante los puntos de referencia a veces hace que el punto de origen supere la compresión en croma (vea la figura 16).</span><span class="sxs-lookup"><span data-stu-id="8dfee-561">Combined with the preceding chroma-dependent lightness compression, this helps preserve the saturation because shear mapping using the reference points sometimes causes the source point to over-compress in chroma (see Figure 16).</span></span>

![Diagrama que muestra la asignación de recorte para coincidir con los puntos de referencia de matiz, antes del recorte a la izquierda, después de distorsionar a la derecha.](images/gmmp-shearmapping.png)

<span data-ttu-id="8dfee-563">**Figura 16** : asignación de recorte, compresión de luminosidad hacia la referencia de matiz J y expansión de croma</span><span class="sxs-lookup"><span data-stu-id="8dfee-563">**Figure 16** : Shear mapping, lightness compression toward hue reference J, and chroma expansion</span></span>

<span data-ttu-id="8dfee-564">A continuación se describe una descripción matemática del proceso de expansión de croma o el ajuste del valor de C del punto de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-564">The following is a mathematical description of the chroma expansion process, or adjusting the C-value of the destination point.</span></span> <span data-ttu-id="8dfee-565">Se denomina punto de destino porque se ha distorsionado el mapa y la luminosidad comprimidos en la gama de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-565">It is called the destination point because it has been shear mapped and lightness compressed into the destination gamut.</span></span>

1.  <span data-ttu-id="8dfee-566">Antes de la asignación de recorte, determine sourceExtentC (la extensión de croma en la luminosidad y el matiz del punto de origen).</span><span class="sxs-lookup"><span data-stu-id="8dfee-566">Before the shear mapping, determine sourceExtentC (the chroma extent at the lightness and hue of the source point).</span></span>
2.  <span data-ttu-id="8dfee-567">Después de la compresión de sesgo y de la asignación de recorte que transforma el punto de origen en el punto de destino, determine el destExtentC (la extensión de croma en la luminosidad y el matiz del punto de destino).</span><span class="sxs-lookup"><span data-stu-id="8dfee-567">After the shear mapping and lightness compression which transforms the source point into the destination point, determine the destExtentC (the chroma extent at the lightness and hue of the destination point).</span></span>
3.  <span data-ttu-id="8dfee-568">Si el sourceExtentC es mayor que destExtentC, no es necesario realizar ningún ajuste de croma en el punto de destino y puede omitir el paso siguiente.</span><span class="sxs-lookup"><span data-stu-id="8dfee-568">If the sourceExtentC is greater than the destExtentC, no chroma adjustment to the destination point is necessary, and you can skip the next step.</span></span>
4.  <span data-ttu-id="8dfee-569">Ajuste destinationC (intensidad del punto de destino) para que quepa en la extensión de croma de destino en esta luminosidad y matiz.</span><span class="sxs-lookup"><span data-stu-id="8dfee-569">Adjust destinationC (the chroma of the destination point) to fit within the destination chroma extent at this lightness and hue.</span></span>
5.  <span data-ttu-id="8dfee-570">destinationC = destinationC?</span><span class="sxs-lookup"><span data-stu-id="8dfee-570">destinationC = destinationC ?</span></span> <span data-ttu-id="8dfee-571">(destExtentC / sourceExtentC)</span><span class="sxs-lookup"><span data-stu-id="8dfee-571">(destExtentC / sourceExtentC)</span></span>

    <span data-ttu-id="8dfee-572">donde:</span><span class="sxs-lookup"><span data-stu-id="8dfee-572">where:</span></span>

    <span data-ttu-id="8dfee-573">destinationC es el valor de C del punto de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-573">destinationC is the destination point C-value.</span></span>

    <span data-ttu-id="8dfee-574">sourceExtentC es el valor máximo de C de la gama de origen en la luminosidad y el matiz del punto de origen.</span><span class="sxs-lookup"><span data-stu-id="8dfee-574">sourceExtentC is the maximum C-value of the source gamut at the lightness and hue of the source point.</span></span>

    <span data-ttu-id="8dfee-575">destExtentC es el valor de C máximo de la gama de destino en la luminosidad y el matiz del punto de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-575">destExtentC is the maximum C-value of the destination gamut at the lightness and hue of the destination point.</span></span>

<span data-ttu-id="8dfee-576">Por último, realice el recorte de distancia mínimo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-576">Finally, perform the mimimum distance clipping.</span></span> <span data-ttu-id="8dfee-577">Si el color de entrada con rotación de matiz, ajuste de luminosidad y asignado a distorsión está todavía ligeramente fuera de la gama de destino, recorte (muévalo) al punto más cercano del límite de la gama de destino (consulte la figura 17).</span><span class="sxs-lookup"><span data-stu-id="8dfee-577">If the hue-rotated, lightness-adjusted, and shear-mapped input color is still slightly outside the destination gamut, clip it (move it) to the closest point on the destination gamut boundary (see Figure 17).</span></span>

![Diagrama que muestra el recorte de distancia mínimo.](images/gmmp-figure15.png)

<span data-ttu-id="8dfee-579">**Figura 17** : recorte de distancia mínimo</span><span class="sxs-lookup"><span data-stu-id="8dfee-579">**Figure 17** : Minimum distance clipping</span></span>

## <a name="gamut-boundary-description-and-gamut-shell-algorithms"></a><span data-ttu-id="8dfee-580">Descripción de los límites de gama y algoritmos de Shell de gama</span><span class="sxs-lookup"><span data-stu-id="8dfee-580">Gamut Boundary Description and Gamut Shell Algorithms</span></span>

<span data-ttu-id="8dfee-581">La función de límite de gama de dispositivos usa el motor de modelo de dispositivo y los parámetros analíticos para derivar un límite de gama de dispositivos de color, que se describe como una lista de vértices indexados del casco de la gama de dispositivos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-581">The device gamut boundary function uses the device model engine and analytical parameters to derive a color device gamut boundary, described as an indexed vertex list of the hull of the device gamut.</span></span> <span data-ttu-id="8dfee-582">El casco se calcula de forma diferente en función de si está trabajando con dispositivos aditivos, como monitores y proyectores, o dispositivos de sustracción.</span><span class="sxs-lookup"><span data-stu-id="8dfee-582">The hull is computed differently depending on whether you are working with additive devices, such as monitors and projectors, or subtractive devices.</span></span> <span data-ttu-id="8dfee-583">La lista de vértices indizada se almacena en CIEJab.</span><span class="sxs-lookup"><span data-stu-id="8dfee-583">The indexed vertex list is stored in CIEJab.</span></span> <span data-ttu-id="8dfee-584">La estructura de la lista de vértices indizada está optimizada para la aceleración de hardware de DirectX.</span><span class="sxs-lookup"><span data-stu-id="8dfee-584">The structure of the indexed vertex list is optimized for hardware acceleration by DirectX.</span></span>

<span data-ttu-id="8dfee-585">Este enfoque tiene muchas soluciones conocidas.</span><span class="sxs-lookup"><span data-stu-id="8dfee-585">This approach has many well-known solutions.</span></span> <span data-ttu-id="8dfee-586">Si busca "DirectX de casco convexo" en la web, obtendrá más de 100 aciertos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-586">If you search for "convex hull DirectX" on the Web, you get more than 100 hits.</span></span> <span data-ttu-id="8dfee-587">Por ejemplo, hay una referencia de 1983 en este tema específico (teoría y aplicación de los gráficos del equipo, "Shiphulls, las superficies de la spline b y CADCAM 34-49", con referencias de 1970 a 1982 en el tema.</span><span class="sxs-lookup"><span data-stu-id="8dfee-587">For example, there is a reference from 1983 on this specific topic (Computer Graphics Theory and Application, "Shiphulls, b-spline surfaces, and cadcam," pp. 34-49) with references dating from 1970 to 1982 on the topic.</span></span>

<span data-ttu-id="8dfee-588">La colección de puntos se puede determinar a partir de información disponible externamente, como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="8dfee-588">The collection of points can be determined from externally available information, as follows:</span></span>

-   <span data-ttu-id="8dfee-589">Los puntos del shell de referencia para los monitores se generan mediante un muestreo del cubo de color en el espacio de dispositivo Colorant.</span><span class="sxs-lookup"><span data-stu-id="8dfee-589">Points for the reference shell for monitors are generated using a sampling of the color cube in device colorant space.</span></span>
-   <span data-ttu-id="8dfee-590">Los puntos del shell de referencia para impresoras y dispositivos de captura se obtienen de los datos de ejemplo que se usan para inicializar el modelo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-590">Points for the reference shell for printers and capture devices are obtained from the sample data used to initialize the model.</span></span>
-   <span data-ttu-id="8dfee-591">Los puntos del shell de referencia para scRGB y sRGB se generan mediante un muestreo del cubo de color para sRGB.</span><span class="sxs-lookup"><span data-stu-id="8dfee-591">Points for the reference shell for scRGB and sRGB are generated using a sampling of the color cube for sRGB.</span></span>
-   <span data-ttu-id="8dfee-592">Los puntos para el shell de plausible para dispositivos de captura se generan mediante un muestreo del cubo de color en el espacio de dispositivo Colorant.</span><span class="sxs-lookup"><span data-stu-id="8dfee-592">Points for the plausible shell for capture devices are generated using a sampling of the color cube in device colorant space.</span></span>
-   <span data-ttu-id="8dfee-593">Los puntos del shell de referencia para los proyectores se generan mediante un muestreo de un polyhedron en el cubo de color en el espacio de dispositivo Colorant.</span><span class="sxs-lookup"><span data-stu-id="8dfee-593">Points for the reference shell for projectors are generated using a sampling of a polyhedron in the color cube in device colorant space.</span></span>
-   <span data-ttu-id="8dfee-594">Los puntos del posible Shell para los espacios de colores de rango dinámico anchos se generan mediante un muestreo del cubo de color en el propio espacio.</span><span class="sxs-lookup"><span data-stu-id="8dfee-594">Points for the possible shell for wide dynamic range color spaces are generated using a sampling of the color cube in the space itself.</span></span>

<span data-ttu-id="8dfee-595">Puede crear una lista de vértices que describa de forma eficaz la gama de colores del dispositivo, dados un perfil de dispositivo y servicios de soporte del sistema.</span><span class="sxs-lookup"><span data-stu-id="8dfee-595">You can create a vertex list that efficiently describes the color device gamut, given a device profile and system support services.</span></span>

<span data-ttu-id="8dfee-596">En el caso de los dispositivos de salida, el límite de la gama describe el intervalo de colores que puede mostrar el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-596">For output devices, the gamut boundary describes the range of colors that can be displayed by the device.</span></span> <span data-ttu-id="8dfee-597">Un límite de gama se genera a partir de los mismos datos que se usan para modelar el comportamiento del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-597">A gamut boundary is generated from the same data used to model the behavior of the device.</span></span> <span data-ttu-id="8dfee-598">Conceptualmente, se genera un muestreo del intervalo de colores que el dispositivo puede producir, se miden los colores, se convierten las medidas en el espacio de apariencia y, a continuación, se usan los resultados para crear el límite de la gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-598">Conceptually, you output a sampling of the range of colors the device can produce, measure the colors, convert the measurements into appearance space, and then use the results to create the gamut boundary.</span></span>

<span data-ttu-id="8dfee-599">Los dispositivos de entrada son más complicados.</span><span class="sxs-lookup"><span data-stu-id="8dfee-599">Input devices are trickier.</span></span> <span data-ttu-id="8dfee-600">Cada píxel de una imagen de entrada debe tener algún valor.</span><span class="sxs-lookup"><span data-stu-id="8dfee-600">Each pixel in an input image must have some value.</span></span> <span data-ttu-id="8dfee-601">Cada píxel debe ser capaz de representar cualquier color que se encuentre en el mundo real de alguna manera.</span><span class="sxs-lookup"><span data-stu-id="8dfee-601">Each pixel must be able to represent any color found in the real world in some way.</span></span> <span data-ttu-id="8dfee-602">En este sentido, no hay ningún color "fuera de la gama" para un dispositivo de entrada, porque siempre se pueden representar.</span><span class="sxs-lookup"><span data-stu-id="8dfee-602">In this sense, no colors are "out of gamut" for an input device, because they can always be represented.</span></span>

<span data-ttu-id="8dfee-603">Todos los formatos de imagen digital tienen algún intervalo dinámico fijo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-603">All digital image formats have some fixed dynamic range.</span></span> <span data-ttu-id="8dfee-604">Debido a esta limitación, siempre hay algunos estímulos distintos que se asignan al mismo valor digital.</span><span class="sxs-lookup"><span data-stu-id="8dfee-604">Because of this limitation, there is always some distinct stimuli that map to the same digital value.</span></span> <span data-ttu-id="8dfee-605">Por lo tanto, no se puede establecer una asignación de uno a uno entre los colores del mundo real y los valores de cámara digital.</span><span class="sxs-lookup"><span data-stu-id="8dfee-605">So, you cannot establish a one-to-one mapping between real-world colors and digital camera values.</span></span> <span data-ttu-id="8dfee-606">En su lugar, el límite de la gama se forma mediante la estimación de una gama de colores del mundo real que pueden generar las respuestas digitales de la cámara.</span><span class="sxs-lookup"><span data-stu-id="8dfee-606">Instead, the gamut boundary is formed by estimating a range of real-world colors that can produce the digital responses of the camera.</span></span> <span data-ttu-id="8dfee-607">El intervalo Estimado se usa como gama para el dispositivo de entrada.</span><span class="sxs-lookup"><span data-stu-id="8dfee-607">You use that estimated range as the gamut for the input device.</span></span>

<span data-ttu-id="8dfee-608">Se incluyen principales para proporcionar la asignación de gama de tipos de calidad de gráficos empresariales.</span><span class="sxs-lookup"><span data-stu-id="8dfee-608">Primaries are included to provide for business graphics intent-type gamut mapping.</span></span>

<span data-ttu-id="8dfee-609">En un estilo real orientado a objetos, se abstrae la representación subyacente del límite de la gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-609">In true object-oriented style, you abstract the underlying representation of the gamut boundary.</span></span> <span data-ttu-id="8dfee-610">Esto le permite la flexibilidad de cambiar la representación en el futuro.</span><span class="sxs-lookup"><span data-stu-id="8dfee-610">This allows you the flexibility to change the representation in the future.</span></span> <span data-ttu-id="8dfee-611">Para comprender el descriptor de límite de gama (GBD) que se usa en la nueva CTE, primero debe comprender cómo funcionan los algoritmos de asignación de gamas (GMAs).</span><span class="sxs-lookup"><span data-stu-id="8dfee-611">To understand the gamut boundary descriptor (GBD) used in the new CTE, you must first understand how gamut mapping algorithms (GMAs) work.</span></span> <span data-ttu-id="8dfee-612">Tradicionalmente, GMAs se han diseñado para satisfacer las necesidades de la comunidad de arte gráfico; es decir, para reproducir imágenes que ya se han representado correctamente para el dispositivo en el que se creó la imagen de entrada.</span><span class="sxs-lookup"><span data-stu-id="8dfee-612">Traditionally, GMAs have been designed to meet the needs of the graphic art community; that is, to reproduce images that have already been properly rendered for the device on which the input image was created.</span></span> <span data-ttu-id="8dfee-613">El objetivo de GMAs de arte gráfico es hacer la mejor reproducción posible de la imagen de entrada en el dispositivo de salida.</span><span class="sxs-lookup"><span data-stu-id="8dfee-613">The goal of graphic arts GMAs is to make the best possible reproduction of the input image on the output device.</span></span> <span data-ttu-id="8dfee-614">La nueva CTE GBD está diseñada para resolver cuatro problemas clave.</span><span class="sxs-lookup"><span data-stu-id="8dfee-614">The new CTE GBD is designed to solve four key problems.</span></span>

<span data-ttu-id="8dfee-615">Dado que la imagen de entrada se representa para el dispositivo de entrada, todos los colores caben en el intervalo entre el punto blanco y el punto negro del medio.</span><span class="sxs-lookup"><span data-stu-id="8dfee-615">Because the input image is rendered for the input device, all colors fit within the range between the medium's white point and black point.</span></span> <span data-ttu-id="8dfee-616">Supongamos que la imagen es una fotografía de una escena en la que hay un blanco difuso, como una persona de una camiseta en blanco y un resaltado especular, como la luz que refleja un golpe de ventana o de cromo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-616">Suppose that the image is a photograph of a scene in which there is a diffuse white, such as a person in a white tee shirt, and a specular highlight, such as light reflecting off a window or chrome bumper.</span></span> <span data-ttu-id="8dfee-617">La escena se representará en el medio de entrada para que el resaltado especular se asigne al punto blanco del medio y el blanco difuso se asigne a un color neutro más oscuro que el punto blanco del medio.</span><span class="sxs-lookup"><span data-stu-id="8dfee-617">The scene will be rendered to the input medium so that the specular highlight is mapped to the medium's white point, and the diffuse white is mapped to some neutral color darker than the medium's white point.</span></span> <span data-ttu-id="8dfee-618">La elección de cómo asignar colores de la escena al medio de entrada es tanto una decisión dependiente de la escena como una decisión estética.</span><span class="sxs-lookup"><span data-stu-id="8dfee-618">The choice of how to map colors from the scene to the input medium is both a scene-dependent decision and an aesthetic decision.</span></span> <span data-ttu-id="8dfee-619">Si falta el resaltado especular de la escena original, el blanco difuso probablemente se asignará al punto blanco del medio.</span><span class="sxs-lookup"><span data-stu-id="8dfee-619">If the specular highlight was missing from the original scene, then the diffuse white would probably be mapped to the medium's white point.</span></span> <span data-ttu-id="8dfee-620">En una escena con muchos detalles de resaltado, se deja más intervalo entre el blanco especular y el blanco difuso.</span><span class="sxs-lookup"><span data-stu-id="8dfee-620">In a scene with a lot of highlight detail, more range would be left between the specular white and the diffuse white.</span></span> <span data-ttu-id="8dfee-621">En una escena en la que el resaltado no es significativo, es posible que se deje un intervalo muy pequeño.</span><span class="sxs-lookup"><span data-stu-id="8dfee-621">In a scene where the highlight is not significant, very little range might be left.</span></span>

<span data-ttu-id="8dfee-622">En el caso de las imágenes previamente representadas, la asignación de gamas es relativamente sencilla.</span><span class="sxs-lookup"><span data-stu-id="8dfee-622">For pre-rendered images, gamut mapping is relatively straightforward.</span></span> <span data-ttu-id="8dfee-623">Básicamente, el punto blanco del medio original se asigna al punto blanco del medio de reproducción, el punto negro de origen se asigna al punto negro de destino y la mayor parte de la asignación se ha completado.</span><span class="sxs-lookup"><span data-stu-id="8dfee-623">Basically, the original medium's white point is mapped to the reproduction medium's white point, the source black point is mapped to the destination black point, and most of the mapping is complete.</span></span> <span data-ttu-id="8dfee-624">Los diferentes GMAs en existencia proporcionan variaciones para asignar otros puntos en la escala de tono del medio de origen y diferentes maneras de administrar los valores de croma fuera de la gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-624">The different GMAs in existence provide variations for mapping other points on the source medium's tone scale and different ways to handle out-of-gamut chroma values.</span></span> <span data-ttu-id="8dfee-625">Pero la asignación de blanco a blanco y de negro a negro es coherente a lo largo de estas variaciones.</span><span class="sxs-lookup"><span data-stu-id="8dfee-625">But the mapping of white to white and black to black is consistent throughout these variations.</span></span> <span data-ttu-id="8dfee-626">Esta implementación requiere que el blanco esté por encima de un J \* de 50 y negro por debajo de un j \* de 50.</span><span class="sxs-lookup"><span data-stu-id="8dfee-626">This implementation requires that white be above a J\* of 50 and black below a J\* of 50.</span></span>

<span data-ttu-id="8dfee-627">No todas las codificaciones de color limitan los rangos de colores de las imágenes de entrada.</span><span class="sxs-lookup"><span data-stu-id="8dfee-627">Not all color encodings limit color ranges for input images.</span></span> <span data-ttu-id="8dfee-628">El scRGB de codificación de color estándar IEC (IEC 61966-2-2) proporciona 16 bits para cada uno de los tres canales de color rojo, verde y azul (RGB).</span><span class="sxs-lookup"><span data-stu-id="8dfee-628">The IEC standard color encoding scRGB (IEC 61966-2-2) provides 16 bits for each of the three color channels red, green, and blue (RGB).</span></span> <span data-ttu-id="8dfee-629">En esa codificación, el negro de referencia no se codifica como el triple RGB (0,0, 0), sino como (4096, 4096, 4096).</span><span class="sxs-lookup"><span data-stu-id="8dfee-629">In that encoding, reference black is not encoded as the RGB triple (0, 0, 0), but as (4096, 4096, 4096).</span></span> <span data-ttu-id="8dfee-630">El blanco de referencia se codifica como (12288, 12288, 12288).</span><span class="sxs-lookup"><span data-stu-id="8dfee-630">Reference white is encoded as (12288, 12288, 12288).</span></span> <span data-ttu-id="8dfee-631">La codificación scRGB se puede usar para representar los reflejos especulares y los detalles de la sombra.</span><span class="sxs-lookup"><span data-stu-id="8dfee-631">The scRGB encoding can be used to represent specular highlights and shadow detail.</span></span> <span data-ttu-id="8dfee-632">Incluye tripas RGB que no son posibles físicamente porque requieren cantidades negativas de luz y codificaciones que están fuera del raíz espectral de CIE.</span><span class="sxs-lookup"><span data-stu-id="8dfee-632">It includes RGB triples that are not physically possible because they require negative amounts of light, and encodings that are outside the CIE spectral locus.</span></span> <span data-ttu-id="8dfee-633">Claramente, ningún dispositivo puede producir todos los colores de la gama scRGB.</span><span class="sxs-lookup"><span data-stu-id="8dfee-633">Clearly, no device can possibly produce all the colors in the scRGB gamut.</span></span> <span data-ttu-id="8dfee-634">De hecho, ningún dispositivo puede producir todos los colores que puede ver un usuario.</span><span class="sxs-lookup"><span data-stu-id="8dfee-634">In fact, no device can produce all the colors that a human being can see.</span></span> <span data-ttu-id="8dfee-635">Por lo tanto, los dispositivos no pueden rellenar la gama scRGB y resultaría útil poder representar la parte de la gama que rellenan.</span><span class="sxs-lookup"><span data-stu-id="8dfee-635">So, devices cannot fill the scRGB gamut, and it would be useful to be able to represent the part of the gamut that they do fill.</span></span> <span data-ttu-id="8dfee-636">Cada dispositivo tiene un intervalo de valores en el espacio scRGB que puede generar.</span><span class="sxs-lookup"><span data-stu-id="8dfee-636">Each device has a range of values in scRGB space that it can produce.</span></span> <span data-ttu-id="8dfee-637">Estos son los colores "esperados" para el dispositivo; sería sorprendente que el dispositivo generara colores fuera de esta gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-637">These are the "expected" colors for the device; it would be surprising for the device to produce colors outside this gamut.</span></span> <span data-ttu-id="8dfee-638">Hay una transformación definida desde el espacio scRGB al espacio de apariencia, por lo que cada dispositivo también tiene un intervalo de valores de apariencia que se espera que reproduzca.</span><span class="sxs-lookup"><span data-stu-id="8dfee-638">There is a defined transformation from scRGB space to appearance space, so each device also has a range of appearance values that it is expected to reproduce.</span></span>

<span data-ttu-id="8dfee-639">Tanto en el scRGB como en los datos de entrada de los dispositivos de captura que se caracterizan por un destino fijo, es posible obtener un valor fuera del intervalo de valores esperados.</span><span class="sxs-lookup"><span data-stu-id="8dfee-639">In both scRGB and input from capture devices characterized with a fixed target, it is possible to get a value outside the range of expected values.</span></span> <span data-ttu-id="8dfee-640">Si alguien calibra una cámara en un destino de prueba; y después captura una escena con reflejos especulares, puede haber píxeles más brillantes que el punto blanco del destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-640">If someone calibrates a camera to a test target; and then captures a scene with specular highlights, there might be pixels that are brighter than the target's white point.</span></span> <span data-ttu-id="8dfee-641">Lo mismo puede suceder si una situación roja que se produce de forma natural es más cromática que la red de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-641">The same thing can happen if a naturally occurring red is more chromatic than the target red.</span></span> <span data-ttu-id="8dfee-642">Si alguien toma una imagen scRGB desde un dispositivo y, a continuación, edita manualmente los colores de la imagen, es posible crear píxeles que estén fuera del intervalo esperado de la gama de dispositivos, aunque estén dentro de la gama de scRGB completa.</span><span class="sxs-lookup"><span data-stu-id="8dfee-642">If someone takes an scRGB image from a device, and then manually edits the colors in the image, it is possible to create pixels that fall outside the expected range of the device gamut, even though they are within the full scRGB gamut.</span></span>

<span data-ttu-id="8dfee-643">Un segundo problema puede que, al principio, parezca estar relacionado con este.</span><span class="sxs-lookup"><span data-stu-id="8dfee-643">A second problem may not, at first, seem to be related to this.</span></span> <span data-ttu-id="8dfee-644">Se produce cuando se usa un destino de color para caracterizar un dispositivo de entrada, como una cámara o un escáner.</span><span class="sxs-lookup"><span data-stu-id="8dfee-644">It arises when you use a color target to characterize an input device, such as a camera or scanner.</span></span> <span data-ttu-id="8dfee-645">Normalmente, los objetivos reflectantes se producen en papel y contienen una serie de revisiones de color.</span><span class="sxs-lookup"><span data-stu-id="8dfee-645">Reflective targets are typically produced on paper and contain a number of colored patches.</span></span> <span data-ttu-id="8dfee-646">Manufaturers proporcionan archivos de datos con medidas de color tomadas en una condición de visualización fija para cada revisión de color.</span><span class="sxs-lookup"><span data-stu-id="8dfee-646">Manufaturers provide data files with color measurements taken under a fixed viewing condition for each color patch.</span></span> <span data-ttu-id="8dfee-647">Las herramientas de generación de perfiles de color crean una asignación entre estos valores medidos y los valores devueltos por los sensores de color en los dispositivos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-647">Color profiling tools create a mapping between these measured values and the values returned by the color sensors in the devices.</span></span> <span data-ttu-id="8dfee-648">El problema es que a menudo estos destinos de color no cubren toda la gama de valores de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-648">The problem is that often these color targets do not cover the full range of device values.</span></span> <span data-ttu-id="8dfee-649">Por ejemplo, puede que el escáner o la cámara devuelvan un valor de (253, 253, 253) para el punto blanco de referencia, y una revisión roja de referencia puede tener un valor RGB de (254, 12, 4).</span><span class="sxs-lookup"><span data-stu-id="8dfee-649">For example, the scanner or camera might return a value of (253, 253, 253) for the reference white point, and a reference red patch might have an RGB value of (254, 12, 4).</span></span> <span data-ttu-id="8dfee-650">Representan el intervalo de valores esperados para el dispositivo de entrada, en función de los valores de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-650">These represent the range of expected values for the input device, based on the target values.</span></span> <span data-ttu-id="8dfee-651">Si caracteriza el dispositivo de entrada en función de las respuestas al destino, solo se esperan colores dentro de este intervalo estrecho.</span><span class="sxs-lookup"><span data-stu-id="8dfee-651">If you characterize the input device based on the responses to the target, then you only expect colors within this narrow range.</span></span> <span data-ttu-id="8dfee-652">Este intervalo no es solo menor que el intervalo de colores que los usuarios pueden ver, es menor que el intervalo de colores que el dispositivo puede producir.</span><span class="sxs-lookup"><span data-stu-id="8dfee-652">This range is not only smaller than the range of colors humans can see, it is smaller than the range of colors the device can produce.</span></span>

<span data-ttu-id="8dfee-653">En ambos casos, es difícil calcular la gama de la imagen o el dispositivo de entrada, a pesar de la existencia de una gama de referencia o de medidas.</span><span class="sxs-lookup"><span data-stu-id="8dfee-653">In both cases, it is difficult to estimate the gamut of the input device or image, despite the existence of a reference gamut or measurements.</span></span> <span data-ttu-id="8dfee-654">En el primer problema, la gama de plausible del dispositivo de entrada es menor que la gama completa de scRGB.</span><span class="sxs-lookup"><span data-stu-id="8dfee-654">In the first problem, the plausible gamut of the input device is less than the full gamut of scRGB.</span></span> <span data-ttu-id="8dfee-655">En el segundo problema, la gama de referencia del destino es menor que la gama completa posible del dispositivo de entrada.</span><span class="sxs-lookup"><span data-stu-id="8dfee-655">In the second problem, the reference gamut of the target is less than the full possible gamut of the input device.</span></span>

<span data-ttu-id="8dfee-656">El tercer problema implica la asignación de tono.</span><span class="sxs-lookup"><span data-stu-id="8dfee-656">The third problem involves tone mapping.</span></span> <span data-ttu-id="8dfee-657">Se han propuesto muchos modelos de límites de gama que pueden representar de forma adecuada imágenes preprocesadas que se usan en la artes gráficas, por ejemplo, Braun y Fairchild Mountain Range GBD (Braun \[ 97 \] ) y el descriptor de límite de nivel máximo del segmento de Morovic (Morovic \[ 98 \] ).</span><span class="sxs-lookup"><span data-stu-id="8dfee-657">Many models of gamut boundaries that can adequately represent pre-rendered images used in the graphic arts have been proposed, for example, the Braun and Fairchild Mountain range GBD (Braun\[97\]), and Morovic's Segment Maxima boundary descriptor (Morovic\[98\]).</span></span> <span data-ttu-id="8dfee-658">Pero estos modelos solo proporcionan información sobre los extremos de la gama del dispositivo; falta información sobre otros puntos en la asignación tonal.</span><span class="sxs-lookup"><span data-stu-id="8dfee-658">But these models only provide information about the extremes of the device's gamut; they are missing information about other points in the tonal mapping.</span></span> <span data-ttu-id="8dfee-659">Sin esta información, GMAs solo puede hacer estimaciones aproximadas de la asignación de tono óptima.</span><span class="sxs-lookup"><span data-stu-id="8dfee-659">Without such information, GMAs can only make rough estimates of optimal tone mapping.</span></span> <span data-ttu-id="8dfee-660">Lo que es peor, estos modelos no proporcionan ayuda para el intervalo dinámico extendido en scRGB y en imágenes de cámara digital.</span><span class="sxs-lookup"><span data-stu-id="8dfee-660">Worse, these models provide no help for the extended dynamic range in scRGB and in digital camera images.</span></span>

<span data-ttu-id="8dfee-661">¿Cómo se resuelve este problema en las industrias fotográficas e fotográficas?</span><span class="sxs-lookup"><span data-stu-id="8dfee-661">How is this problem resolved in the photographic and videographic industries?</span></span> <span data-ttu-id="8dfee-662">La cámara captura una imagen.</span><span class="sxs-lookup"><span data-stu-id="8dfee-662">The camera captures an image.</span></span> <span data-ttu-id="8dfee-663">Los expertos pueden debatir la cantidad de representación que se produce en el dispositivo de captura; pero aceptan que no es una cantidad significativa.</span><span class="sxs-lookup"><span data-stu-id="8dfee-663">Experts might debate how much rendering occurs in the capture device; but they agree that it is not a significant amount.</span></span> <span data-ttu-id="8dfee-664">Ambas tecnologías no asignan un blanco difuso en una escena capturada al punto blanco del medio.</span><span class="sxs-lookup"><span data-stu-id="8dfee-664">Both technologies do not map a diffuse white in a captured scene to the medium's white point.</span></span> <span data-ttu-id="8dfee-665">Del mismo modo, no asignan el punto negro de la escena al punto negro del medio.</span><span class="sxs-lookup"><span data-stu-id="8dfee-665">Similarly, they do not map the black point from the scene to the medium's black point.</span></span> <span data-ttu-id="8dfee-666">El comportamiento de la película fotográfica se describe en el espacio de densidad mediante una curva de característica, que a menudo se denomina "Lesionator" y "&Driffield".</span><span class="sxs-lookup"><span data-stu-id="8dfee-666">The behavior of photographic film is described in density space using a characteristic curve, often called a Hurter and Driffield, or H&D curve.</span></span> <span data-ttu-id="8dfee-667">La curva muestra la densidad de la escena original y la densidad resultante de la película.</span><span class="sxs-lookup"><span data-stu-id="8dfee-667">The curve shows the density of the original scene and the resulting density on the film.</span></span> <span data-ttu-id="8dfee-668">En la figura 18 se muestra una curva de H&D típica.</span><span class="sxs-lookup"><span data-stu-id="8dfee-668">Figure 18 shows a typical H&D curve.</span></span> <span data-ttu-id="8dfee-669">El eje x representa un aumento de la exposición del registro.</span><span class="sxs-lookup"><span data-stu-id="8dfee-669">The x-axis represents increasing log exposure.</span></span> <span data-ttu-id="8dfee-670">El eje y representa la densidad de la diapositiva.</span><span class="sxs-lookup"><span data-stu-id="8dfee-670">The y-axis represents the density on the slide.</span></span> <span data-ttu-id="8dfee-671">Se han marcado cinco puntos de referencia en la curva: negro sin detalles, que representa la densidad mínima en el negativo; negro con detalle; tarjeta gris de referencia: blanco con detalle; y blanco sin detalles.</span><span class="sxs-lookup"><span data-stu-id="8dfee-671">Five reference points are marked on the curve: black without detail, which represents the minimum density on the negative; black with detail; reference mid-gray card; white with detail; and white without detail.</span></span> <span data-ttu-id="8dfee-672">Tenga en cuenta que hay espacio entre el negro sin detalles (que representa el dispositivo negro) y el negro con detalles (sombra negra).</span><span class="sxs-lookup"><span data-stu-id="8dfee-672">Note that there is space between black without detail (which represents device black) and black with detail (shadow black).</span></span> <span data-ttu-id="8dfee-673">Del mismo modo, hay espacio entre blanco y detalle (blanco difuso) y blanco sin detalles (que representa el dispositivo blanco).</span><span class="sxs-lookup"><span data-stu-id="8dfee-673">Similarly, there is space between white with detail (diffuse white) and white without detail (which represents device white).</span></span>

![Diagrama que muestra la curva H y D de la película de diapositivas.](images/gmmp-image079.png)

<span data-ttu-id="8dfee-675">**Figura 18** : curva de H&D para la película de diapositivas</span><span class="sxs-lookup"><span data-stu-id="8dfee-675">**Figure 18** : H&D curve for slide film</span></span>

<span data-ttu-id="8dfee-676">El sector del vídeo proporciona "espacio" y "footroom" en las imágenes.</span><span class="sxs-lookup"><span data-stu-id="8dfee-676">The video industry provides "headroom" and "footroom" in images.</span></span> <span data-ttu-id="8dfee-677">En la especificación ITU 709, la luminancia (llamada Y) se codifica en 8 bits, con un intervalo de 0 a 255.</span><span class="sxs-lookup"><span data-stu-id="8dfee-677">In the ITU 709 specification, luminance (called Y) is encoded in 8 bits, with a range of 0 to 255.</span></span> <span data-ttu-id="8dfee-678">Sin embargo, el negro de referencia se codifica en 15 y el blanco de referencia se codifica como 235.</span><span class="sxs-lookup"><span data-stu-id="8dfee-678">However, reference black is encoded at 15 and reference white is encoded as 235.</span></span> <span data-ttu-id="8dfee-679">Esto deja el intervalo de codificación entre 236 y 255 para representar los reflejos especulares.</span><span class="sxs-lookup"><span data-stu-id="8dfee-679">This leaves the encoding range between 236 and 255 to represent specular highlights.</span></span>

<span data-ttu-id="8dfee-680">El sector del vídeo presenta un sistema de bucles prácticamente cerrado.</span><span class="sxs-lookup"><span data-stu-id="8dfee-680">The video industry presents an essentially closed loop system.</span></span> <span data-ttu-id="8dfee-681">Aunque hay muchos proveedores de equipos distintos, los sistemas de vídeo se basan en dispositivos de referencia.</span><span class="sxs-lookup"><span data-stu-id="8dfee-681">While there are many different equipment vendors, video systems are based upon reference devices.</span></span> <span data-ttu-id="8dfee-682">Hay una codificación estándar para imágenes de vídeo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-682">There is a standard encoding for video images.</span></span> <span data-ttu-id="8dfee-683">No es necesario comunicar un límite de gama con imágenes de vídeo, ya que todas las imágenes se codifican para su reproducción en el mismo dispositivo de referencia.</span><span class="sxs-lookup"><span data-stu-id="8dfee-683">There is no need to communicate a gamut boundary with video images, because all images are encoded for reproduction on the same reference device.</span></span> <span data-ttu-id="8dfee-684">La película también está cerrada porque no es necesario transmitir datos intermedios entre distintos componentes.</span><span class="sxs-lookup"><span data-stu-id="8dfee-684">Film is also closed loop because there is no need to convey intermediate data between different components.</span></span> <span data-ttu-id="8dfee-685">Desea una solución que permita la reproducción de imágenes desde dispositivos con diferentes gamas y que representen escenas predefinidas y no representadas que se reproduzcan en la salida con distintas gamas.</span><span class="sxs-lookup"><span data-stu-id="8dfee-685">You want a solution that enables images from devices with varying gamuts and representing both pre-rendered and unrendered scenes to be reproduced on output with varying gamuts.</span></span>

<span data-ttu-id="8dfee-686">Un cuarto problema que debe resolver la nueva CTE es que los colores visualmente grises generados por un dispositivo, por ejemplo, cuando el color rojo = verde = azul en un monitor, no se encuentran en el eje neutro del CAM (cuando el croma = 0,0).</span><span class="sxs-lookup"><span data-stu-id="8dfee-686">A fourth problem that the new CTE must resolve is that the visually gray colors produced by a device, for example, when red=green=blue on a monitor, frequently do not fall upon the neutral axis of the CAM (when the chroma = 0.0).</span></span> <span data-ttu-id="8dfee-687">Esto produce grandes dificultades para GMAs.</span><span class="sxs-lookup"><span data-stu-id="8dfee-687">This causes great difficulties for GMAs.</span></span> <span data-ttu-id="8dfee-688">Para que los GMAs funcionen bien, tiene que ajustar la descripción de la gama del dispositivo y de los puntos de entrada para que el eje neutro del dispositivo se encuentre en el eje neutro del espacio de apariencia.</span><span class="sxs-lookup"><span data-stu-id="8dfee-688">To make GMAs work well, you have to adjust the description of the device's gamut and of the input points so that the device's neutral axis falls on the appearance space's neutral axis.</span></span> <span data-ttu-id="8dfee-689">Debe ajustar los puntos fuera del eje neutro en una cantidad similar.</span><span class="sxs-lookup"><span data-stu-id="8dfee-689">You have to adjust points off the neutral axis by a similar amount.</span></span> <span data-ttu-id="8dfee-690">De lo contrario, no puede hacer degradaciones suaves a través de la imagen.</span><span class="sxs-lookup"><span data-stu-id="8dfee-690">Otherwise, you cannot make smooth gradations through the image.</span></span> <span data-ttu-id="8dfee-691">En lo que se refiere al sistema GMA, deshacer esta asignación con respecto al eje neutro del dispositivo de salida.</span><span class="sxs-lookup"><span data-stu-id="8dfee-691">On the way out of the GMA, you undo this mapping, relative to the output device's neutral axis.</span></span> <span data-ttu-id="8dfee-692">Esto se conoce como una enderezación "quiropráctico" del eje.</span><span class="sxs-lookup"><span data-stu-id="8dfee-692">This is referred to as a "chiropractic" straightening of the axis.</span></span> <span data-ttu-id="8dfee-693">Al igual que un CHIROPRACTOR, no solo se endereza el esqueleto (eje neutro), sino que se ajusta el resto del cuerpo para moverlo junto con el esqueleto.</span><span class="sxs-lookup"><span data-stu-id="8dfee-693">Like a chiropractor, you not only straighten the skeleton (neutral axis), but you adjust the rest of the body to move along with the skeleton.</span></span> <span data-ttu-id="8dfee-694">Al igual que un CHIROPRACTOR, no ajuste el esqueleto en la misma cantidad en todo el espacio.</span><span class="sxs-lookup"><span data-stu-id="8dfee-694">Like a chiropractor, you do not adjust the skeleton by the same amount through the entire space.</span></span> <span data-ttu-id="8dfee-695">En su lugar, las diferentes secciones se ajustan de forma diferente.</span><span class="sxs-lookup"><span data-stu-id="8dfee-695">Instead, you adjust different sections differently.</span></span>

![Diagrama que muestra la curvatura del eje neutro del dispositivo con respecto al eje neutro CIECAM.](images/gmmp-image081.png)

<span data-ttu-id="8dfee-697">**Figura 19:** Curvatura del eje neutro del dispositivo con respecto al eje neutro de CIECAM</span><span class="sxs-lookup"><span data-stu-id="8dfee-697">**Figure 19:** Curvature of the device neutral axis relative to the CIECAM neutral axis</span></span>

<span data-ttu-id="8dfee-698">Lo que requiere la nueva CTE es un modelo de un límite de gama que se puede usar para representar imágenes de origen representadas y no representadas, proporcionar información sobre la apariencia de los neutros del dispositivo y proporcionar información para las imágenes de asignación de tono con un rango de luminancia ancho.</span><span class="sxs-lookup"><span data-stu-id="8dfee-698">What the new CTE requires is a model of a gamut boundary that can be used to represent both rendered and unrendered source images, provide information about the appearance of device neutrals, and provide information for tone mapping images with a wide luminance range.</span></span>

![Diagrama que muestra los shells de tres gamas.](images/gmmp-image083.png)

<span data-ttu-id="8dfee-700">**Figura 20** : shells de tres gamas</span><span class="sxs-lookup"><span data-stu-id="8dfee-700">**Figure 20** : Three gamut shells</span></span>

<span data-ttu-id="8dfee-701">El límite de la gama se compone de tres shells que definen tres regiones.</span><span class="sxs-lookup"><span data-stu-id="8dfee-701">The gamut boundary is composed of three shells that define three regions.</span></span>

<span data-ttu-id="8dfee-702">En la nueva CTE, el shell exterior de la gama está formado por un casco convexo que se realiza a partir de puntos de ejemplo en la gama de dispositivos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-702">In the new CTE, the outer shell of the gamut is formed with a convex hull made from sample points in the device gamut.</span></span> <span data-ttu-id="8dfee-703">Un casco se forma tomando un conjunto de puntos de ejemplo y rodeados por una superficie.</span><span class="sxs-lookup"><span data-stu-id="8dfee-703">A hull is formed by taking a set of sample points and surrounding them by a surface.</span></span> <span data-ttu-id="8dfee-704">Un casco convexo tiene la propiedad adicional de convexo en todas partes.</span><span class="sxs-lookup"><span data-stu-id="8dfee-704">A convex hull has the additional property of being convex everywhere.</span></span> <span data-ttu-id="8dfee-705">Por lo tanto, este no es el casco más pequeño posible que pueda ajustarse a los datos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-705">Therefore, this is not the smallest possible hull that can be fit to the data.</span></span> <span data-ttu-id="8dfee-706">Pero la experimentación ha demostrado que la conexión de los puntos de ejemplo es demasiado estricta y que los artefactos de las imágenes no resultan atractivos, como la falta de un sombreado suave.</span><span class="sxs-lookup"><span data-stu-id="8dfee-706">But experimentation has shown that fitting the sample points too tightly causes unappealing artifacts in images, such as a lack of smooth shading.</span></span> <span data-ttu-id="8dfee-707">El casco convexo parece resolver estos problemas.</span><span class="sxs-lookup"><span data-stu-id="8dfee-707">The convex hull seems to solve these problems.</span></span>

<span data-ttu-id="8dfee-708">En el algoritmo, los valores de apariencia de color se obtienen para un conjunto de puntos muestreados desde el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-708">In the algorithm, color appearance values are obtained for a set of points sampled from the device.</span></span> <span data-ttu-id="8dfee-709">En el caso de monitores e impresoras, los valores de apariencia de color se obtienen mediante la salida de ejemplos y su medición.</span><span class="sxs-lookup"><span data-stu-id="8dfee-709">For monitors and printers, the color appearance values are obtained by outputting samples, and then measuring them.</span></span> <span data-ttu-id="8dfee-710">También puede crear un modelo de dispositivo y, a continuación, ejecutar datos sintéticos a través del modelo de dispositivo para predecir valores medidos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-710">You can also create a device model, and then run synthetic data through the device model to predict measured values.</span></span> <span data-ttu-id="8dfee-711">Después, los valores medidos se convierten de un espacio colorimétrico (XYZ) al espacio de apariencia (jab) y el casco se ajusta alrededor de los puntos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-711">The measured values are then converted from colorimetric space (XYZ) to appearance space (Jab), and the hull is wrapped around the points.</span></span>

<span data-ttu-id="8dfee-712">El punto clave de este algoritmo es que el punto blanco adoptado en la conversión de colorimétrico al espacio de la apariencia no tiene que ser el punto blanco del medio.</span><span class="sxs-lookup"><span data-stu-id="8dfee-712">The key point to this algorithm is that the adopted white point used in the conversion from colorimetric to appearance space does not have to be the medium's white point.</span></span> <span data-ttu-id="8dfee-713">En su lugar, puede seleccionar un punto más alejado dentro de la gama y en (o cerca) el eje neutro.</span><span class="sxs-lookup"><span data-stu-id="8dfee-713">Instead, you can select a point farther inside the gamut and on (or near) the neutral axis.</span></span> <span data-ttu-id="8dfee-714">Ese punto tendrá un valor J de 100.</span><span class="sxs-lookup"><span data-stu-id="8dfee-714">That point will then have a J-value of 100.</span></span> <span data-ttu-id="8dfee-715">Los ejemplos con un valor Y medido más alto que el punto blanco adoptado terminarán con un valor de J mayor que 100.</span><span class="sxs-lookup"><span data-stu-id="8dfee-715">Samples with a measured Y-value higher than the adopted white point will end up with a J-value greater than 100.</span></span>

<span data-ttu-id="8dfee-716">Si coloca el punto blanco difuso de la escena como el punto blanco adoptado para la conversión del espacio de colores, los resaltes especulares de la escena se detectarán fácilmente con un valor de J mayor que 100.</span><span class="sxs-lookup"><span data-stu-id="8dfee-716">If you place the scene's diffuse white point as the adopted white point for the color space conversion, then specular highlights in the scene will be easily detected as having a J-value greater than 100.</span></span>

<span data-ttu-id="8dfee-717">Dado que el modelo de color CIECAM02 se basa en el sistema visual humano, después de seleccionar un blanco adoptado, el modelo determina automáticamente el nivel de luminancia del punto negro (J = 0).</span><span class="sxs-lookup"><span data-stu-id="8dfee-717">Because the CIECAM02 color model is based on the human visual system, after an adopted white is selected, the luminance level of the black point (J = 0) is automatically determined by the model.</span></span> <span data-ttu-id="8dfee-718">Si la imagen de entrada tiene un intervalo dinámico ancho, es posible que haya valores que se asignen a valores J inferiores a cero.</span><span class="sxs-lookup"><span data-stu-id="8dfee-718">If the input image has a wide dynamic range, it is possible that there might be values that map to J-values less than zero.</span></span>

<span data-ttu-id="8dfee-719">La siguiente figura 21 muestra los neutros de los dispositivos que se ejecutan a través del centro de las gamas de plausible y de referencia.</span><span class="sxs-lookup"><span data-stu-id="8dfee-719">The following Figure 21 shows the device neutrals running through the center of the plausible and reference gamuts.</span></span>

![Diagrama que muestra el eje neutro del dispositivo agregado al límite de la gama.](images/gmmp-image085.png)

<span data-ttu-id="8dfee-721">**Figura 21** : eje neutro de dispositivo agregado a límite de gama</span><span class="sxs-lookup"><span data-stu-id="8dfee-721">**Figure 21** : Device neutral axis added to gamut boundary</span></span>

<span data-ttu-id="8dfee-722">Todas las asignaciones de gama implican el recorte de un intervalo de entrada a una gama de salida o la compresión de la gama de entrada para que quepa en la gama de salida.</span><span class="sxs-lookup"><span data-stu-id="8dfee-722">All gamut mappings involve either clipping an input range to an output gamut, or compressing the input gamut to fit within the output gamut.</span></span> <span data-ttu-id="8dfee-723">Los algoritmos más complejos se forman comprimiendo y recortar en distintas direcciones, o dividiendo la gama en regiones diferentes y, a continuación, realizando el recorte o la compresión en las distintas regiones.</span><span class="sxs-lookup"><span data-stu-id="8dfee-723">More complex algorithms are formed by compressing and clipping in different directions, or by dividing the gamut into different regions, and then performing clipping or compression in the different regions.</span></span>

<span data-ttu-id="8dfee-724">La nueva CTE amplía este concepto para admitir las regiones de una gama posible, una gama de plausible y una gama de referencia, y permite a GMAs asignarlos de diferentes maneras.</span><span class="sxs-lookup"><span data-stu-id="8dfee-724">The new CTE extends this concept to support the regions of a possible gamut, a plausible gamut, and a reference gamut, and enables GMAs to map them in different ways.</span></span> <span data-ttu-id="8dfee-725">Además, los GMAs tienen información sobre el eje neutro del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-725">In addition, the GMAs have information about the device neutral axis.</span></span> <span data-ttu-id="8dfee-726">En la siguiente explicación se explica cómo controlar las situaciones en las que las gamas de plausible y las gamas de referencia se han contraído entre sí.</span><span class="sxs-lookup"><span data-stu-id="8dfee-726">The following discussion addresses how to handle situations where the plausible gamuts and reference gamuts have collapsed on each other.</span></span>

![Diagrama que muestra la G M A con dos descriptores de gama no contraídos.](images/gmmp-image091.png)

<span data-ttu-id="8dfee-728">**Figura 22** : GMA con dos descriptores de gama no contraídos</span><span class="sxs-lookup"><span data-stu-id="8dfee-728">**Figure 22** : GMA with two un-collapsed gamut descriptors</span></span>

<span data-ttu-id="8dfee-729">Es posible que vea este ejemplo si asigna desde un dispositivo de entrada, como una cámara o escáner que se caracteriza por un destino reflectante, al espacio scRGB.</span><span class="sxs-lookup"><span data-stu-id="8dfee-729">You might see this example if you map from an input device, such as a camera or scanner that is characterized with a reflective target, to scRGB space.</span></span> <span data-ttu-id="8dfee-730">Aquí, los colores de plausible más claros que el blanco de referencia son reflejos especulares.</span><span class="sxs-lookup"><span data-stu-id="8dfee-730">Here the plausible colors that are lighter than reference white are specular highlights.</span></span> <span data-ttu-id="8dfee-731">En la práctica, la creación de caracteres de una cámara con un destino podría no generar el intervalo completo de valores posibles en la cámara; sin embargo, los reflejos especulares y los colores muy cromáticos que se encuentran en la naturaleza.</span><span class="sxs-lookup"><span data-stu-id="8dfee-731">In practice, characterizing a camera with a target might not generate the full range of values possible in the camera; however, specular highlights and very chromatic colors found in nature would.</span></span> <span data-ttu-id="8dfee-732">(Los destinos transcartados suelen tener una revisión que es la densidad mínima posible en el medio.</span><span class="sxs-lookup"><span data-stu-id="8dfee-732">(Transmissive targets usually have a patch that is the minimum density possible on the medium.</span></span> <span data-ttu-id="8dfee-733">Con este tipo de destino, los reflejos especulares se encuentran dentro del intervalo del destino. El negro de referencia de un destino reflectante sería el principio de la región de color negro de la sombra.</span><span class="sxs-lookup"><span data-stu-id="8dfee-733">With such a target, specular highlights would fall within the target's range.) The reference black for a reflective target would be the beginning of the shadow black region.</span></span> <span data-ttu-id="8dfee-734">Es decir, es probable que haya colores en las sombras más oscuras que el negro del destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-734">That is, there are likely to be colors in the shadows that are darker than the black on the target.</span></span> <span data-ttu-id="8dfee-735">Si la imagen contiene una gran cantidad de contenido interesante en esa región, es posible que merezca la pena conservar esa variación tonal.</span><span class="sxs-lookup"><span data-stu-id="8dfee-735">If the image contains a lot of interesting content in that region, it may be worthwhile preserving that tonal variation.</span></span>

![Diagrama que muestra la G M A con una gama de destino contraída.](images/gmmp-image095.png)

<span data-ttu-id="8dfee-737">**Figura 23** : GMA con una gama de destino contraída</span><span class="sxs-lookup"><span data-stu-id="8dfee-737">**Figure 23** : GMA with collapsed destination gamut</span></span>

<span data-ttu-id="8dfee-738">En la Figura 23 se muestra un posible algoritmo de asignación de gamas cuando la gama de destino solo proporciona el intervalo del dispositivo blanco a negro y no hay ningún posible número de colores fuera de esta gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-738">Figure 23 shows one possible gamut mapping algorithm when the destination gamut only provides the range from device white to black, and there are no possible colors outside this gamut.</span></span> <span data-ttu-id="8dfee-739">Lo más probable es que se produzca para dispositivos de salida típicos, como las impresoras.</span><span class="sxs-lookup"><span data-stu-id="8dfee-739">This is likely to happen for typical output devices, such as printers.</span></span> <span data-ttu-id="8dfee-740">Los colores posibles se asignan al borde de la gama de destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-740">The possible colors are mapped to the edge of the destination gamut.</span></span> <span data-ttu-id="8dfee-741">Pero carece de una curva de tono para el dispositivo de salida.</span><span class="sxs-lookup"><span data-stu-id="8dfee-741">But it lacks a tone curve for the output device.</span></span> <span data-ttu-id="8dfee-742">El GMA debe seleccionar algún punto neutro de luminancia inferior para usarlo como destino de asignación para el blanco de referencia.</span><span class="sxs-lookup"><span data-stu-id="8dfee-742">The GMA must select some neutral point of lower luminance to use as a mapping destination for the reference white.</span></span> <span data-ttu-id="8dfee-743">Un algoritmo sofisticado puede hacer esto histogramming el lightnesses en la imagen de origen y observando cuántos se encuentran en el intervalo de espera, pero más claro que el blanco de referencia.</span><span class="sxs-lookup"><span data-stu-id="8dfee-743">A sophisticated algorithm can do this by histogramming the lightnesses in the source image and seeing how many fall in the range of expected but lighter than the reference white.</span></span> <span data-ttu-id="8dfee-744">Cuanto mayor sea el número de lightnesses, más espacio se necesita en el dispositivo de destino entre los puntos asignados para los resaltados especulares y el blanco de referencia.</span><span class="sxs-lookup"><span data-stu-id="8dfee-744">The more lightnesses, the more space is required in the destination device between the mapped points for the specular highlights and reference white.</span></span> <span data-ttu-id="8dfee-745">Un algoritmo más sencillo podría elegir una distancia arbitraria hacia abajo de la escala de luminosidad desde el dispositivo blanco, como un 5 por ciento.</span><span class="sxs-lookup"><span data-stu-id="8dfee-745">A simpler algorithm might pick an arbitrary distance down the lightness scale from device white, such as 5 percent.</span></span> <span data-ttu-id="8dfee-746">Se aplica un enfoque similar para la asignación de los valores negros máximo y negro.</span><span class="sxs-lookup"><span data-stu-id="8dfee-746">A similar approach applies for the mapping of the maximum black and shadow black.</span></span>

<span data-ttu-id="8dfee-747">Después de generar la curva de tono de destino, puede asignar un método similar al que se usa en la Figura 23 anterior.</span><span class="sxs-lookup"><span data-stu-id="8dfee-747">After you generate the destination tone curve, you can map in a method similar to that used in the preceding Figure 23.</span></span> <span data-ttu-id="8dfee-748">Todos los puntos de la curva de tono de destino se encontrarán dentro de la gama de dispositivos y todos los puntos de la asignación deben estar dentro de la gama de dispositivos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-748">All points in the destination tone curve will fall within the device gamut, and all points in the mapping must fall within the device gamut.</span></span>

<span data-ttu-id="8dfee-749">Si revierte las figuras de la izquierda y la derecha, y las direcciones de las flechas de la Figura 23, puede describir el caso en el que la imagen de origen tiene solo una gama de referencia y las tres gamas del dispositivo de salida no se contraen entre sí.</span><span class="sxs-lookup"><span data-stu-id="8dfee-749">If you reverse the left figures and right figures, and the directions of the arrows in Figure 23, you can describe the case where the source image has only a reference gamut, and the three gamuts of the output device have not collapsed onto each other.</span></span> <span data-ttu-id="8dfee-750">Un ejemplo de esto podría ser la asignación de un monitor a scRGB.</span><span class="sxs-lookup"><span data-stu-id="8dfee-750">An example of this might be mapping from a monitor to scRGB.</span></span> <span data-ttu-id="8dfee-751">De nuevo, el GMA debe sintetizar los puntos de control de los cinco puntos de la curva de tono de la imagen de origen.</span><span class="sxs-lookup"><span data-stu-id="8dfee-751">Again, the GMA must synthesize the control points for the five points on the tone curve for the source image.</span></span> <span data-ttu-id="8dfee-752">Algunas asignaciones pueden colocar todos los puntos de la curva de tono dentro de la gama de dispositivos scRGB, mientras que otras asignaciones podrían usar más de la gama de scRGB asignando el blanco difuso al blanco de referencia y permitiendo que el blanco especular se asigne a un valor más claro.</span><span class="sxs-lookup"><span data-stu-id="8dfee-752">Some mappings might put all points of the tone curve within the scRGB device gamut, while other mappings might use more of the scRGB gamut by mapping diffuse white to the reference white and allowing specular white to map to a lighter value.</span></span>

<span data-ttu-id="8dfee-753">Por último, tiene el caso en el que ambos dispositivos tienen solo la gama de referencia, que es la forma en que funcionan la mayoría de los algoritmos de asignación.</span><span class="sxs-lookup"><span data-stu-id="8dfee-753">Finally, you have the case where both devices have only the reference gamut, which is how most gamut mapping algorithms work.</span></span> <span data-ttu-id="8dfee-754">Por lo tanto, puede resolverlo simplemente volviendo a los algoritmos actuales.</span><span class="sxs-lookup"><span data-stu-id="8dfee-754">So you can resolve this by just falling back to current algorithms.</span></span> <span data-ttu-id="8dfee-755">Como alternativa, si tiene una manera razonable de determinar los cinco puntos de referencia para los dispositivos de origen y de destino, puede organizar para asignar los puntos de referencia.</span><span class="sxs-lookup"><span data-stu-id="8dfee-755">Alternatively, if you have a reasonable way to determine the five reference points for the source and destination devices, then you can arrange to map the reference points.</span></span>

<span data-ttu-id="8dfee-756">Las gamas de dispositivos contienen más de los cinco puntos de referencia en el eje neutro.</span><span class="sxs-lookup"><span data-stu-id="8dfee-756">Device gamuts contain more than the five reference points on the neutral axis.</span></span> <span data-ttu-id="8dfee-757">Estos solo representan los límites entre las posibles regiones de la imagen.</span><span class="sxs-lookup"><span data-stu-id="8dfee-757">These just represent the boundaries between potential regions in the image.</span></span> <span data-ttu-id="8dfee-758">Entre cada uno de los puntos de referencia puede usar cualquiera de las técnicas de asignación de gama existentes.</span><span class="sxs-lookup"><span data-stu-id="8dfee-758">Between each of the reference points, you can use any of the existing gamut mapping techniques.</span></span> <span data-ttu-id="8dfee-759">Por lo tanto, puede recortar el intervalo de colores inesperados y comprimir todos los colores entre el blanco y el negro esperados, o puede recortar todos los colores fuera del intervalo de referencia y comprimir dentro de ese intervalo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-759">So you might clip the range of unexpected colors, and compress all colors between the expected white and black, or you might clip all colors outside the reference range and compress within that range.</span></span> <span data-ttu-id="8dfee-760">Hay muchas posibilidades, que se pueden implementar en diferentes GMAs.</span><span class="sxs-lookup"><span data-stu-id="8dfee-760">There are many possibilities, which can be implemented in different GMAs.</span></span> <span data-ttu-id="8dfee-761">Además, el GMAs se puede comprimir y recortar de diferentes maneras.</span><span class="sxs-lookup"><span data-stu-id="8dfee-761">Further, the GMAs can compress and clip in different ways.</span></span> <span data-ttu-id="8dfee-762">Todas estas combinaciones están tratadas dentro de esta invento.</span><span class="sxs-lookup"><span data-stu-id="8dfee-762">All of those combinations are covered within this invention.</span></span>

<span data-ttu-id="8dfee-763">Hasta ahora en este debate, la gama se ha tratado como si solo fuera una función del dispositivo en el que se ha creado, capturado o mostrado la imagen.</span><span class="sxs-lookup"><span data-stu-id="8dfee-763">So far in this discussion, the gamut has been treated as if it were solely a function of the device on which the image was created, captured, or displayed.</span></span> <span data-ttu-id="8dfee-764">Sin embargo, no hay ningún motivo por el que todas las imágenes de un dispositivo deben tener la misma gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-764">However, there is no reason why all images for a device must have the same gamut.</span></span> <span data-ttu-id="8dfee-765">GMAs dependen de los datos de GBD.</span><span class="sxs-lookup"><span data-stu-id="8dfee-765">The GMAs depend on the data in the GBD.</span></span> <span data-ttu-id="8dfee-766">Si se cambia el descriptor entre imágenes, no hay ninguna manera de que el GMAs lo sepa.</span><span class="sxs-lookup"><span data-stu-id="8dfee-766">If the descriptor is changed between images, there is no way for the GMAs to know.</span></span> <span data-ttu-id="8dfee-767">En concreto, si las imágenes no tienen reflejos especulares, GMAs funcionan mejor si el descriptor de la gama no muestra que hay colores más claros que el blanco difuso.</span><span class="sxs-lookup"><span data-stu-id="8dfee-767">In particular, if images have no specular highlights, GMAs perform better if the gamut descriptor does not show that there are colors lighter than diffuse white.</span></span>

<span data-ttu-id="8dfee-768">En la nueva arquitectura de CTE, es posible usar más de un GMA.</span><span class="sxs-lookup"><span data-stu-id="8dfee-768">In the new CTE architecture, it is possible to use more than one GMA.</span></span> <span data-ttu-id="8dfee-769">El uso de varias GMAs se define de forma inherente.</span><span class="sxs-lookup"><span data-stu-id="8dfee-769">Using multiple GMAs is inherently ill-defined.</span></span> <span data-ttu-id="8dfee-770">Por ejemplo, si un dispositivo de captura asocia un GMA con su "aspecto y funcionamiento", tiende a hacerlo con una gama de destino de "destino".</span><span class="sxs-lookup"><span data-stu-id="8dfee-770">For example, if a capture device associates a GMA with its "look and feel," it tends to do so with a "targeted" destination gamut.</span></span> <span data-ttu-id="8dfee-771">Lo mismo se aplica a los dispositivos de salida y a las gamas de origen "de destino".</span><span class="sxs-lookup"><span data-stu-id="8dfee-771">The same is true for output devices and "targeted" source gamuts.</span></span> <span data-ttu-id="8dfee-772">La gama sRGB es una gama implícita de destino común.</span><span class="sxs-lookup"><span data-stu-id="8dfee-772">The sRGB gamut is one commonly targeted implied gamut.</span></span> <span data-ttu-id="8dfee-773">Por lo tanto, se recomienda encarecidamente que use un solo GMA, si la predicción es una prioridad.</span><span class="sxs-lookup"><span data-stu-id="8dfee-773">Therefore, it is strongly recommended that you use a single GMA, if predictability is a priority.</span></span> <span data-ttu-id="8dfee-774">Un único flujo de trabajo de GMA debe ser el valor predeterminado para todos los flujos de trabajo, especialmente los flujos de trabajo de consumidor y prosumer.</span><span class="sxs-lookup"><span data-stu-id="8dfee-774">A single GMA workflow should be the default for all workflows, especially consumer and prosumer workflows.</span></span> <span data-ttu-id="8dfee-775">Aunque la asignación de gama para la reproducción preferida debe realizarse una vez, hay instancias en las que se incluyen varios procesos de asignación.</span><span class="sxs-lookup"><span data-stu-id="8dfee-775">While gamut mapping for preferred reproduction should be done one time, there are instances where multiple mapping processes are included.</span></span> <span data-ttu-id="8dfee-776">En primer lugar, para la prueba, realiza una asignación preferida a la gama del dispositivo de destino final y, a continuación, una representación colorimétrica en la gama del dispositivo de prueba.</span><span class="sxs-lookup"><span data-stu-id="8dfee-776">First, for proofing, you do a preferred mapping to the gamut of the final target device, and then a colorimetric rendering to the gamut of the proofing device.</span></span> <span data-ttu-id="8dfee-777">En segundo lugar, algunos tipos de asignación se usan para modificar las características de la imagen, pero no se incluyen para asignarse a una gama de dispositivos, por ejemplo, ajustar la curva de tono o la cromaticidad.</span><span class="sxs-lookup"><span data-stu-id="8dfee-777">Second, some types of mapping are used to alter the characteristics of the image, but aren't included to map to a device gamut, for example, adjusting the tone curve or the chromaticity.</span></span> <span data-ttu-id="8dfee-778">Si se usan varios GMAs, la interfaz de transformación toma una matriz de asignaciones de gama enlazada, es decir, asignaciones de gama que se han inicializado con un par de descripciones de límites de gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-778">If multiple GMAs are used, the transform interface takes an array of bound gamut maps, that is, gamut maps that have been initialized with a pair of gamut boundary descriptions.</span></span> <span data-ttu-id="8dfee-779">Cuando hay más de un mapa de gama, el límite de la gama de entrada para una asignación de gama correcta debe ser el mismo que el límite de la gama de salida de su predecesor.</span><span class="sxs-lookup"><span data-stu-id="8dfee-779">When there is more than one gamut map, the input gamut boundary for a succeeding gamut map must be the same as the output gamut boundary of its predecessor.</span></span>

<span data-ttu-id="8dfee-780">La función de límite de gama de dispositivos toma el motor de modelo de dispositivo y los parámetros analíticos, y deriva un límite de gama de dispositivos de color descrito como una lista de vértices ordenados del casco convexo de la gama de dispositivos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-780">The device gamut boundary function takes the device model engine and analytical parameters and derives a color device gamut boundary described as an ordered vertex list of the convex hull of the device gamut.</span></span> <span data-ttu-id="8dfee-781">La lista de vértices ordenados se almacena en CIEJab.</span><span class="sxs-lookup"><span data-stu-id="8dfee-781">The ordered vertex list is stored in CIEJab.</span></span> <span data-ttu-id="8dfee-782">La estructura de la lista de vértices ordenados está optimizada para la aceleración de hardware de DirectX.</span><span class="sxs-lookup"><span data-stu-id="8dfee-782">The structure of the ordered vertex list is optimized for hardware acceleration by DirectX.</span></span> <span data-ttu-id="8dfee-783">Este enfoque tiene muchas soluciones conocidas (busque "DirectX de casco convexo" en la web y obtendrá buenos resultados 100).</span><span class="sxs-lookup"><span data-stu-id="8dfee-783">This approach has many well known solutions (search for "convex hull DirectX" on the web and you get well over 100 hits).</span></span> <span data-ttu-id="8dfee-784">También hay una referencia de 1983 en este tema (teoría y aplicación de gráficos del equipo, "Shiphulls, b-spline Surfaces y CADCAM" pp. 34-49), con referencias de 1970 a 1982 en el tema.</span><span class="sxs-lookup"><span data-stu-id="8dfee-784">There is also a reference from 1983 on this topic (Computer Graphics Theory and Application, "Shiphulls, b-spline surfaces and cadcam" pp. 34-49), with references dating from 1970 to 1982 on the topic.</span></span>

<span data-ttu-id="8dfee-785">Se pueden usar dos técnicas diferentes para calcular los triángulos en el shell de gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-785">Two different techniques can be used to compute the triangles in the gamut shell.</span></span> <span data-ttu-id="8dfee-786">Para otros dispositivos distintos de los dispositivos RGB aditivos, se calcula un casco convexo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-786">For other devices other than additive RGB devices, you compute a convex hull.</span></span> <span data-ttu-id="8dfee-787">Puede considerar la posibilidad de investigar la compatibilidad con el casco no convexo para otros dispositivos si tiene acceso directo a dichos dispositivos para validar la solidez, el rendimiento y la fidelidad de los algoritmos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-787">You can consider investigating non-convex hull support for other devices if you have direct access to such devices to validate the robustness, performance, and fidelity of the algorithms.</span></span> <span data-ttu-id="8dfee-788">Se trata de un proceso conocido que no requiere una descripción más detallada.</span><span class="sxs-lookup"><span data-stu-id="8dfee-788">This is a well-known process that does not require further description.</span></span> <span data-ttu-id="8dfee-789">La técnica que se usa para los dispositivos de suma RGB se describe de la siguiente manera.</span><span class="sxs-lookup"><span data-stu-id="8dfee-789">The technique used for additive RGB devices is described as follows.</span></span>

<span data-ttu-id="8dfee-790">Los diferentes GBDs tienen ventajas y desventajas.</span><span class="sxs-lookup"><span data-stu-id="8dfee-790">Different GBDs have advantages and drawbacks.</span></span> <span data-ttu-id="8dfee-791">La representación convexa de casco garantiza unas propiedades geométricas atractivas, como segmentos de matiz convexa que proporcionan un punto de intersección único con un rayo que emana de un punto en el eje neutro.</span><span class="sxs-lookup"><span data-stu-id="8dfee-791">The convex hull representation guarantees nice geometric properties, such as convex hue slices that provide a unique intersection point with a ray emanating from a point on the neutral axis.</span></span> <span data-ttu-id="8dfee-792">La desventaja de la representación de casco convexa también es la convexidad.</span><span class="sxs-lookup"><span data-stu-id="8dfee-792">The downside of the convex hull representation is also convexity.</span></span> <span data-ttu-id="8dfee-793">Se sabe que muchos dispositivos, en concreto, muestran dispositivos, tienen gamas que están lejos de ser convexa.</span><span class="sxs-lookup"><span data-stu-id="8dfee-793">It is known that many devices, specifically display devices, have gamuts that are far from being convex.</span></span> <span data-ttu-id="8dfee-794">Si la gama real se desvía significativamente de la suposición de la convexidad, la representación de casco convexa sería inexacta, posiblemente en la medida en que no represente la realidad.</span><span class="sxs-lookup"><span data-stu-id="8dfee-794">If the actual gamut deviates significantly from the convexity assumption, the convex hull representation would be inaccurate, possibly to the extent that it doesn't represent reality.</span></span>

<span data-ttu-id="8dfee-795">Después de adoptar un GBD que proporciona una representación razonablemente precisa de la gama real, se producen otros problemas, algunos debidos al concepto de segmento de matiz.</span><span class="sxs-lookup"><span data-stu-id="8dfee-795">After you adopt a GBD that gives a reasonably accurate representation of the actual gamut, other problems arise, some due to the very concept of hue slice.</span></span> <span data-ttu-id="8dfee-796">Hay al menos dos situaciones patológicas.</span><span class="sxs-lookup"><span data-stu-id="8dfee-796">There are at least two pathological situations.</span></span> <span data-ttu-id="8dfee-797">En la siguiente figura 24, una gama de CRT da lugar a segmentos de matiz con "islas".</span><span class="sxs-lookup"><span data-stu-id="8dfee-797">In the following Figure 24, a CRT gamut gives rise to hue slices with "islands."</span></span> <span data-ttu-id="8dfee-798">En la figura 25, una gama de impresoras da lugar a un segmento de matiz con parte del eje neutro que falta.</span><span class="sxs-lookup"><span data-stu-id="8dfee-798">In Figure 25, a printer gamut gives rise to a hue slice with part of the neutral axis missing.</span></span> <span data-ttu-id="8dfee-799">Los sectores del matiz patológico no están causados por límites de gama especialmente patológicos en estos casos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-799">The pathological hue slices are not caused by particularly pathological gamut boundaries in these cases.</span></span> <span data-ttu-id="8dfee-800">Están causados por el concepto de segmento de matiz, porque (a) se toma a lo largo del matiz constante y (b) solo toma una mitad del plano que corresponde al ángulo de matiz.</span><span class="sxs-lookup"><span data-stu-id="8dfee-800">They are caused by the very concept of hue slice, because (a) it is taken along constant hue, and (b) it only takes one-half of the plane that corresponds to the hue angle.</span></span>

![Diagrama que muestra una vista superior y una vista lateral de la "curva en" en los tonos azules.](images/gmmp-image097.jpg)

<span data-ttu-id="8dfee-802">**Figura 24** : un monitor CRT típico tiene una gama que muestra la "curva en" en los tonos azules.</span><span class="sxs-lookup"><span data-stu-id="8dfee-802">**Figure 24** : A typical CRT monitor has a gamut that shows peculiar "curving in" in the blue hues.</span></span> <span data-ttu-id="8dfee-803">Si se toman segmentos de matiz dentro de este intervalo de matiz, las islas aisladas pueden aparecer en los segmentos del matiz.</span><span class="sxs-lookup"><span data-stu-id="8dfee-803">If hue slices are taken within this hue range, isolated islands may appear in the hue slices.</span></span>

![Diagrama de una gama con un ' hueco ' en su eje neutro.](images/gmmp-image099.jpg)

<span data-ttu-id="8dfee-805">**Figura 25** : una impresora puede tener una gama con "hueco" en su eje neutro.</span><span class="sxs-lookup"><span data-stu-id="8dfee-805">**Figure 25** : A printer may have a gamut that has "gap" in its neutral axis.</span></span> <span data-ttu-id="8dfee-806">Cuando se toma un segmento de matiz (que es solo una mitad del plano), hay una "sangría" en la parte del límite que es el eje neutro.</span><span class="sxs-lookup"><span data-stu-id="8dfee-806">When a hue slice is taken (which is only one-half the plane), there is a "dent" on the part of the boundary that is the neutral axis.</span></span> <span data-ttu-id="8dfee-807">Esto puede ser difícil de resolver con algoritmos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-807">This can be hard to resolve algorithmically.</span></span>

<span data-ttu-id="8dfee-808">Para resolver estos pathologies, se propone un nuevo marco que abandone el concepto de segmento de matiz que se usa como punto de partida.</span><span class="sxs-lookup"><span data-stu-id="8dfee-808">To resolve these pathologies, a new framework is proposed that abandons the concept of hue slice that used as the starting point.</span></span> <span data-ttu-id="8dfee-809">En su lugar, el marco utiliza el conjunto de "elementos de línea de límite" o líneas que se encuentran en el límite de la gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-809">Instead, the framework uses the set of "boundary line elements," or lines that lie on the gamut boundary.</span></span> <span data-ttu-id="8dfee-810">No proporcionan necesariamente una visualización geométrica coherente como segmentos de matiz, pero admiten todas las operaciones de gama comunes.</span><span class="sxs-lookup"><span data-stu-id="8dfee-810">They do not necessarily provide a coherent geometric visualization like hue slices, but they support all the common gamut operations.</span></span> <span data-ttu-id="8dfee-811">Además de resolver los problemas mencionados anteriormente, este enfoque también sugiere que la construcción de los segmentos de matiz, incluso cuando es posible, es un proceso de pérdida computacional.</span><span class="sxs-lookup"><span data-stu-id="8dfee-811">Besides solving the problems mentioned previously, this approach also suggests that the construction of hue slices, even when it is possible, is computationally wasteful.</span></span>

### <a name="triangulation-of-the-gamut-boundary"></a><span data-ttu-id="8dfee-812">Triangulación del límite de la gama</span><span class="sxs-lookup"><span data-stu-id="8dfee-812">Triangulation of the Gamut Boundary</span></span>

<span data-ttu-id="8dfee-813">El punto inicial es un GBD que consta de una triangulación del límite de la gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-813">The starting point is a GBD consisting of a triangulation of the gamut boundary.</span></span> <span data-ttu-id="8dfee-814">Los métodos conocidos para construir GBDs normalmente proporcionan esa triangulación.</span><span class="sxs-lookup"><span data-stu-id="8dfee-814">Known methods of constructing GBDs usually provide that triangulation.</span></span> <span data-ttu-id="8dfee-815">En cuanto a la concretaidad, un método para construir GBDs para dispositivos aditivos se describe aquí.</span><span class="sxs-lookup"><span data-stu-id="8dfee-815">For concreteness, one method of constructing GBDs for additive devices its device space is described here.</span></span> <span data-ttu-id="8dfee-816">Estos dispositivos incluyen monitores (basados en CRT y en LCD) y proyectores.</span><span class="sxs-lookup"><span data-stu-id="8dfee-816">These devices include monitors (both CRT-based and LCD-based) and projectors.</span></span> <span data-ttu-id="8dfee-817">La geometría simple del cubo permite introducir un Lattice normal en el cubo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-817">The simple geometry of the cube enables you to introduce a regular lattice on the cube.</span></span> <span data-ttu-id="8dfee-818">Las caras del borde del cubo se pueden triangular de varias maneras, como la que se muestra en la figura 26.</span><span class="sxs-lookup"><span data-stu-id="8dfee-818">The boundary faces of the cube can be triangulated in a number of fashions, such as the one shown in Figure 26.</span></span> <span data-ttu-id="8dfee-819">La arquitectura proporciona un modelo de dispositivo para el dispositivo, de modo que los valores de colorimétrico de los puntos de Lattice se puedan obtener de forma algorítmica, o bien se hayan realizado medidas directamente para esos puntos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-819">The architecture provides either a device model for the device so that colorimetric values of the lattice points can be obtained algorithmically, or measurements have been made directly for those points.</span></span> <span data-ttu-id="8dfee-820">La arquitectura también proporciona CIECAM02, para que pueda asumir que los datos iniciales ya se han asignado en el espacio de jab de CIECAM02.</span><span class="sxs-lookup"><span data-stu-id="8dfee-820">The architecture also provides CIECAM02, so that you can assume the starting data has already been mapped into CIECAM02 Jab space.</span></span> <span data-ttu-id="8dfee-821">Después, cada punto de Lattice en las caras del límite del cubo RGB tiene un punto correspondiente en el espacio jab.</span><span class="sxs-lookup"><span data-stu-id="8dfee-821">Then each lattice point on the boundary faces of the RGB cube has a corresponding point in Jab space.</span></span> <span data-ttu-id="8dfee-822">Las conexiones de los puntos que forman el conjunto de triángulos en el espacio RGB también inducen un conjunto de triángulos en el espacio de jab.</span><span class="sxs-lookup"><span data-stu-id="8dfee-822">The connections of points that form the set of triangles in RGB space also induces a set of triangles in Jab space.</span></span> <span data-ttu-id="8dfee-823">Este conjunto de triángulos forma una triangulación razonable del límite de la gama si (a) el Lattice en el cubo RGB es suficientemente fino y (b) la transformación del espacio de dispositivo en el espacio de colores uniforme se comportará topológicamente correctamente; es decir, asigna el límite al límite y no lo convierte en el interior para que los puntos interiores se conviertan en puntos de límite.</span><span class="sxs-lookup"><span data-stu-id="8dfee-823">This set of triangles forms a reasonable triangulation of the gamut boundary if (a) the lattice on the RGB cube is fine enough, and (b) the transformation from device space to the uniform color space is topologically well-behaved; that is, it maps boundary to boundary, and it doesn't turn the gamut inside out so that interior points become boundary points.</span></span>

![Diagrama que muestra un método sencillo para triangluate el límite de la gama de un dispositivo con R G B como espacio de dispositivo.](images/gmmp-image100.png)

<span data-ttu-id="8dfee-825">**Figura 26** : método simple para triangular el límite de la gama de un dispositivo con RGB como espacio de dispositivo</span><span class="sxs-lookup"><span data-stu-id="8dfee-825">**Figure 26** : A simple method to triangulate the gamut boundary of a device with RGB as its device space</span></span>

### <a name="boundary-line-elements"></a><span data-ttu-id="8dfee-826">Elementos de línea de límite</span><span class="sxs-lookup"><span data-stu-id="8dfee-826">Boundary Line Elements</span></span>

<span data-ttu-id="8dfee-827">La central de este marco es el concepto de elementos de línea de límite. un conjunto de segmentos de línea que (a) se encuentran en el límite de la gama y (b) se encuentran en un plano.</span><span class="sxs-lookup"><span data-stu-id="8dfee-827">Central to this framework is the concept of boundary line elements; a set of line segments that (a) lie on the gamut boundary, and (b) lie on a plane.</span></span> <span data-ttu-id="8dfee-828">En este caso, el plano es un plano de matiz.</span><span class="sxs-lookup"><span data-stu-id="8dfee-828">In this case, the plane is a hue plane.</span></span> <span data-ttu-id="8dfee-829">Cada segmento de línea es el resultado de la intersección del plano con un triángulo de límite de gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-829">Each line segment is the result of intersecting the plane with a gamut boundary triangle.</span></span> <span data-ttu-id="8dfee-830">Aunque muchos investigadores han utilizado la construcción de intersección de un plano con triángulos de límite, generalmente analizan la relación entre estos segmentos de línea e intentan construir un objeto geométrico coherente fuera de los segmentos de línea.</span><span class="sxs-lookup"><span data-stu-id="8dfee-830">Although many researchers have used the construction of intersecting a plane with boundary triangles, they generally analyze the relationship among these line segments, and attempt to construct a coherent geometric object out of the line segments.</span></span> <span data-ttu-id="8dfee-831">Se han diseñado distintos algoritmos para seguir estos segmentos de línea uno tras otro hasta que se obtiene un segmento de matiz completo y se han realizado muchos intentos para acelerar el proceso de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="8dfee-831">Different algorithms have been devised to follow these line segments one after the other until a whole hue slice is obtained, and many attempts have been made to speed up the process of searching.</span></span>

<span data-ttu-id="8dfee-832">Este enfoque es diferente.</span><span class="sxs-lookup"><span data-stu-id="8dfee-832">This approach is different.</span></span> <span data-ttu-id="8dfee-833">Intersecte el plano con los triángulos para obtener los segmentos de línea.</span><span class="sxs-lookup"><span data-stu-id="8dfee-833">You intersect the plane with the triangles to obtain the line segments.</span></span> <span data-ttu-id="8dfee-834">A continuación, considere estos segmentos de línea como los objetos conceptuales *básicos* .</span><span class="sxs-lookup"><span data-stu-id="8dfee-834">You then consider these line segments as the *basic* conceptual objects.</span></span> <span data-ttu-id="8dfee-835">Es necesario analizar la relación entre los segmentos de línea; no es necesario saber cómo se interconectan entre sí.</span><span class="sxs-lookup"><span data-stu-id="8dfee-835">It is necessary to analyze the relationship among the line segments; you don't have to know how they are interconnected with each other.</span></span> <span data-ttu-id="8dfee-836">Este punto de vista resuelve el problema del segmento Hue con islas.</span><span class="sxs-lookup"><span data-stu-id="8dfee-836">This point of view solves the problem of hue slice with islands.</span></span> <span data-ttu-id="8dfee-837">Los enfoques conocidos que intentan construir un segmento de matiz suponen que, si uno comienza con un segmento de línea y lo sigue al segmento de línea siguiente, y así sucesivamente; Finalmente, vuelve al punto inicial, en el que se construirá un segmento de matiz entero.</span><span class="sxs-lookup"><span data-stu-id="8dfee-837">The known approaches that attempt to construct hue slice assume that, if one starts with one line segment and follows it to the next line segment, and so on; it eventually leads back to the starting point, at which point a whole hue slice would be constructed.</span></span> <span data-ttu-id="8dfee-838">Desafortunadamente, este enfoque omitiría la isla (y, en el peor de los casos, el continente).</span><span class="sxs-lookup"><span data-stu-id="8dfee-838">Unfortunately, this approach would miss the island (and in the worst scenario, the continent).</span></span> <span data-ttu-id="8dfee-839">No insistir en obtener una imagen geométrica coherente; es decir, el segmento Hue, puede controlar el problema de la isla sin esfuerzo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-839">By not insisting on obtaining a coherent geometric picture; that is, hue slice, you can handle the island problem effortlessly.</span></span> <span data-ttu-id="8dfee-840">Otra diferencia importante en este enfoque es que, para acelerar la construcción de segmentos de línea, usa un "filtro de triángulo".</span><span class="sxs-lookup"><span data-stu-id="8dfee-840">Another important difference in this approach is that, to speed up the construction of line segments, it uses a "triangle filter."</span></span> <span data-ttu-id="8dfee-841">El filtro de triángulo produce ciertos triángulos que no producirán definitivamente segmentos de línea que serían útiles en la operación de la gama actual.</span><span class="sxs-lookup"><span data-stu-id="8dfee-841">The triangle filter throws out certain triangles that will definitely not produce line segments that would be useful in the current gamut operation.</span></span> <span data-ttu-id="8dfee-842">Dado que la intersección de un triángulo con el plano es costosa, esto mejora la velocidad.</span><span class="sxs-lookup"><span data-stu-id="8dfee-842">Because intersecting a triangle with the plane is expensive computationally, this improves speed.</span></span> <span data-ttu-id="8dfee-843">Un efecto secundario es que, no se puede construir el segmento de matiz porque faltan algunos segmentos de línea debido al filtrado de triángulos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-843">A side effect is that, you cannot construct hue slice because some line segments would be missing due to the triangle filtering.</span></span>

### <a name="gamut-operation-checkgamut"></a><span data-ttu-id="8dfee-844">Operación de gama: CheckGamut</span><span class="sxs-lookup"><span data-stu-id="8dfee-844">Gamut Operation: CheckGamut</span></span>

<span data-ttu-id="8dfee-845">En el siguiente ejemplo se explica cómo funciona el marco de trabajo y cómo se realiza CheckGamut, es decir, la operación de comprobar si un color es en gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-845">The following example will explain how the framework works, and how CheckGamut is carried out, that is, the operation of checking if a color is in-gamut.</span></span>

<span data-ttu-id="8dfee-846">El marco de trabajo general se muestra en la siguiente figura 27.</span><span class="sxs-lookup"><span data-stu-id="8dfee-846">The general framework is illustrated in the following Figure 27.</span></span> <span data-ttu-id="8dfee-847">Hay varios componentes.</span><span class="sxs-lookup"><span data-stu-id="8dfee-847">There are various components.</span></span> <span data-ttu-id="8dfee-848">Los componentes con la etiqueta en cursiva son componentes que pueden ser diferentes en la implementación según la operación de gama en cuestión.</span><span class="sxs-lookup"><span data-stu-id="8dfee-848">The components labeled in italics are components that may be different in implementation depending on the gamut operation in question.</span></span> <span data-ttu-id="8dfee-849">Los demás componentes son invariables en todas las operaciones de gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-849">The other components are invariant across all gamut operations.</span></span> <span data-ttu-id="8dfee-850">Para empezar, la ***entrada*** es un conjunto de atributos de color.</span><span class="sxs-lookup"><span data-stu-id="8dfee-850">To begin, the ***Input*** is a set of color attributes.</span></span> <span data-ttu-id="8dfee-851">En el caso de CheckGamut, es el color de la consulta.</span><span class="sxs-lookup"><span data-stu-id="8dfee-851">In the case of CheckGamut, it is the query color.</span></span> <span data-ttu-id="8dfee-852">En la figura 27 y en la siguiente explicación, se supone que el ángulo de matiz está entre los atributos de color de entrada o se puede obtener a partir de ellos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-852">In Figure 27 and the following discussion, it is assumed that the hue angle is either among the input color attributes, or can be obtained from them.</span></span> <span data-ttu-id="8dfee-853">Esto es claramente el caso si la entrada es todo el punto de color, ya sea en jab o JCh, desde el que puede calcular el ángulo de matiz.</span><span class="sxs-lookup"><span data-stu-id="8dfee-853">This is clearly the case if the input is the whole color point, either in Jab or JCh, from which you can then compute the hue angle.</span></span> <span data-ttu-id="8dfee-854">Tenga en cuenta que el ángulo de matiz solo es necesario porque se usan planos de matiz.</span><span class="sxs-lookup"><span data-stu-id="8dfee-854">Note that the hue angle is only needed because hue planes are being used.</span></span> <span data-ttu-id="8dfee-855">Dependiendo de la operación de gama en cuestión, puede que no sea necesario usar el plano de matiz.</span><span class="sxs-lookup"><span data-stu-id="8dfee-855">Depending on the gamut operation in question, it might not be necessary to use the hue plane.</span></span> <span data-ttu-id="8dfee-856">Por ejemplo, en la construcción de la rutina CheckGamut, puede que desee usar planos de la constante J. Se trata de una generalidad que no se utilizará ni se explicará más detalladamente; pero podría ser útil recordar esta flexibilidad de la metodología para admitir otras operaciones de gama cuando el plano de matiz podría no ser la mejor opción.</span><span class="sxs-lookup"><span data-stu-id="8dfee-856">For example, in the construction of the routine CheckGamut, you might want to use planes of constant J. This is a generality that will not be used or discussed further; but it might be helpful to remember this flexibility of the methodology to support other gamut operations when hue plane might not be the best choice.</span></span>

![Diagrama que muestra el flujo para admitir las operaciones de gama.](images/gmmp-image112.jpg)

<span data-ttu-id="8dfee-858">**Figura 27** : el marco de trabajo para admitir las operaciones de gama</span><span class="sxs-lookup"><span data-stu-id="8dfee-858">**Figure 27** : The framework to support gamut operations</span></span>

<span data-ttu-id="8dfee-859">El ángulo de matiz, que se obtiene directamente de las entradas o calculadas a partir de las entradas, se usa para inicializar el plano de matiz etiquetado con el **plano de matiz completo** en la ilustración.</span><span class="sxs-lookup"><span data-stu-id="8dfee-859">The hue angle, which is obtained directly from the inputs or computed from the inputs, is used to initialize the hue plane labeled **Full Hue Plane** in the figure.</span></span> <span data-ttu-id="8dfee-860">"Full" se enfatiza porque es el plano completo, no solo el medio plano que contiene el matiz.</span><span class="sxs-lookup"><span data-stu-id="8dfee-860">"Full" is emphasized because this is the full plane, not just the half-plane containing the hue.</span></span> <span data-ttu-id="8dfee-861">El plano completo contiene tanto el ángulo de matiz de entrada como el ángulo de 180 grados opuestos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-861">The full plane contains both the input hue angle and the angle 180 degrees opposite to it.</span></span> <span data-ttu-id="8dfee-862">La funcionalidad clave del plano Hue es la función Intersect, que se explica en la siguiente subsección, plano de matiz completo: Intersect.</span><span class="sxs-lookup"><span data-stu-id="8dfee-862">The key functionality of the hue plane is the Intersect function, which is explained in the following subsection, Full Hue Plane: Intersect.</span></span> <span data-ttu-id="8dfee-863">Supongamos que ya se ha construido GBD y que el conjunto de **triángulos de límite de gama** está disponible.</span><span class="sxs-lookup"><span data-stu-id="8dfee-863">Assume that the GBD has already been constructed, and the set of **Gamut Boundary Triangles** is available.</span></span> <span data-ttu-id="8dfee-864">Intersecte los triángulos que han sobrevivido el \**_triángulo Filter_* _ con el plano Hue mediante Intersect.</span><span class="sxs-lookup"><span data-stu-id="8dfee-864">Intersect the triangles that have survived the \**_Triangle Filter_* _ with the hue plane using Intersect.</span></span> <span data-ttu-id="8dfee-865">El _componente de filtro de triángulo \* se etiqueta en cursiva, lo que significa que el componente varía en la implementación para distintas operaciones de gama. El *filtro de triángulo* de CheckGamut se explica en la sección operación de gama: CheckGamut (continuación). El resultado de la intersección entre un triángulo y el plano del matiz está vacío o es un elemento de la **línea de límite** , es decir, un par de puntos distintos. Si el resultado no está vacío, se pasa al procesador del elemento \**_line_*_ , que vuelve a ser diferente en función de la operación de la gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-865">The _Triangle Filter\* component is labeled in italics, which means that the component varies in implementation for different gamut operations. The *Triangle Filter* for CheckGamut is explained in the section, Gamut Operation: CheckGamut (continued). The result of intersecting a triangle with the hue plane is either empty or a **Boundary Line Element** , that is, a pair of distinct points. If the result is non-empty, it is passed into the \**_Line Element Processor_*_ , which again does different things depending on the gamut operation.</span></span> <span data-ttu-id="8dfee-866">El _elemento Line Processor \* actualiza la estructura de datos interna, \***datos procesados internamente**_ , cuyo contenido o diseño también depende de la operación de la gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-866">The _Line Element Processor\* updates the internal data structure, \***Internal Processed Data**_ , whose content or layout also depends on the gamut operation.</span></span> <span data-ttu-id="8dfee-867">Por lo general, los _datos procesados internos \* contienen la "respuesta" al problema, que se actualiza continuamente con cada nuevo elemento de línea de límite encontrado. Una vez procesados todos los elementos de línea de límite, se ha encontrado la respuesta. Sigue teniendo acceso a ella a través del **adaptador de salida**\*_.</span><span class="sxs-lookup"><span data-stu-id="8dfee-867">Generally, the _Internal Processed Data\* contains the "answer" to the problem, which is continually updated with each new Boundary Line Element found. When all the Boundary Line Elements have been processed, the answer has been found. It remains to access it through the \***Output Adaptor**_.</span></span> <span data-ttu-id="8dfee-868">Dado que la _Internal datos procesados \* es específica de la operación de gama, el *adaptador de salida* también es específico de la operación de gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-868">Because the _Internal Processed Data\* is gamut operation specific, the *Output Adaptor* is also gamut operation specific.</span></span>

### <a name="full-hue-plane-intersect"></a><span data-ttu-id="8dfee-869">Plano de matiz completo: Intersect</span><span class="sxs-lookup"><span data-stu-id="8dfee-869">Full Hue Plane: Intersect</span></span>

<span data-ttu-id="8dfee-870">La función Intersect calcula la intersección del plano de matiz y un triángulo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-870">The Intersect function calculates the intersection of the hue plane and a triangle.</span></span> <span data-ttu-id="8dfee-871">Tan sencillo como suena, esta función es importante por dos motivos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-871">As simple as it sounds, this function is important for two reasons.</span></span>

<span data-ttu-id="8dfee-872">En primer lugar, la intersección de cada borde del triángulo con el plano podría producir tres puntos de intersección, una situación geométricamente imposible.</span><span class="sxs-lookup"><span data-stu-id="8dfee-872">First, intersecting each edge of the triangle with the plane might yield three intersection points, a geometrically impossible situation.</span></span> <span data-ttu-id="8dfee-873">La razón por la que esto puede ocurrir en el cálculo es que, cuando los cálculos se realizan en el punto flotante, por ejemplo, el formato IEEE, faltan incertidumbres o un "ruido numérico" en cada paso que afecta a la conclusión de si un borde forma una intersección con el plano.</span><span class="sxs-lookup"><span data-stu-id="8dfee-873">The reason why this might happen in the computation is that, when calculations are done in floating point, for example, IEEE format, there are uncertainties, or "numeric noise," in each step that affects the conclusion of whether an edge intersects the plane.</span></span> <span data-ttu-id="8dfee-874">Cuando el plano forma una intersección con los bordes en una situación de casi sin errores, los puntos de intersección se encuentran cercanos entre sí y la determinación de si un punto de intersección se encuentra dentro del borde es aleatorio.</span><span class="sxs-lookup"><span data-stu-id="8dfee-874">When the plane intersects the edges in a near-miss situation, the intersection points are close to each other, and the determination whether an intersection point lies within the edge is random.</span></span> <span data-ttu-id="8dfee-875">Aunque el ruido en los valores numéricos de los puntos es pequeño, la conclusión cualitativa de que hay más de dos puntos de intersección es geométricamente imposible y difícil de controlar correctamente en el algoritmo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-875">Although noise in the numeric values of the points is small, the qualitative conclusion that there are more than two intersection points is geometrically impossible and difficult to handle correctly in the algorithm.</span></span>

<span data-ttu-id="8dfee-876">En segundo lugar, esta función está en el bucle crítico para cada borde de cada triángulo filtrado, por lo que es importante que optimice la eficacia en la medida de lo posible.</span><span class="sxs-lookup"><span data-stu-id="8dfee-876">Second, this function is in the critical loop for each edge of each filtered triangle, so it is important that you optimize its efficiency as much as possible.</span></span>

<span data-ttu-id="8dfee-877">Para resolver el primer problema de ruido numérico, realice los cálculos en enteros.</span><span class="sxs-lookup"><span data-stu-id="8dfee-877">To address the first issue Of numeric noise, perform the calculations in integers.</span></span> <span data-ttu-id="8dfee-878">Para solucionar el segundo problema de optimizar su eficacia, almacene en caché el atributo más usado de cada vértice o el "producto de punto" asociado a cada vértice.</span><span class="sxs-lookup"><span data-stu-id="8dfee-878">To address the second issue of optimizing its efficiency, cache the most used attribute of each vertex, or the "dot product" associated with each vertex.</span></span> <span data-ttu-id="8dfee-879">Pasar a enteros es una forma habitual de garantizar la coherencia geométrica.</span><span class="sxs-lookup"><span data-stu-id="8dfee-879">Passing into integers is a typical way to guarantee geometric consistency.</span></span> <span data-ttu-id="8dfee-880">La idea básica es que, si tiene que cuantificar, hágalo al principio.</span><span class="sxs-lookup"><span data-stu-id="8dfee-880">The basic idea is that if you have to quantize, do it at the beginning.</span></span> <span data-ttu-id="8dfee-881">Después, los cálculos posteriores se pueden realizar en enteros y, si los enteros son lo suficientemente amplios como para que no haya ningún riesgo de desbordamiento, los cálculos se pueden realizar con una precisión infinita.</span><span class="sxs-lookup"><span data-stu-id="8dfee-881">Then subsequent calculations can be performed in integers, and if the integers are wide enough so that there is no danger of overflow, the calculations can be done with infinite precision.</span></span> <span data-ttu-id="8dfee-882">La siguiente función de cuantificación útil para este fin.</span><span class="sxs-lookup"><span data-stu-id="8dfee-882">The following quantization function useful for this purpose.</span></span>

<span data-ttu-id="8dfee-883">ScaleAndTruncate (x) = parte entera de x \* 10000</span><span class="sxs-lookup"><span data-stu-id="8dfee-883">ScaleAndTruncate(x) = Integer part of x\*10000</span></span>

<span data-ttu-id="8dfee-884">El factor de escala 10000 significa que el número de punto flotante de entrada tiene cuatro posiciones decimales, lo que es lo suficientemente preciso para esta aplicación.</span><span class="sxs-lookup"><span data-stu-id="8dfee-884">The scaling factor 10000 means that the input floating-point number has four decimal places, which is precise enough for this application.</span></span> <span data-ttu-id="8dfee-885">En función del intervalo de valores del espacio de apariencia del color, querrá elegir un tipo de entero con el ancho de bits lo suficiente para contener los cálculos intermedios.</span><span class="sxs-lookup"><span data-stu-id="8dfee-885">Depending on the range of values of the color appearance space, you want to choose an integer type with bits wide enough to hold the intermediate calculations.</span></span> <span data-ttu-id="8dfee-886">En la mayoría de los espacios de apariencia de color, el intervalo de cada coordenada está en el intervalo de-1.000 a 1.000.</span><span class="sxs-lookup"><span data-stu-id="8dfee-886">In most color appearance spaces, the range of each coordinate is within the range -1,000 to 1,000.</span></span> <span data-ttu-id="8dfee-887">La coordenada cuantificada tiene un valor absoluto máximo posible de 1.000 \* 10.000 = 10 millones.</span><span class="sxs-lookup"><span data-stu-id="8dfee-887">The quantized coordinate has a maximum possible absolute value of 1,000\*10,000 = 10,000,000.</span></span> <span data-ttu-id="8dfee-888">Como verá, la cantidad intermedia es un producto de punto, que es una suma de dos productos de coordenadas, por lo que tiene un valor absoluto máximo posible de 2 \* (10 millones) ₂ = 2? 10 ₁ ₄.</span><span class="sxs-lookup"><span data-stu-id="8dfee-888">As you will see, the intermediate quantity is a dot product, which is a sum of two products of coordinates, so it has a maximum possible absolute value of 2\*(10,000,000) ₂ = 2?10 ₁₄.</span></span> <span data-ttu-id="8dfee-889">El número de bits necesario es ₂ de registro (2? 10 ₁ ₄) = 47,51.</span><span class="sxs-lookup"><span data-stu-id="8dfee-889">The number of bits required is log ₂ (2?10 ₁₄ ) = 47.51.</span></span> <span data-ttu-id="8dfee-890">Una opción conveniente para el tipo entero es, por lo tanto, enteros de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="8dfee-890">A convenient choice for the integer type is, therefore, 64-bit integers.</span></span>

<span data-ttu-id="8dfee-891">Para garantizar que la intersección de un plano con un triángulo siempre proporciona un conjunto vacío o un conjunto de dos puntos, debe considerar el triángulo como un todo, no como bordes individuales del triángulo por separado.</span><span class="sxs-lookup"><span data-stu-id="8dfee-891">To guarantee that intersecting a plane with a triangle always gives either empty set or a set of two points, you must consider the triangle as a whole, not as individual edges of the triangle separately.</span></span> <span data-ttu-id="8dfee-892">Para comprender la situación geométrica, tenga en cuenta las "distancias firmadas" de los vértices del triángulo del plano del matiz.</span><span class="sxs-lookup"><span data-stu-id="8dfee-892">To understand the geometric situation, consider the "signed distances" of the vertices of the triangle from the hue plane.</span></span> <span data-ttu-id="8dfee-893">No calcule estas distancias firmadas directamente; en su lugar, calcule los productos de punto de los vectores de posición de los vértices con el vector normal cuantificado al plano.</span><span class="sxs-lookup"><span data-stu-id="8dfee-893">Do not calculate these signed distances directly; instead calculate the dot products of the position vectors of the vertices with the quantized normal vector to the plane.</span></span> <span data-ttu-id="8dfee-894">Más concretamente, durante la inicialización del plano del matiz, el vector normal cuantificado se calcula como se indica a continuación.</span><span class="sxs-lookup"><span data-stu-id="8dfee-894">More specifically, during the initialization of the hue plane, the quantized normal vector is calculated as follows.</span></span>

<span data-ttu-id="8dfee-895">NormalVector = (ScaleAndTruncate (-sin (matiz)), ScaleAndTruncate (cos (Hue)))</span><span class="sxs-lookup"><span data-stu-id="8dfee-895">NormalVector = (ScaleAndTruncate(-sin(hue)), ScaleAndTruncate(cos(hue)))</span></span>

<span data-ttu-id="8dfee-896">Tenga en cuenta que este vector es un vector bidimensional.</span><span class="sxs-lookup"><span data-stu-id="8dfee-896">Note that this vector is a two-dimensional vector.</span></span> <span data-ttu-id="8dfee-897">Puede usar un vector bidimensional porque el plano del matiz es vertical, por lo que el tercer componente del vector normal siempre es cero.</span><span class="sxs-lookup"><span data-stu-id="8dfee-897">You can use a two-dimensional vector because the hue plane is vertical, so the third component of the normal vector is always zero.</span></span> <span data-ttu-id="8dfee-898">Además, se inicializa una tabla de búsqueda de productos de punto para tener una entrada para cada vértice de los triángulos de límite de la gama y el producto de punto correspondiente establecido en un valor no válido.</span><span class="sxs-lookup"><span data-stu-id="8dfee-898">Moreover, a lookup table of dot products is initialized to have an entry for each vertex from the Gamut Boundary Triangles and the corresponding dot product set to an invalid value.</span></span>

<span data-ttu-id="8dfee-899">Durante una operación de intersección con el plano de matiz con un triángulo, se busca el producto de punto de cada vértice del triángulo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-899">During one operation of intersecting the hue plane with a triangle, the dot product of each vertex of the triangle is looked up.</span></span> <span data-ttu-id="8dfee-900">Si el valor de la tabla de búsqueda es el valor no válido, el producto de punto se calcula mediante la siguiente expresión.</span><span class="sxs-lookup"><span data-stu-id="8dfee-900">If the value in the lookup table is the invalid value, then the dot product is computed using the following expression.</span></span>

<span data-ttu-id="8dfee-901">NormalVector. a \* ScaleAndTruncate (Vertex. a) + NormalVector. b \* ScaleAndTruncate (Vertex. b)</span><span class="sxs-lookup"><span data-stu-id="8dfee-901">NormalVector.a\*ScaleAndTruncate(vertex.a) + NormalVector.b\*ScaleAndTruncate(vertex.b)</span></span>

<span data-ttu-id="8dfee-902">De nuevo, el componente J del vértice nunca se usa, porque el vector normal es horizontal.</span><span class="sxs-lookup"><span data-stu-id="8dfee-902">Again, the J-component of the vertex is never used, because the normal vector is horizontal.</span></span> <span data-ttu-id="8dfee-903">Este producto dot se guarda en la tabla de búsqueda para que no tenga que volver a calcularse si el producto del punto del vértice se consulta posteriormente.</span><span class="sxs-lookup"><span data-stu-id="8dfee-903">This dot product is then saved in the lookup table so that it doesn't have to be computed again if the dot product of the vertex is queried later.</span></span>

<span data-ttu-id="8dfee-904">El almacenamiento en caché permite una determinación rápida de si un borde forma una intersección con el plano, una vez que los productos de punto se tabulan en la tabla de búsqueda, que se genera progresivamente a medida que se procesan los vértices.</span><span class="sxs-lookup"><span data-stu-id="8dfee-904">Caching allows for a quick determination of whether an edge intersects the plane, after the dot products are tabulated in the lookup table, which is built progressively as the vertices are processed.</span></span>

![Diagrama que muestra la intersección del plano de matiz con un triángulo.](images/gmmp-image114.jpg)

<span data-ttu-id="8dfee-906">**Figura 28** : intersección del plano de matiz con un triángulo</span><span class="sxs-lookup"><span data-stu-id="8dfee-906">**Figure 28** : Intersecting the hue plane with a triangle</span></span>

<span data-ttu-id="8dfee-907">Para que el triángulo de la figura 28 intersecte el plano de matiz en un segmento de línea no generada, los productos de punto de los vértices deben estar en uno de los siguientes patrones, cuando se ordenen en orden ascendente.</span><span class="sxs-lookup"><span data-stu-id="8dfee-907">For the triangle in Figure 28 to intersect the hue plane in a non-degenerate line segment, the dot products of the vertices must be in one of the following patterns, when sorted in ascending order.</span></span>

<span data-ttu-id="8dfee-908">0, 0, +; -,0; 0; -, 0, +; -,-,+; -,+,+</span><span class="sxs-lookup"><span data-stu-id="8dfee-908">0,0,+; -,0,0; -,0,+; -,-,+; -,+,+</span></span>

<span data-ttu-id="8dfee-909">Se produce un extremo del segmento de línea cuando un borde intersecta con vértices que tienen signos diferentes en el producto de punto.</span><span class="sxs-lookup"><span data-stu-id="8dfee-909">An end point of the line segment arises when the plane is intersected by an edge with vertices that have different signs in the dot product.</span></span> <span data-ttu-id="8dfee-910">Si el signo es cero, el vértice se encuentra justo en el plano y la intersección del borde con el plano es el propio vértice.</span><span class="sxs-lookup"><span data-stu-id="8dfee-910">If the sign is zero, then the vertex lies right on the plane, and the intersection of the edge with the plane is the vertex itself.</span></span> <span data-ttu-id="8dfee-911">Tenga en cuenta también que los casos 0, 0,0; -,-, 0; 0, +, + no se indican.</span><span class="sxs-lookup"><span data-stu-id="8dfee-911">Note also that the cases 0,0,0; -,-,0; 0,+,+ are not reported.</span></span> <span data-ttu-id="8dfee-912">El primer caso (0,0) significa que el triángulo entero está en el plano.</span><span class="sxs-lookup"><span data-stu-id="8dfee-912">The first case (0,0,0) means the whole triangle lies on the plane.</span></span> <span data-ttu-id="8dfee-913">Esto no se muestra porque cada borde del triángulo debe pertenecer a un triángulo adyacente que no está completamente en el plano.</span><span class="sxs-lookup"><span data-stu-id="8dfee-913">This is not reported because each edge of the triangle should belong to a neighboring triangle that does not also lie entirely on the plane.</span></span> <span data-ttu-id="8dfee-914">El borde se informará cuando se tenga en cuenta ese triángulo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-914">The edge will be reported when that triangle is considered.</span></span> <span data-ttu-id="8dfee-915">Los otros dos casos (-,-, 0 y 0, +, +) se corresponden con la configuración geométrica en la que el triángulo toca el plano en un vértice.</span><span class="sxs-lookup"><span data-stu-id="8dfee-915">The other two cases (-,-,0 and 0,+,+) correspond to the geometric configuration that the triangle touches the plane in one vertex.</span></span> <span data-ttu-id="8dfee-916">Estos casos no se indican porque no dan lugar a un segmento de línea no generada.</span><span class="sxs-lookup"><span data-stu-id="8dfee-916">These cases are not reported because they don't give rise to a non-degenerate line segment.</span></span>

<span data-ttu-id="8dfee-917">El algoritmo anterior determina cuándo calcular una intersección entre un borde del triángulo y el plano del matiz.</span><span class="sxs-lookup"><span data-stu-id="8dfee-917">The preceding algorithm determines when to calculate an intersection between an edge of the triangle and the hue plane.</span></span> <span data-ttu-id="8dfee-918">Una vez determinado un borde, la intersección se calcula mediante ecuaciones paramétricas.</span><span class="sxs-lookup"><span data-stu-id="8dfee-918">After an edge is determined, the intersection is calculated using parametric equations.</span></span> <span data-ttu-id="8dfee-919">Si uno de los productos de punto es cero, la intersección es el propio vértice, por lo que no es necesario realizar ningún cálculo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-919">If one of the dot products is zero, the intersection is the vertex itself, so no calculation is necessary.</span></span> <span data-ttu-id="8dfee-920">Suponiendo que los dos productos de punto de los vértices del borde son distintos de cero, vertex1 es el vértice con el producto de punto *negativo* dotProduct1; y vertex2 es el vértice con dotProduct2 de producto de punto *positivo* .</span><span class="sxs-lookup"><span data-stu-id="8dfee-920">Assuming that both dot products of the vertices of the edge are non-zero , vertex1 is the vertex with *negative* dot product dotProduct1; and vertex2 is the vertex with *positive* dot product dotProduct2.</span></span> <span data-ttu-id="8dfee-921">Este orden es importante para asegurarse de que el punto de intersección calculado no depende de cómo aparezca el orden de los vértices en la representación del borde.</span><span class="sxs-lookup"><span data-stu-id="8dfee-921">This order is important to ensure that the calculated intersection point does not depend on how the ordering of the vertices appears in the representation of the edge.</span></span> <span data-ttu-id="8dfee-922">El concepto geométrico del borde es simétrico con respecto a sus vértices.</span><span class="sxs-lookup"><span data-stu-id="8dfee-922">The geometric concept of the edge is symmetrical with respect to its vertices.</span></span> <span data-ttu-id="8dfee-923">El aspecto computacional del uso de ecuaciones paramétricas del borde presenta asimetría (elección del vértice inicial), que puede dar un punto de intersección ligeramente diferente debido al ruido numérico y el acondicionamiento de las ecuaciones lineales que se van a resolver.</span><span class="sxs-lookup"><span data-stu-id="8dfee-923">The computational aspect of using parametric equations of the edge introduces asymmetry (choice of starting vertex), which may give a slightly different intersection point due to numeric noise and conditioning of the linear equations to be solved.</span></span> <span data-ttu-id="8dfee-924">Con esto, el punto de intersección, la intersección, viene determinado por lo siguiente.</span><span class="sxs-lookup"><span data-stu-id="8dfee-924">With this said, the intersection point, intersection,is given by the following.</span></span>

<span data-ttu-id="8dfee-925">t = dotProduct1/(dotProduct1-dotProduct2)</span><span class="sxs-lookup"><span data-stu-id="8dfee-925">t = dotProduct1/(dotProduct1 - dotProduct2)</span></span>

<span data-ttu-id="8dfee-926">intersección. J = vertex1. J + t \* (vertex2. J-vertex1. J</span><span class="sxs-lookup"><span data-stu-id="8dfee-926">intersection.J = vertex1.J + t \* (vertex2.J - vertex1.J)</span></span>

<span data-ttu-id="8dfee-927">Intersection. a = vertex1. a + t \* (vertex2. a-vertex1. a)</span><span class="sxs-lookup"><span data-stu-id="8dfee-927">intersection.a = vertex1.a + t \* (vertex2.a - vertex1.a)</span></span>

<span data-ttu-id="8dfee-928">Intersection. b = vertex1. b + t \* (vertex2. b-vertex1. b)</span><span class="sxs-lookup"><span data-stu-id="8dfee-928">intersection.b = vertex1.b + t \* (vertex2.b - vertex1.b)</span></span>

### <a name="gamut-operation-checkgamut-continued"></a><span data-ttu-id="8dfee-929">Operación de gama: CheckGamut (continuación)</span><span class="sxs-lookup"><span data-stu-id="8dfee-929">Gamut Operation: CheckGamut (continued)</span></span>

<span data-ttu-id="8dfee-930">El algoritmo geométrico básico que se usa para la comprobación de la gama es contar el número de cruces de rayos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-930">The basic geometric algorithm used for gamut checking is to count the number of ray crossings.</span></span> <span data-ttu-id="8dfee-931">Para un punto de consulta determinado, considere la posibilidad de usar un rayo empezando por el punto de consulta y apuntando hacia arriba (Dirección J).</span><span class="sxs-lookup"><span data-stu-id="8dfee-931">For a given query point, consider a ray starting with the query point and pointing upwards (J-direction).</span></span> <span data-ttu-id="8dfee-932">Cuente el número de veces que este rayo cruza el límite de la gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-932">Count the number of times this ray crosses the gamut boundary.</span></span> <span data-ttu-id="8dfee-933">Si este número es par, el punto de consulta está fuera de la gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-933">If this number is even, then the query point is out-of-gamut.</span></span> <span data-ttu-id="8dfee-934">Si este número es impar, el punto está dentro de.</span><span class="sxs-lookup"><span data-stu-id="8dfee-934">If this number is odd, the point is inside.</span></span> <span data-ttu-id="8dfee-935">En principio, este algoritmo se puede implementar en 3D; por lo general, está plagada por las dificultades ocasionadas por situaciones degeneradas, como el rayo que se encuentra (en parte) en un triángulo límite o degeneracys de menor dimensiones, como el rayo que se encuentra en un borde de un triángulo de límite.</span><span class="sxs-lookup"><span data-stu-id="8dfee-935">In principle, this algorithm can be implemented in 3-D, it is generally plagued by difficulties caused by degenerate situations, such as the ray lying (partly) on a boundary triangle, or lower dimensional degeneracy, such as the ray lying (partly) on an edge of a boundary triangle.</span></span> <span data-ttu-id="8dfee-936">Incluso en 2-D, tiene que tratar con estas situaciones degeneradas: pero el problema es más sencillo y se ha solucionado de manera satisfactoria.</span><span class="sxs-lookup"><span data-stu-id="8dfee-936">Even in 2-D, you have to deal with these degenerate situations; but the problem is simpler and has been addressed in a satisfactory manner.</span></span> <span data-ttu-id="8dfee-937">Vea \[ O'Rourke \] .</span><span class="sxs-lookup"><span data-stu-id="8dfee-937">See \[O'Rourke\].</span></span>

<span data-ttu-id="8dfee-938">Para un punto de entrada determinado jab, determine el ángulo de matiz h como se indica a continuación.</span><span class="sxs-lookup"><span data-stu-id="8dfee-938">For a given input point Jab, determine its hue angle h as follows.</span></span>

<span data-ttu-id="8dfee-939">h = atan (b/a),</span><span class="sxs-lookup"><span data-stu-id="8dfee-939">h = atan(b/a),</span></span>

<span data-ttu-id="8dfee-940">Inicialice el plano de matiz y, a continuación, determine los elementos de línea de límite correspondientes a este plano de matiz.</span><span class="sxs-lookup"><span data-stu-id="8dfee-940">Initialize the hue plane, and then determine the Boundary Line Elements corresponding to this hue plane.</span></span> <span data-ttu-id="8dfee-941">Dado que los elementos de línea de límite solo son relevantes si forman una intersección con el rayo hacia arriba, configure un filtro de triángulo para quitar triángulos que proporcionen elementos de línea que definitivamente no intersectarán con el rayo ascendente.</span><span class="sxs-lookup"><span data-stu-id="8dfee-941">Because the Boundary Line Elements are only relevant if they intersect the upward ray, set up a Triangle Filter to remove triangles that give line elements that definitely will not intersect the upward ray.</span></span> <span data-ttu-id="8dfee-942">En este caso, considere el rectángulo de selección del triángulo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-942">In this case, consider the bounding box of the triangle.</span></span> <span data-ttu-id="8dfee-943">El rayo hacia arriba no intersectará el triángulo si el punto de consulta está fuera de la conversión de "sombra" por el cuadro de límite si una fuente de luz estaba justo encima.</span><span class="sxs-lookup"><span data-stu-id="8dfee-943">The upward ray will not intersect the triangle if the query point is outside the "shadow" cast by the bounding box if a light source was directly above.</span></span> <span data-ttu-id="8dfee-944">Inflarlo ligeramente con una tolerancia prefijada para permitir ruido numérico, de modo que no se produzcan de manera inadvertida triángulos que puedan proporcionar elementos de línea útiles.</span><span class="sxs-lookup"><span data-stu-id="8dfee-944">Inflate this slightly with a pre-fixed tolerance to allow for numeric noise so that you don't inadvertently throw away triangles that might give useful line elements.</span></span> <span data-ttu-id="8dfee-945">El resultado es el cilindro rectangular semiinfinito que se muestra en la Figura 29.</span><span class="sxs-lookup"><span data-stu-id="8dfee-945">The result is the semi-infinite rectangular cylinder shown in Figure 29.</span></span> <span data-ttu-id="8dfee-946">La comprobación de si el punto de consulta está dentro o fuera de este cilindro se puede implementar eficazmente mediante desigualdades simples.</span><span class="sxs-lookup"><span data-stu-id="8dfee-946">Checking whether the query point is inside or outside this cylinder can be efficiently implemented using simple inequalities.</span></span>

![Muestra el filtro de triángulo para CheckGamut.](images/gmmp-image116.jpg)

<span data-ttu-id="8dfee-948">**Figura 29** : filtro de triángulo para CheckGamut</span><span class="sxs-lookup"><span data-stu-id="8dfee-948">**Figure 29** : Triangle Filter for CheckGamut</span></span>

<span data-ttu-id="8dfee-949">CheckGamut tiene tres componentes específicos de operación de gama: *datos procesados internos*,*procesador de elementos de línea* y adaptador de *salida*.</span><span class="sxs-lookup"><span data-stu-id="8dfee-949">CheckGamut has three gamut operation specific components: *Internal Processed Data*,*Line Element Processor*, and *Output Adaptor*.</span></span> <span data-ttu-id="8dfee-950">Los *datos procesados internos* son una lista de elementos de línea procesados por el *procesador de elementos de línea*.</span><span class="sxs-lookup"><span data-stu-id="8dfee-950">The *Internal Processed Data* is a list of line elements that have been processed by *Line Element Processor*.</span></span> <span data-ttu-id="8dfee-951">En este caso, el *procesador del elemento de línea* simplemente agrega un elemento de línea a la lista.</span><span class="sxs-lookup"><span data-stu-id="8dfee-951">In this case, the *Line Element Processor* simply adds a line element to the list.</span></span> <span data-ttu-id="8dfee-952">La estructura de datos interna para los *datos procesados internos* puede ser una lista vinculada o una matriz que pueda aumentar de tamaño.</span><span class="sxs-lookup"><span data-stu-id="8dfee-952">The internal data structure for *Internal Processed Data* can be either a linked list or an array that can grow in size.</span></span>

<span data-ttu-id="8dfee-953">El *adaptador de salida* es un módulo que tiene acceso a la lista de elementos de línea, determina si un elemento de línea cruza el rayo hacia arriba (recuento 1) o no (recuento 0).</span><span class="sxs-lookup"><span data-stu-id="8dfee-953">The *Output Adaptor* is a module that accesses the list of line elements, determines if a line element crosses the upward ray (count 1) or not (count 0).</span></span> <span data-ttu-id="8dfee-954">La suma de todos estos recuentos ofrece un recuento total.</span><span class="sxs-lookup"><span data-stu-id="8dfee-954">Summing all these counts gives a total count.</span></span> <span data-ttu-id="8dfee-955">En última instancia, el *adaptador de salida* da como resultado una respuesta de "sí" (en gama) o "no" (fuera de la gama), dependiendo de si el recuento total es impar o uniforme.</span><span class="sxs-lookup"><span data-stu-id="8dfee-955">The *Output Adaptor* ultimately outputs an answer of "yes" (in-gamut) or "no" (out-of-gamut), depending on whether the total count is odd or even.</span></span> <span data-ttu-id="8dfee-956">El paso en el que se determina si un elemento de línea cruza el rayo ascendente merece la atención porque aquí es donde se produce el problema de degeneracy y también surge el problema de exceso de recuento.</span><span class="sxs-lookup"><span data-stu-id="8dfee-956">The step where you determine if a line element crosses the upward ray deserves some attention because this is where the problem of degeneracy arises and also the problem of over-counting arises.</span></span> <span data-ttu-id="8dfee-957">Después de \[ O'Rourke \] , para que un elemento de línea cruce el rayo, el extremo derecho (el punto final con intensidad de croma mayor) debe estar en el lado derecho del rayo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-957">Following \[O'Rourke\], for a line element to cross the ray, the right end point (the end point with larger chroma) must be strictly on the right side of the ray.</span></span> <span data-ttu-id="8dfee-958">Esto garantiza que, si un punto final se basa exactamente en el rayo, solo se cuenta una vez.</span><span class="sxs-lookup"><span data-stu-id="8dfee-958">This guarantees that, if an end point ever lies exactly on the ray, it is only counted one time.</span></span> <span data-ttu-id="8dfee-959">La misma regla también resuelve la situación degenerada en la que el elemento de línea está exactamente en el rayo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-959">The same rule also solves the degenerate situation where the line element lies exactly on the ray.</span></span> <span data-ttu-id="8dfee-960">No se incrementa el recuento para este elemento de línea.</span><span class="sxs-lookup"><span data-stu-id="8dfee-960">You do not increment the count for this line element.</span></span>

<span data-ttu-id="8dfee-961">En la figura 30 se muestran los elementos de línea resultantes de una gama de muestras con el punto de consulta en varias posiciones.</span><span class="sxs-lookup"><span data-stu-id="8dfee-961">Figure 30 shows the resulting line elements of a sample gamut with the query point in various positions.</span></span>

![Diagrama que muestra los elementos de línea resultantes de una gama de muestras con el punto de consulta en varias posiciones.](images/gmmp-image118.jpg)

<span data-ttu-id="8dfee-963">**Figura 30** : funcionamiento de CheckGamut</span><span class="sxs-lookup"><span data-stu-id="8dfee-963">**Figure 30** : How CheckGamut works</span></span>

### <a name="minimum-color-difference-gamut-mapping"></a><span data-ttu-id="8dfee-964">Asignación mínima de gama de diferencias de color</span><span class="sxs-lookup"><span data-stu-id="8dfee-964">Minimum Color Difference Gamut Mapping</span></span>

<span data-ttu-id="8dfee-965">La asignación mínima de gama de diferencias de color, MinDEMap, tiene una especificación simple: Si un color es en gama, no haga nada.</span><span class="sxs-lookup"><span data-stu-id="8dfee-965">The Minimum Color Difference Gamut Mapping, MinDEMap, has a simple specification: If a color is in-gamut, do nothing.</span></span> <span data-ttu-id="8dfee-966">Si un color está fuera de la gama, se proyecta en el punto "más cercano" en el límite de la gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-966">If a color is out-of-gamut, project it to the "nearest" point on the gamut boundary.</span></span> <span data-ttu-id="8dfee-967">La palabra clave "más cercana" no está bien definida hasta que se especifica la ecuación de diferencia de color que se va a usar.</span><span class="sxs-lookup"><span data-stu-id="8dfee-967">The keyword "nearest" is not well-defined until you specify which color difference equation to use.</span></span> <span data-ttu-id="8dfee-968">En la práctica, para hacer que el cálculo sea más fácil y rápido, la distancia euclidiana del espacio de apariencia del color elegido, o una variante de él, se usa como la métrica de diferencia de color.</span><span class="sxs-lookup"><span data-stu-id="8dfee-968">In practice, to make computation easier and faster, the Euclidean distance of the chosen color appearance space, or a variant of it, is used as the color difference metric.</span></span> <span data-ttu-id="8dfee-969">La ventaja de la métrica euclidiana es que es compatible con el producto punto del espacio, lo que hace posible usar álgebra lineal.</span><span class="sxs-lookup"><span data-stu-id="8dfee-969">The advantage of the Euclidean metric is that it is compatible with the dot product of the space, which makes it possible to use linear algebra.</span></span> <span data-ttu-id="8dfee-970">En detalle, si se define un "producto de punto" en el espacio, se puede definir una distancia como la raíz cuadrada del producto de puntos del vector de diferencia.</span><span class="sxs-lookup"><span data-stu-id="8dfee-970">In detail, if a "dot product" is defined in the space, then a distance can be defined as the square root of the dot product of the difference vector with itself.</span></span> <span data-ttu-id="8dfee-971">Un producto de punto se puede definir generalmente mediante una matriz de 3x3 delimitada positiva.</span><span class="sxs-lookup"><span data-stu-id="8dfee-971">A dot product can generally be defined by a positive definite 3x3 matrix A.</span></span>

<span data-ttu-id="8dfee-972">u? v = u <sub>T</sub> AV</span><span class="sxs-lookup"><span data-stu-id="8dfee-972">u?v = u <sub>T</sub> Av</span></span>

<span data-ttu-id="8dfee-973">donde el lado derecho es la multiplicación de matrices usual.</span><span class="sxs-lookup"><span data-stu-id="8dfee-973">where the right hand side is the usual matrix multiplication.</span></span> <span data-ttu-id="8dfee-974">Si es la matriz de identidad, se recupera el producto de punto estándar.</span><span class="sxs-lookup"><span data-stu-id="8dfee-974">If A is the identity matrix, the standard dot product is recovered.</span></span> <span data-ttu-id="8dfee-975">En la práctica, si jab es el espacio de colores, no desea mezclar los componentes, por lo que se puede usar una matriz diagonal distinta de la matriz de identidades.</span><span class="sxs-lookup"><span data-stu-id="8dfee-975">In practice, if Jab is the color space, you do not want to mix up the components, so a diagonal matrix other than the identity matrix can be used.</span></span> <span data-ttu-id="8dfee-976">Además, es posible que desee mantener la escala en y b sin cambios, de modo que se conserve la medida de matiz.</span><span class="sxs-lookup"><span data-stu-id="8dfee-976">In addition, you might want to keep the scale on a and b unchanged so that the measure of hue is preserved.</span></span> <span data-ttu-id="8dfee-977">Por lo tanto, una variación útil del producto euclidiana DOT estándar es la siguiente.</span><span class="sxs-lookup"><span data-stu-id="8dfee-977">So a useful variation of the standard Euclidean dot product is the following.</span></span>

<span data-ttu-id="8dfee-978"><sub>j</sub> (j componente) (j Component of v) + (un componente de usted) (un componente de v) + (componente b de usted) (componente b de v)</span><span class="sxs-lookup"><span data-stu-id="8dfee-978">w <sub>J</sub> (J component of u)(J component of v) + (a component of u)(a component of v) + (b component of u)(b component of v)</span></span>

<span data-ttu-id="8dfee-979">donde w <sub>J</sub> es un número positivo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-979">where w <sub>J</sub> is a positive number.</span></span> <span data-ttu-id="8dfee-980">Una variación adicional consiste en permitir que <sub>j</sub> varíe con el punto de consulta de entrada:</span><span class="sxs-lookup"><span data-stu-id="8dfee-980">One further variation is to let w <sub>J</sub> vary with the input query point:</span></span>

<span data-ttu-id="8dfee-981">w <sub>j \ =</sub> w <sub>(queryPoint</sub> )</span><span class="sxs-lookup"><span data-stu-id="8dfee-981">w <sub>J\ =</sub> w <sub>J</sub> (queryPoint)</span></span>

<span data-ttu-id="8dfee-982">El resultado final es una medida de distancia que es asimétrica con respecto a los dos puntos, y con diferentes pesos relativos en la luminosidad y croma o el matiz según varíe el punto de consulta de entrada.</span><span class="sxs-lookup"><span data-stu-id="8dfee-982">The end result is a measure of distance that is asymmetric with respect to the two points, and with different relative weights on lightness and chroma or hue as the input query point varies.</span></span> <span data-ttu-id="8dfee-983">Esto está en consonancia con algunas observaciones sobre la percepción de color humano de que las diferencias de color no se ponderan equitativamente en todas las dimensiones.</span><span class="sxs-lookup"><span data-stu-id="8dfee-983">This is in accordance with some observations about human color perception that color differences are not weighted equally in all dimensions.</span></span> <span data-ttu-id="8dfee-984">Se ha descubierto que las personas son menos sensibles a las diferencias en cuanto a la luminosidad que las diferencias de matiz y croma.</span><span class="sxs-lookup"><span data-stu-id="8dfee-984">It has been found that people are less sensitive to differences in lightness than they are to differences in hue and chroma.</span></span>

<span data-ttu-id="8dfee-985">La siguiente función de peso es útil.</span><span class="sxs-lookup"><span data-stu-id="8dfee-985">The following weight function is useful.</span></span>

<span data-ttu-id="8dfee-986">w <sub>J</sub> = k ₂-k ₁ (C-c m ₐ ₓ) n</span><span class="sxs-lookup"><span data-stu-id="8dfee-986">w <sub>J</sub> = k ₂ - k ₁ (C - C ₘₐₓ ) ₙ</span></span>

<span data-ttu-id="8dfee-987">donde k ₂ = 1, k ₁ = 0,75/(C m ₐ ₓ) n, C m ₐ ₓ = 100, n = 2 y C es el menor de croma del punto de consulta y C m ₐ ₓ.</span><span class="sxs-lookup"><span data-stu-id="8dfee-987">where k ₂ = 1, k ₁ = 0.75/(C ₘₐₓ ) ₙ, C ₘₐₓ = 100, n = 2 and C is the smaller of chroma of the query point and C ₘₐₓ.</span></span>

<span data-ttu-id="8dfee-988">de modo que el peso de 0,25 se coloca en el término J cuando el croma es cero y un peso de 1 cuando el croma es 100.</span><span class="sxs-lookup"><span data-stu-id="8dfee-988">so that a weight of 0.25 is put on the J term when chroma is zero, and a weight of 1 when chroma is 100.</span></span> <span data-ttu-id="8dfee-989">Tendencia de colocar menos peso en J cuando el croma es pequeño y más peso en J cuando el croma es grande sigue el uso recomendado para CMC y CIEDE2000.</span><span class="sxs-lookup"><span data-stu-id="8dfee-989">The trend of putting less weight on J when chroma is small, and more weight on J when chroma is large follows the recommended usage for CMC and CIEDE2000.</span></span>

![Gráfico que muestra la función de peso en el componente J de la métrica.](images/gmmp-image119.png)

<span data-ttu-id="8dfee-991">**Figura 31** : función de peso en el componente J de la métrica</span><span class="sxs-lookup"><span data-stu-id="8dfee-991">**Figure 31** : The weight function on the J component of the metric</span></span>

<span data-ttu-id="8dfee-992">Use el espacio jab para el siguiente ejemplo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-992">Use Jab space for the following example.</span></span> <span data-ttu-id="8dfee-993">Exige que se busque en todos los triángulos de límite para determinar el punto más cercano de la métrica euclidiana.</span><span class="sxs-lookup"><span data-stu-id="8dfee-993">It is computationally demanding to search through all the boundary triangles to determine the closest point in the Euclidean metric.</span></span> <span data-ttu-id="8dfee-994">El siguiente es un enfoque sencillo para que este proceso sea lo más eficaz posible, sin introducir suposiciones adicionales que puedan acelerar el proceso, pero que también acaben en una respuesta aproximada.</span><span class="sxs-lookup"><span data-stu-id="8dfee-994">The following is a simple approach to make this process as efficient as possible, without introducing additional assumptions that may speed up the process but also end up in only an approximate answer.</span></span> <span data-ttu-id="8dfee-995">En primer lugar, es necesario comprender el procedimiento geométrico de proyectar un punto en el triángulo determinado.</span><span class="sxs-lookup"><span data-stu-id="8dfee-995">First, it is necessary to understand the geometric procedure of projecting a point onto the given triangle.</span></span> <span data-ttu-id="8dfee-996">Aquí se proporciona una descripción.</span><span class="sxs-lookup"><span data-stu-id="8dfee-996">A description is given here.</span></span>

<span data-ttu-id="8dfee-997">Primero se realiza una proyección ortogonal en el plano infinito que contiene el triángulo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-997">An orthogonal projection onto the infinite plane containing the triangle is first performed.</span></span> <span data-ttu-id="8dfee-998">La distancia más corta del punto de consulta del plano puede determinarse en dos pasos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-998">The shortest distance of the query point from the plane can be determined in two steps.</span></span>

<span data-ttu-id="8dfee-999">**(a)** calcule el vector normal de la unidad al triángulo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-999">**(a)** Calculate the unit normal vector to the triangle.</span></span>

<span data-ttu-id="8dfee-1000">**(b)** calcular el producto de punto del vector de unidad normal y un vector formado a partir del punto de consulta y un punto en el triángulo; es decir, uno de sus vértices.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1000">**(b)** Calculate the dot product of the unit normal vector and a vector formed from the query point and a point on the triangle; that is, one of its vertices.</span></span> <span data-ttu-id="8dfee-1001">Dado que el vector normal tiene una longitud de unidad, el valor absoluto de este producto de punto es la distancia del punto de consulta del plano.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1001">Because the normal vector has unit length, the absolute value of this dot product is the distance of the query point from the plane.</span></span>

<span data-ttu-id="8dfee-1002">El punto proyectado podría no ser la respuesta porque podría estar fuera del triángulo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1002">The projected point might not be the answer, because it might lie outside the triangle.</span></span> <span data-ttu-id="8dfee-1003">Por lo tanto, debe realizar una comprobación primero.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1003">So, you must perform a check first.</span></span> <span data-ttu-id="8dfee-1004">El cálculo es equivalente a calcular las coordenadas Barycentric del punto proyectado en relación con el triángulo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1004">The calculation is equivalent to calculating the barycentric coordinates of the projected point relative to the triangle.</span></span> <span data-ttu-id="8dfee-1005">Si se determina que el punto proyectado está dentro del triángulo, es la respuesta.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1005">If the projected point is determined to be inside the triangle, it is the answer.</span></span> <span data-ttu-id="8dfee-1006">Si no es así, se adquiere el punto más cercano en uno de los bordes del triángulo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1006">If not, the closest point is acquired on one of the edges of the triangle.</span></span> <span data-ttu-id="8dfee-1007">Realice una búsqueda en cada uno de los tres bordes.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1007">Perform a search on each of the three edges.</span></span> <span data-ttu-id="8dfee-1008">Determinar la proyección del punto de consulta en un borde es un proceso similar a la proyección en el triángulo, pero una dimensión es menor.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1008">Determining the projection of the query point onto an edge is a process similar to projection onto the triangle, but one dimension less.</span></span> <span data-ttu-id="8dfee-1009">Primero se calcula una proyección ortogonal.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1009">An orthogonal projection is first calculated.</span></span> <span data-ttu-id="8dfee-1010">Si el punto proyectado se encuentra en el borde, es la respuesta.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1010">If the projected point lies on the edge, it is the answer.</span></span> <span data-ttu-id="8dfee-1011">En caso contrario, se adquiere el punto más cercano en uno de los dos extremos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1011">If not, the closest point is acquired on one of the two end points.</span></span> <span data-ttu-id="8dfee-1012">Realice una búsqueda en los dos extremos; es decir, calcule la distancia del punto de consulta de cada uno de ellos y compare cuál es el más pequeño.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1012">Perform a search on the two end points; that is, calculate the distance of query point from each one, and compare which one is smaller.</span></span>

<span data-ttu-id="8dfee-1013">Un examen cuidadoso revela que hay muchas búsquedas repetidas cuando se recorren todos los triángulos porque un borde siempre se comparte con dos triángulos y un vértice compartido por al menos tres bordes.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1013">Careful examination reveals that there is a lot of repeated searching when you go through all the triangles because an edge is always shared by two triangles, and a vertex shared by at least three edges.</span></span> <span data-ttu-id="8dfee-1014">Además, no está muy interesado en encontrar el punto más cercano a un triángulo determinado; en su lugar, le interesa encontrar el punto más cercano a todo el límite de la gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1014">In addition, you are not much interested in finding the closest point to one particular triangle; instead you are interested in finding the closest point to the whole gamut boundary.</span></span> <span data-ttu-id="8dfee-1015">Sin embargo, un triángulo determinado sería el en el que se consigue.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1015">However,one particular triangle would be the one in which this is achieved.</span></span> <span data-ttu-id="8dfee-1016">Hay dos estrategias que puede usar para acelerar la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1016">There are two strategies that you can use to speed up the search.</span></span>

<span data-ttu-id="8dfee-1017">**Estrategia I**. Cada vértice se procesará, como máximo, una vez.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1017">**Strategy I**. Each vertex will be processed, at most, once.</span></span> <span data-ttu-id="8dfee-1018">Cada borde se procesará, como máximo, una vez.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1018">Each edge will be processed, at most, once.</span></span>

<span data-ttu-id="8dfee-1019">**Estrategia II**.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1019">**Strategy II**.</span></span> <span data-ttu-id="8dfee-1020">En cualquier momento de la búsqueda, tiene un mejor candidato con la mejor distancia correspondiente.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1020">At any point in the search, you have a best candidate with the corresponding best distance.</span></span> <span data-ttu-id="8dfee-1021">Si puede determinar, mediante una comprobación rápida, que un triángulo no es capaz de ofrecer una mejor distancia, no es necesario continuar el cálculo aún más.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1021">If you can determine, by a quick check, that a triangle is not capable of giving a better distance, there is no need to continue the calculation further.</span></span> <span data-ttu-id="8dfee-1022">No necesita el punto y la distancia más cercanos para este triángulo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1022">You do not need the closest point and distance for this triangle.</span></span>

![Diagrama que muestra el flujo de la asignación mínima de.](images/gmmp-image120.png)

<span data-ttu-id="8dfee-1024">**Figura 32** : esquemas mínimos de asignación</span><span class="sxs-lookup"><span data-stu-id="8dfee-1024">**Figure 32** : Minimum DE Mapping schematics</span></span>

<span data-ttu-id="8dfee-1025">En la Figura 32 se muestra el flujo general de lógica para el mapa de la gama MinDEMap.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1025">Figure 32 shows the general flow of logic for the gamut map MinDEMap.</span></span> <span data-ttu-id="8dfee-1026">En un punto de consulta, la función CheckGamut se invoca por primera vez.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1026">For a query point, the CheckGamut function is first invoked.</span></span> <span data-ttu-id="8dfee-1027">Si el punto es en la gama, el mapa es una operación no operativa.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1027">If the point is in-gamut, the map is a no-op.</span></span> <span data-ttu-id="8dfee-1028">Si el punto está fuera de la gama, llame a ProjectPointToBoundary.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1028">If the point is out-of-gamut, call ProjectPointToBoundary.</span></span> <span data-ttu-id="8dfee-1029">Ahora, pase a la Figura 33.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1029">Now move on to Figure 33.</span></span> <span data-ttu-id="8dfee-1030">En este punto, se supone que se han calculado los valores siguientes.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1030">At this point, it is assumed that the following values have been computed.</span></span>

<span data-ttu-id="8dfee-1031">**(a)** vector normal de unidad para cada triángulo de límite de gama con respecto al producto de punto estándar.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1031">**(a)** Unit normal vector to each Gamut Boundary Triangle with respect to the standard dot product.</span></span>

<span data-ttu-id="8dfee-1032">**(b)** lista de vértices y lista de bordes, además de la lista de triángulos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1032">**(b)** Vertex list and edge list, in addition to the triangle list.</span></span>

![Diagrama que muestra la rutina ' ProjectPointToBoundary '.](images/gmmp-image122.jpg)

<span data-ttu-id="8dfee-1034">**Figura 33** : rutina ProjectPointToBoundary</span><span class="sxs-lookup"><span data-stu-id="8dfee-1034">**Figure 33** : The ProjectPointToBoundary routine</span></span>

<span data-ttu-id="8dfee-1035">Todos estos son una sobrecarga constante y tendrían costos reducidos si se realizan consultas suficientes para este límite de gama.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1035">All these are constant overhead, and would have diminishing cost if sufficient queries to this gamut boundary are made.</span></span> <span data-ttu-id="8dfee-1036">Normalmente, este es el caso cuando se crea una transformación LUT desde un dispositivo a otro, donde solo hay dos gamas fijas, y la transformación LUT se ejecuta a través de puntos de la cuadrícula muestreada uniformemente.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1036">Usually, this is the case when you build a transform LUT from one device to another, where there are only two fixed gamuts, and the transform LUT runs through points on the uniformly sampled grid.</span></span> <span data-ttu-id="8dfee-1037">Calcula previamente los vectores normales con respecto al producto de punto estándar, aunque el concepto de la perpendicular se basará en el producto de punto ponderado, que depende del punto de consulta tal y como se explicó anteriormente.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1037">You pre-compute the normal vectors with respect to the standard dot product, even though the notion of perpendicularity will be based on the weighted dot product, which depends on the query point as explained previously.</span></span> <span data-ttu-id="8dfee-1038">La razón es que un vector normal con respecto al producto de punto ponderado se puede obtener fácilmente desde el vector normal con respecto al producto de punto estándar.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1038">The reason is because a normal vector with respect to the weighted dot product can be obtained easily from the normal vector with respect to the standard dot product.</span></span> <span data-ttu-id="8dfee-1039">Si n ₀ es un vector normal con respecto al producto de punto estándar,</span><span class="sxs-lookup"><span data-stu-id="8dfee-1039">If n ₀ is a normal vector with respect to the standard dot product, then</span></span>

<span data-ttu-id="8dfee-1040">n = (componente J de n ₀/w <sub>J</sub>, un componente-de n ₀, componente b de n ₀)</span><span class="sxs-lookup"><span data-stu-id="8dfee-1040">n = (J-component of n ₀ /w <sub>J</sub>, a-component of n ₀, b-component of n ₀ )</span></span>

<span data-ttu-id="8dfee-1041">es normal para el triángulo con respecto al producto de punto ponderado.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1041">is normal to the triangle with respect to the weighted dot product.</span></span> <span data-ttu-id="8dfee-1042">Debido a esta relación, sigue siendo útil calcular previamente n ₀, aunque debe ajustarse en función del punto de consulta.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1042">Because of this relationship, it is still beneficial to pre-compute n ₀ even though it must be adjusted based on the query point.</span></span>

<span data-ttu-id="8dfee-1043">La rutina ProjectPointToBoundary se inicia restableciendo el "historial procesado" de los vértices y los bordes.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1043">The ProjectPointToBoundary routine starts by resetting the "processed history" of the vertices and edges.</span></span> <span data-ttu-id="8dfee-1044">Se trata de tablas de marcas BOOLEANAS que realizan un seguimiento de si un vértice o borde se ha visitado antes.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1044">These are tables of BOOLEAN flags that track whether a vertex or edge has been visited before.</span></span> <span data-ttu-id="8dfee-1045">También restablece la variable ShortestDistance en "Infinity", que es el valor codificado máximo en el sistema de números de punto flotante usado.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1045">It also resets the variable ShortestDistance to "INFINITY," which is the maximum encoded value in the floating-point number system used.</span></span> <span data-ttu-id="8dfee-1046">A continuación, se ejecuta a través de un bucle, buscando el punto más cercano de cada triángulo mediante la llamada ProcessTriangle.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1046">Then it runs through a loop, searching for the closest point from each triangle using the ProcessTriangle call.</span></span> <span data-ttu-id="8dfee-1047">ProcessTriangle es la rutina para actualizar la variable ShortestDistance y está claramente en el bucle crítico.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1047">ProcessTriangle is the routine to update the ShortestDistance variable and is clearly in the critical loop.</span></span> <span data-ttu-id="8dfee-1048">Una optimización es detenerse cuando el resultado es lo suficientemente bueno.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1048">One optimization is to stop when the result is good enough.</span></span> <span data-ttu-id="8dfee-1049">Después de cada llamada a ProcessTriangle, se examina la variable ShortestDistance.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1049">After each call to ProcessTriangle, the variable ShortestDistance is examined.</span></span> <span data-ttu-id="8dfee-1050">Si cumple un umbral predefinido, puede detenerse.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1050">If it satisfies a predefined threshold, you can stop.</span></span> <span data-ttu-id="8dfee-1051">El umbral predefinido depende del espacio de colores utilizado y de la precisión necesaria del sistema de creación de imágenes de color.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1051">The predefined threshold is dependent on the color space used and on the required accuracy of the color imaging system.</span></span> <span data-ttu-id="8dfee-1052">En el caso de una aplicación típica, no desea realizar ningún trabajo innecesario si la diferencia de color es menor que la que se puede discernir por la visión humana.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1052">For a typical application, you do not want to do unnecessary work if the color difference is less than what can be discerned by human vision.</span></span> <span data-ttu-id="8dfee-1053">En el caso de CIECAM02, esta diferencia de color es 1.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1053">For CIECAM02, this color difference is 1.</span></span> <span data-ttu-id="8dfee-1054">No obstante, use un valor de umbral de 0,005 en la implementación para conservar la precisión de los cálculos, ya que esto podría ser solo un paso intermedio en una cadena de transformaciones.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1054">Use a threshold value of 0.005 in the implementation, however, to preserve the precision of computations, because this might be only an intermediate step in a chain of transforms.</span></span>

<span data-ttu-id="8dfee-1055">ProcessTriangle implementa la estrategia II anterior.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1055">ProcessTriangle implements the preceding Strategy II.</span></span> <span data-ttu-id="8dfee-1056">Al obtener un vector normal del vector normal de la unidad precalculada al triángulo con respecto al producto de punto estándar, calcula la distancia del punto de consulta al plano infinito que contiene el triángulo formando el producto de punto del vector de unidad normal y el queryVector, el vector de uno de los vértices del triángulo, vertex1, al punto de consulta. , queryPoint.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1056">Obtaining a normal vector from the pre-computed unit normal vector to the triangle with respect to the standard dot product, it computes the distance of the query point to the infinite plane containing the triangle by forming the dot product of the unit normal vector and the queryVector, the vector from one of the vertices of the triangle, vertex1, to the query point, queryPoint.</span></span>

<span data-ttu-id="8dfee-1057">queryVector = queryPoint-vertex1</span><span class="sxs-lookup"><span data-stu-id="8dfee-1057">queryVector = queryPoint - vertex1</span></span>

<span data-ttu-id="8dfee-1058">Distance = \| normalVector \* queryVector \| / \| \| normalVector\|\|</span><span class="sxs-lookup"><span data-stu-id="8dfee-1058">distance = \| normalVector \* queryVector \|/\|\|normalVector\|\|</span></span>

<span data-ttu-id="8dfee-1059">Este es un cálculo relativamente económico y la distancia es necesaria para realizar cálculos adicionales.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1059">This is a relatively inexpensive calculation, and the distance is required to carry out further calculations.</span></span> <span data-ttu-id="8dfee-1060">Si esta distancia no es menor que la mejor distancia actual, ShortestDistance, este triángulo no producirá una mejor distancia, ya que no proporcionará una distancia mayor que el plano que lo contiene.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1060">If this distance is not less than the current best distance, ShortestDistance, this triangle will not produce a better distance, because it will not give a better distance than the plane containing it.</span></span> <span data-ttu-id="8dfee-1061">En este caso, devolverá el control al bucle de triángulo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1061">In this case, you return control to the triangle loop.</span></span> <span data-ttu-id="8dfee-1062">Si la distancia es menor que ShortestDistance, es posible que tenga un punto más cercano, si este punto se encuentra dentro del triángulo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1062">If the distance is smaller than ShortestDistance, potentially, you have a closer point, if this point lies inside the triangle.</span></span> <span data-ttu-id="8dfee-1063">Debe realizar algunos cálculos "físicos" (no obstante, nada más allá del álgebra lineal) para determinar eso.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1063">You must perform some "hard" calculations (though nothing beyond linear algebra) to determine that.</span></span> <span data-ttu-id="8dfee-1064">Si los otros dos vértices del triángulo son vertex2 y vertex3, forme los vectores de base firstBasisVector y secondBasisVector.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1064">If the other two vertices of the triangle are vertex2 and vertex3, then form the basis vectors firstBasisVector and secondBasisVector.</span></span>

<span data-ttu-id="8dfee-1065">firstBasisVector = vertex2-vertex1</span><span class="sxs-lookup"><span data-stu-id="8dfee-1065">firstBasisVector = vertex2 - vertex1</span></span>

<span data-ttu-id="8dfee-1066">secondBasisVector = vertex3-vertex1</span><span class="sxs-lookup"><span data-stu-id="8dfee-1066">secondBasisVector = vertex3 - vertex1</span></span>

<span data-ttu-id="8dfee-1067">Use el siguiente sistema lineal de ecuaciones para solucionar los problemas de los que dispone y v.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1067">Use the following linear system of equations to solve for unknowns u and v.</span></span>

<span data-ttu-id="8dfee-1068">firstBasisVector \* queryVector = (firstBasisVector \* firstBasisVector) u + (firstBasisVector \* secondBasisVector) v</span><span class="sxs-lookup"><span data-stu-id="8dfee-1068">firstBasisVector \* queryVector = (firstBasisVector \* firstBasisVector)u + (firstBasisVector \* secondBasisVector)v</span></span>

<span data-ttu-id="8dfee-1069">secondBasisVector \* queryVector = (secondBasisVector \* firstBasisVector) u + (secondBasisVector \* secondBasisVector) v</span><span class="sxs-lookup"><span data-stu-id="8dfee-1069">secondBasisVector \* queryVector = (secondBasisVector \* firstBasisVector)u + (secondBasisVector \* secondBasisVector)v</span></span>

<span data-ttu-id="8dfee-1070">y las condiciones del punto proyectado que se encuentran dentro del triángulo son:</span><span class="sxs-lookup"><span data-stu-id="8dfee-1070">and the conditions for the projected point to lie inside the triangle are:</span></span>

<span data-ttu-id="8dfee-1071">0 ≤ u ≤ 1, 0 ≤ v ≤ 1 y + v ≤ 1</span><span class="sxs-lookup"><span data-stu-id="8dfee-1071">0 ≤ u ≤ 1, 0 ≤ v ≤ 1 and u + v ≤ 1</span></span>

<span data-ttu-id="8dfee-1072">Después de este cálculo, si se determina que el punto proyectado se encuentra dentro del triángulo, habrá encontrado un nuevo punto más cercano. la distancia que calculó al principio es la nueva distancia más corta.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1072">After this calculation, if it is determined that the projected point lies within the triangle, then you have found a new closest point; the distance that you calculated at the beginning is the new shortest distance.</span></span> <span data-ttu-id="8dfee-1073">En este caso, actualice las variables ShortestDistance y ClosestPoint.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1073">In this case, update the variables ShortestDistance and ClosestPoint.</span></span> <span data-ttu-id="8dfee-1074">Si el punto proyectado se encuentra fuera del triángulo, es posible que encuentre un punto más cercano en uno de sus bordes.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1074">If the projected point lies outside the triangle, you might find a closer point on one of its edges.</span></span> <span data-ttu-id="8dfee-1075">Por lo tanto, puede llamar a la rutina ProcessEdge en cada uno de los tres bordes.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1075">So, you can call the ProcessEdge routine on each of the three edges.</span></span>

![Diagrama que muestra el flujo de las rutinas ProcessEdge y ProcessVertex.](images/gmmp-image124.jpg)

<span data-ttu-id="8dfee-1077">**Figura 34** : rutinas ProcessEdge y ProcessVertex</span><span class="sxs-lookup"><span data-stu-id="8dfee-1077">**Figure 34** : ProcessEdge and ProcessVertex routines</span></span>

<span data-ttu-id="8dfee-1078">La rutina ProcessEdge implementa la estrategia I, que se muestra en la figura 34.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1078">The ProcessEdge routine implements Strategy I, which is illustrated in Figure 34.</span></span> <span data-ttu-id="8dfee-1079">ProcessEdge se inicia comprobando si el borde se ha procesado antes.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1079">ProcessEdge starts by checking whether the edge has been processed before.</span></span> <span data-ttu-id="8dfee-1080">Si es así, no se realiza ninguna otra acción.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1080">If so, no further action is taken.</span></span> <span data-ttu-id="8dfee-1081">En caso contrario, continúa calculando la proyección ortogonal del punto de consulta en la línea infinita que contiene el borde.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1081">If not, it proceeds to calculate the orthogonal projection of the query point onto the infinite line containing the edge.</span></span> <span data-ttu-id="8dfee-1082">El álgebra lineal implicado en el cálculo es similar a las ecuaciones del triángulo anterior.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1082">The linear algebra involved in the calculation is similar to the previous triangle equations.</span></span> <span data-ttu-id="8dfee-1083">Sin embargo, el cálculo es más sencillo, no se describe aquí.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1083">However, the calculation is simpler, it is not described here.</span></span> <span data-ttu-id="8dfee-1084">Si el punto proyectado se encuentra dentro del borde, la distancia del punto proyectado se encuentra en el punto de consulta.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1084">If the projected point lies within the edge, you find the distance of the projected point from the query point.</span></span> <span data-ttu-id="8dfee-1085">Si esta distancia es menor que ShortestDistance, ha encontrado un nuevo punto más cercano.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1085">If this distance is smaller than ShortestDistance, you have found a new closest point.</span></span> <span data-ttu-id="8dfee-1086">Actualice ShortestDistance y ClosestPoint.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1086">Update both ShortestDistance and ClosestPoint.</span></span> <span data-ttu-id="8dfee-1087">Si el punto proyectado se encuentra fuera del borde, llame a ProcessVertex en los dos extremos.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1087">If the projected point lies outside the edge, call ProcessVertex on the two end points.</span></span> <span data-ttu-id="8dfee-1088">Antes de devolver el control, actualice el historial perimetral para que este borde se marque como "procesado".</span><span class="sxs-lookup"><span data-stu-id="8dfee-1088">Before returning control, update the edge history so that this edge is marked as "PROCESSED."</span></span>

<span data-ttu-id="8dfee-1089">Por último, proporcione una descripción de ProcessVertex.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1089">Finally, you give a description of ProcessVertex.</span></span> <span data-ttu-id="8dfee-1090">La rutina ProjectVertex también implementa la estrategia I y mantiene una tabla de historial de vértices.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1090">The ProjectVertex routine also implements Strategy I and maintains a vertex history table.</span></span> <span data-ttu-id="8dfee-1091">Como se muestra en la figura 34, primero comprueba si el vértice se ha procesado antes.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1091">As illustrated in Figure 34, it first checks whether the vertex has been processed before.</span></span> <span data-ttu-id="8dfee-1092">Si es así, no se realiza ninguna otra acción.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1092">If so, no further action is taken.</span></span> <span data-ttu-id="8dfee-1093">Si no es así, se calcula la distancia del vértice del punto de consulta.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1093">If not, it proceeds to calculate the distance of the vertex from the query point.</span></span> <span data-ttu-id="8dfee-1094">Si la distancia es menor que ShortestDistance, actualice ShortestDistance y ClosestPoint.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1094">If the distance is smaller than ShortestDistance, update both ShortestDistance and ClosestPoint.</span></span> <span data-ttu-id="8dfee-1095">Al final, actualiza el historial de vértices para que este vértice se marque como "procesado".</span><span class="sxs-lookup"><span data-stu-id="8dfee-1095">At the end, it updates the vertex history so that this vertex is marked as "PROCESSED."</span></span>

<span data-ttu-id="8dfee-1096">Cuando el bucle de control exterior ha agotado todos los triángulos o salido antes de que se haya cumplido el umbral de diferencia de color, se obtiene acceso a la variable ClosestPoint.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1096">When the outer control loop has either exhausted all the triangles or exited before color difference threshold has been met, the variable ClosestPoint is accessed.</span></span> <span data-ttu-id="8dfee-1097">Este es el resultado de MinDEMap.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1097">This is the result of MinDEMap.</span></span> <span data-ttu-id="8dfee-1098">El autor de la llamada también puede recuperar ShortestDistance si le interesa el color asignado del color de la consulta.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1098">The caller can also retrieve ShortestDistance if interested in how far the mapped color is from the query color.</span></span>

### <a name="hue-smoothing"></a><span data-ttu-id="8dfee-1099">Suavizado de matiz</span><span class="sxs-lookup"><span data-stu-id="8dfee-1099">Hue Smoothing</span></span>

![Diagrama que muestra dos vistas principales del suavizado de matiz, el original en la parte superior y el matiz suavizado en la parte inferior.](images/gmmp-image125.png)

<span data-ttu-id="8dfee-1101">**Figura 35** : suavizado de matiz</span><span class="sxs-lookup"><span data-stu-id="8dfee-1101">**Figure 35** : Hue Smoothing</span></span>

<span data-ttu-id="8dfee-1102">Se produce un problema con las operaciones con restricción de matiz; es decir, la operación solo tiene en cuenta las variables dentro de un plano de matiz.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1102">An issue arises with operations that are hue constrained; that is, the operation only considers variables within a hue plane.</span></span> <span data-ttu-id="8dfee-1103">En la figura 35 se muestra un ejemplo de una gama que presenta segmentos de matiz "descontinuos" en los tonos azules.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1103">Figure 35 shows an example of a gamut exhibiting "discontinuous" hue slices in the blue hues.</span></span> <span data-ttu-id="8dfee-1104">Dentro de este intervalo de matiz, para determinados ángulos de matiz, el límite de la gama es tangencial al plano del matiz.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1104">Within this hue range, for certain hue angles, the gamut boundary is tangential to the hue plane.</span></span> <span data-ttu-id="8dfee-1105">De hecho, esto provoca un cambio en la estructura topológica de los segmentos de matiz.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1105">In effect, this causes a change in the topological structure of the hue slices.</span></span> <span data-ttu-id="8dfee-1106">En el ejemplo mostrado, a medida que el plano de matiz se barre en este rango de matiz, una "isla" emerge y se combina.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1106">In the example shown, as the hue plane sweeps across this hue range, an "island" emerges and submerges.</span></span> <span data-ttu-id="8dfee-1107">Este cambio en la topología hará que las operaciones específicas de matiz sean discontinuas.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1107">This change in topology will cause hue specific operations to be discontinuous.</span></span> <span data-ttu-id="8dfee-1108">Por ejemplo, el intervalo de cresta en el matiz fijo cambia repentinamente a medida que cambia el ángulo de matiz en este intervalo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1108">For example, the cusp at fixed hue will change abruptly as the hue angle changes across this range.</span></span>

<span data-ttu-id="8dfee-1109">Hay un motivo de ciencia de color por el que es deseable conservar el matiz en determinadas operaciones.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1109">There is a color science reason why it is desirable to preserve hue in certain operations.</span></span> <span data-ttu-id="8dfee-1110">Para resolver el problema anterior, los triángulos del límite de la gama original deben ser "Hue Smoothed".</span><span class="sxs-lookup"><span data-stu-id="8dfee-1110">To resolve the preceding issue, the original Gamut Boundary Triangles must be "hue smoothed."</span></span> <span data-ttu-id="8dfee-1111">En general, un matiz de tonalidad de un conjunto de triángulos de límite de gama es un conjunto de triángulos que (a) forma el límite de una nueva "gama", que podría no corresponderse con la gama real de dispositivos, y que contiene la gama definida por el conjunto original de triángulos; y (b) los triángulos del conjunto nuevo se limitan de ser paralelos a los planos de matiz.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1111">Generally speaking, a hue smoothing of a set of Gamut Boundary Triangles is a set of triangles such that (a) it forms the boundary of a new "gamut," which might not correspond to the actual device gamut, and that contains the gamut defined by the original set of triangles; and (b) the triangles in the new set are bounded away from being parallel to the hue planes.</span></span>

<span data-ttu-id="8dfee-1112">Una forma práctica de obtener un conjunto suavizado de los triángulos es usar el casco convexo de los vértices originales.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1112">One practical way to obtain a hue smoothed set of triangles is to take the convex hull of the original vertices.</span></span> <span data-ttu-id="8dfee-1113">Como se muestra en la figura 35, los segmentos de matiz del casco convexo varían suavemente en el intervalo de matiz problemático sin un cambio repentino en la topología.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1113">As illustrated in Figure 35, the hue slices of the convex hull vary smoothly in the problematic hue range without a sudden change in topology.</span></span>

### <a name="setting-primaries-and-secondaries-in-the-gamut-boundary-description"></a><span data-ttu-id="8dfee-1114">Configuración de las principales y secundarias en la descripción del límite de la gama</span><span class="sxs-lookup"><span data-stu-id="8dfee-1114">Setting Primaries and Secondaries in the Gamut Boundary Description</span></span>

<span data-ttu-id="8dfee-1115">Ciertos métodos de asignación de gama, como HueMap, dependen de la ubicación de las principales y secundarias del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1115">Certain gamut mapping methods, such as HueMap, depend on the location of the device primaries and secondaries.</span></span> <span data-ttu-id="8dfee-1116">En el caso de los dispositivos aditivos, los primarios son rojo, verde y azul (R, G y B); y las secundarias son cian, magenta y amarillo (C, M e y).</span><span class="sxs-lookup"><span data-stu-id="8dfee-1116">For additive devices, the primaries are red, green, and blue (R, G, and B); and the secondaries are cyan, magenta, and yellow (C, M, and Y).</span></span> <span data-ttu-id="8dfee-1117">En el caso de los dispositivos de sustracción, los primarios son C, M e y; y las secundarias son R, G y B. GBD realiza un seguimiento de los seis valores, más el blanco y el negro (W y K), en una matriz de valores de color jab.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1117">For subtractive devices, the primaries are C, M, and Y; and the secondaries are R, G, and B. The GBD keeps track of all six of those values, plus white and black (W and K), in a array of Jab color values.</span></span> <span data-ttu-id="8dfee-1118">Estos valores se establecen en la descripción del límite de la gama cuando se crea.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1118">These values are set into the gamut boundary description when it is created.</span></span> <span data-ttu-id="8dfee-1119">En el caso de los dispositivos de salida, los primarios se pueden determinar mediante la ejecución de combinaciones de valores de control de dispositivo a través del modelo de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1119">For output devices, the primaries can be determined by running combinations of device control values through the device model.</span></span> <span data-ttu-id="8dfee-1120">En el caso de los dispositivos de captura, este enfoque no es adecuado para crear el GBD de referencia, ya que es prácticamente imposible capturar una imagen que produce un valor de dispositivo puro totalmente saturado, como (0,0, 0,0, 1,0).</span><span class="sxs-lookup"><span data-stu-id="8dfee-1120">For capture devices, this approach is not well-suited for creating the reference GBD, because it is almost impossible to capture an image that yields a fully saturated pure device value, such as (0.0, 0.0, 1.0).</span></span> <span data-ttu-id="8dfee-1121">Los perfiles de dispositivo WCS contienen los índices de las principales del destino de captura.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1121">WCS device profiles contain the indices of the primaries in the capture target.</span></span> <span data-ttu-id="8dfee-1122">Dado que estos valores no se incluyen en un perfil ICC, use los valores que se miden a partir de un destino de escáner típico después de la conversión a jab, en relación con las condiciones de visualización de ICC.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1122">Because these values are not contained in an ICC profile, use values measured from a typical scanner target after converting to Jab, relative to the ICC viewing conditions.</span></span>

### <a name="setting-the-neutral-axis-in-the-gamut-boundary-description"></a><span data-ttu-id="8dfee-1123">Establecimiento del eje neutro en la descripción del límite de la gama</span><span class="sxs-lookup"><span data-stu-id="8dfee-1123">Setting the Neutral Axis in the Gamut Boundary Description</span></span>

<span data-ttu-id="8dfee-1124">Los métodos de asignación de gama picada relativa y HueMap usan el eje neutro del dispositivo para enderezar.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1124">The HueMap and the Relative MinCD gamut mapping methods use the device neutral axis for straightening.</span></span> <span data-ttu-id="8dfee-1125">En el caso de los dispositivos de salida de línea base, el eje neutro se puede determinar mediante la ejecución de valores neutros de dispositivo (R = G = B o C = M = Y) a través del método DeviceToColorimetric y, a continuación, mediante el método ColorimetricToAppearance del objeto CIECAM02.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1125">For the baseline output devices, the neutral axis can be determined by running device neutral values (R=G=B or C=M=Y) through the DeviceToColorimetric method, and then through the ColorimetricToAppearance method of the CIECAM02 object.</span></span> <span data-ttu-id="8dfee-1126">Sin embargo, los dispositivos de captura no siempre devuelven un valor neutro del dispositivo cuando se presentan con un ejemplo neutro.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1126">However, capture devices do not always return a device neutral value when presented with a neutral sample.</span></span> <span data-ttu-id="8dfee-1127">Esto es especialmente cierto cuando la iluminación ambiente no es totalmente neutra.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1127">This is particularly true when the ambient lighting is not perfectly neutral.</span></span> <span data-ttu-id="8dfee-1128">Los perfiles de dispositivo WCS contienen los índices de los ejemplos neutros en el destino.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1128">WCS device profiles contain the indices of the neutral samples in the target.</span></span> <span data-ttu-id="8dfee-1129">Use esos ejemplos para establecer el eje neutro.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1129">Use those samples to set the neutral axis.</span></span> <span data-ttu-id="8dfee-1130">Dado que esta información no está disponible para los perfiles de ICC, debe usar el mismo método que se usa para los dispositivos de salida; Ejecute ejemplos neutros de dispositivo a través del método DeviceToColorimetric y, a continuación, acople los valores de entrada y los resultados de la colorimétrico.</span><span class="sxs-lookup"><span data-stu-id="8dfee-1130">Because this information is not available for ICC profiles, you must use the same method that is used for output devices; run device neutral samples through the DeviceToColorimetric method, and then couple the input values and the colorimetric results.</span></span>

## <a name="related-topics"></a><span data-ttu-id="8dfee-1131">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="8dfee-1131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8dfee-1132">Conceptos básicos de la administración del color</span><span class="sxs-lookup"><span data-stu-id="8dfee-1132">Basic color management concepts</span></span>](basic-color-management-concepts.md)
</dt> <dt>

[<span data-ttu-id="8dfee-1133">Algoritmos y esquemas del Sistema de colores de Windows</span><span class="sxs-lookup"><span data-stu-id="8dfee-1133">Windows Color System Schemas and Algorithms</span></span>](windows-color-system-schemas-and-algorithms.md)
</dt> </dl>

 

 




