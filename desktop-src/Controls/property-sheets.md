---
title: Acerca de las hojas de propiedades
description: Una hoja de propiedades es una ventana que permite al usuario ver y editar las propiedades de un elemento.
ms.assetid: 93676a64-7980-48cd-8615-23b14a118e1c
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3256959b588e2109740033692c0c528889fc939f
ms.sourcegitcommit: 11f52354f570aacaf1ba2a266b2e507abd73352a
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/19/2021
ms.locfileid: "105649463"
---
# <a name="about-property-sheets"></a><span data-ttu-id="de9bf-103">Acerca de las hojas de propiedades</span><span class="sxs-lookup"><span data-stu-id="de9bf-103">About Property Sheets</span></span>

<span data-ttu-id="de9bf-104">Una *hoja de propiedades* es una ventana que permite al usuario ver y editar las propiedades de un elemento.</span><span class="sxs-lookup"><span data-stu-id="de9bf-104">A *property sheet* is a window that allows the user to view and edit the properties of an item.</span></span> <span data-ttu-id="de9bf-105">Por ejemplo, una aplicación de hoja de cálculo puede utilizar una hoja de propiedades para permitir al usuario establecer las propiedades de fuente y borde de una celda, o para ver y establecer las propiedades de un dispositivo, como una unidad de disco, una impresora o un mouse.</span><span class="sxs-lookup"><span data-stu-id="de9bf-105">For example, a spreadsheet application can use a property sheet to allow the user to set the font and border properties of a cell or to view and set the properties of a device, such as a disk drive, printer, or mouse.</span></span>

<span data-ttu-id="de9bf-106">En esta sección se tratan los temas siguientes.</span><span class="sxs-lookup"><span data-stu-id="de9bf-106">This section discusses the following topics.</span></span>

-   [<span data-ttu-id="de9bf-107">Aspectos básicos de la hoja de propiedades</span><span class="sxs-lookup"><span data-stu-id="de9bf-107">Property Sheet Basics</span></span>](#property-sheet-basics)
-   [<span data-ttu-id="de9bf-108">Cuadros de diálogo de hoja de propiedades</span><span class="sxs-lookup"><span data-stu-id="de9bf-108">Property Sheet Dialog Boxes</span></span>](#property-sheet-dialog-boxes)
-   [<span data-ttu-id="de9bf-109">Páginas</span><span class="sxs-lookup"><span data-stu-id="de9bf-109">Pages</span></span>](#pages)
-   [<span data-ttu-id="de9bf-110">Creación de hojas de propiedades</span><span class="sxs-lookup"><span data-stu-id="de9bf-110">Property Sheet Creation</span></span>](#property-sheet-creation)
-   [<span data-ttu-id="de9bf-111">Agregar y quitar páginas</span><span class="sxs-lookup"><span data-stu-id="de9bf-111">Adding and Removing Pages</span></span>](#adding-and-removing-pages)
-   [<span data-ttu-id="de9bf-112">Título y etiquetas de página de la hoja de propiedades</span><span class="sxs-lookup"><span data-stu-id="de9bf-112">Property Sheet Title and Page Labels</span></span>](#property-sheet-title-and-page-labels)
-   [<span data-ttu-id="de9bf-113">Activación de página</span><span class="sxs-lookup"><span data-stu-id="de9bf-113">Page Activation</span></span>](#page-activation)
-   [<span data-ttu-id="de9bf-114">Botón ayuda</span><span class="sxs-lookup"><span data-stu-id="de9bf-114">Help Button</span></span>](#help-button)
    -   [<span data-ttu-id="de9bf-115">Quitar el botón ayuda de la barra de título</span><span class="sxs-lookup"><span data-stu-id="de9bf-115">Removing the Caption Bar Help Button</span></span>](#removing-the-caption-bar-help-button)
-   [<span data-ttu-id="de9bf-116">Botones aceptar, cancelar y aplicar</span><span class="sxs-lookup"><span data-stu-id="de9bf-116">OK, Cancel, and Apply Buttons</span></span>](#ok-cancel-and-apply-buttons)
-   [<span data-ttu-id="de9bf-117">Asistentes</span><span class="sxs-lookup"><span data-stu-id="de9bf-117">Wizards</span></span>](#wizards)

## <a name="property-sheet-basics"></a><span data-ttu-id="de9bf-118">Aspectos básicos de la hoja de propiedades</span><span class="sxs-lookup"><span data-stu-id="de9bf-118">Property Sheet Basics</span></span>

<span data-ttu-id="de9bf-119">Para implementar hojas de propiedades en la aplicación, incluya el archivo de encabezado Prsht. h en el proyecto.</span><span class="sxs-lookup"><span data-stu-id="de9bf-119">To implement property sheets in your application, include the Prsht.h header file in your project.</span></span> <span data-ttu-id="de9bf-120">Prsht. h contiene todos los identificadores utilizados con hojas de propiedades.</span><span class="sxs-lookup"><span data-stu-id="de9bf-120">Prsht.h contains all of the identifiers used with property sheets.</span></span>

<span data-ttu-id="de9bf-121">Una hoja de propiedades contiene una o varias ventanas secundarias superpuestas denominadas páginas, cada una de las cuales contiene ventanas de control para establecer un grupo de propiedades relacionadas.</span><span class="sxs-lookup"><span data-stu-id="de9bf-121">A property sheet contains one or more overlapping child windows called pages, each containing control windows for setting a group of related properties.</span></span> <span data-ttu-id="de9bf-122">Por ejemplo, una página puede contener los controles para establecer las propiedades de fuente de un elemento, incluido el estilo de tipo, el tamaño de punto, el color, etc.</span><span class="sxs-lookup"><span data-stu-id="de9bf-122">For example, a page can contain the controls for setting the font properties of an item, including the type style, point size, color, and so on.</span></span> <span data-ttu-id="de9bf-123">Cada página tiene una pestaña que el usuario puede seleccionar para devolver la página al primer plano de la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="de9bf-123">Each page has a tab that the user can select to bring the page to the foreground of the property sheet.</span></span> <span data-ttu-id="de9bf-124">Por ejemplo, la aplicación Date-Time panel de control muestra la siguiente hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="de9bf-124">For example, the Date-Time control panel application displays the following property sheet.</span></span>

![captura de pantalla de una hoja de propiedades con dos pestañas, una de las cuales muestra un reloj y un control de calendario mensual](images/propsheet1.png)

<span data-ttu-id="de9bf-126">Una hoja de propiedades estándar con varias páginas con pestañas permite al usuario el acceso aleatorio a todas las propiedades.</span><span class="sxs-lookup"><span data-stu-id="de9bf-126">A standard property sheet with multiple, tabbed pages allows the user random access to all properties.</span></span> <span data-ttu-id="de9bf-127">Si es más adecuado que las propiedades se establezcan en secuencia, puede usar un [Asistente](#wizards).</span><span class="sxs-lookup"><span data-stu-id="de9bf-127">If it is more appropriate to have properties set in sequence, you can use a [wizard](#wizards).</span></span>

## <a name="property-sheet-dialog-boxes"></a><span data-ttu-id="de9bf-128">Cuadros de diálogo de hoja de propiedades</span><span class="sxs-lookup"><span data-stu-id="de9bf-128">Property Sheet Dialog Boxes</span></span>

<span data-ttu-id="de9bf-129">En realidad, una hoja de propiedades y las páginas que contiene son cuadros de diálogo.</span><span class="sxs-lookup"><span data-stu-id="de9bf-129">A property sheet and the pages it contains are actually dialog boxes.</span></span> <span data-ttu-id="de9bf-130">La hoja de propiedades es un cuadro de diálogo definido por el sistema que administra las páginas y proporciona un contenedor común para ellas.</span><span class="sxs-lookup"><span data-stu-id="de9bf-130">The property sheet is a system-defined dialog box that manages the pages and provides a common container for them.</span></span> <span data-ttu-id="de9bf-131">Un cuadro de diálogo de hoja de propiedades puede ser modal o no modal.</span><span class="sxs-lookup"><span data-stu-id="de9bf-131">A property sheet dialog box can be modal or modeless.</span></span> <span data-ttu-id="de9bf-132">Incluye un marco, una barra de título y cuatro botones: **Aceptar**, **Cancelar**, **aplicar** y, opcionalmente, **ayuda**.</span><span class="sxs-lookup"><span data-stu-id="de9bf-132">It includes a frame, a title bar, and four buttons: **OK**, **Cancel**, **Apply**, and (optionally) **Help**.</span></span> <span data-ttu-id="de9bf-133">Los procedimientos del cuadro de diálogo para las páginas reciben códigos de notificación en forma de mensajes de notificación de [**WM \_**](wm-notify.md) cuando el usuario hace clic en los botones.</span><span class="sxs-lookup"><span data-stu-id="de9bf-133">The dialog box procedures for the pages receive notification codes in the form of [**WM\_NOTIFY**](wm-notify.md) messages when the user clicks the buttons.</span></span>

> [!NOTE]  
> <span data-ttu-id="de9bf-134">No toda la información de esta sección se aplica a los asistentes, que tienen una apariencia y un comportamiento algo distintos.</span><span class="sxs-lookup"><span data-stu-id="de9bf-134">Not all the information in this section applies to wizards, which have a somewhat different appearance and behavior.</span></span> <span data-ttu-id="de9bf-135">Por ejemplo, los asistentes tienen un conjunto diferente de botones y ninguna pestaña.</span><span class="sxs-lookup"><span data-stu-id="de9bf-135">For example, wizards have a different set of buttons and no tabs.</span></span> <span data-ttu-id="de9bf-136">Para obtener más información, vea [crear asistentes](wizards.md).</span><span class="sxs-lookup"><span data-stu-id="de9bf-136">For more information, see [Creating Wizards](wizards.md).</span></span>

<span data-ttu-id="de9bf-137">Cada página de una hoja de propiedades es un cuadro de diálogo no modal definido por la aplicación que administra las ventanas de control utilizadas para ver y editar las propiedades de un elemento.</span><span class="sxs-lookup"><span data-stu-id="de9bf-137">Each page in a property sheet is an application-defined modeless dialog box that manages the control windows used to view and edit the properties of an item.</span></span> <span data-ttu-id="de9bf-138">Proporcione la plantilla de cuadro de diálogo que se usa para crear cada página, así como el procedimiento de cuadro de diálogo que administra los controles y establece las propiedades del elemento correspondiente.</span><span class="sxs-lookup"><span data-stu-id="de9bf-138">You provide the dialog box template used to create each page as well as the dialog box procedure that manages the controls and sets the properties of the corresponding item.</span></span>

<span data-ttu-id="de9bf-139">Una hoja de propiedades envía códigos de notificación al procedimiento de cuadro de diálogo de una página cuando la página obtiene o pierde la activación y cuando el usuario hace clic en el botón **Aceptar**, **Cancelar**, **aplicar** o **ayuda** .</span><span class="sxs-lookup"><span data-stu-id="de9bf-139">A property sheet sends notification codes to the dialog box procedure for a page when the page is gaining or losing the activation and when the user clicks the **OK**, **Cancel**, **Apply**, or **Help** button.</span></span> <span data-ttu-id="de9bf-140">Las notificaciones se envían en forma de mensajes [**de \_ notificación de WM**](wm-notify.md) .</span><span class="sxs-lookup"><span data-stu-id="de9bf-140">The notifications are sent in the form of [**WM\_NOTIFY**](wm-notify.md) messages.</span></span> <span data-ttu-id="de9bf-141">El parámetro *lParam* es la dirección de una estructura [**NMHDR**](/windows/desktop/api/richedit/ns-richedit-nmhdr) que incluye el identificador de ventana del cuadro de diálogo de la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="de9bf-141">The *lParam* parameter is the address of an [**NMHDR**](/windows/desktop/api/richedit/ns-richedit-nmhdr) structure that includes the window handle to the property sheet dialog box.</span></span>

<span data-ttu-id="de9bf-142">Algunos códigos de notificación requieren una página para devolver **true** o **false** en respuesta al mensaje [**de \_ notificación de WM**](wm-notify.md) .</span><span class="sxs-lookup"><span data-stu-id="de9bf-142">Some notification codes require a page to return either **TRUE** or **FALSE** in response to the [**WM\_NOTIFY**](wm-notify.md) message.</span></span> <span data-ttu-id="de9bf-143">Para ello, la página debe usar la función [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) para establecer el valor de **DWL \_ MSGRESULT** para el cuadro de diálogo de página en **true** o **false**.</span><span class="sxs-lookup"><span data-stu-id="de9bf-143">To do this, the page must use the [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) function to set the **DWL\_MSGRESULT** value for the page dialog box to either **TRUE** or **FALSE**.</span></span>

## <a name="pages"></a><span data-ttu-id="de9bf-144">Páginas</span><span class="sxs-lookup"><span data-stu-id="de9bf-144">Pages</span></span>

<span data-ttu-id="de9bf-145">Una hoja de propiedades debe contener al menos una página, pero no puede contener más del valor de **MAXPROPPAGES** tal y como se define en los archivos de encabezado de Windows.</span><span class="sxs-lookup"><span data-stu-id="de9bf-145">A property sheet must contain at least one page, but it cannot contain more than the value of **MAXPROPPAGES** as defined in the Windows header files.</span></span> <span data-ttu-id="de9bf-146">Cada página tiene un índice basado en cero que la hoja de propiedades asigna según el orden en que se agrega la página a la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="de9bf-146">Each page has a zero-based index that the property sheet assigns according to the order in which the page is added to the property sheet.</span></span> <span data-ttu-id="de9bf-147">Los índices se utilizan en los mensajes que se envían a la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="de9bf-147">The indexes are used in messages that you send to the property sheet.</span></span>

<span data-ttu-id="de9bf-148">Una página de propiedades puede contener un cuadro de diálogo anidado.</span><span class="sxs-lookup"><span data-stu-id="de9bf-148">A property page can contain a nested dialog box.</span></span> <span data-ttu-id="de9bf-149">Si lo hace, debe incluir el estilo [**WS \_ ex \_ CONTROLPARENT**](/windows/desktop/winmsg/extended-window-styles) para el cuadro de diálogo de nivel superior y llamar a la función [**IsDialogMessage**](/windows/desktop/api/winuser/nf-winuser-isdialogmessagea) con el identificador del cuadro de diálogo primario.</span><span class="sxs-lookup"><span data-stu-id="de9bf-149">If it does, you must include the [**WS\_EX\_CONTROLPARENT**](/windows/desktop/winmsg/extended-window-styles) style for the top-level dialog box and call the [**IsDialogMessage**](/windows/desktop/api/winuser/nf-winuser-isdialogmessagea) function with the handle to the parent dialog box.</span></span> <span data-ttu-id="de9bf-150">Esto garantiza que el usuario puede utilizar las teclas de teclas y las teclas de navegación del cuadro de diálogo para desplazar el foco a los controles del cuadro de diálogo anidado.</span><span class="sxs-lookup"><span data-stu-id="de9bf-150">This ensures that the user can use mnemonics and the dialog box navigation keys to move the focus to controls in the nested dialog box.</span></span>

<span data-ttu-id="de9bf-151">Cada página tiene un icono y una etiqueta correspondientes.</span><span class="sxs-lookup"><span data-stu-id="de9bf-151">Each page has a corresponding icon and label.</span></span> <span data-ttu-id="de9bf-152">La hoja de propiedades crea una pestaña para cada página y muestra el icono y la etiqueta en la pestaña. Se espera que todas las páginas de la hoja de propiedades utilicen una fuente que no sea negrita.</span><span class="sxs-lookup"><span data-stu-id="de9bf-152">The property sheet creates a tab for each page and displays the icon and label in the tab. All property sheet pages are expected to use a nonbold font.</span></span> <span data-ttu-id="de9bf-153">Para asegurarse de que la fuente no está en negrita, especifique el estilo **\_ 3DLOOK de DS** en la plantilla de cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="de9bf-153">To ensure that the font is not bold, specify the **DS\_3DLOOK** style in the dialog box template.</span></span>

<span data-ttu-id="de9bf-154">El procedimiento de cuadro de diálogo de una página no debe llamar a la función [**EndDialog**](/windows/desktop/api/winuser/nf-winuser-enddialog) .</span><span class="sxs-lookup"><span data-stu-id="de9bf-154">The dialog box procedure for a page must not call the [**EndDialog**](/windows/desktop/api/winuser/nf-winuser-enddialog) function.</span></span> <span data-ttu-id="de9bf-155">Al hacerlo, se destruirá toda la hoja de propiedades, no solo la página.</span><span class="sxs-lookup"><span data-stu-id="de9bf-155">Doing so will destroy the entire property sheet, not just the page.</span></span>

<span data-ttu-id="de9bf-156">El tamaño mínimo de una página de la hoja de propiedades es 212 unidades de cuadro de diálogo horizontalmente y 114 unidades de cuadro de diálogo verticalmente.</span><span class="sxs-lookup"><span data-stu-id="de9bf-156">The minimum size for a property sheet page is 212 dialog units horizontally and 114 dialog units vertically.</span></span> <span data-ttu-id="de9bf-157">Si un cuadro de diálogo de página es menor que este, la página se ampliará hasta que cumpla el tamaño mínimo.</span><span class="sxs-lookup"><span data-stu-id="de9bf-157">If a page dialog is smaller than this, the page will be enlarged until it meets the minimum size.</span></span> <span data-ttu-id="de9bf-158">El archivo de encabezado Prsht. h contiene tres conjuntos de tamaños recomendados para las páginas de la hoja de propiedades, como se muestra en la tabla siguiente.</span><span class="sxs-lookup"><span data-stu-id="de9bf-158">The Prsht.h header file contains three sets of recommended sizes for property sheet pages, as shown in the following table.</span></span>

|  <span data-ttu-id="de9bf-159">Tamaño</span><span class="sxs-lookup"><span data-stu-id="de9bf-159">Size</span></span>                |   <span data-ttu-id="de9bf-160">Descripción</span><span class="sxs-lookup"><span data-stu-id="de9bf-160">Description</span></span>                                                   |
|----------------------|-----------------------------------------------------------------|
| <span data-ttu-id="de9bf-161">**PROP \_ SM \_ CXDLG**</span><span class="sxs-lookup"><span data-stu-id="de9bf-161">**PROP\_SM\_CXDLG**</span></span>  | <span data-ttu-id="de9bf-162">Ancho, en unidades de cuadro de diálogo, de una pequeña página de hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="de9bf-162">Width, in dialog units, of a small property sheet page.</span></span>         |
| <span data-ttu-id="de9bf-163">**PROP \_ SM \_ CYDLG**</span><span class="sxs-lookup"><span data-stu-id="de9bf-163">**PROP\_SM\_CYDLG**</span></span>  | <span data-ttu-id="de9bf-164">Alto, en unidades de cuadro de diálogo, de una pequeña página de hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="de9bf-164">Height, in dialog units, of a small property sheet page.</span></span>        |
| <span data-ttu-id="de9bf-165">**PROP \_ Med \_ CXDLG**</span><span class="sxs-lookup"><span data-stu-id="de9bf-165">**PROP\_MED\_CXDLG**</span></span> | <span data-ttu-id="de9bf-166">Ancho, en unidades de cuadro de diálogo, de una página de hoja de propiedades de tamaño medio.</span><span class="sxs-lookup"><span data-stu-id="de9bf-166">Width, in dialog units, of a medium-sized property sheet page.</span></span>  |
| <span data-ttu-id="de9bf-167">**PROP \_ Med \_ CYDLG**</span><span class="sxs-lookup"><span data-stu-id="de9bf-167">**PROP\_MED\_CYDLG**</span></span> | <span data-ttu-id="de9bf-168">Alto, en unidades de cuadro de diálogo, de una página de hoja de propiedades de tamaño medio.</span><span class="sxs-lookup"><span data-stu-id="de9bf-168">Height, in dialog units, of a medium-sized property sheet page.</span></span> |
| <span data-ttu-id="de9bf-169">**PROP \_ LG \_ CXDLG**</span><span class="sxs-lookup"><span data-stu-id="de9bf-169">**PROP\_LG\_CXDLG**</span></span>  | <span data-ttu-id="de9bf-170">Ancho, en unidades de cuadro de diálogo, de una página grande de la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="de9bf-170">Width, in dialog units, of a large property sheet page.</span></span>         |
| <span data-ttu-id="de9bf-171">**PROP \_ LG \_ CYDLG**</span><span class="sxs-lookup"><span data-stu-id="de9bf-171">**PROP\_LG\_CYDLG**</span></span>  | <span data-ttu-id="de9bf-172">Alto, en unidades de cuadro de diálogo, de una página grande de la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="de9bf-172">Height, in dialog units, of a large property sheet page.</span></span>        |

<span data-ttu-id="de9bf-173">El uso de estos tamaños recomendados le ayudará a garantizar la coherencia visual entre la aplicación y otras aplicaciones de Microsoft Windows.</span><span class="sxs-lookup"><span data-stu-id="de9bf-173">Using these recommended sizes will help ensure visual consistency between your application and other Microsoft Windows applications.</span></span>

<span data-ttu-id="de9bf-174">En el editor de recursos de Microsoft Visual Studio, puede crear una página del tamaño adecuado en el cuadro de diálogo **Agregar recurso** .</span><span class="sxs-lookup"><span data-stu-id="de9bf-174">In the Microsoft Visual Studio resource editor, you can create a page of the appropriate size in the **Add Resource** dialog box.</span></span> <span data-ttu-id="de9bf-175">Expanda el nodo cuadro de diálogo y seleccione **IDD \_ PropPage \_ Large**, **IDD \_ PropPage \_ Medium** o **IDD \_ PropPage \_ Small**.</span><span class="sxs-lookup"><span data-stu-id="de9bf-175">Expand the Dialog node and select **IDD\_PROPPAGE\_LARGE**, **IDD\_PROPPAGE\_MEDIUM**, or **IDD\_PROPPAGE\_SMALL**.</span></span>

<span data-ttu-id="de9bf-176">La hoja de propiedades se ajusta automáticamente para adaptarse a la página más grande.</span><span class="sxs-lookup"><span data-stu-id="de9bf-176">The property sheet is automatically sized to accommodate the largest page.</span></span>

## <a name="property-sheet-creation"></a><span data-ttu-id="de9bf-177">Creación de hojas de propiedades</span><span class="sxs-lookup"><span data-stu-id="de9bf-177">Property Sheet Creation</span></span>

<span data-ttu-id="de9bf-178">Antes de crear una hoja de propiedades, debe definir una o más páginas.</span><span class="sxs-lookup"><span data-stu-id="de9bf-178">Before creating a property sheet, you must define one or more pages.</span></span> <span data-ttu-id="de9bf-179">Esto implica rellenar una estructura [**PROPSHEETPAGE**](pss-propsheetpage.md) con información sobre la página (su icono, etiqueta, plantilla de cuadro de diálogo, procedimiento de cuadro de diálogo, etc.) y, a continuación, especificar la dirección de la estructura en una llamada a la función [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) .</span><span class="sxs-lookup"><span data-stu-id="de9bf-179">This involves filling a [**PROPSHEETPAGE**](pss-propsheetpage.md) structure with information about the page—its icon, label, dialog box template, dialog box procedure, and so on—and then specifying the address of the structure in a call to the [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) function.</span></span> <span data-ttu-id="de9bf-180">La función devuelve un identificador al tipo HPROPSHEETPAGE que identifica la página de forma única.</span><span class="sxs-lookup"><span data-stu-id="de9bf-180">The function returns a handle to the HPROPSHEETPAGE type that uniquely identifies the page.</span></span>

<span data-ttu-id="de9bf-181">Para crear una hoja de propiedades, especifique la dirección de una estructura [**PROPSHEETHEADER**](pss-propsheetheader.md) en una llamada a la función [**hoja**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) .</span><span class="sxs-lookup"><span data-stu-id="de9bf-181">To create a property sheet, you specify the address of a [**PROPSHEETHEADER**](pss-propsheetheader.md) structure in a call to the [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) function.</span></span> <span data-ttu-id="de9bf-182">La estructura define el icono y el título de la hoja de propiedades y también incluye la dirección de una matriz de identificadores HPROPSHEETPAGE que se obtienen mediante [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea).</span><span class="sxs-lookup"><span data-stu-id="de9bf-182">The structure defines the icon and title for the property sheet and also includes the address of an array of HPROPSHEETPAGE handles that you obtain by using [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea).</span></span> <span data-ttu-id="de9bf-183">Cuando **hoja** crea la hoja de propiedades, incluye las páginas identificadas en la matriz.</span><span class="sxs-lookup"><span data-stu-id="de9bf-183">When **PropertySheet** creates the property sheet, it includes the pages identified in the array.</span></span> <span data-ttu-id="de9bf-184">Las páginas aparecen en la hoja de propiedades en el mismo orden en que se encuentran en la matriz.</span><span class="sxs-lookup"><span data-stu-id="de9bf-184">The pages appear in the property sheet in the same order that they are contained in the array.</span></span>

<span data-ttu-id="de9bf-185">Otra manera de asignar páginas a una hoja de propiedades consiste en especificar una matriz de estructuras [**PROPSHEETPAGE**](pss-propsheetpage.md) en lugar de una matriz de identificadores de **HPROPSHEETPAGE** .</span><span class="sxs-lookup"><span data-stu-id="de9bf-185">Another way to assign pages to a property sheet is to specify an array of [**PROPSHEETPAGE**](pss-propsheetpage.md) structures instead of an array of **HPROPSHEETPAGE** handles.</span></span> <span data-ttu-id="de9bf-186">En este caso, [**hoja**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) crea identificadores para las páginas antes de agregarlas a la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="de9bf-186">In this case, [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) creates handles for the pages before adding them to the property sheet.</span></span>

<span data-ttu-id="de9bf-187">Cuando se crea una página, el procedimiento del cuadro de diálogo recibe un mensaje de [**\_ INITDIALOG de WM**](/windows/desktop/dlgbox/wm-initdialog) .</span><span class="sxs-lookup"><span data-stu-id="de9bf-187">When a page is created, its dialog box procedure receives a [**WM\_INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) message.</span></span> <span data-ttu-id="de9bf-188">El parámetro *lParam* del mensaje es un puntero a una copia de la estructura [**PROPSHEETPAGE**](pss-propsheetpage.md) que se define cuando se crea la página.</span><span class="sxs-lookup"><span data-stu-id="de9bf-188">The message's *lParam* parameter is a pointer to a copy of the [**PROPSHEETPAGE**](pss-propsheetpage.md) structure that is defined when the page is created.</span></span> <span data-ttu-id="de9bf-189">En concreto, cuando se crea una página, se puede usar el miembro **lParam** de la estructura para pasar información definida por la aplicación al procedimiento del cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="de9bf-189">In particular, when a page is created, the structure's **lParam** member can be used to pass application-defined information to the dialog box procedure.</span></span> <span data-ttu-id="de9bf-190">A excepción del miembro **lParam** , esta estructura debe tratarse como de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="de9bf-190">With the exception of the **lParam** member, this structure must be treated as read-only.</span></span> <span data-ttu-id="de9bf-191">La modificación de cualquier cosa que no sea **lParam** tendrá consecuencias imprevisibles.</span><span class="sxs-lookup"><span data-stu-id="de9bf-191">Modifying anything other than **lParam** will have unpredictable consequences.</span></span>

<span data-ttu-id="de9bf-192">Cuando el sistema pasa posteriormente una copia de la estructura [**PROPSHEETPAGE**](pss-propsheetpage.md) de la página a la aplicación, utiliza el mismo puntero.</span><span class="sxs-lookup"><span data-stu-id="de9bf-192">When the system subsequently passes a copy of the page's [**PROPSHEETPAGE**](pss-propsheetpage.md) structure to your application, it uses the same pointer.</span></span> <span data-ttu-id="de9bf-193">Se pasarán los cambios a la estructura.</span><span class="sxs-lookup"><span data-stu-id="de9bf-193">Any changes to the structure will be passed along.</span></span> <span data-ttu-id="de9bf-194">Dado que el sistema omite el miembro **lParam** , se puede modificar para enviar información a otras partes de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="de9bf-194">Because the **lParam** member is ignored by the system, it can be modified to send information to other parts of your application.</span></span> <span data-ttu-id="de9bf-195">Por ejemplo, puede usar **lParam** para pasar información a la función de devolución de llamada [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) de la página.</span><span class="sxs-lookup"><span data-stu-id="de9bf-195">You can, for instance, use **lParam** to pass information to the page's [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) callback function.</span></span>

<span data-ttu-id="de9bf-196">[**Hoja**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) establece automáticamente el tamaño y la posición inicial de una hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="de9bf-196">[**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) automatically sets the size and initial position of a property sheet.</span></span> <span data-ttu-id="de9bf-197">La posición se basa en la posición de la ventana propietaria y el tamaño se basa en la página más grande especificada en la matriz de páginas cuando se creó la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="de9bf-197">The position is based on the position of the owner window, and the size is based on the largest page specified in the array of pages when the property sheet was created.</span></span> <span data-ttu-id="de9bf-198">Si desea que las páginas coincidan con el ancho de los cuatro botones en la parte inferior de la hoja de propiedades, establezca el ancho de la página más ancha en 190 unidades de cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="de9bf-198">If you want the pages to match the width of the four buttons at the bottom of the property sheet, set the width of the widest page to 190 dialog units.</span></span>

<span data-ttu-id="de9bf-199">El tamaño de una hoja de propiedades se calcula a partir de las propiedades *width* y *height* de la plantilla de cuadro de diálogo en el archivo de recursos.</span><span class="sxs-lookup"><span data-stu-id="de9bf-199">The size of a property sheet is computed from the *width* and *height* properties of the dialog template in the resource file.</span></span> <span data-ttu-id="de9bf-200">Consulte recurso de [**cuadro de diálogo**](/windows/desktop/menurc/dialog-resource) o [**recurso de DIALOGEX**](/windows/desktop/menurc/dialogex-resource) para obtener más detalles.</span><span class="sxs-lookup"><span data-stu-id="de9bf-200">See [**DIALOG Resource**](/windows/desktop/menurc/dialog-resource) or [**DIALOGEX Resource**](/windows/desktop/menurc/dialogex-resource) for further details.</span></span> <span data-ttu-id="de9bf-201">Sin embargo, tenga en cuenta que, por motivos de compatibilidad, las dimensiones se calculan en relación con la fuente de MS Shell Dlg en lugar de la fuente usada por la página.</span><span class="sxs-lookup"><span data-stu-id="de9bf-201">Note, however, that for compatibility reasons, the dimensions are computed relative to the MS Shell Dlg font rather than the font used by the page.</span></span> <span data-ttu-id="de9bf-202">Si diseña una página que usa otra fuente, se puede usar una de las sugerencias siguientes.</span><span class="sxs-lookup"><span data-stu-id="de9bf-202">If you design a page that uses another font, one of the following suggestions can be used.</span></span>

-   <span data-ttu-id="de9bf-203">Ajuste las dimensiones de la plantilla de cuadro de diálogo para compensar la diferencia de tamaño entre la fuente MS Shell Dlg y la fuente que la página usa realmente.</span><span class="sxs-lookup"><span data-stu-id="de9bf-203">Adjust the dimensions of the dialog template to compensate for the difference in size between the MS Shell Dlg font and the font the page actually uses.</span></span> <span data-ttu-id="de9bf-204">Por ejemplo, si elige una fuente que sea dos veces más ancha que MS Shell Dlg, establezca la propiedad width de la plantilla de cuadro de diálogo en el doble del uso normal.</span><span class="sxs-lookup"><span data-stu-id="de9bf-204">For example, if you choose a font that is twice as wide as MS Shell Dlg, then set the dialog template's width property to twice the normal use.</span></span>
-   <span data-ttu-id="de9bf-205">Use una plantilla de [**DIALOGEX**](/windows/desktop/menurc/dialogex-resource) y establezca el estilo de cuadro de diálogo **\_ SHELLFONT de DS** .</span><span class="sxs-lookup"><span data-stu-id="de9bf-205">Use a [**DIALOGEX**](/windows/desktop/menurc/dialogex-resource) template and set the **DS\_SHELLFONT** dialog style.</span></span> <span data-ttu-id="de9bf-206">En ese caso, el administrador de la hoja de propiedades interpreta las dimensiones de la plantilla de cuadro de diálogo en relación con la fuente utilizada por la plantilla de cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="de9bf-206">In that case, the property sheet manager interprets the dialog template dimensions relative to the font used by the dialog template.</span></span>

## <a name="adding-and-removing-pages"></a><span data-ttu-id="de9bf-207">Agregar y quitar páginas</span><span class="sxs-lookup"><span data-stu-id="de9bf-207">Adding and Removing Pages</span></span>

<span data-ttu-id="de9bf-208">Después de crear una hoja de propiedades, una aplicación puede Agregar una página al final del conjunto de páginas existente mediante el envío de un mensaje de [**PSM \_**](psm-addpage.md) .</span><span class="sxs-lookup"><span data-stu-id="de9bf-208">After creating a property sheet, an application can add a page to the end of the existing set of pages by sending a [**PSM\_ADDPAGE**](psm-addpage.md) message.</span></span> <span data-ttu-id="de9bf-209">Para insertar una página entre las páginas existentes, envíe un mensaje de [**PropSheet \_ InsertPage**](/windows/desktop/api/Prsht/nf-prsht-propsheet_insertpage) .</span><span class="sxs-lookup"><span data-stu-id="de9bf-209">To insert a page between existing pages, send a [**PropSheet\_InsertPage**](/windows/desktop/api/Prsht/nf-prsht-propsheet_insertpage) message.</span></span> <span data-ttu-id="de9bf-210">Tenga en cuenta que el tamaño de la hoja de propiedades no puede cambiar una vez que se ha creado.</span><span class="sxs-lookup"><span data-stu-id="de9bf-210">Note that the size of the property sheet cannot change after it has been created.</span></span> <span data-ttu-id="de9bf-211">Las páginas agregadas o insertadas no deben ser mayores que la página más grande que se encuentra actualmente en la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="de9bf-211">Any added or inserted pages must be no larger than the largest page currently in the property sheet.</span></span> <span data-ttu-id="de9bf-212">Para quitar una página, envíe un mensaje de [**PSM \_ REMOVEPAGE**](psm-removepage.md) .</span><span class="sxs-lookup"><span data-stu-id="de9bf-212">To remove a page, send a [**PSM\_REMOVEPAGE**](psm-removepage.md) message.</span></span>

<span data-ttu-id="de9bf-213">Cuando se define una página, se puede especificar la dirección de una función de devolución de llamada [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) que la hoja de propiedades llama cuando se crea o se quita la página.</span><span class="sxs-lookup"><span data-stu-id="de9bf-213">When you define a page, you can specify the address of a [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) callback function that the property sheet calls when it is creating or removing the page.</span></span> <span data-ttu-id="de9bf-214">El uso de *PropSheetPageProc* le ofrece la oportunidad de realizar operaciones de inicialización y limpieza para páginas individuales.</span><span class="sxs-lookup"><span data-stu-id="de9bf-214">Using *PropSheetPageProc* gives you an opportunity to perform initialization and cleanup operations for individual pages.</span></span>

> [!NOTE]  
> <span data-ttu-id="de9bf-215">Se producen varios mensajes y una llamada de función mientras la hoja de propiedades manipula la lista de páginas.</span><span class="sxs-lookup"><span data-stu-id="de9bf-215">A number of messages and one function call occur while the property sheet is manipulating the list of pages.</span></span> <span data-ttu-id="de9bf-216">Mientras se realiza esta acción, el intento de modificar la lista de páginas tendrá resultados imprevisibles.</span><span class="sxs-lookup"><span data-stu-id="de9bf-216">While this action is taking place, attempting to modify the list of pages will have unpredictable results.</span></span> <span data-ttu-id="de9bf-217">No agregue, inserte o quite páginas en su implementación de [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka)o mientras controla las siguientes notificaciones y mensajes de Windows.</span><span class="sxs-lookup"><span data-stu-id="de9bf-217">Do not add, insert, or remove pages in your implementation of [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka), or while handling the following notifications and Windows messages.</span></span>
>
> -   [<span data-ttu-id="de9bf-218">PSN \_ aplicar</span><span class="sxs-lookup"><span data-stu-id="de9bf-218">PSN\_APPLY</span></span>](psn-apply.md)
> -   [<span data-ttu-id="de9bf-219">PSN \_ KILLACTIVE</span><span class="sxs-lookup"><span data-stu-id="de9bf-219">PSN\_KILLACTIVE</span></span>](psn-killactive.md)
> -   [<span data-ttu-id="de9bf-220">restablecimiento de PSN \_</span><span class="sxs-lookup"><span data-stu-id="de9bf-220">PSN\_RESET</span></span>](psn-reset.md)
> -   [<span data-ttu-id="de9bf-221">PSN \_ SETACTIVE</span><span class="sxs-lookup"><span data-stu-id="de9bf-221">PSN\_SETACTIVE</span></span>](psn-setactive.md)
> -   [<span data-ttu-id="de9bf-222">PSN \_ WIZBACK</span><span class="sxs-lookup"><span data-stu-id="de9bf-222">PSN\_WIZBACK</span></span>](psn-wizback.md)
> -   [<span data-ttu-id="de9bf-223">PSN \_ WIZNEXT</span><span class="sxs-lookup"><span data-stu-id="de9bf-223">PSN\_WIZNEXT</span></span>](psn-wiznext.md)
> -   [<span data-ttu-id="de9bf-224">**INITDIALOG de WM \_**</span><span class="sxs-lookup"><span data-stu-id="de9bf-224">**WM\_INITDIALOG**</span></span>](/windows/desktop/dlgbox/wm-initdialog)
> -   [<span data-ttu-id="de9bf-225">**destrucción de WM \_**</span><span class="sxs-lookup"><span data-stu-id="de9bf-225">**WM\_DESTROY**</span></span>](/windows/desktop/winmsg/wm-destroy)

<span data-ttu-id="de9bf-226">Si es necesario modificar una página de hoja de propiedades mientras se controla uno de estos mensajes o mientras [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) está en funcionamiento, publique un mensaje de Windows privado.</span><span class="sxs-lookup"><span data-stu-id="de9bf-226">If the need arises to modify a property sheet page while you are handling one of these messages or while [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) is in operation, post a private Windows message.</span></span> <span data-ttu-id="de9bf-227">La aplicación no recibirá ese mensaje hasta que el administrador de la hoja de propiedades haya finalizado sus tareas, en cuyo momento será seguro modificar la lista de páginas.</span><span class="sxs-lookup"><span data-stu-id="de9bf-227">Your application will not receive that message until after the property sheet manager has finished its tasks, at which point it will be safe to modify the list of pages.</span></span>

<span data-ttu-id="de9bf-228">Cuando se destruye una hoja de propiedades, se destruyen automáticamente todas las páginas que se han agregado a ella.</span><span class="sxs-lookup"><span data-stu-id="de9bf-228">When a property sheet is destroyed, it automatically destroys all of the pages that have been added to it.</span></span> <span data-ttu-id="de9bf-229">Las páginas se destruyen en orden inverso al especificado en la matriz utilizada para crear las páginas.</span><span class="sxs-lookup"><span data-stu-id="de9bf-229">The pages are destroyed in reverse order from that specified in the array used to create the pages.</span></span> <span data-ttu-id="de9bf-230">Para destruir una página creada por la función [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) pero que no se agregó a la hoja de propiedades, utilice la función [**DestroyPropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-destroypropertysheetpage) .</span><span class="sxs-lookup"><span data-stu-id="de9bf-230">To destroy a page that was created by the [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) function but was not added to the property sheet, use the [**DestroyPropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-destroypropertysheetpage) function.</span></span>

## <a name="property-sheet-title-and-page-labels"></a><span data-ttu-id="de9bf-231">Título y etiquetas de página de la hoja de propiedades</span><span class="sxs-lookup"><span data-stu-id="de9bf-231">Property Sheet Title and Page Labels</span></span>

<span data-ttu-id="de9bf-232">El título de una hoja de propiedades se especifica en la estructura [**PROPSHEETHEADER**](pss-propsheetheader.md) utilizada para crear la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="de9bf-232">You specify the title of a property sheet in the [**PROPSHEETHEADER**](pss-propsheetheader.md) structure used to create the property sheet.</span></span> <span data-ttu-id="de9bf-233">Si el miembro **dwFlags** incluye el **valor \_ PROPTITLE de PSH** , la hoja de propiedades agrega el sufijo "Properties" o el prefijo "Properties for", dependiendo de la versión.</span><span class="sxs-lookup"><span data-stu-id="de9bf-233">If the **dwFlags** member includes the **PSH\_PROPTITLE** value, the property sheet adds the suffix "Properties" or the prefix "Properties for", depending on the version.</span></span> <span data-ttu-id="de9bf-234">Puede cambiar el título después de crear una hoja de propiedades mediante el mensaje [**\_ SETTITLE de PSM**](psm-settitle.md) .</span><span class="sxs-lookup"><span data-stu-id="de9bf-234">You can change the title after a property sheet is created by using the [**PSM\_SETTITLE**](psm-settitle.md) message.</span></span> <span data-ttu-id="de9bf-235">En un asistente de Aero, este mensaje se puede usar para cambiar dinámicamente el título de una página interior.</span><span class="sxs-lookup"><span data-stu-id="de9bf-235">In an Aero Wizard, this message can be used to change the title of an interior page dynamically.</span></span>

<span data-ttu-id="de9bf-236">De forma predeterminada, una hoja de propiedades utiliza la cadena de nombre especificada en la plantilla de cuadro de diálogo como etiqueta de una página.</span><span class="sxs-lookup"><span data-stu-id="de9bf-236">By default, a property sheet uses the name string specified in the dialog box template as the label for a page.</span></span> <span data-ttu-id="de9bf-237">Puede invalidar la cadena de nombre incluyendo el valor de **PSP \_ USETITLE** en el miembro **DwFlags** de la estructura [**PROPSHEETPAGE**](pss-propsheetpage.md) que define la página.</span><span class="sxs-lookup"><span data-stu-id="de9bf-237">You can override the name string by including the **PSP\_USETITLE** value in the **dwFlags** member of the [**PROPSHEETPAGE**](pss-propsheetpage.md) structure that defines the page.</span></span> <span data-ttu-id="de9bf-238">Cuando se especifica **PSP \_ USETITLE** , el miembro **pszTitle** debe contener la dirección de la cadena de etiqueta de la página.</span><span class="sxs-lookup"><span data-stu-id="de9bf-238">When **PSP\_USETITLE** is specified, the **pszTitle** member must contain the address of the label string for the page.</span></span>

## <a name="page-activation"></a><span data-ttu-id="de9bf-239">Activación de página</span><span class="sxs-lookup"><span data-stu-id="de9bf-239">Page Activation</span></span>

<span data-ttu-id="de9bf-240">Una hoja de propiedades solo puede tener una página activa a la vez.</span><span class="sxs-lookup"><span data-stu-id="de9bf-240">A property sheet can have only one active page at a time.</span></span> <span data-ttu-id="de9bf-241">La página que tiene la activación está en primer plano de la pila de páginas superpuestas.</span><span class="sxs-lookup"><span data-stu-id="de9bf-241">The page that has the activation is at the foreground of the overlapping stack of pages.</span></span> <span data-ttu-id="de9bf-242">El usuario activa una página seleccionando su pestaña; una aplicación activa una página mediante el mensaje [**\_ SETCURSEL de PSM**](psm-setcursel.md) .</span><span class="sxs-lookup"><span data-stu-id="de9bf-242">The user activates a page by selecting its tab; an application activates a page by using the [**PSM\_SETCURSEL**](psm-setcursel.md) message.</span></span>

<span data-ttu-id="de9bf-243">La hoja de propiedades envía el código de notificación [PSN \_ KILLACTIVE](psn-killactive.md) a la página que está a punto de perder la activación.</span><span class="sxs-lookup"><span data-stu-id="de9bf-243">The property sheet sends the [PSN\_KILLACTIVE](psn-killactive.md) notification code to the page that is about to lose the activation.</span></span> <span data-ttu-id="de9bf-244">En respuesta, la página debe validar cualquier cambio que haya realizado el usuario en la página.</span><span class="sxs-lookup"><span data-stu-id="de9bf-244">In response, the page must validate any changes that the user has made to the page.</span></span> <span data-ttu-id="de9bf-245">Si la página requiere una entrada adicional por el usuario antes de perder la activación, utilice la función [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) para establecer el valor de **DWL \_ MSGRESULT** de la página en **true**.</span><span class="sxs-lookup"><span data-stu-id="de9bf-245">If the page requires additional user input before losing the activation, use the [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) function to set the **DWL\_MSGRESULT** value of the page to **TRUE**.</span></span> <span data-ttu-id="de9bf-246">Además, la página debe mostrar un cuadro de mensaje que describa el problema y proporcione la acción recomendada.</span><span class="sxs-lookup"><span data-stu-id="de9bf-246">Also, the page must display a message box that describes the problem and provides the recommended action.</span></span> <span data-ttu-id="de9bf-247">Establezca **DWL \_ MSGRESULT** en **false** cuando sea correcto perder la activación.</span><span class="sxs-lookup"><span data-stu-id="de9bf-247">Set **DWL\_MSGRESULT** to **FALSE** when it is okay to lose the activation.</span></span>

<span data-ttu-id="de9bf-248">Antes de que la página que obtiene la activación esté visible, la hoja de propiedades envía el código de notificación [PSN \_ SETACTIVE](psn-setactive.md) a la página.</span><span class="sxs-lookup"><span data-stu-id="de9bf-248">Before the page that is gaining the activation is visible, the property sheet sends the [PSN\_SETACTIVE](psn-setactive.md) notification code to the page.</span></span> <span data-ttu-id="de9bf-249">La página debe responder inicializando sus ventanas de control.</span><span class="sxs-lookup"><span data-stu-id="de9bf-249">The page must respond by initializing its control windows.</span></span>

## <a name="help-button"></a><span data-ttu-id="de9bf-250">Botón ayuda</span><span class="sxs-lookup"><span data-stu-id="de9bf-250">Help Button</span></span>

<span data-ttu-id="de9bf-251">Las hojas de propiedades pueden mostrar dos botones de ayuda: un botón de ayuda de la hoja de propiedades que se muestra en la parte inferior del marco, junto a los botones **Aceptar** / **Cancelar** / **aplicación** y un botón de barra de título estándar que proporciona ayuda contextual.</span><span class="sxs-lookup"><span data-stu-id="de9bf-251">Property sheets can display two Help buttons: a property sheet Help button that is displayed at the bottom of the frame, next to the **OK**/**Cancel**/**Apply** buttons, and a standard caption bar button that provides context-sensitive Help.</span></span>

<span data-ttu-id="de9bf-252">El botón ayuda de la hoja de propiedades es opcional y se puede habilitar en una página por página.</span><span class="sxs-lookup"><span data-stu-id="de9bf-252">The property sheet Help button is optional, and can be enabled on a page by page basis.</span></span> <span data-ttu-id="de9bf-253">Para mostrar el botón ayuda de la hoja de propiedades de una o varias páginas:</span><span class="sxs-lookup"><span data-stu-id="de9bf-253">To display the property sheet Help button for one or more pages:</span></span>

-   <span data-ttu-id="de9bf-254">Establezca la marca de **\_ TieneAyuda de PSH** en el miembro **DwFlags** de la estructura [**PROPSHEETHEADER**](pss-propsheetheader.md) de la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="de9bf-254">Set the **PSH\_HASHELP** flag in the **dwFlags** member of the property sheet's [**PROPSHEETHEADER**](pss-propsheetheader.md) structure.</span></span>
-   <span data-ttu-id="de9bf-255">En cada página que muestre un botón ayuda, establezca la marca **PSP \_ TieneAyuda** en el miembro **DwFlags** de la estructura [**PROPSHEETPAGE**](pss-propsheetpage.md) de la página.</span><span class="sxs-lookup"><span data-stu-id="de9bf-255">For each page that will display a Help button, set the **PSP\_HASHELP** flag in the **dwFlags** member of the page's [**PROPSHEETPAGE**](pss-propsheetpage.md) structure.</span></span>

<span data-ttu-id="de9bf-256">Cuando el usuario hace clic en el botón ayuda, la página activa recibe un código de notificación de [ \_ ayuda de PSN](psn-help.md) .</span><span class="sxs-lookup"><span data-stu-id="de9bf-256">When the user clicks the Help button, the active page receives a [PSN\_HELP](psn-help.md) notification code.</span></span> <span data-ttu-id="de9bf-257">La página debe responder mostrando información de ayuda, normalmente mediante una llamada a la función [**WinHelp**](/windows/desktop/api/winuser/nf-winuser-winhelpa) .</span><span class="sxs-lookup"><span data-stu-id="de9bf-257">The page must respond by displaying Help information, typically by calling the [**WinHelp**](/windows/desktop/api/winuser/nf-winuser-winhelpa) function.</span></span>

### <a name="removing-the-caption-bar-help-button"></a><span data-ttu-id="de9bf-258">Quitar el botón ayuda de la barra de título</span><span class="sxs-lookup"><span data-stu-id="de9bf-258">Removing the Caption Bar Help Button</span></span>

<span data-ttu-id="de9bf-259">El botón ayuda de la barra de título se muestra de forma predeterminada, por lo que siempre está disponible la ayuda contextual para los botones Aceptar/Cancelar/aplicar.</span><span class="sxs-lookup"><span data-stu-id="de9bf-259">The caption bar Help button is displayed by default, so that context-sensitive Help is always available for the OK/Cancel/Apply buttons.</span></span> <span data-ttu-id="de9bf-260">Sin embargo, este botón se puede quitar, si es necesario.</span><span class="sxs-lookup"><span data-stu-id="de9bf-260">However, this button can be removed, if necessary.</span></span> <span data-ttu-id="de9bf-261">Para quitar el botón ayuda de la barra de título de la hoja de propiedades:</span><span class="sxs-lookup"><span data-stu-id="de9bf-261">To remove a property sheet's caption bar Help button:</span></span>

-   <span data-ttu-id="de9bf-262">En el caso de las versiones de los controles comunes anteriores a la [versión 5,80](common-control-versions.md), debe implementar una [**función de devolución de llamada de hoja de propiedades**](/windows/desktop/api/Prsht/nc-prsht-pfnpropsheetcallback).</span><span class="sxs-lookup"><span data-stu-id="de9bf-262">For versions of the common controls prior to [version 5.80](common-control-versions.md), you must implement a [**property sheet callback function**](/windows/desktop/api/Prsht/nc-prsht-pfnpropsheetcallback).</span></span>
-   <span data-ttu-id="de9bf-263">Para la [versión 5,80](common-control-versions.md) y posteriores de los controles comunes, puede simplemente establecer la \_ marca PSH NOCONTEXTHELP en el miembro **DwFlags** de la estructura [**PROPSHEETHEADER**](pss-propsheetheader.md) de la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="de9bf-263">For [version 5.80](common-control-versions.md) and later of the common controls, you can simply set the PSH\_NOCONTEXTHELP flag in the **dwFlags** member of the property sheet's [**PROPSHEETHEADER**](pss-propsheetheader.md) structure.</span></span> <span data-ttu-id="de9bf-264">Sin embargo, si necesita compatibilidad con versiones anteriores de las versiones de control comunes anteriores, debe implementar la función de devolución de llamada.</span><span class="sxs-lookup"><span data-stu-id="de9bf-264">However, if you need backward compatibility with earlier common control versions, you must implement the callback function.</span></span>

<span data-ttu-id="de9bf-265">Para implementar una función de devolución de llamada de la hoja de propiedades que quita el botón ayuda de la barra de título:</span><span class="sxs-lookup"><span data-stu-id="de9bf-265">To implement a property sheet callback function that removes the caption bar Help button:</span></span>

-   <span data-ttu-id="de9bf-266">Establezca la marca **PSH \_ USECALLBACK** en el miembro **DwFlags** de la estructura [**PROPSHEETHEADER**](pss-propsheetheader.md) de la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="de9bf-266">Set the **PSH\_USECALLBACK** flag in the **dwFlags** member of the property sheet's [**PROPSHEETHEADER**](pss-propsheetheader.md) structure.</span></span>
-   <span data-ttu-id="de9bf-267">Establezca el miembro **pfnCallBack** de la estructura [**PROPSHEETHEADER**](pss-propsheetheader.md) para que apunte a la función de devolución de llamada.</span><span class="sxs-lookup"><span data-stu-id="de9bf-267">Set the **pfnCallBack** member of the [**PROPSHEETHEADER**](pss-propsheetheader.md) structure to point to the callback function.</span></span>
-   <span data-ttu-id="de9bf-268">Implemente la función de devolución de llamada.</span><span class="sxs-lookup"><span data-stu-id="de9bf-268">Implement the callback function.</span></span> <span data-ttu-id="de9bf-269">Cuando esta función recibe el mensaje **PSCB \_ precreate** , también recibirá un puntero a la plantilla de cuadro de diálogo de la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="de9bf-269">When this function receives the **PSCB\_PRECREATE** message, it will also receive a pointer to the property sheet's dialog box template.</span></span> <span data-ttu-id="de9bf-270">Quite el **estilo \_ CONTEXTHELP de DS** de esta plantilla.</span><span class="sxs-lookup"><span data-stu-id="de9bf-270">Remove the **DS\_CONTEXTHELP** style from this template.</span></span>

<span data-ttu-id="de9bf-271">En el ejemplo siguiente se muestra cómo implementar este tipo de función de devolución de llamada:</span><span class="sxs-lookup"><span data-stu-id="de9bf-271">The following sample illustrates how to implement such a callback function:</span></span>

```cpp
int CALLBACK RemoveContextHelpProc(HWND hwnd, UINT message, LPARAM lParam)
{
    switch (message) 
    {
    case PSCB_PRECREATE:
        // Remove the DS_CONTEXTHELP style from the
        // dialog box template
        if (((LPDLGTEMPLATEEX)lParam)->signature ==    
           0xFFFF)
           {
            ((LPDLGTEMPLATEEX)lParam)->style 
            &= ~DS_CONTEXTHELP;
        }
        else {
            ((LPDLGTEMPLATE)lParam)->style 
            &= ~DS_CONTEXTHELP;
        }
        return TRUE;
    }
    return TRUE;
}
```

<span data-ttu-id="de9bf-272">Si no se define la estructura [**DLGTEMPLATEEX**](/windows/desktop/dlgbox/dlgtemplateex) , incluya la siguiente declaración:</span><span class="sxs-lookup"><span data-stu-id="de9bf-272">If the [**DLGTEMPLATEEX**](/windows/desktop/dlgbox/dlgtemplateex) structure is not defined, include the following declaration:</span></span>

```cpp
#include <pshpack1.h>

typedef struct DLGTEMPLATEEX
{
    WORD dlgVer;
    WORD signature;
    DWORD helpID;
    DWORD exStyle;
    DWORD style;
    WORD cDlgItems;
    short x;
    short y;
    short cx;
    short cy;
} DLGTEMPLATEEX, *LPDLGTEMPLATEEX;

#include <poppack.h>
```

## <a name="ok-cancel-and-apply-buttons"></a><span data-ttu-id="de9bf-273">Botones aceptar, cancelar y aplicar</span><span class="sxs-lookup"><span data-stu-id="de9bf-273">OK, Cancel, and Apply Buttons</span></span>

<span data-ttu-id="de9bf-274">Los botones **Aceptar** y **aplicar** son similares; ambos dirigen las páginas de la hoja de propiedades para validar y aplicar los cambios de propiedad que ha realizado el usuario.</span><span class="sxs-lookup"><span data-stu-id="de9bf-274">The **OK** and **Apply** buttons are similar; both direct a property sheet's pages to validate and apply the property changes that the user has made.</span></span> <span data-ttu-id="de9bf-275">La única diferencia es que al hacer clic en el botón **Aceptar** , la hoja de propiedades se destruirá una vez aplicados los cambios.</span><span class="sxs-lookup"><span data-stu-id="de9bf-275">The only difference is that clicking the **OK** button causes the property sheet to be destroyed after the changes are applied.</span></span>

<span data-ttu-id="de9bf-276">Cuando el usuario hace clic en el botón **Aceptar** o **aplicar** , la hoja de propiedades envía una notificación de [PSN \_ KILLACTIVE](psn-killactive.md) a la página activa, lo que le permite validar los cambios del usuario.</span><span class="sxs-lookup"><span data-stu-id="de9bf-276">When the user clicks the **OK** or **Apply** button, the property sheet sends a [PSN\_KILLACTIVE](psn-killactive.md) notification to the active page, giving it an opportunity to validate the user's changes.</span></span> <span data-ttu-id="de9bf-277">Si los cambios son válidos, la página debe llamar a la función [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) con el valor de **DWL \_ MSGRESULT** establecido en **false**.</span><span class="sxs-lookup"><span data-stu-id="de9bf-277">If the changes are valid, the page must call the [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) function with the **DWL\_MSGRESULT** value set to **FALSE**.</span></span> <span data-ttu-id="de9bf-278">Si los cambios del usuario no son válidos, la página debe establecer **DWL \_ MSGRESULT** en **true** y mostrar un cuadro de diálogo que informa al usuario del problema.</span><span class="sxs-lookup"><span data-stu-id="de9bf-278">If the user's changes are not valid, the page must set **DWL\_MSGRESULT** to **TRUE** and display a dialog box informing the user of the problem.</span></span> <span data-ttu-id="de9bf-279">La página permanece activa hasta que se establece el valor de **DWL \_ MSGRESULT** en **false** en respuesta a un \_ mensaje KILLACTIVE de PSN.</span><span class="sxs-lookup"><span data-stu-id="de9bf-279">The page remains active until it sets **DWL\_MSGRESULT** to **FALSE** in response to a PSN\_KILLACTIVE message.</span></span>

<span data-ttu-id="de9bf-280">Después de que una página responda a una notificación de [ \_ KILLACTIVE de PSN](psn-killactive.md) al establecer **DWL \_ MSGRESULT** en **false**, la hoja de propiedades enviará una notificación [PSN \_ aplicar](psn-apply.md) a cada página.</span><span class="sxs-lookup"><span data-stu-id="de9bf-280">After a page responds to a [PSN\_KILLACTIVE](psn-killactive.md) notification by setting **DWL\_MSGRESULT** to **FALSE**, the property sheet will send a [PSN\_APPLY](psn-apply.md) notification to each page.</span></span> <span data-ttu-id="de9bf-281">Cuando una página recibe esta notificación, debe aplicar las nuevas propiedades al elemento correspondiente.</span><span class="sxs-lookup"><span data-stu-id="de9bf-281">When a page receives this notification, it must apply the new properties to the corresponding item.</span></span> <span data-ttu-id="de9bf-282">Para indicar a la hoja de propiedades que los cambios son válidos para la página, llame a [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) con **DWL \_ MSGRESULT** establecido en **PSNRET \_ NoError**.</span><span class="sxs-lookup"><span data-stu-id="de9bf-282">To indicate to the property sheet that the changes are valid for the page, call [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) with **DWL\_MSGRESULT** set to **PSNRET\_NOERROR**.</span></span> <span data-ttu-id="de9bf-283">Si los cambios no son válidos para la página, devuelva un error.</span><span class="sxs-lookup"><span data-stu-id="de9bf-283">If the changes are invalid for the page, return an error.</span></span> <span data-ttu-id="de9bf-284">Al hacerlo, se evita que la hoja de propiedades se destruya y se devuelva el foco a la página que recibió la notificación de aplicación de PSN \_ o a la página que tenía el foco cuando se presionó el botón **aplicar** .</span><span class="sxs-lookup"><span data-stu-id="de9bf-284">Doing so prevents the property sheet from being destroyed and returns focus to either the page that received the PSN\_APPLY notification or the page that had focus when the **Apply** button was pressed.</span></span> <span data-ttu-id="de9bf-285">Para devolver un error e indicar la página que recibirá el foco, establezca **DWL \_ MSGRESULT** en uno de los valores siguientes.</span><span class="sxs-lookup"><span data-stu-id="de9bf-285">To return an error, and indicate which page will receive focus, set **DWL\_MSGRESULT** to one of the following values.</span></span>

-   <span data-ttu-id="de9bf-286">**PSNRET \_ NO válido**.</span><span class="sxs-lookup"><span data-stu-id="de9bf-286">**PSNRET\_INVALID**.</span></span> <span data-ttu-id="de9bf-287">La hoja de propiedades no se destruirá y se devolverá el foco a esta página.</span><span class="sxs-lookup"><span data-stu-id="de9bf-287">The property sheet will not be destroyed, and focus will be returned to this page.</span></span>
-   <span data-ttu-id="de9bf-288">**PSNRET \_ \_NOCHANGEPAGE no válido**.</span><span class="sxs-lookup"><span data-stu-id="de9bf-288">**PSNRET\_INVALID\_NOCHANGEPAGE**.</span></span> <span data-ttu-id="de9bf-289">La hoja de propiedades no se destruirá y el foco se devolverá a la página que tenía el foco cuando se presionó el botón.</span><span class="sxs-lookup"><span data-stu-id="de9bf-289">The property sheet will not be destroyed, and focus will be returned to the page that had focus when the button was pressed.</span></span>

<span data-ttu-id="de9bf-290">Una aplicación puede usar el mensaje [**PSM \_ Apply**](psm-apply.md) para simular la selección del botón **aplicar** .</span><span class="sxs-lookup"><span data-stu-id="de9bf-290">An application can use the [**PSM\_APPLY**](psm-apply.md) message to simulate the selection of the **Apply** button.</span></span>

<span data-ttu-id="de9bf-291">Inicialmente, el botón **aplicar** está deshabilitado cuando se activa una página, lo que indica que aún no hay ningún cambio en la propiedad que aplicar.</span><span class="sxs-lookup"><span data-stu-id="de9bf-291">The **Apply** button is initially disabled when a page becomes active, indicating that there are not yet any property changes to apply.</span></span> <span data-ttu-id="de9bf-292">Cuando la página recibe la entrada a través de uno de sus controles que indica que el usuario ha editado una propiedad, la página debe enviar el mensaje de [**\_ cambio de PSM**](psm-changed.md) a la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="de9bf-292">When the page receives input through one of its controls indicating that the user has edited a property, the page must send the [**PSM\_CHANGED**](psm-changed.md) message to the property sheet.</span></span> <span data-ttu-id="de9bf-293">El mensaje hace que la hoja de propiedades habilite el botón **aplicar** .</span><span class="sxs-lookup"><span data-stu-id="de9bf-293">The message causes the property sheet to enable the **Apply** button.</span></span> <span data-ttu-id="de9bf-294">Si el usuario hace clic en el botón **aplicar** o **Cancelar** , la página debe reinicializar sus controles y, a continuación, enviar el mensaje [**PSM \_ sin cambios**](psm-unchanged.md) para deshabilitar de nuevo el botón **aplicar** .</span><span class="sxs-lookup"><span data-stu-id="de9bf-294">If the user subsequently clicks the **Apply** or **Cancel** button, the page must reinitialize its controls and then send the [**PSM\_UNCHANGED**](psm-unchanged.md) message to again disable the **Apply** button.</span></span>

<span data-ttu-id="de9bf-295">A veces, el botón **aplicar** hace que una página realice un cambio en una hoja de propiedades y el cambio no se puede deshacer.</span><span class="sxs-lookup"><span data-stu-id="de9bf-295">Sometimes the **Apply** button causes a page to make a change to a property sheet, and the change cannot be undone.</span></span> <span data-ttu-id="de9bf-296">Cuando esto sucede, la página debe enviar el mensaje de [**PSM \_ CANCELTOCLOSE**](psm-canceltoclose.md) a la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="de9bf-296">When this happens, the page must send the [**PSM\_CANCELTOCLOSE**](psm-canceltoclose.md) message to the property sheet.</span></span> <span data-ttu-id="de9bf-297">El mensaje hace que la hoja de propiedades cambie el texto del botón **Aceptar** a "cerrar", lo que indica que los cambios aplicados no se pueden cancelar.</span><span class="sxs-lookup"><span data-stu-id="de9bf-297">The message causes the property sheet to change the text of the **OK** button to "Close," indicating that the applied changes cannot be canceled.</span></span>

<span data-ttu-id="de9bf-298">A veces, una página realiza un cambio en la configuración del sistema que requiere que se reinicie Windows o que el sistema se reinicie antes de que el cambio surta efecto.</span><span class="sxs-lookup"><span data-stu-id="de9bf-298">Sometimes a page makes a change to the system configuration that requires Windows to be restarted or the system rebooted before the change can take effect.</span></span> <span data-ttu-id="de9bf-299">Después de realizar este cambio, una página debe enviar el mensaje [**PSM \_ RESTARTWINDOWS**](psm-restartwindows.md) o [**PSM \_ REBOOTSYSTEM**](psm-rebootsystem.md) a la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="de9bf-299">After making such a change, a page must send either the [**PSM\_RESTARTWINDOWS**](psm-restartwindows.md) or [**PSM\_REBOOTSYSTEM**](psm-rebootsystem.md) message to the property sheet.</span></span> <span data-ttu-id="de9bf-300">Estos mensajes hacen que la función [**hoja**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) devuelva el valor de **identificador \_ PSRESTARTWINDOWS** o **ID \_ PSREBOOTSYSTEM** después de la destrucción de la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="de9bf-300">These messages cause the [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) function to return the **ID\_PSRESTARTWINDOWS** or **ID\_PSREBOOTSYSTEM** value after the property sheet is destroyed.</span></span>

<span data-ttu-id="de9bf-301">Cuando un usuario hace clic en el botón **Cancelar** , la hoja de propiedades envía el código de notificación de [ \_ restablecimiento de PSN](psn-reset.md) a todas las páginas, lo que indica que la hoja de propiedades está a punto de ser destruida.</span><span class="sxs-lookup"><span data-stu-id="de9bf-301">When a user clicks the **Cancel** button, the property sheet sends the [PSN\_RESET](psn-reset.md) notification code to all pages, indicating that the property sheet is about to be destroyed.</span></span> <span data-ttu-id="de9bf-302">Una página debe utilizar la notificación para realizar operaciones de limpieza.</span><span class="sxs-lookup"><span data-stu-id="de9bf-302">A page must use the notification to perform cleanup operations.</span></span>

## <a name="wizards"></a><span data-ttu-id="de9bf-303">Asistentes</span><span class="sxs-lookup"><span data-stu-id="de9bf-303">Wizards</span></span>

<span data-ttu-id="de9bf-304">Un asistente es un tipo especial de hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="de9bf-304">A wizard is a special type of property sheet.</span></span> <span data-ttu-id="de9bf-305">Los asistentes están diseñados para presentar las páginas de una en una en una secuencia controlada por la aplicación.</span><span class="sxs-lookup"><span data-stu-id="de9bf-305">Wizards are designed to present pages one at a time in a sequence that is controlled by the application.</span></span> <span data-ttu-id="de9bf-306">En lugar de seleccionar un grupo de páginas al hacer clic en una pestaña, los usuarios navegan hacia delante y hacia atrás por la secuencia, una página a la vez, haciendo clic en los botones.</span><span class="sxs-lookup"><span data-stu-id="de9bf-306">Instead of selecting from a group of pages by clicking a tab, users navigate forward and backward through the sequence, one page at a time, by clicking buttons.</span></span> <span data-ttu-id="de9bf-307">Por ejemplo, en la siguiente captura de pantalla se muestra la Página principal del Asistente para agregar hardware:</span><span class="sxs-lookup"><span data-stu-id="de9bf-307">For example, the following screen shot shows the welcome page from the Add Hardware wizard:</span></span>

![captura de pantalla de la Página principal de un asistente](images/wizard97.png)

<span data-ttu-id="de9bf-309">En la captura de pantalla siguiente se muestra la primera página de un asistente de Aero, el nuevo estilo introducido en Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="de9bf-309">The following screen shot shows the first page of an Aero Wizard, the new style introduced in Windows Vista.</span></span>

![captura de pantalla de la primera página de un asistente de Aero](images/wizardaero.png)

<span data-ttu-id="de9bf-311">Vea [crear asistentes](wizards.md) para obtener una descripción completa de los asistentes.</span><span class="sxs-lookup"><span data-stu-id="de9bf-311">See [Creating Wizards](wizards.md) for a complete discussion of wizards.</span></span>
