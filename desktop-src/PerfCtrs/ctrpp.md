---
description: La herramienta CTRPP es un preprocesador que analiza y valida el manifiesto de los contadores.
ms.assetid: 3939f6a1-0a94-429d-a71e-b37f045fea13
title: CTRPP
ms.topic: reference
ms.date: 08/17/2020
topic_type:
- APIRef
- kbSyntax
api_name:
- CTRPP
api_type:
- NA
api_location: ''
ms.openlocfilehash: dce12de641dda7b07871a4447190772533598748
ms.sourcegitcommit: de72a1294df274b0a71dc0fdc42d757e5f6df0f3
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/05/2021
ms.locfileid: "104361970"
---
# <a name="ctrpp"></a><span data-ttu-id="8479b-103">CTRPP</span><span class="sxs-lookup"><span data-stu-id="8479b-103">CTRPP</span></span>

<span data-ttu-id="8479b-104">La herramienta CTRPP es un preprocesador que analiza y valida el manifiesto del proveedor V2.</span><span class="sxs-lookup"><span data-stu-id="8479b-104">The CTRPP tool is a pre-processor that parses and validates the manifest for your V2 provider.</span></span> <span data-ttu-id="8479b-105">La herramienta genera `.rc` recursos con las cadenas que necesitan los consumidores del proveedor y genera un `.h` encabezado con el código que se usa para proporcionar los datos del contador.</span><span class="sxs-lookup"><span data-stu-id="8479b-105">The tool generates `.rc` resources with the strings needed by consumers of your provider, and it generates a `.h` header with code that you use to provide your counter data.</span></span> <span data-ttu-id="8479b-106">Debe ejecutar la herramienta CTRPP durante la compilación del proveedor.</span><span class="sxs-lookup"><span data-stu-id="8479b-106">You should run the CTRPP tool during the build of your provider.</span></span> <span data-ttu-id="8479b-107">Debe usar el código generado como punto de partida al desarrollar el proveedor en lugar de intentar generar este código.</span><span class="sxs-lookup"><span data-stu-id="8479b-107">You should use the generated code as a starting point when developing your provider instead of trying to generate this code yourself.</span></span>

```syntax
ctrpp -o codeFile -rc rcFile [-legacy] [-MemoryRoutines] [-NotificationCallback] [-prefix prefix] [-ch symFile] [-backcompat] inputFile
```

## <a name="arguments"></a><span data-ttu-id="8479b-108">Argumentos</span><span class="sxs-lookup"><span data-stu-id="8479b-108">Arguments</span></span>

|<span data-ttu-id="8479b-109">Opción</span><span class="sxs-lookup"><span data-stu-id="8479b-109">Option</span></span>              |<span data-ttu-id="8479b-110">Descripción</span><span class="sxs-lookup"><span data-stu-id="8479b-110">Description</span></span>
|--------------------|-----------
|<span data-ttu-id="8479b-111">*ArchivoDeEntrada*</span><span class="sxs-lookup"><span data-stu-id="8479b-111">*inputFile*</span></span>         |<span data-ttu-id="8479b-112">**Requerido:** Especifica el nombre del `.man` archivo (manifiesto XML) que define los contadores.</span><span class="sxs-lookup"><span data-stu-id="8479b-112">**Required:** Specifies the name of the `.man` (XML manifest) file that defines your counters.</span></span>
|<span data-ttu-id="8479b-113">**-o** *Codefile*</span><span class="sxs-lookup"><span data-stu-id="8479b-113">**-o** *codeFile*</span></span>   |<span data-ttu-id="8479b-114">**Requerido:** Especifica el nombre del `.h` archivo de código que va a generar CTRPP.</span><span class="sxs-lookup"><span data-stu-id="8479b-114">**Required:** Specifies the name of the `.h` code file to be generated by CTRPP.</span></span> <span data-ttu-id="8479b-115">Este archivo contendrá funciones auxiliares insertadas de C/C++ que simplifican la inicialización y la anulación de la inicialización del proveedor.</span><span class="sxs-lookup"><span data-stu-id="8479b-115">This file will contain C/C++ inline helper functions that simplify initializing and uninitializing your provider.</span></span>
|<span data-ttu-id="8479b-116">**-RC** *rcFile*</span><span class="sxs-lookup"><span data-stu-id="8479b-116">**-rc** *rcFile*</span></span>    |<span data-ttu-id="8479b-117">**Requerido:** Especifica el nombre del `.rc` (archivo de recursos) que va a generar CTRPP.</span><span class="sxs-lookup"><span data-stu-id="8479b-117">**Required:** Specifies the name of the `.rc` (resource file) to be generated by CTRPP.</span></span> <span data-ttu-id="8479b-118">Este archivo contendrá la tabla de cadenas del proveedor.</span><span class="sxs-lookup"><span data-stu-id="8479b-118">This file will contain the provider's string table.</span></span>
|<span data-ttu-id="8479b-119">**-CH** *symFile*</span><span class="sxs-lookup"><span data-stu-id="8479b-119">**-ch** *symFile*</span></span>   |<span data-ttu-id="8479b-120">Especifica el nombre del archivo de `.h` símbolos opcional que va a generar CTRPP.</span><span class="sxs-lookup"><span data-stu-id="8479b-120">Specifies the name of the optional `.h` symbol file to be generated by CTRPP.</span></span> <span data-ttu-id="8479b-121">Este archivo contendrá símbolos de C/C++ para los nombres y GUID de cada CounterSet en el proveedor.</span><span class="sxs-lookup"><span data-stu-id="8479b-121">This file will contain C/C++ symbols for the names and GUIDs of each counterset in the provider.</span></span>
|<span data-ttu-id="8479b-122">- *prefijo* **de prefijo**</span><span class="sxs-lookup"><span data-stu-id="8479b-122">**-prefix** *prefix*</span></span>|<span data-ttu-id="8479b-123">Especifica el prefijo que se va a usar para las variables y funciones definidas en el archivo de encabezado generado.</span><span class="sxs-lookup"><span data-stu-id="8479b-123">Specifies the prefix to use for the variables and functions defined in the generated header file.</span></span>
|<span data-ttu-id="8479b-124">**-NotificationCallback**</span><span class="sxs-lookup"><span data-stu-id="8479b-124">**-NotificationCallback**</span></span>|<span data-ttu-id="8479b-125">Cambia la firma predeterminada de la función de [**Contrainicialización**](counterinitialize.md) para incluir los parámetros para especificar el nombre de las funciones de devolución de llamada [*ControlCallback*](/windows/desktop/api/Perflib/nc-perflib-perflibrequest), [*AllocateMemory*](/windows/desktop/api/Perflib/nc-perflib-perf_mem_alloc)y [*FreeMemory (*](/windows/desktop/api/Perflib/nc-perflib-perf_mem_free) .</span><span class="sxs-lookup"><span data-stu-id="8479b-125">Changes the default signature of the [**CounterInitialize**](counterinitialize.md) function to include parameters for specifying the name of [*ControlCallback*](/windows/desktop/api/Perflib/nc-perflib-perflibrequest), [*AllocateMemory*](/windows/desktop/api/Perflib/nc-perflib-perf_mem_alloc), and [*FreeMemory*](/windows/desktop/api/Perflib/nc-perflib-perf_mem_free) callback functions.</span></span> <span data-ttu-id="8479b-126">Este argumento tiene el mismo efecto que incluir el `callback` atributo en el elemento de [**proveedor**](/windows/desktop/PerfCtrs/performance-counters-provider--counters--element) .</span><span class="sxs-lookup"><span data-stu-id="8479b-126">This argument has the same effect as including the `callback` attribute in the [**provider**](/windows/desktop/PerfCtrs/performance-counters-provider--counters--element) element.</span></span>
|<span data-ttu-id="8479b-127">**-migrar** *outputFile*</span><span class="sxs-lookup"><span data-stu-id="8479b-127">**-migrate** *outputFile*</span></span>|<span data-ttu-id="8479b-128">En lugar de generar `.h` `.rc` archivos y, actualiza el manifiesto de *ArchivoDeEntrada* a la versión más reciente y lo guarda en *outputFile*.</span><span class="sxs-lookup"><span data-stu-id="8479b-128">Instead of generating `.h` and `.rc` files, upgrades the *inputFile* manifest to the latest version and saves it to *outputFile*.</span></span> <span data-ttu-id="8479b-129">Este modificador no se puede usar con otros modificadores.</span><span class="sxs-lookup"><span data-stu-id="8479b-129">This switch cannot be used with other switches.</span></span> <span data-ttu-id="8479b-130">Uso: `CTRPP -migrate NewFile.man OldFile.man`</span><span class="sxs-lookup"><span data-stu-id="8479b-130">Usage: `CTRPP -migrate NewFile.man OldFile.man`</span></span>
|<span data-ttu-id="8479b-131">**-BackCompat**</span><span class="sxs-lookup"><span data-stu-id="8479b-131">**-BackCompat**</span></span>     |<span data-ttu-id="8479b-132">En **desuso:** En Windows 7 se ha agregado compatibilidad con proveedores de modo kernel.</span><span class="sxs-lookup"><span data-stu-id="8479b-132">**Deprecated:** Support for kernel-mode providers was added in Windows 7.</span></span> <span data-ttu-id="8479b-133">De forma predeterminada, el código generado por CTRPP para los proveedores de modo kernel no será compatible con versiones anteriores de Windows (el controlador no se cargará debido a que faltan `Pcw***` API).</span><span class="sxs-lookup"><span data-stu-id="8479b-133">By default, the code generated by CTRPP for kernel-mode providers will be incompatible with earlier versions of Windows (driver will fail to load due to missing `Pcw***` APIs).</span></span> <span data-ttu-id="8479b-134">Establezca `-BackCompat` para habilitar la compatibilidad con versiones anteriores de Windows.</span><span class="sxs-lookup"><span data-stu-id="8479b-134">Set `-BackCompat` to enable compatibility with earlier versions of Windows.</span></span> <span data-ttu-id="8479b-135">El controlador cargará dinámicamente las API necesarias y el código generado deshabilitará de forma silenciosa el proveedor si las API no están disponibles.</span><span class="sxs-lookup"><span data-stu-id="8479b-135">The driver will dynamically load the necessary APIs and the generated code will silently disable the provider if the APIs are not available.</span></span>
|<span data-ttu-id="8479b-136">**-MemoryRoutines**</span><span class="sxs-lookup"><span data-stu-id="8479b-136">**-MemoryRoutines**</span></span> |<span data-ttu-id="8479b-137">En **desuso:** Cuando se usa con el `-Legacy` modificador, incluye plantillas para las rutinas de memoria en el código generado.</span><span class="sxs-lookup"><span data-stu-id="8479b-137">**Deprecated:** When used with the `-Legacy` switch, includes templates for memory routines in the generated code.</span></span> <span data-ttu-id="8479b-138">De lo contrario, este argumento tiene el mismo efecto que el `-NotificationCallback` modificador.</span><span class="sxs-lookup"><span data-stu-id="8479b-138">Otherwise, this argument has the same effect as the `-NotificationCallback` switch.</span></span>
|<span data-ttu-id="8479b-139">**-Heredado**</span><span class="sxs-lookup"><span data-stu-id="8479b-139">**-Legacy**</span></span>         |<span data-ttu-id="8479b-140">En **desuso:** Genera `*.h` `*.c` archivos,, `*.rc` y `*_r.h` con las plantillas de código de Windows Vista (genera PerfAutoInitialize y PerfAutoCleanup en lugar de la contrainicialización y la limpieza).</span><span class="sxs-lookup"><span data-stu-id="8479b-140">**Deprecated:** Generates `*.h`, `*.c`, `*.rc`, and `*_r.h` files using the Windows Vista code templates (generates PerfAutoInitialize and PerfAutoCleanup instead of CounterInitialize and CounterCleanup).</span></span> <span data-ttu-id="8479b-141">Este modificador se puede usar con **-MemoryRoutines** y **-NotificationCallback** , pero no se puede usar con ningún otro modificador.</span><span class="sxs-lookup"><span data-stu-id="8479b-141">This switch can be used with **-MemoryRoutines** and **-NotificationCallback** but cannot be used with any other switches.</span></span> <span data-ttu-id="8479b-142">No use los modificadores **-o** o **-RC** con este modificador.</span><span class="sxs-lookup"><span data-stu-id="8479b-142">Do not use the **-o** or **-rc** switches with this switch.</span></span> <span data-ttu-id="8479b-143">Los archivos generados se nombrarán según el nombre del manifiesto y se escribirán en el directorio que contenía el manifiesto.</span><span class="sxs-lookup"><span data-stu-id="8479b-143">The generated files will be named based on the name of the manifest and will be written to the directory that contained the manifest.</span></span> <span data-ttu-id="8479b-144">Uso: `CTRPP -legacy OldFile.man`</span><span class="sxs-lookup"><span data-stu-id="8479b-144">Usage: `CTRPP -legacy OldFile.man`</span></span>

## <a name="remarks"></a><span data-ttu-id="8479b-145">Observaciones</span><span class="sxs-lookup"><span data-stu-id="8479b-145">Remarks</span></span>

<span data-ttu-id="8479b-146">La herramienta CTRPP genera un `.h` archivo de código, un `.rc` archivo de recursos y, opcionalmente, genera un `.h` archivo de símbolos.</span><span class="sxs-lookup"><span data-stu-id="8479b-146">The CTRPP tool generates a `.h` code file, an `.rc` resource file, and optionally generates a `.h` symbol file.</span></span>

### <a name="using-the-generated-resource-file"></a><span data-ttu-id="8479b-147">Usar el archivo de recursos generado</span><span class="sxs-lookup"><span data-stu-id="8479b-147">Using the generated resource file</span></span>

<span data-ttu-id="8479b-148">La herramienta CTRPP generará un `.rc` archivo de recursos que contiene las cadenas localizables que necesitan los consumidores de los contraconjuntos del proveedor.</span><span class="sxs-lookup"><span data-stu-id="8479b-148">The CTRPP tool will generate a `.rc` resource file that contains the localizable strings needed by consumers of the provider's countersets.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8479b-149">Los recursos de este archivo se deben incluir en el binario del proveedor y la ruta de acceso completa al binario del proveedor se debe registrar durante la instalación del manifiesto del proveedor.</span><span class="sxs-lookup"><span data-stu-id="8479b-149">The resources from this file must be included into your provider binary and the full path to the provider binary must be registered during the installation of your provider's manifest.</span></span> <span data-ttu-id="8479b-150">Los consumidores que no pueden localizar y cargar los recursos no podrán usar los valores de su proveedor.</span><span class="sxs-lookup"><span data-stu-id="8479b-150">Consumers that are unable to locate and load the resources will be unable to use your provider's countersets.</span></span>

<span data-ttu-id="8479b-151">Los recursos de cadena deben administrarse de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="8479b-151">The string resources should be handled as follows:</span></span>

- <span data-ttu-id="8479b-152">El desarrollador edita el archivo de manifiesto del proveedor ( `.man` ) para establecer el `applicationIdentity` atributo del proveedor en el nombre de un binario de proveedor (. DLL,. SYS o. EXE) que contendrá los recursos de cadena para el proveedor y se instalará como parte del componente de proveedor.</span><span class="sxs-lookup"><span data-stu-id="8479b-152">The developer edits the provider manifest (`.man`) file to set the `applicationIdentity` attribute of the provider to the name of a provider binary (.DLL, .SYS, or .EXE) that will contain the string resources for the provider and will be installed as part of the provider component.</span></span>
- <span data-ttu-id="8479b-153">La herramienta CTRPP lee el manifiesto del proveedor y genera un `.rc` archivo.</span><span class="sxs-lookup"><span data-stu-id="8479b-153">The CTRPP tool reads the provider manifest and generates an `.rc` file.</span></span>
- <span data-ttu-id="8479b-154">La herramienta [RC (compilador de recursos)](../menurc/resource-compiler.md) compila los datos del archivo generado por CTRPP `.rc` para generar un `.res` archivo que contiene los recursos binarios.</span><span class="sxs-lookup"><span data-stu-id="8479b-154">The [RC (resource compiler)](../menurc/resource-compiler.md) tool compiles the data from the CTRPP-generated `.rc` file to generate a `.res` file containing the binary resources.</span></span> <span data-ttu-id="8479b-155">Para ello, puede compilar directamente el archivo generado por CTRPP `.rc` o compilar otro `.rc` archivo que incluya el archivo generado por CTRPP `.rc` a través de una `#include` Directiva.</span><span class="sxs-lookup"><span data-stu-id="8479b-155">This can be done either by directly compiling the CTRPP-generated `.rc` file OR by compiling another `.rc` file that includes the CTRPP-generated `.rc` file via an `#include` directive.</span></span>
- <span data-ttu-id="8479b-156">El vinculador incrusta los datos del archivo generado por RC `.res` en el binario del proveedor.</span><span class="sxs-lookup"><span data-stu-id="8479b-156">The linker embeds the data from the RC-generated `.res` file into the provider binary.</span></span>
- <span data-ttu-id="8479b-157">Durante la instalación, el binario del proveedor se copia en el sistema del usuario y el manifiesto del proveedor se registra mediante la [herramienta LODCTR](/windows-server/administration/windows-commands/lodctr).</span><span class="sxs-lookup"><span data-stu-id="8479b-157">During installation, the provider binary is copied onto the user's system and the provider manifest is registered using the [lodctr tool](/windows-server/administration/windows-commands/lodctr).</span></span> <span data-ttu-id="8479b-158">La herramienta LODCTR convierte el `applicationIdentity` atributo del manifiesto del proveedor en una ruta de acceso completa y registra la ruta de acceso completa al binario del proveedor en el registro.</span><span class="sxs-lookup"><span data-stu-id="8479b-158">The lodctr tool converts the `applicationIdentity` attribute of the provider manifest into a full path and records the full path to the provider binary in the registry.</span></span>
  - <span data-ttu-id="8479b-159">Si el binario del proveedor está en el mismo directorio que el manifiesto, use: `lodctr.exe /m:"C:\full\manifest\path\manifest.man"` .</span><span class="sxs-lookup"><span data-stu-id="8479b-159">If the provider binary is in the same directory as the manifest, use: `lodctr.exe /m:"C:\full\manifest\path\manifest.man"`.</span></span> <span data-ttu-id="8479b-160">LODCTR combinará la ruta de acceso del manifiesto especificada con el atributo del manifiesto `applicationIdentity` para formar la ruta de acceso completa.</span><span class="sxs-lookup"><span data-stu-id="8479b-160">lodctr will combine the specified manifest path with the manifest's `applicationIdentity` attribute to form the full path.</span></span>
  - <span data-ttu-id="8479b-161">De lo contrario, use `lodctr.exe /m:"C:\full\manifest\path\manifest.man" "c:\full\binary\path"`.</span><span class="sxs-lookup"><span data-stu-id="8479b-161">Otherwise, use `lodctr.exe /m:"C:\full\manifest\path\manifest.man" "c:\full\binary\path"`.</span></span> <span data-ttu-id="8479b-162">LODCTR combinará la ruta de acceso binaria especificada con el atributo del manifiesto `applicationIdentity` para formar la ruta de acceso completa.</span><span class="sxs-lookup"><span data-stu-id="8479b-162">lodctr will combine the specified binary path with the manifest's `applicationIdentity` attribute to form the full path.</span></span>
  - <span data-ttu-id="8479b-163">Con fines de diagnóstico, puede inspeccionar la ruta de acceso completa registrada comprobando el `ApplicationIdentity` valor de la clave del registro `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Perflib\_V2Providers\{<ProviderGuid>}` .</span><span class="sxs-lookup"><span data-stu-id="8479b-163">For diagnostic purposes, you can inspect the recorded full path by checking the `ApplicationIdentity` value of registry key `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Perflib\_V2Providers\{<ProviderGuid>}`.</span></span>
  - <span data-ttu-id="8479b-164">Si el binario usa MUI para la localización, asegúrese de copiar el archivo MUI junto con el binario.</span><span class="sxs-lookup"><span data-stu-id="8479b-164">If the binary is using MUI for localization, be sure to copy the MUI file along with the binary.</span></span>
- <span data-ttu-id="8479b-165">Durante la colección CounterSet, el consumidor utiliza la ruta de acceso completa registrada al binario del proveedor para buscar y cargar las cadenas necesarias de los recursos del binario del proveedor.</span><span class="sxs-lookup"><span data-stu-id="8479b-165">During counterset collection, the consumer uses the recorded full path to the provider binary to locate and load the necessary strings from the provider binary's resources.</span></span>

### <a name="using-the-generated-code-file-in-a-user-mode-provider"></a><span data-ttu-id="8479b-166">Usar el archivo de código generado en un proveedor de modo de usuario</span><span class="sxs-lookup"><span data-stu-id="8479b-166">Using the generated code file in a user-mode provider</span></span>

<span data-ttu-id="8479b-167">La herramienta CTRPP generará un `.h` archivo de código de C/C++.</span><span class="sxs-lookup"><span data-stu-id="8479b-167">The CTRPP tool will generate a `.h` C/C++ code file.</span></span> <span data-ttu-id="8479b-168">Si el atributo del manifiesto del proveedor `providerType` está establecido en `userMode` , el archivo de código generado contendrá las siguientes definiciones que son útiles para codificar un proveedor de modo usuario:</span><span class="sxs-lookup"><span data-stu-id="8479b-168">If the provider manifest's `providerType` attribute is set to `userMode`, the generated code file will contain the following definitions that are helpful in coding a user-mode provider:</span></span>

- <span data-ttu-id="8479b-169">Una función de inicialización de proveedor denominada [ \* **prefix \* contrainitial**](counterinitialize.md).</span><span class="sxs-lookup"><span data-stu-id="8479b-169">An provider initialization function named [\***prefix\*CounterInitialize**](counterinitialize.md).</span></span>
- <span data-ttu-id="8479b-170">Una función de limpieza de proveedor denominada [ \* **prefix \* contracleanup**](countercleanup.md).</span><span class="sxs-lookup"><span data-stu-id="8479b-170">A provider cleanup function named [\***prefix\*CounterCleanup**](countercleanup.md).</span></span>
- <span data-ttu-id="8479b-171">Una variable global \***Provider** _ que almacena el identificador de proveedor abierto por la función _ \*_prefix_CounterInitialize\*\*.</span><span class="sxs-lookup"><span data-stu-id="8479b-171">A global ***provider** _ variable that stores the provider handle opened by the _ *_prefix_CounterInitialize** function.</span></span> <span data-ttu-id="8479b-172">El nombre de la variable es el valor del `symbol` atributo del `provider` elemento en el manifiesto.</span><span class="sxs-lookup"><span data-stu-id="8479b-172">The variable's name is the value of the `symbol` attribute of the `provider` element in the manifest.</span></span> <span data-ttu-id="8479b-173">Esta variable se debe usar en las llamadas a `PerfCreateInstance` , `PerfDeleteInstance` y otras API para controlar los datos del proveedor.</span><span class="sxs-lookup"><span data-stu-id="8479b-173">This variable should be used in calls to `PerfCreateInstance`, `PerfDeleteInstance`, and other APIs for controlling your provider's data.</span></span>
- <span data-ttu-id="8479b-174">Para cada CounterSet, una variable global \***CounterSet \* GUID** con el GUID de CounterSet.</span><span class="sxs-lookup"><span data-stu-id="8479b-174">For each counterset, a global \***counterset\*GUID** variable with the counterset GUID.</span></span> <span data-ttu-id="8479b-175">El nombre de la variable es el valor del `counterSet` atributo del elemento `symbol` más el sufijo "GUID", por ejemplo, `MyCounterSetGUID` .</span><span class="sxs-lookup"><span data-stu-id="8479b-175">The variable's name is the value of the `counterSet` element's `symbol` attribute plus the suffix "GUID", e.g. `MyCounterSetGUID`.</span></span> <span data-ttu-id="8479b-176">Esta variable se debe usar en las llamadas a `PerfCreateInstance` , `PerfDeleteInstance` y otras API para controlar los datos del proveedor.</span><span class="sxs-lookup"><span data-stu-id="8479b-176">This variable should be used in calls to `PerfCreateInstance`, `PerfDeleteInstance`, and other APIs for controlling your provider's data.</span></span>
- <span data-ttu-id="8479b-177">Para cada contador, una macro de ***contador*** con el valor del contador `id` .</span><span class="sxs-lookup"><span data-stu-id="8479b-177">For each counter, a ***counter*** macro with the counter's `id` value.</span></span> <span data-ttu-id="8479b-178">El nombre de la macro es el valor del `counter` atributo del elemento `symbol` .</span><span class="sxs-lookup"><span data-stu-id="8479b-178">The macro's name is the value of the `counter` element's `symbol` attribute.</span></span> <span data-ttu-id="8479b-179">Esta macro se debe usar en las llamadas a `PerfSetCounterRefValue` , `PerfSetULongLongCounterValue` y otras API para configurar los datos del proveedor.</span><span class="sxs-lookup"><span data-stu-id="8479b-179">This macro should be used in calls to `PerfSetCounterRefValue`, `PerfSetULongLongCounterValue`, and other APIs for setting your provider's data.</span></span>

<span data-ttu-id="8479b-180">En los nombres de función, el ***prefijo*** hace referencia al valor del `-prefix` parámetro de línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="8479b-180">In the function names, ***prefix*** refers to the value of the `-prefix` command-line parameter.</span></span> <span data-ttu-id="8479b-181">Si `-prefix` no se usa el parámetro, las funciones se denominarán `CounterInitialize` y `CounterCleanup` .</span><span class="sxs-lookup"><span data-stu-id="8479b-181">If the `-prefix` parameter is not used the functions will be named `CounterInitialize` and `CounterCleanup`.</span></span>

### <a name="using-the-generated-code-file-in-a-kernel-mode-provider"></a><span data-ttu-id="8479b-182">Usar el archivo de código generado en un proveedor de modo kernel</span><span class="sxs-lookup"><span data-stu-id="8479b-182">Using the generated code file in a kernel-mode provider</span></span>

<span data-ttu-id="8479b-183">La herramienta CTRPP generará un `.h` archivo de código de C/C++.</span><span class="sxs-lookup"><span data-stu-id="8479b-183">The CTRPP tool will generate a `.h` C/C++ code file.</span></span> <span data-ttu-id="8479b-184">Si el atributo del manifiesto del proveedor `providerType` está establecido en `kernelMode` , el archivo de código generado contendrá las siguientes definiciones que son útiles para codificar los contraconjuntos de un proveedor de modo kernel:</span><span class="sxs-lookup"><span data-stu-id="8479b-184">If the provider manifest's `providerType` attribute is set to `kernelMode`, the generated code file will contain the following definitions that are helpful in coding a kernel-mode provider's countersets:</span></span>

- <span data-ttu-id="8479b-185">Una función de inicialización de CounterSet denominada <b> *prefix* registra *CounterSet*</b>.</span><span class="sxs-lookup"><span data-stu-id="8479b-185">A counterset initialization function named <b>*prefix* Register *Counterset*</b>.</span></span> <span data-ttu-id="8479b-186">Esta función rellena una estructura [RegInfo](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_registration_information) y después invoca [PcwRegister](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwregister), colocando el identificador de registro CounterSet resultante en la variable global ***CounterSet*** .</span><span class="sxs-lookup"><span data-stu-id="8479b-186">This function fills in a [RegInfo](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_registration_information) structure then invokes [PcwRegister](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwregister), putting the resulting counterset registration handle into the global ***Counterset*** variable.</span></span>
- <span data-ttu-id="8479b-187">Una función de limpieza CounterSet denominada <b> *prefix* unregister *CounterSet*</b>.</span><span class="sxs-lookup"><span data-stu-id="8479b-187">A counterset cleanup function named <b>*prefix* Unregister *Counterset*</b>.</span></span> <span data-ttu-id="8479b-188">Esta función invoca [PcwUnregister](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwunregister) en el identificador de registro de CounterSet en la variable global ***CounterSet*** .</span><span class="sxs-lookup"><span data-stu-id="8479b-188">This function invokes [PcwUnregister](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwunregister) on the counterset registration handle in the global ***Counterset*** variable.</span></span>
- <span data-ttu-id="8479b-189">Una función de creación de instancia denominada <b> *prefix* Create *CounterSet*</b>.</span><span class="sxs-lookup"><span data-stu-id="8479b-189">An instance creation function named <b>*prefix* Create *Counterset*</b>.</span></span> <span data-ttu-id="8479b-190">Esta función rellena una matriz de estructuras [PcwData](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_data) y, a continuación, invoca [PcwCreateInstance](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwcreateinstance) con el identificador de registro CounterSet en la variable global ***CounterSet*** .</span><span class="sxs-lookup"><span data-stu-id="8479b-190">This function fills in an array of [PcwData](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_data) structures then invokes [PcwCreateInstance](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwcreateinstance) using the counterset registration handle in the global ***Counterset*** variable.</span></span>
- <span data-ttu-id="8479b-191">Una función de limpieza de instancia denominada <b> *prefix* Close *CounterSet*</b>.</span><span class="sxs-lookup"><span data-stu-id="8479b-191">An instance cleanup function named <b>*prefix* Close *Counterset*</b>.</span></span> <span data-ttu-id="8479b-192">Esta función invoca [PcwCloseInstance](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwcloseinstance).</span><span class="sxs-lookup"><span data-stu-id="8479b-192">This function invokes [PcwCloseInstance](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwcloseinstance).</span></span>
- <span data-ttu-id="8479b-193">Una función de creación de informes de instancia denominada <b> *prefix* Add *CounterSet*</b> que se va a usar desde la función de devolución de llamada CounterSet.</span><span class="sxs-lookup"><span data-stu-id="8479b-193">An instance reporting function named <b>*prefix* Add *Counterset*</b> to be used from the counterset callback function.</span></span> <span data-ttu-id="8479b-194">Esta función rellena una matriz de estructuras [PcwData](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_data) y, a continuación, invoca [PcwAddInstance](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwaddinstance).</span><span class="sxs-lookup"><span data-stu-id="8479b-194">This function fills in an array of [PcwData](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_data) structures then invokes [PcwAddInstance](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwaddinstance).</span></span>
- <span data-ttu-id="8479b-195">**Windows SDK 20H1 y versiones posteriores:** Una función de inicialización de RegInfo denominada <b> *prefix* InitRegistrationInformation *CounterSet*</b> para su uso en escenarios avanzados.</span><span class="sxs-lookup"><span data-stu-id="8479b-195">**Windows SDK 20H1 and later:** A RegInfo initialization function named <b>*prefix* InitRegistrationInformation *Counterset*</b> for use in advanced scenarios.</span></span> <span data-ttu-id="8479b-196">Esta función rellena una estructura [RegInfo](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_registration_information) .</span><span class="sxs-lookup"><span data-stu-id="8479b-196">This function fills in a [RegInfo](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_registration_information) structure.</span></span> <span data-ttu-id="8479b-197">Esta función se puede usar en casos en los que el valor de <b>*CounterSet* del registro de *prefijo*</b> generado no satisface sus necesidades, por ejemplo, cuando desea personalizar los valores de la estructura RegInfo o cuando desea almacenar el identificador devuelto en otra variable.</span><span class="sxs-lookup"><span data-stu-id="8479b-197">This function can be used in cases where the generated <b>*prefix* Register *Counterset*</b> does not meet your needs, e.g. when you want to customize the values in the RegInfo structure or when you want to store the returned handle in another variable.</span></span>

<span data-ttu-id="8479b-198">En los nombres de función, el ***prefijo*** hace referencia al valor del `-prefix` parámetro de línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="8479b-198">In the function names, ***prefix*** refers to the value of the `-prefix` command-line parameter.</span></span> <span data-ttu-id="8479b-199">Si `-prefix` no se usa el parámetro, las funciones no tendrán ningún prefijo.</span><span class="sxs-lookup"><span data-stu-id="8479b-199">If the `-prefix` parameter is not used the functions will have no prefix.</span></span>

> [!NOTE]
> <span data-ttu-id="8479b-200">La función de <b> *prefijo* de agregar *CounterSet*</b> generada se usa cuando se tiene una devolución de llamada CounterSet.</span><span class="sxs-lookup"><span data-stu-id="8479b-200">The generated <b>*prefix* Add *Counterset*</b> function is used when you have a counterset callback.</span></span> <span data-ttu-id="8479b-201">Las funciones generadas de <b> *prefijo* de creación *CounterSet*</b> y de cierre de <b> *prefijo*</b> CounterSet se usan cuando no se tiene una devolución de llamada CounterSet.</span><span class="sxs-lookup"><span data-stu-id="8479b-201">The generated <b>*prefix* Create *Counterset*</b> and <b>*prefix* Close *Counterset*</b> functions are used when you do not have a counterset callback.</span></span>

### <a name="using-the-generated-symbol-file"></a><span data-ttu-id="8479b-202">Usar el archivo de símbolos generado</span><span class="sxs-lookup"><span data-stu-id="8479b-202">Using the generated symbol file</span></span>

<span data-ttu-id="8479b-203">Si se especifica el parámetro **-CH** en la línea de comandos, la herramienta CTRPP generará un `.h` archivo de símbolos.</span><span class="sxs-lookup"><span data-stu-id="8479b-203">If the **-ch** parameter is specified on the command line, the CTRPP tool will generate a `.h` symbol file.</span></span> <span data-ttu-id="8479b-204">Este archivo contiene los símbolos de C/C++ para los nombres y GUID de cada CounterSet en el proveedor.</span><span class="sxs-lookup"><span data-stu-id="8479b-204">This file contains the C/C++ symbols for the names and GUIDs of each counterset in the provider.</span></span> <span data-ttu-id="8479b-205">Los símbolos se pueden usar al escribir programas que están codificados de forma rígida para consumir los datos de este CounterSet mediante las [funciones de consumidor de Perflib V2](using-the-perflib-functions-to-consume-counter-data.md).</span><span class="sxs-lookup"><span data-stu-id="8479b-205">The symbols can be used when writing programs that are hard-coded to consume the data from this counterset using the [PerfLib V2 Consumer functions](using-the-perflib-functions-to-consume-counter-data.md).</span></span>

## <a name="requirements"></a><span data-ttu-id="8479b-206">Requisitos</span><span class="sxs-lookup"><span data-stu-id="8479b-206">Requirements</span></span>

|                         ||
|-------------------------|----
| <span data-ttu-id="8479b-207">Cliente mínimo compatible</span><span class="sxs-lookup"><span data-stu-id="8479b-207">Minimum supported client</span></span>| <span data-ttu-id="8479b-208">Solo aplicaciones de escritorio de Windows Vista \[\]</span><span class="sxs-lookup"><span data-stu-id="8479b-208">Windows Vista \[desktop apps only\]</span></span>
| <span data-ttu-id="8479b-209">Servidor mínimo compatible</span><span class="sxs-lookup"><span data-stu-id="8479b-209">Minimum supported server</span></span>| <span data-ttu-id="8479b-210">Solo aplicaciones de escritorio de Windows Server 2008 \[\]</span><span class="sxs-lookup"><span data-stu-id="8479b-210">Windows Server 2008 \[desktop apps only\]</span></span>
