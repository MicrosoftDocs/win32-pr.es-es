---
description: Los objetos agrupables deben cumplir ciertos requisitos para permitir que varios clientes puedan usar una única instancia de objeto.
ms.assetid: 2cd4211e-be12-4197-8b43-5cb9f2321016
title: Requisitos para objetos agrupables
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 78d6834210f180ad8b514b51b6926b5cd30714fd
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104000568"
---
# <a name="requirements-for-poolable-objects"></a><span data-ttu-id="b1f19-103">Requisitos para objetos agrupables</span><span class="sxs-lookup"><span data-stu-id="b1f19-103">Requirements for Poolable Objects</span></span>

<span data-ttu-id="b1f19-104">Los objetos agrupables deben cumplir ciertos requisitos para permitir que varios clientes puedan usar una única instancia de objeto.</span><span class="sxs-lookup"><span data-stu-id="b1f19-104">Poolable objects must meet certain requirements to enable a single object instance to be used by multiple clients.</span></span>

## <a name="stateless"></a><span data-ttu-id="b1f19-105">Sin estado</span><span class="sxs-lookup"><span data-stu-id="b1f19-105">Stateless</span></span>

<span data-ttu-id="b1f19-106">Para mantener la seguridad, la coherencia y el aislamiento, los objetos agrupables no deben tener ningún estado específico del cliente del cliente al cliente.</span><span class="sxs-lookup"><span data-stu-id="b1f19-106">To maintain security, consistency, and isolation, poolable objects should hold no client-specific state from client to client.</span></span> <span data-ttu-id="b1f19-107">Puede administrar cualquier estado por cliente mediante [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol), realizando una inicialización específica del contexto con [**IObjectControl:: Activate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) y limpiando cualquier estado de cliente con [**IObjectControl::D eactivate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate).</span><span class="sxs-lookup"><span data-stu-id="b1f19-107">You can manage any per-client state by using [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol), performing context-specific initialization with [**IObjectControl::Activate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) and cleaning up any client state with [**IObjectControl::Deactivate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate).</span></span> <span data-ttu-id="b1f19-108">Para obtener más información, vea [controlar la duración y el estado](controlling-object-lifetime-and-state.md)de los objetos.</span><span class="sxs-lookup"><span data-stu-id="b1f19-108">For more detail, see [Controlling Object Lifetime and State](controlling-object-lifetime-and-state.md).</span></span>

## <a name="no-thread-affinity"></a><span data-ttu-id="b1f19-109">Sin afinidad de subprocesos</span><span class="sxs-lookup"><span data-stu-id="b1f19-109">No Thread Affinity</span></span>

<span data-ttu-id="b1f19-110">Los objetos agrupables no se pueden enlazar a un subproceso determinado; de lo contrario, el rendimiento podría ser desastroso.</span><span class="sxs-lookup"><span data-stu-id="b1f19-110">Poolable objects cannot be bound to a particular thread; otherwise, performance could be potentially disastrous.</span></span> <span data-ttu-id="b1f19-111">Por esta razón, los objetos agrupables no se pueden marcar para ejecutarse en el modelo de apartamento; deben ejecutarse en el contenedor multiproceso o en el contenedor neutro.</span><span class="sxs-lookup"><span data-stu-id="b1f19-111">For this reason, poolable objects cannot be marked to run in the apartment model; they must run in the multithreaded apartment or the neutral apartment.</span></span> <span data-ttu-id="b1f19-112">Además, los objetos agrupables no deben usar el almacenamiento local para el subproceso ni deben agregar el contador de referencias de subprocesamiento libre.</span><span class="sxs-lookup"><span data-stu-id="b1f19-112">In addition, poolable objects should not use thread local storage nor should they aggregate the free-threaded marshaler.</span></span> <span data-ttu-id="b1f19-113">Para obtener más información acerca de los subprocesos en COM+, vea [modelos de subprocesos com+](com--threading-models.md).</span><span class="sxs-lookup"><span data-stu-id="b1f19-113">For more detail about threading in COM+, see [COM+ Threading Models](com--threading-models.md).</span></span>

> [!Note]  
> <span data-ttu-id="b1f19-114">Los entornos de desarrollo de Microsoft Visual Basic 6,0 y anteriores solo pueden crear componentes de modelo de apartamento.</span><span class="sxs-lookup"><span data-stu-id="b1f19-114">The Microsoft Visual Basic 6.0 and earlier development environments can create only apartment model components.</span></span> <span data-ttu-id="b1f19-115">Sin embargo, en Visual Basic .NET, los componentes se pueden agrupar.</span><span class="sxs-lookup"><span data-stu-id="b1f19-115">However, in Visual Basic .NET, components can be pooled.</span></span>

 

## <a name="aggregatable"></a><span data-ttu-id="b1f19-116">Aggregatable</span><span class="sxs-lookup"><span data-stu-id="b1f19-116">Aggregatable</span></span>

<span data-ttu-id="b1f19-117">Los objetos agrupables deben admitir la agregación; es decir, deben admitir que se creen mediante la invocación de [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) con un argumento *pUnkOuter* que no sea NULL.</span><span class="sxs-lookup"><span data-stu-id="b1f19-117">Poolable objects must support aggregation—that is, they must support being created by invoking [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) with a non-NULL *pUnkOuter* argument.</span></span> <span data-ttu-id="b1f19-118">Cuando COM+ activa un objeto agrupado, crea un agregado para administrar la duración del objeto agrupado y llamar a métodos en [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol).</span><span class="sxs-lookup"><span data-stu-id="b1f19-118">When COM+ activates a pooled object, it creates an aggregate to manage the lifetime of the pooled object and to call methods on [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol).</span></span> <span data-ttu-id="b1f19-119">Para obtener más información sobre cómo escribir objetos agregables, vea [agregación](/windows/desktop/com/aggregation).</span><span class="sxs-lookup"><span data-stu-id="b1f19-119">For details on writing aggregatable objects, see [Aggregation](/windows/desktop/com/aggregation).</span></span>

## <a name="transactional-components"></a><span data-ttu-id="b1f19-120">Componentes transaccionales</span><span class="sxs-lookup"><span data-stu-id="b1f19-120">Transactional Components</span></span>

<span data-ttu-id="b1f19-121">Los objetos agrupables que participan en transacciones deben dar de alta manualmente los recursos administrados.</span><span class="sxs-lookup"><span data-stu-id="b1f19-121">Poolable objects that participate in transactions must manually enlist managed resources.</span></span> <span data-ttu-id="b1f19-122">Mientras está agrupado, si el objeto contiene un recurso administrado como una conexión de base de datos, no habrá forma de que el administrador de recursos dé de alta automáticamente en una transacción cuando el objeto se activa en el contexto especificado.</span><span class="sxs-lookup"><span data-stu-id="b1f19-122">While it is pooled, if your object holds a managed resource such as a database connection, there will be no way for the resource manager to automatically enlist in a transaction when the object is activated in given context.</span></span> <span data-ttu-id="b1f19-123">Por lo tanto, el propio objeto debe controlar la lógica de detección de la transacción, desactivando la inscripción automática del administrador de recursos y dando de alta manualmente los recursos que contiene.</span><span class="sxs-lookup"><span data-stu-id="b1f19-123">Therefore, the object itself must handle the logic of detecting the transaction, turning off the resource manager's auto-enlistment and manually enlisting any resources that it holds.</span></span> <span data-ttu-id="b1f19-124">Además, un objeto agrupado transaccional debe reflejar el estado actual de sus recursos en los valores de parámetro de [**IObjectControl:: CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled).</span><span class="sxs-lookup"><span data-stu-id="b1f19-124">In addition, a transactional pooled object should reflect the current state of its resources in the parameter values of [**IObjectControl::CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled).</span></span> <span data-ttu-id="b1f19-125">Para obtener más información, consulte [agrupación de objetos transaccionales](pooling-transactional-objects.md).</span><span class="sxs-lookup"><span data-stu-id="b1f19-125">For more detail, see [Pooling Transactional Objects](pooling-transactional-objects.md).</span></span>

## <a name="implement-iobjectcontrol-to-manage-the-object-lifetime"></a><span data-ttu-id="b1f19-126">Implementar IObjectControl para administrar la duración de los objetos</span><span class="sxs-lookup"><span data-stu-id="b1f19-126">Implement IObjectControl to Manage the Object Lifetime</span></span>

<span data-ttu-id="b1f19-127">Los objetos agrupables deben implementar [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol), aunque no es estrictamente necesario hacerlo.</span><span class="sxs-lookup"><span data-stu-id="b1f19-127">Poolable objects should implement [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol), although it is not strictly necessary to do so.</span></span> <span data-ttu-id="b1f19-128">Los componentes transaccionales que se agrupan, sin embargo, deben implementar **IObjectControl**.</span><span class="sxs-lookup"><span data-stu-id="b1f19-128">Transactional components that are pooled, however, must implement **IObjectControl**.</span></span> <span data-ttu-id="b1f19-129">Estos componentes deben supervisar el estado de los recursos que contienen e indicar cuándo no se pueden volver a usar. Cuando [**IObjectControl:: CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled) devuelve false, terminará una transacción.</span><span class="sxs-lookup"><span data-stu-id="b1f19-129">These components should monitor the state of the resources they hold and indicate when they can't be reused; when [**IObjectControl::CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled) returns false, it will doom a transaction.</span></span> <span data-ttu-id="b1f19-130">Para obtener más información, vea [controlar la duración y el estado](controlling-object-lifetime-and-state.md)de los objetos.</span><span class="sxs-lookup"><span data-stu-id="b1f19-130">For more detail, see [Controlling Object Lifetime and State](controlling-object-lifetime-and-state.md).</span></span>

## <a name="language-restrictions"></a><span data-ttu-id="b1f19-131">Restricciones de lenguaje</span><span class="sxs-lookup"><span data-stu-id="b1f19-131">Language Restrictions</span></span>

<span data-ttu-id="b1f19-132">Los componentes desarrollados con Microsoft Visual Basic 6,0 y versiones anteriores no se pueden agrupar porque estos componentes serán subprocesos de modelo apartamento.</span><span class="sxs-lookup"><span data-stu-id="b1f19-132">Components developed using Microsoft Visual Basic 6.0 and earlier cannot be pooled because these components will be apartment-model threaded.</span></span> <span data-ttu-id="b1f19-133">Sin embargo, en Visual Basic .NET, los componentes se pueden agrupar.</span><span class="sxs-lookup"><span data-stu-id="b1f19-133">However, in Visual Basic .NET, components can be pooled.</span></span>

## <a name="legacy-components"></a><span data-ttu-id="b1f19-134">Componentes heredados</span><span class="sxs-lookup"><span data-stu-id="b1f19-134">Legacy Components</span></span>

<span data-ttu-id="b1f19-135">Siempre que sean no transaccionales y cumplan los requisitos anteriores, los componentes se pueden agrupar incluso si no se escribieron específicamente con la capacidad de agrupación en mente.</span><span class="sxs-lookup"><span data-stu-id="b1f19-135">As long as they are non-transactional and conform to the appropriate preceding requirements, components can be pooled even if they were not specifically written with pooling capability in mind.</span></span> <span data-ttu-id="b1f19-136">No es necesario implementar [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol); un componente que no lo hace simplemente no participará en la administración de su duración.</span><span class="sxs-lookup"><span data-stu-id="b1f19-136">It is not necessary to implement [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol); a component that does not do so simply won't participate in managing its lifetime.</span></span> <span data-ttu-id="b1f19-137">Si [**IObjectControl:: CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled) no está implementado, el objeto se seguirá reutilizando hasta que el grupo alcance el tamaño máximo.</span><span class="sxs-lookup"><span data-stu-id="b1f19-137">If [**IObjectControl::CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled) is not implemented, the object will continue to be reused until the pool attains maximum size.</span></span>

## <a name="related-topics"></a><span data-ttu-id="b1f19-138">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="b1f19-138">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b1f19-139">Cadenas del constructor de objetos COM+</span><span class="sxs-lookup"><span data-stu-id="b1f19-139">COM+ Object Constructor Strings</span></span>](com--object-constructor-strings.md)
</dt> <dt>

[<span data-ttu-id="b1f19-140">Controlar la duración y el estado de los objetos</span><span class="sxs-lookup"><span data-stu-id="b1f19-140">Controlling Object Lifetime and State</span></span>](controlling-object-lifetime-and-state.md)
</dt> <dt>

[<span data-ttu-id="b1f19-141">Cómo funciona la agrupación de objetos</span><span class="sxs-lookup"><span data-stu-id="b1f19-141">How Object Pooling Works</span></span>](how-object-pooling-works.md)
</dt> <dt>

[<span data-ttu-id="b1f19-142">Mejorar el rendimiento con la agrupación de objetos</span><span class="sxs-lookup"><span data-stu-id="b1f19-142">Improving Performance with Object Pooling</span></span>](improving-performance-with-object-pooling.md)
</dt> <dt>

[<span data-ttu-id="b1f19-143">Agrupar objetos transaccionales</span><span class="sxs-lookup"><span data-stu-id="b1f19-143">Pooling Transactional Objects</span></span>](pooling-transactional-objects.md)
</dt> </dl>

 

 
