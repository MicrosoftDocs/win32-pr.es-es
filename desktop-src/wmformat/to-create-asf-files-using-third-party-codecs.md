---
title: Para crear archivos ASF con códecs de terceros
description: Para crear archivos ASF con códecs de terceros
ms.assetid: 5cd348ca-1f86-429d-92ee-4eab4ced8571
keywords:
- SDK de Windows Media Format, crear archivos ASF
- Windows Media Format SDK, códecs de terceros
- Advanced Systems Format (ASF), crear archivos
- ASF (formato de sistemas avanzados), crear archivos
- Formatos de sistema avanzado (ASF), códecs de terceros
- ASF (formato de sistemas avanzados), códecs de terceros
- códecs de terceros
- códecs, terceros
- códecs, crear archivos ASF
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9d6c057f1785ed50e328ac6094ff7dbe078e98fc
ms.sourcegitcommit: ad672d3a10192c5ccac619ad2524407109266e93
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/25/2020
ms.locfileid: "104358763"
---
# <a name="to-create-asf-files-using-third-party-codecs"></a><span data-ttu-id="c8a2a-112">Para crear archivos ASF con códecs de terceros</span><span class="sxs-lookup"><span data-stu-id="c8a2a-112">To Create ASF Files Using Third-Party Codecs</span></span>

<span data-ttu-id="c8a2a-113">Puede usar el SDK de Windows Media Format para crear archivos ASF que contengan medios digitales codificados con cualquier códec que elija.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-113">You can use the Windows Media Format SDK to create ASF files that contain digital media encoded with any codec you choose.</span></span> <span data-ttu-id="c8a2a-114">Al usar un códec distinto de uno incluido en este SDK, debe realizar los pasos siguientes.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-114">When using a codec other than one included with this SDK, you must perform the following steps.</span></span>

1.  <span data-ttu-id="c8a2a-115">Codifique el contenido con el códec deseado.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-115">Encode the content with the desired codec.</span></span>
2.  <span data-ttu-id="c8a2a-116">Busque o cree un valor GUID para identificar el contenido codificado con el códec usado en el paso 1.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-116">Find or create a GUID value to identify content encoded with the codec used in step 1.</span></span>
3.  <span data-ttu-id="c8a2a-117">Cree un perfil nuevo o modifique uno existente para usarlo con el contenido codificado.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-117">Create a new profile, or modify an existing profile for use with the encoded content.</span></span>
    -   <span data-ttu-id="c8a2a-118">Cree una secuencia para el contenido codificado con el tipo principal adecuado.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-118">Create a stream for the encoded content with the appropriate major type.</span></span> <span data-ttu-id="c8a2a-119">Para obtener más información acerca de los principales tipos de medios, consulte [tipos de medios](media-types.md).</span><span class="sxs-lookup"><span data-stu-id="c8a2a-119">For more information about major media types, see [Media Types](media-types.md).</span></span> <span data-ttu-id="c8a2a-120">Use el GUID identificado en el paso 2 como el subtipo de medio.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-120">Use the GUID identified in step 2 as the media subtype.</span></span>
    -   <span data-ttu-id="c8a2a-121">Establezca la velocidad de bits y la ventana de búfer para la secuencia en valores que no producirán un desbordamiento del búfer.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-121">Set the bit rate and buffer window for the stream to values that will not result in buffer overflow.</span></span> <span data-ttu-id="c8a2a-122">Debe poder obtener estos valores del códec en el momento de la codificación.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-122">You should be able to obtain these values from the codec at the time of encoding.</span></span> <span data-ttu-id="c8a2a-123">Los componentes en tiempo de ejecución del SDK comprueban los valores de la ventana de velocidad de bits y de búfer y quitan ejemplos si es necesario para que los datos especificados quepan en estos valores.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-123">The SDK runtime components check the bitrate/buffer window values and drop samples if necessary to make the given data fit in with these values.</span></span> <span data-ttu-id="c8a2a-124">Si establece los valores incorrectamente, el archivo no se transmitirá correctamente, lo que provocará una reproducción deficiente.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-124">If you set the values incorrectly, the file will not stream properly, resulting in poor playback.</span></span>
    -   <span data-ttu-id="c8a2a-125">En el caso de las secuencias de vídeo, debe establecer el miembro **bicompression** de la estructura **BITMAPINFOHEADER** contenida en la estructura [**WMVIDEOINFOHEADER**](/previous-versions/windows/desktop/api/wmsdkidl/ns-wmsdkidl-wmvideoinfoheader) en el valor FourCC correspondiente para el contenido.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-125">For video streams, you must set the **biCompression** member of the **BITMAPINFOHEADER** structure contained in the [**WMVIDEOINFOHEADER**](/previous-versions/windows/desktop/api/wmsdkidl/ns-wmsdkidl-wmvideoinfoheader) structure to the appropriate FOURCC value for the content.</span></span> <span data-ttu-id="c8a2a-126">Este valor debe ser igual a los primeros cuatro bytes del GUID del subtipo.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-126">This value must be equal to the first four bytes of the subtype GUID.</span></span> <span data-ttu-id="c8a2a-127">Por ejemplo, si la **bicompresión** es MAKEFOURCC (' t ', ' E ', ', ' t ') = 0x54455354, el GUID del subtipo comenzará de la siguiente manera: 54455354-XXXX-XXXX-XXXX-XXXXXXXXXXXX.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-127">For example, if **biCompression** is MAKEFOURCC('T','E','S','T')=0x54455354, then the subtype GUID will begin like this: 54455354-XXXX-XXXX-XXXX-XXXXXXXXXXXX.</span></span>
4.  <span data-ttu-id="c8a2a-128">Cree un objeto de escritor y cargue el perfil creado en el paso anterior.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-128">Create a writer object and load the profile created in the previous step.</span></span> <span data-ttu-id="c8a2a-129">Para obtener más información acerca de la escritura de archivos, consulte [Writing ASF files](writing-asf-files.md).</span><span class="sxs-lookup"><span data-stu-id="c8a2a-129">For more information about writing files, see [Writing ASF Files](writing-asf-files.md).</span></span>
5.  <span data-ttu-id="c8a2a-130">Recorra las entradas del archivo y asigne las propiedades de entrada para cada una de ellas como lo haría normalmente.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-130">Loop through the inputs of the file and assign input properties for each as you normally would.</span></span> <span data-ttu-id="c8a2a-131">Para obtener más información sobre las entradas, consulte [trabajar con entradas](working-with-inputs.md).</span><span class="sxs-lookup"><span data-stu-id="c8a2a-131">For more information about inputs, see [Working with Inputs](working-with-inputs.md).</span></span> <span data-ttu-id="c8a2a-132">En el flujo codificado con un códec de otro fabricante, establezca el puntero de la interfaz [**IWMInputMediaProps**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwminputmediaprops) en **null** antes de llamar a [**IWMWriter:: BeginWriting**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriter-beginwriting).</span><span class="sxs-lookup"><span data-stu-id="c8a2a-132">For the stream encoded with a third-party codec, set the [**IWMInputMediaProps**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwminputmediaprops) interface pointer to **NULL** before calling [**IWMWriter::BeginWriting**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriter-beginwriting).</span></span>
6.  <span data-ttu-id="c8a2a-133">Use el nuevo perfil creado en el paso anterior para escribir el archivo.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-133">Use the new profile created in the previous step to write the file.</span></span> <span data-ttu-id="c8a2a-134">Pase los ejemplos comprimidos mediante [**IWMWriterAdvanced:: WriteStreamSample**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriteradvanced-writestreamsample) en lugar de [**IWMWriter:: WriteSample**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriter-writesample).</span><span class="sxs-lookup"><span data-stu-id="c8a2a-134">Pass the compressed samples using [**IWMWriterAdvanced::WriteStreamSample**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriteradvanced-writestreamsample) instead of [**IWMWriter::WriteSample**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriter-writesample).</span></span> <span data-ttu-id="c8a2a-135">Para vídeo, debe especificar qué ejemplos son fotogramas clave pasando WM \_ SF \_ CLEANPOINT como parámetro *dwFlags* .</span><span class="sxs-lookup"><span data-stu-id="c8a2a-135">For video, you must specify which samples are key frames by passing WM\_SF\_CLEANPOINT as the *dwFlags* parameter.</span></span>

<span data-ttu-id="c8a2a-136">Para procesar y descomprimir el flujo codificado con un códec de otro fabricante, debe leer ejemplos de secuencias comprimidas.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-136">To process and decompress the stream encoded with a third-party codec, you must read compressed stream samples.</span></span> <span data-ttu-id="c8a2a-137">La aplicación de lectura debe controlar también la descompresión de ejemplo para la secuencia.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-137">Your reading application must handle sample decompression for the stream as well.</span></span>

## <a name="putting-mpeg-2-streams-into-asf"></a><span data-ttu-id="c8a2a-138">Colocar secuencias MPEG-2 en ASF</span><span class="sxs-lookup"><span data-stu-id="c8a2a-138">Putting MPEG-2 streams into ASF</span></span>

> [!Note]  
> <span data-ttu-id="c8a2a-139">Este tema se aplica a las aplicaciones que usan el SDK de Windows Media Format para colocar MPEG-2 (u otros formatos de compresión que usan fotogramas B) en el contenedor de archivos ASF.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-139">This topic applies to applications that use the Windows Media Format SDK to put MPEG-2 (or other compression formats that use B frames) into the ASF file container.</span></span>

 

<span data-ttu-id="c8a2a-140">El objeto de escritor requiere que todos los ejemplos de entrada tengan marcas de tiempo y se supone que cada ejemplo de entrada tiene un tiempo de presentación posterior al que lo precedía.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-140">The writer object requires that all input samples have time stamps, and it assumes that each input sample has a presentation time later than the one that preceded it.</span></span> <span data-ttu-id="c8a2a-141">Aunque prácticamente todo el vídeo sin comprimir e incluso algunos flujos de vídeo comprimidos cumplen estas condiciones, las secuencias MPEG-2 no lo hacen.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-141">While virtually all uncompressed video and even some compressed video streams meet these conditions, MPEG-2 streams do not.</span></span> <span data-ttu-id="c8a2a-142">En MPEG-2, no todos los ejemplos tienen marca de tiempo y, cuando hay fotogramas B, el orden de descodificación de ejemplo no es el mismo que el orden de representación.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-142">In MPEG-2, not all samples are time stamped, and when B frames are present, the sample decoding order is not the same as the rendering order.</span></span> <span data-ttu-id="c8a2a-143">Cuando el objeto de escritor encuentra ejemplos desordenados, los reorganiza en el orden "correcto".</span><span class="sxs-lookup"><span data-stu-id="c8a2a-143">When the writer object encounters out-of-order samples, it rearranges them into the "correct" order.</span></span> <span data-ttu-id="c8a2a-144">Por lo tanto, para almacenar secuencias MPEG-2 de forma nativa (no descodificada) en un contenedor ASF, debe realizar los siguientes pasos:</span><span class="sxs-lookup"><span data-stu-id="c8a2a-144">Therefore, to store MPEG-2 streams natively (not decoded) in an ASF container, you must perform the following steps:</span></span>

<span data-ttu-id="c8a2a-145">Al escribir el archivo:</span><span class="sxs-lookup"><span data-stu-id="c8a2a-145">When writing the file:</span></span>

1.  <span data-ttu-id="c8a2a-146">Agregue una extensión de unidad de datos (debida) de tamaño fijo a cada ejemplo de entrada que contenga una estructura que contenga los valores reales de tiempo de inicio y de finalización de la marca de tiempo MPEG para el ejemplo.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-146">Add a fixed-size data unit extension (DUE) to each input sample that will hold a structure that contains the actual MPEG time-stamp start-time and stop-time values for the sample.</span></span> <span data-ttu-id="c8a2a-147">Use-1 para estos valores si el ejemplo no tiene ninguna marca de tiempo.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-147">Use -1 for these values if the sample has no time stamp.</span></span>
2.  <span data-ttu-id="c8a2a-148">Proporcione a las marcas de tiempo de entrada "ficticios" del objeto de escritor que siempre aumentan para que escriba los ejemplos en el archivo exactamente en el mismo orden en que se reciben.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-148">Give the writer object "dummy" input time stamps that are always increasing so that it will write the samples to the file in exactly the same order as they are received.</span></span> <span data-ttu-id="c8a2a-149">Las marcas de tiempo ficticias deben corresponderse aproximadamente con las horas de presentación reales, como promedio en el tiempo.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-149">The dummy time stamps should correspond approximately to the actual presentation times, as averaged over time.</span></span> <span data-ttu-id="c8a2a-150">Las marcas de tiempo ficticias formarán la escala de tiempo de búsqueda, por lo que si difieren en relación con las marcas de tiempo real, las operaciones de búsqueda en el archivo producirán resultados inesperados.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-150">The dummy time stamps will form the seeking timeline, so if they diverge relative to the real time stamps, seek operations on the file will produce unexpected results.</span></span> <span data-ttu-id="c8a2a-151">Sin embargo, una cantidad limitada de vibración entre las horas de ejemplo no afectará gravemente a las operaciones de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-151">However, a limited amount of jitter between the sample times will not seriously affect seek operations.</span></span>

<span data-ttu-id="c8a2a-152">Al leer el archivo:</span><span class="sxs-lookup"><span data-stu-id="c8a2a-152">When reading the file:</span></span>

-   <span data-ttu-id="c8a2a-153">Para cada uno de los ejemplos leídos del archivo, examine el vencimiento.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-153">For each sample read from the file, examine the DUE.</span></span> <span data-ttu-id="c8a2a-154">Si contiene una hora de inicio que es mayor o igual que cero, copie el valor en la marca de tiempo para el ejemplo de salida antes de que se entregue al descodificador.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-154">If it contains a start time that is greater than or equal to zero, copy that value to the time stamp for the output sample before it is delivered to the decoder.</span></span> <span data-ttu-id="c8a2a-155">Establezca el resto de marcas de tiempo de los ejemplos de salida en **null**.</span><span class="sxs-lookup"><span data-stu-id="c8a2a-155">Set all other time stamps on the output samples to **NULL**.</span></span> <span data-ttu-id="c8a2a-156">En DirectShow, esto se realiza mediante una llamada a **IMediaSample:: setTime**(**null**,**null**).</span><span class="sxs-lookup"><span data-stu-id="c8a2a-156">In DirectShow, this is done by calling **IMediaSample::SetTime**(**NULL**,**NULL**).</span></span>

## <a name="related-topics"></a><span data-ttu-id="c8a2a-157">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="c8a2a-157">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c8a2a-158">**Almacenar contenido en búfer**</span><span class="sxs-lookup"><span data-stu-id="c8a2a-158">**Buffering Content**</span></span>](buffering-content.md)
</dt> <dt>

[<span data-ttu-id="c8a2a-159">**Interfaz IWMWriter**</span><span class="sxs-lookup"><span data-stu-id="c8a2a-159">**IWMWriter Interface**</span></span>](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmwriter)
</dt> <dt>

[<span data-ttu-id="c8a2a-160">**Interfaz IWMWriterAdvanced**</span><span class="sxs-lookup"><span data-stu-id="c8a2a-160">**IWMWriterAdvanced Interface**</span></span>](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmwriteradvanced)
</dt> <dt>

[<span data-ttu-id="c8a2a-161">**Para proporcionar ejemplos comprimidos con el lector asincrónico**</span><span class="sxs-lookup"><span data-stu-id="c8a2a-161">**To Deliver Compressed Samples with the Asynchronous Reader**</span></span>](to-deliver-compressed-samples-with-the-asynchronous-reader.md)
</dt> <dt>

[<span data-ttu-id="c8a2a-162">**Para recuperar ejemplos de secuencias con el lector sincrónico**</span><span class="sxs-lookup"><span data-stu-id="c8a2a-162">**To Retrieve Stream Samples with the Synchronous Reader**</span></span>](to-retrieve-stream-samples-with-the-synchronous-reader.md)
</dt> <dt>

[<span data-ttu-id="c8a2a-163">**WMVIDEOINFOHEADER**</span><span class="sxs-lookup"><span data-stu-id="c8a2a-163">**WMVIDEOINFOHEADER**</span></span>](/previous-versions/windows/desktop/api/wmsdkidl/ns-wmsdkidl-wmvideoinfoheader)
</dt> <dt>

[<span data-ttu-id="c8a2a-164">**Trabajar con perfiles**</span><span class="sxs-lookup"><span data-stu-id="c8a2a-164">**Working with Profiles**</span></span>](working-with-profiles.md)
</dt> <dt>

[<span data-ttu-id="c8a2a-165">**Escribir archivos ASF**</span><span class="sxs-lookup"><span data-stu-id="c8a2a-165">**Writing ASF Files**</span></span>](writing-asf-files.md)
</dt> </dl>

 

 




