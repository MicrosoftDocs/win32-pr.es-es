---
description: Schannel tiene un conjunto bien definido de comportamientos para la información incompleta o excesiva incluida en los búferes de entrada de estas funciones.
ms.assetid: 5fad1e76-6520-4ff7-b2b0-2cc2061062a1
title: Búferes adicionales devueltos por Schannel
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5b0c9ce7a468b1b04389ad19f91785b64fb50e74
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "105652989"
---
# <a name="extra-buffers-returned-by-schannel"></a><span data-ttu-id="34586-103">Búferes adicionales devueltos por Schannel</span><span class="sxs-lookup"><span data-stu-id="34586-103">Extra Buffers Returned by Schannel</span></span>

<span data-ttu-id="34586-104">La información se debe enviar entre el cliente y el servidor mientras se establece un [*contexto de seguridad*](/windows/desktop/SecGloss/s-gly) y después porque los mensajes seguros se intercambian mediante las características de cifrado y descifrado proporcionadas por Schannel.</span><span class="sxs-lookup"><span data-stu-id="34586-104">Information must be sent between the client and server while a [*security context*](/windows/desktop/SecGloss/s-gly) is being established and afterward because secure messages are exchanged by using the encryption and decryption features provided by Schannel.</span></span> <span data-ttu-id="34586-105">Las siguientes funciones se usan para realizar estas tareas:</span><span class="sxs-lookup"><span data-stu-id="34586-105">The following functions are used to accomplish these tasks:</span></span>

-   [<span data-ttu-id="34586-106">**AcceptSecurityContext (general)**</span><span class="sxs-lookup"><span data-stu-id="34586-106">**AcceptSecurityContext (General)**</span></span>](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext)
-   [<span data-ttu-id="34586-107">**InitializeSecurityContext (general)**</span><span class="sxs-lookup"><span data-stu-id="34586-107">**InitializeSecurityContext (General)**</span></span>](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta)
-   [<span data-ttu-id="34586-108">**DecryptMessage (general)**</span><span class="sxs-lookup"><span data-stu-id="34586-108">**DecryptMessage (General)**</span></span>](/windows/win32/api/sspi/nf-sspi-decryptmessage)

<span data-ttu-id="34586-109">Schannel tiene un conjunto bien definido de comportamientos para la información incompleta o excesiva incluida en los búferes de entrada de estas funciones.</span><span class="sxs-lookup"><span data-stu-id="34586-109">Schannel has a well-defined set of behaviors for incomplete or excess information included in the input buffers to these functions.</span></span> <span data-ttu-id="34586-110">La información se intercambia entre el cliente y el servidor de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="34586-110">Information is exchanged between the client and server in the following manner:</span></span>

1.  <span data-ttu-id="34586-111">La entidad local interactúa con Schannel llamando a una función SSPI y pasando información.</span><span class="sxs-lookup"><span data-stu-id="34586-111">The local party interacts with Schannel by calling an SSPI function and passing in information.</span></span> <span data-ttu-id="34586-112">Normalmente, la información se recibió de la parte remota.</span><span class="sxs-lookup"><span data-stu-id="34586-112">Typically, the information was received from the remote party.</span></span>
2.  <span data-ttu-id="34586-113">La función devuelve un código de estado y los búferes de salida que contienen información.</span><span class="sxs-lookup"><span data-stu-id="34586-113">The function returns a status code and output buffers containing information.</span></span>
3.  <span data-ttu-id="34586-114">Según el código de estado, los búferes de salida se envían a la parte remota mediante algún mecanismo de comunicación.</span><span class="sxs-lookup"><span data-stu-id="34586-114">Depending on the status code, the output buffers are sent to the remote party by means of some communication mechanism.</span></span>
4.  <span data-ttu-id="34586-115">La parte remota lee la información enviada por la entidad local.</span><span class="sxs-lookup"><span data-stu-id="34586-115">The remote party reads information sent by the local party.</span></span>
5.  <span data-ttu-id="34586-116">El bucle se repite, con las partes locales y remotas intercambiadas.</span><span class="sxs-lookup"><span data-stu-id="34586-116">The loop repeats, with the local and remote parties interchanged.</span></span> <span data-ttu-id="34586-117">(La entidad remota llama a una función SSPI y pasa la información leída en el paso anterior).</span><span class="sxs-lookup"><span data-stu-id="34586-117">(The remote party calls an SSPI function and passes in the information read in the previous step.)</span></span>

<span data-ttu-id="34586-118">Todo funciona según lo esperado cuando el búfer de entrada de la función SSPI contiene exactamente la información necesaria.</span><span class="sxs-lookup"><span data-stu-id="34586-118">Everything works as expected when the input buffer to the SSPI function contains exactly the information needed.</span></span> <span data-ttu-id="34586-119">Sin embargo, debido a la naturaleza orientada a flujos de algunos protocolos de comunicaciones, este podría no ser el caso; un bloque de información recibido de una parte remota puede contener menos datos de los necesarios o más datos de los que puede procesar Schannel en una única llamada de función.</span><span class="sxs-lookup"><span data-stu-id="34586-119">However, due to the stream-oriented nature of some communications protocols this may not be the case; a block of information received from a remote party may contain less data than is required or more data than can be processed by Schannel in a single function call.</span></span>

<span data-ttu-id="34586-120">Si el búfer de entrada contiene demasiado poca información, las funciones devuelven un \_ \_ mensaje incompleto de sec \_ .</span><span class="sxs-lookup"><span data-stu-id="34586-120">If the input buffer contains too little information, the functions return SEC\_E\_INCOMPLETE\_MESSAGE.</span></span> <span data-ttu-id="34586-121">El autor de la llamada debe obtener datos adicionales de la parte remota y volver a llamar a la función.</span><span class="sxs-lookup"><span data-stu-id="34586-121">The caller must obtain additional data from the remote party and call the function again.</span></span>

<span data-ttu-id="34586-122">Cuando los búferes de entrada contienen demasiada información, Schannel no lo trata como un error.</span><span class="sxs-lookup"><span data-stu-id="34586-122">When the input buffers contains too much information, Schannel does not treat this as an error.</span></span> <span data-ttu-id="34586-123">La función procesa tanto como sea posible la entrada y devuelve el código de estado para esa actividad de procesamiento.</span><span class="sxs-lookup"><span data-stu-id="34586-123">The function processes as much of the input as it can, and returns the status code for that processing activity.</span></span> <span data-ttu-id="34586-124">Además, Schannel indica la presencia de información sin procesar en los búferes de entrada devolviendo un búfer de salida de tipo SECBUFFER \_ extra.</span><span class="sxs-lookup"><span data-stu-id="34586-124">In addition, Schannel indicates the presence of unprocessed information in the input buffers by returning an output buffer of type SECBUFFER\_EXTRA.</span></span> <span data-ttu-id="34586-125">Probar los búferes de salida para este tipo de búfer es la única manera de detectar esta situación.</span><span class="sxs-lookup"><span data-stu-id="34586-125">Testing the output buffers for this type of buffer is the only way to detect this situation.</span></span> <span data-ttu-id="34586-126">El campo **cbBuffer** de la estructura de búfer adicional indica el número de bytes de entrada que no se procesaron.</span><span class="sxs-lookup"><span data-stu-id="34586-126">The **cbBuffer** field of the extra buffer structure indicates how many bytes of input were not processed.</span></span>

> [!Note]  
> <span data-ttu-id="34586-127">El campo **pvBuffer** del búfer adicional no contiene una copia de los datos sobrantes.</span><span class="sxs-lookup"><span data-stu-id="34586-127">The **pvBuffer** field of the extra buffer does not contain a copy of the excess data.</span></span>

 

<span data-ttu-id="34586-128">Si recibe un búfer adicional de una función SSPI, debe quitar la información ya procesada del búfer de entrada y llamar de nuevo a la función.</span><span class="sxs-lookup"><span data-stu-id="34586-128">If you receive an extra buffer from a SSPI function, you must remove the already processed information from the input buffer and call the function again.</span></span> <span data-ttu-id="34586-129">Schannel puede, y a menudo, devuelve solo el búfer adicional y nada más en los búferes de salida.</span><span class="sxs-lookup"><span data-stu-id="34586-129">Schannel can, and often does, return only the extra buffer and nothing else in the output buffers.</span></span>

 

 
