---
description: 'Las aplicaciones pueden registrarse para recibir notificaciones de eventos de dispositivo de hardware de adquisición de imágenes de Windows (WIA) mediante una llamada a uno de los siguientes métodos de interfaz IWiaDevMgr o IWiaDevMgr2: IWiaDevMgr:: RegisterEventCallbackCLSID o IWiaDevMgr2:: RegisterEventCallbackCLSIDIWiaDevMgr:: RegisterEventCallbackInterface o IWiaDevMgr2:: RegisterEventCallbackInterfaceIWiaDevMgr:: RegisterEventCallbackProgram o IWiaDevMgr2:: RegisterEventCallbackProgram'
ms.assetid: 0c142083-835f-4bbd-ab32-eb6130f99c59
title: Registrar eventos WIA
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aa9fc36540a64211428579bc13b84902490ea103
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104001178"
---
# <a name="registering-wia-events"></a><span data-ttu-id="b41ef-103">Registrar eventos WIA</span><span class="sxs-lookup"><span data-stu-id="b41ef-103">Registering WIA Events</span></span>

<span data-ttu-id="b41ef-104">Las aplicaciones pueden registrarse para recibir notificaciones de eventos de dispositivo de hardware de adquisición de imágenes de Windows (WIA) mediante una llamada a uno de los siguientes métodos de interfaz [**IWiaDevMgr**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr) o [**IWiaDevMgr2**](-wia-iwiadevmgr2.md) :</span><span class="sxs-lookup"><span data-stu-id="b41ef-104">Applications can register to be notified of Windows Image Acquisition (WIA) hardware device events by calling one of the following [**IWiaDevMgr**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr) or [**IWiaDevMgr2**](-wia-iwiadevmgr2.md) interface methods:</span></span>

-   <span data-ttu-id="b41ef-105">[**IWiaDevMgr:: RegisterEventCallbackCLSID**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackclsid) o [ **IWiaDevMgr2:: RegisterEventCallbackCLSID**](-wia-iwiadevmgr2-registereventcallbackclsid.md)</span><span class="sxs-lookup"><span data-stu-id="b41ef-105">[**IWiaDevMgr::RegisterEventCallbackCLSID**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackclsid) or [**IWiaDevMgr2::RegisterEventCallbackCLSID**](-wia-iwiadevmgr2-registereventcallbackclsid.md)</span></span>
-   <span data-ttu-id="b41ef-106">[**IWiaDevMgr:: RegisterEventCallbackInterface**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackinterface) o [ **IWiaDevMgr2:: RegisterEventCallbackInterface**](-wia-iwiadevmgr2-registereventcallbackinterface.md)</span><span class="sxs-lookup"><span data-stu-id="b41ef-106">[**IWiaDevMgr::RegisterEventCallbackInterface**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackinterface) or [**IWiaDevMgr2::RegisterEventCallbackInterface**](-wia-iwiadevmgr2-registereventcallbackinterface.md)</span></span>
-   <span data-ttu-id="b41ef-107">[**IWiaDevMgr:: RegisterEventCallbackProgram**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackprogram) o [ **IWiaDevMgr2:: RegisterEventCallbackProgram**](-wia-iwiadevmgr2-registereventcallbackprogram.md)</span><span class="sxs-lookup"><span data-stu-id="b41ef-107">[**IWiaDevMgr::RegisterEventCallbackProgram**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackprogram) or [**IWiaDevMgr2::RegisterEventCallbackProgram**](-wia-iwiadevmgr2-registereventcallbackprogram.md)</span></span>

<span data-ttu-id="b41ef-108">Todos estos métodos toman parámetros que especifican el evento y el dispositivo de hardware para el que se va a notificar a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b41ef-108">All of these methods take parameters that specify the event and the hardware device for which the application is to be notified.</span></span> <span data-ttu-id="b41ef-109">Las aplicaciones se registran para recibir un evento para todos los dispositivos WIA pasando un valor **null** para el parámetro que especifica el dispositivo de hardware.</span><span class="sxs-lookup"><span data-stu-id="b41ef-109">Applications register to receive an event for all WIA devices by passing a **NULL** value for the parameter that specifies the hardware device.</span></span>

<span data-ttu-id="b41ef-110">El método **RegisterEventCallbackInterface** registra una aplicación para recibir un evento de dispositivo de hardware WIA si la aplicación se está ejecutando en el momento en que se produce el evento.</span><span class="sxs-lookup"><span data-stu-id="b41ef-110">The **RegisterEventCallbackInterface** method registers an application to receive a WIA hardware device event if the application is running at the time the event occurs.</span></span> <span data-ttu-id="b41ef-111">Cuando se produce el evento para el que se registra la aplicación, WIA llama al método [**IWiaEventCallback:: ImageEventCallback**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaeventcallback-imageeventcallback) del objeto proporcionado por la aplicación para transmitir la información de evento.</span><span class="sxs-lookup"><span data-stu-id="b41ef-111">When the event for which the application is registered occurs, WIA calls the [**IWiaEventCallback::ImageEventCallback**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaeventcallback-imageeventcallback) method of the application-provided object to transmit the event information.</span></span>

<span data-ttu-id="b41ef-112">El método **RegisterEventCallbackCLSID** registra una aplicación que es un componente del modelo de objetos componentes (com) registrado para recibir un evento de dispositivo de hardware WIA, incluso si la aplicación no se está ejecutando.</span><span class="sxs-lookup"><span data-stu-id="b41ef-112">The **RegisterEventCallbackCLSID** method registers an application that is a registered Component Object Model (COM) component to receive a WIA hardware device event even if the application is not running.</span></span> <span data-ttu-id="b41ef-113">Además de los parámetros mencionados anteriormente, este método toma un parámetro, *pClsID*, que especifica el identificador de clase de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b41ef-113">In addition to the parameters mentioned previously, this method takes a parameter, *pClsID*, that specifies the class ID of the application.</span></span> <span data-ttu-id="b41ef-114">Cuando se produce el evento especificado, el sistema WIA usa la función [CoCreateInstance](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) y el identificador de clase especificado por *pClsID* para crear una nueva instancia de la aplicación y llama al método [**IWiaEventCallback:: ImageEventCallback**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaeventcallback-imageeventcallback) de esa aplicación para transmitir la información de evento.</span><span class="sxs-lookup"><span data-stu-id="b41ef-114">When the specified event occurs, the WIA system uses the [CoCreateInstance](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) function and the class ID specified by *pClsID* to create a new instance of the application, and calls the [**IWiaEventCallback::ImageEventCallback**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaeventcallback-imageeventcallback) method of that application to transmit the event information.</span></span>

<span data-ttu-id="b41ef-115">El método **RegisterEventCallbackProgram** registra una aplicación para recibir un evento de dispositivo de hardware WIA incluso si la aplicación no se está ejecutando cuando se produce el evento.</span><span class="sxs-lookup"><span data-stu-id="b41ef-115">The **RegisterEventCallbackProgram** method registers an application to receive a WIA hardware device event even if the application is not running when the event occurs.</span></span> <span data-ttu-id="b41ef-116">No es necesario que la aplicación sea un componente COM registrado.</span><span class="sxs-lookup"><span data-stu-id="b41ef-116">The application need not be a registered COM component.</span></span> <span data-ttu-id="b41ef-117">WIA inicia la aplicación con una instrucción de línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="b41ef-117">WIA launches the application with a command line statement.</span></span> <span data-ttu-id="b41ef-118">**RegisterEventCallbackProgram** toma un parámetro, *bstrCommandline*, que especifica la ruta de acceso completa y el nombre de archivo de la aplicación ejecutable.</span><span class="sxs-lookup"><span data-stu-id="b41ef-118">**RegisterEventCallbackProgram** takes a parameter, *bstrCommandline*, that specifies the full path and filename of the executable application.</span></span> <span data-ttu-id="b41ef-119">**RegisterEventCallbackProgram** existe por compatibilidad con versiones anteriores de aplicaciones que no se ESCRIBIERON para WIA y debe evitarse.</span><span class="sxs-lookup"><span data-stu-id="b41ef-119">**RegisterEventCallbackProgram** exists for backward compatibility with applications that were not written for WIA, and should be avoided.</span></span> <span data-ttu-id="b41ef-120">Use **RegisterEventCallbackInterface** o **RegisterEventCallbackCLSID** en su lugar.</span><span class="sxs-lookup"><span data-stu-id="b41ef-120">Use **RegisterEventCallbackInterface** or **RegisterEventCallbackCLSID** instead.</span></span>

<span data-ttu-id="b41ef-121">Para determinar qué controladores se registran para los eventos en un dispositivo WIA específico, una aplicación llama a un método [**IWiaItem:: EnumRegisterEventInfo**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaitem-enumregistereventinfo) o [**IWiaItem2:: EnumRegisterEventInfo**](-wia-iwiaitem2-enumregistereventinfo.md) de un elemento raíz.</span><span class="sxs-lookup"><span data-stu-id="b41ef-121">To determine which handlers are registered for events on a specific WIA device, an application calls a [**IWiaItem::EnumRegisterEventInfo**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaitem-enumregistereventinfo) or [**IWiaItem2::EnumRegisterEventInfo**](-wia-iwiaitem2-enumregistereventinfo.md) method of a root item.</span></span> <span data-ttu-id="b41ef-122">Este método crea un objeto de enumeración para la información de registro.</span><span class="sxs-lookup"><span data-stu-id="b41ef-122">This method creates an enumeration object for the registration information.</span></span> <span data-ttu-id="b41ef-123">A continuación, la aplicación puede usar la interfaz [**IEnumWIA \_ dev \_ caps**](/windows/desktop/api/wia_xp/nn-wia_xp-ienumwia_dev_caps) de ese objeto para enumerar información acerca de los controladores registrados para recibir eventos para ese dispositivo.</span><span class="sxs-lookup"><span data-stu-id="b41ef-123">The application can then use the [**IEnumWIA\_DEV\_CAPS**](/windows/desktop/api/wia_xp/nn-wia_xp-ienumwia_dev_caps) interface of that object to enumerate information about the handlers registered to receive events for that device.</span></span>

<span data-ttu-id="b41ef-124">Si se produce un evento para el que se registra una aplicación en ejecución a través de **RegisterEventCallbackInterface** y de **RegisterEventCallbackCLSID** o **RegisterEventCallbackProgram**, WIA notifica a la aplicación en ejecución y no intenta iniciar una nueva instancia de la aplicación, ya que el registro de eventos a través de **RegisterEventCallbackInterface** tiene prioridad sobre **RegisterEventCallbackCLSID** y **RegisterEventCallbackProgram**.</span><span class="sxs-lookup"><span data-stu-id="b41ef-124">If an event occurs for which a running application is registered through **RegisterEventCallbackInterface** and either **RegisterEventCallbackCLSID** or **RegisterEventCallbackProgram**, WIA notifies the running application and does not attempt to launch a new instance of the application because event registration through **RegisterEventCallbackInterface** takes precedence over both **RegisterEventCallbackCLSID** and **RegisterEventCallbackProgram**.</span></span>

> [!Note]  
> <span data-ttu-id="b41ef-125">En una aplicación multiproceso, no hay ninguna garantía de que el subproceso devuelto por la devolución de llamada de notificación de eventos sea el mismo subproceso que registró la devolución de llamada.</span><span class="sxs-lookup"><span data-stu-id="b41ef-125">In a multi-threaded application, there is no guarantee that the thread that the event notification callback will return on is the same thread that registered the callback.</span></span>

 

 

 
