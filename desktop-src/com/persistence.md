---
title: Persistencia
description: Persistencia
ms.assetid: 4916ea52-a21c-4938-81cb-392b5ca1f6c1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7ba5fc0c8e389c7babdf80b76719b39fc02d5604
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/21/2020
ms.locfileid: "104078466"
---
# <a name="persistence"></a><span data-ttu-id="eebfa-103">Persistencia</span><span class="sxs-lookup"><span data-stu-id="eebfa-103">Persistence</span></span>

<span data-ttu-id="eebfa-104">Un control implementa una o varias interfaces de persistencia para admitir la persistencia de su estado.</span><span class="sxs-lookup"><span data-stu-id="eebfa-104">A control implements one or more of several persistence interfaces to support persistence of its state.</span></span> <span data-ttu-id="eebfa-105">Por ejemplo, la interfaz [**IPersistStreamInit**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit) admite la persistencia basada en secuencias del estado del control.</span><span class="sxs-lookup"><span data-stu-id="eebfa-105">For example, the [**IPersistStreamInit**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit) interface supports stream-based persistence of the control's state.</span></span> <span data-ttu-id="eebfa-106">**IPersistStreamInit** es un reemplazo de [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) y agrega un método de inicialización, [**InitNew**](/windows/desktop/api/OCIdl/nf-ocidl-ipersiststreaminit-initnew).</span><span class="sxs-lookup"><span data-stu-id="eebfa-106">**IPersistStreamInit** is a replacement for [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) and adds an initialization method, [**InitNew**](/windows/desktop/api/OCIdl/nf-ocidl-ipersiststreaminit-initnew).</span></span> <span data-ttu-id="eebfa-107">Los otros métodos son los mismos en ambas interfaces.</span><span class="sxs-lookup"><span data-stu-id="eebfa-107">The other methods are the same in both interfaces.</span></span> <span data-ttu-id="eebfa-108">**IPersistStreamInit** no se deriva de **IPersistStream**; un objeto solo admite una de las dos interfaces en función de si requiere la capacidad de inicializar nuevas instancias de sí mismo.</span><span class="sxs-lookup"><span data-stu-id="eebfa-108">**IPersistStreamInit** is not derived from **IPersistStream**; an object supports only one of the two interfaces based on whether it requires the ability to initialize new instances of itself.</span></span>

<span data-ttu-id="eebfa-109">Otras interfaces de persistencia que un control puede ofrecer incluyen: [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage), [**IPersistMemory**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85)), [**IPersistPropertyBag**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768205(v=vs.85)), [**IPersistMoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="eebfa-109">Other persistence interfaces that a control can offer include: [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage), [**IPersistMemory**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85)), [**IPersistPropertyBag**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768205(v=vs.85)), [**IPersistMoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85)).</span></span> <span data-ttu-id="eebfa-110">El implementador de controles debe decidir qué tipos de persistencia son más importantes e implementar las interfaces de persistencia apropiadas.</span><span class="sxs-lookup"><span data-stu-id="eebfa-110">The control implementer must decide what kinds of persistence are most important and implement the appropriate persistence interfaces.</span></span> <span data-ttu-id="eebfa-111">El implementador de controles también decide lo que se debe guardar.</span><span class="sxs-lookup"><span data-stu-id="eebfa-111">The control implementer also decides what to save.</span></span> <span data-ttu-id="eebfa-112">Por ejemplo, un control puede guardar los valores actuales de sus propiedades o su ubicación y tamaño dentro de su contenedor.</span><span class="sxs-lookup"><span data-stu-id="eebfa-112">For example, a control can save the current values of its properties or its location and size within its container.</span></span> <span data-ttu-id="eebfa-113">El cliente decide qué interfaz prefiere usar.</span><span class="sxs-lookup"><span data-stu-id="eebfa-113">The client decides which interface it prefers to use.</span></span>

<span data-ttu-id="eebfa-114">Antes de cargar un control desde su estado persistente, un cliente puede comprobar la \_ marca OLEMISC SETCLIENTSITEFIRST para determinar si el control admite la obtención de sus propiedades de ambiente y sitio de cliente antes de cargar su estado persistente.</span><span class="sxs-lookup"><span data-stu-id="eebfa-114">Before loading a control from its persistent state, a client can check the OLEMISC\_SETCLIENTSITEFIRST flag to determine if the control supports getting its client site and ambient properties before loading its persistent state.</span></span> <span data-ttu-id="eebfa-115">Esta optimización puede ahorrar tiempo al crear una instancia de un control, ya que el control puede omitir sus valores persistentes en lugar de cargarlos solo para que se invaliden mediante las propiedades de ambiente proporcionadas por el cliente.</span><span class="sxs-lookup"><span data-stu-id="eebfa-115">This optimization can save time when instantiating a control since the control is then free to ignore its persistent values rather than loading them only to have them overridden by ambient properties supplied by the client.</span></span>

<span data-ttu-id="eebfa-116">Un control también puede permitir guardar y restaurar su estado en un conjunto de propiedades OLE, un conjunto de identificadores y valores en un formato especificado.</span><span class="sxs-lookup"><span data-stu-id="eebfa-116">A control can also support saving and restoring its state in an OLE property set, a set of identifiers and values in a specified format.</span></span> <span data-ttu-id="eebfa-117">Esta característica puede ser útil con contenedores como Visual Basic, que guarda sus programas en forma de texto.</span><span class="sxs-lookup"><span data-stu-id="eebfa-117">This feature can be useful with containers such as Visual Basic, which saves its programs in a textual form.</span></span> <span data-ttu-id="eebfa-118">Un control que desea admitir esta característica implementa [**IDataObject:: GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata) y [**IDataObject:: SetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-setdata) para pasar sus valores de propiedad hacia y desde el contenedor, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="eebfa-118">A control that wants to support this feature implements [**IDataObject::GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata) and [**IDataObject::SetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-setdata) to pass its property values to and from the container, respectively.</span></span> <span data-ttu-id="eebfa-119">Es el trabajo del contenedor convertir esta información en texto y guardarla.</span><span class="sxs-lookup"><span data-stu-id="eebfa-119">It is the container's job to convert this information to text and save it.</span></span> <span data-ttu-id="eebfa-120">Los identificadores utilizados por el control corresponden a los nombres de propiedad y los valores del control.</span><span class="sxs-lookup"><span data-stu-id="eebfa-120">The identifiers used by the control correspond to the control's property names and the values.</span></span> <span data-ttu-id="eebfa-121">Vea el OLE CDK para ver la definición de este conjunto de propiedades.</span><span class="sxs-lookup"><span data-stu-id="eebfa-121">See the OLE CDK for the definition of this property set.</span></span>

## <a name="related-topics"></a><span data-ttu-id="eebfa-122">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="eebfa-122">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="eebfa-123">Controles ActiveX</span><span class="sxs-lookup"><span data-stu-id="eebfa-123">ActiveX Controls</span></span>](activex-controls.md)
</dt> </dl>

 

 