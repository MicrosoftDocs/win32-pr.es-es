---
description: Los contextos de activación son estructuras de datos en memoria que contienen información que el sistema puede utilizar para redirigir una aplicación para cargar una versión de DLL determinada, una instancia de objeto COM o una versión de ventana personalizada.
ms.assetid: 5416f8c0-d99b-4a5d-a689-a47bd0cf1a88
title: Contextos de activación
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2f1f20d747f63ba71eee73fc17c0d5543003e5f7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104360665"
---
# <a name="activation-contexts"></a><span data-ttu-id="efd54-103">Contextos de activación</span><span class="sxs-lookup"><span data-stu-id="efd54-103">Activation Contexts</span></span>

<span data-ttu-id="efd54-104">Los [*contextos de activación*](a-sbscs-gly.md) son estructuras de datos en memoria que contienen información que el sistema puede utilizar para redirigir una aplicación para cargar una versión de dll determinada, una instancia de objeto com o una versión de ventana personalizada.</span><span class="sxs-lookup"><span data-stu-id="efd54-104">[*Activation contexts*](a-sbscs-gly.md) are data structures in memory containing information that the system can use to redirect an application to load a particular DLL version, COM object instance, or custom window version.</span></span> <span data-ttu-id="efd54-105">Una sección del contexto de activación puede contener información de redirección de DLL que usa el cargador de DLL. otra sección puede contener información del servidor COM.</span><span class="sxs-lookup"><span data-stu-id="efd54-105">One section of the activation context may contain DLL redirection information which is used by the DLL loader; another section may contain COM server information.</span></span> <span data-ttu-id="efd54-106">Las funciones de contexto de activación usan, crean, activan y desactivan contextos de activación.</span><span class="sxs-lookup"><span data-stu-id="efd54-106">The activation context functions use, create, activate, and deactivate activation contexts.</span></span> <span data-ttu-id="efd54-107">Las funciones de activación pueden redirigir el enlace de una aplicación a objetos con nombre de versión que especifican versiones de archivos DLL, clases de ventanas, servidores COM, bibliotecas de tipos e interfaces determinadas.</span><span class="sxs-lookup"><span data-stu-id="efd54-107">The activation functions can redirect the binding of an application to version-named objects that specify particular DLL versions, window classes, COM servers, type libraries, and interfaces.</span></span> <span data-ttu-id="efd54-108">Para obtener más información sobre las funciones y estructuras de contexto de activación, vea la [referencia de contexto de activación](activation-context-reference.md).</span><span class="sxs-lookup"><span data-stu-id="efd54-108">For more information about the activation context functions and structures, see the [Activation Context Reference](activation-context-reference.md).</span></span>

<span data-ttu-id="efd54-109">A partir de Windows XP, las funciones de contexto de activación permiten a Windows usar información en los [manifiestos](manifests.md) para crear objetos con nombre de versión.</span><span class="sxs-lookup"><span data-stu-id="efd54-109">Beginning with Windows XP, activation context functions enable Windows to use information in [manifests](manifests.md) to create version-named objects.</span></span> <span data-ttu-id="efd54-110">Si una aplicación crea un proceso llamando a [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa), Windows comprueba la existencia de un [manifiesto de aplicación](application-manifests.md).</span><span class="sxs-lookup"><span data-stu-id="efd54-110">If an application creates a process by calling [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa), Windows checks for the existence of an [application manifest](application-manifests.md).</span></span> <span data-ttu-id="efd54-111">Si existe un manifiesto, Windows usa la información del manifiesto para rellenar el contexto de activación.</span><span class="sxs-lookup"><span data-stu-id="efd54-111">If a manifest exists, Windows uses the information in the manifest to populate the activation context.</span></span> <span data-ttu-id="efd54-112">Dado que los manifiestos describen la dependencia de una aplicación en las versiones de [ensamblado en paralelo](about-side-by-side-assemblies-.md) , los objetos especificados sin versiones en el manifiesto se asignan a objetos con nombre de versión.</span><span class="sxs-lookup"><span data-stu-id="efd54-112">Because manifests describe an application's dependence on [side-by-side assembly](about-side-by-side-assemblies-.md) versions, objects specified without versions in the manifest are mapped to version-named objects.</span></span> <span data-ttu-id="efd54-113">Por ejemplo, el manifiesto puede describir dll, archivos, clases de ventana, servidores COM, bibliotecas de tipos e interfaces.</span><span class="sxs-lookup"><span data-stu-id="efd54-113">For example, the manifest may describe DLLs, files, window classes, COM servers, type libraries, and interfaces.</span></span>

<span data-ttu-id="efd54-114">Cuando se crea un objeto global en el contexto de activación, el sistema asigna automáticamente al objeto un nombre específico de la versión mediante la consulta del manifiesto.</span><span class="sxs-lookup"><span data-stu-id="efd54-114">When a global object is created within the activation context, the system automatically gives the object a version-specific name by consulting the manifest.</span></span> <span data-ttu-id="efd54-115">Cuando la aplicación ejecuta y solicita un objeto con nombre, obtiene el objeto con nombre de versión.</span><span class="sxs-lookup"><span data-stu-id="efd54-115">When the application executes and requests a named object, it gets the version-named object.</span></span> <span data-ttu-id="efd54-116">Esto permite que varias versiones de un módulo de código se ejecuten en el sistema al mismo tiempo sin interferir entre sí.</span><span class="sxs-lookup"><span data-stu-id="efd54-116">This enables multiple versions of a code module to run on the system at the same time without interfering with each other.</span></span> <span data-ttu-id="efd54-117">Por ejemplo, el [Shell de Windows](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)) usa un manifiesto para describir una dependencia de la versión 6,0 de comctl32 y para crear versiones de las clases de ventana.</span><span class="sxs-lookup"><span data-stu-id="efd54-117">For example, [Windows Shell](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)) uses a manifest to describe a dependence on version 6.0 of COMCTL32 and to create versions of window classes.</span></span>

<span data-ttu-id="efd54-118">Si una aplicación crea un recurso mediante una llamada a [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa), el proceso especifica un nombre de clase para esa función.</span><span class="sxs-lookup"><span data-stu-id="efd54-118">If an application creates a resource by calling [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa), the process specifies a class name to that function.</span></span> <span data-ttu-id="efd54-119">La llamada a [**GetCurrentActCtx**](/windows/desktop/api/Winbase/nf-winbase-getcurrentactctx) obtiene el contexto de activación actual y comprueba si existe una asignación para el nombre de clase especificado.</span><span class="sxs-lookup"><span data-stu-id="efd54-119">The call to [**GetCurrentActCtx**](/windows/desktop/api/Winbase/nf-winbase-getcurrentactctx) gets the current activation context and checks to see if a mapping exists for the given class name.</span></span> <span data-ttu-id="efd54-120">Si existe una asignación, usará esa versión del proceso de llamada para resolver la asignación y proporcionar el nombre de clase específico de la versión.</span><span class="sxs-lookup"><span data-stu-id="efd54-120">If a mapping exists, it will use that version of the calling process to resolve the mapping and provide the version-specific class name.</span></span> <span data-ttu-id="efd54-121">Windows crea una ventana con el procedimiento de ventana, los estilos y otros atributos asociados a ese nombre de clase y versión.</span><span class="sxs-lookup"><span data-stu-id="efd54-121">Windows creates a window with the window procedure, styles, and other attributes associated with that class name and version.</span></span>

<span data-ttu-id="efd54-122">El sistema administra el contexto de activación en la mayoría de los casos.</span><span class="sxs-lookup"><span data-stu-id="efd54-122">The activation context is managed by the system in most cases.</span></span> <span data-ttu-id="efd54-123">Normalmente, los desarrolladores de aplicaciones y los proveedores de ensamblados no necesitan realizar llamadas a la pila.</span><span class="sxs-lookup"><span data-stu-id="efd54-123">Application developers and assembly providers do not commonly need to make calls to the stack.</span></span> <span data-ttu-id="efd54-124">Las aplicaciones pueden administrar un contexto de activación llamando directamente al contexto de activación.</span><span class="sxs-lookup"><span data-stu-id="efd54-124">Applications can manage an activation context by directly calling the activation context.</span></span> <span data-ttu-id="efd54-125">Para obtener más información, consulte [uso de la API de contexto de activación](using-the-activation-context-api.md).</span><span class="sxs-lookup"><span data-stu-id="efd54-125">For more information, see [Using the Activation Context API](using-the-activation-context-api.md).</span></span>

 

 
