---
description: Acerca de MFTs
ms.assetid: ca9cef70-b897-4fd5-9a13-8bf1c2b84b00
title: Acerca de MFTs
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 09adce4bc93c110cf98e4fd8ed427ffcd009c3c1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "103908043"
---
# <a name="about-mfts"></a><span data-ttu-id="8d9bc-103">Acerca de MFTs</span><span class="sxs-lookup"><span data-stu-id="8d9bc-103">About MFTs</span></span>

<span data-ttu-id="8d9bc-104">Media Foundation transformaciones (MFTs) proporcionan un modelo genérico para procesar los datos multimedia.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-104">Media Foundation transforms (MFTs) provide a generic model for processing media data.</span></span> <span data-ttu-id="8d9bc-105">MFTs se usan para descodificadores, codificadores y procesadores de señal digital (DSP).</span><span class="sxs-lookup"><span data-stu-id="8d9bc-105">MFTs are used for decoders, encoders, and digital signal processors (DSPs).</span></span> <span data-ttu-id="8d9bc-106">En Resumen, todo lo que se encuentra en la canalización multimedia entre el origen multimedia y el receptor multimedia es un MFT.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-106">In short, anything that sits in the media pipeline between the media source and the media sink is an MFT.</span></span>

<span data-ttu-id="8d9bc-107">Para la mayoría de las aplicaciones, los detalles del procesamiento de datos de MFT están ocultos en los niveles superiores de la arquitectura de Media Foundation.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-107">For most applications, the details of MFT data processing are hidden by higher layers of the Media Foundation architecture.</span></span> <span data-ttu-id="8d9bc-108">Muchas aplicaciones de Media Foundation nunca realizarán una llamada directa a una MFT.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-108">Many Media Foundation applications will never make a direct call to an MFT.</span></span> <span data-ttu-id="8d9bc-109">Sin embargo, es ciertamente posible hospedar un MFT directamente en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-109">However, it is certainly possible to host an MFT directly in your application.</span></span>

<span data-ttu-id="8d9bc-110">MFTs son una evolución del modelo de transformación que se presentó por primera vez con objetos de DirectX media (DMOs).</span><span class="sxs-lookup"><span data-stu-id="8d9bc-110">MFTs are an evolution of the transform model first introduced with DirectX Media Objects (DMOs).</span></span> <span data-ttu-id="8d9bc-111">De hecho, es relativamente fácil crear una transformación que admita ambos modelos.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-111">In fact, it is relatively easy to create a transform that supports both models.</span></span> <span data-ttu-id="8d9bc-112">En comparación con DMOs, los comportamientos necesarios de MFTs se especifican con más claridad, lo que facilita la escritura de una implementación correcta.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-112">Compared with DMOs, the required behaviors of MFTs are more clearly specified, which makes it easier to write a correct implementation.</span></span> <span data-ttu-id="8d9bc-113">Además, MFTs puede admitir el procesamiento de vídeo acelerado por hardware.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-113">In addition, MFTs can support hardware-accelerated video processing.</span></span>

<span data-ttu-id="8d9bc-114">En este tema se proporciona una breve introducción al modelo de procesamiento de MFT, centrándose en el diseño general en lugar de llamadas a métodos específicos.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-114">This topic gives a brief overview of the MFT processing model, focusing on the overall design rather than specific method calls.</span></span> <span data-ttu-id="8d9bc-115">Para obtener una descripción paso a paso más detallada, vea modelo de [procesamiento de MFT básico](basic-mft-processing-model.md).</span><span class="sxs-lookup"><span data-stu-id="8d9bc-115">For a more detailed, step-by-step description, see [Basic MFT Processing Model](basic-mft-processing-model.md).</span></span>

## <a name="streams"></a><span data-ttu-id="8d9bc-116">Secuencias</span><span class="sxs-lookup"><span data-stu-id="8d9bc-116">Streams</span></span>

<span data-ttu-id="8d9bc-117">Una MFT tiene flujos de entrada y flujos de salida.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-117">An MFT has input streams and output streams.</span></span> <span data-ttu-id="8d9bc-118">Los flujos de entrada reciben datos y los flujos de salida generan datos.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-118">Input streams receive data, and output streams produce data.</span></span> <span data-ttu-id="8d9bc-119">Por ejemplo, un descodificador tiene un flujo de entrada, que recibe los datos codificados y un flujo de salida, que genera los datos descodificados.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-119">For example, a decoder has one input stream, which receives the encoded data, and one output stream, which produces the decoded data.</span></span>

<span data-ttu-id="8d9bc-120">Los flujos de una MFT no se representan como objetos COM distintos.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-120">The streams on an MFT are not represented as distinct COM objects.</span></span> <span data-ttu-id="8d9bc-121">En su lugar, cada flujo tiene un identificador de flujo designado y los métodos de la interfaz [**IMFTransform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform) toman los identificadores de secuencia como parámetros de entrada.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-121">Instead, each stream has a designated stream identifier, and the methods in the [**IMFTransform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform) interface take stream identifiers as input parameters.</span></span>

<span data-ttu-id="8d9bc-122">Algunos MFTs tienen un número fijo de flujos.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-122">Some MFTs have a fixed number of streams.</span></span> <span data-ttu-id="8d9bc-123">Por ejemplo, los descodificadores y codificadores suelen tener exactamente una entrada y una salida.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-123">For example, decoders and encoders normally have exactly one input and one output.</span></span> <span data-ttu-id="8d9bc-124">Otros MFTs tienen un número dinámico de flujos.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-124">Other MFTs have a dynamic number of streams.</span></span> <span data-ttu-id="8d9bc-125">Si una MFT admite secuencias dinámicas, el cliente puede agregar nuevos flujos de entrada.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-125">If an MFT supports dynamic streams, the client can add new input streams.</span></span> <span data-ttu-id="8d9bc-126">El cliente no puede Agregar flujos de salida, pero el MFT podría agregar o quitar flujos de salida durante el procesamiento.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-126">The client cannot add output streams, but the MFT might add or remove output streams during processing.</span></span> <span data-ttu-id="8d9bc-127">Por ejemplo, los multiplexores normalmente permiten al cliente agregar flujos de entrada y tener una salida para la secuencia multiplexada.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-127">For example, multiplexers typically allow the client to add input streams and have one output for the multiplexed stream.</span></span> <span data-ttu-id="8d9bc-128">Los demultiplexadores son los inversos, con una entrada, pero un número dinámico de flujos de salida, en función del contenido del flujo de entrada.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-128">Demultiplexers are the reverse, with one input but a dynamic number of output streams, depending on the contents of the input stream.</span></span> <span data-ttu-id="8d9bc-129">En la ilustración siguiente se muestra la diferencia entre multiplexor y separador.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-129">The following illustration shows the difference between multiplexer and demultiplexer.</span></span>

![diagrama que muestra un codificador/descodificador (1 entrada, 1 salida), un multiplexor (2 entradas, 1 salida) y un demultiplexador (1 entrada, 2 salidas)](images/f2b95bd5-f862-4d66-9d75-550a90f6cc97.gif)

## <a name="media-types"></a><span data-ttu-id="8d9bc-131">Tipos de medios</span><span class="sxs-lookup"><span data-stu-id="8d9bc-131">Media Types</span></span>

<span data-ttu-id="8d9bc-132">Cuando se crea por primera vez un MFT, ninguno de los flujos tiene un formato establecido.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-132">When an MFT is first created, none of the streams has an established format.</span></span> <span data-ttu-id="8d9bc-133">Para que la MFT pueda procesar los datos, el cliente debe establecer los formatos de las secuencias.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-133">Before the MFT can process data, the client must set the formats for the streams.</span></span> <span data-ttu-id="8d9bc-134">Por ejemplo, con un descodificador, el formato de entrada es el formato de compresión utilizado en el archivo de código fuente original y el formato de salida es un formato sin comprimir, como audio PCM o vídeo RGB.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-134">For example, with a decoder, the input format is the compression format used in the original source file, and the output format is an uncompressed format, such as PCM audio or RGB video.</span></span> <span data-ttu-id="8d9bc-135">Los formatos de secuencia se describen mediante [tipos de medios](media-types.md).</span><span class="sxs-lookup"><span data-stu-id="8d9bc-135">The stream formats are described using [Media Types](media-types.md).</span></span>

<span data-ttu-id="8d9bc-136">Dependiendo del estado interno de la MFT, podría proporcionar una lista de posibles tipos de medios para cada flujo.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-136">Depending on the internal state of the MFT, it might provide a list of possible media types for each stream.</span></span> <span data-ttu-id="8d9bc-137">Puede usar esta lista como una sugerencia al establecer los tipos de medios.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-137">You can use this list as a hint when you set the media types.</span></span> <span data-ttu-id="8d9bc-138">Si se establece el tipo de medio en una secuencia, se puede cambiar la lista de posibles tipos de otro flujo.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-138">Setting the media type on one stream can change the list of possible types for a another stream.</span></span> <span data-ttu-id="8d9bc-139">Por ejemplo, un descodificador normalmente no puede proporcionar ningún tipo de salida hasta que el cliente establece el tipo de entrada.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-139">For example, a decoder typically cannot provide any output types until the client sets the input type.</span></span> <span data-ttu-id="8d9bc-140">El tipo de entrada contiene la información que el descodificador necesita para devolver una lista de posibles tipos de salida.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-140">The input type contains the information that the decoder needs to return a list of possible output types.</span></span>

<span data-ttu-id="8d9bc-141">Para establecer el tipo de medio en una secuencia, llame a [**IMFTransform:: SetInputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setinputtype) o [**IMFTransform:: SetOutputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setoutputtype).</span><span class="sxs-lookup"><span data-stu-id="8d9bc-141">To set the media type on a stream, call [**IMFTransform::SetInputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setinputtype) or [**IMFTransform::SetOutputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setoutputtype).</span></span> <span data-ttu-id="8d9bc-142">Para obtener la lista de los posibles tipos de medios de una secuencia, llame a [**IMFTransform:: GetInputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getinputavailabletype) o [**IMFTransform:: GetOutputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputavailabletype).</span><span class="sxs-lookup"><span data-stu-id="8d9bc-142">To get the list of possible media types for a stream, call [**IMFTransform::GetInputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getinputavailabletype) or [**IMFTransform::GetOutputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputavailabletype).</span></span>

## <a name="processing-data"></a><span data-ttu-id="8d9bc-143">Procesamiento de datos</span><span class="sxs-lookup"><span data-stu-id="8d9bc-143">Processing Data</span></span>

<span data-ttu-id="8d9bc-144">Después de que el cliente establezca los tipos de medios en las secuencias, la MFT está lista para procesar los datos.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-144">After the client sets the media types on the streams, the MFT is ready to process data.</span></span> <span data-ttu-id="8d9bc-145">Para que esto suceda, el cliente alterna entre proporcionar datos de entrada al MFT y obtener los datos de salida de la MFT:</span><span class="sxs-lookup"><span data-stu-id="8d9bc-145">To make this happen, the client alternates between providing input data to the MFT and getting output data from the MFT:</span></span>

-   <span data-ttu-id="8d9bc-146">Para proporcionar datos de entrada a la MFT, llame a [**IMFTransform::P rocessinput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput).</span><span class="sxs-lookup"><span data-stu-id="8d9bc-146">To give input data to the MFT, call [**IMFTransform::ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput).</span></span>
-   <span data-ttu-id="8d9bc-147">Para extraer los datos de salida de MFT, llame a [**IMFTransform::P rocessoutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput).</span><span class="sxs-lookup"><span data-stu-id="8d9bc-147">To pull output data from the MFT, call [**IMFTransform::ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput).</span></span>

<span data-ttu-id="8d9bc-148">El método [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) toma un puntero a un ejemplo multimedia asignado por el cliente.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-148">The [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) method takes a pointer to a media sample allocated by the client.</span></span> <span data-ttu-id="8d9bc-149">El ejemplo multimedia contiene uno o más búferes y cada búfer contiene datos de entrada para que los procese el MFT.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-149">The media sample contains one or more buffers, and each buffer contains input data for the MFT to process.</span></span>

<span data-ttu-id="8d9bc-150">El método [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) admite dos modelos de asignación diferentes: el MFT asigna los búferes de salida o el cliente asigna los búferes de salida.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-150">The [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) method supports two different allocation models: Either the MFT allocates the output buffers, or the client allocates the output buffers.</span></span> <span data-ttu-id="8d9bc-151">Algunos MFTs admiten ambos modelos de asignación, pero no es necesario que un MFT admita ambos.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-151">Some MFTs support both allocation models, but it is not required for an MFT to support both.</span></span> <span data-ttu-id="8d9bc-152">Por ejemplo, un MFT podría requerir que el cliente asignara los búferes de salida.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-152">For example, an MFT might require the client to allocate the output buffers.</span></span> <span data-ttu-id="8d9bc-153">El método [**IMFTransform:: GetOutputStreamInfo**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputstreaminfo) devuelve información acerca de un flujo de salida, incluido el modelo de asignación que la MFT admite.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-153">The [**IMFTransform::GetOutputStreamInfo**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputstreaminfo) method returns information about an output stream, including which allocation model the MFT supports.</span></span>

<span data-ttu-id="8d9bc-154">MFTs están diseñados para almacenar en búfer los datos mínimos posibles, con el fin de minimizar la latencia en la canalización.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-154">MFTs are designed to buffer as little data as possible, in order to minimize latency in the pipeline.</span></span> <span data-ttu-id="8d9bc-155">Por lo tanto, en un momento dado, la MFT puede indicar una de las siguientes condiciones:</span><span class="sxs-lookup"><span data-stu-id="8d9bc-155">Therefore, at any given time, the MFT can signal one of the following conditions:</span></span>

-   <span data-ttu-id="8d9bc-156">La MFT requiere más datos de entrada.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-156">The MFT requires more input data.</span></span> <span data-ttu-id="8d9bc-157">En este estado, la MFT no puede producir la salida hasta que el cliente llame a [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) al menos una vez.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-157">In this state, the MFT cannot produce output until the client calls [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) at least once.</span></span>
-   <span data-ttu-id="8d9bc-158">La MFT no aceptará más entradas hasta que el cliente llame a [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) al menos una vez.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-158">The MFT will not accept any more input until the client calls [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) at least once.</span></span>

<span data-ttu-id="8d9bc-159">Por ejemplo, supongamos que usa un descodificador de vídeo para descodificar una secuencia de vídeo que contiene una combinación de fotogramas clave y fotogramas Delta.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-159">For example, suppose that you are using a video decoder to decode a video stream that contains a mix of key frames and delta frames.</span></span> <span data-ttu-id="8d9bc-160">Inicialmente, la MFT requiere algunos datos para poder descodificar los fotogramas.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-160">Initially, the MFT requires some input before it can decode any frames.</span></span> <span data-ttu-id="8d9bc-161">El cliente llama a [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) para proporcionar el primer fotograma.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-161">The client calls [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) to deliver the first frame.</span></span> <span data-ttu-id="8d9bc-162">Supongamos que el primer fotograma es un fotograma Delta (se muestra en el siguiente diagrama como "P" para el marco de predicción).</span><span class="sxs-lookup"><span data-stu-id="8d9bc-162">Suppose that the first frame is a delta frame (shown in the following diagram as 'P' for predicted frame).</span></span> <span data-ttu-id="8d9bc-163">El descodificador retiene en este fotograma, pero no puede producir ningún resultado hasta que obtiene el siguiente fotograma clave.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-163">The decoder holds onto this frame, but it cannot produce any output until it gets the next key frame.</span></span>

![diagrama que muestra la MFT que necesita entrada y apunta a un marco de predicción](images/f5a88ac6-24da-40e5-b356-649aa6f811c3.gif)

<span data-ttu-id="8d9bc-165">El cliente sigue llamando a [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) y, finalmente, alcanza el fotograma clave siguiente (que se muestra en el siguiente diagrama como "I" para el marco dentro de la codificación).</span><span class="sxs-lookup"><span data-stu-id="8d9bc-165">The client continues to call [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) and eventually reaches the next key frame (shown in the next diagram as 'I' for intra-coded frame).</span></span> <span data-ttu-id="8d9bc-166">Ahora el descodificador tiene suficientes fotogramas para iniciar la descodificación.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-166">Now the decoder has enough frames to start decoding.</span></span> <span data-ttu-id="8d9bc-167">En este punto, deja de aceptar la entrada y el cliente debe llamar a [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) para obtener los fotogramas descodificados.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-167">At this point it stops accepting input, and the client must call [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) to get the decoded frames.</span></span>

![diagrama que muestra un MFT que no acepta entradas, que apunta a un marco dentro de la codificación y tres marcos predichos](images/ae014a1a-9d03-4cfa-a04d-4a63bdc83f73.gif)

<span data-ttu-id="8d9bc-169">El enfoque más sencillo para el cliente es simplemente llamadas alternativas a [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) y [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput).</span><span class="sxs-lookup"><span data-stu-id="8d9bc-169">The simplest approach for the client is simply to alternate calls to [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) and [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput).</span></span> <span data-ttu-id="8d9bc-170">En el tema [modelo de procesamiento de MFT básico](basic-mft-processing-model.md)se describe un algoritmo más sofisticado.</span><span class="sxs-lookup"><span data-stu-id="8d9bc-170">A more sophisticated algorithm is described in the topic [Basic MFT Processing Model](basic-mft-processing-model.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="8d9bc-171">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="8d9bc-171">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8d9bc-172">Media Foundation transformaciones</span><span class="sxs-lookup"><span data-stu-id="8d9bc-172">Media Foundation Transforms</span></span>](media-foundation-transforms.md)
</dt> </dl>

 

 



