---
description: La \_ enumeración nivel de SUplantación de seguridad \_ define cuatro niveles de suplantación que determinan las operaciones que puede realizar un servidor en el contexto de los clientes.
ms.assetid: ae152dbf-44f0-417f-a85e-09bf60dcfcb0
title: Niveles de suplantación (autorización)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b91654f42a86e5c47069197bed084df56f5445dd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "105668401"
---
# <a name="impersonation-levels-authorization"></a><span data-ttu-id="400ee-103">Niveles de suplantación (autorización)</span><span class="sxs-lookup"><span data-stu-id="400ee-103">Impersonation Levels (Authorization)</span></span>

<span data-ttu-id="400ee-104">La enumeración [**\_ \_ nivel de suplantación de seguridad**](/windows/desktop/api/Winnt/ne-winnt-security_impersonation_level) define cuatro niveles de suplantación que determinan las operaciones que un servidor puede realizar en el contexto del cliente.</span><span class="sxs-lookup"><span data-stu-id="400ee-104">The [**SECURITY\_IMPERSONATION\_LEVEL**](/windows/desktop/api/Winnt/ne-winnt-security_impersonation_level) enumeration defines four impersonation levels that determine the operations a server can perform in the client's context.</span></span>



| <span data-ttu-id="400ee-105">Nivel de suplantación</span><span class="sxs-lookup"><span data-stu-id="400ee-105">Impersonation level</span></span>    | <span data-ttu-id="400ee-106">Descripción</span><span class="sxs-lookup"><span data-stu-id="400ee-106">Description</span></span>                                                                                      |
|------------------------|--------------------------------------------------------------------------------------------------|
| <span data-ttu-id="400ee-107">SecurityAnonymous</span><span class="sxs-lookup"><span data-stu-id="400ee-107">SecurityAnonymous</span></span>      | <span data-ttu-id="400ee-108">El servidor no puede suplantar o identificar al cliente.</span><span class="sxs-lookup"><span data-stu-id="400ee-108">The server cannot impersonate or identify the client.</span></span>                                            |
| <span data-ttu-id="400ee-109">SecurityIdentification</span><span class="sxs-lookup"><span data-stu-id="400ee-109">SecurityIdentification</span></span> | <span data-ttu-id="400ee-110">El servidor puede obtener la identidad y los privilegios del cliente, pero no puede suplantar al cliente.</span><span class="sxs-lookup"><span data-stu-id="400ee-110">The server can get the identity and privileges of the client, but cannot impersonate the client.</span></span> |
| <span data-ttu-id="400ee-111">SecurityImpersonation</span><span class="sxs-lookup"><span data-stu-id="400ee-111">SecurityImpersonation</span></span>  | <span data-ttu-id="400ee-112">El servidor puede suplantar el contexto de seguridad del cliente en el sistema local.</span><span class="sxs-lookup"><span data-stu-id="400ee-112">The server can impersonate the client's security context on the local system.</span></span>                    |
| <span data-ttu-id="400ee-113">SecurityDelegation</span><span class="sxs-lookup"><span data-stu-id="400ee-113">SecurityDelegation</span></span>     | <span data-ttu-id="400ee-114">El servidor puede suplantar el contexto de seguridad del cliente en sistemas remotos.</span><span class="sxs-lookup"><span data-stu-id="400ee-114">The server can impersonate the client's security context on remote systems.</span></span>                      |



 

<span data-ttu-id="400ee-115">El cliente de una canalización con nombre, RPC o conexión DDE puede controlar el nivel de suplantación.</span><span class="sxs-lookup"><span data-stu-id="400ee-115">The client of a named pipe, RPC, or DDE connection can control the impersonation level.</span></span> <span data-ttu-id="400ee-116">Por ejemplo, un cliente de canalización con nombre puede llamar a la función [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) para abrir un identificador a una canalización con nombre y especificar el nivel de suplantación del servidor.</span><span class="sxs-lookup"><span data-stu-id="400ee-116">For example, a named pipe client can call the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function to open a handle to a named pipe and specify the server's impersonation level.</span></span>

<span data-ttu-id="400ee-117">Cuando la canalización con nombre, RPC o conexión DDE es remota, se omiten las marcas pasadas a [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) para establecer el nivel de suplantación.</span><span class="sxs-lookup"><span data-stu-id="400ee-117">When the named pipe, RPC, or DDE connection is remote, the flags passed to [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) to set the impersonation level are ignored.</span></span> <span data-ttu-id="400ee-118">En este caso, el nivel de suplantación del cliente viene determinado por los niveles de suplantación habilitados por el servidor, que se establece mediante una marca en la cuenta del servidor en el servicio de directorio.</span><span class="sxs-lookup"><span data-stu-id="400ee-118">In this case, the impersonation level of the client is determined by the impersonation levels enabled by the server, which is set by a flag on the server's account in the directory service.</span></span> <span data-ttu-id="400ee-119">Por ejemplo, si el servidor está habilitado para la delegación, el nivel de suplantación del cliente también se establecerá en delegación aunque las marcas pasadas a **CreateFile** especifiquen el nivel de suplantación de identificación.</span><span class="sxs-lookup"><span data-stu-id="400ee-119">For example, if the server is enabled for delegation, the client's impersonation level will also be set to delegation even if the flags passed to **CreateFile** specify the identification impersonation level.</span></span>

<span data-ttu-id="400ee-120">Los clientes DDE usan la función [**DdeSetQualityOfService**](/windows/win32/api/dde/nf-dde-ddesetqualityofservice) con la estructura [**\_ \_ de calidad de \_ servicio de seguridad**](/windows/desktop/api/Winnt/ns-winnt-security_quality_of_service) para especificar el nivel de suplantación.</span><span class="sxs-lookup"><span data-stu-id="400ee-120">DDE clients use the [**DdeSetQualityOfService**](/windows/win32/api/dde/nf-dde-ddesetqualityofservice) function with the [**SECURITY\_QUALITY\_OF\_SERVICE**](/windows/desktop/api/Winnt/ns-winnt-security_quality_of_service) structure to specify the impersonation level.</span></span> <span data-ttu-id="400ee-121">El nivel SecurityImpersonation es el valor predeterminado para los servidores de canalización con nombre, RPC y DDE.</span><span class="sxs-lookup"><span data-stu-id="400ee-121">The SecurityImpersonation level is the default for named pipe, RPC, and DDE servers.</span></span> <span data-ttu-id="400ee-122">Las funciones [**ImpersonateSelf**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-impersonateself), [**DuplicateToken**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetoken)y [**DuplicateTokenEx**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetokenex) permiten al llamador especificar un nivel de suplantación.</span><span class="sxs-lookup"><span data-stu-id="400ee-122">The [**ImpersonateSelf**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-impersonateself), [**DuplicateToken**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetoken), and [**DuplicateTokenEx**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetokenex) functions allow the caller to specify an impersonation level.</span></span> <span data-ttu-id="400ee-123">Use la función [**GetTokenInformation**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-gettokeninformation) para recuperar el nivel de suplantación de un [*token de acceso*](/windows/desktop/SecGloss/a-gly).</span><span class="sxs-lookup"><span data-stu-id="400ee-123">Use the [**GetTokenInformation**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-gettokeninformation) function to retrieve the impersonation level of an [*access token*](/windows/desktop/SecGloss/a-gly).</span></span>

<span data-ttu-id="400ee-124">En el nivel SecurityImpersonation, la mayoría de las acciones del subproceso se producen en el contexto de seguridad del [*token de suplantación*](/windows/desktop/SecGloss/i-gly) del subproceso, en lugar de en el [*token principal*](/windows/desktop/SecGloss/p-gly) del [*proceso*](/windows/desktop/SecGloss/p-gly) que posee el subproceso.</span><span class="sxs-lookup"><span data-stu-id="400ee-124">At the SecurityImpersonation level, most of the thread's actions occur in the security context of the thread's [*impersonation token*](/windows/desktop/SecGloss/i-gly) rather than in the [*primary token*](/windows/desktop/SecGloss/p-gly) of the [*process*](/windows/desktop/SecGloss/p-gly) that owns the thread.</span></span> <span data-ttu-id="400ee-125">Por ejemplo, si un subproceso de suplantación abre un [objeto protegible](securable-objects.md), el sistema utiliza el token de suplantación para comprobar el acceso del subproceso.</span><span class="sxs-lookup"><span data-stu-id="400ee-125">For example, if an impersonating thread opens a [securable object](securable-objects.md), the system uses the impersonation token to check the thread's access.</span></span> <span data-ttu-id="400ee-126">Del mismo modo, si un subproceso de suplantación crea un nuevo objeto, por ejemplo llamando a la función [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) , el propietario del nuevo objeto es el propietario predeterminado del [*token de acceso*](/windows/desktop/SecGloss/a-gly)del cliente.</span><span class="sxs-lookup"><span data-stu-id="400ee-126">Similarly, if an impersonating thread creates a new object, for example by calling the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function, the owner of the new object is the default owner from the client's [*access token*](/windows/desktop/SecGloss/a-gly).</span></span>

<span data-ttu-id="400ee-127">Sin embargo, el sistema utiliza el token principal del proceso en lugar del token de suplantación del subproceso que realiza la llamada en las siguientes situaciones:</span><span class="sxs-lookup"><span data-stu-id="400ee-127">However, the system uses the primary token of the process rather than the impersonation token of the calling thread in the following situations:</span></span>

-   <span data-ttu-id="400ee-128">Si un subproceso de suplantación llama a la función [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa) , el nuevo proceso hereda siempre el token principal del proceso.</span><span class="sxs-lookup"><span data-stu-id="400ee-128">If an impersonating thread calls the [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa) function, the new process always inherits the primary token of the process.</span></span>
-   <span data-ttu-id="400ee-129">En el caso de las funciones que requieren el \_ privilegio de nombre TCB de se \_ , como la función [**LogonUser**](/windows/desktop/api/winbase/nf-winbase-logonusera) , el sistema siempre comprueba el privilegio en el token principal del proceso.</span><span class="sxs-lookup"><span data-stu-id="400ee-129">For functions that require the SE\_TCB\_NAME privilege, such as the [**LogonUser**](/windows/desktop/api/winbase/nf-winbase-logonusera) function, the system always checks for the privilege in the primary token of the process.</span></span>
-   <span data-ttu-id="400ee-130">En el caso de las funciones que requieren el privilegio de nombre de auditoría de SE \_ \_ , como la función [**ObjectOpenAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-objectopenauditalarma) , el sistema siempre comprueba el privilegio en el token principal del proceso.</span><span class="sxs-lookup"><span data-stu-id="400ee-130">For functions that require the SE\_AUDIT\_NAME privilege, such as the [**ObjectOpenAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-objectopenauditalarma) function, the system always checks for the privilege in the primary token of the process.</span></span>
-   <span data-ttu-id="400ee-131">En una llamada a la función [**OpenThreadToken**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-openthreadtoken) , un subproceso puede especificar si la función utiliza el token de suplantación o el token primario para determinar si se debe conceder el acceso solicitado.</span><span class="sxs-lookup"><span data-stu-id="400ee-131">In a call to the [**OpenThreadToken**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-openthreadtoken) function, a thread can specify whether the function uses the impersonation token or the primary token to determine whether to grant the requested access.</span></span>

 

 
