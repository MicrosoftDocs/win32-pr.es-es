---
title: Biblioteca COM
description: Biblioteca COM
ms.assetid: 51d4db4a-ad88-4627-8140-2f7906945752
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a285a89ca659907c37f92b7d00f3e3e04d0acf51
ms.sourcegitcommit: 307b14e9847ced354a52a1ac12d7f659722d99bb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/06/2020
ms.locfileid: "103995007"
---
# <a name="the-com-library"></a><span data-ttu-id="e7f4b-103">Biblioteca COM</span><span class="sxs-lookup"><span data-stu-id="e7f4b-103">The COM Library</span></span>

<span data-ttu-id="e7f4b-104">Cualquier proceso que use COM debe inicializar y anular la inicialización de la biblioteca COM.</span><span class="sxs-lookup"><span data-stu-id="e7f4b-104">Any process that uses COM must both initialize and uninitialize the COM library.</span></span> <span data-ttu-id="e7f4b-105">Además de ser una especificación, COM también implementa algunos servicios importantes en esta biblioteca.</span><span class="sxs-lookup"><span data-stu-id="e7f4b-105">In addition to being a specification, COM also implements some important services in this library.</span></span> <span data-ttu-id="e7f4b-106">La biblioteca COM, que se proporciona como un conjunto de archivos dll y exe (principalmente Ole32.dll y Rpcss.exe) en Microsoft Windows, incluye lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="e7f4b-106">Provided as a set of DLLs and EXEs (primarily Ole32.dll and Rpcss.exe) in Microsoft Windows, the COM library includes the following:</span></span>

-   <span data-ttu-id="e7f4b-107">Un pequeño número de funciones fundamentales que facilitan la creación de aplicaciones COM, tanto de cliente como de servidor.</span><span class="sxs-lookup"><span data-stu-id="e7f4b-107">A small number of fundamental functions that facilitate the creation of COM applications, both client and server.</span></span> <span data-ttu-id="e7f4b-108">En el caso de los clientes, COM proporciona funciones básicas para crear objetos.</span><span class="sxs-lookup"><span data-stu-id="e7f4b-108">For clients, COM supplies basic functions for creating objects.</span></span> <span data-ttu-id="e7f4b-109">En el caso de los servidores, COM proporciona los medios para exponer sus objetos.</span><span class="sxs-lookup"><span data-stu-id="e7f4b-109">For servers, COM supplies the means of exposing their objects.</span></span>

-   <span data-ttu-id="e7f4b-110">Los servicios de ubicación de implementación a través de los cuales COM determinan, desde un identificador de clase único (CLSID), que el servidor implementa esa clase y donde se encuentra el servidor.</span><span class="sxs-lookup"><span data-stu-id="e7f4b-110">Implementation-locator services through which COM determines, from a unique class identifier (CLSID), which server implements that class and where that server is located.</span></span> <span data-ttu-id="e7f4b-111">Este servicio incluye compatibilidad con un nivel de direccionamiento indirecto, normalmente un registro del sistema, entre la identidad de una clase de objeto y el empaquetado de la implementación para que los clientes sean independientes del empaquetado, lo que puede cambiar en el futuro.</span><span class="sxs-lookup"><span data-stu-id="e7f4b-111">This service includes support for a level of indirection, usually a system registry, between the identity of an object class and the packaging of the implementation so that clients are independent of the packaging, which can change in the future.</span></span>

-   <span data-ttu-id="e7f4b-112">Llamadas a procedimiento remoto transparentes cuando un objeto se está ejecutando en un servidor local o remoto.</span><span class="sxs-lookup"><span data-stu-id="e7f4b-112">Transparent remote procedure calls when an object is running in a local or remote server.</span></span>

-   <span data-ttu-id="e7f4b-113">Mecanismo estándar para permitir que una aplicación controle el modo en que se asigna la memoria dentro de su proceso, especialmente la memoria que debe pasarse entre los objetos cooperativos para que se pueda liberar correctamente.</span><span class="sxs-lookup"><span data-stu-id="e7f4b-113">A standard mechanism to allow an application to control how memory is allocated within its process, particularly memory that needs to be passed between cooperating objects so that it can be freed properly.</span></span>

<span data-ttu-id="e7f4b-114">Para usar servicios COM básicos, todos los subprocesos COM de ejecución en clientes y servidores fuera de proceso deben llamar a la función [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) o [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex) antes de llamar a cualquier otra función com, excepto las llamadas de asignación de memoria.</span><span class="sxs-lookup"><span data-stu-id="e7f4b-114">To use basic COM services, all COM threads of execution in clients and out-of-process servers must call either the [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) or the [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex) function before calling any other COM function except memory allocation calls.</span></span> <span data-ttu-id="e7f4b-115">**CoInitializeEx** reemplaza la otra función, agregando un parámetro que le permite especificar el modelo de subprocesos del subproceso, ya sea de apartamento o de subproceso libre.</span><span class="sxs-lookup"><span data-stu-id="e7f4b-115">**CoInitializeEx** replaces the other function, adding a parameter that allows you to specify the threading model of the thread: either apartment-threaded or free-threaded.</span></span> <span data-ttu-id="e7f4b-116">Una llamada a **CoInitialize** simplemente establece el modelo de subprocesos en Apartamento-threaded.</span><span class="sxs-lookup"><span data-stu-id="e7f4b-116">A call to **CoInitialize** simply sets the threading model to apartment-threaded.</span></span>

<span data-ttu-id="e7f4b-117">Las aplicaciones de documentos compuestos OLE llaman a la función [**OleInitialize**](/windows/desktop/api/Ole2/nf-ole2-oleinitialize) , que llama a [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex) y también requiere una inicialización para los documentos compuestos.</span><span class="sxs-lookup"><span data-stu-id="e7f4b-117">OLE compound document applications call the [**OleInitialize**](/windows/desktop/api/Ole2/nf-ole2-oleinitialize) function, which calls [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex) and also does some initialization required for compound documents.</span></span> <span data-ttu-id="e7f4b-118">Por lo tanto, los subprocesos que llaman a **OleInitialize** no pueden ser de subproceso libre.</span><span class="sxs-lookup"><span data-stu-id="e7f4b-118">Therefore, threads that call **OleInitialize** cannot be free-threaded.</span></span> <span data-ttu-id="e7f4b-119">Para obtener información sobre los subprocesos en clientes y servidores, consulte [procesos, subprocesos y apartamentos](processes--threads--and-apartments.md).</span><span class="sxs-lookup"><span data-stu-id="e7f4b-119">For information on threading in clients and servers, see [Processes, Threads, and Apartments](processes--threads--and-apartments.md).</span></span>

<span data-ttu-id="e7f4b-120">Los servidores en proceso no llaman a las funciones de inicialización porque se cargan en un proceso que ya lo ha hecho.</span><span class="sxs-lookup"><span data-stu-id="e7f4b-120">In-process servers do not call the initialization functions because they are being loaded into a process that has already done so.</span></span> <span data-ttu-id="e7f4b-121">Como resultado, los servidores en proceso deben establecer su modelo de subprocesos en el registro con la clave [InProcServer32](inprocserver32.md) .</span><span class="sxs-lookup"><span data-stu-id="e7f4b-121">As a result, in-process servers must set their threading model in the registry under the [InprocServer32](inprocserver32.md) key.</span></span> <span data-ttu-id="e7f4b-122">Para obtener información detallada sobre los problemas de subprocesos en los servidores de proceso, vea [problemas de subprocesos de servidor en proceso](in-process-server-threading-issues.md).</span><span class="sxs-lookup"><span data-stu-id="e7f4b-122">For detailed information on threading issues in in-process servers, see [In-Process Server Threading Issues](in-process-server-threading-issues.md).</span></span>

<span data-ttu-id="e7f4b-123">También es importante anular la inicialización de la biblioteca.</span><span class="sxs-lookup"><span data-stu-id="e7f4b-123">It is also important to uninitialize the library.</span></span> <span data-ttu-id="e7f4b-124">Para cada llamada a [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) o [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex), debe haber una llamada correspondiente a [**CoUninitialize**](/windows/desktop/api/combaseapi/nf-combaseapi-couninitialize).</span><span class="sxs-lookup"><span data-stu-id="e7f4b-124">For each call to [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) or [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex), there must be a corresponding call to [**CoUninitialize**](/windows/desktop/api/combaseapi/nf-combaseapi-couninitialize).</span></span> <span data-ttu-id="e7f4b-125">Para cada llamada a [**OleInitialize**](/windows/desktop/api/Ole2/nf-ole2-oleinitialize), debe haber una llamada correspondiente a [**OleUninitialize**](/windows/desktop/api/Ole2/nf-ole2-oleuninitialize).</span><span class="sxs-lookup"><span data-stu-id="e7f4b-125">For each call to [**OleInitialize**](/windows/desktop/api/Ole2/nf-ole2-oleinitialize), there must be a corresponding call to [**OleUninitialize**](/windows/desktop/api/Ole2/nf-ole2-oleuninitialize).</span></span>

<span data-ttu-id="e7f4b-126">Los servidores en proceso pueden suponer que el proceso en el que se cargan ya ha realizado estos pasos.</span><span class="sxs-lookup"><span data-stu-id="e7f4b-126">In-process servers can assume that the process they are being loaded into has already performed these steps.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e7f4b-127">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="e7f4b-127">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="e7f4b-128">[The Component Object Model](the-component-object-model.md) [Modelo de objetos componentes (COM)]</span><span class="sxs-lookup"><span data-stu-id="e7f4b-128">[The Component Object Model](the-component-object-model.md)</span></span>
</dt> </dl>

 

 




