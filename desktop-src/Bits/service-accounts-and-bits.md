---
title: Cuentas de servicio y BITS
description: Puede usar BITS para transferir archivos desde un servicio. El servicio debe usar la cuenta de sistema LocalSystem, LocalService o NetworkService. Estas cuentas siempre inician sesión; por lo tanto, los trabajos enviados por un servicio mediante estas cuentas siempre se ejecutan.
ms.assetid: 43fb58d6-3a99-488f-ab43-dbb4a794fc2f
keywords:
- BITS de cuentas de servicio
- transferir BITS de trabajo, propiedad, cuenta de servicio
- BITS de proxy, cuentas de servicio
- credenciales para transferir BITS de trabajo
ms.topic: article
ms.date: 10/04/2018
ms.openlocfilehash: 475a623e6b105d3ef2bdc6586db613c010fe8923
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104149357"
---
# <a name="service-accounts-and-bits"></a><span data-ttu-id="d4f21-109">Cuentas de servicio y BITS</span><span class="sxs-lookup"><span data-stu-id="d4f21-109">Service Accounts and BITS</span></span>

<span data-ttu-id="d4f21-110">Puede usar BITS para transferir archivos desde un servicio.</span><span class="sxs-lookup"><span data-stu-id="d4f21-110">You can use BITS to transfer files from a service.</span></span> <span data-ttu-id="d4f21-111">El servicio debe usar la cuenta de sistema LocalSystem, LocalService o NetworkService.</span><span class="sxs-lookup"><span data-stu-id="d4f21-111">The service must use the LocalSystem, LocalService, or NetworkService system account.</span></span> <span data-ttu-id="d4f21-112">Estas cuentas siempre inician sesión; por lo tanto, los trabajos enviados por un servicio mediante estas cuentas siempre se ejecutan.</span><span class="sxs-lookup"><span data-stu-id="d4f21-112">These accounts are always logged on; therefore, jobs submitted by a service using these accounts always run.</span></span>

<span data-ttu-id="d4f21-113">Si un servicio que se ejecuta bajo una cuenta del sistema suplanta al usuario antes de llamar a BITS, BITS responde como lo haría con cualquier cuenta de usuario (por ejemplo, el usuario debe haber iniciado sesión en el equipo para que se produzca la transferencia).</span><span class="sxs-lookup"><span data-stu-id="d4f21-113">If a service running under a system account impersonates the user before calling BITS, BITS responds as it would for any user account (for example, the user needs to be logged on to the computer for the transfer to occur).</span></span> <span data-ttu-id="d4f21-114">El servicio también debe utilizar la ocultación dinámica con los punteros de interfaz de BITS al suplantar al usuario.</span><span class="sxs-lookup"><span data-stu-id="d4f21-114">The service should also use dynamic cloaking with the BITS interface pointers when impersonating the user.</span></span> <span data-ttu-id="d4f21-115">No se hereda el Cloaking, por lo que debe llamar a la función [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket) en cada puntero de interfaz que reciba desde bits (por ejemplo, el puntero de trabajo devuelto por la llamada al método [**IBackgroundCopyManager:: CreateJob**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopymanager-createjob) ); no basta con establecer la ocultación en el puntero de la interfaz del administrador.</span><span class="sxs-lookup"><span data-stu-id="d4f21-115">Cloaking is not inherited, therefore you must call the [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket) function on each interface pointer that you receive from BITS (for example, the job pointer returned from calling the [**IBackgroundCopyManager::CreateJob**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopymanager-createjob) method); it is not enough to set cloaking on the manager interface pointer.</span></span> <span data-ttu-id="d4f21-116">También puede llamar a la función [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) para el proceso en lugar de llamar a la función **CoSetProxyBlanket** en cada puntero de interfaz.</span><span class="sxs-lookup"><span data-stu-id="d4f21-116">You can also call the [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) function for the process instead of calling the **CoSetProxyBlanket** function on each interface pointer.</span></span>

<span data-ttu-id="d4f21-117">Sin embargo, si el servicio no suplanta al usuario, se aplican los comportamientos siguientes:</span><span class="sxs-lookup"><span data-stu-id="d4f21-117">However, if the service does not impersonate the user, the following behaviors apply:</span></span>

- <span data-ttu-id="d4f21-118">Los trabajos creados por la cuenta de servicio pertenecen a esa cuenta.</span><span class="sxs-lookup"><span data-stu-id="d4f21-118">Jobs created by the service account are owned by that account.</span></span> <span data-ttu-id="d4f21-119">Dado que las cuentas del sistema siempre inician sesión, BITS transfiere los archivos siempre que el equipo se esté ejecutando y haya una conexión de red.</span><span class="sxs-lookup"><span data-stu-id="d4f21-119">Because system accounts are always logged on, BITS transfers the files as long as the computer is running and there is a network connection.</span></span>
- <span data-ttu-id="d4f21-120">Las cuentas del sistema no deben usar letras de unidad de red asignadas porque las letras de unidad son específicas de una sesión y la asignación puede perderse después de reiniciar el equipo.</span><span class="sxs-lookup"><span data-stu-id="d4f21-120">System accounts should not use mapped network drive letters because the drive letters are specific to a session and the mapping may be lost after a computer restart.</span></span>
- <span data-ttu-id="d4f21-121">En ausencia de un [token auxiliar](helper-tokens-for-bits-transfer-jobs.md), la autenticación de red usa las credenciales de equipo para las cuentas LocalSystem y NetworkService y las credenciales anónimas para la cuenta LocalService.</span><span class="sxs-lookup"><span data-stu-id="d4f21-121">In the absence of a [Helper Token](helper-tokens-for-bits-transfer-jobs.md), network authentication uses computer credentials for LocalSystem and NetworkService accounts and anonymous credentials for the LocalService account.</span></span> <span data-ttu-id="d4f21-122">BITS devuelve "acceso denegado" si la lista de control de acceso (ACL) para el archivo de origen limita el acceso a una cuenta de usuario.</span><span class="sxs-lookup"><span data-stu-id="d4f21-122">BITS returns "access denied" if the access control list (ACL) for the source file limits access to a user account.</span></span>
- <span data-ttu-id="d4f21-123">Para obtener más información sobre cómo funciona la autenticación en presencia de un [token auxiliar](helper-tokens-for-bits-transfer-jobs.md), vea [autenticación](authentication.md).</span><span class="sxs-lookup"><span data-stu-id="d4f21-123">For details on how authentication works in the presence of a [Helper Token](helper-tokens-for-bits-transfer-jobs.md), see [Authentication](authentication.md).</span></span>
- <span data-ttu-id="d4f21-124">La configuración de proxy de Microsoft Internet Explorer se almacena por usuario y no se establece para las cuentas del sistema.</span><span class="sxs-lookup"><span data-stu-id="d4f21-124">Microsoft Internet Explorer proxy settings are stored per-user and are not set for system accounts.</span></span> <span data-ttu-id="d4f21-125">Considere la posibilidad de configurar un token auxiliar en los trabajos de BITS o establecer explícitamente la configuración de proxy correcta mediante una llamada a [**IBackgroundCopyJob:: SetProxySettings**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setproxysettings) con la **\_ \_ \_ \_ invalidación del uso del proxy del trabajo de BG**.</span><span class="sxs-lookup"><span data-stu-id="d4f21-125">Consider configuring a helper token on your BITS jobs, or explicitly setting the correct proxy settings by calling [**IBackgroundCopyJob::SetProxySettings**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setproxysettings) with **BG\_JOB\_PROXY\_USAGE\_OVERRIDE**.</span></span> <span data-ttu-id="d4f21-126">Como alternativa, puede usar los modificadores de **/util/SetIEProxy** de BitsAdmin.exe para establecer la configuración de proxy de Internet Explorer para la cuenta de sistema LocalSystem, LocalService o NetworkService.</span><span class="sxs-lookup"><span data-stu-id="d4f21-126">Alternatively, you can use the **/Util /SetIEProxy** switches of BitsAdmin.exe to set Internet Explorer proxy settings for the LocalSystem, LocalService, or NetworkService system account.</span></span> <span data-ttu-id="d4f21-127">Para obtener más información, consulte la [herramienta BitsAdmin](bitsadmin-tool.md).</span><span class="sxs-lookup"><span data-stu-id="d4f21-127">For details, see [BitsAdmin Tool](bitsadmin-tool.md).</span></span>

<span data-ttu-id="d4f21-128">Tenga en cuenta que BITS no reconoce la configuración de proxy que se establece mediante el archivo de Proxycfg.exe.</span><span class="sxs-lookup"><span data-stu-id="d4f21-128">Note that BITS does not recognize the proxy settings that are set using the Proxycfg.exe file.</span></span>