---
description: Cómo participan los dispositivos de hardware en el gráfico de filtros
ms.assetid: 27e1c097-9bb4-4f9c-b9f9-0d4225c0d290
title: Cómo participan los dispositivos de hardware en el gráfico de filtros
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 68794bbc046e633e9a435b2628a20b8ea8aab174
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/06/2021
ms.locfileid: "104494308"
---
# <a name="how-hardware-devices-participate-in-the-filter-graph"></a><span data-ttu-id="78447-103">Cómo participan los dispositivos de hardware en el gráfico de filtros</span><span class="sxs-lookup"><span data-stu-id="78447-103">How Hardware Devices Participate in the Filter Graph</span></span>

<span data-ttu-id="78447-104">En este artículo se describe cómo interactúa DirectShow con el hardware de audio y vídeo.</span><span class="sxs-lookup"><span data-stu-id="78447-104">This article describes how DirectShow interacts with audio and video hardware.</span></span>

<span data-ttu-id="78447-105">**Filtros de contenedor**</span><span class="sxs-lookup"><span data-stu-id="78447-105">**Wrapper Filters**</span></span>

<span data-ttu-id="78447-106">Todos los filtros de DirectShow son componentes de software de modo usuario.</span><span class="sxs-lookup"><span data-stu-id="78447-106">All DirectShow filters are user mode software components.</span></span> <span data-ttu-id="78447-107">Para que un dispositivo de hardware en modo kernel, como una tarjeta de captura de vídeo, se unan a un gráfico de filtros de DirectShow, el dispositivo se debe representar como un filtro de modo de usuario.</span><span class="sxs-lookup"><span data-stu-id="78447-107">In order for a kernel mode hardware device, such as a video capture card, to join a DirectShow filter graph, the device must be represented as a user-mode filter.</span></span> <span data-ttu-id="78447-108">Esta función se realiza mediante los filtros de "contenedor" especializados que se proporcionan con DirectShow.</span><span class="sxs-lookup"><span data-stu-id="78447-108">This function is performed by specialized "wrapper" filters provided with DirectShow.</span></span> <span data-ttu-id="78447-109">Estos filtros incluyen el filtro de [captura de audio](audio-capture.md) , el filtro de [captura VFW](vfw-capture-filter.md) , el filtro de [sintonizador de TV](tv-tuner-filter.md) , el filtro de audio de [TV](tv-audio-filter.md) y el filtro de [Cruz analógica de vídeo](analog-video-crossbar-filter.md) .</span><span class="sxs-lookup"><span data-stu-id="78447-109">These filters include the [Audio Capture](audio-capture.md) filter, the [VFW Capture](vfw-capture-filter.md) filter, the [TV Tuner](tv-tuner-filter.md) filter, the [TV Audio](tv-audio-filter.md) filter, and the [Analog Video Crossbar](analog-video-crossbar-filter.md) filter.</span></span> <span data-ttu-id="78447-110">DirectShow también proporciona un filtro denominado KsProxy, que puede representar cualquier tipo de dispositivo de streaming Modelo de controlador de Windows (WDM).</span><span class="sxs-lookup"><span data-stu-id="78447-110">DirectShow also provides a filter called KsProxy, which can represent any type of Windows Driver Model (WDM) streaming device.</span></span> <span data-ttu-id="78447-111">Los proveedores de hardware pueden extender KsProxy para admitir la funcionalidad personalizada, proporcionando un *complemento KsProxy*, que es un objeto com agregado por KsProxy.</span><span class="sxs-lookup"><span data-stu-id="78447-111">Hardware vendors can extend KsProxy to support custom functionality, by providing a *Ksproxy plug-in*, which is a COM object aggregated by KsProxy.</span></span>

<span data-ttu-id="78447-112">Los filtros de contenedor exponen las interfaces COM que representan las funciones del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="78447-112">The wrapper filters expose COM interfaces that represent the capabilities of the device.</span></span> <span data-ttu-id="78447-113">La aplicación usa estas interfaces para pasar información hacia y desde el filtro.</span><span class="sxs-lookup"><span data-stu-id="78447-113">The application uses these interfaces to pass information to and from the filter.</span></span> <span data-ttu-id="78447-114">El filtro convierte las llamadas al método COM en llamadas de controlador de dispositivo, pasa esa información al controlador en modo kernel y, a continuación, convierte el resultado de nuevo en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="78447-114">The filter translates the COM method calls into device driver calls, passes that information to the driver in kernel mode, and then translates the result back to the application.</span></span> <span data-ttu-id="78447-115">Los filtros sintonizador de TV, audio de TV, Cruz de vídeo analógico y KsProxy admiten propiedades de controlador personalizadas a través de la interfaz [**IKsPropertySet**](ikspropertyset.md) .</span><span class="sxs-lookup"><span data-stu-id="78447-115">The TV Tuner, TV Audio, Analog Video Crossbar, and KsProxy filters support custom driver properties through the [**IKsPropertySet**](ikspropertyset.md) interface.</span></span> <span data-ttu-id="78447-116">El filtro de captura VFW y el filtro de captura de audio no se pueden extender de esta manera.</span><span class="sxs-lookup"><span data-stu-id="78447-116">The VFW Capture filter and the Audio Capture filter are not extensible in this way.</span></span>

<span data-ttu-id="78447-117">En el caso de los desarrolladores de aplicaciones, los filtros de contenedor permiten a la aplicación controlar los dispositivos de la misma forma que controlan cualquier otro filtro de DirectShow.</span><span class="sxs-lookup"><span data-stu-id="78447-117">For application developers, wrapper filters enable the application to control devices just as they control any other DirectShow filter.</span></span> <span data-ttu-id="78447-118">No se requiere ninguna programación especial; los detalles de la comunicación con el dispositivo de modo kernel se encapsulan dentro del filtro.</span><span class="sxs-lookup"><span data-stu-id="78447-118">No special programming is required; the details of communicating with the kernel-mode device are encapsulated within the filter.</span></span>

<span data-ttu-id="78447-119">**Vídeo para dispositivos Windows**</span><span class="sxs-lookup"><span data-stu-id="78447-119">**Video for Windows Devices**</span></span>

<span data-ttu-id="78447-120">El filtro de captura VFW admite tarjetas de captura de vídeo para Windows (VfW) anteriores.</span><span class="sxs-lookup"><span data-stu-id="78447-120">The VFW Capture filter supports earlier Video for Windows (VfW) capture cards.</span></span> <span data-ttu-id="78447-121">Cuando una tarjeta VfW está presente en el sistema de destino, se puede detectar y agregar al gráfico de filtros mediante el [enumerador de dispositivos del sistema](system-device-enumerator.md)DirectShow.</span><span class="sxs-lookup"><span data-stu-id="78447-121">When a VfW card is present on the target system, it can be discovered and added to the filter graph using the DirectShow [System Device Enumerator](system-device-enumerator.md).</span></span> <span data-ttu-id="78447-122">Para obtener más información, consulte [enumeración de dispositivos y filtros](enumerating-devices-and-filters.md).</span><span class="sxs-lookup"><span data-stu-id="78447-122">For details, see [Enumerating Devices and Filters](enumerating-devices-and-filters.md).</span></span>

<span data-ttu-id="78447-123">**Dispositivos de captura y mezcla de audio (tarjetas de sonido)**</span><span class="sxs-lookup"><span data-stu-id="78447-123">**Audio Capture and Mixing Devices (Sound Cards)**</span></span>

<span data-ttu-id="78447-124">Las tarjetas de sonido más recientes tienen conectores de entrada para los micrófonos y otros tipos de dispositivos.</span><span class="sxs-lookup"><span data-stu-id="78447-124">Newer sound cards have input jacks for microphones and other types of devices.</span></span> <span data-ttu-id="78447-125">Normalmente, estas tarjetas también tienen capacidades de combinación incorporada para controlar el volumen, el agudo y el bajo de cada entrada individual.</span><span class="sxs-lookup"><span data-stu-id="78447-125">Typically these cards also have on-board mixing capabilities for controlling the volume, treble, and bass of each individual input.</span></span> <span data-ttu-id="78447-126">En DirectShow, el filtro de captura de audio encapsula las entradas y el mezclador de la tarjeta de sonido.</span><span class="sxs-lookup"><span data-stu-id="78447-126">In DirectShow, the sound card's inputs and mixer are wrapped by the Audio Capture filter.</span></span> <span data-ttu-id="78447-127">Cada tarjeta de sonido se puede detectar con el enumerador de dispositivos del sistema.</span><span class="sxs-lookup"><span data-stu-id="78447-127">Each sound card can be discovered with the System Device Enumerator.</span></span> <span data-ttu-id="78447-128">Para ver las tarjetas de sonido del sistema, ejecute GraphEdit y seleccione en la categoría orígenes de captura de audio.</span><span class="sxs-lookup"><span data-stu-id="78447-128">To view the sound cards in your system, run GraphEdit and select from the Audio Capture Sources category.</span></span> <span data-ttu-id="78447-129">Cada filtro de esa categoría es una instancia independiente del filtro de captura de audio.</span><span class="sxs-lookup"><span data-stu-id="78447-129">Each filter in that category is a separate instance of the Audio Capture filter.</span></span> <span data-ttu-id="78447-130">(Consulte [uso de GraphEdit](using-graphedit.md)).</span><span class="sxs-lookup"><span data-stu-id="78447-130">(See [Using GraphEdit](using-graphedit.md).)</span></span>

<span data-ttu-id="78447-131">**Dispositivos WDM streaming**</span><span class="sxs-lookup"><span data-stu-id="78447-131">**WDM Streaming Devices**</span></span>

<span data-ttu-id="78447-132">Los descodificadores de hardware y las tarjetas de captura más recientes se ajustan a la Especificación Modelo de controlador de Windows (WDM).</span><span class="sxs-lookup"><span data-stu-id="78447-132">Newer hardware decoders and capture cards conform to the Windows Driver Model (WDM) specification.</span></span> <span data-ttu-id="78447-133">Estos dispositivos tienen una mayor funcionalidad que los dispositivos VfW.</span><span class="sxs-lookup"><span data-stu-id="78447-133">These devices have greater functionality than VfW devices.</span></span> <span data-ttu-id="78447-134">Las tarjetas de captura de vídeo WDM pueden admitir características que no están disponibles en VfW, incluida la enumeración de formatos de captura, el control de los parámetros de vídeo, como matiz y brillo, selección de entrada mediante programación y compatibilidad con sintonizador de TV.</span><span class="sxs-lookup"><span data-stu-id="78447-134">WDM video capture cards can support features that are not available under VfW, including the enumeration of capture formats, programmatic control of video parameters such as hue and brightness, programmatic input selection, and TV Tuner support.</span></span>

<span data-ttu-id="78447-135">Para admitir dispositivos de transmisión por secuencias WDM, DirectShow proporciona el filtro KsProxy (ksproxy.ax).</span><span class="sxs-lookup"><span data-stu-id="78447-135">To support WDM streaming devices, DirectShow provides the KsProxy filter (ksproxy.ax).</span></span> <span data-ttu-id="78447-136">KsProxy se ha denominado "filtro de cuchilla de ejército de Suiza" porque hace muchas cosas diferentes.</span><span class="sxs-lookup"><span data-stu-id="78447-136">KsProxy has been called the "Swiss Army Knife filter" because it does so many different things.</span></span> <span data-ttu-id="78447-137">El número de PIN en el filtro y el número de interfaces COM que expone el filtro dependen de las capacidades del controlador subyacente.</span><span class="sxs-lookup"><span data-stu-id="78447-137">The number of pins on the filter, and the number of COM interfaces exposed by the filter, depend on the capabilities of the underlying driver.</span></span> <span data-ttu-id="78447-138">KsProxy no aparece en el gráfico de filtros bajo el nombre "KsProxy".</span><span class="sxs-lookup"><span data-stu-id="78447-138">KsProxy does not appear in the filter graph under the name "KsProxy."</span></span> <span data-ttu-id="78447-139">Siempre toma el nombre descriptivo del dispositivo, que se encuentra en el registro.</span><span class="sxs-lookup"><span data-stu-id="78447-139">It always takes the friendly name of the device, which is found in the registry.</span></span> <span data-ttu-id="78447-140">Para ver los dispositivos WDM del sistema, ejecute GraphEdit y seleccione una de las categorías de transmisión por secuencias WDM.</span><span class="sxs-lookup"><span data-stu-id="78447-140">To view the WDM devices on your system, run GraphEdit and select from the WDM Streaming categories.</span></span> <span data-ttu-id="78447-141">Incluso si solo tiene una tarjeta WDM en el sistema, esa tarjeta podría contener más de un dispositivo.</span><span class="sxs-lookup"><span data-stu-id="78447-141">Even if you have only one WDM card on your system, that card might contain more than one device.</span></span> <span data-ttu-id="78447-142">Cada dispositivo se representa como un filtro independiente, y cada uno de estos filtros es realmente KsProxy.</span><span class="sxs-lookup"><span data-stu-id="78447-142">Each device is represented as a separate filter, and each of these filters is actually KsProxy.</span></span>

<span data-ttu-id="78447-143">Una aplicación utiliza el enumerador de dispositivos del sistema para buscar monikers de dispositivo WDM en el sistema.</span><span class="sxs-lookup"><span data-stu-id="78447-143">An application uses the System Device Enumerator to find WDM device monikers on the system.</span></span> <span data-ttu-id="78447-144">Se crea una instancia de KsProxy mediante una llamada a **BindToObject** en el moniker.</span><span class="sxs-lookup"><span data-stu-id="78447-144">KsProxy is instantiated by calling **BindToObject** on the moniker.</span></span> <span data-ttu-id="78447-145">Dado que KsProxy puede representar todos los tipos de dispositivos WDM, debe consultar el controlador para determinar qué propiedad permite establecer el controlador.</span><span class="sxs-lookup"><span data-stu-id="78447-145">Because KsProxy can represent all kinds of WDM devices, it must query the driver to determine which property sets the driver supports.</span></span> <span data-ttu-id="78447-146">Los conjuntos de propiedades son colecciones de estructuras de datos usadas por los controladores WDM y también por algunos filtros de modo de usuario, como descodificadores de software MPEG-2.</span><span class="sxs-lookup"><span data-stu-id="78447-146">Property sets are collections of data structures used by WDM drivers, and also by some user mode filters, such as MPEG-2 software decoders.</span></span> <span data-ttu-id="78447-147">KsProxy se configura para exponer las interfaces COM que corresponden a esos conjuntos de propiedades.</span><span class="sxs-lookup"><span data-stu-id="78447-147">KsProxy configures itself to expose the COM interfaces that correspond to those property sets.</span></span> <span data-ttu-id="78447-148">KsProxy traduce las llamadas a métodos COM en conjuntos de propiedades y las envía al controlador.</span><span class="sxs-lookup"><span data-stu-id="78447-148">KsProxy translates the COM method calls into property sets and sends these to the driver.</span></span> <span data-ttu-id="78447-149">Los proveedores de hardware pueden extender KsProxy mediante el suministro de complementos, que son interfaces específicas del proveedor que exponen las capacidades especiales de un dispositivo.</span><span class="sxs-lookup"><span data-stu-id="78447-149">Hardware vendors can extend KsProxy by supplying plug-ins, which are vendor-specific interfaces that expose the special capabilities of a device.</span></span> <span data-ttu-id="78447-150">Todos estos detalles están ocultos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="78447-150">All these details are hidden from application.</span></span> <span data-ttu-id="78447-151">La aplicación controla el dispositivo por medio de KsProxy, de la misma forma que cualquier otro filtro de DirectShow.</span><span class="sxs-lookup"><span data-stu-id="78447-151">The application controls the device by way of KsProxy, in the same way as any other DirectShow filter.</span></span>

<span data-ttu-id="78447-152">**Streaming de kernel**</span><span class="sxs-lookup"><span data-stu-id="78447-152">**Kernel Streaming**</span></span>

<span data-ttu-id="78447-153">Los dispositivos WDM admiten el streaming de kernel, en el que los datos se transmiten por completo en modo kernel sin cambiar al modo de usuario.</span><span class="sxs-lookup"><span data-stu-id="78447-153">WDM devices support kernel streaming, in which data is streamed entirely in kernel mode without ever switching to user mode.</span></span> <span data-ttu-id="78447-154">Cambiar entre el modo kernel y el modo de usuario es costoso. el streaming de kernel permite velocidades de bits altas sin sobrecargar la CPU del host.</span><span class="sxs-lookup"><span data-stu-id="78447-154">Switching between kernel mode and user mode is computationally expensive; kernel streaming allows for high bit rates without burdening the host CPU.</span></span> <span data-ttu-id="78447-155">Los filtros basados en WDM pueden usar el streaming de kernel para pasar datos multimedia directamente de un dispositivo de hardware a otro, en la misma tarjeta o en una tarjeta diferente, sin copiar los datos en la memoria principal del sistema.</span><span class="sxs-lookup"><span data-stu-id="78447-155">WDM-based filters can use kernel streaming to pass multimedia data directly from one hardware device to another, either on the same card or on a different card, without copying the data into the system's main memory.</span></span>

<span data-ttu-id="78447-156">Desde el punto de vista de una aplicación, aparece como si los datos se mueven de un filtro de modo de usuario al siguiente.</span><span class="sxs-lookup"><span data-stu-id="78447-156">From an application's point of view, it appears as if the data moves from one user-mode filter to the next.</span></span> <span data-ttu-id="78447-157">En realidad, los datos podrían no pasar nunca al modo de usuario, pero en su lugar podrían transmitirse directamente desde un dispositivo de modo kernel a otro hasta que se represente en la tarjeta gráfica de vídeo.</span><span class="sxs-lookup"><span data-stu-id="78447-157">In reality, the data might never pass into user mode at all, but instead might be streamed directly from one kernel-mode device to another until it is rendered on the video graphics card.</span></span> <span data-ttu-id="78447-158">Algunos escenarios, como la captura en un archivo, requieren que los datos pasen del modo kernel al modo de usuario en algún momento.</span><span class="sxs-lookup"><span data-stu-id="78447-158">Some scenarios, such as capture to a file, require that the data pass from kernel mode to user mode at some point.</span></span> <span data-ttu-id="78447-159">Sin embargo, este modificador no requiere necesariamente que los datos se copien en una nueva ubicación en la memoria.</span><span class="sxs-lookup"><span data-stu-id="78447-159">However, this switch does not necessarily require the data to be copied to a new location in memory.</span></span>

<span data-ttu-id="78447-160">Por lo general, los desarrolladores de aplicaciones no necesitan preocuparse por los detalles de la transmisión por secuencias del kernel, excepto como información general.</span><span class="sxs-lookup"><span data-stu-id="78447-160">Application developers generally do not need to be concerned with the details of kernel streaming, except as background information.</span></span> <span data-ttu-id="78447-161">Vea el DDK de Microsoft para obtener información más detallada sobre WDM, streaming de kernel, KsProxy y temas relacionados.</span><span class="sxs-lookup"><span data-stu-id="78447-161">See the Microsoft DDK for more detailed information about WDM, kernel streaming, KsProxy, and related topics.</span></span>

## <a name="related-topics"></a><span data-ttu-id="78447-162">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="78447-162">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="78447-163">El gráfico de filtro y sus componentes</span><span class="sxs-lookup"><span data-stu-id="78447-163">The Filter Graph and Its Components</span></span>](the-filter-graph-and-its-components.md)
</dt> </dl>

 

 



