---
description: Negociación de tipo de medio en el codificador
ms.assetid: c8ae543e-68f7-4c74-9cb7-2a200bd51820
title: Negociación de tipo de medio en el codificador
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c7845e9d50c5d418198dc0e08313e2e9329ffab8
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/03/2021
ms.locfileid: "104003424"
---
# <a name="media-type-negotiation-on-the-encoder"></a><span data-ttu-id="ce31d-103">Negociación de tipo de medio en el codificador</span><span class="sxs-lookup"><span data-stu-id="ce31d-103">Media Type Negotiation on the Encoder</span></span>

<span data-ttu-id="ce31d-104">En Microsoft Media Foundation, los codificadores se implementan como [transformaciones Media Foundation](media-foundation-transforms.md) (MFTs) con una entrada y una salida.</span><span class="sxs-lookup"><span data-stu-id="ce31d-104">In Microsoft Media Foundation, encoders are implemented as [Media Foundation transforms](media-foundation-transforms.md) (MFTs) with one input and one output.</span></span> <span data-ttu-id="ce31d-105">Antes de una sesión de codificación, un codificador debe conocer las características de la secuencia que recibirá como entrada y el formato de la secuencia que generará como salida.</span><span class="sxs-lookup"><span data-stu-id="ce31d-105">Before an encoding session, an encoder needs to know the characteristics of the stream it will receive as input and the format of the stream it will produce as output.</span></span> <span data-ttu-id="ce31d-106">Debe establecer los tipos de medios de entrada y salida, así como las características relacionadas, antes de pasar los datos a través del codificador.</span><span class="sxs-lookup"><span data-stu-id="ce31d-106">You must set the input and output media types and related characteristics before you pass data through the encoder.</span></span> <span data-ttu-id="ce31d-107">Debe proporcionar los formatos de entrada y salida especificando los GUID de [tipo de medio](media-type-guids.md) adecuados y estableciendo las características del flujo de salida mediante el establecimiento de los [atributos de tipo de medio](media-type-attributes.md) correspondientes en el tipo de medio de salida.</span><span class="sxs-lookup"><span data-stu-id="ce31d-107">You must supply the input and output formats by specifying the appropriate [Media Type GUIDs](media-type-guids.md) and set the characteristics of the output stream by setting the relevant [Media Type Attributes](media-type-attributes.md) on the output media type.</span></span> <span data-ttu-id="ce31d-108">Un codificador con una instancia recién creada no tiene ningún tipo de medio establecido.</span><span class="sxs-lookup"><span data-stu-id="ce31d-108">A newly instantiated encoder does not have any set media types.</span></span>

<span data-ttu-id="ce31d-109">El tipo de medio de entrada es un formato sin comprimir, como audio PCM o vídeo RGB.</span><span class="sxs-lookup"><span data-stu-id="ce31d-109">The input media type is an uncompressed format, such as PCM audio or RGB video.</span></span> <span data-ttu-id="ce31d-110">Los tipos de formato que utiliza el codificador se limitan a los descritos por las estructuras **VIDEOINFOHEADER** y **WAVEFORMATEX** .</span><span class="sxs-lookup"><span data-stu-id="ce31d-110">The format types that are used by the encoder are limited to those described by the **VIDEOINFOHEADER** and **WAVEFORMATEX** structures.</span></span> <span data-ttu-id="ce31d-111">Para obtener más información acerca de estas estructuras, vea la documentación de Windows SDK. Media Foundation proporciona funciones auxiliares para crear tipos de medios a partir de estructuras de formato.</span><span class="sxs-lookup"><span data-stu-id="ce31d-111">For more information about these structures, see the Windows SDK documentation.Media foundation provides helper functions to create media types from format structures.</span></span> <span data-ttu-id="ce31d-112">Por ejemplo, la función [**MFInitMediaTypeFromVideoInfoHeader**](/windows/desktop/api/mfapi/nf-mfapi-mfinitmediatypefromvideoinfoheader) Inicializa un tipo de vídeo a partir de una estructura **VIDEOINFOHEADER** , y la función [**MFInitMediaTypeFromWaveFormatEx**](/windows/desktop/api/mfapi/nf-mfapi-mfinitmediatypefromwaveformatex) Inicializa un tipo de vídeo a partir de una estructura **WAVEFORMATEX** o **WAVEFORMATEXTENSIBLE** .</span><span class="sxs-lookup"><span data-stu-id="ce31d-112">For example, the [**MFInitMediaTypeFromVideoInfoHeader**](/windows/desktop/api/mfapi/nf-mfapi-mfinitmediatypefromvideoinfoheader) function initializes a video type from a **VIDEOINFOHEADER** structure, and the [**MFInitMediaTypeFromWaveFormatEx**](/windows/desktop/api/mfapi/nf-mfapi-mfinitmediatypefromwaveformatex) function initializes a video type from a **WAVEFORMATEX** or **WAVEFORMATEXTENSIBLE** structure.</span></span> <span data-ttu-id="ce31d-113">Para obtener más información, vea [conversiones de tipo de medio](media-type-conversions.md).</span><span class="sxs-lookup"><span data-stu-id="ce31d-113">For more information, see [Media Type Conversions](media-type-conversions.md).</span></span> <span data-ttu-id="ce31d-114">Debe establecer el tipo de medio de entrada en el codificador llamando a [**IMFTransform:: SetInputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setinputtype).</span><span class="sxs-lookup"><span data-stu-id="ce31d-114">You must set the input media type on the encoder by calling [**IMFTransform::SetInputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setinputtype).</span></span>

<span data-ttu-id="ce31d-115">El tipo de medio de salida es el formato de compresión utilizado en la secuencia o el archivo de origen final.</span><span class="sxs-lookup"><span data-stu-id="ce31d-115">The output media type is the compression format used in the final source stream or file.</span></span> <span data-ttu-id="ce31d-116">Solo puede establecer el tipo de medio de salida disponible después de establecer el tipo de medio de entrada.</span><span class="sxs-lookup"><span data-stu-id="ce31d-116">You can set the available output media type only after setting the input media type.</span></span> <span data-ttu-id="ce31d-117">Puede recuperar los tipos de salida admitidos llamando a [**IMFTransform:: GetOutputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputavailabletype) en un bucle hasta que el codificador devuelva **MF \_ E \_ ningún \_ \_ tipo más**.</span><span class="sxs-lookup"><span data-stu-id="ce31d-117">You can retrieve the supported output types by calling [**IMFTransform::GetOutputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputavailabletype) in a loop until the encoder returns **MF\_E\_NO\_MORE\_TYPES**.</span></span> <span data-ttu-id="ce31d-118">Incremente el índice de tipo con cada iteración.</span><span class="sxs-lookup"><span data-stu-id="ce31d-118">Increment the type index with each iteration.</span></span> <span data-ttu-id="ce31d-119">Cuando encuentre un tipo de medio adecuado, establezca el tipo de medio de salida llamando a [**IMFTransform:: SetOutputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setoutputtype).</span><span class="sxs-lookup"><span data-stu-id="ce31d-119">When you find an appropriate media type, set the output media type by calling [**IMFTransform::SetOutputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setoutputtype).</span></span>

<span data-ttu-id="ce31d-120">El factor de decisión a la hora de elegir el tipo de medio de salida depende del tipo de codificación y de los requisitos de codificación.</span><span class="sxs-lookup"><span data-stu-id="ce31d-120">The deciding factor in choosing the output media type depends on the type of encoding and your encoding requirements.</span></span> <span data-ttu-id="ce31d-121">Por ejemplo, en el caso de las secuencias de audio con codificación CBR, desea encontrar un tipo de medio que coincida con la entrada y que tenga una velocidad de bits lo más cercana posible a un valor de destino.</span><span class="sxs-lookup"><span data-stu-id="ce31d-121">For example, for audio streams that are CBR-encoded, you want to find a media type that matches your input and has a bit rate that is as close as possible to a target value.</span></span>

<span data-ttu-id="ce31d-122">Si desea utilizar un modo de codificación distinto de CBR, debe establecer el modo y, a continuación, enumerar los tipos de salida para ese modo, porque el codificador cambia los tipos de salida admitidos en función del conjunto de modos.</span><span class="sxs-lookup"><span data-stu-id="ce31d-122">If you want to use an encoding mode other than CBR, you must set the mode and then enumerate the output types for that mode, because the encoder changes the supported output types depending upon the mode set.</span></span> <span data-ttu-id="ce31d-123">Las propiedades que controlan el modo de codificación son [**MFPKEY \_ VBRENABLED**](mfpkey-vbrenabledproperty.md) y [**MFPKEY \_ PASSESUSED**](mfpkey-passesusedproperty.md).</span><span class="sxs-lookup"><span data-stu-id="ce31d-123">The properties that control the encoding mode are [**MFPKEY\_VBRENABLED**](mfpkey-vbrenabledproperty.md) and [**MFPKEY\_PASSESUSED**](mfpkey-passesusedproperty.md).</span></span> <span data-ttu-id="ce31d-124">Por ejemplo, si se enumeran los tipos de salida para la codificación de calidad VBR, el tipo de medio depende del valor de calidad que decida usar.</span><span class="sxs-lookup"><span data-stu-id="ce31d-124">For example, if you are enumerating output types for VBR-quality encoding, the media type depends on the quality value you decide to use.</span></span> <span data-ttu-id="ce31d-125">Para obtener información sobre cómo establecer estas propiedades, consulte [propiedades de codificación](configuring-the-encoder.md).</span><span class="sxs-lookup"><span data-stu-id="ce31d-125">For information about setting these properties, see [Encoding Properties](configuring-the-encoder.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="ce31d-126">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="ce31d-126">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ce31d-127">Crear instancias de una MFT del codificador</span><span class="sxs-lookup"><span data-stu-id="ce31d-127">Instantiating an Encoder MFT</span></span>](instantiating-the-encoder-mft.md)
</dt> <dt>

[<span data-ttu-id="ce31d-128">Codificadores de Windows Media</span><span class="sxs-lookup"><span data-stu-id="ce31d-128">Windows Media Encoders</span></span>](windows-media-encoders.md)
</dt> </dl>

 

 



