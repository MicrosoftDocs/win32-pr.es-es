---
title: Desarrollo de complementos de IFilter
description: Puede extender la búsqueda de escritorio de Microsoft Windows (WDS) con complementos de filtro, componentes que implementan IFilterinterface, para incluir nuevos tipos de archivo.
ms.assetid: 71dd515d-a73e-4e0a-b0da-c8a6209d09fe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 79f846cf2101eefc17b1e92fbd7992529a06fb43
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/19/2020
ms.locfileid: "104487675"
---
# <a name="developing-ifilter-add-ins"></a><span data-ttu-id="15b01-103">Desarrollo de complementos de IFilter</span><span class="sxs-lookup"><span data-stu-id="15b01-103">Developing IFilter Add-ins</span></span>

> [!NOTE]
> <span data-ttu-id="15b01-104">Windows Desktop Search 2. x es una tecnología obsoleta que estaba disponible originalmente como complemento para Windows XP y Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="15b01-104">Windows Desktop Search 2.x is an obsolete technology that was originally available as an add-in for Windows XP and Windows Server 2003.</span></span> <span data-ttu-id="15b01-105">En versiones posteriores, use la [búsqueda de Windows](../search/-search-3x-wds-overview.md) en su lugar.</span><span class="sxs-lookup"><span data-stu-id="15b01-105">On later releases, use [Windows Search](../search/-search-3x-wds-overview.md) instead.</span></span>

<span data-ttu-id="15b01-106">Puede extender la búsqueda de escritorio de Microsoft Windows (WDS) con complementos de filtro, componentes que implementan la interfaz [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter), para incluir nuevos tipos de archivo.</span><span class="sxs-lookup"><span data-stu-id="15b01-106">You can extend Microsoft Windows Desktop Search (WDS) with filter add-ins, components that implement the [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)interface, to include new file types.</span></span> <span data-ttu-id="15b01-107">Los filtros son responsables de obtener acceso a los datos y analizarlos en archivos y de devolver pares de propiedades y valores, así como fragmentos de texto para la indización.</span><span class="sxs-lookup"><span data-stu-id="15b01-107">Filters are responsible for accessing and parsing data in files and for returning pairs of properties and values as well as chunks of text for indexing.</span></span> <span data-ttu-id="15b01-108">Durante el proceso de indexación, WDS llama al filtro apropiado con la dirección URL de cada archivo o elemento.</span><span class="sxs-lookup"><span data-stu-id="15b01-108">During the indexing process, WDS calls the appropriate filter with the URL for each file or item.</span></span> <span data-ttu-id="15b01-109">En primer lugar, el filtro extrae los metadatos que corresponden a las propiedades que están marcadas como recuperables en el esquema de WDS, como el título, el tamaño del archivo y la fecha de la última modificación.</span><span class="sxs-lookup"><span data-stu-id="15b01-109">The filter first extracts metadata that corresponds to properties that are marked retrievable in the WDS schema, such as title, file size, and last modified date.</span></span> <span data-ttu-id="15b01-110">A continuación, divide el contenido del elemento en fragmentos de texto.</span><span class="sxs-lookup"><span data-stu-id="15b01-110">Then it breaks the item content into chunks of text.</span></span> <span data-ttu-id="15b01-111">WDS agrega las propiedades y el texto devueltos por el filtro al catálogo.</span><span class="sxs-lookup"><span data-stu-id="15b01-111">WDS adds the properties and text returned by the filter to the catalog.</span></span> <span data-ttu-id="15b01-112">WDS puede indexar cualquier tipo de archivo para el que tenga un filtro registrado.</span><span class="sxs-lookup"><span data-stu-id="15b01-112">WDS can index any file type for which it has a registered filter.</span></span>

<span data-ttu-id="15b01-113">En algunas circunstancias, no es necesario escribir un nuevo filtro.</span><span class="sxs-lookup"><span data-stu-id="15b01-113">In some circumstances, you do not need to write a new filter.</span></span> <span data-ttu-id="15b01-114">WDS 2. x contiene filtros para más de 200 tipos de elementos (incluidos los elementos de texto no cifrado, como HTML, XML y archivos de código fuente) y usa la misma tecnología de [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)que SharePoint Services.</span><span class="sxs-lookup"><span data-stu-id="15b01-114">WDS 2.x contains filters for over 200 types of items (including plaintext items such as HTML, XML, and source code files) and uses the same [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)technology as SharePoint Services.</span></span> <span data-ttu-id="15b01-115">Si ya tiene filtros instalados para los tipos de archivo, WDS puede usar esos filtros existentes para indizar estos datos.</span><span class="sxs-lookup"><span data-stu-id="15b01-115">If you already have filters installed for your file types, WDS can use those existing filters to index this data.</span></span> <span data-ttu-id="15b01-116">Además, WDS incluye un filtro general para los tipos de archivo que se basan en texto sin formato.</span><span class="sxs-lookup"><span data-stu-id="15b01-116">Furthermore, WDS includes a general filter for file types that are plaintext-based.</span></span> <span data-ttu-id="15b01-117">Si tiene un tipo de archivo que puede ser procesado por un filtro de SharePoint Services existente o por el filtro de texto sin formato, puede Agregar la extensión de nombre de archivo y el GUID del filtro al registro para que WDS pueda ubicarlo y usarlo (vea [para registrar un complemento de filtro](#to-register-a-filter-add-in) para obtener más información).</span><span class="sxs-lookup"><span data-stu-id="15b01-117">If you have a file type that can be processed by either an existing SharePoint Services filter or the plaintext filter, you can add the file name extension and filter GUID to the Registry so WDS can locate and use it (see [To Register a Filter Add-in](#to-register-a-filter-add-in) for more information).</span></span>

<span data-ttu-id="15b01-118">Sin embargo, si tiene un formato de archivo o datos de texto no cifrado, escribir una implementación de filtro personalizada es la única manera de asegurarse de que WDS puede indizar el formato de archivo en el catálogo.</span><span class="sxs-lookup"><span data-stu-id="15b01-118">If, however, you have a non-plaintext and proprietary data or file format, writing a custom filter implementation is the only way to ensure WDS can index the file format in the catalog.</span></span> <span data-ttu-id="15b01-119">Solo puede tener un complemento de filtro para un tipo de archivo, por lo que es posible invalidar un filtro existente o hacer que otro filtro invalide el suyo para un tipo de archivo específico.</span><span class="sxs-lookup"><span data-stu-id="15b01-119">You can have only one filter add-in for a file type, so it is possible to override an existing filter or to have another filter override yours for a specific file type.</span></span>

<span data-ttu-id="15b01-120">Esta sección contiene los siguientes temas:</span><span class="sxs-lookup"><span data-stu-id="15b01-120">This section contains the following topics:</span></span>

-   [<span data-ttu-id="15b01-121">Interfaces de filtro requeridas</span><span class="sxs-lookup"><span data-stu-id="15b01-121">Required Filter Interfaces</span></span>](#required-filter-interfaces)
    -   [<span data-ttu-id="15b01-122">Interfaz IFilter</span><span class="sxs-lookup"><span data-stu-id="15b01-122">IFilter Interface</span></span>](#ifilter-interface)
    -   [<span data-ttu-id="15b01-123">IPersistStream</span><span class="sxs-lookup"><span data-stu-id="15b01-123">IPersistStream</span></span>](#ipersiststream)
    -   [<span data-ttu-id="15b01-124">IPersistFile</span><span class="sxs-lookup"><span data-stu-id="15b01-124">IPersistFile</span></span>](#ipersistfile)
    -   [<span data-ttu-id="15b01-125">IPersistStorage</span><span class="sxs-lookup"><span data-stu-id="15b01-125">IPersistStorage</span></span>](#ipersiststorage)
-   [<span data-ttu-id="15b01-126">Salida de propiedades con filtros</span><span class="sxs-lookup"><span data-stu-id="15b01-126">Outputting Properties with Filters</span></span>](#outputting-properties-with-filters)
    -   [<span data-ttu-id="15b01-127">Valores de propiedad</span><span class="sxs-lookup"><span data-stu-id="15b01-127">Property Values</span></span>](#property-values)
-   [<span data-ttu-id="15b01-128">Instalación del complemento de filtro</span><span class="sxs-lookup"><span data-stu-id="15b01-128">Filter Add-in Installation</span></span>](#filter-add-in-installation)
    -   [<span data-ttu-id="15b01-129">CLSID necesarios para el registro</span><span class="sxs-lookup"><span data-stu-id="15b01-129">CLSIDs Required for Registration</span></span>](#clsids-required-for-registration)
    -   [<span data-ttu-id="15b01-130">Modelo de registro</span><span class="sxs-lookup"><span data-stu-id="15b01-130">Registration Model</span></span>](#registration-model)
    -   [<span data-ttu-id="15b01-131">Para registrar un complemento de filtro</span><span class="sxs-lookup"><span data-stu-id="15b01-131">To Register a Filter Add-in</span></span>](#to-register-a-filter-add-in)
-   [<span data-ttu-id="15b01-132">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="15b01-132">Related topics</span></span>](#related-topics)

## <a name="required-filter-interfaces"></a><span data-ttu-id="15b01-133">Interfaces de filtro requeridas</span><span class="sxs-lookup"><span data-stu-id="15b01-133">Required Filter Interfaces</span></span>

<span data-ttu-id="15b01-134">Un complemento de filtro debe implementar la interfaz de [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)y una de las interfaces siguientes:</span><span class="sxs-lookup"><span data-stu-id="15b01-134">A filter add-in must implement the [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)interface and one of the following interfaces:</span></span>

-   <span data-ttu-id="15b01-135">[IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) : para cargar datos de una secuencia.</span><span class="sxs-lookup"><span data-stu-id="15b01-135">[IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) - To load data from a stream.</span></span> <span data-ttu-id="15b01-136">Esto es más seguro que el uso de archivos porque no se escribe nada en el disco.</span><span class="sxs-lookup"><span data-stu-id="15b01-136">This is more secure than using files because nothing is written to disk.</span></span> <span data-ttu-id="15b01-137">La interfaz IPersistStream es el método preferido para la compatibilidad con versiones posteriores con Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="15b01-137">The IPersistStream interface is the preferred method for forward compatibility with Windows Vista.</span></span>
-   <span data-ttu-id="15b01-138">[IPersistFile (interfaz](/windows/win32/api/objidl/nn-objidl-ipersistfile) ): para cargar datos de un archivo.</span><span class="sxs-lookup"><span data-stu-id="15b01-138">[IPersistFile Interface](/windows/win32/api/objidl/nn-objidl-ipersistfile) - To load data from a file.</span></span> <span data-ttu-id="15b01-139">Esta interfaz no es compatible con Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="15b01-139">This interface is not supported in Windows Vista.</span></span>
-   <span data-ttu-id="15b01-140">[Interfaz IPersistStorage](/windows/win32/api/objidl/nn-objidl-ipersiststorage) : para cargar datos desde un almacenamiento estructurado OLE com.</span><span class="sxs-lookup"><span data-stu-id="15b01-140">[IPersistStorage Interface](/windows/win32/api/objidl/nn-objidl-ipersiststorage) - To load data from an OLE COM Structured Storage.</span></span>

<span data-ttu-id="15b01-141">Un complemento de filtro utiliza estas interfaces para obtener el contenido del elemento y devolverlos de forma iterativa al índice hasta que se alcanza el final del archivo.</span><span class="sxs-lookup"><span data-stu-id="15b01-141">A filter add-in uses these interfaces to get the contents of the item and return them iteratively to the index until the end of the file is reached.</span></span> <span data-ttu-id="15b01-142">Un complemento de filtro debe ser lo más robusto posible para administrar archivos dañados y los que no cumplen los formatos de entrada esperados.</span><span class="sxs-lookup"><span data-stu-id="15b01-142">A filter add-in should be as robust as possible to handle corrupt files and those that do not meet expected input formats.</span></span>

### <a name="ifilter-interface"></a><span data-ttu-id="15b01-143">Interfaz IFilter</span><span class="sxs-lookup"><span data-stu-id="15b01-143">IFilter Interface</span></span>

<span data-ttu-id="15b01-144">Se trata de una interfaz necesaria para una implementación de filtro.</span><span class="sxs-lookup"><span data-stu-id="15b01-144">This is a required interface for a filter implementation.</span></span> <span data-ttu-id="15b01-145">Para obtener más información, consulte la referencia de la interfaz de [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter).</span><span class="sxs-lookup"><span data-stu-id="15b01-145">For more information, see the [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)interface reference.</span></span>



| <span data-ttu-id="15b01-146">Método</span><span class="sxs-lookup"><span data-stu-id="15b01-146">Method</span></span>       | <span data-ttu-id="15b01-147">Descripción</span><span class="sxs-lookup"><span data-stu-id="15b01-147">Description</span></span>                                                                            |
|--------------|----------------------------------------------------------------------------------------|
| <span data-ttu-id="15b01-148">Init ()</span><span class="sxs-lookup"><span data-stu-id="15b01-148">Init()</span></span>       | <span data-ttu-id="15b01-149">Inicializa una sesión de filtrado.</span><span class="sxs-lookup"><span data-stu-id="15b01-149">Initializes a filtering session.</span></span>                                                       |
| <span data-ttu-id="15b01-150">GetChunk ()</span><span class="sxs-lookup"><span data-stu-id="15b01-150">GetChunk()</span></span>   | <span data-ttu-id="15b01-151">Coloca el filtro al principio del primer fragmento o siguiente y devuelve un descriptor.</span><span class="sxs-lookup"><span data-stu-id="15b01-151">Positions the filter at the beginning of first or next chunk and returns a descriptor.</span></span> |
| <span data-ttu-id="15b01-152">GetText ()</span><span class="sxs-lookup"><span data-stu-id="15b01-152">GetText()</span></span>    | <span data-ttu-id="15b01-153">Recupera texto del fragmento actual.</span><span class="sxs-lookup"><span data-stu-id="15b01-153">Retrieves text from the current chunk.</span></span>                                                 |
| <span data-ttu-id="15b01-154">GetValue()</span><span class="sxs-lookup"><span data-stu-id="15b01-154">GetValue()</span></span>   | <span data-ttu-id="15b01-155">Recupera los valores de propiedad del fragmento actual.</span><span class="sxs-lookup"><span data-stu-id="15b01-155">Retrieves property values from the current chunk.</span></span>                                      |
| <span data-ttu-id="15b01-156">BindRegion()</span><span class="sxs-lookup"><span data-stu-id="15b01-156">BindRegion()</span></span> | <span data-ttu-id="15b01-157">Está reservado actualmente para uso interno; No implemente.</span><span class="sxs-lookup"><span data-stu-id="15b01-157">Currently reserved for internal use; do not implement.</span></span> <span data-ttu-id="15b01-158">Este método devuelve E \_ NOTIMPL.</span><span class="sxs-lookup"><span data-stu-id="15b01-158">This method returns E\_NOTIMPL.</span></span> |



 

### <a name="ipersiststream"></a><span data-ttu-id="15b01-159">IPersistStream</span><span class="sxs-lookup"><span data-stu-id="15b01-159">IPersistStream</span></span>

<span data-ttu-id="15b01-160">Esta interfaz carga un archivo de una secuencia para un procesamiento más seguro que la [interfaz IPersistFile](/windows/win32/api/objidl/nn-objidl-ipersistfile) porque el contexto en el que se ejecuta un filtro [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) no necesita los derechos para abrir ningún archivo en el disco o a través de la red.</span><span class="sxs-lookup"><span data-stu-id="15b01-160">This interface loads a file from a stream for more secure processing than [IPersistFile Interface](/windows/win32/api/objidl/nn-objidl-ipersistfile) because the context in which a [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) filter runs does not need the rights to open any files on the disk or over the network.</span></span> <span data-ttu-id="15b01-161">De los dos métodos para tener acceso a un único archivo, es el método preferido para la compatibilidad con versiones posteriores de Windows.</span><span class="sxs-lookup"><span data-stu-id="15b01-161">Of the two methods for accessing a single file, this is the preferred method for forward compatibility with Windows.</span></span>



| <span data-ttu-id="15b01-162">Método</span><span class="sxs-lookup"><span data-stu-id="15b01-162">Method</span></span>       | <span data-ttu-id="15b01-163">Descripción</span><span class="sxs-lookup"><span data-stu-id="15b01-163">Description</span></span>                                                                                                                                        |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="15b01-164">IsDirty ()</span><span class="sxs-lookup"><span data-stu-id="15b01-164">IsDirty()</span></span>    | <span data-ttu-id="15b01-165">Comprueba si se ha producido un cambio.</span><span class="sxs-lookup"><span data-stu-id="15b01-165">Checks if there has been a change.</span></span> <span data-ttu-id="15b01-166">Este método devuelve E \_ NOTIMPL en filtros.</span><span class="sxs-lookup"><span data-stu-id="15b01-166">This method returns E\_NOTIMPL in filters.</span></span>                                                                      |
| <span data-ttu-id="15b01-167">InitNew ()</span><span class="sxs-lookup"><span data-stu-id="15b01-167">InitNew()</span></span>    | <span data-ttu-id="15b01-168">Crea un nuevo almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="15b01-168">Creates a new storage.</span></span> <span data-ttu-id="15b01-169">Este método devuelve E \_ NOTIMPL en filtros.</span><span class="sxs-lookup"><span data-stu-id="15b01-169">This method returns E\_NOTIMPL in filters.</span></span>                                                                                  |
| <span data-ttu-id="15b01-170">Load ()</span><span class="sxs-lookup"><span data-stu-id="15b01-170">Load()</span></span>       | <span data-ttu-id="15b01-171">Inicializa un objeto desde la secuencia donde se guardó previamente.</span><span class="sxs-lookup"><span data-stu-id="15b01-171">Initializes an object from the stream where it was previously saved.</span></span>                                                                               |
| <span data-ttu-id="15b01-172">Guardar ()</span><span class="sxs-lookup"><span data-stu-id="15b01-172">Save()</span></span>       | <span data-ttu-id="15b01-173">Guarda un objeto en el flujo especificado e indica si el objeto debe restablecer su marca de modificado.</span><span class="sxs-lookup"><span data-stu-id="15b01-173">Saves an object into the specified stream and indicates whether the object should reset its dirty flag.</span></span> <span data-ttu-id="15b01-174">Este método devuelve E \_ NOTIMPL en filtros.</span><span class="sxs-lookup"><span data-stu-id="15b01-174">This method returns E\_NOTIMPL in filters.</span></span> |
| <span data-ttu-id="15b01-175">GetSizeMax()</span><span class="sxs-lookup"><span data-stu-id="15b01-175">GetSizeMax()</span></span> | <span data-ttu-id="15b01-176">Devuelve el tamaño en bytes de la secuencia necesaria para guardar el objeto.</span><span class="sxs-lookup"><span data-stu-id="15b01-176">Returns the size in bytes of the stream needed to save the object.</span></span> <span data-ttu-id="15b01-177">Este método devuelve E \_ NOTIMPL en filtros.</span><span class="sxs-lookup"><span data-stu-id="15b01-177">This method returns E\_NOTIMPL in filters.</span></span>                                      |



 

### <a name="ipersistfile"></a><span data-ttu-id="15b01-178">IPersistFile</span><span class="sxs-lookup"><span data-stu-id="15b01-178">IPersistFile</span></span>

<span data-ttu-id="15b01-179">Esta interfaz carga un archivo mediante una ruta de acceso absoluta y no se admite en Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="15b01-179">This interface loads a file by absolute path and is not supported in Windows Vista.</span></span>



| <span data-ttu-id="15b01-180">Método</span><span class="sxs-lookup"><span data-stu-id="15b01-180">Method</span></span>          | <span data-ttu-id="15b01-181">Descripción</span><span class="sxs-lookup"><span data-stu-id="15b01-181">Description</span></span>                                                                                                                  |
|-----------------|------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="15b01-182">GetCurFile()</span><span class="sxs-lookup"><span data-stu-id="15b01-182">GetCurFile()</span></span>    | <span data-ttu-id="15b01-183">Obtiene el nombre actual del archivo asociado al objeto.</span><span class="sxs-lookup"><span data-stu-id="15b01-183">Gets the current name of the file associated with the object.</span></span> <span data-ttu-id="15b01-184">Devuelve la ruta de acceso especificada en Load ().</span><span class="sxs-lookup"><span data-stu-id="15b01-184">Returns the path specified in Load().</span></span>                          |
| <span data-ttu-id="15b01-185">Load ()</span><span class="sxs-lookup"><span data-stu-id="15b01-185">Load()</span></span>          | <span data-ttu-id="15b01-186">Abre el archivo especificado e inicializa un objeto del contenido del archivo.</span><span class="sxs-lookup"><span data-stu-id="15b01-186">Opens the specified file and initializes an object from the file contents.</span></span> <span data-ttu-id="15b01-187">Puede retrasar la apertura del archivo hasta que lo necesite.</span><span class="sxs-lookup"><span data-stu-id="15b01-187">You can delay opening the file until you need it.</span></span> |
| <span data-ttu-id="15b01-188">GetClassID ()</span><span class="sxs-lookup"><span data-stu-id="15b01-188">GetClassID()</span></span>    | <span data-ttu-id="15b01-189">Devuelve el identificador de clase (CLSID) para el nuevo tipo de archivo.</span><span class="sxs-lookup"><span data-stu-id="15b01-189">Returns the class identifier (CLSID) for the new file type.</span></span> <span data-ttu-id="15b01-190">Debe utilizar uuidgen.exe para generar un CLSID único.</span><span class="sxs-lookup"><span data-stu-id="15b01-190">You should use uuidgen.exe to generate a unique CLSID.</span></span>           |
| <span data-ttu-id="15b01-191">IsDirty ()</span><span class="sxs-lookup"><span data-stu-id="15b01-191">IsDirty()</span></span>       | <span data-ttu-id="15b01-192">Solo es necesario devolver E \_ NOTIMPL en filtros</span><span class="sxs-lookup"><span data-stu-id="15b01-192">Need only return E\_NOTIMPL in filters</span></span>                                                                                       |
| <span data-ttu-id="15b01-193">Guardar ()</span><span class="sxs-lookup"><span data-stu-id="15b01-193">Save()</span></span>          | <span data-ttu-id="15b01-194">Solo es necesario devolver E \_ NOTIMPL en filtros</span><span class="sxs-lookup"><span data-stu-id="15b01-194">Need only return E\_NOTIMPL in filters</span></span>                                                                                       |
| <span data-ttu-id="15b01-195">SaveCompleted()</span><span class="sxs-lookup"><span data-stu-id="15b01-195">SaveCompleted()</span></span> | <span data-ttu-id="15b01-196">Solo es necesario devolver E \_ NOTIMPL en filtros</span><span class="sxs-lookup"><span data-stu-id="15b01-196">Need only return E\_NOTIMPL in filters</span></span>                                                                                       |



 

### <a name="ipersiststorage"></a><span data-ttu-id="15b01-197">IPersistStorage</span><span class="sxs-lookup"><span data-stu-id="15b01-197">IPersistStorage</span></span>

<span data-ttu-id="15b01-198">Esta interfaz admite el modelo de almacenamiento estructurado, en el que cada objeto contenido tiene su propio almacenamiento anidado dentro del almacenamiento del contenedor.</span><span class="sxs-lookup"><span data-stu-id="15b01-198">This interface supports the structured storage model, in which each contained object has its own storage that is nested within the container's storage.</span></span> <span data-ttu-id="15b01-199">Como la [interfaz IPersistFile](/windows/win32/api/objidl/nn-objidl-ipersistfile), esta interfaz se carga mediante una ruta de acceso absoluta y no se admite en Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="15b01-199">Like [IPersistFile Interface](/windows/win32/api/objidl/nn-objidl-ipersistfile), this interface loads by absolute path and is not supported in Windows Vista.</span></span>



| <span data-ttu-id="15b01-200">Método</span><span class="sxs-lookup"><span data-stu-id="15b01-200">Method</span></span>            | <span data-ttu-id="15b01-201">Descripción</span><span class="sxs-lookup"><span data-stu-id="15b01-201">Description</span></span>                                                                                                   |
|-------------------|---------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="15b01-202">IsDirty ()</span><span class="sxs-lookup"><span data-stu-id="15b01-202">IsDirty()</span></span>         | <span data-ttu-id="15b01-203">Comprueba si se ha producido un cambio.</span><span class="sxs-lookup"><span data-stu-id="15b01-203">Checks if there has been a change.</span></span> <span data-ttu-id="15b01-204">Este método devuelve E \_ NOTIMPL en filtros.</span><span class="sxs-lookup"><span data-stu-id="15b01-204">This method returns E\_NOTIMPL in filters.</span></span>                                 |
| <span data-ttu-id="15b01-205">InitNew ()</span><span class="sxs-lookup"><span data-stu-id="15b01-205">InitNew()</span></span>         | <span data-ttu-id="15b01-206">Crea un nuevo almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="15b01-206">Creates a new storage.</span></span> <span data-ttu-id="15b01-207">Este método devuelve E \_ NOTIMPL en filtros.</span><span class="sxs-lookup"><span data-stu-id="15b01-207">This method returns E\_NOTIMPL in filters.</span></span>                                             |
| <span data-ttu-id="15b01-208">Load ()</span><span class="sxs-lookup"><span data-stu-id="15b01-208">Load()</span></span>            | <span data-ttu-id="15b01-209">Guarda el almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="15b01-209">Saves the storage.</span></span> <span data-ttu-id="15b01-210">Este método devuelve E \_ NOTIMPL en filtros.</span><span class="sxs-lookup"><span data-stu-id="15b01-210">This method returns E\_NOTIMPL in filters.</span></span>                                                 |
| <span data-ttu-id="15b01-211">Guardar ()</span><span class="sxs-lookup"><span data-stu-id="15b01-211">Save()</span></span>            | <span data-ttu-id="15b01-212">Devuelve el tamaño en bytes de la secuencia necesaria para guardar el objeto.</span><span class="sxs-lookup"><span data-stu-id="15b01-212">Returns the size in bytes of the stream needed to save the object.</span></span> <span data-ttu-id="15b01-213">Este método devuelve E \_ NOTIMPL en filtros.</span><span class="sxs-lookup"><span data-stu-id="15b01-213">This method returns E\_NOTIMPL in filters.</span></span> |
| <span data-ttu-id="15b01-214">SaveCompleted()</span><span class="sxs-lookup"><span data-stu-id="15b01-214">SaveCompleted()</span></span>   | <span data-ttu-id="15b01-215">Reservado para uso interno.</span><span class="sxs-lookup"><span data-stu-id="15b01-215">Reserved for internal use.</span></span> <span data-ttu-id="15b01-216">Este método devuelve E \_ NOTIMPL en filtros.</span><span class="sxs-lookup"><span data-stu-id="15b01-216">This method returns E\_NOTIMPL in filters.</span></span>                                         |
| <span data-ttu-id="15b01-217">HandsOffStorage()</span><span class="sxs-lookup"><span data-stu-id="15b01-217">HandsOffStorage()</span></span> | <span data-ttu-id="15b01-218">Reservado para uso interno.</span><span class="sxs-lookup"><span data-stu-id="15b01-218">Reserved for internal use.</span></span> <span data-ttu-id="15b01-219">Este método devuelve E \_ NOTIMPL en filtros.</span><span class="sxs-lookup"><span data-stu-id="15b01-219">This method returns E\_NOTIMPL in filters.</span></span>                                         |



 

## <a name="outputting-properties-with-filters"></a><span data-ttu-id="15b01-220">Salida de propiedades con filtros</span><span class="sxs-lookup"><span data-stu-id="15b01-220">Outputting Properties with Filters</span></span>

<span data-ttu-id="15b01-221">El propósito de un filtro es extraer el contenido y las propiedades de los archivos para su inclusión en el índice de texto completo.</span><span class="sxs-lookup"><span data-stu-id="15b01-221">The purpose of a filter is to extract the content and properties of files for inclusion in the full-text index.</span></span> <span data-ttu-id="15b01-222">En primer lugar, WDS llama al método Load en las implementaciones IPersistFile, IPersistStream o IPersistStorage y, a continuación, invoca el método init de la implementación de IFilter.</span><span class="sxs-lookup"><span data-stu-id="15b01-222">WDS first calls the Load method on either the IPersistFile, IPersistStream, or IPersistStorage implementations and then invokes the Init method of the IFilter implementation.</span></span> <span data-ttu-id="15b01-223">Se llama a **GetChunk** para recuperar fragmentos de datos de texto o de valores de propiedad y, a continuación, se llama a **gettext** o a **GetValue** tantas veces como sea necesario para recuperar todos los valores de texto o propiedad asociados al fragmento.</span><span class="sxs-lookup"><span data-stu-id="15b01-223">**GetChunk** is called to retrieve chunks of text or property value data, and then either **GetText** or **GetValue** is called as many times as needed to retrieve all of the text or property values associated with the chunk.</span></span> <span data-ttu-id="15b01-224">Este proceso se repite hasta que **GetChunk** informa de que no hay más fragmentos en el documento.</span><span class="sxs-lookup"><span data-stu-id="15b01-224">This process repeats until **GetChunk** reports that there are no more chunks in the document.</span></span>

<span data-ttu-id="15b01-225">El método **GetChunk** recupera información sobre el primer o el siguiente bloque lógico de información del archivo que se está filtrando y devuelve esa información en una estructura de fragmentos de datos. \_ incluir un identificador de fragmento que se incrementa de forma continua, información de estado sobre cómo se relaciona el fragmento actual con el fragmento anterior, una marca que indica si el fragmento contiene texto o un valor, la configuración regional del fragmento y la especificación de la propiedad del fragmento.</span><span class="sxs-lookup"><span data-stu-id="15b01-225">The **GetChunk** method retrieves information about the first or next logical block of information from the file being filtered and returns that information in a STAT\_CHUNK structure, including a monotonically increasing chunk ID, status information about how the current chunk relates to the previous chunk, a flag indicating whether the chunk contains text or a value, the chunk's locale, and the chunk's property specification.</span></span> <span data-ttu-id="15b01-226">La especificación de propiedad es un [**FULLPROPSPEC**](/windows/desktop/api/filter/ns-filter-fullpropspec) que consta de un CLSID y un identificador de propiedad de cadena o entero (por ejemplo, D5CDD505-2E9C-101B-9397-08002B2CF9AE/PerceivedType).</span><span class="sxs-lookup"><span data-stu-id="15b01-226">The property specification is a [**FULLPROPSPEC**](/windows/desktop/api/filter/ns-filter-fullpropspec) consisting of a CLSID and either an integer or string property identifier (for example, D5CDD505-2E9C-101B-9397-08002B2CF9AE/PerceivedType).</span></span> <span data-ttu-id="15b01-227">Identifica el tipo de propiedad en lugar del propio valor de la propiedad.</span><span class="sxs-lookup"><span data-stu-id="15b01-227">It identifies the type of property rather than the property value itself.</span></span>

<span data-ttu-id="15b01-228">El identificador de configuración regional de fragmentos se usa para elegir un separador de palabras adecuado y es muy importante que lo identifique correctamente.</span><span class="sxs-lookup"><span data-stu-id="15b01-228">The chunk locale identifier is used to choose an appropriate word breaker, and it is very important that you correctly identify it.</span></span> <span data-ttu-id="15b01-229">Si el filtro no puede determinar la configuración regional del texto, debe suponer la configuración regional predeterminada del sistema, disponible mediante **GetSystemDefaultLCID**.</span><span class="sxs-lookup"><span data-stu-id="15b01-229">If the filter cannot determine the locale of the text, it should assume the default system locale, available by using **GetSystemDefaultLCID**.</span></span> <span data-ttu-id="15b01-230">Si controla el formato de archivo y actualmente no contiene información de configuración regional, debe agregar una característica de usuario para habilitar la identificación de configuración regional adecuada.</span><span class="sxs-lookup"><span data-stu-id="15b01-230">If you control the file format and it currently does not contain locale information, you should add a user feature to enable proper locale identification.</span></span> <span data-ttu-id="15b01-231">El uso de un separador de palabras no coincidente puede dar lugar a una mala experiencia de consulta para el usuario.</span><span class="sxs-lookup"><span data-stu-id="15b01-231">Using a mismatched word breaker can lead to a bad query experience for the user.</span></span>

<span data-ttu-id="15b01-232">**GetChunk** solo administra el acceso a fragmentos y no devuelve el propio valor de texto o propiedad.</span><span class="sxs-lookup"><span data-stu-id="15b01-232">**GetChunk** only manages accessing chunks and does not return the text or property value itself.</span></span> <span data-ttu-id="15b01-233">En su lugar, las llamadas subsiguientes a **gettext** y **GetValue** recuperan el cuerpo del fragmento.</span><span class="sxs-lookup"><span data-stu-id="15b01-233">Rather, subsequent calls to **GetText** and **GetValue** retrieve the body of the chunk.</span></span> <span data-ttu-id="15b01-234">**Gettext** devuelve fragmentos de texto, que son cadenas Unicode, del fragmento de texto del fragmento actual \_ .</span><span class="sxs-lookup"><span data-stu-id="15b01-234">**GetText** returns text chunks, which are Unicode strings, from the current CHUNK\_TEXT chunk.</span></span> <span data-ttu-id="15b01-235">Si el fragmento actual es demasiado grande, es posible que se requiera más de una llamada al método **gettext** .</span><span class="sxs-lookup"><span data-stu-id="15b01-235">If the current chunk is too large, more than one call to the **GetText** method can be required.</span></span> <span data-ttu-id="15b01-236">Cada llamada al método **gettext** recupera el texto que sigue inmediatamente al texto de la última llamada al método **gettext** .</span><span class="sxs-lookup"><span data-stu-id="15b01-236">Each call to the **GetText** method retrieves text that immediately follows the text from the last call to the **GetText** method.</span></span> <span data-ttu-id="15b01-237">Por ejemplo, el último carácter de una llamada puede estar en medio de una palabra y el primer carácter de la siguiente llamada continuaría esa palabra.</span><span class="sxs-lookup"><span data-stu-id="15b01-237">For example, the last character from one call can be in the middle of a word, and the first character in the next call would continue that word.</span></span> <span data-ttu-id="15b01-238">Los motores de búsqueda deben tratar esta situación.</span><span class="sxs-lookup"><span data-stu-id="15b01-238">Search engines must handle this situation.</span></span>

<span data-ttu-id="15b01-239">**GetValue** devuelve valores de propiedad para el fragmento de valor de fragmento actual \_ en estructuras PROPVARIANT, que pueden contener una amplia variedad de tipos de datos.</span><span class="sxs-lookup"><span data-stu-id="15b01-239">**GetValue** returns property values for the current CHUNK\_VALUE chunk in PROPVARIANT structures, which can hold a wide variety of data types.</span></span> <span data-ttu-id="15b01-240">**GetValue** debe asignar la propia estructura PROPVARIANT mediante CoTaskMemAlloc.</span><span class="sxs-lookup"><span data-stu-id="15b01-240">**GetValue** must allocate the PROPVARIANT structure itself using CoTaskMemAlloc.</span></span> <span data-ttu-id="15b01-241">El autor de la llamada de **GetValue** es responsable de liberar la memoria a la que apunta PROPVARIANT mediante PropVariantClear, y para liberar la propia estructura con CoTaskMemFree.</span><span class="sxs-lookup"><span data-stu-id="15b01-241">The caller of **GetValue** is responsible for freeing memory pointed to by the PROPVARIANT using PropVariantClear, and for freeing the structure itself with CoTaskMemFree.</span></span> <span data-ttu-id="15b01-242">Para obtener más información sobre PROPVARIANTs, consulte la referencia de [PROPVARIANT](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="15b01-242">For more information on PROPVARIANTs, see the [PROPVARIANT](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) reference.</span></span>

### <a name="property-values"></a><span data-ttu-id="15b01-243">Valores de propiedad</span><span class="sxs-lookup"><span data-stu-id="15b01-243">Property Values</span></span>

<span data-ttu-id="15b01-244">Los filtros deben mostrar como mínimo las siguientes propiedades, que son las columnas predeterminadas en la vista de resultados de WDS.</span><span class="sxs-lookup"><span data-stu-id="15b01-244">Filters should output at a minimum the following properties which are the default columns in the WDS results view.</span></span>



| <span data-ttu-id="15b01-245">GUID</span><span class="sxs-lookup"><span data-stu-id="15b01-245">GUID</span></span>                                 | <span data-ttu-id="15b01-246">PROPSPEC</span><span class="sxs-lookup"><span data-stu-id="15b01-246">PROPSPEC</span></span>      | <span data-ttu-id="15b01-247">Nombre descriptivo</span><span class="sxs-lookup"><span data-stu-id="15b01-247">Friendly Name</span></span>  | <span data-ttu-id="15b01-248">Descripción</span><span class="sxs-lookup"><span data-stu-id="15b01-248">Description</span></span>                                                                                                                                     |
|--------------------------------------|---------------|----------------|-------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="15b01-249">F29F85E0-4FF9-1068-AB91-08002B27B3D9</span><span class="sxs-lookup"><span data-stu-id="15b01-249">F29F85E0-4FF9-1068-AB91-08002B27B3D9</span></span> | <span data-ttu-id="15b01-250">2</span><span class="sxs-lookup"><span data-stu-id="15b01-250">2</span></span>             | <span data-ttu-id="15b01-251">PrimaryTitle</span><span class="sxs-lookup"><span data-stu-id="15b01-251">PrimaryTitle</span></span>   | <span data-ttu-id="15b01-252">Título que se muestra para este elemento.</span><span class="sxs-lookup"><span data-stu-id="15b01-252">Title that displays for this item.</span></span>                                                                                                              |
| <span data-ttu-id="15b01-253">F29F85E0-4FF9-1068-AB91-08002B27B3D9</span><span class="sxs-lookup"><span data-stu-id="15b01-253">F29F85E0-4FF9-1068-AB91-08002B27B3D9</span></span> | <span data-ttu-id="15b01-254">4</span><span class="sxs-lookup"><span data-stu-id="15b01-254">4</span></span>             | <span data-ttu-id="15b01-255">PrimaryAuthors</span><span class="sxs-lookup"><span data-stu-id="15b01-255">PrimaryAuthors</span></span> | <span data-ttu-id="15b01-256">Persona más asociada a este elemento.</span><span class="sxs-lookup"><span data-stu-id="15b01-256">Person most associated with this item.</span></span>                                                                                                          |
| <span data-ttu-id="15b01-257">D5CDD505-2E9C-101B-9397-08002B2CF9AE</span><span class="sxs-lookup"><span data-stu-id="15b01-257">D5CDD505-2E9C-101B-9397-08002B2CF9AE</span></span> | <span data-ttu-id="15b01-258">PrimaryDate</span><span class="sxs-lookup"><span data-stu-id="15b01-258">PrimaryDate</span></span>   | <span data-ttu-id="15b01-259">PrimaryDate</span><span class="sxs-lookup"><span data-stu-id="15b01-259">PrimaryDate</span></span>    | <span data-ttu-id="15b01-260">Fecha más importante del elemento, como la fecha de recepción del correo electrónico o la modificación de los archivos.</span><span class="sxs-lookup"><span data-stu-id="15b01-260">Most important date for item, like date received for email or modified for files.</span></span>                                                               |
| <span data-ttu-id="15b01-261">D5CDD505-2E9C-101B-9397-08002B2CF9AE</span><span class="sxs-lookup"><span data-stu-id="15b01-261">D5CDD505-2E9C-101B-9397-08002B2CF9AE</span></span> | <span data-ttu-id="15b01-262">PerceivedType</span><span class="sxs-lookup"><span data-stu-id="15b01-262">PerceivedType</span></span> | <span data-ttu-id="15b01-263">PerceivedType</span><span class="sxs-lookup"><span data-stu-id="15b01-263">PerceivedType</span></span>  | <span data-ttu-id="15b01-264">Tipo de archivo que se está analizando.</span><span class="sxs-lookup"><span data-stu-id="15b01-264">Type of file being parsed.</span></span> <span data-ttu-id="15b01-265">Debe coincidir con uno de los tipos de búsqueda en el escritorio de Windows enumerados en el [tipo percibido](-search-2x-wds-perceivedtype.md)de WDS.</span><span class="sxs-lookup"><span data-stu-id="15b01-265">Must match one of the Windows Desktop Search types listed in WDS [Perceived Type](-search-2x-wds-perceivedtype.md).</span></span> |



 

<span data-ttu-id="15b01-266">En el caso de los elementos de texto no cifrado, WDS extrae todas las propiedades definidas por el sistema, como el tamaño de archivo o la extensión, al incluir nuevos tipos de archivo de texto no cifrado en el índice.</span><span class="sxs-lookup"><span data-stu-id="15b01-266">For plaintext items, WDS extracts all text and system-defined properties such as file size or extension on including new plaintext file types to the index).</span></span> <span data-ttu-id="15b01-267">Otros tipos de propiedades que se pueden devolver al índice son:</span><span class="sxs-lookup"><span data-stu-id="15b01-267">Other types of properties that can be returned to the index include:</span></span>

-   <span data-ttu-id="15b01-268">Para archivos: autor, título, estado, palabras clave</span><span class="sxs-lookup"><span data-stu-id="15b01-268">For files: author, title, status, keywords</span></span>
-   <span data-ttu-id="15b01-269">Para medios: álbum, género, marca de cámara, fecha de toma</span><span class="sxs-lookup"><span data-stu-id="15b01-269">For media: album, genre, camera make, date taken</span></span>
-   <span data-ttu-id="15b01-270">Para comunicaciones: de, a, CC, importancia</span><span class="sxs-lookup"><span data-stu-id="15b01-270">For communications: from, to, cc, importance</span></span>
-   <span data-ttu-id="15b01-271">Para contactos: puesto, teléfono del trabajo, compañía</span><span class="sxs-lookup"><span data-stu-id="15b01-271">For contacts: job title, business phone, company</span></span>

<span data-ttu-id="15b01-272">La lista anterior agrupa propiedades comunes a un tipo percibido específico; sin embargo, se puede utilizar cualquier propiedad independientemente del tipo.</span><span class="sxs-lookup"><span data-stu-id="15b01-272">The list above groups properties common to a specified Perceived Type; however, any property can be used regardless of the type.</span></span> <span data-ttu-id="15b01-273">Por ejemplo, la empresa podría usarse para el nombre de la empresa de un contacto y también podría usarse para hacer referencia al nombre de un cliente con el que se relaciona el archivo.</span><span class="sxs-lookup"><span data-stu-id="15b01-273">For example, company could be used for a contact's employer name and could also be used to refer to the name of a client the file relates to.</span></span> <span data-ttu-id="15b01-274">Muchas de estas propiedades se usan para mostrar los resultados de la búsqueda en la vista de resultados de WDS.</span><span class="sxs-lookup"><span data-stu-id="15b01-274">Many of these properties are used to display search results in the WDS results view.</span></span> <span data-ttu-id="15b01-275">Por ejemplo, la propiedad title de un archivo se muestra como la columna principal en la vista de resultados predeterminada.</span><span class="sxs-lookup"><span data-stu-id="15b01-275">For example, a file's Title property is shown as the main column in the default results view.</span></span> <span data-ttu-id="15b01-276">Los objetos IFilter deben generar todas las propiedades relacionadas con el tipo de elemento que se están analizando.</span><span class="sxs-lookup"><span data-stu-id="15b01-276">IFilter objects should output all the properties related to the item type they are parsing.</span></span> <span data-ttu-id="15b01-277">No se pueden agregar propiedades personalizadas en WDS 2. x.</span><span class="sxs-lookup"><span data-stu-id="15b01-277">Custom properties cannot be added in WDS 2.x.</span></span> <span data-ttu-id="15b01-278">Para obtener una lista completa de las propiedades disponibles, vea el [esquema de WDS](-search-2x-wds-schematable.md).</span><span class="sxs-lookup"><span data-stu-id="15b01-278">For a full list of properties available, see the [WDS Schema](-search-2x-wds-schematable.md).</span></span>

## <a name="filter-add-in-installation"></a><span data-ttu-id="15b01-279">Instalación del complemento de filtro</span><span class="sxs-lookup"><span data-stu-id="15b01-279">Filter Add-in Installation</span></span>

<span data-ttu-id="15b01-280">La instalación del filtro implica copiar el archivo DLL en una ubicación adecuada del directorio archivos de programa y registrarlo.</span><span class="sxs-lookup"><span data-stu-id="15b01-280">Installing the filter involves copying the DLL to an appropriate location in the Program Files directory and registering it.</span></span> <span data-ttu-id="15b01-281">Los filtros deben implementar el registro automático para la instalación y deben seguir estas directrices:</span><span class="sxs-lookup"><span data-stu-id="15b01-281">Filters should implement self-registration for installation and should follow these guidelines:</span></span>

-   <span data-ttu-id="15b01-282">El instalador debe utilizar el instalador EXE o MSI.</span><span class="sxs-lookup"><span data-stu-id="15b01-282">The installer must use either EXE or MSI installer.</span></span>
-   <span data-ttu-id="15b01-283">Se deben proporcionar las notas de la versión.</span><span class="sxs-lookup"><span data-stu-id="15b01-283">Release notes must be provided.</span></span>
-   <span data-ttu-id="15b01-284">Se debe crear una entrada **Agregar o quitar programas** para cada complemento instalado.</span><span class="sxs-lookup"><span data-stu-id="15b01-284">An **Add/Remove Programs** entry must be created for each add-in installed.</span></span>
-   <span data-ttu-id="15b01-285">El instalador debe asumir toda la configuración del registro para el tipo de archivo o almacén concreto que el complemento actual entienda.</span><span class="sxs-lookup"><span data-stu-id="15b01-285">The installer must take over all registry settings for the particular file type or store that the current add-in understands.</span></span>
-   <span data-ttu-id="15b01-286">Si se está sobrescribiendo un complemento anterior, el instalador debe notificar al usuario.</span><span class="sxs-lookup"><span data-stu-id="15b01-286">If a previous add-in is being overwritten, the installer should notify the user.</span></span>
-   <span data-ttu-id="15b01-287">Si un complemento más reciente ha sobrescrito el complemento anterior, debería tener la capacidad de restaurar la funcionalidad del complemento anterior y convertirlo en el complemento predeterminado para ese tipo de archivo o para almacenarlo de nuevo.</span><span class="sxs-lookup"><span data-stu-id="15b01-287">If a newer add-in has overwritten the previous add-in, there should be the ability to restore the previous add-in's functionality and make it the default add-in for that file type or store again.</span></span>

### <a name="clsids-required-for-registration"></a><span data-ttu-id="15b01-288">CLSID necesarios para el registro</span><span class="sxs-lookup"><span data-stu-id="15b01-288">CLSIDs Required for Registration</span></span>

<span data-ttu-id="15b01-289">Hay tres identificadores de clase, o CLSID, asociados a cada filtro.</span><span class="sxs-lookup"><span data-stu-id="15b01-289">There are three class identifiers, or CLSIDs, associated with every filter.</span></span> <span data-ttu-id="15b01-290">Deberá generar uno o más de estos (use uuidgen.exe) para registrar el complemento de filtro.</span><span class="sxs-lookup"><span data-stu-id="15b01-290">You'll need to generate one or more of these (use uuidgen.exe) to register your filter add-in.</span></span>

-   <span data-ttu-id="15b01-291">El primero identifica todos los controladores persistentes de filtros, IID \_ IFilter, que es {89BCB740-6119-101A-BCB7-00DD010655AF}.</span><span class="sxs-lookup"><span data-stu-id="15b01-291">The first identifies all filters' persistent handler, IID\_IFilter, which is {89BCB740-6119-101A-BCB7-00DD010655AF}.</span></span> <span data-ttu-id="15b01-292">Este CLSID es constante para todos los filtros que implementan IFilter.</span><span class="sxs-lookup"><span data-stu-id="15b01-292">This CLSID is constant for all filters that implement IFilter.</span></span>
-   <span data-ttu-id="15b01-293">El segundo (el valor de la clave de IFilter de IID \_ ) identifica la implementación de IFilter para el tipo de archivo.</span><span class="sxs-lookup"><span data-stu-id="15b01-293">The second (the value of the IID\_IFilter key) identifies the IFilter implementation for your file type.</span></span> <span data-ttu-id="15b01-294">Esta clave contiene un valor InprocServer32 que especifica el nombre del archivo DLL mediante la ruta de acceso y el modelo de subprocesos.</span><span class="sxs-lookup"><span data-stu-id="15b01-294">This key contains an InprocServer32 value that specifies the DLL name by path and the threading model.</span></span> <span data-ttu-id="15b01-295">Si el filtro está en la ruta de acceso del sistema, como el directorio system32, basta con un nombre de archivo.</span><span class="sxs-lookup"><span data-stu-id="15b01-295">If the filter is in the system path, like the system32 directory, a file name is sufficient.</span></span> <span data-ttu-id="15b01-296">De lo contrario, este valor debe tener una especificación de ruta de acceso completa.</span><span class="sxs-lookup"><span data-stu-id="15b01-296">Otherwise, this value should have a full path specification.</span></span>
-   <span data-ttu-id="15b01-297">El tercero identifica el tipo de archivo que procesa el filtro y lo devuelve el método GetClassID en la interfaz IPersist.</span><span class="sxs-lookup"><span data-stu-id="15b01-297">The third identifies the file type the filter processes and is returned by the GetClassID method on your IPersist interface.</span></span>

> [!Note]
>
> <span data-ttu-id="15b01-298">En versiones futuras de los sistemas operativos de Microsoft, la instalación de archivos en el directorio system32 puede ser más difícil, por lo que se recomienda instalarlos en archivos de programa e incluir una ruta de acceso completa al filtro en el registro.</span><span class="sxs-lookup"><span data-stu-id="15b01-298">In future versions of Microsoft operating systems, installing files in the system32 directory may get more difficult, so we recommend you install them under Program Files and include a full path to the filter in the registry.</span></span> <span data-ttu-id="15b01-299">Por motivos de seguridad, también es prudente especificar una ruta de acceso completa al archivo DLL en el registro.</span><span class="sxs-lookup"><span data-stu-id="15b01-299">For security reasons, it is also prudent to specify a full path to your DLL in the registry.</span></span> <span data-ttu-id="15b01-300">De lo contrario, se puede cargar una versión de "caballo de Troya" de la DLL si está en la ruta de acceso del proceso antes de la versión.</span><span class="sxs-lookup"><span data-stu-id="15b01-300">Otherwise, a "Trojan horse" version of your DLL could be loaded if it happens to be in the process path before your version.</span></span>

 

### <a name="registration-model"></a><span data-ttu-id="15b01-301">Modelo de registro</span><span class="sxs-lookup"><span data-stu-id="15b01-301">Registration Model</span></span>

<span data-ttu-id="15b01-302">Cuando WDS está listo para filtrar un archivo, busca en el registro en la extensión del archivo para determinar el filtro que se va a cargar.</span><span class="sxs-lookup"><span data-stu-id="15b01-302">When WDS is ready to filter a file, it looks in the registry under the file's extension to determine which filter to load.</span></span> <span data-ttu-id="15b01-303">Después, sigue una serie de vínculos del registro para buscar el nombre del archivo DLL del filtro, en este orden:</span><span class="sxs-lookup"><span data-stu-id="15b01-303">It then follows a series of registry links to find the name of the filter DLL, in this order:</span></span>

1.  <span data-ttu-id="15b01-304">Desde CLSIDs que se encuentran en:</span><span class="sxs-lookup"><span data-stu-id="15b01-304">From CLSIDs located at:</span></span>

    <span data-ttu-id="15b01-305">**HKEY \_ Current \_ User \\ software \\ Microsoft \\ RSSearch \\ ContentIndexCommon \\ Filters \\ override \\ RSApp**</span><span class="sxs-lookup"><span data-stu-id="15b01-305">**HKEY\_CURRENT\_USER\\SOFTWARE\\Microsoft\\RSSearch\\ContentIndexCommon\\Filters\\Override\\RSApp**</span></span>

    <span data-ttu-id="15b01-306">**HKEY \_ Current \_ User \\ software \\ Microsoft \\ RSSearch \\ ContentIndexCommon \\ Filters**</span><span class="sxs-lookup"><span data-stu-id="15b01-306">**HKEY\_CURRENT\_USER\\SOFTWARE\\Microsoft\\RSSearch\\ContentIndexCommon\\Filters**</span></span>

2.  <span data-ttu-id="15b01-307">En el tipo de contenido del archivo en:</span><span class="sxs-lookup"><span data-stu-id="15b01-307">From the file content type at:</span></span>

    <span data-ttu-id="15b01-308">**HKEY \_ local \_ Machine \\ software \\ classes \\ MIME \\ Database \\ Content Type**</span><span class="sxs-lookup"><span data-stu-id="15b01-308">**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes\\MIME\\Database\\Content Type**</span></span>

3.  <span data-ttu-id="15b01-309">En la extensión de nombre de archivo (igual que la API LoadIFilter de Win32) en:</span><span class="sxs-lookup"><span data-stu-id="15b01-309">From the file name extension (same as Win32 LoadIFilter API) at:</span></span>

    <span data-ttu-id="15b01-310">**HKEY \_ Current \_ User \\ software \\ Microsoft \\ RSSearch \\ ContentIndexCommon \\ Filters \\ override \\ RSApp**</span><span class="sxs-lookup"><span data-stu-id="15b01-310">**HKEY\_CURRENT\_USER\\SOFTWARE\\Microsoft\\RSSearch\\ContentIndexCommon\\Filters\\Override\\RSApp**</span></span>

    <span data-ttu-id="15b01-311">**HKEY \_ Current \_ User \\ software \\ Microsoft \\ RSSearch \\ ContentIndexCommon \\ Filters**</span><span class="sxs-lookup"><span data-stu-id="15b01-311">**HKEY\_CURRENT\_USER\\SOFTWARE\\Microsoft\\RSSearch\\ContentIndexCommon\\Filters**</span></span>

    <span data-ttu-id="15b01-312">**HKEY \_ classes \_ raíz \\ EXTPERSISTENTHANDLER->CLSID->IID \_ IFilter->CLSID**</span><span class="sxs-lookup"><span data-stu-id="15b01-312">**HKEY\_CLASSES\_ROOT\\extpersistentHandler->CLSID->IID\_IFilter->CLSID**</span></span>

4.  <span data-ttu-id="15b01-313">De predeterminada en:</span><span class="sxs-lookup"><span data-stu-id="15b01-313">From Default at:</span></span>

    <span data-ttu-id="15b01-314">**HKEY \_ local \_ Machine \\ software \\ Microsoft \\ RSSearch \\ ContentIndexCommon \\ Filters**</span><span class="sxs-lookup"><span data-stu-id="15b01-314">**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\RSSearch\\ContentIndexCommon\\Filters**</span></span>

### <a name="to-register-a-filter-add-in"></a><span data-ttu-id="15b01-315">Para registrar un complemento de filtro</span><span class="sxs-lookup"><span data-stu-id="15b01-315">To Register a Filter Add-in</span></span>

<span data-ttu-id="15b01-316">Debe crear un total de ocho entradas en el registro para registrar el complemento de filtro, donde:</span><span class="sxs-lookup"><span data-stu-id="15b01-316">You need to make a total of eight entries in the registry to register your filter add-in, where:</span></span>

-   <span data-ttu-id="15b01-317">**. ext** es la nueva extensión de nombre de archivo</span><span class="sxs-lookup"><span data-stu-id="15b01-317">**.ext** is the new file name extension</span></span>
-   <span data-ttu-id="15b01-318">**GUID \_ 1** puede ser cualquier nuevo GUID generado para esta extensión</span><span class="sxs-lookup"><span data-stu-id="15b01-318">**GUID\_1** can be any new GUID generated for this extension</span></span>
-   <span data-ttu-id="15b01-319">**89BCB740-6119-101A-BCB7-00DD010655AF** es el GUID de la interfaz de IFilter, que es una constante para todas las implementaciones de IFilter.</span><span class="sxs-lookup"><span data-stu-id="15b01-319">**89BCB740-6119-101A-BCB7-00DD010655AF** is the IFilter interface GUID, which is a constant for all IFilter implementations.</span></span>

1.  <span data-ttu-id="15b01-320">Registre el controlador persistente para la extensión de nombre de archivo con las claves y los valores siguientes:</span><span class="sxs-lookup"><span data-stu-id="15b01-320">Register the persistent handler for the file name extension with the following keys and values:</span></span>

    ```
    HKEY_CLASSES_ROOT\<.ext>\PersistentHandler
       (Default) = {GUID_1}
    ```

    ```
    HKEY_CLASSES_ROOT\CLSID\{GUID_1}
       (Default) = <Persistent Handler Description>
    ```

    ```
    HKEY_CLASSES_ROOT\CLSID\{GUID_1}\PersistentAddinsRegistered
       (Default) = (Value Not Set)
    ```

    ```
    HKEY_CLASSES_ROOT\CLSID\{GUID_1}\PersistentAddinsRegistered\{89BCB740-6119-101A-BCB7-00DD010655AF}
       (Default) = {CLSID of IFilter implementation}
    ```

    ```
    HKEY_CLASSES_ROOT\CLSID\{GUID_1}\PersistentHandler
       (Default) = {GUID_1}
    ```

2.  <span data-ttu-id="15b01-321">Registre la implementación de IFilter con las claves y los valores siguientes:</span><span class="sxs-lookup"><span data-stu-id="15b01-321">Register the IFilter implementation with the following keys and values:</span></span>

    ```
    HKEY_CLASSES_ROOT\CLSID\{CLSID of IFilter implementation}
       (Default) = Extension IFilter Description">
    ```

    ```
    HKEY_CLASSES_ROOT\CLSID\{CLSID of IFilter implementation}\InprocServer32
       (Default) = <DLL Install Path>
       ThreadingModel = Both
    ```

3.  <span data-ttu-id="15b01-322">Registre la implementación de IFilter con la búsqueda de escritorio de Windows con la clave y el valor siguientes:</span><span class="sxs-lookup"><span data-stu-id="15b01-322">Register the IFilter implementation with Windows Desktop Search with the following key and value:</span></span>

    ```
    HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\RSSearch\ContentIndexCommon\Filters\Extension\<.ext>
       (Default) = {CLSID of IFilter implementation}"
    ```

## <a name="related-topics"></a><span data-ttu-id="15b01-323">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="15b01-323">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="15b01-324">**Referencia**</span><span class="sxs-lookup"><span data-stu-id="15b01-324">**Reference**</span></span>
</dt> <dt>

[<span data-ttu-id="15b01-325">SchemaTable</span><span class="sxs-lookup"><span data-stu-id="15b01-325">SchemaTable</span></span>](-search-2x-wds-schematable.md)
</dt> <dt>

[<span data-ttu-id="15b01-326">Tipos percibidos</span><span class="sxs-lookup"><span data-stu-id="15b01-326">Perceived Types</span></span>](-search-2x-wds-perceivedtype.md)
</dt> <dt>

[<span data-ttu-id="15b01-327">Desarrollar controladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="15b01-327">Developing Protocol Handlers</span></span>](-search-2x-wds-phaddins.md)
</dt> <dt>

<span data-ttu-id="15b01-328">**Otros recursos**</span><span class="sxs-lookup"><span data-stu-id="15b01-328">**Other Resources**</span></span>
</dt> <dt>

[<span data-ttu-id="15b01-329">**Imaging**</span><span class="sxs-lookup"><span data-stu-id="15b01-329">**IFilter**</span></span>](/windows/desktop/api/filter/nn-filter-ifilter)
</dt> </dl>

 

 