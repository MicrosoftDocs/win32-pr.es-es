---
description: El receptor de archivos ASF es una implementación de IMFMediaSink proporcionada por Media Foundation que una aplicación puede usar para archivar datos multimedia ASF en un archivo. Para obtener información sobre el modelo de objetos de los receptores de medios ASF y el uso general, consulte receptores multimedia ASF.
ms.assetid: 991f3345-a6b4-45c2-a89d-3c13c70b6bbc
title: Crear el receptor de archivos ASF
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c43625bcbc581b4967d4db99cef71a0fc779f070
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104153659"
---
# <a name="creating-the-asf-file-sink"></a><span data-ttu-id="64229-104">Crear el receptor de archivos ASF</span><span class="sxs-lookup"><span data-stu-id="64229-104">Creating the ASF File Sink</span></span>

<span data-ttu-id="64229-105">El receptor de archivos ASF es una implementación de [**IMFMediaSink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) proporcionada por Media Foundation que una aplicación puede usar para archivar datos multimedia ASF en un archivo.</span><span class="sxs-lookup"><span data-stu-id="64229-105">The ASF file sink is an implementation of [**IMFMediaSink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) provided by Media Foundation that an application can use to archive ASF media data to a file.</span></span> <span data-ttu-id="64229-106">Para obtener información sobre el modelo de objetos y el uso general de los receptores de medios ASF, consulte [receptores de medios ASF](asf-media-sinks.md).</span><span class="sxs-lookup"><span data-stu-id="64229-106">For information about ASF Media Sinks' object model and general usage, see [ASF Media Sinks](asf-media-sinks.md).</span></span>

<span data-ttu-id="64229-107">Hay dos formas de crear una instancia del receptor de archivos ASF.</span><span class="sxs-lookup"><span data-stu-id="64229-107">There are two ways of creating an instance of the ASF file sink.</span></span> <span data-ttu-id="64229-108">Puede llamar a [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink) o [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate).</span><span class="sxs-lookup"><span data-stu-id="64229-108">You can call [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink) or [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate).</span></span>

<span data-ttu-id="64229-109">Si llama a [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink), debe especificar una secuencia de bytes, para el archivo de salida, en la que el receptor escribirá el contenido ASF durante una sesión de codificación.</span><span class="sxs-lookup"><span data-stu-id="64229-109">If you call [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink), you must specify a byte stream, for the output file, into which the sink will write the ASF content during an encoding session.</span></span> <span data-ttu-id="64229-110">La secuencia de bytes especificada debe tener funcionalidades de búsqueda y escritura; de lo contrario, se produce un error en la llamada **MFCreateASFMediaSink** con el \_ código de error E Fail.</span><span class="sxs-lookup"><span data-stu-id="64229-110">The specified byte stream must have seekable and writable capabilities otherwise the **MFCreateASFMediaSink** call fails with the E\_FAIL error code.</span></span> <span data-ttu-id="64229-111">Esta llamada crea un objeto de receptor de archivo en proceso y devuelve un puntero a la interfaz [**IMFMediaSink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) del receptor de archivo.</span><span class="sxs-lookup"><span data-stu-id="64229-111">This call creates an in-process file sink object and returns a pointer to the [**IMFMediaSink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) interface of the file sink.</span></span>

<span data-ttu-id="64229-112">Si llama a [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate), debe especificar la dirección URL del archivo de salida en el que el receptor de archivo escribirá los datos multimedia.</span><span class="sxs-lookup"><span data-stu-id="64229-112">If you call [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate), you must specify the URL of the output file into which the file sink will write media data.</span></span> <span data-ttu-id="64229-113">En este caso, el receptor de archivo crea internamente la secuencia de bytes.</span><span class="sxs-lookup"><span data-stu-id="64229-113">In this case, the file sink internally creates the byte stream.</span></span> <span data-ttu-id="64229-114">La función devuelve un puntero a la interfaz [**IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) del receptor de archivo.</span><span class="sxs-lookup"><span data-stu-id="64229-114">The function returns a pointer to the [**IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) interface of the file sink.</span></span> <span data-ttu-id="64229-115">En</span><span class="sxs-lookup"><span data-stu-id="64229-115">To</span></span>

<span data-ttu-id="64229-116">Considere la posibilidad de [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate) en lugar de [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink), cuando la topología de codificación esté diseñada de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="64229-116">Consider [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate) instead of [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink), when your encoding topology is designed as follows:</span></span>

-   <span data-ttu-id="64229-117">La topología de codificación es para la ruta de acceso a medios protegidos (PMP) y el receptor de archivos se usa fuera de proceso.</span><span class="sxs-lookup"><span data-stu-id="64229-117">The encoding topology is for the protected media path (PMP) and the file sink is used out-of-process.</span></span>
-   <span data-ttu-id="64229-118">El nodo de salida de la topología se crea mediante el puntero devuelto al objeto activa del receptor de archivos y la aplicación realiza un seguimiento de las secuencias del receptor de archivos por números de secuencia.</span><span class="sxs-lookup"><span data-stu-id="64229-118">The output node of the topology is created by using the returned pointer to the activate object of the file sink and your application is keeping track of the streams in the file sink by stream numbers.</span></span>
    > [!Note]  
    > <span data-ttu-id="64229-119">Puede activar el receptor de archivos llamando a [**IMFActivate:: ActivateObject**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-activateobject).</span><span class="sxs-lookup"><span data-stu-id="64229-119">You can activate the file sink by calling [**IMFActivate::ActivateObject**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-activateobject).</span></span> <span data-ttu-id="64229-120">Sin embargo, no es necesario activar el objeto explícitamente.</span><span class="sxs-lookup"><span data-stu-id="64229-120">However you do not need to activate the object explictly.</span></span> <span data-ttu-id="64229-121">La sesión multimedia realiza un seguimiento del objeto de activación y activa el receptor de archivos automáticamente durante la sesión de codificación.</span><span class="sxs-lookup"><span data-stu-id="64229-121">The Media Session keeps track of the activation object and activates the file sink automatically during the encoding session.</span></span>

     

-   <span data-ttu-id="64229-122">La información de la secuencia se configura en el objeto ContentInfo.</span><span class="sxs-lookup"><span data-stu-id="64229-122">The stream information is configured in the ContentInfo object.</span></span> <span data-ttu-id="64229-123">Disucssed en la subsección siguiente.</span><span class="sxs-lookup"><span data-stu-id="64229-123">Disucssed in the next sub-section.</span></span>

<span data-ttu-id="64229-124">Después de crear el receptor de archivo ASF, debe configurarlo antes de compilar la topología.</span><span class="sxs-lookup"><span data-stu-id="64229-124">After creating the ASF file sink it must be configured before building the topology.</span></span> <span data-ttu-id="64229-125">El receptor de archivos necesita conocer la siguiente información para generar el archivo de salida.</span><span class="sxs-lookup"><span data-stu-id="64229-125">The file sink needs to know the following information in order to generate the output file.</span></span>

-   <span data-ttu-id="64229-126">Información básica de la secuencia</span><span class="sxs-lookup"><span data-stu-id="64229-126">Basic stream information</span></span>
-   <span data-ttu-id="64229-127">Información del modo de codificación</span><span class="sxs-lookup"><span data-stu-id="64229-127">Encoding mode information</span></span>
-   <span data-ttu-id="64229-128">Metadatos</span><span class="sxs-lookup"><span data-stu-id="64229-128">Metadata</span></span>

<span data-ttu-id="64229-129">El receptor de archivos implementa el [objeto ContentInfo de ASF](asf-contentinfo-object.md) y expone la interfaz [**IMFASFContentInfo**](/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfcontentinfo) para que una aplicación pueda usarla para establecer información relacionada con las secuencias y la codificación.</span><span class="sxs-lookup"><span data-stu-id="64229-129">The file sink implements the [ASF ContentInfo Object](asf-contentinfo-object.md) and exposes the [**IMFASFContentInfo**](/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfcontentinfo) interface so that an application can use it to set information related to the streams and encoding.</span></span> <span data-ttu-id="64229-130">Dependiendo de la función a la que llamó para crear el receptor de archivos, hay dos maneras de obtener una referencia a la interfaz **IMFASFContentInfo** .</span><span class="sxs-lookup"><span data-stu-id="64229-130">Depending on the function you called to create the file sink, there are two ways of getting a reference to the **IMFASFContentInfo** interface.</span></span>

-   <span data-ttu-id="64229-131">Si llama a la función [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink) , la aplicación debe consultar la interfaz [**IMFASFContentInfo**](/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfcontentinfo) llamando a **IMFMediaSink:: QueryInterface** en el receptor de archivo devuelto.</span><span class="sxs-lookup"><span data-stu-id="64229-131">If you call the [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink) function, the application must query for [**IMFASFContentInfo**](/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfcontentinfo) interface by calling **IMFMediaSink::QueryInterface** on the returned file sink.</span></span>
-   <span data-ttu-id="64229-132">Si decide llamar a [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate), esta función espera que tenga un objeto ContentInfo totalmente configurado antes de la llamada.</span><span class="sxs-lookup"><span data-stu-id="64229-132">If you choose to call [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate), this function expects that you have a fully-configured ContentInfo object prior to the call.</span></span> <span data-ttu-id="64229-133">Para ello, debe crear un objeto ContentInfo vacío llamando a [**MFCreateASFContentInfo**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfcontentinfo) y, a continuación, configurarlo con toda la información necesaria.</span><span class="sxs-lookup"><span data-stu-id="64229-133">To do this, you need to create an empty ContentInfo object by calling [**MFCreateASFContentInfo**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfcontentinfo) and then configure it with all the required information.</span></span> <span data-ttu-id="64229-134">Pase el objeto ContentInfo configurado a **MFCreateASFMediaSinkActivate** para recibir un puntero al objeto Sink Activate.</span><span class="sxs-lookup"><span data-stu-id="64229-134">Pass the configured ContentInfo object to the **MFCreateASFMediaSinkActivate** to receive a pointer to the sink activate object.</span></span> <span data-ttu-id="64229-135">No se puede activar el receptor de archivos mediante el objeto de activación devuelto y, a continuación, cambiar cualquier información de secuencia o codificación.</span><span class="sxs-lookup"><span data-stu-id="64229-135">You cannot activate the file sink by using the returned activation object and then change any stream or encoding information.</span></span>

<span data-ttu-id="64229-136">Para obtener información sobre la configuración de secuencias de receptor y propiedades específicas, vea los temas siguientes:</span><span class="sxs-lookup"><span data-stu-id="64229-136">For information about configuring sink streams and specific properties, see the following topics:</span></span>

-   [<span data-ttu-id="64229-137">Agregar información de secuencias al receptor de archivos ASF</span><span class="sxs-lookup"><span data-stu-id="64229-137">Adding Stream Information to the ASF File Sink</span></span>](adding-stream-information-to-the-asf-file-sink.md)
-   [<span data-ttu-id="64229-138">Establecer propiedades en el receptor de archivos</span><span class="sxs-lookup"><span data-stu-id="64229-138">Setting Properties in the File Sink</span></span>](setting-properties-in-the-file-sink.md)
-   [<span data-ttu-id="64229-139">Agregar metadatos al receptor de archivos</span><span class="sxs-lookup"><span data-stu-id="64229-139">Adding Metadata to the File Sink</span></span>](adding-metadata-to-the-file-sink.md)

## <a name="related-topics"></a><span data-ttu-id="64229-140">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="64229-140">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="64229-141">Receptores de medios ASF</span><span class="sxs-lookup"><span data-stu-id="64229-141">ASF Media Sinks</span></span>](asf-media-sinks.md)
</dt> <dt>

[<span data-ttu-id="64229-142">Componentes ASF de capa de canalización</span><span class="sxs-lookup"><span data-stu-id="64229-142">Pipeline Layer ASF Components</span></span>](pipeline-layer-asf-components.md)
</dt> <dt>

[<span data-ttu-id="64229-143">Compatibilidad con ASF en Media Foundation</span><span class="sxs-lookup"><span data-stu-id="64229-143">ASF Support in Media Foundation</span></span>](asf-support-in-media-foundation.md)
</dt> </dl>

 

 



