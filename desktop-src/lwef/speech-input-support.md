---
title: Compatibilidad con entrada de voz
description: Compatibilidad con entrada de voz
ms.assetid: 4702b941-fcc9-4d00-aba2-eca624b6d417
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b8ecb6f2ddfbbe10f8b892ce922cd466eca96890
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/19/2020
ms.locfileid: "105656357"
---
# <a name="speech-input-support"></a><span data-ttu-id="62f68-103">Compatibilidad con entrada de voz</span><span class="sxs-lookup"><span data-stu-id="62f68-103">Speech Input Support</span></span>

<span data-ttu-id="62f68-104">\[Microsoft Agent está en desuso a partir de Windows 7 y puede que no esté disponible en versiones posteriores de Windows.\]</span><span class="sxs-lookup"><span data-stu-id="62f68-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="62f68-105">Además de admitir la interacción con el mouse y el teclado, Microsoft Agent incluye compatibilidad directa para la entrada de voz.</span><span class="sxs-lookup"><span data-stu-id="62f68-105">In addition to supporting mouse and keyboard interaction, Microsoft Agent includes direct support for speech input.</span></span> <span data-ttu-id="62f68-106">Dado que la compatibilidad del agente de Microsoft con la entrada de voz se basa en Microsoft SAPI (interfaz de programación de aplicaciones de voz), puede usar el agente de Microsoft con los motores de control y comandos de reconocimiento de voz que incluyen la compatibilidad necesaria con SAPI.</span><span class="sxs-lookup"><span data-stu-id="62f68-106">Because Microsoft Agent's support for speech input is based on Microsoft SAPI (Speech Application Programming Interface), you can use Microsoft Agent with speech recognition command and control engines that include the SAPI-required support.</span></span> <span data-ttu-id="62f68-107">Para obtener más información sobre los requisitos del motor de voz, vea [requisitos de compatibilidad del motor de voz](requirements-for-speech-recognition-engines.md).</span><span class="sxs-lookup"><span data-stu-id="62f68-107">For more information on speech engine requirements, see [Speech Engine Support Requirements](requirements-for-speech-recognition-engines.md).</span></span>

<span data-ttu-id="62f68-108">Microsoft proporciona un motor de reconocimiento de voz de comando y control que puede usar con el agente de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="62f68-108">Microsoft provides a command-and-control speech recognition engine you can use with Microsoft Agent.</span></span> <span data-ttu-id="62f68-109">Para obtener más información, consulte [selección del motor de voz](speech-engine-selection.md).</span><span class="sxs-lookup"><span data-stu-id="62f68-109">For more information, see [Speech Engine Selection](speech-engine-selection.md).</span></span>

<span data-ttu-id="62f68-110">El usuario puede iniciar la entrada de voz si presiona y mantiene presionada la tecla de silencio para escuchar la lectura.</span><span class="sxs-lookup"><span data-stu-id="62f68-110">The user can initiate speech input by pressing and holding the push-to-talk Listening hotkey.</span></span> <span data-ttu-id="62f68-111">En este modo de escucha, si el motor de voz recibe el inicio de la entrada oral, mantiene el canal de audio abierto hasta que detecta el final del utterance.</span><span class="sxs-lookup"><span data-stu-id="62f68-111">In this Listening mode, if the speech engine receives the beginning of spoken input, it holds the audio channel open until it detects the end of the utterance.</span></span> <span data-ttu-id="62f68-112">Sin embargo, cuando no se recibe la entrada, no bloquea la salida de audio.</span><span class="sxs-lookup"><span data-stu-id="62f68-112">However, when not receiving input, it does not block audio output.</span></span> <span data-ttu-id="62f68-113">Esto permite al usuario emitir varios comandos de voz mientras mantiene presionada la tecla y el carácter puede responder cuando el usuario no está hablando.</span><span class="sxs-lookup"><span data-stu-id="62f68-113">This enables the user to issue multiple voice commands while holding down the key, and the character can respond when the user isn't speaking.</span></span>

<span data-ttu-id="62f68-114">El modo de escucha agota el tiempo de espera una vez que el usuario libera la clave de escucha.</span><span class="sxs-lookup"><span data-stu-id="62f68-114">The Listening mode times out once the user releases the Listening key.</span></span> <span data-ttu-id="62f68-115">El usuario puede ajustar el tiempo de espera de este modo mediante las opciones de caracteres avanzadas.</span><span class="sxs-lookup"><span data-stu-id="62f68-115">The user can adjust the time-out for this mode using the Advanced Character Options.</span></span> <span data-ttu-id="62f68-116">No se puede establecer este tiempo de espera desde el código de la aplicación cliente.</span><span class="sxs-lookup"><span data-stu-id="62f68-116">You cannot set this time-out from your client application code.</span></span>

<span data-ttu-id="62f68-117">Si un carácter intenta hablar mientras el usuario está hablando, se produce un error en la salida audible del carácter aunque el texto se siga mostrando en el globo de palabras.</span><span class="sxs-lookup"><span data-stu-id="62f68-117">If a character attempts to speak while the user is speaking, the character's audible output fails though text may still be displayed in its word balloon.</span></span> <span data-ttu-id="62f68-118">Si el carácter tiene el canal de audio mientras se presiona la tecla de escucha, el servidor transfiere automáticamente el control al usuario después de procesar el texto en el método [**Speak**](speak-method.md) .</span><span class="sxs-lookup"><span data-stu-id="62f68-118">If the character has the audio channel while the Listening key is pressed, the server automatically transfers control back to the user after processing the text in the [**Speak**](speak-method.md) method.</span></span> <span data-ttu-id="62f68-119">Se reproduce un tono MIDI opcional para señalar al usuario para que empiece a hablar.</span><span class="sxs-lookup"><span data-stu-id="62f68-119">An optional MIDI tone is played to cue the user to begin speaking.</span></span> <span data-ttu-id="62f68-120">Esto permite al usuario proporcionar la entrada incluso si la aplicación que conduce el carácter no proporcionó pausas lógicas en su salida.</span><span class="sxs-lookup"><span data-stu-id="62f68-120">This enables the user to provide input even if the application driving the character failed to provide logical pauses in its output.</span></span>

<span data-ttu-id="62f68-121">También puede usar el método [**Listen**](listen-method.md) para iniciar la entrada de voz.</span><span class="sxs-lookup"><span data-stu-id="62f68-121">You can also use the [**Listen**](listen-method.md) method to initiate speech input.</span></span> <span data-ttu-id="62f68-122">La llamada a este método activa el reconocimiento de voz durante un período de tiempo predefinido.</span><span class="sxs-lookup"><span data-stu-id="62f68-122">Calling this method turns on the speech recognition for a predefined period of time.</span></span> <span data-ttu-id="62f68-123">Si no hay ninguna entrada durante este intervalo, el agente de Microsoft desactiva automáticamente el motor de reconocimiento de voz y libera el canal de audio.</span><span class="sxs-lookup"><span data-stu-id="62f68-123">If there is no input during this interval, Microsoft Agent automatically turns off the speech recognition engine and frees up the audio channel.</span></span> <span data-ttu-id="62f68-124">Esto evita bloquear la entrada o salida del dispositivo de audio y minimiza la sobrecarga del procesador que el reconocimiento de voz usa cuando está activado.</span><span class="sxs-lookup"><span data-stu-id="62f68-124">This avoids blocking input to or output from the audio device and minimizes the processor overhead the speech recognition uses when it is on.</span></span> <span data-ttu-id="62f68-125">También puede usar el método **Listen** para desactivar la entrada de voz.</span><span class="sxs-lookup"><span data-stu-id="62f68-125">You can also use the **Listen** method to turn off speech input.</span></span> <span data-ttu-id="62f68-126">Sin embargo, tenga en cuenta que, dado que el motor de reconocimiento de voz funciona de forma asincrónica, el efecto puede no ser inmediato.</span><span class="sxs-lookup"><span data-stu-id="62f68-126">However, be aware that because the speech recognition engine operates asynchronously, the effect may not be immediate.</span></span> <span data-ttu-id="62f68-127">Como resultado, es posible recibir un evento de [**comando**](command-event.md) incluso después de que el código llamado **escuche** para desactivar la entrada de voz.</span><span class="sxs-lookup"><span data-stu-id="62f68-127">As a result, it is possible to receive a [**Command**](command-event.md) event even after your code called **Listen** to turn off speech input.</span></span>

<span data-ttu-id="62f68-128">Para admitir la entrada de voz, se define una *gramática*, un conjunto de palabras en las que se desea que el motor de reconocimiento de voz escuche y coincida como la configuración de **voz** de un [**comando**](/windows/desktop/lwef/the-command-object) en la colección de [**comandos**](/windows/desktop/lwef/the-commands-collection-object) .</span><span class="sxs-lookup"><span data-stu-id="62f68-128">To support speech input, you define a *grammar*, a set of words you want the speech recognition engine to listen and match for as the **Voice** setting for a [**Command**](/windows/desktop/lwef/the-command-object) in your [**Commands**](/windows/desktop/lwef/the-commands-collection-object) collection.</span></span> <span data-ttu-id="62f68-129">Puede incluir palabras opcionales y alternativas y secuencias repetidas en la gramática.</span><span class="sxs-lookup"><span data-stu-id="62f68-129">You can include optional and alternative words and repeated sequences in your grammar.</span></span> <span data-ttu-id="62f68-130">Tenga en cuenta que el agente no habilita la tecla de acceso rápido de escucha hasta que uno de sus clientes ha cargado correctamente un motor de voz o ha creado una **voz** para uno de sus objetos de **comando** .</span><span class="sxs-lookup"><span data-stu-id="62f68-130">Note that Agent does not enable the Listening hotkey until one of its clients has successfully loaded a speech engine or has authored a **Voice** for one of its **Command** objects.</span></span>

<span data-ttu-id="62f68-131">Si el usuario presiona la tecla de método de escucha o la aplicación cliente llama al método [**Listen**](listen-method.md) para iniciar la entrada de voz, el motor de reconocimiento de voz intenta hacer coincidir la entrada de un utterance con la gramática de los comandos que se han definido y devuelve la información de vuelta al servidor.</span><span class="sxs-lookup"><span data-stu-id="62f68-131">Whether the user presses the Listening hotkey or your client application calls the [**Listen**](listen-method.md) method to initiate speech input, the speech recognition engine attempts to match an utterance's input to the grammar for the commands that have been defined, and passes the information back the server.</span></span> <span data-ttu-id="62f68-132">A continuación, el servidor notifica a la aplicación cliente mediante el evento de [**comando**](command-event.md) ([**IAgentNotifySink:: Command**](iagentnotifysink--command.md)); devolver el objeto [**UserInput**](/windows/desktop/lwef/iagentuserinput) que incluye el identificador de comando de la mejor coincidencia y las dos coincidencias alternativas siguientes (si existen), una puntuación de confianza y el texto coincidente para cada coincidencia.</span><span class="sxs-lookup"><span data-stu-id="62f68-132">The server then notifies the client application using the [**Command**](command-event.md) event ([**IAgentNotifySink::Command**](iagentnotifysink--command.md)); passing back the [**UserInput**](/windows/desktop/lwef/iagentuserinput) object that includes the command ID of the best match and next two alternative matches (if any), a confidence score, and the matching text for each match.</span></span>

<span data-ttu-id="62f68-133">El servidor también notifica a la aplicación cliente cuando coincide con la entrada de voz a uno de sus comandos proporcionados.</span><span class="sxs-lookup"><span data-stu-id="62f68-133">The server also notifies your client application when it matches the speech input to one of its supplied commands.</span></span> <span data-ttu-id="62f68-134">Aunque el identificador de comando es **null**, se obtiene la puntuación de confianza y el texto coincidentes.</span><span class="sxs-lookup"><span data-stu-id="62f68-134">While the command ID is **NULL**, you still get the confidence score and text matched.</span></span> <span data-ttu-id="62f68-135">En el modo de escucha, el servidor reproduce automáticamente la animación asignada al estado de **escucha** del carácter.</span><span class="sxs-lookup"><span data-stu-id="62f68-135">When in Listening mode, the server automatically plays the animation assigned to the character's **Listening** state.</span></span> <span data-ttu-id="62f68-136">A continuación, cuando se detecta un utterance realmente, el servidor reproduce la animación del estado de la **audición** del carácter.</span><span class="sxs-lookup"><span data-stu-id="62f68-136">Then, when an utterance is actually detected, the server plays the character's **Hearing** state animation.</span></span> <span data-ttu-id="62f68-137">El servidor mantendrá el carácter en un estado Attentive hasta que haya finalizado utterance.</span><span class="sxs-lookup"><span data-stu-id="62f68-137">The server will keep the character in an attentive state until the utterance has ended.</span></span> <span data-ttu-id="62f68-138">Esto proporciona los comentarios sociales adecuados para señalar al usuario para la entrada.</span><span class="sxs-lookup"><span data-stu-id="62f68-138">This provides the appropriate social feedback to cue the user for input.</span></span>

<span data-ttu-id="62f68-139">Si el usuario deshabilita la entrada de voz en opciones de caracteres avanzadas, también se deshabilitará la Hotkey de escucha.</span><span class="sxs-lookup"><span data-stu-id="62f68-139">If the user disables speech input in Advanced Character Options, the Listening hotkey will also be disabled.</span></span> <span data-ttu-id="62f68-140">Del mismo modo, si se intenta llamar al método [**Listen**](listen-method.md) cuando la entrada de voz está deshabilitada, se producirá un error en el método.</span><span class="sxs-lookup"><span data-stu-id="62f68-140">Similarly, attempting to call the [**Listen**](listen-method.md) method when speech input is disabled will cause the method to fail.</span></span>

 

 