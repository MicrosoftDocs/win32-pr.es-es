---
description: Los consumidores de seguimiento de eventos pueden procesar eventos de uno o más proveedores.
ms.assetid: 039a9f66-228e-4258-9967-2b2cd7d31091
title: Consumir eventos (seguimiento de eventos)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 68ad8234cc66d07b5a52c10ab39c7d7b3c8aa029
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "104986087"
---
# <a name="consuming-events-event-tracing"></a><span data-ttu-id="34ee2-103">Consumir eventos (seguimiento de eventos)</span><span class="sxs-lookup"><span data-stu-id="34ee2-103">Consuming Events (Event Tracing)</span></span>

<span data-ttu-id="34ee2-104">Los consumidores de seguimiento de eventos pueden procesar eventos de uno o más proveedores.</span><span class="sxs-lookup"><span data-stu-id="34ee2-104">Event trace consumers can process events from one or more providers.</span></span> <span data-ttu-id="34ee2-105">Los consumidores pueden procesar eventos desde un archivo de registro o en tiempo real.</span><span class="sxs-lookup"><span data-stu-id="34ee2-105">Consumers can process events from a log file or in real time.</span></span> <span data-ttu-id="34ee2-106">Solo puede consumir eventos en tiempo real si el controlador especifica el modo de registro en tiempo real para la sesión.</span><span class="sxs-lookup"><span data-stu-id="34ee2-106">You can consume events in real time only if the controller specifies the real time logging mode for the session.</span></span> <span data-ttu-id="34ee2-107">Por motivos de rendimiento, no se recomienda el procesamiento en tiempo real antes de Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="34ee2-107">For performance reasons, real-time processing is not recommended prior to Windows Vista.</span></span>

<span data-ttu-id="34ee2-108">Para especificar la sesión de seguimiento desde la que desea procesar eventos, use la estructura de archivo de [**\_ \_ registro de seguimiento de eventos**](/windows/win32/api/evntrace/ns-evntrace-event_trace_logfilea) .</span><span class="sxs-lookup"><span data-stu-id="34ee2-108">To specify the trace session from which you want to process events, you use the [**EVENT\_TRACE\_LOGFILE**](/windows/win32/api/evntrace/ns-evntrace-event_trace_logfilea) structure.</span></span> <span data-ttu-id="34ee2-109">Debe inicializar una copia de esta estructura para cada archivo de registro o sesión en tiempo real que desee procesar.</span><span class="sxs-lookup"><span data-stu-id="34ee2-109">You must initialize a copy of this structure for each log file or real time session that you want to process.</span></span>

<span data-ttu-id="34ee2-110">Para consumir eventos de un archivo de registro, establezca el miembro **LogFileName** en el nombre del archivo de registro.</span><span class="sxs-lookup"><span data-stu-id="34ee2-110">To consume events from a log file, set the **LogFileName** member to the name of the log file.</span></span> <span data-ttu-id="34ee2-111">Para consumir eventos de una sesión en tiempo real, establezca el miembro **LoggerName** en el nombre de sesión.</span><span class="sxs-lookup"><span data-stu-id="34ee2-111">To consume events from real time session, set the **LoggerName** member to the session name.</span></span> <span data-ttu-id="34ee2-112">También puede usar esta estructura para especificar la devolución de llamada de [*BufferCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_trace_buffer_callbacka) y la devolución de llamada [*EventCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_callback) o [**EventRecordCallback**](/windows/win32/api/evntrace/nc-evntrace-pevent_record_callback) utilizada para procesar los eventos.</span><span class="sxs-lookup"><span data-stu-id="34ee2-112">You also use this structure to specify the [*BufferCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_trace_buffer_callbacka) callback and the [*EventCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_callback) or [**EventRecordCallback**](/windows/win32/api/evntrace/nc-evntrace-pevent_record_callback) callback used to process the events.</span></span>

-   <span data-ttu-id="34ee2-113">[**EventRecordCallback**](/windows/win32/api/evntrace/nc-evntrace-pevent_record_callback): recibe y procesa todos los eventos (incluido el evento de encabezado) de uno o varios archivos de registro y una sesión en tiempo real.</span><span class="sxs-lookup"><span data-stu-id="34ee2-113">[**EventRecordCallback**](/windows/win32/api/evntrace/nc-evntrace-pevent_record_callback)—Receives and processes all events (including the header event) from one or more log files and a real-time session.</span></span> <span data-ttu-id="34ee2-114">Puede implementar esta devolución de llamada si usa las funciones auxiliares de datos de seguimiento para analizar los datos de evento o si desea recuperar metadatos sobre el evento.</span><span class="sxs-lookup"><span data-stu-id="34ee2-114">You implement this callback if you use the trace data helper functions to parse the event data or you want to retrieve metadata about the event.</span></span>
-   <span data-ttu-id="34ee2-115">[*EventCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_callback): recibe y procesa todos los eventos (incluido el evento de encabezado) de uno o varios archivos de registro y una sesión en tiempo real.</span><span class="sxs-lookup"><span data-stu-id="34ee2-115">[*EventCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_callback)—Receives and processes all events (including the header event) from one or more log files and a real-time session.</span></span>
-   <span data-ttu-id="34ee2-116">[*BufferCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_trace_buffer_callbacka): recibe y procesa información de resumen sobre el búfer actual, como los eventos perdidos.</span><span class="sxs-lookup"><span data-stu-id="34ee2-116">[*BufferCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_trace_buffer_callbacka)—Receives and processes summary information about the current buffer, such as events lost.</span></span> <span data-ttu-id="34ee2-117">ETW llama a la devolución de llamada después de entregar todos los eventos del búfer al consumidor.</span><span class="sxs-lookup"><span data-stu-id="34ee2-117">ETW calls the callback after delivering all events in the buffer to the consumer.</span></span> <span data-ttu-id="34ee2-118">El consumidor también puede utilizar esta devolución de llamada para cancelar el procesamiento de eventos; sin embargo, si está consumiendo eventos en tiempo real, ETW entrega eventos hasta que el controlador detenga la sesión.</span><span class="sxs-lookup"><span data-stu-id="34ee2-118">The consumer can also use this callback to cancel event processing; however, if you are consuming events in real time, ETW delivers events until the controller stops the session.</span></span>

<span data-ttu-id="34ee2-119">Después de definir una o más sesiones de seguimiento, llame a la función [**OpenTrace**](/windows/win32/api/evntrace/nf-evntrace-opentracea) para cada sesión de seguimiento que desee procesar; puede procesar eventos de uno o varios archivos de registro, pero solo de una sesión en tiempo real.</span><span class="sxs-lookup"><span data-stu-id="34ee2-119">After defining one or more trace sessions, call the [**OpenTrace**](/windows/win32/api/evntrace/nf-evntrace-opentracea) function for each trace session that you want to process; you can process events from one or more log files, but from only one real-time session.</span></span> <span data-ttu-id="34ee2-120">A continuación, se pasa la lista de identificadores de sesión de seguimiento que **OpenTrace** devuelve a la función [**ProcessTrace**](/windows/win32/api/evntrace/nf-evntrace-processtrace) .</span><span class="sxs-lookup"><span data-stu-id="34ee2-120">You then pass the list of trace session handles that **OpenTrace** returns to the [**ProcessTrace**](/windows/win32/api/evntrace/nf-evntrace-processtrace) function.</span></span> <span data-ttu-id="34ee2-121">La función **ProcessTrace** combina los eventos, los ordena en orden cronológico y los entrega a las devoluciones de llamada de uno en uno.</span><span class="sxs-lookup"><span data-stu-id="34ee2-121">The **ProcessTrace** function combines the events, sorts them into chronological order, and then delivers them to the callbacks one at a time.</span></span> <span data-ttu-id="34ee2-122">Los eventos se pueden filtrar para incluir solo los que se encuentran en un intervalo de tiempo específico mediante los parámetros *startTime* y *EndTime* .</span><span class="sxs-lookup"><span data-stu-id="34ee2-122">The events can be filtered to include only those that fall into a specific time frame using the *StartTime* and *EndTime* parameters.</span></span> <span data-ttu-id="34ee2-123">La función **ProcessTrace** bloquea el subproceso hasta que el consumidor procesa todos los eventos en las sesiones de seguimiento, el [*BufferCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_trace_buffer_callbacka) devuelve **false** o se llama [**CloseTrace**](/windows/win32/api/evntrace/nf-evntrace-closetrace).</span><span class="sxs-lookup"><span data-stu-id="34ee2-123">The **ProcessTrace** function blocks the thread until your consumer processes all events in the trace sessions, the [*BufferCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_trace_buffer_callbacka) returns **FALSE**, or you call [**CloseTrace**](/windows/win32/api/evntrace/nf-evntrace-closetrace).</span></span>

<span data-ttu-id="34ee2-124">**Antes de Windows Vista:** Solo puede llamar a [**CloseTrace**](/windows/win32/api/evntrace/nf-evntrace-closetrace) después de que [**ProcessTrace**](/windows/win32/api/evntrace/nf-evntrace-processtrace) devuelva.</span><span class="sxs-lookup"><span data-stu-id="34ee2-124">**Prior to Windows Vista:** You can call [**CloseTrace**](/windows/win32/api/evntrace/nf-evntrace-closetrace) only after [**ProcessTrace**](/windows/win32/api/evntrace/nf-evntrace-processtrace) returns.</span></span>

<span data-ttu-id="34ee2-125">Para obtener un ejemplo en el que se muestra cómo consumir eventos publicados mediante un manifiesto, MOF o archivos TMF, vea [recuperar datos de eventos mediante TDH](retrieving-event-data-using-tdh.md).</span><span class="sxs-lookup"><span data-stu-id="34ee2-125">For an example that shows how to consume events published using a manifest, MOF, or TMF files, see [Retrieving Event Data Using TDH](retrieving-event-data-using-tdh.md).</span></span> <span data-ttu-id="34ee2-126">Tenga en cuenta que, a partir de Windows Vista, debe usar las funciones de la aplicación auxiliar de datos de seguimiento (TDH) para consumir eventos.</span><span class="sxs-lookup"><span data-stu-id="34ee2-126">Note that beginning with Windows Vista, you should use the trace data helper (TDH) functions to consume events.</span></span>

<span data-ttu-id="34ee2-127">Para obtener un ejemplo en el que se muestra cómo consumir eventos publicados mediante MOF, vea [recuperar datos de eventos mediante MOF](retrieving-event-data-using-mof.md).</span><span class="sxs-lookup"><span data-stu-id="34ee2-127">For an example that shows how to consume events published using MOF, see [Retrieving Event Data Using MOF](retrieving-event-data-using-mof.md).</span></span>

 

 
