---
title: Representación visual
description: Un control permite colocar y mostrarse en su contenedor mediante tecnología de documentos compuestos y tecnología OLE de arrastrar y colocar que implica tanto el control como su contenedor.
ms.assetid: a7940560-360c-4c0d-9ac1-d051adb0b83e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9711dccbc7aa17f0b4a2ff228b2e2e4421e5083b
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/16/2019
ms.locfileid: "103779956"
---
# <a name="visual-representation"></a><span data-ttu-id="e3dd8-103">Representación visual</span><span class="sxs-lookup"><span data-stu-id="e3dd8-103">Visual Representation</span></span>

<span data-ttu-id="e3dd8-104">Un control permite colocar y mostrarse en su contenedor mediante tecnología de documentos compuestos y tecnología OLE de arrastrar y colocar que implica tanto el control como su contenedor.</span><span class="sxs-lookup"><span data-stu-id="e3dd8-104">A control supports positioning and displaying itself within its container through compound document technology and OLE drag and drop technology that involves both the control and its container.</span></span> <span data-ttu-id="e3dd8-105">El control debe ser capaz de dibujarse a sí mismo mientras el contenedor administra la posición del control y su tamaño.</span><span class="sxs-lookup"><span data-stu-id="e3dd8-105">The control must be able to draw itself while the container manages the position of the control and its size.</span></span>

<span data-ttu-id="e3dd8-106">Los controles se agregan a las funciones básicas que proporcionan los documentos OLE.</span><span class="sxs-lookup"><span data-stu-id="e3dd8-106">Controls add to the basic functions provided by OLE documents.</span></span> <span data-ttu-id="e3dd8-107">Un control llama al método [**IOleClientSite:: RequestNewObjectLayout**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-requestnewobjectlayout) de su cliente para indicar a su contenedor que desea cambiar su tamaño.</span><span class="sxs-lookup"><span data-stu-id="e3dd8-107">A control calls its client's [**IOleClientSite::RequestNewObjectLayout**](/windows/desktop/api/OleIdl/nf-oleidl-ioleclientsite-requestnewobjectlayout) method to tell its container that it wants to change its size.</span></span> <span data-ttu-id="e3dd8-108">El cliente llama al método [**IOleObject:: GetExtent**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getextent) del control para obtener el nuevo tamaño y llama a [**IOleInPlaceObject:: SetObjectRects**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-setobjectrects) para establecer el control en su nuevo tamaño.</span><span class="sxs-lookup"><span data-stu-id="e3dd8-108">The client calls the control's [**IOleObject::GetExtent**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getextent) to get the new size and calls [**IOleInPlaceObject::SetObjectRects**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-setobjectrects) to set the control to its new size.</span></span>

<span data-ttu-id="e3dd8-109">Los controles que solo admiten [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) o [**IPersistStreamInit**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit) no admiten el almacenamiento en caché a través de [**IOleCache2**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache2) porque la memoria caché requiere compatibilidad para [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage).</span><span class="sxs-lookup"><span data-stu-id="e3dd8-109">Controls that support only [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) or [**IPersistStreamInit**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit) do not support caching through [**IOleCache2**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache2) because the cache requires support for [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage).</span></span> <span data-ttu-id="e3dd8-110">Sin embargo, estos controles deben proporcionar una manera para que el cliente represente el control a través de [**IDataObject:: GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata) para que el cliente pueda crear y administrar opcionalmente su propia memoria caché de los datos de presentación del control.</span><span class="sxs-lookup"><span data-stu-id="e3dd8-110">However, these controls should provide a way for the client to render the control through [**IDataObject::GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata) so the client can optionally create and manage its own cache of the presentation data for the control.</span></span>

<span data-ttu-id="e3dd8-111">Los controles usan el tipo HIMETRIC para sus coordenadas.</span><span class="sxs-lookup"><span data-stu-id="e3dd8-111">Controls use the HIMETRIC type for its coordinates.</span></span> <span data-ttu-id="e3dd8-112">Sin embargo, los distintos contenedores pueden utilizar distintos sistemas de coordenadas.</span><span class="sxs-lookup"><span data-stu-id="e3dd8-112">However, different containers can use different coordinate systems.</span></span> <span data-ttu-id="e3dd8-113">El contenedor desea recibir coordenadas en su propio sistema, pero el control no sabe necesariamente qué coordenadas está usando su contenedor.</span><span class="sxs-lookup"><span data-stu-id="e3dd8-113">The container wants to receive coordinates in its own system, but the control does not necessarily know what coordinates its container is using.</span></span> <span data-ttu-id="e3dd8-114">Para comunicarse correctamente, el control necesita una forma de convertir valores en las coordenadas de su contenedor.</span><span class="sxs-lookup"><span data-stu-id="e3dd8-114">To communicate successfully, the control needs a way to convert values to its container's coordinates.</span></span> <span data-ttu-id="e3dd8-115">El contenedor proporciona un objeto de sitio con el método [**IOleControlSite:: TransformCoords**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-transformcoords) .</span><span class="sxs-lookup"><span data-stu-id="e3dd8-115">The container provides a site object with the [**IOleControlSite::TransformCoords**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-transformcoords) method.</span></span> <span data-ttu-id="e3dd8-116">El control llama primero a este método en el sitio de cliente de su contenedor para convertir sus coordenadas en las coordenadas adecuadas para el contenedor.</span><span class="sxs-lookup"><span data-stu-id="e3dd8-116">The control calls this method on its container's client site first to convert its coordinates into the appropriate coordinates for the container.</span></span> <span data-ttu-id="e3dd8-117">A continuación, puede pasar las coordenadas convertidas al contenedor.</span><span class="sxs-lookup"><span data-stu-id="e3dd8-117">Then, it can pass the converted coordinates to the container.</span></span>

<span data-ttu-id="e3dd8-118">Los controles pueden llamar a [**IOleControlSite:: LockInPlaceActive**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-lockinplaceactive) en el objeto de sitio del contenedor para evitar que el contenedor intente degradar el control fuera del estado activo en contexto.</span><span class="sxs-lookup"><span data-stu-id="e3dd8-118">Controls can call [**IOleControlSite::LockInPlaceActive**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-lockinplaceactive) in the container's site object to prevent the container from attempting to demote the control out of the in-place active state.</span></span> <span data-ttu-id="e3dd8-119">Degradar el control de esta manera hace que el control se desactive y se destruya su ventana, por lo que si el control debe mantener su ventana durante un tiempo conocido, puede llamar a **LockInPlaceActive** para garantizar su estado.</span><span class="sxs-lookup"><span data-stu-id="e3dd8-119">Demoting the control in this way causes the control to be deactivated and its window destroyed, so if the control must maintain its window for a known duration it can call **LockInPlaceActive** to guarantee its state.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e3dd8-120">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="e3dd8-120">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e3dd8-121">Controles ActiveX</span><span class="sxs-lookup"><span data-stu-id="e3dd8-121">ActiveX Controls</span></span>](activex-controls.md)
</dt> </dl>

 

 




