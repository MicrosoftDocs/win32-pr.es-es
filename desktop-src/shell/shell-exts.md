---
description: En este conjunto de temas se explica cómo implementar los controladores de extensión que permiten modificar diversas acciones de Shell.
ms.assetid: 794b6369-665f-49a9-a263-7c736c5ce8ac
title: Trabajar con extensiones de Shell
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dbb696f4536cdb0fb6869be073771d431bd8d2de
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "104985986"
---
# <a name="working-with-shell-extensions"></a><span data-ttu-id="ec14c-103">Trabajar con extensiones de Shell</span><span class="sxs-lookup"><span data-stu-id="ec14c-103">Working with Shell Extensions</span></span>

<span data-ttu-id="ec14c-104">Las capacidades del shell se pueden extender con las entradas del registro y los archivos. ini.</span><span class="sxs-lookup"><span data-stu-id="ec14c-104">The capabilities of the Shell can be extended with registry entries and .ini files.</span></span> <span data-ttu-id="ec14c-105">Aunque este enfoque para extender el Shell es sencillo y adecuado para muchos propósitos, es limitado.</span><span class="sxs-lookup"><span data-stu-id="ec14c-105">While this approach to extending the Shell is simple, and adequate for many purposes, it is limited.</span></span> <span data-ttu-id="ec14c-106">Por ejemplo, si usa el registro para especificar un icono personalizado para un tipo de archivo, aparecerá el mismo icono para cada archivo de ese tipo.</span><span class="sxs-lookup"><span data-stu-id="ec14c-106">For example, if you use the registry to specify a custom icon for a file type, the same icon will appear for every file of that type.</span></span> <span data-ttu-id="ec14c-107">La extensión del shell con el registro no le permite modificar el icono de los distintos miembros del tipo de archivo.</span><span class="sxs-lookup"><span data-stu-id="ec14c-107">Extending the Shell with the registry does not allow you to vary the icon for different members of the file type.</span></span> <span data-ttu-id="ec14c-108">Otros aspectos del shell, como la hoja de propiedades **propiedades** que se pueden mostrar cuando se hace clic con el botón derecho en un archivo, no se pueden modificar en absoluto con el registro.</span><span class="sxs-lookup"><span data-stu-id="ec14c-108">Other aspects of the Shell, such as the **Properties** property sheet that can be displayed when a file is right-clicked, cannot be modified at all with the registry.</span></span>

<span data-ttu-id="ec14c-109">Un enfoque más eficaz y flexible para extender el Shell es implementar *controladores de extensión de Shell*.</span><span class="sxs-lookup"><span data-stu-id="ec14c-109">A more powerful and flexible approach to extending the Shell is to implement *shell extension handlers*.</span></span> <span data-ttu-id="ec14c-110">Estos controladores se pueden implementar para una serie de acciones que puede llevar a cabo el shell.</span><span class="sxs-lookup"><span data-stu-id="ec14c-110">These handlers can be implemented for a variety of actions that the Shell can take.</span></span> <span data-ttu-id="ec14c-111">Antes de realizar la acción, el shell consulta el controlador de extensión, lo que le otorga la oportunidad de modificar la acción.</span><span class="sxs-lookup"><span data-stu-id="ec14c-111">Before taking the action, the Shell queries the extension handler, giving it the opportunity to modify the action.</span></span> <span data-ttu-id="ec14c-112">Un ejemplo común es un controlador de extensión de menú contextual.</span><span class="sxs-lookup"><span data-stu-id="ec14c-112">A common example is a shortcut menu extension handler.</span></span> <span data-ttu-id="ec14c-113">Si se implementa una para un tipo de archivo, se consultará cada vez que se haga clic con el botón derecho en uno de los archivos.</span><span class="sxs-lookup"><span data-stu-id="ec14c-113">If one is implemented for a file type, it will be queried every time one of the files is right-clicked.</span></span> <span data-ttu-id="ec14c-114">A continuación, el controlador puede especificar elementos de menú adicionales cada archivo, en lugar de tener el mismo conjunto para todos los archivos de ese tipo de archivo.</span><span class="sxs-lookup"><span data-stu-id="ec14c-114">The handler can then specify additional menu items on a file-by-file basis, rather than having the same set for all files of that file type.</span></span>

<span data-ttu-id="ec14c-115">En este conjunto de temas se explica cómo implementar los controladores de extensión que permiten modificar diversas acciones de Shell.</span><span class="sxs-lookup"><span data-stu-id="ec14c-115">This set of topics discusses how to implement the extension handlers that allow you to modify a variety of Shell actions.</span></span> <span data-ttu-id="ec14c-116">Los siguientes controladores se asocian a un tipo de archivo determinado y permiten especificar cada archivo de forma individual.</span><span class="sxs-lookup"><span data-stu-id="ec14c-116">The following handlers are associated with a particular file type and allow you to specify on a file-by-file basis.</span></span>



| <span data-ttu-id="ec14c-117">Controlador</span><span class="sxs-lookup"><span data-stu-id="ec14c-117">Handler</span></span>                                               | <span data-ttu-id="ec14c-118">Descripción</span><span class="sxs-lookup"><span data-stu-id="ec14c-118">Description</span></span>                                                                                                                                                                |
|-------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="ec14c-119">Controlador del menú contextual</span><span class="sxs-lookup"><span data-stu-id="ec14c-119">Shortcut menu handler</span></span>](context-menu-handlers.md)    | <span data-ttu-id="ec14c-120">Se llama antes de que se muestre el menú contextual de un archivo.</span><span class="sxs-lookup"><span data-stu-id="ec14c-120">Called before a file's shortcut menu is displayed.</span></span> <span data-ttu-id="ec14c-121">Permite agregar elementos al menú contextual de forma individual para cada archivo.</span><span class="sxs-lookup"><span data-stu-id="ec14c-121">It enables you to add items to the shortcut menu on a file-by-file basis.</span></span>                                               |
| [<span data-ttu-id="ec14c-122">Controlador de datos</span><span class="sxs-lookup"><span data-stu-id="ec14c-122">Data handler</span></span>](how-to-create-data-handlers.md)       | <span data-ttu-id="ec14c-123">Se le llama cuando se realiza una operación de arrastrar y colocar en objetos de Shell.</span><span class="sxs-lookup"><span data-stu-id="ec14c-123">Called when a drag-and-drop operation is performed on Shell objects.</span></span> <span data-ttu-id="ec14c-124">Permite proporcionar formatos de Portapapeles adicionales al destino de colocación.</span><span class="sxs-lookup"><span data-stu-id="ec14c-124">It enables you to provide additional clipboard formats to the drop target.</span></span>                            |
| [<span data-ttu-id="ec14c-125">Quitar controlador</span><span class="sxs-lookup"><span data-stu-id="ec14c-125">Drop handler</span></span>](how-to-create-drop-handlers.md)       | <span data-ttu-id="ec14c-126">Se llama cuando se arrastra un objeto de datos o se coloca en un archivo.</span><span class="sxs-lookup"><span data-stu-id="ec14c-126">Called when a data object is dragged over or dropped on a file.</span></span> <span data-ttu-id="ec14c-127">Permite crear un archivo en un destino de colocación.</span><span class="sxs-lookup"><span data-stu-id="ec14c-127">It enables you to make a file into a drop target.</span></span>                                                          |
| [<span data-ttu-id="ec14c-128">Controlador de iconos</span><span class="sxs-lookup"><span data-stu-id="ec14c-128">Icon handler</span></span>](how-to-create-icon-handlers.md)       | <span data-ttu-id="ec14c-129">Se llama antes de que se muestre el icono de un archivo.</span><span class="sxs-lookup"><span data-stu-id="ec14c-129">Called before a file's icon is displayed.</span></span> <span data-ttu-id="ec14c-130">Permite reemplazar el icono predeterminado del archivo con un icono personalizado en función de cada archivo.</span><span class="sxs-lookup"><span data-stu-id="ec14c-130">It enables you to replace the file's default icon with a custom icon on a file-by-file basis.</span></span>                                    |
| [<span data-ttu-id="ec14c-131">Controlador de la hoja de propiedades</span><span class="sxs-lookup"><span data-stu-id="ec14c-131">Property sheet handler</span></span>](propsheet-handlers.md)      | <span data-ttu-id="ec14c-132">Se llama antes de que se muestre la hoja de propiedades de **propiedades** de un objeto.</span><span class="sxs-lookup"><span data-stu-id="ec14c-132">Called before an object's **Properties** property sheet is displayed.</span></span> <span data-ttu-id="ec14c-133">Permite agregar o reemplazar páginas.</span><span class="sxs-lookup"><span data-stu-id="ec14c-133">It enables you to add or replace pages.</span></span>                                                              |
| [<span data-ttu-id="ec14c-134">**Controlador de imagen en miniatura**</span><span class="sxs-lookup"><span data-stu-id="ec14c-134">**Thumbnail Image handler**</span></span>](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) | <span data-ttu-id="ec14c-135">Proporciona una imagen para representar el elemento.</span><span class="sxs-lookup"><span data-stu-id="ec14c-135">Provides an image to represent the item.</span></span>                                                                                                                                   |
| [<span data-ttu-id="ec14c-136">**Controlador de recuadro informativo**</span><span class="sxs-lookup"><span data-stu-id="ec14c-136">**Infotip handler**</span></span>](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo)                 | <span data-ttu-id="ec14c-137">Proporciona texto emergente cuando el usuario mantiene el puntero del mouse sobre el objeto.</span><span class="sxs-lookup"><span data-stu-id="ec14c-137">Provides pop-up text when the user hovers the mouse pointer over the object.</span></span>                                                                                               |
| [<span data-ttu-id="ec14c-138">**Controlador de metadatos**</span><span class="sxs-lookup"><span data-stu-id="ec14c-138">**Metadata handler**</span></span>](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage)       | <span data-ttu-id="ec14c-139">Proporciona acceso de lectura y escritura a los metadatos (propiedades) almacenados en un archivo.</span><span class="sxs-lookup"><span data-stu-id="ec14c-139">Provides read and write access to metadata (properties) stored in a file.</span></span> <span data-ttu-id="ec14c-140">Se puede usar para ampliar la vista de detalles, recuadros informativos, la página de propiedades y las características de agrupación.</span><span class="sxs-lookup"><span data-stu-id="ec14c-140">This can be used to extend the Details view, infotips, the property page, and grouping features.</span></span> |



 

<span data-ttu-id="ec14c-141">Otros no están asociados a un tipo de archivo determinado, pero se les llama antes que algunas operaciones de Shell.</span><span class="sxs-lookup"><span data-stu-id="ec14c-141">Others are not associated with a particular file type but are called before some Shell operations.</span></span>



| <span data-ttu-id="ec14c-142">Controlador</span><span class="sxs-lookup"><span data-stu-id="ec14c-142">Handler</span></span>                                                            | <span data-ttu-id="ec14c-143">Descripción</span><span class="sxs-lookup"><span data-stu-id="ec14c-143">Description</span></span>                                                                                                                                  |
|--------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="ec14c-144">Controlador de columnas</span><span class="sxs-lookup"><span data-stu-id="ec14c-144">Column handler</span></span>](../lwef/column-handlers.md)                             | <span data-ttu-id="ec14c-145">Lo llama el explorador de Windows antes de mostrar la vista de detalles de una carpeta.</span><span class="sxs-lookup"><span data-stu-id="ec14c-145">Called by Windows Explorer before it displays the Details view of a folder.</span></span> <span data-ttu-id="ec14c-146">Permite agregar columnas personalizadas a la vista de detalles.</span><span class="sxs-lookup"><span data-stu-id="ec14c-146">It enables you to add custom columns to the Details view.</span></span>        |
| [<span data-ttu-id="ec14c-147">Copiar controlador de enlace</span><span class="sxs-lookup"><span data-stu-id="ec14c-147">Copy hook handler</span></span>](how-to-create-copy-hook-handlers.md)          | <span data-ttu-id="ec14c-148">Se llama cuando una carpeta o un objeto de impresora está a punto de moverse, copiarse, eliminarse o cambiarse de nombre.</span><span class="sxs-lookup"><span data-stu-id="ec14c-148">Called when a folder or printer object is about to be moved, copied, deleted, or renamed.</span></span> <span data-ttu-id="ec14c-149">Permite aprobar o vetar la operación.</span><span class="sxs-lookup"><span data-stu-id="ec14c-149">It enables you to approve or veto the operation.</span></span>   |
| [<span data-ttu-id="ec14c-150">Controlador de arrastrar y colocar</span><span class="sxs-lookup"><span data-stu-id="ec14c-150">Drag-and-drop handler</span></span>](context-menu-handlers.md)                 | <span data-ttu-id="ec14c-151">Se le llama cuando se arrastra un archivo con el botón secundario del mouse.</span><span class="sxs-lookup"><span data-stu-id="ec14c-151">Called when a file is dragged with the right mouse button.</span></span> <span data-ttu-id="ec14c-152">Permite modificar el menú contextual que se muestra.</span><span class="sxs-lookup"><span data-stu-id="ec14c-152">It enables you to modify the shortcut menu that is displayed.</span></span>                     |
| [<span data-ttu-id="ec14c-153">Controlador de superposición de iconos</span><span class="sxs-lookup"><span data-stu-id="ec14c-153">Icon Overlay handler</span></span>](how-to-implement-icon-overlay-handlers.md) | <span data-ttu-id="ec14c-154">Se llama antes de que se muestre el icono de un archivo.</span><span class="sxs-lookup"><span data-stu-id="ec14c-154">Called before a file's icon is displayed.</span></span> <span data-ttu-id="ec14c-155">Permite especificar una superposición para el icono del archivo.</span><span class="sxs-lookup"><span data-stu-id="ec14c-155">It enables you to specify an overlay for the file's icon.</span></span>                                          |
| [<span data-ttu-id="ec14c-156">Controlador de búsqueda</span><span class="sxs-lookup"><span data-stu-id="ec14c-156">Search handler</span></span>](../lwef/search-handlers.md)                             | <span data-ttu-id="ec14c-157">Se llama para iniciar un motor de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="ec14c-157">Called to launch a search engine.</span></span> <span data-ttu-id="ec14c-158">Permite implementar un motor de búsqueda personalizado accesible desde el menú **Inicio** o el explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="ec14c-158">It enables you to implement a custom search engine accessible from the **Start** menu or Windows Explorer.</span></span> |



 

<span data-ttu-id="ec14c-159">Los detalles sobre cómo implementar controladores de extensión específicos se tratan en las secciones anteriores.</span><span class="sxs-lookup"><span data-stu-id="ec14c-159">The details of how to implement specific extension handlers are covered in the sections listed above.</span></span> <span data-ttu-id="ec14c-160">Para obtener una discusión de los problemas de implementación comunes a todos los controladores de extensión de Shell, vea estos temas:</span><span class="sxs-lookup"><span data-stu-id="ec14c-160">For discussions of implementation issues that are common to all Shell extension handlers, see these topics:</span></span>

-   [<span data-ttu-id="ec14c-161">Inicializar controladores de extensión de Shell</span><span class="sxs-lookup"><span data-stu-id="ec14c-161">Initializing Shell Extension Handlers</span></span>](int-shell-exts.md)
-   [<span data-ttu-id="ec14c-162">Registrando controladores de extensión de Shell</span><span class="sxs-lookup"><span data-stu-id="ec14c-162">Registering Shell Extension Handlers</span></span>](reg-shell-exts.md)

 

 
