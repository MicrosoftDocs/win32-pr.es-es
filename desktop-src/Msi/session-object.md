---
description: El objeto de sesión controla el proceso de instalación.
ms.assetid: 013959d9-900c-45f7-b742-17b0365d6107
title: Objeto Session (Windows Installer)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- Session
api_type:
- COM
api_location:
- Msi.dll
ms.openlocfilehash: c391249d5ccc58fe9a947c9db761a77521c9776d
ms.sourcegitcommit: c8ec1ded1ffffc364d3c4f560bb2171da0dc5040
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/22/2021
ms.locfileid: "105653976"
---
# <a name="session-object-windows-installer"></a><span data-ttu-id="56f7c-103">Objeto Session (Windows Installer)</span><span class="sxs-lookup"><span data-stu-id="56f7c-103">Session object (Windows Installer)</span></span>

<span data-ttu-id="56f7c-104">El objeto de **sesión** controla el proceso de instalación.</span><span class="sxs-lookup"><span data-stu-id="56f7c-104">The **Session** object controls the installation process.</span></span> <span data-ttu-id="56f7c-105">Se abre la base de datos del instalador, que contiene las tablas y los datos de instalación.</span><span class="sxs-lookup"><span data-stu-id="56f7c-105">It opens the Installer database, which contains the installation tables and data.</span></span> <span data-ttu-id="56f7c-106">Este objeto está asociado a un conjunto estándar de funciones de acción, cada una de las cuales realiza operaciones particulares en los datos de una o más tablas.</span><span class="sxs-lookup"><span data-stu-id="56f7c-106">This object is associated with a standard set of action functions, each performing particular operations on data from one or more tables.</span></span> <span data-ttu-id="56f7c-107">Se pueden agregar acciones personalizadas adicionales para instalaciones de productos determinadas.</span><span class="sxs-lookup"><span data-stu-id="56f7c-107">Additional custom actions may be added for particular product installations.</span></span> <span data-ttu-id="56f7c-108">La función básica Engine es un secuenciador que captura registros secuenciales de una tabla de secuencia designada, evalúa cualquier expresión de condición especificada y ejecuta la acción designada.</span><span class="sxs-lookup"><span data-stu-id="56f7c-108">The basic engine function is a sequencer that fetches sequential records from a designated sequence table, evaluates any specified condition expression, and executes the designated action.</span></span> <span data-ttu-id="56f7c-109">Las acciones no reconocidas por el motor se difieren al objeto de controlador de interfaz de usuario para el procesamiento, normalmente secuencias de cuadros de diálogo.</span><span class="sxs-lookup"><span data-stu-id="56f7c-109">Actions not recognized by the engine are deferred to the UI handler object for processing, usually dialog box sequences.</span></span>

<span data-ttu-id="56f7c-110">Tenga en cuenta que solo un único proceso puede abrir un objeto de **sesión** .</span><span class="sxs-lookup"><span data-stu-id="56f7c-110">Note that only one **Session** object can be opened by a single process.</span></span>

## <a name="members"></a><span data-ttu-id="56f7c-111">Miembros</span><span class="sxs-lookup"><span data-stu-id="56f7c-111">Members</span></span>

<span data-ttu-id="56f7c-112">El objeto de **sesión** tiene estos tipos de miembros:</span><span class="sxs-lookup"><span data-stu-id="56f7c-112">The **Session** object has these types of members:</span></span>

-   [<span data-ttu-id="56f7c-113">Métodos</span><span class="sxs-lookup"><span data-stu-id="56f7c-113">Methods</span></span>](#methods)
-   [<span data-ttu-id="56f7c-114">Propiedades</span><span class="sxs-lookup"><span data-stu-id="56f7c-114">Properties</span></span>](#properties)

### <a name="methods"></a><span data-ttu-id="56f7c-115">Métodos</span><span class="sxs-lookup"><span data-stu-id="56f7c-115">Methods</span></span>

<span data-ttu-id="56f7c-116">El objeto de **sesión** tiene estos métodos.</span><span class="sxs-lookup"><span data-stu-id="56f7c-116">The **Session** object has these methods.</span></span>



| <span data-ttu-id="56f7c-117">Método</span><span class="sxs-lookup"><span data-stu-id="56f7c-117">Method</span></span>                                                 | <span data-ttu-id="56f7c-118">Descripción</span><span class="sxs-lookup"><span data-stu-id="56f7c-118">Description</span></span>                                                                                                                                                                                                                                                               |
|:-------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="56f7c-119">**DoAction**</span><span class="sxs-lookup"><span data-stu-id="56f7c-119">**DoAction**</span></span>](session-doaction.md)                   | <span data-ttu-id="56f7c-120">Ejecuta la acción especificada.</span><span class="sxs-lookup"><span data-stu-id="56f7c-120">Executes the specified action.</span></span> <br/>                                                                                                                                                                                                                                |
| [<span data-ttu-id="56f7c-121">**EvaluateCondition**</span><span class="sxs-lookup"><span data-stu-id="56f7c-121">**EvaluateCondition**</span></span>](session-evaluatecondition.md) | <span data-ttu-id="56f7c-122">Evalúa una expresión lógica que contiene símbolos y valores y devuelve un entero de la enumeración msiEvaluateConditionErrorEnum.</span><span class="sxs-lookup"><span data-stu-id="56f7c-122">Evaluates a logical expression containing symbols and values and returns an integer of the enumeration msiEvaluateConditionErrorEnum.</span></span><br/>                                                                                                                          |
| [<span data-ttu-id="56f7c-123">**FeatureInfo**</span><span class="sxs-lookup"><span data-stu-id="56f7c-123">**FeatureInfo**</span></span>](session-featureinfo.md)             | <span data-ttu-id="56f7c-124">Devuelve un objeto [**FeatureInfo**](featureinfo-object.md) que contiene información descriptiva de la característica especificada.</span><span class="sxs-lookup"><span data-stu-id="56f7c-124">Returns a [**FeatureInfo**](featureinfo-object.md) object containing descriptive information for the specified feature.</span></span><br/>                                                                                                                                       |
| [<span data-ttu-id="56f7c-125">**FormatRecord**</span><span class="sxs-lookup"><span data-stu-id="56f7c-125">**FormatRecord**</span></span>](session-formatrecord.md)           | <span data-ttu-id="56f7c-126">Devuelve una cadena con formato de los datos de la plantilla y del registro.</span><span class="sxs-lookup"><span data-stu-id="56f7c-126">Returns a formatted string from template and record data.</span></span><br/>                                                                                                                                                                                                      |
| [<span data-ttu-id="56f7c-127">**Message**</span><span class="sxs-lookup"><span data-stu-id="56f7c-127">**Message**</span></span>](session-message.md)                     | <span data-ttu-id="56f7c-128">Realiza cualquier operación de registro habilitada y pospone la ejecución al objeto de controlador de interfaz de usuario asociado al motor.</span><span class="sxs-lookup"><span data-stu-id="56f7c-128">Performs any enabled logging operations and defers execution to the UI handler object associated with the engine.</span></span><br/>                                                                                                                                              |
| [<span data-ttu-id="56f7c-129">**SPRJ**</span><span class="sxs-lookup"><span data-stu-id="56f7c-129">**Sequence**</span></span>](session-sequence.md)                   | <span data-ttu-id="56f7c-130">Abre una consulta en la tabla especificada, ordenando las acciones por los números de la columna de secuencia.</span><span class="sxs-lookup"><span data-stu-id="56f7c-130">Opens a query on the specified table, ordering the actions by the numbers in the Sequence column.</span></span> <span data-ttu-id="56f7c-131">Para cada fila capturada, se llama al método [**OnAction**](session-doaction.md) , siempre que cualquier expresión de condición proporcionada no se evalúe como false.</span><span class="sxs-lookup"><span data-stu-id="56f7c-131">For each row fetched, the [**DoAction**](session-doaction.md) method is called, provided that any supplied condition expression does not evaluate to False.</span></span><br/> |
| [<span data-ttu-id="56f7c-132">**SetInstallLevel**</span><span class="sxs-lookup"><span data-stu-id="56f7c-132">**SetInstallLevel**</span></span>](session-setinstalllevel.md)     | <span data-ttu-id="56f7c-133">Establece el nivel de instalación de la instalación actual en un valor especificado y vuelve a calcular los Estados SELECT y installed para todas las características.</span><span class="sxs-lookup"><span data-stu-id="56f7c-133">Sets the install level for the current installation to a specified value and recalculates the Select and Installed states for all features.</span></span><br/>                                                                                                                    |



 

### <a name="properties"></a><span data-ttu-id="56f7c-134">Propiedades</span><span class="sxs-lookup"><span data-stu-id="56f7c-134">Properties</span></span>

<span data-ttu-id="56f7c-135">El objeto de **sesión** tiene estas propiedades.</span><span class="sxs-lookup"><span data-stu-id="56f7c-135">The **Session** object has these properties.</span></span>



| <span data-ttu-id="56f7c-136">Propiedad</span><span class="sxs-lookup"><span data-stu-id="56f7c-136">Property</span></span>                                                                  | <span data-ttu-id="56f7c-137">Tipo de acceso</span><span class="sxs-lookup"><span data-stu-id="56f7c-137">Access type</span></span>           | <span data-ttu-id="56f7c-138">Descripción</span><span class="sxs-lookup"><span data-stu-id="56f7c-138">Description</span></span>                                                                                                                                                                |
|:--------------------------------------------------------------------------|:----------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="56f7c-139">**ComponentCosts**</span><span class="sxs-lookup"><span data-stu-id="56f7c-139">**ComponentCosts**</span></span>](session-componentcosts.md)<br/>               |                       | <span data-ttu-id="56f7c-140">Devuelve un objeto [**RecordList**](recordlist-object.md) que enumera el espacio en disco por unidad necesaria para instalar un componente.</span><span class="sxs-lookup"><span data-stu-id="56f7c-140">Returns a [**RecordList**](recordlist-object.md) object enumerating the disk space per drive required to install a component.</span></span><br/>                                  |
| [<span data-ttu-id="56f7c-141">**ComponentCurrentState**</span><span class="sxs-lookup"><span data-stu-id="56f7c-141">**ComponentCurrentState**</span></span>](session-componentcurrentstate.md)<br/> |                       | <span data-ttu-id="56f7c-142">Devuelve el estado instalado actual del componente designado.</span><span class="sxs-lookup"><span data-stu-id="56f7c-142">Returns the current installed state of the designated component.</span></span><br/>                                                                                                |
| [<span data-ttu-id="56f7c-143">**ComponentRequestState**</span><span class="sxs-lookup"><span data-stu-id="56f7c-143">**ComponentRequestState**</span></span>](session-componentrequeststate.md)<br/> |                       | <span data-ttu-id="56f7c-144">Obtiene o solicita un cambio en el estado de acción de una fila de la tabla de componentes.</span><span class="sxs-lookup"><span data-stu-id="56f7c-144">Obtains or requests a change in the Action state of a row in the Component table.</span></span><br/>                                                                               |
| [<span data-ttu-id="56f7c-145">**Base de datos**</span><span class="sxs-lookup"><span data-stu-id="56f7c-145">**Database**</span></span>](session-database.md)<br/>                           |                       | <span data-ttu-id="56f7c-146">Devuelve la base de datos de la sesión de instalación actual.</span><span class="sxs-lookup"><span data-stu-id="56f7c-146">Returns the database for the current installation session.</span></span><br/>                                                                                                      |
| [<span data-ttu-id="56f7c-147">**FeatureCost**</span><span class="sxs-lookup"><span data-stu-id="56f7c-147">**FeatureCost**</span></span>](session-featurecost.md)<br/>                     |                       | <span data-ttu-id="56f7c-148">Devuelve la cantidad total de espacio en disco (en unidades de 512 bytes) que requiere la característica especificada y sus características principales (hasta la raíz de la tabla de características).</span><span class="sxs-lookup"><span data-stu-id="56f7c-148">Returns the total amount of disk space (in units of 512 bytes) required by the specified feature and its parent features (up to the root of the Feature table).</span></span><br/> |
| [<span data-ttu-id="56f7c-149">**FeatureCurrentState**</span><span class="sxs-lookup"><span data-stu-id="56f7c-149">**FeatureCurrentState**</span></span>](session-featurecurrentstate.md)<br/>     |                       | <span data-ttu-id="56f7c-150">Devuelve el estado instalado actual de la característica designada.</span><span class="sxs-lookup"><span data-stu-id="56f7c-150">Returns the current installed state of the designated feature.</span></span><br/>                                                                                                  |
| [<span data-ttu-id="56f7c-151">**FeatureRequestState**</span><span class="sxs-lookup"><span data-stu-id="56f7c-151">**FeatureRequestState**</span></span>](session-featurerequeststate.md)<br/>     | <span data-ttu-id="56f7c-152">Lectura/escritura</span><span class="sxs-lookup"><span data-stu-id="56f7c-152">Read/write</span></span><br/> | <span data-ttu-id="56f7c-153">Obtiene o solicita un cambio en el estado de selección del registro y los subregistros de una característica.</span><span class="sxs-lookup"><span data-stu-id="56f7c-153">Obtains or requests a change in the Select state of a feature's record and subrecords.</span></span><br/>                                                                          |
| [<span data-ttu-id="56f7c-154">**FeatureValidStates**</span><span class="sxs-lookup"><span data-stu-id="56f7c-154">**FeatureValidStates**</span></span>](session-featurevalidstates.md)<br/>       |                       | <span data-ttu-id="56f7c-155">Devuelve un entero que representa las marcas de bits con cada bit pertinente que representa un estado de instalación válido de la característica especificada.</span><span class="sxs-lookup"><span data-stu-id="56f7c-155">Returns an integer representing bit flags with each relevant bit representing a valid installation state for the specified feature.</span></span><br/>                             |
| [<span data-ttu-id="56f7c-156">**Instalador**</span><span class="sxs-lookup"><span data-stu-id="56f7c-156">**Installer**</span></span>](session-installer.md)<br/>                         |                       | <span data-ttu-id="56f7c-157">Devuelve el objeto de instalador activo.</span><span class="sxs-lookup"><span data-stu-id="56f7c-157">Returns the active installer object.</span></span><br/>                                                                                                                            |
| [<span data-ttu-id="56f7c-158">**Language (objeto de sesión)**</span><span class="sxs-lookup"><span data-stu-id="56f7c-158">**Language (Session Object)**</span></span>](session-language.md)<br/>          |                       | <span data-ttu-id="56f7c-159">Representa el identificador de idioma numérico utilizado por la sesión de instalación actual.</span><span class="sxs-lookup"><span data-stu-id="56f7c-159">Represents the numeric language identifier used by the current installation session.</span></span><br/>                                                                            |
| [<span data-ttu-id="56f7c-160">**Mode**</span><span class="sxs-lookup"><span data-stu-id="56f7c-160">**Mode**</span></span>](session-mode.md)<br/>                                   |                       | <span data-ttu-id="56f7c-161">Esta propiedad es un valor que representa la marca de modo designado para la sesión de instalación actual.</span><span class="sxs-lookup"><span data-stu-id="56f7c-161">This property is a value representing the designated mode flag for the current installation session.</span></span><br/>                                                            |
| [<span data-ttu-id="56f7c-162">**ProductProperty**</span><span class="sxs-lookup"><span data-stu-id="56f7c-162">**ProductProperty**</span></span>](session-productproperty.md)<br/>             |                       | <span data-ttu-id="56f7c-163">Representa el valor de cadena de una propiedad de instalador con nombre.</span><span class="sxs-lookup"><span data-stu-id="56f7c-163">Represents the string value of a named installer property.</span></span><br/>                                                                                                      |
| [<span data-ttu-id="56f7c-164">**Property (objeto de sesión)**</span><span class="sxs-lookup"><span data-stu-id="56f7c-164">**Property (Session Object)**</span></span>](session-session.md)<br/>           | <span data-ttu-id="56f7c-165">Lectura/escritura</span><span class="sxs-lookup"><span data-stu-id="56f7c-165">Read/write</span></span><br/> | <span data-ttu-id="56f7c-166">Recupera las propiedades del producto de la base de datos del producto.</span><span class="sxs-lookup"><span data-stu-id="56f7c-166">Retrieves product properties from the product database.</span></span><br/>                                                                                                         |
| [<span data-ttu-id="56f7c-167">**SourcePath**</span><span class="sxs-lookup"><span data-stu-id="56f7c-167">**SourcePath**</span></span>](session-sourcepath.md)<br/>                       |                       | <span data-ttu-id="56f7c-168">Proporciona la ruta de acceso completa a la carpeta designada en el medio de origen o la imagen del servidor.</span><span class="sxs-lookup"><span data-stu-id="56f7c-168">Provides the full path to the designated folder on the source media or server image.</span></span><br/>                                                                            |
| [<span data-ttu-id="56f7c-169">**TargetPath**</span><span class="sxs-lookup"><span data-stu-id="56f7c-169">**TargetPath**</span></span>](session-targetpath.md)<br/>                       | <span data-ttu-id="56f7c-170">Lectura/escritura</span><span class="sxs-lookup"><span data-stu-id="56f7c-170">Read/write</span></span><br/> | <span data-ttu-id="56f7c-171">Proporciona la ruta de acceso completa a la carpeta designada en la unidad de destino de la instalación.</span><span class="sxs-lookup"><span data-stu-id="56f7c-171">Provides the full path to the designated folder on the installation target drive.</span></span><br/>                                                                               |
| [<span data-ttu-id="56f7c-172">**VerifyDiskSpace**</span><span class="sxs-lookup"><span data-stu-id="56f7c-172">**VerifyDiskSpace**</span></span>](session-verifydiskspace.md)<br/>             |                       | <span data-ttu-id="56f7c-173">Devuelve true si existe suficiente espacio en disco y false si el disco está lleno.</span><span class="sxs-lookup"><span data-stu-id="56f7c-173">Returns true if enough disk space exists, and false if the disk is full.</span></span><br/>                                                                                        |



 

## <a name="requirements"></a><span data-ttu-id="56f7c-174">Requisitos</span><span class="sxs-lookup"><span data-stu-id="56f7c-174">Requirements</span></span>



| <span data-ttu-id="56f7c-175">Requisito</span><span class="sxs-lookup"><span data-stu-id="56f7c-175">Requirement</span></span> | <span data-ttu-id="56f7c-176">Value</span><span class="sxs-lookup"><span data-stu-id="56f7c-176">Value</span></span> |
|--------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="56f7c-177">Versión</span><span class="sxs-lookup"><span data-stu-id="56f7c-177">Version</span></span><br/> | <span data-ttu-id="56f7c-178">Windows Installer 5,0 en Windows Server 2012, Windows 8, Windows Server 2008 R2 o Windows 7.</span><span class="sxs-lookup"><span data-stu-id="56f7c-178">Windows Installer 5.0 on Windows Server 2012, Windows 8, Windows Server 2008 R2 or Windows 7.</span></span> <span data-ttu-id="56f7c-179">Windows Installer 4,0 o Windows Installer 4,5 en Windows Server 2008 o Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="56f7c-179">Windows Installer 4.0 or Windows Installer 4.5 on Windows Server 2008 or Windows Vista.</span></span> <span data-ttu-id="56f7c-180">Windows Installer en Windows Server 2003 o Windows XP</span><span class="sxs-lookup"><span data-stu-id="56f7c-180">Windows Installer on Windows Server 2003 or Windows XP</span></span><br/> |
| <span data-ttu-id="56f7c-181">Archivo DLL</span><span class="sxs-lookup"><span data-stu-id="56f7c-181">DLL</span></span><br/>     | <dl> <span data-ttu-id="56f7c-182"><dt>Msi.dll</dt></span><span class="sxs-lookup"><span data-stu-id="56f7c-182"><dt>Msi.dll</dt></span></span> </dl>                                                                                                                                                                      |
| <span data-ttu-id="56f7c-183">IID</span><span class="sxs-lookup"><span data-stu-id="56f7c-183">IID</span></span><br/>     | <span data-ttu-id="56f7c-184">El IID \_ ISession se define como 000C109E-0000-0000-C000-000000000046</span><span class="sxs-lookup"><span data-stu-id="56f7c-184">IID\_ISession is defined as 000C109E-0000-0000-C000-000000000046</span></span><br/>                                                                                                                                                                             |



## <a name="see-also"></a><span data-ttu-id="56f7c-185">Vea también</span><span class="sxs-lookup"><span data-stu-id="56f7c-185">See also</span></span>

<dl> <dt>

[<span data-ttu-id="56f7c-186">Ejemplos de scripting Windows Installer</span><span class="sxs-lookup"><span data-stu-id="56f7c-186">Windows Installer Scripting Examples</span></span>](windows-installer-scripting-examples.md)
</dt> </dl>

 

 




