---
title: Imprimir hoja de propiedades
description: La hoja de propiedades imprimir es una interfaz de usuario estándar que permite al usuario especificar las propiedades de un trabajo de impresión determinado.
ms.assetid: b52b71cc-a583-4a21-8a53-501ab442e6f8
keywords:
- Interfaz de usuario de Windows, entrada de usuario
- Interfaz de usuario de Windows, biblioteca de cuadros de diálogo comunes
- entrada de usuario, biblioteca de cuadros de diálogo comunes
- capturar la entrada del usuario, la biblioteca de cuadros de diálogo comunes
- Biblioteca de cuadros de diálogo comunes
- cuadros de diálogo comunes
- Cuadro de diálogo Imprimir hoja de propiedades
- cuadro de diálogo Personalizar hoja de propiedades de impresión
- cuadros de diálogo predefinidos
- cuadros de diálogo, hoja de propiedades imprimir
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 20905f76af290b3978bec828a382604147297998
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104078338"
---
# <a name="print-property-sheet"></a><span data-ttu-id="a361a-113">Imprimir hoja de propiedades</span><span class="sxs-lookup"><span data-stu-id="a361a-113">Print Property Sheet</span></span>

<span data-ttu-id="a361a-114">La hoja de propiedades **Imprimir** es una interfaz de usuario estándar que permite al usuario especificar las propiedades de un trabajo de impresión determinado.</span><span class="sxs-lookup"><span data-stu-id="a361a-114">The **Print** property sheet is a standard user interface that enables the user to specify the properties of a particular print job.</span></span> <span data-ttu-id="a361a-115">La hoja de propiedades se compone de un conjunto de páginas de propiedades que varía según la impresora o la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a361a-115">The property sheet is composed of a set of property pages that varies by printer or application.</span></span> <span data-ttu-id="a361a-116">En un subconjunto de las páginas de propiedades estándar de Windows, algunas impresoras pueden agregar páginas de propiedades específicas del controlador y algunas aplicaciones pueden agregar páginas de propiedades específicas de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a361a-116">To a subset of standard Windows property pages, some printers might add driver-specific property pages and some applications might add application-specific property pages.</span></span>

<span data-ttu-id="a361a-117">Para crear y mostrar una hoja de propiedades de **impresión** , inicialice una estructura [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) y pase la estructura a la función [**PRINTDLGEX**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="a361a-117">To create and display a **Print** property sheet, initialize a [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure and pass the structure to the [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function.</span></span>

<span data-ttu-id="a361a-118">En la ilustración siguiente se muestra una hoja de propiedades de **impresión** típica.</span><span class="sxs-lookup"><span data-stu-id="a361a-118">The following illustration shows a typical **Print** property sheet.</span></span>

![hoja de propiedades de la impresora](images/printerpropertypagexp.png)

<span data-ttu-id="a361a-120">La mayoría de los miembros de la estructura [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) son idénticos a los de la estructura [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) .</span><span class="sxs-lookup"><span data-stu-id="a361a-120">Most members of the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure are identical to those of the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure.</span></span> <span data-ttu-id="a361a-121">Para obtener descripciones sobre cómo usar los miembros de la estructura común para interactuar con los controles de cuadro de diálogo, vea [cuadro de diálogo Imprimir](print-dialog-box.md).</span><span class="sxs-lookup"><span data-stu-id="a361a-121">For descriptions of how to use the common structure members to interact with the dialog box controls, see [Print Dialog Box](print-dialog-box.md).</span></span> <span data-ttu-id="a361a-122">En el resto de este tema se describen las características de la hoja de propiedades de **impresión** que difieren del cuadro de diálogo **Imprimir** .</span><span class="sxs-lookup"><span data-stu-id="a361a-122">The remainder of this topic describes the **Print** property sheet features that differ from the **Print** dialog box.</span></span>

<span data-ttu-id="a361a-123">Puede personalizar una hoja de propiedades de **impresión** especificando una plantilla de cuadro de diálogo personalizada para la parte inferior de la página **General** y especificando páginas de propiedades adicionales para seguir la página **General** .</span><span class="sxs-lookup"><span data-stu-id="a361a-123">You can customize a **Print** property sheet by specifying a custom dialog box template for the lower portion of the **General** page and by specifying additional property pages to follow the **General** page.</span></span> <span data-ttu-id="a361a-124">Para obtener más información, vea [personalizar la hoja de propiedades de impresión](#customizing-the-print-property-sheet).</span><span class="sxs-lookup"><span data-stu-id="a361a-124">For more information, see [Customizing the Print Property Sheet](#customizing-the-print-property-sheet).</span></span>

<span data-ttu-id="a361a-125">Puede implementar un objeto de devolución de llamada para recibir notificaciones y mensajes de la función [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) mientras se muestra la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="a361a-125">You can implement a callback object to receive notifications and messages from the [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function while the property sheet is displayed.</span></span> <span data-ttu-id="a361a-126">Las aplicaciones que proporcionan plantillas personalizadas o páginas adicionales utilizan el objeto de devolución de llamada para comunicarse con la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="a361a-126">Applications that provide custom templates or additional pages use the callback object to communicate with the property sheet.</span></span> <span data-ttu-id="a361a-127">Para obtener más información, vea [callback (objeto) para la hoja de propiedades Print](#callback-object-for-the-print-property-sheet).</span><span class="sxs-lookup"><span data-stu-id="a361a-127">For more information, see [Callback Object for the Print Property Sheet](#callback-object-for-the-print-property-sheet).</span></span>

<span data-ttu-id="a361a-128">La hoja de propiedades **Imprimir** proporciona compatibilidad para especificar varios intervalos de páginas no contiguos que se van a imprimir.</span><span class="sxs-lookup"><span data-stu-id="a361a-128">The **Print** property sheet provides support for specifying multiple, noncontiguous page ranges to print.</span></span> <span data-ttu-id="a361a-129">El miembro **lpPageRanges** de la estructura [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) especifica una matriz de estructuras [**PRINTPAGERANGE**](/windows/win32/api/commdlg/ns-commdlg-printpagerange) en la que cada estructura especifica un intervalo de páginas.</span><span class="sxs-lookup"><span data-stu-id="a361a-129">The **lpPageRanges** member of the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure specifies an array of [**PRINTPAGERANGE**](/windows/win32/api/commdlg/ns-commdlg-printpagerange) structures in which each structure specifies a page range.</span></span>

<span data-ttu-id="a361a-130">La hoja de propiedades **Imprimir** muestra un botón de radio **Página actual** como parte del grupo **intervalo de páginas** de botones de radio.</span><span class="sxs-lookup"><span data-stu-id="a361a-130">The **Print** property sheet displays a **Current Page** radio button as part of the **Page Range** group of radio buttons.</span></span> <span data-ttu-id="a361a-131">Para controlar el botón de opción **Página actual** , use las marcas **PD \_ CURRENTPAGE** y **PD \_ NOCURRENTPAGE** en el miembro **Flags** de la estructura [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) .</span><span class="sxs-lookup"><span data-stu-id="a361a-131">To control the **Current Page** radio button, use the **PD\_CURRENTPAGE** and **PD\_NOCURRENTPAGE** flags in the **Flags** member of the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure.</span></span>

<span data-ttu-id="a361a-132">En esta sección se tratan los temas siguientes.</span><span class="sxs-lookup"><span data-stu-id="a361a-132">This section discusses the following topics.</span></span>

-   [<span data-ttu-id="a361a-133">Personalización de la hoja de propiedades de impresión</span><span class="sxs-lookup"><span data-stu-id="a361a-133">Customizing the Print Property Sheet</span></span>](#customizing-the-print-property-sheet)
-   [<span data-ttu-id="a361a-134">Objeto de devolución de llamada para la hoja de propiedades de impresión</span><span class="sxs-lookup"><span data-stu-id="a361a-134">Callback Object for the Print Property Sheet</span></span>](#callback-object-for-the-print-property-sheet)

## <a name="customizing-the-print-property-sheet"></a><span data-ttu-id="a361a-135">Personalización de la hoja de propiedades de impresión</span><span class="sxs-lookup"><span data-stu-id="a361a-135">Customizing the Print Property Sheet</span></span>

<span data-ttu-id="a361a-136">Puede personalizar la hoja de propiedades de **impresión** de las siguientes maneras:</span><span class="sxs-lookup"><span data-stu-id="a361a-136">You can customize the **Print** property sheet in the following ways:</span></span>

-   <span data-ttu-id="a361a-137">Proporcione una plantilla personalizada para la parte inferior de la página **General** .</span><span class="sxs-lookup"><span data-stu-id="a361a-137">Provide a custom template for the lower portion of the **General** page.</span></span> <span data-ttu-id="a361a-138">Esto le permite incluir controles adicionales que son exclusivos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a361a-138">This allows you to include additional controls that are unique to your application.</span></span> <span data-ttu-id="a361a-139">La función [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) usa la plantilla personalizada en lugar de la plantilla predeterminada.</span><span class="sxs-lookup"><span data-stu-id="a361a-139">The [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function uses your custom template in place of the default template.</span></span>
-   <span data-ttu-id="a361a-140">Proporcione páginas de propiedades adicionales para seguir la página **General** .</span><span class="sxs-lookup"><span data-stu-id="a361a-140">Provide additional property pages to follow the **General** page.</span></span>
-   <span data-ttu-id="a361a-141">Proporcione un objeto de devolución de llamada.</span><span class="sxs-lookup"><span data-stu-id="a361a-141">Provide a callback object.</span></span> <span data-ttu-id="a361a-142">Para obtener más información, vea [callback (objeto) para la hoja de propiedades Print](#callback-object-for-the-print-property-sheet).</span><span class="sxs-lookup"><span data-stu-id="a361a-142">For more information, see [Callback Object for the Print Property Sheet](#callback-object-for-the-print-property-sheet).</span></span>

<span data-ttu-id="a361a-143">No se puede cambiar la parte superior de la página **General** .</span><span class="sxs-lookup"><span data-stu-id="a361a-143">You cannot change the upper portion of the **General** page.</span></span> <span data-ttu-id="a361a-144">No se pueden cambiar las páginas de propiedades proporcionadas por el controlador de impresora.</span><span class="sxs-lookup"><span data-stu-id="a361a-144">You cannot change property pages provided by the printer driver.</span></span>

<span data-ttu-id="a361a-145">Para proporcionar una plantilla personalizada para la página general:</span><span class="sxs-lookup"><span data-stu-id="a361a-145">To provide a custom template for the General page:</span></span>

1.  <span data-ttu-id="a361a-146">Cree una plantilla personalizada para la parte inferior de la página **General** modificando la plantilla PRINTDLGEXORD especificada en el archivo prnsetup. Dlg.</span><span class="sxs-lookup"><span data-stu-id="a361a-146">Create a custom template for the lower portion of the **General** page by modifying the PRINTDLGEXORD template specified in the Prnsetup.dlg file.</span></span> <span data-ttu-id="a361a-147">Normalmente, la plantilla personalizada debe tener el mismo tamaño que la plantilla predeterminada.</span><span class="sxs-lookup"><span data-stu-id="a361a-147">Typically, the custom template must be the same size as the default template.</span></span> <span data-ttu-id="a361a-148">Sin embargo, puede ampliar la plantilla personalizada si especifica la marca **PD \_ USELARGETEMPLATE** para crear una página **General** más grande.</span><span class="sxs-lookup"><span data-stu-id="a361a-148">However, you can enlarge the custom template if you specify the **PD\_USELARGETEMPLATE** flag to create a larger **General** page.</span></span> <span data-ttu-id="a361a-149">Los identificadores de control que se usan en la plantilla de cuadro de diálogo de **impresión** predeterminada se definen en el archivo Dlgs. h.</span><span class="sxs-lookup"><span data-stu-id="a361a-149">The control identifiers used in the default **Print** dialog template are defined in the Dlgs.h file.</span></span>
2.  <span data-ttu-id="a361a-150">Use la estructura [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) para habilitar la plantilla de la manera siguiente:</span><span class="sxs-lookup"><span data-stu-id="a361a-150">Use the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure to enable the template as follows:</span></span>
    -   <span data-ttu-id="a361a-151">Si la plantilla personalizada es un recurso de una biblioteca de vínculos dinámicos o de aplicación, establezca la marca **PD \_ ENABLEPRINTTEMPLATE** en el miembro **Flags** .</span><span class="sxs-lookup"><span data-stu-id="a361a-151">If your custom template is a resource in an application or dynamic-link library, set the **PD\_ENABLEPRINTTEMPLATE** flag in the **Flags** member.</span></span> <span data-ttu-id="a361a-152">Use los miembros **hInstance** y **lpPrintTemplateName** de la estructura para identificar el nombre del módulo y del recurso.</span><span class="sxs-lookup"><span data-stu-id="a361a-152">Use the **hInstance** and **lpPrintTemplateName** members of the structure to identify the module and resource name.</span></span>

        <span data-ttu-id="a361a-153">-O bien-</span><span class="sxs-lookup"><span data-stu-id="a361a-153">-Or-</span></span>

    -   <span data-ttu-id="a361a-154">Si la plantilla personalizada ya está en la memoria, establezca la marca **PD \_ ENABLEPRINTTEMPLATEHANDLE** .</span><span class="sxs-lookup"><span data-stu-id="a361a-154">If your custom template is already in memory, set the **PD\_ENABLEPRINTTEMPLATEHANDLE** flag.</span></span> <span data-ttu-id="a361a-155">Use el miembro **hInstance** para identificar el objeto de memoria que contiene la plantilla.</span><span class="sxs-lookup"><span data-stu-id="a361a-155">Use the **hInstance** member to identify the memory object that contains the template.</span></span>

3.  <span data-ttu-id="a361a-156">Si usa una plantilla personalizada para definir controles adicionales, debe proporcionar un objeto de devolución de llamada para procesar la entrada para los controles.</span><span class="sxs-lookup"><span data-stu-id="a361a-156">If you use a custom template to define additional controls, you must provide a callback object to process input for your controls.</span></span> <span data-ttu-id="a361a-157">El objeto de devolución de llamada implementa un método [**IPrintDialogCallback:: HandleMessage**](/windows/win32/api/commdlg/nf-commdlg-iprintdialogcallback-handlemessage) que recibe los mensajes enviados al cuadro de diálogo personalizado.</span><span class="sxs-lookup"><span data-stu-id="a361a-157">The callback object implements a [**IPrintDialogCallback::HandleMessage**](/windows/win32/api/commdlg/nf-commdlg-iprintdialogcallback-handlemessage) method which receives messages sent to the custom dialog box.</span></span>

<span data-ttu-id="a361a-158">Para proporcionar páginas de propiedades adicionales</span><span class="sxs-lookup"><span data-stu-id="a361a-158">To provide additional property pages</span></span>

1.  <span data-ttu-id="a361a-159">Utilice la función para crear las páginas adicionales.</span><span class="sxs-lookup"><span data-stu-id="a361a-159">Use the function to create the additional pages.</span></span>
2.  <span data-ttu-id="a361a-160">Use el miembro **lphPropertyPages** de la estructura [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) para especificar una matriz de identificadores para las páginas adicionales.</span><span class="sxs-lookup"><span data-stu-id="a361a-160">Use the **lphPropertyPages** member of the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure to specify an array of handles to the additional pages.</span></span>

    <span data-ttu-id="a361a-161">Los procedimientos del cuadro de diálogo especificados al crear cada página procesan los mensajes enviados a las páginas.</span><span class="sxs-lookup"><span data-stu-id="a361a-161">The dialog box procedures specified when you created each page process messages sent to the pages.</span></span>

3.  <span data-ttu-id="a361a-162">Es posible que desee proporcionar un objeto de devolución de llamada que implemente la interfaz.</span><span class="sxs-lookup"><span data-stu-id="a361a-162">You might want to provide a callback object that implements the interface.</span></span> <span data-ttu-id="a361a-163">La función [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) usa esta interfaz para pasar a la aplicación un puntero a una interfaz [**IPrintDialogServices**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogservices) .</span><span class="sxs-lookup"><span data-stu-id="a361a-163">The [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function uses this interface to pass to the application a pointer to an [**IPrintDialogServices**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogservices) interface.</span></span> <span data-ttu-id="a361a-164">Los procedimientos del cuadro de diálogo de las páginas de propiedades adicionales pueden utilizar esta interfaz para recuperar información acerca de la impresora seleccionada actualmente.</span><span class="sxs-lookup"><span data-stu-id="a361a-164">The dialog box procedures for the additional property pages can use this interface to retrieve information about the currently selected printer.</span></span>

## <a name="callback-object-for-the-print-property-sheet"></a><span data-ttu-id="a361a-165">Objeto de devolución de llamada para la hoja de propiedades de impresión</span><span class="sxs-lookup"><span data-stu-id="a361a-165">Callback Object for the Print Property Sheet</span></span>

<span data-ttu-id="a361a-166">Una aplicación que muestra una hoja de propiedades de **impresión** puede implementar un objeto de devolución de llamada para recibir notificaciones y mensajes de la función [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) mientras se muestra la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="a361a-166">An application that displays a **Print** property sheet can implement a callback object to receive notifications and messages from the [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function while the property sheet is displayed.</span></span> <span data-ttu-id="a361a-167">Para proporcionar un objeto de devolución de llamada, especifique un puntero al objeto en el miembro **lpCallback** de la estructura [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) .</span><span class="sxs-lookup"><span data-stu-id="a361a-167">To provide a callback object, specify a pointer to the object in the **lpCallback** member of the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure.</span></span>

<span data-ttu-id="a361a-168">El objeto de devolución de llamada debe implementar la interfaz [**IPrintDialogCallback**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogcallback) .</span><span class="sxs-lookup"><span data-stu-id="a361a-168">The callback object must implement the [**IPrintDialogCallback**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogcallback) interface.</span></span> <span data-ttu-id="a361a-169">La función [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) llama a los métodos **IPrintDialogCallback** en las situaciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="a361a-169">The [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function calls **IPrintDialogCallback** methods in the following situations:</span></span>

-   <span data-ttu-id="a361a-170">Cuando se ha inicializado el cuadro de diálogo</span><span class="sxs-lookup"><span data-stu-id="a361a-170">When the dialog box has been initialized</span></span>
-   <span data-ttu-id="a361a-171">Cuando el usuario selecciona una impresora diferente de la lista de impresoras instaladas que se muestra en la hoja de propiedades</span><span class="sxs-lookup"><span data-stu-id="a361a-171">When the user selects a different printer from the list of installed printers displayed by the property sheet</span></span>
-   <span data-ttu-id="a361a-172">Cuando recibe mensajes para el cuadro de diálogo secundario en la parte inferior de la página **General** de la hoja de propiedades</span><span class="sxs-lookup"><span data-stu-id="a361a-172">When it receives messages for the child dialog box in the lower portion of the property sheet's **General** page</span></span>

<span data-ttu-id="a361a-173">El objeto de devolución de llamada también debe implementar la interfaz [**IObjectWithSite**](/windows/win32/api/ocidl/nn-ocidl-iobjectwithsite) .</span><span class="sxs-lookup"><span data-stu-id="a361a-173">The callback object should also implement the [**IObjectWithSite**](/windows/win32/api/ocidl/nn-ocidl-iobjectwithsite) interface.</span></span> <span data-ttu-id="a361a-174">La función [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) llama al método para pasar un puntero a una interfaz [**IPrintDialogServices**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogservices) a una aplicación.</span><span class="sxs-lookup"><span data-stu-id="a361a-174">The [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function calls the method to pass a pointer to an [**IPrintDialogServices**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogservices) interface to an application.</span></span> <span data-ttu-id="a361a-175">Los métodos [**IPrintDialogCallback**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogcallback) pueden usar la interfaz **IPrintDialogServices** para recuperar información acerca de la impresora seleccionada actualmente.</span><span class="sxs-lookup"><span data-stu-id="a361a-175">The [**IPrintDialogCallback**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogcallback) methods can use the **IPrintDialogServices** interface to retrieve information about the currently selected printer.</span></span> <span data-ttu-id="a361a-176">La interfaz **IPrintDialogServices** también es útil para las aplicaciones que crean páginas adicionales para seguir la página **General** de la hoja de propiedades **Imprimir** .</span><span class="sxs-lookup"><span data-stu-id="a361a-176">The **IPrintDialogServices** interface is also useful for applications that create additional pages to follow the **General** page of the **Print** property sheet.</span></span> <span data-ttu-id="a361a-177">Los procedimientos del cuadro de diálogo para las páginas adicionales pueden llamar a métodos **IPrintDialogServices** .</span><span class="sxs-lookup"><span data-stu-id="a361a-177">The dialog box procedures for the additional pages can call **IPrintDialogServices** methods.</span></span>

 

 