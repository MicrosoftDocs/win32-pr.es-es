---
description: Un vínculo de Shell es un objeto de datos que contiene información que se usa para tener acceso a otro objeto en el espacio de nombres del shell&\# 8212; es decir, cualquier objeto visible a través del explorador de Windows.
ms.assetid: 32ad306d-54bd-4130-ad30-08db50ef106e
title: Vínculos de Shell
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 327bcb425f998bcc2a4c0714118d4461ded253ee
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "104277416"
---
# <a name="shell-links"></a><span data-ttu-id="8f3cb-103">Vínculos de Shell</span><span class="sxs-lookup"><span data-stu-id="8f3cb-103">Shell Links</span></span>

<span data-ttu-id="8f3cb-104">Un *vínculo de Shell* es un objeto de datos que contiene información que se usa para tener acceso a otro objeto en el espacio de nombres del shell, es decir, cualquier objeto visible a través del explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-104">A *Shell link* is a data object that contains information used to access another object in the Shell's namespace—that is, any object visible through Windows Explorer.</span></span> <span data-ttu-id="8f3cb-105">Los tipos de objetos a los que se puede tener acceso a través de vínculos de Shell incluyen archivos, carpetas, unidades de disco e impresoras.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-105">The types of objects that can be accessed through Shell links include files, folders, disk drives, and printers.</span></span> <span data-ttu-id="8f3cb-106">Un vínculo de Shell permite a un usuario o una aplicación tener acceso a un objeto desde cualquier lugar del espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-106">A Shell link allows a user or an application to access an object from anywhere in the namespace.</span></span> <span data-ttu-id="8f3cb-107">El usuario o la aplicación no necesita conocer el nombre y la ubicación actuales del objeto.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-107">The user or application does not need to know the current name and location of the object.</span></span>

-   [<span data-ttu-id="8f3cb-108">Acerca de los vínculos de Shell</span><span class="sxs-lookup"><span data-stu-id="8f3cb-108">About Shell Links</span></span>](#about-shell-links)
    -   [<span data-ttu-id="8f3cb-109">Resolución de vínculo</span><span class="sxs-lookup"><span data-stu-id="8f3cb-109">Link Resolution</span></span>](#link-resolution)
    -   [<span data-ttu-id="8f3cb-110">Archivos de vínculo</span><span class="sxs-lookup"><span data-stu-id="8f3cb-110">Link Files</span></span>](#link-files)
    -   [<span data-ttu-id="8f3cb-111">Identificadores de elementos y listas de identificadores</span><span class="sxs-lookup"><span data-stu-id="8f3cb-111">Item Identifiers and Identifier Lists</span></span>](#item-identifiers-and-identifier-lists)
-   [<span data-ttu-id="8f3cb-112">Usar vínculos de Shell</span><span class="sxs-lookup"><span data-stu-id="8f3cb-112">Using Shell Links</span></span>](#using-shell-links)
    -   [<span data-ttu-id="8f3cb-113">Crear un acceso directo y un acceso directo a una carpeta en un archivo</span><span class="sxs-lookup"><span data-stu-id="8f3cb-113">Creating a Shortcut and a Folder Shortcut to a File</span></span>](#creating-a-shortcut-and-a-folder-shortcut-to-a-file)
    -   [<span data-ttu-id="8f3cb-114">Resolución de un acceso directo</span><span class="sxs-lookup"><span data-stu-id="8f3cb-114">Resolving a Shortcut</span></span>](#resolving-a-shortcut)
    -   [<span data-ttu-id="8f3cb-115">Crear un acceso directo a un objeto que no es de archivo</span><span class="sxs-lookup"><span data-stu-id="8f3cb-115">Creating a Shortcut to a Nonfile Object</span></span>](#creating-a-shortcut-to-a-nonfile-object)

## <a name="about-shell-links"></a><span data-ttu-id="8f3cb-116">Acerca de los vínculos de Shell</span><span class="sxs-lookup"><span data-stu-id="8f3cb-116">About Shell Links</span></span>

<span data-ttu-id="8f3cb-117">El usuario crea un vínculo de Shell eligiendo el comando **crear acceso directo** en el menú contextual de un objeto.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-117">The user creates a Shell link by choosing the **Create Shortcut** command from an object's shortcut menu.</span></span> <span data-ttu-id="8f3cb-118">El sistema crea automáticamente un icono para el vínculo de Shell mediante la combinación del icono del objeto con una flecha pequeña (conocida como el icono de superposición de vínculos definida por el sistema) que aparece en la esquina inferior izquierda del icono.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-118">The system automatically creates an icon for the Shell link by combining the object's icon with a small arrow (known as the system-defined link overlay icon) that appears in the lower left corner of the icon.</span></span> <span data-ttu-id="8f3cb-119">Un vínculo de Shell que tiene un icono se denomina acceso directo; sin embargo, los términos vínculo y acceso directo de Shell a menudo se usan indistintamente.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-119">A Shell link that has an icon is called a shortcut; however, the terms Shell link and shortcut are often used interchangeably.</span></span> <span data-ttu-id="8f3cb-120">Normalmente, el usuario crea accesos directos para obtener acceso rápido a los objetos almacenados en subcarpetas o en carpetas compartidas en otros equipos.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-120">Typically, the user creates shortcuts to gain quick access to objects stored in subfolders or in shared folders on other computers.</span></span> <span data-ttu-id="8f3cb-121">Por ejemplo, un usuario puede crear un acceso directo a un documento de Microsoft Word que se encuentra en una subcarpeta y colocar el icono de acceso directo en el escritorio.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-121">For example, a user can create a shortcut to a Microsoft Word document that is located in a subfolder and place the shortcut icon on the desktop.</span></span> <span data-ttu-id="8f3cb-122">Después, el usuario puede abrir el documento haciendo doble clic en el icono de acceso directo.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-122">The user can then open the document by double-clicking the shortcut icon.</span></span> <span data-ttu-id="8f3cb-123">Si el documento se mueve o se cambia de nombre después de crear el acceso directo, el sistema intentará actualizar el acceso directo la próxima vez que el usuario lo seleccione.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-123">If the document is moved or renamed after the shortcut is created, the system will attempt to update the shortcut the next time the user selects it.</span></span>

<span data-ttu-id="8f3cb-124">Las aplicaciones también pueden crear y usar vínculos de Shell y accesos directos.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-124">Applications can also create and use Shell links and shortcuts.</span></span> <span data-ttu-id="8f3cb-125">Por ejemplo, una aplicación de procesamiento de texto podría crear un vínculo de Shell para implementar una lista de los documentos usados más recientemente.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-125">For example, a word processing application might create a Shell link to implement a list of the most recently used documents.</span></span> <span data-ttu-id="8f3cb-126">Una aplicación crea un vínculo de Shell mediante la interfaz [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) para crear un objeto de vínculo de Shell.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-126">An application creates a Shell link by using the [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) interface to create a Shell link object.</span></span> <span data-ttu-id="8f3cb-127">La aplicación usa la interfaz [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) o [**IPersistStream**](/windows/win32/api/objidl/nn-objidl-ipersiststream) para almacenar el objeto en un archivo o una secuencia.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-127">The application uses the [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) or [**IPersistStream**](/windows/win32/api/objidl/nn-objidl-ipersiststream) interface to store the object in a file or stream.</span></span>

> [!Note]  
> <span data-ttu-id="8f3cb-128">No se puede usar [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) para crear un vínculo a una dirección URL.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-128">You cannot use [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) to create a link to a URL.</span></span>

 

<span data-ttu-id="8f3cb-129">En esta información general se describe la interfaz [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) y se explica cómo usarla para crear y resolver vínculos de Shell desde una aplicación basada en Microsoft Win32.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-129">This overview describes the [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) interface and explains how to use it to create and resolve Shell links from within a Microsoft Win32-based application.</span></span> <span data-ttu-id="8f3cb-130">Dado que el diseño de vínculos de Shell se basa en el modelo de objetos componentes (COM) de OLE, debería estar familiarizado con los conceptos básicos de la programación de COM y OLE antes de leer esta información general.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-130">Because the design of Shell links is based on the OLE Component Object Model (COM), you should be familiar with the basic concepts of COM and OLE programming before reading this overview.</span></span>

### <a name="link-resolution"></a><span data-ttu-id="8f3cb-131">Resolución de vínculo</span><span class="sxs-lookup"><span data-stu-id="8f3cb-131">Link Resolution</span></span>

<span data-ttu-id="8f3cb-132">Si un usuario crea un acceso directo a un objeto y posteriormente se cambia el nombre o la ubicación del objeto, el sistema toma automáticamente los pasos necesarios para actualizar el acceso directo la próxima vez que el usuario lo seleccione.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-132">If a user creates a shortcut to an object and the name or location of the object is later changed, the system automatically takes steps to update, or resolve, the shortcut the next time the user selects it.</span></span> <span data-ttu-id="8f3cb-133">Sin embargo, si una aplicación crea un vínculo de Shell y lo almacena en una secuencia, el sistema no intenta resolver el vínculo automáticamente.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-133">However, if an application creates a Shell link and stores it in a stream, the system does not automatically attempt to resolve the link.</span></span> <span data-ttu-id="8f3cb-134">La aplicación debe resolver el vínculo llamando al método [**IShellLink:: Resolve**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-resolve) .</span><span class="sxs-lookup"><span data-stu-id="8f3cb-134">The application must resolve the link by calling the [**IShellLink::Resolve**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-resolve) method.</span></span>

<span data-ttu-id="8f3cb-135">Cuando se crea un vínculo de Shell, el sistema guarda información sobre el vínculo.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-135">When a Shell link is created, the system saves information about the link.</span></span> <span data-ttu-id="8f3cb-136">Al resolver un vínculo, ya sea de forma automática o con una llamada a [**IShellLink:: Resolve**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-resolve) , el sistema recupera primero la ruta de acceso asociada con el vínculo de Shell mediante un puntero a la lista de identificadores del vínculo de Shell.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-136">When resolving a link—either automatically or with an [**IShellLink::Resolve**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-resolve) call—the system first retrieves the path associated with the Shell link by using a pointer to the Shell link's identifier list.</span></span> <span data-ttu-id="8f3cb-137">Para obtener más información sobre la lista de identificadores, vea [identificadores de elementos y listas de identificadores](#item-identifiers-and-identifier-lists).</span><span class="sxs-lookup"><span data-stu-id="8f3cb-137">For more information about the identifier list, see [Item Identifiers and Identifier Lists](#item-identifiers-and-identifier-lists).</span></span> <span data-ttu-id="8f3cb-138">El sistema busca el objeto asociado en esa ruta de acceso y, si encuentra el objeto, resuelve el vínculo.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-138">The system searches for the associated object in that path and, if it finds the object, resolves the link.</span></span> <span data-ttu-id="8f3cb-139">Si el sistema no encuentra el objeto, llama a en el servicio de [seguimiento de vínculos distribuidos](../fileio/distributed-link-tracking-and-object-identifiers.md) (DLT), si está disponible, para buscar el objeto.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-139">If the system cannot find the object, it calls on the [Distributed Link Tracking and Object Identifiers](../fileio/distributed-link-tracking-and-object-identifiers.md) (DLT) service, if available, to locate the object.</span></span> <span data-ttu-id="8f3cb-140">Si el servicio DLT no está disponible o no encuentra el objeto, el sistema busca en el mismo directorio un objeto con la misma hora de creación de archivo y los mismos atributos, pero con un nombre diferente.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-140">If the DLT service is not available or cannot find the object, the system looks in the same directory for an object with the same file creation time and attributes but with a different name.</span></span> <span data-ttu-id="8f3cb-141">Este tipo de búsqueda resuelve un vínculo a un objeto al que se ha cambiado el nombre.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-141">This type of search resolves a link to an object that has been renamed.</span></span>

<span data-ttu-id="8f3cb-142">Si el sistema sigue sin poder encontrar el objeto, busca en los directorios, en el escritorio y en los volúmenes locales, lo que busca de forma recursiva en el árbol de directorios de un objeto con el mismo nombre o la misma hora de creación.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-142">If the system still cannot find the object, it searches the directories, the desktop, and local volumes, looking recursively though the directory tree for an object with either the same name or creation time.</span></span> <span data-ttu-id="8f3cb-143">Si el sistema sigue sin encontrar una coincidencia, muestra un cuadro de diálogo que solicita al usuario una ubicación.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-143">If the system still does not find a match, it displays a dialog box prompting the user for a location.</span></span> <span data-ttu-id="8f3cb-144">Una aplicación puede suprimir el cuadro de diálogo especificando el valor de **\_ no la interfaz de \_ usuario de SLR** en una llamada a [**IShellLink:: Resolve**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-resolve).</span><span class="sxs-lookup"><span data-stu-id="8f3cb-144">An application can suppress the dialog box by specifying the **SLR\_NO\_UI** value in a call to [**IShellLink::Resolve**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-resolve).</span></span>

### <a name="initialization-of-the-component-object-library"></a><span data-ttu-id="8f3cb-145">Inicialización de la biblioteca de objetos de componentes</span><span class="sxs-lookup"><span data-stu-id="8f3cb-145">Initialization of the Component Object Library</span></span>

<span data-ttu-id="8f3cb-146">Para que una aplicación pueda crear y resolver accesos directos, debe inicializar la biblioteca de objetos componente llamando a la función [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) .</span><span class="sxs-lookup"><span data-stu-id="8f3cb-146">Before an application can create and resolve shortcuts, it must initialize the component object library by calling the [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) function.</span></span> <span data-ttu-id="8f3cb-147">Cada llamada a **CoInitialize** requiere una llamada correspondiente a la función [**CoUninitialize**](/windows/win32/api/combaseapi/nf-combaseapi-couninitialize) , a la que una aplicación debe llamar cuando termina.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-147">Each call to **CoInitialize** requires a corresponding call to the [**CoUninitialize**](/windows/win32/api/combaseapi/nf-combaseapi-couninitialize) function, which an application should call when it terminates.</span></span> <span data-ttu-id="8f3cb-148">La llamada a **CoUninitialize** garantiza que la aplicación no finaliza hasta que se han recibido todos los mensajes pendientes.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-148">The call to **CoUninitialize** ensures that the application does not terminate until it has received all of its pending messages.</span></span>

### <a name="location-independent-names"></a><span data-ttu-id="8f3cb-149">Nombres de Location-Independent</span><span class="sxs-lookup"><span data-stu-id="8f3cb-149">Location-Independent Names</span></span>

<span data-ttu-id="8f3cb-150">El sistema proporciona nombres independientes de la ubicación para los vínculos de Shell a los objetos almacenados en carpetas compartidas.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-150">The system provides location-independent names for Shell links to objects stored in shared folders.</span></span> <span data-ttu-id="8f3cb-151">Si el objeto se almacena localmente, el sistema proporciona la ruta de acceso local y el nombre de archivo del objeto.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-151">If the object is stored locally, the system provides the local path and file name for the object.</span></span> <span data-ttu-id="8f3cb-152">Si el objeto se almacena de forma remota, el sistema proporciona un nombre de recurso de red UNC (Convención de nomenclatura universal) para el objeto.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-152">If the object is stored remotely, the system provides a Universal Naming Convention (UNC) network resource name for the object.</span></span> <span data-ttu-id="8f3cb-153">Dado que el sistema proporciona nombres independientes de la ubicación, un vínculo de Shell puede servir como nombre universal para un archivo que se puede transferir a otros equipos.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-153">Because the system provides location-independent names, a Shell link can serve as a universal name for a file that can be transferred to other computers.</span></span>

### <a name="link-files"></a><span data-ttu-id="8f3cb-154">Archivos de vínculo</span><span class="sxs-lookup"><span data-stu-id="8f3cb-154">Link Files</span></span>

<span data-ttu-id="8f3cb-155">Cuando el usuario crea un acceso directo a un objeto eligiendo el comando **crear acceso directo** del menú contextual del objeto, Windows almacena la información que necesita para tener acceso al objeto en un archivo de vínculo, un archivo binario con la extensión de nombre de archivo. lnk.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-155">When the user creates a shortcut to an object by choosing the **Create Shortcut** command from the object's shortcut menu, Windows stores the information it needs to access the object in a link file—a binary file that has the .lnk file name extension.</span></span> <span data-ttu-id="8f3cb-156">Un archivo de vínculo contiene la siguiente información:</span><span class="sxs-lookup"><span data-stu-id="8f3cb-156">A link file contains the following information:</span></span>

-   <span data-ttu-id="8f3cb-157">La ubicación (ruta de acceso) del objeto al que hace referencia el acceso directo (llamado el objeto correspondiente).</span><span class="sxs-lookup"><span data-stu-id="8f3cb-157">The location (path) of the object referenced by the shortcut (called the corresponding object).</span></span>
-   <span data-ttu-id="8f3cb-158">Directorio de trabajo del objeto correspondiente.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-158">The working directory of the corresponding object.</span></span>
-   <span data-ttu-id="8f3cb-159">Lista de argumentos que el sistema pasa al objeto correspondiente cuando se activa el método [**IContextMenu:: InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) para el acceso directo.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-159">The list of arguments that the system passes to the corresponding object when the [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) method is activated for the shortcut.</span></span>
-   <span data-ttu-id="8f3cb-160">El comando show que se usa para establecer el estado de presentación inicial del objeto correspondiente.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-160">The show command used to set the initial show state of the corresponding object.</span></span> <span data-ttu-id="8f3cb-161">Éste es uno de los valores de SW \_ descritos en [**ShowWindow**](/windows/win32/api/winuser/nf-winuser-showwindow).</span><span class="sxs-lookup"><span data-stu-id="8f3cb-161">This is one of the SW\_ values described in [**ShowWindow**](/windows/win32/api/winuser/nf-winuser-showwindow).</span></span>
-   <span data-ttu-id="8f3cb-162">La ubicación (ruta de acceso e índice) del icono del acceso directo.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-162">The location (path and index) of the shortcut's icon.</span></span>
-   <span data-ttu-id="8f3cb-163">Cadena de Descripción del acceso directo.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-163">The shortcut's description string.</span></span>
-   <span data-ttu-id="8f3cb-164">Método abreviado de teclado para el acceso directo.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-164">The keyboard shortcut for the shortcut.</span></span>

<span data-ttu-id="8f3cb-165">Cuando se elimina un archivo de vínculo, el objeto correspondiente no se ve afectado.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-165">When a link file is deleted, the corresponding object is not affected.</span></span>

<span data-ttu-id="8f3cb-166">Si crea un acceso directo a otro acceso directo, el sistema simplemente copia el archivo de vínculo en lugar de crear un nuevo archivo de vínculo.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-166">If you create a shortcut to another shortcut, the system simply copies the link file rather than creating a new link file.</span></span> <span data-ttu-id="8f3cb-167">En este caso, los accesos directos no serán independientes entre sí.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-167">In this case, the shortcuts will not be independent of each other.</span></span>

<span data-ttu-id="8f3cb-168">Una aplicación puede registrar una extensión de nombre de archivo como un tipo de archivo de acceso directo.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-168">An application can register a file name extension as a shortcut file type.</span></span> <span data-ttu-id="8f3cb-169">Si un archivo tiene una extensión de nombre de archivo que se ha registrado como un tipo de archivo de acceso directo, el sistema agrega automáticamente el icono de superposición de vínculo definido por el sistema (una flecha pequeña) al icono del archivo.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-169">If a file has a file name extension that has been registered as a shortcut file type, the system automatically adds the system-defined link overlay icon (a small arrow) to the file's icon.</span></span> <span data-ttu-id="8f3cb-170">Para registrar una extensión de nombre de archivo como un tipo de archivo de acceso directo, debe agregar el valor de IsShortcut a la descripción del registro de la extensión de nombre de archivo, tal como se muestra en el ejemplo siguiente.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-170">To register a file name extension as a shortcut file type, you must add the IsShortcut value to the registry description of the file name extension, as shown in the example below.</span></span> <span data-ttu-id="8f3cb-171">Tenga en cuenta que el shell debe reiniciarse para que el icono de superposición surta efecto.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-171">Note that the Shell must be restarted for the overlay icon to take effect.</span></span> <span data-ttu-id="8f3cb-172">IsShortcut no tiene ningún valor de datos.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-172">IsShortcut has no data value.</span></span>

```
HKEY_CLASSES_ROOT
   .xyz
      (Default) = XYZApp
   XYZApp
      IsShortcut
```

### <a name="shortcut-names"></a><span data-ttu-id="8f3cb-173">Nombres de acceso directo</span><span class="sxs-lookup"><span data-stu-id="8f3cb-173">Shortcut names</span></span>

<span data-ttu-id="8f3cb-174">El nombre del acceso directo, que es una cadena que aparece debajo del icono de vínculo de Shell, es en realidad el nombre del archivo del acceso directo.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-174">The shortcut's name, which is a string that appears below the Shell link icon, is actually the file name of the shortcut itself.</span></span> <span data-ttu-id="8f3cb-175">El usuario puede editar la cadena de Descripción seleccionándola y escribiendo una nueva cadena.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-175">The user can edit the description string by selecting it and entering a new string.</span></span>

### <a name="location-of-shortcuts-in-the-namespace"></a><span data-ttu-id="8f3cb-176">Ubicación de los accesos directos en el espacio de nombres</span><span class="sxs-lookup"><span data-stu-id="8f3cb-176">Location of shortcuts in the namespace</span></span>

<span data-ttu-id="8f3cb-177">Puede existir un acceso directo en el escritorio o en cualquier lugar del espacio de nombres del shell.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-177">A shortcut can exist on the desktop or anywhere in the Shell's namespace.</span></span> <span data-ttu-id="8f3cb-178">Del mismo modo, el objeto que está asociado al método abreviado también puede existir en cualquier parte del espacio de nombres del shell.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-178">Similarly, the object that is associated with the shortcut can also exist anywhere in the Shell's namespace.</span></span> <span data-ttu-id="8f3cb-179">Una aplicación puede usar el método [**IShellLink:: SetPath**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setpath) para establecer la ruta de acceso y el nombre de archivo del objeto asociado, y el método [**IShellLink:: GetPath**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getpath) para recuperar la ruta de acceso y el nombre de archivo actuales del objeto.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-179">An application can use the [**IShellLink::SetPath**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setpath) method to set the path and file name for the associated object, and the [**IShellLink::GetPath**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getpath) method to retrieve the current path and file name for the object.</span></span>

### <a name="shortcut-working-directory"></a><span data-ttu-id="8f3cb-180">Directorio de trabajo de acceso directo</span><span class="sxs-lookup"><span data-stu-id="8f3cb-180">Shortcut working directory</span></span>

<span data-ttu-id="8f3cb-181">El directorio de trabajo es el directorio en el que el objeto correspondiente de un acceso directo carga o almacena archivos cuando el usuario no identifica un directorio específico.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-181">The working directory is the directory where the corresponding object of a shortcut loads or stores files when the user does not identify a specific directory.</span></span> <span data-ttu-id="8f3cb-182">Un archivo de vínculo contiene el nombre del directorio de trabajo para el objeto correspondiente.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-182">A link file contains the name of the working directory for the corresponding object.</span></span> <span data-ttu-id="8f3cb-183">Una aplicación puede establecer el nombre del directorio de trabajo para el objeto correspondiente mediante el método [**IShellLink:: SetWorkingDirectory**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setworkingdirectory) y puede recuperar el nombre del directorio de trabajo actual para el objeto correspondiente mediante el método [**IShellLink:: GetWorkingDirectory**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getworkingdirectory) .</span><span class="sxs-lookup"><span data-stu-id="8f3cb-183">An application can set the name of the working directory for the corresponding object by using the [**IShellLink::SetWorkingDirectory**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setworkingdirectory) method and can retrieve the name of the current working directory for the corresponding object by using the [**IShellLink::GetWorkingDirectory**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getworkingdirectory) method.</span></span>

### <a name="shortcut-command-line-arguments"></a><span data-ttu-id="8f3cb-184">Argumentos de la línea de comandos de acceso directo</span><span class="sxs-lookup"><span data-stu-id="8f3cb-184">Shortcut command-line arguments</span></span>

<span data-ttu-id="8f3cb-185">Un archivo de vínculo contiene los argumentos de línea de comandos que el shell pasa al objeto correspondiente cuando el usuario selecciona el vínculo.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-185">A link file contains command-line arguments that the Shell passes to the corresponding object when the user selects the link.</span></span> <span data-ttu-id="8f3cb-186">Una aplicación puede establecer los argumentos de línea de comandos para un acceso directo mediante el método [**IShellLink:: SetArguments**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setarguments) .</span><span class="sxs-lookup"><span data-stu-id="8f3cb-186">An application can set the command-line arguments for a shortcut by using the [**IShellLink::SetArguments**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setarguments) method.</span></span> <span data-ttu-id="8f3cb-187">Resulta útil establecer argumentos de la línea de comandos cuando la aplicación correspondiente, como un vinculador o un compilador, toma marcas especiales como argumentos.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-187">It is useful to set command-line arguments when the corresponding application, such as a linker or compiler, takes special flags as arguments.</span></span> <span data-ttu-id="8f3cb-188">Una aplicación puede recuperar los argumentos de línea de comandos de un acceso directo mediante el método [**IShellLink:: GetArguments**](/windows/desktop/api/Shobjidl_core/nf-shobjidl_core-ishelllinka-getarguments) .</span><span class="sxs-lookup"><span data-stu-id="8f3cb-188">An application can retrieve the command-line arguments from a shortcut by using the [**IShellLink::GetArguments**](/windows/desktop/api/Shobjidl_core/nf-shobjidl_core-ishelllinka-getarguments) method.</span></span>

### <a name="shortcut-show-commands"></a><span data-ttu-id="8f3cb-189">Comandos de acceso directo para mostrar</span><span class="sxs-lookup"><span data-stu-id="8f3cb-189">Shortcut show commands</span></span>

<span data-ttu-id="8f3cb-190">Cuando el usuario hace doble clic en un acceso directo, el sistema inicia la aplicación asociada al objeto correspondiente y establece el estado de presentación inicial de la aplicación en función del comando show especificado por el acceso directo.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-190">When the user double-clicks a shortcut, the system starts the application associated with the corresponding object and sets the initial show state of the application based on the show command specified by the shortcut.</span></span> <span data-ttu-id="8f3cb-191">El comando show puede ser cualquiera de los valores de SW \_ incluidos en la descripción de la función [**ShowWindow**](/windows/win32/api/winuser/nf-winuser-showwindow) .</span><span class="sxs-lookup"><span data-stu-id="8f3cb-191">The show command can be any of the SW\_ values included in the description of the [**ShowWindow**](/windows/win32/api/winuser/nf-winuser-showwindow) function.</span></span> <span data-ttu-id="8f3cb-192">Una aplicación puede establecer el comando show para un acceso directo mediante el método [**IShellLink:: SetShowCmd**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setshowcmd) y puede recuperar el comando show actual mediante el método [**IShellLink:: GetShowCmd**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getshowcmd) .</span><span class="sxs-lookup"><span data-stu-id="8f3cb-192">An application can set the show command for a shortcut by using the [**IShellLink::SetShowCmd**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setshowcmd) method and can retrieve the current show command by using the [**IShellLink::GetShowCmd**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getshowcmd) method.</span></span>

### <a name="shortcut-icons"></a><span data-ttu-id="8f3cb-193">Iconos de acceso directo</span><span class="sxs-lookup"><span data-stu-id="8f3cb-193">Shortcut icons</span></span>

<span data-ttu-id="8f3cb-194">Al igual que otros objetos de Shell, un acceso directo tiene un icono.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-194">Like other Shell objects, a shortcut has an icon.</span></span> <span data-ttu-id="8f3cb-195">El usuario tiene acceso al objeto asociado a un acceso directo haciendo doble clic en el icono del acceso directo.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-195">The user accesses the object associated with a shortcut by double-clicking the shortcut's icon.</span></span> <span data-ttu-id="8f3cb-196">Cuando el sistema crea un icono para un acceso directo, usa el mapa de bits del objeto correspondiente y agrega el icono de superposición de vínculo definido por el sistema (una flecha pequeña) a la esquina inferior izquierda.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-196">When the system creates an icon for a shortcut, it uses the bitmap of the corresponding object and adds the system-defined link overlay icon (a small arrow) to the lower left corner.</span></span> <span data-ttu-id="8f3cb-197">Una aplicación puede establecer la ubicación (ruta de acceso e índice) del icono de un acceso directo mediante el método [**IShellLink:: SetIconLocation**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-seticonlocation) .</span><span class="sxs-lookup"><span data-stu-id="8f3cb-197">An application can set the location (path and index) of a shortcut's icon by using the [**IShellLink::SetIconLocation**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-seticonlocation) method.</span></span> <span data-ttu-id="8f3cb-198">Una aplicación puede recuperar esta ubicación mediante el método [**IShellLink:: GetIconLocation**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-geticonlocation) .</span><span class="sxs-lookup"><span data-stu-id="8f3cb-198">An application can retrieve this location by using the [**IShellLink::GetIconLocation**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-geticonlocation) method.</span></span>

### <a name="shortcut-descriptions"></a><span data-ttu-id="8f3cb-199">Descripciones de acceso directo</span><span class="sxs-lookup"><span data-stu-id="8f3cb-199">Shortcut descriptions</span></span>

<span data-ttu-id="8f3cb-200">Los accesos directos tienen descripciones, pero el usuario nunca los ve.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-200">Shortcuts have descriptions, but the user never sees them.</span></span> <span data-ttu-id="8f3cb-201">Una aplicación puede usar una descripción para almacenar cualquier información de texto.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-201">An application can use a description to store any text information.</span></span> <span data-ttu-id="8f3cb-202">Las descripciones se establecen mediante el método [**IShellLink:: SetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setdescription) y se recuperan mediante el método [**IShellLink:: getDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getdescription) .</span><span class="sxs-lookup"><span data-stu-id="8f3cb-202">Descriptions are set using the [**IShellLink::SetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setdescription) method and retrieved using the [**IShellLink::GetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getdescription) method.</span></span>

### <a name="shortcut-keyboard-shortcuts"></a><span data-ttu-id="8f3cb-203">Métodos abreviados de teclado de acceso directo</span><span class="sxs-lookup"><span data-stu-id="8f3cb-203">Shortcut Keyboard Shortcuts</span></span>

<span data-ttu-id="8f3cb-204">Un objeto de acceso directo puede tener asociado un método abreviado de teclado.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-204">A shortcut object can have a keyboard shortcut associated with it.</span></span> <span data-ttu-id="8f3cb-205">Los métodos abreviados de teclado permiten al usuario presionar una combinación de teclas para activar un acceso directo.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-205">Keyboard shortcuts allow a user to press a combination of keys to activate a shortcut.</span></span> <span data-ttu-id="8f3cb-206">Una aplicación puede establecer el método abreviado de teclado para un acceso directo mediante el método [**IShellLink:: SetHotkey**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-sethotkey) y puede recuperar el método abreviado de teclado actual mediante el método [**IShellLink:: GetHotkey**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-gethotkey) .</span><span class="sxs-lookup"><span data-stu-id="8f3cb-206">An application can set the keyboard shortcut for a shortcut by using the [**IShellLink::SetHotkey**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-sethotkey) method and can retrieve the current keyboard shortcut by using the [**IShellLink::GetHotkey**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-gethotkey) method.</span></span>

### <a name="item-identifiers-and-identifier-lists"></a><span data-ttu-id="8f3cb-207">Identificadores de elementos y listas de identificadores</span><span class="sxs-lookup"><span data-stu-id="8f3cb-207">Item Identifiers and Identifier Lists</span></span>

<span data-ttu-id="8f3cb-208">El shell utiliza identificadores de objeto en el espacio de nombres del shell.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-208">The Shell uses object identifiers within the Shell's namespace.</span></span> <span data-ttu-id="8f3cb-209">Todos los objetos visibles en el Shell (archivos, directorios, servidores, grupos de trabajo, etc.) tienen identificadores únicos entre los objetos de su carpeta principal.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-209">All objects visible in the Shell (files, directories, servers, workgroups, and so on) have unique identifiers among the objects within their parent folder.</span></span> <span data-ttu-id="8f3cb-210">Estos identificadores se denominan identificadores de elemento y tienen el tipo de datos [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) , tal y como se define en el archivo de encabezado Shtypes. h.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-210">These identifiers are called item identifiers, and they have the [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) data type as defined in the Shtypes.h header file.</span></span> <span data-ttu-id="8f3cb-211">Un identificador de elemento es una secuencia de bytes de longitud variable que contiene información que identifica un objeto dentro de una carpeta.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-211">An item identifier is a variable-length byte stream that contains information that identifies an object within a folder.</span></span> <span data-ttu-id="8f3cb-212">Solo el creador de un identificador de elemento conoce el contenido y el formato del identificador.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-212">Only the creator of an item identifier knows the content and format of the identifier.</span></span> <span data-ttu-id="8f3cb-213">La única parte de un identificador de elemento que usa el Shell son los primeros dos bytes, que especifican el tamaño del identificador.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-213">The only part of an item identifier that the Shell uses is the first two bytes, which specify the size of the identifier.</span></span>

<span data-ttu-id="8f3cb-214">Cada carpeta primaria tiene su propio identificador de elemento que la identifica dentro de su propia carpeta principal.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-214">Each parent folder has its own item identifier that identifies it within its own parent folder.</span></span> <span data-ttu-id="8f3cb-215">Por lo tanto, cualquier objeto de Shell se puede identificar de forma única mediante una lista de identificadores de elemento.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-215">Thus, any Shell object can be uniquely identified by a list of item identifiers.</span></span> <span data-ttu-id="8f3cb-216">Una carpeta primaria mantiene una lista de identificadores para los elementos que contiene.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-216">A parent folder keeps a list of identifiers for the items it contains.</span></span> <span data-ttu-id="8f3cb-217">La lista tiene el tipo de datos [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) .</span><span class="sxs-lookup"><span data-stu-id="8f3cb-217">The list has the [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) data type.</span></span> <span data-ttu-id="8f3cb-218">Las listas de identificadores de elementos se asignan mediante el Shell y se pueden pasar a través de interfaces de Shell, como [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder).</span><span class="sxs-lookup"><span data-stu-id="8f3cb-218">Item identifier lists are allocated by the Shell and may be passed across Shell interfaces, such as [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder).</span></span> <span data-ttu-id="8f3cb-219">Es importante recordar que cada identificador de una lista de identificadores de elementos solo es significativo dentro del contexto de su carpeta principal.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-219">It is important to remember that each identifier in an item identifier list is only meaningful within the context of its parent folder.</span></span>

<span data-ttu-id="8f3cb-220">Una aplicación puede establecer la lista de identificadores de elementos de un acceso directo mediante el método [**IShellLink:: SetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setidlist) .</span><span class="sxs-lookup"><span data-stu-id="8f3cb-220">An application can set a shortcut's item identifier list by using the [**IShellLink::SetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setidlist) method.</span></span> <span data-ttu-id="8f3cb-221">Este método es útil cuando se establece un acceso directo a un objeto que no es un archivo, como una impresora o una unidad de disco.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-221">This method is useful when setting a shortcut to an object that is not a file, such as a printer or disk drive.</span></span> <span data-ttu-id="8f3cb-222">Una aplicación puede recuperar la lista de identificadores de elementos de un acceso directo mediante el método [**IShellLink:: GetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getidlist) .</span><span class="sxs-lookup"><span data-stu-id="8f3cb-222">An application can retrieve a shortcut's item identifier list by using the [**IShellLink::GetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getidlist) method.</span></span>

## <a name="using-shell-links"></a><span data-ttu-id="8f3cb-223">Usar vínculos de Shell</span><span class="sxs-lookup"><span data-stu-id="8f3cb-223">Using Shell Links</span></span>

<span data-ttu-id="8f3cb-224">Esta sección contiene ejemplos que muestran cómo crear y resolver accesos directos desde una aplicación basada en Win32.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-224">This section contains examples that demonstrate how to create and resolve shortcuts from within a Win32-based application.</span></span> <span data-ttu-id="8f3cb-225">En esta sección se da por supuesto que está familiarizado con la programación de Win32, C++ y OLE COM.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-225">This section assumes you are familiar with Win32, C++, and OLE COM programming.</span></span>

### <a name="creating-a-shortcut-and-a-folder-shortcut-to-a-file"></a><span data-ttu-id="8f3cb-226">Crear un acceso directo y un acceso directo a una carpeta en un archivo</span><span class="sxs-lookup"><span data-stu-id="8f3cb-226">Creating a Shortcut and a Folder Shortcut to a File</span></span>

<span data-ttu-id="8f3cb-227">En la función de ejemplo CreateLink del ejemplo siguiente se crea un acceso directo.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-227">The CreateLink sample function in the following example creates a shortcut.</span></span> <span data-ttu-id="8f3cb-228">Los parámetros incluyen un puntero al nombre del archivo al que se va a vincular, un puntero al nombre del acceso directo que está creando y un puntero a la descripción del vínculo.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-228">The parameters include a pointer to the name of the file to link to, a pointer to the name of the shortcut that you are creating, and a pointer to the description of the link.</span></span> <span data-ttu-id="8f3cb-229">La descripción consta de la cadena "acceso directo a **nombre de archivo**", donde **nombre de archivo** es el nombre del archivo al que se va a vincular.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-229">The description consists of the string, "Shortcut to **file name**," where **file name** is the name of the file to link to.</span></span>

<span data-ttu-id="8f3cb-230">Para crear un acceso directo a una carpeta mediante la función de ejemplo CreateLink, llame a [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) con CLSID \_ FolderShortcut, en lugar de CLSID \_ ShellLink (CLSID \_ FolderShortcut admite IShellLink).</span><span class="sxs-lookup"><span data-stu-id="8f3cb-230">To create a folder shortcut using the CreateLink sample function, call [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) using CLSID\_FolderShortcut, instead of CLSID\_ShellLink (CLSID\_FolderShortcut supports IShellLink).</span></span> <span data-ttu-id="8f3cb-231">El resto del código sigue siendo el mismo.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-231">All other code remains the same.</span></span>

<span data-ttu-id="8f3cb-232">Dado que CreateLink llama a la función [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) , se supone que ya se ha llamado a la función [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) .</span><span class="sxs-lookup"><span data-stu-id="8f3cb-232">Because CreateLink calls the [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) function, it is assumed that the [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) function has already been called.</span></span> <span data-ttu-id="8f3cb-233">CreateLink usa la interfaz [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) para guardar el acceso directo y la interfaz [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) para almacenar el nombre de archivo y la descripción.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-233">CreateLink uses the [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface to save the shortcut and the [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) interface to store the file name and description.</span></span>


```C++
// CreateLink - Uses the Shell's IShellLink and IPersistFile interfaces 
//              to create and store a shortcut to the specified object. 
//
// Returns the result of calling the member functions of the interfaces. 
//
// Parameters:
// lpszPathObj  - Address of a buffer that contains the path of the object,
//                including the file name.
// lpszPathLink - Address of a buffer that contains the path where the 
//                Shell link is to be stored, including the file name.
// lpszDesc     - Address of a buffer that contains a description of the 
//                Shell link, stored in the Comment field of the link
//                properties.

#include "stdafx.h"
#include "windows.h"
#include "winnls.h"
#include "shobjidl.h"
#include "objbase.h"
#include "objidl.h"
#include "shlguid.h"

HRESULT CreateLink(LPCWSTR lpszPathObj, LPCSTR lpszPathLink, LPCWSTR lpszDesc) 
{ 
    HRESULT hres; 
    IShellLink* psl; 
 
    // Get a pointer to the IShellLink interface. It is assumed that CoInitialize
    // has already been called.
    hres = CoCreateInstance(CLSID_ShellLink, NULL, CLSCTX_INPROC_SERVER, IID_IShellLink, (LPVOID*)&psl); 
    if (SUCCEEDED(hres)) 
    { 
        IPersistFile* ppf; 
 
        // Set the path to the shortcut target and add the description. 
        psl->SetPath(lpszPathObj); 
        psl->SetDescription(lpszDesc); 
 
        // Query IShellLink for the IPersistFile interface, used for saving the 
        // shortcut in persistent storage. 
        hres = psl->QueryInterface(IID_IPersistFile, (LPVOID*)&ppf); 
 
        if (SUCCEEDED(hres)) 
        { 
            WCHAR wsz[MAX_PATH]; 
 
            // Ensure that the string is Unicode. 
            MultiByteToWideChar(CP_ACP, 0, lpszPathLink, -1, wsz, MAX_PATH); 
            
            // Add code here to check return value from MultiByteWideChar 
            // for success.
 
            // Save the link by calling IPersistFile::Save. 
            hres = ppf->Save(wsz, TRUE); 
            ppf->Release(); 
        } 
        psl->Release(); 
    } 
    return hres; 
```



### <a name="resolving-a-shortcut"></a><span data-ttu-id="8f3cb-234">Resolución de un acceso directo</span><span class="sxs-lookup"><span data-stu-id="8f3cb-234">Resolving a Shortcut</span></span>

<span data-ttu-id="8f3cb-235">Es posible que una aplicación necesite tener acceso y manipular un acceso directo creado previamente.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-235">An application may need to access and manipulate a shortcut that was previously created.</span></span> <span data-ttu-id="8f3cb-236">Esta operación se conoce como resolver el acceso directo.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-236">This operation is referred to as resolving the shortcut.</span></span>

<span data-ttu-id="8f3cb-237">La función ResolveIt definida por la aplicación en el ejemplo siguiente resuelve un acceso directo.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-237">The application-defined ResolveIt function in the following example resolves a shortcut.</span></span> <span data-ttu-id="8f3cb-238">Sus parámetros incluyen un identificador de ventana, un puntero a la ruta de acceso del acceso directo y la dirección de un búfer que recibe la nueva ruta de acceso al objeto.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-238">Its parameters include a window handle, a pointer to the path of the shortcut, and the address of a buffer that receives the new path to the object.</span></span> <span data-ttu-id="8f3cb-239">El identificador de ventana identifica la ventana primaria para cualquier cuadro de mensaje que el shell pueda necesitar Mostrar.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-239">The window handle identifies the parent window for any message boxes that the Shell may need to display.</span></span> <span data-ttu-id="8f3cb-240">Por ejemplo, el shell puede mostrar un cuadro de mensaje si el vínculo está en medios no compartidos, si se producen problemas de red, si el usuario necesita insertar un disquete, etc.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-240">For example, the Shell can display a message box if the link is on unshared media, if network problems occur, if the user needs to insert a floppy disk, and so on.</span></span>

<span data-ttu-id="8f3cb-241">La función ResolveIt llama a la función [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) y da por supuesto que ya se ha llamado a la función [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) .</span><span class="sxs-lookup"><span data-stu-id="8f3cb-241">The ResolveIt function calls the [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) function and assumes that the [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) function has already been called.</span></span> <span data-ttu-id="8f3cb-242">Tenga en cuenta que ResolveIt debe usar la interfaz [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) para almacenar la información del vínculo.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-242">Note that ResolveIt needs to use the [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface to store the link information.</span></span> <span data-ttu-id="8f3cb-243">**IPersistFile** se implementa mediante el objeto [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) .</span><span class="sxs-lookup"><span data-stu-id="8f3cb-243">**IPersistFile** is implemented by the [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) object.</span></span> <span data-ttu-id="8f3cb-244">La información del vínculo debe cargarse antes de que se recupere la información de la ruta de acceso, que se muestra más adelante en el ejemplo.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-244">The link information must be loaded before the path information is retrieved, which is shown later in the example.</span></span> <span data-ttu-id="8f3cb-245">Si no se carga la información de vínculo, se producirá un error en las llamadas a las funciones miembro [**IShellLink:: GetPath**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getpath) y [**IShellLink:: getDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getdescription) .</span><span class="sxs-lookup"><span data-stu-id="8f3cb-245">Failing to load the link information causes the calls to the [**IShellLink::GetPath**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getpath) and [**IShellLink::GetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-getdescription) member functions to fail.</span></span>


```C++
// ResolveIt - Uses the Shell's IShellLink and IPersistFile interfaces 
//             to retrieve the path and description from an existing shortcut. 
//
// Returns the result of calling the member functions of the interfaces. 
//
// Parameters:
// hwnd         - A handle to the parent window. The Shell uses this window to 
//                display a dialog box if it needs to prompt the user for more 
//                information while resolving the link.
// lpszLinkFile - Address of a buffer that contains the path of the link,
//                including the file name.
// lpszPath     - Address of a buffer that receives the path of the link
                  target, including the file name.
// lpszDesc     - Address of a buffer that receives the description of the 
//                Shell link, stored in the Comment field of the link
//                properties.

#include "stdafx.h"
#include "windows.h"
#include "shobjidl.h"
#include "shlguid.h"
#include "strsafe.h"
                            
HRESULT ResolveIt(HWND hwnd, LPCSTR lpszLinkFile, LPWSTR lpszPath, int iPathBufferSize) 
{ 
    HRESULT hres; 
    IShellLink* psl; 
    WCHAR szGotPath[MAX_PATH]; 
    WCHAR szDescription[MAX_PATH]; 
    WIN32_FIND_DATA wfd; 
 
    *lpszPath = 0; // Assume failure 

    // Get a pointer to the IShellLink interface. It is assumed that CoInitialize
    // has already been called. 
    hres = CoCreateInstance(CLSID_ShellLink, NULL, CLSCTX_INPROC_SERVER, IID_IShellLink, (LPVOID*)&psl); 
    if (SUCCEEDED(hres)) 
    { 
        IPersistFile* ppf; 
 
        // Get a pointer to the IPersistFile interface. 
        hres = psl->QueryInterface(IID_IPersistFile, (void**)&ppf); 
        
        if (SUCCEEDED(hres)) 
        { 
            WCHAR wsz[MAX_PATH]; 
 
            // Ensure that the string is Unicode. 
            MultiByteToWideChar(CP_ACP, 0, lpszLinkFile, -1, wsz, MAX_PATH); 
 
            // Add code here to check return value from MultiByteWideChar 
            // for success.
 
            // Load the shortcut. 
            hres = ppf->Load(wsz, STGM_READ); 
            
            if (SUCCEEDED(hres)) 
            { 
                // Resolve the link. 
                hres = psl->Resolve(hwnd, 0); 

                if (SUCCEEDED(hres)) 
                { 
                    // Get the path to the link target. 
                    hres = psl->GetPath(szGotPath, MAX_PATH, (WIN32_FIND_DATA*)&wfd, SLGP_SHORTPATH); 

                    if (SUCCEEDED(hres)) 
                    { 
                        // Get the description of the target. 
                        hres = psl->GetDescription(szDescription, MAX_PATH); 

                        if (SUCCEEDED(hres)) 
                        {
                            hres = StringCbCopy(lpszPath, iPathBufferSize, szGotPath);
                            if (SUCCEEDED(hres))
                            {
                                // Handle success
                            }
                            else
                            {
                                // Handle the error
                            }
                        }
                    }
                } 
            } 

            // Release the pointer to the IPersistFile interface. 
            ppf->Release(); 
        } 

        // Release the pointer to the IShellLink interface. 
        psl->Release(); 
    } 
    return hres; 
}
```



### <a name="creating-a-shortcut-to-a-nonfile-object"></a><span data-ttu-id="8f3cb-246">Crear un acceso directo a un objeto que no es de archivo</span><span class="sxs-lookup"><span data-stu-id="8f3cb-246">Creating a Shortcut to a Nonfile Object</span></span>

<span data-ttu-id="8f3cb-247">Crear un acceso directo a un objeto que no es un archivo, como una impresora, es similar a crear un acceso directo a un archivo, salvo que en lugar de establecer la ruta de acceso en el archivo, debe establecer la lista de identificadores en la impresora.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-247">Creating a shortcut to a nonfile object, such as a printer, is similar to creating a shortcut to a file except that rather than setting the path to the file, you must set the identifier list to the printer.</span></span> <span data-ttu-id="8f3cb-248">Para establecer la lista de identificadores, llame al método [**IShellLink:: SetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setidlist) , especificando la dirección de una lista de identificadores.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-248">To set the identifier list, call the [**IShellLink::SetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setidlist) method, specifying the address of an identifier list.</span></span>

<span data-ttu-id="8f3cb-249">Cada objeto del espacio de nombres del shell tiene un identificador de elemento.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-249">Each object within the Shell's namespace has an item identifier.</span></span> <span data-ttu-id="8f3cb-250">El shell suele concatenar los identificadores de elemento en listas terminadas en null que se componen de cualquier número de identificadores de elemento.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-250">The Shell often concatenates item identifiers into null-terminated lists consisting of any number of item identifiers.</span></span> <span data-ttu-id="8f3cb-251">Para obtener más información sobre los identificadores de elemento, vea [identificadores de elemento y listas de identificadores](#item-identifiers-and-identifier-lists).</span><span class="sxs-lookup"><span data-stu-id="8f3cb-251">For more information about item identifiers, see [Item Identifiers and Identifier Lists](#item-identifiers-and-identifier-lists).</span></span>

<span data-ttu-id="8f3cb-252">En general, si tiene que establecer un acceso directo a un elemento que no tenga un nombre de archivo, como una impresora, ya tendrá un puntero a la interfaz [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) del objeto.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-252">In general, if you need to set a shortcut to an item that does not have a file name, such as a printer, you will already have a pointer to the object's [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="8f3cb-253">**IShellFolder** se usa para crear extensiones de espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-253">**IShellFolder** is used to create namespace extensions.</span></span>

<span data-ttu-id="8f3cb-254">Una vez que tenga el identificador de clase para [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder), puede llamar a la función [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) para recuperar la dirección de la interfaz.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-254">Once you have the class identifier for [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder), you can call the [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) function to retrieve the address of the interface.</span></span> <span data-ttu-id="8f3cb-255">Después, puede llamar a la interfaz para enumerar los objetos de la carpeta y recuperar la dirección del identificador de elemento para el objeto que está buscando.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-255">Then you can call the interface to enumerate the objects in the folder and retrieve the address of the item identifier for the object that you are searching for.</span></span> <span data-ttu-id="8f3cb-256">Por último, puede usar la dirección en una llamada a la función miembro [**IShellLink:: SetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setidlist) para crear un acceso directo al objeto.</span><span class="sxs-lookup"><span data-stu-id="8f3cb-256">Finally, you can use the address in a call to the [**IShellLink::SetIDList**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setidlist) member function to create a shortcut to the object.</span></span>

 

 
