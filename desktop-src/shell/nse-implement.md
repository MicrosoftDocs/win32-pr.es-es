---
description: El procedimiento para implementar una extensión de espacio de nombres es similar al de cualquier otro objeto de modelo de objetos componentes (COM) en proceso.
title: Implementar las interfaces de objeto de carpeta básicas
ms.topic: article
ms.date: 05/31/2018
ms.assetid: a45b8011-5355-429b-8935-4a7bdb5d2316
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: c05f5d2e4c21a923856c7324ad2d407230fa7595
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "104985662"
---
# <a name="implementing-the-basic-folder-object-interfaces"></a><span data-ttu-id="1adc9-103">Implementar las interfaces de objeto de carpeta básicas</span><span class="sxs-lookup"><span data-stu-id="1adc9-103">Implementing the Basic Folder Object Interfaces</span></span>

<span data-ttu-id="1adc9-104">El procedimiento para implementar una extensión de espacio de nombres es similar al de cualquier otro objeto de modelo de objetos componentes (COM) en proceso.</span><span class="sxs-lookup"><span data-stu-id="1adc9-104">The procedure for implementing a namespace extension is similar to that for any other in-process Component Object Model (COM) object.</span></span> <span data-ttu-id="1adc9-105">Todas las extensiones deben admitir tres interfaces principales que proporcionan al explorador de Windows la información básica necesaria para mostrar las carpetas de la extensión en la vista de árbol.</span><span class="sxs-lookup"><span data-stu-id="1adc9-105">All extensions must support three primary interfaces that provide Windows Explorer with the basic information needed to display the extension's folders in the tree view.</span></span> <span data-ttu-id="1adc9-106">Sin embargo, para hacer un uso completo de las capacidades del explorador de Windows, la extensión también debe exponer una o varias interfaces opcionales que admitan características más sofisticadas, como menús contextuales o arrastrar y colocar, y proporcionar una vista de carpeta.</span><span class="sxs-lookup"><span data-stu-id="1adc9-106">However, to make full use of the capabilities of Windows Explorer, your extension must also expose one or more optional interfaces that support more sophisticated features, such as shortcut menus or drag-and-drop, and provide a folder view.</span></span>

<span data-ttu-id="1adc9-107">En este documento se explica cómo implementar las interfaces principales y opcionales que el explorador de Windows llama para obtener información sobre el contenido de la extensión.</span><span class="sxs-lookup"><span data-stu-id="1adc9-107">This document discusses how to implement the primary and optional interfaces that Windows Explorer calls for information about the contents of your extension.</span></span> <span data-ttu-id="1adc9-108">Para obtener información sobre cómo implementar una vista de carpetas y cómo personalizar el explorador de Windows, consulte [implementar una vista de carpeta](../lwef/nse-folderview.md).</span><span class="sxs-lookup"><span data-stu-id="1adc9-108">For a discussion of how to implement a folder view and how to customize Windows Explorer, see [Implementing a Folder View](../lwef/nse-folderview.md).</span></span>

-   [<span data-ttu-id="1adc9-109">Implementación y registro básicos</span><span class="sxs-lookup"><span data-stu-id="1adc9-109">Basic Implementation and Registration</span></span>](#basic-implementation-and-registration)
    -   [<span data-ttu-id="1adc9-110">Registrar una extensión</span><span class="sxs-lookup"><span data-stu-id="1adc9-110">Registering an Extension</span></span>](#registering-an-extension)
-   [<span data-ttu-id="1adc9-111">Controlar PIDL</span><span class="sxs-lookup"><span data-stu-id="1adc9-111">Handling PIDLs</span></span>](#handling-pidls)
    -   [<span data-ttu-id="1adc9-112">Crear una estructura SHITEMID</span><span class="sxs-lookup"><span data-stu-id="1adc9-112">Creating an SHITEMID Structure</span></span>](#creating-an-shitemid-structure)
    -   [<span data-ttu-id="1adc9-113">Construir un PIDL</span><span class="sxs-lookup"><span data-stu-id="1adc9-113">Constructing a PIDL</span></span>](#constructing-a-pidl)
    -   [<span data-ttu-id="1adc9-114">Interpretar PIDL</span><span class="sxs-lookup"><span data-stu-id="1adc9-114">Interpreting PIDLs</span></span>](#interpreting-pidls)
-   [<span data-ttu-id="1adc9-115">Implementar las interfaces principales</span><span class="sxs-lookup"><span data-stu-id="1adc9-115">Implementing the Primary Interfaces</span></span>](#implementing-the-primary-interfaces)
    -   [<span data-ttu-id="1adc9-116">Interfaz IPersistFolder</span><span class="sxs-lookup"><span data-stu-id="1adc9-116">IPersistFolder Interface</span></span>](#ipersistfolder-interface)
    -   [<span data-ttu-id="1adc9-117">Interfaz IShellFolder</span><span class="sxs-lookup"><span data-stu-id="1adc9-117">IShellFolder Interface</span></span>](#ishellfolder-interface)
    -   [<span data-ttu-id="1adc9-118">Interfaz IEnumIDList</span><span class="sxs-lookup"><span data-stu-id="1adc9-118">IEnumIDList Interface</span></span>](#ienumidlist-interface)
-   [<span data-ttu-id="1adc9-119">Implementar las interfaces opcionales</span><span class="sxs-lookup"><span data-stu-id="1adc9-119">Implementing the Optional Interfaces</span></span>](#implementing-the-optional-interfaces)
    -   [<span data-ttu-id="1adc9-120">IExtractIcon</span><span class="sxs-lookup"><span data-stu-id="1adc9-120">IExtractIcon</span></span>](#iextracticon)
    -   [<span data-ttu-id="1adc9-121">IContextMenu</span><span class="sxs-lookup"><span data-stu-id="1adc9-121">IContextMenu</span></span>](#icontextmenu)
    -   [<span data-ttu-id="1adc9-122">IQueryInfo</span><span class="sxs-lookup"><span data-stu-id="1adc9-122">IQueryInfo</span></span>](#iqueryinfo)
    -   [<span data-ttu-id="1adc9-123">IDataObject e IDropTarget</span><span class="sxs-lookup"><span data-stu-id="1adc9-123">IDataObject and IDropTarget</span></span>](#idataobject-and-idroptarget)
-   [<span data-ttu-id="1adc9-124">Trabajar con la implementación de vista de carpeta de Shell predeterminada</span><span class="sxs-lookup"><span data-stu-id="1adc9-124">Working With the Default Shell Folder View Implementation</span></span>](#working-with-the-default-shell-folder-view-implementation)

## <a name="basic-implementation-and-registration"></a><span data-ttu-id="1adc9-125">Implementación y registro básicos</span><span class="sxs-lookup"><span data-stu-id="1adc9-125">Basic Implementation and Registration</span></span>

<span data-ttu-id="1adc9-126">Como servidor COM en proceso, el archivo DLL debe exponer varias funciones y interfaces estándar:</span><span class="sxs-lookup"><span data-stu-id="1adc9-126">As an in-process COM server, your DLL must expose several standard functions and interfaces:</span></span>

-   [<span data-ttu-id="1adc9-127">**DllCanUnloadNow**</span><span class="sxs-lookup"><span data-stu-id="1adc9-127">**DllCanUnloadNow**</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow)
-   [<span data-ttu-id="1adc9-128">**DllGetClassObject**</span><span class="sxs-lookup"><span data-stu-id="1adc9-128">**DllGetClassObject**</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject)
-   [<span data-ttu-id="1adc9-129">**IClassFactory**</span><span class="sxs-lookup"><span data-stu-id="1adc9-129">**IClassFactory**</span></span>](/windows/win32/api/unknwn/nn-unknwn-iclassfactory)
-   [<span data-ttu-id="1adc9-130">**IUnknown**</span><span class="sxs-lookup"><span data-stu-id="1adc9-130">**IUnknown**</span></span>](/windows/win32/api/unknwn/nn-unknwn-iunknown)

<span data-ttu-id="1adc9-131">Estas funciones e interfaces se implementan de la misma manera que para la mayoría de los demás objetos COM.</span><span class="sxs-lookup"><span data-stu-id="1adc9-131">These functions and interfaces are implemented in the same way as they are for most other COM objects.</span></span> <span data-ttu-id="1adc9-132">Para obtener más información, consulte la [documentación de com](../com/the-component-object-model.md).</span><span class="sxs-lookup"><span data-stu-id="1adc9-132">For details, see the [COM documentation](../com/the-component-object-model.md).</span></span>

### <a name="registering-an-extension"></a><span data-ttu-id="1adc9-133">Registrar una extensión</span><span class="sxs-lookup"><span data-stu-id="1adc9-133">Registering an Extension</span></span>

<span data-ttu-id="1adc9-134">Al igual que con todos los objetos COM, debe crear un GUID de identificador de clase (CLSID) para la extensión.</span><span class="sxs-lookup"><span data-stu-id="1adc9-134">As with all COM objects, you must create a class identifier (CLSID) GUID for your extension.</span></span> <span data-ttu-id="1adc9-135">Registre el objeto creando una subclave de **\_ clase HKEY \_ raíz** \\ **CLSID** denominada para el CLSID de la extensión.</span><span class="sxs-lookup"><span data-stu-id="1adc9-135">Register the object by creating a subkey of **HKEY\_CLASSES\_ROOT**\\**CLSID** named for the CLSID of your extension.</span></span> <span data-ttu-id="1adc9-136">El archivo DLL se debe registrar como un servidor en proceso y debe especificar el modelo de subprocesos de apartamento.</span><span class="sxs-lookup"><span data-stu-id="1adc9-136">The DLL should be registered as an in-process server and should specify the apartment threading model.</span></span> <span data-ttu-id="1adc9-137">Puede personalizar el comportamiento de la carpeta raíz de una extensión agregando una variedad de subclaves y valores a la clave CLSID de la extensión.</span><span class="sxs-lookup"><span data-stu-id="1adc9-137">You can customize the behavior of an extension's root folder by adding a variety of subkeys and values to the extension's CLSID key.</span></span>

<span data-ttu-id="1adc9-138">Algunos de estos valores solo se aplican a las extensiones con puntos de Unión virtuales.</span><span class="sxs-lookup"><span data-stu-id="1adc9-138">Several of these values apply only to extensions with virtual junction points.</span></span> <span data-ttu-id="1adc9-139">Estos valores no se aplican a las extensiones cuyos puntos de Unión son carpetas del sistema de archivos.</span><span class="sxs-lookup"><span data-stu-id="1adc9-139">These values do not apply to extensions whose junction points are file system folders.</span></span> <span data-ttu-id="1adc9-140">Para obtener más información, vea [especificar la ubicación de una extensión de espacio de nombres](nse-junction.md).</span><span class="sxs-lookup"><span data-stu-id="1adc9-140">For further discussion, see [Specifying a Namespace Extension's Location](nse-junction.md).</span></span> <span data-ttu-id="1adc9-141">Para modificar el comportamiento de una extensión con un punto de Unión virtual, agregue uno o varios de los siguientes valores a la clave CLSID de la extensión:</span><span class="sxs-lookup"><span data-stu-id="1adc9-141">To modify the behavior of an extension with a virtual junction point, add one or more of the following values to the extension's CLSID key:</span></span>

-   <span data-ttu-id="1adc9-142">WantsFORPARSING.</span><span class="sxs-lookup"><span data-stu-id="1adc9-142">WantsFORPARSING.</span></span> <span data-ttu-id="1adc9-143">Normalmente, el nombre de análisis de una extensión con un punto de Unión virtual tendrá el formato:: {*GUID*}.</span><span class="sxs-lookup"><span data-stu-id="1adc9-143">The parsing name for an extension with a virtual junction point will normally have the form ::{*GUID*}.</span></span> <span data-ttu-id="1adc9-144">Normalmente, las extensiones de este tipo contienen elementos virtuales.</span><span class="sxs-lookup"><span data-stu-id="1adc9-144">Extensions of this type normally contain virtual items.</span></span> <span data-ttu-id="1adc9-145">Sin embargo, algunas extensiones, como mis documentos, se corresponden realmente con las carpetas del sistema de archivos, aunque tengan puntos de Unión virtuales.</span><span class="sxs-lookup"><span data-stu-id="1adc9-145">However, some extensions, such as My Documents, actually correspond to file system folders, even though they have virtual junction points.</span></span> <span data-ttu-id="1adc9-146">Si la extensión representa objetos del sistema de archivos de esta manera, puede establecer el valor de WantsFORPARSING.</span><span class="sxs-lookup"><span data-stu-id="1adc9-146">If your extension represents file system objects in this way, you can set the WantsFORPARSING value.</span></span> <span data-ttu-id="1adc9-147">Después, el explorador de Windows solicitará el nombre de análisis de la carpeta raíz llamando al método [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) del objeto de la carpeta con *UFlags* establecido en **SHGDN \_ FORPARSING** y *PIDL* establecido en un único puntero vacío a una lista de identificadores de elementos (PIDL).</span><span class="sxs-lookup"><span data-stu-id="1adc9-147">Windows Explorer will then request your root folder's parsing name by calling the folder object's [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) method with *uFlags* set to **SHGDN\_FORPARSING** and *pidl* set to a single empty pointer to an item identifier list (PIDL).</span></span> <span data-ttu-id="1adc9-148">Un PIDL vacío solo contiene un terminador.</span><span class="sxs-lookup"><span data-stu-id="1adc9-148">An empty PIDL contains only a terminator.</span></span> <span data-ttu-id="1adc9-149">Después, el método debe devolver el nombre de análisis de la carpeta raíz:: {*GUID*}.</span><span class="sxs-lookup"><span data-stu-id="1adc9-149">Your method should then return the root folder's ::{*GUID*} parsing name.</span></span>
-   <span data-ttu-id="1adc9-150">HideFolderVerbs.</span><span class="sxs-lookup"><span data-stu-id="1adc9-150">HideFolderVerbs.</span></span> <span data-ttu-id="1adc9-151">Los verbos registrados en la **carpeta \_ \_ raíz de las clases HKEY** \\  suelen estar asociados a todas las extensiones.</span><span class="sxs-lookup"><span data-stu-id="1adc9-151">The verbs registered under **HKEY\_CLASSES\_ROOT**\\**Folder** normally are associated with all extensions.</span></span> <span data-ttu-id="1adc9-152">Aparecen en el menú contextual de la extensión y se pueden invocar mediante [**ShellExecute**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecutea).</span><span class="sxs-lookup"><span data-stu-id="1adc9-152">They appear on the extension's shortcut menu and can be invoked by [**ShellExecute**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecutea).</span></span> <span data-ttu-id="1adc9-153">Para evitar que cualquiera de estos verbos se asocie a la extensión, establezca el valor de HideFolderVerbs.</span><span class="sxs-lookup"><span data-stu-id="1adc9-153">To prevent any of these verbs from being associated with your extension, set the HideFolderVerbs value.</span></span>
-   <span data-ttu-id="1adc9-154">HideAsDelete.</span><span class="sxs-lookup"><span data-stu-id="1adc9-154">HideAsDelete.</span></span> <span data-ttu-id="1adc9-155">Si un usuario intenta eliminar la extensión, el explorador de Windows ocultará en su lugar la extensión.</span><span class="sxs-lookup"><span data-stu-id="1adc9-155">If a user attempts to delete your extension, Windows Explorer will instead hide the extension.</span></span>
-   <span data-ttu-id="1adc9-156">HideAsDeletePerUser.</span><span class="sxs-lookup"><span data-stu-id="1adc9-156">HideAsDeletePerUser.</span></span> <span data-ttu-id="1adc9-157">Este valor tiene el mismo efecto que HideAsDelete, pero por usuario.</span><span class="sxs-lookup"><span data-stu-id="1adc9-157">This value has the same effect as HideAsDelete but on a per-user basis.</span></span> <span data-ttu-id="1adc9-158">La extensión solo está oculta para los usuarios que han intentado eliminarla.</span><span class="sxs-lookup"><span data-stu-id="1adc9-158">The extension is hidden only for those users who have attempted to delete it.</span></span> <span data-ttu-id="1adc9-159">La extensión es visible para todos los demás usuarios.</span><span class="sxs-lookup"><span data-stu-id="1adc9-159">The extension is visible to all other users.</span></span>
-   <span data-ttu-id="1adc9-160">QueryForOverlay.</span><span class="sxs-lookup"><span data-stu-id="1adc9-160">QueryForOverlay.</span></span> <span data-ttu-id="1adc9-161">Establezca este valor para indicar que el icono de la carpeta raíz puede tener una superposición de iconos.</span><span class="sxs-lookup"><span data-stu-id="1adc9-161">Set this value to indicate that the root folder's icon can have an icon overlay.</span></span> <span data-ttu-id="1adc9-162">El objeto de carpeta debe admitir la interfaz [**IShellIconOverlay**](/windows/win32/api/shlobj_core/nn-shlobj_core-ishelliconoverlay) .</span><span class="sxs-lookup"><span data-stu-id="1adc9-162">The folder object must support the [**IShellIconOverlay**](/windows/win32/api/shlobj_core/nn-shlobj_core-ishelliconoverlay) interface.</span></span> <span data-ttu-id="1adc9-163">Antes de que el explorador de Windows muestre el icono de la carpeta raíz, se solicitará un icono de superposición llamando a uno de los dos métodos **IShellIconOverlay** con *pidlItem* establecido en un PIDL vacío.</span><span class="sxs-lookup"><span data-stu-id="1adc9-163">Before Windows Explorer displays the root folder's icon, it will request an overlay icon by calling one of the two **IShellIconOverlay** methods with *pidlItem* set to an empty PIDL.</span></span>

<span data-ttu-id="1adc9-164">Los valores y subclaves restantes se aplican a todas las extensiones:</span><span class="sxs-lookup"><span data-stu-id="1adc9-164">The remaining values and subkeys apply to all extensions:</span></span>

-   <span data-ttu-id="1adc9-165">Para especificar el nombre para mostrar de la carpeta de punto de unión de la extensión, establezca el valor predeterminado de la subclave CLSID de la extensión en una cadena adecuada.</span><span class="sxs-lookup"><span data-stu-id="1adc9-165">To specify the display name of the extension's junction point folder, set the default value of the extension's CLSID subkey to an appropriate string.</span></span>
-   <span data-ttu-id="1adc9-166">Cuando el cursor se mantiene sobre una carpeta, normalmente se muestra un recuadro informativo que describe el contenido de la carpeta.</span><span class="sxs-lookup"><span data-stu-id="1adc9-166">When the cursor hovers over a folder, an infotip is typically displayed that describes the contents of the folder.</span></span> <span data-ttu-id="1adc9-167">Para proporcionar un recuadro informativo a la carpeta raíz de la extensión, cree un valor de **reg \_ SZ** para la clave CLSID de la extensión y establézcalo en una cadena adecuada.</span><span class="sxs-lookup"><span data-stu-id="1adc9-167">To provide an infotip for your extension's root folder, create an InfoTip **REG\_SZ** value for the extension's CLSID key, and set it to an appropriate string.</span></span>
-   <span data-ttu-id="1adc9-168">Para especificar un icono personalizado para la carpeta raíz de la extensión, cree una subclave de la subclave CLSID de la extensión denominada **DefaultIcon**.</span><span class="sxs-lookup"><span data-stu-id="1adc9-168">To specify a custom icon for your extension's root folder, create a subkey of the extension's CLSID subkey named **DefaultIcon**.</span></span> <span data-ttu-id="1adc9-169">Establezca el valor predeterminado de **DefaultIcon** en un valor de **reg \_ SZ** que contenga el nombre del archivo que contiene el icono, seguido de una coma, seguido de un signo menos, seguido del índice del icono de ese archivo.</span><span class="sxs-lookup"><span data-stu-id="1adc9-169">Set the default value of **DefaultIcon** to a **REG\_SZ** value containing the name of the file that contains the icon, followed by a comma, followed by a minus sign, followed by the index of the icon in that file.</span></span>
-   <span data-ttu-id="1adc9-170">De forma predeterminada, el menú contextual de la carpeta raíz de la extensión contendrá los elementos definidos en la **\_ \_ \\ carpeta raíz HKEY classes**.</span><span class="sxs-lookup"><span data-stu-id="1adc9-170">By default, the shortcut menu of your extension's root folder will contain the items defined under **HKEY\_CLASSES\_ROOT\\Folder**.</span></span> <span data-ttu-id="1adc9-171">Si ha establecido las marcas SFGAO XXX adecuadas, se agregan los elementos **eliminar**, **cambiar nombre** y **propiedades** \_ .</span><span class="sxs-lookup"><span data-stu-id="1adc9-171">The **Delete**, **Rename**, and **Properties** items are added if you have set the appropriate SFGAO\_XXX flags.</span></span> <span data-ttu-id="1adc9-172">Puede agregar otros elementos al menú contextual de la carpeta raíz o invalidar los elementos existentes, de forma muy similar a como lo haría con un [tipo de archivo](fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="1adc9-172">You can add other items to the root folder's shortcut menu, or override existing items, much as you would for a [file type](fa-file-types.md).</span></span> <span data-ttu-id="1adc9-173">Cree una subclave de **Shell** en la clave CLSID de la extensión y defina los comandos como se describe en [extender menús contextuales](context.md).</span><span class="sxs-lookup"><span data-stu-id="1adc9-173">Create a **Shell** subkey under the extension's CLSID key, and define commands as discussed in [Extending Shortcut Menus](context.md).</span></span>
-   <span data-ttu-id="1adc9-174">Si necesita una manera más flexible de controlar el menú contextual de la carpeta raíz, puede implementar un [controlador de menú contextual](context-menu-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="1adc9-174">If you need a more flexible way to handle the root folder's shortcut menu, you can implement a [shortcut menu handler](context-menu-handlers.md).</span></span> <span data-ttu-id="1adc9-175">Para registrar el controlador de menú contextual, cree una clave **ShellEx** en la clave CLSID de la extensión.</span><span class="sxs-lookup"><span data-stu-id="1adc9-175">To register the shortcut menu handler, create a **ShellEx** key under the extension's CLSID key.</span></span> <span data-ttu-id="1adc9-176">Registre el CLSID del controlador como lo haría para los controladores de la [extensión de Shell de creación](handlers.md)convencionales.</span><span class="sxs-lookup"><span data-stu-id="1adc9-176">Register the handler's CLSID as you would for a conventional [Creating Shell Extension Handlers](handlers.md).</span></span>
-   <span data-ttu-id="1adc9-177">Para agregar una página a la hoja de propiedades de la carpeta raíz, asigne a la carpeta el atributo **SFGAO \_ HASPROPSHEET** e implemente un controlador de la [hoja de propiedades](propsheet-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="1adc9-177">To add a page to the root folder's Properties property sheet, give the folder the **SFGAO\_HASPROPSHEET** attribute and implement a [property sheet handler](propsheet-handlers.md).</span></span> <span data-ttu-id="1adc9-178">Para registrar el controlador de la hoja de propiedades, cree una clave **ShellEx** en la clave CLSID de la extensión.</span><span class="sxs-lookup"><span data-stu-id="1adc9-178">To register the property sheet handler, create a **ShellEx** key under the extension's CLSID key.</span></span> <span data-ttu-id="1adc9-179">Registre el CLSID del controlador como lo haría para los controladores de la [extensión de Shell de creación](handlers.md)convencionales.</span><span class="sxs-lookup"><span data-stu-id="1adc9-179">Register the handler's CLSID as you would for a conventional [Creating Shell Extension Handlers](handlers.md).</span></span>
-   <span data-ttu-id="1adc9-180">Para especificar los atributos de la carpeta raíz, agregue una subclave **ShellFolder** a la subclave CLSID de la extensión.</span><span class="sxs-lookup"><span data-stu-id="1adc9-180">To specify the attributes of the root folder, add a **ShellFolder** subkey to the extension's CLSID subkey.</span></span> <span data-ttu-id="1adc9-181">Cree un valor de atributos y establézcalo en la combinación adecuada de marcas [**SFGAO \_ XXX**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) .</span><span class="sxs-lookup"><span data-stu-id="1adc9-181">Create an Attributes value, and set it to the appropriate combination of [**SFGAO\_XXX**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) flags.</span></span>

<span data-ttu-id="1adc9-182">En la tabla siguiente se enumeran algunos atributos usados comúnmente para las carpetas raíz.</span><span class="sxs-lookup"><span data-stu-id="1adc9-182">The following table lists some commonly used attributes for root folders.</span></span>



| <span data-ttu-id="1adc9-183">Marca</span><span class="sxs-lookup"><span data-stu-id="1adc9-183">Flag</span></span>                | <span data-ttu-id="1adc9-184">Value</span><span class="sxs-lookup"><span data-stu-id="1adc9-184">Value</span></span>      | <span data-ttu-id="1adc9-185">Descripción</span><span class="sxs-lookup"><span data-stu-id="1adc9-185">Description</span></span>                                                                                                                                                                                                                                                                                                       |
|---------------------|------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="1adc9-186">\_carpeta SFGAO</span><span class="sxs-lookup"><span data-stu-id="1adc9-186">SFGAO\_FOLDER</span></span>       | <span data-ttu-id="1adc9-187">0x20000000</span><span class="sxs-lookup"><span data-stu-id="1adc9-187">0x20000000</span></span> | <span data-ttu-id="1adc9-188">La carpeta raíz de la extensión contiene uno o varios elementos.</span><span class="sxs-lookup"><span data-stu-id="1adc9-188">The extension's root folder contains one or more items.</span></span>                                                                                                                                                                                                                                                           |
| <span data-ttu-id="1adc9-189">SFGAO \_ HASSUBFOLDER</span><span class="sxs-lookup"><span data-stu-id="1adc9-189">SFGAO\_HASSUBFOLDER</span></span> | <span data-ttu-id="1adc9-190">0x80000000</span><span class="sxs-lookup"><span data-stu-id="1adc9-190">0x80000000</span></span> | <span data-ttu-id="1adc9-191">La carpeta raíz de la extensión contiene una o varias subcarpetas.</span><span class="sxs-lookup"><span data-stu-id="1adc9-191">The extension's root folder contains one or more subfolders.</span></span> <span data-ttu-id="1adc9-192">El explorador de Windows colocará un signo más (+) junto al icono de carpeta.</span><span class="sxs-lookup"><span data-stu-id="1adc9-192">Windows Explorer will place a plus sign ( + ) next to the folder icon.</span></span>                                                                                                                                                                               |
| <span data-ttu-id="1adc9-193">SFGAO \_ CANDELETE</span><span class="sxs-lookup"><span data-stu-id="1adc9-193">SFGAO\_CANDELETE</span></span>    | <span data-ttu-id="1adc9-194">0x00000020</span><span class="sxs-lookup"><span data-stu-id="1adc9-194">0x00000020</span></span> | <span data-ttu-id="1adc9-195">El usuario puede eliminar la carpeta raíz de la extensión.</span><span class="sxs-lookup"><span data-stu-id="1adc9-195">The extension's root folder can be deleted by the user.</span></span> <span data-ttu-id="1adc9-196">El menú contextual de la carpeta tendrá un elemento **eliminar** .</span><span class="sxs-lookup"><span data-stu-id="1adc9-196">The folder's shortcut menu will have a **Delete** item.</span></span> <span data-ttu-id="1adc9-197">Esta marca se debe establecer para los puntos de Unión que se colocan en una de las [carpetas virtuales](nse-junction.md).</span><span class="sxs-lookup"><span data-stu-id="1adc9-197">This flag should be set for junction points that are placed under one of the [virtual folders](nse-junction.md).</span></span>                                                                                 |
| <span data-ttu-id="1adc9-198">SFGAO \_ CANRENAME</span><span class="sxs-lookup"><span data-stu-id="1adc9-198">SFGAO\_CANRENAME</span></span>    | <span data-ttu-id="1adc9-199">0x00000010</span><span class="sxs-lookup"><span data-stu-id="1adc9-199">0x00000010</span></span> | <span data-ttu-id="1adc9-200">El usuario puede cambiar el nombre de la carpeta raíz de la extensión.</span><span class="sxs-lookup"><span data-stu-id="1adc9-200">The extension's root folder can be renamed by the user.</span></span> <span data-ttu-id="1adc9-201">El menú contextual de la carpeta tendrá un elemento **cambiar nombre** .</span><span class="sxs-lookup"><span data-stu-id="1adc9-201">The folder's shortcut menu will have a **Rename** item.</span></span>                                                                                                                                                                                                   |
| <span data-ttu-id="1adc9-202">SFGAO \_ HASPROPSHEET</span><span class="sxs-lookup"><span data-stu-id="1adc9-202">SFGAO\_HASPROPSHEET</span></span> | <span data-ttu-id="1adc9-203">0x00000040</span><span class="sxs-lookup"><span data-stu-id="1adc9-203">0x00000040</span></span> | <span data-ttu-id="1adc9-204">La carpeta raíz de la extensión tiene una hoja de propiedades de **propiedades** .</span><span class="sxs-lookup"><span data-stu-id="1adc9-204">The extension's root folder has a **Properties** property sheet.</span></span> <span data-ttu-id="1adc9-205">El menú contextual de la carpeta tendrá un elemento **propiedades** .</span><span class="sxs-lookup"><span data-stu-id="1adc9-205">The folder's shortcut menu will have a **Properties** item.</span></span> <span data-ttu-id="1adc9-206">Para proporcionar la hoja de propiedades, debe implementar un [controlador](propsheet-handlers.md)de la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="1adc9-206">To provide the property sheet, you must implement a [property sheet handler](propsheet-handlers.md).</span></span> <span data-ttu-id="1adc9-207">Registre el controlador bajo la clave CLSID de la extensión, como se explicó anteriormente.</span><span class="sxs-lookup"><span data-stu-id="1adc9-207">Register the handler under the extension's CLSID key, as discussed previously.</span></span> |



 

<span data-ttu-id="1adc9-208">En el ejemplo siguiente se muestra la entrada del registro CLSID para una extensión con el nombre para mostrar de la extensión.</span><span class="sxs-lookup"><span data-stu-id="1adc9-208">The following example shows the CLSID registry entry for an extension with a display name of MyExtension.</span></span> <span data-ttu-id="1adc9-209">La extensión tiene un icono personalizado que se encuentra en el archivo DLL de la extensión con un índice de 1.</span><span class="sxs-lookup"><span data-stu-id="1adc9-209">The extension has a custom icon that is contained in the extension's DLL with an index of 1.</span></span> <span data-ttu-id="1adc9-210">Se establecen los atributos **SFGAO \_**, **SFGAO \_ HASSUBFOLDER** y **SFGAO \_ CANDELETE** .</span><span class="sxs-lookup"><span data-stu-id="1adc9-210">The **SFGAO\_FOLDER**, **SFGAO\_HASSUBFOLDER**, and **SFGAO\_CANDELETE** attributes are set.</span></span>

```
HKEY_CLASSES_ROOT
   CLSID
      {Extension CLSID}
         (Default) = MyExtension
         InfoTip = Some appropriate text
      DefaultIcon
         (Default) = c:\MyDir\MyExtension.dll,-1
      InProcServer32
         (Default) = c:\MyDir\MyExtension.dll
         ThreadingModel = Apartment
      ShellFolder
         Attributes = 0xA00000020
```

## <a name="handling-pidls"></a><span data-ttu-id="1adc9-211">Controlar PIDL</span><span class="sxs-lookup"><span data-stu-id="1adc9-211">Handling PIDLs</span></span>

<span data-ttu-id="1adc9-212">Todos los elementos del espacio de nombres del shell deben tener un PIDL único.</span><span class="sxs-lookup"><span data-stu-id="1adc9-212">Every item in the Shell namespace must have a unique PIDL.</span></span> <span data-ttu-id="1adc9-213">El explorador de Windows asigna un PIDL a la carpeta raíz y pasa el valor a la extensión durante la inicialización.</span><span class="sxs-lookup"><span data-stu-id="1adc9-213">Windows Explorer assigns a PIDL to your root folder and passes the value to your extension during initialization.</span></span> <span data-ttu-id="1adc9-214">A continuación, la extensión es responsable de asignar un PIDL construido correctamente a cada uno de sus objetos y de proporcionar esos PIDL al explorador de Windows a petición.</span><span class="sxs-lookup"><span data-stu-id="1adc9-214">Your extension is then responsible for assigning a properly constructed PIDL to each of its objects and providing those PIDLs to Windows Explorer on request.</span></span> <span data-ttu-id="1adc9-215">Cuando el shell usa un PIDL para identificar uno de los objetos de la extensión, la extensión debe ser capaz de interpretar el PIDL e identificar el objeto determinado.</span><span class="sxs-lookup"><span data-stu-id="1adc9-215">When the Shell uses a PIDL to identify one of your extension's objects, your extension must be able to interpret the PIDL and identify the particular object.</span></span> <span data-ttu-id="1adc9-216">La extensión también debe asignar un [**nombre para mostrar**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-setnameof) y un *nombre de análisis* a cada objeto.</span><span class="sxs-lookup"><span data-stu-id="1adc9-216">Your extension must also assign a [**display name**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-setnameof) and a *parsing name* to each object.</span></span> <span data-ttu-id="1adc9-217">Dado que la PIDL se usa prácticamente en cada interfaz de carpeta, las extensiones suelen implementar un único *Administrador de PIDL* para controlar todas estas tareas.</span><span class="sxs-lookup"><span data-stu-id="1adc9-217">Because PIDLs are used by virtually every folder interface, extensions commonly implement a single *PIDL manager* to handle all these tasks.</span></span>

<span data-ttu-id="1adc9-218">El término PIDL es corto para una estructura [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) o un puntero a una estructura de este tipo, dependiendo del contexto.</span><span class="sxs-lookup"><span data-stu-id="1adc9-218">The term PIDL is short for an [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) structure or a pointer to such a structure, depending on context.</span></span> <span data-ttu-id="1adc9-219">Como se declara, una estructura **ITEMIDLIST** tiene un solo miembro, una estructura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) .</span><span class="sxs-lookup"><span data-stu-id="1adc9-219">As declared, an **ITEMIDLIST** structure has a single member, an [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure.</span></span> <span data-ttu-id="1adc9-220">La estructura **ITEMIDLIST** de un objeto es realmente una matriz empaquetada de dos o más estructuras **SHITEMID** .</span><span class="sxs-lookup"><span data-stu-id="1adc9-220">An object's **ITEMIDLIST** structure is actually a packed array of two or more **SHITEMID** structures.</span></span> <span data-ttu-id="1adc9-221">El orden de estas estructuras define una ruta de acceso a través del espacio de nombres, de la misma manera que c: myPath \\ \\ myPath define una ruta de acceso a través del sistema de archivos.</span><span class="sxs-lookup"><span data-stu-id="1adc9-221">The order of these structures defines a path through the namespace, in much the same way that c:\\MyDirectory\\MyFile defines a path through the file system.</span></span> <span data-ttu-id="1adc9-222">Normalmente, el PIDL de un objeto constará de una serie de estructuras **SHITEMID** que se corresponden con las carpetas que definen la ruta de acceso del espacio de nombres, seguida de la estructura **SHITEMID** del objeto, seguida de un terminador.</span><span class="sxs-lookup"><span data-stu-id="1adc9-222">Typically, an object's PIDL will consist of a series of **SHITEMID** structures that correspond to the folders that define the namespace path, followed by the object's **SHITEMID** structure, followed by a terminator.</span></span>

<span data-ttu-id="1adc9-223">El terminador es una estructura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) , con el miembro *CB* establecido en **null**.</span><span class="sxs-lookup"><span data-stu-id="1adc9-223">The terminator is an [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure, with the *cb* member set to **NULL**.</span></span> <span data-ttu-id="1adc9-224">El terminador es necesario porque el número de estructuras **SHITEMID** de PIDL de un objeto depende de la ubicación del objeto en el espacio de nombres del shell y del punto inicial de la ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="1adc9-224">The terminator is necessary because the number of **SHITEMID** structures in an object's PIDL depends on the location of the object in the Shell namespace, and the starting point of the path.</span></span> <span data-ttu-id="1adc9-225">Además, el tamaño de las distintas estructuras **SHITEMID** puede variar.</span><span class="sxs-lookup"><span data-stu-id="1adc9-225">In addition, the size of the various **SHITEMID** structures can vary.</span></span> <span data-ttu-id="1adc9-226">Cuando recibe un PIDL, no tiene una forma sencilla de determinar su tamaño o incluso el número total de estructuras de **SHITEMID** .</span><span class="sxs-lookup"><span data-stu-id="1adc9-226">When you receive a PIDL, you have no simple way of determining its size or even the total number of **SHITEMID** structures.</span></span> <span data-ttu-id="1adc9-227">En su lugar, debe "recorrer" la matriz empaquetada, estructurada por estructura, hasta alcanzar el terminador.</span><span class="sxs-lookup"><span data-stu-id="1adc9-227">Instead, you must "walk" the packed array, structure by structure, until you reach the terminator.</span></span>

<span data-ttu-id="1adc9-228">Para crear un PIDL, la aplicación debe:</span><span class="sxs-lookup"><span data-stu-id="1adc9-228">To create a PIDL, your application needs to:</span></span>

1.  <span data-ttu-id="1adc9-229">Cree una estructura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) para cada uno de sus objetos.</span><span class="sxs-lookup"><span data-stu-id="1adc9-229">Create an [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure for each of its objects.</span></span>
2.  <span data-ttu-id="1adc9-230">Ensamble las estructuras [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) relevantes en un PIDL.</span><span class="sxs-lookup"><span data-stu-id="1adc9-230">Assemble the relevant [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures into a PIDL.</span></span>

### <a name="creating-an-shitemid-structure"></a><span data-ttu-id="1adc9-231">Crear una estructura SHITEMID</span><span class="sxs-lookup"><span data-stu-id="1adc9-231">Creating an SHITEMID Structure</span></span>

<span data-ttu-id="1adc9-232">La estructura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) de un objeto identifica de forma única el objeto dentro de su carpeta.</span><span class="sxs-lookup"><span data-stu-id="1adc9-232">An object's [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure uniquely identifies the object within its folder.</span></span> <span data-ttu-id="1adc9-233">De hecho, un tipo de PIDL utilizado por muchos de los métodos [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) solo se compone de la estructura **SHITEMID** del objeto, seguida de un terminador.</span><span class="sxs-lookup"><span data-stu-id="1adc9-233">In fact, a type of PIDL used by many of the [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) methods consists of just the object's **SHITEMID** structure, followed by a terminator.</span></span> <span data-ttu-id="1adc9-234">La definición de una estructura **SHITEMID** es:</span><span class="sxs-lookup"><span data-stu-id="1adc9-234">The definition of an **SHITEMID** structure is:</span></span>


```C++
typedef struct _SHITEMID { 
    USHORT cb; 
    BYTE   abID[1]; 
} SHITEMID, * LPSHITEMID;
```



<span data-ttu-id="1adc9-235">El miembro *atenerse* es el identificador del objeto.</span><span class="sxs-lookup"><span data-stu-id="1adc9-235">The *abID* member is the object's identifier.</span></span> <span data-ttu-id="1adc9-236">Dado que la longitud de la extensión *no está definida* y puede variar, el miembro *CB* se establece en el tamaño de la estructura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) , en bytes.</span><span class="sxs-lookup"><span data-stu-id="1adc9-236">Because the length of *abID* is not defined and can vary, the *cb* member is set to the size of the [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure, in bytes.</span></span>

<span data-ttu-id="1adc9-237">Dado que *no se normaliza* ni la longitud ni el contenido de la extensión, puede usar cualquier esquema que desee *asignar a los objetos* .</span><span class="sxs-lookup"><span data-stu-id="1adc9-237">Because neither the length nor the content of *abID* is standardized, you can use any scheme you want to assign *abID* values to your objects.</span></span> <span data-ttu-id="1adc9-238">El único requisito es que no se pueden tener dos objetos en la misma carpeta con valores idénticos.</span><span class="sxs-lookup"><span data-stu-id="1adc9-238">The only requirement is that you cannot have two objects in the same folder with identical values.</span></span> <span data-ttu-id="1adc9-239">Sin embargo, por motivos de rendimiento, la estructura de [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) debe alinearse con **DWORD**.</span><span class="sxs-lookup"><span data-stu-id="1adc9-239">However, for performance reasons, your [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure should be **DWORD**-aligned.</span></span> <span data-ttu-id="1adc9-240">En otras palabras, debe construir los valores de *respetar* tal que *CB* sea un múltiplo entero de 4.</span><span class="sxs-lookup"><span data-stu-id="1adc9-240">In other words, you should construct your *abID* values such that *cb* is an integral multiple of 4.</span></span>

<span data-ttu-id="1adc9-241">Normalmente, se *hace referencia a* una estructura definida por la extensión.</span><span class="sxs-lookup"><span data-stu-id="1adc9-241">Typically, *abID* points to an extension-defined structure.</span></span> <span data-ttu-id="1adc9-242">Además del identificador del objeto, esta estructura se usa a menudo para contener una gran variedad de información relacionada, como el tipo o los atributos del objeto.</span><span class="sxs-lookup"><span data-stu-id="1adc9-242">In addition to the object's ID, this structure is often used to hold a variety of related information, such as the object's type or attributes.</span></span> <span data-ttu-id="1adc9-243">Los objetos de carpeta de la extensión pueden extraer rápidamente la información de PIDL en lugar de tener que consultarla.</span><span class="sxs-lookup"><span data-stu-id="1adc9-243">Your extension's folder objects can then quickly extract the information from the PIDL instead of having to query for it.</span></span>

> [!Note]  
> <span data-ttu-id="1adc9-244">Uno de los aspectos más importantes del diseño de una estructura de datos para un PIDL es hacer que la estructura sea persistente y se pueda transportar.</span><span class="sxs-lookup"><span data-stu-id="1adc9-244">One of the most important aspects of designing a data structure for a PIDL is to make the structure persistable and transportable.</span></span> <span data-ttu-id="1adc9-245">En el contexto de PIDL, el significado de estos términos es:</span><span class="sxs-lookup"><span data-stu-id="1adc9-245">In the context of PIDLs, the meaning of these terms is:</span></span>
>
> -   <span data-ttu-id="1adc9-246">Con persistencia.</span><span class="sxs-lookup"><span data-stu-id="1adc9-246">Persistable.</span></span> <span data-ttu-id="1adc9-247">Con frecuencia, el sistema coloca PIDL en varios tipos de almacenamiento a largo plazo, como archivos de acceso directo.</span><span class="sxs-lookup"><span data-stu-id="1adc9-247">The system frequently places PIDLs in various types of long-term storage, such as shortcut files.</span></span> <span data-ttu-id="1adc9-248">Después, puede recuperar estos PIDL desde el almacenamiento más adelante, probablemente después de reiniciar el sistema.</span><span class="sxs-lookup"><span data-stu-id="1adc9-248">It can then recover these PIDLs from storage later, possibly after the system has been rebooted.</span></span> <span data-ttu-id="1adc9-249">Un PIDL que se ha recuperado del almacenamiento debe seguir siendo válido y significativo para la extensión.</span><span class="sxs-lookup"><span data-stu-id="1adc9-249">A PIDL that has been recovered from storage must still be valid and meaningful to your extension.</span></span> <span data-ttu-id="1adc9-250">Este requisito significa, por ejemplo, que no se deben usar punteros o manipuladores en la estructura PIDL.</span><span class="sxs-lookup"><span data-stu-id="1adc9-250">This requirement means, for instance, that you should not use pointers or handles in your PIDL structure.</span></span> <span data-ttu-id="1adc9-251">Los PIDL que contienen este tipo de datos normalmente no tendrán sentido cuando el sistema los recupere posteriormente del almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="1adc9-251">PIDLs containing this type of data will normally be meaningless when the system later recovers them from storage.</span></span>
> -   <span data-ttu-id="1adc9-252">Transportables.</span><span class="sxs-lookup"><span data-stu-id="1adc9-252">Transportable.</span></span> <span data-ttu-id="1adc9-253">Un PIDL debe seguir siendo significativo cuando se transporta de un equipo a otro.</span><span class="sxs-lookup"><span data-stu-id="1adc9-253">A PIDL must remain meaningful when transported from one computer to another.</span></span> <span data-ttu-id="1adc9-254">Por ejemplo, un PIDL puede escribirse en un archivo de acceso directo, copiarse en un disquete y transportarse a otro equipo.</span><span class="sxs-lookup"><span data-stu-id="1adc9-254">For example, a PIDL can be written to a shortcut file, copied to a floppy disk, and transported to another computer.</span></span> <span data-ttu-id="1adc9-255">Ese PIDL debe seguir siendo significativo para la extensión que se ejecuta en el segundo equipo.</span><span class="sxs-lookup"><span data-stu-id="1adc9-255">That PIDL should still be meaningful to your extension running on the second computer.</span></span> <span data-ttu-id="1adc9-256">Por ejemplo, para asegurarse de que los PIDL sean transportables, use explícitamente caracteres ANSI o Unicode.</span><span class="sxs-lookup"><span data-stu-id="1adc9-256">For instance, to ensure that your PIDLs are transportable, use either ANSI or Unicode characters explicitly.</span></span> <span data-ttu-id="1adc9-257">Evite tipos de datos como **TCHAR** o **LPTSTR**.</span><span class="sxs-lookup"><span data-stu-id="1adc9-257">Avoid data types such as **TCHAR** or **LPTSTR**.</span></span> <span data-ttu-id="1adc9-258">Si usa esos tipos de datos, un PIDL creado en un equipo que ejecute una versión Unicode de la extensión no se podrá leer con una versión ANSI de esa extensión que se ejecute en un equipo diferente.</span><span class="sxs-lookup"><span data-stu-id="1adc9-258">If you use those data types, a PIDL created on a computer running a Unicode version of your extension will not be readable by an ANSI version of that extension running on a different computer.</span></span>

 

<span data-ttu-id="1adc9-259">En la declaración siguiente se muestra un ejemplo simple de una estructura de datos.</span><span class="sxs-lookup"><span data-stu-id="1adc9-259">The following declaration shows a simple example of a data structure.</span></span>


```C++
typedef struct tagMYPIDLDATA {
  USHORT cb;
  DWORD dwType;
  WCHAR wszDisplayName[40];
} MYPIDLDATA, *LPMYPIDLDATA;
```



<span data-ttu-id="1adc9-260">El miembro **CB** se establece en el tamaño de la estructura **MYPIDLDATA** .</span><span class="sxs-lookup"><span data-stu-id="1adc9-260">The **cb** member is set to the size of the **MYPIDLDATA** structure.</span></span> <span data-ttu-id="1adc9-261">Este miembro convierte **MYPIDLDATA** en una estructura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) válida, en y de sí misma.</span><span class="sxs-lookup"><span data-stu-id="1adc9-261">This member makes **MYPIDLDATA** a valid [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure, in and of itself.</span></span> <span data-ttu-id="1adc9-262">El resto de los miembros son equivalentes a **los miembros** de una estructura **SHITEMID** y contienen datos privados.</span><span class="sxs-lookup"><span data-stu-id="1adc9-262">The rest of the members are equivalent to the **abID** member of an **SHITEMID** structure and hold private data.</span></span> <span data-ttu-id="1adc9-263">El miembro **dwType** es un valor definido por la extensión que indica el tipo de objeto.</span><span class="sxs-lookup"><span data-stu-id="1adc9-263">The **dwType** member is an extension-defined value that indicates the type of object.</span></span> <span data-ttu-id="1adc9-264">En este ejemplo, **dwType** se establece en **true** para las carpetas y **false** en caso contrario.</span><span class="sxs-lookup"><span data-stu-id="1adc9-264">For this example, **dwType** is set to **TRUE** for folders and **FALSE** otherwise.</span></span> <span data-ttu-id="1adc9-265">Este miembro le permite, por ejemplo, determinar rápidamente si el objeto es o no una carpeta.</span><span class="sxs-lookup"><span data-stu-id="1adc9-265">This member allows you, for instance, to quickly determine whether the object is a folder or not.</span></span> <span data-ttu-id="1adc9-266">El miembro **wszDisplayName** contiene el nombre para mostrar del objeto.</span><span class="sxs-lookup"><span data-stu-id="1adc9-266">The **wszDisplayName** member contains the object's display name.</span></span> <span data-ttu-id="1adc9-267">Dado que no asignaría el mismo nombre para mostrar a dos objetos diferentes en la misma carpeta, el nombre para mostrar también sirve como identificador de objeto.</span><span class="sxs-lookup"><span data-stu-id="1adc9-267">Since you would not assign the same display name to two different objects in the same folder, the display name also serves as the object ID.</span></span> <span data-ttu-id="1adc9-268">En este ejemplo, **wszDisplayName** se establece en 40 caracteres para garantizar que la estructura **SHITEMID** se alineará con **DWORD**.</span><span class="sxs-lookup"><span data-stu-id="1adc9-268">In this example, **wszDisplayName** is set to 40 characters to guarantee that the **SHITEMID** structure will be **DWORD**-aligned.</span></span> <span data-ttu-id="1adc9-269">Para limitar el tamaño de PIDL, puede usar una matriz de caracteres de longitud variable y ajustar el valor de CB en consecuencia.</span><span class="sxs-lookup"><span data-stu-id="1adc9-269">To limit the size of your PIDLs, you can instead use a variable-length character array and adjust the value of cb accordingly.</span></span> <span data-ttu-id="1adc9-270">Rellene la cadena de presentación con suficientes \\ caracteres ' 0 ' para mantener la alineación **DWORD** de la estructura.</span><span class="sxs-lookup"><span data-stu-id="1adc9-270">Pad the display string with enough '\\0' characters to maintain the structure's **DWORD** alignment.</span></span> <span data-ttu-id="1adc9-271">Otros miembros que pueden ser útiles para colocar en la estructura incluyen el tamaño del objeto, los atributos o el nombre de análisis.</span><span class="sxs-lookup"><span data-stu-id="1adc9-271">Other members that might be useful to put in the structure include the object's size, attributes, or parsing name.</span></span>

### <a name="constructing-a-pidl"></a><span data-ttu-id="1adc9-272">Construir un PIDL</span><span class="sxs-lookup"><span data-stu-id="1adc9-272">Constructing a PIDL</span></span>

<span data-ttu-id="1adc9-273">Una vez que haya definido las estructuras [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) para los objetos, puede usarlas para construir un PIDL.</span><span class="sxs-lookup"><span data-stu-id="1adc9-273">Once you have defined [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures for your objects, you can then use them to construct a PIDL.</span></span> <span data-ttu-id="1adc9-274">PIDL se puede construir para una variedad de propósitos, pero en la mayoría de las tareas se usa uno de los dos tipos de PIDL.</span><span class="sxs-lookup"><span data-stu-id="1adc9-274">PIDLs can be constructed for a variety of purposes, but most tasks use one of two types of PIDL.</span></span> <span data-ttu-id="1adc9-275">La más simple, una PIDL de un solo nivel, identifica el objeto relativo a su carpeta principal.</span><span class="sxs-lookup"><span data-stu-id="1adc9-275">The simplest, a single-level PIDL, identifies the object relative to its parent folder.</span></span> <span data-ttu-id="1adc9-276">Muchos de los métodos [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) utilizan este tipo de PIDL.</span><span class="sxs-lookup"><span data-stu-id="1adc9-276">This type of PIDL is used by many of the [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) methods.</span></span> <span data-ttu-id="1adc9-277">Un PIDL de nivel único contiene la estructura **SHITEMID** del objeto, seguida de un terminador.</span><span class="sxs-lookup"><span data-stu-id="1adc9-277">A single-level PIDL contains the object's **SHITEMID** structure, followed by a terminator.</span></span> <span data-ttu-id="1adc9-278">Un PIDL completo define una ruta de acceso a través de la jerarquía de espacios de nombres desde el escritorio hasta el objeto.</span><span class="sxs-lookup"><span data-stu-id="1adc9-278">A fully qualified PIDL defines a path through the namespace hierarchy from the desktop to the object.</span></span> <span data-ttu-id="1adc9-279">Este tipo de PIDL se inicia en el escritorio y contiene una estructura **SHITEMID** para cada carpeta de la ruta de acceso, seguida del objeto y el terminador.</span><span class="sxs-lookup"><span data-stu-id="1adc9-279">This type of PIDL starts at the desktop and contains one **SHITEMID** structure for each folder in the path, followed by the object and the terminator.</span></span> <span data-ttu-id="1adc9-280">Un PIDL completo identifica de forma única el objeto en todo el espacio de nombres del shell.</span><span class="sxs-lookup"><span data-stu-id="1adc9-280">A fully qualified PIDL uniquely identifies the object within the entire Shell namespace.</span></span>

<span data-ttu-id="1adc9-281">La manera más sencilla de construir un PIDL es trabajar directamente con la propia estructura [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) .</span><span class="sxs-lookup"><span data-stu-id="1adc9-281">The simplest way to construct a PIDL is to work directly with the [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) structure itself.</span></span> <span data-ttu-id="1adc9-282">Cree una estructura **ITEMIDLIST** , pero asigne suficiente memoria para contener todas las estructuras [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) .</span><span class="sxs-lookup"><span data-stu-id="1adc9-282">Create an **ITEMIDLIST** structure, but allocate enough memory to hold all the [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures.</span></span> <span data-ttu-id="1adc9-283">La dirección de esta estructura apuntará a la estructura **SHITEMID** inicial.</span><span class="sxs-lookup"><span data-stu-id="1adc9-283">The address of this structure will point to the initial **SHITEMID** structure.</span></span> <span data-ttu-id="1adc9-284">Defina valores para los miembros de esta estructura inicial y, a continuación, anexe tantas estructuras **SHITEMID** adicionales como necesite, en el orden adecuado.</span><span class="sxs-lookup"><span data-stu-id="1adc9-284">Define values for the members of this initial structure, and then append as many additional **SHITEMID** structures as you need, in the appropriate order.</span></span> <span data-ttu-id="1adc9-285">En el procedimiento siguiente se describe cómo crear un PIDL de nivel único.</span><span class="sxs-lookup"><span data-stu-id="1adc9-285">The following procedure outlines how to create a single-level PIDL.</span></span> <span data-ttu-id="1adc9-286">Contiene dos estructuras **SHITEMID** : una estructura **MYPIDLDATA** seguida de un terminador:</span><span class="sxs-lookup"><span data-stu-id="1adc9-286">It contains two **SHITEMID** structures—a **MYPIDLDATA** structure followed by a terminator:</span></span>

1.  <span data-ttu-id="1adc9-287">Use la función [**CoTaskMemAlloc**](/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemalloc) para asignar memoria para el PIDL.</span><span class="sxs-lookup"><span data-stu-id="1adc9-287">Use the [**CoTaskMemAlloc**](/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemalloc) function to allocate memory for the PIDL.</span></span> <span data-ttu-id="1adc9-288">Asigne suficiente memoria para los datos privados más un **USHORT** (dos bytes) para el terminador.</span><span class="sxs-lookup"><span data-stu-id="1adc9-288">Allocate enough memory for your private data plus a **USHORT** (two bytes) for the terminator.</span></span> <span data-ttu-id="1adc9-289">Convierta el resultado en LPMYPIDLDATA.</span><span class="sxs-lookup"><span data-stu-id="1adc9-289">Cast the result to LPMYPIDLDATA.</span></span>
2.  <span data-ttu-id="1adc9-290">Establezca el miembro CB de la primera estructura **MYPIDLDATA** en el tamaño de esa estructura.</span><span class="sxs-lookup"><span data-stu-id="1adc9-290">Set the cb member of the first **MYPIDLDATA** structure to the size of that structure.</span></span> <span data-ttu-id="1adc9-291">En este ejemplo, se debería establecer **CB** en SIZEOF (MYPIDLDATA).</span><span class="sxs-lookup"><span data-stu-id="1adc9-291">For this example, you would set **cb** to sizeof(MYPIDLDATA).</span></span> <span data-ttu-id="1adc9-292">Si desea usar una estructura de longitud variable, tendrá que calcular el valor de **CB**.</span><span class="sxs-lookup"><span data-stu-id="1adc9-292">If you want to use a variable-length structure, you will have to calculate the value of **cb**.</span></span>
3.  <span data-ttu-id="1adc9-293">Asigne los valores adecuados a los miembros de datos privados.</span><span class="sxs-lookup"><span data-stu-id="1adc9-293">Assign appropriate values to the private data members.</span></span>
4.  <span data-ttu-id="1adc9-294">Calcula la dirección de la siguiente estructura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) .</span><span class="sxs-lookup"><span data-stu-id="1adc9-294">Calculate the address of the next [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure.</span></span> <span data-ttu-id="1adc9-295">Convierta la dirección de la estructura MYPIDLDATA actual a LPBYTE y agregue ese valor al valor de **CB** determinado en el paso 3.</span><span class="sxs-lookup"><span data-stu-id="1adc9-295">Cast the address of the current MYPIDLDATA structure to LPBYTE, and add that value to the value of **cb** determined in step 3.</span></span>
5.  <span data-ttu-id="1adc9-296">En este caso, la siguiente estructura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) es el terminador.</span><span class="sxs-lookup"><span data-stu-id="1adc9-296">In this case, the next [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure is the terminator.</span></span> <span data-ttu-id="1adc9-297">Establezca el miembro **CB** de la estructura en cero.</span><span class="sxs-lookup"><span data-stu-id="1adc9-297">Set the structure's **cb** member to zero.</span></span>

<span data-ttu-id="1adc9-298">Para PIDL más largos, asigne suficiente memoria y repita los pasos 3-5 para cada estructura de [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) adicional.</span><span class="sxs-lookup"><span data-stu-id="1adc9-298">For longer PIDLs, allocate sufficient memory and repeat steps 3-5 for each additional [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure.</span></span>

<span data-ttu-id="1adc9-299">La función de ejemplo siguiente toma el tipo y el nombre para mostrar de un objeto y devuelve el PIDL de un solo nivel del objeto.</span><span class="sxs-lookup"><span data-stu-id="1adc9-299">The following sample function takes an object's type and display name and returns the object's single-level PIDL.</span></span> <span data-ttu-id="1adc9-300">La función supone que el nombre para mostrar, incluido el carácter **nulo** de terminación, no supera el número de caracteres declarado para la estructura **MYPIDLDATA** .</span><span class="sxs-lookup"><span data-stu-id="1adc9-300">The function assumes that the display name, including its terminating **null** character, does not exceed the number of characters declared for the **MYPIDLDATA** structure.</span></span> <span data-ttu-id="1adc9-301">Si esa hipótesis deja de ser errónea, la función [**StringCbCopyW**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopya) truncará el nombre para mostrar.</span><span class="sxs-lookup"><span data-stu-id="1adc9-301">If that assumption turns out to be erroneous, the [**StringCbCopyW**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopya) function will truncate the display name.</span></span> <span data-ttu-id="1adc9-302">La variable **g \_ pMalloc** es un puntero [**IMalloc**](/windows/win32/api/objidlbase/nn-objidlbase-imalloc) creado en otro lugar y almacenado en una variable global.</span><span class="sxs-lookup"><span data-stu-id="1adc9-302">The **g\_pMalloc** variable is an [**IMalloc**](/windows/win32/api/objidlbase/nn-objidlbase-imalloc) pointer created elsewhere and stored in a global variable.</span></span>


```C++
LPITEMIDLIST CreatePIDL(DWORD dwType, LPCWSTR pwszDisplayName)
{
    LPMYPIDLDATA   pidlOut;
    USHORT         uSize;

    pidlOut = NULL;

    //Calculate the size of the MYPIDLDATA structure.
    uSize = sizeof(MYPIDLDATA);

    // Allocate enough memory for the PIDL to hold a MYPIDLDATA structure 
    // plus the terminator
    pidlOut = (LPMYPIDLDATA)m_pMalloc->Alloc(uSize + sizeof(USHORT));

    if(pidlOut)
    {
       //Assign values to the members of the MYPIDLDATA structure
       //that is the PIDL's first SHITEMID structure
       pidlOut->cb = uSize;
       pidlOut->dwType = dwType;
       hr = StringCbCopyW(pidlOut->wszDisplayName, 
                          sizeof(pidlOut->wszDisplayName), pwszDisplayName);
       
       // TODO: Add error handling here to verify the HRESULT returned 
       // by StringCbCopyW.

       //Advance the pointer to the start of the next SHITEMID structure.
       pidlOut = (LPMYPIDLDATA)((LPBYTE)pidlOut + pidlOut->cb);

       //Create the terminating null character by setting cb to 0.
       pidlOut->cb = 0;
    }

    return pidlOut;
```



<span data-ttu-id="1adc9-303">Un PIDL completo debe tener estructuras [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) para cada objeto del escritorio al objeto.</span><span class="sxs-lookup"><span data-stu-id="1adc9-303">A fully qualified PIDL must have [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures for every object from the desktop to your object.</span></span> <span data-ttu-id="1adc9-304">La extensión recibe un PIDL completo para la carpeta raíz cuando el shell llama a [**IPersistFolder:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipersistfolder-initialize).</span><span class="sxs-lookup"><span data-stu-id="1adc9-304">Your extension receives a fully qualified PIDL for your root folder when the Shell calls [**IPersistFolder::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipersistfolder-initialize).</span></span> <span data-ttu-id="1adc9-305">Para construir un PIDL completo para un objeto, tome el PIDL que el shell haya asignado a la carpeta raíz y Anexe las estructuras **SHITEMID** que se necesitan para llevarle de la carpeta raíz al objeto.</span><span class="sxs-lookup"><span data-stu-id="1adc9-305">To construct a fully qualified PIDL for an object, take the PIDL that the Shell has assigned to your root folder, and append the **SHITEMID** structures that are needed to take you from the root folder to the object.</span></span>

### <a name="interpreting-pidls"></a><span data-ttu-id="1adc9-306">Interpretar PIDL</span><span class="sxs-lookup"><span data-stu-id="1adc9-306">Interpreting PIDLs</span></span>

<span data-ttu-id="1adc9-307">Cuando el shell o una aplicación llama a una de las interfaces de la extensión para solicitar información sobre un objeto, normalmente identificará el objeto por un PIDL.</span><span class="sxs-lookup"><span data-stu-id="1adc9-307">When the Shell or an application calls one of your extension's interfaces to request information about an object, it will usually identify the object by a PIDL.</span></span> <span data-ttu-id="1adc9-308">Algunos métodos, como [**IShellFolder:: GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof), usan PIDL que son relativos a la carpeta principal y son fáciles de interpretar.</span><span class="sxs-lookup"><span data-stu-id="1adc9-308">Some methods, such as [**IShellFolder::GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof), use PIDLs that are relative to the parent folder and are straightforward to interpret.</span></span> <span data-ttu-id="1adc9-309">Sin embargo, la extensión probablemente también recibirá PIDL completo.</span><span class="sxs-lookup"><span data-stu-id="1adc9-309">However, your extension will probably also receive fully qualified PIDLs.</span></span> <span data-ttu-id="1adc9-310">Después, el administrador de PIDL debe determinar a qué objetos hace referencia PIDL.</span><span class="sxs-lookup"><span data-stu-id="1adc9-310">Your PIDL manager must then determine which of your objects that PIDL is referring to.</span></span>

<span data-ttu-id="1adc9-311">Lo que complica la tarea de asociar un objeto con un PIDL completo es que una o varias de las estructuras [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) iniciales de la PIDL pueden pertenecer a objetos que se encuentran fuera de la extensión en el espacio de nombres del shell.</span><span class="sxs-lookup"><span data-stu-id="1adc9-311">What complicates the task of associating an object with a fully qualified PIDL is that one or more of the initial [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures in the PIDL might belong to objects that lie outside your extension in the Shell namespace.</span></span> <span data-ttu-id="1adc9-312">No se puede interpretar el significado del miembro *acatar* de esas estructuras.</span><span class="sxs-lookup"><span data-stu-id="1adc9-312">You have no way of interpreting the meaning of the *abID* member of those structures.</span></span> <span data-ttu-id="1adc9-313">Lo que debe hacer la extensión es "recorrer" la lista de estructuras **SHITEMID** , hasta que llegue a la estructura que corresponde a la carpeta raíz.</span><span class="sxs-lookup"><span data-stu-id="1adc9-313">What your extension must do is to "walk" the list of **SHITEMID** structures, until you reach the structure that corresponds to your root folder.</span></span> <span data-ttu-id="1adc9-314">A partir de entonces, sabrá cómo interpretar la información de las estructuras **SHITEMID** .</span><span class="sxs-lookup"><span data-stu-id="1adc9-314">From then on, you will know how to interpret the information in the **SHITEMID** structures.</span></span>

<span data-ttu-id="1adc9-315">Para recorrer el PIDL, tome el primer valor *CB* y agréguelo a la dirección del PIDL para avanzar el puntero hasta el inicio de la siguiente estructura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) .</span><span class="sxs-lookup"><span data-stu-id="1adc9-315">To walk the PIDL, take the first *cb* value and add it to the address of the PIDL to advance the pointer to the start of the next [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure.</span></span> <span data-ttu-id="1adc9-316">A continuación, señalará al miembro *CB* de esa estructura, que puede usar para avanzar el puntero hasta el inicio de la siguiente estructura **SHITEMID** , etc.</span><span class="sxs-lookup"><span data-stu-id="1adc9-316">It then will be pointing to that structure's *cb* member, which you can use to advance the pointer to the start of the next **SHITEMID** structure, and so on.</span></span> <span data-ttu-id="1adc9-317">Cada vez que avance el puntero, examine la estructura **SHITEMID** para determinar si se ha alcanzado la raíz del espacio de nombres de la extensión.</span><span class="sxs-lookup"><span data-stu-id="1adc9-317">Each time you advance the pointer, examine the **SHITEMID** structure to determine whether you have reached the root of your extension's namespace.</span></span>

## <a name="implementing-the-primary-interfaces"></a><span data-ttu-id="1adc9-318">Implementar las interfaces principales</span><span class="sxs-lookup"><span data-stu-id="1adc9-318">Implementing the Primary Interfaces</span></span>

<span data-ttu-id="1adc9-319">Al igual que con todos los objetos COM, implementar una extensión es en gran medida la implementación de una colección de interfaces.</span><span class="sxs-lookup"><span data-stu-id="1adc9-319">As with all COM objects, implementing an extension is largely a matter of implementing a collection of interfaces.</span></span> <span data-ttu-id="1adc9-320">En esta sección se describen las tres interfaces principales que deben implementar todas las extensiones.</span><span class="sxs-lookup"><span data-stu-id="1adc9-320">This section discusses the three primary interfaces that must be implemented by all extensions.</span></span> <span data-ttu-id="1adc9-321">Se utilizan para la inicialización y para proporcionar al explorador de Windows información básica sobre el contenido de la extensión.</span><span class="sxs-lookup"><span data-stu-id="1adc9-321">They are used for initialization and to provide Windows Explorer with basic information about the contents of the extension.</span></span> <span data-ttu-id="1adc9-322">Estas interfaces, además de una [vista de carpeta](../lwef/nse-folderview.md), son todas necesarias para una extensión funcional.</span><span class="sxs-lookup"><span data-stu-id="1adc9-322">These interfaces, plus a [folder view](../lwef/nse-folderview.md), are all that is required for a functional extension.</span></span> <span data-ttu-id="1adc9-323">Sin embargo, para aprovechar por completo las características del explorador de Windows, la mayoría de las extensiones también implementan una o varias de las interfaces opcionales.</span><span class="sxs-lookup"><span data-stu-id="1adc9-323">However, to fully exploit the features of Windows Explorer, most extensions also implement one or more of the optional interfaces.</span></span>

### <a name="ipersistfolder-interface"></a><span data-ttu-id="1adc9-324">Interfaz IPersistFolder</span><span class="sxs-lookup"><span data-stu-id="1adc9-324">IPersistFolder Interface</span></span>

<span data-ttu-id="1adc9-325">Se llama a la interfaz [**IPersistFolder**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder) para inicializar un nuevo objeto Folder.</span><span class="sxs-lookup"><span data-stu-id="1adc9-325">The [**IPersistFolder**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder) interface is called to initialize a new folder object.</span></span> <span data-ttu-id="1adc9-326">El método [**IPersistFolder:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipersistfolder-initialize) asigna un PIDL completo al nuevo objeto.</span><span class="sxs-lookup"><span data-stu-id="1adc9-326">The [**IPersistFolder::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipersistfolder-initialize) method assigns a fully qualified PIDL to the new object.</span></span> <span data-ttu-id="1adc9-327">Almacene este PIDL para su uso posterior.</span><span class="sxs-lookup"><span data-stu-id="1adc9-327">Store this PIDL for later use.</span></span> <span data-ttu-id="1adc9-328">Por ejemplo, un objeto de carpeta debe usar este PIDL para construir PIDL completos para los elementos secundarios del objeto.</span><span class="sxs-lookup"><span data-stu-id="1adc9-328">For instance, a folder object must use this PIDL to construct fully qualified PIDLs for the object's children.</span></span> <span data-ttu-id="1adc9-329">El creador del objeto de la carpeta también puede llamar a [**IPersist:: GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) para solicitar el CLSID del objeto.</span><span class="sxs-lookup"><span data-stu-id="1adc9-329">The folder object's creator can also call [**IPersist::GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) to request the object's CLSID.</span></span>

<span data-ttu-id="1adc9-330">Normalmente, el método [**IShellFolder:: BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) de la carpeta primaria crea e inicializa un objeto de carpeta.</span><span class="sxs-lookup"><span data-stu-id="1adc9-330">Typically, a folder object is created and initialized by its parent folder's [**IShellFolder::BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) method.</span></span> <span data-ttu-id="1adc9-331">Sin embargo, cuando un usuario examina la extensión, el explorador de Windows crea e inicializa el objeto de carpeta raíz de la extensión.</span><span class="sxs-lookup"><span data-stu-id="1adc9-331">However, when a user browses into your extension, Windows Explorer creates and initializes the extension's root folder object.</span></span> <span data-ttu-id="1adc9-332">El PIDL que el objeto de carpeta raíz recibe a través de [**IPersistFolder:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipersistfolder-initialize) contiene la ruta de acceso del escritorio a la carpeta raíz que necesitará para construir PIDL completo para la extensión.</span><span class="sxs-lookup"><span data-stu-id="1adc9-332">The PIDL that the root folder object receives through [**IPersistFolder::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipersistfolder-initialize) contains the path from the desktop to the root folder that you will need to construct fully qualified PIDLs for your extension.</span></span>

### <a name="ishellfolder-interface"></a><span data-ttu-id="1adc9-333">Interfaz IShellFolder</span><span class="sxs-lookup"><span data-stu-id="1adc9-333">IShellFolder Interface</span></span>

<span data-ttu-id="1adc9-334">El shell trata una extensión como una colección ordenada jerárquicamente de objetos de carpeta.</span><span class="sxs-lookup"><span data-stu-id="1adc9-334">The Shell treats an extension as a hierarchically ordered collection of folder objects.</span></span> <span data-ttu-id="1adc9-335">La interfaz [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) es el núcleo de cualquier implementación de extensión.</span><span class="sxs-lookup"><span data-stu-id="1adc9-335">The [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface is the core of any extension implementation.</span></span> <span data-ttu-id="1adc9-336">Representa un objeto de carpeta y proporciona al explorador de Windows una gran parte de la información necesaria para mostrar el contenido de la carpeta.</span><span class="sxs-lookup"><span data-stu-id="1adc9-336">It represents a folder object and provides Windows Explorer with much of the information needed to display the contents of the folder.</span></span>

<span data-ttu-id="1adc9-337">[**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) suele ser la única interfaz de carpeta distinta de [**IPersistFolder**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder) que expone directamente un objeto de carpeta.</span><span class="sxs-lookup"><span data-stu-id="1adc9-337">[**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) is typically the only folder interface other than [**IPersistFolder**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder) that is directly exposed by a folder object.</span></span> <span data-ttu-id="1adc9-338">Aunque el explorador de Windows usa una variedad de interfaces obligatorias y opcionales para obtener información sobre el contenido de la carpeta, obtiene punteros a esas interfaces a través de **IShellFolder**.</span><span class="sxs-lookup"><span data-stu-id="1adc9-338">While Windows Explorer uses a variety of required and optional interfaces to obtain information about the contents of the folder, it obtains pointers to those interfaces through **IShellFolder**.</span></span>

<span data-ttu-id="1adc9-339">El explorador de Windows obtiene el CLSID de la carpeta raíz de la extensión de varias maneras.</span><span class="sxs-lookup"><span data-stu-id="1adc9-339">Windows Explorer obtains the CLSID of your extension's root folder in a variety of ways.</span></span> <span data-ttu-id="1adc9-340">Para obtener más información, vea [especificar la ubicación de una extensión de espacio de nombres](nse-junction.md) o [Mostrar una vista de Self-Contained de una extensión de espacio de nombres](nse-view.md).</span><span class="sxs-lookup"><span data-stu-id="1adc9-340">For details, see [Specifying a Namespace Extension's Location](nse-junction.md) or [Displaying a Self-Contained View of a Namespace Extension](nse-view.md).</span></span> <span data-ttu-id="1adc9-341">Después, el explorador de Windows utiliza ese CLSID para crear e inicializar una instancia de la carpeta raíz y consultar una interfaz [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="1adc9-341">Windows Explorer then uses that CLSID to create and initialize an instance of the root folder and query for an [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="1adc9-342">La extensión crea un objeto de carpeta para representar la carpeta raíz y devuelve la interfaz **IShellFolder** del objeto.</span><span class="sxs-lookup"><span data-stu-id="1adc9-342">Your extension creates a folder object to represent the root folder and returns the object's **IShellFolder** interface.</span></span> <span data-ttu-id="1adc9-343">Gran parte del resto de la interacción entre la extensión y el explorador de Windows tiene lugar a través de **IShellFolder**.</span><span class="sxs-lookup"><span data-stu-id="1adc9-343">Much of the remainder of the interaction between your extension and Windows Explorer then takes place through **IShellFolder**.</span></span> <span data-ttu-id="1adc9-344">El explorador de Windows llama a **IShellFolder** para:</span><span class="sxs-lookup"><span data-stu-id="1adc9-344">Windows Explorer calls **IShellFolder** to:</span></span>

-   <span data-ttu-id="1adc9-345">Solicita un objeto que puede enumerar el contenido de la carpeta raíz.</span><span class="sxs-lookup"><span data-stu-id="1adc9-345">Request an object that can enumerate the contents of the root folder.</span></span>
-   <span data-ttu-id="1adc9-346">Obtener varios tipos de información sobre el contenido de la carpeta raíz.</span><span class="sxs-lookup"><span data-stu-id="1adc9-346">Obtain various types of information about the contents of the root folder.</span></span>
-   <span data-ttu-id="1adc9-347">Solicite un objeto que exponga una de las interfaces opcionales.</span><span class="sxs-lookup"><span data-stu-id="1adc9-347">Request an object that exposes one of the optional interfaces.</span></span> <span data-ttu-id="1adc9-348">A continuación, se puede consultar a esas interfaces información adicional, como iconos o menús contextuales.</span><span class="sxs-lookup"><span data-stu-id="1adc9-348">Those interfaces can then be queried for additional information, such as icons or shortcut menus.</span></span>
-   <span data-ttu-id="1adc9-349">Solicite un objeto de carpeta que represente una subcarpeta de la carpeta raíz.</span><span class="sxs-lookup"><span data-stu-id="1adc9-349">Request a folder object that represents a subfolder of the root folder.</span></span>

<span data-ttu-id="1adc9-350">Cuando un usuario abre una subcarpeta de la carpeta raíz, el explorador de Windows llama a [**IShellFolder:: BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject).</span><span class="sxs-lookup"><span data-stu-id="1adc9-350">When a user opens a subfolder of the root folder, Windows Explorer calls [**IShellFolder::BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject).</span></span> <span data-ttu-id="1adc9-351">La extensión crea e inicializa un nuevo objeto Folder para representar la subcarpeta y devuelve su interfaz [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="1adc9-351">Your extension creates and initializes a new folder object to represent the subfolder and returns its [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="1adc9-352">Después, el explorador de Windows llama a esta interfaz para varios tipos de información, y así sucesivamente hasta que el usuario decide navegar en otro lugar del espacio de nombres del shell o cerrar el explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="1adc9-352">Windows Explorer then calls this interface for various types of information, and so on until the user decides to navigate elsewhere in the Shell namespace or close Windows Explorer.</span></span>

<span data-ttu-id="1adc9-353">En el resto de esta sección se describen brevemente los métodos de [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) más importantes y cómo implementarlos.</span><span class="sxs-lookup"><span data-stu-id="1adc9-353">The remainder of this section briefly discusses the more important [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) methods and how to implement them.</span></span>

### <a name="enumobjects"></a><span data-ttu-id="1adc9-354">EnumObjects</span><span class="sxs-lookup"><span data-stu-id="1adc9-354">EnumObjects</span></span>

<span data-ttu-id="1adc9-355">Antes de mostrar el contenido de una carpeta en la vista de árbol, el explorador de Windows debe determinar primero lo que contiene la carpeta mediante una llamada al método [**IShellFolder:: EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) .</span><span class="sxs-lookup"><span data-stu-id="1adc9-355">Before displaying the contents of a folder in the tree view, Windows Explorer must first determine what the folder contains by calling the [**IShellFolder::EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) method.</span></span> <span data-ttu-id="1adc9-356">Este método crea un objeto de enumeración OLE estándar que expone una interfaz [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) y devuelve el puntero de interfaz.</span><span class="sxs-lookup"><span data-stu-id="1adc9-356">This method creates a standard OLE enumeration object that exposes an [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) interface and returns that interface pointer.</span></span> <span data-ttu-id="1adc9-357">La interfaz **IEnumIDList** permite al explorador de Windows obtener el PIDL de todos los objetos contenidos en la carpeta.</span><span class="sxs-lookup"><span data-stu-id="1adc9-357">The **IEnumIDList** interface allows Windows Explorer to obtain the PIDLs of all the objects contained by the folder.</span></span> <span data-ttu-id="1adc9-358">Estos PIDL se usan para obtener información sobre los objetos contenidos en la carpeta.</span><span class="sxs-lookup"><span data-stu-id="1adc9-358">These PIDLs are then used to obtain information about the objects contained by the folder.</span></span> <span data-ttu-id="1adc9-359">Para obtener más información, vea [IEnumIDList (interfaz](#ienumidlist-interface)).</span><span class="sxs-lookup"><span data-stu-id="1adc9-359">For further details, see [IEnumIDList Interface](#ienumidlist-interface).</span></span>

> [!Note]  
> <span data-ttu-id="1adc9-360">El método [**IEnumIDList:: Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next) solo debe devolver PIDL que sean relativos a la carpeta principal.</span><span class="sxs-lookup"><span data-stu-id="1adc9-360">The [**IEnumIDList::Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next) method should only return PIDLs that are relative to the parent folder.</span></span> <span data-ttu-id="1adc9-361">PIDL debe contener solo la estructura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) del objeto, seguida de un terminador.</span><span class="sxs-lookup"><span data-stu-id="1adc9-361">The PIDL should contain only the object's [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure, followed by a terminator.</span></span>

 

### <a name="createviewobject"></a><span data-ttu-id="1adc9-362">CreateViewObject</span><span class="sxs-lookup"><span data-stu-id="1adc9-362">CreateViewObject</span></span>

<span data-ttu-id="1adc9-363">Antes de que se muestre el contenido de una carpeta, el explorador de Windows llama a este método para solicitar un puntero a una interfaz [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) .</span><span class="sxs-lookup"><span data-stu-id="1adc9-363">Before the contents of a folder are displayed, Windows Explorer calls this method to request a pointer to an [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) interface.</span></span> <span data-ttu-id="1adc9-364">Esta interfaz la usa el explorador de Windows para administrar la vista de carpetas.</span><span class="sxs-lookup"><span data-stu-id="1adc9-364">This interface is used by Windows Explorer to manage the folder view.</span></span> <span data-ttu-id="1adc9-365">Cree un objeto de vista de carpeta y devuelva su interfaz **IShellView** .</span><span class="sxs-lookup"><span data-stu-id="1adc9-365">Create a folder view object and return its **IShellView** interface.</span></span>

<span data-ttu-id="1adc9-366">También se llama al método [**IShellFolder:: CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) para solicitar una de las interfaces opcionales, como [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu), para la propia carpeta.</span><span class="sxs-lookup"><span data-stu-id="1adc9-366">The [**IShellFolder::CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) method is also called to request one of the optional interfaces, such as [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu), for the folder itself.</span></span> <span data-ttu-id="1adc9-367">La implementación de este método debe crear un objeto que exponga la interfaz solicitada y devuelva el puntero de interfaz.</span><span class="sxs-lookup"><span data-stu-id="1adc9-367">Your implementation of this method should create an object that exposes the requested interface and returns the interface pointer.</span></span> <span data-ttu-id="1adc9-368">Si el explorador de Windows necesita una interfaz opcional para uno de los objetos contenidos en la carpeta, llamará a [**IShellFolder:: GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof).</span><span class="sxs-lookup"><span data-stu-id="1adc9-368">If Windows Explorer needs an optional interface for one of the objects contained by the folder, it will call [**IShellFolder::GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof).</span></span>

### <a name="getuiobjectof"></a><span data-ttu-id="1adc9-369">GetUIObjectOf</span><span class="sxs-lookup"><span data-stu-id="1adc9-369">GetUIObjectOf</span></span>

<span data-ttu-id="1adc9-370">Aunque la información básica sobre el contenido de una carpeta está disponible a través de los métodos [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) , la extensión también puede proporcionar el explorador de Windows con varios tipos de información adicional.</span><span class="sxs-lookup"><span data-stu-id="1adc9-370">While basic information about the contents of a folder is available through the [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) methods, your extension can also provide Windows Explorer with various kinds of additional information.</span></span> <span data-ttu-id="1adc9-371">Por ejemplo, puede especificar iconos para el contenido de una carpeta o el menú contextual de un objeto.</span><span class="sxs-lookup"><span data-stu-id="1adc9-371">For instance, you can specify icons for the contents of a folder or an object's shortcut menu.</span></span> <span data-ttu-id="1adc9-372">El explorador de Windows llama al método [**IShellFolder:: GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof) para intentar recuperar información adicional sobre un objeto contenido en una carpeta.</span><span class="sxs-lookup"><span data-stu-id="1adc9-372">Windows Explorer calls the [**IShellFolder::GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof) method to attempt to retrieve additional information about an object that is contained by a folder.</span></span> <span data-ttu-id="1adc9-373">El explorador de Windows especifica en qué objeto desea obtener información y el IID de la interfaz correspondiente.</span><span class="sxs-lookup"><span data-stu-id="1adc9-373">Windows Explorer specifies which object it wants the information for, and the IID of the relevant interface.</span></span> <span data-ttu-id="1adc9-374">A continuación, el objeto de carpeta crea un objeto que expone la interfaz solicitada y devuelve el puntero de interfaz.</span><span class="sxs-lookup"><span data-stu-id="1adc9-374">The folder object then creates an object that exposes the requested interface and returns the interface pointer.</span></span>

<span data-ttu-id="1adc9-375">Si la extensión permite a los usuarios transferir objetos con arrastrar y colocar o el portapapeles, el explorador de Windows llamará a [**IShellFolder:: GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof) para solicitar una interfaz [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) o [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) .</span><span class="sxs-lookup"><span data-stu-id="1adc9-375">If your extension allows users to transfer objects with drag-and-drop or the clipboard, Windows Explorer will call [**IShellFolder::GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof) to request an [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) or [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface.</span></span> <span data-ttu-id="1adc9-376">Para obtener más información, vea [transferir objetos de Shell con arrastrar y colocar y el portapapeles](dragdrop.md).</span><span class="sxs-lookup"><span data-stu-id="1adc9-376">For details, see [Transferring Shell Objects with Drag-and-Drop and the Clipboard](dragdrop.md).</span></span>

<span data-ttu-id="1adc9-377">El explorador de Windows llama a [**IShellFolder:: CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) cuando desea tener el mismo tipo de información sobre la propia carpeta.</span><span class="sxs-lookup"><span data-stu-id="1adc9-377">Windows Explorer calls [**IShellFolder::CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) when it wants the same sort of information about the folder itself.</span></span>

### <a name="bindtoobject"></a><span data-ttu-id="1adc9-378">BindToObject</span><span class="sxs-lookup"><span data-stu-id="1adc9-378">BindToObject</span></span>

<span data-ttu-id="1adc9-379">El explorador de Windows llama al método [**IShellFolder:: BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) cuando un usuario intenta abrir una de las subcarpetas de la extensión.</span><span class="sxs-lookup"><span data-stu-id="1adc9-379">Windows Explorer calls the [**IShellFolder::BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) method when a user attempts to open one of your extension's subfolders.</span></span> <span data-ttu-id="1adc9-380">Si *riid* se establece en IID \_ IShellFolder, debe crear e inicializar un objeto de carpeta que represente la subcarpeta y devolver la interfaz [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) del objeto.</span><span class="sxs-lookup"><span data-stu-id="1adc9-380">If *riid* is set to IID\_IShellFolder, you should create and initialize a folder object that represents the subfolder and return the object's [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span>

> [!Note]  
> <span data-ttu-id="1adc9-381">En la actualidad, el explorador de Windows llama a este método solo para solicitar una interfaz [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="1adc9-381">At present, Windows Explorer calls this method only to request an [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="1adc9-382">Sin embargo, no suponga que siempre será el caso.</span><span class="sxs-lookup"><span data-stu-id="1adc9-382">However, do not assume that this will always be the case.</span></span> <span data-ttu-id="1adc9-383">Siempre debe comprobar el valor de *riid* antes de continuar.</span><span class="sxs-lookup"><span data-stu-id="1adc9-383">You should always check the value of *riid* before proceeding.</span></span>

 

### <a name="getdisplaynameof"></a><span data-ttu-id="1adc9-384">GetDisplayNameOf</span><span class="sxs-lookup"><span data-stu-id="1adc9-384">GetDisplayNameOf</span></span>

<span data-ttu-id="1adc9-385">El explorador de Windows llama al método [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) para convertir el PIDL de uno de los objetos de la carpeta en un nombre.</span><span class="sxs-lookup"><span data-stu-id="1adc9-385">Windows Explorer calls the [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) method to convert the PIDL of one of the folder's objects into a name.</span></span> <span data-ttu-id="1adc9-386">Esa PIDL debe ser relativa a la carpeta principal del objeto.</span><span class="sxs-lookup"><span data-stu-id="1adc9-386">That PIDL must be relative to the object's parent folder.</span></span> <span data-ttu-id="1adc9-387">En otras palabras, debe contener una única estructura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) que no sea **null** .</span><span class="sxs-lookup"><span data-stu-id="1adc9-387">In other words, it must contain a single non-**NULL** [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure.</span></span> <span data-ttu-id="1adc9-388">Dado que hay más de una posible manera de asignar nombres a los objetos, el explorador de Windows especifica el tipo de nombre estableciendo una o más marcas [**SHGDNF**](/windows/win32/api/shobjidl_core/ne-shobjidl_core-_shgdnf) en el parámetro *uFlags* .</span><span class="sxs-lookup"><span data-stu-id="1adc9-388">Because there is more than one possible way to name objects, Windows Explorer specifies the type of name by setting one or more [**SHGDNF**](/windows/win32/api/shobjidl_core/ne-shobjidl_core-_shgdnf) flags in the *uFlags* parameter.</span></span> <span data-ttu-id="1adc9-389">Se establecerá uno de los dos valores **SHGDN \_ normal** o **SHGDN \_ InFolder**, para especificar si el nombre debe ser relativo a la carpeta o relativa al escritorio.</span><span class="sxs-lookup"><span data-stu-id="1adc9-389">One of two values, **SHGDN\_NORMAL** or **SHGDN\_INFOLDER**, will be set to specify whether the name should be relative to the folder or relative to the desktop.</span></span> <span data-ttu-id="1adc9-390">Uno de los otros tres valores, **SHGDN \_ FOREDITING**, **SHGDN \_ FORADDRESSBAR** o **SHGDN \_ FORPARSING**, se puede establecer para especificar para qué nombre se usará.</span><span class="sxs-lookup"><span data-stu-id="1adc9-390">One of the other three values, **SHGDN\_FOREDITING**, **SHGDN\_FORADDRESSBAR**, or **SHGDN\_FORPARSING**, can be set to specify what the name will be used for.</span></span>

<span data-ttu-id="1adc9-391">Debe devolver el nombre con el formato de una estructura [**Strret**](/windows/desktop/api/Shtypes/ns-shtypes-strret) .</span><span class="sxs-lookup"><span data-stu-id="1adc9-391">You must return the name in the form of an [**STRRET**](/windows/desktop/api/Shtypes/ns-shtypes-strret) structure.</span></span> <span data-ttu-id="1adc9-392">Si no se establecen **SHGDN \_ FOREDITING**, **SHGDN \_ FORADDRESSBAR** y **SHGDN \_ FORPARSING** , se devuelve el nombre para mostrar del objeto.</span><span class="sxs-lookup"><span data-stu-id="1adc9-392">If **SHGDN\_FOREDITING**, **SHGDN\_FORADDRESSBAR**, and **SHGDN\_FORPARSING** are not set, return the object's display name.</span></span> <span data-ttu-id="1adc9-393">Si se establece la marca **SHGDN \_ FORPARSING** , el explorador de Windows solicita un nombre de análisis.</span><span class="sxs-lookup"><span data-stu-id="1adc9-393">If the **SHGDN\_FORPARSING** flag is set, Windows Explorer is requesting a parsing name.</span></span> <span data-ttu-id="1adc9-394">Los nombres de análisis se pasan a [**IShellFolder::P arsedisplayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) para obtener PIDL de un objeto, aunque podría encontrarse uno o varios niveles por debajo de la carpeta actual en la jerarquía de espacios de nombres.</span><span class="sxs-lookup"><span data-stu-id="1adc9-394">Parsing names are passed to [**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) to obtain an object's PIDL, even though it might be located one or more levels below the current folder in the namespace hierarchy.</span></span> <span data-ttu-id="1adc9-395">Por ejemplo, el nombre de análisis de un objeto del sistema de archivos es su ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="1adc9-395">For example, the parsing name of a file system object is its path.</span></span> <span data-ttu-id="1adc9-396">Puede pasar la ruta de acceso completa de cualquier objeto del sistema de archivos al método **IShellFolder::P arsedisplayname** del escritorio, y devolverá el PIDL completo del objeto.</span><span class="sxs-lookup"><span data-stu-id="1adc9-396">You can pass the fully qualified path of any object in the file system to the desktop's **IShellFolder::ParseDisplayName** method, and it will return the object's fully qualified PIDL.</span></span>

<span data-ttu-id="1adc9-397">Aunque los nombres de análisis son cadenas de texto, no tienen por qué incluir el nombre para mostrar.</span><span class="sxs-lookup"><span data-stu-id="1adc9-397">While parsing names are text strings, they do not necessarily have to include the display name.</span></span> <span data-ttu-id="1adc9-398">Debe asignar nombres de análisis basados en lo que funcionará de manera más eficaz cuando se llama a [**IShellFolder::P arsedisplayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) .</span><span class="sxs-lookup"><span data-stu-id="1adc9-398">You should assign parsing names based on what will work most efficiently when [**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) is called.</span></span> <span data-ttu-id="1adc9-399">Por ejemplo, muchas de las carpetas virtuales del shell no forman parte del sistema de archivos y no tienen una ruta de acceso completa.</span><span class="sxs-lookup"><span data-stu-id="1adc9-399">For instance, many of the Shell's virtual folders are not part of the file system and do not have a fully qualified path.</span></span> <span data-ttu-id="1adc9-400">En su lugar, a cada carpeta se le asigna un GUID y el nombre de análisis adopta la forma:: {GUID}.</span><span class="sxs-lookup"><span data-stu-id="1adc9-400">Instead, each folder is assigned a GUID and the parsing name takes the form ::{GUID}.</span></span> <span data-ttu-id="1adc9-401">Independientemente del esquema que use, debe ser capaz de "realizar un recorrido de ida y vuelta" de forma confiable.</span><span class="sxs-lookup"><span data-stu-id="1adc9-401">Regardless of what scheme you use, it should be able to reliably "round trip."</span></span> <span data-ttu-id="1adc9-402">Por ejemplo, si un llamador pasa un nombre de análisis a **IShellFolder::P arsedisplayname** para recuperar PIDL de un objeto y, a continuación, pasa ese PIDL a [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) con el indicador **SHGDN \_ FORPARSING** establecido, el llamador debe recuperar el nombre de análisis original.</span><span class="sxs-lookup"><span data-stu-id="1adc9-402">For instance, if a caller passes a parsing name to **IShellFolder::ParseDisplayName** to retrieve an object's PIDL, and then passes that PIDL to [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) with the **SHGDN\_FORPARSING** flag set, the caller should recover the original parsing name.</span></span>

### <a name="getattributesof"></a><span data-ttu-id="1adc9-403">GetAttributesOf</span><span class="sxs-lookup"><span data-stu-id="1adc9-403">GetAttributesOf</span></span>

<span data-ttu-id="1adc9-404">El explorador de Windows llama al método [**IShellFolder:: GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) para determinar los atributos de uno o más elementos contenidos en un objeto de carpeta.</span><span class="sxs-lookup"><span data-stu-id="1adc9-404">Windows Explorer calls the [**IShellFolder::GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) method to determine the attributes of one or more items contained by a folder object.</span></span> <span data-ttu-id="1adc9-405">El valor de *cidl* proporciona el número de elementos de la consulta y *aPidl* apunta a una lista de su PIDL.</span><span class="sxs-lookup"><span data-stu-id="1adc9-405">The value of *cidl* gives the number of items in the query, and *aPidl* points to a list of their PIDLs.</span></span>

<span data-ttu-id="1adc9-406">Dado que las pruebas para algunos atributos pueden llevar mucho tiempo, el explorador de Windows normalmente restringe la consulta a un subconjunto de las marcas disponibles mediante el establecimiento de sus valores en *rfgInOut*.</span><span class="sxs-lookup"><span data-stu-id="1adc9-406">Because testing for some attributes can be time consuming, Windows Explorer typically restricts the query to a subset of the available flags by setting their values in *rfgInOut*.</span></span> <span data-ttu-id="1adc9-407">El método debe probar solo los atributos cuyas marcas se establecen en *rfgInOut*.</span><span class="sxs-lookup"><span data-stu-id="1adc9-407">Your method should test for only those attributes whose flags are set in *rfgInOut*.</span></span> <span data-ttu-id="1adc9-408">Deje las marcas válidas establecidas y borre el resto.</span><span class="sxs-lookup"><span data-stu-id="1adc9-408">Leave the valid flags set and clear the remainder.</span></span> <span data-ttu-id="1adc9-409">Si se incluye más de un elemento en la consulta, establezca solo las marcas que se aplican a todos los elementos.</span><span class="sxs-lookup"><span data-stu-id="1adc9-409">If more than one item is included in the query, set only those flags that apply to all items.</span></span>

> [!Note]  
> <span data-ttu-id="1adc9-410">Los atributos deben establecerse correctamente para que un elemento se muestre correctamente.</span><span class="sxs-lookup"><span data-stu-id="1adc9-410">The attributes must be properly set for an item to be correctly displayed.</span></span> <span data-ttu-id="1adc9-411">Por ejemplo, si un elemento es una carpeta que contiene subcarpetas, debe establecer la marca **\_ HASSUBFOLDER de SFGAO** .</span><span class="sxs-lookup"><span data-stu-id="1adc9-411">For instance, if an item is a folder that contains subfolders, you must set the **SFGAO\_HASSUBFOLDER** flag.</span></span> <span data-ttu-id="1adc9-412">De lo contrario, el explorador de Windows no mostrará un botón + junto al icono del elemento en la vista de árbol.</span><span class="sxs-lookup"><span data-stu-id="1adc9-412">Otherwise, Windows Explorer will not display a + next to the item's icon in the tree view.</span></span>

 

### <a name="parsedisplayname"></a><span data-ttu-id="1adc9-413">ParseDisplayName</span><span class="sxs-lookup"><span data-stu-id="1adc9-413">ParseDisplayName</span></span>

<span data-ttu-id="1adc9-414">El método [**IShellFolder::P arsedisplayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) tiene en cierto sentido una imagen reflejada de [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof).</span><span class="sxs-lookup"><span data-stu-id="1adc9-414">The [**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) method is in some sense a mirror image of [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof).</span></span> <span data-ttu-id="1adc9-415">El uso más común de este método consiste en convertir el nombre de análisis de un objeto en el PIDL asociado.</span><span class="sxs-lookup"><span data-stu-id="1adc9-415">The most common use of this method is to convert an object's parsing name into the associated PIDL.</span></span> <span data-ttu-id="1adc9-416">El nombre de análisis puede hacer referencia a cualquier objeto que se encuentra debajo de la carpeta en la jerarquía de espacios de nombres.</span><span class="sxs-lookup"><span data-stu-id="1adc9-416">The parsing name can refer to any object that lies below the folder in the namespace hierarchy.</span></span> <span data-ttu-id="1adc9-417">La PIDL devuelta es relativa al objeto de carpeta que expone el método y normalmente no es completo.</span><span class="sxs-lookup"><span data-stu-id="1adc9-417">The returned PIDL is relative to the folder object that exposes the method and is usually not fully qualified.</span></span> <span data-ttu-id="1adc9-418">En otras palabras, aunque PIDL puede contener varias estructuras [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) , la primera será la del propio objeto o la primera subcarpeta de la ruta de acceso de la carpeta al objeto.</span><span class="sxs-lookup"><span data-stu-id="1adc9-418">In other words, although the PIDL can contain several [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures, the first will either be that of the object itself or the first subfolder in the path from the folder to the object.</span></span> <span data-ttu-id="1adc9-419">El autor de la llamada tendrá que anexar este PIDL al PIDL completo de la carpeta para obtener un PIDL completo para el objeto.</span><span class="sxs-lookup"><span data-stu-id="1adc9-419">The caller will have to append this PIDL to the folder's fully qualified PIDL to obtain a fully qualified PIDL for the object.</span></span>

<span data-ttu-id="1adc9-420">[**IShellFolder:**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) también se puede llamar a:P arsedisplayname para solicitar los atributos de un objeto.</span><span class="sxs-lookup"><span data-stu-id="1adc9-420">[**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) can also be called to request an object's attributes.</span></span> <span data-ttu-id="1adc9-421">Dado que la determinación de todos los atributos aplicables puede llevar mucho tiempo, el autor de la llamada solo establecerá las marcas [**SFGAO \_ XXX**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) que representen información que el llamador le interese.</span><span class="sxs-lookup"><span data-stu-id="1adc9-421">Because determining all the applicable attributes can be time consuming, the caller will set only those [**SFGAO\_XXX**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) flags that represent information that the caller is interested in.</span></span> <span data-ttu-id="1adc9-422">Debe determinar cuáles de esos atributos son true para el objeto y borrar el resto de marcas.</span><span class="sxs-lookup"><span data-stu-id="1adc9-422">You should determine which of those attributes are true for the object, and clear the remaining flags.</span></span>

### <a name="ienumidlist-interface"></a><span data-ttu-id="1adc9-423">Interfaz IEnumIDList</span><span class="sxs-lookup"><span data-stu-id="1adc9-423">IEnumIDList Interface</span></span>

<span data-ttu-id="1adc9-424">Cuando el explorador de Windows necesita enumerar los objetos contenidos en una carpeta, llama a [**IShellFolder:: EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects).</span><span class="sxs-lookup"><span data-stu-id="1adc9-424">When Windows Explorer needs to enumerate the objects that are contained by a folder, it calls [**IShellFolder::EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects).</span></span> <span data-ttu-id="1adc9-425">El objeto de carpeta debe crear un objeto de enumeración que exponga la interfaz [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) y devuelva ese puntero de interfaz.</span><span class="sxs-lookup"><span data-stu-id="1adc9-425">The folder object must create an enumeration object that exposes the [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) interface and return that interface pointer.</span></span> <span data-ttu-id="1adc9-426">El explorador de Windows normalmente usará **IEnumIDList** para enumerar el PIDL de todos los objetos contenidos en la carpeta.</span><span class="sxs-lookup"><span data-stu-id="1adc9-426">Windows Explorer will then typically use **IEnumIDList** to enumerate the PIDLs of all the objects contained by the folder.</span></span>

<span data-ttu-id="1adc9-427">[**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) es una interfaz de enumeración OLE estándar y se implementa de la manera habitual.</span><span class="sxs-lookup"><span data-stu-id="1adc9-427">[**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) is a standard OLE enumeration interface and is implemented in the usual way.</span></span> <span data-ttu-id="1adc9-428">No obstante, recuerde que el valor de PIDL que se devuelve debe ser relativo a la carpeta y contener solo la estructura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) del objeto y un terminador.</span><span class="sxs-lookup"><span data-stu-id="1adc9-428">Remember, however, that the PIDLs that you return must be relative to the folder and contain only the object's [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure and a terminator.</span></span>

## <a name="implementing-the-optional-interfaces"></a><span data-ttu-id="1adc9-429">Implementar las interfaces opcionales</span><span class="sxs-lookup"><span data-stu-id="1adc9-429">Implementing the Optional Interfaces</span></span>

<span data-ttu-id="1adc9-430">Hay una serie de interfaces de Shell opcionales que los objetos de carpeta de la extensión pueden admitir.</span><span class="sxs-lookup"><span data-stu-id="1adc9-430">There are a number of optional Shell interfaces that your extension's folder objects can support.</span></span> <span data-ttu-id="1adc9-431">Muchos de ellos, como [**IExtractIcon**](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona), le permiten personalizar distintos aspectos del modo en que el usuario ve la extensión.</span><span class="sxs-lookup"><span data-stu-id="1adc9-431">Many of them, such as [**IExtractIcon**](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona), allow you to customize various aspects of the way the user views your extension.</span></span> <span data-ttu-id="1adc9-432">Otros, como [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject), permiten que la extensión admita características como arrastrar y colocar.</span><span class="sxs-lookup"><span data-stu-id="1adc9-432">Others, such as [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject), allow your extension to support features such as drag-and-drop.</span></span>

<span data-ttu-id="1adc9-433">Ninguna de las interfaces opcionales se expone directamente mediante un objeto de carpeta.</span><span class="sxs-lookup"><span data-stu-id="1adc9-433">None of the optional interfaces are exposed directly by a folder object.</span></span> <span data-ttu-id="1adc9-434">En su lugar, el explorador de Windows llama a uno de los dos métodos [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) para solicitar una interfaz:</span><span class="sxs-lookup"><span data-stu-id="1adc9-434">Instead, Windows Explorer calls one of two [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) methods to request an interface:</span></span>

-   <span data-ttu-id="1adc9-435">El explorador de Windows llama a [**IShellFolder:: GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof) de un objeto de carpeta para solicitar una interfaz para uno de los objetos contenidos en la carpeta.</span><span class="sxs-lookup"><span data-stu-id="1adc9-435">Windows Explorer calls a folder object's [**IShellFolder::GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof) to request an interface for one of the objects contained by the folder.</span></span>
-   <span data-ttu-id="1adc9-436">El explorador de Windows llama a [**IShellFolder:: CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) de un objeto de carpeta para solicitar una interfaz para la propia carpeta.</span><span class="sxs-lookup"><span data-stu-id="1adc9-436">Windows Explorer calls a folder object's [**IShellFolder::CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) to request an interface for the folder itself.</span></span>

<span data-ttu-id="1adc9-437">Para proporcionar la información, el objeto de carpeta crea un objeto que expone la interfaz solicitada y devuelve el puntero de interfaz.</span><span class="sxs-lookup"><span data-stu-id="1adc9-437">To provide the information, the folder object creates an object that exposes the requested interface and returns the interface pointer.</span></span> <span data-ttu-id="1adc9-438">Después, el explorador de Windows llama a esa interfaz para recuperar la información necesaria.</span><span class="sxs-lookup"><span data-stu-id="1adc9-438">Windows Explorer then calls that interface to retrieve the needed information.</span></span> <span data-ttu-id="1adc9-439">En esta sección se describen las interfaces opcionales que se usan con más frecuencia.</span><span class="sxs-lookup"><span data-stu-id="1adc9-439">This section discusses the most commonly used optional interfaces.</span></span>

### <a name="iextracticon"></a><span data-ttu-id="1adc9-440">IExtractIcon</span><span class="sxs-lookup"><span data-stu-id="1adc9-440">IExtractIcon</span></span>

<span data-ttu-id="1adc9-441">El explorador de Windows solicita una interfaz [**IExtractIcon**](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona) antes de mostrar el contenido de una carpeta.</span><span class="sxs-lookup"><span data-stu-id="1adc9-441">Windows Explorer requests an [**IExtractIcon**](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona) interface before it displays the contents of a folder.</span></span> <span data-ttu-id="1adc9-442">La interfaz permite que la extensión especifique iconos personalizados para los objetos que contiene la carpeta.</span><span class="sxs-lookup"><span data-stu-id="1adc9-442">The interface allows your extension to specify custom icons for the objects that are contained by the folder.</span></span> <span data-ttu-id="1adc9-443">De lo contrario, se usarán los iconos de archivo y carpeta estándar.</span><span class="sxs-lookup"><span data-stu-id="1adc9-443">Otherwise, the standard file and folder icons will be used.</span></span> <span data-ttu-id="1adc9-444">Para proporcionar un icono personalizado, cree un objeto de extracción de icono que exponga **IExtractIcon** y devuelva un puntero a esa interfaz.</span><span class="sxs-lookup"><span data-stu-id="1adc9-444">To provide a custom icon, create an icon extraction object that exposes **IExtractIcon** and return a pointer to that interface.</span></span> <span data-ttu-id="1adc9-445">Para obtener más información, consulte la documentación de referencia de **IExtractIcon** o [creación de controladores de iconos](./how-to-create-icon-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="1adc9-445">For further discussion, see the **IExtractIcon** reference documentation or [Creating Icon Handlers](./how-to-create-icon-handlers.md).</span></span>

### <a name="icontextmenu"></a><span data-ttu-id="1adc9-446">IContextMenu</span><span class="sxs-lookup"><span data-stu-id="1adc9-446">IContextMenu</span></span>

<span data-ttu-id="1adc9-447">Cuando un usuario hace clic con el botón secundario en un objeto, el explorador de Windows solicita una interfaz [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu) .</span><span class="sxs-lookup"><span data-stu-id="1adc9-447">When a user right-clicks an object, Windows Explorer requests an [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu) interface.</span></span> <span data-ttu-id="1adc9-448">Para proporcionar menús contextuales para los objetos, cree un objeto de controlador de menú y devuelva su interfaz **IContextMenu** .</span><span class="sxs-lookup"><span data-stu-id="1adc9-448">To provide shortcut menus for your objects, create a menu handler object and return its **IContextMenu** interface.</span></span>

<span data-ttu-id="1adc9-449">Los procedimientos para crear un objeto de controlador de menú son muy similares a los que se usan para crear una extensión de Shell de controlador de menú.</span><span class="sxs-lookup"><span data-stu-id="1adc9-449">The procedures for creating a menu handler object are very similar to those used to create a menu handler Shell extension.</span></span> <span data-ttu-id="1adc9-450">Para obtener más información, vea [crear controladores de menús contextuales](context-menu-handlers.md) o la referencia [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu), [**IContextMenu2**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu2)o [**IContextMenu3**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu3) .</span><span class="sxs-lookup"><span data-stu-id="1adc9-450">For details, see [Creating Context Menu Handlers](context-menu-handlers.md) or the [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu), [**IContextMenu2**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu2), or [**IContextMenu3**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu3) reference.</span></span>

### <a name="iqueryinfo"></a><span data-ttu-id="1adc9-451">IQueryInfo</span><span class="sxs-lookup"><span data-stu-id="1adc9-451">IQueryInfo</span></span>

<span data-ttu-id="1adc9-452">El explorador de Windows llama a la interfaz [**IQueryInfo**](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo) para recuperar una cadena de texto informativa.</span><span class="sxs-lookup"><span data-stu-id="1adc9-452">Windows Explorer calls the [**IQueryInfo**](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo) interface to retrieve an infotip text string.</span></span>

### <a name="idataobject-and-idroptarget"></a><span data-ttu-id="1adc9-453">IDataObject e IDropTarget</span><span class="sxs-lookup"><span data-stu-id="1adc9-453">IDataObject and IDropTarget</span></span>

<span data-ttu-id="1adc9-454">Cuando el explorador de Windows muestra los objetos, un objeto de carpeta no tiene ninguna forma directa de saber cuándo un usuario está intentando cortar, copiar o arrastrar un objeto.</span><span class="sxs-lookup"><span data-stu-id="1adc9-454">When your objects are displayed by Windows Explorer, a folder object has no direct way to know when a user is attempting to cut, copy, or drag an object.</span></span> <span data-ttu-id="1adc9-455">En su lugar, el explorador de Windows solicita una interfaz [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) .</span><span class="sxs-lookup"><span data-stu-id="1adc9-455">Instead, Windows Explorer requests an [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span> <span data-ttu-id="1adc9-456">Para permitir la transferencia del objeto, cree un objeto de datos y devuelva un puntero a su interfaz **IDataObject** .</span><span class="sxs-lookup"><span data-stu-id="1adc9-456">To allow the object to be transferred, create a data object and return a pointer to its **IDataObject** interface.</span></span>

<span data-ttu-id="1adc9-457">Del mismo modo, un usuario podría intentar quitar un objeto de datos en una representación del explorador de Windows de uno de los objetos, como un icono o una ruta de acceso de la barra de direcciones.</span><span class="sxs-lookup"><span data-stu-id="1adc9-457">Similarly, a user might attempt to drop a data object on a Windows Explorer representation of one of your objects, such as an icon or address bar path.</span></span> <span data-ttu-id="1adc9-458">Después, el explorador de Windows solicita una interfaz [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) .</span><span class="sxs-lookup"><span data-stu-id="1adc9-458">Windows Explorer then requests an [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface.</span></span> <span data-ttu-id="1adc9-459">Para permitir quitar el objeto de datos, cree un objeto que exponga una interfaz **IDropTarget** y devuelva el puntero de interfaz.</span><span class="sxs-lookup"><span data-stu-id="1adc9-459">To allow the data object to be dropped, create an object that exposes an **IDropTarget** interface and return the interface pointer.</span></span>

<span data-ttu-id="1adc9-460">Controlar la transferencia de datos es uno de los aspectos más complicados de escribir extensiones de espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="1adc9-460">Handling data transfer is one of the trickier aspects of writing namespace extensions.</span></span> <span data-ttu-id="1adc9-461">Para obtener una explicación detallada, vea [transferir objetos de Shell con arrastrar y colocar y el portapapeles](dragdrop.md).</span><span class="sxs-lookup"><span data-stu-id="1adc9-461">For a detailed discussion, see [Transferring Shell Objects with Drag-and-Drop and the Clipboard](dragdrop.md).</span></span>

## <a name="working-with-the-default-shell-folder-view-implementation"></a><span data-ttu-id="1adc9-462">Trabajar con la implementación de vista de carpeta de Shell predeterminada</span><span class="sxs-lookup"><span data-stu-id="1adc9-462">Working With the Default Shell Folder View Implementation</span></span>

<span data-ttu-id="1adc9-463">Los orígenes de datos que usan el objeto de vista de carpeta de shell predeterminado (DefView) deben implementar estas interfaces:</span><span class="sxs-lookup"><span data-stu-id="1adc9-463">Data sources that use the default Shell folder view object (DefView) must implement these interfaces:</span></span>

-   [<span data-ttu-id="1adc9-464">**IShellFolder**</span><span class="sxs-lookup"><span data-stu-id="1adc9-464">**IShellFolder**</span></span>](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder)
-   [<span data-ttu-id="1adc9-465">**IShellFolder2**</span><span class="sxs-lookup"><span data-stu-id="1adc9-465">**IShellFolder2**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellfolder2)
-   [<span data-ttu-id="1adc9-466">**IPersistFolder**</span><span class="sxs-lookup"><span data-stu-id="1adc9-466">**IPersistFolder**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder)
-   [<span data-ttu-id="1adc9-467">**IPersistFolder2**</span><span class="sxs-lookup"><span data-stu-id="1adc9-467">**IPersistFolder2**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder2)

<span data-ttu-id="1adc9-468">Opcionalmente, también pueden implementar [**IPersistFolder3**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder3).</span><span class="sxs-lookup"><span data-stu-id="1adc9-468">Optionally, they can also implement [**IPersistFolder3**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder3).</span></span>

 

 
