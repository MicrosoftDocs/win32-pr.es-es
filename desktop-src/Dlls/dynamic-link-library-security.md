---
description: Cuando una aplicación carga dinámicamente una biblioteca de vínculos dinámicos sin especificar un nombre de ruta de acceso completo, Windows intenta localizar el archivo DLL buscando un conjunto de directorios bien definido en un orden determinado, como se describe en Dynamic-Link el orden de búsqueda de la biblioteca. Si un atacante obtiene el control de uno de los directorios de la ruta de búsqueda de DLL, puede colocar una copia malintencionada del archivo DLL en ese directorio. Esto se denomina a veces un ataque de carga previa de DLL o un ataque de Binary Planting.
ms.assetid: 9493F299-789D-4CBC-9822-96EEAE39B494
title: Seguridad de biblioteca Dynamic-Link
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4016139762461784702ac0190c1ee65d8bc6e72d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "105669703"
---
# <a name="dynamic-link-library-security"></a><span data-ttu-id="a4c2e-105">Seguridad de biblioteca Dynamic-Link</span><span class="sxs-lookup"><span data-stu-id="a4c2e-105">Dynamic-Link Library Security</span></span>

<span data-ttu-id="a4c2e-106">Cuando una aplicación carga dinámicamente una biblioteca de vínculos dinámicos sin especificar un nombre de ruta de acceso completo, Windows intenta localizar el archivo DLL buscando un conjunto de directorios bien definido en un orden determinado, tal como se describe en el orden de búsqueda de la [biblioteca de vínculos dinámicos](dynamic-link-library-search-order.md).</span><span class="sxs-lookup"><span data-stu-id="a4c2e-106">When an application dynamically loads a dynamic-link library without specifying a fully qualified path name, Windows attempts to locate the DLL by searching a well-defined set of directories in a particular order, as described in [Dynamic-Link Library Search Order](dynamic-link-library-search-order.md).</span></span> <span data-ttu-id="a4c2e-107">Si un atacante obtiene el control de uno de los directorios de la ruta de búsqueda de DLL, puede colocar una copia malintencionada del archivo DLL en ese directorio.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-107">If an attacker gains control of one of the directories on the DLL search path, it can place a malicious copy of the DLL in that directory.</span></span> <span data-ttu-id="a4c2e-108">Esto se denomina a veces un *ataque de carga previa de dll* o un ataque de *Binary planting*.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-108">This is sometimes called a *DLL preloading attack* or a *binary planting attack*.</span></span> <span data-ttu-id="a4c2e-109">Si el sistema no encuentra una copia legítima de la DLL antes de buscar en el directorio en peligro, carga la DLL malintencionada.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-109">If the system does not find a legitimate copy of the DLL before it searches the compromised directory, it loads the malicious DLL.</span></span> <span data-ttu-id="a4c2e-110">Si la aplicación se ejecuta con privilegios de administrador, el atacante puede tener éxito en la elevación de privilegios local.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-110">If the application is running with administrator privileges, the attacker may succeed in local privilege elevation.</span></span>

<span data-ttu-id="a4c2e-111">Por ejemplo, supongamos que una aplicación está diseñada para cargar un archivo DLL desde el directorio actual del usuario y se produce un error si no se encuentra el archivo DLL.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-111">For example, suppose an application is designed to load a DLL from the user's current directory and fail gracefully if the DLL is not found.</span></span> <span data-ttu-id="a4c2e-112">La aplicación llama a [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) con solo el nombre del archivo dll, lo que hace que el sistema busque el archivo dll.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-112">The application calls [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) with just the name of the DLL, which causes the system to search for the DLL.</span></span> <span data-ttu-id="a4c2e-113">Suponiendo que el modo de búsqueda de archivos DLL seguro está habilitado y la aplicación no usa un orden de búsqueda alternativo, el sistema busca en los directorios en el siguiente orden:</span><span class="sxs-lookup"><span data-stu-id="a4c2e-113">Assuming safe DLL search mode is enabled and the application is not using an alternate search order, the system searches directories in the following order:</span></span>

1.  <span data-ttu-id="a4c2e-114">Directorio desde el que se cargó la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-114">The directory from which the application loaded.</span></span>
2.  <span data-ttu-id="a4c2e-115">Directorio del sistema.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-115">The system directory.</span></span>
3.  <span data-ttu-id="a4c2e-116">Directorio del sistema de 16 bits.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-116">The 16-bit system directory.</span></span>
4.  <span data-ttu-id="a4c2e-117">El directorio de Windows.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-117">The Windows directory.</span></span>
5.  <span data-ttu-id="a4c2e-118">El directorio actual.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-118">The current directory.</span></span>
6.  <span data-ttu-id="a4c2e-119">Los directorios que aparecen en la variable de entorno PATH.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-119">The directories that are listed in the PATH environment variable.</span></span>

<span data-ttu-id="a4c2e-120">Continuando con el ejemplo, un atacante con conocimiento de la aplicación gana el control del directorio actual y coloca una copia malintencionada del archivo DLL en ese directorio.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-120">Continuing the example, an attacker with knowledge of the application gains control of the current directory and places a malicious copy of the DLL in that directory.</span></span> <span data-ttu-id="a4c2e-121">Cuando la aplicación emite la llamada **LoadLibrary** , el sistema busca el archivo dll, encuentra la copia malintencionada del archivo dll en el directorio actual y lo carga.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-121">When the application issues the **LoadLibrary** call, the system searches for the DLL, finds the malicious copy of the DLL in the current directory, and loads it.</span></span> <span data-ttu-id="a4c2e-122">La copia malintencionada del archivo DLL se ejecuta dentro de la aplicación y obtiene los privilegios del usuario.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-122">The malicious copy of the DLL then runs within the application and gains the privileges of the user.</span></span>

<span data-ttu-id="a4c2e-123">Los desarrolladores pueden ayudar a proteger sus aplicaciones contra los ataques de carga previa de DLL siguiendo estas instrucciones:</span><span class="sxs-lookup"><span data-stu-id="a4c2e-123">Developers can help safeguard their applications against DLL preloading attacks by following these guidelines:</span></span>

-   <span data-ttu-id="a4c2e-124">Siempre que sea posible, especifique una ruta de acceso completa al utilizar las funciones [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya), [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa), [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa)o [**ShellExecute**](/windows/desktop/api/shellapi/nf-shellapi-shellexecutea) .</span><span class="sxs-lookup"><span data-stu-id="a4c2e-124">Wherever possible, specify a fully qualified path when using the [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya), [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa), [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa), or [**ShellExecute**](/windows/desktop/api/shellapi/nf-shellapi-shellexecutea) functions.</span></span>
-   <span data-ttu-id="a4c2e-125">Use las marcas de búsqueda de la \_ biblioteca de carga \_ con la función [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) o use estas marcas con la función [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) para establecer un orden de búsqueda de dll para un proceso y, a continuación, use las funciones [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) o [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) para modificar la lista.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-125">Use the LOAD\_LIBRARY\_SEARCH flags with the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function, or use these flags with the [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) function to establish a DLL search order for a process and then use the [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) or [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) functions to modify the list.</span></span> <span data-ttu-id="a4c2e-126">Para obtener más información, vea [orden de búsqueda en la biblioteca de vínculos dinámicos](dynamic-link-library-search-order.md).</span><span class="sxs-lookup"><span data-stu-id="a4c2e-126">For more information, see [Dynamic-Link Library Search Order](dynamic-link-library-search-order.md).</span></span>

    <span data-ttu-id="a4c2e-127">**Windows 7, Windows server 2008 R2, Windows Vista y Windows server 2008:** Estas marcas y funciones están disponibles en los sistemas con [KB2533623](https://support.microsoft.com/kb/2533623) instalado.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-127">**Windows 7, Windows Server 2008 R2, Windows Vista and Windows Server 2008:** These flags and functions are available on systems with [KB2533623](https://support.microsoft.com/kb/2533623) installed.</span></span>

-   <span data-ttu-id="a4c2e-128">En los sistemas con [KB2533623](https://support.microsoft.com/kb/2533623) instalado, use las marcas de búsqueda de la biblioteca de carga \_ \_ con la función [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) , o bien use estas marcas con la función [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) para establecer un orden de búsqueda de dll para un proceso y, a continuación, use las funciones [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) o [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) para modificar la lista.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-128">On systems with [KB2533623](https://support.microsoft.com/kb/2533623) installed, use the LOAD\_LIBRARY\_SEARCH flags with the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function, or use these flags with the [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) function to establish a DLL search order for a process and then use the [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) or [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) functions to modify the list.</span></span> <span data-ttu-id="a4c2e-129">Para obtener más información, vea [orden de búsqueda en la biblioteca de vínculos dinámicos](dynamic-link-library-search-order.md).</span><span class="sxs-lookup"><span data-stu-id="a4c2e-129">For more information, see [Dynamic-Link Library Search Order](dynamic-link-library-search-order.md).</span></span>
-   <span data-ttu-id="a4c2e-130">Considere la posibilidad de usar el [redireccionamiento de dll](dynamic-link-library-redirection.md) o un [manifiesto](/windows/desktop/SbsCs/manifests) para asegurarse de que la aplicación usa el archivo dll correcto.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-130">Consider using [DLL redirection](dynamic-link-library-redirection.md) or a [manifest](/windows/desktop/SbsCs/manifests) to ensure that your application uses the correct DLL.</span></span>
-   <span data-ttu-id="a4c2e-131">Al usar el orden de búsqueda estándar, asegúrese de que está habilitado el modo de búsqueda segura de DLL.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-131">When using the standard search order, make sure that safe DLL search mode is enabled.</span></span> <span data-ttu-id="a4c2e-132">Esto coloca el directorio actual del usuario más adelante en el orden de búsqueda, lo que aumenta las posibilidades de que Windows encuentre una copia legítima del archivo DLL antes de una copia malintencionada.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-132">This places the user's current directory later in the search order, increasing the chances that Windows will find a legitimate copy of the DLL before a malicious copy.</span></span> <span data-ttu-id="a4c2e-133">El modo de búsqueda segura de archivos dll está habilitado de forma predeterminada a partir de Windows XP con Service Pack 2 (SP2) y se controla mediante el valor del registro **HKEY \_ local \_ Machine \\ System \\ CurrentControlSet \\ control \\ Session Manager** \\ **SafeDllSearchMode** .</span><span class="sxs-lookup"><span data-stu-id="a4c2e-133">Safe DLL search mode is enabled by default starting with Windows XP with Service Pack 2 (SP2) and is controlled by the **HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager**\\**SafeDllSearchMode** registry value.</span></span> <span data-ttu-id="a4c2e-134">Para obtener más información, vea [orden de búsqueda en la biblioteca de vínculos dinámicos](dynamic-link-library-search-order.md).</span><span class="sxs-lookup"><span data-stu-id="a4c2e-134">For more information, see [Dynamic-Link Library Search Order](dynamic-link-library-search-order.md).</span></span>
-   <span data-ttu-id="a4c2e-135">Considere la posibilidad de quitar el directorio actual de la ruta de acceso de búsqueda estándar mediante una llamada a [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) con una cadena vacía ("").</span><span class="sxs-lookup"><span data-stu-id="a4c2e-135">Consider removing the current directory from the standard search path by calling [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) with an empty string ("").</span></span> <span data-ttu-id="a4c2e-136">Esto debe realizarse una vez al principio de la inicialización del proceso, no antes ni después de las llamadas a [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya).</span><span class="sxs-lookup"><span data-stu-id="a4c2e-136">This should be done once early in process initialization, not before and after calls to [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya).</span></span> <span data-ttu-id="a4c2e-137">Tenga en cuenta que **SetDllDirectory** afecta a todo el proceso y que varios subprocesos que llaman a **SetDllDirectory** con distintos valores pueden provocar un comportamiento indefinido.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-137">Be aware that **SetDllDirectory** affects the entire process and that multiple threads calling **SetDllDirectory** with different values can cause undefined behavior.</span></span> <span data-ttu-id="a4c2e-138">Si la aplicación carga archivos dll de terceros, realice una prueba detenidamente para identificar las incompatibilidades.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-138">If your application loads third-party DLLs, test carefully to identify any incompatibilities.</span></span>
-   <span data-ttu-id="a4c2e-139">No utilice la función [**SearchPath**](/windows/desktop/api/processenv/nf-processenv-searchpathw) para recuperar una ruta de acceso a un archivo DLL para una llamada [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) subsiguiente a menos que esté habilitado el modo de búsqueda de procesos seguros.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-139">Do not use the [**SearchPath**](/windows/desktop/api/processenv/nf-processenv-searchpathw) function to retrieve a path to a DLL for a subsequent [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) call unless safe process search mode is enabled.</span></span> <span data-ttu-id="a4c2e-140">Cuando el modo de búsqueda de procesos seguro no está habilitado, la función **SearchPath** usa un orden de búsqueda diferente que **LoadLibrary** y es probable que busque primero en el directorio actual del usuario la dll especificada.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-140">When safe process search mode is not enabled, the **SearchPath** function uses a different search order than **LoadLibrary** and is likely to first search the user's current directory for the specified DLL.</span></span> <span data-ttu-id="a4c2e-141">Para habilitar el modo de búsqueda segura de procesos para la función **SearchPath** , use la función [**SetSearchPathMode**](/windows/desktop/api/winbase/nf-winbase-setsearchpathmode) con la \_ ruta de búsqueda base \_ \_ habilitar \_ \_ SEARCHMODE segura.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-141">To enable safe process search mode for the **SearchPath** function, use the [**SetSearchPathMode**](/windows/desktop/api/winbase/nf-winbase-setsearchpathmode) function with BASE\_SEARCH\_PATH\_ENABLE\_SAFE\_SEARCHMODE.</span></span> <span data-ttu-id="a4c2e-142">Esto mueve el directorio actual al final de la lista de búsqueda de **SearchPath** mientras dure el proceso.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-142">This moves the current directory to the end of the **SearchPath** search list for the life of the process.</span></span> <span data-ttu-id="a4c2e-143">Tenga en cuenta que el directorio actual no se quita de la ruta de acceso de búsqueda, por lo que si el sistema no encuentra una copia legítima del archivo DLL antes de que llegue al directorio actual, la aplicación seguirá siendo vulnerable.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-143">Note that the current directory is not removed from the search path, so if the system does not find a legitimate copy of the DLL before it reaches the current directory, the application is still vulnerable.</span></span> <span data-ttu-id="a4c2e-144">Al igual que con [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya), la llamada a **SetSearchPathMode** se debe realizar en el principio de la inicialización del proceso y afecta a todo el proceso.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-144">As with [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya), calling **SetSearchPathMode** should be done early in process initialization and it affects the entire process.</span></span> <span data-ttu-id="a4c2e-145">Si la aplicación carga archivos dll de terceros, realice una prueba detenidamente para identificar las incompatibilidades.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-145">If your application loads third-party DLLs, test carefully to identify any incompatibilities.</span></span>
-   <span data-ttu-id="a4c2e-146">No realice suposiciones sobre la versión del sistema operativo basada en una llamada [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) que busque un archivo dll.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-146">Do not make assumptions about the operating system version based on a [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) call that searches for a DLL.</span></span> <span data-ttu-id="a4c2e-147">Si la aplicación se ejecuta en un entorno en el que el archivo DLL no está presente legítimamente pero hay una copia malintencionada de la DLL en la ruta de búsqueda, se puede cargar la copia malintencionada del archivo DLL.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-147">If the application is running in an environment where the DLL is legitimately not present but a malicious copy of the DLL is in the search path, the malicious copy of the DLL may be loaded.</span></span> <span data-ttu-id="a4c2e-148">En su lugar, use las técnicas recomendadas que se describen en [obtener la versión del sistema](/windows/desktop/SysInfo/getting-the-system-version).</span><span class="sxs-lookup"><span data-stu-id="a4c2e-148">Instead, use the recommended techniques described in [Getting the System Version](/windows/desktop/SysInfo/getting-the-system-version).</span></span>

<span data-ttu-id="a4c2e-149">La herramienta Monitor de procesos se puede usar para ayudar a identificar las operaciones de carga de archivos DLL que podrían ser vulnerables.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-149">The Process Monitor tool can be used to help identify DLL load operations that might be vulnerable.</span></span> <span data-ttu-id="a4c2e-150">La herramienta Monitor de procesos se puede descargar desde <https://technet.microsoft.com/sysinternals/bb896645.aspx> .</span><span class="sxs-lookup"><span data-stu-id="a4c2e-150">The Process Monitor tool can be downloaded from <https://technet.microsoft.com/sysinternals/bb896645.aspx>.</span></span>

<span data-ttu-id="a4c2e-151">En el procedimiento siguiente se describe cómo usar el monitor de procesos para examinar las operaciones de carga de archivos DLL en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-151">The following procedure describes how to use Process Monitor to examine DLL load operations in your application.</span></span>

<span data-ttu-id="a4c2e-152">**Para usar el monitor de procesos para examinar las operaciones de carga de archivos DLL en la aplicación**</span><span class="sxs-lookup"><span data-stu-id="a4c2e-152">**To use Process Monitor to examine DLL load operations in your application**</span></span>

1.  <span data-ttu-id="a4c2e-153">Inicie el monitor de proceso.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-153">Start Process Monitor.</span></span>
2.  <span data-ttu-id="a4c2e-154">En el monitor de procesos, incluya los siguientes filtros:</span><span class="sxs-lookup"><span data-stu-id="a4c2e-154">In Process Monitor, include the following filters:</span></span>
    -   <span data-ttu-id="a4c2e-155">La operación es CreateFile</span><span class="sxs-lookup"><span data-stu-id="a4c2e-155">Operation is CreateFile</span></span>
    -   <span data-ttu-id="a4c2e-156">La operación es LoadImage</span><span class="sxs-lookup"><span data-stu-id="a4c2e-156">Operation is LoadImage</span></span>
    -   <span data-ttu-id="a4c2e-157">Path contiene. cpl</span><span class="sxs-lookup"><span data-stu-id="a4c2e-157">Path contains .cpl</span></span>
    -   <span data-ttu-id="a4c2e-158">La ruta de acceso contiene. dll</span><span class="sxs-lookup"><span data-stu-id="a4c2e-158">Path contains .dll</span></span>
    -   <span data-ttu-id="a4c2e-159">La ruta de acceso contiene. drv</span><span class="sxs-lookup"><span data-stu-id="a4c2e-159">Path contains .drv</span></span>
    -   <span data-ttu-id="a4c2e-160">La ruta de acceso contiene. exe</span><span class="sxs-lookup"><span data-stu-id="a4c2e-160">Path contains .exe</span></span>
    -   <span data-ttu-id="a4c2e-161">La ruta de acceso contiene. ocx</span><span class="sxs-lookup"><span data-stu-id="a4c2e-161">Path contains .ocx</span></span>
    -   <span data-ttu-id="a4c2e-162">La ruta de acceso contiene. SCR</span><span class="sxs-lookup"><span data-stu-id="a4c2e-162">Path contains .scr</span></span>
    -   <span data-ttu-id="a4c2e-163">La ruta de acceso contiene. sys</span><span class="sxs-lookup"><span data-stu-id="a4c2e-163">Path contains .sys</span></span>
3.  <span data-ttu-id="a4c2e-164">Excluya los siguientes filtros:</span><span class="sxs-lookup"><span data-stu-id="a4c2e-164">Exclude the following filters:</span></span>
    -   <span data-ttu-id="a4c2e-165">El nombre del proceso es procmon.exe</span><span class="sxs-lookup"><span data-stu-id="a4c2e-165">Process Name is procmon.exe</span></span>
    -   <span data-ttu-id="a4c2e-166">El nombre del proceso es Procmon64.exe</span><span class="sxs-lookup"><span data-stu-id="a4c2e-166">Process Name is Procmon64.exe</span></span>
    -   <span data-ttu-id="a4c2e-167">El nombre del proceso es sistema</span><span class="sxs-lookup"><span data-stu-id="a4c2e-167">Process Name is System</span></span>
    -   <span data-ttu-id="a4c2e-168">La operación comienza con IRP \_ MJ\_</span><span class="sxs-lookup"><span data-stu-id="a4c2e-168">Operation begins with IRP\_MJ\_</span></span>
    -   <span data-ttu-id="a4c2e-169">La operación comienza con FASTIO\_</span><span class="sxs-lookup"><span data-stu-id="a4c2e-169">Operation begins with FASTIO\_</span></span>
    -   <span data-ttu-id="a4c2e-170">El resultado es SUCCEss</span><span class="sxs-lookup"><span data-stu-id="a4c2e-170">Result is SUCCESS</span></span>
    -   <span data-ttu-id="a4c2e-171">La ruta de acceso finaliza con pagefile.sys</span><span class="sxs-lookup"><span data-stu-id="a4c2e-171">Path ends with pagefile.sys</span></span>
4.  <span data-ttu-id="a4c2e-172">Intente iniciar la aplicación con el directorio actual establecido en un directorio específico.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-172">Attempt to start your application with the current directory set to a specific directory.</span></span> <span data-ttu-id="a4c2e-173">Por ejemplo, haga doble clic en un archivo con una extensión cuyo controlador de archivos esté asignado a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-173">For example, double-click a file with an extension whose file handler is assigned to your application.</span></span>
5.  <span data-ttu-id="a4c2e-174">Compruebe la salida del monitor de procesos para las rutas de acceso que parezcan sospechosas, como una llamada al directorio actual para cargar un archivo DLL.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-174">Check Process Monitor output for paths that look suspicious, such as a call to the current directory to load a DLL.</span></span> <span data-ttu-id="a4c2e-175">Este tipo de llamada puede indicar una vulnerabilidad en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a4c2e-175">This kind of call might indicate a vulnerability in your application.</span></span>

 

 
