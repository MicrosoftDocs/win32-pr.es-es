---
title: Controlar el mensaje de WM_GETOBJECT
description: Tanto Microsoft Active Accessibility como la automatización de la interfaz de usuario de Microsoft envían el mensaje de WM \_ GETOBJECT a una aplicación de servidor o de proveedor para recuperar información sobre un objeto accesible compatible con el servidor o el proveedor.
ms.assetid: 4b8e551f-aba7-4a89-8874-ba690175f525
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 695fad8f050606f0a95a1780551d35499e39d166
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "105714425"
---
# <a name="handling-the-wm_getobject-message"></a><span data-ttu-id="46993-103">Controlar el mensaje de WM \_ GETOBJECT</span><span class="sxs-lookup"><span data-stu-id="46993-103">Handling the WM\_GETOBJECT Message</span></span>

<span data-ttu-id="46993-104">Tanto Microsoft Active Accessibility como la automatización de la interfaz de usuario de Microsoft envían el mensaje de [**WM \_ GETOBJECT**](wm-getobject.md) a una aplicación de servidor o de proveedor para recuperar información sobre un objeto accesible compatible con el servidor o el proveedor.</span><span class="sxs-lookup"><span data-stu-id="46993-104">Both Microsoft Active Accessibility and Microsoft UI Automation send the [**WM\_GETOBJECT**](wm-getobject.md) message to a server or provider application to retrieve information about an accessible object supported by the server or provider.</span></span> <span data-ttu-id="46993-105">Los clientes nunca envían directamente **WM \_ GETOBJECT** .</span><span class="sxs-lookup"><span data-stu-id="46993-105">Clients never send **WM\_GETOBJECT** directly.</span></span> <span data-ttu-id="46993-106">En su lugar, Microsoft Active Accessibility envía este mensaje cuando un cliente llama a las funciones [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint), [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent)y [**AccessibleObjectFromWindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) .</span><span class="sxs-lookup"><span data-stu-id="46993-106">Instead, Microsoft Active Accessibility sends this message when a client calls the [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint), [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent), and [**AccessibleObjectFromWindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) functions.</span></span> <span data-ttu-id="46993-107">La automatización de la interfaz de usuario envía **WM \_ GETOBJECT** cuando un cliente llama a [**IUIAutomation:: ElementFromHandle**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle), [**ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint)y [**GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement), y al controlar los eventos para los que el cliente se ha registrado.</span><span class="sxs-lookup"><span data-stu-id="46993-107">UI Automation sends **WM\_GETOBJECT** when a client calls [**IUIAutomation::ElementFromHandle**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle), [**ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint), and [**GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement), and when handling events for which the client has registered.</span></span>

<span data-ttu-id="46993-108">Microsoft Active Accessibility o la automatización de la interfaz de usuario especifica el tipo de objeto para el que necesita información pasando un valor denominado *identificador de objeto* con el mensaje de [**\_ GETOBJECT de WM**](wm-getobject.md) .</span><span class="sxs-lookup"><span data-stu-id="46993-108">Microsoft Active Accessibility or UI Automation specifies the type of object it needs information for by passing a valued called an *object identifier* with the [**WM\_GETOBJECT**](wm-getobject.md) message.</span></span> <span data-ttu-id="46993-109">Cuando recibe el mensaje, el servidor o el proveedor examina el identificador de objeto para determinar cómo responder al mensaje.</span><span class="sxs-lookup"><span data-stu-id="46993-109">When it receives the message, the server or provider examines the object identifier to determine how to respond to the message.</span></span> <span data-ttu-id="46993-110">La respuesta depende de si la aplicación receptora implementa Microsoft Active Accessibility (un servidor), automatización de la interfaz de usuario (un proveedor) o ninguna de ellas para el objeto especificado.</span><span class="sxs-lookup"><span data-stu-id="46993-110">The response depends on whether the receiving application implements Microsoft Active Accessibility (a server), UI Automation (a provider), or neither, for the specified object.</span></span>

-   <span data-ttu-id="46993-111">Si la aplicación receptora es un servidor de Microsoft Active Accessibility y el mensaje de [**WM \_ GETOBJECT**](wm-getobject.md) incluye un identificador de objeto de [**\_ cliente de OBJID**](object-identifiers.md), el servidor debe devolver el valor obtenido pasando la interfaz [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) del objeto a la función [**LresultFromObject**](/windows/desktop/api/Oleacc/nf-oleacc-lresultfromobject) .</span><span class="sxs-lookup"><span data-stu-id="46993-111">If the receiving application is an Microsoft Active Accessibility server and the [**WM\_GETOBJECT**](wm-getobject.md) message includes an object identifier of [**OBJID\_CLIENT**](object-identifiers.md), the server should return the value obtained by passing the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface of the object to the [**LresultFromObject**](/windows/desktop/api/Oleacc/nf-oleacc-lresultfromobject) function.</span></span>
-   <span data-ttu-id="46993-112">Si la aplicación receptora es un proveedor de automatización de aUI y el identificador de objeto es **UiaRootObjectId**, el proveedor debe devolver la interfaz [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) del objeto.</span><span class="sxs-lookup"><span data-stu-id="46993-112">If the receiving application is aUI Automation provider and the object identifier is **UiaRootObjectId**, the provider should return the [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interface of the object.</span></span> <span data-ttu-id="46993-113">El proveedor obtiene la interfaz mediante una llamada a la función [**UiaReturnRawElementProvider**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiareturnrawelementprovider) .</span><span class="sxs-lookup"><span data-stu-id="46993-113">The provider obtains the interface by calling the [**UiaReturnRawElementProvider**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiareturnrawelementprovider) function.</span></span>
-   <span data-ttu-id="46993-114">Si la aplicación receptora no implementa Microsoft Active Accessibility ni la automatización de la interfaz de usuario, debe pasar el mensaje de [**WM \_ GETOBJECT**](wm-getobject.md) a la función [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) .</span><span class="sxs-lookup"><span data-stu-id="46993-114">If the receiving application implements neither Microsoft Active Accessibility nor UI Automation, it should pass the [**WM\_GETOBJECT**](wm-getobject.md) message to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function.</span></span> <span data-ttu-id="46993-115">Al pasar el mensaje, se habilita el marco de accesibilidad para determinar si un proxy está disponible para el objeto especificado.</span><span class="sxs-lookup"><span data-stu-id="46993-115">Passing the message enables the accessibility framework to determine if a proxy is available for the specified object.</span></span>
-   <span data-ttu-id="46993-116">Si el identificador de objeto no es [**un \_ cliente de OBJID**](object-identifiers.md) ni UiaRootObjectId, la aplicación receptora debe pasar el mensaje de [**WM \_ GETOBJECT**](wm-getobject.md) a la función [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) .</span><span class="sxs-lookup"><span data-stu-id="46993-116">If the object identifier is neither [**OBJID\_CLIENT**](object-identifiers.md) nor UiaRootObjectId, the receiving application should pass the [**WM\_GETOBJECT**](wm-getobject.md) message to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function.</span></span> <span data-ttu-id="46993-117">Al pasar el mensaje, el marco de accesibilidad podrá usar los proveedores predeterminados para los elementos de la interfaz de usuario estándar.</span><span class="sxs-lookup"><span data-stu-id="46993-117">Passing the message enables the accessibility framework to use the default providers for standard UI elements.</span></span>

<span data-ttu-id="46993-118">Microsoft Active Accessibility y la automatización de la interfaz de usuario pueden pasar los identificadores de objetos personalizados en un mensaje de [**WM \_ GETOBJECT**](wm-getobject.md) para recuperar los objetos o los valores definidos por la aplicación de un servidor o proveedor.</span><span class="sxs-lookup"><span data-stu-id="46993-118">Microsoft Active Accessibility and UI Automation can pass custom object identifiers in a [**WM\_GETOBJECT**](wm-getobject.md) message to retrieve application-defined values or objects from a server or provider.</span></span> <span data-ttu-id="46993-119">El identificador de objeto [**objid \_ NATIVEOM**](object-identifiers.md) o [**objid \_ QUERYCLASSNAMEIDX**](object-identifiers.md) se puede usar para recuperar una interfaz del modelo de objetos nativo o para solicitar un objeto proxy específico compatible con Oleacc.dll.</span><span class="sxs-lookup"><span data-stu-id="46993-119">The [**OBJID\_NATIVEOM**](object-identifiers.md) or [**OBJID\_QUERYCLASSNAMEIDX**](object-identifiers.md) object identifier can be used to retrieve a native Object Model interface, or to request a specific proxy object that is supported by Oleacc.dll.</span></span>

<span data-ttu-id="46993-120">Mediante el control de los identificadores de objeto **UiaRootObjectId** y el [**\_ cliente de OBJID**](object-identifiers.md) , una implementación de Microsoft Active Accessibility Server puede coexistir junto con una implementación del proveedor de automatización de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="46993-120">By handling both the [**OBJID\_CLIENT**](object-identifiers.md) and **UiaRootObjectId** object identifiers, a Microsoft Active Accessibility server implementation can co-exist alongside a UI Automation provider implementation.</span></span> <span data-ttu-id="46993-121">Dado que la mayoría de los controles estándar de Windows y los controles comunes que implementa la biblioteca de controles comunes (ComCtl32.dll) no implementan Microsoft Active Accessibility o la automatización de la interfaz de usuario, estos controles normalmente no controlan el mensaje de [**WM \_ GETOBJECT**](wm-getobject.md) .</span><span class="sxs-lookup"><span data-stu-id="46993-121">Because most standard Windows controls and common controls implemented by the common control library (ComCtl32.dll) do not implement either Microsoft Active Accessibility or UI Automation, these controls typically do not handle the [**WM\_GETOBJECT**](wm-getobject.md) message.</span></span> <span data-ttu-id="46993-122">En su lugar, Microsoft Active Accessibility o el marco de automatización de la interfaz de usuario comprueba si un objeto proxy está disponible para un elemento de la interfaz de usuario determinado.</span><span class="sxs-lookup"><span data-stu-id="46993-122">Instead, the Microsoft Active Accessibility or UI Automation framework checks if a proxy object is available for a particular UI element.</span></span> <span data-ttu-id="46993-123">De lo contrario, proporciona el objeto proxy predeterminado para el objeto de ventana host.</span><span class="sxs-lookup"><span data-stu-id="46993-123">Otherwise, it provides the default proxy object for the host window object.</span></span>

 

 