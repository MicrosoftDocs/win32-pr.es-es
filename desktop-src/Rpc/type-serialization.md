---
title: Serialización de tipo
description: El compilador MIDL genera hasta tres funciones para cada tipo al que se aplica el atributo \ encode \ o \ decode \.
ms.assetid: 948f1dd7-c8b0-4fa0-88d8-9d122de52ba1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4674617bc98c92dbc684a29d1a3c91ac6a7429e1
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104149425"
---
# <a name="type-serialization"></a><span data-ttu-id="6246c-103">Serialización de tipo</span><span class="sxs-lookup"><span data-stu-id="6246c-103">Type Serialization</span></span>

<span data-ttu-id="6246c-104">El compilador MIDL genera hasta tres funciones para cada tipo al que \[ [](/windows/desktop/Midl/encode) \] se aplica el atributo de codificación o \[ [descodificación](/windows/desktop/Midl/decode) \] .</span><span class="sxs-lookup"><span data-stu-id="6246c-104">The MIDL compiler generates up to three functions for each type to which the \[ [encode](/windows/desktop/Midl/encode)\] or \[ [decode](/windows/desktop/Midl/decode)\] attribute is applied.</span></span> <span data-ttu-id="6246c-105">Por ejemplo, para un tipo definido por el usuario denominado mi *tipo*, el compilador genera código para las \_ funciones de codificación, \_ descodificación y tipo \_ AlignSize.</span><span class="sxs-lookup"><span data-stu-id="6246c-105">For example, for a user-defined type named *MyType*, the compiler generates code for the MyType\_Encode, MyType\_Decode, and MyType\_AlignSize functions.</span></span> <span data-ttu-id="6246c-106">Para estas funciones, el compilador escribe prototipos en stub. h y el código fuente en stub \_ c.c.</span><span class="sxs-lookup"><span data-stu-id="6246c-106">For these functions, the compiler writes prototypes to Stub.h and source code to Stub\_c.c.</span></span> <span data-ttu-id="6246c-107">Por lo general, puede codificar un objeto de *tipo* de usuario con \_ la codificación de tipo y descodificar un objeto del búfer mediante la \_ descodificación de tipo.</span><span class="sxs-lookup"><span data-stu-id="6246c-107">Generally, you can encode a *MyType* object with MyType\_Encode and decode an object from the buffer using MyType\_Decode.</span></span> <span data-ttu-id="6246c-108">\_Se utiliza AlignSize si necesita conocer el tamaño del búfer de serialización antes de asignarlo.</span><span class="sxs-lookup"><span data-stu-id="6246c-108">MyType\_AlignSize is used if you need to know the size of the marshaling buffer before allocating it.</span></span>

<span data-ttu-id="6246c-109">El compilador MIDL genera la siguiente función de codificación.</span><span class="sxs-lookup"><span data-stu-id="6246c-109">The following encoding function is generated by the MIDL compiler.</span></span> <span data-ttu-id="6246c-110">Esta función serializa los datos para el objeto al que apunta pObject y el búfer se obtiene según el método especificado en el identificador.</span><span class="sxs-lookup"><span data-stu-id="6246c-110">This function serializes the data for the object pointed to by pObject, and the buffer is obtained according to the method specified in the handle.</span></span> <span data-ttu-id="6246c-111">Después de escribir los datos serializados en el búfer, se controla el búfer.</span><span class="sxs-lookup"><span data-stu-id="6246c-111">After writing the serialized data to the buffer, you control the buffer.</span></span> <span data-ttu-id="6246c-112">Tenga en cuenta que el identificador hereda el estado de las llamadas anteriores y los búferes se deben alinear en 8.</span><span class="sxs-lookup"><span data-stu-id="6246c-112">Note that the handle inherits the status from the previous calls, and the buffers must be aligned at 8.</span></span>

<span data-ttu-id="6246c-113">Para un identificador implícito:</span><span class="sxs-lookup"><span data-stu-id="6246c-113">For an implicit handle:</span></span>

``` syntax
void MyType_Encode (MyType __RPC_FAR * pObject);
```

<span data-ttu-id="6246c-114">Para un identificador explícito:</span><span class="sxs-lookup"><span data-stu-id="6246c-114">For an explicit handle:</span></span>

``` syntax
void MyType_Encode (handle_t Handle, MyType __RPC_FAR * pObject);
```

<span data-ttu-id="6246c-115">La función siguiente deserializa los datos del almacenamiento de la aplicación en el objeto al que apunta pObject.</span><span class="sxs-lookup"><span data-stu-id="6246c-115">The following function deserializes the data from the application's storage into the object pointed to by pObject.</span></span> <span data-ttu-id="6246c-116">Proporcione un búfer calculado según el método especificado en el identificador.</span><span class="sxs-lookup"><span data-stu-id="6246c-116">You supply a marshaled buffer according to the method specified in the handle.</span></span> <span data-ttu-id="6246c-117">Tenga en cuenta que el identificador puede heredar el estado de las llamadas anteriores y los búferes se deben alinear en 8.</span><span class="sxs-lookup"><span data-stu-id="6246c-117">Note that the handle can inherit the status from the previous calls and the buffers must be aligned at 8.</span></span>

<span data-ttu-id="6246c-118">Para un identificador implícito:</span><span class="sxs-lookup"><span data-stu-id="6246c-118">For an implicit handle:</span></span>

``` syntax
void MyType_Decode (MyType __RPC_FAR * pObject);
```

<span data-ttu-id="6246c-119">Para un identificador explícito:</span><span class="sxs-lookup"><span data-stu-id="6246c-119">For an explicit handle:</span></span>

``` syntax
void MyType_Decode (handle_t Handle, MyType __RPC_FAR * pObject);
```

<span data-ttu-id="6246c-120">La función siguiente devuelve un tamaño, en bytes, que incluye la instancia de tipo más los bytes de relleno necesarios para alinear los datos.</span><span class="sxs-lookup"><span data-stu-id="6246c-120">The following function returns a size, in bytes, that includes the type instance plus any padding bytes needed to align the data.</span></span> <span data-ttu-id="6246c-121">Esto permite serializar un conjunto de instancias del mismo tipo o de tipos diferentes en un búfer, a la vez que se garantiza que los datos de cada objeto están alineados correctamente.</span><span class="sxs-lookup"><span data-stu-id="6246c-121">This enables serializing a set of instances of the same or different types into a buffer while ensuring that the data for each object is appropriately aligned.</span></span> <span data-ttu-id="6246c-122">\_AlignSize da por supuesto que la instancia a la que apunta pObject se serializará en un búfer que comienza en el desplazamiento alineado en 8.</span><span class="sxs-lookup"><span data-stu-id="6246c-122">MyType\_AlignSize assumes that the instance pointed to by pObject will be marshaled into a buffer beginning at the offset aligned at 8.</span></span>

<span data-ttu-id="6246c-123">Para un identificador implícito:</span><span class="sxs-lookup"><span data-stu-id="6246c-123">For an implicit handle:</span></span>

``` syntax
size_t MyType_AlignSize (MyType __RPC_FAR * pObject);
```

<span data-ttu-id="6246c-124">Para un identificador explícito:</span><span class="sxs-lookup"><span data-stu-id="6246c-124">For an explicit handle:</span></span>

``` syntax
size_t MyType_AlignSize (handle_t Handle, MyType __RPC_FAR * pObject);
```

<span data-ttu-id="6246c-125">Tenga en cuenta que los procedimientos remotos con identificadores de enlace implícitos y tipos serializados con identificadores de serialización implícitos usan la misma variable de identificador global.</span><span class="sxs-lookup"><span data-stu-id="6246c-125">Note that both remote procedures with implicit binding handles and serialized types with implicit serialization handles use the same global handle variable.</span></span> <span data-ttu-id="6246c-126">Por lo tanto, es aconsejable no mezclar la serialización de tipos y los procedimientos remotos en una interfaz con identificadores implícitos.</span><span class="sxs-lookup"><span data-stu-id="6246c-126">Therefore, it is advisable not to mix type serialization and remote procedures in an interface with implicit handles.</span></span> <span data-ttu-id="6246c-127">Para obtener más información, vea [identificadores implícitos e explícitos](implicit-versus-explicit-handles.md).</span><span class="sxs-lookup"><span data-stu-id="6246c-127">For details, see [Implicit Versus Explicit Handles](implicit-versus-explicit-handles.md).</span></span>

 

 