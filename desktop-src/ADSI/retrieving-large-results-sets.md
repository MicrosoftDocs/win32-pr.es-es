---
title: Recuperar conjuntos de resultados grandes
description: Si existe la posibilidad de que el conjunto de resultados que se devuelva contenga más de 1000 elementos, debe usar una búsqueda paginada.
ms.assetid: 1439d6b8-50dd-4d37-bcc9-dd0f63af865f
ms.tgt_platform: multiple
keywords:
- Recuperar conjuntos de resultados de gran tamaño ADSI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 78f8902d25010690953cfae8a03ff9e500b4ebda
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/16/2019
ms.locfileid: "105656154"
---
# <a name="retrieving-large-results-sets"></a><span data-ttu-id="48e66-104">Recuperar conjuntos de resultados grandes</span><span class="sxs-lookup"><span data-stu-id="48e66-104">Retrieving Large Results Sets</span></span>

<span data-ttu-id="48e66-105">Si existe la posibilidad de que el conjunto de resultados que se devuelva contenga más de 1000 elementos, debe usar una búsqueda paginada.</span><span class="sxs-lookup"><span data-stu-id="48e66-105">When there is the possibility that the result set that will be returned will contain more than 1000 items, you must use a paged search.</span></span> <span data-ttu-id="48e66-106">Las búsquedas de Active Directory realizadas sin paginación se limitan a devolver un máximo de los primeros 1000 registros.</span><span class="sxs-lookup"><span data-stu-id="48e66-106">Searches of Active Directory performed without paging are limited to returning a maximum of the first 1000 records.</span></span> <span data-ttu-id="48e66-107">Con una búsqueda paginada, el conjunto de resultados se presenta como páginas individuales, cada una de las cuales contiene un número predeterminado de entradas de resultados.</span><span class="sxs-lookup"><span data-stu-id="48e66-107">With a paged search, the result set is presented as individual pages, each containing a predetermined number of result entries.</span></span> <span data-ttu-id="48e66-108">Con este tipo de búsqueda, se devuelven nuevas páginas de entradas de resultados hasta que se alcanza el final del conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="48e66-108">With this type of search, new pages of result entries are returned until the end of the result set is reached.</span></span>

<span data-ttu-id="48e66-109">De forma predeterminada, el servidor que responde a una solicitud de consulta calcula completamente un conjunto de resultados antes de devolver los datos.</span><span class="sxs-lookup"><span data-stu-id="48e66-109">By default, the server that responds to a query request completely calculates a result set before returning data.</span></span> <span data-ttu-id="48e66-110">En un conjunto de resultados grande, esto requiere la memoria del servidor cuando se adquiere el conjunto de resultados y el ancho de banda de red cuando se devuelve el resultado grande.</span><span class="sxs-lookup"><span data-stu-id="48e66-110">In a large result set, this requires server memory as the result set is acquired, and network bandwidth when the large result is returned.</span></span> <span data-ttu-id="48e66-111">Establecer un tamaño de página permite que el servidor envíe los datos en las páginas a medida que se compilan las páginas.</span><span class="sxs-lookup"><span data-stu-id="48e66-111">Setting a page size allows the server to send the data in pages as the pages are being built.</span></span> <span data-ttu-id="48e66-112">Después, el cliente almacena en caché estos datos y proporciona un cursor al código de nivel de aplicación.</span><span class="sxs-lookup"><span data-stu-id="48e66-112">The client then caches this data and provides a cursor to the application level code.</span></span> <span data-ttu-id="48e66-113">La paginación se establece definiendo cuántas filas calcula el servidor antes de que los datos se devuelvan a través de la red al cliente.</span><span class="sxs-lookup"><span data-stu-id="48e66-113">Paging is set by defining how many rows the server calculates before the data is returned over the network to the client.</span></span>

<span data-ttu-id="48e66-114">La búsqueda paginada ofrece ventajas tanto para el cliente como para el servidor.</span><span class="sxs-lookup"><span data-stu-id="48e66-114">Paged searching offers benefits to both the client and the server.</span></span> <span data-ttu-id="48e66-115">Por ejemplo, el cliente puede tener mayor capacidad de respuesta en la presentación de los resultados a los usuarios finales.</span><span class="sxs-lookup"><span data-stu-id="48e66-115">For example, the client can be more responsive in presenting the results to end users.</span></span> <span data-ttu-id="48e66-116">Esto es especialmente importante para las herramientas de interfaz gráfica de usuario que pueden mostrar datos mientras otro subproceso recibe simultáneamente más datos del servidor.</span><span class="sxs-lookup"><span data-stu-id="48e66-116">This is especially relevant for graphical user interface tools that can display data while another thread concurrently receives more data from the server.</span></span>

<span data-ttu-id="48e66-117">Al configurar la consulta, si especifica un criterio de ordenación para el conjunto de resultados, el servidor debe calcular por completo el conjunto de resultados antes de devolver los datos al cliente, lo que afecta al tiempo de respuesta de la consulta.</span><span class="sxs-lookup"><span data-stu-id="48e66-117">When you set up your query, if you specify a sort order for your result set, then the server must completely calculate the result set before returning the data to the client, which impacts the response time for the query.</span></span>

<span data-ttu-id="48e66-118">En el lado del servidor, la búsqueda paginada hace que la operación sea escalable.</span><span class="sxs-lookup"><span data-stu-id="48e66-118">On the server side, paged searching makes the operation scalable.</span></span> <span data-ttu-id="48e66-119">Por ejemplo, si los clientes 100 emiten solicitudes de búsqueda simultáneamente y, en el promedio, cada cliente devuelve 200 objetos, si no se especifica el tamaño de página, el servidor debe tener suficiente memoria para contener el conjunto de resultados completo de 20.000 entradas.</span><span class="sxs-lookup"><span data-stu-id="48e66-119">For example, if one hundred clients issue search requests simultaneously and, on the average, each client is returned two hundred objects, if page size is not specified, the server must have sufficient memory to hold the complete result set of 20,000 entries.</span></span> <span data-ttu-id="48e66-120">Como alternativa, si cada cliente especifica un tamaño de página de diez objetos, los requisitos de memoria en el servidor se reducirían en un factor de 20.</span><span class="sxs-lookup"><span data-stu-id="48e66-120">Alternately, if each client specified a page size of ten objects, the memory requirements on the server would be reduced by a factor of 20.</span></span>

> [!Note]  
> <span data-ttu-id="48e66-121">No todos los servicios de directorio admiten búsquedas paginadas.</span><span class="sxs-lookup"><span data-stu-id="48e66-121">Not all directory services support paged searches.</span></span> <span data-ttu-id="48e66-122">Active Directory implementa la arquitectura de tamaño de página.</span><span class="sxs-lookup"><span data-stu-id="48e66-122">Active Directory implements page size architecture.</span></span>

 

<span data-ttu-id="48e66-123">Muchos servidores de directorio especifican un límite administrativo para el número máximo de objetos que pueden devolver si un cliente no especifica el tamaño de página.</span><span class="sxs-lookup"><span data-stu-id="48e66-123">Many directory servers specify an Administrative Limit for the maximum number of objects they can return if a client does not specify the page size.</span></span> <span data-ttu-id="48e66-124">Cuando se alcanza el límite administrativo, ADSI genera el error Error de Win32 de **\_ límite de \_ Administración \_ \_ de DS** .</span><span class="sxs-lookup"><span data-stu-id="48e66-124">When the Administrative Limit is reached, ADSI generates the **ERROR\_DS\_ADMIN\_LIMIT\_EXCEEDED** Win32 error.</span></span>

<span data-ttu-id="48e66-125">En el lado del cliente, una búsqueda paginada permite a un cliente detener la operación mientras aún está en curso.</span><span class="sxs-lookup"><span data-stu-id="48e66-125">On the client side, a paged search allows a client to stop the operation while it is still in progress.</span></span> <span data-ttu-id="48e66-126">Por el contrario, en una búsqueda no paginada, el cliente se bloquea hasta que se devuelven los datos por completo, o se produce un error.</span><span class="sxs-lookup"><span data-stu-id="48e66-126">By contrast, in a non-paged search, the client is blocked until the data is completely returned, or an error occurs.</span></span> <span data-ttu-id="48e66-127">Esto podría afectar al rendimiento de la red si el conjunto de resultados resulta ser mayor y tarda más tiempo del esperado.</span><span class="sxs-lookup"><span data-stu-id="48e66-127">This could impact network performance if the result set turns out to be larger and takes more time than expected.</span></span>

<span data-ttu-id="48e66-128">En nombre del cliente, ADSI controla el tamaño de página de forma transparente.</span><span class="sxs-lookup"><span data-stu-id="48e66-128">On behalf of the client, ADSI handles the page size transparently.</span></span> <span data-ttu-id="48e66-129">El cliente no tiene que contar el número de objetos en curso.</span><span class="sxs-lookup"><span data-stu-id="48e66-129">The client does not have to count the number of objects in progress.</span></span> <span data-ttu-id="48e66-130">ADSI encapsula la interacción del servidor para el cliente.</span><span class="sxs-lookup"><span data-stu-id="48e66-130">ADSI encapsulates the server interaction for the client.</span></span> <span data-ttu-id="48e66-131">Desde la perspectiva del cliente, la búsqueda devuelve un conjunto de resultados completo.</span><span class="sxs-lookup"><span data-stu-id="48e66-131">From the client perspective, the search returns a complete result set.</span></span>

<span data-ttu-id="48e66-132">Para obtener más información acerca del uso de la opción de tiempo de espera de búsqueda con una interfaz de búsqueda específica, vea:</span><span class="sxs-lookup"><span data-stu-id="48e66-132">For more information about using the search time out option with a specific search interface, see:</span></span>

-   [<span data-ttu-id="48e66-133">Paginación con IDirectorySearch</span><span class="sxs-lookup"><span data-stu-id="48e66-133">Paging with IDirectorySearch</span></span>](paging-with-idirectorysearch.md)
-   [<span data-ttu-id="48e66-134">Buscar con Objetos de datos ActiveX</span><span class="sxs-lookup"><span data-stu-id="48e66-134">Searching with ActiveX Data Objects</span></span>](searching-with-activex-data-objects-ado.md)
-   [<span data-ttu-id="48e66-135">Buscar con OLE DB</span><span class="sxs-lookup"><span data-stu-id="48e66-135">Searching with OLE DB</span></span>](searching-with-ole-db.md)

<span data-ttu-id="48e66-136">Una búsqueda paginada es transparente para la aplicación porque ADSI continúa recuperando automáticamente páginas de resultados adicionales hasta que llega al final del conjunto de resultados o al final del límite de tiempo establecido.</span><span class="sxs-lookup"><span data-stu-id="48e66-136">A paged search is transparent to your application because ADSI automatically continues to retrieve additional pages of results until it reaches the end of the result set or the end of the time limit that you set.</span></span> <span data-ttu-id="48e66-137">Cuando se usa una búsqueda paginada, el límite de tamaño no invalida el tamaño de página.</span><span class="sxs-lookup"><span data-stu-id="48e66-137">When you use a paged search, the size limit does not override page size.</span></span> <span data-ttu-id="48e66-138">El límite de tamaño solo se puede usar cuando se recupera un conjunto de resultados que contiene menos de 1000 entradas.</span><span class="sxs-lookup"><span data-stu-id="48e66-138">Size limit can only be used when you retrieve a result set that contains fewer than 1000 entries.</span></span>

 

 




