---
title: Definición de interfaces COM
description: Microsoft define muchas interfaces COM. En la mayoría de los casos, puede reutilizar estas interfaces genéricas. Sin embargo, algunas aplicaciones tienen requisitos específicos que hacen que sea deseable o necesario definir sus propias interfaces de objeto.
ms.assetid: 8a94bd7d-d101-411c-97de-9e9a46bf9591
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 516c02a2c337b2c76229094b0e42d75b44f65d16
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/21/2020
ms.locfileid: "104149654"
---
# <a name="defining-com-interfaces"></a><span data-ttu-id="d7126-105">Definición de interfaces COM</span><span class="sxs-lookup"><span data-stu-id="d7126-105">Defining COM Interfaces</span></span>

<span data-ttu-id="d7126-106">Microsoft define muchas interfaces COM.</span><span class="sxs-lookup"><span data-stu-id="d7126-106">Microsoft defines many COM interfaces.</span></span> <span data-ttu-id="d7126-107">En la mayoría de los casos, puede reutilizar estas interfaces genéricas.</span><span class="sxs-lookup"><span data-stu-id="d7126-107">In most cases, you can reuse these generic interfaces.</span></span> <span data-ttu-id="d7126-108">Sin embargo, algunas aplicaciones tienen requisitos específicos que hacen que sea deseable o necesario definir sus propias interfaces de objeto.</span><span class="sxs-lookup"><span data-stu-id="d7126-108">However, some applications have specific requirements that make it desirable or necessary to define your own object interfaces.</span></span>

<span data-ttu-id="d7126-109">Todas las interfaces COM deben derivar, directa o indirectamente, de la interfaz [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) .</span><span class="sxs-lookup"><span data-stu-id="d7126-109">All COM interfaces must derive, directly or indirectly, from the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface.</span></span> <span data-ttu-id="d7126-110">Dentro de esa restricción, la interfaz personalizada puede admitir casi cualquier método o parámetro, incluidos los métodos asincrónicos.</span><span class="sxs-lookup"><span data-stu-id="d7126-110">Within that constraint, your custom interface can support almost any method or parameter, including asynchronous methods.</span></span> <span data-ttu-id="d7126-111">También puede generar una biblioteca de tipos para las interfaces personalizadas para que los clientes puedan tener acceso a la información sobre los métodos del objeto en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="d7126-111">You can also generate a type library for your custom interfaces so that clients can access information about your object's methods at run time.</span></span> <span data-ttu-id="d7126-112">Después de definir una interfaz, describirla en Lenguaje de definición de interfaz de Microsoft (MIDL), compilarla y registrarla, úsela como cualquier interfaz genérica.</span><span class="sxs-lookup"><span data-stu-id="d7126-112">After you define an interface, describe it in Microsoft Interface Definition Language (MIDL), compile and register it, you use it just like any generic interface.</span></span> <span data-ttu-id="d7126-113">Con COM distribuido, los métodos de interfaz están disponibles tanto para los procesos remotos como para otros procesos del mismo equipo.</span><span class="sxs-lookup"><span data-stu-id="d7126-113">With distributed COM, interface methods are available both to remote processes and to other processes on the same computer.</span></span>

<span data-ttu-id="d7126-114">Por último, la creación de interfaces COM requiere un entorno de desarrollo que incluya un compilador de C/C++ y el compilador de Midl.exe.</span><span class="sxs-lookup"><span data-stu-id="d7126-114">Finally, building COM interfaces requires a development environment that includes a C/C++ compiler and the Midl.exe compiler.</span></span>

<span data-ttu-id="d7126-115">Los pasos para crear una interfaz COM son los siguientes:</span><span class="sxs-lookup"><span data-stu-id="d7126-115">The steps in creating a COM interface are as follows:</span></span>

-   <span data-ttu-id="d7126-116">Decida cómo desea proporcionar compatibilidad con la serialización para la interfaz; con el cálculo de referencias controlado por la biblioteca de tipos o con un archivo DLL de proxy/código auxiliar.</span><span class="sxs-lookup"><span data-stu-id="d7126-116">Decide how you want to provide marshaling support for your interface; either with type-library driven marshaling or with a proxy/stub DLL.</span></span> <span data-ttu-id="d7126-117">Incluso se deben calcular las referencias de las interfaces en proceso si se van a utilizar en límites de apartamento.</span><span class="sxs-lookup"><span data-stu-id="d7126-117">Even in-process interfaces must be marshaled if they are to be used across apartment boundaries.</span></span> <span data-ttu-id="d7126-118">Es una buena idea crear compatibilidad con el cálculo de referencias en cada interfaz COM, incluso si no cree que lo necesitará.</span><span class="sxs-lookup"><span data-stu-id="d7126-118">It is a good idea to build marshaling support into every COM interface, even if you don't think you will need it.</span></span> <span data-ttu-id="d7126-119">Vea [serialización](interface-marshaling.md) de la interfaz para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="d7126-119">See [Interface Marshaling](interface-marshaling.md) for more information.</span></span>
-   <span data-ttu-id="d7126-120">Describir la interfaz o interfaces en un archivo de definición de interfaz (IDL).</span><span class="sxs-lookup"><span data-stu-id="d7126-120">Describe the interface or interfaces in an interface definition (IDL) file.</span></span> <span data-ttu-id="d7126-121">Además, puede especificar determinados aspectos locales de la interfaz en un archivo de configuración de la aplicación (ACF).</span><span class="sxs-lookup"><span data-stu-id="d7126-121">In addition, you can specify certain local aspects of your interface in an application configuration file (ACF).</span></span> <span data-ttu-id="d7126-122">Si utiliza el cálculo de referencias controlado por la biblioteca de tipos, agregue una instrucción de [**biblioteca**](/windows/desktop/Midl/library) que haga referencia a las interfaces para las que desea generar información de tipos.</span><span class="sxs-lookup"><span data-stu-id="d7126-122">If you are using type-library driven marshaling, add a [**library**](/windows/desktop/Midl/library) statement that references the interfaces for which you want to generate type information.</span></span>
-   <span data-ttu-id="d7126-123">Utilice el compilador MIDL para generar un archivo de biblioteca de tipos y un archivo de encabezado, o archivos de proxy/código auxiliar de lenguaje C, un archivo de identificador de interfaz, un archivo de datos DLL y un archivo de encabezado.</span><span class="sxs-lookup"><span data-stu-id="d7126-123">Use the MIDL compiler to generate a type library file and header file, or C-language proxy/stub files, interface identifier file, DLL data file and header file.</span></span> <span data-ttu-id="d7126-124">Vea la [compilación de MIDL](midl-compilation.md) para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="d7126-124">See [MIDL Compilation](midl-compilation.md) for more information.</span></span>
-   <span data-ttu-id="d7126-125">Dependiendo del método de cálculo de referencias que elija, escriba un archivo de definición de módulo (DEF), compile y vincule todos los archivos generados por MIDL en un solo archivo DLL de proxy, registre la interfaz en el registro del sistema o registre la biblioteca de tipos.</span><span class="sxs-lookup"><span data-stu-id="d7126-125">Depending on the marshaling method you chose, write a module definition (DEF) file, compile and link all the MIDL-generated files into a single proxy DLL, and register the interface in the system registry, or register the type library.</span></span> <span data-ttu-id="d7126-126">Vea [cargar y registrar una biblioteca de tipos](loading-and-registering-a-type-library.md) y [generar y registrar un archivo dll de proxy](building-and-registering-a-proxy-dll.md) para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="d7126-126">See [Loading and Registering a Type Library](loading-and-registering-a-type-library.md) and [Building and Registering a Proxy DLL](building-and-registering-a-proxy-dll.md) for more information.</span></span>

## <a name="related-topics"></a><span data-ttu-id="d7126-127">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="d7126-127">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d7126-128">Anatomía de un archivo IDL</span><span class="sxs-lookup"><span data-stu-id="d7126-128">Anatomy of an IDL File</span></span>](anatomy-of-an-idl-file.md)
</dt> <dt>

[<span data-ttu-id="d7126-129">Clientes y servidores COM</span><span class="sxs-lookup"><span data-stu-id="d7126-129">COM Clients and Servers</span></span>](com-clients-and-servers.md)
</dt> <dt>

[<span data-ttu-id="d7126-130">Reglas de diseño de interfaz</span><span class="sxs-lookup"><span data-stu-id="d7126-130">Interface Design Rules</span></span>](interface-design-rules.md)
</dt> <dt>

<span data-ttu-id="d7126-131">[The Component Object Model](the-component-object-model.md) [Modelo de objetos componentes (COM)]</span><span class="sxs-lookup"><span data-stu-id="d7126-131">[The Component Object Model](the-component-object-model.md)</span></span>
</dt> </dl>

 

 