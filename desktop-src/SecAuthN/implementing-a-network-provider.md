---
description: Un proveedor de red es un archivo DLL que permite que el sistema operativo Windows admita un protocolo de red específico.
ms.assetid: 21dfa941-72fd-4f2c-8bc4-379ed6ca2a4c
title: Implementación de un proveedor de red
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 97819b033c57feb25cf882f97051785123e2e382
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104153841"
---
# <a name="implementing-a-network-provider"></a><span data-ttu-id="9b1a9-103">Implementación de un proveedor de red</span><span class="sxs-lookup"><span data-stu-id="9b1a9-103">Implementing a Network Provider</span></span>

<span data-ttu-id="9b1a9-104">Un proveedor de red es un archivo DLL que permite que el sistema operativo Windows admita un protocolo de red específico.</span><span class="sxs-lookup"><span data-stu-id="9b1a9-104">A network provider is a DLL that enables the Windows operating system to support a specific network protocol.</span></span> <span data-ttu-id="9b1a9-105">Para ello, implementa la API del proveedor de red.</span><span class="sxs-lookup"><span data-stu-id="9b1a9-105">It does this by implementing the Network Provider API.</span></span> <span data-ttu-id="9b1a9-106">Esta API es un conjunto de funciones a las que el [*enrutador de varios proveedores*](../secgloss/m-gly.md) (MPR) llama para comunicarse con la red.</span><span class="sxs-lookup"><span data-stu-id="9b1a9-106">This API is a set of functions the [*Multiple Provider Router*](../secgloss/m-gly.md) (MPR) calls to communicate with the network.</span></span> <span data-ttu-id="9b1a9-107">A continuación, el proveedor de red traduce estas llamadas a llamadas API específicas de la red para realizar la acción especificada por el MPR.</span><span class="sxs-lookup"><span data-stu-id="9b1a9-107">The network provider then translates these calls into network-specific API calls to perform the action specified by the MPR.</span></span> <span data-ttu-id="9b1a9-108">De esta manera, el sistema operativo Windows puede interactuar con nuevos protocolos de red sin tener que entender las API específicas de la red.</span><span class="sxs-lookup"><span data-stu-id="9b1a9-108">In this way, the Windows operating system can interact with new network protocols without having to understand their network-specific APIs.</span></span>

<span data-ttu-id="9b1a9-109">Para crear un proveedor de red, escriba un archivo DLL que exporte la función [**NPGetCaps**](/windows/desktop/api/Npapi/nf-npapi-npgetcaps) .</span><span class="sxs-lookup"><span data-stu-id="9b1a9-109">To create a network provider, write a DLL that exports the [**NPGetCaps**](/windows/desktop/api/Npapi/nf-npapi-npgetcaps) function.</span></span>

<span data-ttu-id="9b1a9-110">La compatibilidad con las demás funciones de la API del proveedor de red es opcional.</span><span class="sxs-lookup"><span data-stu-id="9b1a9-110">Support of the other functions in the Network Provider API is optional.</span></span> <span data-ttu-id="9b1a9-111">Si el proveedor de red no requiere una función, el archivo DLL no necesita implementarlo ni proporcionar una implementación de código auxiliar.</span><span class="sxs-lookup"><span data-stu-id="9b1a9-111">If your network provider does not require a function, your DLL does not need to implement it or provide a stub implementation.</span></span> <span data-ttu-id="9b1a9-112">Para obtener más información, vea los temas de función individual en [funciones de proveedor de red](authentication-functions.md).</span><span class="sxs-lookup"><span data-stu-id="9b1a9-112">For more information, see the individual function topics in [Network Provider Functions](authentication-functions.md).</span></span>

<span data-ttu-id="9b1a9-113">La excepción es que si admite una de las siguientes funciones de enumeración, debe admitir también las otras dos funciones: [**NPOpenEnum**](/windows/desktop/api/Npapi/nf-npapi-npopenenum), [**NPEnumResource**](/windows/desktop/api/Npapi/nf-npapi-npenumresource)y [**NPCloseEnum**](/windows/desktop/api/Npapi/nf-npapi-npcloseenum).</span><span class="sxs-lookup"><span data-stu-id="9b1a9-113">The exception is that if you support one of the following enumeration functions, you must support the other two functions as well: [**NPOpenEnum**](/windows/desktop/api/Npapi/nf-npapi-npopenenum), [**NPEnumResource**](/windows/desktop/api/Npapi/nf-npapi-npenumresource), and [**NPCloseEnum**](/windows/desktop/api/Npapi/nf-npapi-npcloseenum).</span></span>

<span data-ttu-id="9b1a9-114">Las instrucciones siguientes describen cómo escribir un proveedor de red que interactúe bien con el MPR y el sistema operativo Windows.</span><span class="sxs-lookup"><span data-stu-id="9b1a9-114">The following guidelines describe how to write a network provider that interacts well with the MPR and the Windows operating system.</span></span> <span data-ttu-id="9b1a9-115">Siempre que sea posible, el proveedor debe cumplir las siguientes directrices para la velocidad, la validación y el enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="9b1a9-115">Whenever possible, your provider should adhere to the following guidelines for speed, validation, and routing.</span></span>

## <a name="speed"></a><span data-ttu-id="9b1a9-116">Velocidad</span><span class="sxs-lookup"><span data-stu-id="9b1a9-116">Speed</span></span>

<span data-ttu-id="9b1a9-117">Un proveedor de red debe determinar rápidamente si un recurso de red es el suyo propio.</span><span class="sxs-lookup"><span data-stu-id="9b1a9-117">A network provider should quickly determine whether a network resource is its own.</span></span> <span data-ttu-id="9b1a9-118">Esto se debe a que es posible que el MPR tenga que recorrer muchos proveedores para encontrar el propietario de un recurso.</span><span class="sxs-lookup"><span data-stu-id="9b1a9-118">This is because the MPR may have to cycle through many providers to find the owner of a resource.</span></span>

<span data-ttu-id="9b1a9-119">Si el proveedor de red no posee el recurso, debe devolver de inmediato el código de estado de red de red incorrecta de WN \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="9b1a9-119">If the network provider does not own the resource, it should immediately return the WN\_BAD\_NETNAME status code.</span></span>

<span data-ttu-id="9b1a9-120">También es importante que los proveedores que admiten [**NPGetDirectoryType**](/windows/desktop/api/Npapi/nf-npapi-npgetdirectorytype) devuelvan los resultados de esta función rápidamente porque se llama mientras WinFile está pintando el árbol de directorios.</span><span class="sxs-lookup"><span data-stu-id="9b1a9-120">It is also important that providers that support [**NPGetDirectoryType**](/windows/desktop/api/Npapi/nf-npapi-npgetdirectorytype) return results for this function quickly because it is called while WinFile is painting the directory tree.</span></span>

## <a name="validation"></a><span data-ttu-id="9b1a9-121">Validación</span><span class="sxs-lookup"><span data-stu-id="9b1a9-121">Validation</span></span>

<span data-ttu-id="9b1a9-122">El orden de validación es importante.</span><span class="sxs-lookup"><span data-stu-id="9b1a9-122">The order of validation is important.</span></span> <span data-ttu-id="9b1a9-123">Un proveedor de red debe determinar primero si se ha iniciado su red y, a continuación, determinar si la red y el proveedor de red admiten la operación.</span><span class="sxs-lookup"><span data-stu-id="9b1a9-123">A network provider should first determine whether its network is started and then determine whether the network and network provider support the operation.</span></span> <span data-ttu-id="9b1a9-124">Si, después de estas comprobaciones, el proveedor de red recibe los recursos de red, debe determinar si es propietario de ellos.</span><span class="sxs-lookup"><span data-stu-id="9b1a9-124">If, after these checks, the network provider receives any network resources, it should determine whether it owns them.</span></span> <span data-ttu-id="9b1a9-125">Por último, debe validar otros parámetros.</span><span class="sxs-lookup"><span data-stu-id="9b1a9-125">Finally, it should validate other parameters.</span></span>

## <a name="routing"></a><span data-ttu-id="9b1a9-126">Enrutamiento</span><span class="sxs-lookup"><span data-stu-id="9b1a9-126">Routing</span></span>

<span data-ttu-id="9b1a9-127">Si el MPR tiene que recorrer los proveedores de red, probará todos los proveedores hasta que uno acepte la llamada.</span><span class="sxs-lookup"><span data-stu-id="9b1a9-127">If the MPR has to cycle through network providers, it will try all providers until one accepts the call.</span></span> <span data-ttu-id="9b1a9-128">En otras palabras, el MPR siempre continúa intentando encontrar un proveedor de red.</span><span class="sxs-lookup"><span data-stu-id="9b1a9-128">In other words, the MPR always continues to try to find a network provider.</span></span>

<span data-ttu-id="9b1a9-129">Sin embargo, toma nota del primer error significativo informado por un proveedor.</span><span class="sxs-lookup"><span data-stu-id="9b1a9-129">It does, however, take note of the first significant error reported by a provider.</span></span> <span data-ttu-id="9b1a9-130">Errores como ERROR \_ NETPATH erróneo \_ , error de \_ \_ nombre de red, error de \_ \_ parámetro no válido. el nivel de \_ error \_ no válido \_ se considera insignificante porque simplemente significa que el proveedor no administra el recurso.</span><span class="sxs-lookup"><span data-stu-id="9b1a9-130">Errors such as ERROR\_BAD\_NETPATH, ERROR\_BAD\_NET\_NAME, ERROR\_INVALID\_PARAMETER, ERROR\_INVALID\_LEVEL are considered insignificant because they simply mean that the provider does not manage the resource.</span></span> <span data-ttu-id="9b1a9-131">Sin embargo, si se produce un error en el proveedor con el error \_ contraseña no válida \_ o algún otro error significativo, MPR registra este error y continúa el ciclo de los proveedores de red.</span><span class="sxs-lookup"><span data-stu-id="9b1a9-131">However, if the provider fails with the error ERROR\_INVALID\_PASSWORD or some other significant error, MPR records this error and continues cycling through the network providers.</span></span> <span data-ttu-id="9b1a9-132">En general, cuando se realiza el enrutamiento, si ningún proveedor acepta la llamada, el MPR informa del primer error significativo que encuentra al recorrer los proveedores de red.</span><span class="sxs-lookup"><span data-stu-id="9b1a9-132">In general, when routing, if no provider accepts the call, the MPR reports the first significant error it encounters while cycling through the network providers.</span></span>

<span data-ttu-id="9b1a9-133">El proveedor de red debe tener en cuenta este comportamiento del MPR al decidir qué mensaje de error devolver.</span><span class="sxs-lookup"><span data-stu-id="9b1a9-133">Your network provider should take this behavior of the MPR into account when deciding what error message to return.</span></span>

## <a name="implementation-note"></a><span data-ttu-id="9b1a9-134">Nota de implementación</span><span class="sxs-lookup"><span data-stu-id="9b1a9-134">Implementation note</span></span>

<span data-ttu-id="9b1a9-135">Al implementar las DLL de proveedor de red, el proveedor no debe llamar a otras [funciones de red de Windows](../wnet/windows-networking-functions.md), API de [Shell](../shell/samples-usingthumbnailproviders.md)u otras consultas basadas en rutas de acceso UNC que podrían provocar la reentrada en el subsistema de mpr.</span><span class="sxs-lookup"><span data-stu-id="9b1a9-135">When implementing Network Provider DLL’s, the provider must not call into other [Windows Networking Functions](../wnet/windows-networking-functions.md), [Shell APIs](../shell/samples-usingthumbnailproviders.md), or other UNC path-based queries that could cause reentry into the MPR subsystem.</span></span> <span data-ttu-id="9b1a9-136">Si realiza este tipo de llamadas desde una DLL de proveedor de red, la aplicación u otros componentes del sistema operativo pueden experimentar contención, un bajo rendimiento o interbloqueos dentro del subsistema de MPR.</span><span class="sxs-lookup"><span data-stu-id="9b1a9-136">If you make such calls from a Network Provider DLL, the application, or other operating system components may experience contention, poor performance, or deadlocks inside the MPR subsystem.</span></span>

 

 
