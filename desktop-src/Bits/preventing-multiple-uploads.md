---
title: Impedir varias cargas
description: Cuando se carga un archivo, BITS crea un identificador de sesión que identifica la sesión de carga en el cliente BITS y el servidor BITS.
ms.assetid: 97283f8e-d2fa-4383-9b92-a05f46680443
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ae59bb1d605af7e4dd53b0c1d66618b6816e7886
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/16/2019
ms.locfileid: "104075171"
---
# <a name="preventing-multiple-uploads"></a><span data-ttu-id="eeb5a-103">Impedir varias cargas</span><span class="sxs-lookup"><span data-stu-id="eeb5a-103">Preventing Multiple Uploads</span></span>

<span data-ttu-id="eeb5a-104">Cuando se carga un archivo, BITS crea un identificador de sesión que identifica la sesión de carga en el cliente BITS y el servidor BITS.</span><span class="sxs-lookup"><span data-stu-id="eeb5a-104">When you upload a file, BITS creates a session ID that identifies the upload session to both the BITS client and BITS server.</span></span> <span data-ttu-id="eeb5a-105">Si la conexión entre el cliente BITS y el servidor se interrumpe mientras BITS carga un archivo, el cliente usará el ID. de sesión para intentar reanudar la carga.</span><span class="sxs-lookup"><span data-stu-id="eeb5a-105">If the connection between the BITS client and server is broken while BITS is uploading a file, the client will use the session ID to try to resume the upload.</span></span>

<span data-ttu-id="eeb5a-106">Si el cliente de BITS se conecta al mismo servidor que antes, el servidor reconocerá el identificador de sesión y la carga se reanudará desde el punto de interrupción.</span><span class="sxs-lookup"><span data-stu-id="eeb5a-106">If the BITS client connects to the same server as before, the server will recognize the session ID and the upload will resume from the point of interruption.</span></span> <span data-ttu-id="eeb5a-107">Sin embargo, si el cliente se conecta a un servidor diferente, el cliente debe iniciar la carga desde el principio porque el nuevo servidor no tiene el contexto de la sesión o los datos cargados previamente.</span><span class="sxs-lookup"><span data-stu-id="eeb5a-107">However, if the client connects to a different server, the client must start the upload from the beginning because the new server does not have the session context or the previously uploaded data.</span></span> <span data-ttu-id="eeb5a-108">BITS puede conectarse a un servidor diferente cuando el servidor BITS está hospedado en una granja de servidores web y la propiedad de extensión de IIS de BITS, [BITSHostId](bits-iis-extension-properties.md), no está establecida.</span><span class="sxs-lookup"><span data-stu-id="eeb5a-108">BITS may connect to a different server when the BITS server is hosted on a web farm and the BITS IIS extension property, [BITSHostId](bits-iis-extension-properties.md), is not set.</span></span> <span data-ttu-id="eeb5a-109">La propiedad BITSHostId evita los reinicios forzando al cliente de BITS a conectarse a la dirección única del servidor anterior en lugar de a la dirección del servidor compartido.</span><span class="sxs-lookup"><span data-stu-id="eeb5a-109">The BITSHostId property prevents restarts by forcing the BITS client to connect to the previous server's unique address instead of the shared server address.</span></span>

<span data-ttu-id="eeb5a-110">El servidor BITS intentará enviar el archivo de carga una sola vez a la aplicación de servidor, pero es posible que el archivo se envíe más de una vez.</span><span class="sxs-lookup"><span data-stu-id="eeb5a-110">The BITS server will attempt to send the upload file only once to the server application, but it is possible that the file may be sent more than one time.</span></span> <span data-ttu-id="eeb5a-111">Esto puede ocurrir, por ejemplo, si el servidor BITS envía el archivo a la aplicación de servidor y, a continuación, finaliza mientras se espera la respuesta de la aplicación de servidor.</span><span class="sxs-lookup"><span data-stu-id="eeb5a-111">This can occur, for example, if the BITS server sends the file to the server application and then terminates while waiting for the reply from the server application.</span></span> <span data-ttu-id="eeb5a-112">El cliente de BITS recibirá un código de error de la capa HTTP y volverá a intentar la carga después de un retraso.</span><span class="sxs-lookup"><span data-stu-id="eeb5a-112">The BITS client will receive an error code from the HTTP layer, and retry the upload after a delay.</span></span> <span data-ttu-id="eeb5a-113">Si el servidor permanece sin conexión durante más tiempo que el tiempo de espera de [BITSHostIdFallbackTimeout](bits-iis-extension-properties.md) , el cliente volverá a enviar la solicitud a la dirección del servidor compartido; un servidor BITS distinto recibirá el archivo y lo entregará de nuevo a la aplicación de servidor.</span><span class="sxs-lookup"><span data-stu-id="eeb5a-113">If the server stays offline for longer than the [BITSHostIdFallbackTimeout](bits-iis-extension-properties.md) timeout, then the client will eventually send the request to the shared server address again; a different BITS server will receive the file and deliver it again to the server application.</span></span>

<span data-ttu-id="eeb5a-114">Un caso similar puede producirse incluso con un solo servidor front-end.</span><span class="sxs-lookup"><span data-stu-id="eeb5a-114">A similar case can occur even with a single front-end server.</span></span> <span data-ttu-id="eeb5a-115">Por ejemplo, cuando el cliente ha cargado el archivo completo en el servidor, el bloque final hace que el servidor reenvíe el archivo a la aplicación de servidor.</span><span class="sxs-lookup"><span data-stu-id="eeb5a-115">For example, when the client has uploaded the entire file to the server, the final block causes the server to forward the file to the server application.</span></span> <span data-ttu-id="eeb5a-116">Si el servidor BITS o la aplicación de servidor terminan después de procesarse el archivo, pero antes de que se envíe la confirmación al cliente, el cliente recibirá un código de error y volverá a intentarlo más tarde.</span><span class="sxs-lookup"><span data-stu-id="eeb5a-116">If the BITS server or the server application terminate after the file is processed but before the acknowledgment is sent to the client, then the client will receive an error code and retry later.</span></span> <span data-ttu-id="eeb5a-117">Cuando el cliente vuelva a intentarlo, el servidor BITS verá que se ha cargado el bloque final y volverá a enviar el archivo a la aplicación de servidor.</span><span class="sxs-lookup"><span data-stu-id="eeb5a-117">When the client retries, the BITS server will see that the final block has been uploaded, and it will again forward the file to the server application.</span></span> <span data-ttu-id="eeb5a-118">Si recibir el archivo de carga varias veces es un problema para su aplicación de servidor, considere la posibilidad de incluir un identificador de transacción en los datos.</span><span class="sxs-lookup"><span data-stu-id="eeb5a-118">If receiving the upload file multiple times is an issue for your server application, you should consider including a transaction identifier in the data.</span></span>

 

 




