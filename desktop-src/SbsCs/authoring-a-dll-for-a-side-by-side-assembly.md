---
description: Al crear sus propios ensamblados en paralelo, siga las instrucciones para crear ensamblados en paralelo.
ms.assetid: e5fc3bae-0646-4418-a8f7-369856f03cd5
title: Crear archivos DLL para ensamblados en paralelo
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aa15f3876c60ce55be00d60d8f417eb0c2cbf6ec
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "104277353"
---
# <a name="authoring-dlls-for-side-by-side-assemblies"></a><span data-ttu-id="bfc51-103">Crear archivos DLL para ensamblados en paralelo</span><span class="sxs-lookup"><span data-stu-id="bfc51-103">Authoring DLLs for Side-by-side Assemblies</span></span>

<span data-ttu-id="bfc51-104">Al crear sus propios ensamblados en paralelo, siga las [directrices para crear ensamblados en paralelo](guidelines-for-creating-side-by-side-assemblies.md) y crear cualquier dll que se use en el ensamblado según las siguientes directrices:</span><span class="sxs-lookup"><span data-stu-id="bfc51-104">When creating your own side-by-side assemblies, follow the [Guidelines for Creating Side-by-side Assemblies](guidelines-for-creating-side-by-side-assemblies.md) and author any DLLs used in the assembly according to the following guidelines:</span></span>

-   <span data-ttu-id="bfc51-105">Los archivos dll deben diseñarse de modo que se puedan ejecutar varias versiones al mismo tiempo y en el mismo proceso sin interferir entre sí.</span><span class="sxs-lookup"><span data-stu-id="bfc51-105">Your DLLs should be designed so that multiple versions can run at the same time and in the same process without interfering with each other.</span></span> <span data-ttu-id="bfc51-106">Por ejemplo, muchas aplicaciones hospedan varios complementos, cada uno de los cuales requiere una versión diferente de un componente.</span><span class="sxs-lookup"><span data-stu-id="bfc51-106">For example, many applications host multiple plug-ins that each require a different version of one component.</span></span> <span data-ttu-id="bfc51-107">El desarrollador debe diseñar y probar el ensamblado en paralelo para asegurarse de que varias versiones del componente funcionan correctamente cuando se ejecutan al mismo tiempo en el mismo proceso.</span><span class="sxs-lookup"><span data-stu-id="bfc51-107">The developer the side-by-side assembly needs to design and test to ensure that multiple versions of the component work correctly when run at the same time in the same process.</span></span>

-   <span data-ttu-id="bfc51-108">Si tiene previsto proporcionar el componente como componente compartido en sistemas anteriores a Windows XP, debe continuar instalando el componente en estos sistemas como un componente compartido de una sola instancia.</span><span class="sxs-lookup"><span data-stu-id="bfc51-108">If you plan to provide your component as a shared component on systems earlier than Windows XP, you need to continue to install the component on these systems as a single-instance shared component.</span></span> <span data-ttu-id="bfc51-109">En este caso, debe asegurarse de que el componente sea compatible con versiones anteriores.</span><span class="sxs-lookup"><span data-stu-id="bfc51-109">In this case, you need to ensure your component is backward compatible.</span></span>

-   <span data-ttu-id="bfc51-110">Evalúe el uso de objetos cuando se ejecute más de una versión del ensamblado en el sistema.</span><span class="sxs-lookup"><span data-stu-id="bfc51-110">Evaluate the use of objects when more than one version of your assembly is run on the system.</span></span> <span data-ttu-id="bfc51-111">Determine si las distintas versiones del ensamblado requieren estructuras de datos independientes, como archivos asignados a memoria, canalizaciones con nombre, mensajes y clases de Windows registrados, memoria compartida, semáforos, exclusiones mutuas y controladores de hardware.</span><span class="sxs-lookup"><span data-stu-id="bfc51-111">Determine whether different versions of the assembly require separate data structures, such as memory-mapped files, named pipes, registered Windows messages and classes, shared memory, semaphores, mutexes, and hardware drivers.</span></span> <span data-ttu-id="bfc51-112">Todas las estructuras de datos utilizadas en las versiones de ensamblado deben ser compatibles con versiones anteriores.</span><span class="sxs-lookup"><span data-stu-id="bfc51-112">Any data structures used across assembly versions must be backward-compatible.</span></span> <span data-ttu-id="bfc51-113">Decida qué estructuras de datos se pueden usar en las versiones y qué estructuras de datos deben ser privadas para una versión.</span><span class="sxs-lookup"><span data-stu-id="bfc51-113">Decide which data structures can be used across versions, and which data structures must be private to a version.</span></span> <span data-ttu-id="bfc51-114">Determine si las estructuras de datos compartidas requieren objetos de sincronización independientes, como semáforos y exclusiones mutuas.</span><span class="sxs-lookup"><span data-stu-id="bfc51-114">Determine whether shared data structures require separate synchronization objects, such as semaphores and mutexes.</span></span>

-   <span data-ttu-id="bfc51-115">Algunos objetos, como las clases de ventana y los átomos, tienen un nombre único para cada proceso.</span><span class="sxs-lookup"><span data-stu-id="bfc51-115">Some objects, such as window classes and Atoms, are uniquely named for each process.</span></span> <span data-ttu-id="bfc51-116">Los objetos como las clases de ventana deben tener versiones para cada ensamblado mediante el manifiesto.</span><span class="sxs-lookup"><span data-stu-id="bfc51-116">Objects such as window classes should be versioned for each assembly using the manifest.</span></span> <span data-ttu-id="bfc51-117">Para objetos como átomos, use identificadores específicos de la versión a menos que planee compartir entre versiones.</span><span class="sxs-lookup"><span data-stu-id="bfc51-117">For objects such as Atoms, use version-specific identifiers unless you plan to share across versions.</span></span> <span data-ttu-id="bfc51-118">Si usa identificadores específicos de la versión, use el número de versión de cuatro partes.</span><span class="sxs-lookup"><span data-stu-id="bfc51-118">If you use version-specific identifiers, use the four-part versioning number.</span></span>

-   <span data-ttu-id="bfc51-119">No incluya código de registro automático en ningún archivo DLL.</span><span class="sxs-lookup"><span data-stu-id="bfc51-119">Include no self-registering code in any DLL.</span></span> <span data-ttu-id="bfc51-120">Un archivo DLL de un ensamblado en paralelo no se puede registrar automáticamente.</span><span class="sxs-lookup"><span data-stu-id="bfc51-120">A DLL in a side-by-side assembly cannot be self-registering.</span></span>

-   <span data-ttu-id="bfc51-121">Defina todos los nombres específicos de la versión en el archivo DLL con \# instrucciones de definición.</span><span class="sxs-lookup"><span data-stu-id="bfc51-121">Define all version-specific names in your DLL with \#define statements.</span></span> <span data-ttu-id="bfc51-122">Esto permite cambiar todas las claves del registro de una ubicación.</span><span class="sxs-lookup"><span data-stu-id="bfc51-122">This enables all registry keys to be changed from one location.</span></span> <span data-ttu-id="bfc51-123">Al liberar una nueva versión del ensamblado, solo tiene que cambiar esta instrucción de \# definición.</span><span class="sxs-lookup"><span data-stu-id="bfc51-123">When you release a new version of your assembly, you only need to change this \#define statement.</span></span> <span data-ttu-id="bfc51-124">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="bfc51-124">For example:</span></span>

    `#define MyRegistryKey "MyAssembly1.0.0.0"`

-   <span data-ttu-id="bfc51-125">Almacene los datos no persistentes en el directorio temporal.</span><span class="sxs-lookup"><span data-stu-id="bfc51-125">Store any nonpersistent data in the Temp directory.</span></span>

-   <span data-ttu-id="bfc51-126">No coloque los datos de usuario en ubicaciones globales.</span><span class="sxs-lookup"><span data-stu-id="bfc51-126">Do not put user data into global locations.</span></span> <span data-ttu-id="bfc51-127">Mantenga los datos de la aplicación separados de los datos del usuario.</span><span class="sxs-lookup"><span data-stu-id="bfc51-127">Keep application data separate from user data.</span></span>

-   <span data-ttu-id="bfc51-128">Asigne a todos los archivos compartidos una versión de archivo que dependa del nombre de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="bfc51-128">Assign all shared files a file version that depends upon the application's name.</span></span>

-   <span data-ttu-id="bfc51-129">Asigne a todos los mensajes y estructuras de datos usados en los procesos una versión para evitar el uso compartido de procesos cruzados involuntariamente.</span><span class="sxs-lookup"><span data-stu-id="bfc51-129">Assign all messages and data structures used across processes a version to prevent unintentional cross-process sharing.</span></span>

-   <span data-ttu-id="bfc51-130">El archivo DLL no debe depender del uso compartido entre versiones que pueden no existir, como las secciones de memoria compartida que no se comparten entre las distintas versiones del ensamblado.</span><span class="sxs-lookup"><span data-stu-id="bfc51-130">Your DLL should not depend upon sharing across versions that may not exist, such as shared memory sections that are not shared across different versions of your assembly.</span></span>

-   <span data-ttu-id="bfc51-131">Si agrega una nueva funcionalidad que no sigue el contrato de compatibilidad de la interfaz binaria de la DLL original, debe asignar un nuevo CLSID, ProgId y nombre de archivo.</span><span class="sxs-lookup"><span data-stu-id="bfc51-131">If you add new functionality that does not follow the binary interface compatibility contract of the original DLL, you must assign a new CLSID, ProgId, and file name.</span></span> <span data-ttu-id="bfc51-132">Después, es necesario que las versiones futuras del ensamblado en paralelo utilicen este CLSID, ProgId y el nombre de archivo.</span><span class="sxs-lookup"><span data-stu-id="bfc51-132">Future versions of your side-by-side assembly is then required to use this CLSID, ProgId, and file name.</span></span> <span data-ttu-id="bfc51-133">Esto evita un conflicto cuando una versión de la DLL que no está en paralelo se registra en una versión en paralelo.</span><span class="sxs-lookup"><span data-stu-id="bfc51-133">This prevents a conflict when a version of the DLL that is not side-by-side is registered over a side-by-side version.</span></span>

-   <span data-ttu-id="bfc51-134">Si reutiliza el mismo CLSID o ProgId, pruebe a asegurarse de que el ensamblado es compatible con versiones anteriores.</span><span class="sxs-lookup"><span data-stu-id="bfc51-134">If you reuse the same CLSID or ProgId, test to ensure that the assembly is backward compatible.</span></span>

-   <span data-ttu-id="bfc51-135">Inicialice y establezca la configuración predeterminada para el ensamblado en el código de ensamblado.</span><span class="sxs-lookup"><span data-stu-id="bfc51-135">Initialize and set the default settings for the assembly in the assembly code.</span></span> <span data-ttu-id="bfc51-136">No guarde los valores predeterminados en el registro.</span><span class="sxs-lookup"><span data-stu-id="bfc51-136">Do not save the defaults settings in the registry.</span></span>

-   <span data-ttu-id="bfc51-137">Asignar versiones a todas las estructuras de datos.</span><span class="sxs-lookup"><span data-stu-id="bfc51-137">Assign versions to all data structures.</span></span>

-   <span data-ttu-id="bfc51-138">El archivo DLL debe almacenar el estado del ensamblado en paralelo, tal y como se describe en [creación de almacenamiento de estado para ensamblados en paralelo](authoring-state-storage-for-side-by-side-assemblies.md).</span><span class="sxs-lookup"><span data-stu-id="bfc51-138">Your DLL should store the state of the side-by-side assembly as described in [Authoring State Storage for Side-by-Side Assemblies](authoring-state-storage-for-side-by-side-assemblies.md).</span></span>

 

 



