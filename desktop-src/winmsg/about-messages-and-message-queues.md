---
description: En esta sección se describen los mensajes y las colas de mensajes de Windows.
ms.assetid: 21a4d40b-52da-49e4-a374-afc4927e96e8
title: Acerca de los mensajes y las colas de mensajes
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7f0bcf68dbacaae868de3aea1fdc4a5d11290821
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "105669872"
---
# <a name="about-messages-and-message-queues"></a>Acerca de los mensajes y las colas de mensajes

A diferencia de las aplicaciones basadas en MS-DOS, las aplicaciones basadas en Windows están orientadas a eventos. No realizan llamadas explícitas a funciones (como llamadas a la biblioteca en tiempo de ejecución de C) para obtener entradas. En su lugar, esperan a que el sistema pase la entrada a ellos.

El sistema pasa todas las entradas de una aplicación a las distintas ventanas de la aplicación. Cada ventana tiene una función, denominada procedimiento de ventana, a la que el sistema llama cuando tiene entrada para la ventana. El procedimiento de ventana procesa la entrada y devuelve el control al sistema. Para obtener más información acerca de los procedimientos de ventana, vea [procedimientos de ventana](window-procedures.md).

Si una ventana de nivel superior deja de responder a los mensajes durante más de unos segundos, el sistema considera que la ventana no responde. En este caso, el sistema oculta la ventana y la reemplaza por una ventana fantasma que tiene el mismo orden Z, ubicación, tamaño y atributos visuales. Esto permite al usuario moverla, cambiar su tamaño o incluso cerrar la aplicación. Sin embargo, estas son las únicas acciones disponibles porque la aplicación realmente no responde. En el modo de depurador, el sistema no genera una ventana fantasma.

En esta sección se tratan los temas siguientes:

-   [Mensajes de Windows](#windows-messages)
-   [Tipos de mensajes](#message-types)
    -   [Mensajes definidos por el sistema](#system-defined-messages)
    -   [Mensajes definidos por la aplicación](#application-defined-messages)
-   [Enrutamiento de mensajes](#message-routing)
    -   [Mensajes en cola](#queued-messages)
    -   [Mensajes no en cola](#nonqueued-messages)
-   [Control de mensajes](#message-handling)
    -   [Bucle de mensajes](#message-loop)
    -   [Procedimiento de ventana](#window-procedure)
-   [Filtrado de mensajes](#message-filtering)
-   [Publicación y envío de mensajes](#posting-and-sending-messages)
    -   [Publicar mensajes](#posting-messages)
    -   [Envío de mensajes](#sending-messages)
-   [Interbloqueos de mensajes](#message-deadlocks)
-   [Difundir mensajes](#broadcasting-messages)
-   [Consultar mensajes](#query-messages)

## <a name="windows-messages"></a>Mensajes de Windows

El sistema pasa la entrada a un procedimiento de ventana en forma de *mensaje*. Los mensajes son generados por el sistema y las aplicaciones. El sistema genera un mensaje en cada evento de entrada, por ejemplo, cuando el usuario escribe, mueve el mouse o hace clic en un control, como una barra de desplazamiento. El sistema también genera mensajes en respuesta a los cambios en el sistema que ha generado una aplicación, por ejemplo, cuando una aplicación cambia el grupo de recursos de fuentes del sistema o cambia el tamaño de una de sus ventanas. Una aplicación puede generar mensajes para dirigir sus propias ventanas para realizar tareas o para comunicarse con Windows en otras aplicaciones.

El sistema envía un mensaje a un procedimiento de ventana con un conjunto de cuatro parámetros: un identificador de ventana, un identificador de mensaje y dos valores denominados *parámetros de mensaje*. El *identificador de ventana* identifica la ventana a la que está destinado el mensaje. El sistema la usa para determinar el procedimiento de ventana que debe recibir el mensaje.

Un *identificador de mensaje* es una constante con nombre que identifica el propósito de un mensaje. Cuando un procedimiento de ventana recibe un mensaje, usa un identificador de mensaje para determinar cómo procesar el mensaje. Por ejemplo, el identificador de mensaje [**WM \_ Paint**](/windows/desktop/gdi/wm-paint) indica al procedimiento de ventana que el área cliente de la ventana ha cambiado y se debe volver a dibujar.

Los parámetros de mensaje especifican datos o la ubicación de los datos utilizados por un procedimiento de ventana al procesar un mensaje. El significado y el valor de los parámetros del mensaje dependen del mensaje. Un parámetro de mensaje puede contener un entero, marcas de bits empaquetadas, un puntero a una estructura que contiene datos adicionales, etc. Cuando un mensaje no usa parámetros de mensaje, normalmente se establece en **null**. Un procedimiento de ventana debe comprobar el identificador de mensaje para determinar cómo interpretar los parámetros de mensaje.

## <a name="message-types"></a>Tipos de mensajes

En esta sección se describen los dos tipos de mensajes:

-   [Mensajes definidos por el sistema](#system-defined-messages)
-   [Mensajes definidos por la aplicación](#application-defined-messages)

### <a name="system-defined-messages"></a>Mensajes de System-Defined

El sistema envía o envía un *mensaje definido por el sistema* cuando se comunica con una aplicación. Utiliza estos mensajes para controlar las operaciones de las aplicaciones y proporcionar información de entrada y otra información para que las aplicaciones las procesen. Una aplicación también puede enviar o exponer mensajes definidos por el sistema. Normalmente, las aplicaciones usan estos mensajes para controlar el funcionamiento de las ventanas de control creadas mediante el uso de clases de ventana previamente registradas.

Cada mensaje definido por el sistema tiene un identificador de mensaje único y una constante simbólica correspondiente (definida en los archivos de encabezado del kit de desarrollo de software (SDK)) que indica el propósito del mensaje. Por ejemplo, la [**constante \_ Paint de WM**](/windows/desktop/gdi/wm-paint) solicita que una ventana pinte su contenido.

Las constantes simbólicas especifican la categoría a la que pertenecen los mensajes definidos por el sistema. El prefijo de la constante identifica el tipo de ventana que puede interpretar y procesar el mensaje. A continuación se muestran los prefijos y sus categorías de mensajes relacionadas.



| Prefijo                               | Categoría de mensaje             | Documentación                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|--------------------------------------|------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **ABN** y **ABN**                  | Barra de herramientas del escritorio de la aplicación  | [Notificaciones y mensajes de Shell](/windows/desktop/shell/control-panel-applications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **ACM** y **ACN**                  | Animation (control)            | [Mensajes de control de animación](/windows/desktop/Controls/bumper-animation-control-reference-messages) y [notificaciones de control de animación](/windows/desktop/Controls/bumper-animation-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **BCM**, **BCN**, **BM** y **BN** | Button (control)               | [Mensajes de control de botón](/windows/desktop/Controls/bumper-button-control-reference-messages) y [notificaciones de control de botón](/windows/desktop/Controls/bumper-button-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **CB** y **CBN**                   | ComboBox (control)             | [Mensajes del control ComboBox](/windows/desktop/Controls/bumper-combobox-control-reference-messages) y [notificaciones del control ComboBox](/windows/desktop/Controls/bumper-combobox-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **CBEM** y **CBEN**                | Control ComboBoxEx           | [Mensajes de ComboBoxEx](/windows/desktop/Controls/bumper-comboboxex-control-reference-messages) y [notificaciones de ComboBoxEx](/windows/desktop/Controls/bumper-comboboxex-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **MCC**                              | Control general              | [Mensajes de control](/windows/desktop/Controls/bumper-general-control-reference-messages)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **CDM**                              | Cuadro de diálogo común            | [Mensajes comunes de cuadros de diálogo](/windows/desktop/dlgbox/common-dialog-box-messages)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **DFM**                              | Menú contextual predeterminado         | [Notificaciones y mensajes de Shell](/windows/desktop/shell/control-panel-applications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **DL**                               | Arrastrar cuadro de lista                | [Arrastrar notificaciones de cuadro de lista](/previous-versions//ff485914(v=vs.85))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **DM**                               | Control de botón de preinstalación predeterminado  | [Mensajes de cuadro de diálogo](/windows/desktop/dlgbox/dialog-box-messages)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **DTM** y **DTN**                  | Control de selector de fecha y hora | [Mensajes del selector de fecha y hora](/windows/desktop/Controls/bumper-date-and-time-picker-control-reference-messages) y [notificaciones de selector de fecha y hora](/windows/desktop/Controls/bumper-date-and-time-picker-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **Em** y **en**                    | Edit (control)                 | [Editar mensajes de control](/windows/desktop/Controls/bumper-edit-control-reference-messages), [Editar notificaciones de control](/windows/desktop/Controls/bumper-edit-control-reference-notifications), mensajes de [edición enriquecida](/windows/desktop/Controls/bumper-rich-edit-control-reference-messages)y [notificaciones de edición enriquecidas](/windows/desktop/Controls/bumper-rich-edit-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **HDM** y **HDN**                  | Control de encabezado               | [Mensajes de control de encabezado](/windows/desktop/Controls/bumper-header-control-reference-messages) y [notificaciones del control de encabezado](/windows/desktop/Controls/bumper-header-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **HKM**                              | Control de tecla de acceso rápido              | [Mensajes de control de teclas de acceso rápido](/windows/desktop/Controls/bumper-hot-key-control-reference-messages)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **IPM** y **IPN**                  | control de dirección IP           | [Mensajes de dirección](/windows/desktop/Controls/bumper-ip-address-control-reference-messages) IP y [notificaciones de direcciones IP](/windows/desktop/Controls/bumper-ip-address-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **Lb** y **LBN**                   | Control de cuadro de lista             | [Mensajes de cuadro de lista](/windows/desktop/Controls/bumper-list-box-control-reference-messages) y [notificaciones de cuadro de lista](/windows/desktop/Controls/bumper-list-box-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **NTLM**                               | SysLink (control)              | [Mensajes del control SysLink](/windows/desktop/Controls/bumper-syslink-control-reference-messages)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **LVM** y **LVN**                  | Control de vista de lista            | [Lista de mensajes](/windows/desktop/Controls/bumper-list-view-control-reference-messages) y [notificaciones de vista de lista](/windows/desktop/Controls/bumper-list-view-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **MCM** y **MCN**                  | Month Calendar (control)       | [Mensajes de calendario mensual](/windows/desktop/Controls/bumper-month-calendar-control-reference-messages) y [notificaciones de calendario mensual](/windows/desktop/Controls/bumper-month-calendar-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **PBM**                              | Barra de progreso                 | [Mensajes de la barra de progreso](/windows/desktop/Controls/bumper-progress-bar-control-reference-messages)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **PGM** y **PGN**                  | Control de paginación                | [Mensajes de control de buscapersonas](/windows/desktop/Controls/bumper-pager-control-reference-messages) y [notificaciones de control de buscapersonas](/windows/desktop/Controls/bumper-pager-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **PSM** y **PSN**                  | Hoja de propiedades               | [Mensajes](/windows/desktop/Controls/bumper-property-sheets-reference-messages) de la hoja de propiedades y [notificaciones](/windows/desktop/Controls/bumper-property-sheets-reference-notifications) de la hoja de propiedades                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **RB** y **RBN**                   | Rebar (control)                | [Mensajes de control rebar](/windows/desktop/Controls/bumper-rebar-control-reference-messages) y [notificaciones del control rebar](/windows/desktop/Controls/bumper-rebar-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **SB** y **SBN**                   | Ventana de la barra de estado            | [Mensajes](/windows/desktop/Controls/bumper-status-bars-reference-messages) de la barra de estado y [notificaciones](/windows/desktop/Controls/bumper-status-bars-reference-notifications) de la barra de estado                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **SBM**                              | Scroll Bar (control)           | [Mensajes de la barra de desplazamiento](/windows/desktop/Controls/bumper-scroll-bars-reference-messages)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **ETHERPOWER**                              | Menú Shell                   | [Notificaciones y mensajes de Shell](/windows/desktop/shell/control-panel-applications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **STM** y **STN**                  | Control estático               | [Mensajes de control estático](/windows/desktop/Controls/bumper-static-control-reference-messages) y [notificaciones de control estático](/windows/desktop/Controls/bumper-static-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **TB** y **TBN**                   | Barra de herramientas                      | [Mensajes de control de barra de herramientas](/windows/desktop/Controls/bumper-toolbar-control-reference-messages) y [notificaciones del control Toolbar](/windows/desktop/Controls/bumper-toolbar-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **TBM** y **TRBN**                 | TrackBar (control)             | [Notificaciones](/windows/desktop/Controls/bumper-trackbar-control-reference-notifications) del control TrackBar y [messages](/windows/desktop/Controls/bumper-trackbar-control-reference-messages)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **TCM** y **TCN**                  | Control Tab                  | [Mensajes de control de pestaña](/windows/desktop/Controls/bumper-tab-control-reference-messages) y [notificaciones de control de pestaña](/windows/desktop/Controls/bumper-tab-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **TDM** y **TDN**                  | Cuadro de diálogo tarea                  | [Mensajes del cuadro de diálogo de tareas](/windows/desktop/Controls/bumper-task-dialogs-reference-messages) y [notificaciones de diálogo de tareas](/windows/desktop/Controls/bumper-task-dialogs-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **TTM** y **TTN**                  | Control ToolTip              | [Mensajes de control de información sobre herramientas](/windows/desktop/Controls/bumper-tooltip-control-reference-messages) y [notificaciones de control ToolTip](/windows/desktop/Controls/bumper-tooltip-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **TVM** y **TVN**                  | Control de vista de árbol            | [Mensajes de vista de árbol](/windows/desktop/Controls/bumper-tree-view-control-reference-messages) y [notificaciones de vista de árbol](/windows/desktop/Controls/bumper-tree-view-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **UDM** y **UDN**                  | Control de flechas              | [Mensajes de flechas arriba](/windows/desktop/Controls/bumper-up-down-control-reference-messages) y [abajo](/windows/desktop/Controls/bumper-up-down-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **WM**                               | General                      | <dl> <dt>[Mensajes del portapapeles](/windows/desktop/dataxchg/clipboard-messages)</dt> <dt>[cuadro de diálogo](/windows/desktop/dlgbox/common-dialog-box-notifications)</dt> de <dt>[notificaciones de Portapapeles](/windows/desktop/dataxchg/clipboard-notifications)</dt> notificaciones de <dt>[cursor](/windows/desktop/menurc/cursor-notifications)</dt> mensajes de copia de <dt>[datos](/windows/desktop/dataxchg/wm-copydata)</dt> mensajes de <dt>[Administrador de ventanas de escritorio mensajes de](/windows/desktop/dwm/dwm-messages)</dt> <dt>[Administración de dispositivos](/windows/desktop/DevIO/device-management-messages)</dt> <dt>[notificaciones](/windows/desktop/dlgbox/dialog-box-notifications)</dt> <dt>[](/windows/desktop/Controls/bumper-scroll-bars-reference-notifications)</dt> de mensajes <dt>[intercambio dinámico de datos mensajes](/windows/desktop/dataxchg/dynamic-data-exchange-messages)</dt> <dt>[intercambio dinámico de datos](/windows/desktop/dataxchg/dynamic-data-exchange-notifications)</dt> notificaciones <dt>[enlazar](hook-notifications.md)</dt> notificaciones de aceleradores <dt>[](multiple-document-interface-messages.md)</dt> <dt>[de teclado](/windows/desktop/menurc/keyboard-accelerator-messages)</dt> <dt>[notificaciones](/windows/desktop/menurc/keyboard-accelerator-notifications)</dt> de teclado <dt>[de entrada](/windows/desktop/inputdev/raw-input-notifications)</dt> <dt>[de teclado](/windows/desktop/inputdev/keyboard-input-notifications)</dt> <dt>[mensajes](/windows/desktop/inputdev/keyboard-input-messages)</dt> de <dt>[la ventana de](timer-notifications.md)</dt> notificaciones de entrada de <dt>[mouse](/windows/desktop/inputdev/mouse-input-notifications)</dt> <dt>[notificaciones](/windows/desktop/menurc/menu-notifications)</dt> de la <dt>[ventana](window-notifications.md)</dt> <dt>[mensajes](window-messages.md)</dt> </dl> |



 

Los mensajes de ventana generales cubren una amplia gama de información y solicitudes, incluidos los mensajes de entrada de mouse y teclado, la entrada del menú y del cuadro de diálogo, la creación y administración de ventanas y el Intercambio dinámico de datos (DDE).

### <a name="application-defined-messages"></a>Mensajes de Application-Defined

Una aplicación puede crear mensajes para su uso por sus propias ventanas o para comunicarse con Windows en otros procesos. Si una aplicación crea sus propios mensajes, el procedimiento de ventana que los recibe debe interpretar los mensajes y proporcionar el procesamiento adecuado.

Los valores del identificador de mensaje se utilizan de la siguiente manera:

-   El sistema reserva los valores del identificador de mensaje en el intervalo de 0x0000 a 0x03FF (el valor de [**WM \_ User**](wm-user.md)  -1) para los mensajes definidos por el sistema. Las aplicaciones no pueden usar estos valores para los mensajes privados.
-   Los valores del intervalo 0x0400 (el valor de [**\_ usuario de WM**](wm-user.md)) a través de 0x7FFF están disponibles para los identificadores de mensaje de las clases de ventana privadas.
-   Si la aplicación está marcada como versión 4,0, puede usar valores de identificador de mensaje en el intervalo 0x8000 ([**\_ aplicación de WM**](wm-app.md)) a través de 0xBFFF para mensajes privados.
-   El sistema devuelve un identificador de mensaje en el intervalo de 0xC000 a 0xFFFF cuando una aplicación llama a la función [**RegisterWindowMessage**](/windows/win32/api/winuser/nf-winuser-registerwindowmessagea) para registrar un mensaje. Se garantiza que el identificador de mensaje devuelto por esta función es único en todo el sistema. El uso de esta función evita conflictos que pueden surgir si otras aplicaciones usan el mismo identificador de mensaje para propósitos diferentes.

## <a name="message-routing"></a>Enrutamiento de mensajes

El sistema utiliza dos métodos para enrutar los mensajes a un procedimiento de ventana: enviar mensajes a una cola de primero en salir, denominada *cola* de mensajes, un objeto de memoria definido por el sistema que almacena temporalmente los mensajes y enviar mensajes directamente a un procedimiento de ventana.

Los mensajes que se envían a una cola de mensajes se denominan *mensajes en cola*. Estos son principalmente el resultado de la entrada del usuario especificada mediante el mouse o el teclado, como los mensajes [**WM \_ MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove), [**WM \_ LBUTTONDOWN**](/windows/desktop/inputdev/wm-lbuttondown), [**WM \_ KEYDOWN**](/windows/desktop/inputdev/wm-keydown)y [**WM \_ Char**](/windows/desktop/inputdev/wm-char) . Otros mensajes en cola incluyen los mensajes Timer, Paint y Quit: [**\_ Timer de WM**](wm-timer.md), [**WM \_ Paint**](/windows/desktop/gdi/wm-paint)y [**WM \_ Quit**](wm-quit.md). La mayoría de los demás mensajes, que se envían directamente a un procedimiento de ventana, se denominan *mensajes no en cola*.

-   [Mensajes en cola](#queued-messages)
-   [Mensajes no en cola](#nonqueued-messages)

### <a name="queued-messages"></a>Mensajes en cola

El sistema puede mostrar cualquier número de ventanas a la vez. Para enrutar la entrada del mouse y del teclado a la ventana adecuada, el sistema utiliza las colas de mensajes.

El sistema mantiene una única cola de mensajes del sistema y una cola de mensajes específica del subproceso para cada subproceso de la GUI. Para evitar la sobrecarga de crear una cola de mensajes para los subprocesos que no son de GUI, todos los subprocesos se crean Inicialmente sin una cola de mensajes. El sistema crea una cola de mensajes específica del subproceso solo cuando el subproceso realiza su primera llamada a una de las funciones de usuario específicas; ninguna llamada a la función GUI produce la creación de una cola de mensajes.

Cada vez que el usuario mueve el mouse, hace clic en los botones del mouse o los tipos del teclado, el controlador del dispositivo del mouse o el teclado convierte la entrada en mensajes y los coloca en la cola de mensajes del sistema. El sistema quita los mensajes, de uno en uno, de la cola de mensajes del sistema, los examina para determinar la ventana de destino y, a continuación, los envía a la cola de mensajes del subproceso que creó la ventana de destino. La cola de mensajes de un subproceso recibe todos los mensajes del mouse y del teclado para las ventanas creadas por el subproceso. El subproceso quita los mensajes de su cola y dirige al sistema para que los envíe al procedimiento de ventana adecuado para su procesamiento.

A excepción del mensaje de [**\_ Paint de WM**](/windows/desktop/gdi/wm-paint) , el mensaje del [**\_ temporizador de WM**](wm-timer.md) y el mensaje de [**\_ salida de WM**](wm-quit.md) , el sistema siempre envía mensajes al final de una cola de mensajes. Esto garantiza que una ventana reciba los mensajes de entrada en la primera secuencia correcta, primero en salir (FIFO). Sin embargo, el mensaje de **\_ dibujo** de WM, el mensaje del **\_ temporizador de WM** y el mensaje de **\_ salida de WM** se mantienen en la cola y se reenvían al procedimiento de ventana solo cuando la cola no contiene ningún otro mensaje. Además, varios mensajes **de \_ pintura de WM** para la misma ventana se combinan en un solo mensaje de **\_ dibujo de WM** , consolidando todas las partes no válidas del área de cliente en una sola área. La combinación de mensajes de **WM \_ Paint** reduce el número de veces que una ventana debe volver a dibujar el contenido de su área de cliente.

El sistema envía un mensaje a la cola de mensajes de un subproceso rellenando una estructura [**MSG**](/windows/win32/api/winuser/ns-winuser-msg) y, a continuación, copiándolo en la cola de mensajes. La información incluida en **MSG** incluye: el identificador de la ventana para la que se ha diseñado el mensaje, el identificador de mensaje, los dos parámetros de mensaje, la hora a la que se expuso el mensaje y la posición del cursor del mouse. Un subproceso puede publicar un mensaje en su propia cola de mensajes o en la cola de otro subproceso mediante la función [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) o [**PostThreadMessage**](/windows/win32/api/winuser/nf-winuser-postthreadmessagea) .

Una aplicación puede quitar un mensaje de su cola mediante la función [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) . Para examinar un mensaje sin quitarlo de su cola, una aplicación puede usar la función [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) . Esta función rellena [**MSG**](/windows/win32/api/winuser/ns-winuser-msg) con información sobre el mensaje.

Después de quitar un mensaje de la cola, una aplicación puede usar la función [**DispatchMessage**](/windows/win32/api/winuser/nf-winuser-dispatchmessage) para indicar al sistema que envíe el mensaje a un procedimiento de ventana para su procesamiento. **DispatchMessage** toma un puntero al [**mensaje**](/windows/win32/api/winuser/ns-winuser-msg) que se rellenó con una llamada anterior a la función [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) o [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) . **DispatchMessage** pasa el identificador de ventana, el identificador de mensaje y los dos parámetros de mensaje al procedimiento de ventana, pero no pasa la hora en que se envió el mensaje o la posición del cursor del mouse. Una aplicación puede recuperar esta información llamando a las funciones [**GetMessageTime**](/windows/win32/api/winuser/nf-winuser-getmessagetime) y [**GetMessagePos**](/windows/win32/api/winuser/nf-winuser-getmessagepos) al procesar un mensaje.

Un subproceso puede utilizar la función [**WaitMessage**](/windows/win32/api/winuser/nf-winuser-waitmessage) para producir el control en otros subprocesos cuando no tiene ningún mensaje en la cola de mensajes. La función suspende el subproceso y no devuelve ningún resultado hasta que se coloca un nuevo mensaje en la cola de mensajes del subproceso.

Puede llamar a la función [**SetMessageExtraInfo**](/windows/win32/api/winuser/nf-winuser-setmessageextrainfo) para asociar un valor a la cola de mensajes del subproceso actual. A continuación, llame a la función [**GetMessageExtraInfo**](/windows/win32/api/winuser/nf-winuser-getmessageextrainfo) para obtener el valor asociado al último mensaje recuperado por la función [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) o [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) .

### <a name="nonqueued-messages"></a>Mensajes no en cola

Los mensajes no en cola se envían inmediatamente al procedimiento de ventana de destino, omitiendo la cola de mensajes del sistema y la cola de mensajes del subproceso. Normalmente, el sistema envía mensajes no en cola para notificar a una ventana de eventos que lo afectan. Por ejemplo, cuando el usuario activa una nueva ventana de la aplicación, el sistema envía a la ventana una serie de mensajes, entre los que se incluyen [**WM \_ Activar**](/windows/desktop/inputdev/wm-activate), [**WM \_ SETFOCUS**](/windows/desktop/inputdev/wm-setfocus)y [**WM \_ SETCURSOR**](/windows/desktop/menurc/wm-setcursor). Estos mensajes notifican a la ventana que se ha activado, que la entrada de teclado se dirige a la ventana y que el cursor del mouse se ha despasado dentro de los bordes de la ventana. Los mensajes no en cola también pueden producirse cuando una aplicación llama a determinadas funciones del sistema. Por ejemplo, el sistema envía el mensaje de [**WM \_ WINDOWPOSCHANGED**](wm-windowposchanged.md) después de que una aplicación utilice la función [**SetWindowPos**](/windows/win32/api/winuser/nf-winuser-setwindowpos) para desplace una ventana.

Algunas funciones que envían mensajes no en cola son [**BroadcastSystemMessage**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessage), [**BroadcastSystemMessageEx**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessageexa), [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage), [**SendMessageTimeout**](/windows/win32/api/winuser/nf-winuser-sendmessagetimeouta)y [**SendNotifyMessage**](/windows/win32/api/winuser/nf-winuser-sendnotifymessagea).

## <a name="message-handling"></a>Tratamiento de mensajes

Una aplicación debe quitar y procesar los mensajes enviados a las colas de mensajes de sus subprocesos. Normalmente, una aplicación de un solo subproceso usa un *bucle de mensajes* en su función [**WinMain**](/windows/win32/api/winbase/nf-winbase-winmain) para quitar y enviar mensajes a los procedimientos de ventana adecuados para su procesamiento. Las aplicaciones con varios subprocesos pueden incluir un bucle de mensajes en cada subproceso que crea una ventana. En las secciones siguientes se describe cómo funciona un bucle de mensajes y se explica el rol de un procedimiento de ventana:

-   [Bucle de mensajes](#message-loop)
-   [Procedimiento de ventana](#window-procedure)

### <a name="message-loop"></a>Bucle de mensajes

Un bucle de mensajes simple se compone de una llamada de función a cada una de estas tres funciones: [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage), [**TranslateMessage**](/windows/win32/api/winuser/nf-winuser-translatemessage)y [**DispatchMessage**](/windows/win32/api/winuser/nf-winuser-dispatchmessage). Tenga en cuenta que si se produce un error, **GetMessage** devuelve – 1, por lo tanto, la necesidad de las pruebas especiales.


```
MSG msg;
BOOL bRet;

while( (bRet = GetMessage( &msg, NULL, 0, 0 )) != 0)
{ 
    if (bRet == -1)
    {
        // handle the error and possibly exit
    }
    else
    {
        TranslateMessage(&msg); 
        DispatchMessage(&msg); 
    }
}
```



La función [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) recupera un mensaje de la cola y lo copia en una estructura de tipo [**MSG**](/windows/win32/api/winuser/ns-winuser-msg). Devuelve un valor distinto de cero, a menos que encuentre el mensaje [**de \_ salida de WM**](wm-quit.md) , en cuyo caso devuelve **false** y finaliza el bucle. En una aplicación de un solo subproceso, el final del bucle de mensajes suele ser el primer paso para cerrar la aplicación. Una aplicación puede finalizar su propio bucle mediante la función [**PostQuitMessage**](/windows/win32/api/winuser/nf-winuser-postquitmessage) , normalmente en respuesta al mensaje de [**\_ destrucción de WM**](wm-destroy.md) en el procedimiento de ventana de la ventana principal de la aplicación.

Si especifica un identificador de ventana como segundo parámetro de [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage), solo se recuperarán de la cola los mensajes de la ventana especificada. **GetMessage** también puede filtrar los mensajes de la cola, recuperando solo los mensajes que se encuentran dentro de un intervalo especificado. Para obtener más información sobre el filtrado de mensajes, vea [filtrado de mensajes](#message-filtering).

El bucle de mensajes de un subproceso debe incluir [**TranslateMessage**](/windows/win32/api/winuser/nf-winuser-translatemessage) si el subproceso va a recibir la entrada de caracteres del teclado. El sistema genera mensajes de clave virtual ([**WM \_ KEYDOWN**](/windows/desktop/inputdev/wm-keydown) y [**WM \_ KEYUP**](/windows/desktop/inputdev/wm-keyup)) cada vez que el usuario presiona una tecla. Un mensaje de clave virtual contiene un código de tecla virtual que identifica la tecla que se presionó, pero no su valor de carácter. Para recuperar este valor, el bucle de mensajes debe contener **TranslateMessage**, que convierte el mensaje de clave virtual en un mensaje de carácter ([**WM \_ Char**](/windows/desktop/inputdev/wm-char)) y lo vuelve a colocar en la cola de mensajes de aplicación. A continuación, se puede quitar el mensaje de carácter en una iteración posterior del bucle de mensajes y enviarse a un procedimiento de ventana.

La función [**DispatchMessage**](/windows/win32/api/winuser/nf-winuser-dispatchmessage) envía un mensaje al procedimiento de ventana asociado al identificador de ventana especificado en la estructura [**MSG**](/windows/win32/api/winuser/ns-winuser-msg) . Si el identificador de ventana es **hWnd \_ superior**, **DispatchMessage** envía el mensaje a los procedimientos de ventana de todas las ventanas de nivel superior del sistema. Si el identificador de ventana es **null**, **DispatchMessage** no hace nada con el mensaje.

El subproceso principal de una aplicación inicia su bucle de mensajes después de inicializar la aplicación y crear al menos una ventana. Una vez iniciado, el bucle de mensajes continúa recuperando mensajes de la cola de mensajes del subproceso y enviándolos a las ventanas adecuadas. El bucle de mensajes finaliza cuando la función [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) quita el mensaje de [**\_ salida de WM**](wm-quit.md) de la cola de mensajes.

Solo se necesita un bucle de mensajes para una cola de mensajes, aunque una aplicación contenga muchas ventanas. [**DispatchMessage**](/windows/win32/api/winuser/nf-winuser-dispatchmessage) siempre envía el mensaje a la ventana adecuada; Esto se debe a que cada mensaje de la cola es una estructura [**MSG**](/windows/win32/api/winuser/ns-winuser-msg) que contiene el identificador de la ventana a la que pertenece el mensaje.

Puede modificar un bucle de mensajes de varias maneras. Por ejemplo, puede recuperar mensajes de la cola sin enviarlos a una ventana. Esto resulta útil para las aplicaciones que envían mensajes que no especifican una ventana. También puede dirigir [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) para buscar mensajes específicos, y mantener otros mensajes en la cola. Esto resulta útil si debe omitir temporalmente el orden FIFO habitual de la cola de mensajes.

Una aplicación que usa teclas de aceleración debe poder traducir los mensajes del teclado en mensajes de comandos. Para ello, el bucle de mensajes de la aplicación debe incluir una llamada a la función [**TranslateAccelerator**](/windows/desktop/api/winuser/nf-winuser-translateacceleratora) . Para obtener más información sobre las teclas de aceleración, consulte [aceleradores de teclado](/windows/desktop/menurc/keyboard-accelerators).

Si un subproceso usa un cuadro de diálogo no modal, el bucle de mensajes debe incluir la función [**IsDialogMessage**](/windows/desktop/api/winuser/nf-winuser-isdialogmessagea) para que el cuadro de diálogo pueda recibir entradas del teclado.

### <a name="window-procedure"></a>Procedimiento de ventana

Un procedimiento de ventana es una función que recibe y procesa todos los mensajes enviados a la ventana. Cada clase de ventana tiene un procedimiento de ventana y cada ventana creada con esa clase usa ese mismo procedimiento de ventana para responder a los mensajes.

El sistema envía un mensaje a un procedimiento de ventana pasando los datos del mensaje como argumentos al procedimiento. A continuación, el procedimiento de ventana realiza una acción adecuada para el mensaje; comprueba el identificador del mensaje y, durante el procesamiento del mensaje, usa la información especificada por los parámetros del mensaje.

Un procedimiento de ventana no suele omitir un mensaje. Si no procesa un mensaje, debe devolver el mensaje al sistema para su procesamiento predeterminado. Para ello, el procedimiento de ventana llama a la función [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) , que realiza una acción predeterminada y devuelve el resultado de un mensaje. El procedimiento de ventana debe devolver este valor como su propio resultado de mensaje. La mayoría de los procedimientos de ventana procesan solo unos pocos mensajes y pasan los demás al sistema llamando a **DefWindowProc**.

Dado que todas las ventanas que pertenecen a la misma clase comparten un procedimiento de ventana, puede procesar mensajes para varias ventanas diferentes. Para identificar la ventana específica afectada por el mensaje, un procedimiento de ventana puede examinar el identificador de ventana que se pasa con un mensaje. Para obtener más información acerca de los procedimientos de ventana, vea [procedimientos de ventana](window-procedures.md).

## <a name="message-filtering"></a>Filtrado de mensajes

Una aplicación puede elegir mensajes específicos para recuperarlos de la cola de mensajes (mientras se omiten otros mensajes) mediante la función [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) o [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) para especificar un filtro de mensajes. El filtro es un intervalo de identificadores de mensaje (especificado por un primer y último identificador), un identificador de ventana o ambos. **GetMessage** y **PeekMessage** usan un filtro de mensajes para seleccionar los mensajes que se van a recuperar de la cola. El filtrado de mensajes es útil si una aplicación debe buscar en la cola de mensajes los mensajes que han llegado posteriormente en la cola. También es útil si una aplicación debe procesar los mensajes de entrada (hardware) antes de procesar los mensajes publicados.

Las constantes de **WM \_ KEYFIRST** y **WM \_ KEYLAST** se pueden usar como valores de filtro para recuperar todos los mensajes del teclado; las constantes de **WM \_ MOUSEFIRST** y **WM \_ MOUSELAST** se pueden usar para recuperar todos los mensajes del mouse.

Cualquier aplicación que filtre mensajes debe asegurarse de que se puede publicar un mensaje que cumpla el filtro de mensajes. Por ejemplo, si una aplicación filtra un mensaje de un [**\_ carácter de WM**](/windows/desktop/inputdev/wm-char) en una ventana que no recibe la entrada del teclado, la función [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) no devuelve. Esto "bloquea" la aplicación.

## <a name="posting-and-sending-messages"></a>Publicación y envío de mensajes

Cualquier aplicación puede publicar y enviar mensajes. Al igual que el sistema, una aplicación envía un mensaje copiándolo en una cola de mensajes y envía un mensaje pasando los datos del mensaje como argumentos a un procedimiento de ventana. Para publicar mensajes, una aplicación utiliza la función [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) . Una aplicación puede enviar un mensaje mediante una llamada a la función [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage), [**BroadcastSystemMessage**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessage), [**SendMessageCallback**](/windows/win32/api/winuser/nf-winuser-sendmessagecallbacka), [**SendMessageTimeout**](/windows/win32/api/winuser/nf-winuser-sendmessagetimeouta), [**SendNotifyMessage**](/windows/win32/api/winuser/nf-winuser-sendnotifymessagea)o [**SendDlgItemMessage**](/windows/desktop/api/winuser/nf-winuser-senddlgitemmessagea) .

### <a name="posting-messages"></a>Publicar mensajes

Normalmente, una aplicación envía un mensaje para notificar a una ventana específica que realice una tarea. [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) crea una estructura [**MSG**](/windows/win32/api/winuser/ns-winuser-msg) para el mensaje y copia el mensaje en la cola de mensajes. El bucle de mensajes de la aplicación recupera finalmente el mensaje y lo envía al procedimiento de ventana adecuado.

Una aplicación puede publicar un mensaje sin especificar una ventana. Si la aplicación proporciona un identificador de ventana **nulo** al llamar a [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea), el mensaje se envía a la cola asociada al subproceso actual. Dado que no se especifica ningún identificador de ventana, la aplicación debe procesar el mensaje en el bucle de mensajes. Se trata de una manera de crear un mensaje que se aplica a toda la aplicación, en lugar de a una ventana específica.

En ocasiones, es posible que desee publicar un mensaje en todas las ventanas de nivel superior del sistema. Una aplicación puede publicar un mensaje en todas las ventanas de nivel superior llamando a [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) y especificando el **nivel de HWND \_ más alto** en el parámetro *hWnd* .

Un error de programación común es suponer que la función [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) siempre envía un mensaje. Esto no es cierto cuando la cola de mensajes está llena. Una aplicación debe comprobar el valor devuelto de la función **PostMessage** para determinar si el mensaje se ha publicado y, si no lo ha hecho, volver a publicarlo.

### <a name="sending-messages"></a>enviar mensajes

Normalmente, una aplicación envía un mensaje para notificar a un procedimiento de ventana que realice una tarea inmediatamente. La función [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) envía el mensaje al procedimiento de ventana correspondiente a la ventana especificada. La función espera hasta que el procedimiento de ventana completa el procesamiento y, a continuación, devuelve el resultado del mensaje. Las ventanas primaria y secundaria suelen comunicarse mediante el envío de mensajes entre sí. Por ejemplo, una ventana primaria que tenga un control de edición como su ventana secundaria puede establecer el texto del control mediante el envío de un mensaje a ella. El control puede notificar a la ventana primaria los cambios realizados por el usuario mediante el envío de mensajes de vuelta al elemento primario.

La función [**SendMessageCallback**](/windows/win32/api/winuser/nf-winuser-sendmessagecallbacka) también envía un mensaje al procedimiento de ventana correspondiente a la ventana especificada. Sin embargo, esta función vuelve inmediatamente. Una vez que el procedimiento de ventana procesa el mensaje, el sistema llama a la función de devolución de llamada especificada. Para obtener más información sobre la función de devolución de llamada, vea la función [**SendAsyncProc**](/windows/win32/api/winuser/nc-winuser-sendasyncproc) .

En ocasiones, es posible que desee enviar un mensaje a todas las ventanas de nivel superior del sistema. Por ejemplo, si la aplicación cambia la hora del sistema, debe notificar a todas las ventanas de nivel superior sobre el cambio mediante el envío de un mensaje de [**\_ TIMECHANGE de WM**](../sysinfo/wm-timechange.md) . Una aplicación puede enviar un mensaje a todas las ventanas de nivel superior llamando a [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) y especificando el **nivel de HWND \_ más alto** en el parámetro *hWnd* . También puede difundir un mensaje a todas las aplicaciones mediante una llamada a la función [**BroadcastSystemMessage**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessage) y especificando **\_ aplicaciones de BSM** en el parámetro *lpdwRecipients* .

Mediante el uso de la función [**InSendMessage**](/windows/win32/api/winuser/nf-winuser-insendmessage) o [**InSendMessageEx**](/windows/win32/api/winuser/nf-winuser-insendmessageex) , un procedimiento de ventana puede determinar si está procesando un mensaje enviado por otro subproceso. Esta capacidad es útil cuando el procesamiento de mensajes depende del origen del mensaje.

## <a name="message-deadlocks"></a>Interbloqueos de mensajes

Un subproceso que llama a la función [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) para enviar un mensaje a otro subproceso no puede continuar ejecutándose hasta que el procedimiento de ventana que recibe el mensaje vuelva. Si el subproceso receptor cede el control mientras procesa el mensaje, el subproceso de envío no puede continuar ejecutándose porque está esperando a que se devuelva **SendMessage** . Si el subproceso receptor está asociado a la misma cola que el remitente, puede provocar que se produzca un interbloqueo de la aplicación. (Tenga en cuenta que los enlaces de Journal asocian los subprocesos a la misma cola).

Tenga en cuenta que el subproceso receptor no necesita proporcionar el control explícitamente. la llamada a cualquiera de las funciones siguientes puede hacer que un subproceso produzca el control implícitamente.

-   [**DialogBox**](/windows/desktop/api/winuser/nf-winuser-dialogboxa)
-   [**DialogBoxIndirect**](/windows/desktop/api/winuser/nf-winuser-dialogboxindirecta)
-   [**DialogBoxIndirectParam**](/windows/desktop/api/winuser/nf-winuser-dialogboxindirectparama)
-   [**DialogBoxParam**](/windows/desktop/api/winuser/nf-winuser-dialogboxparama)
-   [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage)
-   [**Cuadro de mensajes**](/windows/desktop/api/winuser/nf-winuser-messagebox)
-   [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea)
-   [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage)

Para evitar posibles interbloqueos en la aplicación, considere la posibilidad de usar las funciones [**SendNotifyMessage**](/windows/win32/api/winuser/nf-winuser-sendnotifymessagea) o [**SendMessageTimeout**](/windows/win32/api/winuser/nf-winuser-sendmessagetimeouta) . De lo contrario, un procedimiento de ventana puede determinar si un mensaje recibido fue enviado por otro subproceso llamando a la función [**InSendMessage**](/windows/win32/api/winuser/nf-winuser-insendmessage) o [**InSendMessageEx**](/windows/win32/api/winuser/nf-winuser-insendmessageex) . Antes de llamar a cualquiera de las funciones de la lista anterior mientras se procesaba un mensaje, el procedimiento de ventana debe llamar primero a **InSendMessage** o **InSendMessageEx**. Si esta función devuelve **true**, el procedimiento de ventana debe llamar a la función [**ReplyMessage**](/windows/win32/api/winuser/nf-winuser-replymessage) antes de cualquier función que haga que el subproceso produzca el control.

## <a name="broadcasting-messages"></a>Difundir mensajes

Cada mensaje consta de un identificador de mensaje y dos parámetros, *wParam* e *lParam*. El identificador de mensaje es un valor único que especifica el propósito del mensaje. Los parámetros proporcionan información adicional que es específica del mensaje, pero el parámetro *wParam* suele ser un valor de tipo que proporciona más información sobre el mensaje.

Una *difusión de mensajes* es simplemente el envío de un mensaje a varios destinatarios del sistema. Para difundir un mensaje desde una aplicación, utilice la función [**BroadcastSystemMessage**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessage) , especificando los destinatarios del mensaje. En lugar de especificar destinatarios individuales, debe especificar uno o más tipos de destinatarios. Estos tipos son aplicaciones, controladores instalables, controladores de red y controladores de dispositivos de nivel de sistema. El sistema envía mensajes de difusión a todos los miembros de cada tipo especificado.

Normalmente, el sistema difunde mensajes en respuesta a los cambios que tienen lugar en los controladores de dispositivos de nivel de sistema o en los componentes relacionados. El controlador o el componente relacionado difunde el mensaje a las aplicaciones y otros componentes para notificar el cambio. Por ejemplo, el componente responsable de las unidades de disco difunde un mensaje cada vez que el controlador de dispositivo de la unidad de disquete detecta un cambio de medios, como cuando el usuario inserta un disco en la unidad.

El sistema difunde mensajes a los destinatarios en este orden: Controladores de dispositivos de nivel de sistema, controladores de red, controladores instalables y aplicaciones. Esto significa que los controladores de dispositivos de nivel de sistema, si se eligen como destinatarios, siempre obtienen la primera oportunidad para responder a un mensaje. Dentro de un tipo de destinatario determinado, no se garantiza que ningún controlador reciba un mensaje determinado antes que ningún otro controlador. Esto significa que un mensaje destinado a un controlador específico debe tener un identificador de mensaje único globalmente para que ningún otro controlador lo procese involuntariamente.

También puede difundir mensajes a todas las ventanas de nivel superior especificando la **\_ difusión HWND** en la [**función SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage), [**SendMessageCallback**](/windows/win32/api/winuser/nf-winuser-sendmessagecallbacka), [**SendMessageTimeout**](/windows/win32/api/winuser/nf-winuser-sendmessagetimeouta)o [**SendNotifyMessage**](/windows/win32/api/winuser/nf-winuser-sendnotifymessagea) .

Las aplicaciones reciben mensajes a través del procedimiento de ventana de las ventanas de nivel superior. Los mensajes no se envían a las ventanas secundarias. Los servicios pueden recibir mensajes a través de un procedimiento de ventana o de sus controladores de control de servicio.

> [!Note]  
> Los controladores de dispositivos de nivel de sistema usan una función relacionada de nivel de sistema para difundir mensajes del sistema.

 

## <a name="query-messages"></a>Consultar mensajes

Puede crear sus propios mensajes personalizados y usarlos para coordinar las actividades entre las aplicaciones y otros componentes del sistema. Esto es especialmente útil si ha creado sus propios controladores instalables o controladores de dispositivos de nivel de sistema. Los mensajes personalizados pueden llevar información hacia y desde el controlador y las aplicaciones que usan el controlador.

Para sondear a los destinatarios en busca de permiso para realizar una acción determinada, use un *mensaje de consulta*. Puede generar sus propios mensajes de consulta estableciendo el valor **de \_ consulta BSF** en el parámetro *DwFlags* al llamar a [**BroadcastSystemMessage**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessage). Cada destinatario del mensaje de consulta debe devolver **true** para que la función envíe el mensaje al siguiente destinatario. Si algún destinatario devuelve **la \_ consulta \_ de difusión deny**, la difusión finaliza inmediatamente y la función devuelve un cero.

 

 
