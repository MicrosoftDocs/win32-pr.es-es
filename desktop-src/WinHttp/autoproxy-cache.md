---
description: Caché de AutoProxy
ms.assetid: 087104e8-ab38-4ba4-be70-23a5ea2bb130
title: Caché de AutoProxy
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6d0492bec116bad8a82da0e961cf6d851d27c787
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "105716993"
---
# <a name="autoproxy-cache"></a><span data-ttu-id="154f6-103">Caché de AutoProxy</span><span class="sxs-lookup"><span data-stu-id="154f6-103">AutoProxy Cache</span></span>

<span data-ttu-id="154f6-104">La función [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) realiza la búsqueda de proxy automática en función de la solicitud de la dirección URL especificada.</span><span class="sxs-lookup"><span data-stu-id="154f6-104">The [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) function performs autoproxy lookup on a per-request basis for the specified URL.</span></span> <span data-ttu-id="154f6-105">Si se devuelven varios servidores proxy, las aplicaciones cliente deben probar cada proxy antes de enviar la solicitud (para obtener más información, vea la sección [solo se admite un servidor proxy](autoproxy-issues-in-winhttp.md) en problemas de AutoProxy en WinHTTP).</span><span class="sxs-lookup"><span data-stu-id="154f6-105">If multiple proxies are returned, client applications should test each proxy before sending the request (for more information, see the [Only One Proxy Server is Currently Supported](autoproxy-issues-in-winhttp.md) section in AutoProxy Issues in WinHTTP).</span></span> <span data-ttu-id="154f6-106">La información de este tema se aplica a las llamadas a **WinHttpGetProxyForUrl** cuando el cliente especifica la detección automática del proxy.</span><span class="sxs-lookup"><span data-stu-id="154f6-106">The information in this topic applies to calls to **WinHttpGetProxyForUrl** when the client specifies automatic proxy discovery.</span></span>

<span data-ttu-id="154f6-107">[**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) , opcionalmente, localiza la dirección URL de AutoProxy y descarga el script de AutoProxy de ese sitio.</span><span class="sxs-lookup"><span data-stu-id="154f6-107">[**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) optionally locates the autoproxy URL and downloads the autoproxy script from that site.</span></span> <span data-ttu-id="154f6-108">WinHttp usa el script de AutoProxy para ubicar los servidores proxy.</span><span class="sxs-lookup"><span data-stu-id="154f6-108">WinHttp uses the autoproxy script to locate the proxy servers.</span></span> <span data-ttu-id="154f6-109">Tanto la dirección URL de AutoProxy como el script de AutoProxy se almacenan en caché para la sesión especificada.</span><span class="sxs-lookup"><span data-stu-id="154f6-109">Both the autoproxy URL and the autoproxy script are cached for the specified session.</span></span> <span data-ttu-id="154f6-110">Solo se almacenan en caché una dirección URL y un script de AutoProxy para cada sesión.</span><span class="sxs-lookup"><span data-stu-id="154f6-110">Only one autoproxy URL and script are cached for each session.</span></span> <span data-ttu-id="154f6-111">Normalmente, el script y la dirección URL de AutoProxy se almacenan en caché hasta que cambia la dirección IP asociada al equipo.</span><span class="sxs-lookup"><span data-stu-id="154f6-111">Typically, the autoproxy script and URL are cached until the IP address associated with the computer changes.</span></span> <span data-ttu-id="154f6-112">Si se detecta una nueva dirección IP durante una llamada a **WinHttpGetProxyForUrl**, la llamada intentará localizar una nueva dirección URL de proxy AutoProxy y el script y almacenar en caché los resultados.</span><span class="sxs-lookup"><span data-stu-id="154f6-112">If a new IP address is detected during a call to **WinHttpGetProxyForUrl**, the call will attempt to locate a new autoproxy URL and script and cache the results.</span></span> <span data-ttu-id="154f6-113">Solo se debe permitir un usuario por sesión, de modo que los datos almacenados en caché no se compartan con otros usuarios del equipo.</span><span class="sxs-lookup"><span data-stu-id="154f6-113">Only one user should be allowed per session, so that the cached data is not shared with other users on the computer.</span></span> <span data-ttu-id="154f6-114">Para obtener más información, vea [información general sobre las sesiones de WinHTTP](winhttp-sessions-overview.md).</span><span class="sxs-lookup"><span data-stu-id="154f6-114">For more information, see [WinHTTP Sessions Overview](winhttp-sessions-overview.md).</span></span>

<span data-ttu-id="154f6-115">Si el servicio fuera de proceso está activo cuando se llama a [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) , el script y la dirección URL de proxy automático almacenados en caché estarán disponibles para todo el equipo.</span><span class="sxs-lookup"><span data-stu-id="154f6-115">If the out-of-process service is active when [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) is called, the cached autoproxy URL and script are available to the whole computer.</span></span> <span data-ttu-id="154f6-116">Sin embargo, si se usa el servicio fuera de proceso y la marca **fAutoLogonIfChallenged** en la estructura *pAutoProxyOptions* es true, el script y la dirección URL de AutoProxy no se almacenan en caché.</span><span class="sxs-lookup"><span data-stu-id="154f6-116">However, if the out-of-process service is used, and the **fAutoLogonIfChallenged** flag in the *pAutoProxyOptions* structure is true, then the autoproxy URL and script are not cached.</span></span> <span data-ttu-id="154f6-117">Por lo tanto, al llamar a **WinHttpGetProxyForUrl** con el miembro **FAutoLogonIfChallenged** establecido en **true** , se producen operaciones de sobrecarga adicionales que pueden afectar al rendimiento.</span><span class="sxs-lookup"><span data-stu-id="154f6-117">Therefore, calling **WinHttpGetProxyForUrl** with the **fAutoLogonIfChallenged** member set to **TRUE** results in additional overhead operations that may affect performance.</span></span> <span data-ttu-id="154f6-118">Los siguientes pasos se pueden usar para mejorar el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="154f6-118">The following steps can be used to improve performance.</span></span>

<span data-ttu-id="154f6-119">**Para mejorar el rendimiento**</span><span class="sxs-lookup"><span data-stu-id="154f6-119">**To improve performance**</span></span>

1.  <span data-ttu-id="154f6-120">Llame a [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) con el parámetro fAutoLogonIfChallenged establecido en **false**.</span><span class="sxs-lookup"><span data-stu-id="154f6-120">Call [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) with the fAutoLogonIfChallenged parameter set to **false**.</span></span> <span data-ttu-id="154f6-121">La dirección URL y el script de AutoProxy se almacenan en caché para futuras llamadas a **WinHttpGetProxyForUrl**.</span><span class="sxs-lookup"><span data-stu-id="154f6-121">The autoproxy URL and script are cached for future calls to **WinHttpGetProxyForUrl**.</span></span>
2.  <span data-ttu-id="154f6-122">Si se produce un error en el paso 1, con **errores de inicio de sesión de \_ WinHTTP \_ \_**, llame a [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) con el miembro **fAutoLogonIfChallenged** establecido en **true**.</span><span class="sxs-lookup"><span data-stu-id="154f6-122">If Step 1 fails, with **ERROR\_WINHTTP\_LOGIN\_FAILURE**, then call [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) with the **fAutoLogonIfChallenged** member set to **TRUE**.</span></span>

 

 



