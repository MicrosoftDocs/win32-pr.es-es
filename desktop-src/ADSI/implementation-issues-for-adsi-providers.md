---
title: Problemas de implementación para los proveedores ADSI
description: Problemas de implementación para los proveedores ADSI
ms.assetid: 0be772aa-e7d8-4d34-b55a-162abfb0bfd4
ms.tgt_platform: multiple
keywords:
- Problemas de implementación para los proveedores ADSI ADSI
- proveedores ADSI, implementar
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c4c362b04244580e448e7bb7bd78889e66db12fe
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/21/2020
ms.locfileid: "104421420"
---
# <a name="implementation-issues-for-adsi-providers"></a><span data-ttu-id="6b7aa-105">Problemas de implementación para los proveedores ADSI</span><span class="sxs-lookup"><span data-stu-id="6b7aa-105">Implementation Issues for ADSI Providers</span></span>

<span data-ttu-id="6b7aa-106">Para implementar interfaces ADSI, implemente primero la interfaz COM [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject).</span><span class="sxs-lookup"><span data-stu-id="6b7aa-106">To implement ADSI interfaces, first implement the COM interface [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject).</span></span> <span data-ttu-id="6b7aa-107">Al proporcionar esta interfaz como una capa de sobrecarga mínima, proporciona a las aplicaciones cliente el control necesario para obtener acceso a los objetos de directorio directamente desde el directorio en lugar de hacerlo a través de la caché ADSI, lo que optimiza el rendimiento de la red.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-107">By providing this interface as a minimal overhead layer, you supply client applications the control required to access directory objects directly from the directory rather than through the ADSI cache, which optimizes network performance.</span></span> <span data-ttu-id="6b7aa-108">El uso de esta interfaz también proporcionará su propia implementación con la máxima flexibilidad.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-108">Using this interface will also supply your own implementation with the most flexibility.</span></span>

<span data-ttu-id="6b7aa-109">En segundo lugar, implemente las interfaces ADSI fundamentales, [**IADs**](/windows/desktop/api/Iads/nn-iads-iads), [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer), [**IADsCollection**](/windows/desktop/api/Iads/nn-iads-iadscollection)y [**IADsPropertyValue**](/windows/desktop/api/Iads/nn-iads-iadspropertyvalue), [**IADsPropertyEntry**](/windows/desktop/api/Iads/nn-iads-iadspropertyentry), [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist) de caché de propiedades.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-109">Second, implement the fundamental ADSI interfaces, [**IADs**](/windows/desktop/api/Iads/nn-iads-iads), [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer), [**IADsCollection**](/windows/desktop/api/Iads/nn-iads-iadscollection), and the [**IADsPropertyValue**](/windows/desktop/api/Iads/nn-iads-iadspropertyvalue), [**IADsPropertyEntry**](/windows/desktop/api/Iads/nn-iads-iadspropertyentry), [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist) property cache interfaces.</span></span> <span data-ttu-id="6b7aa-110">[**IADsGroup**](/windows/desktop/api/Iads/nn-iads-iadsgroup) y [**IADsMembers**](/windows/desktop/api/Iads/nn-iads-iadsmembers) también son interfaces en la demanda frecuente del software de administración del sistema.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-110">[**IADsGroup**](/windows/desktop/api/Iads/nn-iads-iadsgroup) and [**IADsMembers**](/windows/desktop/api/Iads/nn-iads-iadsmembers) are also interfaces in frequent demand by system administration software.</span></span>

<span data-ttu-id="6b7aa-111">En tercer lugar, implemente las interfaces de administración de esquemas si el servicio de directorio tiene un esquema subyacente: [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass), [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty), [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax).</span><span class="sxs-lookup"><span data-stu-id="6b7aa-111">Third, implement the schema management interfaces if your directory service has an underlying schema: [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass), [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty), [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax).</span></span> <span data-ttu-id="6b7aa-112">Si no hay ningún esquema subyacente, utilice estas interfaces para abstraer las clases y propiedades utilizadas por el servicio de directorio.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-112">If there is no underlying schema, use these interfaces to abstract the classes and properties used by the directory service.</span></span> <span data-ttu-id="6b7aa-113">Los esquemas se pueden usar para publicar las características del servicio de directorio en los clientes ADSI.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-113">Schemas can be used to publish the features of your directory service to ADSI clients.</span></span>

## <a name="collections"></a><span data-ttu-id="6b7aa-114">Colecciones</span><span class="sxs-lookup"><span data-stu-id="6b7aa-114">Collections</span></span>

<span data-ttu-id="6b7aa-115">Los componentes del proveedor ADSI pueden seguir a uno de los tres modelos para almacenar en caché las colecciones durante la enumeración.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-115">ADSI provider components can follow one of three models for caching collections during enumeration.</span></span> <span data-ttu-id="6b7aa-116">La elección de un modelo de almacenamiento en caché determina el comportamiento de ADSI cuando se elimina un objeto de una colección del servicio de directorio subyacente externo a ADSI.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-116">The choice of a caching model determines the behavior of ADSI when an object in a collection is deleted from the underlying directory service external to ADSI.</span></span>

<span data-ttu-id="6b7aa-117">Los modelos de almacenamiento en caché incluyen:</span><span class="sxs-lookup"><span data-stu-id="6b7aa-117">The caching models include:</span></span>

-   <span data-ttu-id="6b7aa-118">Las colecciones se almacenan en caché de antemano.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-118">Collections cached in advance.</span></span> <span data-ttu-id="6b7aa-119">La colección de instancias de objeto se recupera del servicio de directorio subyacente en su totalidad cuando se llama a [**IADsCollection:: get \_ \_ NewEnum**](/windows/desktop/api/Iads/nf-iads-iadscollection-get__newenum) para crear un nuevo objeto de enumerador.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-119">The collection of object instances is retrieved from the underlying directory service in its entirety when [**IADsCollection::get\_\_NewEnum**](/windows/desktop/api/Iads/nf-iads-iadscollection-get__newenum) is called to create a new enumerator object.</span></span> <span data-ttu-id="6b7aa-120">Si el objeto de origen de una instancia de objeto de Active Directory en la colección recuperada se elimina del servicio de directorio subyacente, el cliente no reconoce la eliminación hasta que un objeto [**IADs:: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) o [**IADs:: SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) intente obtener acceso a la colección.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-120">If the source object for an Active Directory object instance in the retrieved collection is deleted from the underlying directory service, the client does not recognize the deletion until a [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) or [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) attempts to access the collection.</span></span>
-   <span data-ttu-id="6b7aa-121">Las colecciones se almacenan en caché incrementalmente.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-121">Collections incrementally cached.</span></span> <span data-ttu-id="6b7aa-122">La colección se recupera del servicio de directorio subyacente de un objeto cada vez cuando se llama a [**IEnumVARIANT:: Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) .</span><span class="sxs-lookup"><span data-stu-id="6b7aa-122">The collection is retrieved from the underlying directory service one object at a time when [**IEnumVARIANT::Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) is called.</span></span> <span data-ttu-id="6b7aa-123">[**IEnumVARIANT:: RESET**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-reset) volverá al principio de la colección en la memoria caché y **IEnumVARIANT:: Next** devolverá los objetos almacenados en caché hasta que se alcance el final de la memoria caché, en cuyo punto se agregarán nuevos objetos desde el almacén subyacente.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-123">[**IEnumVARIANT::Reset**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-reset) will return to the beginning of the collection in the cache and **IEnumVARIANT::Next** will return cached objects until the end of the cache is reached, at which point new objects will be added from the underlying store.</span></span> <span data-ttu-id="6b7aa-124">Cuando una instancia de objeto Active Directory está en la memoria caché, el cliente no conocerá su eliminación desde el servicio de directorio subyacente hasta que un objeto [**IADs:: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) o [**IADs:: SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) intente tener acceso al objeto.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-124">When an Active Directory object instance is in the cache the client will not become aware of its deletion from the underlying directory service until an [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) or [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) attempts to access the object.</span></span>
-   <span data-ttu-id="6b7aa-125">Colecciones no almacenadas en caché.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-125">Collections not cached.</span></span> <span data-ttu-id="6b7aa-126">La colección se recupera del servicio de directorio subyacente de un objeto cada vez cuando se llama a [**IEnumVARIANT:: Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) .</span><span class="sxs-lookup"><span data-stu-id="6b7aa-126">The collection is retrieved from the underlying directory service one object at a time when [**IEnumVARIANT::Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) is called.</span></span> <span data-ttu-id="6b7aa-127">[**IEnumVARIANT:: RESET**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-reset) volverá al principio de la colección en el almacén subyacente.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-127">[**IEnumVARIANT::Reset**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-reset) will return to the beginning of the collection in the underlying store.</span></span> <span data-ttu-id="6b7aa-128">Las operaciones **IEnumVARIANT:: Next** y **IEnumVARIANT:: RESET** no pueden recuperar objetos eliminados, ya que los objetos se recuperan a petición desde el servicio de directorio subyacente.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-128">**IEnumVARIANT::Next** and **IEnumVARIANT::Reset** operations cannot retrieve deleted objects, because the objects are retrieved on-demand from the underlying directory service.</span></span> <span data-ttu-id="6b7aa-129">Solo se almacena en caché el objeto actual; Si se elimina el objeto actual, el cliente no conocerá su eliminación desde el servicio de directorio subyacente hasta que un objeto [**IADs:: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) o [**IADs:: SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) intente tener acceso al objeto.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-129">Only the current object is cached; if the current object is deleted, the client will not become aware of its deletion from the underlying directory service until a [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) or [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) attempts to access the object.</span></span>

<span data-ttu-id="6b7aa-130">Independientemente del modelo de almacenamiento en caché, tenga en cuenta que la enumeración ADSI devuelve Active Directory interfaces de servicio al llamador.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-130">Regardless of the caching model, be aware that ADSI enumeration returns Active Directory service interfaces to the caller.</span></span> <span data-ttu-id="6b7aa-131">Para evitar la sobrecarga de obtener un nuevo puntero de interfaz, las aplicaciones ADSI deben almacenar en caché los punteros de interfaz devueltos para los objetos que se van a manipular.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-131">To avoid the overhead of obtaining a new interface pointer, ADSI applications should cache the returned interface pointers for objects that they intend to manipulate.</span></span> <span data-ttu-id="6b7aa-132">Por ejemplo, una aplicación Visual Basic que enumera un contenedor y rellena un cuadro de lista con nombres puede almacenar en caché los punteros de interfaz asociados a los nombres para su uso posterior.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-132">For example, a Visual Basic application that enumerates a container and populates a list box with names can cache the interface pointers associated with the names for later use.</span></span> <span data-ttu-id="6b7aa-133">Este enfoque proporcionará un mayor rendimiento que el rellenado del cuadro de lista durante la enumeración y la obtención de un nuevo puntero de interfaz cuando el usuario realiza una selección.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-133">This approach will provide greater performance than populating the list box during enumeration and obtaining a new interface pointer when the user makes a selection.</span></span>

## <a name="about-dispatch-ids"></a><span data-ttu-id="6b7aa-134">Acerca de los ID. de envío</span><span class="sxs-lookup"><span data-stu-id="6b7aa-134">About Dispatch IDs</span></span>

<span data-ttu-id="6b7aa-135">[**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) es una interfaz de automatización definida por com para los controladores que no utilizan directamente las interfaces com.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-135">[**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) is an Automation interface defined by COM for controllers that do not use COM interfaces directly.</span></span> <span data-ttu-id="6b7aa-136">El acceso a un objeto a través de **IDispatch** se denomina acceso enlazado a un nombre o enlace en tiempo de ejecución, ya que se produce en tiempo de ejecución ("late") y usa nombres de cadena de propiedades y métodos para resolver referencias ("Name").</span><span class="sxs-lookup"><span data-stu-id="6b7aa-136">Accessing an object through **IDispatch** is called name-bound or late-bound access, because it occurs at run time ("late") and uses string names of properties and methods to resolve references ("name").</span></span> <span data-ttu-id="6b7aa-137">En tiempo de ejecución, los clientes pasan el nombre de cadena de la propiedad o el método que desean llamar en el método [**IDispatch:: GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames)().</span><span class="sxs-lookup"><span data-stu-id="6b7aa-137">At run time, clients pass the string name of the property or method they wish to call into the [**IDispatch::GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames)() method.</span></span> <span data-ttu-id="6b7aa-138">Si la propiedad o el método existen en el objeto, se recupera el identificador de envío (DISPID) de la función correspondiente.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-138">If the property or method exists on the object, the dispatch identifier (dispID) of the corresponding function is retrieved.</span></span> <span data-ttu-id="6b7aa-139">A continuación, se usa el DISPID para ejecutar la función mediante [**IDispatch:: Invoke**](/windows/win32/api/oaidl/nf-oaidl-idispatch-invoke)().</span><span class="sxs-lookup"><span data-stu-id="6b7aa-139">The dispID is then used to execute the function through [**IDispatch::Invoke**](/windows/win32/api/oaidl/nf-oaidl-idispatch-invoke)().</span></span> <span data-ttu-id="6b7aa-140">Con **IDispatch**, las propiedades y los métodos de las interfaces expuestas por un solo objeto aparecen como una lista plana.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-140">Using **IDispatch**, properties and methods on the interfaces exposed by a single object appear as a flat list.</span></span> <span data-ttu-id="6b7aa-141">Dado que el acceso enlazado a nombres requiere dos llamadas a funciones, es menos eficaz que usar directamente una interfaz COM.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-141">Because name-bound access requires two function calls, it is less efficient than using a COM interface directly.</span></span> <span data-ttu-id="6b7aa-142">Se anima a los clientes a usar las interfaces COM ADSI en los objetos cuando el rendimiento es una consideración.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-142">Clients are encouraged to use the ADSI COM interfaces on the objects when performance is a consideration.</span></span> <span data-ttu-id="6b7aa-143">Los controladores de automatización avanzados, como Visual Basic 4,0, pueden llamar a otras interfaces COM, así como a **IDispatch**, si las interfaces cumplen con las restricciones de automatización de los tipos de datos y el paso de parámetros.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-143">Advanced Automation controllers such as Visual Basic 4.0 can call other COM interfaces as well as **IDispatch**, if the interfaces comply with the Automation constraints for data types and parameter passing.</span></span>

<span data-ttu-id="6b7aa-144">Los proveedores ADSI generan los dispids dinámicamente para cada Active Directory objeto.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-144">ADSI providers generate dispIDs dynamically for each Active Directory object.</span></span> <span data-ttu-id="6b7aa-145">Los DISPID recuperados a través de [**IDispatch:: GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) para un objeto determinado son los valores generados, pero no los valores que se encuentran en el IDL para el objeto.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-145">The dispIDs retrieved through [**IDispatch::GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) for a given object are the generated values, but not the values that are in the IDL for the object.</span></span> <span data-ttu-id="6b7aa-146">Los usuarios de [**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) deben llamar a **GetIDsOfNames** para obtener los DISPID válidos en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-146">[**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) users must call **GetIDsOfNames** to obtain valid dispIDs at run time.</span></span>

## <a name="type-information-and-type-libraries"></a><span data-ttu-id="6b7aa-147">Información de tipos y bibliotecas de tipos</span><span class="sxs-lookup"><span data-stu-id="6b7aa-147">Type Information and Type Libraries</span></span>

<span data-ttu-id="6b7aa-148">El SDK de ADSI proporciona una biblioteca de tipos, activeds. tlb, que documenta todas las interfaces estándar compatibles con ADSI.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-148">The ADSI SDK supplies a type library, Activeds.tlb, that documents all the standard interfaces supported by ADSI.</span></span> <span data-ttu-id="6b7aa-149">Un proveedor debe proporcionar una biblioteca de tipos similar para todas las interfaces que se encuentran en activeds. tlb, además de los datos de tipo adicionales para las interfaces implementadas dentro del componente de proveedor.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-149">A provider must supply a similar type library for all interfaces found in Activeds.tlb, plus any additional type data for the interfaces implemented within the provider component.</span></span>

<span data-ttu-id="6b7aa-150">El siguiente es un ejemplo de código IDL.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-150">The following is an IDL code example.</span></span>

``` syntax
[ object, uuid(IID_IADsXYZ), oleautomation, dual ]
interface IADsXYZ: IDispatch
{
// Read-only properties.
[propget]
HRESULT AReadOnlyProp ([out, retval]BSTR *pbstrAReadOnlyProp);
 
// Read/write properties.
[propget]
HRESULT AReadWriteProp ([out, retval]long *plAReadWriteProp);
[propput]
HRESULT AReadWriteProp ([in]long lAReadWriteProp);
 
// Methods.
HRESULT AMethod ([in]DATE dateInParameter,
[out, retval]BSTR *pbstrReturnValue);
};
```

## <a name="thread-safety"></a><span data-ttu-id="6b7aa-151">Seguridad para subprocesos</span><span class="sxs-lookup"><span data-stu-id="6b7aa-151">Thread Safety</span></span>

<span data-ttu-id="6b7aa-152">El modelo de objetos componentes (COM) describe los tres modelos de subprocesos siguientes.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-152">The Component Object Model (COM) describes the following three threading models.</span></span> <span data-ttu-id="6b7aa-153">Las aplicaciones COM indican qué modelo se usa al inicializar la biblioteca COM mediante las funciones [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) y [**CoInitializeEx**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializeex) :</span><span class="sxs-lookup"><span data-stu-id="6b7aa-153">COM applications indicate which model is in use when initializing the COM library using the [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) and [**CoInitializeEx**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializeex) functions:</span></span>

-   <span data-ttu-id="6b7aa-154">Subprocesamiento único.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-154">Single threading.</span></span> <span data-ttu-id="6b7aa-155">El modelo de un solo subproceso presupone un único subproceso de ejecución en un proceso, con lo que se supone que las estructuras de datos COM de un proceso no necesitan ninguna serialización de acceso.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-155">The single threaded model assumes a single thread of execution in a process, further assuming that COM data structures in a process need no access serialization.</span></span>
-   <span data-ttu-id="6b7aa-156">Subprocesamiento de apartamento.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-156">Apartment threading.</span></span> <span data-ttu-id="6b7aa-157">Un objeto COM está asociado al subproceso que lo creó.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-157">A COM object is associated with the thread that created it.</span></span> <span data-ttu-id="6b7aa-158">El subproceso que creó ese objeto debe ejecutar las llamadas a un objeto en otro subproceso.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-158">Calls to an object on another thread must be executed by the thread that created that object.</span></span> <span data-ttu-id="6b7aa-159">Para ello, el subproceso de origen invoca un proxy de cliente que organiza la llamada al método y la entrega a una función de código auxiliar de servidor en el subproceso de destino a través de la cola de mensajes de Win32 asociada al subproceso de destino.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-159">To accomplish this, the source thread invokes a client proxy which arranges the method call and delivers it to a server stub function in the destination thread through the Win32 message queue associated with the destination thread.</span></span>
-   <span data-ttu-id="6b7aa-160">Subprocesamiento libre.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-160">Free threading.</span></span> <span data-ttu-id="6b7aa-161">Se supone que los objetos COM son seguros para subprocesos.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-161">COM objects are assumed to be thread safe.</span></span> <span data-ttu-id="6b7aa-162">A varios subprocesos se les permite el acceso a cualquier objeto del proceso sin ninguna serialización impuesta.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-162">Multiple threads are allowed access to any object in the process with no serialization imposed.</span></span>

<span data-ttu-id="6b7aa-163">ADSI no supone ningún modelo de subprocesos determinado.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-163">ADSI does not assume any particular threading model.</span></span> <span data-ttu-id="6b7aa-164">Los escritores de componentes de proveedor deben suponer el modelo de subprocesos gratuito y garantizar la coherencia de sus estructuras de datos internas mediante su protección contra los subprocesos no seguros, es decir, sin coordinación, actualizaciones mediante el uso de objetos de sincronización como secciones críticas o semáforos.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-164">Writers of provider components should assume the free threading model and guarantee the consistency of their internal data structures by protecting them from thread-unsafe, that is, uncoordinated, updates through the use of synchronization objects such as critical sections or semaphores.</span></span>

## <a name="object-locking"></a><span data-ttu-id="6b7aa-165">Bloqueo de objetos</span><span class="sxs-lookup"><span data-stu-id="6b7aa-165">Object Locking</span></span>

<span data-ttu-id="6b7aa-166">ADSI no impone ni define un esquema de bloqueo de objetos.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-166">ADSI does not impose or define an object-locking scheme.</span></span> <span data-ttu-id="6b7aa-167">Los proveedores de espacios de nombres que admiten la serialización de acceso mediante el bloqueo pueden exponer el esquema de bloqueo subyacente a través de extensiones específicas del proveedor a ADSI.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-167">Providers for namespaces that support access serialization using locking can expose the underlying locking scheme through provider-specific extensions to ADSI.</span></span>

## <a name="property-names-within-a-schema"></a><span data-ttu-id="6b7aa-168">Nombres de propiedad dentro de un esquema</span><span class="sxs-lookup"><span data-stu-id="6b7aa-168">Property Names Within a Schema</span></span>

<span data-ttu-id="6b7aa-169">ADSI representa propiedades como objetos de propiedad dentro del contenedor de esquema ADSI.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-169">ADSI represents properties as property objects within the ADSI schema container.</span></span> <span data-ttu-id="6b7aa-170">Esto requiere que los nombres de propiedad sean únicos en cada contenedor de esquemas.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-170">This requires that property names be unique within each schema container.</span></span> <span data-ttu-id="6b7aa-171">El proveedor debe asegurarse de que no haya conflictos de nombres.</span><span class="sxs-lookup"><span data-stu-id="6b7aa-171">The provider must ensure that there are no name collisions.</span></span>

## <a name="primary-interface"></a><span data-ttu-id="6b7aa-172">Interfaz principal</span><span class="sxs-lookup"><span data-stu-id="6b7aa-172">Primary Interface</span></span>

<span data-ttu-id="6b7aa-173">Cuando un proveedor no puede identificar qué interfaz se debe devolver como la interfaz principal, se debe devolver el **IID de IID \_** .</span><span class="sxs-lookup"><span data-stu-id="6b7aa-173">When a provider cannot identify which interface should be returned as the primary interface, **IID\_IADs** should be returned.</span></span> <span data-ttu-id="6b7aa-174">Esto proporciona acceso con enlace de nombre a todas las propiedades de un objeto a través de [**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) y los métodos [**IADs:: get**](/windows/desktop/api/Iads/nf-iads-iads-get), [**IADs:: GETEX**](/windows/desktop/api/Iads/nf-iads-iads-getex), [**iads::P UT**](/windows/desktop/api/Iads/nf-iads-iads-put)y [**IADs::P Utex**](/windows/desktop/api/Iads/nf-iads-iads-putex) .</span><span class="sxs-lookup"><span data-stu-id="6b7aa-174">This provides name-bound access to all properties of an object through [**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) and the [**IADs::Get**](/windows/desktop/api/Iads/nf-iads-iads-get), [**IADs::GetEx**](/windows/desktop/api/Iads/nf-iads-iads-getex), [**IADs::Put**](/windows/desktop/api/Iads/nf-iads-iads-put), and [**IADs::PutEx**](/windows/desktop/api/Iads/nf-iads-iads-putex) methods.</span></span>

 

 