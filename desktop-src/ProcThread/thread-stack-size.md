---
description: Cada nuevo subproceso o fibra recibe su propio espacio de pila compuesto por la memoria reservada y inicialmente asignada.
ms.assetid: abb2d5c1-040b-4c36-aae5-3517b6a8c540
title: Tamaño de pila de subprocesos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f4204e0bffa13fb43b6ea9520b60c0505372bad6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "104002137"
---
# <a name="thread-stack-size"></a><span data-ttu-id="78bb6-103">Tamaño de pila de subprocesos</span><span class="sxs-lookup"><span data-stu-id="78bb6-103">Thread Stack Size</span></span>

<span data-ttu-id="78bb6-104">Cada nuevo subproceso o fibra recibe su propio espacio de pila compuesto por la memoria reservada y inicialmente asignada.</span><span class="sxs-lookup"><span data-stu-id="78bb6-104">Each new thread or fiber receives its own stack space consisting of both reserved and initially committed memory.</span></span> <span data-ttu-id="78bb6-105">El tamaño de memoria reservada representa la asignación total de la pila en la memoria virtual.</span><span class="sxs-lookup"><span data-stu-id="78bb6-105">The reserved memory size represents the total stack allocation in virtual memory.</span></span> <span data-ttu-id="78bb6-106">Como tal, el tamaño reservado se limita al intervalo de direcciones virtuales.</span><span class="sxs-lookup"><span data-stu-id="78bb6-106">As such, the reserved size is limited to the virtual address range.</span></span> <span data-ttu-id="78bb6-107">Las páginas confirmadas inicialmente no usan la memoria física hasta que se hace referencia a ellas. sin embargo, quitan páginas del límite total de confirmaciones del sistema, que es el tamaño del archivo de paginación más el tamaño de la memoria física.</span><span class="sxs-lookup"><span data-stu-id="78bb6-107">The initially committed pages do not utilize physical memory until they are referenced; however, they do remove pages from the system total commit limit, which is the size of the page file plus the size of the physical memory.</span></span> <span data-ttu-id="78bb6-108">El sistema confirma páginas adicionales de la memoria reservada de la pila a medida que se necesitan, hasta que la pila alcanza el tamaño reservado menos una página (que se usa como una página de protección para evitar el desbordamiento de la pila) o el sistema es tan bajo en la memoria que la operación no se realiza correctamente.</span><span class="sxs-lookup"><span data-stu-id="78bb6-108">The system commits additional pages from the reserved stack memory as they are needed, until either the stack reaches the reserved size minus one page (which is used as a guard page to prevent stack overflow) or the system is so low on memory that the operation fails.</span></span>

<span data-ttu-id="78bb6-109">Es mejor elegir el tamaño de la pila como sea posible y confirmar la pila necesaria para que el subproceso o la fibra se ejecuten de forma confiable.</span><span class="sxs-lookup"><span data-stu-id="78bb6-109">It is best to choose as small a stack size as possible and commit the stack that is needed for the thread or fiber to run reliably.</span></span> <span data-ttu-id="78bb6-110">Todas las páginas reservadas para la pila no se pueden usar para ningún otro propósito.</span><span class="sxs-lookup"><span data-stu-id="78bb6-110">Every page that is reserved for the stack cannot be used for any other purpose.</span></span>

<span data-ttu-id="78bb6-111">Una pila se libera cuando se cierra su subproceso.</span><span class="sxs-lookup"><span data-stu-id="78bb6-111">A stack is freed when its thread exits.</span></span> <span data-ttu-id="78bb6-112">No se libera si otro subproceso finaliza el subproceso.</span><span class="sxs-lookup"><span data-stu-id="78bb6-112">It is not freed if the thread is terminated by another thread.</span></span>

<span data-ttu-id="78bb6-113">El tamaño predeterminado de la memoria de pila reservada y inicialmente confirmada se especifica en el encabezado del archivo ejecutable.</span><span class="sxs-lookup"><span data-stu-id="78bb6-113">The default size for the reserved and initially committed stack memory is specified in the executable file header.</span></span> <span data-ttu-id="78bb6-114">Se produce un error en la creación de subprocesos o fibras si no hay suficiente memoria para reservar o confirmar el número de bytes solicitados.</span><span class="sxs-lookup"><span data-stu-id="78bb6-114">Thread or fiber creation fails if there is not enough memory to reserve or commit the number of bytes requested.</span></span> <span data-ttu-id="78bb6-115">El tamaño de reserva de pila predeterminado utilizado por el enlazador es 1 MB.</span><span class="sxs-lookup"><span data-stu-id="78bb6-115">The default stack reservation size used by the linker is 1 MB.</span></span> <span data-ttu-id="78bb6-116">Para especificar un tamaño de reserva de pila predeterminado diferente para todos los subprocesos y fibras, use la instrucción STACKSIZE en el archivo de definición de módulo (. def).</span><span class="sxs-lookup"><span data-stu-id="78bb6-116">To specify a different default stack reservation size for all threads and fibers, use the STACKSIZE statement in the module definition (.def) file.</span></span> <span data-ttu-id="78bb6-117">El sistema operativo redondea el tamaño especificado al múltiplo más cercano de la granularidad de asignación del sistema (normalmente 64 KB).</span><span class="sxs-lookup"><span data-stu-id="78bb6-117">The operating system rounds up the specified size to the nearest multiple of the system's allocation granularity (typically 64 KB).</span></span> <span data-ttu-id="78bb6-118">Para recuperar la granularidad de asignación del sistema actual, utilice la función [**GetSystemInfo**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-getsysteminfo) .</span><span class="sxs-lookup"><span data-stu-id="78bb6-118">To retrieve the allocation granularity of the current system, use the [**GetSystemInfo**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-getsysteminfo) function.</span></span>

<span data-ttu-id="78bb6-119">Para cambiar el espacio de pila inicialmente confirmado, use el parámetro *dwStackSize* de la función [**CreateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread), [**CreateRemoteThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createremotethread)o [**CreateFiber**](/windows/desktop/api/WinBase/nf-winbase-createfiber) .</span><span class="sxs-lookup"><span data-stu-id="78bb6-119">To change the initially committed stack space, use the *dwStackSize* parameter of the [**CreateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread), [**CreateRemoteThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createremotethread), or [**CreateFiber**](/windows/desktop/api/WinBase/nf-winbase-createfiber) function.</span></span> <span data-ttu-id="78bb6-120">Este valor se redondea hacia arriba a la página más cercana.</span><span class="sxs-lookup"><span data-stu-id="78bb6-120">This value is rounded up to the nearest page.</span></span> <span data-ttu-id="78bb6-121">Por lo general, el tamaño de reserva es el tamaño de reserva predeterminado especificado en el encabezado ejecutable.</span><span class="sxs-lookup"><span data-stu-id="78bb6-121">Generally, the reserve size is the default reserve size specified in the executable header.</span></span> <span data-ttu-id="78bb6-122">Sin embargo, si el tamaño inicialmente confirmado especificado por *dwStackSize* es mayor o igual que el tamaño de reserva predeterminado, el tamaño de reserva es este nuevo tamaño de confirmación redondeado al múltiplo más cercano de 1 MB.</span><span class="sxs-lookup"><span data-stu-id="78bb6-122">However, if the initially committed size specified by *dwStackSize* is larger than or equal to the default reserve size, the reserve size is this new commit size rounded up to the nearest multiple of 1 MB.</span></span>

<span data-ttu-id="78bb6-123">Para cambiar el tamaño de la pila reservada, establezca el parámetro *dwCreationFlags* de [**CreateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread) o [**CreateRemoteThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createremotethread) en el parámetro de tamaño de pila \_ \_ \_ es \_ una \_ reserva y use el parámetro *dwStackSize* .</span><span class="sxs-lookup"><span data-stu-id="78bb6-123">To change the reserved stack size, set the *dwCreationFlags* parameter of [**CreateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread) or [**CreateRemoteThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createremotethread) to STACK\_SIZE\_PARAM\_IS\_A\_RESERVATION and use the *dwStackSize* parameter.</span></span> <span data-ttu-id="78bb6-124">En este caso, el tamaño asignado inicialmente es el tamaño predeterminado especificado en el encabezado ejecutable.</span><span class="sxs-lookup"><span data-stu-id="78bb6-124">In this case, the initially committed size is the default size specified in the executable header.</span></span> <span data-ttu-id="78bb6-125">Para fibras, use el parámetro *dwStackReserveSize* de [**CreateFiberEx**](/windows/desktop/api/WinBase/nf-winbase-createfiberex).</span><span class="sxs-lookup"><span data-stu-id="78bb6-125">For fibers, use the *dwStackReserveSize* parameter of [**CreateFiberEx**](/windows/desktop/api/WinBase/nf-winbase-createfiberex).</span></span> <span data-ttu-id="78bb6-126">El tamaño confirmado se especifica en el parámetro *dwStackCommitSize* .</span><span class="sxs-lookup"><span data-stu-id="78bb6-126">The committed size is specified in the *dwStackCommitSize* parameter.</span></span>

<span data-ttu-id="78bb6-127">La función [**SetThreadStackGuarantee**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-setthreadstackguarantee) establece el tamaño mínimo de la pila asociada al subproceso o fibra que realiza la llamada que estará disponible durante cualquier excepción de desbordamiento de pila.</span><span class="sxs-lookup"><span data-stu-id="78bb6-127">The [**SetThreadStackGuarantee**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-setthreadstackguarantee) function sets the minimum size of the stack associated with the calling thread or fiber that will be available during any stack overflow exceptions.</span></span>

 

 
