---
description: Los controladores de superposición de iconos son objetos de modelo de objetos componentes (COM) en proceso, implementados como archivos dll.
ms.assetid: ADF27BFD-CC96-43F9-9EBB-DEBE0DEA7B92
title: Cómo implementar controladores de superposición de iconos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e22c1057f65c50b31c6627846ec77103827a0283
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104985427"
---
# <a name="how-to-implement-icon-overlay-handlers"></a><span data-ttu-id="8ead2-103">Cómo implementar controladores de superposición de iconos</span><span class="sxs-lookup"><span data-stu-id="8ead2-103">How to Implement Icon Overlay Handlers</span></span>

<span data-ttu-id="8ead2-104">Los controladores de superposición de iconos son objetos de modelo de objetos componentes (COM) en proceso, implementados como archivos dll.</span><span class="sxs-lookup"><span data-stu-id="8ead2-104">Icon overlay handlers are in-process Component Object Model (COM) objects, implemented as DLLs.</span></span> <span data-ttu-id="8ead2-105">Exportan una interfaz además de [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown): [**IShellIconOverlayIdentifier**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelliconoverlayidentifier).</span><span class="sxs-lookup"><span data-stu-id="8ead2-105">They export one interface in addition to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown): [**IShellIconOverlayIdentifier**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelliconoverlayidentifier).</span></span> <span data-ttu-id="8ead2-106">Esta interfaz tiene tres métodos: [**IShellIconOverlayIdentifier:: GetOverlayInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getoverlayinfo), [**IShellIconOverlayIdentifier:: GetPriority (**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getpriority)y [**IShellIconOverlayIdentifier:: IsMemberOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-ismemberof).</span><span class="sxs-lookup"><span data-stu-id="8ead2-106">This interface has three methods: [**IShellIconOverlayIdentifier::GetOverlayInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getoverlayinfo), [**IShellIconOverlayIdentifier::GetPriority**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getpriority), and [**IShellIconOverlayIdentifier::IsMemberOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-ismemberof).</span></span>

## <a name="instructions"></a><span data-ttu-id="8ead2-107">Instrucciones</span><span class="sxs-lookup"><span data-stu-id="8ead2-107">Instructions</span></span>

### <a name="step-1-implementing-getoverlayinfo"></a><span data-ttu-id="8ead2-108">Paso 1: implementación de GetOverlayInfo</span><span class="sxs-lookup"><span data-stu-id="8ead2-108">Step 1: Implementing GetOverlayInfo</span></span>

<span data-ttu-id="8ead2-109">Primero se llama al método [**GetOverlayInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getoverlayinfo) durante la inicialización.</span><span class="sxs-lookup"><span data-stu-id="8ead2-109">The [**GetOverlayInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getoverlayinfo) method is first called during initialization.</span></span> <span data-ttu-id="8ead2-110">El método devuelve la ruta de acceso completa del archivo que contiene la imagen de superposición de icono y su índice de base cero dentro del archivo.</span><span class="sxs-lookup"><span data-stu-id="8ead2-110">The method returns the fully qualified path of the file that contains the icon overlay image, and its zero-based index within the file.</span></span> <span data-ttu-id="8ead2-111">Después, el shell agrega la imagen a la lista de imágenes del sistema.</span><span class="sxs-lookup"><span data-stu-id="8ead2-111">The Shell then adds the image to the system image list.</span></span> <span data-ttu-id="8ead2-112">Las superposiciones de iconos pueden estar contenidas en cualquiera de los tipos de archivo estándar, como. exe,. dll y. ico.</span><span class="sxs-lookup"><span data-stu-id="8ead2-112">Icon overlays can be contained in any of the standard file types, including .exe, .dll, and .ico.</span></span>

<span data-ttu-id="8ead2-113">Una vez completada la inicialización, el shell llama a [**GetOverlayInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getoverlayinfo) cuando necesita mostrar la superposición de iconos del controlador.</span><span class="sxs-lookup"><span data-stu-id="8ead2-113">After initialization is complete, the Shell calls [**GetOverlayInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getoverlayinfo) when it needs to display the handler's icon overlay.</span></span> <span data-ttu-id="8ead2-114">El método debe devolver el mismo nombre de archivo y el mismo índice que tenía durante la inicialización.</span><span class="sxs-lookup"><span data-stu-id="8ead2-114">The method should return the same file name and index that it did during initialization.</span></span> <span data-ttu-id="8ead2-115">Aunque el shell usa la imagen que está almacenada en la memoria caché en la lista de imágenes del sistema en lugar de cargar la imagen desde el archivo, una superposición de iconos sigue siendo identificada por su nombre de archivo e índice.</span><span class="sxs-lookup"><span data-stu-id="8ead2-115">Although the Shell uses the image that is cached in the system image list rather than loading the image from the file, an icon overlay is still identified by its file name and index.</span></span>

### <a name="step-2-implementing-getpriority"></a><span data-ttu-id="8ead2-116">Paso 2: implementación de GetPriority (</span><span class="sxs-lookup"><span data-stu-id="8ead2-116">Step 2: Implementing GetPriority</span></span>

<span data-ttu-id="8ead2-117">Solo se llama al método [**GetPriority (**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getpriority) durante la inicialización.</span><span class="sxs-lookup"><span data-stu-id="8ead2-117">The [**GetPriority**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getpriority) method is called only during initialization.</span></span> <span data-ttu-id="8ead2-118">Asigna un valor de prioridad a la superposición de iconos del controlador.</span><span class="sxs-lookup"><span data-stu-id="8ead2-118">It assigns a priority value to the handler's icon overlay.</span></span> <span data-ttu-id="8ead2-119">El valor puede oscilar entre cero y 100, donde 100 es la prioridad más baja.</span><span class="sxs-lookup"><span data-stu-id="8ead2-119">The value can range from zero to 100, where 100 is the lowest priority.</span></span> <span data-ttu-id="8ead2-120">El propósito de este valor de prioridad es ayudar a que el shell resuelva el conflicto que surge cuando se especifican varias superposiciones de iconos para un único objeto.</span><span class="sxs-lookup"><span data-stu-id="8ead2-120">The purpose of this priority value is to help the Shell resolve the conflict that arises when multiple icon overlays are specified for a single object.</span></span> <span data-ttu-id="8ead2-121">El shell usa primero un conjunto interno de reglas para determinar la superposición del icono de prioridad más alta.</span><span class="sxs-lookup"><span data-stu-id="8ead2-121">The Shell first uses an internal set of rules to determine the highest-priority icon overlay.</span></span> <span data-ttu-id="8ead2-122">Si estas reglas no resuelven el conflicto, los valores asignados al icono superpuesto de **GetPriority (** determinan la prioridad.</span><span class="sxs-lookup"><span data-stu-id="8ead2-122">If these rules do not resolve the conflict, the values assigned to the icon overlays by **GetPriority** determine priority.</span></span>

<span data-ttu-id="8ead2-123">El valor de prioridad establecido por [**GetPriority (**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getpriority) no es una manera confiable de resolver conflictos entre controladores de superposición de iconos no relacionados.</span><span class="sxs-lookup"><span data-stu-id="8ead2-123">The priority value set by [**GetPriority**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getpriority) is not a reliable way to resolve conflicts between unrelated icon overlay handlers.</span></span> <span data-ttu-id="8ead2-124">No hay ninguna manera de que el controlador determine qué valores de prioridad usan otros controladores.</span><span class="sxs-lookup"><span data-stu-id="8ead2-124">There is no way for your handler to determine what priority values other handlers are using.</span></span> <span data-ttu-id="8ead2-125">Normalmente, el valor se debe establecer en cero.</span><span class="sxs-lookup"><span data-stu-id="8ead2-125">Normally, you should set the value to zero.</span></span> <span data-ttu-id="8ead2-126">Sin embargo, el valor de prioridad es útil cuando se han implementado dos o más controladores de superposición de iconos que pueden solicitar iconos de superposición de iconos para el mismo objeto.</span><span class="sxs-lookup"><span data-stu-id="8ead2-126">However, the priority value is useful when you have implemented two or more icon overlay handlers that can request icon overlay icons for the same object.</span></span> <span data-ttu-id="8ead2-127">Al establecer los valores de prioridad adecuadamente, puede especificar cuál de las superposiciones de iconos solicitadas se mostrará.</span><span class="sxs-lookup"><span data-stu-id="8ead2-127">By setting the priority values appropriately, you can specify which of the requested icon overlays will be displayed.</span></span>

### <a name="step-3-implementing-ismemberof"></a><span data-ttu-id="8ead2-128">Paso 3: implementación de IsMemberOf</span><span class="sxs-lookup"><span data-stu-id="8ead2-128">Step 3: Implementing IsMemberOf</span></span>

<span data-ttu-id="8ead2-129">El shell llama al método [**IsMemberOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-ismemberof) para determinar si debe mostrar la superposición de icono de un controlador para un objeto determinado.</span><span class="sxs-lookup"><span data-stu-id="8ead2-129">The Shell calls the [**IsMemberOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-ismemberof) method to determine whether it should display a handler's icon overlay for a particular object.</span></span> <span data-ttu-id="8ead2-130">El shell especifica el objeto pasando su nombre al método.</span><span class="sxs-lookup"><span data-stu-id="8ead2-130">The Shell specifies the object by passing its name to the method.</span></span> <span data-ttu-id="8ead2-131">Si un controlador desea mostrar su superposición de icono, **IsMemberOf** devuelve S \_ correcto.</span><span class="sxs-lookup"><span data-stu-id="8ead2-131">If a handler wants to have its icon overlay displayed, **IsMemberOf** returns S\_OK.</span></span> <span data-ttu-id="8ead2-132">Si no es así, devuelve S \_ false.</span><span class="sxs-lookup"><span data-stu-id="8ead2-132">If not, it returns S\_FALSE.</span></span>

<span data-ttu-id="8ead2-133">Los controladores de superposición de iconos suelen estar diseñados para trabajar con un grupo de archivos determinado.</span><span class="sxs-lookup"><span data-stu-id="8ead2-133">Icon overlay handlers are normally intended to work with a particular group of files.</span></span> <span data-ttu-id="8ead2-134">Un ejemplo típico es un [tipo de archivo](fa-file-types.md), identificado por una extensión de nombre de archivo específica.</span><span class="sxs-lookup"><span data-stu-id="8ead2-134">A typical example is a [file type](fa-file-types.md), identified by a specific file name extension.</span></span> <span data-ttu-id="8ead2-135">Un controlador de superposición de iconos puede solicitar una superposición de iconos para todos los archivos del tipo de archivo.</span><span class="sxs-lookup"><span data-stu-id="8ead2-135">An icon overlay handler can request an icon overlay for all files of the file type.</span></span> <span data-ttu-id="8ead2-136">Algunos controladores solicitan una superposición de iconos solo si un archivo del tipo de archivo se encuentra en un estado determinado.</span><span class="sxs-lookup"><span data-stu-id="8ead2-136">Some handlers request an icon overlay only if a file of the file type is in a particular state.</span></span> <span data-ttu-id="8ead2-137">Sin embargo, los controladores de superposición de iconos pueden solicitar la superposición de iconos para cualquier objeto que elijan.</span><span class="sxs-lookup"><span data-stu-id="8ead2-137">However, icon overlay handlers are free to request their icon overlay for any object that they choose.</span></span>

 

 
