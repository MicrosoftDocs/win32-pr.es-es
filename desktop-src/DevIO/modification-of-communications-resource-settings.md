---
description: Cuando la función CreateFile abre un identificador de un recurso de comunicaciones serie, el sistema inicializa y configura el recurso de acuerdo con los valores configurados la última vez que se abrió el recurso.
ms.assetid: a39881d8-32af-4846-a2d3-508f1945b666
title: Modificación de la configuración de los recursos de comunicaciones
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8658029470fae9ee2d70ffb1459312c3c4d80ecf
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104080194"
---
# <a name="modification-of-communications-resource-settings"></a><span data-ttu-id="3f344-103">Modificación de la configuración de los recursos de comunicaciones</span><span class="sxs-lookup"><span data-stu-id="3f344-103">Modification of Communications Resource Settings</span></span>

<span data-ttu-id="3f344-104">Cuando la función [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) abre un identificador de un recurso de comunicaciones serie, el sistema inicializa y configura el recurso de acuerdo con los valores configurados la última vez que se abrió el recurso.</span><span class="sxs-lookup"><span data-stu-id="3f344-104">When the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function opens a handle to a serial communications resource, the system initializes and configures the resource according to the values set up the last time the resource was opened.</span></span> <span data-ttu-id="3f344-105">Conservar la configuración anterior permite al usuario conservar la configuración especificada a través de un comando de **modo** cuando se vuelve a abrir el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="3f344-105">Preserving the previous settings enables the user to retain the settings specified through a **mode** command when the device is reopened.</span></span> <span data-ttu-id="3f344-106">Los valores heredados de la operación de apertura anterior incluyen los valores de configuración del bloque de control del dispositivo (una estructura [**DCB**](/windows/desktop/api/Winbase/ns-winbase-dcb) ) y los valores de tiempo de espera utilizados en las operaciones de e/s.</span><span class="sxs-lookup"><span data-stu-id="3f344-106">The values inherited from the previous open operation include the configuration settings of the device control block (a [**DCB**](/windows/desktop/api/Winbase/ns-winbase-dcb) structure) and the time-out values used in I/O operations.</span></span> <span data-ttu-id="3f344-107">Si el dispositivo no se ha abierto nunca, se configura con los valores predeterminados del sistema.</span><span class="sxs-lookup"><span data-stu-id="3f344-107">If the device has never been opened, it is configured with the system defaults.</span></span>

<span data-ttu-id="3f344-108">Para determinar la configuración inicial de un recurso de comunicaciones serie, un proceso llama a la función [**GetCommState**](/windows/desktop/api/Winbase/nf-winbase-getcommstate) , que rellena una estructura de [**DCB**](/windows/desktop/api/Winbase/ns-winbase-dcb) de puerto serie con las opciones de configuración actuales.</span><span class="sxs-lookup"><span data-stu-id="3f344-108">To determine the initial configuration of a serial communications resource, a process calls the [**GetCommState**](/windows/desktop/api/Winbase/nf-winbase-getcommstate) function, which fills in a serial port [**DCB**](/windows/desktop/api/Winbase/ns-winbase-dcb) structure with the current configuration settings.</span></span> <span data-ttu-id="3f344-109">Para modificar esta configuración, un proceso especifica una estructura **DCB** en una llamada a la función [**SetCommState**](/windows/desktop/api/Winbase/nf-winbase-setcommstate) .</span><span class="sxs-lookup"><span data-stu-id="3f344-109">To modify this configuration, a process specifies a **DCB** structure in a call to the [**SetCommState**](/windows/desktop/api/Winbase/nf-winbase-setcommstate) function.</span></span>

<span data-ttu-id="3f344-110">Los miembros de la estructura [**DCB**](/windows/desktop/api/Winbase/ns-winbase-dcb) especifican las opciones de configuración, como la velocidad en baudios, el número de bits de datos por byte y el número de bits de parada por byte.</span><span class="sxs-lookup"><span data-stu-id="3f344-110">Members of the [**DCB**](/windows/desktop/api/Winbase/ns-winbase-dcb) structure specify the configuration settings such as the baud rate, the number of data bits per byte, and the number of stop bits per byte.</span></span> <span data-ttu-id="3f344-111">Otros miembros de **DCB** especifican caracteres especiales y habilitan la comprobación de paridad y el control de flujo.</span><span class="sxs-lookup"><span data-stu-id="3f344-111">Other **DCB** members specify special characters and enable parity checking and flow control.</span></span> <span data-ttu-id="3f344-112">Cuando un proceso necesita modificar solo algunas de estas opciones de configuración, primero debe llamar a [**GetCommState**](/windows/desktop/api/Winbase/nf-winbase-getcommstate) para rellenar una estructura **DCB** con la configuración actual.</span><span class="sxs-lookup"><span data-stu-id="3f344-112">When a process needs to modify only a few of these configuration settings, it should first call [**GetCommState**](/windows/desktop/api/Winbase/nf-winbase-getcommstate) to fill in a **DCB** structure with the current configuration.</span></span> <span data-ttu-id="3f344-113">Después, el proceso puede ajustar los valores importantes de la estructura **DCB** y volver a configurar el dispositivo llamando a [**SetCommState**](/windows/desktop/api/Winbase/nf-winbase-setcommstate) y especificando la estructura **DCB** modificada.</span><span class="sxs-lookup"><span data-stu-id="3f344-113">Then the process can adjust the important values in the **DCB** structure and reconfigure the device by calling [**SetCommState**](/windows/desktop/api/Winbase/nf-winbase-setcommstate) and specifying the modified **DCB** structure.</span></span> <span data-ttu-id="3f344-114">Este procedimiento garantiza que los miembros no modificados de la estructura **DCB** contengan los valores adecuados.</span><span class="sxs-lookup"><span data-stu-id="3f344-114">This procedure ensures that the unmodified members of the **DCB** structure contain appropriate values.</span></span> <span data-ttu-id="3f344-115">Por ejemplo, un error común es configurar un dispositivo con una estructura **DCB** en la que el miembro **XonChar** de la estructura sea igual que el miembro **XoffChar** .</span><span class="sxs-lookup"><span data-stu-id="3f344-115">For example, a common error is to configure a device with a **DCB** structure in which the structure's **XonChar** member is equal to the **XoffChar** member.</span></span>

<span data-ttu-id="3f344-116">La función [**BuildCommDCB**](/windows/desktop/api/Winbase/nf-winbase-buildcommdcba) proporciona otra manera de modificar una estructura [**DCB**](/windows/desktop/api/Winbase/ns-winbase-dcb) .</span><span class="sxs-lookup"><span data-stu-id="3f344-116">The [**BuildCommDCB**](/windows/desktop/api/Winbase/nf-winbase-buildcommdcba) function provides another way to modify a [**DCB**](/windows/desktop/api/Winbase/ns-winbase-dcb) structure.</span></span> <span data-ttu-id="3f344-117">**BuildCommDCB** usa una cadena con el mismo formato que los argumentos de la línea de comandos del comando de **modo** para especificar la velocidad en baudios, el esquema de paridad, el número de bits de parada y el número de bits de datos.</span><span class="sxs-lookup"><span data-stu-id="3f344-117">**BuildCommDCB** uses a string with the same form as the command-line arguments of the **mode** command to specify the baud rate, parity scheme, number of stop bits, and number of data bits.</span></span> <span data-ttu-id="3f344-118">El resto de los miembros de [**DCB**](/windows/desktop/api/Winbase/ns-winbase-dcb) no se modifican mediante esta función, salvo que los miembros adecuados se establecen para deshabilitar XON/XOFF y el control de flujo de hardware.</span><span class="sxs-lookup"><span data-stu-id="3f344-118">The remaining members of [**DCB**](/windows/desktop/api/Winbase/ns-winbase-dcb) are not changed by this function, except that the appropriate members are set to disable XON/XOFF and hardware flow control.</span></span> <span data-ttu-id="3f344-119">**BuildCommDCB** solo modifica una estructura **DCB** ; no vuelve a configurar el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="3f344-119">**BuildCommDCB** only modifies a **DCB** structure; it does not reconfigure the device.</span></span>

<span data-ttu-id="3f344-120">Un proceso puede volver a configurar un recurso de comunicaciones mediante la función [**GetCommProperties**](/windows/desktop/api/Winbase/nf-winbase-getcommproperties) para obtener información de un controlador de dispositivo sobre las opciones de configuración que admite.</span><span class="sxs-lookup"><span data-stu-id="3f344-120">A process can reconfigure a communications resource by using the [**GetCommProperties**](/windows/desktop/api/Winbase/nf-winbase-getcommproperties) function to get information from a device driver about the configuration settings that it supports.</span></span> <span data-ttu-id="3f344-121">El proceso puede utilizar esta información para evitar especificar una configuración que no se admite.</span><span class="sxs-lookup"><span data-stu-id="3f344-121">The process can use this information to avoid specifying a configuration that is not supported.</span></span>

<span data-ttu-id="3f344-122">La función [**SetCommState**](/windows/desktop/api/Winbase/nf-winbase-setcommstate) vuelve a configurar el recurso de comunicaciones, pero no afecta a los búferes de entrada y salida internos del controlador especificado.</span><span class="sxs-lookup"><span data-stu-id="3f344-122">The [**SetCommState**](/windows/desktop/api/Winbase/nf-winbase-setcommstate) function reconfigures the communications resource, but it does not affect the internal output and input buffers of the specified driver.</span></span> <span data-ttu-id="3f344-123">Los búferes no se vacían y las operaciones de lectura y escritura pendientes no se terminan prematuramente.</span><span class="sxs-lookup"><span data-stu-id="3f344-123">The buffers are not flushed, and pending read and write operations are not terminated prematurely.</span></span>

<span data-ttu-id="3f344-124">Un proceso reinicializa un recurso de comunicaciones mediante la función [**SetupComm**](/windows/desktop/api/Winbase/nf-winbase-setupcomm) , que realiza las tareas siguientes:</span><span class="sxs-lookup"><span data-stu-id="3f344-124">A process reinitializes a communications resource by using the [**SetupComm**](/windows/desktop/api/Winbase/nf-winbase-setupcomm) function, which performs the following tasks:</span></span>

-   <span data-ttu-id="3f344-125">Finaliza las operaciones de lectura y escritura pendientes, incluso si no se han completado.</span><span class="sxs-lookup"><span data-stu-id="3f344-125">Terminates pending read and write operations, even if they have not been completed.</span></span>
-   <span data-ttu-id="3f344-126">Descarta los caracteres no leídos y libera los búferes de entrada y salida internos del controlador asociado con el recurso especificado.</span><span class="sxs-lookup"><span data-stu-id="3f344-126">Discards unread characters and frees the internal output and input buffers of the driver associated with the specified resource.</span></span>
-   <span data-ttu-id="3f344-127">Reasigna los búferes de entrada y salida internos.</span><span class="sxs-lookup"><span data-stu-id="3f344-127">Reallocates the internal output and input buffers.</span></span>

<span data-ttu-id="3f344-128">No es necesario un proceso para llamar a [**SetupComm**](/windows/desktop/api/Winbase/nf-winbase-setupcomm).</span><span class="sxs-lookup"><span data-stu-id="3f344-128">A process is not required to call [**SetupComm**](/windows/desktop/api/Winbase/nf-winbase-setupcomm).</span></span> <span data-ttu-id="3f344-129">Si no es así, el controlador del recurso inicializa el dispositivo con la configuración predeterminada la primera vez que se usa el identificador de recursos de comunicaciones.</span><span class="sxs-lookup"><span data-stu-id="3f344-129">If it does not, the resource's driver initializes the device with the default settings the first time that the communications resource handle is used.</span></span>

 

 
