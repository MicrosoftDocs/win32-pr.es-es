---
title: Diferencias entre las implementaciones de archivos independientes y compuestos
description: La implementación independiente de las interfaces del conjunto de propiedades y la implementación de archivos compuestos difiere de algunas maneras.
ms.assetid: 650d4759-a58a-47a4-922d-5757e356cf56
keywords:
- IPropertyStorage Strctd STG, implementaciones
- IPropertyStorage Strctd STG, implementaciones, diferencias
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 988f8a9cfdaca0a131bedf98cd8ff10ae8b89525
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/16/2019
ms.locfileid: "103903375"
---
# <a name="differences-between-stand-alone-and-compound-file-implementations"></a><span data-ttu-id="86ddb-105">Diferencias entre las implementaciones de archivos independientes y compuestos</span><span class="sxs-lookup"><span data-stu-id="86ddb-105">Differences between Stand-alone and Compound File Implementations</span></span>

<span data-ttu-id="86ddb-106">La implementación independiente de las interfaces del conjunto de propiedades y la implementación de archivos compuestos difiere de algunas maneras.</span><span class="sxs-lookup"><span data-stu-id="86ddb-106">The stand-alone implementation of the property set interfaces and the compound file implementation differ in some ways.</span></span> <span data-ttu-id="86ddb-107">En la implementación de archivo compuesto de secuencias, almacenamiento, almacenamiento de conjuntos de propiedades y objetos de almacenamiento de propiedades, las diversas interfaces se coordinan entre sí porque comparten una implementación común.</span><span class="sxs-lookup"><span data-stu-id="86ddb-107">In the compound-file implementation of stream, storage, property set storage, and property storage objects, the various interfaces coordinate with each another because they share a common implementation.</span></span> <span data-ttu-id="86ddb-108">En la implementación independiente, las implementaciones de interfaz son distintas.</span><span class="sxs-lookup"><span data-stu-id="86ddb-108">In the stand-alone implementation, the interface implementations are distinct.</span></span>

<span data-ttu-id="86ddb-109">Como resultado, la implementación de archivo compuesto controla los problemas de simultaneidad y sincroniza el objeto de conjunto de propiedades con el objeto de almacenamiento o de secuencia.</span><span class="sxs-lookup"><span data-stu-id="86ddb-109">As a result, the compound-file implementation handles concurrency issues and synchronizes the property set object with the storage or stream object.</span></span> <span data-ttu-id="86ddb-110">Con la implementación independiente, el cliente es responsable de controlar los problemas de simultaneidad y sincronización entre el almacenamiento o el objeto de flujo y el conjunto de propiedades.</span><span class="sxs-lookup"><span data-stu-id="86ddb-110">With the stand-alone implementation, the client is responsible for handling concurrency and synchronization issues between the storage or stream object and the property set.</span></span> <span data-ttu-id="86ddb-111">Un cliente puede cumplir estos requisitos siguiendo dos reglas simples.</span><span class="sxs-lookup"><span data-stu-id="86ddb-111">A client can meet these requirements by following two simple rules.</span></span> <span data-ttu-id="86ddb-112">En primer lugar, Nunca manipule un conjunto de propiedades mediante sus interfaces de flujo o de almacenamiento mientras un objeto de almacenamiento de propiedades está abierto en él.</span><span class="sxs-lookup"><span data-stu-id="86ddb-112">First, never manipulate a property set using its stream or storage interfaces while a property storage object is open on it.</span></span> <span data-ttu-id="86ddb-113">En segundo lugar, llame siempre a **commit** en un objeto de almacenamiento de propiedades antes de llamar a **CopyTo**, **MoveElementTo** o **commit** en un objeto de almacenamiento antecesor.</span><span class="sxs-lookup"><span data-stu-id="86ddb-113">Second, always call **Commit** on a property storage object before calling **CopyTo**, **MoveElementTo**, or **Commit** on an ancestor storage object.</span></span> <span data-ttu-id="86ddb-114">En concreto, los siguientes elementos requieren atención del cliente:</span><span class="sxs-lookup"><span data-stu-id="86ddb-114">Specifically, the following items require client attention:</span></span>

-   <span data-ttu-id="86ddb-115">En la implementación de archivo compuesto, un único mecanismo proporciona protección de simultaneidad para el objeto de almacenamiento y sus objetos de conjunto de propiedades asociados.</span><span class="sxs-lookup"><span data-stu-id="86ddb-115">In the compound-file implementation, a single mechanism provides concurrency protection for the storage object and its associated property set objects.</span></span> <span data-ttu-id="86ddb-116">Sin embargo, en la implementación independiente, la implementación del objeto de almacenamiento es independiente de la implementación del conjunto de propiedades y cada una proporciona sus propios mecanismos de simultaneidad.</span><span class="sxs-lookup"><span data-stu-id="86ddb-116">However, in the stand-alone implementation, the storage object implementation is separate from the property set implementation and each provides its own concurrency mechanisms.</span></span> <span data-ttu-id="86ddb-117">Por lo tanto, en la implementación independiente, el cliente es responsable de mantener la protección de simultaneidad entre las dos implementaciones a través de un mecanismo de exclusión mutua.</span><span class="sxs-lookup"><span data-stu-id="86ddb-117">Thus, in the stand-alone implementation, the client is responsible for maintaining concurrency protection between the two implementations through a mechanism of mutual exclusion.</span></span>
-   <span data-ttu-id="86ddb-118">En la implementación de archivo compuesto, los cambios en los conjuntos de propiedades se almacenan en búfer en una caché de conjunto de propiedades.</span><span class="sxs-lookup"><span data-stu-id="86ddb-118">In the compound file implementation, changes to property sets are buffered in a property-set cache.</span></span> <span data-ttu-id="86ddb-119">Después, cuando se llama al método [**IStorage:: commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit) en el objeto de almacenamiento, la implementación de archivos compuestos vacía automáticamente los cambios del conjunto de propiedades del búfer del conjunto de propiedades antes de que se confirme el objeto de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="86ddb-119">Then, when the [**IStorage::Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit) method is called on the storage object, the compound files implementation automatically flushes the property-set changes from the property-set buffer before the storage object is committed.</span></span> <span data-ttu-id="86ddb-120">Por lo tanto, los cambios del conjunto de propiedades se hacen visibles como parte de la transacción que se confirma.</span><span class="sxs-lookup"><span data-stu-id="86ddb-120">Thus, the property-set changes are made visible as part of the transaction being committed.</span></span>

    <span data-ttu-id="86ddb-121">En la implementación independiente, el cliente debe vaciar explícitamente el búfer del conjunto de propiedades mediante una llamada a [**IPropertyStorage:: commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) antes de llamar al método [**IStorage:: commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit) en el almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="86ddb-121">In the stand-alone implementation, the client must explicitly flush the property-set buffer by calling [**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) before calling the [**IStorage::Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit) method on the storage.</span></span> <span data-ttu-id="86ddb-122">Como alternativa, el cliente puede utilizar el nuevo \_ valor no almacenado en búfer de PROPSETFLAG en la implementación independiente para escribir directamente en el conjunto de propiedades en lugar de almacenar en caché los cambios en el búfer interno del conjunto de propiedades.</span><span class="sxs-lookup"><span data-stu-id="86ddb-122">Alternatively, the client can use the new PROPSETFLAG\_UNBUFFERED value in the stand-alone implementation to write directly to the property set instead of caching changes to the property set's internal buffer.</span></span> <span data-ttu-id="86ddb-123">Si \_ se utiliza PROPSETFLAG sin almacenar en búfer, se cumplen automáticamente las responsabilidades del cliente.</span><span class="sxs-lookup"><span data-stu-id="86ddb-123">If PROPSETFLAG\_UNBUFFERED is used, the client's responsibilities are automatically met.</span></span> <span data-ttu-id="86ddb-124">La implementación de archivo compuesto no admite el valor de PROPSETFLAG no \_ almacenado en búfer.</span><span class="sxs-lookup"><span data-stu-id="86ddb-124">The compound file implementation does not support the PROPSETFLAG\_UNBUFFERED value.</span></span> <span data-ttu-id="86ddb-125">Para obtener más información, vea [**constantes PROPSETFLAG**](propsetflag-constants.md).</span><span class="sxs-lookup"><span data-stu-id="86ddb-125">For more information, see [**PROPSETFLAG Constants**](propsetflag-constants.md).</span></span>

-   <span data-ttu-id="86ddb-126">Al igual que con los almacenamientos con transacciones, la implementación de archivo compuesto actualiza el conjunto de propiedades vaciando su búfer interno antes de ejecutar una llamada a [**IStorage:: CopyTo**](/windows/desktop/api/Objidl/nf-objidl-istorage-copyto) o [**IStorage:: MoveElementTo**](/windows/desktop/api/Objidl/nf-objidl-istorage-moveelementto).</span><span class="sxs-lookup"><span data-stu-id="86ddb-126">As with transacted storages, the compound file implementation updates the property set by flushing its internal buffer before executing a call to [**IStorage::CopyTo**](/windows/desktop/api/Objidl/nf-objidl-istorage-copyto) or [**IStorage::MoveElementTo**](/windows/desktop/api/Objidl/nf-objidl-istorage-moveelementto).</span></span> <span data-ttu-id="86ddb-127">Por lo tanto, los cambios realizados en el conjunto de propiedades se reflejan en el elemento de almacenamiento copiado o que se ha cambiado.</span><span class="sxs-lookup"><span data-stu-id="86ddb-127">Thus, changes to the property set are reflected in the copied or moved storage element.</span></span>

    <span data-ttu-id="86ddb-128">En la implementación independiente, el cliente debe vaciar explícitamente el búfer del conjunto de propiedades mediante una llamada a [**IPropertyStorage:: commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) antes de llamar a [**IStorage:: CopyTo**](/windows/desktop/api/Objidl/nf-objidl-istorage-copyto) o [**IStorage:: MoveElementTo**](/windows/desktop/api/Objidl/nf-objidl-istorage-moveelementto).</span><span class="sxs-lookup"><span data-stu-id="86ddb-128">In the stand-alone implementation, the client must explicitly flush the property set buffer by calling [**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) before calling [**IStorage::CopyTo**](/windows/desktop/api/Objidl/nf-objidl-istorage-copyto) or [**IStorage::MoveElementTo**](/windows/desktop/api/Objidl/nf-objidl-istorage-moveelementto).</span></span> <span data-ttu-id="86ddb-129">Como alternativa, el cliente puede utilizar el nuevo valor no almacenado en búfer de PROPSETFLAG \_ para escribir directamente en el conjunto de propiedades en lugar de almacenar en caché los cambios en el búfer del conjunto de propiedades.</span><span class="sxs-lookup"><span data-stu-id="86ddb-129">Alternatively, the client can use the new PROPSETFLAG\_UNBUFFERED value to write directly to the property set instead of caching changes to the property set buffer.</span></span> <span data-ttu-id="86ddb-130">Para obtener más información, vea [**constantes PROPSETFLAG**](propsetflag-constants.md).</span><span class="sxs-lookup"><span data-stu-id="86ddb-130">For more information, see [**PROPSETFLAG Constants**](propsetflag-constants.md).</span></span>

 

 




