---
description: Los clientes autorizados correctamente utilizan la interfaz ICertView para ver la base de datos de servicios de certificados.
ms.assetid: c8f316dd-186b-4e4a-b0ce-561a23b266cb
title: Ver la base de datos de servicios de certificados
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 43c553cee2f64c3096e733d588c9e0ad3d08ceb4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "104156569"
---
# <a name="viewing-the-certificate-services-database"></a><span data-ttu-id="35504-103">Ver la base de datos de servicios de certificados</span><span class="sxs-lookup"><span data-stu-id="35504-103">Viewing the Certificate Services Database</span></span>

<span data-ttu-id="35504-104">Los clientes autorizados correctamente utilizan la interfaz [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) para ver la base de datos de servicios de certificados.</span><span class="sxs-lookup"><span data-stu-id="35504-104">The [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) interface is used by properly authorized clients to view the Certificate Services database.</span></span> <span data-ttu-id="35504-105">Tenga en cuentan que, como parte del producto enviado, el complemento MMC entidad de certificación se puede usar para ver la base de datos de servicios de Certificate Server.</span><span class="sxs-lookup"><span data-stu-id="35504-105">It should be noted that, as part of the shipped product, the Certification Authority MMC snap-in can be used to view the Certificate Services database.</span></span> <span data-ttu-id="35504-106">[**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) se proporciona para ver la base de datos mediante programación.</span><span class="sxs-lookup"><span data-stu-id="35504-106">[**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) is provided for programmatically viewing the database.</span></span> <span data-ttu-id="35504-107">La compatibilidad con la interfaz **ICertView** comienza con Windows XP.</span><span class="sxs-lookup"><span data-stu-id="35504-107">Support for the **ICertView** interface begins with Windows XP.</span></span>

<span data-ttu-id="35504-108">Un cliente correctamente autorizado significa a un usuario al que se le ha concedido permiso para ver la base de datos de servicios de Certificate Server; el complemento MMC entidad de certificación se puede usar para conceder o restringir el acceso para ver la base de datos (en **propiedades** de la [*entidad de certificación*](../secgloss/c-gly.md), haga clic en la pestaña **seguridad** ).</span><span class="sxs-lookup"><span data-stu-id="35504-108">A properly authorized client means a user who has been granted permission to view the Certificate Services database; the Certification Authority MMC snap-in can be used to grant or restrict access to view the database (under **Properties** for the [*certification authority*](../secgloss/c-gly.md), click the **Security** tab).</span></span> <span data-ttu-id="35504-109">Además, para usar el objeto [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) , la estación de trabajo cliente debe tener instalados los componentes de cliente de servicios de Certificate Server.</span><span class="sxs-lookup"><span data-stu-id="35504-109">Additionally, to use the [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) object, the client workstation is required to have installed the Certificate Services client components.</span></span>

<span data-ttu-id="35504-110">Aunque hay varios escenarios para usar [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) y sus interfaces relacionadas, a continuación se muestra una secuencia posible para desarrollar una aplicación cliente basada en **ICertView**:</span><span class="sxs-lookup"><span data-stu-id="35504-110">Although there are various scenarios for using [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) and its related interfaces, the following depicts one possible sequence for developing a client application based on **ICertView**:</span></span>

<span data-ttu-id="35504-111">**Para ver la base de datos de servicios de certificados**</span><span class="sxs-lookup"><span data-stu-id="35504-111">**To view the Certificate Services database**</span></span>

1.  <span data-ttu-id="35504-112">Después de obtener una instancia del objeto [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) , llame a [**ICertView:: OpenConnection**](/windows/desktop/api/Certview/nf-certview-icertview-openconnection) para comunicarse con una entidad de [*certificación*](../secgloss/c-gly.md) en un equipo específico.</span><span class="sxs-lookup"><span data-stu-id="35504-112">After obtaining an instance of the [**ICertView**](/windows/desktop/api/Certview/nn-certview-icertview) object, call [**ICertView::OpenConnection**](/windows/desktop/api/Certview/nf-certview-icertview-openconnection) to communicate with a [*certification authority*](../secgloss/c-gly.md) on a specific computer.</span></span>
2.  <span data-ttu-id="35504-113">Llame a [**ICertView:: SetResultColumnCount**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumncount) para especificar el número de columnas de la vista; esta llamada también se utiliza para especificar una vista predeterminada.</span><span class="sxs-lookup"><span data-stu-id="35504-113">Call [**ICertView::SetResultColumnCount**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumncount) to specify the number of columns in the view; this call is also used to specify a default view.</span></span> <span data-ttu-id="35504-114">Si no se especifica una vista predeterminada en la llamada, el llamador debe llamar a [**ICertView:: SetResultColumn**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumn) para cada una de las columnas que se van a incluir en la vista.</span><span class="sxs-lookup"><span data-stu-id="35504-114">If a default view is not specified in the call, the caller must call [**ICertView::SetResultColumn**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumn) for each of the columns to be contained in the view.</span></span>
3.  <span data-ttu-id="35504-115">Opcional.</span><span class="sxs-lookup"><span data-stu-id="35504-115">Optional.</span></span> <span data-ttu-id="35504-116">Especifique los criterios de ordenación y/o los criterios de calificación para la consulta de base de datos mediante una llamada a la función [**ICertView:: SetRestriction**](/windows/desktop/api/Certview/nf-certview-icertview-setrestriction) .</span><span class="sxs-lookup"><span data-stu-id="35504-116">Specify sorting criteria and/or qualifying criteria for the database query by calling the [**ICertView::SetRestriction**](/windows/desktop/api/Certview/nf-certview-icertview-setrestriction) function.</span></span> <span data-ttu-id="35504-117">Los criterios de calificación consisten en informar de la vista para recuperar datos basados en calificadores como mayor que, menor que, igual a, etc.</span><span class="sxs-lookup"><span data-stu-id="35504-117">Qualifying criteria consists of informing the view to retrieve data based on qualifiers such as Greater Than, Less Than, Equal To, and so on.</span></span>
4.  <span data-ttu-id="35504-118">Llame a [**ICertView:: OpenView**](/windows/desktop/api/Certview/nf-certview-icertview-openview) para recuperar los datos de la vista; los datos de la vista se componen de las columnas solicitadas por medio de [**ICertView:: SetResultColumnCount**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumncount) (y si no se ha especificado una vista predeterminada, [**ICertView:: SetResultColumn**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumn)).</span><span class="sxs-lookup"><span data-stu-id="35504-118">Call [**ICertView::OpenView**](/windows/desktop/api/Certview/nf-certview-icertview-openview) to retrieve the data in the view; the view's data will consist of the columns requested by means of [**ICertView::SetResultColumnCount**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumncount) (and if a default view was not specified, [**ICertView::SetResultColumn**](/windows/desktop/api/Certview/nf-certview-icertview-setresultcolumn)).</span></span> <span data-ttu-id="35504-119">Si se llamó a [**ICertView:: SetRestriction**](/windows/desktop/api/Certview/nf-certview-icertview-setrestriction) , los datos de las columnas se ordenarán o calificarán.</span><span class="sxs-lookup"><span data-stu-id="35504-119">If [**ICertView::SetRestriction**](/windows/desktop/api/Certview/nf-certview-icertview-setrestriction) was called, data in the columns will be sorted and/or qualified.</span></span> <span data-ttu-id="35504-120">**ICertView:: OpenView** crea un objeto [**IEnumCERTVIEWROW**](/windows/desktop/api/Certview/nn-certview-ienumcertviewrow) , que se puede utilizar para enumerar las filas de la vista.</span><span class="sxs-lookup"><span data-stu-id="35504-120">**ICertView::OpenView** creates a [**IEnumCERTVIEWROW**](/windows/desktop/api/Certview/nn-certview-ienumcertviewrow) object, which can be used to enumerate the view's rows.</span></span>
5.  <span data-ttu-id="35504-121">Use los [](/windows/desktop/api/Certview/nn-certview-ienumcertviewrow) métodos IEnumCERTVIEWROW [**IEnumCERTVIEWROW:: EnumCertViewAttribute**](/windows/desktop/api/Certview/nf-certview-ienumcertviewrow-enumcertviewattribute), [**IEnumCERTVIEWROW:: EnumCertViewColumn**](/windows/desktop/api/Certview/nf-certview-ienumcertviewrow-enumcertviewcolumn)y [**IEnumCERTVIEWROW:: EnumCertViewExtension**](/windows/desktop/api/Certview/nf-certview-ienumcertviewrow-enumcertviewextension) para recuperar los datos de atributos, columnas y extensiones según sea necesario.</span><span class="sxs-lookup"><span data-stu-id="35504-121">Use the [**IEnumCERTVIEWROW**](/windows/desktop/api/Certview/nn-certview-ienumcertviewrow) methods [**IEnumCERTVIEWROW::EnumCertViewAttribute**](/windows/desktop/api/Certview/nf-certview-ienumcertviewrow-enumcertviewattribute), [**IEnumCERTVIEWROW::EnumCertViewColumn**](/windows/desktop/api/Certview/nf-certview-ienumcertviewrow-enumcertviewcolumn), and [**IEnumCERTVIEWROW::EnumCertViewExtension**](/windows/desktop/api/Certview/nf-certview-ienumcertviewrow-enumcertviewextension) to retrieve attribute, column, and extension data as desired.</span></span>

 

 
