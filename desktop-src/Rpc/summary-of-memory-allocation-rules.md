---
title: Resumen de reglas de asignación de memoria
description: En la tabla siguiente se resumen las reglas clave relativas a la asignación de memoria.
ms.assetid: 0c1f8398-75e6-45ec-a9f9-9dcdbe21c24d
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6f9403bb5057b2004d966c0634bc101a3282fe92
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104149457"
---
# <a name="summary-of-memory-allocation-rules"></a><span data-ttu-id="3ae2c-103">Resumen de reglas de asignación de memoria</span><span class="sxs-lookup"><span data-stu-id="3ae2c-103">Summary of Memory Allocation Rules</span></span>

<span data-ttu-id="3ae2c-104">En la tabla siguiente se resumen las reglas clave relativas a la asignación de memoria.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-104">The following table summarizes key rules regarding memory allocation.</span></span>



| <span data-ttu-id="3ae2c-105">Elemento MIDL</span><span class="sxs-lookup"><span data-stu-id="3ae2c-105">MIDL element</span></span>                                                                                                                                           | <span data-ttu-id="3ae2c-106">Descripción</span><span class="sxs-lookup"><span data-stu-id="3ae2c-106">Description</span></span>                                                                                                                                                           |
|--------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="3ae2c-107">\[Punteros [ref](/windows/desktop/Midl/ref) de nivel superior \]</span><span class="sxs-lookup"><span data-stu-id="3ae2c-107">Top-level \[ [ref](/windows/desktop/Midl/ref)\] pointers</span></span>                                                                                                                | <span data-ttu-id="3ae2c-108">Debe ser punteros no nulos.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-108">Must be non-null pointers.</span></span>                                                                                                                                            |
| <span data-ttu-id="3ae2c-109">Valor devuelto de función</span><span class="sxs-lookup"><span data-stu-id="3ae2c-109">Function return value</span></span>                                                                                                                                  | <span data-ttu-id="3ae2c-110">Siempre se asigna una nueva memoria para los valores devueltos del puntero.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-110">New memory is always allocated for pointer return values.</span></span>                                                                                                             |
| <span data-ttu-id="3ae2c-111">\[[Unique](/windows/desktop/Midl/unique), [out](/windows/desktop/Midl/out-idl) \] o \[ [ptr](/windows/desktop/Midl/ptr), puntero de salida \]</span><span class="sxs-lookup"><span data-stu-id="3ae2c-111">\[ [unique](/windows/desktop/Midl/unique), [out](/windows/desktop/Midl/out-idl)\] or \[ [ptr](/windows/desktop/Midl/ptr), out\] pointer</span></span>                                                                   | <span data-ttu-id="3ae2c-112">No permitido por MIDL.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-112">Not allowed by MIDL.</span></span>                                                                                                                                                  |
| <span data-ttu-id="3ae2c-113">Puntero de no nivel superior \[ [único](/windows/desktop/Midl/unique), [in](/windows/desktop/Midl/in), [out](/windows/desktop/Midl/out-idl) \] o \[ [ptr](/windows/desktop/Midl/ptr), in, out \] que cambia de null a no NULL</span><span class="sxs-lookup"><span data-stu-id="3ae2c-113">Non-top-level \[[unique](/windows/desktop/Midl/unique), [in](/windows/desktop/Midl/in), [out](/windows/desktop/Midl/out-idl)\] or \[[ptr](/windows/desktop/Midl/ptr), in, out\] pointer that changes from null to non-null</span></span> | <span data-ttu-id="3ae2c-114">Los códigos auxiliares de cliente asignan memoria nueva en el cliente en la devolución.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-114">Client stubs allocate new memory on client on return.</span></span>                                                                                                                 |
| <span data-ttu-id="3ae2c-115">Un puntero de un solo nivel no superior \[ [](/windows/desktop/Midl/unique), [in](/windows/desktop/Midl/in), [out](/windows/desktop/Midl/out-idl) \] que cambia de un valor distinto de null a NULL</span><span class="sxs-lookup"><span data-stu-id="3ae2c-115">Non-top-level \[[unique](/windows/desktop/Midl/unique), [in](/windows/desktop/Midl/in), [out](/windows/desktop/Midl/out-idl)\] pointer that changes from non-null to null</span></span>                                 | <span data-ttu-id="3ae2c-116">La memoria está huérfana en el cliente; la aplicación cliente es responsable de liberar memoria y evitar pérdidas.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-116">Memory is orphaned on client; client application is responsible for freeing memory and preventing leaks.</span></span>                                                              |
| <span data-ttu-id="3ae2c-117">PTR de nivel superior \[ [](/windows/desktop/Midl/ptr), [in](/windows/desktop/Midl/in), [out](/windows/desktop/Midl/out-idl) \] que cambia de distinto de null a NULL</span><span class="sxs-lookup"><span data-stu-id="3ae2c-117">Non-top-level \[[ptr](/windows/desktop/Midl/ptr), [in](/windows/desktop/Midl/in), [out](/windows/desktop/Midl/out-idl)\] pointer that changes from non-null to null</span></span>                                       | <span data-ttu-id="3ae2c-118">La memoria quedará huérfana en el cliente si no tiene alias. la aplicación cliente es responsable de liberar y evitar pérdidas de memoria en este caso.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-118">Memory will be orphaned on client if not aliased; client application is responsible for freeing and preventing memory leaks in this case.</span></span>                             |
| <span data-ttu-id="3ae2c-119">\[[referencia](/windows/desktop/Midl/ref) \] punteros</span><span class="sxs-lookup"><span data-stu-id="3ae2c-119">\[[ref](/windows/desktop/Midl/ref)\] pointers</span></span>                                                                                                                           | <span data-ttu-id="3ae2c-120">El nivel de aplicación cliente normalmente asigna.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-120">Client-application layer usually allocates.</span></span>                                                                                                                           |
| <span data-ttu-id="3ae2c-121">No NULL \[ [en](/windows/desktop/Midl/in), puntero de [salida](/windows/desktop/Midl/out-idl) \]</span><span class="sxs-lookup"><span data-stu-id="3ae2c-121">Non-null \[[in](/windows/desktop/Midl/in), [out](/windows/desktop/Midl/out-idl)\] pointer</span></span>                                                                                                | <span data-ttu-id="3ae2c-122">Los códigos auxiliares intentan escribir en el almacenamiento existente en el cliente.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-122">Stubs attempt to write into existing storage on client.</span></span> <span data-ttu-id="3ae2c-123">Si la **\[ cadena \]** y el tamaño aumentan más allá del tamaño asignado en el cliente, producirá un error de GP en la devolución.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-123">If **\[string\]** and size increases beyond size allocated on the client, it will cause a GP-fault on return.</span></span> |



 

<span data-ttu-id="3ae2c-124">En la tabla siguiente se resumen los efectos de los atributos Key IDL y ACF en la administración de memoria.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-124">The following table summarizes the effects of key IDL and ACF attributes on memory management.</span></span>



| <span data-ttu-id="3ae2c-125">Característica MIDL</span><span class="sxs-lookup"><span data-stu-id="3ae2c-125">MIDL feature</span></span>                                                                   | <span data-ttu-id="3ae2c-126">Problemas del cliente</span><span class="sxs-lookup"><span data-stu-id="3ae2c-126">Client issues</span></span>                                                                                                                                  | <span data-ttu-id="3ae2c-127">Problemas del servidor</span><span class="sxs-lookup"><span data-stu-id="3ae2c-127">Server issues</span></span>                                                                                                                 |
|--------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="3ae2c-128">\[[asignar](/windows/desktop/Midl/allocate)( \_ nodo único) \] , \[ asignar (todos los \_ nodos)\]</span><span class="sxs-lookup"><span data-stu-id="3ae2c-128">\[ [allocate](/windows/desktop/Midl/allocate)(single\_node)\], \[allocate(all\_nodes)\]</span></span>         | <span data-ttu-id="3ae2c-129">Determina si se realizan una o varias llamadas a las funciones de memoria.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-129">Determines whether one or many calls are made to the memory functions.</span></span>                                                                         | <span data-ttu-id="3ae2c-130">Lo mismo que el cliente, excepto la memoria privada, a menudo se puede usar para la asignación ( \_ nodo único) \[ en \] y \[ en los datos de salida \] .</span><span class="sxs-lookup"><span data-stu-id="3ae2c-130">Same as client, except private memory can often be used for allocate (single\_node) \[in\] and \[in,out\] data.</span></span>               |
| <span data-ttu-id="3ae2c-131">\[asignar (gratis) \] o \[ asignar (no \_ gratis)\]</span><span class="sxs-lookup"><span data-stu-id="3ae2c-131">\[allocate(free)\] or \[allocate(dont\_free)\]</span></span>                                 | <span data-ttu-id="3ae2c-132">(Ninguno; afecta al servidor).</span><span class="sxs-lookup"><span data-stu-id="3ae2c-132">(None; affects server.)</span></span>                                                                                                                        | <span data-ttu-id="3ae2c-133">Determina si la memoria del servidor se libera después de cada llamada a procedimiento remoto.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-133">Determines whether memory on the server is freed after each remote procedure call.</span></span>                                            |
| <span data-ttu-id="3ae2c-134">los atributos \[ de matriz [Max \_ es](/windows/desktop/Midl/max-is) \] y \[ [size \_ es](/windows/desktop/Midl/size-is)\]</span><span class="sxs-lookup"><span data-stu-id="3ae2c-134">array attributes \[ [max\_is](/windows/desktop/Midl/max-is)\] and \[ [size\_is](/windows/desktop/Midl/size-is)\]</span></span> | <span data-ttu-id="3ae2c-135">(Ninguno; afecta al servidor).</span><span class="sxs-lookup"><span data-stu-id="3ae2c-135">(None; affects server.)</span></span>                                                                                                                        | <span data-ttu-id="3ae2c-136">Determina el tamaño de la memoria que se va a asignar.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-136">Determines size of memory to be allocated.</span></span>                                                                                    |
| <span data-ttu-id="3ae2c-137">\[[ \_ recuento de bytes](/windows/desktop/Midl/byte-count)\]</span><span class="sxs-lookup"><span data-stu-id="3ae2c-137">\[ [byte\_count](/windows/desktop/Midl/byte-count)\]</span></span>                                            | <span data-ttu-id="3ae2c-138">El cliente debe asignar el búfer; no asignado o liberado por el código auxiliar del cliente.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-138">Client must allocate buffer; not allocated or freed by client stubs.</span></span>                                                                           | <span data-ttu-id="3ae2c-139">El atributo del parámetro ACF determina el tamaño del búfer asignado en el servidor.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-139">ACF parameter attribute determines size of buffer allocated on server.</span></span>                                                        |
| <span data-ttu-id="3ae2c-140">\[[habilitar \_ asignación](/windows/desktop/Midl/enable-allocate)\]</span><span class="sxs-lookup"><span data-stu-id="3ae2c-140">\[ [enable\_allocate](/windows/desktop/Midl/enable-allocate)\]</span></span>                                  | <span data-ttu-id="3ae2c-141">Normalmente, ninguno.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-141">Usually, none.</span></span> <span data-ttu-id="3ae2c-142">Sin embargo, el cliente puede usar un entorno de administración de memoria diferente.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-142">However, the client may be using a different memory management environment.</span></span>                                                     | <span data-ttu-id="3ae2c-143">El servidor usa un entorno de administración de memoria diferente.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-143">Server uses a different memory management environment.</span></span> <span data-ttu-id="3ae2c-144">[**RpcSmAllocate**](/windows/desktop/api/Rpcndr/nf-rpcndr-rpcsmallocate) debe usarse para las asignaciones.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-144">[**RpcSmAllocate**](/windows/desktop/api/Rpcndr/nf-rpcndr-rpcsmallocate) should be used for allocations.</span></span> |
| <span data-ttu-id="3ae2c-145">\[[en](/windows/desktop/Midl/in) \] atribui</span><span class="sxs-lookup"><span data-stu-id="3ae2c-145">\[ [in](/windows/desktop/Midl/in)\]attribute</span></span>                                                    | <span data-ttu-id="3ae2c-146">Aplicación cliente responsable de la asignación de memoria para los datos.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-146">Client application responsible for allocating memory for data.</span></span>                                                                                 | <span data-ttu-id="3ae2c-147">Asignado en el servidor mediante código auxiliar.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-147">Allocated on server by stubs.</span></span>                                                                                                 |
| <span data-ttu-id="3ae2c-148">\[[fuera](/windows/desktop/Midl/out-idl) \] de atribui</span><span class="sxs-lookup"><span data-stu-id="3ae2c-148">\[ [out](/windows/desktop/Midl/out-idl)\] attribute</span></span>                                             | <span data-ttu-id="3ae2c-149">Asignado en el cliente mediante código auxiliar.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-149">Allocated on client by stubs.</span></span>                                                                                                                  | <span data-ttu-id="3ae2c-150">\[[fuera](/windows/desktop/Midl/out-idl) \] de -solo el puntero debe ser un puntero de \[ [referencia](/windows/desktop/Midl/ref) \] ; se asigna en el servidor mediante código auxiliar.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-150">\[[out](/windows/desktop/Midl/out-idl)\]-only pointer must be \[[ref](/windows/desktop/Midl/ref)\] pointer; allocated on server by stubs.</span></span>                       |
| <span data-ttu-id="3ae2c-151">\[[referencia](/windows/desktop/Midl/ref) \] atribui</span><span class="sxs-lookup"><span data-stu-id="3ae2c-151">\[ [ref](/windows/desktop/Midl/ref)\] attribute</span></span>                                                 | <span data-ttu-id="3ae2c-152">La aplicación cliente debe asignar la memoria a la que hace referencia el puntero.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-152">Memory referenced by pointer must be allocated by client application.</span></span>                                                                          | <span data-ttu-id="3ae2c-153">Punteros de referencia de nivel superior y de primer nivel administrados por códigos auxiliares.</span><span class="sxs-lookup"><span data-stu-id="3ae2c-153">Top-level and first-level reference pointers managed by stubs.</span></span>                                                                |
| <span data-ttu-id="3ae2c-154">\[[único](/windows/desktop/Midl/unique) \] atribui</span><span class="sxs-lookup"><span data-stu-id="3ae2c-154">\[ [unique](/windows/desktop/Midl/unique)\] attribute</span></span>                                           | <span data-ttu-id="3ae2c-155">Un valor distinto de null a NULL puede dar lugar a la memoria huérfana; null a un valor distinto de NULL hace que el código auxiliar de cliente llame a la [ \_ \_ asignación de usuarios de MIDL](/windows/desktop/Midl/midl-user-allocate-1).</span><span class="sxs-lookup"><span data-stu-id="3ae2c-155">Non-null to null can result in orphaned memory; null to non-null causes client stub to call [midl\_user\_allocate](/windows/desktop/Midl/midl-user-allocate-1).</span></span> | <span data-ttu-id="3ae2c-156">(Afecta al cliente).</span><span class="sxs-lookup"><span data-stu-id="3ae2c-156">(Affects client.)</span></span>                                                                                                             |
| <span data-ttu-id="3ae2c-157">\[[ptr](/windows/desktop/Midl/ptr) \] atribui</span><span class="sxs-lookup"><span data-stu-id="3ae2c-157">\[ [ptr](/windows/desktop/Midl/ptr)\] attribute</span></span>                                                 | <span data-ttu-id="3ae2c-158">(Consulte \[ [Unique](/windows/desktop/Midl/unique) \] ).</span><span class="sxs-lookup"><span data-stu-id="3ae2c-158">(See \[ [unique](/windows/desktop/Midl/unique)\].)</span></span>                                                                                                              | <span data-ttu-id="3ae2c-159">(Consulte \[ [Unique](/windows/desktop/Midl/unique) \] ).</span><span class="sxs-lookup"><span data-stu-id="3ae2c-159">(See \[ [unique](/windows/desktop/Midl/unique)\].)</span></span>                                                                                             |



 

 

 