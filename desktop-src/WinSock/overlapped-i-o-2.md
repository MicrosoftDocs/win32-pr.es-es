---
description: Windows Sockets 2 introduce e/s superpuestas y requiere que todos los proveedores de transporte admitan esta funcionalidad.
ms.assetid: 90d49171-e211-4426-aa56-88aaeac7c578
title: Entrada/salida superpuestas
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0d8caa13dd3d50e4f0fdaa1b92fa8e99afd8e2e1
ms.sourcegitcommit: 3d9dce1bd6c84e2b51759e940aa95aa9b459cd20
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/04/2021
ms.locfileid: "103914238"
---
# <a name="overlapped-inputoutput"></a><span data-ttu-id="ef179-103">Entrada/salida superpuestas</span><span class="sxs-lookup"><span data-stu-id="ef179-103">Overlapped Input/Output</span></span>

<span data-ttu-id="ef179-104">Windows Sockets 2 introduce e/s superpuestas y requiere que todos los proveedores de transporte admitan esta funcionalidad.</span><span class="sxs-lookup"><span data-stu-id="ef179-104">Windows Sockets 2 introduces overlapped I/O and requires that all transport providers support this capability.</span></span> <span data-ttu-id="ef179-105">La e/s superpuesta solo se puede realizar en sockets creados a través de la función [**WSPSocket**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspsocket) con el indicador de la marca \_ \_ OVERLAPPED superpuesta, y seguir el modelo establecido en Windows.</span><span class="sxs-lookup"><span data-stu-id="ef179-105">Overlapped I/O can be performed only on sockets that were created through the [**WSPSocket**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspsocket) function with the WSA\_FLAG\_OVERLAPPED flag set, and follow the model established in Windows.</span></span>

<span data-ttu-id="ef179-106">Para recibir, un cliente usa [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) o [**WSPRecvFrom**](/previous-versions/windows/desktop/legacy/ms742287(v=vs.85)) para proporcionar búferes en los que se van a recibir los datos.</span><span class="sxs-lookup"><span data-stu-id="ef179-106">For receiving, a client uses [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) or [**WSPRecvFrom**](/previous-versions/windows/desktop/legacy/ms742287(v=vs.85)) to supply buffers into which data is to be received.</span></span> <span data-ttu-id="ef179-107">Si se exponen uno o más búferes antes del momento en que la red ha recibido los datos, es posible que los datos se colocan en los búferes del usuario inmediatamente a medida que llegan y, por tanto, evitan la operación de copia que, de lo contrario, se produciría.</span><span class="sxs-lookup"><span data-stu-id="ef179-107">If one or more buffers are posted prior to the time when data has been received by the network, it is possible that data will be placed into the user's buffers immediately as it arrives and thereby avoid the copy operation that would otherwise occur.</span></span> <span data-ttu-id="ef179-108">Si los datos llegan cuando los búferes de recepción ya se han publicado, se copian inmediatamente en los búferes del usuario.</span><span class="sxs-lookup"><span data-stu-id="ef179-108">If data arrives when receive buffers have already been posted, it is copied immediately into the user's buffers.</span></span> <span data-ttu-id="ef179-109">Si los datos llegan cuando la aplicación no ha publicado ningún búfer de recepción, el proveedor de servicios recurre al estilo sincrónico de operación en el que los datos entrantes se almacenan en búfer internamente hasta el momento en que el cliente emite una llamada de recepción y, por tanto, proporciona un búfer en el que se pueden copiar los datos.</span><span class="sxs-lookup"><span data-stu-id="ef179-109">If data arrives when no receive buffers have been posted by the application, the service provider resorts to the synchronous style of operation where the incoming data is buffered internally until such time as the client issues a receive call and thereby supplies a buffer into which the data may be copied.</span></span> <span data-ttu-id="ef179-110">Una excepción a esto sería si la aplicación usa [**WSPSetSockOpt**](/previous-versions/windows/hardware/network/ff566318(v=vs.85)) para establecer el tamaño del búfer de recepción en cero.</span><span class="sxs-lookup"><span data-stu-id="ef179-110">An exception to this would be if the application used [**WSPSetSockOpt**](/previous-versions/windows/hardware/network/ff566318(v=vs.85)) to set the size of the receive buffer to zero.</span></span> <span data-ttu-id="ef179-111">En esta instancia, los protocolos confiables solo permitirán que se reciban los datos cuando se hayan publicado los búferes de la aplicación, y los datos de protocolos no confiables se perderían.</span><span class="sxs-lookup"><span data-stu-id="ef179-111">In this instance, reliable protocols would only allow data to be received when application buffers had been posted, and data on unreliable protocols would be lost.</span></span>

<span data-ttu-id="ef179-112">En el lado de envío, los clientes usan [**WSPSend**](/previous-versions/windows/hardware/network/ff566316(v=vs.85)) o [**WSPSendTo**](/previous-versions/windows/desktop/legacy/ms742291(v=vs.85)) para proporcionar punteros a búferes rellenos y, después, acuerdan no molestar los búferes de ningún modo hasta que la red haya consumido el contenido del búfer.</span><span class="sxs-lookup"><span data-stu-id="ef179-112">On the sending side, clients use [**WSPSend**](/previous-versions/windows/hardware/network/ff566316(v=vs.85)) or [**WSPSendTo**](/previous-versions/windows/desktop/legacy/ms742291(v=vs.85)) to supply pointers to filled buffers and then agree not to disturb the buffers in any way until the network has consumed the buffer's contents.</span></span>

<span data-ttu-id="ef179-113">Las llamadas de envío y recepción superpuestas se devuelven inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="ef179-113">Overlapped send and receive calls return immediately.</span></span> <span data-ttu-id="ef179-114">Un valor devuelto de cero indica que la operación de e/s se completó inmediatamente y que ya se ha producido la indicación de finalización correspondiente.</span><span class="sxs-lookup"><span data-stu-id="ef179-114">A return value of zero indicates that the I/O operation completed immediately and that the corresponding completion indication has already occurred.</span></span> <span data-ttu-id="ef179-115">Es decir, se ha señalado el objeto de evento asociado o la rutina de finalización se ha puesto en cola a través de [**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc).</span><span class="sxs-lookup"><span data-stu-id="ef179-115">That is, the associated event object has been signaled, or the completion routine has been queued through [**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc).</span></span> <span data-ttu-id="ef179-116">Un valor devuelto de \_ error de socket junto con un código de error de la \_ e/s de WSA \_ pendiente indica que la operación superpuesta se ha iniciado correctamente y que se proporcionará una indicación posterior cuando se hayan consumido los búferes de envío o cuando se rellenen los búferes de recepción.</span><span class="sxs-lookup"><span data-stu-id="ef179-116">A return value of SOCKET\_ERROR coupled with an error code of WSA\_IO\_PENDING indicates that the overlapped operation has been successfully initiated and that a subsequent indication will be provided when send buffers have been consumed or when receive buffers are filled.</span></span> <span data-ttu-id="ef179-117">Cualquier otro código de error indica que la operación superpuesta no se ha iniciado correctamente y que no habrá ninguna indicación de finalización próxima.</span><span class="sxs-lookup"><span data-stu-id="ef179-117">Any other error code indicates that the overlapped operation was not successfully initiated and that no completion indication will be forthcoming.</span></span>

<span data-ttu-id="ef179-118">Las operaciones de envío y recepción se pueden superponer.</span><span class="sxs-lookup"><span data-stu-id="ef179-118">Both send and receive operations can be overlapped.</span></span> <span data-ttu-id="ef179-119">Las funciones Receive se pueden invocar varias veces para publicar búferes de recepción como preparación para los datos entrantes, y las funciones send se pueden invocar varias veces para poner en cola varios búferes que se van a enviar.</span><span class="sxs-lookup"><span data-stu-id="ef179-119">The receive functions may be invoked multiple times to post receive buffers in preparation for incoming data, and the send functions may be invoked multiple times to queue up multiple buffers to be sent.</span></span> <span data-ttu-id="ef179-120">Tenga en cuenta que, aunque se enviará una serie de búferes de envío superpuestos en el orden proporcionado, se pueden producir las indicaciones de finalización correspondientes en un orden diferente.</span><span class="sxs-lookup"><span data-stu-id="ef179-120">Note that while a series of overlapped send buffers will be sent in the order supplied, the corresponding completion indications may occur in a different order.</span></span> <span data-ttu-id="ef179-121">Del mismo modo, en el lado receptor, los búferes se rellenarán en el orden en que se proporcionan, pero las indicaciones de finalización pueden aparecer en un orden diferente.</span><span class="sxs-lookup"><span data-stu-id="ef179-121">Likewise, on the receiving side, buffers will be filled in the order they are supplied, but completion indications may occur in a different order.</span></span>

<span data-ttu-id="ef179-122">La característica de finalización aplazada de e/s superpuesta también está disponible para [**WSPIoctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="ef179-122">The deferred completion feature of overlapped I/O is also available for [**WSPIoctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85)).</span></span>

## <a name="delivering-completion-indications"></a><span data-ttu-id="ef179-123">Entrega de indicaciones de finalización</span><span class="sxs-lookup"><span data-stu-id="ef179-123">Delivering Completion Indications</span></span>

<span data-ttu-id="ef179-124">Los proveedores de servicios tienen dos maneras de indicar la finalización superpuesta: establecimiento de un objeto de evento especificado por el cliente o invocación de una rutina de finalización especificada por el cliente.</span><span class="sxs-lookup"><span data-stu-id="ef179-124">Service providers have two ways to indicate overlapped completion: setting a client-specified event object, or invoking a client-specified completion routine.</span></span> <span data-ttu-id="ef179-125">En ambos casos, una estructura de datos, [**WSAOVERLAPPED**](/windows/desktop/api/Winsock2/ns-winsock2-wsaoverlapped), se asocia a cada operación superpuesta.</span><span class="sxs-lookup"><span data-stu-id="ef179-125">In both cases a data structure, [**WSAOVERLAPPED**](/windows/desktop/api/Winsock2/ns-winsock2-wsaoverlapped), is associated with each overlapped operation.</span></span> <span data-ttu-id="ef179-126">Esta estructura la asigna el cliente y la usa para indicar qué objeto de evento (si existe) se debe establecer cuando se complete.</span><span class="sxs-lookup"><span data-stu-id="ef179-126">This structure is allocated by the client and used by it to indicate which event object (if any) is to be set when completion occurs.</span></span> <span data-ttu-id="ef179-127">El proveedor de servicios puede usar la estructura **WSAOVERLAPPED** como un lugar para almacenar un identificador en los resultados (por ejemplo, el número de bytes transferidos, marcas actualizadas, códigos de error, etc.) para una operación superpuesta determinada.</span><span class="sxs-lookup"><span data-stu-id="ef179-127">The **WSAOVERLAPPED** structure may be used by the service provider as a place to store a handle to the results (for example, number of bytes transferred, updated flags, error codes, etc.) for a particular overlapped operation.</span></span> <span data-ttu-id="ef179-128">Para obtener estos resultados, los clientes deben invocar [**WSPGetOverlappedResult**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspgetoverlappedresult), pasando un puntero a la estructura superpuesta correspondiente.</span><span class="sxs-lookup"><span data-stu-id="ef179-128">To obtain these results clients must invoke [**WSPGetOverlappedResult**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspgetoverlappedresult), passing in a pointer to the corresponding overlapped structure.</span></span>

<span data-ttu-id="ef179-129">Si se selecciona la indicación de finalización basada en eventos para una solicitud de e/s superpuesta determinada, los clientes pueden usar la rutina [**WSPGetOverlappedResult**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspgetoverlappedresult) para sondear o esperar a que se complete la operación superpuesta.</span><span class="sxs-lookup"><span data-stu-id="ef179-129">If event based completion indication is selected for a particular overlapped I/O request, the [**WSPGetOverlappedResult**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspgetoverlappedresult) routine may itself be used by clients to either poll or wait for completion of the overlapped operation.</span></span> <span data-ttu-id="ef179-130">Si se selecciona la indicación de finalización basada en rutinas de finalización para una solicitud de e/s superpuesta en particular, solo está disponible la opción de sondeo de **WSPGetOverlappedResult** .</span><span class="sxs-lookup"><span data-stu-id="ef179-130">If completion-routine-based completion indication is selected for a particular overlapped I/O request, only the polling option of **WSPGetOverlappedResult** is available.</span></span> <span data-ttu-id="ef179-131">Un cliente también puede utilizar otros medios para esperar (como el uso de [**WSAWaitForMultipleEvents**](/windows/desktop/api/Winsock2/nf-winsock2-wsawaitformultipleevents)) hasta que el objeto de evento correspondiente se ha señalado o el proveedor de servicios ha invocado la rutina de finalización especificada.</span><span class="sxs-lookup"><span data-stu-id="ef179-131">A client may also use other means to wait (such as using [**WSAWaitForMultipleEvents**](/windows/desktop/api/Winsock2/nf-winsock2-wsawaitformultipleevents)) until the corresponding event object has been signaled or the specified completion routine has been invoked by the service provider.</span></span> <span data-ttu-id="ef179-132">Una vez que se ha indicado la finalización, el cliente puede invocar a **WSPGetOverlappedResult**, con la expectativa de que la llamada se complete inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="ef179-132">Once completion has been indicated, the client may invoke **WSPGetOverlappedResult**, with the expectation that the call will complete immediately.</span></span>

## <a name="invoking-socket-io-completion-routines"></a><span data-ttu-id="ef179-133">Invocar rutinas de finalización de e/s de socket</span><span class="sxs-lookup"><span data-stu-id="ef179-133">Invoking Socket I/O Completion Routines</span></span>

<span data-ttu-id="ef179-134">Si el parámetro *lpCompletionRoutine* de una operación superpuesta no es **null**, es responsabilidad del proveedor de servicios organizar la invocación de la rutina de finalización especificada por el cliente cuando se complete la operación superpuesta.</span><span class="sxs-lookup"><span data-stu-id="ef179-134">If the *lpCompletionRoutine* parameter to an overlapped operation is not **NULL**, it is the service provider's responsibility to arrange for invocation of the client-specified completion routine when the overlapped operation completes.</span></span> <span data-ttu-id="ef179-135">Dado que la rutina de finalización se debe ejecutar en el contexto del mismo subproceso que inició la operación superpuesta, no se puede invocar directamente desde el proveedor de servicios.</span><span class="sxs-lookup"><span data-stu-id="ef179-135">Since the completion routine must be executed in the context of the same thread that initiated the overlapped operation, it cannot be invoked directly from the service provider.</span></span> <span data-ttu-id="ef179-136">El \_32.DLL Ws2 ofrece un mecanismo de llamada a procedimiento asincrónico (APC) para facilitar la invocación de rutinas de finalización.</span><span class="sxs-lookup"><span data-stu-id="ef179-136">The Ws2\_32.DLL offers an asynchronous procedure call (APC) mechanism to facilitate invocation of completion routines.</span></span>

<span data-ttu-id="ef179-137">Un proveedor de servicios organiza una función para que se ejecute en el subproceso adecuado mediante una llamada a [**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc).</span><span class="sxs-lookup"><span data-stu-id="ef179-137">A service provider arranges for a function to be executed in the proper thread by calling [**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc).</span></span> <span data-ttu-id="ef179-138">Se puede llamar a esta función desde cualquier proceso y contexto de subproceso, incluso un contexto diferente del subproceso y el proceso que se usó para iniciar la operación superpuesta.</span><span class="sxs-lookup"><span data-stu-id="ef179-138">This function can be called from any process and thread context, even a context different from the thread and process that was used to initiate the overlapped operation.</span></span>

<span data-ttu-id="ef179-139">[**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc) toma como parámetros de entrada un puntero a una estructura [**WSATHREADID**](/windows/desktop/api/Ws2spi/ns-ws2spi-wsathreadid) , un puntero a una función APC que se va a invocar y un valor de contexto de 32 bits que se pasa posteriormente a la función APC.</span><span class="sxs-lookup"><span data-stu-id="ef179-139">[**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc) takes as input parameters a pointer to a [**WSATHREADID**](/windows/desktop/api/Ws2spi/ns-ws2spi-wsathreadid) structure, a pointer to an APC function to be invoked, and a 32-bit context value that is subsequently passed to the APC function.</span></span> <span data-ttu-id="ef179-140">Los proveedores de servicios siempre se suministran con un puntero a la estructura **WSATHREADID** adecuada mediante el parámetro *lpThreadId* a la función superpuesta.</span><span class="sxs-lookup"><span data-stu-id="ef179-140">Service providers are always supplied with a pointer to the proper **WSATHREADID** structure through the *lpThreadId* parameter to the overlapped function.</span></span> <span data-ttu-id="ef179-141">El proveedor debe almacenar la estructura **WSATHREADID** localmente y proporcionar un puntero a esta copia de la estructura **WSATHREADID** como parámetro de entrada a **WPUQueueApc**.</span><span class="sxs-lookup"><span data-stu-id="ef179-141">The provider should store the **WSATHREADID** structure locally and supply a pointer to this copy of the **WSATHREADID** structure as an input parameter to **WPUQueueApc**.</span></span> <span data-ttu-id="ef179-142">Una vez que la función **WPUQueueApc** devuelve, el proveedor puede desechar su copia de **WSATHREADID**.</span><span class="sxs-lookup"><span data-stu-id="ef179-142">Once the **WPUQueueApc** function returns, the provider can dispose of its copy of the **WSATHREADID**.</span></span>

<span data-ttu-id="ef179-143">El procedimiento [**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc) simplemente pone en cola la información suficiente para llamar a la función APC indicada con los parámetros especificados, pero no lo llama.</span><span class="sxs-lookup"><span data-stu-id="ef179-143">The procedure [**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc) simply enqueues sufficient information to call the indicated APC function with the given parameters, but does not call it.</span></span> <span data-ttu-id="ef179-144">Cuando el subproceso de destino entra en un estado de espera de alerta, esta información se quita de la cola y se realiza una llamada a la función APC en ese subproceso de destino y contexto de proceso.</span><span class="sxs-lookup"><span data-stu-id="ef179-144">When the target thread enters an alertable wait state, this information is dequeued and a call is made to the APC function in that target thread and process context.</span></span> <span data-ttu-id="ef179-145">Dado que el mecanismo APC solo admite un único valor de contexto de 32 bits, la función APC no puede ser la rutina de finalización especificada por el cliente, lo que implica más parámetros.</span><span class="sxs-lookup"><span data-stu-id="ef179-145">Because the APC mechanism supports only a single 32-bit context value, the APC function cannot itself be the client-specified completion routine, which involves more parameters.</span></span> <span data-ttu-id="ef179-146">En su lugar, el proveedor de servicios debe proporcionar un puntero a su propia función de APC que use el valor de contexto proporcionado para tener acceso a la información de los resultados necesarios para la operación superpuesta y, a continuación, invoca la rutina de finalización especificada por el cliente.</span><span class="sxs-lookup"><span data-stu-id="ef179-146">The service provider must instead supply a pointer to its own APC function which uses the supplied context value to access the needed result information for the overlapped operation, and then invokes the client-specified completion routine.</span></span>

<span data-ttu-id="ef179-147">En el caso de los proveedores de servicios en los que un componente de modo de usuario implementa la e/s superpuesta, un uso típico del mecanismo APC es el siguiente:</span><span class="sxs-lookup"><span data-stu-id="ef179-147">For service providers where a user-mode component implements overlapped I/O, a typical usage of the APC mechanism is as follows:</span></span>

-   <span data-ttu-id="ef179-148">Cuando se completa la operación de e/s, el proveedor asigna un búfer pequeño y lo empaqueta con un puntero al procedimiento de finalización proporcionado por el cliente y los valores de parámetro que se van a pasar al procedimiento.</span><span class="sxs-lookup"><span data-stu-id="ef179-148">When the I/O operation completes, the provider allocates a small buffer and packs it with a pointer to the client-supplied completion procedure and parameter values to pass to the procedure.</span></span>
-   <span data-ttu-id="ef179-149">Pone en cola un APC, especificando el puntero al búfer como el valor de contexto y su propio procedimiento intermedio como el procedimiento de destino.</span><span class="sxs-lookup"><span data-stu-id="ef179-149">It queues an APC, specifying the pointer to the buffer as the context value and its own intermediate procedure as the target procedure.</span></span>
-   <span data-ttu-id="ef179-150">Cuando el subproceso de destino entra en el estado de espera de alerta, se llama al procedimiento intermedio del proveedor de servicios en el contexto de subproceso adecuado.</span><span class="sxs-lookup"><span data-stu-id="ef179-150">When the target thread eventually enters alertable wait state, the service provider's intermediate procedure is called in the proper thread context.</span></span>
-   <span data-ttu-id="ef179-151">El procedimiento intermedio simplemente desempaqueta los parámetros, desasigna el búfer y llama al procedimiento de finalización proporcionado por el cliente.</span><span class="sxs-lookup"><span data-stu-id="ef179-151">The intermediate procedure simply unpacks parameters, deallocates the buffer, and calls the client-supplied completion procedure.</span></span>
-   <span data-ttu-id="ef179-152">En el caso de los proveedores de servicios en los que un componente de modo kernel implementa la e/s superpuesta, una implementación típica es similar, salvo que la implementación usaría interfaces de kernel estándar para poner en cola el APC.</span><span class="sxs-lookup"><span data-stu-id="ef179-152">For service providers where a kernel-mode component implements overlapped I/O, a typical implementation is similar, except that the implementation would use standard kernel interfaces to enqueue the APC.</span></span>

<span data-ttu-id="ef179-153">La descripción de las interfaces de kernel relevantes está fuera del ámbito de la especificación de Windows Sockets 2.</span><span class="sxs-lookup"><span data-stu-id="ef179-153">Description of the relevant kernel interfaces is outside the scope of the Windows Sockets 2 specification.</span></span>

> [!Note]  
> <span data-ttu-id="ef179-154">Los proveedores de servicios deben permitir a los clientes de Windows Sockets 2 invocar las operaciones de envío y recepción desde dentro del contexto de la rutina de finalización de e/s de socket y garantizar que para un socket determinado, las rutinas de finalización de e/s no se anidarán.</span><span class="sxs-lookup"><span data-stu-id="ef179-154">Service providers must allow Windows Sockets 2 clients to invoke send and receive operations from within the context of the socket I/O completion routine and guarantee that for a given socket, I/O completion routines will not be nested.</span></span>

 

<span data-ttu-id="ef179-155">En algunas circunstancias, un proveedor de servicios por niveles puede necesitar iniciar y completar las operaciones superpuestas desde dentro de un subproceso de trabajo interno.</span><span class="sxs-lookup"><span data-stu-id="ef179-155">Under some circumstances, a layered service provider may need to initiate and complete overlapped operations from within an internal worker thread.</span></span> <span data-ttu-id="ef179-156">En este caso, [**WSATHREADID**](/windows/desktop/api/Ws2spi/ns-ws2spi-wsathreadid) no estará disponible desde una llamada de función entrante.</span><span class="sxs-lookup"><span data-stu-id="ef179-156">In this case, a [**WSATHREADID**](/windows/desktop/api/Ws2spi/ns-ws2spi-wsathreadid) would not be available from an incoming function call.</span></span> <span data-ttu-id="ef179-157">La interfaz del proveedor de servicios proporciona una llamada a, [**WPUOpenCurrentThread**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuopencurrentthread), para obtener un **WSATHREADID** para el subproceso actual.</span><span class="sxs-lookup"><span data-stu-id="ef179-157">The service provider interface provides an upcall, [**WPUOpenCurrentThread**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuopencurrentthread), to obtain a **WSATHREADID** for the current thread.</span></span> <span data-ttu-id="ef179-158">Cuando ya no se necesita este **WSATHREADID** , se deben devolver sus recursos llamando a [**WPUCloseThread**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuclosethread).</span><span class="sxs-lookup"><span data-stu-id="ef179-158">When this **WSATHREADID** is no longer needed, its resources should be returned by calling [**WPUCloseThread**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuclosethread).</span></span>

 

 
