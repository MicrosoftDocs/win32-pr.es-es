---
description: Servicios de Certificate Server proporciona páginas de inscripción Web que se pueden usar para solicitar certificados.
ms.assetid: 1e198bc8-c712-4d0f-9e3a-35a295445acf
title: Personalización de las páginas de inscripción Web de servicios de certificados
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4eb2fbf421eceb1ebf0b15379aca5d0788a992ba
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "103913046"
---
# <a name="customizing-certificate-services-web-enrollment-pages"></a><span data-ttu-id="2e167-103">Personalización de las páginas de inscripción Web de servicios de certificados</span><span class="sxs-lookup"><span data-stu-id="2e167-103">Customizing Certificate Services Web Enrollment Pages</span></span>

<span data-ttu-id="2e167-104">[*Servicios de Certificate Server*](../secgloss/c-gly.md) proporciona páginas de inscripción Web que se pueden usar para solicitar certificados.</span><span class="sxs-lookup"><span data-stu-id="2e167-104">[*Certificate Services*](../secgloss/c-gly.md) provides web enrollment pages that can be used to request certificates.</span></span> <span data-ttu-id="2e167-105">Un administrador puede personalizar algunos de los elementos que se pueden ver en las páginas de inscripción Web. sin embargo, debe estar familiarizado con las páginas de inscripción Web y el scripting Web antes de realizar cambios.</span><span class="sxs-lookup"><span data-stu-id="2e167-105">An administrator can customize some of the items that can be viewed in the web enrollment pages; however, you should be familiar with the web enrollment pages and web scripting before making any changes.</span></span> <span data-ttu-id="2e167-106">Para obtener más información sobre el scripting Web, vea [scripting](/previous-versions/ms950396(v=msdn.10)).</span><span class="sxs-lookup"><span data-stu-id="2e167-106">For more information about web scripting, see [Scripting](/previous-versions/ms950396(v=msdn.10)).</span></span>

<span data-ttu-id="2e167-107">Los valores predeterminados para los campos de nombre distintivo de organización, unidad organizativa, localidad, estado y país o región son los valores especificados para la [*entidad de certificación*](../secgloss/c-gly.md) (CA) cuando se instala servicios de Certificate Server.</span><span class="sxs-lookup"><span data-stu-id="2e167-107">The default values for the Distinguished Name fields for Organization, Organizational Unit, Locality, State, and Country/Region are the values specified for the [*certification authority*](../secgloss/c-gly.md) (CA) when Certificate Services is installed.</span></span> <span data-ttu-id="2e167-108">Estos valores predeterminados aparecen en las páginas web y el usuario puede cambiarlos durante el proceso de inscripción de certificados.</span><span class="sxs-lookup"><span data-stu-id="2e167-108">These default values appear in the webpages and can be changed by the user during the certificate enrollment process.</span></span> <span data-ttu-id="2e167-109">Sin embargo, si desea que aparezcan otros valores predeterminados en las páginas web, puede editar el archivo certdat. Inc (en la ruta de acceso \\ *WindowsDirectory* \\ system32 \\ CertSrv \\ ); en concreto, puede asignar valores personalizados a las siguientes variables proporcionadas para la personalización.</span><span class="sxs-lookup"><span data-stu-id="2e167-109">However, if you want other default values to appear in the webpages, you can edit the Certdat.inc file (in the path \\*WindowsDirectory*\\System32\\Certsrv\\); specifically, you can assign custom values to the following variables provided for customization.</span></span>



| <span data-ttu-id="2e167-110">Variable</span><span class="sxs-lookup"><span data-stu-id="2e167-110">Variable</span></span>            | <span data-ttu-id="2e167-111">Descripción</span><span class="sxs-lookup"><span data-stu-id="2e167-111">Description</span></span>                                                                                                                                                                                                                               |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="2e167-112">sDefaultCompany</span><span class="sxs-lookup"><span data-stu-id="2e167-112">sDefaultCompany</span></span>     | <span data-ttu-id="2e167-113">Empresa predeterminada (aparece en la [*solicitud de certificado*](../secgloss/c-gly.md) como el campo organización [*X. 509*](../secgloss/x-gly.md) ).</span><span class="sxs-lookup"><span data-stu-id="2e167-113">Default company (appears in the [*certificate request*](../secgloss/c-gly.md) as the [*X.509*](../secgloss/x-gly.md) Organization field).</span></span> |
| <span data-ttu-id="2e167-114">sDefaultOrgUnit</span><span class="sxs-lookup"><span data-stu-id="2e167-114">sDefaultOrgUnit</span></span>     | <span data-ttu-id="2e167-115">Departamento predeterminado (aparece en la solicitud de certificado como el campo de unidad organizativa X. 509).</span><span class="sxs-lookup"><span data-stu-id="2e167-115">Default department (appears in the certificate request as the X.509 Organizational Unit field).</span></span>                                                                                                                                           |
| <span data-ttu-id="2e167-116">sDefaultLocality</span><span class="sxs-lookup"><span data-stu-id="2e167-116">sDefaultLocality</span></span>    | <span data-ttu-id="2e167-117">Ciudad predeterminada (aparece en la solicitud de certificado como el campo de ubicación X. 509).</span><span class="sxs-lookup"><span data-stu-id="2e167-117">Default city (appears in the certificate request as the X.509 Location field).</span></span>                                                                                                                                                            |
| <span data-ttu-id="2e167-118">sDefaultState</span><span class="sxs-lookup"><span data-stu-id="2e167-118">sDefaultState</span></span>       | <span data-ttu-id="2e167-119">Estado o provincia predeterminados (aparece en la solicitud de certificado como el campo de estado X. 509).</span><span class="sxs-lookup"><span data-stu-id="2e167-119">Default state/province (appears in the certificate request as the X.509 State field).</span></span>                                                                                                                                                     |
| <span data-ttu-id="2e167-120">sDefaultCountry</span><span class="sxs-lookup"><span data-stu-id="2e167-120">sDefaultCountry</span></span>     | <span data-ttu-id="2e167-121">País o región predeterminados (aparece en la solicitud de certificado como el campo de país o región X. 509).</span><span class="sxs-lookup"><span data-stu-id="2e167-121">Default country/region (appears in the certificate request as the X.509 Country/Region field).</span></span>                                                                                                                                            |
| <span data-ttu-id="2e167-122">nPendingTimeoutDays</span><span class="sxs-lookup"><span data-stu-id="2e167-122">nPendingTimeoutDays</span></span> | <span data-ttu-id="2e167-123">Número de días en los que el usuario puede recuperar un certificado pendiente después de solicitarlo.</span><span class="sxs-lookup"><span data-stu-id="2e167-123">Number of days in which the user can retrieve a pending certificate after it has been requested.</span></span>                                                                                                                                          |



 

<span data-ttu-id="2e167-124">No se deben cambiar otras variables en el archivo certdat. Inc.</span><span class="sxs-lookup"><span data-stu-id="2e167-124">No other variables should be changed in the Certdat.inc file.</span></span>

<span data-ttu-id="2e167-125">En el ejemplo siguiente se establece la unidad organizativa predeterminada en "Marketing".</span><span class="sxs-lookup"><span data-stu-id="2e167-125">The following example sets the default Organizational Unit to "Marketing".</span></span>


```VB
sDefaultOrgUnit="Marketing"
```



<span data-ttu-id="2e167-126">Además, puede editar el archivo Certrqtp. Inc para agregar, cambiar o quitar plantillas de [*certificado*](../secgloss/c-gly.md) o tipos disponibles para el usuario.</span><span class="sxs-lookup"><span data-stu-id="2e167-126">Additionally, you can edit the Certrqtp.inc file to add, change, or remove [*certificate templates*](../secgloss/c-gly.md) or types available to the user.</span></span> <span data-ttu-id="2e167-127">Estas plantillas y tipos, así como información relacionada, se encuentran en una matriz con dimensiones denominada rgAvailReqTypes (*m*, 5).</span><span class="sxs-lookup"><span data-stu-id="2e167-127">These templates and types, as well as related information, are contained in a dimensioned array called rgAvailReqTypes(*m*,5).</span></span>

<span data-ttu-id="2e167-128">Esta matriz, como todas Visual Basic Scripting Edition matrices, está basada en cero y, como resultado, la primera dimensión de la matriz, *m*, asigna memoria para los elementos *m*+ 1.</span><span class="sxs-lookup"><span data-stu-id="2e167-128">This array, like all Visual Basic Scripting Edition arrays, is zero based, and as a result, the array's first dimension, *m*, allocates memory for *m*+1 items.</span></span> <span data-ttu-id="2e167-129">Por lo tanto, si en la personalización de las páginas web necesita modificar el número de elementos de la matriz rgAvailReqTypes, establezca la dimensión *m* en uno menos que el número total de elementos que necesita.</span><span class="sxs-lookup"><span data-stu-id="2e167-129">Therefore, if in customizing the webpages, you need to modify the number of items in the rgAvailReqTypes array, set the *m* dimension to one less than the total number of items you need.</span></span> <span data-ttu-id="2e167-130">Por ejemplo, si va a tener siete plantillas de certificado, cambie la declaración de rgAvailReqTypes como se muestra en el ejemplo siguiente.</span><span class="sxs-lookup"><span data-stu-id="2e167-130">For example, if you will have seven certificate templates, change the declaration of rgAvailReqTypes as shown in the following example.</span></span>


```VB
Dim rgAvailReqTypes(6,5)
```



<span data-ttu-id="2e167-131">La segunda dimensión de la matriz, que siempre tiene el valor cinco, asigna los seis campos que componen cada elemento.</span><span class="sxs-lookup"><span data-stu-id="2e167-131">The array's second dimension, which always has the value five, allocates the six fields that compose each item.</span></span> <span data-ttu-id="2e167-132">Estos seis campos representan la plantilla o el tipo de certificado, el nombre para mostrar asociado a esta plantilla o tipo y si la plantilla requiere [*extensiones seguras multipropósito de correo Internet*](../secgloss/s-gly.md) (S/MIME).</span><span class="sxs-lookup"><span data-stu-id="2e167-132">These six fields represent the certificate template or type, the display name associated with this template or type, and whether the template requires [*Secure/Multipurpose Internet Mail Extensions*](../secgloss/s-gly.md) (S/MIME).</span></span>

<span data-ttu-id="2e167-133">Para facilitar la comprensión de los campos a los que se tiene acceso, Certrqtp. Inc también proporciona las siguientes constantes que se pueden usar al establecer los valores de los campos.</span><span class="sxs-lookup"><span data-stu-id="2e167-133">To make it easier to understand which of these fields is being accessed, Certrqtp.inc also provides the following constants you can use when setting field values.</span></span>



| <span data-ttu-id="2e167-134">Constante</span><span class="sxs-lookup"><span data-stu-id="2e167-134">Constant</span></span>                              | <span data-ttu-id="2e167-135">Descripción</span><span class="sxs-lookup"><span data-stu-id="2e167-135">Description</span></span>                                                                                                                                                                                                                                                                                                                          |
|---------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="2e167-136">**OID del campo \_**</span><span class="sxs-lookup"><span data-stu-id="2e167-136">**FIELD\_OID**</span></span>                        | <span data-ttu-id="2e167-137">(Se aplica a las CA independientes) Índice del primer campo del elemento; representa un [*identificador de objeto*](../secgloss/o-gly.md) (OID) para un tipo de certificado.</span><span class="sxs-lookup"><span data-stu-id="2e167-137">(Applies to stand-alone CAs) Index to the item's first field; represents an [*object identifier*](../secgloss/o-gly.md) (OID) for a certificate type.</span></span><br/>                                                                                                           |
| <span data-ttu-id="2e167-138">**plantilla de campo \_**</span><span class="sxs-lookup"><span data-stu-id="2e167-138">**FIELD\_TEMPLATE**</span></span>                   | <span data-ttu-id="2e167-139">(Se aplica a las CA de empresa) Índice del primer campo del elemento; representa una plantilla de certificado.</span><span class="sxs-lookup"><span data-stu-id="2e167-139">(Applies to enterprise CAs) Index to the item's first field; represents a certificate template.</span></span><br/>                                                                                                                                                                                                                           |
| <span data-ttu-id="2e167-140">**CAMPO \_ FRIENDLYNAME**</span><span class="sxs-lookup"><span data-stu-id="2e167-140">**FIELD\_FRIENDLYNAME**</span></span>               | <span data-ttu-id="2e167-141">Índice del segundo campo del elemento; representa el nombre para mostrar (que el usuario verá al inscribirse) del elemento en el primer campo.</span><span class="sxs-lookup"><span data-stu-id="2e167-141">Index to the item's second field; represents the display name (which the user will see when enrolling) of the item in the first field.</span></span>                                                                                                                                                                                               |
| <span data-ttu-id="2e167-142">**CAMPO \_ CSPLIST**</span><span class="sxs-lookup"><span data-stu-id="2e167-142">**FIELD\_CSPLIST**</span></span>                    | <span data-ttu-id="2e167-143">Índice del tercer campo del elemento.</span><span class="sxs-lookup"><span data-stu-id="2e167-143">Index to the item's third field.</span></span> <span data-ttu-id="2e167-144">Una lista de nombres de [*proveedores de servicios de cifrado*](../secgloss/c-gly.md) permitidos por la plantilla.</span><span class="sxs-lookup"><span data-stu-id="2e167-144">A list of [*Cryptographic Service Provider*](../secgloss/c-gly.md) names allowed by the template.</span></span> <span data-ttu-id="2e167-145">Cada nombre de la lista está separado por un signo de interrogación (?).</span><span class="sxs-lookup"><span data-stu-id="2e167-145">Each name in the list is separated by a question mark (?).</span></span>                                                    |
| <span data-ttu-id="2e167-146">**CAMPO \_ CSPLIST2**</span><span class="sxs-lookup"><span data-stu-id="2e167-146">**FIELD\_CSPLIST2**</span></span>                   | <span data-ttu-id="2e167-147">Índice del cuarto campo del elemento.</span><span class="sxs-lookup"><span data-stu-id="2e167-147">Index to the item's fourth field.</span></span> <span data-ttu-id="2e167-148">Lista secundaria de nombres de [*proveedores de servicios de cifrado*](../secgloss/c-gly.md) permitidos por la plantilla.</span><span class="sxs-lookup"><span data-stu-id="2e167-148">A secondary list of [*Cryptographic Service Provider*](../secgloss/c-gly.md) names allowed by the template.</span></span> <span data-ttu-id="2e167-149">Cada nombre de la lista está separado por un signo de interrogación (?).</span><span class="sxs-lookup"><span data-stu-id="2e167-149">Each name in the list is separated by a question mark (?).</span></span> <span data-ttu-id="2e167-150">Esta lista proporciona un valor predeterminado diferente.</span><span class="sxs-lookup"><span data-stu-id="2e167-150">This list provides a different default.</span></span> |
| <span data-ttu-id="2e167-151">**CAMPO \_ EXportable**</span><span class="sxs-lookup"><span data-stu-id="2e167-151">**FIELD\_EXPORTABLE**</span></span>                 | <span data-ttu-id="2e167-152">Índice del quinto campo del elemento.</span><span class="sxs-lookup"><span data-stu-id="2e167-152">Index to the item's fifth field.</span></span> <span data-ttu-id="2e167-153">Indica si la plantilla especifica que la clave debe ser exportable.</span><span class="sxs-lookup"><span data-stu-id="2e167-153">Indicates whether the template specifies that the key should be exportable.</span></span> <span data-ttu-id="2e167-154">Si este campo contiene "true", la clave es exportable.</span><span class="sxs-lookup"><span data-stu-id="2e167-154">If this field contains "True", the key is exportable.</span></span> <span data-ttu-id="2e167-155">Si este campo contiene "false", la clave no se exportable.</span><span class="sxs-lookup"><span data-stu-id="2e167-155">If this field contains "False", the key is not exportable.</span></span>                                                                                                        |
| <span data-ttu-id="2e167-156">**el \_ campo \_ necesita \_ funcionalidades SMIME**</span><span class="sxs-lookup"><span data-stu-id="2e167-156">**FIELD\_NEEDS\_SMIME\_CAPABILITIES**</span></span> | <span data-ttu-id="2e167-157">Esta constante no se admite.</span><span class="sxs-lookup"><span data-stu-id="2e167-157">This constant is not supported.</span></span>                                                                                                                                                                                                                                                                                                      |



 

<span data-ttu-id="2e167-158">Por ejemplo, las expresiones siguientes asignan el OID de 1.3.6.1.5.5.7.3.2 al primer campo del primer elemento y asignan "certificado de explorador Web" al segundo campo del primer elemento (el valor de matriz de cero indiza el primer elemento).</span><span class="sxs-lookup"><span data-stu-id="2e167-158">For example, the following expressions assign the OID of 1.3.6.1.5.5.7.3.2 to the first item's first field and assign "Web Browser Certificate" to the first item's second field (the array value of zero indexes the first item).</span></span>


```VB
rgAvailReqTypes(0, FIELD_OID) = "1.3.6.1.5.5.7.3.2"
rgAvailReqTypes(0, FIELD_FRIENDLYNAME) = "Web Browser Certificate"
```



<span data-ttu-id="2e167-159">El resultado de estas asignaciones es que el usuario verá el **certificado del explorador Web** de texto al inscribirse y, si el usuario selecciona el certificado del **explorador Web**, la [*solicitud de certificado*](../secgloss/c-gly.md) contendrá el OID 1.3.6.1.5.5.7.3.2.</span><span class="sxs-lookup"><span data-stu-id="2e167-159">The result of these assignments is that the user will see the text **Web Browser Certificate** when enrolling, and if the user selects **Web Browser Certificate**, the [*certificate request*](../secgloss/c-gly.md) will contain the OID 1.3.6.1.5.5.7.3.2.</span></span>

<span data-ttu-id="2e167-160">El archivo Certrqtp. Inc también contiene constantes que se usan para mostrar los nombres de las plantillas de certificado o los tipos.</span><span class="sxs-lookup"><span data-stu-id="2e167-160">The Certrqtp.inc file also contains constants that are used for the display names of the certificate templates or types.</span></span> <span data-ttu-id="2e167-161">En el siguiente ejemplo se muestra el formato.</span><span class="sxs-lookup"><span data-stu-id="2e167-161">The following example shows the format.</span></span>


```VB
' Strings for localization.
Const L_WebBrowserCert_Text="Web Browser Certificate"
Const L_EmailProtectionCert_Text="E-Mail Protection Certificate"
Const L_UserTemplateCert_Text="User Certificate"
```



<span data-ttu-id="2e167-162">Estas constantes se definen en un bloque en el archivo Certrqtp. Inc y esta agrupación facilita la asignación de cada uno de ellos a un valor personalizado.</span><span class="sxs-lookup"><span data-stu-id="2e167-162">These constants are defined in a block in the Certrqtp.inc file, and this grouping makes it easier to assign each of them a custom value.</span></span> <span data-ttu-id="2e167-163">Esto es especialmente útil cuando se localizan los nombres para mostrar de las versiones internacionales de las páginas Web.</span><span class="sxs-lookup"><span data-stu-id="2e167-163">This is particularly helpful when you localize the display names for international versions of the webpages.</span></span>

<span data-ttu-id="2e167-164">Por último, el archivo Certrqtp. Inc contiene una variable que representa el número de plantillas de certificado o tipos de la matriz rgAvailReqTypes.</span><span class="sxs-lookup"><span data-stu-id="2e167-164">Finally, the Certrqtp.inc file contains a variable that represents the number of certificate templates or types in the rgAvailReqTypes array.</span></span> <span data-ttu-id="2e167-165">A diferencia de la dimensión *m* de la matriz, establezca el valor de la variable nAvailReqTypes en el número real de plantillas de certificado o tipos que utilizará la instalación. Este valor no debe ser mayor que *m*+ 1.</span><span class="sxs-lookup"><span data-stu-id="2e167-165">In contrast to the *m* dimension of the array, set the value of the nAvailReqTypes variable to the actual number of certificate templates or types that your installation will use; this value must be no larger than *m*+1.</span></span> <span data-ttu-id="2e167-166">Aunque se declara cerca de la parte superior del archivo Certrqtp. Inc, se asigna un valor a nAvailReqTypes una vez que se rellena la matriz rgAvailReqTypes, lo que facilita la visualización del número de elementos que se usan realmente en la matriz.</span><span class="sxs-lookup"><span data-stu-id="2e167-166">Although declared near the top of the Certrqtp.inc file, nAvailReqTypes is assigned a value after the rgAvailReqTypes array is populated, making it easier to see how many elements are actually used by the array.</span></span> <span data-ttu-id="2e167-167">El valor nAvailReqTypes se usa en una iteración en otra parte de las páginas de inscripción Web, por lo que es importante que esta variable refleje con precisión el número de plantillas de certificado o los tipos que desea que sean visibles para el usuario.</span><span class="sxs-lookup"><span data-stu-id="2e167-167">The nAvailReqTypes value is used in an iteration elsewhere in the web enrollment pages, so it is important that this variable accurately reflect the number of certificate templates or types that you want to be viewable to the user.</span></span>

<span data-ttu-id="2e167-168">Tenga en cuenta que, al agregar simplemente plantillas y tipos de [*certificado*](../secgloss/c-gly.md) al archivo Certrqtp. Inc, no se garantiza que el usuario pueda obtener un certificado con esos rasgos. la entidad de certificación debe estar autorizada para emitir un certificado para la plantilla de certificado especificada o el tipo.</span><span class="sxs-lookup"><span data-stu-id="2e167-168">Note that merely adding [*certificate templates*](../secgloss/c-gly.md) and types to the Certrqtp.inc file does not guarantee that the user will be able to get a certificate with those traits; the CA must be authorized to issue a certificate for the specified certificate template or type.</span></span>

<span data-ttu-id="2e167-169">Las instalaciones pueden crear sus propias aplicaciones o páginas web para solicitar y recibir un certificado.</span><span class="sxs-lookup"><span data-stu-id="2e167-169">Installations can create their own applications or webpages to request and receive a certificate.</span></span> <span data-ttu-id="2e167-170">Los objetos [**ICEnroll4**](/windows/desktop/api/Xenroll/nn-xenroll-icenroll4) y [**ICertRequest2**](/windows/desktop/api/Certcli/nn-certcli-icertrequest2) permiten a los programadores o generadores de scripts crear aplicaciones de [*solicitud de certificado*](../secgloss/c-gly.md) .</span><span class="sxs-lookup"><span data-stu-id="2e167-170">The [**ICEnroll4**](/windows/desktop/api/Xenroll/nn-xenroll-icenroll4) and [**ICertRequest2**](/windows/desktop/api/Certcli/nn-certcli-icertrequest2) objects allow programmers or scripters to build [*certificate request*](../secgloss/c-gly.md) applications.</span></span>

<span data-ttu-id="2e167-171">Para solicitar un certificado que se va a emitir en una [*tarjeta inteligente*](../secgloss/s-gly.md), puede usar el control de inscripción de tarjetas inteligentes.</span><span class="sxs-lookup"><span data-stu-id="2e167-171">To request a certificate to be issued on a [*smart card*](../secgloss/s-gly.md), you can use the Smart Card Enrollment Control.</span></span> <span data-ttu-id="2e167-172">Para obtener más información y código de ejemplo, vea [**ISCrdEnr**](iscrdenr.md).</span><span class="sxs-lookup"><span data-stu-id="2e167-172">For details and example code, see [**ISCrdEnr**](iscrdenr.md).</span></span>

 

 
