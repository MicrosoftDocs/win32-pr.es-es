---
description: Obtenga información sobre cómo establecer propiedades en el receptor de archivos ASF, que una aplicación puede usar para archivar datos multimedia de ASF en un archivo.
ms.assetid: a47caabd-23e3-4d22-b4b6-5fdb79d62ca1
title: Establecer propiedades en el receptor de archivos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 64b6b000ed04c7858251f7388d3edc6a40e0b213
ms.sourcegitcommit: 5d4e99f4c8f42f5f543e52cb9beb9fb13ec56c5f
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/19/2021
ms.locfileid: "112407518"
---
# <a name="setting-properties-in-the-file-sink"></a><span data-ttu-id="ceb01-103">Establecer propiedades en el receptor de archivos</span><span class="sxs-lookup"><span data-stu-id="ceb01-103">Setting Properties in the File Sink</span></span>

<span data-ttu-id="ceb01-104">El receptor de archivos DE ASF es una implementación de [**IMFMediaSink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) proporcionada por Media Foundation que una aplicación puede usar para archivar datos multimedia de ASF en un archivo.</span><span class="sxs-lookup"><span data-stu-id="ceb01-104">The ASF file sink is an implementation of [**IMFMediaSink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) provided by Media Foundation that an application can use to archive ASF media data to a file.</span></span> <span data-ttu-id="ceb01-105">Para obtener información sobre el modelo de objetos de los receptores de medios de ASF y el uso general, vea [Receptores multimedia de ASF.](asf-media-sinks.md)</span><span class="sxs-lookup"><span data-stu-id="ceb01-105">For information about ASF Media Sinks' object model and general usage, see [ASF Media Sinks](asf-media-sinks.md).</span></span>

<span data-ttu-id="ceb01-106">Después [de crear el receptor de archivos ASF,](creating-the-asf-file-sink.md)debe configurarse con información sobre los flujos del archivo de salida.</span><span class="sxs-lookup"><span data-stu-id="ceb01-106">After [Creating the ASF file sink](creating-the-asf-file-sink.md), it must be configured with information about the streams in the output file.</span></span> <span data-ttu-id="ceb01-107">Este procedimiento se describe en [Adding Stream Information to the ASF File Sink](adding-stream-information-to-the-asf-file-sink.md).</span><span class="sxs-lookup"><span data-stu-id="ceb01-107">This procedure is described in [Adding Stream Information to the ASF File Sink](adding-stream-information-to-the-asf-file-sink.md).</span></span> <span data-ttu-id="ceb01-108">Puede establecer propiedades adicionales en el receptor de archivos en función del tipo de codificación; cubos con pérdidas; propiedades generales del archivo.</span><span class="sxs-lookup"><span data-stu-id="ceb01-108">You can set additional properties on the file sink depending on the type of encoding; leaky buckets; general file properties.</span></span> <span data-ttu-id="ceb01-109">Esta configuración no se escribe en el objeto de encabezado asf final.</span><span class="sxs-lookup"><span data-stu-id="ceb01-109">These settings are not written in the final ASF Header Object.</span></span> <span data-ttu-id="ceb01-110">En este tema se describe el proceso de agregar estas propiedades en el almacén de propiedades del receptor de archivos.</span><span class="sxs-lookup"><span data-stu-id="ceb01-110">This topic describes process of adding these properties in the file sink's property store.</span></span>

<span data-ttu-id="ceb01-111">El objeto ContentInfo mantiene las propiedades de archivo global y las propiedades de secuencia individuales para el receptor de archivos.</span><span class="sxs-lookup"><span data-stu-id="ceb01-111">The ContentInfo object maintains the global file properties and individual stream properties for the file sink.</span></span> <span data-ttu-id="ceb01-112">Para obtener información sobre cómo obtener una referencia al objeto ContentInfo de ASF del receptor de archivos, vea [Creating the ASF File Sink](creating-the-asf-file-sink.md).</span><span class="sxs-lookup"><span data-stu-id="ceb01-112">For information about getting a reference to the file sink's ASF ContentInfo object, see [Creating the ASF File Sink](creating-the-asf-file-sink.md).</span></span>

<span data-ttu-id="ceb01-113">Para obtener una referencia al almacén de propiedades del receptor de archivos ([**IPropertyStore),**](/windows/win32/api/propsys/nn-propsys-ipropertystore)llame a [**IMFASFContentInfo::GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) en la referencia del objeto ContentInfo del receptor de archivos.</span><span class="sxs-lookup"><span data-stu-id="ceb01-113">To get a reference to the file sink's property store ([**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore)), call [**IMFASFContentInfo::GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) on the file sink's ContentInfo object's reference.</span></span>

## <a name="stream-encoding-properties"></a><span data-ttu-id="ceb01-114">Propiedades de codificación de secuencias</span><span class="sxs-lookup"><span data-stu-id="ceb01-114">Stream Encoding Properties</span></span>

<span data-ttu-id="ceb01-115">Para codificar el contenido correctamente, el archivo debe conocer cierta información de codificación, como el tipo de codificación y los parámetros de codificación relacionados.</span><span class="sxs-lookup"><span data-stu-id="ceb01-115">To encode content properly the file needs to know certain encoding information such as type of encoding and the related encoding parameters.</span></span> <span data-ttu-id="ceb01-116">Estos valores se establecen en el receptor de archivos como valores de propiedad en un almacén de propiedades que mantiene el objeto ContentInfo de ASF.</span><span class="sxs-lookup"><span data-stu-id="ceb01-116">These values are set on the file sink as property values in a property store that is maintained by the ASF ContentInfo object.</span></span> <span data-ttu-id="ceb01-117">Si va a configurar el receptor de archivos antes de crear instancias de los codificadores pertinentes, puede usar el objeto ContentInfo con todas las propiedades rellenadas para crear los codificadores de Windows Media.</span><span class="sxs-lookup"><span data-stu-id="ceb01-117">If you are configuring the file sink before instantiating the relevant encoders, you can use the ContentInfo object with all the populated properties to create the Windows Media encoders.</span></span> <span data-ttu-id="ceb01-118">En este caso, las propiedades se establecen automáticamente en los codificadores con instancias.</span><span class="sxs-lookup"><span data-stu-id="ceb01-118">In this case, the properties are automatically set on the instantiated encoders.</span></span> <span data-ttu-id="ceb01-119">Por el contrario, si va a crear los codificadores antes del receptor, asegúrese de que las propiedades establecidas en los codificadores se copian en el almacén de propiedades del receptor de archivos.</span><span class="sxs-lookup"><span data-stu-id="ceb01-119">Conversely, if you are creating the encoders before the sink, make sure that the properties that you set on the encoders are copied into the file sink's property store.</span></span>

<span data-ttu-id="ceb01-120">Para establecer las propiedades de codificación, necesita acceso al almacén de propiedades de nivel de secuencia del receptor de archivos.</span><span class="sxs-lookup"><span data-stu-id="ceb01-120">To set encoding properties, you need access to the file sink's stream-level property store.</span></span> <span data-ttu-id="ceb01-121">Pase el número de secuencia en el *parámetro wStreamNumber* del método [**IMFASFContentInfo::GetEncodingConfigurationPropertyStore.**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore)</span><span class="sxs-lookup"><span data-stu-id="ceb01-121">Pass the stream number in the *wStreamNumber* parameter of the [**IMFASFContentInfo::GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) method.</span></span> <span data-ttu-id="ceb01-122">Los números de secuencia deben coincidir con los valores establecidos al configurar cada secuencia en el perfil.</span><span class="sxs-lookup"><span data-stu-id="ceb01-122">The stream numbers must match the values set while configuring each stream in the profile.</span></span> <span data-ttu-id="ceb01-123">Los valores de propiedad se establecen mediante una [**llamada a IPropertyStore::SetValue**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span><span class="sxs-lookup"><span data-stu-id="ceb01-123">Property values are set by calling [**IPropertyStore::SetValue**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span></span> <span data-ttu-id="ceb01-124">En la tabla siguiente se describen las propiedades admitidas.</span><span class="sxs-lookup"><span data-stu-id="ceb01-124">The following table describes the supported properties.</span></span>

<span data-ttu-id="ceb01-125">Las propiedades dependen del tipo de codificación.</span><span class="sxs-lookup"><span data-stu-id="ceb01-125">The properties depend on the type of encoding.</span></span> <span data-ttu-id="ceb01-126">Para obtener información sobre las propiedades y los valores respectivos que debe establecer, vea [Propiedades de codificación](configuring-the-encoder.md).</span><span class="sxs-lookup"><span data-stu-id="ceb01-126">For information about the properties and the respective values that you must set, see [Encoding Properties](configuring-the-encoder.md).</span></span>

## <a name="leaky-bucket-property"></a><span data-ttu-id="ceb01-127">Propiedad leaky bucket</span><span class="sxs-lookup"><span data-stu-id="ceb01-127">Leaky Bucket Property</span></span>

<span data-ttu-id="ceb01-128">Los parámetros de depósito con pérdida determinan la ventana de búfer real que usa el codificador para la secuencia.</span><span class="sxs-lookup"><span data-stu-id="ceb01-128">Leaky bucket parameters determine the actual buffer window used by the encoder for the stream.</span></span> <span data-ttu-id="ceb01-129">La propiedad [**MFPKEY \_ ASFSTREAMSINK \_ CORRECTED \_ LEAKYBUCKET**](mfpkey-asfstreamsink-corrected-leakybucket-property.md) del receptor de archivos contiene los parámetros del depósito de pérdidas, la velocidad de bits, la ventana de búfer y la integridad inicial del búfer. Esta propiedad se establece en el almacén de propiedades de nivel de secuencia para el receptor de archivos y debe establecerse una vez creados y configurados los codificadores.</span><span class="sxs-lookup"><span data-stu-id="ceb01-129">The file sink's [**MFPKEY\_ASFSTREAMSINK\_CORRECTED\_LEAKYBUCKET**](mfpkey-asfstreamsink-corrected-leakybucket-property.md) property contains the leaky bucket parameters, bit rate, buffer window, and initial buffer fullness.This property is set in the stream-level property property store for the file sink and must be set after encoders have been created and configured.</span></span> <span data-ttu-id="ceb01-130">Este valor se establece en .</span><span class="sxs-lookup"><span data-stu-id="ceb01-130">This value is set in the .</span></span> <span data-ttu-id="ceb01-131">Durante la negociación del tipo de medio, el codificador decide la ventana de búfer y la velocidad de bits que se usará.</span><span class="sxs-lookup"><span data-stu-id="ceb01-131">During the media type negotiation, the encoder decides the buffer window and the bit rate to use.</span></span> <span data-ttu-id="ceb01-132">Puede obtener estos valores mediante la interfaz **IWMCodecLeakyBucket,** que se define en wmcodecifaces.h y debe vincular a wmcodecdspuuid.lib para llamar a sus métodos.</span><span class="sxs-lookup"><span data-stu-id="ceb01-132">You can get these values by using the **IWMCodecLeakyBucket** interface, which is defined in wmcodecifaces.h and you must link to wmcodecdspuuid.lib to call its methods.</span></span>

<span data-ttu-id="ceb01-133">Los valores recuperados se pueden establecer para esta propiedad para cada secuencia del receptor de archivos ASF.</span><span class="sxs-lookup"><span data-stu-id="ceb01-133">The retrieved values can be set for this property for each stream in the ASF file sink.</span></span>

## <a name="global-file-sink-properties"></a><span data-ttu-id="ceb01-134">Propiedades del receptor global de archivos</span><span class="sxs-lookup"><span data-stu-id="ceb01-134">Global File Sink Properties</span></span>

<span data-ttu-id="ceb01-135">Para obtener el almacén de propiedades global del receptor de archivos, pase 0 en el parámetro *wStreamNumber* del método [**IMFASFContentInfo::GetEncodingConfigurationPropertyStore.**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore)</span><span class="sxs-lookup"><span data-stu-id="ceb01-135">To get the file sink's global property store, pass 0 in the *wStreamNumber* parameter of the [**IMFASFContentInfo::GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) method.</span></span> <span data-ttu-id="ceb01-136">Los valores de propiedad se establecen mediante una [**llamada a IPropertyStore::SetValue**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span><span class="sxs-lookup"><span data-stu-id="ceb01-136">Property values are set by calling [**IPropertyStore::SetValue**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span></span> <span data-ttu-id="ceb01-137">En la tabla siguiente se describen las propiedades admitidas.</span><span class="sxs-lookup"><span data-stu-id="ceb01-137">The following table describes the supported properties.</span></span>

| <span data-ttu-id="ceb01-138">Propiedades de nivel de archivo</span><span class="sxs-lookup"><span data-stu-id="ceb01-138">File-level Properties</span></span>                                                                                | <span data-ttu-id="ceb01-139">Descripción</span><span class="sxs-lookup"><span data-stu-id="ceb01-139">Description</span></span>                                                                                                                                                                                                                                                                                           |
|------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="ceb01-140">**MFPKEY \_ ASFMEDIASINK \_ BASE \_ SENDTIME**</span><span class="sxs-lookup"><span data-stu-id="ceb01-140">**MFPKEY\_ASFMEDIASINK\_BASE\_SENDTIME**</span></span>](mfpkey-asfmediasink-base-sendtime-property.md)           | <span data-ttu-id="ceb01-141">El tiempo de envío indica cuándo se liberará la carga dentro del depósito de pérdidas.</span><span class="sxs-lookup"><span data-stu-id="ceb01-141">The send time indicates when the payload inside the leaky bucket will be released.</span></span> <span data-ttu-id="ceb01-142">Este valor de propiedad indica la primera hora de envío.</span><span class="sxs-lookup"><span data-stu-id="ceb01-142">This property value indicates the first send time.</span></span> <span data-ttu-id="ceb01-143">El multiplexor usa este valor para calcular los tiempos de envío subsiguientes de los paquetes generados y garantiza que los datos fluyen constantemente a través del cubo de pérdidas.</span><span class="sxs-lookup"><span data-stu-id="ceb01-143">The multiplexer uses this value to calculate the subsequent send times for the generated packets and ensures that data flows steadily through the leaky bucket.</span></span> |
| [<span data-ttu-id="ceb01-144">**MFPKEY \_ ASFMEDIASINK \_ AUTOADJUST \_ BITRATE**</span><span class="sxs-lookup"><span data-stu-id="ceb01-144">**MFPKEY\_ASFMEDIASINK\_AUTOADJUST\_BITRATE**</span></span>](mfpkey-asfmediasink-autoadjust-bitrate-property.md) | <span data-ttu-id="ceb01-145">Este valor BOOL indica si el multiplexor debe ajustar la velocidad de bits automáticamente para asegurarse de que los datos no desbordan el cubo con pérdidas.</span><span class="sxs-lookup"><span data-stu-id="ceb01-145">This BOOL value indicates whether the multiplexer needs to adjust the bit rate automatically to ensure that data does not overflow the leaky bucket.</span></span>                                                                                                                                                  |
| [<span data-ttu-id="ceb01-146">**MFPKEY \_ ASFMEDIASINK \_ DRMACTION**</span><span class="sxs-lookup"><span data-stu-id="ceb01-146">**MFPKEY\_ASFMEDIASINK\_DRMACTION**</span></span>](mfpkey-asfmediasink-drmaction-property.md)                    | <span data-ttu-id="ceb01-147">Esto indica la acción DRM del receptor de medios de ASF para la generación de archivos.</span><span class="sxs-lookup"><span data-stu-id="ceb01-147">This indicates the ASF media sink DRM action for file generation.</span></span> <span data-ttu-id="ceb01-148">En esta versión, solo se admite la transcodificación DRM.</span><span class="sxs-lookup"><span data-stu-id="ceb01-148">In this release, only DRM transcode is supported.</span></span>                                                                                                                                                                                   |



 

## <a name="related-topics"></a><span data-ttu-id="ceb01-149">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="ceb01-149">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ceb01-150">Receptores multimedia de ASF</span><span class="sxs-lookup"><span data-stu-id="ceb01-150">ASF Media Sinks</span></span>](asf-media-sinks.md)
</dt> <dt>

[<span data-ttu-id="ceb01-151">Componentes de ASF de capa de canalización</span><span class="sxs-lookup"><span data-stu-id="ceb01-151">Pipeline Layer ASF Components</span></span>](pipeline-layer-asf-components.md)
</dt> <dt>

[<span data-ttu-id="ceb01-152">Compatibilidad con ASF en Media Foundation</span><span class="sxs-lookup"><span data-stu-id="ceb01-152">ASF Support in Media Foundation</span></span>](asf-support-in-media-foundation.md)
</dt> </dl>

 

 
