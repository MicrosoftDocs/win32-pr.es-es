---
title: IEnumSTATPROPSETSTG-Compound la implementación de archivos
description: La implementación de archivo compuesto de la interfaz IEnumSTATPROPSETSTG se usa para enumerar una matriz de estructuras STATPROPSETSTG que contienen datos de propiedad estadísticos.
ms.assetid: 1ce36e40-518c-411b-be5a-835a2dd0995e
keywords:
- IEnumSTATPROPSETSTG Strctd STG, implementación de archivo compuesto
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9566af1a1956b3a951a996b6198f4a3161680042
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104359040"
---
# <a name="ienumstatpropsetstg-compound-file-implementation"></a><span data-ttu-id="8246b-104">IEnumSTATPROPSETSTG-Compound la implementación de archivos</span><span class="sxs-lookup"><span data-stu-id="8246b-104">IEnumSTATPROPSETSTG-Compound File Implementation</span></span>

<span data-ttu-id="8246b-105">La implementación de archivo compuesto de la interfaz [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) se usa para enumerar una matriz de estructuras [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) que contienen datos de propiedad estadísticos.</span><span class="sxs-lookup"><span data-stu-id="8246b-105">The compound file implementation of the [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) interface is used to enumerate an array of [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures that contain statistical property data.</span></span> <span data-ttu-id="8246b-106">La implementación de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) administra los datos estadísticos y está asociado a un objeto de almacenamiento de archivos compuesto actual.</span><span class="sxs-lookup"><span data-stu-id="8246b-106">The [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) implementation manages the statistical data and is associated with a current compound file storage object.</span></span>

## <a name="when-to-use"></a><span data-ttu-id="8246b-107">Cuándo usar</span><span class="sxs-lookup"><span data-stu-id="8246b-107">When to Use</span></span>

<span data-ttu-id="8246b-108">Llame a los métodos de [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) para enumerar las estructuras [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) , cada una de las cuales proporciona datos sobre uno de los conjuntos de propiedades asociados al objeto de almacenamiento de archivos compuesto.</span><span class="sxs-lookup"><span data-stu-id="8246b-108">Call the methods of [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) to enumerate [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures, each of which provide data about one of the property sets associated with the compound file storage object.</span></span>

## <a name="remarks"></a><span data-ttu-id="8246b-109">Observaciones</span><span class="sxs-lookup"><span data-stu-id="8246b-109">Remarks</span></span>

<dl> <dt>

<span data-ttu-id="8246b-110"><span id="IEnumSTATPROPSETSTG__Next"></span><span id="ienumstatpropsetstg__next"></span><span id="IENUMSTATPROPSETSTG__NEXT"></span>[**IEnumSTATPROPSETSTG:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg)</span><span class="sxs-lookup"><span data-stu-id="8246b-110"><span id="IEnumSTATPROPSETSTG__Next"></span><span id="ienumstatpropsetstg__next"></span><span id="IENUMSTATPROPSETSTG__NEXT"></span>[**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg)</span></span>
</dt> <dd>

<span data-ttu-id="8246b-111">Obtiene la siguiente estructura [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) o más (el número se especifica mediante el parámetro *Celt* ).</span><span class="sxs-lookup"><span data-stu-id="8246b-111">Gets the next one or more [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures (the number is specified by the *celt* parameter).</span></span> <span data-ttu-id="8246b-112">Los elementos **STATPROPSETSTG** que se proporcionan a través de una llamada a la implementación de archivo compuesto de [**IEnumSTATPROPSETSTG:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) siguen estas reglas:</span><span class="sxs-lookup"><span data-stu-id="8246b-112">The **STATPROPSETSTG** elements provided through a call to the compound file implementation of [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) follow these rules:</span></span>

-   <span data-ttu-id="8246b-113">Si [**IEnumSTATPROPSETSTG:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) no proporciona STATPROPSETSTG. fmtid, se escriben ceros en ese miembro.</span><span class="sxs-lookup"><span data-stu-id="8246b-113">If [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) cannot provide STATPROPSETSTG.fmtid, zeros are written to that member.</span></span> <span data-ttu-id="8246b-114">Esto sucede si el conjunto de propiedades no tiene un nombre predefinido (por ejemplo, \\ 005SummaryInformation) y no es un valor válido.</span><span class="sxs-lookup"><span data-stu-id="8246b-114">This occurs when the property set does not have a predefined name (such as \\005SummaryInformation) and is not a legal value.</span></span>
-   <span data-ttu-id="8246b-115">El conjunto de propiedades DocumentSummaryInformation y UserDefined es especial, ya que puede tener dos secciones set de propiedad.</span><span class="sxs-lookup"><span data-stu-id="8246b-115">The DocumentSummaryInformation and UserDefined property set is special, in that it may have two property set sections.</span></span> <span data-ttu-id="8246b-116">Este conjunto de propiedades se describe en la sección de [los conjuntos de propiedades DocumentSummaryInformation y UserDefined](the-documentsummaryinformation-and-userdefined-property-sets.md).</span><span class="sxs-lookup"><span data-stu-id="8246b-116">This property set is described in the section [The DocumentSummaryInformation and UserDefined Property Sets](the-documentsummaryinformation-and-userdefined-property-sets.md).</span></span> <span data-ttu-id="8246b-117">La segunda sección se conoce como User-Defined propiedades.</span><span class="sxs-lookup"><span data-stu-id="8246b-117">The second section is referred to as the User-Defined Properties.</span></span> <span data-ttu-id="8246b-118">Cada sección se identifica con un identificador de formato único (FMTID).</span><span class="sxs-lookup"><span data-stu-id="8246b-118">Each section is identified with a unique format identifier (FMTID).</span></span> <span data-ttu-id="8246b-119">Cuando se usa [**IPropertySetStorage:: enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum) para enumerar los conjuntos de propiedades, no se enumerará el conjunto de propiedades User-Defined.</span><span class="sxs-lookup"><span data-stu-id="8246b-119">When [**IPropertySetStorage::Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum) is used to enumerate property sets, the User-Defined property set will not be enumerated.</span></span>

> [!Note]  
> <span data-ttu-id="8246b-120">Si siempre crea un conjunto de propiedades mediante [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create), porque se crea un "GUID de carácter" para el nombre de almacenamiento, [**IEnumSTATPROPSETSTG:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) devolverá un FMTID válido distinto de cero para el conjunto de propiedades \[ STATPROPSETSTG. FMTID \] .</span><span class="sxs-lookup"><span data-stu-id="8246b-120">If you always create a property set using [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create), then, because a "Character GUID" is created for the storage name, [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) will return a nonzero, valid FMTID for the property set \[STATPROPSETSTG.fmtid\].</span></span>

 

-   <span data-ttu-id="8246b-121">El miembro STATPROPSETSTG. grfFlags no refleja necesariamente si el conjunto de propiedades es ANSI o no.</span><span class="sxs-lookup"><span data-stu-id="8246b-121">The STATPROPSETSTG.grfFlags member does not necessarily reflect whether the property set is ANSI or not.</span></span> <span data-ttu-id="8246b-122">Si \_ se establece PROPSETFLAG ANSI, el conjunto de propiedades es definitivamente ANSI.</span><span class="sxs-lookup"><span data-stu-id="8246b-122">If PROPSETFLAG\_ANSI is set, the property set is definitely ANSI.</span></span> <span data-ttu-id="8246b-123">Si PROPSETFLAG \_ ANSI está claro, el conjunto de propiedades podría ser Unicode o no Unicode, ya que no es posible saber si es ANSI sin abrirlo.</span><span class="sxs-lookup"><span data-stu-id="8246b-123">If PROPSETFLAG\_ANSI is clear, the property set could be either Unicode or non-Unicode, because it is not possible to tell whether it is ANSI without opening it.</span></span>
-   <span data-ttu-id="8246b-124">El miembro STATPROPSETSTG. grfFlags refleja si el conjunto de propiedades es simple o no, por lo que el valor de la \_ marca PROPSETFLAG nonsimple siempre es válido.</span><span class="sxs-lookup"><span data-stu-id="8246b-124">The STATPROPSETSTG.grfFlags member does reflect whether the property set is simple or not, so the setting of the PROPSETFLAG\_NONSIMPLE flag is always valid.</span></span>
-   <span data-ttu-id="8246b-125">Si [**IEnumSTATPROPSETSTG:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) no proporciona STATPROPSETSTG. CLSID, se establece en todos los ceros (CLSID \_ null).</span><span class="sxs-lookup"><span data-stu-id="8246b-125">If [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) cannot provide STATPROPSETSTG.clsid, it is set to all zeroes (CLSID\_NULL).</span></span> <span data-ttu-id="8246b-126">En la implementación de archivo compuesto COM, esto ocurre cuando el conjunto de propiedades es simple ( \_ no se establece la marca PROPSETFLAG no simple) o no es simple, pero el CLSID no se estableció explícitamente.</span><span class="sxs-lookup"><span data-stu-id="8246b-126">In the COM compound file implementation, this occurs when the property set is simple (the PROPSETFLAG\_NONSIMPLE flag is not set), or is nonsimple, but the CLSID was not explicitly set.</span></span> <span data-ttu-id="8246b-127">En el caso de conjuntos de propiedades no simples, el CLSID que se recibe es el que mantiene el [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage)subyacente.</span><span class="sxs-lookup"><span data-stu-id="8246b-127">For nonsimple property sets, the CLSID that is received is the one that is maintained by the underlying [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage).</span></span>
-   <span data-ttu-id="8246b-128">Si [**IEnumSTATPROPSETSTG:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) no proporciona los campos de hora \[ **ctime**, **mtime**, **atime** \] , cada hora no admitida se establecerá en ceros.</span><span class="sxs-lookup"><span data-stu-id="8246b-128">If [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) cannot provide the time fields \[**ctime**, **mtime**, **atime**\], each non-supported time will be set to zeroes.</span></span> <span data-ttu-id="8246b-129">En la implementación de archivo compuesto COM, obtener estos valores depende de recuperarlos de la implementación de [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) subyacente.</span><span class="sxs-lookup"><span data-stu-id="8246b-129">In the COM compound file implementation, getting these values depends on retrieving them from the underlying [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) implementation.</span></span>

</dd> <dt>

<span data-ttu-id="8246b-130"><span id="IEnumSTATPROPSETSTG__Skip"></span><span id="ienumstatpropsetstg__skip"></span><span id="IENUMSTATPROPSETSTG__SKIP"></span>[**IEnumSTATPROPSETSTG:: Skip**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span><span class="sxs-lookup"><span data-stu-id="8246b-130"><span id="IEnumSTATPROPSETSTG__Skip"></span><span id="ienumstatpropsetstg__skip"></span><span id="IENUMSTATPROPSETSTG__SKIP"></span>[**IEnumSTATPROPSETSTG::Skip**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span></span>
</dt> <dd>

<span data-ttu-id="8246b-131">Omite el número de elementos especificados en *Celt*.</span><span class="sxs-lookup"><span data-stu-id="8246b-131">Skips the number of elements specified in *celt*.</span></span> <span data-ttu-id="8246b-132">Devuelve S \_ OK si se omite el número especificado de elementos, devuelve s \_ false si se omiten menos elementos de los solicitados.</span><span class="sxs-lookup"><span data-stu-id="8246b-132">Returns S\_OK if the specified number of elements are skipped, returns S\_FALSE if fewer elements than requested are skipped.</span></span> <span data-ttu-id="8246b-133">En cualquier otro caso, devuelve el error adecuado.</span><span class="sxs-lookup"><span data-stu-id="8246b-133">In any other case, returns the appropriate error.</span></span>

</dd> <dt>

<span data-ttu-id="8246b-134"><span id="IEnumSTATPROPSETSTG__Reset"></span><span id="ienumstatpropsetstg__reset"></span><span id="IENUMSTATPROPSETSTG__RESET"></span>[**IEnumSTATPROPSETSTG:: RESET**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span><span class="sxs-lookup"><span data-stu-id="8246b-134"><span id="IEnumSTATPROPSETSTG__Reset"></span><span id="ienumstatpropsetstg__reset"></span><span id="IENUMSTATPROPSETSTG__RESET"></span>[**IEnumSTATPROPSETSTG::Reset**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span></span>
</dt> <dd>

<span data-ttu-id="8246b-135">Establece el cursor al principio de la enumeración.</span><span class="sxs-lookup"><span data-stu-id="8246b-135">Sets the cursor to the beginning of the enumeration.</span></span> <span data-ttu-id="8246b-136">Si se realiza correctamente, devuelve S \_ OK; de lo contrario, devuelve STG \_ E \_ INVALIDHANDLE.</span><span class="sxs-lookup"><span data-stu-id="8246b-136">If successful, returns S\_OK, otherwise, returns STG\_E\_INVALIDHANDLE.</span></span>

</dd> <dt>

<span data-ttu-id="8246b-137"><span id="IEnumSTATPROPSETSTG__Clone"></span><span id="ienumstatpropsetstg__clone"></span><span id="IENUMSTATPROPSETSTG__CLONE"></span>[**IEnumSTATPROPSETSTG:: Clone**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span><span class="sxs-lookup"><span data-stu-id="8246b-137"><span id="IEnumSTATPROPSETSTG__Clone"></span><span id="ienumstatpropsetstg__clone"></span><span id="IENUMSTATPROPSETSTG__CLONE"></span>[**IEnumSTATPROPSETSTG::Clone**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span></span>
</dt> <dd>

<span data-ttu-id="8246b-138">Copia el estado actual de la enumeración de este enumerador.</span><span class="sxs-lookup"><span data-stu-id="8246b-138">Copies the current enumeration state of this enumerator.</span></span>

</dd> </dl>

 

 