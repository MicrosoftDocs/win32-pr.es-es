---
description: Muchas aplicaciones permiten a los usuarios transferir datos a otra aplicación arrastrando y colocando los datos con el mouse o usando el portapapeles.
title: Transferir objetos de Shell con arrastrar y colocar y el portapapeles
ms.topic: article
ms.date: 05/31/2018
ms.assetid: bd73098b-2f69-48a4-bb06-e1e0a452e69d
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: b04523d0ae22eac7bef68f37a6d22ac94b21e303
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104985534"
---
# <a name="transferring-shell-objects-with-drag-and-drop-and-the-clipboard"></a><span data-ttu-id="801c2-103">Transferir objetos de Shell con arrastrar y colocar y el portapapeles</span><span class="sxs-lookup"><span data-stu-id="801c2-103">Transferring Shell Objects with Drag-and-Drop and the Clipboard</span></span>

<span data-ttu-id="801c2-104">Muchas aplicaciones permiten a los usuarios transferir datos a otra aplicación arrastrando y colocando los datos con el mouse o usando el portapapeles.</span><span class="sxs-lookup"><span data-stu-id="801c2-104">Many applications allow users to transfer data to another application by dragging and dropping the data with the mouse, or by using the Clipboard.</span></span> <span data-ttu-id="801c2-105">Entre los diversos tipos de datos que se pueden transferir se encuentran los objetos de Shell, como archivos o carpetas.</span><span class="sxs-lookup"><span data-stu-id="801c2-105">Among the many types of data that can be transferred are Shell objects such as files or folders.</span></span> <span data-ttu-id="801c2-106">La transferencia de datos de Shell puede tener lugar entre dos aplicaciones, pero los usuarios también pueden transferir datos de Shell hacia o desde el escritorio o el explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="801c2-106">Shell data transfer can take place between two applications, but users can also transfer Shell data to or from the desktop or Windows Explorer.</span></span>

<span data-ttu-id="801c2-107">Aunque los archivos son el objeto de Shell que se transfiere con mayor frecuencia, la transferencia de datos de Shell puede incluir cualquiera de los diversos objetos que se encuentran en el [espacio de nombres del shell](namespace-intro.md).</span><span class="sxs-lookup"><span data-stu-id="801c2-107">Although files are the most commonly transferred Shell object, Shell data transfer can involve any of the variety of objects found in the [Shell namespace](namespace-intro.md).</span></span> <span data-ttu-id="801c2-108">Por ejemplo, es posible que la aplicación necesite transferir un archivo a una carpeta virtual como la papelera de reciclaje o acepte un objeto de una extensión de espacio de nombres que no sea de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="801c2-108">For instance, your application might need to transfer a file to a virtual folder such as the Recycle Bin, or accept an object from a non-Microsoft namespace extension.</span></span> <span data-ttu-id="801c2-109">Si está implementando una extensión de espacio de nombres, debe ser capaz de comportarse correctamente como un origen y un destino de colocación.</span><span class="sxs-lookup"><span data-stu-id="801c2-109">If you are implementing a namespace extension, it must be able to behave properly as a drop source and target.</span></span>

<span data-ttu-id="801c2-110">En este documento se explica cómo las aplicaciones pueden implementar las transferencias de datos de arrastrar y colocar y del Portapapeles con objetos de Shell.</span><span class="sxs-lookup"><span data-stu-id="801c2-110">This document discusses how applications can implement drag-and-drop and Clipboard data transfers with Shell objects.</span></span>

-   [<span data-ttu-id="801c2-111">Objeto de datos de Shell</span><span class="sxs-lookup"><span data-stu-id="801c2-111">The Shell Data Object</span></span>](dataobject.md)
-   [<span data-ttu-id="801c2-112">Formatos del portapapeles de Shell</span><span class="sxs-lookup"><span data-stu-id="801c2-112">Shell Clipboard Formats</span></span>](clipboard.md)
-   [<span data-ttu-id="801c2-113">Control de escenarios de transferencia de datos de shell</span><span class="sxs-lookup"><span data-stu-id="801c2-113">Handling Shell Data Transfer Scenarios</span></span>](datascenarios.md)

## <a name="how-drag-and-drop-works-with-shell-objects"></a><span data-ttu-id="801c2-114">Cómo funciona la función de arrastrar y colocar con objetos de Shell</span><span class="sxs-lookup"><span data-stu-id="801c2-114">How Drag-and-Drop Works with Shell Objects</span></span>

<span data-ttu-id="801c2-115">Las aplicaciones a menudo necesitan proporcionar a los usuarios una manera de transferir los datos de Shell.</span><span class="sxs-lookup"><span data-stu-id="801c2-115">Applications often need to provide users with a way to transfer Shell data.</span></span> <span data-ttu-id="801c2-116">Ejemplos:</span><span class="sxs-lookup"><span data-stu-id="801c2-116">Some examples are:</span></span>

-   <span data-ttu-id="801c2-117">Arrastrar un archivo desde el explorador de Windows o el escritorio y colocarlo en una aplicación.</span><span class="sxs-lookup"><span data-stu-id="801c2-117">Dragging a file from Windows Explorer or the desktop and dropping it on an application.</span></span>
-   <span data-ttu-id="801c2-118">Copiar un archivo en el portapapeles en el explorador de Windows y pegarlo en una aplicación.</span><span class="sxs-lookup"><span data-stu-id="801c2-118">Copying a file to the Clipboard in Windows Explorer and pasting it into an application.</span></span>
-   <span data-ttu-id="801c2-119">Arrastrar un archivo desde una aplicación a la papelera de reciclaje.</span><span class="sxs-lookup"><span data-stu-id="801c2-119">Dragging a file from an application to the Recycle Bin.</span></span>

<span data-ttu-id="801c2-120">Para obtener una explicación detallada sobre cómo administrar estos y otros escenarios, vea [administrar escenarios de transferencia de datos de Shell](datascenarios.md).</span><span class="sxs-lookup"><span data-stu-id="801c2-120">For a detailed discussion of how to handle these and other scenarios, see [Handling Shell Data Transfer Scenarios](datascenarios.md).</span></span> <span data-ttu-id="801c2-121">Este documento se centra en los principios generales detrás de la transferencia de datos de Shell.</span><span class="sxs-lookup"><span data-stu-id="801c2-121">This document focuses on the general principles behind Shell data transfer.</span></span>

<span data-ttu-id="801c2-122">Windows proporciona dos formas estándar para que las aplicaciones transfieran datos de Shell:</span><span class="sxs-lookup"><span data-stu-id="801c2-122">Windows provides two standard ways for applications to transfer Shell data:</span></span>

-   <span data-ttu-id="801c2-123">Un usuario corta o copia en el portapapeles los datos de Shell, como uno o varios archivos.</span><span class="sxs-lookup"><span data-stu-id="801c2-123">A user cuts or copies Shell data, such as one or more files, to the Clipboard.</span></span> <span data-ttu-id="801c2-124">La otra aplicación recupera los datos del portapapeles.</span><span class="sxs-lookup"><span data-stu-id="801c2-124">The other application retrieves the data from the Clipboard.</span></span>
-   <span data-ttu-id="801c2-125">Un usuario arrastra un icono que representa los datos de la aplicación de origen y coloca el icono en una ventana propiedad del destino.</span><span class="sxs-lookup"><span data-stu-id="801c2-125">A user drags an icon that represents the data from the source application and drops the icon on a window owned by the target.</span></span>

<span data-ttu-id="801c2-126">En ambos casos, los datos transferidos se incluyen en un *objeto de datos*.</span><span class="sxs-lookup"><span data-stu-id="801c2-126">In both cases, the transferred data is contained in a *data object*.</span></span> <span data-ttu-id="801c2-127">Los objetos de datos son objetos del modelo de objetos componentes (COM) que exponen la interfaz [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) .</span><span class="sxs-lookup"><span data-stu-id="801c2-127">Data objects are Component Object Model (COM) objects that expose the [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span> <span data-ttu-id="801c2-128">Esquemáticamente, hay tres pasos esenciales que deben seguir todas las transferencias de datos de Shell:</span><span class="sxs-lookup"><span data-stu-id="801c2-128">Schematically, there are three essential steps that all Shell data transfers must follow:</span></span>

1.  <span data-ttu-id="801c2-129">El origen crea un objeto de datos que representa los datos que se van a transferir.</span><span class="sxs-lookup"><span data-stu-id="801c2-129">The source creates a data object that represents the data that is to be transferred.</span></span>
2.  <span data-ttu-id="801c2-130">El destino recibe un puntero a la interfaz [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) del objeto de datos.</span><span class="sxs-lookup"><span data-stu-id="801c2-130">The target receives a pointer to the data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span>
3.  <span data-ttu-id="801c2-131">El destino llama a la interfaz [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) para extraer los datos de ella.</span><span class="sxs-lookup"><span data-stu-id="801c2-131">The target calls the [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface to extract the data from it.</span></span>

<span data-ttu-id="801c2-132">La diferencia entre las transferencias de datos del portapapeles y de arrastrar y colocar radica principalmente en cómo se transfiere el puntero [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) desde el origen al destino.</span><span class="sxs-lookup"><span data-stu-id="801c2-132">The difference between Clipboard and drag-and-drop data transfers lies primarily in how the [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) pointer is transferred from the source to the target.</span></span>

### <a name="clipboard-data-transfers"></a><span data-ttu-id="801c2-133">Transferencias de datos del portapapeles</span><span class="sxs-lookup"><span data-stu-id="801c2-133">Clipboard Data Transfers</span></span>

<span data-ttu-id="801c2-134">El portapapeles es la forma más sencilla de transferir datos de Shell.</span><span class="sxs-lookup"><span data-stu-id="801c2-134">The Clipboard is the simplest way to transfer Shell data.</span></span> <span data-ttu-id="801c2-135">El procedimiento básico es similar a las transferencias de datos estándar del portapapeles.</span><span class="sxs-lookup"><span data-stu-id="801c2-135">The basic procedure is similar to standard Clipboard data transfers.</span></span> <span data-ttu-id="801c2-136">Sin embargo, dado que está transfiriendo un puntero a un objeto de datos, no los propios datos, debe utilizar la API del portapapeles OLE en lugar de la API del portapapeles estándar.</span><span class="sxs-lookup"><span data-stu-id="801c2-136">However, because you are transferring a pointer to a data object, not the data itself, you must use the OLE clipboard API instead of the standard clipboard API.</span></span> <span data-ttu-id="801c2-137">En el procedimiento siguiente se describe cómo usar la API del portapapeles OLE para transferir datos de Shell con el portapapeles:</span><span class="sxs-lookup"><span data-stu-id="801c2-137">The following procedure outlines how to use the OLE clipboard API to transfer Shell data with the Clipboard:</span></span>

1.  <span data-ttu-id="801c2-138">El origen de datos crea un objeto de datos que contiene los datos.</span><span class="sxs-lookup"><span data-stu-id="801c2-138">The data source creates a data object to contain the data.</span></span>
2.  <span data-ttu-id="801c2-139">El origen de datos llama a [**OleSetClipboard**](/windows/win32/api/ole2/nf-ole2-olesetclipboard), que coloca un puntero a la interfaz [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) del objeto de datos en el portapapeles.</span><span class="sxs-lookup"><span data-stu-id="801c2-139">The data source calls [**OleSetClipboard**](/windows/win32/api/ole2/nf-ole2-olesetclipboard), which places a pointer to the data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface on the Clipboard.</span></span>
3.  <span data-ttu-id="801c2-140">El destino llama a [**OleGetClipboard**](/windows/win32/api/ole2/nf-ole2-olegetclipboard) para recuperar el puntero a la interfaz [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) del objeto de datos.</span><span class="sxs-lookup"><span data-stu-id="801c2-140">The target calls [**OleGetClipboard**](/windows/win32/api/ole2/nf-ole2-olegetclipboard) to retrieve the pointer to the data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span>
4.  <span data-ttu-id="801c2-141">El destino extrae los datos llamando al método [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) .</span><span class="sxs-lookup"><span data-stu-id="801c2-141">The target extracts the data by calling the [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method.</span></span>
5.  <span data-ttu-id="801c2-142">Con algunas transferencias de datos del shell, el destino podría tener que llamar al método [**IDataObject:: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) del objeto de datos para proporcionar comentarios al objeto de datos sobre el resultado de la transferencia de datos.</span><span class="sxs-lookup"><span data-stu-id="801c2-142">With some Shell data transfers, the target might also need to call the data object's [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method to provide feedback to the data object on the outcome of the data transfer.</span></span> <span data-ttu-id="801c2-143">Consulte [control de operaciones de movimiento optimizado](datascenarios.md) para obtener un ejemplo de este tipo de operación.</span><span class="sxs-lookup"><span data-stu-id="801c2-143">See [Handling Optimized Move Operations](datascenarios.md) for an example of this type of operation.</span></span>

### <a name="drag-and-drop-data-transfers"></a><span data-ttu-id="801c2-144">Transferencias de datos de arrastrar y colocar</span><span class="sxs-lookup"><span data-stu-id="801c2-144">Drag-and-Drop Data Transfers</span></span>

<span data-ttu-id="801c2-145">Aunque es algo más complejo de implementar, la transferencia de datos de arrastrar y colocar tiene algunas ventajas significativas en el portapapeles:</span><span class="sxs-lookup"><span data-stu-id="801c2-145">While somewhat more complex to implement, drag-and-drop data transfer has some significant advantages over the Clipboard:</span></span>

-   <span data-ttu-id="801c2-146">Las transferencias de arrastrar y colocar se pueden realizar con un sencillo movimiento del mouse, lo que hace que la operación sea más flexible e intuitiva de usar que el portapapeles.</span><span class="sxs-lookup"><span data-stu-id="801c2-146">Drag-and-drop transfers can be done with a simple mouse movement, making operation more flexible and intuitive to use than the Clipboard.</span></span>
-   <span data-ttu-id="801c2-147">Arrastrar y colocar proporciona al usuario una representación visual de la operación.</span><span class="sxs-lookup"><span data-stu-id="801c2-147">Drag-and-drop provides the user with a visual representation of the operation.</span></span> <span data-ttu-id="801c2-148">El usuario puede seguir el icono cuando se mueve de un origen a un destino.</span><span class="sxs-lookup"><span data-stu-id="801c2-148">The user can follow the icon as it moves from source to target.</span></span>
-   <span data-ttu-id="801c2-149">Arrastrar y colocar notifica al destino cuando los datos están disponibles.</span><span class="sxs-lookup"><span data-stu-id="801c2-149">Drag-and-drop notifies the target when the data is available.</span></span>

<span data-ttu-id="801c2-150">Las operaciones de arrastrar y colocar también usan objetos de datos para transferir datos.</span><span class="sxs-lookup"><span data-stu-id="801c2-150">Drag-and-drop operations also use data objects to transfer data.</span></span> <span data-ttu-id="801c2-151">Sin embargo, el origen de colocación debe proporcionar la funcionalidad más allá de la necesaria para las transferencias del portapapeles:</span><span class="sxs-lookup"><span data-stu-id="801c2-151">However, the drop source must provide functionality beyond that required for Clipboard transfers:</span></span>

-   <span data-ttu-id="801c2-152">El origen de colocación también debe crear un objeto que exponga una interfaz [**IDropSource**](/windows/win32/api/oleidl/nn-oleidl-idropsource) .</span><span class="sxs-lookup"><span data-stu-id="801c2-152">The drop source must also create an object that exposes an [**IDropSource**](/windows/win32/api/oleidl/nn-oleidl-idropsource) interface.</span></span> <span data-ttu-id="801c2-153">El sistema usa **IDropSource** para comunicarse con el origen mientras la operación está en curso.</span><span class="sxs-lookup"><span data-stu-id="801c2-153">The system uses **IDropSource** to communicate with the source while the operation is in progress.</span></span>
-   <span data-ttu-id="801c2-154">El objeto de datos de arrastrar y colocar es responsable de realizar el seguimiento del movimiento del cursor y de mostrar un icono para representar el objeto de datos.</span><span class="sxs-lookup"><span data-stu-id="801c2-154">The drag-and-drop data object is responsible for tracking cursor movement and displaying an icon to represent the data object.</span></span>

<span data-ttu-id="801c2-155">Los destinos de colocación también deben proporcionar más funcionalidad de la necesaria para controlar las transferencias del portapapeles:</span><span class="sxs-lookup"><span data-stu-id="801c2-155">Drop targets must also provide more functionality than is needed to handle Clipboard transfers:</span></span>

-   <span data-ttu-id="801c2-156">El destino de colocación debe exponer una interfaz [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) .</span><span class="sxs-lookup"><span data-stu-id="801c2-156">The drop target must expose an [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface.</span></span> <span data-ttu-id="801c2-157">Cuando el cursor se encuentra sobre una ventana de destino, el sistema utiliza **IDropTarget** para proporcionar al destino información como la posición del cursor y para notificárselo cuando se quitan los datos.</span><span class="sxs-lookup"><span data-stu-id="801c2-157">When the cursor is over a target window, the system uses **IDropTarget** to provide the target with information such as the cursor position, and to notify it when the data is dropped.</span></span>
-   <span data-ttu-id="801c2-158">El destino de colocación debe registrarse en el sistema llamando a [**RegisterDragDrop**](/windows/win32/api/ole2/nf-ole2-registerdragdrop).</span><span class="sxs-lookup"><span data-stu-id="801c2-158">The drop target must register itself with the system by calling [**RegisterDragDrop**](/windows/win32/api/ole2/nf-ole2-registerdragdrop).</span></span> <span data-ttu-id="801c2-159">Esta función proporciona al sistema el identificador de una ventana de destino y un puntero a la interfaz [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) de la aplicación de destino.</span><span class="sxs-lookup"><span data-stu-id="801c2-159">This function provides the system with the handle to a target window and a pointer to the target application's [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface.</span></span>

> [!Note]  
> <span data-ttu-id="801c2-160">En el caso de las operaciones de arrastrar y colocar, la aplicación debe inicializar COM con [**OleInitialize**](/windows/win32/api/ole2/nf-ole2-oleinitialize), no [**coinicializarse**](/windows/win32/api/objbase/nf-objbase-coinitialize).</span><span class="sxs-lookup"><span data-stu-id="801c2-160">For drag-and-drop operations, your application must initialize COM with [**OleInitialize**](/windows/win32/api/ole2/nf-ole2-oleinitialize), not [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize).</span></span>

 

<span data-ttu-id="801c2-161">En el procedimiento siguiente se describen los pasos esenciales que se suelen usar para transferir datos de Shell con arrastrar y colocar:</span><span class="sxs-lookup"><span data-stu-id="801c2-161">The following procedure outlines the essential steps that are typically used to transfer Shell data with drag-and-drop:</span></span>

1.  <span data-ttu-id="801c2-162">El destino llama a [**RegisterDragDrop**](/windows/win32/api/ole2/nf-ole2-registerdragdrop) para proporcionar al sistema un puntero a su interfaz [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) y registrar una ventana como destino de colocación.</span><span class="sxs-lookup"><span data-stu-id="801c2-162">The target calls [**RegisterDragDrop**](/windows/win32/api/ole2/nf-ole2-registerdragdrop) to give the system a pointer to its [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface and register a window as a drop target.</span></span>
2.  <span data-ttu-id="801c2-163">Cuando el usuario inicia una operación de arrastrar y colocar, el origen crea un objeto de datos e inicia un *bucle de arrastre* llamando a [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop).</span><span class="sxs-lookup"><span data-stu-id="801c2-163">When the user starts a drag-and-drop operation, the source creates a data object and initiates a *drag loop* by calling [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop).</span></span>
3.  <span data-ttu-id="801c2-164">Cuando el cursor está sobre la ventana de destino, el sistema notifica al destino llamando a uno de los métodos [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) del destino.</span><span class="sxs-lookup"><span data-stu-id="801c2-164">When the cursor is over the target window, the system notifies the target by calling one of the target's [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) methods.</span></span> <span data-ttu-id="801c2-165">El sistema llama a [**IDropTarget::D ragenter**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragenter) cuando el cursor entra en la ventana de destino e [**IDropTarget::D ragover**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragover) cuando el cursor pasa sobre la ventana de destino.</span><span class="sxs-lookup"><span data-stu-id="801c2-165">The system calls [**IDropTarget::DragEnter**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragenter) when the cursor enters the target window, and [**IDropTarget::DragOver**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragover) as the cursor passes over the target window.</span></span> <span data-ttu-id="801c2-166">Ambos métodos proporcionan el destino de colocación con la posición actual del cursor y el estado de las teclas modificadoras del teclado, como CTRL o ALT.</span><span class="sxs-lookup"><span data-stu-id="801c2-166">Both methods provide the drop target with the current cursor position and the state of keyboard modifier keys such as CTRL or ALT.</span></span> <span data-ttu-id="801c2-167">Cuando el cursor sale de la ventana de destino, el sistema lo notifica al destino llamando a [**IDropTarget::D ragleave**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragleave).</span><span class="sxs-lookup"><span data-stu-id="801c2-167">When the cursor leaves the target window, the system notifies the target by calling [**IDropTarget::DragLeave**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragleave).</span></span> <span data-ttu-id="801c2-168">Cuando cualquiera de estos métodos devuelve, el sistema llama a la interfaz [**IDropSource**](/windows/win32/api/oleidl/nn-oleidl-idropsource) para pasar el valor devuelto al origen.</span><span class="sxs-lookup"><span data-stu-id="801c2-168">When any of these methods return, the system calls the [**IDropSource**](/windows/win32/api/oleidl/nn-oleidl-idropsource) interface to pass the return value to the source.</span></span>
4.  <span data-ttu-id="801c2-169">Cuando el usuario suelta el botón del mouse para colocar los datos, el sistema llama al método [**ROP::D ROP**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-drop) del destino.</span><span class="sxs-lookup"><span data-stu-id="801c2-169">When the user releases the mouse button to drop the data, the system calls the target's [**IDropTarget::Drop**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-drop) method.</span></span> <span data-ttu-id="801c2-170">Entre los parámetros del método se encuentra un puntero a la interfaz [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) del objeto de datos.</span><span class="sxs-lookup"><span data-stu-id="801c2-170">Among the method's parameters is a pointer to the data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span>
5.  <span data-ttu-id="801c2-171">El destino llama al método [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) del objeto de datos para extraer los datos.</span><span class="sxs-lookup"><span data-stu-id="801c2-171">The target calls the data object's [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method to extract the data.</span></span>
6.  <span data-ttu-id="801c2-172">Con algunas transferencias de datos del shell, es posible que el destino también tenga que llamar al método [**IDataObject:: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) del objeto de datos para proporcionar comentarios al origen sobre el resultado de la transferencia de datos.</span><span class="sxs-lookup"><span data-stu-id="801c2-172">With some Shell data transfers, the target might also need to call the data object's [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method to provide feedback to the source on the outcome of the data transfer.</span></span>
7.  <span data-ttu-id="801c2-173">Cuando el destino termina con el objeto de datos, vuelve de [**IDropTarget::D ROP**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-drop).</span><span class="sxs-lookup"><span data-stu-id="801c2-173">When the target is finished with the data object, it returns from [**IDropTarget::Drop**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-drop).</span></span> <span data-ttu-id="801c2-174">El sistema devuelve la llamada [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) del origen para notificar al origen que la transferencia de datos se ha completado.</span><span class="sxs-lookup"><span data-stu-id="801c2-174">The system returns the source's [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) call to notify the source that the data transfer is complete.</span></span>
8.  <span data-ttu-id="801c2-175">Dependiendo del [escenario de transferencia de datos](datascenarios.md)determinado, es posible que el origen tenga que realizar una acción adicional basada en el valor devuelto por [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) y los valores que el destino pasa al objeto de datos.</span><span class="sxs-lookup"><span data-stu-id="801c2-175">Depending on the particular [data transfer scenario](datascenarios.md), the source might need to take additional action based on the value returned by [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) and the values that are passed to the data object by the target.</span></span> <span data-ttu-id="801c2-176">Por ejemplo, cuando se mueve un archivo, el origen debe comprobar estos valores para determinar si debe eliminar el archivo original.</span><span class="sxs-lookup"><span data-stu-id="801c2-176">For instance, when a file is moved, the source must check these values to determine whether it must delete the original file.</span></span>
9.  <span data-ttu-id="801c2-177">El origen libera el objeto de datos.</span><span class="sxs-lookup"><span data-stu-id="801c2-177">The source releases the data object.</span></span>

<span data-ttu-id="801c2-178">Aunque los procedimientos descritos anteriormente proporcionan un buen modelo general para la transferencia de datos de Shell, hay muchos tipos diferentes de datos que se pueden incluir en un objeto de datos de Shell.</span><span class="sxs-lookup"><span data-stu-id="801c2-178">While the procedures outlined above provide a good general model for Shell data transfer, there are many different types of data that can be contained in a Shell data object.</span></span> <span data-ttu-id="801c2-179">También hay una serie de escenarios de transferencia de datos diferentes que es posible que la aplicación necesite controlar.</span><span class="sxs-lookup"><span data-stu-id="801c2-179">There are also a number of different data transfer scenarios that your application might need to handle.</span></span> <span data-ttu-id="801c2-180">Cada tipo de datos y escenario requiere un enfoque algo diferente en tres pasos clave del procedimiento:</span><span class="sxs-lookup"><span data-stu-id="801c2-180">Each data type and scenario requires a somewhat different approach to three key steps in the procedure:</span></span>

-   <span data-ttu-id="801c2-181">Cómo crea un origen un objeto de datos que contiene los datos del shell.</span><span class="sxs-lookup"><span data-stu-id="801c2-181">How a source constructs a data object to contain the Shell data.</span></span>
-   <span data-ttu-id="801c2-182">Cómo un destino extrae datos de Shell del objeto de datos.</span><span class="sxs-lookup"><span data-stu-id="801c2-182">How a target extracts Shell data from the data object.</span></span>
-   <span data-ttu-id="801c2-183">Cómo el origen completa la operación de transferencia de datos.</span><span class="sxs-lookup"><span data-stu-id="801c2-183">How the source completes the data transfer operation.</span></span>

<span data-ttu-id="801c2-184">El [objeto de datos de Shell](dataobject.md) proporciona una explicación general de cómo un origen crea un objeto de datos de Shell y cómo puede controlar ese objeto de datos el destino.</span><span class="sxs-lookup"><span data-stu-id="801c2-184">The [Shell Data Object](dataobject.md) provides a general discussion of how a source constructs a Shell data object, and how that data object can be handled by the target.</span></span> <span data-ttu-id="801c2-185">[Administrar escenarios de transferencia de datos de Shell](datascenarios.md) describe en detalle cómo controlar una serie de escenarios comunes de transferencia de datos de Shell.</span><span class="sxs-lookup"><span data-stu-id="801c2-185">[Handling Shell Data Transfer Scenarios](datascenarios.md) discusses in detail how to handle a number of common Shell data transfer scenarios.</span></span>

 

 
