---
title: Codificación de contenido
description: A partir de Windows Server 2008 y Windows Vista, la aplicación puede indicar a WinINet que realice la descodificación de contenido para los esquemas de codificación de contenido gzip y DEFLATE.
ms.assetid: 136f22a6-e5ca-41c5-8651-6e132655d268
keywords:
- Codificación de contenido
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 09b089ae2aa4cbacdfc9b6ebefe5cbdfc1bfc10e
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104078236"
---
# <a name="content-encoding"></a><span data-ttu-id="dc190-104">Codificación de contenido</span><span class="sxs-lookup"><span data-stu-id="dc190-104">Content Encoding</span></span>

<span data-ttu-id="dc190-105">Tal y como se especifica en el protocolo HTTP (RFC 2616), las aplicaciones pueden solicitar que el servidor devuelva respuestas HTTP en formato codificado.</span><span class="sxs-lookup"><span data-stu-id="dc190-105">As specified in the HTTP protocol (RFC 2616) applications can request that the server return HTTP responses in encoded format.</span></span> <span data-ttu-id="dc190-106">Antes de Windows Server 2008 y Windows Vista, las solicitudes con codificación de contenido se enviaban a la aplicación para su procesamiento en su nivel.</span><span class="sxs-lookup"><span data-stu-id="dc190-106">Prior to Windows Server 2008 and Windows Vista, requests with content encoding were sent to the application for processing at their level.</span></span> <span data-ttu-id="dc190-107">A partir de Windows Server 2008 y Windows Vista, la aplicación puede indicar a WinINet que realice la descodificación de contenido para los esquemas de codificación de contenido gzip y DEFLATE.</span><span class="sxs-lookup"><span data-stu-id="dc190-107">Starting in Windows Server 2008 and Windows Vista, the application can direct WinINet to perform content decoding for the gzip and deflate content encoding schemes.</span></span>

<span data-ttu-id="dc190-108">Para habilitar la descodificación de contenido, la aplicación establece la opción de descodificación solicitando que WinINet realice la descodificación en su nombre.</span><span class="sxs-lookup"><span data-stu-id="dc190-108">To enable content decoding, the application sets the decoding option requesting that WinINet perform decoding on their behalf.</span></span> <span data-ttu-id="dc190-109">Sin embargo, al habilitar la descodificación no se garantiza que WinINet realice la descodificación de contenido y la aplicación debe estar preparada para controlar la descodificación.</span><span class="sxs-lookup"><span data-stu-id="dc190-109">However, enabling decoding does not guarantee that WinINet will perform content decoding, and the application should be prepared to handle decoding.</span></span> <span data-ttu-id="dc190-110">WinINet quita el encabezado Content-Encoding de la respuesta cuando se realiza correctamente la descodificación de contenido.</span><span class="sxs-lookup"><span data-stu-id="dc190-110">WinINet strips the content-encoding header from the response when content decoding is successfully performed.</span></span> <span data-ttu-id="dc190-111">Se espera que las aplicaciones controlen la descodificación de contenido independientemente de si la opción de descodificación está habilitada o deshabilitada cuando el encabezado Content-Encoding está presente en la respuesta.</span><span class="sxs-lookup"><span data-stu-id="dc190-111">Applications are expected to handle content decoding regardless of whether the decoding option is enabled or disabled when the content-encoding header is present in the response.</span></span>

<span data-ttu-id="dc190-112">Cuando la descodificación está habilitada, la aplicación debe especificar la lista de codificaciones admitidas en el encabezado Accept-Encoding de la solicitud.</span><span class="sxs-lookup"><span data-stu-id="dc190-112">When decoding is enabled, the application must specify the list of supported encodings in the Accept-Encoding header of the request.</span></span> <span data-ttu-id="dc190-113">Sin embargo, el encabezado Accept-Encoding no obliga al servidor a enviar una respuesta codificada.</span><span class="sxs-lookup"><span data-stu-id="dc190-113">The Accept-Encoding header, however, does not obligate the server to send an encoded response.</span></span> <span data-ttu-id="dc190-114">WinINet enviará las respuestas que no coincidan con la lista de codificaciones aceptables de vuelta a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="dc190-114">WinINet will send responses that do not match the list of acceptable encodings back to the application.</span></span>

<span data-ttu-id="dc190-115">En la lista siguiente se describen las condiciones en las que WinINet realizará la descodificación de contenido cuando se habilite la opción:</span><span class="sxs-lookup"><span data-stu-id="dc190-115">The following list describes the conditions under which WinINet will perform content decoding when the option is enabled:</span></span>

-   <span data-ttu-id="dc190-116">El encabezado Accept-Encoding debe estar presente en la solicitud y debe especificar los esquemas de codificación gzip, DEFLATE o gzip y DEFLATE.</span><span class="sxs-lookup"><span data-stu-id="dc190-116">The Accept-Encoding header must be present in the request, and it must specify the gzip, deflate, or both gzip and deflate encoding schemes.</span></span>
-   <span data-ttu-id="dc190-117">El esquema de codificación especificado en el encabezado Content-Encoding debe coincidir con uno de los esquemas de codificación especificados en el encabezado Accept-Encoding.</span><span class="sxs-lookup"><span data-stu-id="dc190-117">The encoding scheme specified in the Content-Encoding header must match one of the encoding schemes specified in the Accept-Encoding header.</span></span>
-   <span data-ttu-id="dc190-118">El encabezado Content-Encoding de la respuesta especifica solo un esquema de codificación.</span><span class="sxs-lookup"><span data-stu-id="dc190-118">The Content-Encoding header in the response specifies only one encoding scheme.</span></span>
-   <span data-ttu-id="dc190-119">La respuesta debe contener solo un encabezado Content-Encoding.</span><span class="sxs-lookup"><span data-stu-id="dc190-119">The response must contain only one Content- Encoding header.</span></span> <span data-ttu-id="dc190-120">WinINet descodifica el contenido que está codificado con un solo esquema de codificación.</span><span class="sxs-lookup"><span data-stu-id="dc190-120">WinINet decodes content that is encoded with only one encoding scheme.</span></span>
-   <span data-ttu-id="dc190-121">El encabezado Cache-Control no debe contener la Directiva no-transform.</span><span class="sxs-lookup"><span data-stu-id="dc190-121">The Cache-Control header must not contain the no-transform directive.</span></span>
-   <span data-ttu-id="dc190-122">El encabezado Content-Range no debe estar presente en la respuesta.</span><span class="sxs-lookup"><span data-stu-id="dc190-122">The Content-Range header must not be present in the response.</span></span>

## <a name="setting-the-decompression-option"></a><span data-ttu-id="dc190-123">Establecer la opción de descompresión</span><span class="sxs-lookup"><span data-stu-id="dc190-123">Setting the Decompression Option</span></span>

<span data-ttu-id="dc190-124">La opción de descodificación se puede establecer en el identificador de la sesión, el identificador de la solicitud o el identificador de conexión.</span><span class="sxs-lookup"><span data-stu-id="dc190-124">The decoding option can be set on the session handle, the request handle or the connection handle.</span></span> <span data-ttu-id="dc190-125">Identificador en el que se establece la opción de descodificación, que define el ámbito de la opción de descodificación.</span><span class="sxs-lookup"><span data-stu-id="dc190-125">The handle on which the decoding option is set, defines the scope of the decoding option.</span></span> <span data-ttu-id="dc190-126">Por ejemplo, si se establece la descodificación en la sesión, se habilitará la descodificación de todas las conexiones y solicitudes creadas bajo dicho identificador.</span><span class="sxs-lookup"><span data-stu-id="dc190-126">For example, setting decoding on the session will enable decoding an all connections and requests created under that handle.</span></span>

<span data-ttu-id="dc190-127">Para establecer la opción de descodificación, la aplicación llama a [**InternetSetOption**](/windows/desktop/api/Wininet/nf-wininet-internetsetoptiona) con el identificador devuelto por [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena), [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta)o [**HttpOpenRequest**](/windows/desktop/api/Wininet/nf-wininet-httpopenrequesta).</span><span class="sxs-lookup"><span data-stu-id="dc190-127">To set the decoding option, the application calls [**InternetSetOption**](/windows/desktop/api/Wininet/nf-wininet-internetsetoptiona) with the handle returned from [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena), [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta), or [**HttpOpenRequest**](/windows/desktop/api/Wininet/nf-wininet-httpopenrequesta).</span></span> <span data-ttu-id="dc190-128">La opción de **Internet \_ \_ \_ descodificación http** se especifica en el parámetro *dwOption* y el parámetro *lpBuffer* apunta a una variable booleana establecida en true.</span><span class="sxs-lookup"><span data-stu-id="dc190-128">The **INTERNET\_OPTION\_HTTP\_DECODING** option is specified in the *dwOption* parameter, and the *lpBuffer* parameter points to a boolean variable set to true.</span></span> <span data-ttu-id="dc190-129">Para deshabilitar la descodificación, la aplicación llama a **InternetSetOption** con la opción de **Internet \_ \_ \_ descodificación http** y la variable booleana establecida en false.</span><span class="sxs-lookup"><span data-stu-id="dc190-129">To disable decoding, the application calls **InternetSetOption** with the **INTERNET\_OPTION\_HTTP\_DECODING** option and the boolean variable set to false.</span></span>

<span data-ttu-id="dc190-130">Cuando se establece la opción de descodificación, WinINet realiza la descodificación en la solicitud cuando la aplicación llama a [**InternetReadFile**](/windows/desktop/api/Wininet/nf-wininet-internetreadfile).</span><span class="sxs-lookup"><span data-stu-id="dc190-130">When the decoding option is set, WinINet performs decoding on the request when the application calls [**InternetReadFile**](/windows/desktop/api/Wininet/nf-wininet-internetreadfile).</span></span> <span data-ttu-id="dc190-131">Si WinINet detecta un error mientras realiza la descodificación de contenido, se produce un error en la llamada a **InternetReadFile** con un error en la **\_ \_ descodificación \_ de Internet**.</span><span class="sxs-lookup"><span data-stu-id="dc190-131">If WinINet encounters an error while performing content decoding, the call to **InternetReadFile** fails with an **ERROR\_INTERNET\_DECODING\_FAILED**.</span></span> <span data-ttu-id="dc190-132">Cuando se produce un error en la descodificación, la aplicación tiene dos opciones: puede quitar el encabezado Accept-Encoding y volver a enviar la solicitud, o bien establecer la opción de configuración de **Internet \_ \_ \_ descodificación http** en la solicitud en false y volver a enviar la solicitud.</span><span class="sxs-lookup"><span data-stu-id="dc190-132">When decoding fails, the application has two options: it can remove the Accept-Encoding header and resend the request, or it can set the **INTERNET\_OPTION\_HTTP\_DECODING** option on the request to false and then resend the request.</span></span> <span data-ttu-id="dc190-133">Si la opción de descodificación está establecida en false, la aplicación debe comprobar el encabezado Content-Encoding y realizar cualquier descodificación en el nivel de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="dc190-133">If the decoding option is set to false, the application must check the Content-Encoding header and perform any decoding at the application level.</span></span>

> [!Note]  
> <span data-ttu-id="dc190-134">WinINet no admite implementaciones de servidor.</span><span class="sxs-lookup"><span data-stu-id="dc190-134">WinINet does not support server implementations.</span></span> <span data-ttu-id="dc190-135">Además, no se debe usar desde un servicio.</span><span class="sxs-lookup"><span data-stu-id="dc190-135">In addition, it should not be used from a service.</span></span> <span data-ttu-id="dc190-136">En el caso de servicios o implementaciones de servidor, use los [servicios http de Microsoft Windows (WinHTTP)](/windows/desktop/WinHttp/winhttp-start-page).</span><span class="sxs-lookup"><span data-stu-id="dc190-136">For server implementations or services use [Microsoft Windows HTTP Services (WinHTTP)](/windows/desktop/WinHttp/winhttp-start-page).</span></span>

 

 

 