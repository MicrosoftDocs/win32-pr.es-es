---
title: Funciones del servicio de directorio (AD DS)
description: Las funciones de servicio de directorio proporcionan una utilidad para buscar un controlador de dominio (DC) en un dominio de Windows NT o Windows 2000.
ms.assetid: 7b519c81-5a6c-470a-a525-1894efd53305
ms.tgt_platform: multiple
keywords:
- Funciones del servicio de directorio
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 75b071128806926e07cf61d62e53b823d8e7e1ac
ms.sourcegitcommit: 8ea1a82717bd3dbb3457be0697329aa37fb13f08
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 12/11/2019
ms.locfileid: "104077207"
---
# <a name="directory-service-functions-ad-ds"></a><span data-ttu-id="64e42-104">Funciones del servicio de directorio (AD DS)</span><span class="sxs-lookup"><span data-stu-id="64e42-104">Directory Service Functions (AD DS)</span></span>

<span data-ttu-id="64e42-105">Las funciones de servicio de directorio proporcionan una utilidad para buscar un controlador de dominio (DC) en un dominio de Windows NT o Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="64e42-105">The directory service functions provide a utility for locating a domain controller (DC) in a Windows NT or Windows 2000 domain.</span></span> <span data-ttu-id="64e42-106">La arquitectura interactúa con los clientes, así como con los servidores en todas las versiones de Windows NT y Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="64e42-106">The architecture interacts with clients as well as servers in all versions of Windows NT and Windows 2000.</span></span> <span data-ttu-id="64e42-107">Las siguientes funciones permiten a los desarrolladores trabajar con el controlador de dominio y la pertenencia al dominio en el servicio de directorio:</span><span class="sxs-lookup"><span data-stu-id="64e42-107">The following functions enable developers to work with the domain controller and domain membership in the directory service:</span></span>

-   [<span data-ttu-id="64e42-108">**DsAddressToSiteNames**</span><span class="sxs-lookup"><span data-stu-id="64e42-108">**DsAddressToSiteNames**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsaddresstositenamesa)
-   [<span data-ttu-id="64e42-109">**DsAddressToSiteNamesEx**</span><span class="sxs-lookup"><span data-stu-id="64e42-109">**DsAddressToSiteNamesEx**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsaddresstositenamesexa)
-   [<span data-ttu-id="64e42-110">**DsDeregisterDnsHostRecords**</span><span class="sxs-lookup"><span data-stu-id="64e42-110">**DsDeregisterDnsHostRecords**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsderegisterdnshostrecordsa)
-   [<span data-ttu-id="64e42-111">**DsEnumerateDomainTrusts**</span><span class="sxs-lookup"><span data-stu-id="64e42-111">**DsEnumerateDomainTrusts**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsenumeratedomaintrustsa)
-   [<span data-ttu-id="64e42-112">**DsGetDcClose**</span><span class="sxs-lookup"><span data-stu-id="64e42-112">**DsGetDcClose**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsgetdcclosew)
-   [<span data-ttu-id="64e42-113">**DsGetDcName**</span><span class="sxs-lookup"><span data-stu-id="64e42-113">**DsGetDcName**</span></span>](/windows/desktop/api/DsGetDC/nf-dsgetdc-dsgetdcnamea)
-   [<span data-ttu-id="64e42-114">**DsGetDcNext**</span><span class="sxs-lookup"><span data-stu-id="64e42-114">**DsGetDcNext**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsgetdcnexta)
-   [<span data-ttu-id="64e42-115">**DsGetDcOpen**</span><span class="sxs-lookup"><span data-stu-id="64e42-115">**DsGetDcOpen**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsgetdcopena)
-   [<span data-ttu-id="64e42-116">**DsGetDcSiteCoverage**</span><span class="sxs-lookup"><span data-stu-id="64e42-116">**DsGetDcSiteCoverage**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsgetdcsitecoveragea)
-   [<span data-ttu-id="64e42-117">**DsGetForestTrustInformationW**</span><span class="sxs-lookup"><span data-stu-id="64e42-117">**DsGetForestTrustInformationW**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsgetforesttrustinformationw)
-   [<span data-ttu-id="64e42-118">**DsGetSiteName**</span><span class="sxs-lookup"><span data-stu-id="64e42-118">**DsGetSiteName**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsgetsitenamea)
-   [<span data-ttu-id="64e42-119">**DsMergeForestTrustInformationW**</span><span class="sxs-lookup"><span data-stu-id="64e42-119">**DsMergeForestTrustInformationW**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsmergeforesttrustinformationw)
-   [<span data-ttu-id="64e42-120">**DsRoleFreeMemory**</span><span class="sxs-lookup"><span data-stu-id="64e42-120">**DsRoleFreeMemory**</span></span>](/windows/desktop/api/Dsrole/nf-dsrole-dsrolefreememory)
-   [<span data-ttu-id="64e42-121">**DsRoleGetPrimaryDomainInformation**</span><span class="sxs-lookup"><span data-stu-id="64e42-121">**DsRoleGetPrimaryDomainInformation**</span></span>](/windows/desktop/api/Dsrole/nf-dsrole-dsrolegetprimarydomaininformation)
-   [<span data-ttu-id="64e42-122">**DsValidateSubnetName**</span><span class="sxs-lookup"><span data-stu-id="64e42-122">**DsValidateSubnetName**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsvalidatesubnetnamea)

<span data-ttu-id="64e42-123">El servicio NetLogon implementa el ubicador de DC, [**DsGetDcName**](/windows/desktop/api/DsGetDC/nf-dsgetdc-dsgetdcnamea).</span><span class="sxs-lookup"><span data-stu-id="64e42-123">The DC locator, [**DsGetDcName**](/windows/desktop/api/DsGetDC/nf-dsgetdc-dsgetdcnamea), is implemented by the Netlogon service.</span></span> <span data-ttu-id="64e42-124">Cada DC registra su nombre DNS en el servidor DNS y su nombre NetBIOS mediante un mecanismo específico de transporte, por ejemplo, en WINS.</span><span class="sxs-lookup"><span data-stu-id="64e42-124">Each DC registers its DNS name on the DNS server and its NetBIOS name using a transport-specific mechanism, for example, in WINS.</span></span> <span data-ttu-id="64e42-125">El localizador de DC busca el nombre y, a continuación, envía un datagrama al DC que registró el nombre, o hace ping en él.</span><span class="sxs-lookup"><span data-stu-id="64e42-125">The DC locator looks up the name, then sends a datagram to, or pings, the DC that registered the name.</span></span> <span data-ttu-id="64e42-126">En el caso de los nombres de dominio NetBIOS, el datagrama es un mensaje de buzón.</span><span class="sxs-lookup"><span data-stu-id="64e42-126">For NetBIOS domain names, the datagram is a mailslot message.</span></span> <span data-ttu-id="64e42-127">En el caso de los nombres de dominio DNS, el datagrama es una búsqueda UDP de LDAP.</span><span class="sxs-lookup"><span data-stu-id="64e42-127">For DNS domain names, the datagram is an LDAP UDP search.</span></span> <span data-ttu-id="64e42-128">Cada uno de estos DC responde que indica que está operativo actualmente.</span><span class="sxs-lookup"><span data-stu-id="64e42-128">Each such DC responds indicating that it is currently operational.</span></span> <span data-ttu-id="64e42-129">El primer controlador de dominio que responde se devuelve al autor de la llamada.</span><span class="sxs-lookup"><span data-stu-id="64e42-129">The first DC to respond is returned to the caller.</span></span>

<span data-ttu-id="64e42-130">El controlador de dominio devuelto se almacena en caché, por lo que los llamadores subsiguientes no necesitan repetir el algoritmo anterior y animar a todos los autores de llamadas a usar ese mismo DC.</span><span class="sxs-lookup"><span data-stu-id="64e42-130">The returned DC is cached, so that subsequent callers need not repeat the preceding algorithm, and to encourage all callers to use that same DC.</span></span> <span data-ttu-id="64e42-131">Esto garantiza que un solo cliente tiene una vista coherente del contenido del controlador de dominio.</span><span class="sxs-lookup"><span data-stu-id="64e42-131">This ensures that a single client has a consistent view of the contents of the DC.</span></span>

<span data-ttu-id="64e42-132">Al buscar un DC por el nombre de dominio DNS, el ubicador de DC intenta encontrar un controlador de dominio en el sitio "más cercano".</span><span class="sxs-lookup"><span data-stu-id="64e42-132">When searching for a DC by DNS domain name, the DC locator attempts to find a DC in the "closest" site.</span></span> <span data-ttu-id="64e42-133">Cada DC registra registros DNS adicionales que indican en qué sitio se encuentra el controlador de dominio y qué sitios incluye el controlador de dominio.</span><span class="sxs-lookup"><span data-stu-id="64e42-133">Each DC registers additional DNS records indicating what site that the DC is in and what sites the DC includes.</span></span> <span data-ttu-id="64e42-134">El ubicador de DC primero busca este registro DNS específico del sitio antes de buscar el registro de DNS que no es específico del sitio y, por tanto, precede un controlador de dominio en ese sitio.</span><span class="sxs-lookup"><span data-stu-id="64e42-134">The DC locator first searches for this site-specific DNS record before searching for the DNS record that is not site-specific, thus preferring a DC in that site.</span></span> <span data-ttu-id="64e42-135">Cuando el ubicador de DC envía un datagrama al controlador de dominio, el controlador de dominio busca la dirección IP del cliente en el contenedor configuración/sitios/subred del DS para encontrar un objeto de subred.</span><span class="sxs-lookup"><span data-stu-id="64e42-135">When the DC locator sends a datagram to the DC, the DC looks up the IP address of the client in the Configuration/Sites/Subnet container of the DS to find a subnet object.</span></span> <span data-ttu-id="64e42-136">La propiedad **siteObject** del objeto subnet define el nombre del sitio que contiene el cliente.</span><span class="sxs-lookup"><span data-stu-id="64e42-136">The **siteObject** property of the subnet object defines the name of the site that contains the client.</span></span> <span data-ttu-id="64e42-137">El controlador de dominio responde al ping con el nombre del sitio que contiene el cliente, junto con un indicador de si este controlador de dominio cubre ese sitio.</span><span class="sxs-lookup"><span data-stu-id="64e42-137">The DC responds to the ping with the name of the site that contains the client, along with an indicator of whether this DC covers that site.</span></span> <span data-ttu-id="64e42-138">Si el controlador de dominio no incluye ese sitio y el ubicador de DC todavía no ha intentado encontrar un controlador de dominio en ese sitio, el ubicador de DC intenta buscar de nuevo un controlador de dominio en el sitio.</span><span class="sxs-lookup"><span data-stu-id="64e42-138">If the DC does not include that site and the DC locator has not yet attempted to find a DC in that site, the DC locator tries again to find a DC in the site.</span></span>

<span data-ttu-id="64e42-139">Para buscar el nombre del sitio que contiene el cliente, utilice la función [**DsGetSiteName**](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsgetsitenamea) .</span><span class="sxs-lookup"><span data-stu-id="64e42-139">To find the name of the site containing the client, use the [**DsGetSiteName**](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsgetsitenamea) function.</span></span> <span data-ttu-id="64e42-140">Los nombres de los objetos del contenedor configuración/sitios/subred deben ser nombres de subred válidos.</span><span class="sxs-lookup"><span data-stu-id="64e42-140">The names of the objects in the Configuration/Sites/Subnet container must be valid subnet names.</span></span> <span data-ttu-id="64e42-141">La función [**DsValidateSubnetName**](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsvalidatesubnetnamea) indica si un nombre de subred especificado es válido.</span><span class="sxs-lookup"><span data-stu-id="64e42-141">The [**DsValidateSubnetName**](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsvalidatesubnetnamea) function indicates whether a specified subnet name is valid.</span></span>

 

 




