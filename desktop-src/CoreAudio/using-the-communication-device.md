---
description: En Windows 7, el panel de control multimedia de Windows, Mmsys.cpl, proporciona una nueva pestaña comunicaciones.
ms.assetid: bec2127d-fb82-436d-beee-d43e8fef5c35
title: Uso de un dispositivo de comunicación
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 93f677245e650cf11c71c879b2c26d3183ff4a0b
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "103907311"
---
# <a name="using-a-communication-device"></a><span data-ttu-id="e7ac9-103">Uso de un dispositivo de comunicación</span><span class="sxs-lookup"><span data-stu-id="e7ac9-103">Using a Communication Device</span></span>

<span data-ttu-id="e7ac9-104">En Windows 7, el panel de control multimedia de Windows, Mmsys.cpl, proporciona una nueva pestaña **comunicaciones** . Esta pestaña contiene opciones que permiten a un usuario establecer opciones que definen el modo en que el sistema administra un *dispositivo de comunicación*.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-104">In Windows 7, the Windows multimedia control panel, Mmsys.cpl, provides a new **Communications** tab. This tab contains options that enables a user to set options that defines how the system manages a *communication device*.</span></span> <span data-ttu-id="e7ac9-105">Un dispositivo de comunicación se usa principalmente para colocar o recibir llamadas telefónicas en el equipo.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-105">A communication device is used primarily for placing or receiving telephone calls on the computer.</span></span> <span data-ttu-id="e7ac9-106">En el caso de un equipo que solo tenga un dispositivo de representación (altavoz) y un dispositivo de captura (micrófono), estos dispositivos de audio también actuarán como dispositivos de comunicación predeterminados.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-106">For a computer that has only one rendering device (speaker) and one capture device (microphone), these audio devices also act as the default communication devices.</span></span> <span data-ttu-id="e7ac9-107">Cuando un usuario conecta un dispositivo nuevo, como un auricular USB, el sistema realiza la detección automática de roles de dispositivo mediante la búsqueda de las opciones de configuración rellenadas por el OEM.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-107">When a user connects a new device, such as a USB headset, the system performs automatic device role detection by looking up the configuration settings that are populated by the OEM.</span></span> <span data-ttu-id="e7ac9-108">Si el sistema determina que un dispositivo es más adecuado para fines de comunicación, el sistema asigna el rol **eCommunications** al dispositivo.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-108">If the system determines a device to be best suited for communication purposes, the system assigns the **eCommunications** role to the device.</span></span> <span data-ttu-id="e7ac9-109">Para estos dispositivos, el Mmsys.cpl de Windows 7 proporciona el **dispositivo de comunicación predeterminado** de la opción que permite a un usuario seleccionar un dispositivo de comunicación para cada representación de audio (pestaña **reproducción** ) y captura de audio (pestaña **grabación** ).</span><span class="sxs-lookup"><span data-stu-id="e7ac9-109">For these devices, the Windows 7 Mmsys.cpl provides the option **Default Communication Device** that enables a user to select a communication device each for audio rendering (**Playback** tab) and audio capturing (**Recording** tab).</span></span> <span data-ttu-id="e7ac9-110">El sistema realiza la detección automática de roles, pero no establece un dispositivo determinado para su uso en las comunicaciones.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-110">The system performs automatic role detection but does not set a particular device to be used for communications.</span></span> <span data-ttu-id="e7ac9-111">Esto debe hacerlo el usuario.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-111">This must be done by the user.</span></span> <span data-ttu-id="e7ac9-112">El nuevo rol **eCommunications** permite a una aplicación distinguir entre un dispositivo elegido por el usuario para controlar las llamadas telefónicas y un dispositivo que se va a usar como dispositivo multimedia (reproducción de música).</span><span class="sxs-lookup"><span data-stu-id="e7ac9-112">The new **eCommunications** role lets an application distinguish between a device that is chosen by the user for handling phone calls and a device to be used as a multimedia device (music playback).</span></span> <span data-ttu-id="e7ac9-113">Por ejemplo, si el usuario tiene un auricular y un altavoz conectados al equipo, el sistema asigna el rol **eConsole** al altavoz y el rol **eCommunications** a los auriculares.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-113">For example, if the user has a headset and a speaker connected to the computer, the system assigns the **eConsole** role to the speaker and the **eCommunications** role to the headset.</span></span> <span data-ttu-id="e7ac9-114">Una vez que el usuario selecciona los auriculares que se van a usar como dispositivo de comunicación, para desarrollar una aplicación de comunicación, puede tener como destino el casco específicamente para representar una secuencia de audio.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-114">After the user selects the headset to be used as the communication device, to develop a communication application, you can target the headset specifically for rendering an audio stream.</span></span> <span data-ttu-id="e7ac9-115">Una aplicación el usuario no puede cambiar el rol de dispositivo asignado por el sistema.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-115">An application the user cannot change the device role assigned by the system.</span></span> <span data-ttu-id="e7ac9-116">Para obtener más información sobre los roles de dispositivo, consulte [roles de dispositivo](device-roles.md).</span><span class="sxs-lookup"><span data-stu-id="e7ac9-116">For more information about device roles, see [Device Roles](device-roles.md).</span></span>

<span data-ttu-id="e7ac9-117">Las aplicaciones de comunicación, como las aplicaciones de comunicación unificada y VoIP, colocan y reciben llamadas telefónicas a través de un equipo.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-117">Communication applications, such as VoIP and Unified Communication applications, place and receive phone calls through a computer.</span></span> <span data-ttu-id="e7ac9-118">Por ejemplo, una aplicación de VoIP podría asignar un flujo que contiene la notificación de timbre al punto de conexión de un conjunto de dispositivos de comunicación para la representación de secuencias de audio.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-118">For example, a VoIP application might assign a stream that contains the ring-in notification to the endpoint of a communication device set for rendering audio streams.</span></span> <span data-ttu-id="e7ac9-119">Además, la aplicación puede abrir los flujos de entrada y salida de voz en los dispositivos de extremo de captura y representación que se establecen como dispositivos de comunicación.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-119">In addition, the application might open the voice input and output streams on the capture and rendering endpoint devices that are set as communication devices.</span></span>

<span data-ttu-id="e7ac9-120">Para integrar las funcionalidades de comunicación en las aplicaciones, puede usar:</span><span class="sxs-lookup"><span data-stu-id="e7ac9-120">To integrate communication capabilities into your applications, you can use:</span></span>

-   <span data-ttu-id="e7ac9-121">[MMDEVICE API](mmdevice-api.md): para obtener una referencia al punto de conexión del dispositivo de comunicación.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-121">[MMDevice API](mmdevice-api.md)—to get a reference to the endpoint of the communication device.</span></span>
-   <span data-ttu-id="e7ac9-122">[WASAPI](wasapi.md): para representar y capturar flujos de audio a través del dispositivo de comunicación.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-122">[WASAPI](wasapi.md)—to render and capture audio streams through the communication device.</span></span> <span data-ttu-id="e7ac9-123">El sistema operativo considera que el flujo abierto en un dispositivo de comunicación es un *flujo de comunicación*.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-123">The operating system considers the stream opened on a communication device to be a *communication stream*.</span></span>

<span data-ttu-id="e7ac9-124">La aplicación de comunicación enumera los dispositivos y proporciona administración de transmisiones para una secuencia de flujo de comunicación (representación o captura) de la misma manera en que administraría una secuencia que no es de comunicación mediante el uso de las API de audio principales.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-124">The communication application enumerates devices and provides stream management for a communication stream (rendering or capture) stream in the same manner as it would manage a non-communication stream by using the Core Audio APIs.</span></span>

<span data-ttu-id="e7ac9-125">Una de las características que se pueden integrar en la aplicación de comunicación *es la* perdedora o la *atenuación* de la secuencia.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-125">One of the features that you can integrate in your communication application is *ducking* or *stream attenuation*.</span></span> <span data-ttu-id="e7ac9-126">Este comportamiento define lo que debe ocurrir con otros sonidos cuando se abre una secuencia de comunicación, como cuando se recibe una llamada telefónica en el dispositivo de comunicación.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-126">This behavior defines what must happen to other sounds when a communication stream is opened, such as when a phone call is received on the communication device.</span></span> <span data-ttu-id="e7ac9-127">El sistema podría silenciar o reducir el volumen de audio de la secuencia de no comunicación en función de la elección del usuario.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-127">The system might mute or lower the audio volume of the non-communication stream depending on the user's choice.</span></span> <span data-ttu-id="e7ac9-128">El sistema de audio genera eventos de subprocesos cuando se abre o cierra una secuencia de comunicación para representar o capturar secuencias.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-128">The audio system generates ducking events when a communication stream is opened or closed for rendering or capturing streams.</span></span> <span data-ttu-id="e7ac9-129">De forma predeterminada, el sistema operativo proporciona una experiencia predeterminada de los patos.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-129">By default, the operating system provides a default ducking experience.</span></span> <span data-ttu-id="e7ac9-130">Una aplicación multimedia puede reemplazar el comportamiento predeterminado y controlar estos eventos para proporcionar una experiencia personalizada de patos.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-130">A media application can replace the default behavior and handle these events itself to provide a customized ducking experience.</span></span>

<span data-ttu-id="e7ac9-131">En las secciones siguientes se describe cómo usar las API de audio principales para proporcionar una experiencia personalizada de patos.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-131">The following sections describe how to use Core Audio APIs to provide a custom ducking experience.</span></span>

-   [<span data-ttu-id="e7ac9-132">Experiencia predeterminada de los patos</span><span class="sxs-lookup"><span data-stu-id="e7ac9-132">Default Ducking Experience</span></span>](stream-attenuation.md)
-   [<span data-ttu-id="e7ac9-133">Deshabilitación de la experiencia de patos predeterminada</span><span class="sxs-lookup"><span data-stu-id="e7ac9-133">Disabling the Default Ducking Experience</span></span>](disabling-the-ducking-experience.md)
-   [<span data-ttu-id="e7ac9-134">Proporcionar un comportamiento personalizado de patos</span><span class="sxs-lookup"><span data-stu-id="e7ac9-134">Providing a Custom Ducking Behavior</span></span>](providing-a-custom-ducking-experience.md)
-   [<span data-ttu-id="e7ac9-135">Consideraciones de implementación para las notificaciones de patos</span><span class="sxs-lookup"><span data-stu-id="e7ac9-135">Implementation Considerations for Ducking Notifications</span></span>](handling-audio-ducking-events-from-communication-devices.md)
-   [<span data-ttu-id="e7ac9-136">Obtención de eventos de pato</span><span class="sxs-lookup"><span data-stu-id="e7ac9-136">Getting Ducking Events</span></span>](getting-ducking-events-from-a-communication-device.md)

### <a name="getting-a-reference-to-the-communication-device-endpoint"></a><span data-ttu-id="e7ac9-137">Obtener una referencia al punto de conexión del dispositivo de comunicación</span><span class="sxs-lookup"><span data-stu-id="e7ac9-137">Getting a Reference to the Communication Device Endpoint</span></span>

<span data-ttu-id="e7ac9-138">Para usar el dispositivo de comunicación, un cliente de WASAPI directo debe enumerar los dispositivos mediante el enumerador de dispositivos.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-138">To use the communication device, a direct WASAPI client must enumerate the devices by using the device enumerator.</span></span> <span data-ttu-id="e7ac9-139">Obtenga una referencia al punto de conexión del dispositivo de comunicación predeterminado mediante una llamada a [**IMMDeviceEnumerator:: GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint).</span><span class="sxs-lookup"><span data-stu-id="e7ac9-139">Get a reference to the endpoint of the default communication device by calling [**IMMDeviceEnumerator::GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint).</span></span> <span data-ttu-id="e7ac9-140">En esta llamada, la aplicación debe especificar **eCommunications** en el parámetro *role* para restringir la enumeración de dispositivos a los dispositivos de comunicación.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-140">In this call, the application must specify **eCommunications** in the *Role* parameter to restrict the device enumeration to communication devices.</span></span> <span data-ttu-id="e7ac9-141">Después de obtener una referencia al punto de conexión del dispositivo para el dispositivo, puede activar los servicios cuyo ámbito es el punto de conexión mediante una llamada a [**IMMDevice:: Activate**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-activate).</span><span class="sxs-lookup"><span data-stu-id="e7ac9-141">After you get a reference to the device endpoint for the device, you can activate the services that are scoped for the endpoint by calling [**IMMDevice::Activate**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-activate).</span></span> <span data-ttu-id="e7ac9-142">Por ejemplo, puede pasar el identificador de servicio **IID \_ IAudioClient** para activar un objeto de cliente de audio y usarlo para la administración de transmisiones, el identificador **IID \_ IAudioEndpointVolume** para obtener acceso a los controles de volumen del punto de conexión de dispositivo de comunicación, o el identificador de **\_ IAudioSessionManager de IID** para activar el administrador de sesión que le permite interactuar con el motor de directivas del punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-142">For example, you can pass the **IID\_IAudioClient** service identifier to activate an audio client object and use it for stream management, the **IID\_IAudioEndpointVolume** identifier to get access to the volume controls of the communication device endpoint, or the **IID\_IAudioSessionManager** identifier to activate the session manager that enables you to interact with the policy engine of the endpoint.</span></span> <span data-ttu-id="e7ac9-143">Para obtener información sobre las operaciones de Stream, consulte [Administración de transmisiones](stream-management.md).</span><span class="sxs-lookup"><span data-stu-id="e7ac9-143">For information about stream operations, see [Stream Management](stream-management.md).</span></span>

<span data-ttu-id="e7ac9-144">Mediante el uso de la referencia [**IMMDevice**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice) , también puede acceder al almacén de propiedades para el punto de conexión del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-144">By using the [**IMMDevice**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice) reference, you can also access the property store for the device endpoint.</span></span> <span data-ttu-id="e7ac9-145">Estos valores de propiedad, como el nombre descriptivo del dispositivo y el nombre del fabricante, se rellenan con el OEM y permiten que una aplicación determine las características de un dispositivo de comunicación.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-145">These property values, such as device friendly name and manufacturer name, are populated by the OEM and enable an application to determine the characteristics of a communication device.</span></span> <span data-ttu-id="e7ac9-146">Para obtener más información, consulte [propiedades del dispositivo](device-properties.md).</span><span class="sxs-lookup"><span data-stu-id="e7ac9-146">For more information, see [Device Properties](device-properties.md).</span></span>

<span data-ttu-id="e7ac9-147">En el código de ejemplo siguiente se obtiene una referencia al punto de conexión del dispositivo de comunicación predeterminado para representar una secuencia de audio.</span><span class="sxs-lookup"><span data-stu-id="e7ac9-147">The following example code gets a reference to the endpoint of the default communication device for rendering an audio stream.</span></span>


```C++
IMMDevice *defaultDevice = NULL;

hr = CoCreateInstance(__uuidof(MMDeviceEnumerator), NULL,
            CLSCTX_INPROC_SERVER, 
            __uuidof(IMMDeviceEnumerator), 
            (LPVOID *)&deviceEnumerator);

hr = deviceEnumerator->GetDefaultAudioEndpoint(eRender, 
            eCommunications, &defaultDevice);
```



## <a name="related-topics"></a><span data-ttu-id="e7ac9-148">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="e7ac9-148">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e7ac9-149">Administración de flujos</span><span class="sxs-lookup"><span data-stu-id="e7ac9-149">Stream Management</span></span>](stream-management.md)
</dt> </dl>

 

 



