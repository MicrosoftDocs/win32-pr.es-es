---
description: En este tema se describen algunos de los aspectos que se deben tener en cuenta al usar bibliotecas en el programa.
ms.assetid: 40ACC8F6-1416-4390-A8D7-8F924DC2C2FE
title: Usar bibliotecas en el programa
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2812a66b148d9bd16fc3951efab64a4d37afaaff
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "104361670"
---
# <a name="using-libraries-in-your-program"></a><span data-ttu-id="84fa4-103">Usar bibliotecas en el programa</span><span class="sxs-lookup"><span data-stu-id="84fa4-103">Using Libraries in your Program</span></span>

<span data-ttu-id="84fa4-104">En este tema se describen algunos de los aspectos que se deben tener en cuenta al usar bibliotecas en el programa.</span><span class="sxs-lookup"><span data-stu-id="84fa4-104">This topic describes some of the things to consider when using libraries in your program.</span></span>

<span data-ttu-id="84fa4-105">En este tema:</span><span class="sxs-lookup"><span data-stu-id="84fa4-105">In this topic:</span></span>

-   [<span data-ttu-id="84fa4-106">Información general sobre la programación de bibliotecas</span><span class="sxs-lookup"><span data-stu-id="84fa4-106">Library programming overview</span></span>](#library-programming-overview)
-   [<span data-ttu-id="84fa4-107">Programar con bibliotecas</span><span class="sxs-lookup"><span data-stu-id="84fa4-107">Programming with Libraries</span></span>](#programming-with-libraries)
    -   [<span data-ttu-id="84fa4-108">Mover de carpetas conocidas a bibliotecas</span><span class="sxs-lookup"><span data-stu-id="84fa4-108">Moving from Known Folders to Libraries</span></span>](#moving-from-known-folders-to-libraries)
    -   [<span data-ttu-id="84fa4-109">Grupo hogar y bibliotecas compartidas</span><span class="sxs-lookup"><span data-stu-id="84fa4-109">HomeGroup and shared libraries</span></span>](#homegroup-and-shared-libraries)
-   [<span data-ttu-id="84fa4-110">Usar un cuadro de diálogo de archivo común con bibliotecas</span><span class="sxs-lookup"><span data-stu-id="84fa4-110">Using a common file dialog box with libraries</span></span>](#using-a-common-file-dialog-box-with-libraries)
-   [<span data-ttu-id="84fa4-111">Habilitar la selección de biblioteca desde la interfaz de usuario</span><span class="sxs-lookup"><span data-stu-id="84fa4-111">Enabling library selection from the user interface</span></span>](#enabling-library-selection-from-the-user-interface)
-   [<span data-ttu-id="84fa4-112">Acceder al contenido de una biblioteca en un programa</span><span class="sxs-lookup"><span data-stu-id="84fa4-112">Accessing library content in a program</span></span>](#accessing-library-content-in-a-program)
    -   [<span data-ttu-id="84fa4-113">Acceder al contenido de la biblioteca con la interfaz IShellLibrary</span><span class="sxs-lookup"><span data-stu-id="84fa4-113">Accessing library content with the IShellLibrary interface</span></span>](#accessing-library-content-with-the-ishelllibrary-interface)
    -   [<span data-ttu-id="84fa4-114">Acceder al contenido de la biblioteca con las API de Shell</span><span class="sxs-lookup"><span data-stu-id="84fa4-114">Accessing library content with the Shell APIs</span></span>](#accessing-library-content-with-the-shell-apis)
-   [<span data-ttu-id="84fa4-115">Guardar el contenido de un usuario en una biblioteca</span><span class="sxs-lookup"><span data-stu-id="84fa4-115">Saving user content in a library</span></span>](#saving-user-content-in-a-library)
-   [<span data-ttu-id="84fa4-116">Admitir operaciones de arrastrar y colocar en una biblioteca</span><span class="sxs-lookup"><span data-stu-id="84fa4-116">Supporting drag-and-drop operations in a library</span></span>](#supporting-drag-and-drop-operations-in-a-library)
-   [<span data-ttu-id="84fa4-117">Mantener la sincronización con una biblioteca</span><span class="sxs-lookup"><span data-stu-id="84fa4-117">Keeping in sync with a library</span></span>](#keeping-in-sync-with-a-library)
    -   [<span data-ttu-id="84fa4-118">Actualización masiva</span><span class="sxs-lookup"><span data-stu-id="84fa4-118">Bulk Update</span></span>](#bulk-update)
    -   [<span data-ttu-id="84fa4-119">Notificación de API de Shell</span><span class="sxs-lookup"><span data-stu-id="84fa4-119">Shell API Notification</span></span>](#shell-api-notification)
    -   [<span data-ttu-id="84fa4-120">Notificación de API del sistema de archivos</span><span class="sxs-lookup"><span data-stu-id="84fa4-120">File-system API Notification</span></span>](#file-system-api-notification)
-   [<span data-ttu-id="84fa4-121">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="84fa4-121">Related topics</span></span>](#related-topics)

## <a name="library-programming-overview"></a><span data-ttu-id="84fa4-122">Información general sobre la programación de bibliotecas</span><span class="sxs-lookup"><span data-stu-id="84fa4-122">Library programming overview</span></span>

<span data-ttu-id="84fa4-123">Las bibliotecas permiten a los usuarios organizar su contenido basado en archivos de forma que sean significativos para ellos y no estén limitados por la organización del sistema de archivos.</span><span class="sxs-lookup"><span data-stu-id="84fa4-123">Libraries enable users to organize their file-based content in a way that is meaningful to them and not limited by the organization of the file system.</span></span> <span data-ttu-id="84fa4-124">Cuando el programa es compatible con las bibliotecas, permite al usuario buscar su contenido de forma que le resulte útil a la hora de presentar una interfaz de usuario coherente con la experiencia del usuario de Windows 7.</span><span class="sxs-lookup"><span data-stu-id="84fa4-124">When your program supports libraries, it allows the user to find their content in a way that makes sense to them while presenting a user interface that is consistent with the Windows 7 user experience.</span></span> <span data-ttu-id="84fa4-125">Las bibliotecas también facilitan que el programa busque contenido basado en archivos que se almacena en carpetas diferentes o en equipos diferentes.</span><span class="sxs-lookup"><span data-stu-id="84fa4-125">Libraries also make it easier for your program to locate file-based content that is stored in different folders or on different machines.</span></span>

<span data-ttu-id="84fa4-126">En los temas de esta sección se describe cómo puede Agregar compatibilidad con la biblioteca a su programa y aprovechar las nuevas funcionalidades que ofrecen las bibliotecas.</span><span class="sxs-lookup"><span data-stu-id="84fa4-126">The topics in this section describe how you can add library support to your program and take advantage of the new capabilities that libraries offer.</span></span> <span data-ttu-id="84fa4-127">Windows 7 proporciona parte de esta compatibilidad de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="84fa4-127">Windows 7 provides some of this support by default.</span></span> <span data-ttu-id="84fa4-128">Si el programa no modifica los cuadros de diálogo de archivos comunes que usa actualmente, podría requerir muy poca programación adicional para admitir las bibliotecas.</span><span class="sxs-lookup"><span data-stu-id="84fa4-128">If your program does not modify the common file dialog boxes that it currently uses, it might require very little additional programming to support libraries.</span></span>

<span data-ttu-id="84fa4-129">En esta sección se describen algunas de las características clave que proporcionan las bibliotecas y cómo admitirlas en el programa.</span><span class="sxs-lookup"><span data-stu-id="84fa4-129">This section describes some of the key features that libraries provide and how to support them in your program.</span></span> <span data-ttu-id="84fa4-130">Con esta información, puede decidir qué características proporcionarán la mejor experiencia de usuario de su programa.</span><span class="sxs-lookup"><span data-stu-id="84fa4-130">With this information, you can decide which features will provide the best user experience from your program.</span></span> <span data-ttu-id="84fa4-131">Si el programa Personaliza los cuadros de diálogo de archivos comunes, la información de esta sección puede ayudarle a determinar cómo usar los cuadros de diálogo nuevos archivos comunes para usar las bibliotecas y proporcionar una funcionalidad equivalente en Windows 7.</span><span class="sxs-lookup"><span data-stu-id="84fa4-131">If your program customizes the common file dialog boxes, the information in this section can help you determine how to use the new common file dialog boxes to use libraries and provide equivalent functionality in Windows 7.</span></span>

## <a name="programming-with-libraries"></a><span data-ttu-id="84fa4-132">Programar con bibliotecas</span><span class="sxs-lookup"><span data-stu-id="84fa4-132">Programming with Libraries</span></span>

<span data-ttu-id="84fa4-133">El modelo de programación del shell de Windows describe cómo interactúa un programa con objetos de programación del shell de Windows.</span><span class="sxs-lookup"><span data-stu-id="84fa4-133">The Windows Shell programming model describes how a program interacts with Windows Shell programming objects.</span></span> <span data-ttu-id="84fa4-134">Mientras que los objetos del sistema de archivos, como archivos y directorios, están representados por objetos de Shell de Windows, no todos los objetos de Shell de Windows están representados por el sistema de archivos.</span><span class="sxs-lookup"><span data-stu-id="84fa4-134">While file-system objects, such as files and directories, are represented by Windows Shell objects, not all Windows Shell objects are represented by the file-system.</span></span> <span data-ttu-id="84fa4-135">Por ejemplo, las bibliotecas son objetos del shell de Windows que no tienen un equivalente del sistema de archivos.</span><span class="sxs-lookup"><span data-stu-id="84fa4-135">Libraries, for example, are Windows Shell objects that do not have a file-system equivalent.</span></span> <span data-ttu-id="84fa4-136">El uso de objetos de Shell de Windows en el programa permite que el programa tenga acceso a todos los objetos de Shell y no solo a los objetos del sistema de archivos.</span><span class="sxs-lookup"><span data-stu-id="84fa4-136">Using Windows Shell objects in your program enables your program to access all Shell objects and not just file-system objects.</span></span>

<span data-ttu-id="84fa4-137">Para obtener los mejores resultados, el programa usaría la [**API**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) de la biblioteca de Shell para interactuar con las bibliotecas y acceder a su contenido.</span><span class="sxs-lookup"><span data-stu-id="84fa4-137">For the best results, your program would use the [**Shell Library API**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) to interact with libraries and access their contents.</span></span> <span data-ttu-id="84fa4-138">Mientras que las bibliotecas contienen elementos del sistema de archivos, como carpetas y archivos, las bibliotecas no son elementos del sistema de archivos.</span><span class="sxs-lookup"><span data-stu-id="84fa4-138">While libraries contain file-system items such as folders and files, libraries are not file-system items.</span></span> <span data-ttu-id="84fa4-139">Como tal, las API del sistema de archivos no se pueden usar para tener acceso a las características de la biblioteca o al contenido de la biblioteca.</span><span class="sxs-lookup"><span data-stu-id="84fa4-139">As such, file-system APIs cannot be used to access library features or library contents.</span></span>

<span data-ttu-id="84fa4-140">Si tiene un programa existente que actualmente usa muchas API del sistema de archivos, el programa puede seguir aprovechando las características de la biblioteca.</span><span class="sxs-lookup"><span data-stu-id="84fa4-140">If you have an existing program that currently uses many file-system APIs, your program can still take advantage of library features.</span></span> <span data-ttu-id="84fa4-141">La [**API**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) de la biblioteca de Shell puede proporcionar referencias del sistema de archivos a los elementos que se encuentran en una biblioteca y estas referencias del sistema de archivos, como el nombre de archivo y la ruta de acceso, se pueden pasar a las API del sistema de archivos existentes que se encuentran en el programa existente.</span><span class="sxs-lookup"><span data-stu-id="84fa4-141">The [**Shell Library API**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary) can provide file-system references to the items that are found in a library and these file-system references, such as the file name and path, can be passed to the existing file-system APIs that are in your existing program.</span></span>

### <a name="moving-from-known-folders-to-libraries"></a><span data-ttu-id="84fa4-142">Mover de carpetas conocidas a bibliotecas</span><span class="sxs-lookup"><span data-stu-id="84fa4-142">Moving from Known Folders to Libraries</span></span>

<span data-ttu-id="84fa4-143">Antes de Windows 7 era habitual usar una carpeta conocida, como la carpeta Mis documentos, como carpeta predeterminada en operaciones de archivo guardar o abrir archivo.</span><span class="sxs-lookup"><span data-stu-id="84fa4-143">Before Windows 7 it was common to use a known folder, such as the My Documents folder, as the default folder in file save or file open operations.</span></span> <span data-ttu-id="84fa4-144">En Windows 7, se debe usar la biblioteca correspondiente, de modo que el usuario tendrá la misma experiencia en el programa que con otros programas de Windows 7, como el explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="84fa4-144">In Windows 7, the corresponding library should be used so the user will have the same experience in your program as they would with other Windows 7 programs, such as the Windows Explorer.</span></span>

<span data-ttu-id="84fa4-145">Si actualmente usa la API de Shell de Windows en su programa, la compatibilidad con la biblioteca es sencilla.</span><span class="sxs-lookup"><span data-stu-id="84fa4-145">If you are currently using the Windows Shell API in your program, adding library support is straightforward.</span></span> <span data-ttu-id="84fa4-146">Por ejemplo, si actualmente llama a la función [**SHGetKnownFolderItem**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetknownfolderitem) para obtener la ubicación de la carpeta Mis documentos, puede reemplazar el valor de [**KNOWNFOLDERID**](knownfolderid.md) de la carpeta Mis documentos conocidos por el valor **KNOWNFOLDERID** de la biblioteca correspondiente.</span><span class="sxs-lookup"><span data-stu-id="84fa4-146">For example, if you currently call the [**SHGetKnownFolderItem**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetknownfolderitem) function to get the location of the My Documents folder, you can replace the [**KNOWNFOLDERID**](knownfolderid.md) value of the My Documents known folder with the **KNOWNFOLDERID** value of the corresponding library.</span></span>

<span data-ttu-id="84fa4-147">En la tabla siguiente se muestra la relación entre los valores [**KNOWNFOLDERID**](knownfolderid.md) de las carpetas conocidas y el valor **KNOWNFOLDERID** de la biblioteca correspondiente en Windows 7.</span><span class="sxs-lookup"><span data-stu-id="84fa4-147">The following table shows the relationship between the [**KNOWNFOLDERID**](knownfolderid.md) values of known folders and the **KNOWNFOLDERID** value of the corresponding library in Windows 7.</span></span> 

| <span data-ttu-id="84fa4-148">Valores de KNOWNFOLDERID de carpeta conocidos</span><span class="sxs-lookup"><span data-stu-id="84fa4-148">Known Folder KNOWNFOLDERID values</span></span> | <span data-ttu-id="84fa4-149">Valores de KNOWNFOLDERID de biblioteca</span><span class="sxs-lookup"><span data-stu-id="84fa4-149">Library KNOWNFOLDERID values</span></span> |
|-----------------------------------|------------------------------|
| <span data-ttu-id="84fa4-150">Documentos de FOLDERID \_</span><span class="sxs-lookup"><span data-stu-id="84fa4-150">FOLDERID\_Documents</span></span>               | <span data-ttu-id="84fa4-151">FOLDERID \_ DocumentsLibrary</span><span class="sxs-lookup"><span data-stu-id="84fa4-151">FOLDERID\_DocumentsLibrary</span></span>   |
| <span data-ttu-id="84fa4-152">Imágenes de FOLDERID \_</span><span class="sxs-lookup"><span data-stu-id="84fa4-152">FOLDERID\_Pictures</span></span>                | <span data-ttu-id="84fa4-153">FOLDERID \_ PicturesLibrary</span><span class="sxs-lookup"><span data-stu-id="84fa4-153">FOLDERID\_PicturesLibrary</span></span>    |
| <span data-ttu-id="84fa4-154">\_Música FOLDERID</span><span class="sxs-lookup"><span data-stu-id="84fa4-154">FOLDERID\_Music</span></span>                   | <span data-ttu-id="84fa4-155">FOLDERID \_ MusicLibrary</span><span class="sxs-lookup"><span data-stu-id="84fa4-155">FOLDERID\_MusicLibrary</span></span>       |
| <span data-ttu-id="84fa4-156">FOLDERID \_ RecordedTV</span><span class="sxs-lookup"><span data-stu-id="84fa4-156">FOLDERID\_RecordedTV</span></span>              | <span data-ttu-id="84fa4-157">FOLDERID \_ RecordedTVLibrary</span><span class="sxs-lookup"><span data-stu-id="84fa4-157">FOLDERID\_RecordedTVLibrary</span></span>  |



 

### <a name="homegroup-and-shared-libraries"></a><span data-ttu-id="84fa4-158">Grupo hogar y bibliotecas compartidas</span><span class="sxs-lookup"><span data-stu-id="84fa4-158">HomeGroup and shared libraries</span></span>

<span data-ttu-id="84fa4-159">La incorporación de compatibilidad con la biblioteca al programa habilitará la compatibilidad con las bibliotecas compartidas en un grupo en el hogar.</span><span class="sxs-lookup"><span data-stu-id="84fa4-159">Adding library support to your program will enable support for shared libraries in a HomeGroup.</span></span> <span data-ttu-id="84fa4-160">El grupo en el hogar se identifica mediante su valor [**KNOWNFOLDERID**](knownfolderid.md) de [**FOLDERID \_ Grupo**](knownfolderid.md)en el hogar.</span><span class="sxs-lookup"><span data-stu-id="84fa4-160">The HomeGroup is identified by its [**KNOWNFOLDERID**](knownfolderid.md) value of [**FOLDERID\_HomeGroup**](knownfolderid.md).</span></span> <span data-ttu-id="84fa4-161">El programa puede identificar la ubicación de almacenamiento predeterminada privada o compartida del usuario estableciendo el valor de [**DEFAULTSAVEFOLDERTYPE**](/windows/desktop/api/shobjidl_core/ne-shobjidl_core-defaultsavefoldertype) en la llamada al método [**IShellLibrary:: GetDefaultSaveFolder**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelllibrary-getdefaultsavefolder) .</span><span class="sxs-lookup"><span data-stu-id="84fa4-161">Your program can find identify the user's private or shared default save location by setting the [**DEFAULTSAVEFOLDERTYPE**](/windows/desktop/api/shobjidl_core/ne-shobjidl_core-defaultsavefoldertype) value in the call to [**IShellLibrary::GetDefaultSaveFolder**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelllibrary-getdefaultsavefolder) method.</span></span>

## <a name="using-a-common-file-dialog-box-with-libraries"></a><span data-ttu-id="84fa4-162">Usar un cuadro de diálogo de archivo común con bibliotecas</span><span class="sxs-lookup"><span data-stu-id="84fa4-162">Using a common file dialog box with libraries</span></span>

<span data-ttu-id="84fa4-163">Usar un cuadro de diálogo de archivo común con bibliotecas el cuadro de diálogo archivo común se ha actualizado para admitir las bibliotecas de Windows 7.</span><span class="sxs-lookup"><span data-stu-id="84fa4-163">Using a common file dialog box with libraries The common file dialog box has been updated to support libraries in Windows 7.</span></span> <span data-ttu-id="84fa4-164">La siguiente ilustración muestra cómo aparece el cuadro de diálogo archivo común a un usuario en Windows 7.</span><span class="sxs-lookup"><span data-stu-id="84fa4-164">The following illustration shows how the common file dialog box appears to a user in Windows 7.</span></span>

![captura de pantalla del cuadro de diálogo de archivo común que muestra las bibliotecas](images/libraries-commonfiledialog.png)

<span data-ttu-id="84fa4-166">En Windows 7, si el programa muestra actualmente un cuadro de diálogo de archivo común y no cambia la plantilla de cuadro de diálogo ni enlaza ninguno de sus eventos, se mostrará automáticamente la nueva versión de Windows 7 del cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="84fa4-166">In Windows 7, if your program currently displays a common file dialog box and does not change the dialog box template or hook any of its events, it will display the new Windows 7 version of the dialog box automatically.</span></span> <span data-ttu-id="84fa4-167">En concreto, en la función de la llamada al cuadro de diálogo de archivo común, los miembros **lpfnHook**, **hInstance**, **lpTemplatename** de la estructura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) deben ser **null** y los marcadores **OFN \_ ENABLEHOOK** y **OFN \_ ENABLETEMPLATE** deben ser claros.</span><span class="sxs-lookup"><span data-stu-id="84fa4-167">Specifically, in the call to the common file dialog box function, the **lpfnHook**, **hInstance**, **lpTemplatename** members of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure must be **NULL** and the **OFN\_ENABLEHOOK** and **OFN\_ENABLETEMPLATE** flags must be clear.</span></span>

<span data-ttu-id="84fa4-168">En Windows 7, las interfaces relacionadas con [**IFileDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)reemplazan las funciones del cuadro de diálogo de archivos comunes que se usaban en versiones anteriores de Windows.</span><span class="sxs-lookup"><span data-stu-id="84fa4-168">In Windows 7, the [**IFileDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)-related interfaces replace the common file dialog box functions that were used in earlier versions of Windows.</span></span> <span data-ttu-id="84fa4-169">Las funciones del cuadro de diálogo de archivos comunes anteriores todavía se admiten en Windows 7, pero no proporcionan la experiencia del usuario completa de Windows 7 y no admiten bibliotecas.</span><span class="sxs-lookup"><span data-stu-id="84fa4-169">The earlier common file dialog box functions are still supported in Windows 7 but they do not provide the complete Windows 7 user experience and they do not support libraries.</span></span> <span data-ttu-id="84fa4-170">Algunas de las nuevas características admitidas por las interfaces relacionadas con **IFileDialog** incluyen:</span><span class="sxs-lookup"><span data-stu-id="84fa4-170">Some of the new features supported by the **IFileDialog**-related interfaces include:</span></span>

-   <span data-ttu-id="84fa4-171">El usuario puede tener acceso a las propiedades de archivo admitidas por el explorador de Windows 7 para buscar y seleccionar los archivos.</span><span class="sxs-lookup"><span data-stu-id="84fa4-171">The user can access the file properties supported by the Windows 7 Windows Explorer to search and select the files.</span></span>
-   <span data-ttu-id="84fa4-172">El programa puede utilizar interfaces y métodos de la API del espacio de nombres del shell para trabajar con los elementos.</span><span class="sxs-lookup"><span data-stu-id="84fa4-172">The program can use interfaces and methods from the Shell namespace API to work with the items.</span></span>
-   <span data-ttu-id="84fa4-173">El programa puede usar un modelo de personalización controlado por datos en lugar de un modelo de personalización controlado por archivos de recursos para agregar nuevos controles a los cuadros de diálogo de archivos comunes.</span><span class="sxs-lookup"><span data-stu-id="84fa4-173">The program can use a data-driven customization model instead of a resource-file-driven customization model to add new controls to the common file dialog boxes.</span></span>

<span data-ttu-id="84fa4-174">Debe usar las interfaces relacionadas con [**IFileDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)cuando:</span><span class="sxs-lookup"><span data-stu-id="84fa4-174">You should use the [**IFileDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)-related interfaces when:</span></span>

-   <span data-ttu-id="84fa4-175">debe personalizar el cuadro de diálogo archivo común para el programa en Windows 7.</span><span class="sxs-lookup"><span data-stu-id="84fa4-175">you need to customize the common file dialog box for your program in Windows 7.</span></span> <span data-ttu-id="84fa4-176">Esto permitirá que el programa funcione con las bibliotecas y admita la personalización del cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="84fa4-176">This will allow your program to work with libraries and support customizing your dialog box.</span></span>
-   <span data-ttu-id="84fa4-177">quiere que el usuario pueda seleccionar varios archivos desde un cuadro de diálogo de archivo común.</span><span class="sxs-lookup"><span data-stu-id="84fa4-177">you want the user to be able to select multiple files from a common file dialog box.</span></span> <span data-ttu-id="84fa4-178">Así se asegurará de que obtiene las rutas de acceso correctas al objeto seleccionado, ya que una biblioteca puede tener contenido que se almacena en carpetas diferentes.</span><span class="sxs-lookup"><span data-stu-id="84fa4-178">This will ensure you get the correct paths to the selected object because a library can have contents that are stored in different folders.</span></span>

<span data-ttu-id="84fa4-179">Para obtener más información sobre las interfaces relacionadas con [**IFileDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog), vea:</span><span class="sxs-lookup"><span data-stu-id="84fa4-179">For more information on the [**IFileDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)-related interfaces, see:</span></span>

-   [<span data-ttu-id="84fa4-180">**IFileDialog**</span><span class="sxs-lookup"><span data-stu-id="84fa4-180">**IFileDialog**</span></span>](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialog)
-   [<span data-ttu-id="84fa4-181">**IFileOpenDialog**</span><span class="sxs-lookup"><span data-stu-id="84fa4-181">**IFileOpenDialog**</span></span>](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog)
-   [<span data-ttu-id="84fa4-182">**IFileSaveDialog**</span><span class="sxs-lookup"><span data-stu-id="84fa4-182">**IFileSaveDialog**</span></span>](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ifilesavedialog)
-   [<span data-ttu-id="84fa4-183">**IFileDialogCustomize**</span><span class="sxs-lookup"><span data-stu-id="84fa4-183">**IFileDialogCustomize**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize)
-   [<span data-ttu-id="84fa4-184">**IFileDialogEvents**</span><span class="sxs-lookup"><span data-stu-id="84fa4-184">**IFileDialogEvents**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogevents)
-   [<span data-ttu-id="84fa4-185">**IFileDialogControlEvents**</span><span class="sxs-lookup"><span data-stu-id="84fa4-185">**IFileDialogControlEvents**</span></span>](/windows/desktop/api/Shobjidl/nn-shobjidl-ifiledialogcontrolevents)

## <a name="enabling-library-selection-from-the-user-interface"></a><span data-ttu-id="84fa4-186">Habilitar la selección de biblioteca desde la interfaz de usuario</span><span class="sxs-lookup"><span data-stu-id="84fa4-186">Enabling library selection from the user interface</span></span>

<span data-ttu-id="84fa4-187">Si el programa permite al usuario seleccionar una carpeta, como las funciones de importación o exportación, en Windows 7, debe permitir que el usuario seleccione también una biblioteca.</span><span class="sxs-lookup"><span data-stu-id="84fa4-187">If your program allows the user to select a folder, such as for import or export functions, in Windows 7, it should allow the user to select a library as well.</span></span> <span data-ttu-id="84fa4-188">La interfaz [**IFileOpenDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog) y la función [**SHBrowseForFolder**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbrowseforfoldera) permiten al usuario seleccionar una biblioteca cuando se le pide que seleccione una carpeta.</span><span class="sxs-lookup"><span data-stu-id="84fa4-188">The [**IFileOpenDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog) interface and [**SHBrowseForFolder**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbrowseforfoldera) function allow the user to select a library when prompted to select a folder.</span></span> <span data-ttu-id="84fa4-189">La interfaz **IFileOpenDialog** es preferible a la función **SHBrowseForFolder** porque **IFileOpenDialog** es compatible con la interfaz de usuario de Windows 7.</span><span class="sxs-lookup"><span data-stu-id="84fa4-189">The **IFileOpenDialog** interface is preferred over the **SHBrowseForFolder** function because **IFileOpenDialog** supports the Windows 7 user interface.</span></span>

<span data-ttu-id="84fa4-190">Para permitir que los usuarios seleccionen carpetas al usar la interfaz [**IFileOpenDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog) , llame a SetOptions con la marca de FOS \_ PICKFOLDERS establecida y asegúrese de que la marca de FOS \_ FORCEFILESYSTEM está clara.</span><span class="sxs-lookup"><span data-stu-id="84fa4-190">To allow users to select folders when using the [**IFileOpenDialog**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog) interface, call SetOptions with the FOS\_PICKFOLDERS flag set and make sure the FOS\_FORCEFILESYSTEM flag is clear.</span></span>


```C++
FILEOPENDIALOGOPTIONS fileOptions;

hr = fileOpenDialogBox->GetOptions(&fileOptions);
fileOptions = fileOptions | FOS_PICKFOLDERS | ~FOS_FORCEFILESYSTEM;
hr = fileOpenDialogBox->SetOptions(fileOptions);
```



<span data-ttu-id="84fa4-191">Para permitir que los usuarios seleccionen carpetas al llamar a la función SHBrowseForFolder, en el miembro ulFlags de la estructura [**BROWSEINFO**](/windows/desktop/api/shlobj_core/ns-shlobj_core-browseinfoa) , establezca la \_ marca BIF USENEWUI y borre la \_ marca BIF RETURNONLYFSDIRS.</span><span class="sxs-lookup"><span data-stu-id="84fa4-191">To allow users to select folders when calling the SHBrowseForFolder function, in the ulFlags member of the [**BROWSEINFO**](/windows/desktop/api/shlobj_core/ns-shlobj_core-browseinfoa) structure, set the BIF\_USENEWUI flag and clear the BIF\_RETURNONLYFSDIRS flag.</span></span>


```C++
BROWSEINFO    browseInfo;
browseInfo.ulFlags = BIF_USENEWUI | ~BIF_RETURNONLYFSDIRS;
// Set other member values
pidl = SHBrowseForFolder(&browseInfo);
```



## <a name="accessing-library-content-in-a-program"></a><span data-ttu-id="84fa4-192">Acceder al contenido de una biblioteca en un programa</span><span class="sxs-lookup"><span data-stu-id="84fa4-192">Accessing library content in a program</span></span>

<span data-ttu-id="84fa4-193">Para tener acceso al contenido de una biblioteca, debe usar la API de Shell de Windows.</span><span class="sxs-lookup"><span data-stu-id="84fa4-193">To access the contents of a library, you must use the Windows Shell API.</span></span> <span data-ttu-id="84fa4-194">Las funciones de la API de sistema de archivos no se pueden usar para tener acceso al contenido de la biblioteca porque las bibliotecas no son objetos del sistema de archivos.</span><span class="sxs-lookup"><span data-stu-id="84fa4-194">Functions of the file-system API cannot be used to access library contents because libraries are not file-system objects.</span></span> <span data-ttu-id="84fa4-195">Si el programa usa un explorador de archivos personalizado que se basa en la API del sistema de archivos, no podrá examinar bibliotecas ni acceder al contenido de la biblioteca.</span><span class="sxs-lookup"><span data-stu-id="84fa4-195">If your program uses a custom file browser that is based on the file-system API, it will not be able to browse libraries or access library content.</span></span>

<span data-ttu-id="84fa4-196">En esta sección se describe cómo puede tener acceso al contenido de la biblioteca para que pueda seleccionar la mejor manera de actualizar el programa para trabajar con las bibliotecas.</span><span class="sxs-lookup"><span data-stu-id="84fa4-196">This section describes how you can access library content so that you can select the best way to update your program to work with libraries.</span></span>

### <a name="accessing-library-content-with-the-ishelllibrary-interface"></a><span data-ttu-id="84fa4-197">Acceder al contenido de la biblioteca con la interfaz IShellLibrary</span><span class="sxs-lookup"><span data-stu-id="84fa4-197">Accessing library content with the IShellLibrary interface</span></span>

<span data-ttu-id="84fa4-198">La forma más sencilla de que un programa tenga acceso al contenido de la biblioteca es usar la API de la [**biblioteca de Shell**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary).</span><span class="sxs-lookup"><span data-stu-id="84fa4-198">The easiest way for a program to access library content is to use the [**Shell Library API**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary).</span></span> <span data-ttu-id="84fa4-199">Si está trabajando en un programa que usa la API del sistema de archivos, la **API** de la biblioteca de Shell puede devolver las carpetas del sistema de archivos de una biblioteca, lo que minimiza el cambio en el código de programa existente.</span><span class="sxs-lookup"><span data-stu-id="84fa4-199">If you are working on a program that uses the file-system API, the **Shell Library API** can return the file-system folders of a library, which minimizes the change to your existing program code.</span></span>


```C++
IShellLibrary *picturesLibrary;

hr = SHLoadLibraryFromKnownFolder(FOLDERID_PicturesLibrary, 
                                  STGM_READ, 
                                  IID_PPV_ARGS(&picturesLibrary));

// picturesLibrary now points to the user's picture library
    
IShellItemArray *pictureFolders; 

hr = pslLibrary->GetFolders(LFF_FORCEFILESYSTEM, IID_PPV_ARGS(&pictureFolders));

// pictureFolders now contains an array of Shell items that
// represent the folders found in the user's pictures library
```



### <a name="accessing-library-content-with-the-shell-apis"></a><span data-ttu-id="84fa4-200">Acceder al contenido de la biblioteca con las API de Shell</span><span class="sxs-lookup"><span data-stu-id="84fa4-200">Accessing library content with the Shell APIs</span></span>

<span data-ttu-id="84fa4-201">Dado que los objetos de biblioteca forman parte del modelo de programación de Shell, se pueden usar con otras API del shell de Windows.</span><span class="sxs-lookup"><span data-stu-id="84fa4-201">Because the library objects are part of the Shell programming model, they can be used with other Windows Shell APIs.</span></span> <span data-ttu-id="84fa4-202">Por ejemplo, puede usar las interfaces [**IShellItem**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellitem) y [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) en el programa, junto con las funciones auxiliares relacionadas, para tener acceso al contenido de una biblioteca de la misma manera en que se enumeran las carpetas y el contenido de la carpeta para tener acceso al contenido con las API del sistema de archivos.</span><span class="sxs-lookup"><span data-stu-id="84fa4-202">For example you can use the [**IShellItem**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellitem) and [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interfaces in your program, along with related helper functions, to access the contents of a library in the same way as you would enumerate folders and folder contents to access content with the file system APIs.</span></span>

<span data-ttu-id="84fa4-203">Las API del shell de Windows admiten dos modos de enumeración para tener acceso al contenido de una biblioteca:</span><span class="sxs-lookup"><span data-stu-id="84fa4-203">The Windows Shell APIs support two enumeration modes to access the contents of a library:</span></span>

-   <span data-ttu-id="84fa4-204">**Examinar enumeración**</span><span class="sxs-lookup"><span data-stu-id="84fa4-204">**Browse enumeration**</span></span>

    <span data-ttu-id="84fa4-205">Examinar enumeración es el modo de enumeración predeterminado y enumera el contenido de una carpeta de biblioteca.</span><span class="sxs-lookup"><span data-stu-id="84fa4-205">Browse enumeration is the default enumeration mode and enumerates the contents of a library folder.</span></span> <span data-ttu-id="84fa4-206">Desactive la \_ marca de la enumeración de navegación SHCONTF \_ para usar este modo.</span><span class="sxs-lookup"><span data-stu-id="84fa4-206">Clear the SHCONTF\_NAVIGATION\_ENUM flag to use this mode.</span></span>

-   <span data-ttu-id="84fa4-207">**Enumeración de navegación**</span><span class="sxs-lookup"><span data-stu-id="84fa4-207">**Navigation enumeration**</span></span>

    <span data-ttu-id="84fa4-208">La enumeración de navegación enumera las carpetas de la biblioteca.</span><span class="sxs-lookup"><span data-stu-id="84fa4-208">Navigation enumeration enumerates the library folders.</span></span> <span data-ttu-id="84fa4-209">Establezca la marca de la \_ enumeración de navegación SHCONTF \_ para usar este modo.</span><span class="sxs-lookup"><span data-stu-id="84fa4-209">Set the SHCONTF\_NAVIGATION\_ENUM flag to use this mode.</span></span>

<span data-ttu-id="84fa4-210">Si el programa usa un control de árbol personalizado para navegar por las carpetas del usuario, la enumeración de las carpetas en el modo de enumeración de navegación le proporcionará una lista de las carpetas de la biblioteca que es coherente con la forma en que el explorador de Windows enumera las carpetas en Windows 7.</span><span class="sxs-lookup"><span data-stu-id="84fa4-210">If your program uses a custom tree control to navigate the user's folders, enumerating the folders in the navigation enumeration mode will give you a list of a library's folders that is consistent with how the Windows Explorer enumerates folders in Windows 7.</span></span>

<span data-ttu-id="84fa4-211">Para obtener ejemplos de cómo usar estas características en un programa, vea el ejemplo ShellStorage en el Windows SDK.</span><span class="sxs-lookup"><span data-stu-id="84fa4-211">For examples of how to uses these features in a program, see the ShellStorage sample in the Windows SDK.</span></span>

## <a name="saving-user-content-in-a-library"></a><span data-ttu-id="84fa4-212">Guardar el contenido de un usuario en una biblioteca</span><span class="sxs-lookup"><span data-stu-id="84fa4-212">Saving user content in a library</span></span>

<span data-ttu-id="84fa4-213">El programa puede guardar el contenido de un usuario en una biblioteca, así como en una carpeta de la biblioteca.</span><span class="sxs-lookup"><span data-stu-id="84fa4-213">Your program can save user content to a library as well as to a folder in the library.</span></span> <span data-ttu-id="84fa4-214">Del mismo modo, el usuario puede guardar en una carpeta específica de una biblioteca o simplemente guardar en la biblioteca.</span><span class="sxs-lookup"><span data-stu-id="84fa4-214">Likewise, the user can save to a specific folder in a library or they can just save to the library.</span></span>

<span data-ttu-id="84fa4-215">Cada biblioteca tiene una carpeta que se designa como ubicación de almacenamiento predeterminada.</span><span class="sxs-lookup"><span data-stu-id="84fa4-215">Every library has a folder that is designated as the default save location.</span></span> <span data-ttu-id="84fa4-216">La ubicación de almacenamiento predeterminada se define cuando se crea la biblioteca. sin embargo, el usuario puede reasignar la ubicación de almacenamiento predeterminada para que sea cualquier carpeta de la biblioteca.</span><span class="sxs-lookup"><span data-stu-id="84fa4-216">The default save location is defined when the library is created; however the user can reassign the default save location to be any folder in the library.</span></span> <span data-ttu-id="84fa4-217">Aunque el usuario no necesita configurar una ubicación de almacenamiento predeterminada, tiene la opción de cambiarla.</span><span class="sxs-lookup"><span data-stu-id="84fa4-217">While the user does not need to configure a default save location, they have the option to change it.</span></span> <span data-ttu-id="84fa4-218">Si el usuario elimina la carpeta que está configurada actualmente como ubicación de almacenamiento predeterminada, la biblioteca configurará automáticamente la carpeta siguiente en la biblioteca para que sea la ubicación de almacenamiento predeterminada.</span><span class="sxs-lookup"><span data-stu-id="84fa4-218">If the user deletes the folder that is currently set as the default save location, the library will automatically configure the next folder in the library to be the default save location.</span></span>

<span data-ttu-id="84fa4-219">Hay varias maneras de guardar el contenido de un usuario en una biblioteca.</span><span class="sxs-lookup"><span data-stu-id="84fa4-219">There are several ways you can save user content to a library.</span></span>

-   <span data-ttu-id="84fa4-220">**API de Shell**</span><span class="sxs-lookup"><span data-stu-id="84fa4-220">**Shell API**</span></span>

    <span data-ttu-id="84fa4-221">Si usa el modelo de programación de Shell y guarda un elemento de Shell, como se representa mediante [**IShellItem**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellitem), IStorage o IStream, en un objeto de biblioteca, el elemento de Shell se almacenará automáticamente en la ubicación de almacenamiento predeterminada de la biblioteca.</span><span class="sxs-lookup"><span data-stu-id="84fa4-221">If you are using the Shell programming model and save a Shell item, as represented by an [**IShellItem**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellitem), IStorage, or IStream, to a library object, the Shell item will be automatically stored in the default save location of the library.</span></span>

-   <span data-ttu-id="84fa4-222">**API del sistema de archivos**</span><span class="sxs-lookup"><span data-stu-id="84fa4-222">**File-system API**</span></span>

    <span data-ttu-id="84fa4-223">Si tiene un programa existente que usa muchas llamadas API del sistema de archivos, puede obtener una ruta de acceso a la carpeta definida como la ubicación de almacenamiento predeterminada de la biblioteca.</span><span class="sxs-lookup"><span data-stu-id="84fa4-223">If you have an existing program that uses many file-system API calls, you can get a path to the folder that is defined as the library's default save location.</span></span> <span data-ttu-id="84fa4-224">La ruta de acceso de la carpeta se puede pasar a una API del sistema de archivos.</span><span class="sxs-lookup"><span data-stu-id="84fa4-224">The folder path can then be passed to a file-system API.</span></span>

<span data-ttu-id="84fa4-225">Para obtener ejemplos de cómo usar estas características en un programa, vea el ejemplo ShellStorage en el Windows SDK.</span><span class="sxs-lookup"><span data-stu-id="84fa4-225">For examples of how to uses these features in a program, see the ShellStorage sample in the Windows SDK.</span></span>

## <a name="supporting-drag-and-drop-operations-in-a-library"></a><span data-ttu-id="84fa4-226">Admitir operaciones de arrastrar y colocar en una biblioteca</span><span class="sxs-lookup"><span data-stu-id="84fa4-226">Supporting drag-and-drop operations in a library</span></span>

<span data-ttu-id="84fa4-227">Si el programa admite acciones de arrastrar y colocar, deben actualizarse para admitir la interacción de biblioteca correcta.</span><span class="sxs-lookup"><span data-stu-id="84fa4-227">If your program supports drag-and-drop actions, those should be updated to support the correct library interaction.</span></span> <span data-ttu-id="84fa4-228">Si se coloca un archivo en una biblioteca, el archivo quitado debe guardarse en la ubicación de almacenamiento predeterminada.</span><span class="sxs-lookup"><span data-stu-id="84fa4-228">If a file is dropped into a library, the dropped file should be saved in the default save location.</span></span> <span data-ttu-id="84fa4-229">Si una carpeta se coloca en una biblioteca, la carpeta quitada debe agregarse como una nueva carpeta a la biblioteca.</span><span class="sxs-lookup"><span data-stu-id="84fa4-229">If a folder is dropped into a library, the dropped folder should be added as a new folder to the library.</span></span> <span data-ttu-id="84fa4-230">Si un archivo se coloca en una carpeta existente que no es la ubicación de almacenamiento predeterminada, el archivo debe agregarse a la carpeta seleccionada.</span><span class="sxs-lookup"><span data-stu-id="84fa4-230">If a file is dropped into an existing folder that is not the default save location, the file should be added to the selected folder.</span></span>

<span data-ttu-id="84fa4-231">Para obtener ejemplos de cómo agregar compatibilidad de biblioteca para la funcionalidad de arrastrar y colocar de programas, consulte el ejemplo ShellLibraryCommandLine en el Windows SDK.</span><span class="sxs-lookup"><span data-stu-id="84fa4-231">For examples of how to add library support for your programs drag-and-drop functionality, see the ShellLibraryCommandLine sample in the Windows SDK.</span></span>

## <a name="keeping-in-sync-with-a-library"></a><span data-ttu-id="84fa4-232">Mantener la sincronización con una biblioteca</span><span class="sxs-lookup"><span data-stu-id="84fa4-232">Keeping in sync with a library</span></span>

<span data-ttu-id="84fa4-233">En este tema se describe cómo un programa puede mantener actualizada su vista del contenido de una biblioteca.</span><span class="sxs-lookup"><span data-stu-id="84fa4-233">This topic describes how a program can keep its view of a library's content up-to-date.</span></span>

### <a name="bulk-update"></a><span data-ttu-id="84fa4-234">Actualización masiva</span><span class="sxs-lookup"><span data-stu-id="84fa4-234">Bulk Update</span></span>

<span data-ttu-id="84fa4-235">Dado que el usuario puede modificar las carpetas de una biblioteca de forma interactiva cuando el programa no se está ejecutando, el programa debe llamar a [**SHResolveLibrary**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-shresolvelibrary) cuando empiece a detectar y almacenar los cambios en la biblioteca.</span><span class="sxs-lookup"><span data-stu-id="84fa4-235">Because the user can modify the folders of a library interactively when your program is not running, your program should call [**SHResolveLibrary**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-shresolvelibrary) when it starts to discover and store any changes to the library.</span></span> <span data-ttu-id="84fa4-236">La API de Shell proporciona la función **SHResolveLibrary** para permitir que un programa obtenga el contenido actual de una biblioteca y las ubicaciones actuales de cualquier carpeta que la biblioteca pueda contener.</span><span class="sxs-lookup"><span data-stu-id="84fa4-236">The Shell API provides the **SHResolveLibrary** function to enable a program to get the current contents of a library and the current locations of any folders the library might contain.</span></span>

<span data-ttu-id="84fa4-237">Tenga en cuenta que [**SHResolveLibrary**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-shresolvelibrary) es una función de bloqueo que podría tardar mucho tiempo en devolverse según lo que haya cambiado en la biblioteca.</span><span class="sxs-lookup"><span data-stu-id="84fa4-237">Note that [**SHResolveLibrary**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-shresolvelibrary) is a blocking function that could take a long time to return depending on what has changed in the library.</span></span> <span data-ttu-id="84fa4-238">Como tal, no se debe llamar desde un subproceso de interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="84fa4-238">As such, it should not be called from a UI thread.</span></span>

<span data-ttu-id="84fa4-239">Una vez que el programa se ha actualizado, puede registrarse para recibir notificaciones de cambio con el fin de mantener una vista actual.</span><span class="sxs-lookup"><span data-stu-id="84fa4-239">After the program has been brought up-to-date, it can then register for change notifications to maintain a current view.</span></span>

### <a name="shell-api-notification"></a><span data-ttu-id="84fa4-240">Notificación de API de Shell</span><span class="sxs-lookup"><span data-stu-id="84fa4-240">Shell API Notification</span></span>

<span data-ttu-id="84fa4-241">La API de Shell de Windows proporciona la función [**SHChangeNotifyRegister**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotifyregister) , que es la manera preferida para que los procesos que no son de servicio reciban una notificación de un cambio en la biblioteca.</span><span class="sxs-lookup"><span data-stu-id="84fa4-241">The Windows Shell API provides the [**SHChangeNotifyRegister**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotifyregister) function, which is the preferred way for non-service processes to be notified of a change in the library.</span></span>

<span data-ttu-id="84fa4-242">Para detectar cambios en los elementos de una biblioteca mediante la API de Shell de Windows, llame a [**SHChangeNotifyRegister**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotifyregister) para registrar el programa para las notificaciones de cambios en los elementos de una carpeta de biblioteca.</span><span class="sxs-lookup"><span data-stu-id="84fa4-242">To detect changes to items within a library using the Windows Shell API, call [**SHChangeNotifyRegister**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotifyregister) to register your program for notifications of changes to items in a library folder.</span></span> <span data-ttu-id="84fa4-243">Esta función puede notificar al programa si hay un cambio en alguna biblioteca o simplemente en una biblioteca específica.</span><span class="sxs-lookup"><span data-stu-id="84fa4-243">This function can notify your program if there is a change in any library or just in a specific library.</span></span> <span data-ttu-id="84fa4-244">Las notificaciones se envían inmediatamente cuando se cambia una biblioteca.</span><span class="sxs-lookup"><span data-stu-id="84fa4-244">Notifications are sent immediately when a library is changed.</span></span>

### <a name="file-system-api-notification"></a><span data-ttu-id="84fa4-245">Notificación de API del sistema de archivos</span><span class="sxs-lookup"><span data-stu-id="84fa4-245">File-system API Notification</span></span>

<span data-ttu-id="84fa4-246">Las notificaciones del sistema de archivos se deben usar en los procesos de servicio.</span><span class="sxs-lookup"><span data-stu-id="84fa4-246">File system notifications must be used in service processes.</span></span>

<span data-ttu-id="84fa4-247">Para detectar cambios en los elementos de una biblioteca mediante la API del sistema de archivos, enumere las carpetas de la biblioteca y llame a [**FindFirstChangeNotification**](/windows/win32/api/fileapi/nf-fileapi-findfirstchangenotificationa) para cada carpeta que se va a supervisar.</span><span class="sxs-lookup"><span data-stu-id="84fa4-247">To detect changes to items in a library using the file-system API, enumerate the folders in the library and call [**FindFirstChangeNotification**](/windows/win32/api/fileapi/nf-fileapi-findfirstchangenotificationa) for each folder to monitor.</span></span> <span data-ttu-id="84fa4-248">El programa recibirá una notificación cuando cambie una carpeta supervisada.</span><span class="sxs-lookup"><span data-stu-id="84fa4-248">Your program will receive notification when a monitored folder changes.</span></span> <span data-ttu-id="84fa4-249">Para buscar el archivo específico de archivos que han cambiado en la carpeta, llame a [**ReadDirectoryChangesW**](/windows/win32/api/winbase/nf-winbase-readdirectorychangesw).</span><span class="sxs-lookup"><span data-stu-id="84fa4-249">To find the specific file of files that changed in the folder, call [**ReadDirectoryChangesW**](/windows/win32/api/winbase/nf-winbase-readdirectorychangesw).</span></span> <span data-ttu-id="84fa4-250">Para detectar cambios en el archivo de descripción de la biblioteca, supervise la carpeta que lo contiene.</span><span class="sxs-lookup"><span data-stu-id="84fa4-250">To detect changes in the library description file, monitor the folder that contains it.</span></span> <span data-ttu-id="84fa4-251">El archivo de descripción de la biblioteca se puede encontrar en la carpeta [**FOLDERID \_ Libraries**](knownfolderid.md) .</span><span class="sxs-lookup"><span data-stu-id="84fa4-251">The library description file can be found in the [**FOLDERID\_Libraries**](knownfolderid.md) folder.</span></span> <span data-ttu-id="84fa4-252">El archivo de descripción de la biblioteca, sin embargo, no se debe abrir ni modificar.</span><span class="sxs-lookup"><span data-stu-id="84fa4-252">The library description file, however, should not be opened or modified.</span></span>

## <a name="related-topics"></a><span data-ttu-id="84fa4-253">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="84fa4-253">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="84fa4-254">Acerca de las bibliotecas</span><span class="sxs-lookup"><span data-stu-id="84fa4-254">About Libraries</span></span>](library-leverage-to-manage-folders.md)
</dt> <dt>

[<span data-ttu-id="84fa4-255">**IShellLibrary**</span><span class="sxs-lookup"><span data-stu-id="84fa4-255">**IShellLibrary**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelllibrary)
</dt> <dt>

[<span data-ttu-id="84fa4-256">Vínculos de Shell</span><span class="sxs-lookup"><span data-stu-id="84fa4-256">Shell Links</span></span>](./links.md)
</dt> <dt>

[<span data-ttu-id="84fa4-257">Carpetas conocidas</span><span class="sxs-lookup"><span data-stu-id="84fa4-257">Known Folders</span></span>](known-folders.md)
</dt> <dt>

[<span data-ttu-id="84fa4-258">Esquema de descripción de biblioteca</span><span class="sxs-lookup"><span data-stu-id="84fa4-258">Library Description Schema</span></span>](library-schema-entry.md)
</dt> <dt>

[<span data-ttu-id="84fa4-259">**IID \_ PPV \_ args**</span><span class="sxs-lookup"><span data-stu-id="84fa4-259">**IID\_PPV\_ARGS**</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-iid_ppv_args)
</dt> </dl>

 

 
