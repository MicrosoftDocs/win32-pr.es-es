---
description: Obtenga información sobre cómo proteger los servicios de modo de usuario antimalware (AM) y cómo puede optar por incluir esta característica en el servicio antimalware.
ms.assetid: 88875a0d-9027-43f2-8411-34f9ff428fe5
title: Protección de los servicios antimalware
ms.topic: article
ms.date: 08/02/2018
ms.openlocfilehash: c2e50bb9e7ef2bec22d2b4b9cd2a72106ed57bd23d11135e026a1a84f0f1fc05
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/11/2021
ms.locfileid: "117967851"
---
# <a name="protecting-anti-malware-services"></a>Protección de los servicios antimalware

Windows 8.1 un nuevo concepto de servicios protegidos para proteger los servicios antimalware, que son un objetivo frecuente de ataques por malware.

Obtenga información sobre cómo proteger los servicios de modo de usuario antimalware (AM) y cómo puede optar por incluir esta característica en el servicio antimalware.

Esta información se aplica a los siguientes sistemas operativos y a sus sucesores:

-   Windows 8.1
-   Windows Server 2012 R2

Al final de este tema se enumeran las referencias y los recursos que se deban tratar aquí.

## <a name="introduction"></a>Introducción

La mayoría de las soluciones antimalware incluyen un servicio en modo de usuario que realiza operaciones especializadas para detectar y quitar malware del sistema. Este servicio en modo de usuario también es responsable con frecuencia de descargar las definiciones y firmas de virus más recientes. Este servicio en modo de usuario se convierte en un objetivo frecuente de malware porque es el único punto de error al deshabilitar la protección en un sistema. Para defenderse contra ataques en el servicio de modo de usuario, los proveedores antimalware tienen que agregar una gran cantidad de funcionalidad y heurística a su software. Sin embargo, estas técnicas no son completamente infalibles y tienden a ser propensas a errores porque tienen que identificar la funcionalidad que Windows realiza en su servicio y habilitar de forma selectiva esa funcionalidad.

En Windows 8.1, se ha introducido un nuevo concepto de servicio protegido para permitir que los servicios en modo de usuario antimalware se puedan iniciar como un servicio protegido. Después de iniciar el servicio como protegido, Windows integridad de código para permitir que solo se cargue código de confianza en el servicio protegido. Windows también protege estos procesos de la inyección de código y otros ataques de los procesos de administración.

En este documento se describe cómo un proveedor antimalware con un controlador antimalware de inicio temprano (ELAM) puede participar en esta característica e iniciar su servicio antimalware como un servicio protegido.

## <a name="system-protected-process"></a>Proceso protegido por el sistema

A partir Windows 8.1, se ha puesto en marcha un nuevo modelo de seguridad en el kernel para defenderse mejor contra ataques malintencionados en componentes críticos para el sistema. Este nuevo modelo de seguridad amplía las versiones anteriores de la infraestructura de procesos protegidos de Windows usadas para escenarios específicos, como la reproducción de contenido DRM, en un modelo de uso general que pueden usar proveedores antimalware de terceros. La infraestructura de procesos protegidos solo permite cargar código firmado de confianza y tiene una defensa integrada frente a ataques por inyección de código.

Consulte [Procesos protegidos en Windows Vista para](https://download.microsoft.com/download/a/f/7/af7777e5-7dcd-4800-8a0a-b18336565f5b/process_vista.doc) obtener más información sobre los procesos protegidos.

El nuevo modelo de seguridad usa una variante ligeramente diferente de la infraestructura de proceso de protección denominada proceso protegido por el sistema, que es más adecuada para esta característica, ya que esto mantiene el contenido DRM independiente. Cada proceso protegido por el sistema tiene un nivel o atributo asociado, que indica la directiva de firma del código firmado que se puede cargar dentro del proceso. Una vez que los servicios antimalware han optado por el modo de servicio protegido Windows, solo se puede cargar en ese proceso un código firmado o un código firmado con los certificados del proveedor antimalware. De forma similar, otros niveles de proceso protegidos tienen directivas de código diferentes aplicadas por Windows.

## <a name="requirements"></a>Requisitos

Para que un servicio en modo de usuario antimalware se ejecute como un servicio protegido, el proveedor antimalware debe tener instalado un controlador ELAM en la máquina Windows software malintencionado. Además de los requisitos de certificación del controlador ELAM existentes, el controlador debe tener una sección de recursos incrustados que contenga la información de los certificados usados para firmar los archivos binarios del servicio en modo de usuario.

> [!IMPORTANT]
> En Windows 8.1, la cadena de certificación debe ser una raíz conocida determinada por la comprobación del controlador o debe incluirse el certificado raíz.

 

Durante el proceso de arranque, esta sección de recursos se extraerá del controlador ELAM para validar la información del certificado y registrar el servicio antimalware. El servicio antimalware también se puede registrar durante el proceso de instalación de software antimalware mediante una llamada a una API especial, como se describe más adelante en este documento.

Una vez que la sección de recursos se extrae correctamente del controlador ELAM y se registra el servicio en modo de usuario, se permite que el servicio se inicie como servicio protegido. Después de iniciar el servicio como protegido, otros procesos no protegidos del sistema no podrán insertar subprocesos y no podrán escribir en la memoria virtual del proceso protegido.

Además, los archivos DLL que no Windows que se cargan en el proceso protegido deben firmarse con un certificado adecuado.

Consulte [Early launch antimalware (Antimalware de inicio](/windows/desktop/w8cookbook/secured-boot) temprano) para obtener más información sobre los controladores de ELAM.

### <a name="anti-malware-service-signing-requirements"></a>Requisitos de firma de servicio antimalware

El servicio en modo de usuario que debe iniciarse como protegido debe estar firmado con certificados válidos. El archivo EXE de servicio debe estar firmado por hash de página y los archivos DLL que no sean de Windows que se carguen en el servicio también deben estar firmados con los mismos certificados. El hash de estos certificados debe agregarse al archivo de recursos, que se vinculará al controlador ELAM.

> [!Note]  
> Se deben usar hashes de archivo o página SHA256, aunque los certificados pueden seguir siendo SHA1.

 

### <a name="primary-signature-recommended"></a>Firma principal (recomendado)

Se recomienda que los proveedores antimalware usen su certificado Authenticode existente para firmar sus archivos binarios del servicio antimalware y que el hash de este certificado Authenticode se incluya en la sección de recursos para indicar el certificado que se usa para firmar los archivos binarios del servicio. Si actualiza este certificado, se debe liberar una versión más reciente del controlador ELAM con los hash de certificado actualizados.

### <a name="secondary-signature-optional"></a>Firma secundaria (opcional)

Los proveedores de antimalware tienen la opción de configurar una ENTIDAD de certificación privada y usar certificados de esta ENTIDAD de certificación para firmar en código los archivos binarios del servicio antimalware como una firma secundaria. La principal ventaja de usar la CA privada es que permite a los proveedores crear certificados con una propiedad EKU especializada, que se puede usar para diferenciar entre varios productos del mismo proveedor. También reduce la necesidad de actualizar el controlador ELAM debido a la expiración del certificado, ya que los certificados de entidad de certificación privada suelen tener fechas de expiración más largas.

Tenga en cuenta que si los archivos binarios de servicio están firmados con los certificados de entidad de certificación privada, los archivos binarios también deben estar firmados doblemente con los certificados Authenticode existentes. Si los archivos binarios no están firmados por una entidad de certificación de confianza conocida (por ejemplo, VeriSign), el usuario de la máquina no tiene confianza en los archivos binarios porque no puede confiar en la CA privada. La firma dual de los archivos binarios con el certificado Authenticode existente también permite que los archivos binarios se ejecuten en sistemas operativos de nivel inferior.

Para obtener más información sobre cómo configurar e instalar la entidad de certificación, vea Configurar una entidad de [certificación](/previous-versions/windows/desktop/ms755466(v=vs.85)) e [Instalar la entidad de certificación](/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/jj125375(v=ws.11)).

> [!Note]  
> Para la compatibilidad con Windows Vista o Windows XP (o Windows 7 sin la revisión SHA2), puede usar el modificador "/as" al firmar los archivos binarios [conSignTool.exe](/windows/desktop/SecCrypto/signtool) con los hashes de archivo o página SHA256. Esto agregará la firma como una firma secundaria al archivo. SHA1 firma primero el archivo, ya que Windows XP, Windows Vista y Windows 7 solo verán la primera firma.

 

### <a name="dll-signing-requirements"></a>Requisitos de firma de DLL

Como se mencionó anteriormente, los archivos DLL no Windows que se carguen en el servicio protegido deben firmarse con el mismo certificado que se usó para firmar el servicio antimalware.

### <a name="catalog-signing"></a>Firma de catálogo

Los proveedores antimalware pueden incluir paquetes desarrollados por otras empresas sin actualizar las firmas binarias. Esto se puede lograr mediante la inclusión de los archivos binarios en un catálogo que está firmado con su certificado Authenticode, lo que se consigue siguiendo estos pasos:

1. Generación de un catálogo [mediante MakeCat](/windows/desktop/SecCrypto/makecat)
2. Agregar todos los archivos binarios sin una firma adecuada al catálogo
3. Firmar el catálogo con el certificado Authenticode, como haría con cualquier otro archivo binario
4. Use la [función agregar](/windows/desktop/api/Mscat/nf-mscat-cryptcatadminaddcatalog) catálogo para incluir el catálogo con la aplicación.

Cuando la integridad del código se encuentra con los paquetes sin una firma adecuada, buscará un catálogo con una firma aprobada. Encontrará este catálogo siempre que se sigan estos pasos y se instale con la aplicación.


## <a name="resource-file-info"></a>Información del archivo de recursos

Se debe crear un archivo de recursos y vincularlo al controlador ELAM. El hash del certificado, junto con otra información de certificado, debe agregarse en el archivo de recursos.

La sección de recursos debe estar en el diseño siguiente para que el sistema extraiga correctamente los recursos de la imagen binaria y valide la información del certificado incrustado.

``` syntax
MicrosoftElamCertificateInfo  MSElamCertInfoID
{
      3, // count of entries
      L”CertHash1\0”,
      Algorithm,
      L”EKU1\0”,
      L”CertHash2\0”,
      Algorithm,
      L”\0”, //No EKU for cert hash 2
      L”CertHash3\0”,
      Algorithm,
      L”EKU3a;EKU3b;EKU3c\0”,  //multiple EKU entries supported (max: 3)
}
```

Para obtener más información sobre el archivo de recursos definido por el usuario, vea [Recurso definido por el usuario](/windows/desktop/menurc/user-defined-resource).

### <a name="certhash"></a>CertHash

Hash del certificado que se usa para firmar el servicio antimalware. La CertMgr.exe, que se incluye en el SDK Windows, se puede usar para obtener el hash.

``` syntax
certmgr.exe –v <path to the signed file>
```

Por ejemplo:

![hash de certificado de servicio protegido contra malware (certhash)](images/cert-hash-example.png)

### <a name="algorithm"></a>Algoritmo

El valor del algoritmo representa el algoritmo del certificado. Se admiten estos valores de algoritmo:

<dl> 0x8004: SHA1  
0x800c: SHA256  
0X800d: SHA384  
0x800e– SHA512  
</dl>

Recuerde incluir el valor del algoritmo (como se muestra anteriormente) y no el nombre real del algoritmo. Por ejemplo, si el certificado se basa en el algoritmo SHA256, incluya 0x800c en la sección de recursos.

### <a name="eku"></a>EKU

El objeto EKU representa una única propiedad de uso de clave extendida (EKU) de un certificado. Esto es opcional y se debe especificar \\ "0" si no hay EKUs asociadas al certificado. En un caso en el que hay varios productos y servicios de un único proveedor antimalware que se ejecutan en el mismo sistema, el proveedor antimalware puede usar la propiedad EKU del certificado de entidad de certificación privada para diferenciar un servicio de otro. Por ejemplo, si hay dos servicios que se ejecutan en el sistema desde el mismo proveedor antimalware y están firmados por la misma CA, el servicio que debe iniciarse como protegido se puede firmar con un certificado emitido por la CA que contenga un EKU especial. Este EKU debe agregarse a la sección de recursos. A continuación, el sistema registra el EKU y se empareja con el hash del certificado para validar e iniciar el servicio como protegido.

Tenga en cuenta que la cadena de certificados debe incluir el EKU de firma de código (1.3.6.1.5.5.7.3.3), pero este EKU no debe incluirse en la sección de recursos del controlador ELAM.

> [!Note]  
> Si la información de EKU se incluye en la información del certificado para el controlador ELAM, se debe usar el mismo EKU al firmar los archivos binarios.

 

### <a name="count"></a>Count

Si el archivo binario del servicio antimalware está firmado con el certificado Authenticode, así como con el certificado de entidad de certificación privada, solo se debe agregar la información del certificado de entidad de certificación privada en la sección de recursos.

## <a name="launching-anti-malware-services-as-protected"></a>Inicio de servicios antimalware como protegidos

### <a name="registering-the-service"></a>Registrar el servicio

El servicio antimalware debe registrarse en el sistema para poder iniciarse como protegido. Durante la instalación del software antimalware, el instalador puede instalar el controlador ELAM y reiniciar el sistema para registrar automáticamente el servicio. El sistema registrará el servicio en tiempo de arranque extrayendo la información del certificado del archivo de recursos mencionado anteriormente que está vinculado al controlador ELAM.

Durante la fase de instalación, se recomienda encarecidamente reiniciar el sistema para que el controlador ELAM se cargue y valide el estado del sistema. Sin embargo, en los casos en los que se debe evitar un reinicio, Windows también expone un mecanismo para que el instalador antimalware registre el servicio como protegido mediante una API.

### <a name="registering-the-service-without-rebooting-the-system"></a>Registro del servicio sin reiniciar el sistema

Durante la instalación, un instalador de software antimalware puede llamar a la API [**InstallELAMCertificateInfo**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-installelamcertificateinfo) y proporcionar un identificador al archivo de controlador DE ELAM. El sistema abre el controlador ELAM, llama a rutinas internas para asegurarse de que el controlador DE ELAM está firmado correctamente y extrae la información del certificado de la sección de recursos asociada al controlador DE ELAM. Para obtener la sintaxis de [**función, vea InstallELAMCertificateInfo**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-installelamcertificateinfo).

Ejemplo de código:


```C++
HANDLE FileHandle = NULL;

FileHandle = CreateFile(<Insert Elam driver file name>,
                        FILE_READ_DATA,
                        FILE_SHARE_READ,
                        NULL,
                        OPEN_EXISTING,
                        FILE_ATTRIBUTE_NORMAL,
                        NULL
                        );

if (InstallElamCertificateInfo(FileHandle) == FALSE)
{
    Result = GetLastError();
    goto exitFunc;
}
```



### <a name="starting-the-service-as-protected"></a>Inicio del servicio como protegido

El instalador puede seguir estos pasos para crear, configurar e iniciar el servicio como protegido:

1.  Llame a la API [**CreateService**](/windows/desktop/api/Winsvc/nf-winsvc-createservicea) para crear un objeto de servicio y agregarlo a la base de datos del Administrador de control de servicios (SCM).
2.  Llame a [**setServiceObjectSecurity**](/windows/desktop/api/winsvc/nf-winsvc-setserviceobjectsecurity) API para establecer el descriptor de seguridad del objeto de servicio creado en el paso 1.
3.  Llame a la API [**ChangeServiceConfig2**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a) para marcar el servicio como protegido y especifique el nuevo valor de enumeración **SERVICE CONFIG LAUNCH \_ \_ \_ PROTECTED,** que se ha agregado en Winsvc.h (a partir de Windows 8.1).

    Ejemplo de código:

    ```C++
    SERVICE_LAUNCH_PROTECTED_INFO Info;
    SC_HANDLE hService;

    Info.dwLaunchProtected = SERVICE_LAUNCH_PROTECTED_ANTIMALWARE_LIGHT;

    hService = CreateService (/* ... */);

    if (ChangeServiceConfig2(hService,
                             SERVICE_CONFIG_LAUNCH_PROTECTED,
                             &Info) == FALSE)
    {
        Result = GetLastError();
    }
    ```

    

4.  Llame a la API [**StartService**](/windows/desktop/api/Winsvc/nf-winsvc-startservicea) para iniciar el servicio. Al iniciar el servicio como protegido, SCM comprueba con el subsistema de integridad de código (CI) para validar la información del certificado. Una vez que ci valida la información del certificado, SCM inicia el servicio como protegido.
    1.  Tenga en cuenta que se produce un error en este paso si no ha registrado el servicio mediante una llamada a la API [**InstallELAMCertificateInfo.**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-installelamcertificateinfo)
    2.  Si el servicio se ha configurado para iniciarse automáticamente durante la fase de inicio del sistema, puede evitar este paso y simplemente reiniciar el sistema. Durante un reinicio, el sistema registra automáticamente el servicio (si el controlador DE ELAM se inicia correctamente) e inicia el servicio en modo protegido.

### <a name="launching-a-child-process-as-protected"></a>Inicio de un proceso secundario como protegido

El nuevo modelo de seguridad también permite que los servicios protegidos contra malware inicien procesos secundarios como protegidos. Estos procesos secundarios se ejecutarán en el mismo nivel de protección que el servicio primario y sus archivos binarios deben estar firmados con el mismo certificado que se ha registrado a través de la sección de recursos de ELAM.

Para permitir que el servicio protegido contra malware inicie el proceso secundario como protegido, se ha expuesto una nueva clave de atributo extendida, **PROC THREAD ATTRIBUTE PROTECTION \_ \_ \_ \_ LEVEL**, que se debe usar con la API [**UpdateProcThreadAttribute.**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-updateprocthreadattribute) Se debe pasar un puntero al valor de atributo **de PROTECTION \_ LEVEL \_ SAME** a la API **UpdateProcThreadAttribute.**

Notas:

-   Para usar este nuevo atributo, el servicio también debe especificar CREATE PROTECTED PROCESS en el parámetro **process \_ creation \_ flags** de la [**llamada CreateProcess.**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa)
-   Debe tener los archivos binarios de servicio firmados mediante el modificador /ac para incluir el certificado cruzado para encadenarlo a una entidad de certificación conocida. El certificado autofirmado sin el encadenamiento adecuado a una ca raíz conocida no funcionará.

Ejemplo de código:


```C++
DWORD ProtectionLevel = PROTECTION_LEVEL_SAME;
SIZE_T AttributeListSize;

STARTUPINFOEXW StartupInfoEx = { 0 };

StartupInfoEx.StartupInfo.cb = sizeof(StartupInfoEx);

if (InitializeProcThreadAttributeList(NULL,
                                      1,
                                      0,
                                      &AttributeListSize) == FALSE)
{
    Result = GetLastError();
    goto exitFunc;
}

StartupInfoEx.lpAttributeList = (LPPROC_THREAD_ATTRIBUTE_LIST) HeapAlloc(
    GetProcessHeap(),
    0,
    AttributeListSize
    );

if (InitializeProcThreadAttributeList(StartupInfoEx.lpAttributeList,
                                      1,
                                      0,
                                      &AttributeListSize) == FALSE)
{
    Result = GetLastError();
    goto exitFunc;
}

if (UpdateProcThreadAttribute(StartupInfoEx.lpAttributeList,
                              0,
                              PROC_THREAD_ATTRIBUTE_PROTECTION_LEVEL,
                              &ProtectionLevel,
                              sizeof(ProtectionLevel),
                              NULL,
                              NULL) == FALSE)
{
    Result = GetLastError();
    goto exitFunc;
}

PROCESS_INFORMATION ProcessInformation = { 0 };

if (CreateProcessW(ApplicationName,
                   CommandLine,
                   ProcessAttributes,
                   ThreadAttributes,
                   InheritHandles,
                   EXTENDED_STARTUPINFO_PRESENT | CREATE_PROTECTED_PROCESS,
                   Environment,
                   CurrentDirectory,
                   (LPSTARTUPINFOW)&StartupInfoEx,
                   &ProcessInformation) == FALSE)
{
    Result = GetLastError();
    goto exitFunc;
}
```



## <a name="updates-and-servicing"></a>Actualizaciones y mantenimiento

Una vez que el servicio antimalware se inicia como protegido, otros procesos no protegidos (e incluso administradores) no pueden detener el servicio. En el caso de las actualizaciones de los archivos binarios del servicio, el servicio antimalware debe recibir una devolución de llamada del instalador para detenerse para que se pueda atender. Una vez detenido el servicio, el instalador antimalware puede realizar actualizaciones [](https://www.bing.com/search?q=Registering+the+service) y, a [](#starting-the-service-as-protected) continuación, seguir los pasos descritos anteriormente en las secciones Registro del servicio e Iniciar el servicio como protegido para registrar el certificado e iniciar el servicio como protegido.

Tenga en cuenta que el servicio debe asegurarse de que solo los llamadores de confianza puedan detener el servicio. Permitir que los llamadores que no son de confianza lo hagan, se desaconse el propósito de proteger el servicio.

### <a name="unregistering-the-service"></a>Anulación del registro del servicio

Al desinstalar un servicio protegido, el servicio debe marcarse como desprotegido mediante una llamada a la API [**ChangeServiceConfig2.**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a) Tenga en cuenta que, dado que el sistema no permite que ningún proceso no protegido modifique la configuración de un servicio protegido, el propio servicio protegido debe realizar la llamada a [**ChangeServiceConfig2.**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a) Una vez que se ha reconfigurado el servicio para que se ejecute como desprotegido, el desinstalador puede simplemente tomar los pasos adecuados para quitar el software antimalware del sistema.

## <a name="debugging-an-anti-malware-protected-service"></a>Depuración de un servicio protegido contra malware

Como parte del modelo de seguridad de procesos protegidos, otros procesos no protegidos no pueden insertar subprocesos ni escribir en la memoria virtual del proceso protegido. Sin embargo, se permite un depurador de kernel (KD) para depurar los procesos protegidos contra malware. El KD también se puede usar para comprobar si el servicio antimalware se ejecuta como protegido o no:

``` syntax
dt –r1 nt!_EPROCESS <Process Address>
+0x67a Protection       : _PS_PROTECTION
      +0x000 Level            : 0x31 '1'
      +0x000 Type             : 0y0001
      +0x000 Signer           : 0y0011
```

Si el valor del *miembro Type* es 0y0001, el servicio se ejecuta como protegido.

Además, solo se permiten los siguientes comandos SC en el servicio protegido contra malware:

-   `sc config start=Auto`
-   `sc qc`
-   `sc start`
-   `sc interrogate`
-   `sc sdshow`

Si el depurador está asociado, use la marca siguiente en el Registro para interrumpir el depurador cuando se carguen archivos binarios sin firmar (o firmados de forma inapropiada) en el servicio protegido contra malware.

``` syntax
Key:   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\CI
Value: DebugFlags      REG_DWORD
```

Establezca el valor **en** 00000400 interrumpir en el depurador cuando se produce un error en la validación de la firma.

> [!Note]  
> Limitaciones del proceso protegido:
>
> 1.  Los procesos que tienen interfaz de usuario o una GUI no se pueden proteger debido a la manera en que el kernel bloquea un proceso en memoria y no permite escrituras en él.
> 2.  Antes de Windows 10, versión 1703 (la actualización creators), los procesos protegidos no pueden usar los protocolos de comunicación TLS o SSL debido a las limitaciones de uso compartido de certificados entre la autoridad de seguridad local (LSA) y un proceso protegido.

 

## <a name="resources"></a>Recursos

Para obtener más información, consulta:

-   [Antimalware de inicio temprano](/windows/desktop/w8cookbook/secured-boot)
-   [Procesos protegidos en Windows Vista](/previous-versions/windows/hardware/download/dn550976(v=vs.85))
-   [Configuración de una entidad de certificación](/previous-versions/windows/desktop/ms755466(v=vs.85))
-   [Instalar la entidad de certificación](/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/jj125375(v=ws.11))
-   [Recurso definido por el usuario](/windows/desktop/menurc/user-defined-resource)

En este artículo Windows se hace referencia a estas funciones de API:

-   [**ChangeServiceConfig2**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a)
-   [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa)
-   [**CreateService**](/windows/desktop/api/Winsvc/nf-winsvc-createservicea)
-   [**InitializeProcThreadAttributeList**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-initializeprocthreadattributelist)
-   [**InstallELAMCertificateInfo**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-installelamcertificateinfo)
-   [**SetServiceObjectSecurity**](/windows/desktop/api/winsvc/nf-winsvc-setserviceobjectsecurity)
-   [**StartService**](/windows/desktop/api/Winsvc/nf-winsvc-startservicea)
-   [**UpdateProcThreadAttribute**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-updateprocthreadattribute)

 

 
