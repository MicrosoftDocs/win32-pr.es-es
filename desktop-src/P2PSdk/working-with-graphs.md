---
description: Al trabajar con gráficos del mismo nivel, se debe llamar a las funciones en un orden concreto. El flujo de llamadas depende de si se crea o se abre un grafo del mismo nivel. En este tema se identifica el flujo de llamadas a funciones en una aplicación sencilla de gráficos del mismo nivel.
ms.assetid: cb4f48d0-d1e2-4a4b-bd5a-6e8f66d03806
title: Trabajar con gráficos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b4328b7a0109139421cf03c72a7228a3dc17e375
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "105667358"
---
# <a name="working-with-graphs"></a><span data-ttu-id="8b38a-105">Trabajar con gráficos</span><span class="sxs-lookup"><span data-stu-id="8b38a-105">Working with Graphs</span></span>

<span data-ttu-id="8b38a-106">Al trabajar con gráficos del mismo nivel, se debe llamar a las funciones en un orden concreto.</span><span class="sxs-lookup"><span data-stu-id="8b38a-106">When working with peer graphs, functions must be called in a specific order.</span></span> <span data-ttu-id="8b38a-107">El flujo de llamadas depende de si se crea o se abre un grafo del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="8b38a-107">The flow of calls depends on whether you are creating or opening a peer graph.</span></span> <span data-ttu-id="8b38a-108">En este tema se identifica el flujo de llamadas a funciones en una aplicación sencilla de gráficos del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="8b38a-108">This topic identifies the flow of function calls in a simple peer graph application.</span></span>

## <a name="starting-up-a-graph"></a><span data-ttu-id="8b38a-109">Inicio de un grafo</span><span class="sxs-lookup"><span data-stu-id="8b38a-109">Starting Up a Graph</span></span>

<span data-ttu-id="8b38a-110">Antes de que una aplicación llame a una función de la API de gráficos del mismo nivel, se debe llamar a [**PeerGraphStartup**](/windows/desktop/api/P2P/nf-p2p-peergraphstartup) para inicializar la API de gráficos del mismo nivel para una aplicación y, a continuación, establecer la versión compatible.</span><span class="sxs-lookup"><span data-stu-id="8b38a-110">Before an application calls a function in the Peer Graphing API, [**PeerGraphStartup**](/windows/desktop/api/P2P/nf-p2p-peergraphstartup) must be called to initialize the Peer Graphing API for an application, and then set the supported version.</span></span>

## <a name="creating-a-peer-graph"></a><span data-ttu-id="8b38a-111">Crear un grafo del mismo nivel</span><span class="sxs-lookup"><span data-stu-id="8b38a-111">Creating a Peer Graph</span></span>

<span data-ttu-id="8b38a-112">El procedimiento siguiente identifica el flujo de llamadas para crear un grafo del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="8b38a-112">The following procedure identifies the flow of calls for creating a peer graph.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8b38a-113">Solo un elemento del mismo nivel debe llamar a [**PeerGraphCreate**](/windows/desktop/api/P2P/nf-p2p-peergraphcreate).</span><span class="sxs-lookup"><span data-stu-id="8b38a-113">Only one peer should call [**PeerGraphCreate**](/windows/desktop/api/P2P/nf-p2p-peergraphcreate).</span></span> <span data-ttu-id="8b38a-114">Todos los demás elementos del mismo nivel deben llamar a [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen).</span><span class="sxs-lookup"><span data-stu-id="8b38a-114">All other peers should call [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen).</span></span> <span data-ttu-id="8b38a-115">Varias llamadas a **PeerGraphCreate** invalidan un grafo.</span><span class="sxs-lookup"><span data-stu-id="8b38a-115">Multiple calls to **PeerGraphCreate** invalidate a graph.</span></span>

 

-   <span data-ttu-id="8b38a-116">Cree un grafo del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="8b38a-116">Create a peer graph.</span></span> <span data-ttu-id="8b38a-117">Llame a [**PeerGraphCreate**](/windows/desktop/api/P2P/nf-p2p-peergraphcreate).</span><span class="sxs-lookup"><span data-stu-id="8b38a-117">Call [**PeerGraphCreate**](/windows/desktop/api/P2P/nf-p2p-peergraphcreate).</span></span>
-   <span data-ttu-id="8b38a-118">Registrar para eventos del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="8b38a-118">Register for peer events.</span></span> <span data-ttu-id="8b38a-119">Llame a [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent).</span><span class="sxs-lookup"><span data-stu-id="8b38a-119">Call [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent).</span></span>
    > [!Note]  
    > <span data-ttu-id="8b38a-120">Para obtener más información sobre el registro de eventos del mismo nivel, vea [infraestructura de eventos](peer-events-infrastructure.md).</span><span class="sxs-lookup"><span data-stu-id="8b38a-120">For more information about registering for peer events, see [Events Infrastructure](peer-events-infrastructure.md).</span></span>

     

-   <span data-ttu-id="8b38a-121">Escucha las conexiones a un grafo del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="8b38a-121">Listen for connections to a peer graph.</span></span> <span data-ttu-id="8b38a-122">Llame a [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten).</span><span class="sxs-lookup"><span data-stu-id="8b38a-122">Call [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten).</span></span>
-   <span data-ttu-id="8b38a-123">Realizar funciones dependientes de la aplicación para el resto del tiempo de ejecución, por ejemplo, procesar eventos del mismo nivel y trabajar con conexiones.</span><span class="sxs-lookup"><span data-stu-id="8b38a-123">Perform application-dependent functions for the remainder of the running time, for example, process peer events and work with connections.</span></span>
-   <span data-ttu-id="8b38a-124">Cierre la conexión a un grafo del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="8b38a-124">Close the connection to a peer graph.</span></span> <span data-ttu-id="8b38a-125">Llame a [**PeerGraphClose**](/windows/desktop/api/P2P/nf-p2p-peergraphclose).</span><span class="sxs-lookup"><span data-stu-id="8b38a-125">Call [**PeerGraphClose**](/windows/desktop/api/P2P/nf-p2p-peergraphclose).</span></span>

## <a name="opening-a-peer-graph"></a><span data-ttu-id="8b38a-126">Abrir un grafo del mismo nivel</span><span class="sxs-lookup"><span data-stu-id="8b38a-126">Opening a Peer Graph</span></span>

<span data-ttu-id="8b38a-127">El flujo de llamadas de función para abrir un grafo del mismo nivel depende del valor devuelto de la llamada a [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen).</span><span class="sxs-lookup"><span data-stu-id="8b38a-127">The flow of function calls to open a peer graph depends on the return value of the call to [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen).</span></span> <span data-ttu-id="8b38a-128">Los valores más importantes son **s \_ OK** y **datos del mismo nivel \_ \_ \_ creados**, que se explican en las siguientes secciones de este tema.</span><span class="sxs-lookup"><span data-stu-id="8b38a-128">The most important values are **S\_OK** and **PEER\_S\_DATA\_CREATED**, which are explained in the following sections of this topic.</span></span>

> [!Note]  
> <span data-ttu-id="8b38a-129">Si una llamada a [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen) no devuelve los **datos \_ correctos** o **del mismo nivel que se \_ \_ \_ han creado**, controle el error.</span><span class="sxs-lookup"><span data-stu-id="8b38a-129">If a call to [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen) does not return **S\_OK** or **PEER\_S\_DATA\_CREATED**, handle the error.</span></span>

 

## <a name="when-peergraphopen-returns-s_ok"></a><span data-ttu-id="8b38a-130">Cuando PeerGraphOpen devuelve S \_ OK</span><span class="sxs-lookup"><span data-stu-id="8b38a-130">When PeerGraphOpen Returns S\_OK</span></span>

<span data-ttu-id="8b38a-131">Cuando una llamada a [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen) devuelve **S \_ correcto**, se han abierto un grafo del mismo nivel y una base de datos existente.</span><span class="sxs-lookup"><span data-stu-id="8b38a-131">When a call to [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen) returns **S\_OK**, a peer graph and an existing database have been opened.</span></span> <span data-ttu-id="8b38a-132">El siguiente procedimiento identifica lo que puede hacer para abrir un grafo del mismo nivel cuando una llamada a **PeerGraphOpen** devuelve **S \_ correctos** .</span><span class="sxs-lookup"><span data-stu-id="8b38a-132">The following procedure identifies what you can do to open a peer graph when a call to **PeerGraphOpen** returns **S\_OK**</span></span>

-   <span data-ttu-id="8b38a-133">Registrar para eventos del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="8b38a-133">Register for peer events.</span></span> <span data-ttu-id="8b38a-134">Llame a [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent).</span><span class="sxs-lookup"><span data-stu-id="8b38a-134">Call [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent).</span></span>
    > [!Note]  
    > <span data-ttu-id="8b38a-135">Para obtener más información sobre el registro de eventos, vea [infraestructura de eventos](peer-events-infrastructure.md).</span><span class="sxs-lookup"><span data-stu-id="8b38a-135">For more information about registering for events, see [Events Infrastructure](peer-events-infrastructure.md).</span></span>

     

-   <span data-ttu-id="8b38a-136">Busque un nodo.</span><span class="sxs-lookup"><span data-stu-id="8b38a-136">Locate a node.</span></span> <span data-ttu-id="8b38a-137">Se trata de un proceso realizado fuera de la infraestructura de gráficos del mismo nivel, mediante el uso de un método o una aplicación que se identifican.</span><span class="sxs-lookup"><span data-stu-id="8b38a-137">This is a process performed outside of the Peer Graphing Infrastructure, by using a method or application that you identify.</span></span> <span data-ttu-id="8b38a-138">La API de gráficos del mismo nivel no proporciona un mecanismo específico para encontrar un nodo de gráfico inicial al que conectarse.</span><span class="sxs-lookup"><span data-stu-id="8b38a-138">The Peer Graphing API does not provide a specific mechanism to find an initial graph node to connect to.</span></span> <span data-ttu-id="8b38a-139">Una aplicación debe usar otro mecanismo, como la API del [Protocolo de resolución de nombres de mismo nivel (PNRP)](pnrp-namespace-provider-api.md) , para buscar el nodo inicial.</span><span class="sxs-lookup"><span data-stu-id="8b38a-139">An application must use another mechanism, such as the [Peer Name Resolution Protocol (PNRP)](pnrp-namespace-provider-api.md) API, to locate the initial node.</span></span>
-   <span data-ttu-id="8b38a-140">Si se encuentra un nodo, conéctese a él.</span><span class="sxs-lookup"><span data-stu-id="8b38a-140">If a node is found, connect to it.</span></span> <span data-ttu-id="8b38a-141">Llame a [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect)y, a continuación, llame a [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten) para escuchar las conexiones al grafo del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="8b38a-141">Call [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect), then call [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten) to listen for connections to the peer graph.</span></span>
    > [!Note]  
    > <span data-ttu-id="8b38a-142">Si no se encuentra un nodo, no llame a [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect) y [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten).</span><span class="sxs-lookup"><span data-stu-id="8b38a-142">If a node is not found, do not call [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect) and [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten).</span></span>

     

-   <span data-ttu-id="8b38a-143">Realizar funciones dependientes de la aplicación durante el resto del tiempo de ejecución, por ejemplo, procesar eventos del mismo nivel y trabajar con conexiones, dependiendo de si el nodo está conectado al grafo del mismo nivel o no.</span><span class="sxs-lookup"><span data-stu-id="8b38a-143">Perform application-dependent functions for the remainder of the running time, for example, process peer events and work with connections, depending on whether the node is connected to the peer graph or not.</span></span> <span data-ttu-id="8b38a-144">Por ejemplo, la aplicación puede elegir el tiempo de espera o realizar la detección periódicamente para un nodo activo en el gráfico.</span><span class="sxs-lookup"><span data-stu-id="8b38a-144">For example, the application can choose to timeout or periodically perform discovery for an active node in the graph.</span></span>
-   <span data-ttu-id="8b38a-145">Cierre la conexión al grafo del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="8b38a-145">Close the connection to the peer graph.</span></span> <span data-ttu-id="8b38a-146">Llame a [**PeerGraphClose**](/windows/desktop/api/P2P/nf-p2p-peergraphclose).</span><span class="sxs-lookup"><span data-stu-id="8b38a-146">Call [**PeerGraphClose**](/windows/desktop/api/P2P/nf-p2p-peergraphclose).</span></span>

## <a name="when-peergraphopen-returns-peer_s_data_created"></a><span data-ttu-id="8b38a-147">Cuando PeerGraphOpen devuelve datos del mismo nivel \_ \_ \_ creados</span><span class="sxs-lookup"><span data-stu-id="8b38a-147">When PeerGraphOpen Returns PEER\_S\_DATA\_CREATED</span></span>

<span data-ttu-id="8b38a-148">Cuando [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen) devuelve **datos del mismo nivel \_ \_ \_ creados**, significa que no se encuentra una base de datos existente para un grafo del mismo nivel, se crea una nueva base de datos y es la primera vez que se abre.</span><span class="sxs-lookup"><span data-stu-id="8b38a-148">When [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen) returns **PEER\_S\_DATA\_CREATED**, it means that an existing database for a peer graph is not found, a new database is created, and this is the first time it is opened.</span></span> <span data-ttu-id="8b38a-149">Para usar o escuchar en un grafo del mismo nivel, un elemento del mismo nivel debe estar conectado y sincronizado con un grafo del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="8b38a-149">To use or listen on a peer graph, a peer must be connected to and synchronized with a peer graph.</span></span>

<span data-ttu-id="8b38a-150">El siguiente procedimiento identifica lo que puede hacer para abrir un grafo del mismo nivel cuando una llamada a [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen) devuelve los **datos del mismo nivel \_ \_ \_ creados**.</span><span class="sxs-lookup"><span data-stu-id="8b38a-150">The following procedure identifies what you can do to open a peer graph when a call to [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen) returns **PEER\_S\_DATA\_CREATED**.</span></span>

-   <span data-ttu-id="8b38a-151">Abra un grafo del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="8b38a-151">Open a peer graph.</span></span> <span data-ttu-id="8b38a-152">Llame a [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen).</span><span class="sxs-lookup"><span data-stu-id="8b38a-152">Call [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen).</span></span>
-   <span data-ttu-id="8b38a-153">Registrar para eventos del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="8b38a-153">Register for peer events.</span></span> <span data-ttu-id="8b38a-154">Llame a [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent).</span><span class="sxs-lookup"><span data-stu-id="8b38a-154">Call [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent).</span></span>
    > [!Note]  
    > <span data-ttu-id="8b38a-155">Para obtener más información sobre el registro de eventos del mismo nivel, vea [infraestructura de eventos](peer-events-infrastructure.md).</span><span class="sxs-lookup"><span data-stu-id="8b38a-155">For more information about registering for peer events, see [Events Infrastructure](peer-events-infrastructure.md).</span></span>

     

-   <span data-ttu-id="8b38a-156">Busque un nodo.</span><span class="sxs-lookup"><span data-stu-id="8b38a-156">Locate a node.</span></span> <span data-ttu-id="8b38a-157">Se trata de un proceso realizado fuera de la infraestructura de gráficos del mismo nivel, mediante el uso de un método o una aplicación que se identifican.</span><span class="sxs-lookup"><span data-stu-id="8b38a-157">This is a process performed outside of the Peer Graphing Infrastructure, by using a method or application that you identify.</span></span> <span data-ttu-id="8b38a-158">La API de gráficos del mismo nivel no proporciona un mecanismo específico para encontrar un nodo de gráfico inicial al que conectarse.</span><span class="sxs-lookup"><span data-stu-id="8b38a-158">The Peer Graphing API does not provide a specific mechanism to find an initial graph node to connect to.</span></span> <span data-ttu-id="8b38a-159">Una aplicación debe usar otro mecanismo, como la API del [Protocolo de resolución de nombres de mismo nivel (PNRP)](pnrp-namespace-provider-api.md) , para buscar el nodo inicial.</span><span class="sxs-lookup"><span data-stu-id="8b38a-159">An application must use another mechanism, such as the [Peer Name Resolution Protocol (PNRP)](pnrp-namespace-provider-api.md) API, to locate the initial node.</span></span>
-   <span data-ttu-id="8b38a-160">Si se encuentra un nodo, conéctese a él.</span><span class="sxs-lookup"><span data-stu-id="8b38a-160">If a node is found, connect to it.</span></span> <span data-ttu-id="8b38a-161">Llame a [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect)y, a continuación, llame a [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten) para escuchar las conexiones al grafo del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="8b38a-161">Call [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect), then call [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten) to listen for connections to the peer graph.</span></span>
    > [!Note]  
    > <span data-ttu-id="8b38a-162">Si no se encuentra un nodo, no llame a [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect) y [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten).</span><span class="sxs-lookup"><span data-stu-id="8b38a-162">If a node is not found, do not call [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect) and [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten).</span></span>

     

-   <span data-ttu-id="8b38a-163">Realizar funciones dependientes de la aplicación durante el resto del tiempo de ejecución, por ejemplo, procesar eventos del mismo nivel y trabajar con conexiones, dependiendo de si el nodo está conectado al grafo del mismo nivel o no.</span><span class="sxs-lookup"><span data-stu-id="8b38a-163">Perform application-dependent functions for the remainder of the running time, for example, process peer events and work with connections, depending on whether the node is connected to the peer graph or not.</span></span> <span data-ttu-id="8b38a-164">Por ejemplo, la aplicación puede elegir el tiempo de espera o realizar la detección periódicamente para un nodo activo en el gráfico.</span><span class="sxs-lookup"><span data-stu-id="8b38a-164">For example, the application can choose to timeout or periodically perform discovery for an active node in the graph.</span></span>
-   <span data-ttu-id="8b38a-165">Cierre la conexión al grafo del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="8b38a-165">Close the connection to the peer graph.</span></span> <span data-ttu-id="8b38a-166">Llame a [**PeerGraphClose**](/windows/desktop/api/P2P/nf-p2p-peergraphclose).</span><span class="sxs-lookup"><span data-stu-id="8b38a-166">Call [**PeerGraphClose**](/windows/desktop/api/P2P/nf-p2p-peergraphclose).</span></span>

 

 



