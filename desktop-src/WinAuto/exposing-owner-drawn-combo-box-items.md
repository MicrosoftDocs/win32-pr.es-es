---
title: Exponer Owner-Drawn elementos del cuadro combinado
description: Los desarrolladores de aplicaciones no necesitan implementar IAccessible para exponer los elementos de un cuadro combinado dibujado por el propietario que tenga el estilo CBS \_ HASSTRINGS porque Microsoft Active Accessibility expone los elementos de los cuadros combinados con este estilo.
ms.assetid: 9ff14b2f-ae09-4839-b281-fba46addaf5f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 364dccaf21927e2d0092fc744d501f47830c6eeb
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "105676455"
---
# <a name="exposing-owner-drawn-combo-box-items"></a><span data-ttu-id="56664-103">Exponer Owner-Drawn elementos del cuadro combinado</span><span class="sxs-lookup"><span data-stu-id="56664-103">Exposing Owner-Drawn Combo Box Items</span></span>

<span data-ttu-id="56664-104">Los desarrolladores de aplicaciones no necesitan implementar [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) para exponer los elementos de un cuadro combinado dibujado por el propietario que tenga el estilo **CBS \_ HASSTRINGS** porque Microsoft Active Accessibility expone los elementos de los cuadros combinados con este estilo.</span><span class="sxs-lookup"><span data-stu-id="56664-104">Application developers do not need to implement [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) to expose the items in an owner-drawn combo box that has the style **CBS\_HASSTRINGS** because Microsoft Active Accessibility exposes the items in combo boxes with this style.</span></span> <span data-ttu-id="56664-105">Los elementos de un cuadro combinado dibujado por el propietario con el estilo **CBS \_ HASSTRINGS** se muestran como texto.</span><span class="sxs-lookup"><span data-stu-id="56664-105">The items in an owner-drawn combo box with the **CBS\_HASSTRINGS** style are displayed as text.</span></span> <span data-ttu-id="56664-106">Sin embargo, este estilo también se utiliza con cuadros combinados dibujados por el propietario que no muestran texto para que Microsoft Active Accessibility exponga los elementos del cuadro combinado.</span><span class="sxs-lookup"><span data-stu-id="56664-106">However, this style is also used with owner-drawn combo boxes that do not display text so that the combo box items are exposed by Microsoft Active Accessibility.</span></span>

<span data-ttu-id="56664-107">Para permitir que Microsoft Active Accessibility exponga los elementos de un cuadro combinado dibujado por el propietario que no muestre texto:</span><span class="sxs-lookup"><span data-stu-id="56664-107">To allow Microsoft Active Accessibility to expose the items in an owner-drawn combo box that does not display text:</span></span>

-   <span data-ttu-id="56664-108">Use el **estilo \_ HASSTRINGS de CBS** al crear el cuadro combinado.</span><span class="sxs-lookup"><span data-stu-id="56664-108">Use the **CBS\_HASSTRINGS** style when creating the combo box.</span></span>
-   <span data-ttu-id="56664-109">Cree un homólogo textual que nombra o describe cada elemento del cuadro combinado.</span><span class="sxs-lookup"><span data-stu-id="56664-109">Create a textual counterpart that names or describes each item in the combo box.</span></span>
-   <span data-ttu-id="56664-110">Al agregar elementos al cuadro combinado dibujado por el propietario, use el \_ mensaje CB ADDSTRING para agregar el texto que desea que Microsoft Active Accessibility exponga.</span><span class="sxs-lookup"><span data-stu-id="56664-110">When adding items to the owner-drawn combo box, use the CB\_ADDSTRING message to add the text that you want Microsoft Active Accessibility to expose.</span></span> <span data-ttu-id="56664-111">Este texto no se muestra, por lo que no debe formar parte de los datos dibujados por el propietario.</span><span class="sxs-lookup"><span data-stu-id="56664-111">This text is not displayed, so it must not be part of the owner-drawn data.</span></span> <span data-ttu-id="56664-112">Agregue los datos del elemento dibujado por el propietario mediante el \_ mensaje CB SETITEMDATA.</span><span class="sxs-lookup"><span data-stu-id="56664-112">Add the owner-drawn item data using the CB\_SETITEMDATA message.</span></span>

<span data-ttu-id="56664-113">Al usar el método anterior, tenga en cuenta lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="56664-113">When using the above method, note the following:</span></span>

-   <span data-ttu-id="56664-114">Si usa el estilo **de \_ ordenación CBS** , el cuadro combinado se ordena con las cadenas proporcionadas y no con el procedimiento de devolución de llamada [ \_ COMPAREITEM de WM](../controls/wm-compareitem.md) .</span><span class="sxs-lookup"><span data-stu-id="56664-114">If you use the **CBS\_SORT** style, the combo box is sorted using the supplied strings and not the [WM\_COMPAREITEM](../controls/wm-compareitem.md) callback procedure.</span></span>
-   <span data-ttu-id="56664-115">Con los cuadros combinados de variables dibujadas por el propietario creados con el estilo **CBS \_ OWNERDRAWVARIABLE**, use una variable global o algún otro mecanismo para realizar un seguimiento de Cuándo es válido el miembro de **itemData** de [measureitemstruct (](/windows/win32/api/winuser/ns-winuser-measureitemstruct) .</span><span class="sxs-lookup"><span data-stu-id="56664-115">With owner-drawn variable combo boxes created with the style **CBS\_OWNERDRAWVARIABLE**, use a global variable or some other mechanism to keep track of when the **itemData** member of the [MEASUREITEMSTRUCT](/windows/win32/api/winuser/ns-winuser-measureitemstruct) is valid.</span></span> <span data-ttu-id="56664-116">La variable global es necesaria porque el sistema envía el mensaje de [WM \_ MEASUREITEM](../controls/wm-measureitem.md) en cuanto se agrega la cadena, pero antes de que se adjunten los datos del elemento, y en este momento el miembro de **itemData** no es válido.</span><span class="sxs-lookup"><span data-stu-id="56664-116">The global variable is required because the system sends the [WM\_MEASUREITEM](../controls/wm-measureitem.md) message as soon as the string is added but before the item data is attached, and at this point the **itemData** member is not valid.</span></span>
-   <span data-ttu-id="56664-117">Para cambiar la cadena de un elemento en un cuadro combinado con el estilo **CBS \_ HASSTRINGS** , elimine el elemento con el mensaje [CB \_ DELETESTRING](../controls/cb-deletestring.md) y agregue la nueva cadena con el mensaje [CB \_ ADDSTRING](../controls/cb-addstring.md) .</span><span class="sxs-lookup"><span data-stu-id="56664-117">To change the string for an item in a combo box with the **CBS\_HASSTRINGS** style, delete the item with the [CB\_DELETESTRING](../controls/cb-deletestring.md) message and add the new string with the [CB\_ADDSTRING](../controls/cb-addstring.md) message.</span></span>

 

 