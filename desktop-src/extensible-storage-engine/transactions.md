---
description: 'Más información acerca de: transacciones (eventos de Windows)'
title: Transacciones (eventos de Windows)
TOCTitle: Transactions
ms:assetid: 1ceb362c-1efe-439b-b10a-016c8a54f27b
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269197(v=EXCHG.10)
ms:contentKeyID: 32765500
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: 90b5b566f5ff961ce7b0ae3725f580e1f39c041d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "104360990"
---
# <a name="transactions-windows-events"></a><span data-ttu-id="272a1-103">Transacciones (eventos de Windows)</span><span class="sxs-lookup"><span data-stu-id="272a1-103">Transactions (Windows Events)</span></span>


<span data-ttu-id="272a1-104">_**Se aplica a:** Windows | Windows Server_</span><span class="sxs-lookup"><span data-stu-id="272a1-104">_**Applies to:** Windows�| Windows Server_</span></span>

## <a name="transactions"></a><span data-ttu-id="272a1-105">Transacciones</span><span class="sxs-lookup"><span data-stu-id="272a1-105">Transactions</span></span>

<span data-ttu-id="272a1-106">Las transacciones de ESE son unidades lógicas de procesamiento que controlan el modo en que una aplicación ve y manipula filas en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="272a1-106">ESE transactions are logical units of processing that control how an application sees and manipulates rows in the database.</span></span> <span data-ttu-id="272a1-107">La aplicación puede utilizar puntos de almacenamiento de transacciones para determinar si se debe mantener o descartar un conjunto determinado de cambios en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="272a1-107">Your application can use transaction save points to determine whether to keep or discard a particular set of changes to the database.</span></span> <span data-ttu-id="272a1-108">Todas las transacciones de ESE son atómicas, coherentes, aisladas y duraderas (ACID) tal y como se describe a continuación:</span><span class="sxs-lookup"><span data-stu-id="272a1-108">All transactions in ESE are atomic, consistent, isolated, and durable (ACID) as described below:</span></span>

  - <span data-ttu-id="272a1-109">**Atómico:** Todas las actualizaciones de la transacción aparecen en la base de datos o se descartan.</span><span class="sxs-lookup"><span data-stu-id="272a1-109">**Atomic:** All the updates in the transaction either appear in the database or they are discarded.</span></span>

<!-- end list -->

  - <span data-ttu-id="272a1-110">**Coherente:** La base de datos siempre se iniciará en un estado legal y siempre finalizará en otro estado legal.</span><span class="sxs-lookup"><span data-stu-id="272a1-110">**Consistent:** The database will always start in a legal state and will always end in another legal state.</span></span> <span data-ttu-id="272a1-111">En el caso de las aplicaciones de ESE, el motor de base de datos controlará algunas restricciones simples, por ejemplo la unicidad de un índice único, pero la propia aplicación definirá casi todos los demás aspectos de lo que significa que la base de datos esté en un estado legal.</span><span class="sxs-lookup"><span data-stu-id="272a1-111">For ESE applications, the database engine will control some simple constraints, for example uniqueness of a unique index, but the application itself will define almost all other aspects of what it means for the database to be in a legal state.</span></span>

<!-- end list -->

  - <span data-ttu-id="272a1-112">**Aislamiento:** Las transacciones están aisladas de las actualizaciones realizadas por otras sesiones.</span><span class="sxs-lookup"><span data-stu-id="272a1-112">**Isolation:** Transactions are isolated from updates by other sessions.</span></span> <span data-ttu-id="272a1-113">Una transacción nunca verá un conjunto parcial de cambios realizados por otra transacción.</span><span class="sxs-lookup"><span data-stu-id="272a1-113">A transaction will never see a partial set of changes made by another transaction.</span></span>

<!-- end list -->

  - <span data-ttu-id="272a1-114">**Duradero:** Una vez que el motor de base de datos confirma que se ha confirmado una transacción, sus cambios son persistentes en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="272a1-114">**Durable:** After the database engine acknowledges that a transaction has been committed, its changes are persistent in the database.</span></span> <span data-ttu-id="272a1-115">La durabilidad de una transacción se puede eximir opcionalmente por motivos de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="272a1-115">The durability of a transaction may be optionally waived for performance reasons.</span></span>

<span data-ttu-id="272a1-116">Las transacciones se realizan dentro de los límites de las llamadas a [JetBeginTransaction](./jetbegintransaction-function.md) y [JetCommitTransaction](./jetcommittransaction-function.md) o [JetRollback](./jetrollback-function.md).</span><span class="sxs-lookup"><span data-stu-id="272a1-116">Transactions are performed within the bounds of the calls to [JetBeginTransaction](./jetbegintransaction-function.md) and [JetCommitTransaction](./jetcommittransaction-function.md) or [JetRollback](./jetrollback-function.md).</span></span> <span data-ttu-id="272a1-117">Cuando la aplicación entra en la transacción, la base de datos aparece inmovilizada en la instancia de en el momento en que comienza la transacción.</span><span class="sxs-lookup"><span data-stu-id="272a1-117">When the application enters the transaction, the database appears frozen at the instance in time that the transaction begins.</span></span> <span data-ttu-id="272a1-118">Esto se denomina aislamiento de instantánea.</span><span class="sxs-lookup"><span data-stu-id="272a1-118">This is called snapshot isolation.</span></span> <span data-ttu-id="272a1-119">Si la transacción se termina llamando a [JetRollback](./jetrollback-function.md), ninguna de las operaciones realizadas en la transacción se confirma en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="272a1-119">If the transaction is terminated by calling [JetRollback](./jetrollback-function.md), none of the operations performed in the transaction are committed to the database.</span></span> <span data-ttu-id="272a1-120">Si el proceso o el equipo se bloquea antes de que se llame a [JetCommitTransaction](./jetcommittransaction-function.md) , es lo mismo que llamar a [JetRollback](./jetrollback-function.md).</span><span class="sxs-lookup"><span data-stu-id="272a1-120">If the process or the machine crashes before [JetCommitTransaction](./jetcommittransaction-function.md) is called, it is the same as calling [JetRollback](./jetrollback-function.md).</span></span>

<span data-ttu-id="272a1-121">Este procedimiento muestra cómo iniciar y confirmar una transacción que lee y actualiza datos en una base de datos de.</span><span class="sxs-lookup"><span data-stu-id="272a1-121">This procedure shows how to start and commit a transaction that reads and updates data in a database.</span></span>

### <a name="to-start-and-commit-a-transaction"></a><span data-ttu-id="272a1-122">Para iniciar y confirmar una transacción</span><span class="sxs-lookup"><span data-stu-id="272a1-122">To start and commit a transaction</span></span>

1.  <span data-ttu-id="272a1-123">Llame a [JetBeginTransaction](./jetbegintransaction-function.md) o [JETBEGINTRANSACTION2](./jetbegintransaction2-function.md) con el identificador de sesión para iniciar la transacción.</span><span class="sxs-lookup"><span data-stu-id="272a1-123">Call [JetBeginTransaction](./jetbegintransaction-function.md) or [JetBeginTransaction2](./jetbegintransaction2-function.md) with the session ID to start the transaction.</span></span>

2.  <span data-ttu-id="272a1-124">Mueva el cursor al registro deseado llamando a [JetMove](./jetmove-function.md) con JET_MoveFirst especificado en el parámetro *cRow* .</span><span class="sxs-lookup"><span data-stu-id="272a1-124">Move the cursor to the desired record by calling [JetMove](./jetmove-function.md) with JET_MoveFirst specified in the *cRow* parameter.</span></span> <span data-ttu-id="272a1-125">Para obtener más información acerca de cómo se mueve el cursor, vea el tema [indexación en la tabla](./indexing-in-the-table.md) .</span><span class="sxs-lookup"><span data-stu-id="272a1-125">For more information on how to move the cursor, see the [Indexing in the Table](./indexing-in-the-table.md) topic.</span></span>

3.  <span data-ttu-id="272a1-126">Llame a [JetGetTableColumnInfo](./jetgettablecolumninfo-function.md) en el registro actual con JET_ColInfo especificado en el parámetro *InfoLevel* para recuperar el ID. de columna de la columna.</span><span class="sxs-lookup"><span data-stu-id="272a1-126">Call [JetGetTableColumnInfo](./jetgettablecolumninfo-function.md) on the current record with JET_ColInfo specified in the *InfoLevel* parameter to retrieve the column ID for the column.</span></span> <span data-ttu-id="272a1-127">El ID. de columna se devuelve en la estructura [JET_COLUMNDEF](./jet-columndef-structure.md) .</span><span class="sxs-lookup"><span data-stu-id="272a1-127">The column ID is returned in the [JET_COLUMNDEF](./jet-columndef-structure.md) structure.</span></span>

4.  <span data-ttu-id="272a1-128">Llame a [JetSetColumn](./jetsetcolumn-function.md) con el identificador de sesión, el identificador de tabla y el identificador de columna de la columna que se actualiza.</span><span class="sxs-lookup"><span data-stu-id="272a1-128">Call [JetSetColumn](./jetsetcolumn-function.md) with the session ID, table ID, and column ID of the column that is updated.</span></span> <span data-ttu-id="272a1-129">Los datos de columna se incluyen en el parámetro *pvData* .</span><span class="sxs-lookup"><span data-stu-id="272a1-129">The column data is contained in the *pvData* parameter.</span></span>

5.  <span data-ttu-id="272a1-130">Llame a [JetCommitTransaction](./jetcommittransaction-function.md) para confirmar la transacción en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="272a1-130">Call [JetCommitTransaction](./jetcommittransaction-function.md) to commit the transaction to the database.</span></span>

<span data-ttu-id="272a1-131">La forma en que un motor de base de datos ESE implementa el aislamiento de instantáneas tiene algunas diferencias importantes con respecto a los modelos tradicionales de aislamiento y aislamiento de bases de datos relacionales.</span><span class="sxs-lookup"><span data-stu-id="272a1-131">The way in which an ESE database engine implements snapshot isolation has some important differences from traditional relational database isolation and locking models.</span></span> <span data-ttu-id="272a1-132">Cuando una transacción Lee una fila, siempre puede tener acceso a la fila sin errores o esperando a que otras sesiones liberen un bloqueo.</span><span class="sxs-lookup"><span data-stu-id="272a1-132">When a transaction reads a row, it can always access the row without failing or waiting for other sessions to release a lock.</span></span> <span data-ttu-id="272a1-133">Cuando una transacción intenta actualizar una fila, se realizará correctamente si es la primera sesión para actualizar esa fila, es decir, el primer escritor gana.</span><span class="sxs-lookup"><span data-stu-id="272a1-133">When a transaction attempts to update a row, it will succeed if it is the first session to update that row, that is the first writer wins.</span></span> <span data-ttu-id="272a1-134">Si la sesión no es el primer escritor, se producirá un error inmediatamente con un conflicto de escritura.</span><span class="sxs-lookup"><span data-stu-id="272a1-134">If the session is not the first writer then it will immediately fail with a write conflict error.</span></span> <span data-ttu-id="272a1-135">A continuación, la sesión debe anular su transacción, esperar (normalmente a través de un retraso aleatorio) para que la otra transacción confirme sus cambios y, a continuación, vuelva a intentar la transacción.</span><span class="sxs-lookup"><span data-stu-id="272a1-135">The session must then abort its transaction, wait (usually via a random delay), for the other transaction to commit its changes, and then retry the transaction.</span></span> <span data-ttu-id="272a1-136">El motor de base de datos no hará que dicha sesión espere hasta que la otra transacción haya finalizado la actualización.</span><span class="sxs-lookup"><span data-stu-id="272a1-136">The database engine will not automatically cause that session to wait until the other transaction has finished its update.</span></span> <span data-ttu-id="272a1-137">Normalmente, una transacción probará si puede actualizar una fila dentro de la llamada a [JetUpdate](./jetupdate-function.md) .</span><span class="sxs-lookup"><span data-stu-id="272a1-137">Usually, a transaction will test if it can update a row inside of the [JetUpdate](./jetupdate-function.md) call.</span></span> <span data-ttu-id="272a1-138">Si no puede bloquear la fila para la actualización, se producirá un error en [JetUpdate](./jetupdate-function.md) con JET_errWriteConflict.</span><span class="sxs-lookup"><span data-stu-id="272a1-138">If it cannot lock the row for update then [JetUpdate](./jetupdate-function.md) will fail with JET_errWriteConflict.</span></span>

<span data-ttu-id="272a1-139">Las sesiones se limitan a un subproceso desde el momento en que la transacción comienza hasta el final de la transacción.</span><span class="sxs-lookup"><span data-stu-id="272a1-139">Sessions are limited to one thread from the time the transaction starts to the end of the transaction.</span></span> <span data-ttu-id="272a1-140">Se recomienda que todas las operaciones de actualización y recuperación se realicen en una transacción.</span><span class="sxs-lookup"><span data-stu-id="272a1-140">It is recommended that all update and retrieve operations be performed in a transaction.</span></span> <span data-ttu-id="272a1-141">ESE también admite modificaciones de esquema, como la creación de tablas y la adición de columnas dentro de la transacción.</span><span class="sxs-lookup"><span data-stu-id="272a1-141">ESE also supports schema modifications such as creating tables and adding columns inside the transaction.</span></span> <span data-ttu-id="272a1-142">Las modificaciones de la actualización y del esquema se pueden realizar en la misma transacción.</span><span class="sxs-lookup"><span data-stu-id="272a1-142">Both update and schema modifications can be performed in the same transaction.</span></span> <span data-ttu-id="272a1-143">Una vez completada la transacción con [JetCommitTransaction](./jetcommittransaction-function.md), la actualización se registra en el archivo de registro de transacciones.</span><span class="sxs-lookup"><span data-stu-id="272a1-143">After the transaction completes with [JetCommitTransaction](./jetcommittransaction-function.md), the update is logged in the transaction log file.</span></span> <span data-ttu-id="272a1-144">Estos archivos se pueden usar para mantener un estado coherente lógicamente en caso de que se produzca una terminación inesperada de un proceso o un cierre del sistema.</span><span class="sxs-lookup"><span data-stu-id="272a1-144">These files can be used to maintain a logically consistent state in the event of an unexpected process termination or system shutdown.</span></span>

<span data-ttu-id="272a1-145">Las transacciones se pueden anidar hasta 7 niveles con llamadas coincidentes a [JetBeginTransaction](./jetbegintransaction-function.md) y [JetCommitTransaction](./jetcommittransaction-function.md) o [JetRollback](./jetrollback-function.md) anidadas entre sí.</span><span class="sxs-lookup"><span data-stu-id="272a1-145">Transactions may be nested up to 7 levels with matching calls to [JetBeginTransaction](./jetbegintransaction-function.md) and [JetCommitTransaction](./jetcommittransaction-function.md) or [JetRollback](./jetrollback-function.md) nested within each other.</span></span> <span data-ttu-id="272a1-146">Esto permite que la aplicación revierta una parte de la transacción sin tener que volver a la transacción completa.</span><span class="sxs-lookup"><span data-stu-id="272a1-146">This allows the application to rollback a part of the transaction without having to back out of the entire transaction.</span></span> <span data-ttu-id="272a1-147">La llamada anidada a [JetCommitTransaction](./jetcommittransaction-function.md) significa que se ha completado este nivel de procesamiento; sin embargo, la transacción no se confirma en la base de datos hasta la llamada más externa para confirmar la transacción con [JetCommitTransaction](./jetcommittransaction-function.md).</span><span class="sxs-lookup"><span data-stu-id="272a1-147">The nested call to [JetCommitTransaction](./jetcommittransaction-function.md) signifies that this level of processing is complete; however, the transaction is not committed to the database until the outer most call to commit the transaction with [JetCommitTransaction](./jetcommittransaction-function.md).</span></span>

<span data-ttu-id="272a1-148">Las columnas de actualización de custodia se pueden actualizar simultáneamente en varias sesiones sin que se produzcan errores Jet_errWriteConflict.</span><span class="sxs-lookup"><span data-stu-id="272a1-148">Escrow update columns can be updated concurrently by multiple sessions without failing with Jet_errWriteConflict.</span></span> <span data-ttu-id="272a1-149">Solo se puede llamar a la función [JetEscrowUpdate](./jetescrowupdate-function.md) en las columnas de custodia, las columnas que se crearon con Jet_bitColumnEscrowUpdate.</span><span class="sxs-lookup"><span data-stu-id="272a1-149">The [JetEscrowUpdate](./jetescrowupdate-function.md) function may only be called on escrow columns, columns that were created with Jet_bitColumnEscrowUpdate.</span></span>
