---
title: Implementación del administrador de categorías de componentes
description: A medida que crece el número de componentes disponibles, se hace cada vez más difícil administrar estos componentes. En cuanto a las interfaces que exponen, así como las tareas que realizan, muchos componentes ofrecen una funcionalidad similar.
ms.assetid: c2c67129-bf19-465b-8354-193922aeafaa
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2414567beba159c05ea08b3561f0a97ddda1cb70
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/16/2019
ms.locfileid: "103994580"
---
# <a name="component-categories-manager-implementation"></a><span data-ttu-id="46002-104">Implementación del administrador de categorías de componentes</span><span class="sxs-lookup"><span data-stu-id="46002-104">Component Categories Manager Implementation</span></span>

<span data-ttu-id="46002-105">A medida que crece el número de componentes disponibles, se hace cada vez más difícil administrar estos componentes.</span><span class="sxs-lookup"><span data-stu-id="46002-105">As the number of available components grows, it becomes increasingly difficult to manage these components.</span></span> <span data-ttu-id="46002-106">En cuanto a las interfaces que exponen, así como las tareas que realizan, muchos componentes ofrecen una funcionalidad similar.</span><span class="sxs-lookup"><span data-stu-id="46002-106">In terms of the interfaces they expose as well as the tasks they perform, many components offer similar functionality.</span></span>

<span data-ttu-id="46002-107">A menudo es necesario enumerar los componentes que se pueden usar en un contexto determinado.</span><span class="sxs-lookup"><span data-stu-id="46002-107">It is often necessary to enumerate the components that can be used in a certain context.</span></span> <span data-ttu-id="46002-108">Ejemplos de esto son el cuadro de diálogo **Insertar objeto** que se usa en los documentos compuestos OLE y el cuadro de diálogo **Insertar control** que se usa en los controles OLE.</span><span class="sxs-lookup"><span data-stu-id="46002-108">Examples of this are the **Insert Object** dialog box used in OLE compound documents and the **Insert Control** dialog box used in OLE controls.</span></span> <span data-ttu-id="46002-109">Estos cuadros de diálogo muestran todos los componentes que cumplen (o reclaman) los contratos de interfaz para los documentos o controles compuestos.</span><span class="sxs-lookup"><span data-stu-id="46002-109">These dialog boxes list all components that fulfill (or claim to fulfill) the interface contracts for compound documents or controls.</span></span> <span data-ttu-id="46002-110">Estas categorías existentes (documento OLE, control OLE) no implican una firma exacta de la interfaz.</span><span class="sxs-lookup"><span data-stu-id="46002-110">These existing categories (OLE document, OLE control) do not imply an exact interface signature.</span></span> <span data-ttu-id="46002-111">Los documentos OLE deben exponer un conjunto determinado de interfaces principales (por ejemplo, [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) o [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage)), pero también pueden exponer interfaces adicionales como [**IOleLink**](/windows/desktop/api/OleIdl/nn-oleidl-iolelink).</span><span class="sxs-lookup"><span data-stu-id="46002-111">OLE documents have to expose a certain set of core interfaces (for example, [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) or [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage)) but can also expose additional interfaces such as [**IOleLink**](/windows/desktop/api/OleIdl/nn-oleidl-iolelink).</span></span>

<span data-ttu-id="46002-112">En el pasado, los componentes se etiquetaron agregando un nombre legible ("insertable", "control", etc.) como una subclave a las **clases HKEY \_ \_ raíz \\ CLSID \\ {...}**</span><span class="sxs-lookup"><span data-stu-id="46002-112">In the past, components have been tagged by adding a human-readable name ("Insertable", "Control", and so on) as a subkey to the **HKEY\_CLASSES\_ROOT\\CLSID\\{...}**</span></span> <span data-ttu-id="46002-113">clave del registro correspondiente al componente.</span><span class="sxs-lookup"><span data-stu-id="46002-113">registry key corresponding to the component.</span></span> <span data-ttu-id="46002-114">Esto funciona bien para una definición central de las categorías, pero arriesga los conflictos de nombres cuando muchas entidades independientes definen nuevas categorías.</span><span class="sxs-lookup"><span data-stu-id="46002-114">This works well for a central definition of categories but risks name collisions when many independent parties define new categories.</span></span> <span data-ttu-id="46002-115">Como en otras áreas de COM, la solución para proporcionar un espacio de nombres extensible se basa en el uso de identificadores únicos globales (GUID).</span><span class="sxs-lookup"><span data-stu-id="46002-115">As in other areas of COM, the solution to providing an extensible namespace lies in the use of globally unique identifiers (GUIDs).</span></span> <span data-ttu-id="46002-116">En lugar de usar un nombre legible, se asigna un número único (CATId) a cada categoría.</span><span class="sxs-lookup"><span data-stu-id="46002-116">Instead of using a human-readable name, a unique number (CATID) is assigned to each category.</span></span>

<span data-ttu-id="46002-117">Otra limitación de la categorización existente es que se limita a expresar las capacidades del propio componente.</span><span class="sxs-lookup"><span data-stu-id="46002-117">Another limitation with the existing categorization is that it is limited to expressing the capabilities of the component itself.</span></span> <span data-ttu-id="46002-118">Muchos componentes requieren ciertas funcionalidades de los contenedores.</span><span class="sxs-lookup"><span data-stu-id="46002-118">Many components require certain capabilities from the containers.</span></span> <span data-ttu-id="46002-119">Cuando se inserta este componente en un contenedor, la inserción puede producir un error o comportarse de forma inesperada, incluso aunque el componente cumpla los contratos que una de sus categorías implica.</span><span class="sxs-lookup"><span data-stu-id="46002-119">When such a component is inserted into a container, the insertion can fail or behave unexpectedly, even though the component fulfills the contracts implied by one of its categories.</span></span> <span data-ttu-id="46002-120">Para enumerar los componentes que se pueden usar correctamente en determinadas situaciones, se deben tener en cuenta las capacidades del componente y del contenedor.</span><span class="sxs-lookup"><span data-stu-id="46002-120">To enumerate the components that can be used successfully in certain situations, the capabilities of both the component and the container must be considered.</span></span>

<span data-ttu-id="46002-121">Debido a estas consideraciones, se realizaron los siguientes cambios en la categorización existente:</span><span class="sxs-lookup"><span data-stu-id="46002-121">Because of these considerations, the following changes were made to the existing categorization:</span></span>

-   <span data-ttu-id="46002-122">Las categorías se indican mediante CATID que son identificadores únicos globales.</span><span class="sxs-lookup"><span data-stu-id="46002-122">Categories are indicated by using CATIDs that are globally unique identifiers.</span></span>
-   <span data-ttu-id="46002-123">En la subclave **Components** de la clave del registro **\_ \_ \\ CLSID raíz de las clases HKEY** , se desarrollaron dos subclaves independientes, "Categories implementadas" y "Categories Required".</span><span class="sxs-lookup"><span data-stu-id="46002-123">Under the **Components** subkey of the **HKEY\_CLASSES\_ROOT\\CLSID** registry key, two separate subkeys, "Implemented Categories" and "Required Categories", were developed.</span></span> <span data-ttu-id="46002-124">Estas subclaves contienen las listas de CATID que proporciona el componente o que el contenedor del componente debe proporcionar.</span><span class="sxs-lookup"><span data-stu-id="46002-124">These subkeys contain the lists of CATIDs that are provided by the component or that the container of the component must provide.</span></span>

<span data-ttu-id="46002-125">Para facilitar la administración de las categorías de componentes, las categorías se muestran en una ubicación central en el registro: **\_ clases HKEY categorías de \_ \\ componentes raíz**.</span><span class="sxs-lookup"><span data-stu-id="46002-125">To ease managing the component categories, categories are listed in a central place in the registry: **HKEY\_CLASSES\_ROOT\\Component Categories**.</span></span> <span data-ttu-id="46002-126">Esta clave enumera las categorías instaladas con su CATId y con los nombres localizados y legibles.</span><span class="sxs-lookup"><span data-stu-id="46002-126">This key lists the installed categories both with their CATID and with localized, human-readable names.</span></span>

<span data-ttu-id="46002-127">Para obtener más información, vea los temas siguientes:</span><span class="sxs-lookup"><span data-stu-id="46002-127">For more information, see the following topics:</span></span>

-   [<span data-ttu-id="46002-128">Categorización por funcionalidad de componentes</span><span class="sxs-lookup"><span data-stu-id="46002-128">Categorizing by Component Capabilities</span></span>](categorizing-by-component-capabilities.md)
-   [<span data-ttu-id="46002-129">Clasificar por capacidades de contenedor</span><span class="sxs-lookup"><span data-stu-id="46002-129">Categorizing by Container Capabilities</span></span>](categorizing-by-container-capabilities.md)
-   [<span data-ttu-id="46002-130">Administrador de categorías de componentes</span><span class="sxs-lookup"><span data-stu-id="46002-130">The Component Categories Manager</span></span>](the-component-categories-manager.md)
-   [<span data-ttu-id="46002-131">Clases y asociaciones predeterminadas</span><span class="sxs-lookup"><span data-stu-id="46002-131">Default Classes and Associations</span></span>](default-classes-and-associations.md)
-   [<span data-ttu-id="46002-132">Definir categorías de componentes</span><span class="sxs-lookup"><span data-stu-id="46002-132">Defining Component Categories</span></span>](defining-component-categories.md)
-   [<span data-ttu-id="46002-133">Asociar iconos a una categoría</span><span class="sxs-lookup"><span data-stu-id="46002-133">Associating Icons with a Category</span></span>](associating-icons-with-a-category.md)

 

 




