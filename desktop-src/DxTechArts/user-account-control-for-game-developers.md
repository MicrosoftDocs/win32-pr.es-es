---
title: Control de cuentas de usuario para desarrolladores de juegos
description: En este artículo se describen las instrucciones y los procedimientos recomendados para que los desarrolladores de juegos puedan trabajar de forma eficaz con la característica de seguridad de control de cuentas de usuario (UAC) que se presentó en Windows Vista.
ms.assetid: dbac1c07-73dd-f2bc-3c5c-d6160368a88f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 57d5533a3fbdd349cc25dfde501a234bbd7b05b1
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104421022"
---
# <a name="user-account-control-for-game-developers"></a><span data-ttu-id="49b74-103">Control de cuentas de usuario para desarrolladores de juegos</span><span class="sxs-lookup"><span data-stu-id="49b74-103">User Account Control for Game Developers</span></span>

<span data-ttu-id="49b74-104">En este artículo se describen las instrucciones y los procedimientos recomendados para que los desarrolladores de juegos puedan trabajar de forma eficaz con la característica de seguridad de control de cuentas de usuario (UAC) que se presentó en Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="49b74-104">This article describes the guidelines and best practices for game developers to work effectively with the User Account Control (UAC) security feature introduced in Windows Vista.</span></span>

-   [<span data-ttu-id="49b74-105">Información general sobre el control de cuentas de usuario</span><span class="sxs-lookup"><span data-stu-id="49b74-105">Overview of User Account Control</span></span>](#overview-of-user-account-control)
-   [<span data-ttu-id="49b74-106">Cuentas de usuario en Windows Vista</span><span class="sxs-lookup"><span data-stu-id="49b74-106">User Accounts in Windows Vista</span></span>](#user-accounts-in-windows-vista)
-   [<span data-ttu-id="49b74-107">Acceso a archivos como usuario estándar</span><span class="sxs-lookup"><span data-stu-id="49b74-107">File Access as a Standard User</span></span>](#file-access-as-a-standard-user)
-   [<span data-ttu-id="49b74-108">Acceso al registro como usuario estándar</span><span class="sxs-lookup"><span data-stu-id="49b74-108">Registry Access as a Standard User</span></span>](#registry-access-as-a-standard-user)
-   [<span data-ttu-id="49b74-109">Elevación de privilegios</span><span class="sxs-lookup"><span data-stu-id="49b74-109">Privilege Elevation</span></span>](#privilege-elevation)
-   [<span data-ttu-id="49b74-110">Implicaciones de UAC con CreateProcess ()</span><span class="sxs-lookup"><span data-stu-id="49b74-110">UAC Implications with CreateProcess()</span></span>](#uac-implications-with-createprocess)
-   [<span data-ttu-id="49b74-111">Establecer el nivel de ejecución en el manifiesto de aplicación</span><span class="sxs-lookup"><span data-stu-id="49b74-111">Setting the Execution Level in the Application Manifest</span></span>](#setting-the-execution-level-in-the-application-manifest)
-   [<span data-ttu-id="49b74-112">Incrustar un manifiesto en Visual Studio</span><span class="sxs-lookup"><span data-stu-id="49b74-112">Embedding a Manifest in Visual Studio</span></span>](#embedding-a-manifest-in-visual-studio)
-   [<span data-ttu-id="49b74-113">Compatibilidad de UAC con juegos más antiguos</span><span class="sxs-lookup"><span data-stu-id="49b74-113">UAC Compatibility with Older Games</span></span>](#uac-compatibility-with-older-games)
-   [<span data-ttu-id="49b74-114">Escenarios y manifiestos heredados</span><span class="sxs-lookup"><span data-stu-id="49b74-114">Legacy Scenarios and Manifests</span></span>](#legacy-scenarios-and-manifests)
-   [<span data-ttu-id="49b74-115">Conclusión</span><span class="sxs-lookup"><span data-stu-id="49b74-115">Conclusion</span></span>](#conclusion)
-   [<span data-ttu-id="49b74-116">Lecturas adicionales</span><span class="sxs-lookup"><span data-stu-id="49b74-116">Further Reading</span></span>](#further-reading)

## <a name="overview-of-user-account-control"></a><span data-ttu-id="49b74-117">Información general sobre el control de cuentas de usuario</span><span class="sxs-lookup"><span data-stu-id="49b74-117">Overview of User Account Control</span></span>

<span data-ttu-id="49b74-118">El control de cuentas de usuario (UAC), introducido en Windows Vista, es una característica de seguridad diseñada para evitar que los atacantes malintencionados usen puntos débiles o errores detectados en aplicaciones ampliamente usadas para modificar el sistema operativo u otros programas instalados.</span><span class="sxs-lookup"><span data-stu-id="49b74-118">User Account Control (UAC), introduced in Windows Vista, is a security feature that is designed to help prevent malicious attackers from using weaknesses or bugs found in widely-used applications to alter the operating system or other installed programs.</span></span> <span data-ttu-id="49b74-119">Esto se consigue mediante la ejecución de la inmensa mayoría de programas y procesos como un usuario estándar (también conocido como usuario limitado, usuario restringido o Least-Privileged usuario), incluso si la cuenta del usuario actual tiene credenciales administrativas.</span><span class="sxs-lookup"><span data-stu-id="49b74-119">This is accomplished by running the vast majority of programs and processes as a Standard User (also known as a Limited User, Restricted User, or Least-Privileged User) even if the current user's account has administrative credentials.</span></span> <span data-ttu-id="49b74-120">Un proceso con privilegios de usuario estándar tiene muchas restricciones inherentes que impiden realizar cambios en todo el sistema.</span><span class="sxs-lookup"><span data-stu-id="49b74-120">A process with standard user privileges has many inherent restrictions that prevent it from making system-wide changes.</span></span>

<span data-ttu-id="49b74-121">UAC también es responsable de la elevación de privilegios de un proceso mediante el uso de un esquema de autenticación basado en un cuadro de diálogo que se inicia tras la ejecución de determinados procesos que se designan como que requieren privilegios administrativos.</span><span class="sxs-lookup"><span data-stu-id="49b74-121">UAC is also responsible for privilege elevation of a process by use of a dialog-based, authentication scheme initiated upon execution of certain processes that are designated as requiring administrative privileges.</span></span> <span data-ttu-id="49b74-122">La elevación de privilegios permite que los administradores ejecuten la mayoría de sus aplicaciones con un nivel de privilegios seguro (igual que con cualquier otro usuario estándar), pero también permiten procesos y operaciones que requieren privilegios administrativos.</span><span class="sxs-lookup"><span data-stu-id="49b74-122">Privilege elevation allows administrators to run the majority of their applications at a safe privilege level (the same as any other standard user), but also allow processes and operations that require administrative privileges.</span></span> <span data-ttu-id="49b74-123">UAC admite la autenticación por encima del hombro para que un administrador pueda conceder privilegios elevados a un programa mientras un usuario estándar ha iniciado sesión actualmente en el sistema.</span><span class="sxs-lookup"><span data-stu-id="49b74-123">UAC supports over-the-shoulder authentication so that an administrator can grant elevated privileges to a program while a standard user is currently logged onto the system.</span></span>

<span data-ttu-id="49b74-124">La característica UAC está habilitada de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="49b74-124">The UAC feature is enabled by default.</span></span> <span data-ttu-id="49b74-125">Aunque es posible que un administrador deshabilite UAC en todo el sistema, hacer esto tiene varias ramificaciones negativas.</span><span class="sxs-lookup"><span data-stu-id="49b74-125">While it is possible for an administrator to disable UAC system-wide, doing so has a number of negative ramifications.</span></span> <span data-ttu-id="49b74-126">En primer lugar, esto debilita la seguridad de todas las cuentas administrativas, ya que todos los procesos se ejecutarían con credenciales administrativas, incluso cuando la mayoría de las aplicaciones no las necesiten realmente.</span><span class="sxs-lookup"><span data-stu-id="49b74-126">First, this weakens the security of all administrative accounts, as all processes would be run with administrative credentials, even when most applications do not actually require them.</span></span> <span data-ttu-id="49b74-127">Con UAC deshabilitado, una aplicación de usuario estándar que exponga una vulnerabilidad explotable en seguridad puede usarse potencialmente para robar información privada, instalar rootkits o spyware, destruir la integridad del sistema o hospedar ataques Zombie en otros sistemas.</span><span class="sxs-lookup"><span data-stu-id="49b74-127">With UAC disabled, a standard user application that exposes an exploitable vulnerability in security can potentially be used to steal private information, install rootkits or spyware, destroy the system integrity, or host zombie attacks on other systems.</span></span> <span data-ttu-id="49b74-128">Mientras que con UAC habilitado, la mayor parte del software como usuario estándar limita considerablemente el daño potencial de este error.</span><span class="sxs-lookup"><span data-stu-id="49b74-128">Whereas with UAC enabled, running the majority of software as a standard user greatly limits the potential damage from such a bug.</span></span> <span data-ttu-id="49b74-129">En segundo lugar, al desactivar UAC, se deshabilitan muchas de las soluciones alternativas para la compatibilidad de aplicaciones que permiten a los usuarios estándar verdaderos ejecutar correctamente una amplia gama de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="49b74-129">Secondly, turning off UAC disables many of the workarounds for application compatibility that allow true standard users to successfully run a broad range of applications.</span></span> <span data-ttu-id="49b74-130">No se recomienda deshabilitar UAC nunca como solución de compatibilidad.</span><span class="sxs-lookup"><span data-stu-id="49b74-130">Disabling UAC should never be recommended as a compatibility workaround.</span></span>

<span data-ttu-id="49b74-131">Es importante tener en cuenta que las aplicaciones deben esforzarse por usar solo los derechos de usuario estándar si es posible.</span><span class="sxs-lookup"><span data-stu-id="49b74-131">It is important to note that applications should strive to only use standard user rights if at all possible.</span></span> <span data-ttu-id="49b74-132">Aunque los administradores pueden elevar fácilmente los privilegios de un proceso, la elevación todavía requiere la interacción del usuario y la confirmación cada vez que se ejecuta una aplicación que requiere credenciales administrativas.</span><span class="sxs-lookup"><span data-stu-id="49b74-132">While administrators can easily elevate the privileges of a process, the elevation still requires user interaction and acknowledgement every time that an application is run that requires administrative credentials.</span></span> <span data-ttu-id="49b74-133">Esta elevación también debe realizarse en el momento en que se inicia el programa, por lo que requerir credenciales administrativas incluso para una única operación requiere exponer el sistema a un riesgo mayor para todo el tiempo de ejecución de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="49b74-133">This elevation must also be done at the time that the program starts, so requiring administrative credentials   even for a single operation   requires exposing the system to greater risk for the entire running time of the application.</span></span> <span data-ttu-id="49b74-134">Los usuarios estándar sin la capacidad de elevar sus privilegios también son comunes en la configuración de la familia y el negocio.</span><span class="sxs-lookup"><span data-stu-id="49b74-134">Standard users without any ability to elevate their privileges are also common in family and business settings.</span></span> <span data-ttu-id="49b74-135">"Ejecutar como administrador" no es una buena solución para la compatibilidad, expone al usuario y al sistema a un mayor riesgo de seguridad y crea frustración para los usuarios en muchas situaciones.</span><span class="sxs-lookup"><span data-stu-id="49b74-135">"Run As Administrator" is not a good workaround for compatibility, exposes the user and the system to greater security risk, and creates frustration for users in many situations.</span></span>

> [!Note]  
> <span data-ttu-id="49b74-136">La característica de control de cuentas de usuario incluida en Windows Vista también está presente en Windows 7.</span><span class="sxs-lookup"><span data-stu-id="49b74-136">The User Account Control feature introduced in Windows Vista is also present in Windows 7.</span></span> <span data-ttu-id="49b74-137">Aunque la experiencia del usuario que trabaja con las distintas características del sistema se ha mejorado con respecto al control de cuentas de usuario, el impacto en las aplicaciones es básicamente el mismo.</span><span class="sxs-lookup"><span data-stu-id="49b74-137">While the user experience working with the various system features has been improved with respect to User Account Control, the impact on applications is basically the same.</span></span> <span data-ttu-id="49b74-138">Todas las recomendaciones de Windows Vista de este artículo se aplican también a Windows 7.</span><span class="sxs-lookup"><span data-stu-id="49b74-138">All of the Windows Vista recommendations in this article apply to Windows 7 as well.</span></span> <span data-ttu-id="49b74-139">Para obtener más información sobre los cambios de la interfaz de usuario de UAC para Windows 7, consulte la [interfaz de usuario: actualizaciones del cuadro de diálogo control de cuentas de usuario](../win7appqual/user-interface---user-account-control-dialog-updates.md).</span><span class="sxs-lookup"><span data-stu-id="49b74-139">For details on the UAC UI changes for Windows 7, see [User Interface - User Account Control Dialog Updates](../win7appqual/user-interface---user-account-control-dialog-updates.md).</span></span>

 

## <a name="user-accounts-in-windows-vista"></a><span data-ttu-id="49b74-140">Cuentas de usuario en Windows Vista</span><span class="sxs-lookup"><span data-stu-id="49b74-140">User Accounts in Windows Vista</span></span>

<span data-ttu-id="49b74-141">Windows Vista clasifica cada usuario en dos tipos de cuenta de usuario: administradores y usuarios estándar.</span><span class="sxs-lookup"><span data-stu-id="49b74-141">Windows Vista categorizes every user into two user account types: administrators and standard users.</span></span>

<span data-ttu-id="49b74-142">Una cuenta de usuario estándar es similar a una cuenta de usuario limitado en Windows XP.</span><span class="sxs-lookup"><span data-stu-id="49b74-142">A standard user account is similar to a limited-user account in Windows XP.</span></span> <span data-ttu-id="49b74-143">Al igual que en Windows XP, un usuario estándar no puede escribir en la carpeta archivos de programa, no puede escribir en la \_ \_ parte de la máquina local HKEY del registro y no puede realizar tareas que modifiquen el sistema, como la instalación de un controlador en modo kernel o el acceso a los espacios de proceso de nivel de sistema.</span><span class="sxs-lookup"><span data-stu-id="49b74-143">Like in Windows XP, a standard user cannot write to the Program Files folder, cannot write to the HKEY\_LOCAL\_MACHINE portion of the registry, and cannot perform tasks that alter the system, such as installing a kernel-mode driver or accessing system-level process spaces.</span></span>

<span data-ttu-id="49b74-144">La cuenta Administrador ha cambiado significativamente desde que se lanzó Windows XP.</span><span class="sxs-lookup"><span data-stu-id="49b74-144">The Administrator account has significantly changed since Windows XP was released.</span></span> <span data-ttu-id="49b74-145">Anteriormente, todos los procesos iniciados por un miembro del grupo administradores tenían privilegios administrativos.</span><span class="sxs-lookup"><span data-stu-id="49b74-145">Previously, all processes launched by a member of the Administrators group were given administrative privileges.</span></span> <span data-ttu-id="49b74-146">Con UAC habilitado, todos los procesos se ejecutan con privilegios de usuario estándar, a menos que un administrador los haya elevado de forma específica.</span><span class="sxs-lookup"><span data-stu-id="49b74-146">With UAC enabled, all processes execute with standard user privileges, unless specifically elevated by an administrator.</span></span> <span data-ttu-id="49b74-147">Esta diferencia hace que las cuentas del grupo de administradores sean más seguras reduciendo el riesgo de seguridad que plantean los posibles errores en la mayoría de los programas.</span><span class="sxs-lookup"><span data-stu-id="49b74-147">This difference makes accounts in the Administrators group more secure by reducing the security risk posed by potential bugs in most programs.</span></span>

<span data-ttu-id="49b74-148">Es importante que todas las aplicaciones, especialmente los juegos, funcionen de forma eficaz y responsable cuando se ejecutan como un proceso de usuario estándar.</span><span class="sxs-lookup"><span data-stu-id="49b74-148">It is important that all applications, especially games, operate effectively and responsibly when run as a standard user process.</span></span> <span data-ttu-id="49b74-149">Todas las operaciones que requieren privilegios administrativos deben realizarse en el momento de la instalación o mediante programas auxiliares que soliciten explícitamente credenciales administrativas.</span><span class="sxs-lookup"><span data-stu-id="49b74-149">All operations that require administrative privileges should be done either at installation time or by auxiliary programs that explicitly request administrative credentials.</span></span> <span data-ttu-id="49b74-150">Aunque la elevación de privilegios es bastante trivial para un miembro del grupo de administradores, los usuarios estándar deben aplazar a alguien con credenciales administrativas para introducir físicamente su contraseña para elevar los privilegios.</span><span class="sxs-lookup"><span data-stu-id="49b74-150">While privilege elevation is fairly trivial for a member of the Administrators group, standard users must defer to someone with administrative credentials to physically enter their password to elevate privileges.</span></span> <span data-ttu-id="49b74-151">Como las cuentas protegidas por controles parentales deben ser usuarios estándar, se trata de una situación muy común para los jugadores que usan Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="49b74-151">Since accounts protected by parental controls must be standard users, this will be a very common situation for gamers who are using Windows Vista.</span></span>

<span data-ttu-id="49b74-152">Si el juego ya está trabajando en Windows XP con cuentas de usuario limitado, el cambio a control de cuentas de usuario en Windows Vista debe ser muy sencillo.</span><span class="sxs-lookup"><span data-stu-id="49b74-152">If your game is already working on Windows XP with limited-user accounts, then the move to User Account Control on Windows Vista should be very easy.</span></span> <span data-ttu-id="49b74-153">La mayoría de estas aplicaciones funcionará tal cual, aunque es muy recomendable agregar un manifiesto de aplicación.</span><span class="sxs-lookup"><span data-stu-id="49b74-153">The majority of such applications will work as-is, although adding an application manifest is highly recommended.</span></span> <span data-ttu-id="49b74-154">(Los manifiestos se describen más adelante en este tema para [establecer el nivel de ejecución en el manifiesto de aplicación](#setting-the-execution-level-in-the-application-manifest)).</span><span class="sxs-lookup"><span data-stu-id="49b74-154">(Manifests are described later in this topic in [Setting the Execution Level in the Application Manifest](#setting-the-execution-level-in-the-application-manifest).)</span></span>

## <a name="file-access-as-a-standard-user"></a><span data-ttu-id="49b74-155">Acceso a archivos como usuario estándar</span><span class="sxs-lookup"><span data-stu-id="49b74-155">File Access as a Standard User</span></span>

<span data-ttu-id="49b74-156">El aspecto del juego más afectado por las restricciones de usuario estándar es la organización del sistema de archivos y la accesibilidad.</span><span class="sxs-lookup"><span data-stu-id="49b74-156">The aspect of your game most affected by standard user restrictions is file system organization and accessibility.</span></span> <span data-ttu-id="49b74-157">Nunca debe asumir que el juego puede escribir archivos en la carpeta donde está instalado el juego.</span><span class="sxs-lookup"><span data-stu-id="49b74-157">You should never assume that your game can write files to the folder where your game is installed.</span></span> <span data-ttu-id="49b74-158">En Windows Vista, por ejemplo, el sistema operativo debe elevar los privilegios de usuario antes de que una aplicación pueda escribir en la carpeta archivos de programa.</span><span class="sxs-lookup"><span data-stu-id="49b74-158">In Windows Vista for instance, a user s privileges must be elevated by the operating system before an application can write to the Program Files folder.</span></span> <span data-ttu-id="49b74-159">Para evitar esto, debe clasificar los archivos de datos de juegos por ámbito y accesibilidad, y usar la función [**SHGetFolderPath**](/windows/win32/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) , junto con las constantes CSIDL proporcionadas por el shell de Windows, para generar las rutas de acceso de archivo adecuadas.</span><span class="sxs-lookup"><span data-stu-id="49b74-159">To avoid this, you should categorize your game s data files by scope and accessibility, and use the [**SHGetFolderPath**](/windows/win32/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) function, along with the CSIDL constants provided by the Windows shell, to generate the appropriate file paths.</span></span> <span data-ttu-id="49b74-160">Las constantes CSIDL se corresponden con las carpetas conocidas del sistema de archivos que el sistema operativo utiliza y promueve para particionar archivos globales y específicos del usuario.</span><span class="sxs-lookup"><span data-stu-id="49b74-160">The CSIDL constants correspond to known folders in the file system that the operating system uses and promotes to partition global and user-specific files.</span></span>

<span data-ttu-id="49b74-161">Si intenta crear o escribir un archivo o un directorio en una carpeta que no conceda permiso de escritura en el proceso, se producirá un error en Windows Vista si la aplicación no tiene privilegios administrativos.</span><span class="sxs-lookup"><span data-stu-id="49b74-161">Attempting to create or write a file or directory under a folder which does not grant write permission to the process will fail under Windows Vista if the application does not have administrative privileges.</span></span> <span data-ttu-id="49b74-162">Si el ejecutable del juego de 32 bits se está ejecutando en el modo heredado, porque no declaraba un nivel de ejecución solicitado, sus operaciones de escritura se realizarán correctamente, pero se someterán a la virtualización, tal y como se describe en la sección "compatibilidad de UAC con juegos más antiguos", más adelante en este artículo.</span><span class="sxs-lookup"><span data-stu-id="49b74-162">If your 32-bit game executable is running in legacy mode, because it did not declare a requested execution level, its write operations will succeed, but they will be subjected to virtualization as described in the section "UAC Compatibility with Older Games" later in this article.</span></span>

<span data-ttu-id="49b74-163">**Tabla 1. Carpetas conocidas**</span><span class="sxs-lookup"><span data-stu-id="49b74-163">**Table 1. Known Folders**</span></span>



| <span data-ttu-id="49b74-164">CSIDL nombre</span><span class="sxs-lookup"><span data-stu-id="49b74-164">CSIDL Name</span></span>             | <span data-ttu-id="49b74-165">Ruta de acceso típica (Windows Vista)</span><span class="sxs-lookup"><span data-stu-id="49b74-165">Typical Path (Windows Vista)</span></span>                                                   | <span data-ttu-id="49b74-166">Derechos de usuario estándar</span><span class="sxs-lookup"><span data-stu-id="49b74-166">Standard User Rights</span></span> | <span data-ttu-id="49b74-167">Derechos de administrador</span><span class="sxs-lookup"><span data-stu-id="49b74-167">Administrator Rights</span></span> | <span data-ttu-id="49b74-168">Ámbito de acceso</span><span class="sxs-lookup"><span data-stu-id="49b74-168">Access Scope</span></span> | <span data-ttu-id="49b74-169">Descripción</span><span class="sxs-lookup"><span data-stu-id="49b74-169">Description</span></span>                                                                                                                      | <span data-ttu-id="49b74-170">Ejemplos</span><span class="sxs-lookup"><span data-stu-id="49b74-170">Examples</span></span>                                                          |
|------------------------|--------------------------------------------------------------------------------|----------------------|----------------------|--------------|----------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------|
| <span data-ttu-id="49b74-171">CSIDL \_ personal</span><span class="sxs-lookup"><span data-stu-id="49b74-171">CSIDL\_PERSONAL</span></span>        | <span data-ttu-id="49b74-172">C: \\ usuarios \\ nombre de usuario \\ documentos</span><span class="sxs-lookup"><span data-stu-id="49b74-172">C:\\Users\\user name\\Documents</span></span>                                                | <span data-ttu-id="49b74-173">Lectura/Escritura</span><span class="sxs-lookup"><span data-stu-id="49b74-173">Read/Write</span></span>           | <span data-ttu-id="49b74-174">Lectura/Escritura</span><span class="sxs-lookup"><span data-stu-id="49b74-174">Read/Write</span></span>           | <span data-ttu-id="49b74-175">Per-User</span><span class="sxs-lookup"><span data-stu-id="49b74-175">Per-User</span></span>     | <span data-ttu-id="49b74-176">Archivos de juegos específicos del usuario que se leen y modifican y que se pueden manipular fuera del contexto del juego.</span><span class="sxs-lookup"><span data-stu-id="49b74-176">User-specific game files that are read and modified and can be manipulated outside of the game context.</span></span>                          | <span data-ttu-id="49b74-177">Capturas de pantalla.</span><span class="sxs-lookup"><span data-stu-id="49b74-177">Screen shots.</span></span> <span data-ttu-id="49b74-178">Archivos de juego guardados con una asociación de extensión de archivo.</span><span class="sxs-lookup"><span data-stu-id="49b74-178">Saved game files with a file extension association.</span></span> |
| <span data-ttu-id="49b74-179">la \_ AppData local de CSIDL \_</span><span class="sxs-lookup"><span data-stu-id="49b74-179">CSIDL\_LOCAL\_APPDATA</span></span>  | <span data-ttu-id="49b74-180">C: \\ usuarios \\ nombre de usuario \\ AppData \\ local</span><span class="sxs-lookup"><span data-stu-id="49b74-180">C:\\Users\\user name\\AppData\\Local</span></span>                                           | <span data-ttu-id="49b74-181">Lectura/Escritura</span><span class="sxs-lookup"><span data-stu-id="49b74-181">Read/Write</span></span>           | <span data-ttu-id="49b74-182">Lectura/Escritura</span><span class="sxs-lookup"><span data-stu-id="49b74-182">Read/Write</span></span>           | <span data-ttu-id="49b74-183">Per-User</span><span class="sxs-lookup"><span data-stu-id="49b74-183">Per-User</span></span>     | <span data-ttu-id="49b74-184">Archivos de juegos específicos del usuario que se leen y modifican y que solo se usan en el contexto del juego.</span><span class="sxs-lookup"><span data-stu-id="49b74-184">User-specific game files that are read and modified and are of use only within the game context.</span></span>                                 | <span data-ttu-id="49b74-185">Archivos de caché de juego.</span><span class="sxs-lookup"><span data-stu-id="49b74-185">Game cache files.</span></span> <span data-ttu-id="49b74-186">Configuraciones del reproductor.</span><span class="sxs-lookup"><span data-stu-id="49b74-186">Player configurations.</span></span>                          |
| <span data-ttu-id="49b74-187">\_AppData comunes de CSIDL \_</span><span class="sxs-lookup"><span data-stu-id="49b74-187">CSIDL\_COMMON\_APPDATA</span></span> | <span data-ttu-id="49b74-188">C: \\ ProgramData</span><span class="sxs-lookup"><span data-stu-id="49b74-188">C:\\ProgramData</span></span>                                                                | <span data-ttu-id="49b74-189">Lectura/escritura si es propietario</span><span class="sxs-lookup"><span data-stu-id="49b74-189">Read/Write if owner</span></span>  | <span data-ttu-id="49b74-190">Lectura/Escritura</span><span class="sxs-lookup"><span data-stu-id="49b74-190">Read/Write</span></span>           | <span data-ttu-id="49b74-191">Todos los usuarios</span><span class="sxs-lookup"><span data-stu-id="49b74-191">All Users</span></span>    | <span data-ttu-id="49b74-192">Archivos de juego que pueden ser creados por un usuario y leídos por todos los usuarios.</span><span class="sxs-lookup"><span data-stu-id="49b74-192">Game files that can be created by a user and read by all users.</span></span> <span data-ttu-id="49b74-193">El acceso de escritura solo se concede al creador del archivo (propietario).</span><span class="sxs-lookup"><span data-stu-id="49b74-193">Write access is granted only to the creator of the file (owner).</span></span> | <span data-ttu-id="49b74-194">Perfiles de usuario</span><span class="sxs-lookup"><span data-stu-id="49b74-194">User Profiles</span></span>                                                     |
| <span data-ttu-id="49b74-195">\_archivos de programa CSIDL \_</span><span class="sxs-lookup"><span data-stu-id="49b74-195">CSIDL\_PROGRAM\_FILES</span></span>  | <span data-ttu-id="49b74-196">C: \\ archivos de programa</span><span class="sxs-lookup"><span data-stu-id="49b74-196">C:\\Program Files</span></span><br/> <span data-ttu-id="49b74-197">or</span><span class="sxs-lookup"><span data-stu-id="49b74-197">or</span></span><br/> <span data-ttu-id="49b74-198">C: \\ archivos de programa (x86)</span><span class="sxs-lookup"><span data-stu-id="49b74-198">C:\\Program Files (x86)</span></span> <br/> | <span data-ttu-id="49b74-199">Solo lectura</span><span class="sxs-lookup"><span data-stu-id="49b74-199">Read only</span></span>            | <span data-ttu-id="49b74-200">Lectura/Escritura</span><span class="sxs-lookup"><span data-stu-id="49b74-200">Read/Write</span></span>           | <span data-ttu-id="49b74-201">Todos los usuarios</span><span class="sxs-lookup"><span data-stu-id="49b74-201">All Users</span></span>    | <span data-ttu-id="49b74-202">Archivos de juego estáticos escritos por el instalador del juego s que leen todos los usuarios.</span><span class="sxs-lookup"><span data-stu-id="49b74-202">Static game files written by the game s installer that are read by all users.</span></span>                                                    | <span data-ttu-id="49b74-203">Recursos de juegos, como materiales y mallas.</span><span class="sxs-lookup"><span data-stu-id="49b74-203">Game assets, such as materials and meshes.</span></span>                        |



 

<span data-ttu-id="49b74-204">El juego se instalará normalmente en una carpeta en la carpeta representada por la \_ constante de archivos de programa CSIDL \_ .</span><span class="sxs-lookup"><span data-stu-id="49b74-204">Your game will typically be installed in a folder under the folder represented by the CSIDL\_PROGRAM\_FILES constant.</span></span> <span data-ttu-id="49b74-205">Sin embargo, este no siempre es el caso.</span><span class="sxs-lookup"><span data-stu-id="49b74-205">However, this is not always the case.</span></span> <span data-ttu-id="49b74-206">En su lugar, debe usar una ruta de acceso relativa desde el archivo ejecutable al generar cadenas de ruta de acceso a archivos o directorios ubicados en la carpeta de instalación.</span><span class="sxs-lookup"><span data-stu-id="49b74-206">You should instead use a relative path from your executable file when generating path strings to files or directories located under your installation folder.</span></span>

<span data-ttu-id="49b74-207">También debe abstenerse de supuestos codificados de forma rígida sobre las rutas de acceso de carpeta conocidas.</span><span class="sxs-lookup"><span data-stu-id="49b74-207">You should also refrain from hard-coded assumptions about the known folder paths.</span></span> <span data-ttu-id="49b74-208">Por ejemplo, en Windows XP Professional 64-bit Edition y Windows Vista x64, la ruta de acceso a los archivos de programa es C: \\ archivos de programa (x86) para programas de 32 bits y C: \\ archivos de programa para programas de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="49b74-208">For example, on Windows XP Professional 64-bit Edition and Windows Vista x64, the program files path is C:\\Program Files (x86) for 32-bit programs and C:\\Program Files for 64-bit programs.</span></span> <span data-ttu-id="49b74-209">Estas rutas de acceso conocidas se cambian desde Windows XP y los usuarios pueden volver a configurar la ubicación de muchas de estas carpetas e incluso localizarlas en unidades distintas.</span><span class="sxs-lookup"><span data-stu-id="49b74-209">These known paths are changed from Windows XP, and users can reconfigure the location of many of these folders and even locate them on different drives.</span></span> <span data-ttu-id="49b74-210">Por lo tanto, use siempre las constantes CSIDL para evitar confusiones y posibles problemas.</span><span class="sxs-lookup"><span data-stu-id="49b74-210">So, always use the CSIDL constants to avoid confusion and potential problems.</span></span> <span data-ttu-id="49b74-211">Programa de instalación de Windows entiende estas ubicaciones de carpeta conocidas y moverá los datos al actualizar el sistema operativo desde Windows XP; por el contrario, el uso de ubicaciones no estándar o rutas de acceso codificadas de forma rígida puede producir un error después de una actualización del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="49b74-211">Windows Setup understands these known folder locations and will move the data when upgrading the operating system from Windows XP; in contrast, use of non-standard locations or hard-coded paths may well fail after an OS upgrade.</span></span>

<span data-ttu-id="49b74-212">Se debe prestar atención a las diferencias de facilidad de uso entre las carpetas específicas del usuario especificadas por CSIDL \_ personal y CSIDL \_ local \_ appdata.</span><span class="sxs-lookup"><span data-stu-id="49b74-212">Attention should be given to the subtle usability differences between the user-specific folders specified by CSIDL\_PERSONAL and CSIDL\_LOCAL\_APPDATA.</span></span> <span data-ttu-id="49b74-213">La práctica recomendada para seleccionar la constante CSIDL que se va a usar para escribir un archivo consiste en usar CSIDL \_ personal si se espera que el usuario interactúe con el archivo, como hacer doble clic en él para abrirlo en una herramienta o aplicación, y usar la opción de la \_ \_ AppData local de CSIDL para otros archivos.</span><span class="sxs-lookup"><span data-stu-id="49b74-213">The recommended practice for selecting the CSIDL constant to use for writing a file is to use CSIDL\_PERSONAL if the user is expected to interact with the file, such as double-clicking on it to open it in a tool or application, and to use CSIDL\_LOCAL\_APPDATA for other files.</span></span> <span data-ttu-id="49b74-214">La aplicación puede aprovechar ambas carpetas para almacenar y organizar archivos de datos específicos del usuario, ya que no hay ninguna diferencia en su ámbito de acceso o nivel de privilegios.</span><span class="sxs-lookup"><span data-stu-id="49b74-214">Both folders can be leveraged by your application to store and organize user-specific data files, as there is no difference in their access scope or privilege level.</span></span> <span data-ttu-id="49b74-215">Se debe tener cuidado para crear nombres de ruta de acceso que sean lo suficientemente únicos como para no entrar en conflicto con otras aplicaciones, pero lo suficientemente corto como para mantener el número de caracteres de la ruta de acceso completa menos que el valor de la \_ ruta de acceso máxima, 260.</span><span class="sxs-lookup"><span data-stu-id="49b74-215">Care should be taken to create path names that are unique enough to not collide with other applications, but short enough to keep the number of characters in the full path fewer than the value of MAX\_PATH, 260.</span></span>

<span data-ttu-id="49b74-216">El código siguiente proporciona un ejemplo de cómo escribir un archivo en una carpeta conocida:</span><span class="sxs-lookup"><span data-stu-id="49b74-216">The following code provides an example of how to write a file to a known folder:</span></span>

``` syntax
#include <windows.h>
#include <shlobj.h>
#include <shlwapi.h>
        ...
        ...
        ...
        TCHAR strPath[MAX_PATH];
        if( SUCCEEDED(
        SHGetFolderPath( NULL, CSIDL_PERSONAL, NULL, SHGFP_TYPE_CURRENT, strPath ) ) )
        {
        PathAppend( strPath, TEXT( "Company Name\\Title" ) );

        if( !PathFileExists( strPath ) )
        {
        if( ERROR_SUCCESS != SHCreateDirectoryEx( NULL, strPath, NULL ) )
        return E_FAIL;
        }

        PathAppend( strPath, TEXT( "gamefile.txt" ) );

        // strPath is now something like:
        // C:\Users\<current user>\Documents\Company Name\Title\gamefile.txt
        // Open the file for writing
        HANDLE hFile = CreateFile(strPath, GENERIC_WRITE, NULL, NULL, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL);

        if( INVALID_HANDLE_VALUE != hFile )
        {
        // TODO: Write to file
        CloseHandle(hFile);
        }
        }
```

## <a name="registry-access-as-a-standard-user"></a><span data-ttu-id="49b74-217">Acceso al registro como usuario estándar</span><span class="sxs-lookup"><span data-stu-id="49b74-217">Registry Access as a Standard User</span></span>

<span data-ttu-id="49b74-218">El acceso al registro por parte de un usuario estándar está restringido de manera similar al sistema de archivos.</span><span class="sxs-lookup"><span data-stu-id="49b74-218">Registry access by a standard user is restricted in a similar fashion as the file system.</span></span> <span data-ttu-id="49b74-219">A un usuario estándar se le permite el acceso de lectura a todas las claves del registro. sin embargo, el acceso de escritura solo se concede \_ al \_ subárbol HKEY current user (HKCU), que se asigna internamente a la subclave específica del usuario HKEY \_ ID. \\ de seguridad (SID) del usuario actual.</span><span class="sxs-lookup"><span data-stu-id="49b74-219">A standard user is permitted read access to all keys in the registry; however, write access is only granted to the HKEY\_CURRENT\_USER (HKCU) subtree, which is mapped internally to the user-specific subkey HKEY\_USERS\\Security ID (SID) of current user.</span></span> <span data-ttu-id="49b74-220">Una aplicación que necesita escribir en cualquier ubicación del registro que no sea el \_ usuario actual de HKEY \_ requiere privilegios administrativos.</span><span class="sxs-lookup"><span data-stu-id="49b74-220">An application that needs to write to any registry location other than HKEY\_CURRENT\_USER requires administrative privileges.</span></span>

<span data-ttu-id="49b74-221">Si la aplicación de 32 bits no contiene un nivel de ejecución solicitado en su manifiesto, se virtualizarán todas las escrituras en el \_ software de máquina local HKEY \_ \\ , mientras que las escrituras en otras ubicaciones fuera del \_ usuario actual de HKEY no se realizarán \_ correctamente.</span><span class="sxs-lookup"><span data-stu-id="49b74-221">If the 32-bit application does not contain a requested execution level in its manifest, then all writes to HKEY\_LOCAL\_MACHINE\\Software will be virtualized, while writes to other locations outside of HKEY\_CURRENT\_USER will fail.</span></span>

<span data-ttu-id="49b74-222">No se recomienda almacenar datos persistentes en el registro, como la configuración de un usuario.</span><span class="sxs-lookup"><span data-stu-id="49b74-222">Storing persistent data in the registry, like a user's configuration, is not recommended.</span></span> <span data-ttu-id="49b74-223">El método preferido para almacenar datos persistentes desde el juego es escribir los datos en el sistema de archivos llamando a [**SHGetFolderPath**](/windows/win32/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) y obtener el valor de una constante CSIDL, que se describe en la sección anterior.</span><span class="sxs-lookup"><span data-stu-id="49b74-223">The preferred method of storing persistent data from your game is to write the data to the file system by calling [**SHGetFolderPath**](/windows/win32/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) and to get the value of a CSIDL constant, described in the previous section.</span></span>

## <a name="privilege-elevation"></a><span data-ttu-id="49b74-224">Elevación de privilegios</span><span class="sxs-lookup"><span data-stu-id="49b74-224">Privilege Elevation</span></span>

<span data-ttu-id="49b74-225">En Windows Vista, todas las aplicaciones que requieran privilegios administrativos deben declarar una solicitud para un nivel de ejecución administrativo en su manifiesto (que se describe en la sección siguiente, [estableciendo el nivel de ejecución en el manifiesto de aplicación](#setting-the-execution-level-in-the-application-manifest)).</span><span class="sxs-lookup"><span data-stu-id="49b74-225">In Windows Vista, any application that requires administrative privileges must declare a request for an administrative execution level in its manifest (described in the next section, [Setting the Execution Level in the Application Manifest](#setting-the-execution-level-in-the-application-manifest)).</span></span>

<span data-ttu-id="49b74-226">La elevación, como se conoce, es el procedimiento controlado por UAC para promover un proceso a un proceso administrativo.</span><span class="sxs-lookup"><span data-stu-id="49b74-226">Elevation, as it is known, is the procedure driven by UAC to promote a process to an administrative process.</span></span> <span data-ttu-id="49b74-227">Los privilegios de un proceso solo se pueden elevar en el momento de la creación.</span><span class="sxs-lookup"><span data-stu-id="49b74-227">The privileges of a process can only be elevated at creation time.</span></span> <span data-ttu-id="49b74-228">Una vez creado, un proceso nunca se promoverá a un nivel de privilegios superior.</span><span class="sxs-lookup"><span data-stu-id="49b74-228">Once created, a process will never be promoted to a higher privilege level.</span></span> <span data-ttu-id="49b74-229">Por esta razón.</span><span class="sxs-lookup"><span data-stu-id="49b74-229">For this reason.</span></span> <span data-ttu-id="49b74-230">las operaciones que requieren credenciales administrativas deben aislarse en instaladores independientes y otros programas auxiliares.</span><span class="sxs-lookup"><span data-stu-id="49b74-230">operations that require administrative credentials should be isolated to separate installers and other auxiliary programs.</span></span>

<span data-ttu-id="49b74-231">Tras la ejecución de un programa, UAC inspecciona el nivel de ejecución solicitado en el manifiesto y, si se requieren privilegios elevados, solicita al usuario actual uno de dos cuadros de diálogo estándar: uno para un usuario estándar y otro para un administrador.</span><span class="sxs-lookup"><span data-stu-id="49b74-231">Upon execution of a program, UAC inspects the requested execution level in the manifest, and if elevated privileges are required, prompts the current user with one of two standard dialog boxes: one for a standard user and one for an administrator.</span></span>

<span data-ttu-id="49b74-232">Si el usuario actual es un usuario estándar, UAC solicita al usuario las credenciales de un administrador antes de permitir que se ejecute el programa.</span><span class="sxs-lookup"><span data-stu-id="49b74-232">If the current user is a standard user, UAC prompts the user for the credentials of an administrator before allowing the program to run.</span></span>

<span data-ttu-id="49b74-233">**Figura 1. Pedir a un usuario estándar que escriba las credenciales para una cuenta administrativa**</span><span class="sxs-lookup"><span data-stu-id="49b74-233">**Figure 1. Prompt for a Standard User to enter credentials for an administrative account**</span></span>

![pedir a un usuario estándar que escriba las credenciales para una cuenta administrativa](images/uac-prompt-elevation.jpg)

<span data-ttu-id="49b74-235">Si el usuario actual es un administrador, UAC solicita permiso al usuario antes de permitir que se ejecute el programa.</span><span class="sxs-lookup"><span data-stu-id="49b74-235">If the current user is an administrator, UAC prompts the user for permission before allowing the program to run.</span></span>

<span data-ttu-id="49b74-236">**Figura 2. Pedir a un administrador que autorice cambios en el equipo**</span><span class="sxs-lookup"><span data-stu-id="49b74-236">**Figure 2. Prompt for an Administrator to authorize changes to the computer**</span></span>

![pedir a un administrador que autorice cambios en el equipo](images/uac-prompt-authorization.jpg)

<span data-ttu-id="49b74-238">A la aplicación solo se le concederán privilegios administrativos si un usuario estándar proporciona las credenciales administrativas adecuadas o un usuario administrativo proporciona confirmación; todo lo demás hará que la aplicación finalice.</span><span class="sxs-lookup"><span data-stu-id="49b74-238">The application will only be granted administrative privileges if a standard user provides the proper administrative credentials or an administrative user provides acknowledgement; anything else will cause the application to terminate.</span></span>

<span data-ttu-id="49b74-239">Es importante tener en cuenta que un proceso con privilegios elevados se ejecuta como el usuario administrativo que especificó las credenciales en el símbolo del sistema de UAC en lugar de como el usuario estándar que ha iniciado sesión actualmente.</span><span class="sxs-lookup"><span data-stu-id="49b74-239">It is important to note that a process with elevated privileges runs as the administrative user who entered credentials in the UAC prompt rather than as the standard user who is currently logged in.</span></span> <span data-ttu-id="49b74-240">Esto es similar a **runas** en Windows XP. el proceso elevado obtiene la carpeta del administrador y las claves del registro al obtener acceso a los datos de cada usuario, y todos los programas que inicia el proceso elevado también heredan los derechos administrativos y las ubicaciones de las cuentas de usuario.</span><span class="sxs-lookup"><span data-stu-id="49b74-240">This is similar to **RunAs** in Windows XP   the elevated process gets the administrator's folder and registry keys when accessing per-user data, and all programs that the elevated process launches also inherit both the administrative rights and user account locations.</span></span> <span data-ttu-id="49b74-241">En el caso de los administradores a los que se les pida confirmación (**continuar** o **Cancelar**), estas ubicaciones coincidirán con las ubicaciones del usuario actual.</span><span class="sxs-lookup"><span data-stu-id="49b74-241">For administrators who are prompted for acknowledgement (**Continue** or **Cancel**), these locations will match the currently user's locations.</span></span> <span data-ttu-id="49b74-242">En general, sin embargo, los procesos que requieren elevación no deben funcionar en los datos por usuario.</span><span class="sxs-lookup"><span data-stu-id="49b74-242">In general, however, processes that require elevation should not operate on per-user data.</span></span> <span data-ttu-id="49b74-243">Tenga en cuenta que esto puede afectar de forma significativa a cómo debe funcionar el instalador.</span><span class="sxs-lookup"><span data-stu-id="49b74-243">Note that this can substantially affect how your installer must operate!</span></span> <span data-ttu-id="49b74-244">Si el instalador, que se ejecuta como administrador, escribe en HKCU o en el perfil de un usuario, es posible que pueda escribir en la ubicación equivocada.</span><span class="sxs-lookup"><span data-stu-id="49b74-244">If the installer, running as an administrator, writes to HKCU or to a user's profile, it may very well be writing to the wrong location.</span></span> <span data-ttu-id="49b74-245">Considere la posibilidad de crear estos valores por usuario en la primera ejecución del juego.</span><span class="sxs-lookup"><span data-stu-id="49b74-245">Consider creating these per-user values upon the first run of the game.</span></span>

## <a name="uac-implications-with-createprocess"></a><span data-ttu-id="49b74-246">Implicaciones de UAC con CreateProcess ()</span><span class="sxs-lookup"><span data-stu-id="49b74-246">UAC Implications with CreateProcess()</span></span>

<span data-ttu-id="49b74-247">El mecanismo de elevación de UAC no se invocará desde una llamada a la función [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa)() de Win32 para iniciar un ejecutable que esté configurado para requerir un nivel de ejecución más alto que el proceso actual.</span><span class="sxs-lookup"><span data-stu-id="49b74-247">The UAC elevation mechanism will not be invoked from a call to the Win32 [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa)() function to start an executable which is configured to require a higher execution level than the current process.</span></span> <span data-ttu-id="49b74-248">Como resultado, se producirá un error en la llamada a **CreateProcess**() con [**GetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror)() que devuelve la elevación de errores \_ \_ necesaria.</span><span class="sxs-lookup"><span data-stu-id="49b74-248">As a result, the call to **CreateProcess**() will fail with [**GetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror)() returning ERROR\_ELEVATION\_REQUIRED.</span></span> <span data-ttu-id="49b74-249">**CreateProcess**() solo se realizará correctamente cuando el nivel de ejecución del destinatario sea igual o menor que el del llamador.</span><span class="sxs-lookup"><span data-stu-id="49b74-249">**CreateProcess**() will only succeed when the execution level of the callee is equal-to or less-than that of the caller.</span></span> <span data-ttu-id="49b74-250">Un proceso no elevado que debe generar procesos elevados debe hacerlo mediante la función [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea)(), lo que hará que el mecanismo de elevación de UAC se desencadene por medio del shell.</span><span class="sxs-lookup"><span data-stu-id="49b74-250">A non-elevated process that must spawn elevated processes should do so using the [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea)() function, which will cause the UAC elevation mechanism to be triggered by means of the shell.</span></span>

## <a name="setting-the-execution-level-in-the-application-manifest"></a><span data-ttu-id="49b74-251">Establecer el nivel de ejecución en el manifiesto de aplicación</span><span class="sxs-lookup"><span data-stu-id="49b74-251">Setting the Execution Level in the Application Manifest</span></span>

<span data-ttu-id="49b74-252">Para declarar el nivel de ejecución solicitado del juego, agregue una extensión al manifiesto de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="49b74-252">You declare the requested execution level of your game by adding an extension to the application s manifest.</span></span> <span data-ttu-id="49b74-253">El siguiente código XML muestra la configuración mínima necesaria para establecer el nivel de ejecución de una aplicación:</span><span class="sxs-lookup"><span data-stu-id="49b74-253">The following XML code shows the minimal configuration required to set the execution level for an application:</span></span>

``` syntax
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
    <ms_asmv2:trustInfo xmlns:ms_asmv2="urn:schemas-microsoft-com:asm.v2">
        <ms_asmv2:security>
            <ms_asmv2:requestedPrivileges>
                <ms_asmv2:requestedExecutionLevel level="asInvoker" uiAccess="false" />
            </ms_asmv2:requestedPrivileges>
        </ms_asmv2:security>
    </ms_asmv2:trustInfo>
</assembly>
```

<span data-ttu-id="49b74-254">En el código anterior, se informa al sistema operativo de que el juego solo requiere privilegios de usuario estándar mediante la siguiente etiqueta:</span><span class="sxs-lookup"><span data-stu-id="49b74-254">In the preceding code, the operating system is informed that the game only requires standard user privileges by the following tag:</span></span>

``` syntax
<ms_asmv2:requestedExecutionLevel level="asInvoker" uiAccess="false" />
```

<span data-ttu-id="49b74-255">Al establecer de forma explícita el valor de requestedExecutionLevel en "AsInvoker", este ejemplo afirma al sistema operativo que el juego se comportará correctamente sin privilegios administrativos.</span><span class="sxs-lookup"><span data-stu-id="49b74-255">By explicitly setting requestedExecutionLevel to "asInvoker", this example asserts to the operating system that the game will behave properly without administrative privileges.</span></span> <span data-ttu-id="49b74-256">Como resultado, UAC deshabilita la virtualización y ejecuta el juego con los mismos privilegios que el invocador, que suele tener privilegios de usuario estándar, ya que el explorador de Windows se ejecuta como usuario estándar.</span><span class="sxs-lookup"><span data-stu-id="49b74-256">As a result, UAC disables virtualization and runs the game with the same privileges as the invoker   which is typically standard user privileges, since Windows Explorer runs as standard user.</span></span>

<span data-ttu-id="49b74-257">Se puede informar al sistema operativo de que un juego requiere la elevación de privilegios administrativos mediante la sustitución de "AsInvoker" por "requireAdministrator", para crear la siguiente etiqueta:</span><span class="sxs-lookup"><span data-stu-id="49b74-257">The operating system can be informed a game requires elevation to administrative privileges by replacing "asInvoker" with "requireAdministrator", to create the following tag:</span></span>

``` syntax
<ms_asmv2:requestedExecutionLevel level="requireAdministrator" uiAccess="false" />
```

<span data-ttu-id="49b74-258">Con esta configuración, el sistema operativo solicita al usuario actual uno de los cuadros de diálogo de elevación de UAC estándar cada vez que se ejecuta el juego.</span><span class="sxs-lookup"><span data-stu-id="49b74-258">With this configuration, the operating system prompts the current user with one of the standard UAC elevation dialogs every time that the game is executed.</span></span> <span data-ttu-id="49b74-259">Se recomienda encarecidamente que ningún juego requiera privilegios de administrador para ejecutarse, porque no solo este cuadro de diálogo se vuelve tan molesto, sino que también hace que el juego no sea compatible con el control parental.</span><span class="sxs-lookup"><span data-stu-id="49b74-259">It is highly recommended that no game require administrator privileges to run, because not only will this dialog quickly become annoying, but it also makes the game incompatible with parental controls.</span></span> <span data-ttu-id="49b74-260">Piense muy detenidamente antes de agregar este requisito a cualquier archivo ejecutable.</span><span class="sxs-lookup"><span data-stu-id="49b74-260">Think very carefully before adding this requirement to any executable.</span></span>

<span data-ttu-id="49b74-261">Una idea equivocada habitual es que agregar un manifiesto que establezca requestedExecutionLevel en "requireAdministrator" omite la necesidad de una solicitud de elevación.</span><span class="sxs-lookup"><span data-stu-id="49b74-261">A common misconception is that adding a manifest that sets requestedExecutionLevel to "requireAdministrator" bypasses the need for an elevation prompt.</span></span> <span data-ttu-id="49b74-262">Esto no es cierto.</span><span class="sxs-lookup"><span data-stu-id="49b74-262">This is not true.</span></span> <span data-ttu-id="49b74-263">Simplemente impide que el sistema operativo adivine si su aplicación de instalación o actualización necesita privilegios administrativos.</span><span class="sxs-lookup"><span data-stu-id="49b74-263">It simply prevents the operating system from guessing whether your setup or update application needs administrative privileges.</span></span> <span data-ttu-id="49b74-264">Todavía se solicita al usuario que autorice la elevación.</span><span class="sxs-lookup"><span data-stu-id="49b74-264">The user is still prompted to authorize elevation.</span></span>

<span data-ttu-id="49b74-265">Windows comprueba la firma de cualquier aplicación marcada para elevación antes de mostrar el símbolo del sistema de UAC.</span><span class="sxs-lookup"><span data-stu-id="49b74-265">Windows checks the signature of any application that is marked for elevation before it displays the UAC prompt.</span></span> <span data-ttu-id="49b74-266">Un archivo ejecutable grande marcado para elevación tarda más tiempo en comprobarse que un archivo ejecutable pequeño y más largo que un archivo ejecutable marcado como "AsInvoker".</span><span class="sxs-lookup"><span data-stu-id="49b74-266">A large executable that is marked for elevation takes longer to check than a small executable and longer than an executable that is marked as "asInvoker".</span></span> <span data-ttu-id="49b74-267">Los ejecutables de instalación que se extraen automáticamente deberían estar marcados como "AsInvoker" y cualquier parte que deba marcarse como "requireAdministrator" debe colocarse en un ejecutable auxiliar independiente.</span><span class="sxs-lookup"><span data-stu-id="49b74-267">Setup executables that are self-extracting should, therefore, be marked as "asInvoker", and any portion that needs to be marked as "requireAdministrator" should be placed in a separate helper executable.</span></span>

<span data-ttu-id="49b74-268">El atributo uiAccess, que se muestra en los ejemplos anteriores, siempre debe ser FALSE para los juegos.</span><span class="sxs-lookup"><span data-stu-id="49b74-268">The uiAccess attribute, shown in the preceding examples, should always be FALSE for games.</span></span> <span data-ttu-id="49b74-269">Este atributo especifica si los clientes de automatización de la interfaz de usuario tienen acceso a la interfaz de usuario del sistema protegida y tiene implicaciones de seguridad especiales si se establece en TRUE.</span><span class="sxs-lookup"><span data-stu-id="49b74-269">This attribute specifies whether UI automation clients have access to the protected system UI, and it has special security implications if set to TRUE.</span></span>

## <a name="embedding-a-manifest-in-visual-studio"></a><span data-ttu-id="49b74-270">Incrustar un manifiesto en Visual Studio</span><span class="sxs-lookup"><span data-stu-id="49b74-270">Embedding a Manifest in Visual Studio</span></span>

<span data-ttu-id="49b74-271">La compatibilidad con manifiestos se agregó por primera vez a Visual Studio a partir de VS2005.</span><span class="sxs-lookup"><span data-stu-id="49b74-271">Manifest support was first added to Visual Studio beginning in VS2005.</span></span> <span data-ttu-id="49b74-272">De forma predeterminada, un archivo ejecutable compilado en Visual Studio 2005 (o posterior) tendrá un manifiesto generado automáticamente incrustado como parte del proceso de compilación.</span><span class="sxs-lookup"><span data-stu-id="49b74-272">By default, an executable built in Visual Studio 2005 (or newer) will have an auto-generated manifest embedded in it as part of the build process.</span></span> <span data-ttu-id="49b74-273">El contenido del manifiesto generado automáticamente depende de ciertas configuraciones de proyecto que se especifiquen en el cuadro de diálogo Propiedades del proyecto.</span><span class="sxs-lookup"><span data-stu-id="49b74-273">The contents of the auto-generated manifest are dependent on certain project configurations that you specify in the project properties dialog.</span></span>

<span data-ttu-id="49b74-274">El manifiesto generado automáticamente por Visual Studio 2005 no contendrá un <trustInfo> bloque, ya que no hay forma de configurar el nivel de ejecución de UAC en las propiedades del proyecto.</span><span class="sxs-lookup"><span data-stu-id="49b74-274">The manifest that is auto-generated by Visual Studio 2005 will not contain a <trustInfo> block as there is no way to configure the UAC execution level in the project properties.</span></span> <span data-ttu-id="49b74-275">La mejor manera de agregar esta información es dejar que VS2005 combine un manifiesto definido por el usuario que contenga el <trustInfo> bloque con el manifiesto generado automáticamente.</span><span class="sxs-lookup"><span data-stu-id="49b74-275">The preferred way to add this information is to let VS2005 merge a user-defined manifest containing the <trustInfo> block with the auto-generated manifest.</span></span> <span data-ttu-id="49b74-276">Esto es tan sencillo como agregar un \* archivo. manifest a la solución que contiene el XML que se muestra en la sección anterior.</span><span class="sxs-lookup"><span data-stu-id="49b74-276">This is as simple as adding a \*.manifest file to your solution that contains the XML listed in the previous section.</span></span> <span data-ttu-id="49b74-277">Cuando Visual Studio encuentra un archivo. manifest en la solución, invocará automáticamente la herramienta manifiesto (mt.exe) para combinar los archivos. manifest con el generado automáticamente.</span><span class="sxs-lookup"><span data-stu-id="49b74-277">When Visual Studio encounters a .manifest file in your solution, it will automatically invoke the Manifest Tool (mt.exe) to merge the .manifest files with the auto-generated one.</span></span>

> [!Note]  
> <span data-ttu-id="49b74-278">Existe un error en la herramienta de manifiesto (mt.exe) proporcionada por Visual Studio 2005 que genera un manifiesto combinado e incrustado que puede causar problemas cuando el archivo ejecutable se ejecuta en Windows XP anterior a SP3.</span><span class="sxs-lookup"><span data-stu-id="49b74-278">There is a bug in the Manifest Tool (mt.exe) provided by Visual Studio 2005 that results in a merged and embedded manifest which can cause problems when the executable is run on Windows XP prior to SP3.</span></span> <span data-ttu-id="49b74-279">El error es el resultado de la forma en que la herramienta vuelve a definir el espacio de nombres predeterminado al declarar el <trustInfo> bloque.</span><span class="sxs-lookup"><span data-stu-id="49b74-279">The bug is a result of how the tool redefines the default namespace upon declaration of the <trustInfo> block.</span></span> <span data-ttu-id="49b74-280">Afortunadamente, es fácil omitir completamente el problema declarando explícitamente un espacio de nombres diferente en el <trustInfo> bloque y estableciendo el ámbito de los nodos secundarios en el nuevo espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="49b74-280">Fortunately, it is easy to bypass the issue entirely by explicitly declaring a different namespace in the <trustInfo> block and by scoping the child nodes to the new namespace.</span></span> <span data-ttu-id="49b74-281">El XML proporcionado en la sección anterior muestra esta corrección.</span><span class="sxs-lookup"><span data-stu-id="49b74-281">The XML provided in the previous section demonstrates this fix.</span></span>

 

<span data-ttu-id="49b74-282">Una advertencia en el uso de la herramienta mt.exe que se incluye en Visual Studio 2005 es que generará una advertencia al procesar el <trustInfo> bloque, ya que la herramienta no contiene un esquema actualizado con el que validar el XML.</span><span class="sxs-lookup"><span data-stu-id="49b74-282">A caveat in using the mt.exe tool included in Visual Studio 2005 is that it will generate a warning when processing the <trustInfo> block as the tool does not contain an updated schema to validate the XML against.</span></span> <span data-ttu-id="49b74-283">Para solucionar esta advertencia, se recomienda reemplazar todos los archivos mt.exe en el directorio de instalación de Visual Studio 2005 (hay varias instancias) con las mt.exe proporcionadas en la Windows SDK más reciente.</span><span class="sxs-lookup"><span data-stu-id="49b74-283">To remedy this warning, it is recommended that you replace all mt.exe files under the Visual Studio 2005 install directory (there are multiple instances) with the mt.exe provided in the latest Windows SDK.</span></span>

<span data-ttu-id="49b74-284">A partir de Visual Studio 2008, ahora puede especificar el nivel de ejecución de una aplicación desde el cuadro de diálogo Propiedades del proyecto (Figura 3) o mediante la marca del enlazador/MANIFESTUAC.</span><span class="sxs-lookup"><span data-stu-id="49b74-284">Beginning in Visual Studio 2008, you can now specify an application's execution level from within the project properties dialog (Figure 3), or by using the /MANIFESTUAC linker flag.</span></span> <span data-ttu-id="49b74-285">La configuración de estas opciones hará que Visual Studio 2008 genere automáticamente e inserte un manifiesto con el <trustInfo> bloque adecuado en el archivo ejecutable.</span><span class="sxs-lookup"><span data-stu-id="49b74-285">Setting these options will cause Visual Studio 2008 to auto-generate and embed a manifest with the appropriate <trustInfo> block into the executable.</span></span>

<span data-ttu-id="49b74-286">**Figura 3. Establecer el nivel de ejecución en Visual Studio 2008**</span><span class="sxs-lookup"><span data-stu-id="49b74-286">**Figure 3. Setting the execution level in Visual Studio 2008**</span></span>

![establecer el nivel de ejecución en Visual Studio 2008](images/setting-execution-level-in-vs2008.jpg)

<span data-ttu-id="49b74-288">Todavía es posible incrustar un manifiesto en versiones anteriores de Visual Studio sin la compatibilidad con el manifiesto, pero requiere más trabajo del desarrollador.</span><span class="sxs-lookup"><span data-stu-id="49b74-288">Embedding a manifest in older versions of Visual Studio without manifest support is still possible, but does require more work from the developer.</span></span> <span data-ttu-id="49b74-289">Para ver un ejemplo de cómo hacerlo, examine el proyecto de Visual Studio 2003 incluido en cualquier ejemplo del SDK de DirectX antes de la versión de marzo de 2008.</span><span class="sxs-lookup"><span data-stu-id="49b74-289">For an example on how to do this, please examine the Visual Studio 2003 project included in any sample in the DirectX SDK prior to the March 2008 release.</span></span>

## <a name="uac-compatibility-with-older-games"></a><span data-ttu-id="49b74-290">Compatibilidad de UAC con juegos más antiguos</span><span class="sxs-lookup"><span data-stu-id="49b74-290">UAC Compatibility with Older Games</span></span>

<span data-ttu-id="49b74-291">Si parece que el juego está guardando y cargando un archivo correctamente en el directorio de archivos de programa, pero no hay evidencia de la ión de archivos Windows Vista, cualquier aplicación de 32 bits que no contenga un nivel de ejecución solicitado en su manifiesto se considera una aplicación heredada.</span><span class="sxs-lookup"><span data-stu-id="49b74-291">If your game appears to be saving and loading a file successfully to the Program Files directory, yet no evidence of the file iOn Windows Vista, any 32-bit application that does not contain a requested execution level in its manifest is considered a legacy application.</span></span> <span data-ttu-id="49b74-292">Antes de Windows Vista, la mayoría de las aplicaciones se ejecutaban normalmente por usuarios con privilegios administrativos.</span><span class="sxs-lookup"><span data-stu-id="49b74-292">Prior to Windows Vista, most applications were typically run by users with administrative privileges.</span></span> <span data-ttu-id="49b74-293">Como resultado, estas aplicaciones pueden leer y escribir libremente archivos del sistema y claves del registro, y muchos desarrolladores no realizaron los cambios necesarios para funcionar correctamente en cuentas de usuario limitadas en Windows XP.</span><span class="sxs-lookup"><span data-stu-id="49b74-293">As a result, these applications could freely read and write system files and registry keys, and many developers did not make the changes needed to work properly on Limited User Accounts on Windows XP.</span></span> <span data-ttu-id="49b74-294">Sin embargo, en Windows Vista, estas mismas aplicaciones no funcionarán correctamente debido a privilegios de acceso insuficientes en el nuevo modelo de seguridad, que aplica la ejecución de usuarios estándar para aplicaciones heredadas.</span><span class="sxs-lookup"><span data-stu-id="49b74-294">However on Windows Vista, these same applications would now fail due to insufficient access privileges under the new security model, which enforces standard user execution for legacy applications.</span></span> <span data-ttu-id="49b74-295">Para mitigar el impacto de esto, la virtualización también se agregó a Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="49b74-295">To mitigate the impact of this, virtualization was also added to Windows Vista.</span></span> <span data-ttu-id="49b74-296">La virtualización mantendrá las miles de aplicaciones heredadas que funcionan bien en Windows Vista sin necesidad de que esas aplicaciones tengan privilegios elevados en todo momento, simplemente con el fin de que se realicen correctamente con unas pocas operaciones menores.</span><span class="sxs-lookup"><span data-stu-id="49b74-296">Virtualization will keep thousands of legacy applications working well on Windows Vista without requiring those applications to have elevated privileges at all times simply to succeed at a few minor operations.</span></span> <span data-ttu-id="49b74-297">Si se encuentra, lo más probable es que el juego se esté ejecutando en modo heredado y se haya sometido a la virtualización.</span><span class="sxs-lookup"><span data-stu-id="49b74-297">s found, chances are your game is running in legacy mode and was subjected to virtualization.</span></span>

<span data-ttu-id="49b74-298">La virtualización afecta al sistema de archivos y al registro redirigiendo las escrituras que distinguen el sistema (y las operaciones posteriores del registro o de archivos) a una ubicación por usuario en el perfil del usuario actual.</span><span class="sxs-lookup"><span data-stu-id="49b74-298">Virtualization affects the file system and registry by redirecting system-sensitive writes (and subsequent file or registry operations) to a per-user location within the current user's profile.</span></span> <span data-ttu-id="49b74-299">Por ejemplo, si una aplicación intenta escribir en el siguiente archivo:</span><span class="sxs-lookup"><span data-stu-id="49b74-299">For example, if an application attempts to write to the following file:</span></span>

<dl> <span data-ttu-id="49b74-300">C: \\ archivos de programa nombre de la \\ compañía \\ título \\config.ini</span><span class="sxs-lookup"><span data-stu-id="49b74-300">C:\\Program Files\\Company Name\\Title\\config.ini</span></span>  
</dl>

<span data-ttu-id="49b74-301">la escritura se redirige automáticamente a:</span><span class="sxs-lookup"><span data-stu-id="49b74-301">the write is automatically redirected to:</span></span>

<dl> <span data-ttu-id="49b74-302">C: \\ usuarios \\ nombre de usuario \\ AppData \\ local \\ VirtualStore archivo de programa nombre de la \\ \\ compañía \\ title \\config.ini</span><span class="sxs-lookup"><span data-stu-id="49b74-302">C:\\Users\\user name\\AppData\\Local\\VirtualStore\\Program Files\\Company Name\\Title\\config.ini</span></span>  
</dl>

<span data-ttu-id="49b74-303">Del mismo modo, si una aplicación intenta escribir un valor del registro como el siguiente:</span><span class="sxs-lookup"><span data-stu-id="49b74-303">Likewise, if an application attempts to write a registry value like the following:</span></span>

<dl> <span data-ttu-id="49b74-304">HKEY \_ local \_ Machine \\ software \\ nombre de la compañía \\ title</span><span class="sxs-lookup"><span data-stu-id="49b74-304">HKEY\_LOCAL\_MACHINE\\Software\\Company Name\\Title</span></span>  
</dl>

<span data-ttu-id="49b74-305">en su lugar, se redirigirá a:</span><span class="sxs-lookup"><span data-stu-id="49b74-305">it will be redirected instead to:</span></span>

<dl> <span data-ttu-id="49b74-306">HKEY \_ Current \_ User \\ \\ classes \\ VirtualStore \\ Machine \\ software \\ Company name \\ title</span><span class="sxs-lookup"><span data-stu-id="49b74-306">HKEY\_CURRENT\_USER\\Software\\Classes\\VirtualStore\\MACHINE\\Software\\Company Name\\Title</span></span>  
</dl>

<span data-ttu-id="49b74-307">Solo se puede tener acceso a los archivos y las claves del registro afectados por la virtualización mediante operaciones de archivo y registro desde aplicaciones virtualizadas que se ejecutan como el usuario actual.</span><span class="sxs-lookup"><span data-stu-id="49b74-307">Files and registry keys affected by virtualization are only be accessed by file and registry operations from virtualized applications that are running as the current user.</span></span>

<span data-ttu-id="49b74-308">Sin embargo, hay muchas restricciones en la virtualización.</span><span class="sxs-lookup"><span data-stu-id="49b74-308">However, there are many restrictions to virtualization.</span></span> <span data-ttu-id="49b74-309">Una es que las aplicaciones de 64 bits nunca se ejecutan en el modo heredado para las operaciones de compatibilidad que se someten a la virtualización en las aplicaciones de 32 bits producirán un error en 64 bits.</span><span class="sxs-lookup"><span data-stu-id="49b74-309">One is that 64-bit applications are never run in legacy mode for compatibility   operations subjected to virtualization in 32-bit applications will just fail in 64-bit.</span></span> <span data-ttu-id="49b74-310">Además, si una aplicación heredada que se ejecuta como un usuario estándar intenta escribir cualquier tipo de archivo ejecutable en una ubicación que requiera credenciales administrativas, no se realizará la virtualización y se producirá un error en la escritura.</span><span class="sxs-lookup"><span data-stu-id="49b74-310">Also if a legacy application running as a standard user tries to write any type of executable file to a location that requires administrative credentials, then virtualization will not occur and the write will fail.</span></span>

<span data-ttu-id="49b74-311">**Figura 4. Proceso de virtualización**</span><span class="sxs-lookup"><span data-stu-id="49b74-311">**Figure 4. Virtualization Process**</span></span>

![proceso de virtualización](images/uac-virtualization-process.jpg)

<span data-ttu-id="49b74-313">Cuando una aplicación heredada intenta realizar una operación de lectura en ubicaciones sensibles del sistema en el sistema de archivos o en el registro, primero se busca en las ubicaciones virtuales.</span><span class="sxs-lookup"><span data-stu-id="49b74-313">When a legacy application attempts a read operation on system-sensitive locations in the file system or registry, the virtual locations are searched first.</span></span> <span data-ttu-id="49b74-314">Si no se encuentra el archivo o la clave del registro, el sistema operativo tiene acceso a las ubicaciones predeterminadas del sistema.</span><span class="sxs-lookup"><span data-stu-id="49b74-314">If the file or registry key is not found, then the operating system accesses the default system locations.</span></span>

<span data-ttu-id="49b74-315">La virtualización se quitará de las versiones posteriores de Windows, por lo que es importante no confiar en esta característica.</span><span class="sxs-lookup"><span data-stu-id="49b74-315">Virtualization will be removed from subsequent versions of Windows so it important not to rely on this feature.</span></span> <span data-ttu-id="49b74-316">En su lugar, debe configurar explícitamente el manifiesto de aplicación para los privilegios de usuario estándar o de administrador, ya que esto deshabilitará la virtualización.</span><span class="sxs-lookup"><span data-stu-id="49b74-316">Instead, you should explicitly configure your application manifest for either standard user or administrative privileges, as this will disable virtualization.</span></span> <span data-ttu-id="49b74-317">La virtualización tampoco es obvia para los usuarios finales, por lo que, aunque la virtualización puede permitir que la aplicación se ejecute, puede generar llamadas de soporte técnico y dificultar la toma de problemas para estos clientes.</span><span class="sxs-lookup"><span data-stu-id="49b74-317">Virtualization is also not obvious to end users, so even though virtualization may allow your application to run, it can generate support calls and make it difficult to trouble-shoot for these customers.</span></span>

<span data-ttu-id="49b74-318">Tenga en cuenta que si UAC está deshabilitado, la virtualización también está deshabilitada.</span><span class="sxs-lookup"><span data-stu-id="49b74-318">Note that if UAC is disabled, then virtualization is also disabled.</span></span> <span data-ttu-id="49b74-319">Si la virtualización está deshabilitada, las cuentas de usuario estándar se comportan exactamente igual que las cuentas de usuario limitadas en Windows XP, y es posible que las aplicaciones heredadas no funcionen correctamente para los usuarios estándar que, de otro modo, se habrían ejecutado correctamente debido</span><span class="sxs-lookup"><span data-stu-id="49b74-319">If virtualization is disabled, standard user accounts behave exactly like limited user accounts in Windows XP, and legacy applications may not function correctly for standard users that would otherwise have succeeded due to virtualization.</span></span>

## <a name="legacy-scenarios-and-manifests"></a><span data-ttu-id="49b74-320">Escenarios y manifiestos heredados</span><span class="sxs-lookup"><span data-stu-id="49b74-320">Legacy Scenarios and Manifests</span></span>

<span data-ttu-id="49b74-321">Para la mayoría de los escenarios de uso, basta con marcar el archivo. exe con los elementos de manifiesto de UAC correctos y asegurarse de que la aplicación funciona correctamente, ya que un usuario estándar es suficiente para una excelente compatibilidad con UAC.</span><span class="sxs-lookup"><span data-stu-id="49b74-321">For the majority of usage scenarios, simply marking the .exe with the correct UAC manifest elements and ensuring the application works correctly as a Standard User is sufficient for excellent UAC compatibility.</span></span> <span data-ttu-id="49b74-322">La mayoría de los jugadores ejecutan Windows Vista o Windows 7 con el control de cuentas de usuario habilitado.</span><span class="sxs-lookup"><span data-stu-id="49b74-322">Most gamers are running Windows Vista or Windows 7 with User Account Control enabled.</span></span> <span data-ttu-id="49b74-323">En Windows XP y los usuarios de Windows Vista o Windows7 con la característica control de cuentas de usuario deshabilitada, normalmente se ejecutan con cuentas de administrador.</span><span class="sxs-lookup"><span data-stu-id="49b74-323">For Windows XP and users on Windows Vista or Windows7 with the User Account Control feature disabled, they typically run using administrator accounts.</span></span> <span data-ttu-id="49b74-324">Aunque se trata de un modo de funcionamiento menos seguro, normalmente no se encontrará en ningún problema de compatibilidad adicional, aunque como se indicó anteriormente, al deshabilitar UAC se deshabilita también la virtualización.</span><span class="sxs-lookup"><span data-stu-id="49b74-324">While this is a less secure mode of operation, it will generally not run into any additional compatibility issues although as noted above, disabling UAC disables virtualization as well.</span></span>

<span data-ttu-id="49b74-325">Hay un caso especial que merece la pena tener en cuenta cuando el programa se marca como "requireAdministrator" en el manifiesto de UAC.</span><span class="sxs-lookup"><span data-stu-id="49b74-325">There is a special case worth noting when the program is marked as "requireAdministrator" in the UAC manifest.</span></span> <span data-ttu-id="49b74-326">En Windows XP y en Windows Vista o Windows 7 con el control de cuentas de usuario deshabilitado, el sistema omite los elementos de manifiesto de UAC.</span><span class="sxs-lookup"><span data-stu-id="49b74-326">On Windows XP and on Windows Vista or Windows 7 with User Account Control disabled, the UAC manifest elements are ignored by the system.</span></span> <span data-ttu-id="49b74-327">En esta situación, los usuarios con cuentas de administrador siempre ejecutarán todos los programas con derechos de administrador completos y, por tanto, estos programas funcionarán según lo previsto.</span><span class="sxs-lookup"><span data-stu-id="49b74-327">In this situation, users with administrator accounts will always run all programs with full administrator rights, and thus these programs will function as expected.</span></span> <span data-ttu-id="49b74-328">Los usuarios restringidos de Windows XP y los usuarios estándar que se ejecutan en Windows Vista o Windows 7, sin embargo, siempre ejecutarán estos programas con derechos restringidos y se producirá un error en todas las operaciones de nivel de administrador.</span><span class="sxs-lookup"><span data-stu-id="49b74-328">Windows XP Restricted Users and Standard Users running on Windows Vista or Windows 7, however, will always run these programs with restricted rights and all administrator-level operations will fail.</span></span> <span data-ttu-id="49b74-329">Por lo tanto, se recomienda que los programas marcados como "requiretAdministrator" llamen a [**IsUserAnAdmin**](/windows/win32/api/shlobj_core/nf-shlobj_core-isuseranadmin) en el inicio y que aparezca un mensaje de error irrecuperable si devuelve false.</span><span class="sxs-lookup"><span data-stu-id="49b74-329">It is therefore recommended that programs marked as "requiretAdministrator" call [**IsUserAnAdmin**](/windows/win32/api/shlobj_core/nf-shlobj_core-isuseranadmin) on startup, and display a fatal error message if it returns FALSE.</span></span> <span data-ttu-id="49b74-330">En el caso anterior, esto siempre se realizará correctamente, pero proporciona una mejor experiencia de usuario y un mensaje de error claro para esta situación excepcional.</span><span class="sxs-lookup"><span data-stu-id="49b74-330">For the majority scenario above, this will always succeed, but provides a better user experience and a clear error message for this rare situation.</span></span>

## <a name="conclusion"></a><span data-ttu-id="49b74-331">Conclusión</span><span class="sxs-lookup"><span data-stu-id="49b74-331">Conclusion</span></span>

<span data-ttu-id="49b74-332">Como desarrollador de juegos dirigido al entorno multiusuario de Windows, es imperativo diseñar su juego para que funcione de forma eficaz y responsable.</span><span class="sxs-lookup"><span data-stu-id="49b74-332">As a game developer targeting the Windows multi-user environment, it is imperative that you design your game to operate effectively and responsibly.</span></span> <span data-ttu-id="49b74-333">El archivo ejecutable principal del juego no debe depender de los privilegios administrativos.</span><span class="sxs-lookup"><span data-stu-id="49b74-333">Your game's main executable file should not be dependent on administrative privileges.</span></span> <span data-ttu-id="49b74-334">Esto no solo evita la aparición de mensajes de elevación cada vez que se ejecuta el juego, lo que puede afectar negativamente a la experiencia global del usuario, pero también permite que el juego aproveche otras características que requieren la ejecución con privilegios de usuario estándar, como el control parental.</span><span class="sxs-lookup"><span data-stu-id="49b74-334">This not only prevents the appearance of prompts for elevation every time that your game is run   which can negatively impact the overall user experience   but it also enables your game to take advantage of other features that require execution with standard user privileges, such as Parental Controls.</span></span>

<span data-ttu-id="49b74-335">Las aplicaciones que están diseñadas correctamente para funcionar como con las credenciales de un usuario estándar (o un usuario limitado) en versiones anteriores de Windows no se verán afectadas por UAC y se ejecutarán sin elevación.</span><span class="sxs-lookup"><span data-stu-id="49b74-335">Applications that are properly designed to operate as with the credentials of a standard user (or limited user) under previous versions of Windows will not be impacted by UAC   they will run without elevation.</span></span> <span data-ttu-id="49b74-336">Sin embargo, deben incluir un manifiesto con el nivel de ejecución solicitado establecido en "AsInvoker" para cumplir con los estándares de aplicación de vista.</span><span class="sxs-lookup"><span data-stu-id="49b74-336">However, they should include a manifest with their requested execution level set to "asInvoker" to conform to application standards for Vista.</span></span>

## <a name="further-reading"></a><span data-ttu-id="49b74-337">Lecturas adicionales</span><span class="sxs-lookup"><span data-stu-id="49b74-337">Further Reading</span></span>

<span data-ttu-id="49b74-338">Para obtener ayuda con el diseño de aplicaciones para Windows Vista que son compatibles con el control de cuentas de usuario, descargue las notas del producto siguientes: [requisitos de desarrollo de aplicaciones de Windows Vista para la compatibilidad con el control de cuentas de usuario](/previous-versions/dotnet/articles/bb530410(v=msdn.10)).</span><span class="sxs-lookup"><span data-stu-id="49b74-338">For assistance with designing applications for Windows Vista that are compliant with User Account Control, download the following white paper: [Windows Vista Application Development Requirements for User Account Control Compatibility](/previous-versions/dotnet/articles/bb530410(v=msdn.10)).</span></span>

<span data-ttu-id="49b74-339">En estas notas del producto se proporcionan pasos detallados sobre el proceso de diseño, junto con ejemplos de código, requisitos y prácticas recomendadas.</span><span class="sxs-lookup"><span data-stu-id="49b74-339">This white paper provides detailed steps about the design process, along with code samples, requirements, and best practices.</span></span> <span data-ttu-id="49b74-340">En este documento también se detallan las actualizaciones técnicas y los cambios en la experiencia del usuario en Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="49b74-340">This paper also details the technical updates and changes to the user experience in Windows Vista.</span></span>

<span data-ttu-id="49b74-341">Para obtener más información acerca del control de cuentas de usuario, visite [Windows Vista: control de cuentas de usuario](https://www.microsoft.com/technet/windowsvista/security/uac.mspx) en [Microsoft TechNet](https://www.microsoft.com/technet/).</span><span class="sxs-lookup"><span data-stu-id="49b74-341">For more information about User Account Control, visit [Windows Vista: User Account Control](https://www.microsoft.com/technet/windowsvista/security/uac.mspx) on [Microsoft TechNet](https://www.microsoft.com/technet/).</span></span>

<span data-ttu-id="49b74-342">Otro recurso útil es el artículo [que enseña a las aplicaciones a jugar bien con el control de cuentas de usuario de Windows Vista](/archive/msdn-magazine/2007/january/teach-your-apps-to-work-with-windows-vista-user-account-control), desde [MSDN Magazine](/archive/msdn-magazine/msdn-magazine-issues), el 2007 de enero.</span><span class="sxs-lookup"><span data-stu-id="49b74-342">Another useful resource is the article [Teach Your Apps To Play Nicely with Windows Vista User Account Control](/archive/msdn-magazine/2007/january/teach-your-apps-to-work-with-windows-vista-user-account-control), from [MSDN Magazine](/archive/msdn-magazine/msdn-magazine-issues), January 2007.</span></span> <span data-ttu-id="49b74-343">En este artículo se describen los problemas generales de compatibilidad de aplicaciones, así como las ventajas y los problemas del uso de paquetes de Windows Installer en Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="49b74-343">This article discusses general issues of application compatibility, as well as the advantages and issues of using Windows Installer packages on Windows Vista.</span></span>

<span data-ttu-id="49b74-344">Para obtener más información sobre el error y la corrección de mt.exe, la herramienta usada por Visual Studio 2005 para combinar e incrustar automáticamente un manifiesto en un archivo ejecutable, vea [explorar manifiestos, parte 2: espacios de nombres predeterminados y manifiestos de UAC en Windows Vista](https://techcommunity.microsoft.com/t5/Windows-Blog-Archive/bg-p/Windows-Blog-Archive/2006/09/08/exploring-manifests-part-2-default-namespaces-and-uac-manifests-in-windows-vista/) en el blog de Chris Jackson en [MSDN](/archive/blogs/).</span><span class="sxs-lookup"><span data-stu-id="49b74-344">For more information about the bug and the fix for mt.exe, the tool used by Visual Studio 2005 to automatically merge and embed a manifest into an executable, see [Exploring Manifests Part 2: Default Namespaces and UAC Manifests in Windows Vista](https://techcommunity.microsoft.com/t5/Windows-Blog-Archive/bg-p/Windows-Blog-Archive/2006/09/08/exploring-manifests-part-2-default-namespaces-and-uac-manifests-in-windows-vista/) on Chris Jackson's blog on [MSDN](/archive/blogs/).</span></span>

 

