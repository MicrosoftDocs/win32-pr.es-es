---
description: Puede agregar información de localización a una base de datos de instalación mediante un editor de tablas de base de datos como orca que se proporciona con el SDK de Windows Installer o mediante una llamada a las funciones de base de datos desde una aplicación.
ms.assetid: cc1eb336-5dec-40cc-8aa5-564cd167855d
title: Control de páginas de códigos de cadenas de parámetros
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 22a52872472d5509e1abdf35aa12be5afb6a8d13
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104275669"
---
# <a name="code-page-handling-of-parameter-strings"></a><span data-ttu-id="a45fe-103">Control de páginas de códigos de cadenas de parámetros</span><span class="sxs-lookup"><span data-stu-id="a45fe-103">Code Page Handling of Parameter Strings</span></span>

<span data-ttu-id="a45fe-104">Puede agregar información de localización a una base de datos de instalación mediante un editor de tablas de base de datos como orca que se proporciona con el SDK de Windows Installer o mediante una llamada a las [funciones de base de datos](database-functions.md) desde una aplicación.</span><span class="sxs-lookup"><span data-stu-id="a45fe-104">You can add localization information to an installation database by using a database table editor such as Orca that is provided with the Windows Installer SDK, or by calling the [Database Functions](database-functions.md) from an application.</span></span> <span data-ttu-id="a45fe-105">Tenga cuidado de pasar solo los parámetros de cadena que usan la página de códigos de la base de datos que se va a localizar.</span><span class="sxs-lookup"><span data-stu-id="a45fe-105">Be careful to only pass string parameters that use the code page of the database that is being localized.</span></span> <span data-ttu-id="a45fe-106">Si un parámetro de cadena contiene caracteres que no se pueden representar mediante la página de códigos de la base de datos, el instalador devuelve un error al llamar a [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span><span class="sxs-lookup"><span data-stu-id="a45fe-106">If a string parameter contains characters that cannot be represented by the code page of the database, the Installer returns an error when calling [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span></span> <span data-ttu-id="a45fe-107">Para obtener una lista de páginas de códigos numéricas, consulte [localizar las tablas de error y ActionText](localizing-the-error-and-actiontext-tables.md).</span><span class="sxs-lookup"><span data-stu-id="a45fe-107">For a list of numeric code pages, see [Localizing the Error and ActionText Tables](localizing-the-error-and-actiontext-tables.md).</span></span>

<span data-ttu-id="a45fe-108">Para obtener más información, vea [determinar la página de códigos de una base de datos de instalación](determining-an-installation-database-s-code-page.md).</span><span class="sxs-lookup"><span data-stu-id="a45fe-108">For more information, see [Determining an Installation Database's Code Page](determining-an-installation-database-s-code-page.md).</span></span>

## <a name="adding-localization-information-to-a-database"></a><span data-ttu-id="a45fe-109">Agregar información de localización a una base de datos</span><span class="sxs-lookup"><span data-stu-id="a45fe-109">Adding Localization Information to a Database</span></span>

<span data-ttu-id="a45fe-110">Al agregar información de localización a una base de datos, la página de códigos de la base de datos debe ser compatible con el sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="a45fe-110">When you add localization information to a database, the code page of the database must be supported by the operating system.</span></span> <span data-ttu-id="a45fe-111">No tiene que ser la página de códigos actual del sistema.</span><span class="sxs-lookup"><span data-stu-id="a45fe-111">It does not have to be the current code page of the system.</span></span> <span data-ttu-id="a45fe-112">[**IsValidCodePage**](/windows/desktop/api/winnls/nf-winnls-isvalidcodepage) debe devolver **true** para la página de códigos de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="a45fe-112">[**IsValidCodePage**](/windows/desktop/api/winnls/nf-winnls-isvalidcodepage) must return **TRUE** for the database code page.</span></span> <span data-ttu-id="a45fe-113">Dado que el sistema convierte las cadenas ANSI en Unicode, se produce un error si la página de códigos del usuario actual no es igual que la página de códigos de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="a45fe-113">Because the system converts ANSI strings to Unicode, there is an error if the current user code page is not the same as the database code page.</span></span>

<span data-ttu-id="a45fe-114">La llamada a la versión ANSI de la API de Windows Installer convierte la cadena traducida en Unicode mediante la página de códigos del sistema actual.</span><span class="sxs-lookup"><span data-stu-id="a45fe-114">Calling the ANSI version of the Windows Installer API converts the localized string to Unicode by using the current system code page.</span></span> <span data-ttu-id="a45fe-115">Cuando se confirma la base de datos, la cadena Unicode se convierte en ANSI mediante la página de códigos de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="a45fe-115">When the database is committed, the Unicode string is converted to ANSI using the code page of the database.</span></span> <span data-ttu-id="a45fe-116">Si la página de códigos del sistema actual difiere de la página de códigos de la cadena localizada, el resultado puede ser una pérdida de datos y una conversión de cadena incorrecta.</span><span class="sxs-lookup"><span data-stu-id="a45fe-116">If the current system code page differs from the code page of the localized string, the result can be a loss of data and incorrect string conversion.</span></span>

<span data-ttu-id="a45fe-117">En el procedimiento siguiente se muestra cómo almacenar los datos de localización.</span><span class="sxs-lookup"><span data-stu-id="a45fe-117">The following procedure shows you how to store the localization data.</span></span>

<span data-ttu-id="a45fe-118">**Para almacenar datos de localización**</span><span class="sxs-lookup"><span data-stu-id="a45fe-118">**To store localization data**</span></span>

1.  <span data-ttu-id="a45fe-119">Establezca la página de códigos de la base de datos en la página de códigos de la cadena localizada.</span><span class="sxs-lookup"><span data-stu-id="a45fe-119">Set the code page of the database to the code page of the localized string.</span></span>
2.  <span data-ttu-id="a45fe-120">Convierta la cadena ANSI en Unicode mediante la función [**MultiByteToWideChar**](/windows/desktop/api/stringapiset/nf-stringapiset-multibytetowidechar) y especifique la página de códigos de los datos localizados.</span><span class="sxs-lookup"><span data-stu-id="a45fe-120">Convert the ANSI string to Unicode by using the [**MultiByteToWideChar**](/windows/desktop/api/stringapiset/nf-stringapiset-multibytetowidechar) function, and specify the code page of the localized data.</span></span>
3.  <span data-ttu-id="a45fe-121">Llame a la versión Unicode de la API de Windows Installer mediante la cadena Unicode para agregar los datos localizados.</span><span class="sxs-lookup"><span data-stu-id="a45fe-121">Call the Unicode version of the Windows Installer API by using the Unicode string to add the localized data.</span></span>
4.  <span data-ttu-id="a45fe-122">Confirme los cambios de localización en la base de datos mediante [**MsiDatabaseCommit**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit).</span><span class="sxs-lookup"><span data-stu-id="a45fe-122">Commit the localization changes to the database by using [**MsiDatabaseCommit**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit).</span></span>

<span data-ttu-id="a45fe-123">También puede agregar información de localización a una base de datos de instalación importando y exportando archivos de archivo de texto ASCII.</span><span class="sxs-lookup"><span data-stu-id="a45fe-123">You can also add localization information to an installation database by importing and exporting ASCII text archive files.</span></span> <span data-ttu-id="a45fe-124">Para obtener más información, vea [control de páginas de códigos de tablas importadas y exportadas](code-page-handling-of-imported-and-exported-tables.md).</span><span class="sxs-lookup"><span data-stu-id="a45fe-124">For more information, see [Code Page Handling of Imported and Exported Tables](code-page-handling-of-imported-and-exported-tables.md).</span></span>

 

 
