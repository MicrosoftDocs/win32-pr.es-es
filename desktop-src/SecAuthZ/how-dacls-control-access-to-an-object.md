---
description: Cuando un subproceso intenta tener acceso a un objeto protegible, el sistema concede o deniega el acceso.
ms.assetid: dc98b23e-ce42-4d4a-a285-c0b7b5e2a478
title: Cómo funciona AccessCheck
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 730cc8f63e7d69bf4cb38344f5eda60861d08a9f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "104553113"
---
# <a name="how-accesscheck-works"></a><span data-ttu-id="530f9-103">Cómo funciona AccessCheck</span><span class="sxs-lookup"><span data-stu-id="530f9-103">How AccessCheck Works</span></span>

<span data-ttu-id="530f9-104">Cuando un subproceso intenta tener acceso a un objeto protegible, el sistema concede o deniega el acceso.</span><span class="sxs-lookup"><span data-stu-id="530f9-104">When a thread tries to access a securable object, the system either grants or denies access.</span></span> <span data-ttu-id="530f9-105">Si el objeto no tiene una [*lista de control de acceso discrecional*](/windows/desktop/SecGloss/d-gly) (DACL), el sistema concede acceso; de lo contrario, el sistema busca [entradas de Access Control](access-control-entries.md) (ACE) en la DACL del objeto que se aplican al subproceso.</span><span class="sxs-lookup"><span data-stu-id="530f9-105">If the object does not have a [*discretionary access control list*](/windows/desktop/SecGloss/d-gly) (DACL), the system grants access; otherwise, the system looks for [Access Control Entries](access-control-entries.md) (ACEs) in the object's DACL that apply to the thread.</span></span> <span data-ttu-id="530f9-106">Cada ACE de la DACL del objeto especifica los derechos de acceso permitidos o denegados para un [Administrador de confianza](trustees.md), que puede ser una cuenta de usuario, una cuenta de grupo o una [*sesión de inicio*](/windows/desktop/SecGloss/l-gly)de sesión.</span><span class="sxs-lookup"><span data-stu-id="530f9-106">Each ACE in the object's DACL specifies the access rights allowed or denied for a [trustee](trustees.md), which can be a user account, a group account, or a [*logon session*](/windows/desktop/SecGloss/l-gly).</span></span>

## <a name="dacls"></a><span data-ttu-id="530f9-107">DACL</span><span class="sxs-lookup"><span data-stu-id="530f9-107">DACLs</span></span>

<span data-ttu-id="530f9-108">El sistema compara el administrador de confianza de cada ACE con los que confían identificados en el [token de acceso](access-tokens.md)del subproceso.</span><span class="sxs-lookup"><span data-stu-id="530f9-108">The system compares the trustee in each ACE to the trustees identified in the thread's [access token](access-tokens.md).</span></span> <span data-ttu-id="530f9-109">Un token de acceso contiene los [*identificadores de seguridad*](/windows/desktop/SecGloss/s-gly) (SID) que identifican al usuario y a las cuentas de grupo a las que pertenece el usuario.</span><span class="sxs-lookup"><span data-stu-id="530f9-109">An access token contains [*security identifiers*](/windows/desktop/SecGloss/s-gly) (SIDs) that identify the user and the group accounts to which the user belongs.</span></span> <span data-ttu-id="530f9-110">Un token también contiene un [*SID de inicio de sesión*](/windows/desktop/SecGloss/l-gly) que identifica la sesión de inicio de sesión actual.</span><span class="sxs-lookup"><span data-stu-id="530f9-110">A token also contains a [*logon SID*](/windows/desktop/SecGloss/l-gly) that identifies the current logon session.</span></span> <span data-ttu-id="530f9-111">Durante una comprobación de acceso, el sistema omite los SID de grupo que no están habilitados.</span><span class="sxs-lookup"><span data-stu-id="530f9-111">During an access check, the system ignores group SIDs that are not enabled.</span></span> <span data-ttu-id="530f9-112">Para obtener más información sobre los SID habilitados, deshabilitados y de solo denegación, consulte [atributos de SID en un token de acceso](sid-attributes-in-an-access-token.md).</span><span class="sxs-lookup"><span data-stu-id="530f9-112">For more information on enabled, disabled, and deny-only SIDs, see [SID Attributes in an Access Token](sid-attributes-in-an-access-token.md).</span></span>

<span data-ttu-id="530f9-113">Normalmente, el sistema utiliza el [*token de acceso principal*](/windows/desktop/SecGloss/p-gly) del subproceso que solicita acceso.</span><span class="sxs-lookup"><span data-stu-id="530f9-113">Typically, the system uses the [*primary access token*](/windows/desktop/SecGloss/p-gly) of the thread that is requesting access.</span></span> <span data-ttu-id="530f9-114">Sin embargo, si el subproceso está suplantando a otro usuario, el sistema utiliza el [*token de suplantación*](/windows/desktop/SecGloss/i-gly)del subproceso.</span><span class="sxs-lookup"><span data-stu-id="530f9-114">However, if the thread is impersonating another user, the system uses the thread's [*impersonation token*](/windows/desktop/SecGloss/i-gly).</span></span>

<span data-ttu-id="530f9-115">El sistema examina cada ACE en secuencia hasta que se produce uno de los siguientes eventos:</span><span class="sxs-lookup"><span data-stu-id="530f9-115">The system examines each ACE in sequence until one of the following events occurs:</span></span>

-   <span data-ttu-id="530f9-116">Una ACE de acceso denegado deniega explícitamente cualquiera de los [derechos de acceso](access-rights-and-access-masks.md) solicitados a uno de los que se enumeran en el token de acceso del subproceso.</span><span class="sxs-lookup"><span data-stu-id="530f9-116">An access-denied ACE explicitly denies any of the requested [access rights](access-rights-and-access-masks.md) to one of the trustees listed in the thread's access token.</span></span>
-   <span data-ttu-id="530f9-117">Una o varias ACE de acceso permitido para los confianzas enumerados en el token de acceso del subproceso conceden explícitamente todos los derechos de acceso solicitados.</span><span class="sxs-lookup"><span data-stu-id="530f9-117">One or more access-allowed ACEs for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>
-   <span data-ttu-id="530f9-118">Todas las ACE se han comprobado y todavía hay al menos un derecho de acceso solicitado que no se ha permitido explícitamente, en cuyo caso el acceso se deniega implícitamente.</span><span class="sxs-lookup"><span data-stu-id="530f9-118">All ACEs have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>

<span data-ttu-id="530f9-119">En la ilustración siguiente se muestra cómo la DACL de un objeto puede permitir el acceso a un subproceso a la vez que se deniega el acceso a otro.</span><span class="sxs-lookup"><span data-stu-id="530f9-119">The following illustration shows how an object's DACL can allow access to one thread while denying access to another.</span></span>

![DACL que concede derechos de acceso diferentes a distintos subprocesos](images/accctrl1.png)

<span data-ttu-id="530f9-121">En el caso del subproceso A, el sistema lee ACE 1 y deniega inmediatamente el acceso porque la ACE de acceso denegado se aplica al usuario en el token de acceso del subproceso.</span><span class="sxs-lookup"><span data-stu-id="530f9-121">For Thread A, the system reads ACE 1 and immediately denies access because the access-denied ACE applies to the user in the thread's access token.</span></span> <span data-ttu-id="530f9-122">En este caso, el sistema no comprueba las ACE 2 y 3.</span><span class="sxs-lookup"><span data-stu-id="530f9-122">In this case, the system does not check ACEs 2 and 3.</span></span> <span data-ttu-id="530f9-123">En el caso del subproceso B, ACE 1 no es aplicable, por lo que el sistema continúa con ACE 2, que permite el acceso de escritura y ACE 3, que permite el acceso de lectura y ejecución.</span><span class="sxs-lookup"><span data-stu-id="530f9-123">For Thread B, ACE 1 does not apply, so the system proceeds to ACE 2, which allows write access, and ACE 3 which allows read and execute access.</span></span>

<span data-ttu-id="530f9-124">Dado que el sistema detiene la comprobación de ACE cuando se concede o se deniega explícitamente el acceso solicitado, es importante el orden de las ACE en una DACL.</span><span class="sxs-lookup"><span data-stu-id="530f9-124">Because the system stops checking ACEs when the requested access is explicitly granted or denied, the order of ACEs in a DACL is important.</span></span> <span data-ttu-id="530f9-125">Tenga en cuenta que si el orden de ACE era diferente en el ejemplo, el sistema podría haber concedido acceso al subproceso a. En el caso de los objetos del sistema, el sistema operativo define el [orden preferido de las ACE en una DACL](order-of-aces-in-a-dacl.md).</span><span class="sxs-lookup"><span data-stu-id="530f9-125">Note that if the ACE order were different in the example, the system might have granted access to Thread A. For system objects, the operating system defines a preferred [order of ACEs in a DACL](order-of-aces-in-a-dacl.md).</span></span>

 

 
