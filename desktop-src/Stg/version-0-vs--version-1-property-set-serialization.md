---
title: Serialización de conjunto de propiedades
description: Hay dos versiones del formato de serialización del conjunto de propiedades.
ms.assetid: 10544118-5e80-47e2-b75b-c1a43be15b2e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 49c635728e169cdddb20437323a49a18496b3459
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104271292"
---
# <a name="property-set-serialization"></a><span data-ttu-id="f48e8-103">Serialización de conjunto de propiedades</span><span class="sxs-lookup"><span data-stu-id="f48e8-103">Property Set Serialization</span></span>

<span data-ttu-id="f48e8-104">Hay dos versiones del formato de serialización del conjunto de propiedades.</span><span class="sxs-lookup"><span data-stu-id="f48e8-104">There are two versions of the property set serialization format.</span></span> <span data-ttu-id="f48e8-105">La especificación original describe la versión 0 del formato.</span><span class="sxs-lookup"><span data-stu-id="f48e8-105">The original specification describes version 0 of the format.</span></span> <span data-ttu-id="f48e8-106">Vea [versión de formato](format-version.md) para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="f48e8-106">See [Format Version](format-version.md) for more information.</span></span> <span data-ttu-id="f48e8-107">La versión 1 amplía la versión original.</span><span class="sxs-lookup"><span data-stu-id="f48e8-107">Version 1 extends the original version.</span></span> <span data-ttu-id="f48e8-108">Todos los conjuntos de propiedades de la versión 0 son válidos como conjuntos de propiedades de la versión 1.</span><span class="sxs-lookup"><span data-stu-id="f48e8-108">All version 0 property sets are valid as version 1 property sets.</span></span> <span data-ttu-id="f48e8-109">El campo de **versión de formato** en el encabezado de un conjunto de propiedades serializado indica la versión.</span><span class="sxs-lookup"><span data-stu-id="f48e8-109">The **Format Version** field in the header of a serialized property set indicates the version.</span></span>

<span data-ttu-id="f48e8-110">Los elementos siguientes identifican las diferencias entre los formatos de serialización de los conjuntos de propiedades de las versiones 0 y 1.</span><span class="sxs-lookup"><span data-stu-id="f48e8-110">The following items identify the differences between version 0 and version 1 property set serialization formats.</span></span>

-   <span data-ttu-id="f48e8-111">Compatibilidad con los nuevos valores de **VARTYPE** .</span><span class="sxs-lookup"><span data-stu-id="f48e8-111">Support for new **VARTYPE** values.</span></span> <span data-ttu-id="f48e8-112">Para obtener más información sobre los valores de **VARTYPE** y cómo usarlos, vea el tema [tipos de datos y estructuras de IDispatch]( /previous-versions/ms221600(v=vs.100)) y la estructura [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="f48e8-112">For more information about **VARTYPE** values and how to use them, see the topic [IDispatch Data Types and Structures]( /previous-versions/ms221600(v=vs.100)) and the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

    <span data-ttu-id="f48e8-113">Los siguientes valores de **VARTYPE** no se admiten en los conjuntos de propiedades de la versión 0, pero se admiten en la versión 1:</span><span class="sxs-lookup"><span data-stu-id="f48e8-113">The following **VARTYPE** values are not supported in version 0 property sets, but are supported in version 1:</span></span>

    <span data-ttu-id="f48e8-114">VT \_ I1</span><span class="sxs-lookup"><span data-stu-id="f48e8-114">VT\_I1</span></span>

    <span data-ttu-id="f48e8-115">VT \_ Vector \| VT \_ I1</span><span class="sxs-lookup"><span data-stu-id="f48e8-115">VT\_VECTOR \| VT\_I1</span></span>

    <span data-ttu-id="f48e8-116">VT \_ int</span><span class="sxs-lookup"><span data-stu-id="f48e8-116">VT\_INT</span></span>

    <span data-ttu-id="f48e8-117">VT \_ uint</span><span class="sxs-lookup"><span data-stu-id="f48e8-117">VT\_UINT</span></span>

    <span data-ttu-id="f48e8-118">VT \_ decimal</span><span class="sxs-lookup"><span data-stu-id="f48e8-118">VT\_DECIMAL</span></span>

    <span data-ttu-id="f48e8-119">Además, SafeArray se puede serializar en un conjunto de propiedades.</span><span class="sxs-lookup"><span data-stu-id="f48e8-119">Additionally, SafeArrays can be serialized in a property set.</span></span> <span data-ttu-id="f48e8-120">La presencia de un SafeArray se indica mediante el bit de matriz de VT \_ combinado, mediante una operación de **o** , con los elementos de la matriz en el miembro de **VT** de la estructura [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="f48e8-120">The presence of a SafeArray is indicated by the VT\_ARRAY bit combined, using an **OR** operation, with the array elements in the **vt** member of the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span> <span data-ttu-id="f48e8-121">Por ejemplo, una SafeArray de enteros con signo de 4 bytes tiene un tipo de \_ matriz VT de \| VT \_ I4.</span><span class="sxs-lookup"><span data-stu-id="f48e8-121">For example, a SafeArray of 4-byte signed integers has a type of VT\_ARRAY \| VT\_I4.</span></span>

    <span data-ttu-id="f48e8-122">Los siguientes tipos de elemento son válidos para un SafeArray en un conjunto de propiedades serializadas:</span><span class="sxs-lookup"><span data-stu-id="f48e8-122">The following element types are valid for a SafeArray in a serialized property set:</span></span>



|             |          |             |           |
|-------------|----------|-------------|-----------|
| <span data-ttu-id="f48e8-123">VT \_ I1</span><span class="sxs-lookup"><span data-stu-id="f48e8-123">VT\_I1</span></span>      | <span data-ttu-id="f48e8-124">VT \_ UI1</span><span class="sxs-lookup"><span data-stu-id="f48e8-124">VT\_UI1</span></span>  | <span data-ttu-id="f48e8-125">I2 de VT \_</span><span class="sxs-lookup"><span data-stu-id="f48e8-125">VT\_I2</span></span>      | <span data-ttu-id="f48e8-126">VT \_ UI2</span><span class="sxs-lookup"><span data-stu-id="f48e8-126">VT\_UI2</span></span>   |
| <span data-ttu-id="f48e8-127">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="f48e8-127">VT\_I4</span></span>      | <span data-ttu-id="f48e8-128">VT \_ UI4</span><span class="sxs-lookup"><span data-stu-id="f48e8-128">VT\_UI4</span></span>  | <span data-ttu-id="f48e8-129">VT \_ int</span><span class="sxs-lookup"><span data-stu-id="f48e8-129">VT\_INT</span></span>     | <span data-ttu-id="f48e8-130">VT \_ uint</span><span class="sxs-lookup"><span data-stu-id="f48e8-130">VT\_UINT</span></span>  |
| <span data-ttu-id="f48e8-131">VT \_ R4</span><span class="sxs-lookup"><span data-stu-id="f48e8-131">VT\_R4</span></span>      | <span data-ttu-id="f48e8-132">VT \_ R8</span><span class="sxs-lookup"><span data-stu-id="f48e8-132">VT\_R8</span></span>   | <span data-ttu-id="f48e8-133">VT \_ CY</span><span class="sxs-lookup"><span data-stu-id="f48e8-133">VT\_CY</span></span>      | <span data-ttu-id="f48e8-134">fecha de VT \_</span><span class="sxs-lookup"><span data-stu-id="f48e8-134">VT\_DATE</span></span>  |
| <span data-ttu-id="f48e8-135">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="f48e8-135">VT\_BSTR</span></span>    | <span data-ttu-id="f48e8-136">VT \_ bool</span><span class="sxs-lookup"><span data-stu-id="f48e8-136">VT\_BOOL</span></span> | <span data-ttu-id="f48e8-137">VT \_ decimal</span><span class="sxs-lookup"><span data-stu-id="f48e8-137">VT\_DECIMAL</span></span> | <span data-ttu-id="f48e8-138">ERROR de VT \_</span><span class="sxs-lookup"><span data-stu-id="f48e8-138">VT\_ERROR</span></span> |
| <span data-ttu-id="f48e8-139">VT ( \_ variante)</span><span class="sxs-lookup"><span data-stu-id="f48e8-139">VT\_VARIANT</span></span> |          |             |           |



 

<span data-ttu-id="f48e8-140">Cuando \_ se especifica el tipo de datos de variante de VT, indica que el propio SafeArray contiene estructuras [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="f48e8-140">When the VT\_VARIANT data type is specified, it indicates that the SafeArray itself holds [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structures.</span></span> <span data-ttu-id="f48e8-141">Los tipos de estos elementos deben ser de la lista anterior, salvo que no pueden contener tipos Variant de VT anidados \_ .</span><span class="sxs-lookup"><span data-stu-id="f48e8-141">The types for these elements must be from the preceding list, except they cannot contain nested VT\_VARIANT types.</span></span>

<span data-ttu-id="f48e8-142">Tenga en cuenta que las implementaciones de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) deben poder recuperarse correctamente devolviendo un error cuando se encuentra un nuevo tipo. por ejemplo, VARENUM Types.</span><span class="sxs-lookup"><span data-stu-id="f48e8-142">Note that implementations of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) must be able to recover gracefully by returning an error when a new type is encountered; for example, VARENUM types.</span></span>

-   <span data-ttu-id="f48e8-143">Nombres de propiedad que distinguen mayúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="f48e8-143">Case sensitive property names.</span></span> <span data-ttu-id="f48e8-144">Los nombres de propiedad, por ejemplo los especificados en el método [**IPropertyStorage:: WritePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames) , no distinguen mayúsculas de minúsculas en los conjuntos de propiedades de la versión 0.</span><span class="sxs-lookup"><span data-stu-id="f48e8-144">Property names, for example those specified in the [**IPropertyStorage::WritePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames) method, are not case sensitive in version 0 property sets.</span></span> <span data-ttu-id="f48e8-145">En los conjuntos de propiedades de la versión 1, los nombres de propiedad pueden distinguir entre mayúsculas y minúsculas según el valor de la nueva propiedad de comportamiento.</span><span class="sxs-lookup"><span data-stu-id="f48e8-145">In version 1 property sets, property names can be case-sensitive depending on the value of the new Behavior property.</span></span>

    <span data-ttu-id="f48e8-146">La propiedad Behavior es el ID. de [propiedad 0x80000003](/windows/desktop/Stg/reserved-property-identifiers) con un tipo de VT \_ UI4.</span><span class="sxs-lookup"><span data-stu-id="f48e8-146">The Behavior property is [Property ID 0x80000003](/windows/desktop/Stg/reserved-property-identifiers) with a type of VT\_UI4.</span></span> <span data-ttu-id="f48e8-147">Si se establece el bit más bajo de este valor, los nombres de los conjuntos de propiedades distinguen mayúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="f48e8-147">If the lowest bit of this value is set, the property set names are case sensitive.</span></span> <span data-ttu-id="f48e8-148">Establezca la marca PROPSETFLAG distinguir mayúsculas de \_ minúsculas \_ en el parámetro *GrfFlags* del método [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) para especificar un conjunto de propiedades que distingue mayúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="f48e8-148">Set the PROPSETFLAG\_CASE\_SENSITIVE flag in the *grfFlags* parameter of the [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) method to specify a case-sensitive property set.</span></span>

-   <span data-ttu-id="f48e8-149">Nombres de propiedad largos.</span><span class="sxs-lookup"><span data-stu-id="f48e8-149">Long property names.</span></span> <span data-ttu-id="f48e8-150">Los nombres de propiedad de los conjuntos de propiedades de la versión 0 deben ser menores o iguales a 256 caracteres, incluido el terminador de cadena, para los conjuntos de propiedades de la página de códigos Unicode.</span><span class="sxs-lookup"><span data-stu-id="f48e8-150">Property names for version 0 property sets must be less than or equal to 256 characters, including the string terminator, for property sets in the Unicode code page.</span></span> <span data-ttu-id="f48e8-151">Si no está en la página de códigos Unicode, debe ser inferior a 256 bytes.</span><span class="sxs-lookup"><span data-stu-id="f48e8-151">If not in the Unicode code page, they must be less than 256 bytes.</span></span> <span data-ttu-id="f48e8-152">Por otro lado, los conjuntos de propiedades de la versión 1 pueden tener nombres de propiedad de longitud ilimitada, aunque siguen estando limitados por el límite de tamaño del conjunto de propiedades general de 256 kilobytes (KB).</span><span class="sxs-lookup"><span data-stu-id="f48e8-152">Version 1 property sets, on the other hand, can have property names of unlimited length, although they are still limited by the overall property set size limit of 256 kilobytes (KB).</span></span>

<span data-ttu-id="f48e8-153">Se recomienda que las implementaciones de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) creen y mantengan conjuntos de propiedades de la versión 0 de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="f48e8-153">It is recommended that implementations of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) create and maintain version 0 property sets by default.</span></span> <span data-ttu-id="f48e8-154">Si un llamador solicita posteriormente una característica específica del formato de la versión 1, solo debe actualizarse la versión del conjunto de propiedades.</span><span class="sxs-lookup"><span data-stu-id="f48e8-154">If a caller subsequently requests a feature specific to the version 1 format, only then should the version of the property set be updated.</span></span> <span data-ttu-id="f48e8-155">Por ejemplo, si se escribe una propiedad de tipo VT \_ array o se escribe un nombre de propiedad largo, la implementación debe actualizar el formato del conjunto de propiedades a la versión 1.</span><span class="sxs-lookup"><span data-stu-id="f48e8-155">For example, if a property of type VT\_ARRAY is written or if a long property name is written, then the implementation should update the property set format to version 1.</span></span> <span data-ttu-id="f48e8-156">Una excepción a esta directriz se produce si \_ \_ se especifica el valor de enumeración que distingue entre mayúsculas y minúsculas PROPSETFLAG en la llamada a [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span><span class="sxs-lookup"><span data-stu-id="f48e8-156">One exception to this guideline occurs if the PROPSETFLAG\_CASE\_SENSITIVE enumeration value is specified in the call to [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span></span> <span data-ttu-id="f48e8-157">En este caso, el conjunto de propiedades debe crearse como un conjunto de propiedades de la versión 1.</span><span class="sxs-lookup"><span data-stu-id="f48e8-157">In this case, the property set must be created as a version 1 property set.</span></span>

 

 