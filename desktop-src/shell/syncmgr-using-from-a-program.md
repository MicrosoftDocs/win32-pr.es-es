---
description: Para permitir que la aplicación funcione con el administrador de sincronización, debe implementar un objeto de modelo de objetos componentes (COM) para controlar las notificaciones de sincronización que recibe de SyncMgr.
title: Usar el administrador de sincronización desde un programa
ms.topic: article
ms.date: 05/31/2018
ms.assetid: bf18d493-0fe7-46e7-9686-f7ee75b3039b
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: 9bd5abdc382c82c6c1aafcda3a967337384dc807
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "104546926"
---
# <a name="using-synchronization-manager-from-a-program"></a><span data-ttu-id="54d5b-103">Usar el administrador de sincronización desde un programa</span><span class="sxs-lookup"><span data-stu-id="54d5b-103">Using Synchronization Manager from a Program</span></span>

<span data-ttu-id="54d5b-104">Para permitir que la aplicación funcione con el administrador de sincronización, debe implementar un objeto de modelo de objetos componentes (COM) para controlar las notificaciones de sincronización que recibe de SyncMgr.</span><span class="sxs-lookup"><span data-stu-id="54d5b-104">To enable your application to work with the Synchronization Manager you must implement a Component Object Model (COM) object to handle synchronization notifications that you receive from SyncMgr.</span></span> <span data-ttu-id="54d5b-105">El controlador de la aplicación realiza la sincronización de los elementos que controla.</span><span class="sxs-lookup"><span data-stu-id="54d5b-105">Your application's handler performs the synchronization for the items that you handle.</span></span> <span data-ttu-id="54d5b-106">Se incluye en el controlador, debe implementar la interfaz [**ISyncMgrSynchronize**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronize) .</span><span class="sxs-lookup"><span data-stu-id="54d5b-106">Included in your handler, you must implement the [**ISyncMgrSynchronize**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronize) interface.</span></span> <span data-ttu-id="54d5b-107">Además, debe proporcionar un objeto de enumerador y [**ISyncMgrEnumItems**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrenumitems) para cualquier elemento independiente que la aplicación pueda sincronizar.</span><span class="sxs-lookup"><span data-stu-id="54d5b-107">Also, you must provide an enumerator object and [**ISyncMgrEnumItems**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrenumitems) for any separate items that your application can synchronize.</span></span>

<span data-ttu-id="54d5b-108">SyncMgr implementa [**ISyncMgrSynchronizeCallback**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrsynchronizecallback) y [**ISyncMgrSynchronizeInvoke**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronizeinvoke).</span><span class="sxs-lookup"><span data-stu-id="54d5b-108">SyncMgr implements [**ISyncMgrSynchronizeCallback**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrsynchronizecallback) and [**ISyncMgrSynchronizeInvoke**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronizeinvoke).</span></span>

<span data-ttu-id="54d5b-109">SyncMgr llama a los métodos de [**ISyncMgrSynchronize**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronize) para obtener información sobre los elementos que controla la aplicación e información sobre el controlador que se proporciona para sincronizar estos elementos.</span><span class="sxs-lookup"><span data-stu-id="54d5b-109">The SyncMgr calls methods in your [**ISyncMgrSynchronize**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronize) to get information on the items that your application handles and information on the handler that you provide for synchronizing these items.</span></span>

<span data-ttu-id="54d5b-110">En tiempo de ejecución, el proceso de sincronización sigue estos pasos.</span><span class="sxs-lookup"><span data-stu-id="54d5b-110">At runtime, the synchronization process follows these steps.</span></span>

1.  <span data-ttu-id="54d5b-111">SyncMgr notifica a la aplicación que es el momento de que se produzca la sincronización de uno de los elementos que controla la aplicación llamando al método [**ISyncMgrSynchronize:: Initialize**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-initialize) .</span><span class="sxs-lookup"><span data-stu-id="54d5b-111">SyncMgr notifies your application that it is time for synchronization to occur for one of the items that your application handles by calling your [**ISyncMgrSynchronize::Initialize**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-initialize) method.</span></span>
2.  <span data-ttu-id="54d5b-112">SyncMgr llama a [**ISyncMgrSynchronize:: EnumSyncMgrItems**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-enumsyncmgritems) para obtener la interfaz [**ISyncMgrEnumItems**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrenumitems) para los elementos administrados por la aplicación.</span><span class="sxs-lookup"><span data-stu-id="54d5b-112">SyncMgr calls [**ISyncMgrSynchronize::EnumSyncMgrItems**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-enumsyncmgritems) to obtain the [**ISyncMgrEnumItems**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrenumitems) interface for the items handled by your application.</span></span>
3.  <span data-ttu-id="54d5b-113">SyncMgr llama a [**ISyncMgrSynchronize:: SetProgressCallback**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-setprogresscallback) para proporcionar al controlador el puntero de interfaz para la interfaz [**ISyncMgrSynchronizeCallback**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrsynchronizecallback) .</span><span class="sxs-lookup"><span data-stu-id="54d5b-113">SyncMgr calls [**ISyncMgrSynchronize::SetProgressCallback**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-setprogresscallback) to provide your handler with the interface pointer for the [**ISyncMgrSynchronizeCallback**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrsynchronizecallback) interface.</span></span> <span data-ttu-id="54d5b-114">El controlador usa esta interfaz para devolver la llamada a SyncMgr durante la sincronización.</span><span class="sxs-lookup"><span data-stu-id="54d5b-114">Your handler uses this interface to call back to the SyncMgr during synchronization.</span></span>
4.  <span data-ttu-id="54d5b-115">A continuación, SyncMgr llama al método [**ISyncMgrSynchronize::P repareforsync**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-prepareforsync) para dar a su controlador una oportunidad de mostrar cualquier elemento de la interfaz de usuario que sea necesario antes de comenzar la sincronización.</span><span class="sxs-lookup"><span data-stu-id="54d5b-115">SyncMgr then calls your [**ISyncMgrSynchronize::PrepareForSync**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-prepareforsync) method to give your handler a chance to display any user interface element that is necessary before synchronization begins.</span></span> <span data-ttu-id="54d5b-116">Por ejemplo, una aplicación de correo electrónico puede mostrar un cuadro de diálogo de inicio de sesión de usuario.</span><span class="sxs-lookup"><span data-stu-id="54d5b-116">For example, an email application may display a user logon dialog.</span></span>
5.  <span data-ttu-id="54d5b-117">El controlador llama a [**ISyncMgrSynchronizeCallback:: EnableModeless**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronizecallback-enablemodeless) antes y después de mostrar los elementos de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="54d5b-117">Your handler calls [**ISyncMgrSynchronizeCallback::EnableModeless**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronizecallback-enablemodeless) before and after displaying any user interface elements.</span></span> <span data-ttu-id="54d5b-118">El controlador llama a [**ISyncMgrSynchronizeCallback::P repareforsynccompleted**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronizecallback-prepareforsynccompleted) cuando haya terminado.</span><span class="sxs-lookup"><span data-stu-id="54d5b-118">Your handler calls [**ISyncMgrSynchronizeCallback::PrepareForSyncCompleted**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronizecallback-prepareforsynccompleted) when you are done.</span></span>
6.  <span data-ttu-id="54d5b-119">SyncMgr llama al método [**ISyncMgrSynchronize:: Synchronize**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-synchronize) para iniciar la sincronización.</span><span class="sxs-lookup"><span data-stu-id="54d5b-119">SyncMgr calls your [**ISyncMgrSynchronize::Synchronize**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronize-synchronize) method to start the synchronization.</span></span>

<span data-ttu-id="54d5b-120">Durante el proceso de sincronización, SyncMgr sigue llamando a los métodos de la interfaz [**ISyncMgrSynchronize**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronize) .</span><span class="sxs-lookup"><span data-stu-id="54d5b-120">During the synchronization process, SyncMgr continues to call methods in your [**ISyncMgrSynchronize**](/windows/desktop/api/Mobsync/nn-mobsync-isyncmgrsynchronize) interface.</span></span> <span data-ttu-id="54d5b-121">Puede enviar los errores del controlador, el progreso y las notificaciones.</span><span class="sxs-lookup"><span data-stu-id="54d5b-121">It can send your handler errors, progress, and notifications.</span></span> <span data-ttu-id="54d5b-122">También puede enumerar los elementos que controla la aplicación o permite a la aplicación mostrar las propiedades de los elementos.</span><span class="sxs-lookup"><span data-stu-id="54d5b-122">It can also enumerate through the items that your application handles or allow your application to show properties for the items.</span></span>

<span data-ttu-id="54d5b-123">El controlador llama a los métodos de [**ISyncMgrSynchronizeCallback**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrsynchronizecallback) para determinar si se debe omitir un elemento, registrar errores y publicar información de progreso durante el proceso de sincronización.</span><span class="sxs-lookup"><span data-stu-id="54d5b-123">Your handler calls methods in [**ISyncMgrSynchronizeCallback**](/windows/desktop/api/mobsync/nn-mobsync-isyncmgrsynchronizecallback) to determine if an item should be skipped, to log errors, and to post progress information during the synchronization process.</span></span>

<span data-ttu-id="54d5b-124">Para obtener más información, consulte las páginas de referencia relacionadas de las interfaces implicadas.</span><span class="sxs-lookup"><span data-stu-id="54d5b-124">For further information, see the related reference pages for the interfaces involved.</span></span>

<span data-ttu-id="54d5b-125">Cuando se completa la sincronización, el controlador llama a [**ISyncMgrSynchronizeCallback:: SynchronizeCompleted**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronizecallback-synchronizecompleted).</span><span class="sxs-lookup"><span data-stu-id="54d5b-125">When the synchronization is completed, your handler calls [**ISyncMgrSynchronizeCallback::SynchronizeCompleted**](/windows/desktop/api/Mobsync/nf-mobsync-isyncmgrsynchronizecallback-synchronizecompleted).</span></span>

 

 



