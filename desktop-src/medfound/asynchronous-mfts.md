---
description: En este tema se describe el procesamiento asincrónico de datos para transformaciones de Media Foundation (MFTs).
ms.assetid: d438ffae-fc50-454f-8ce4-2d6676500fff
title: MFTs asincrónico
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4a16950cf431eff16f2befb382a77910c49ccb2e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "105705428"
---
# <a name="asynchronous-mfts"></a><span data-ttu-id="86e89-103">MFTs asincrónico</span><span class="sxs-lookup"><span data-stu-id="86e89-103">Asynchronous MFTs</span></span>

<span data-ttu-id="86e89-104">En este tema se describe el procesamiento asincrónico de datos para transformaciones de Media Foundation (MFTs).</span><span class="sxs-lookup"><span data-stu-id="86e89-104">This topic describes asynchronous data processing for Media Foundation transforms (MFTs).</span></span>

> [!Note]  
> <span data-ttu-id="86e89-105">Este tema se aplica a Windows 7 o posterior.</span><span class="sxs-lookup"><span data-stu-id="86e89-105">This topic applies to Windows 7 or later.</span></span>

 

-   [<span data-ttu-id="86e89-106">Acerca de MFTs asincrónicos</span><span class="sxs-lookup"><span data-stu-id="86e89-106">About Asynchronous MFTs</span></span>](#about-asynchronous-mfts)
-   [<span data-ttu-id="86e89-107">Requisitos generales</span><span class="sxs-lookup"><span data-stu-id="86e89-107">General Requirements</span></span>](#general-requirements)
-   [<span data-ttu-id="86e89-108">Eventos</span><span class="sxs-lookup"><span data-stu-id="86e89-108">Events</span></span>](#events)
-   [<span data-ttu-id="86e89-109">ProcessInput</span><span class="sxs-lookup"><span data-stu-id="86e89-109">ProcessInput</span></span>](#processinput)
-   [<span data-ttu-id="86e89-110">ProcessOutput</span><span class="sxs-lookup"><span data-stu-id="86e89-110">ProcessOutput</span></span>](#processoutput)
-   [<span data-ttu-id="86e89-111">Purgando</span><span class="sxs-lookup"><span data-stu-id="86e89-111">Draining</span></span>](#draining)
-   [<span data-ttu-id="86e89-112">Vaciar</span><span class="sxs-lookup"><span data-stu-id="86e89-112">Flushing</span></span>](#flushing)
-   [<span data-ttu-id="86e89-113">Marcadores</span><span class="sxs-lookup"><span data-stu-id="86e89-113">Markers</span></span>](#markers)
-   [<span data-ttu-id="86e89-114">Cambiar formato</span><span class="sxs-lookup"><span data-stu-id="86e89-114">Format Changes</span></span>](#format-changes)
-   [<span data-ttu-id="86e89-115">Atributos</span><span class="sxs-lookup"><span data-stu-id="86e89-115">Attributes</span></span>](#attributes)
-   [<span data-ttu-id="86e89-116">Desbloqueo de MFTs asincrónicos</span><span class="sxs-lookup"><span data-stu-id="86e89-116">Unlocking Asynchronous MFTs</span></span>](#unlocking-asynchronous-mfts)
-   [<span data-ttu-id="86e89-117">Apagar el MFT</span><span class="sxs-lookup"><span data-stu-id="86e89-117">Shutting Down the MFT</span></span>](#shutting-down-the-mft)
-   [<span data-ttu-id="86e89-118">Registro y enumeración</span><span class="sxs-lookup"><span data-stu-id="86e89-118">Registration and Enumeration</span></span>](#registration-and-enumeration)
-   [<span data-ttu-id="86e89-119">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="86e89-119">Related topics</span></span>](#related-topics)

## <a name="about-asynchronous-mfts"></a><span data-ttu-id="86e89-120">Acerca de MFTs asincrónicos</span><span class="sxs-lookup"><span data-stu-id="86e89-120">About Asynchronous MFTs</span></span>

<span data-ttu-id="86e89-121">Cuando MFTs se introdujeron en Windows Vista, la API se diseñó para el procesamiento de datos *sincrónicos* .</span><span class="sxs-lookup"><span data-stu-id="86e89-121">When MFTs were introduced in Windows Vista, the API was designed for *synchronous* data processing.</span></span> <span data-ttu-id="86e89-122">En ese modelo, la MFT siempre está esperando para obtener la entrada o en espera para producir la salida.</span><span class="sxs-lookup"><span data-stu-id="86e89-122">In that model, the MFT is always either waiting to get input, or waiting to produce output.</span></span>

<span data-ttu-id="86e89-123">Considere un descodificador de vídeo típico.</span><span class="sxs-lookup"><span data-stu-id="86e89-123">Consider a typical video decoder.</span></span> <span data-ttu-id="86e89-124">Para obtener un fotograma descodificado, el cliente llama a [**IMFTransform::P rocessoutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput).</span><span class="sxs-lookup"><span data-stu-id="86e89-124">To get a decoded frame, the client calls [**IMFTransform::ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput).</span></span> <span data-ttu-id="86e89-125">Si el descodificador tiene suficientes datos para descodificar un fotograma, **ProcessOutput** se bloquea mientras la MFT descodifica el marco.</span><span class="sxs-lookup"><span data-stu-id="86e89-125">If the decoder has enough data to decode a frame, **ProcessOutput** blocks while the MFT decodes the frame.</span></span> <span data-ttu-id="86e89-126">De lo contrario, **ProcessOutput** devuelve **MF_E_TRANSFORM_NEED_MORE_INPUT**, que indica que el cliente debe llamar a [**IMFTransform::P rocessinput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput).</span><span class="sxs-lookup"><span data-stu-id="86e89-126">Otherwise, **ProcessOutput** returns **MF_E_TRANSFORM_NEED_MORE_INPUT**, indicating that the client should call [**IMFTransform::ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput).</span></span>

<span data-ttu-id="86e89-127">Este modelo funciona bien si el descodificador realiza todas las operaciones de descodificación en un subproceso.</span><span class="sxs-lookup"><span data-stu-id="86e89-127">This model works well if the decoder performs all of its decoding operations on one thread.</span></span> <span data-ttu-id="86e89-128">Pero supongamos que el descodificador usa varios subprocesos para descodificar fotogramas en paralelo.</span><span class="sxs-lookup"><span data-stu-id="86e89-128">But suppose the decoder uses several threads to decode frames in parallel.</span></span> <span data-ttu-id="86e89-129">Para obtener el mejor rendimiento, el descodificador debe recibir una nueva entrada cada vez que un subproceso de descodificación se quede inactivo.</span><span class="sxs-lookup"><span data-stu-id="86e89-129">For the best performance, the decoder should receive new input whenever a decoding thread becomes idle.</span></span> <span data-ttu-id="86e89-130">Pero la velocidad a la que los subprocesos completan las operaciones de descodificación no se alinearán exactamente con las llamadas del cliente a [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) y [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput), lo que da lugar a subprocesos que esperan el trabajo.</span><span class="sxs-lookup"><span data-stu-id="86e89-130">But the rate at which threads complete decoding operations will not align exactly with the client's calls to [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) and [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput), resulting in threads waiting for work.</span></span>

<span data-ttu-id="86e89-131">Windows 7 incluye un procesamiento *asincrónico* basado en eventos para MFTs.</span><span class="sxs-lookup"><span data-stu-id="86e89-131">Windows 7 introduces event-driven, *asynchronous* processing for MFTs.</span></span> <span data-ttu-id="86e89-132">En este modelo, cada vez que la MFT necesita entrada o tiene salida, envía un evento al cliente.</span><span class="sxs-lookup"><span data-stu-id="86e89-132">In this model, whenever the MFT needs input or has output, it sends an event to the client.</span></span>

## <a name="general-requirements"></a><span data-ttu-id="86e89-133">Requisitos generales</span><span class="sxs-lookup"><span data-stu-id="86e89-133">General Requirements</span></span>

<span data-ttu-id="86e89-134">En este tema se describe cómo difieren los MFTs asincrónicos del MFT sincrónico.</span><span class="sxs-lookup"><span data-stu-id="86e89-134">This topic describes how asynchronous MFTs differ from synchronous MFT.</span></span> <span data-ttu-id="86e89-135">Excepto donde se indica en este tema, los dos modelos de procesamiento son los mismos.</span><span class="sxs-lookup"><span data-stu-id="86e89-135">Except where noted in this topic, the two processing models are the same.</span></span> <span data-ttu-id="86e89-136">(En concreto, la negociación de formato es la misma).</span><span class="sxs-lookup"><span data-stu-id="86e89-136">(In particular, format negotiation is the same.)</span></span>

<span data-ttu-id="86e89-137">Un MFT asincrónico debe implementar las interfaces siguientes:</span><span class="sxs-lookup"><span data-stu-id="86e89-137">An asynchronous MFT must implement the following interfaces:</span></span>

-   [<span data-ttu-id="86e89-138">**IMFTransform**</span><span class="sxs-lookup"><span data-stu-id="86e89-138">**IMFTransform**</span></span>](/windows/desktop/api/mftransform/nn-mftransform-imftransform)
-   [<span data-ttu-id="86e89-139">**IMFMediaEventGenerator**</span><span class="sxs-lookup"><span data-stu-id="86e89-139">**IMFMediaEventGenerator**</span></span>](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediaeventgenerator)
-   [<span data-ttu-id="86e89-140">**IMFShutdown**</span><span class="sxs-lookup"><span data-stu-id="86e89-140">**IMFShutdown**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfshutdown)

## <a name="events"></a><span data-ttu-id="86e89-141">Events</span><span class="sxs-lookup"><span data-stu-id="86e89-141">Events</span></span>

<span data-ttu-id="86e89-142">Un MFT asincrónico usa los siguientes eventos para indicar su estado de procesamiento de datos:</span><span class="sxs-lookup"><span data-stu-id="86e89-142">An asynchronous MFT uses the following events to signal its data-processing status:</span></span>



| <span data-ttu-id="86e89-143">Evento</span><span class="sxs-lookup"><span data-stu-id="86e89-143">Event</span></span>                                                    | <span data-ttu-id="86e89-144">Descripción</span><span class="sxs-lookup"><span data-stu-id="86e89-144">Description</span></span>                                                       |
|----------------------------------------------------------|-------------------------------------------------------------------|
| [<span data-ttu-id="86e89-145">METransformNeedInput</span><span class="sxs-lookup"><span data-stu-id="86e89-145">METransformNeedInput</span></span>](metransformneedinput.md)         | <span data-ttu-id="86e89-146">Se envía cuando la MFT puede aceptar más entradas.</span><span class="sxs-lookup"><span data-stu-id="86e89-146">Sent when the MFT can accept more input.</span></span>                          |
| [<span data-ttu-id="86e89-147">METransformHaveOutput</span><span class="sxs-lookup"><span data-stu-id="86e89-147">METransformHaveOutput</span></span>](metransformhaveoutput.md)       | <span data-ttu-id="86e89-148">Se envía cuando la MFT tiene salida.</span><span class="sxs-lookup"><span data-stu-id="86e89-148">Sent when the MFT has output.</span></span>                                     |
| [<span data-ttu-id="86e89-149">METransformDrainComplete</span><span class="sxs-lookup"><span data-stu-id="86e89-149">METransformDrainComplete</span></span>](metransformdraincomplete.md) | <span data-ttu-id="86e89-150">Se envía cuando se completa una operación de purga.</span><span class="sxs-lookup"><span data-stu-id="86e89-150">Sent when a drain operation completes.</span></span> <span data-ttu-id="86e89-151">Vea [purgado](#draining).</span><span class="sxs-lookup"><span data-stu-id="86e89-151">See [Draining](#draining).</span></span> |
| [<span data-ttu-id="86e89-152">METransformMarker</span><span class="sxs-lookup"><span data-stu-id="86e89-152">METransformMarker</span></span>](metransformmarker.md)               | <span data-ttu-id="86e89-153">Se envía cuando un marcador es un proceso.</span><span class="sxs-lookup"><span data-stu-id="86e89-153">Sent when a marker is process.</span></span> <span data-ttu-id="86e89-154">Vea [marcadores](#markers).</span><span class="sxs-lookup"><span data-stu-id="86e89-154">See [Markers](#markers).</span></span>           |



 

<span data-ttu-id="86e89-155">Estos eventos se envían fuera de banda.</span><span class="sxs-lookup"><span data-stu-id="86e89-155">These events are sent out-of-band.</span></span> <span data-ttu-id="86e89-156">Es importante comprender la diferencia entre los eventos en banda y fuera de banda en el contexto de una MFT.</span><span class="sxs-lookup"><span data-stu-id="86e89-156">It is important to understand the difference between in-band and out-of-band events in the context of an MFT.</span></span>

<span data-ttu-id="86e89-157">El diseño de la MFT original admite eventos *en banda* .</span><span class="sxs-lookup"><span data-stu-id="86e89-157">The original MFT design supports *in-band* events.</span></span> <span data-ttu-id="86e89-158">Un evento en banda contiene información sobre el flujo de datos, como información sobre un cambio de formato.</span><span class="sxs-lookup"><span data-stu-id="86e89-158">An in-band event contains information about the data stream, such as information about a format change.</span></span> <span data-ttu-id="86e89-159">El cliente envía eventos en banda a la MFT llamando a [**IMFTransform::P rocessevent**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processevent).</span><span class="sxs-lookup"><span data-stu-id="86e89-159">The client sends in-band events to the MFT by calling [**IMFTransform::ProcessEvent**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processevent).</span></span> <span data-ttu-id="86e89-160">MFT puede enviar eventos en banda de vuelta al cliente en el método [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) .</span><span class="sxs-lookup"><span data-stu-id="86e89-160">The MFT can send in-band events back to the client in the [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) method.</span></span> <span data-ttu-id="86e89-161">(En concreto, los eventos se transmiten en el miembro **pEvents** de la estructura [**MFT_OUTPUT_DATA_BUFFER**](/windows/desktop/api/mftransform/ns-mftransform-mft_output_data_buffer) ).</span><span class="sxs-lookup"><span data-stu-id="86e89-161">(Specifically, events are conveyed in the **pEvents** member of the [**MFT_OUTPUT_DATA_BUFFER**](/windows/desktop/api/mftransform/ns-mftransform-mft_output_data_buffer) structure.)</span></span>

<span data-ttu-id="86e89-162">Una MFT envía eventos fuera de banda a través de la interfaz [**IMFMediaEventGenerator**](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediaeventgenerator) como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="86e89-162">An MFT sends out-of-band events through the [**IMFMediaEventGenerator**](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediaeventgenerator) interface as follows:</span></span>

1.  <span data-ttu-id="86e89-163">MFT implementa la interfaz [**IMFMediaEventGenerator**](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediaeventgenerator) , tal y como se describe en [generadores de eventos multimedia](media-event-generators.md).</span><span class="sxs-lookup"><span data-stu-id="86e89-163">The MFT implements the [**IMFMediaEventGenerator**](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediaeventgenerator) interface, as described in [Media Event Generators](media-event-generators.md).</span></span>
2.  <span data-ttu-id="86e89-164">El cliente llama a **IUnknown:: QueryInterface** en el MFT para la interfaz [**IMFMediaEventGenerator**](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediaeventgenerator) .</span><span class="sxs-lookup"><span data-stu-id="86e89-164">The client calls **IUnknown::QueryInterface** on the MFT for the [**IMFMediaEventGenerator**](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediaeventgenerator) interface.</span></span> <span data-ttu-id="86e89-165">Una MFT asincrónica debe exponer esta interfaz.</span><span class="sxs-lookup"><span data-stu-id="86e89-165">An asynchronous MFT must expose this interface.</span></span> <span data-ttu-id="86e89-166">Los MFTs sincrónicos no deben exponer esta interfaz.</span><span class="sxs-lookup"><span data-stu-id="86e89-166">Synchronous MFTs should not expose this interface.</span></span>
3.  <span data-ttu-id="86e89-167">El cliente llama a [**IMFMediaEventGenerator:: BeginGetEvent**](/windows/desktop/api/mfobjects/nf-mfobjects-imfmediaeventgenerator-begingetevent) y [**IMFMediaEventGenerator:: EndGetEvent**](/windows/desktop/api/mfobjects/nf-mfobjects-imfmediaeventgenerator-endgetevent) para recibir eventos fuera de banda de MFT.</span><span class="sxs-lookup"><span data-stu-id="86e89-167">The client calls [**IMFMediaEventGenerator::BeginGetEvent**](/windows/desktop/api/mfobjects/nf-mfobjects-imfmediaeventgenerator-begingetevent) and [**IMFMediaEventGenerator::EndGetEvent**](/windows/desktop/api/mfobjects/nf-mfobjects-imfmediaeventgenerator-endgetevent) to receive out-of-band events from the MFT.</span></span>

## <a name="processinput"></a><span data-ttu-id="86e89-168">ProcessInput</span><span class="sxs-lookup"><span data-stu-id="86e89-168">ProcessInput</span></span>

<span data-ttu-id="86e89-169">El método [**IMFTransform::P rocessinput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) se modifica de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="86e89-169">The [**IMFTransform::ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) method is modified as follows:</span></span>

1.  <span data-ttu-id="86e89-170">Cuando se inicia el streaming, el cliente envía el mensaje de [**MFT_MESSAGE_NOTIFY_START_OF_STREAM**](mft-message-notify-start-of-stream.md) .</span><span class="sxs-lookup"><span data-stu-id="86e89-170">When streaming starts, the client sends the [**MFT_MESSAGE_NOTIFY_START_OF_STREAM**](mft-message-notify-start-of-stream.md) message.</span></span>
2.  <span data-ttu-id="86e89-171">Durante el streaming, MFT solicita datos mediante el envío de un evento [METransformNeedInput](metransformneedinput.md) .</span><span class="sxs-lookup"><span data-stu-id="86e89-171">During streaming, the MFT requests data by sending an [METransformNeedInput](metransformneedinput.md) event.</span></span> <span data-ttu-id="86e89-172">Los datos del evento son el identificador del flujo.</span><span class="sxs-lookup"><span data-stu-id="86e89-172">The event data is the stream identifier.</span></span>
3.  <span data-ttu-id="86e89-173">Para cada evento [METransformNeedInput](metransformneedinput.md) , el cliente llama a [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) para la secuencia especificada.</span><span class="sxs-lookup"><span data-stu-id="86e89-173">For each [METransformNeedInput](metransformneedinput.md) event, the client calls [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) for the specified stream.</span></span>
4.  <span data-ttu-id="86e89-174">Al final del streaming, el cliente puede llamar a [**ProcessMessage**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processmessage) con el mensaje de [**MFT_MESSAGE_NOTIFY_END_OF_STREAM**](mft-message-notify-end-of-stream.md) .</span><span class="sxs-lookup"><span data-stu-id="86e89-174">At the end of streaming, the client may call [**ProcessMessage**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processmessage) with the [**MFT_MESSAGE_NOTIFY_END_OF_STREAM**](mft-message-notify-end-of-stream.md) message.</span></span>

<span data-ttu-id="86e89-175">Notas de implementación:</span><span class="sxs-lookup"><span data-stu-id="86e89-175">Implementation notes:</span></span>

-   <span data-ttu-id="86e89-176">La MFT no debe enviar ningún evento [METransformNeedInput](metransformneedinput.md) hasta que reciba el mensaje de [**MFT_MESSAGE_NOTIFY_START_OF_STREAM**](mft-message-notify-start-of-stream.md) .</span><span class="sxs-lookup"><span data-stu-id="86e89-176">The MFT must not send any [METransformNeedInput](metransformneedinput.md) events until it receives the [**MFT_MESSAGE_NOTIFY_START_OF_STREAM**](mft-message-notify-start-of-stream.md) message.</span></span>
-   <span data-ttu-id="86e89-177">Durante el streaming, MFT puede enviar eventos [METransformNeedInput](metransformneedinput.md) en cualquier momento.</span><span class="sxs-lookup"><span data-stu-id="86e89-177">During streaming, the MFT may send [METransformNeedInput](metransformneedinput.md) events at any time.</span></span>
-   <span data-ttu-id="86e89-178">La MFT debe mantener un recuento de eventos de [METransformNeedInput](metransformneedinput.md) pendientes.</span><span class="sxs-lookup"><span data-stu-id="86e89-178">The MFT should maintain a count of pending [METransformNeedInput](metransformneedinput.md) events.</span></span> <span data-ttu-id="86e89-179">Cualquier llamada a [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) que no corresponda a un evento METransformNeedInput debe devolver **MF_E_NOTACCEPTING**.</span><span class="sxs-lookup"><span data-stu-id="86e89-179">Any call to [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) that does not correspond to an METransformNeedInput event must return **MF_E_NOTACCEPTING**.</span></span>
-   <span data-ttu-id="86e89-180">Cuando el MFT recibe el mensaje de [**MFT_MESSAGE_NOTIFY_END_OF_STREAM**](mft-message-notify-end-of-stream.md) , restablece el número de eventos pendientes de [METransformNeedInput](metransformneedinput.md) en cero.</span><span class="sxs-lookup"><span data-stu-id="86e89-180">When the MFT receives the [**MFT_MESSAGE_NOTIFY_END_OF_STREAM**](mft-message-notify-end-of-stream.md) message, it resets the count of pending [METransformNeedInput](metransformneedinput.md) events to zero.</span></span>
-   <span data-ttu-id="86e89-181">La MFT no debe enviar ningún evento de [METransformNeedInput](metransformneedinput.md) después de recibir el mensaje de [**MFT_MESSAGE_NOTIFY_END_OF_STREAM**](mft-message-notify-end-of-stream.md) .</span><span class="sxs-lookup"><span data-stu-id="86e89-181">The MFT must not send any [METransformNeedInput](metransformneedinput.md) events after it receives the [**MFT_MESSAGE_NOTIFY_END_OF_STREAM**](mft-message-notify-end-of-stream.md) message.</span></span>
-   <span data-ttu-id="86e89-182">Si se llama a [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) antes de [**MFT_MESSAGE_NOTIFY_START_OF_STREAM**](mft-message-notify-start-of-stream.md) o después de [**MFT_MESSAGE_NOTIFY_END_OF_STREAM**](mft-message-notify-end-of-stream.md), el método debe devolver **MF_E_NOTACCEPTING**.</span><span class="sxs-lookup"><span data-stu-id="86e89-182">If [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) is called before [**MFT_MESSAGE_NOTIFY_START_OF_STREAM**](mft-message-notify-start-of-stream.md) or after [**MFT_MESSAGE_NOTIFY_END_OF_STREAM**](mft-message-notify-end-of-stream.md), the method must return **MF_E_NOTACCEPTING**.</span></span>

## <a name="processoutput"></a><span data-ttu-id="86e89-183">ProcessOutput</span><span class="sxs-lookup"><span data-stu-id="86e89-183">ProcessOutput</span></span>

<span data-ttu-id="86e89-184">El método [**IMFTransform::P rocessoutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) se modifica de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="86e89-184">The [**IMFTransform::ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) method is modified as follows:</span></span>

1.  <span data-ttu-id="86e89-185">Cada vez que la MFT tiene salida, envía un evento [METransformHaveOutput](metransformhaveoutput.md) .</span><span class="sxs-lookup"><span data-stu-id="86e89-185">Whenever the MFT has output, it sends an [METransformHaveOutput](metransformhaveoutput.md) event.</span></span>
2.  <span data-ttu-id="86e89-186">Para cada evento [METransformHaveOutput](metransformhaveoutput.md) , el cliente llama a [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput).</span><span class="sxs-lookup"><span data-stu-id="86e89-186">For each [METransformHaveOutput](metransformhaveoutput.md) event, the client calls [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput).</span></span>

<span data-ttu-id="86e89-187">Notas de implementación:</span><span class="sxs-lookup"><span data-stu-id="86e89-187">Implementation notes:</span></span>

-   <span data-ttu-id="86e89-188">Si el cliente llama a [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) en cualquier otro momento, el método devuelve **E_UNEXPECTED**.</span><span class="sxs-lookup"><span data-stu-id="86e89-188">If the client calls [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) at any other time, the method returns **E_UNEXPECTED**.</span></span>
-   <span data-ttu-id="86e89-189">Una MFT asincrónica nunca debe devolver **MF_E_TRANSFORM_NEED_MORE_INPUT** del método [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) .</span><span class="sxs-lookup"><span data-stu-id="86e89-189">An asynchronous MFT should never return **MF_E_TRANSFORM_NEED_MORE_INPUT** from the [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) method.</span></span> <span data-ttu-id="86e89-190">Si la MFT requiere más entrada, envía un evento [METransformNeedInput](metransformneedinput.md) .</span><span class="sxs-lookup"><span data-stu-id="86e89-190">If the MFT requires more input, it sends an [METransformNeedInput](metransformneedinput.md) event.</span></span>

## <a name="draining"></a><span data-ttu-id="86e89-191">Purgando</span><span class="sxs-lookup"><span data-stu-id="86e89-191">Draining</span></span>

<span data-ttu-id="86e89-192">La purga de una MFT hace que la MFT genere tantas salidas como sea posible desde cualquier dato de entrada que ya se haya enviado.</span><span class="sxs-lookup"><span data-stu-id="86e89-192">Draining an MFT causes the MFT to produce as much output as it can from whatever input data has already been sent.</span></span> <span data-ttu-id="86e89-193">La purga de una MFT asincrónica funciona de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="86e89-193">Draining an asynchronous MFT works as follows:</span></span>

1.  <span data-ttu-id="86e89-194">El cliente envía el mensaje de [**MFT_MESSAGE_COMMAND_DRAIN**](mft-message-command-drain.md) .</span><span class="sxs-lookup"><span data-stu-id="86e89-194">The client sends the [**MFT_MESSAGE_COMMAND_DRAIN**](mft-message-command-drain.md) message.</span></span>
2.  <span data-ttu-id="86e89-195">La MFT sigue enviando eventos [METransformHaveOutput](metransformhaveoutput.md) hasta que no tiene más datos para procesar.</span><span class="sxs-lookup"><span data-stu-id="86e89-195">The MFT continues to send [METransformHaveOutput](metransformhaveoutput.md) events until it has no more data to process.</span></span> <span data-ttu-id="86e89-196">No envía eventos [METransformNeedInput](metransformneedinput.md) durante este tiempo.</span><span class="sxs-lookup"><span data-stu-id="86e89-196">It does not send [METransformNeedInput](metransformneedinput.md) events during this time.</span></span>
3.  <span data-ttu-id="86e89-197">Después de que el MFT envíe el último evento [METransformHaveOutput](metransformhaveoutput.md) , envía un evento [METransformDrainComplete](metransformdraincomplete.md) .</span><span class="sxs-lookup"><span data-stu-id="86e89-197">After the MFT sends the last [METransformHaveOutput](metransformhaveoutput.md) event, it sends an [METransformDrainComplete](metransformdraincomplete.md) event.</span></span>

<span data-ttu-id="86e89-198">Una vez completada la purga, el MFT no envía otro evento [METransformNeedInput](metransformneedinput.md) hasta que recibe un mensaje de [**MFT_MESSAGE_NOTIFY_START_OF_STREAM**](mft-message-notify-start-of-stream.md) del cliente.</span><span class="sxs-lookup"><span data-stu-id="86e89-198">After draining is complete, the MFT does not send another [METransformNeedInput](metransformneedinput.md) event until it receives an [**MFT_MESSAGE_NOTIFY_START_OF_STREAM**](mft-message-notify-start-of-stream.md) message from the client.</span></span>

## <a name="flushing"></a><span data-ttu-id="86e89-199">Vaciar</span><span class="sxs-lookup"><span data-stu-id="86e89-199">Flushing</span></span>

<span data-ttu-id="86e89-200">El cliente puede vaciar la MFT enviando el mensaje de [**MFT_MESSAGE_COMMAND_FLUSH**](mft-message-command-flush.md) .</span><span class="sxs-lookup"><span data-stu-id="86e89-200">The client can flush the MFT by sending the [**MFT_MESSAGE_COMMAND_FLUSH**](mft-message-command-flush.md) message.</span></span> <span data-ttu-id="86e89-201">La MFT quita todos los ejemplos de entrada y salida que contiene.</span><span class="sxs-lookup"><span data-stu-id="86e89-201">The MFT drops all of the input and output samples it is holding.</span></span>

<span data-ttu-id="86e89-202">MFT no envía otro evento [METransformNeedInput](metransformneedinput.md) hasta que recibe un mensaje de [**MFT_MESSAGE_NOTIFY_START_OF_STREAM**](mft-message-notify-start-of-stream.md) del cliente.</span><span class="sxs-lookup"><span data-stu-id="86e89-202">The MFT does not send another [METransformNeedInput](metransformneedinput.md) event until it receives an [**MFT_MESSAGE_NOTIFY_START_OF_STREAM**](mft-message-notify-start-of-stream.md) message from the client.</span></span>

## <a name="markers"></a><span data-ttu-id="86e89-203">Marcadores</span><span class="sxs-lookup"><span data-stu-id="86e89-203">Markers</span></span>

<span data-ttu-id="86e89-204">El cliente puede marcar un punto en la secuencia enviando el mensaje de [**MFT_MESSAGE_COMMAND_MARKER**](mft-message-command-marker.md) .</span><span class="sxs-lookup"><span data-stu-id="86e89-204">The client can mark a point in the stream by sending the [**MFT_MESSAGE_COMMAND_MARKER**](mft-message-command-marker.md) message.</span></span> <span data-ttu-id="86e89-205">La MFT responde de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="86e89-205">The MFT responds as follows:</span></span>

1.  <span data-ttu-id="86e89-206">La MFT genera tantos ejemplos de salida como los datos de entrada existentes, y envía un evento [METransformHaveOutput](metransformhaveoutput.md) para cada ejemplo de salida.</span><span class="sxs-lookup"><span data-stu-id="86e89-206">The MFT generates as many output samples as it can from the existing input data, sending an [METransformHaveOutput](metransformhaveoutput.md) event for each output sample.</span></span>
2.  <span data-ttu-id="86e89-207">Una vez generada la salida, el MFT envía un evento [METransformMarker](metransformmarker.md) .</span><span class="sxs-lookup"><span data-stu-id="86e89-207">After all of the output is generated, the MFT sends an [METransformMarker](metransformmarker.md) event.</span></span> <span data-ttu-id="86e89-208">Este evento se debe enviar después de todos los eventos [METransformHaveOutput](metransformhaveoutput.md) .</span><span class="sxs-lookup"><span data-stu-id="86e89-208">This event must be sent after all of the [METransformHaveOutput](metransformhaveoutput.md) events.</span></span>

<span data-ttu-id="86e89-209">Por ejemplo, supongamos que un descodificador tiene suficientes datos de entrada para generar cuatro ejemplos de salida.</span><span class="sxs-lookup"><span data-stu-id="86e89-209">For example, suppose that a decoder has enough input data to produce four output samples.</span></span> <span data-ttu-id="86e89-210">Si el cliente envía el mensaje de [**MFT_MESSAGE_COMMAND_MARKER**](mft-message-command-marker.md) , la MFT pondrá en cola cuatro eventos [METransformHaveOutput](metransformhaveoutput.md) (uno por ejemplo de salida), seguidos de un evento [METransformMarker](metransformmarker.md) .</span><span class="sxs-lookup"><span data-stu-id="86e89-210">If the client sends the [**MFT_MESSAGE_COMMAND_MARKER**](mft-message-command-marker.md) message, the MFT will queue four [METransformHaveOutput](metransformhaveoutput.md) events (one per output sample), followed by an [METransformMarker](metransformmarker.md) event.</span></span>

<span data-ttu-id="86e89-211">El mensaje de marcador es similar al mensaje de purga.</span><span class="sxs-lookup"><span data-stu-id="86e89-211">The marker message is similar to the drain message.</span></span> <span data-ttu-id="86e89-212">Sin embargo, una purga se considera una interrupción en la secuencia, mientras que un marcador no lo es.</span><span class="sxs-lookup"><span data-stu-id="86e89-212">However, a drain is considered a break in the stream, whereas a marker is not.</span></span> <span data-ttu-id="86e89-213">Los marcadores de purga y tienen las siguientes diferencias.</span><span class="sxs-lookup"><span data-stu-id="86e89-213">Draining and markers have the following differences.</span></span>

<span data-ttu-id="86e89-214">Purgando</span><span class="sxs-lookup"><span data-stu-id="86e89-214">Draining:</span></span>

-   <span data-ttu-id="86e89-215">Durante la purga, el MFT no envía eventos [METransformNeedInput](metransformneedinput.md) .</span><span class="sxs-lookup"><span data-stu-id="86e89-215">While draining, the MFT does not send [METransformNeedInput](metransformneedinput.md) events.</span></span>
-   <span data-ttu-id="86e89-216">La MFT descarta los datos de entrada que no se pueden usar para crear un ejemplo de salida.</span><span class="sxs-lookup"><span data-stu-id="86e89-216">The MFT discards any input data that cannot be used to create an output sample.</span></span>
-   <span data-ttu-id="86e89-217">Algunos MFTs producen un "tail" al final de los datos.</span><span class="sxs-lookup"><span data-stu-id="86e89-217">Some MFTs produce a "tail" at the end of the data.</span></span> <span data-ttu-id="86e89-218">Por ejemplo, los efectos de audio como reverberación o eco generan datos adicionales después de que los datos de entrada se hayan detenido.</span><span class="sxs-lookup"><span data-stu-id="86e89-218">For example, audio effects such as reverb or echo produce extra data after the input data has stopped.</span></span> <span data-ttu-id="86e89-219">Una MFT que genera una cola debe hacerlo al final de una operación de purga.</span><span class="sxs-lookup"><span data-stu-id="86e89-219">An MFT that generates a tail should do so at the end of a drain operation.</span></span>
-   <span data-ttu-id="86e89-220">Una vez finalizada la purga de MFT, marca el siguiente ejemplo de salida con el atributo [**MFSampleExtension_Discontinuity**](mfsampleextension-discontinuity-attribute.md) para indicar una discontinuidad en la secuencia.</span><span class="sxs-lookup"><span data-stu-id="86e89-220">After the MFT has finished draining, it marks the next output sample with the [**MFSampleExtension_Discontinuity**](mfsampleextension-discontinuity-attribute.md) attribute, to indicate a discontinuity in the stream.</span></span>

<span data-ttu-id="86e89-221">Dor</span><span class="sxs-lookup"><span data-stu-id="86e89-221">Marker:</span></span>

-   <span data-ttu-id="86e89-222">La MFT sigue enviando eventos [METransformNeedInput](metransformneedinput.md) antes de enviar el evento de marcador.</span><span class="sxs-lookup"><span data-stu-id="86e89-222">The MFT continues to send [METransformNeedInput](metransformneedinput.md) events before sending the marker event.</span></span>
-   <span data-ttu-id="86e89-223">MFT no descarta ningún dato de entrada.</span><span class="sxs-lookup"><span data-stu-id="86e89-223">The MFT does not discard any input data.</span></span> <span data-ttu-id="86e89-224">Si hay datos parciales, se deben procesar después del punto de marcador.</span><span class="sxs-lookup"><span data-stu-id="86e89-224">If there is partial data, it should be processed after the marker point.</span></span>
-   <span data-ttu-id="86e89-225">La MFT no produce una cola en el punto de marcador.</span><span class="sxs-lookup"><span data-stu-id="86e89-225">The MFT does not produce a tail at the marker point.</span></span>
-   <span data-ttu-id="86e89-226">La MFT no establece la marca de discontinuidad después del punto de marcador.</span><span class="sxs-lookup"><span data-stu-id="86e89-226">The MFT does not set the discontinuity flag after the marker point.</span></span>

## <a name="format-changes"></a><span data-ttu-id="86e89-227">Cambiar formato</span><span class="sxs-lookup"><span data-stu-id="86e89-227">Format Changes</span></span>

<span data-ttu-id="86e89-228">Un MFT asincrónico debe admitir los cambios de formato dinámico, tal y como se describe en [control de los cambios de flujo](handling-stream-changes.md).</span><span class="sxs-lookup"><span data-stu-id="86e89-228">An asynchronous MFT must support dynamic format changes, as described in [Handling Stream Changes](handling-stream-changes.md).</span></span>

## <a name="attributes"></a><span data-ttu-id="86e89-229">Atributos</span><span class="sxs-lookup"><span data-stu-id="86e89-229">Attributes</span></span>

<span data-ttu-id="86e89-230">Un MFT asincrónico debe implementar el método [**IMFTransform:: GetAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getattributes) para devolver un almacén de atributos válido.</span><span class="sxs-lookup"><span data-stu-id="86e89-230">An asynchronous MFT must implement the [**IMFTransform::GetAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getattributes) method to return a valid attribute store.</span></span> <span data-ttu-id="86e89-231">Los siguientes atributos se aplican a MFTs asincrónico:</span><span class="sxs-lookup"><span data-stu-id="86e89-231">The following attributes apply to asynchronous MFTs:</span></span>



| <span data-ttu-id="86e89-232">Atributo</span><span class="sxs-lookup"><span data-stu-id="86e89-232">Attribute</span></span>                                                                                    | <span data-ttu-id="86e89-233">Descripción</span><span class="sxs-lookup"><span data-stu-id="86e89-233">Description</span></span>                                                                                                                       |
|----------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="86e89-234">MF_TRANSFORM_ASYNC</span><span class="sxs-lookup"><span data-stu-id="86e89-234">MF_TRANSFORM_ASYNC</span></span>](mf-transform-async.md)                                               | <span data-ttu-id="86e89-235">MFT debe establecer este atributo en **true** (1).</span><span class="sxs-lookup"><span data-stu-id="86e89-235">The MFT must set this attribute to **TRUE** (1).</span></span> <span data-ttu-id="86e89-236">El cliente puede consultar este atributo para detectar si la MFT es asincrónica.</span><span class="sxs-lookup"><span data-stu-id="86e89-236">The client can query this attribute to discover whether the MFT is asynchronous.</span></span> |
| [<span data-ttu-id="86e89-237">MF_TRANSFORM_ASYNC_UNLOCK</span><span class="sxs-lookup"><span data-stu-id="86e89-237">MF_TRANSFORM_ASYNC_UNLOCK</span></span>](mf-transform-async-unlock.md)                                |                                                                                                                                   |
| [<span data-ttu-id="86e89-238">**MFT_SUPPORT_DYNAMIC_FORMAT_CHANGE**</span><span class="sxs-lookup"><span data-stu-id="86e89-238">**MFT_SUPPORT_DYNAMIC_FORMAT_CHANGE**</span></span>](mft-support-dynamic-format-change-attribute.md) | <span data-ttu-id="86e89-239">MFT debe establecer este atributo en **true** (1).</span><span class="sxs-lookup"><span data-stu-id="86e89-239">The MFT must set this attribute to **TRUE** (1).</span></span> <span data-ttu-id="86e89-240">El cliente puede suponer que este atributo está establecido.</span><span class="sxs-lookup"><span data-stu-id="86e89-240">The client can assume that this attribute is set.</span></span>                                |



 

## <a name="unlocking-asynchronous-mfts"></a><span data-ttu-id="86e89-241">Desbloqueo de MFTs asincrónicos</span><span class="sxs-lookup"><span data-stu-id="86e89-241">Unlocking Asynchronous MFTs</span></span>

<span data-ttu-id="86e89-242">Los MFTs asincrónicos no son compatibles con el modelo de procesamiento de datos de MFT original.</span><span class="sxs-lookup"><span data-stu-id="86e89-242">Asynchronous MFTs are not compatible with the original MFT data processing model.</span></span> <span data-ttu-id="86e89-243">Para evitar que los MFTs asincrónicos interrumpan las aplicaciones existentes, se define el mecanismo siguiente:</span><span class="sxs-lookup"><span data-stu-id="86e89-243">To prevent asynchronous MFTs from breaking existing applications, the following mechanism is defined:</span></span>

<dl> <span data-ttu-id="86e89-244">El cliente llama a <a href="/windows/desktop/api/mftransform/nf-mftransform-imftransform-getattributes">IMFTransform:: GetAttributes</a> en la MFT.</span><span class="sxs-lookup"><span data-stu-id="86e89-244">The client calls <a href="/windows/desktop/api/mftransform/nf-mftransform-imftransform-getattributes">IMFTransform::GetAttributes</a> on the MFT.</span></span>  
<span data-ttu-id="86e89-245">El cliente consulta para este <a href="mf-transform-async.md">MF_TRANSFORM_ASYNC</a> atributo.</span><span class="sxs-lookup"><span data-stu-id="86e89-245">The client queries the for this <a href="mf-transform-async.md">MF_TRANSFORM_ASYNC</a> attribute.</span></span> <span data-ttu-id="86e89-246">En el caso de una MFT asincrónica, el valor de este atributo es **true**.</span><span class="sxs-lookup"><span data-stu-id="86e89-246">For an asynchronous MFT, the value of this attribute is **TRUE**.</span></span>  
<span data-ttu-id="86e89-247">Para desbloquear la MFT, el cliente debe establecer el atributo <a href="mf-transform-async-unlock.md">MF_TRANSFORM_ASYNC_UNLOCK</a> en **true**.</span><span class="sxs-lookup"><span data-stu-id="86e89-247">To unlock the MFT, the client must sets the <a href="mf-transform-async-unlock.md">MF_TRANSFORM_ASYNC_UNLOCK</a> attribute to **TRUE**.</span></span>  
</dl>

<span data-ttu-id="86e89-248">Hasta que el cliente desbloquee la MFT, todos los métodos de [**IMFTransform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform) deben devolver **MF_E_TRANSFORM_ASYNC_LOCKED**, con las siguientes excepciones:</span><span class="sxs-lookup"><span data-stu-id="86e89-248">Until the client unlocks the MFT, all [**IMFTransform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform) methods should return **MF_E_TRANSFORM_ASYNC_LOCKED**, with the following exceptions:</span></span>

-   <span data-ttu-id="86e89-249">[**IMFTransform:: GetAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getattributes) (todos los MFTs asincrónicos)</span><span class="sxs-lookup"><span data-stu-id="86e89-249">[**IMFTransform::GetAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getattributes) (all asynchronous MFTs)</span></span>
-   <span data-ttu-id="86e89-250">[**IMFTransform:: GetInputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getinputavailabletype) (todos los MFTs asincrónicos)</span><span class="sxs-lookup"><span data-stu-id="86e89-250">[**IMFTransform::GetInputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getinputavailabletype) (all asynchronous MFTs)</span></span>
-   <span data-ttu-id="86e89-251">[**IMFTransform:: GetOutputCurrentType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputcurrenttype) (solo codificadores)</span><span class="sxs-lookup"><span data-stu-id="86e89-251">[**IMFTransform::GetOutputCurrentType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputcurrenttype) (encoders only)</span></span>
-   <span data-ttu-id="86e89-252">[**IMFTransform:: SetOutputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setoutputtype) (solo codificadores)</span><span class="sxs-lookup"><span data-stu-id="86e89-252">[**IMFTransform::SetOutputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setoutputtype) (encoders only)</span></span>
-   <span data-ttu-id="86e89-253">[**IMFTransform:: GetStreamCount**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getstreamcount) (todos los MFTs asincrónicos)</span><span class="sxs-lookup"><span data-stu-id="86e89-253">[**IMFTransform::GetStreamCount**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getstreamcount) (all asynchronous MFTs)</span></span>
-   <span data-ttu-id="86e89-254">[**IMFTransform:: GetStreamIDs**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getstreamids) (todos los MFTs asincrónicos)</span><span class="sxs-lookup"><span data-stu-id="86e89-254">[**IMFTransform::GetStreamIDs**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getstreamids) (all asynchronous MFTs)</span></span>

<span data-ttu-id="86e89-255">En el código siguiente se muestra cómo desbloquear una MFT asincrónica:</span><span class="sxs-lookup"><span data-stu-id="86e89-255">The following code shows how to unlock an asynchronous MFT:</span></span>


```C++
HRESULT UnlockAsyncMFT(IMFTransform *pMFT)
{
    IMFAttributes *pAttributes = NULL;

    HRESULT hr = hr = pMFT->GetAttributes(&pAttributes);

    if (SUCCEEDED(hr))
    {
        hr = pAttributes->SetUINT32(MF_TRANSFORM_ASYNC_UNLOCK, TRUE);
        pAttributes->Release();
    }
    
    return hr;
}
```



## <a name="shutting-down-the-mft"></a><span data-ttu-id="86e89-256">Apagar el MFT</span><span class="sxs-lookup"><span data-stu-id="86e89-256">Shutting Down the MFT</span></span>

<span data-ttu-id="86e89-257">Los MFTs asincrónicos deben implementar la interfaz [**IMFShutdown**](/windows/desktop/api/mfidl/nn-mfidl-imfshutdown) .</span><span class="sxs-lookup"><span data-stu-id="86e89-257">Asynchronous MFTs must implement the [**IMFShutdown**](/windows/desktop/api/mfidl/nn-mfidl-imfshutdown) interface.</span></span>

-   <span data-ttu-id="86e89-258">[**Shutdown**](/windows/desktop/api/mfidl/nf-mfidl-imfshutdown-shutdown): la MFT debe apagar su cola de eventos.</span><span class="sxs-lookup"><span data-stu-id="86e89-258">[**Shutdown**](/windows/desktop/api/mfidl/nf-mfidl-imfshutdown-shutdown): The MFT must shut down its event queue.</span></span> <span data-ttu-id="86e89-259">Si usa la cola de eventos estándar, llame a [**IMFMediaEventQueue:: Shutdown**](/windows/desktop/api/mfobjects/nf-mfobjects-imfmediaeventqueue-shutdown).</span><span class="sxs-lookup"><span data-stu-id="86e89-259">If using the standard event queue, call [**IMFMediaEventQueue::Shutdown**](/windows/desktop/api/mfobjects/nf-mfobjects-imfmediaeventqueue-shutdown).</span></span> <span data-ttu-id="86e89-260">Opcionalmente, el MFT puede liberar otros recursos.</span><span class="sxs-lookup"><span data-stu-id="86e89-260">Optionally, the MFT may release other resources.</span></span> <span data-ttu-id="86e89-261">El cliente no debe usar MFT después de llamar a **Shutdown**.</span><span class="sxs-lookup"><span data-stu-id="86e89-261">The client must not use the MFT after calling **Shutdown**.</span></span>
-   <span data-ttu-id="86e89-262">[**GetShutdownStatus**](/windows/desktop/api/mfidl/nf-mfidl-imfshutdown-getshutdownstatus): una vez llamado el [**cierre**](/windows/desktop/api/mfidl/nf-mfidl-imfshutdown-shutdown) , el MFT debe devolver el valor **MFSHUTDOWN_COMPLETED** en el parámetro *pStatus* .</span><span class="sxs-lookup"><span data-stu-id="86e89-262">[**GetShutdownStatus**](/windows/desktop/api/mfidl/nf-mfidl-imfshutdown-getshutdownstatus): After [**Shutdown**](/windows/desktop/api/mfidl/nf-mfidl-imfshutdown-shutdown) has been called, the MFT should return the value **MFSHUTDOWN_COMPLETED** in the *pStatus* parameter.</span></span> <span data-ttu-id="86e89-263">No debe devolver el valor **MFSHUTDOWN_INITIATED**.</span><span class="sxs-lookup"><span data-stu-id="86e89-263">It should not return the value **MFSHUTDOWN_INITIATED**.</span></span>

## <a name="registration-and-enumeration"></a><span data-ttu-id="86e89-264">Registro y enumeración</span><span class="sxs-lookup"><span data-stu-id="86e89-264">Registration and Enumeration</span></span>

<span data-ttu-id="86e89-265">Para registrar un MFT asincrónico, llame a la función [**MFTRegister**](/windows/desktop/api/mfapi/nf-mfapi-mftregister) y establezca la marca **MFT_ENUM_FLAG_ASYNCMFT** en el parámetro *Flags* .</span><span class="sxs-lookup"><span data-stu-id="86e89-265">To register an asynchronous MFT, call the [**MFTRegister**](/windows/desktop/api/mfapi/nf-mfapi-mftregister) function and set the **MFT_ENUM_FLAG_ASYNCMFT** flag in the *Flags* parameter.</span></span> <span data-ttu-id="86e89-266">(Anteriormente se ha reservado esta marca).</span><span class="sxs-lookup"><span data-stu-id="86e89-266">(Previously this flag was reserved.)</span></span>

<span data-ttu-id="86e89-267">Para enumerar MFTs asincrónicos, llame a la función [**MFTEnumEx**](/windows/desktop/api/mfapi/nf-mfapi-mftenumex) y establezca la marca **MFT_ENUM_FLAG_ASYNCMFT** en el parámetro *Flags* .</span><span class="sxs-lookup"><span data-stu-id="86e89-267">To enumerate asynchronous MFTs, call the [**MFTEnumEx**](/windows/desktop/api/mfapi/nf-mfapi-mftenumex) function and set the **MFT_ENUM_FLAG_ASYNCMFT** flag in the *Flags* parameter.</span></span> <span data-ttu-id="86e89-268">Por compatibilidad con versiones anteriores, la función [**MFTEnum**](/windows/desktop/api/mfapi/nf-mfapi-mftenum) no enumera MFTs asincrónico.</span><span class="sxs-lookup"><span data-stu-id="86e89-268">For backward compatibility, the [**MFTEnum**](/windows/desktop/api/mfapi/nf-mfapi-mftenum) function does not enumerate asynchronous MFTs.</span></span> <span data-ttu-id="86e89-269">De lo contrario, la instalación de un MFT asíncrono en el equipo del usuario podría interrumpir las aplicaciones existentes.</span><span class="sxs-lookup"><span data-stu-id="86e89-269">Otherwise, installing an asynchronous MFT on the user's computer could break existing applications.</span></span>

## <a name="related-topics"></a><span data-ttu-id="86e89-270">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="86e89-270">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="86e89-271">Media Foundation transformaciones</span><span class="sxs-lookup"><span data-stu-id="86e89-271">Media Foundation Transforms</span></span>](media-foundation-transforms.md)
</dt> </dl>

 

 



