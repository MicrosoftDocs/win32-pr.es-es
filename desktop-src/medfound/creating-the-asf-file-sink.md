---
description: Obtenga información sobre cómo crear el receptor de archivos ASF, que una aplicación puede usar para archivar datos multimedia de ASF en un archivo.
ms.assetid: 991f3345-a6b4-45c2-a89d-3c13c70b6bbc
title: Creación del receptor de archivos ASF
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6fcd9ea19f0200dfd330f421fd5dac2cd100b702
ms.sourcegitcommit: 5d4e99f4c8f42f5f543e52cb9beb9fb13ec56c5f
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/19/2021
ms.locfileid: "112409928"
---
# <a name="creating-the-asf-file-sink"></a><span data-ttu-id="e2ad7-103">Creación del receptor de archivos ASF</span><span class="sxs-lookup"><span data-stu-id="e2ad7-103">Creating the ASF File Sink</span></span>

<span data-ttu-id="e2ad7-104">El receptor de archivos DE ASF es una implementación de [**IMFMediaSink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) proporcionada por Media Foundation que una aplicación puede usar para archivar datos multimedia de ASF en un archivo.</span><span class="sxs-lookup"><span data-stu-id="e2ad7-104">The ASF file sink is an implementation of [**IMFMediaSink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) provided by Media Foundation that an application can use to archive ASF media data to a file.</span></span> <span data-ttu-id="e2ad7-105">Para obtener información sobre el modelo de objetos de los receptores de medios de ASF y el uso general, vea [Receptores multimedia de ASF.](asf-media-sinks.md)</span><span class="sxs-lookup"><span data-stu-id="e2ad7-105">For information about ASF Media Sinks' object model and general usage, see [ASF Media Sinks](asf-media-sinks.md).</span></span>

<span data-ttu-id="e2ad7-106">Hay dos maneras de crear una instancia del receptor de archivos ASF.</span><span class="sxs-lookup"><span data-stu-id="e2ad7-106">There are two ways of creating an instance of the ASF file sink.</span></span> <span data-ttu-id="e2ad7-107">Puede llamar a [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink) o [**MFCreateASFMediaSinkActivate.**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate)</span><span class="sxs-lookup"><span data-stu-id="e2ad7-107">You can call [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink) or [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate).</span></span>

<span data-ttu-id="e2ad7-108">Si llama a [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink), debe especificar una secuencia de bytes, para el archivo de salida, en la que el receptor escribirá el contenido de ASF durante una sesión de codificación.</span><span class="sxs-lookup"><span data-stu-id="e2ad7-108">If you call [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink), you must specify a byte stream, for the output file, into which the sink will write the ASF content during an encoding session.</span></span> <span data-ttu-id="e2ad7-109">La secuencia de bytes especificada debe tener funcionalidades que se pueden buscar y escribir; de lo contrario, se produce un error en la llamada **a MFCreateASFMediaSink** con el código de error E \_ FAIL.</span><span class="sxs-lookup"><span data-stu-id="e2ad7-109">The specified byte stream must have seekable and writable capabilities otherwise the **MFCreateASFMediaSink** call fails with the E\_FAIL error code.</span></span> <span data-ttu-id="e2ad7-110">Esta llamada crea un objeto de receptor de archivo en proceso y devuelve un puntero a la interfaz [**DE INMEDIASink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) del receptor de archivos.</span><span class="sxs-lookup"><span data-stu-id="e2ad7-110">This call creates an in-process file sink object and returns a pointer to the [**IMFMediaSink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) interface of the file sink.</span></span>

<span data-ttu-id="e2ad7-111">Si llama a [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate), debe especificar la dirección URL del archivo de salida en el que el receptor de archivos escribirá datos multimedia.</span><span class="sxs-lookup"><span data-stu-id="e2ad7-111">If you call [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate), you must specify the URL of the output file into which the file sink will write media data.</span></span> <span data-ttu-id="e2ad7-112">En este caso, el receptor de archivos crea internamente la secuencia de bytes.</span><span class="sxs-lookup"><span data-stu-id="e2ad7-112">In this case, the file sink internally creates the byte stream.</span></span> <span data-ttu-id="e2ad7-113">La función devuelve un puntero a la interfaz [**IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) del receptor de archivos.</span><span class="sxs-lookup"><span data-stu-id="e2ad7-113">The function returns a pointer to the [**IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) interface of the file sink.</span></span> <span data-ttu-id="e2ad7-114">En</span><span class="sxs-lookup"><span data-stu-id="e2ad7-114">To</span></span>

<span data-ttu-id="e2ad7-115">Considere la posibilidad de usar [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate) en lugar de [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink)cuando la topología de codificación esté diseñada de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="e2ad7-115">Consider [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate) instead of [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink), when your encoding topology is designed as follows:</span></span>

-   <span data-ttu-id="e2ad7-116">La topología de codificación es para la ruta de acceso multimedia protegida (PMP) y el receptor de archivos se usa fuera de proceso.</span><span class="sxs-lookup"><span data-stu-id="e2ad7-116">The encoding topology is for the protected media path (PMP) and the file sink is used out-of-process.</span></span>
-   <span data-ttu-id="e2ad7-117">El nodo de salida de la topología se crea mediante el puntero devuelto al objeto activate del receptor de archivos y la aplicación realiza un seguimiento de las secuencias del receptor de archivos mediante números de secuencia.</span><span class="sxs-lookup"><span data-stu-id="e2ad7-117">The output node of the topology is created by using the returned pointer to the activate object of the file sink and your application is keeping track of the streams in the file sink by stream numbers.</span></span>
    > [!Note]  
    > <span data-ttu-id="e2ad7-118">Puede activar el receptor de archivos llamando [**a IMFActivate::ActivateObject**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-activateobject).</span><span class="sxs-lookup"><span data-stu-id="e2ad7-118">You can activate the file sink by calling [**IMFActivate::ActivateObject**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-activateobject).</span></span> <span data-ttu-id="e2ad7-119">Sin embargo, no es necesario activar el objeto de forma explícita.</span><span class="sxs-lookup"><span data-stu-id="e2ad7-119">However you do not need to activate the object explictly.</span></span> <span data-ttu-id="e2ad7-120">La sesión multimedia realiza un seguimiento del objeto de activación y activa el receptor de archivos automáticamente durante la sesión de codificación.</span><span class="sxs-lookup"><span data-stu-id="e2ad7-120">The Media Session keeps track of the activation object and activates the file sink automatically during the encoding session.</span></span>

     

-   <span data-ttu-id="e2ad7-121">La información de secuencia se configura en el objeto ContentInfo.</span><span class="sxs-lookup"><span data-stu-id="e2ad7-121">The stream information is configured in the ContentInfo object.</span></span> <span data-ttu-id="e2ad7-122">Se ha desenlazado en la siguiente subsección.</span><span class="sxs-lookup"><span data-stu-id="e2ad7-122">Disucssed in the next sub-section.</span></span>

<span data-ttu-id="e2ad7-123">Después de crear el receptor de archivos ASF, debe configurarse antes de compilar la topología.</span><span class="sxs-lookup"><span data-stu-id="e2ad7-123">After creating the ASF file sink it must be configured before building the topology.</span></span> <span data-ttu-id="e2ad7-124">El receptor de archivos debe conocer la siguiente información para generar el archivo de salida.</span><span class="sxs-lookup"><span data-stu-id="e2ad7-124">The file sink needs to know the following information in order to generate the output file.</span></span>

-   <span data-ttu-id="e2ad7-125">Información básica del flujo</span><span class="sxs-lookup"><span data-stu-id="e2ad7-125">Basic stream information</span></span>
-   <span data-ttu-id="e2ad7-126">Información del modo de codificación</span><span class="sxs-lookup"><span data-stu-id="e2ad7-126">Encoding mode information</span></span>
-   <span data-ttu-id="e2ad7-127">Metadatos</span><span class="sxs-lookup"><span data-stu-id="e2ad7-127">Metadata</span></span>

<span data-ttu-id="e2ad7-128">El receptor de archivos implementa el objeto ContentInfo de [ASF](asf-contentinfo-object.md) y expone la interfaz [**IMFASFContentInfo**](/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfcontentinfo) para que una aplicación pueda usarla para establecer información relacionada con las secuencias y la codificación.</span><span class="sxs-lookup"><span data-stu-id="e2ad7-128">The file sink implements the [ASF ContentInfo Object](asf-contentinfo-object.md) and exposes the [**IMFASFContentInfo**](/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfcontentinfo) interface so that an application can use it to set information related to the streams and encoding.</span></span> <span data-ttu-id="e2ad7-129">En función de la función a la que llamó para crear el receptor de archivos, hay dos maneras de obtener una referencia a la interfaz **IMFASFContentInfo.**</span><span class="sxs-lookup"><span data-stu-id="e2ad7-129">Depending on the function you called to create the file sink, there are two ways of getting a reference to the **IMFASFContentInfo** interface.</span></span>

-   <span data-ttu-id="e2ad7-130">Si llama a la función [**MFCreateASFMediaSink,**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink) la aplicación debe consultar la interfaz [**MFASFContentInfo**](/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfcontentinfo) llamando a **MFMediaSink::QueryInterface** en el receptor de archivos devuelto.</span><span class="sxs-lookup"><span data-stu-id="e2ad7-130">If you call the [**MFCreateASFMediaSink**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasink) function, the application must query for [**IMFASFContentInfo**](/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfcontentinfo) interface by calling **IMFMediaSink::QueryInterface** on the returned file sink.</span></span>
-   <span data-ttu-id="e2ad7-131">Si decide llamar a [**MFCreateASFMediaSinkActivate,**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate)esta función espera que tenga un objeto ContentInfo totalmente configurado antes de la llamada.</span><span class="sxs-lookup"><span data-stu-id="e2ad7-131">If you choose to call [**MFCreateASFMediaSinkActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfmediasinkactivate), this function expects that you have a fully-configured ContentInfo object prior to the call.</span></span> <span data-ttu-id="e2ad7-132">Para ello, debe crear un objeto ContentInfo vacío mediante una llamada a [**MFCreateASFContentInfo**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfcontentinfo) y, a continuación, configurarlo con toda la información necesaria.</span><span class="sxs-lookup"><span data-stu-id="e2ad7-132">To do this, you need to create an empty ContentInfo object by calling [**MFCreateASFContentInfo**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfcontentinfo) and then configure it with all the required information.</span></span> <span data-ttu-id="e2ad7-133">Pase el objeto ContentInfo configurado a **MFCreateASFMediaSinkActivate** para recibir un puntero al objeto de activación del receptor.</span><span class="sxs-lookup"><span data-stu-id="e2ad7-133">Pass the configured ContentInfo object to the **MFCreateASFMediaSinkActivate** to receive a pointer to the sink activate object.</span></span> <span data-ttu-id="e2ad7-134">No se puede activar el receptor de archivos mediante el objeto de activación devuelto y, a continuación, cambiar la información de secuencia o codificación.</span><span class="sxs-lookup"><span data-stu-id="e2ad7-134">You cannot activate the file sink by using the returned activation object and then change any stream or encoding information.</span></span>

<span data-ttu-id="e2ad7-135">Para obtener información sobre cómo configurar flujos receptores y propiedades específicas, vea los temas siguientes:</span><span class="sxs-lookup"><span data-stu-id="e2ad7-135">For information about configuring sink streams and specific properties, see the following topics:</span></span>

-   [<span data-ttu-id="e2ad7-136">Adición de información de flujo al receptor de archivos ASF</span><span class="sxs-lookup"><span data-stu-id="e2ad7-136">Adding Stream Information to the ASF File Sink</span></span>](adding-stream-information-to-the-asf-file-sink.md)
-   [<span data-ttu-id="e2ad7-137">Establecer propiedades en el receptor de archivos</span><span class="sxs-lookup"><span data-stu-id="e2ad7-137">Setting Properties in the File Sink</span></span>](setting-properties-in-the-file-sink.md)
-   [<span data-ttu-id="e2ad7-138">Agregar metadatos al receptor de archivos</span><span class="sxs-lookup"><span data-stu-id="e2ad7-138">Adding Metadata to the File Sink</span></span>](adding-metadata-to-the-file-sink.md)

## <a name="related-topics"></a><span data-ttu-id="e2ad7-139">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="e2ad7-139">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e2ad7-140">Receptores multimedia de ASF</span><span class="sxs-lookup"><span data-stu-id="e2ad7-140">ASF Media Sinks</span></span>](asf-media-sinks.md)
</dt> <dt>

[<span data-ttu-id="e2ad7-141">Componentes de ASF de capa de canalización</span><span class="sxs-lookup"><span data-stu-id="e2ad7-141">Pipeline Layer ASF Components</span></span>](pipeline-layer-asf-components.md)
</dt> <dt>

[<span data-ttu-id="e2ad7-142">Compatibilidad con ASF en Media Foundation</span><span class="sxs-lookup"><span data-stu-id="e2ad7-142">ASF Support in Media Foundation</span></span>](asf-support-in-media-foundation.md)
</dt> </dl>

 

 



