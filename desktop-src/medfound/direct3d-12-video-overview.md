---
description: Este artículo contiene instrucciones generales para usar las API de vídeo de Direct3D 12.
ms.assetid: ''
title: Información general sobre vídeo de Direct3D 12
ms.topic: article
ms.date: 06/03/2019
ms.openlocfilehash: b21587f2784b34131da9c050655b6f3fbe43582d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104539574"
---
# <a name="direct3d-12-video-overview"></a><span data-ttu-id="ef7ae-103">Información general sobre vídeo de Direct3D 12</span><span class="sxs-lookup"><span data-stu-id="ef7ae-103">Direct3D 12 Video Overview</span></span>

<span data-ttu-id="ef7ae-104">Este artículo contiene instrucciones generales para usar las API de vídeo de Direct3D 12.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-104">This article contains general guidance for using the Direct3D 12 video APIs.</span></span>

## <a name="about-direct3d-12-video"></a><span data-ttu-id="ef7ae-105">Vídeo acerca de Direct3D 12</span><span class="sxs-lookup"><span data-stu-id="ef7ae-105">About Direct3D 12 Video</span></span>

<span data-ttu-id="ef7ae-106">La interfaz de vídeo de Direct3D 12 proporciona una nueva forma para que las aplicaciones implementen la descodificación y el proceso de vídeo.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-106">The Direct3D 12 video interface provides a new way for apps to implement video decoding and process.</span></span> <span data-ttu-id="ef7ae-107">La interfaz de Direct3D 12 es diferente de la interfaz de Direct3D 11 anterior porque se diseñó para ser coherente con los principios y el estilo de Direct3D 12, que incluye lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="ef7ae-107">The Direct3D 12 interface is different from the previous Direct3D 11 interface because it was designed to be consistent with the Direct3D 12 principles and style, which includes the following:</span></span>

- <span data-ttu-id="ef7ae-108">Ofrezca más control a los desarrolladores</span><span class="sxs-lookup"><span data-stu-id="ef7ae-108">Give developers more control</span></span>
 - <span data-ttu-id="ef7ae-109">Asignación de memoria accesible desde hardware</span><span class="sxs-lookup"><span data-stu-id="ef7ae-109">Allocation of hardware-accessible memory</span></span>
 - <span data-ttu-id="ef7ae-110">Subprocesos de CPU utilizados para generar & enviar comandos</span><span class="sxs-lookup"><span data-stu-id="ef7ae-110">CPU threads used to generate & submit commands</span></span>
   - <span data-ttu-id="ef7ae-111">Generación y envío independientes</span><span class="sxs-lookup"><span data-stu-id="ef7ae-111">Independent generation and submission</span></span>
   - <span data-ttu-id="ef7ae-112">Sin bloqueo</span><span class="sxs-lookup"><span data-stu-id="ef7ae-112">Non-blocking</span></span>
 - <span data-ttu-id="ef7ae-113">Programación de trabajo de hardware</span><span class="sxs-lookup"><span data-stu-id="ef7ae-113">Scheduling of hardware work</span></span>
- <span data-ttu-id="ef7ae-114">Cubre la funcionalidad existente, incluida la mayoría de la funcionalidad de vídeo de Direct3D 11, pero al mismo tiempo, tiene en cuenta la simplicidad y la facilidad de uso.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-114">Covers existing functionality, including most Direct3D 11 video functionality, but at the same time, keeps simplicity and ease of use in mind</span></span>
- <span data-ttu-id="ef7ae-115">Eficacia y rendimiento de las aplicaciones de Direct3D 12 principales iguales o superiores a Direct3D 11</span><span class="sxs-lookup"><span data-stu-id="ef7ae-115">Power and performance of main Direct3D 12 applications equal to or better than Direct3D 11</span></span>
- <span data-ttu-id="ef7ae-116">Coherencia con otras API de Direct3D 12</span><span class="sxs-lookup"><span data-stu-id="ef7ae-116">Consistency with other Direct3D 12 APIs</span></span>
- <span data-ttu-id="ef7ae-117">Interoperabilidad con las API de gráficos existentes</span><span class="sxs-lookup"><span data-stu-id="ef7ae-117">Interoperability with existing graphics APIs</span></span>


## <a name="video-decoding"></a><span data-ttu-id="ef7ae-118">Descodificación de vídeo</span><span class="sxs-lookup"><span data-stu-id="ef7ae-118">Video decoding</span></span>

<span data-ttu-id="ef7ae-119">En las secciones siguientes se describen algunas de las tareas necesarias para implementar la descodificación de vídeo de Direct3D 12.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-119">The following sections describe some of the tasks involved in implementing Direct3D 12 video decoding.</span></span>

### <a name="query-for-decoding-capabilities"></a><span data-ttu-id="ef7ae-120">Consulta de funcionalidades de descodificación</span><span class="sxs-lookup"><span data-stu-id="ef7ae-120">Query for decoding capabilities</span></span>

<span data-ttu-id="ef7ae-121">Llame a [ID3D12VideoDevice:: CheckFeatureSupport](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-checkfeaturesupport) para comprobar los detalles de compatibilidad de las operaciones de descodificación de vídeo de Direct3D 12.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-121">Call [ID3D12VideoDevice::CheckFeatureSupport](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-checkfeaturesupport) to check for the support details for Direct3D 12 video decoding operations.</span></span> <span data-ttu-id="ef7ae-122">Pase un valor de la enumeración [D3D12_FEATURE_VIDEO](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_feature_video) para especificar la característica a la que solicita información de soporte técnico.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-122">Pass a value from the [D3D12_FEATURE_VIDEO](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_feature_video) enumeration to specify the feature for which you are requesting support information.</span></span>

### <a name="create-the-video-decoder"></a><span data-ttu-id="ef7ae-123">Crear el descodificador de vídeo</span><span class="sxs-lookup"><span data-stu-id="ef7ae-123">Create the video decoder</span></span>

<span data-ttu-id="ef7ae-124">Llame a [ID3D12VideoDevice:: CreateVideoDecoder](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-createvideodecoder) para crear una instancia de la interfaz [ID3D12VideoDecoder](/windows/desktop/api/d3d12video/nn-d3d12video-id3d12videodecoder) .</span><span class="sxs-lookup"><span data-stu-id="ef7ae-124">Call [ID3D12VideoDevice::CreateVideoDecoder](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-createvideodecoder) to create an instance of the [ID3D12VideoDecoder](/windows/desktop/api/d3d12video/nn-d3d12video-id3d12videodecoder) interface.</span></span> <span data-ttu-id="ef7ae-125">El descodificador contiene el estado de una sesión de descodificación, incluidos los datos relacionados con las referencias como vectores de movimiento.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-125">The decoder holds state for a decode session, including reference-related data such as motion vectors.</span></span>  <span data-ttu-id="ef7ae-126">En el caso de un cambio de resolución o un cambio de [MaxDecodePictureBufferCount](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_decoder_heap_desc) , se vuelve a crear el objeto descodificador.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-126">In the event of a resolution change or a [MaxDecodePictureBufferCount](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_decoder_heap_desc) change, the decoder object is recreated.</span></span> <span data-ttu-id="ef7ae-127">El ancho y el alto de descodificación especifican la resolución de flujo nativo antes de cualquier escala.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-127">The decode width and height specify the native stream resolution before any scale.</span></span>  <span data-ttu-id="ef7ae-128">El número máximo de búferes de descodificación de imágenes (DPB) especifica el recuento de DPB más grande que se puede usar sin volver a crear el descodificador de vídeo.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-128">The maximum Decode Picture Buffer (DPB) count specifies the largest DPB count that can be used without recreating the video decoder.</span></span>

<span data-ttu-id="ef7ae-129">El descodificador se puede usar para grabar comandos desde varias listas de comandos, pero solo se puede asociar a una lista de comandos a la vez.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-129">The decoder may be used to record commands from multiple command lists, but may only be associated with one command list at a time.</span></span>  <span data-ttu-id="ef7ae-130">La aplicación es responsable de sincronizar el acceso al descodificador.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-130">The application is responsible for synchronizing access to the decoder.</span></span>

### <a name="create-the-video-decoder-heap"></a><span data-ttu-id="ef7ae-131">Crear el montón del descodificador de vídeo</span><span class="sxs-lookup"><span data-stu-id="ef7ae-131">Create the video decoder heap</span></span> 

<span data-ttu-id="ef7ae-132">Llame a [ID3D12VideoDevice:: CreateVideoDecoderHeap](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-createvideodecoderheap) para crear una instancia de la interfaz [ID3D12VideoDecoderHeap](/windows/desktop/api/d3d12video/nn-d3d12video-id3d12videodecoderheap) .</span><span class="sxs-lookup"><span data-stu-id="ef7ae-132">Call [ID3D12VideoDevice::CreateVideoDecoderHeap](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-createvideodecoderheap) to create an instance of the [ID3D12VideoDecoderHeap](/windows/desktop/api/d3d12video/nn-d3d12video-id3d12videodecoderheap) interface.</span></span> <span data-ttu-id="ef7ae-133">Este objeto contiene los recursos de controlador dependientes de la resolución y el estado.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-133">This object contains the resolution-dependent driver resources and state.</span></span>

### <a name="decoding-a-frame"></a><span data-ttu-id="ef7ae-134">Descodificar un marco</span><span class="sxs-lookup"><span data-stu-id="ef7ae-134">Decoding a frame</span></span>

<span data-ttu-id="ef7ae-135">Todos los parámetros de entrada y salida de las operaciones de procesamiento de vídeo se organizan en una estructura de parámetros de entrada, [D3D12_VIDEO_DECODE_INPUT_STREAM_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_decode_input_stream_arguments)y una estructura de parámetros de salida, [D3D12_VIDEO_DECODE_OUTPUT_STREAM_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_decode_output_stream_arguments).</span><span class="sxs-lookup"><span data-stu-id="ef7ae-135">All input and output parameters for the video processing operations are organized into an input parameter structure, [D3D12_VIDEO_DECODE_INPUT_STREAM_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_decode_input_stream_arguments), and an output parameter structure, [D3D12_VIDEO_DECODE_OUTPUT_STREAM_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_decode_output_stream_arguments).</span></span>
<span data-ttu-id="ef7ae-136">La aplicación administra los fotogramas de referencia y, como tal, debe establecer los fotogramas de referencia para cada operación de descodificación.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-136">The application manages the reference frames, and as such, needs to set the reference frames for every decoding operation.</span></span>
<span data-ttu-id="ef7ae-137">Cuando se grabe correctamente la lista de comandos, llame a [ID3D12CommandQueue:: ExecuteCommandLists](/windows/desktop/api/d3d12/nf-d3d12-id3d12commandqueue-executecommandlists) en la cola de comandos de vídeo para enviar la descodificación de fotogramas a la GPU.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-137">When the command list is properly recorded, call [ID3D12CommandQueue::ExecuteCommandLists](/windows/desktop/api/d3d12/nf-d3d12-id3d12commandqueue-executecommandlists) on the video command queue to submit the frame decoding to the GPU.</span></span>


### <a name="enabling-decoder-output-conversions"></a><span data-ttu-id="ef7ae-138">Habilitar las conversiones de salida del descodificador</span><span class="sxs-lookup"><span data-stu-id="ef7ae-138">Enabling decoder output conversions</span></span>
<span data-ttu-id="ef7ae-139">Si el descodificador admite la conversión, habilite las conversiones deseadas rellenando correctamente la estructura de [D3D12_VIDEO_DECODE_CONVERSION_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_decode_conversion_arguments) .</span><span class="sxs-lookup"><span data-stu-id="ef7ae-139">If the decoder supports conversion, then enable the desired conversions by properly filling the [D3D12_VIDEO_DECODE_CONVERSION_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_decode_conversion_arguments) structure.</span></span> <span data-ttu-id="ef7ae-140">El formato y las resoluciones de la salida deseada en lugar de la salida nativa del descodificador se comunican a través de la diferencia en el espacio de colores y las resoluciones especificadas en los parámetros de conversión.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-140">The format and resolutions of the desired output versus the native output of the decoder are communicated via the difference in color space and resolutions specified in the conversion parameters.</span></span>

##  <a name="querying-decoding-status"></a><span data-ttu-id="ef7ae-141">Consulta del estado de descodificación</span><span class="sxs-lookup"><span data-stu-id="ef7ae-141">Querying decoding status</span></span> 
<span data-ttu-id="ef7ae-142">Use los métodos [ID3D12VideoDecodeCommandList:: BeginQuery](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodecodecommandlist-beginquery) y [ID3D12VideoDecodeCommandList:: EndQuery](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodecodecommandlist-endquery) para consultar el estado de la operación de descodificación.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-142">Use the methods [ID3D12VideoDecodeCommandList::BeginQuery](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodecodecommandlist-beginquery) and [ID3D12VideoDecodeCommandList::EndQuery](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodecodecommandlist-endquery) to query the status of the decoding operation.</span></span>

<span data-ttu-id="ef7ae-143">La estructura de [D3D12_QUERY_DATA_VIDEO_DECODE_STATISTICS](/windows/win32/api/d3d12video/ns-d3d12video-d3d12_query_data_video_decode_statistics) se usa para describir las estadísticas de descodificación de vídeo.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-143">The [D3D12_QUERY_DATA_VIDEO_DECODE_STATISTICS](/windows/win32/api/d3d12video/ns-d3d12video-d3d12_query_data_video_decode_statistics) structure is used to describe video decode statistics.</span></span> <span data-ttu-id="ef7ae-144">Para obtener una instancia de esta estructura, llame a [ID3D12VideoDecodeCommandList:: EndQuery](/windows/win32/api/d3d12video/nf-d3d12video-id3d12videodecodecommandlist-endquery), pasando el valor de tipo de consulta heap de [D3D12_QUERY_TYPE_VIDEO_DECODE_STATISTIC](/windows/win32/api/d3d12/ne-d3d12-d3d12_query_type).</span><span class="sxs-lookup"><span data-stu-id="ef7ae-144">To get an instance of this structure call [ID3D12VideoDecodeCommandList::EndQuery](/windows/win32/api/d3d12video/nf-d3d12video-id3d12videodecodecommandlist-endquery), passing in the heap query type value of [D3D12_QUERY_TYPE_VIDEO_DECODE_STATISTIC](/windows/win32/api/d3d12/ne-d3d12-d3d12_query_type).</span></span> <span data-ttu-id="ef7ae-145">Tenga en cuenta que esta consulta no usa [ID3D12VideoDecodeCommandList:: BeginQuery](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodecodecommandlist-beginquery).</span><span class="sxs-lookup"><span data-stu-id="ef7ae-145">Note that this query does not use [ID3D12VideoDecodeCommandList::BeginQuery](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodecodecommandlist-beginquery).</span></span>

## <a name="video-processing"></a><span data-ttu-id="ef7ae-146">Procesamiento de vídeo</span><span class="sxs-lookup"><span data-stu-id="ef7ae-146">Video processing</span></span>

<span data-ttu-id="ef7ae-147">Las API de vídeo de Direct3D 12 tienen un enfoque simplificado para el procesamiento de vídeo, con lo que se eliminan las características de Direct3D 11 que no se usaron ampliamente y se quitan las comprobaciones de funcionalidad de las características que son obligatorias en</span><span class="sxs-lookup"><span data-stu-id="ef7ae-147">Direct3D 12 video APIs take a streamlined approach to video processing, eliminating features of Direct3D 11 that weren't widely used and removing capability checks for features that are mandatory across devices.</span></span> <span data-ttu-id="ef7ae-148">Se elimina el proceso de enumeración para el procesamiento de vídeo.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-148">The enumeration process for video processing is eliminated.</span></span> <span data-ttu-id="ef7ae-149">En su lugar, llame a [ID3D12VideoDevice:: CheckFeatureSupport](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-checkfeaturesupport) , que permite que una aplicación identifique las capacidades del procesador de vídeo.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-149">Instead, call [ID3D12VideoDevice::CheckFeatureSupport](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-checkfeaturesupport) which allows an app to identify the capabilities of the video processor.</span></span> <span data-ttu-id="ef7ae-150">Los formatos y las tasas de vídeo, entrelazado y estéreo deseados se proporcionan como entrada para **CheckFeatureSupport**.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-150">The desired video, interlace, stereo formats and rates are provided as as input to **CheckFeatureSupport**.</span></span>

### <a name="removed-capabilities"></a><span data-ttu-id="ef7ae-151">Funcionalidades eliminadas</span><span class="sxs-lookup"><span data-stu-id="ef7ae-151">Removed capabilities</span></span>

<span data-ttu-id="ef7ae-152">Las siguientes funcionalidades de Direct3D 11 no se admiten en el procesamiento de vídeo de Direct3D 12:</span><span class="sxs-lookup"><span data-stu-id="ef7ae-152">The following capabilities from Direct3D 11 are not supported in Direct3D 12 video processing:</span></span>
- <span data-ttu-id="ef7ae-153">Tasas personalizadas.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-153">Custom rates.</span></span>  <span data-ttu-id="ef7ae-154">En su lugar, se proporciona una velocidad de entrada y salida durante la grabación de comandos [ID3D12VideoProcessCommandList::P rocessframes](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videoprocesscommandlist-processframes) .</span><span class="sxs-lookup"><span data-stu-id="ef7ae-154">Instead, there is an input and output rate given during the [ID3D12VideoProcessCommandList::ProcessFrames](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videoprocesscommandlist-processframes) command recording.</span></span>
- <span data-ttu-id="ef7ae-155">Ahora solo hay dos modos de desentrelazado disponibles: [Bob](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_process_deinterlace_flags) y [Custom](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_process_deinterlace_flags).</span><span class="sxs-lookup"><span data-stu-id="ef7ae-155">There are just two deinterlacing modes available now: [BOB](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_process_deinterlace_flags) and [CUSTOM](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_process_deinterlace_flags).</span></span> <span data-ttu-id="ef7ae-156">Se han eliminado otros modos.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-156">Other modes have been eliminated.</span></span> <span data-ttu-id="ef7ae-157">PERSONALIZADO es un modo de desentrelazado de alta calidad proporcionado por el fabricante del hardware.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-157">CUSTOM is a high-quality deinterlacing mode provided by the hardware vendor.</span></span>
- <span data-ttu-id="ef7ae-158">Ya no se admiten todos los formatos estéreo opcionales de [D3D11_VIDEO_PROCESSOR_STEREO_CAPS](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_stereo_caps) .</span><span class="sxs-lookup"><span data-stu-id="ef7ae-158">All of the optional stereo formats in [D3D11_VIDEO_PROCESSOR_STEREO_CAPS](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_stereo_caps) are no longer supported.</span></span> <span data-ttu-id="ef7ae-159">En su lugar, [Nono](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_frame_stereo_format), [horizontal](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_frame_stereo_format), [vertical](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_frame_stereo_format)y [independiente](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_frame_stereo_format) son obligatorios para todos los dispositivos de hardware Si se admite estéreo.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-159">Instead, [nono](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_frame_stereo_format), [horizontal](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_frame_stereo_format), [vertical](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_frame_stereo_format), and [separate](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_frame_stereo_format) are mandatory for all hardware devices if stereo is supported.</span></span>
- <span data-ttu-id="ef7ae-160">No hay ningún equivalente para [D3D11_VIDEO_PROCESSOR_FORMAT_CAPS](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_format_caps) o [D3D11_VIDEO_PROCESSOR_AUTO_STREAM_CAPS](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_auto_stream_caps).</span><span class="sxs-lookup"><span data-stu-id="ef7ae-160">There is no equivalent for [D3D11_VIDEO_PROCESSOR_FORMAT_CAPS](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_format_caps) or [D3D11_VIDEO_PROCESSOR_AUTO_STREAM_CAPS](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_auto_stream_caps).</span></span> <span data-ttu-id="ef7ae-161">En su lugar, los formatos de entrada y salida son argumentos para la creación del procesador de vídeo y, en ese momento, se debe conocer si el procesador de vídeo puede o no puede realizar la operación con el formato especificado.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-161">Instead, input and output formats are arguments to the creation of the video processor, and at that time, it should be known if the video processor can or cannot perform the operation with the given format.</span></span> <span data-ttu-id="ef7ae-162">El [D3D12_VIDEO_PROCESS_AUTO_PROCESSING_FLAGS](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_process_auto_processing_flags) se utiliza para indicar si las características de procesamiento automático están disponibles.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-162">The [D3D12_VIDEO_PROCESS_AUTO_PROCESSING_FLAGS](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_process_auto_processing_flags) is used to indicate if auto processing features are available.</span></span>
- <span data-ttu-id="ef7ae-163">No hay ningún equivalente para [D3D11_VIDEO_PROCESSOR_CAPS_LEGACY](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_feature_caps).</span><span class="sxs-lookup"><span data-stu-id="ef7ae-163">There is no equivalent for [D3D11_VIDEO_PROCESSOR_CAPS_LEGACY](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_feature_caps).</span></span>
- <span data-ttu-id="ef7ae-164">No hay ningún equivalente para [D3D11_VIDEO_PROCESSOR_CAPS_CONSTRICTION](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_feature_caps).</span><span class="sxs-lookup"><span data-stu-id="ef7ae-164">There is no equivalent for [D3D11_VIDEO_PROCESSOR_CAPS_CONSTRICTION](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_feature_caps).</span></span>
- <span data-ttu-id="ef7ae-165">Al convertir de estéreo a mono, asumimos que la vista de línea base es 0.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-165">When converting from stereo to mono, we assume the baseline view is 0.</span></span>
- <span data-ttu-id="ef7ae-166">El procesamiento de vídeo de Direct3D 12 no admite la conversión de mono a estéreo y no se admite el desplazamiento mono.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-166">Direct3D 12 video processing does not support converting mono to stereo and there is no support for mono offset.</span></span> 


### <a name="creating-a-video-processor"></a><span data-ttu-id="ef7ae-167">Creación de un procesador de vídeo</span><span class="sxs-lookup"><span data-stu-id="ef7ae-167">Creating a video processor</span></span>

<span data-ttu-id="ef7ae-168">Llame a [ID3D12VideoDevice:: CreateVideoProcessor](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-createvideoprocessor) para crear una instancia de [ID3D12VideoProcessor](/windows/desktop/api/d3d12video/nn-d3d12video-id3d12videoprocessor).</span><span class="sxs-lookup"><span data-stu-id="ef7ae-168">Call [ID3D12VideoDevice::CreateVideoProcessor](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-createvideoprocessor) to create an instance of the [ID3D12VideoProcessor](/windows/desktop/api/d3d12video/nn-d3d12video-id3d12videoprocessor).</span></span> <span data-ttu-id="ef7ae-169">El procesador de vídeo contiene el estado de una sesión de procesamiento de vídeo, incluida la memoria intermedia necesaria, los datos de procesamiento en caché u otro espacio de trabajo temporal.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-169">The video processor holds state for a video processing session, including required intermediate memory, cached processing data, or other temporary working space.</span></span> <span data-ttu-id="ef7ae-170">Los argumentos de creación del procesador de vídeo especifican qué operaciones se realizan o están disponibles en [ID3D12VideoProcessCommandList1::P rocessframes1](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videoprocesscommandlist1-processframes1) Time.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-170">The video processor creation arguments specify which operations are performed or are available at [ID3D12VideoProcessCommandList1::ProcessFrames1](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videoprocesscommandlist1-processframes1) time.</span></span>  <span data-ttu-id="ef7ae-171">Las asignaciones de controladores para realizar la operación de proceso de vídeo (por ejemplo, los intermedios) se asignan en el momento de la creación del procesador de vídeo.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-171">Driver allocations to perform the video process operation (e.g. intermediates) are allocated at video processor creation time.</span></span>  <span data-ttu-id="ef7ae-172">Use [D3D12_FEATURE_VIDEO_PROCESSOR_SIZE](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_feature_video) para determinar el tamaño de asignación del procesador de vídeo de antemano.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-172">Use [D3D12_FEATURE_VIDEO_PROCESSOR_SIZE](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_feature_video) to determine the allocation size of the video processor in advance.</span></span>

<span data-ttu-id="ef7ae-173">El procesador de vídeo solo se puede usar para grabar comandos desde varias listas de comandos, pero solo se puede asociar a una lista de comandos a la vez.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-173">The video processor may only be used to record commands from multiple command lists, but may only be associated with one command list at a time.</span></span>  <span data-ttu-id="ef7ae-174">La aplicación es responsable de sincronizar el acceso al procesador de vídeo.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-174">The application is responsible for synchronizing access to the video processor.</span></span>  <span data-ttu-id="ef7ae-175">La aplicación también debe grabar comandos de procesamiento de vídeo en el vídeo procoessor en el orden en que se ejecutan en la GPU.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-175">The application must also record video processing commands against the video procoessor in the order that they are executed on the GPU.</span></span>

<span data-ttu-id="ef7ae-176">Todos los argumentos de entrada y salida de las operaciones de procesamiento de vídeo se organizan en una estructura de argumentos de entrada, [D3D12_VIDEO_PROCESS_INPUT_STREAM_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_process_input_stream_arguments)y una estructura de argumentos de salida, [D3D12_VIDEO_PROCESS_OUTPUT_STREAM_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_process_output_stream_arguments).</span><span class="sxs-lookup"><span data-stu-id="ef7ae-176">All input and output arguments for the video processing operations are organized into an input argument structure, [D3D12_VIDEO_PROCESS_INPUT_STREAM_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_process_input_stream_arguments), and an output argument structure, [D3D12_VIDEO_PROCESS_OUTPUT_STREAM_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_process_output_stream_arguments).</span></span> <span data-ttu-id="ef7ae-177">La aplicación debe llamar a [ID3D12VideoProcessCommandList::P rocessframes](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videoprocesscommandlist-processframes) para registrar la operación de procesamiento de vídeo que desea ejecutar.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-177">The application must call [ID3D12VideoProcessCommandList::ProcessFrames](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videoprocesscommandlist-processframes) to record the video processing operation it wants to execute.</span></span> 

<span data-ttu-id="ef7ae-178">Cuando se grabe la lista de comandos, llame a [ID3D12CommandQueue:: ExecuteCommandLists](/windows/desktop/api/d3d12/nf-d3d12-id3d12commandqueue-executecommandlists) en la cola de comandos de vídeo para enviar el procesamiento de fotogramas a la GPU.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-178">When the command list is recorded, call [ID3D12CommandQueue::ExecuteCommandLists](/windows/desktop/api/d3d12/nf-d3d12-id3d12commandqueue-executecommandlists) on the video command queue to submit the frame processing to the GPU.</span></span>


## <a name="tiers"></a><span data-ttu-id="ef7ae-179">Niveles</span><span class="sxs-lookup"><span data-stu-id="ef7ae-179">Tiers</span></span>

<span data-ttu-id="ef7ae-180">El vídeo de Direct3D 12 define los niveles que agrupan las capacidades de los dispositivos de hardware, de modo que la aplicación puede tener menos rutas de acceso de código para satisfacer la variedad de hardware.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-180">Direct3D 12 video defines tiers that group the capabilities of hardware devices, so that the app can have fewer code paths to cater to the variety of hardware.</span></span> <span data-ttu-id="ef7ae-181">Los niveles se especifican con la enumeración [D3D12_VIDEO_DECODE_TIER](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_decode_tier) .</span><span class="sxs-lookup"><span data-stu-id="ef7ae-181">The tiers are specified with the [D3D12_VIDEO_DECODE_TIER](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_decode_tier) enumeration.</span></span>

<span data-ttu-id="ef7ae-182">En todos los niveles, estará disponible lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="ef7ae-182">In all the tiers, the following will be available:</span></span>

- <span data-ttu-id="ef7ae-183">No es necesario volver a realizar el descodificador en los cambios de resolución.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-183">No need for decoder recreation on resolution changes.</span></span> <span data-ttu-id="ef7ae-184">Solo es necesario volver a crear el montón del descodificador en el cambio de resolución.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-184">Only the decoder heap needs to be recreated on resolution change.</span></span>
- <span data-ttu-id="ef7ae-185">Todos los fotogramas de referencia serán administrados por la aplicación.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-185">All reference frames will be managed by the app.</span></span> <span data-ttu-id="ef7ae-186">Esto permite que el sistema Ahorre memoria, ya que no es necesario asignar el número máximo de DPBs en el momento de la creación del descodificador en algunos niveles, y proporciona flexibilidad a las aplicaciones en los escenarios de cambio de resolución.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-186">This allows the system to save memory since we do not need to allocate the maximum number of DPBs at decoder creation time in some tiers, and gives apps flexibility in resolution changing scenarios.</span></span>

<span data-ttu-id="ef7ae-187">Tenga en cuenta que los niveles son superconjuntos.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-187">Note that the tiers are supersets.</span></span> <span data-ttu-id="ef7ae-188">Una aplicación puede decidir realizar el nivel 1 y no usar las características de nivel superior, lo que se permite, pero es posible que no proporcione un rendimiento óptimo.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-188">An app may decide to do tier 1, and not use the higher level features, which is allowed but may not provide optimal performace.</span></span> <span data-ttu-id="ef7ae-189">Para obtener más información sobre las capacidades asociadas a los distintos niveles de nivel, vea [D3D12_VIDEO_DECODE_TIER](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_decode_tier).</span><span class="sxs-lookup"><span data-stu-id="ef7ae-189">For more information on the capabilities associated with different tier levels, see [D3D12_VIDEO_DECODE_TIER](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_decode_tier).</span></span>

## <a name="reference-frames"></a><span data-ttu-id="ef7ae-190">Fotogramas de referencia</span><span class="sxs-lookup"><span data-stu-id="ef7ae-190">Reference frames</span></span>

<span data-ttu-id="ef7ae-191">Con el vídeo de Direct3D 12, los fotogramas de referencia se pasan explícitamente.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-191">With Direct3D 12 video, reference frames are passed explicitly.</span></span> <span data-ttu-id="ef7ae-192">Esto permite un uso claro de la matriz de texturas o matrices de texturas al descodificar fotogramas.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-192">This allows for clear usage of array of textures or texture arrays when we are decoding frames.</span></span> <span data-ttu-id="ef7ae-193">No es necesario que la aplicación pase exactamente el mismo identificador de recurso cuando se usa como referencia. por ejemplo, puede optar por copiar un recurso en otro y, a continuación, pasar la copia en lugar de la original.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-193">The app is not required to pass the exact same resource handle when using it as a reference; it may, for instance, decide to copy one resource to another and then pass the copy instead of the original one.</span></span> <span data-ttu-id="ef7ae-194">El controlador sigue usando los índices de *RefFrameList* y *CurrPic* de DXVA para almacenar los datos pertinentes de cada fotograma descodificado.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-194">The DXVA *RefFrameList* and *CurrPic* indices are still used by the driver to store relevant data for each decoded frame.</span></span>


## <a name="directx-12-fences"></a><span data-ttu-id="ef7ae-195">Barreras de DirectX 12</span><span class="sxs-lookup"><span data-stu-id="ef7ae-195">DirectX 12 fences</span></span>

<span data-ttu-id="ef7ae-196">En DirectX 12, la aplicación es responsable de sincronizar el acceso a sus búferes.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-196">In DirectX 12, the app is responsible for synchronizing the access to their buffers.</span></span> <span data-ttu-id="ef7ae-197">En el caso de la descodificación, habrá que agregar barreras a los búferes de entrada y a los búferes de salida.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-197">For the decoding case, there will be the need for adding fences to the input buffers and to the output buffers.</span></span> <span data-ttu-id="ef7ae-198">Cada barrera tiene un valor asociado y se usa para la sincronización de la CPU y los motores de hardware.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-198">Each fence has a value associated with it, and are used for synchronization of the CPU and the hardware engines.</span></span> <span data-ttu-id="ef7ae-199">Para obtener más información, vea [uso de barreras de recursos para sincronizar los Estados de los recursos en Direct3D 12](/windows/desktop/direct3d12/using-resource-barriers-to-synchronize-resource-states-in-direct3d-12).</span><span class="sxs-lookup"><span data-stu-id="ef7ae-199">For more information, see [Using Resource Barriers to Synchronize Resource States in Direct3D 12](/windows/desktop/direct3d12/using-resource-barriers-to-synchronize-resource-states-in-direct3d-12).</span></span>

<span data-ttu-id="ef7ae-200">Una implementación típica tendrá una barrera para cada búfer de entrada.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-200">A typical implementation will have a fence for each input buffer.</span></span> <span data-ttu-id="ef7ae-201">En el caso de los búferes de entrada, es posible que el búfer esté disponible antes de que se realice todo el proceso de descodificación.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-201">In the case of input buffers, it is possible that the buffer may be available before the whole decoding process is done.</span></span> <span data-ttu-id="ef7ae-202">El sistema omitirá este caso y asumirá que el búfer de entrada está disponible cuando se realiza la descodificación.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-202">The system will ignore this case and assume that the input buffer is available when decoding is done.</span></span>
<span data-ttu-id="ef7ae-203">Normalmente, una implementación también tendrá una barrera para cada búfer de salida.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-203">An implementation will also usually have a fence for each output buffer.</span></span> <span data-ttu-id="ef7ae-204">En el caso de enviar la salida al compositor, por ejemplo, se necesita una barrera que se señaliza cuando la presentación de ese fotograma se realiza finalmente, lo que indica que la salida está de nuevo disponible para el descodificador.</span><span class="sxs-lookup"><span data-stu-id="ef7ae-204">In the case of sending the output to the compositor, for instance, a fence is needed that is signaled when that presentation of that frame is finally done, indicating that the output is again available for the decoder.</span></span>


## <a name="related-topics"></a><span data-ttu-id="ef7ae-205">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="ef7ae-205">Related topics</span></span>

<dl> <span data-ttu-id="ef7ae-206"><dt>API de vídeo de 
[Direct3D 12](direct3d-12-video-apis.md) 
 [Guía de programación de Media Foundation](media-foundation-programming-guide.md)
</dt> </span><span class="sxs-lookup"><span data-stu-id="ef7ae-206"><dt>
[Direct3D 12 Video APIs](direct3d-12-video-apis.md)
[Media Foundation Programming Guide](media-foundation-programming-guide.md)
</dt> </span></span></dl>

 

 
