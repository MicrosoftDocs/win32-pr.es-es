---
description: Antes de Windows Vista, se creaba un elemento del panel de control creando un archivo. dll y asignándole un nombre con una extensión. cpl.
ms.assetid: 258dae28-c054-4392-b0e9-99493f23c814
title: Usar CPLApplet
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b1e59b29dd7c082822ed63d425dd4967a542b5d1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104985399"
---
# <a name="using-cplapplet"></a><span data-ttu-id="0edfa-103">Usar CPLApplet</span><span class="sxs-lookup"><span data-stu-id="0edfa-103">Using CPLApplet</span></span>

<span data-ttu-id="0edfa-104">Antes de Windows Vista, se creaba un elemento del panel de control creando un archivo. dll y asignándole un nombre con una extensión. cpl.</span><span class="sxs-lookup"><span data-stu-id="0edfa-104">Prior to Windows Vista, you created a Control Panel item by creating a .dll file and naming it with a .cpl extension.</span></span> <span data-ttu-id="0edfa-105">Este archivo exportó la función [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) .</span><span class="sxs-lookup"><span data-stu-id="0edfa-105">This file exported the [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) function.</span></span> <span data-ttu-id="0edfa-106">Este esquema sigue siendo compatible con Windows Vista y versiones posteriores, y se describe en este tema.</span><span class="sxs-lookup"><span data-stu-id="0edfa-106">This scheme is still supported in Windows Vista and later versions and is discussed in this topic.</span></span> <span data-ttu-id="0edfa-107">Sin embargo, las instrucciones para los nuevos elementos del panel de control recomiendan un enfoque más sencillo con el elemento del panel de control compilado como un archivo. exe que usa un diseño de flujo de tareas.</span><span class="sxs-lookup"><span data-stu-id="0edfa-107">However, the guidelines for new Control Panel items recommend a simpler approach with the Control Panel item built as a .exe file that uses a task flow layout.</span></span>

<span data-ttu-id="0edfa-108">Cuando el panel de control carga un archivo. dll (o. cpl), llama a la función [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) para obtener información como el número de elementos del panel de control que hospeda el archivo, así como información sobre cada elemento.</span><span class="sxs-lookup"><span data-stu-id="0edfa-108">When Control Panel loads a .dll (or .cpl) file, it calls the [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) function to get information such as the number of Control Panel items the file hosts, as well as information about each item.</span></span> <span data-ttu-id="0edfa-109">El panel de control también llama a la función cuando la ventana del elemento se inicializa, se abre o se cierra.</span><span class="sxs-lookup"><span data-stu-id="0edfa-109">Control Panel also calls the function when the item's window is initialized, opened, or closed.</span></span>

<span data-ttu-id="0edfa-110">Cuando Windows carga por primera vez el elemento del panel de control, recupera la dirección de la función [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) y, posteriormente, usa esa dirección para llamar a la función y pasar mensajes.</span><span class="sxs-lookup"><span data-stu-id="0edfa-110">When Windows first loads the Control Panel item, it retrieves the address of the [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) function and subsequently uses that address to call the function and pass it messages.</span></span> <span data-ttu-id="0edfa-111">Podría enviar los mensajes siguientes.</span><span class="sxs-lookup"><span data-stu-id="0edfa-111">It might send the following messages.</span></span>



| <span data-ttu-id="0edfa-112">Message</span><span class="sxs-lookup"><span data-stu-id="0edfa-112">Message</span></span>                                     | <span data-ttu-id="0edfa-113">Descripción</span><span class="sxs-lookup"><span data-stu-id="0edfa-113">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|---------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="0edfa-114">**CPL \_ DBLCLK**</span><span class="sxs-lookup"><span data-stu-id="0edfa-114">**CPL\_DBLCLK**</span></span>](cpl-dblclk.md)           | <span data-ttu-id="0edfa-115">Se envía para notificar a [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) que el usuario ha elegido el icono asociado a un determinado elemento del panel de control.</span><span class="sxs-lookup"><span data-stu-id="0edfa-115">Sent to notify [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) that the user has chosen the icon associated with a given Control Panel item.</span></span> <span data-ttu-id="0edfa-116">**CPlApplet** debe mostrar el cuadro de diálogo para el elemento especificado y realizar las tareas especificadas por el usuario.</span><span class="sxs-lookup"><span data-stu-id="0edfa-116">**CPlApplet** should display the dialog box for the specified item and carry out any user-specified tasks.</span></span> <span data-ttu-id="0edfa-117">El parámetro **CPlApplet** *lParam1* es un entero que representa el índice de base cero del elemento del panel de control.</span><span class="sxs-lookup"><span data-stu-id="0edfa-117">The **CPlApplet** *lParam1* parameter is an integer that represents the zero-based index of the Control Panel item.</span></span> <span data-ttu-id="0edfa-118">El parámetro *lParam2* es el puntero **lpData** devuelto en la estructura [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) o [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) del mensaje [**CPL \_ inquire**](cpl-inquire.md) o [**CPL \_ NEWINQUIRE**](cpl-newinquire.md) .</span><span class="sxs-lookup"><span data-stu-id="0edfa-118">The *lParam2* parameter is the **lpData** pointer returned in the [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) or [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) structure in the [**CPL\_INQUIRE**](cpl-inquire.md) or [**CPL\_NEWINQUIRE**](cpl-newinquire.md) message.</span></span> <span data-ttu-id="0edfa-119">Se omite el valor devuelto.</span><span class="sxs-lookup"><span data-stu-id="0edfa-119">The return value is ignored.</span></span>                                                                |
| [<span data-ttu-id="0edfa-120">**salir de CPL \_**</span><span class="sxs-lookup"><span data-stu-id="0edfa-120">**CPL\_EXIT**</span></span>](cpl-exit.md)               | <span data-ttu-id="0edfa-121">Se envía después del último bloque de detención de CPL \_ e inmediatamente antes de que Windows use la función [**FreeLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary) para liberar el archivo DLL que contiene el elemento del panel de control.</span><span class="sxs-lookup"><span data-stu-id="0edfa-121">Sent after the last CPL\_STOP message and immediately before Windows uses the [**FreeLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary) function to free the DLL that contains the Control Panel item.</span></span> <span data-ttu-id="0edfa-122">[**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) debe liberar cualquier memoria restante y prepararse para cerrar.</span><span class="sxs-lookup"><span data-stu-id="0edfa-122">[**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) should free any remaining memory and prepare to close.</span></span> <span data-ttu-id="0edfa-123">Se omite el valor devuelto.</span><span class="sxs-lookup"><span data-stu-id="0edfa-123">The return value is ignored.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="0edfa-124">**CPL \_ GETCOUNT**</span><span class="sxs-lookup"><span data-stu-id="0edfa-124">**CPL\_GETCOUNT**</span></span>](cpl-getcount.md)       | <span data-ttu-id="0edfa-125">Se envía después del \_ mensaje CPL init para solicitar a [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) que devuelva un número que indica el número de subprogramas que admite.</span><span class="sxs-lookup"><span data-stu-id="0edfa-125">Sent after the CPL\_INIT message to prompt [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) to return a number that indicates how many subprograms it supports.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="0edfa-126">**CPL \_ init**</span><span class="sxs-lookup"><span data-stu-id="0edfa-126">**CPL\_INIT**</span></span>](cpl-init.md)               | <span data-ttu-id="0edfa-127">Se envía inmediatamente después de que se cargue el archivo DLL que contiene el elemento del panel de control.</span><span class="sxs-lookup"><span data-stu-id="0edfa-127">Sent immediately after the DLL that contains the Control Panel item is loaded.</span></span> <span data-ttu-id="0edfa-128">El mensaje solicita a [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) que realice los procedimientos de inicialización, incluida la asignación de memoria.</span><span class="sxs-lookup"><span data-stu-id="0edfa-128">The message prompts [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) to perform initialization procedures, including memory allocation.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [<span data-ttu-id="0edfa-129">**CPL \_ consulta**</span><span class="sxs-lookup"><span data-stu-id="0edfa-129">**CPL\_INQUIRE**</span></span>](cpl-inquire.md)         | <span data-ttu-id="0edfa-130">Se envía después del \_ mensaje CPL GETCOUNT para solicitar a [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) que proporcione información sobre un subprograma especificado.</span><span class="sxs-lookup"><span data-stu-id="0edfa-130">Sent after the CPL\_GETCOUNT message to prompt [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) to provide information about a specified subprogram.</span></span> <span data-ttu-id="0edfa-131">El valor de *lParam1* es un entero que representa el índice de base cero del subprograma sobre el que se solicita información.</span><span class="sxs-lookup"><span data-stu-id="0edfa-131">The *lParam1* value is an integer that represents the zero-based index of the subprogram about which information is being requested.</span></span> <span data-ttu-id="0edfa-132">El parámetro *lParam2* de **CPlApplet** apunta a una estructura [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) .</span><span class="sxs-lookup"><span data-stu-id="0edfa-132">The *lParam2* parameter of **CPlApplet** points to a [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) structure.</span></span> <span data-ttu-id="0edfa-133">Se omite el valor devuelto.</span><span class="sxs-lookup"><span data-stu-id="0edfa-133">The return value is ignored.</span></span>                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="0edfa-134">**CPL \_ NEWINQUIRE**</span><span class="sxs-lookup"><span data-stu-id="0edfa-134">**CPL\_NEWINQUIRE**</span></span>](cpl-newinquire.md)   | <span data-ttu-id="0edfa-135">Se envía después del \_ mensaje CPL GETCOUNT para solicitar a [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) que proporcione información sobre un elemento del panel de control especificado.</span><span class="sxs-lookup"><span data-stu-id="0edfa-135">Sent after the CPL\_GETCOUNT message to prompt [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) to provide information about a specified Control Panel item.</span></span> <span data-ttu-id="0edfa-136">El valor de *lParam1* es un entero que representa el índice de base cero del subprograma sobre el que se solicita información.</span><span class="sxs-lookup"><span data-stu-id="0edfa-136">The *lParam1* value is an integer that represents the zero-based index of the subprogram about which information is being requested.</span></span> <span data-ttu-id="0edfa-137">El parámetro *lParam2* es un puntero a una estructura [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) .</span><span class="sxs-lookup"><span data-stu-id="0edfa-137">The *lParam2* parameter is a pointer to a [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) structure.</span></span> <span data-ttu-id="0edfa-138">\_Se debe omitir CPL NEWINQUIRE normalmente.</span><span class="sxs-lookup"><span data-stu-id="0edfa-138">CPL\_NEWINQUIRE normally should be ignored.</span></span> <span data-ttu-id="0edfa-139">La aplicación solo debe procesar \_ los sistemas de CPL en windows 95, Microsoft Windows NT 4,0 y versiones posteriores, ya que el rendimiento del panel de control se ve afectado cuando \_ se usa CPL NEWINQUIRE.</span><span class="sxs-lookup"><span data-stu-id="0edfa-139">Your application should process only CPL\_INQUIRE on Windows 95, Microsoft Windows NT 4.0, and later systems since Control Panel performance suffers when CPL\_NEWINQUIRE is used.</span></span> <span data-ttu-id="0edfa-140">Esto se debe a que las cadenas e iconos devueltos no se pueden almacenar en caché.</span><span class="sxs-lookup"><span data-stu-id="0edfa-140">This is because the returned strings and icons cannot be cached.</span></span> <span data-ttu-id="0edfa-141">Se omite el valor devuelto.</span><span class="sxs-lookup"><span data-stu-id="0edfa-141">The return value is ignored.</span></span> |
| [<span data-ttu-id="0edfa-142">**CPL \_ Select**</span><span class="sxs-lookup"><span data-stu-id="0edfa-142">**CPL\_SELECT**</span></span>](cpl-select.md)           | <span data-ttu-id="0edfa-143">Obsoleto.</span><span class="sxs-lookup"><span data-stu-id="0edfa-143">Obsolete.</span></span> <span data-ttu-id="0edfa-144">Las versiones actuales de Windows no envían este mensaje.</span><span class="sxs-lookup"><span data-stu-id="0edfa-144">Current versions of Windows do not send this message.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="0edfa-145">**CPL \_ STARTWPARMS**</span><span class="sxs-lookup"><span data-stu-id="0edfa-145">**CPL\_STARTWPARMS**</span></span>](cpl-startwparms.md) | <span data-ttu-id="0edfa-146">Se envía para notificar a [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) que el usuario ha elegido el icono asociado a un cuadro de diálogo determinado.</span><span class="sxs-lookup"><span data-stu-id="0edfa-146">Sent to notify [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) that the user has chosen the icon associated with a given dialog box.</span></span> <span data-ttu-id="0edfa-147">**CPlApplet** debe mostrar el cuadro de diálogo correspondiente y realizar las tareas especificadas por el usuario.</span><span class="sxs-lookup"><span data-stu-id="0edfa-147">**CPlApplet** should display the corresponding dialog box and carry out any user-specified tasks.</span></span> <span data-ttu-id="0edfa-148">Este mensaje es similar a CPL \_ DBLCLK, pero puede haber información adicional.</span><span class="sxs-lookup"><span data-stu-id="0edfa-148">This message is similar to CPL\_DBLCLK, but there might be some additional information.</span></span> <span data-ttu-id="0edfa-149">El parámetro *lParam1* es el número de elemento del panel de control y *LParam2* es un **LPCTSTR** a cualquier dirección adicional que pueda ser necesaria.</span><span class="sxs-lookup"><span data-stu-id="0edfa-149">The *lParam1* parameter is the Control Panel item number and *lParam2* is an **LPCTSTR** to any extra directions that might be necessary.</span></span> <span data-ttu-id="0edfa-150">Devuelve **true** si este mensaje está controlado; en caso contrario, **false**.</span><span class="sxs-lookup"><span data-stu-id="0edfa-150">Return **TRUE** if this message is handled; otherwise, **FALSE**.</span></span> <span data-ttu-id="0edfa-151">Este mensaje es válido para la [versión 5,00](versions.md) y versiones posteriores de Shell32.dll.</span><span class="sxs-lookup"><span data-stu-id="0edfa-151">This message is valid for [version 5.00](versions.md) and later of Shell32.dll.</span></span>                                                                                         |
| [<span data-ttu-id="0edfa-152">**CPL \_ Stop**</span><span class="sxs-lookup"><span data-stu-id="0edfa-152">**CPL\_STOP**</span></span>](cpl-stop.md)               | <span data-ttu-id="0edfa-153">Se envía una vez por cada elemento del panel de control del archivo. cpl antes de que Windows Descargue la extensión del panel de control.</span><span class="sxs-lookup"><span data-stu-id="0edfa-153">Sent once for each Control Panel item in the .cpl file before Windows unloads the Control Panel extension.</span></span> <span data-ttu-id="0edfa-154">[**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) debe liberar cualquier memoria asociada al número de elemento proporcionado en *lParam1*.</span><span class="sxs-lookup"><span data-stu-id="0edfa-154">[**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) should free any memory associated with the item number provided in *lParam1*.</span></span> <span data-ttu-id="0edfa-155">El parámetro *lParam2* es el puntero **lpData** devuelto en la estructura [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) o [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) del mensaje [**CPL \_ inquire**](cpl-inquire.md) o [**CPL \_ NEWINQUIRE**](cpl-newinquire.md) .</span><span class="sxs-lookup"><span data-stu-id="0edfa-155">The *lParam2* parameter is **lpData** pointer returned in the [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) or [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) structure in the [**CPL\_INQUIRE**](cpl-inquire.md) or [**CPL\_NEWINQUIRE**](cpl-newinquire.md) message.</span></span> <span data-ttu-id="0edfa-156">Se omite el valor devuelto.</span><span class="sxs-lookup"><span data-stu-id="0edfa-156">The return value is ignored.</span></span>                                                                                                                                                                                                       |



 

## <a name="related-topics"></a><span data-ttu-id="0edfa-157">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="0edfa-157">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="0edfa-158">Elementos del panel de control</span><span class="sxs-lookup"><span data-stu-id="0edfa-158">Control Panel Items</span></span>](control-panel-applications.md)
</dt> <dt>

[<span data-ttu-id="0edfa-159">Directrices de la experiencia de usuario</span><span class="sxs-lookup"><span data-stu-id="0edfa-159">User Experience Guidelines</span></span>](user-experience-guidelines.md)
</dt> <dt>

[<span data-ttu-id="0edfa-160">Registrar elementos del panel de control</span><span class="sxs-lookup"><span data-stu-id="0edfa-160">Registering Control Panel Items</span></span>](registering-control-panel-items.md)
</dt> <dt>

[<span data-ttu-id="0edfa-161">Procesamiento de mensajes del panel de control</span><span class="sxs-lookup"><span data-stu-id="0edfa-161">Control Panel Message Processing</span></span>](message-processing.md)
</dt> <dt>

[<span data-ttu-id="0edfa-162">Ejecutar elementos del panel de control</span><span class="sxs-lookup"><span data-stu-id="0edfa-162">Executing Control Panel Items</span></span>](executing-control-panel-items.md)
</dt> <dt>

[<span data-ttu-id="0edfa-163">Extender elementos del panel de control del sistema</span><span class="sxs-lookup"><span data-stu-id="0edfa-163">Extending System Control Panel Items</span></span>](extending-system-control-panel-items.md)
</dt> <dt>

[<span data-ttu-id="0edfa-164">Asignar categorías del panel de control</span><span class="sxs-lookup"><span data-stu-id="0edfa-164">Assigning Control Panel Categories</span></span>](assigning-control-panel-categories.md)
</dt> <dt>

[<span data-ttu-id="0edfa-165">Crear vínculos de tarea que se pueden buscar para un elemento del panel de control</span><span class="sxs-lookup"><span data-stu-id="0edfa-165">Creating Searchable Task Links for a Control Panel Item</span></span>](creating-searchable-task-links.md)
</dt> <dt>

[<span data-ttu-id="0edfa-166">Acceder al panel de control en modo seguro en Windows Vista</span><span class="sxs-lookup"><span data-stu-id="0edfa-166">Accessing the Control Panel in Safe Mode under Windows Vista</span></span>](accessing-the-cp-in-safe-mode-under-vista.md)
</dt> </dl>

 

 
