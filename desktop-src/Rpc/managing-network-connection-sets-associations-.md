---
title: Administración de conjuntos de conexiones de red (asociaciones)
description: A partir de Windows 2000, el tiempo de ejecución de RPC puede mantener más de una conexión entre el cliente y el servidor.
ms.assetid: 9b9c42e9-8ed5-46a6-b6ec-4093ce0128bb
keywords:
- Administración de conjuntos de conexiones de red
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 81e99afe23d90e44d85dc7a2ec9301b45e1f20b1
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/16/2019
ms.locfileid: "104269130"
---
# <a name="managing-network-connection-sets-associations"></a><span data-ttu-id="804ae-104">Administración de conjuntos de conexiones de red (asociaciones)</span><span class="sxs-lookup"><span data-stu-id="804ae-104">Managing Network Connection Sets (Associations)</span></span>

<span data-ttu-id="804ae-105">A partir de Windows 2000, el tiempo de ejecución de RPC puede mantener más de una conexión entre el cliente y el servidor.</span><span class="sxs-lookup"><span data-stu-id="804ae-105">Starting with Windows 2000, the RPC run time may maintain more than one connection between the client and the server.</span></span> <span data-ttu-id="804ae-106">Esto facilita la operación en los transportes que no admiten el cambio de la identidad del cliente sin tener que volver a establecer la conexión, los clientes multiproceso y los clientes asincrónicos.</span><span class="sxs-lookup"><span data-stu-id="804ae-106">This facilitates operation on transports that do not support changing the client identity without reestablishing the connection, multithreaded clients, and asynchronous clients.</span></span> <span data-ttu-id="804ae-107">El conjunto de conexiones entre un proceso de cliente y un punto de conexión de servidor se denomina *Asociación* en la terminología de RPC.</span><span class="sxs-lookup"><span data-stu-id="804ae-107">The set of connections between a client process and a server endpoint is called an *association* in RPC terminology.</span></span> <span data-ttu-id="804ae-108">Comprender las asociaciones puede mejorar la implementación de RPC.</span><span class="sxs-lookup"><span data-stu-id="804ae-108">Understanding associations can improve the implementation of RPC.</span></span>

<span data-ttu-id="804ae-109">En un escenario de identidad de un solo subproceso y de un solo cliente, RPC abre una conexión entre un proceso de cliente y un punto de conexión de servidor para realizar llamadas RPC.</span><span class="sxs-lookup"><span data-stu-id="804ae-109">In a single-thread, single-client identity scenario, RPC opens one connection between a client process and a server endpoint to make RPC calls.</span></span> <span data-ttu-id="804ae-110">Cuando se realiza una llamada RPC sincrónica, el cliente envía la solicitud al servidor en esta conexión y recibe también la respuesta.</span><span class="sxs-lookup"><span data-stu-id="804ae-110">When a synchronous RPC call is made, the client sends the request to the server on this connection, and receives the reply on it as well.</span></span> <span data-ttu-id="804ae-111">Cuando crece el número de subprocesos que realizan llamadas RPC en el proceso del cliente, la identidad de seguridad del cliente puede cambiar.</span><span class="sxs-lookup"><span data-stu-id="804ae-111">When the number of threads making RPC calls in the client process grows, the security identity of the client can change.</span></span> <span data-ttu-id="804ae-112">Cuando se mezclan llamadas asincrónicas/canalizaciones con llamadas sincrónicas en el cliente, RPC puede necesitar más de una conexión de red.</span><span class="sxs-lookup"><span data-stu-id="804ae-112">When asynchronous/pipe calls are mixed with synchronous calls on the client, RPC may need more than one network connection.</span></span> <span data-ttu-id="804ae-113">Todas las conexiones del conjunto se colocan en un grupo de conexiones denominado Asociación.</span><span class="sxs-lookup"><span data-stu-id="804ae-113">All connections in the set are put in a connection pool called an association.</span></span>

<span data-ttu-id="804ae-114">Una llamada a procedimiento remoto sincrónico utiliza exclusivamente una conexión determinada para cumplir con los estándares de RPC.</span><span class="sxs-lookup"><span data-stu-id="804ae-114">A synchronous remote procedure call exclusively uses a given connection to conform with RPC standards.</span></span> <span data-ttu-id="804ae-115">Una conexión utilizada por una llamada RPC sincrónica se considera ocupada si se ha enviado una solicitud, pero no se ha recibido una respuesta.</span><span class="sxs-lookup"><span data-stu-id="804ae-115">A connection used by a synchronous RPC call is considered busy if a request has been sent, but a response has not been received.</span></span> <span data-ttu-id="804ae-116">No se permite ningún otro tráfico en esa conexión hasta que se reciba la respuesta.</span><span class="sxs-lookup"><span data-stu-id="804ae-116">No other traffic is allowed on that connection until the response is received.</span></span> <span data-ttu-id="804ae-117">El tiempo de ejecución de RPC intenta multiplexar llamadas RPC asincrónicas y de canalización en la misma conexión.</span><span class="sxs-lookup"><span data-stu-id="804ae-117">The RPC run time attempts to multiplex asynchronous and pipe RPC calls on the same connection.</span></span> <span data-ttu-id="804ae-118">No se pueden mezclar llamadas sincrónicas y asincrónicas/canalizaciones en la misma conexión, lo que significa que se puede usar una conexión determinada para llamadas RPC sincrónicas o para llamadas RPC asincrónicas o de canalización.</span><span class="sxs-lookup"><span data-stu-id="804ae-118">Synchronous and asynchronous/pipe calls cannot be mixed on the same connection, which means that a given connection can be used for either synchronous RPC calls or for asynchronous/pipe RPC calls.</span></span>

<span data-ttu-id="804ae-119">RPC intenta de forma agresiva volver a usar las conexiones del grupo.</span><span class="sxs-lookup"><span data-stu-id="804ae-119">RPC aggressively tries to reuse connections from the pool.</span></span> <span data-ttu-id="804ae-120">Cuando se realiza una nueva llamada RPC, RPC intenta encontrar una conexión adecuada del grupo y crea una nueva conexión solo si no se encuentra una conexión adecuada.</span><span class="sxs-lookup"><span data-stu-id="804ae-120">When a new RPC call is made, RPC attempts to find a suitable connection from the pool, and creates a new connection only if a suitable connection cannot be found.</span></span> <span data-ttu-id="804ae-121">Para que una conexión se considere adecuada, debe:</span><span class="sxs-lookup"><span data-stu-id="804ae-121">For a connection to be considered suitable, it must:</span></span>

-   <span data-ttu-id="804ae-122">Ser del tipo adecuado (sincrónico o asincrónico/canalización).</span><span class="sxs-lookup"><span data-stu-id="804ae-122">Be of the appropriate type (synchronous, or asynchronous/pipe).</span></span>
-   <span data-ttu-id="804ae-123">Sea gratuito.</span><span class="sxs-lookup"><span data-stu-id="804ae-123">Be free.</span></span>
-   <span data-ttu-id="804ae-124">Tienen la misma identidad de seguridad que el controlador de enlace en el que se realiza la llamada.</span><span class="sxs-lookup"><span data-stu-id="804ae-124">Have the same security identity as the binding handle on which the call is made.</span></span> <span data-ttu-id="804ae-125">Si se utiliza el seguimiento de identidad dinámica, la identidad del identificador de enlace se actualiza desde el token del subproceso al principio de la llamada.</span><span class="sxs-lookup"><span data-stu-id="804ae-125">If dynamic identity tracking is used, the identity of the binding handle is refreshed from the thread token at the beginning of the call.</span></span> <span data-ttu-id="804ae-126">Si se utiliza el seguimiento de identidad estático, se usa la identidad del cliente marcada en el identificador de enlace.</span><span class="sxs-lookup"><span data-stu-id="804ae-126">If static identity tracking is used, the client identity stamped on the binding handle is used.</span></span>

<span data-ttu-id="804ae-127">Cuando se completa la llamada, una vez recibida la respuesta, la conexión se marca como gratuita y se puede usar para otras llamadas RPC.</span><span class="sxs-lookup"><span data-stu-id="804ae-127">When the call is complete, once the response is received, the connection is marked as free and can be used for other RPC calls.</span></span>

<span data-ttu-id="804ae-128">No se puede cambiar la identidad de seguridad en una conexión.</span><span class="sxs-lookup"><span data-stu-id="804ae-128">The security identity on a connection cannot change.</span></span> <span data-ttu-id="804ae-129">Por ejemplo, si se realiza un gran número de llamadas al mismo servidor en identidades de seguridad diferentes, el número de conexiones en el grupo de subprocesos crece.</span><span class="sxs-lookup"><span data-stu-id="804ae-129">For example, if a large number of calls to the same server are made under different security identities, the number of connections in the thread pool grows.</span></span> <span data-ttu-id="804ae-130">La propia asociación se cuenta como referencia y, cuando todas las referencias han desaparecido, detiene y cierra todas las conexiones.</span><span class="sxs-lookup"><span data-stu-id="804ae-130">The association itself is reference-counted, and when all references are gone, it stops and closes all connections.</span></span> <span data-ttu-id="804ae-131">Cada identificador de enlace y cada identificador de contexto contienen una referencia en la asociación.</span><span class="sxs-lookup"><span data-stu-id="804ae-131">Every binding handle and every context handle hold a reference on the association.</span></span> <span data-ttu-id="804ae-132">Cuando se cierra todo, la Asociación desaparece.</span><span class="sxs-lookup"><span data-stu-id="804ae-132">When all are closed, the association disappears.</span></span> <span data-ttu-id="804ae-133">En Windows XP, las asociaciones no desaparecen necesariamente inmediatamente; pueden permanecer durante un breve período (el período de destino es de 20 segundos, pero el tiempo de ejecución de RPC puede optar por retrasar la destrucción de la asociación si no hay ningún subproceso disponible para ejecutar la tarea).</span><span class="sxs-lookup"><span data-stu-id="804ae-133">On Windows XP, associations do not necessarily disappear immediately; they may remain for a short period (the target period is 20 seconds, but the RPC run time may choose to delay destroying the association if no threads are available to execute the task).</span></span> <span data-ttu-id="804ae-134">Si no desea que la Asociación permanezca activa después de que se cierre el último identificador de contexto o identificador de enlace, use la opción no persistente de RPC \_ C \_ \_ \_ para forzar al tiempo de ejecución de RPC a cerrar inmediatamente la conexión.</span><span class="sxs-lookup"><span data-stu-id="804ae-134">If you do not want the association to stay alive after the last context handle/binding handle is closed, use the RPC\_C\_OPT\_DONT\_LINGER option to force the RPC Runtime to immediately close the connection.</span></span>

 

 




