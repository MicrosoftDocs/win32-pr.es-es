---
description: La estructura WSAQUERYSET se usa para crear consultas para la función NSPLookupServiceBegin y se usa para proporcionar los resultados de la consulta para la función NSPLookupServiceNext.
ms.assetid: 017b5828-bc6e-42b7-aba7-21648b2dd707
title: Query-Related estructuras de datos en el SPI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 57ce5a7016bd2ad96f464137177036b470c64a95
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104568531"
---
# <a name="query-related-data-structures-in-the-spi"></a><span data-ttu-id="28f34-103">Query-Related estructuras de datos en el SPI</span><span class="sxs-lookup"><span data-stu-id="28f34-103">Query-Related Data Structures in the SPI</span></span>

<span data-ttu-id="28f34-104">La estructura [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) se usa para formar consultas de [**NSPLookupServiceBegin**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicebegin)y se usa para proporcionar los resultados de la consulta para [**NSPLookupServiceNext**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicenext).</span><span class="sxs-lookup"><span data-stu-id="28f34-104">The [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) structure is used to form queries for [**NSPLookupServiceBegin**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicebegin), and used to deliver query results for [**NSPLookupServiceNext**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicenext).</span></span> <span data-ttu-id="28f34-105">Es una estructura compleja porque contiene punteros a varias estructuras, algunas de las cuales hacen referencia a otras estructuras.</span><span class="sxs-lookup"><span data-stu-id="28f34-105">It is a complex structure because it contains pointers to several other structures, some of which reference still other structures.</span></span> <span data-ttu-id="28f34-106">La relación entre **WSAQUERYSET** y las estructuras a las que hace referencia se ilustra de la manera siguiente:</span><span class="sxs-lookup"><span data-stu-id="28f34-106">The relationship between **WSAQUERYSET** and the structures it references is illustrated as follows:</span></span>

![estructuras wsaqueryset](images/ovrvw3-2.png)

<span data-ttu-id="28f34-108">Dentro de la estructura [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) , la mayoría de los miembros se explican por sí solos, pero algunos merecen una explicación adicional.</span><span class="sxs-lookup"><span data-stu-id="28f34-108">Within the [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) structure, most of the members are self explanatory, but some deserve additional explanation.</span></span> <span data-ttu-id="28f34-109">El **dwSize** se rellenará con sizeof ( **WSAQUERYSET**) y los proveedores de espacios de nombres pueden utilizarlo para detectar y adaptarse a las diferentes versiones de la estructura **WSAQUERYSET** que pueden aparecer.</span><span class="sxs-lookup"><span data-stu-id="28f34-109">The **dwSize** will be filled in with sizeof( **WSAQUERYSET**), and can be used by namespace providers to detect and adapt to different versions of the **WSAQUERYSET** structure that may appear.</span></span>

<span data-ttu-id="28f34-110">Un proveedor de espacios de nombres usa el miembro **dwOutputFlags** para proporcionar datos adicionales sobre los resultados de la consulta.</span><span class="sxs-lookup"><span data-stu-id="28f34-110">The **dwOutputFlags** member is used by a namespace provider to provide additional data about query results.</span></span> <span data-ttu-id="28f34-111">Para obtener más información, vea [**NSPLookupServiceNext**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicenext).</span><span class="sxs-lookup"><span data-stu-id="28f34-111">For more information, see [**NSPLookupServiceNext**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicenext).</span></span>

<span data-ttu-id="28f34-112">La estructura [**WSAECOMPARATOR**](/windows/desktop/api/Winsock2/ne-winsock2-wsaecomparator) a la que hace referencia **lpversion** se utiliza para la restricción de consulta y los resultados.</span><span class="sxs-lookup"><span data-stu-id="28f34-112">The [**WSAECOMPARATOR**](/windows/desktop/api/Winsock2/ne-winsock2-wsaecomparator) structure referenced by **lpversion** is used for both query constraint and results.</span></span> <span data-ttu-id="28f34-113">En el caso de las consultas, el miembro **dwVersion** indica la versión deseada del servicio.</span><span class="sxs-lookup"><span data-stu-id="28f34-113">For queries, the **dwVersion** member indicates the desired version of the service.</span></span> <span data-ttu-id="28f34-114">El miembro **ecHow** es un tipo enumerado que especifica cómo se realizará la comparación.</span><span class="sxs-lookup"><span data-stu-id="28f34-114">The **ecHow** member is an enumerated type which specifies how the comparison will be made.</span></span> <span data-ttu-id="28f34-115">Las opciones son \_ igual a, lo que requiere que se produzca una coincidencia exacta en la versión, o COMP \_ NOTLESS, que especifica que el número de versión del servicio no es menor que el valor de **dwVersion**.</span><span class="sxs-lookup"><span data-stu-id="28f34-115">The choices are COMP\_EQUALS which requires that an exact match in version occurs, or COMP\_NOTLESS which specifies that the service's version number be no less than the value of **dwVersion**.</span></span>

<span data-ttu-id="28f34-116">La interpretación de **dwNameSpace** y **lpNSProviderId** depende de cómo se use la estructura y se describe con más detalle en las descripciones de funciones individuales que utilizan esta estructura.</span><span class="sxs-lookup"><span data-stu-id="28f34-116">The interpretation of **dwNameSpace** and **lpNSProviderId** depends upon how the structure is being used and is described further in the individual function descriptions that utilize this structure.</span></span>

<span data-ttu-id="28f34-117">El miembro **lpszContext** se aplica a los espacios de nombres jerárquicos y especifica el punto inicial de una consulta o la ubicación dentro de la jerarquía en la que reside el servicio.</span><span class="sxs-lookup"><span data-stu-id="28f34-117">The **lpszContext** member applies to hierarchical namespaces, and specifies the starting point of a query or the location within the hierarchy where the service resides.</span></span> <span data-ttu-id="28f34-118">Las reglas generales son las siguientes:</span><span class="sxs-lookup"><span data-stu-id="28f34-118">The general rules are:</span></span>

-   <span data-ttu-id="28f34-119">Un valor **null** en blanco ("") iniciará la búsqueda en el contexto predeterminado.</span><span class="sxs-lookup"><span data-stu-id="28f34-119">A value of **NULL**, blank ("") will start the search at the default context.</span></span>
-   <span data-ttu-id="28f34-120">Un valor de " \\ " inicia la búsqueda en la parte superior del espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="28f34-120">A value of "\\" starts the search at the top of the namespace.</span></span>
-   <span data-ttu-id="28f34-121">Cualquier otro valor inicia la búsqueda en el punto designado.</span><span class="sxs-lookup"><span data-stu-id="28f34-121">Any other value starts the search at the designated point.</span></span>

<span data-ttu-id="28f34-122">Los proveedores que no admiten la contención pueden devolver un error si se especifica un valor distinto de "" o " \\ ".</span><span class="sxs-lookup"><span data-stu-id="28f34-122">Providers that do not support containment may return an error if anything other than "" or "\\" is specified.</span></span> <span data-ttu-id="28f34-123">Los proveedores que admiten la contención limitada, como los grupos, deben aceptar "", " \\ " o un punto designado.</span><span class="sxs-lookup"><span data-stu-id="28f34-123">Providers that support limited containment, such as groups, should accept "", '\\", or a designated point.</span></span> <span data-ttu-id="28f34-124">Los contextos son específicos del espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="28f34-124">Contexts are namespace specific.</span></span> <span data-ttu-id="28f34-125">Si **dwNameSpace** es NS \_ All, solo se debe pasar "" o " \\ " como contexto, ya que todos los espacios de nombres lo reconocen.</span><span class="sxs-lookup"><span data-stu-id="28f34-125">If **dwNameSpace** is NS\_ALL, then only "" or "\\" should be passed as the context because these are recognized by all namespaces.</span></span>

<span data-ttu-id="28f34-126">El miembro **lpszQueryString** se usa para proporcionar información adicional sobre la consulta específica del espacio de nombres, como una cadena que describe un servicio conocido y un nombre de protocolo de transporte, como en "FTP/TCP".</span><span class="sxs-lookup"><span data-stu-id="28f34-126">The **lpszQueryString** member is used to supply additional, namespace-specific query information such as a string describing a well-known service and transport protocol name, as in "ftp/tcp".</span></span>

<span data-ttu-id="28f34-127">La estructura [**AFPROTOCOLS**](/windows/desktop/api/Winsock2/ns-winsock2-afprotocols) a la que hace referencia **lpafpProtocols** se usa solo con fines de consulta y proporciona una lista de protocolos para restringir la consulta.</span><span class="sxs-lookup"><span data-stu-id="28f34-127">The [**AFPROTOCOLS**](/windows/desktop/api/Winsock2/ns-winsock2-afprotocols) structure referenced by **lpafpProtocols** is used for query purposes only, and supplies a list of protocols to constrain the query.</span></span> <span data-ttu-id="28f34-128">Estos protocolos se representan como pares de familia de direcciones, protocolos, porque los valores de protocolo solo tienen significado dentro del contexto de una familia de direcciones.</span><span class="sxs-lookup"><span data-stu-id="28f34-128">These protocols are represented as (address family, protocol) pairs, because protocol values only have meaning within the context of an address family.</span></span>

<span data-ttu-id="28f34-129">La matriz de la estructura de [**\_ información de CSADDR**](/windows/win32/api/ws2def/ns-ws2def-csaddr_info) a la que hace referencia **lpcsaBuffer** contiene toda la información necesaria para que un servicio pueda usarse en el establecimiento de una escucha, o un cliente para usarlo en el establecimiento de una conexión con el servicio.</span><span class="sxs-lookup"><span data-stu-id="28f34-129">The array of [**CSADDR\_INFO**](/windows/win32/api/ws2def/ns-ws2def-csaddr_info) structure referenced by **lpcsaBuffer** contains all of the information required for either a service to use in establishing a listen, or a client to use in establishing a connection to the service.</span></span> <span data-ttu-id="28f34-130">Los miembros **LocalAddr** y **RemoteAddr** contienen directamente una estructura [**de \_ dirección de socket**](/windows/desktop/api/Ws2def/ns-ws2def-socket_address) .</span><span class="sxs-lookup"><span data-stu-id="28f34-130">The **LocalAddr** and **RemoteAddr** members both directly contain a [**SOCKET\_ADDRESS**](/windows/desktop/api/Ws2def/ns-ws2def-socket_address) structure.</span></span> <span data-ttu-id="28f34-131">Un servicio crearía un socket mediante la tupla (LocalAddr. lpSockaddr->\_ familia SA, iSocketType, iProtocol).</span><span class="sxs-lookup"><span data-stu-id="28f34-131">A service would create a socket using the tuple (LocalAddr.lpSockaddr->sa\_family, iSocketType, iProtocol).</span></span> <span data-ttu-id="28f34-132">Enlazaría el socket a una dirección local mediante LocalAddr. lpSockaddr y LocalAddr. lpSockaddrLength.</span><span class="sxs-lookup"><span data-stu-id="28f34-132">It would bind the socket to a local address using LocalAddr.lpSockaddr, and LocalAddr.lpSockaddrLength.</span></span> <span data-ttu-id="28f34-133">El cliente crea su socket con la tupla (RemoteAddr. lpSockaddr->\_ familia SA, iSocketType, iProtocol) y usa la combinación de RemoteAddr. lpSockaddr y RemoteAddr. lpSockaddrLength al establecer una conexión remota.</span><span class="sxs-lookup"><span data-stu-id="28f34-133">The client creates its socket with the tuple (RemoteAddr.lpSockaddr->sa\_family, iSocketType, iProtocol), and uses the combination of RemoteAddr.lpSockaddr, and RemoteAddr.lpSockaddrLength when making a remote connection.</span></span>

 

 
