---
title: Notificación de datos
description: A veces es necesario informar a los objetos que consumen datos de un origen externo cuando cambian los datos de ese origen.
ms.assetid: 286a1ecf-5255-4443-a17d-5ffa55ed0be1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 49df9e6bb7d9b15192473b18114fe7fcd69ecedf
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/21/2020
ms.locfileid: "105705041"
---
# <a name="data-notification"></a><span data-ttu-id="59960-103">Notificación de datos</span><span class="sxs-lookup"><span data-stu-id="59960-103">Data Notification</span></span>

<span data-ttu-id="59960-104">A veces es necesario informar a los objetos que consumen datos de un origen externo cuando cambian los datos de ese origen.</span><span class="sxs-lookup"><span data-stu-id="59960-104">Objects that consume data from an external source sometimes need to be informed when data in that source changes.</span></span> <span data-ttu-id="59960-105">Por ejemplo, se debe notificar a un visor de cintas de tablero de cotizaciones que se base en los datos de una hoja de cálculo cuando cambien los datos para que pueda actualizar su presentación.</span><span class="sxs-lookup"><span data-stu-id="59960-105">For example, a stock ticker tape viewer that relies on data in some spreadsheet needs to be notified when that data changes so it can update its display.</span></span> <span data-ttu-id="59960-106">De forma similar, un documento compuesto necesita información sobre los cambios de datos en los objetos incrustados para que pueda actualizar sus cachés de datos.</span><span class="sxs-lookup"><span data-stu-id="59960-106">Similarly, a compound document needs information about data changes in its embedded objects so that it can update its data caches.</span></span> <span data-ttu-id="59960-107">En casos como este, en el que es deseable la actualización dinámica de los datos, los orígenes de datos requieren algún mecanismo para notificar a los consumidores de datos los cambios a medida que se producen sin obligar a los consumidores a quitar todo el código con el fin de actualizar los datos.</span><span class="sxs-lookup"><span data-stu-id="59960-107">In cases such as this, where dynamic updating of data is desirable, sources of data require some mechanism of notifying data consumers of changes as they occur without obligating the consumers to drop everything in order to update their data.</span></span> <span data-ttu-id="59960-108">Idealmente, una vez que se ha notificado que se ha producido un cambio en el origen de datos, un objeto consumidor puede solicitar una copia actualizada en su tiempo de ocio.</span><span class="sxs-lookup"><span data-stu-id="59960-108">Ideally, having been notified that a change has occurred in the data source, a consuming object can ask for an updated copy at its leisure.</span></span>

<span data-ttu-id="59960-109">El mecanismo de COM para controlar las notificaciones asincrónicas de este tipo es un objeto denominado receptor de notificaciones, que es simplemente cualquier objeto COM que implementa una interfaz denominada [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink).</span><span class="sxs-lookup"><span data-stu-id="59960-109">COM's mechanism for handling asynchronous notifications of this type is an object called an advise sink, which is simply any COM object that implements an interface called [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink).</span></span> <span data-ttu-id="59960-110">Los consumidores de datos implementan **IAdviseSink**.</span><span class="sxs-lookup"><span data-stu-id="59960-110">Consumers of data implement the **IAdviseSink**.</span></span> <span data-ttu-id="59960-111">Se registran para recibir notificaciones mediante la entrega de un puntero al objeto de datos de interés.</span><span class="sxs-lookup"><span data-stu-id="59960-111">They register to receive notifications by handing a pointer to the data object of interest.</span></span>

<span data-ttu-id="59960-112">Las interfaces [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) exponen los métodos siguientes para recibir notificaciones asincrónicas:</span><span class="sxs-lookup"><span data-stu-id="59960-112">The [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) interfaces exposes the following methods for receiving asynchronous notifications:</span></span>



| <span data-ttu-id="59960-113">Método</span><span class="sxs-lookup"><span data-stu-id="59960-113">Method</span></span>                                                      | <span data-ttu-id="59960-114">Notifica al receptor de notificaciones que</span><span class="sxs-lookup"><span data-stu-id="59960-114">Notifies the advise sink that</span></span>                                            |
|-------------------------------------------------------------|--------------------------------------------------------------------------|
| [<span data-ttu-id="59960-115">**OnDataChange**</span><span class="sxs-lookup"><span data-stu-id="59960-115">**OnDataChange**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange)<br/> | <span data-ttu-id="59960-116">Los datos del objeto que realiza la llamada han cambiado.</span><span class="sxs-lookup"><span data-stu-id="59960-116">The calling object's data has changed.</span></span><br/>                        |
| [<span data-ttu-id="59960-117">**OnViewChange**</span><span class="sxs-lookup"><span data-stu-id="59960-117">**OnViewChange**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onviewchange)<br/> | <span data-ttu-id="59960-118">Las instrucciones para dibujar el objeto que realiza la llamada han cambiado.</span><span class="sxs-lookup"><span data-stu-id="59960-118">The instructions for drawing the calling object have changed.</span></span><br/> |
| [<span data-ttu-id="59960-119">**OnRename**</span><span class="sxs-lookup"><span data-stu-id="59960-119">**OnRename**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onrename)<br/>         | <span data-ttu-id="59960-120">El moniker del objeto que realiza la llamada ha cambiado.</span><span class="sxs-lookup"><span data-stu-id="59960-120">The calling object's moniker has changed.</span></span><br/>                     |
| [<span data-ttu-id="59960-121">**OnSave**</span><span class="sxs-lookup"><span data-stu-id="59960-121">**OnSave**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onsave)<br/>             | <span data-ttu-id="59960-122">El objeto que realiza la llamada se ha guardado en el almacenamiento persistente.</span><span class="sxs-lookup"><span data-stu-id="59960-122">The calling object has been saved to persistent storage.</span></span><br/>      |
| [<span data-ttu-id="59960-123">**OnClose**</span><span class="sxs-lookup"><span data-stu-id="59960-123">**OnClose**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onclose)<br/>           | <span data-ttu-id="59960-124">El objeto que realiza la llamada se ha cerrado.</span><span class="sxs-lookup"><span data-stu-id="59960-124">The calling object has been closed.</span></span><br/>                           |



 

<span data-ttu-id="59960-125">Como indica la tabla, la interfaz [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) expone métodos para notificar al receptor de notificaciones de eventos distintos de los cambios en los datos del objeto que realiza la llamada.</span><span class="sxs-lookup"><span data-stu-id="59960-125">As the table indicates, the [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) interface exposes methods for notifying the advise sink of events other than changes in the calling object's data.</span></span> <span data-ttu-id="59960-126">El objeto que realiza la llamada también puede notificar al receptor el modo en que se dibujan los cambios, o bien se le cambia el nombre, se guarda o se cierra.</span><span class="sxs-lookup"><span data-stu-id="59960-126">The calling object can also notify the sink when the way in which it draws itself changes, or it is renamed, saved, or closed.</span></span> <span data-ttu-id="59960-127">Estas otras notificaciones se utilizan principalmente o por completo en el contexto de documentos compuestos, aunque el mecanismo de notificación es idéntico.</span><span class="sxs-lookup"><span data-stu-id="59960-127">These other notifications are used mainly or entirely in the context of compound documents, although the notification mechanism is identical.</span></span> <span data-ttu-id="59960-128">Para obtener más información sobre las notificaciones de documentos compuestos, vea "documentos compuestos".</span><span class="sxs-lookup"><span data-stu-id="59960-128">For more information on compound-document notifications, see "Compound Documents."</span></span>

<span data-ttu-id="59960-129">Con el fin de aprovechar el receptor de notificaciones, un origen de datos debe implementar [**IDataObject::D Advise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dadvise), [**IDataObject::D unvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dunadvise)y [**IDataObject:: EnumDAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise).</span><span class="sxs-lookup"><span data-stu-id="59960-129">In order to take advantage of the advise sink, a data source must implement [**IDataObject::DAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dadvise), [**IDataObject::DUnadvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dunadvise), and [**IDataObject::EnumDAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise).</span></span> <span data-ttu-id="59960-130">Un consumidor de datos llama a **DAdvise** método para notificar a un objeto de datos que desea recibir una notificación cuando cambien los datos del objeto.</span><span class="sxs-lookup"><span data-stu-id="59960-130">A data consumer calls the **DAdvise** mothod to notify a data object that it wishes to be notified when the object's data changes.</span></span> <span data-ttu-id="59960-131">El objeto consumidor llama al método **DUnadvise** para anular esta conexión.</span><span class="sxs-lookup"><span data-stu-id="59960-131">The consuming object calls the **DUnadvise** method to tear down this connection.</span></span> <span data-ttu-id="59960-132">Cualquier entidad interesada puede llamar al método **EnumDAdvise** para conocer el número de objetos que tienen una conexión de consulta con un objeto de datos.</span><span class="sxs-lookup"><span data-stu-id="59960-132">Any interested party can call the **EnumDAdvise** method to learn the number of objects having an advisory connection with a data object.</span></span>

<span data-ttu-id="59960-133">Cuando los datos cambian en el origen, el objeto de datos llama a [**IAdviseSink:: OnDataChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange) en todos los consumidores de datos que se han registrado para recibir notificaciones.</span><span class="sxs-lookup"><span data-stu-id="59960-133">When data changes at the source, the data object calls [**IAdviseSink::OnDataChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange) on all data consumers that have registered to receive notifications.</span></span> <span data-ttu-id="59960-134">Para realizar un seguimiento de las conexiones de consulta y administrar el envío de notificaciones, los orígenes de datos se basan en un objeto denominado titular de una notificación de *datos*.</span><span class="sxs-lookup"><span data-stu-id="59960-134">To keep track of advisory connections and manage the dispatch of notifications, data sources rely on an object called a *data advise holder*.</span></span> <span data-ttu-id="59960-135">Puede crear su propio titular de notificaciones de datos mediante la implementación de la interfaz [**IDataAdviseHolder**](/windows/desktop/api/ObjIdl/nn-objidl-idataadviseholder) .</span><span class="sxs-lookup"><span data-stu-id="59960-135">You can create your own data advise holder by implementing the [**IDataAdviseHolder**](/windows/desktop/api/ObjIdl/nn-objidl-idataadviseholder) interface.</span></span> <span data-ttu-id="59960-136">O bien, puede dejar que COM lo haga por usted mediante una llamada a la función auxiliar [**CreateDataAdviseHolder**](/windows/win32/api/ole2/nf-ole2-createdataadviseholder).</span><span class="sxs-lookup"><span data-stu-id="59960-136">Or, you can let COM do it for you by calling the helper function [**CreateDataAdviseHolder**](/windows/win32/api/ole2/nf-ole2-createdataadviseholder).</span></span>

## <a name="related-topics"></a><span data-ttu-id="59960-137">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="59960-137">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="59960-138">Transferencia de datos</span><span class="sxs-lookup"><span data-stu-id="59960-138">Data Transfer</span></span>](data-transfer.md)
</dt> </dl>

 

