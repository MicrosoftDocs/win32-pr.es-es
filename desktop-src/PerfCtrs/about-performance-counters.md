---
description: Los contadores se utilizan para proporcionar información sobre el rendimiento del sistema operativo o de una aplicación, servicio o controlador.
ms.assetid: d172a131-61d3-4fc1-8e0c-b07b2bd34f80
title: Acerca de los contadores de rendimiento
ms.topic: article
ms.date: 08/17/2020
ms.openlocfilehash: dec7c71e99ab614ee64e3d1e8c9620f0be78c14a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "103909754"
---
# <a name="about-performance-counters"></a><span data-ttu-id="d493a-103">Acerca de los contadores de rendimiento</span><span class="sxs-lookup"><span data-stu-id="d493a-103">About Performance Counters</span></span>

<span data-ttu-id="d493a-104">Los contadores de rendimiento de Windows proporcionan una capa de abstracción de alto nivel con una interfaz coherente para recopilar diversos tipos de datos del sistema, como la CPU, la memoria y las estadísticas de uso del disco.</span><span class="sxs-lookup"><span data-stu-id="d493a-104">Windows Performance Counters provide a high-level abstraction layer with a consistent interface for collecting various kinds of system data such as CPU, memory, and disk usage statistics.</span></span> <span data-ttu-id="d493a-105">Los administradores del sistema usan contadores de rendimiento para supervisar los problemas de rendimiento o de comportamiento.</span><span class="sxs-lookup"><span data-stu-id="d493a-105">System administrators use performance counters to monitor for performance or behavior problems.</span></span> <span data-ttu-id="d493a-106">Los desarrolladores de software usan contadores de rendimiento para inspeccionar el uso de los recursos de sus componentes.</span><span class="sxs-lookup"><span data-stu-id="d493a-106">Software developers use performance counters to inspect the resource usage of their components.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d493a-107">Los contadores de rendimiento de Windows están optimizados para la recopilación y detección de datos administrativos y de diagnóstico.</span><span class="sxs-lookup"><span data-stu-id="d493a-107">Windows Performance Counters are optimized for administrative/diagnostic data discovery and collection.</span></span> <span data-ttu-id="d493a-108">No son adecuados para la recopilación de datos de alta frecuencia ni para la generación de perfiles de aplicaciones, ya que no están diseñadas para recopilarse más de una vez por segundo.</span><span class="sxs-lookup"><span data-stu-id="d493a-108">They are not appropriate for high-frequency data collection or for application profiling since they are not designed to be collected more than once per second.</span></span> <span data-ttu-id="d493a-109">Para el acceso de menor sobrecarga a la información del sistema, es posible que prefiera más API directas como la [**aplicación auxiliar de estado de proceso**](../psapi/process-status-helper.md), [**GlobalMemoryStatusEx**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-globalmemorystatusex), [**GetSystemTimes**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getsystemtimes)o [**GetProcessTimes**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getprocesstimes).</span><span class="sxs-lookup"><span data-stu-id="d493a-109">For lower-overhead access to system information, you might prefer more direct APIs such as [**Process Status Helper**](../psapi/process-status-helper.md), [**GlobalMemoryStatusEx**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-globalmemorystatusex), [**GetSystemTimes**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getsystemtimes), or [**GetProcessTimes**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getprocesstimes).</span></span> <span data-ttu-id="d493a-110">Para la generación de perfiles, puede recopilar registros de ETW con datos de generación de perfiles del sistema mediante [**tracelog.exe**](/windows-hardware/drivers/devtest/tracelog) con `-critsec` `-dpcisr` `-eflag` las opciones,, o `-ProfileSource` , o puede usar la [**generación de perfiles de contadores de hardware**](/previous-versions/windows/desktop/hcp/hcp-reference).</span><span class="sxs-lookup"><span data-stu-id="d493a-110">For profiling, you might collect ETW logs with system profiling data using [**tracelog.exe**](/windows-hardware/drivers/devtest/tracelog) with `-critsec`, `-dpcisr`, `-eflag`, or `-ProfileSource` options, or you might use [**Hardware Counter Profiling**](/previous-versions/windows/desktop/hcp/hcp-reference).</span></span>

> [!NOTE]
> <span data-ttu-id="d493a-111">No confunda los contadores de rendimiento de Windows con la API de [**QueryPerformanceCounter**](/windows/win32/api/profileapi/nf-profileapi-queryperformancecounter) .</span><span class="sxs-lookup"><span data-stu-id="d493a-111">Do not confuse Windows Performance Counters with the [**QueryPerformanceCounter**](/windows/win32/api/profileapi/nf-profileapi-queryperformancecounter) API.</span></span> <span data-ttu-id="d493a-112">Los contadores de rendimiento de Windows proporcionan una abstracción de alto nivel para muchos tipos de información del sistema.</span><span class="sxs-lookup"><span data-stu-id="d493a-112">Windows Performance Counters provide a high-level abstraction for many kinds of system information.</span></span> <span data-ttu-id="d493a-113">La función QueryPerformanceCounter proporciona acceso optimizado a una marca de tiempo de alta precisión.</span><span class="sxs-lookup"><span data-stu-id="d493a-113">The QueryPerformanceCounter function provides optimized access to a high-precision timestamp.</span></span>

## <a name="getting-started"></a><span data-ttu-id="d493a-114">Introducción</span><span class="sxs-lookup"><span data-stu-id="d493a-114">Getting Started</span></span>

- <span data-ttu-id="d493a-115">Use [las herramientas del contador de rendimiento](performance-counters-tools.md) si desea recopilar o ver los datos de rendimiento de un sistema.</span><span class="sxs-lookup"><span data-stu-id="d493a-115">Use [Performance Counter Tools](performance-counters-tools.md) when you want to collect or view the performance data from a system.</span></span>
- <span data-ttu-id="d493a-116">Use las [API de recopilación de contadores de rendimiento](consuming-counter-data.md) cuando desee escribir un script o un programa que recopile datos de rendimiento del sistema local.</span><span class="sxs-lookup"><span data-stu-id="d493a-116">Use [Performance Counter Collection APIs](consuming-counter-data.md) when you want to write a script or a program that collects performance data from the local system.</span></span>
- <span data-ttu-id="d493a-117">Use [clases de contador de rendimiento de WMI](/windows/desktop/WmiSdk/monitoring-performance-data) si desea recopilar datos de rendimiento de un sistema local o remoto mediante WMI.</span><span class="sxs-lookup"><span data-stu-id="d493a-117">Use [WMI Performance Counter Classes](/windows/desktop/WmiSdk/monitoring-performance-data) when you want to collect performance data from a local or remote system using WMI.</span></span>
- <span data-ttu-id="d493a-118">Use las [API de proveedor de contador de rendimiento](providing-counter-data.md) cuando desee publicar datos de rendimiento desde el componente de software.</span><span class="sxs-lookup"><span data-stu-id="d493a-118">Use [Performance Counter Provider APIs](providing-counter-data.md) when you want to publish performance data from your software component.</span></span>

## <a name="concepts"></a><span data-ttu-id="d493a-119">Conceptos</span><span class="sxs-lookup"><span data-stu-id="d493a-119">Concepts</span></span>

<span data-ttu-id="d493a-120">El sistema de contador de rendimiento de Windows se organiza en **consumidores**, **proveedores**, **contraconjuntos**, **contadores**, **instancias** y **valores de contador**.</span><span class="sxs-lookup"><span data-stu-id="d493a-120">The Windows Performance Counter system is organized into **consumers**, **providers**, **countersets**, **counters**, **instances**, and **counter values**.</span></span>

<span data-ttu-id="d493a-121">Un **consumidor** es un componente de software que hace uso de los datos de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="d493a-121">A **consumer** is a software component that makes use of performance data.</span></span> <span data-ttu-id="d493a-122">Windows incluye varias [herramientas integradas](performance-counters-tools.md) que hacen uso de los datos de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="d493a-122">Windows includes several [built-in tools](performance-counters-tools.md) that make use of performance data.</span></span> <span data-ttu-id="d493a-123">Entre ellos se incluyen el administrador de tareas, el Monitor de recursos, el monitor de rendimiento, el typeperf.exe, el logman.exe y el relog.exe.</span><span class="sxs-lookup"><span data-stu-id="d493a-123">These include Task Manager, Resource Monitor, Performance Monitor, typeperf.exe, logman.exe, and relog.exe.</span></span> <span data-ttu-id="d493a-124">Los desarrolladores pueden escribir scripts y aplicaciones que tengan acceso a los contadores de rendimiento a través de las [API de contador de rendimiento](consuming-counter-data.md).</span><span class="sxs-lookup"><span data-stu-id="d493a-124">Developers can write scripts and applications that access performance counters via [performance counter APIs](consuming-counter-data.md).</span></span>

<span data-ttu-id="d493a-125">Un **proveedor** es un componente de software que [genera y publica datos de rendimiento](providing-counter-data.md).</span><span class="sxs-lookup"><span data-stu-id="d493a-125">A **provider** is a software component that [generates and publishes performance data](providing-counter-data.md).</span></span> <span data-ttu-id="d493a-126">Un proveedor publicará los datos de uno o más *contraconjuntos*.</span><span class="sxs-lookup"><span data-stu-id="d493a-126">A provider will publish data for one or more *countersets*.</span></span> <span data-ttu-id="d493a-127">Por ejemplo, un sistema de base de datos puede registrarse como un proveedor de datos de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="d493a-127">For example, a database system might register itself as a performance data provider.</span></span>

- <span data-ttu-id="d493a-128">Un **proveedor v1** es un componente de software que publica los datos de rendimiento a través de un [archivo dll de rendimiento](providing-counter-data-using-a-performance-dll.md) que se ejecuta en el proceso del consumidor.</span><span class="sxs-lookup"><span data-stu-id="d493a-128">A **V1 provider** is a software component that publishes performance data via a [performance DLL](providing-counter-data-using-a-performance-dll.md) that runs in the process of the consumer.</span></span> <span data-ttu-id="d493a-129">Un proveedor v1 se instala en un sistema a través de un `.ini` archivo.</span><span class="sxs-lookup"><span data-stu-id="d493a-129">A V1 provider is installed onto a system via an `.ini` file.</span></span> <span data-ttu-id="d493a-130">La arquitectura del proveedor V1 está en desuso.</span><span class="sxs-lookup"><span data-stu-id="d493a-130">The V1 provider architecture is deprecated.</span></span> <span data-ttu-id="d493a-131">Los proveedores nuevos deben usar la arquitectura de proveedor V2.</span><span class="sxs-lookup"><span data-stu-id="d493a-131">New providers should use the V2 provider architecture.</span></span>
- <span data-ttu-id="d493a-132">Un **proveedor V2** es un componente de software que publica los datos de rendimiento a través de las [API del proveedor de contador de rendimiento](providing-counter-data-using-version-2-0.md).</span><span class="sxs-lookup"><span data-stu-id="d493a-132">A **V2 provider** is a software component that publishes performance data via the [performance counter provider APIs](providing-counter-data-using-version-2-0.md).</span></span> <span data-ttu-id="d493a-133">Un proveedor V2 se instala en un sistema a través de un `.man` archivo (manifiesto XML).</span><span class="sxs-lookup"><span data-stu-id="d493a-133">A V2 provider is installed onto a system via a `.man` (XML manifest) file.</span></span>

<span data-ttu-id="d493a-134">Un **CounterSet** es una agrupación de datos de rendimiento dentro de un proveedor.</span><span class="sxs-lookup"><span data-stu-id="d493a-134">A **counterset** is a grouping of performance data within a provider.</span></span> <span data-ttu-id="d493a-135">Un CounterSet tiene un nombre y uno o varios *contadores*.</span><span class="sxs-lookup"><span data-stu-id="d493a-135">A counterset has a name and one or more *counters*.</span></span> <span data-ttu-id="d493a-136">Recopilar los datos de un CounterSet devuelve un número de *instancias*.</span><span class="sxs-lookup"><span data-stu-id="d493a-136">Collecting the data from a counterset returns a number of *instances*.</span></span> <span data-ttu-id="d493a-137">En algunas API de Windows, los contraconjuntos se denominan **objetos de rendimiento**.</span><span class="sxs-lookup"><span data-stu-id="d493a-137">In some Windows APIs, countersets are called **performance objects**.</span></span> <span data-ttu-id="d493a-138">Por ejemplo, un proveedor de datos de rendimiento para un sistema de base de datos podría proporcionar un CounterSet para las estadísticas por base de datos.</span><span class="sxs-lookup"><span data-stu-id="d493a-138">For example, a performance data provider for a database system might provide a counterset for per-database statistics.</span></span>

<span data-ttu-id="d493a-139">Un **contador** es la definición de un único elemento de datos de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="d493a-139">A **counter** is the definition of single piece of performance data.</span></span> <span data-ttu-id="d493a-140">Un contador tiene un nombre y un tipo.</span><span class="sxs-lookup"><span data-stu-id="d493a-140">A counter has a name and a type.</span></span> <span data-ttu-id="d493a-141">Por ejemplo, un CounterSet "por cada base de datos" puede contener un contador denominado "transacciones por segundo" con el tipo `PERF_COUNTER_COUNTER` .</span><span class="sxs-lookup"><span data-stu-id="d493a-141">For example, a "per-database statistics" counterset might contain a counter named "transactions per second" with type `PERF_COUNTER_COUNTER`.</span></span>

<span data-ttu-id="d493a-142">Una **instancia** es una entidad sobre la que se envían los datos de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="d493a-142">An **instance** is an entity about which performance data is reported.</span></span> <span data-ttu-id="d493a-143">Una instancia tiene un nombre (cadena) y uno o más *valores de contador*.</span><span class="sxs-lookup"><span data-stu-id="d493a-143">An instance has a name (string) and one or more *counter values*.</span></span> <span data-ttu-id="d493a-144">Por ejemplo, un CounterSet de "estadísticas por base de datos" puede contener una instancia por base de datos.</span><span class="sxs-lookup"><span data-stu-id="d493a-144">For example, a "per-database statistics" counterset might contain one instance per database.</span></span> <span data-ttu-id="d493a-145">El nombre de instancia sería el nombre de la base de datos y cada instancia contendría valores de contador para los contadores "transacciones por segundo", "uso de memoria" y "uso de disco".</span><span class="sxs-lookup"><span data-stu-id="d493a-145">The instance name would be the database name, and each instance would contain counter values for "transactions per second", "memory usage", and "disk usage" counters.</span></span>

<span data-ttu-id="d493a-146">Un **valor de contador** es el valor de una sola parte de los datos del contador de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="d493a-146">A **counter value** is the value of a single piece of performance counter data.</span></span> <span data-ttu-id="d493a-147">Un valor de contador es un entero sin signo, de 32 bits o 64 bits, dependiendo del tipo del contador correspondiente.</span><span class="sxs-lookup"><span data-stu-id="d493a-147">A counter value is an unsigned integer, either 32-bit or 64-bit depending on the type of the corresponding counter.</span></span> <span data-ttu-id="d493a-148">Al hablar sobre una *instancia* de, un *valor de contador* a veces podría llamarse un *contador* o un *valor*.</span><span class="sxs-lookup"><span data-stu-id="d493a-148">When talking about an *instance*, a *counter value* might sometimes be called a *counter* or a *value*.</span></span>

> [!TIP]
> <span data-ttu-id="d493a-149">Puede ser útil relacionar los términos del contador de rendimiento con términos de hoja de cálculo más conocidos.</span><span class="sxs-lookup"><span data-stu-id="d493a-149">It might be helpful to relate performance counter terms to more familiar spreadsheet terms.</span></span> <span data-ttu-id="d493a-150">Un **CounterSet** es como una tabla.</span><span class="sxs-lookup"><span data-stu-id="d493a-150">A **counterset** is like a table.</span></span> <span data-ttu-id="d493a-151">Un **contador** es como una columna.</span><span class="sxs-lookup"><span data-stu-id="d493a-151">A **counter** is like a column.</span></span> <span data-ttu-id="d493a-152">Una **instancia** es como una fila.</span><span class="sxs-lookup"><span data-stu-id="d493a-152">An **instance** is like a row.</span></span> <span data-ttu-id="d493a-153">Un **valor de contador** es como una celda de la tabla.</span><span class="sxs-lookup"><span data-stu-id="d493a-153">A **counter value** is like a cell in the table.</span></span>

<span data-ttu-id="d493a-154">Los **contraconjuntos de instancia única** siempre contienen datos para una sola instancia.</span><span class="sxs-lookup"><span data-stu-id="d493a-154">**Single-instance countersets** always contain data for exactly one instance.</span></span> <span data-ttu-id="d493a-155">Esto es común para los contraconjuntos que notifican las estadísticas globales del sistema.</span><span class="sxs-lookup"><span data-stu-id="d493a-155">This is common for countersets that report system-global statistics.</span></span> <span data-ttu-id="d493a-156">Por ejemplo, Windows tiene un CounterSet integrado de instancia única denominado "Memory" que notifica el uso de memoria global.</span><span class="sxs-lookup"><span data-stu-id="d493a-156">For example, Windows has a built-in single-instance counterset named "Memory" that reports on global memory usage.</span></span>

<span data-ttu-id="d493a-157">Los **contraconjuntos de varias** instancias contienen datos para un número variable de instancias.</span><span class="sxs-lookup"><span data-stu-id="d493a-157">**Multi-instance countersets** contain data for a variable number of instances.</span></span> <span data-ttu-id="d493a-158">Esto es común para los contraconjuntos que informan sobre las entidades dentro del sistema.</span><span class="sxs-lookup"><span data-stu-id="d493a-158">This is common for countersets that report about entities within the system.</span></span> <span data-ttu-id="d493a-159">Por ejemplo, Windows tiene un CounterSet integrado de varias instancias denominado "información del procesador" que notifica una instancia para cada CPU instalada.</span><span class="sxs-lookup"><span data-stu-id="d493a-159">For example, Windows has a built-in multi-instance counterset named "Processor Information" that reports one instance for each installed CPU.</span></span>

<span data-ttu-id="d493a-160">Los consumidores recopilan y registran periódicamente los datos del CounterSet de un proveedor.</span><span class="sxs-lookup"><span data-stu-id="d493a-160">Consumers will periodically collect and record the data from a provider's counterset.</span></span> <span data-ttu-id="d493a-161">Por ejemplo, el consumidor podría recopilar los datos una vez por segundo o una vez por minuto.</span><span class="sxs-lookup"><span data-stu-id="d493a-161">For example, the consumer might collect data once per second or once per minute.</span></span> <span data-ttu-id="d493a-162">Los datos recopilados se denominan **ejemplo**.</span><span class="sxs-lookup"><span data-stu-id="d493a-162">The data collected is called a **sample**.</span></span> <span data-ttu-id="d493a-163">Un ejemplo consta de marcas de tiempo junto con los datos de las instancias del CounterSet.</span><span class="sxs-lookup"><span data-stu-id="d493a-163">A sample consists of timestamps along with the data for instances of the counterset.</span></span> <span data-ttu-id="d493a-164">Los datos de cada instancia incluyen el nombre de instancia (cadena) y un conjunto de valores de contador (enteros, un valor para cada contador en el CounterSet).</span><span class="sxs-lookup"><span data-stu-id="d493a-164">The data for each instance includes the instance name (string) and a set of counter values (integers, one value for each counter in the counterset).</span></span>

<span data-ttu-id="d493a-165">Normalmente, los nombres de instancia deben ser únicos dentro de un ejemplo, es decir, un proveedor no debe devolver dos instancias con el mismo nombre que parte de un único ejemplo.</span><span class="sxs-lookup"><span data-stu-id="d493a-165">Instance names should normally be unique within a sample, i.e. a provider should not return two instances with the same name as part of a single sample.</span></span> <span data-ttu-id="d493a-166">Algunos proveedores antiguos no siguen esta regla, de modo que [los consumidores deben ser capaces de tolerar nombres de instancia no únicos](handling-duplicate-instance-names.md).</span><span class="sxs-lookup"><span data-stu-id="d493a-166">Some older providers do not follow this rule, so [consumers must be able to tolerate non-unique instance names](handling-duplicate-instance-names.md).</span></span> <span data-ttu-id="d493a-167">Los nombres de instancia no distinguen mayúsculas de minúsculas, por lo que las instancias no deben tener nombres que solo difieran en mayúsculas o minúsculas.</span><span class="sxs-lookup"><span data-stu-id="d493a-167">Instance names are not case-sensitive, so instances should not have names that differ only in case.</span></span>

> [!NOTE]
> <span data-ttu-id="d493a-168">Por motivos de compatibilidad con versiones anteriores, el CounterSet "Process" devuelve nombres de instancia no únicos basados en el nombre de archivo EXE.</span><span class="sxs-lookup"><span data-stu-id="d493a-168">For backwards-compatibility reasons, the "Process" counterset returns non-unique instance names based on the EXE filename.</span></span> <span data-ttu-id="d493a-169">Esto puede producir resultados confusos, especialmente cuando se inicia o se cierra un proceso con un nombre no único, ya que esto suele dar lugar a problemas de datos debido a la coincidencia incorrecta de los nombres de instancia entre los ejemplos.</span><span class="sxs-lookup"><span data-stu-id="d493a-169">This can cause confusing results, especially when a process with a non-unique name starts up or shuts down, as this will typically result in data glitches due to incorrect matching of instance names between samples.</span></span> <span data-ttu-id="d493a-170">Los consumidores de los CounterSet "Process" deben ser capaces de tolerar estos nombres de instancia no únicos y los problemas de datos resultantes.</span><span class="sxs-lookup"><span data-stu-id="d493a-170">Consumers of of the "Process" counterset must be able to tolerate these non-unique instance names and the resulting data glitches.</span></span>

<span data-ttu-id="d493a-171">Los nombres de instancia deben ser estables en todas las muestras; es decir, un proveedor debe usar el mismo nombre de instancia para la misma entidad cada vez que se recopile el CounterSet.</span><span class="sxs-lookup"><span data-stu-id="d493a-171">Instance names must be stable across samples, i.e. a provider should use the same instance name for the same entity each time the counterset is collected.</span></span>

<span data-ttu-id="d493a-172">Cada contador tiene un tipo.</span><span class="sxs-lookup"><span data-stu-id="d493a-172">Each counter has a type.</span></span> <span data-ttu-id="d493a-173">El tipo de contador indica el tipo de **valor sin formato** del contador (entero de 32 bits sin signo o entero de 64 bits sin signo).</span><span class="sxs-lookup"><span data-stu-id="d493a-173">The counter type indicates the type of the counter's **raw value** (either unsigned 32-bit integer or unsigned 64-bit integer).</span></span> <span data-ttu-id="d493a-174">El tipo de contador también indica lo que representa el valor sin formato del contador, que determina cómo se debe procesar el valor sin formato para generar estadísticas útiles.</span><span class="sxs-lookup"><span data-stu-id="d493a-174">The counter type also indicates what the counter's raw value represents, which determines how the raw value should be processed to generate useful statistics.</span></span>

<span data-ttu-id="d493a-175">Aunque algunos tipos de contador son simples y tienen un valor sin formato que es directamente útil, muchos tipos de contador requieren un [procesamiento adicional](calculating-counter-values.md) para crear un **valor con formato** útil.</span><span class="sxs-lookup"><span data-stu-id="d493a-175">While some counter types are simple and have a raw value that is directly useful, many counter types require [additional processing](calculating-counter-values.md) to create a useful **formatted value**.</span></span> <span data-ttu-id="d493a-176">Para generar el valor con formato, algunos tipos de contador requieren valores sin formato de dos ejemplos, algunos tipos de contador requieren marcas de tiempo y algunos tipos de contador requieren valores sin formato de varios contadores.</span><span class="sxs-lookup"><span data-stu-id="d493a-176">To produce the formatted value, some counter types require raw values from two samples, some counter types require timestamps, and some counter types require raw values from multiple counters.</span></span> <span data-ttu-id="d493a-177">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="d493a-177">For example:</span></span>

- <span data-ttu-id="d493a-178">`PERF_COUNTER_LARGE_RAWCOUNT` es un valor sin formato de 64 bits que no requiere ningún procesamiento para ser útil.</span><span class="sxs-lookup"><span data-stu-id="d493a-178">`PERF_COUNTER_LARGE_RAWCOUNT` is a 64-bit raw value that requires no processing to be useful.</span></span> <span data-ttu-id="d493a-179">Es adecuado para los valores de un momento dado, como "bytes de memoria en uso".</span><span class="sxs-lookup"><span data-stu-id="d493a-179">It is appropriate for point-in-time values such as "Bytes of memory in use".</span></span>
- <span data-ttu-id="d493a-180">`PERF_COUNTER_RAWCOUNT_HEX` es un valor sin formato de 32 bits que requiere que solo el formato hexadecimal sencillo sea útil.</span><span class="sxs-lookup"><span data-stu-id="d493a-180">`PERF_COUNTER_RAWCOUNT_HEX` is a 32-bit raw value that requires only simple hexadecimal formatting to be useful.</span></span> <span data-ttu-id="d493a-181">Es adecuado para la información de un momento dado o de identificación, como "marcas" o "dirección base".</span><span class="sxs-lookup"><span data-stu-id="d493a-181">It is appropriate for point-in-time or identifying information such as "Flags" or "Base Address".</span></span>
- <span data-ttu-id="d493a-182">`PERF_COUNTER_BULK_COUNT` es un valor sin formato de 64 bits que indica un recuento de eventos y se utiliza para calcular la velocidad a la que se producen los eventos.</span><span class="sxs-lookup"><span data-stu-id="d493a-182">`PERF_COUNTER_BULK_COUNT` is a 64-bit raw value that indicates a count of events and is used to compute the rate at which the events occur.</span></span> <span data-ttu-id="d493a-183">Para que sea útil, este tipo de contador requiere dos ejemplos que se separan en el tiempo.</span><span class="sxs-lookup"><span data-stu-id="d493a-183">To be useful, this counter type requires two samples that are separated in time.</span></span> <span data-ttu-id="d493a-184">El valor con formato es la tasa de eventos, es decir, el número de veces que se produjo el evento por segundo durante el intervalo entre los dos ejemplos.</span><span class="sxs-lookup"><span data-stu-id="d493a-184">The formatted value is the event rate, i.e. the number of times the event occurred per second over the interval between the two samples.</span></span> <span data-ttu-id="d493a-185">Dados dos ejemplos `s0` y `s1` , el valor con formato (tasa de eventos) se calcularía como `(s1.EventCount - s0.EventCount)/(s1.TimestampInSeconds - s0.TimestampInSeconds)` .</span><span class="sxs-lookup"><span data-stu-id="d493a-185">Given two samples `s0` and `s1`, the formatted value (event rate) would be computed as `(s1.EventCount - s0.EventCount)/(s1.TimestampInSeconds - s0.TimestampInSeconds)`.</span></span>

<span data-ttu-id="d493a-186">Se espera que los proveedores se comporten como si fueran sin estado, es decir, la recopilación de datos de un CounterSet no debe afectar visiblemente al estado del proveedor.</span><span class="sxs-lookup"><span data-stu-id="d493a-186">Providers are expected to behave as if they are stateless, i.e. collecting data from a counterset should not visibly affect the state of the provider.</span></span> <span data-ttu-id="d493a-187">Por ejemplo, un proveedor no debe restablecer los valores de contador en 0 cuando se recopila un CounterSet y no debe usar la marca de tiempo de una colección anterior para ajustar los valores de la colección actual.</span><span class="sxs-lookup"><span data-stu-id="d493a-187">For example, a provider should not reset counter values to 0 when a counterset is collected and it should not use the timestamp of a previous collection to adjust the values in the current collection.</span></span> <span data-ttu-id="d493a-188">En su lugar, debe proporcionar valores de contador sin formato sencillos con tipos precisos para que el consumidor pueda calcular estadísticas útiles en función de los valores sin formato y sus marcas de tiempo.</span><span class="sxs-lookup"><span data-stu-id="d493a-188">Instead, it should provide simple raw counter values with accurate types so that the consumer can compute useful statistics based on the raw values and their timestamps.</span></span>

## <a name="performance-api-architecture"></a><span data-ttu-id="d493a-189">Arquitectura de la API de rendimiento</span><span class="sxs-lookup"><span data-stu-id="d493a-189">Performance API Architecture</span></span>

![Las aplicaciones de contador de rendimiento invocan a las API de Windows que llaman a proveedores para obtener datos de rendimiento.](images/architecture.png)

<span data-ttu-id="d493a-191">Los consumidores del contador de rendimiento incluyen:</span><span class="sxs-lookup"><span data-stu-id="d493a-191">Performance counter consumers include:</span></span>

- <span data-ttu-id="d493a-192">[Aplicaciones proporcionadas por Microsoft](performance-counters-tools.md) , como administrador de tareas, monitor de recursos, monitor de rendimiento y typeperf.exe.</span><span class="sxs-lookup"><span data-stu-id="d493a-192">[Microsoft-provided applications](performance-counters-tools.md) such as Task Manager, Resource Monitor, Performance Monitor, and typeperf.exe.</span></span>
- <span data-ttu-id="d493a-193">Superficies de API de alto nivel proporcionadas por Microsoft que exponen datos del contador de rendimiento, como [las clases de rendimiento de WMI](/windows/desktop/WmiSdk/monitoring-performance-data).</span><span class="sxs-lookup"><span data-stu-id="d493a-193">Microsoft-provided high-level API surfaces that expose performance counter data such as [WMI Performance Classes](/windows/desktop/WmiSdk/monitoring-performance-data).</span></span>
- <span data-ttu-id="d493a-194">Sus propias aplicaciones o scripts que usan las [API del consumidor del contador de rendimiento](consuming-counter-data.md).</span><span class="sxs-lookup"><span data-stu-id="d493a-194">Your own applications or scripts that use [performance counter consumer APIs](consuming-counter-data.md).</span></span>

<span data-ttu-id="d493a-195">La mayoría de los consumidores del contador de rendimiento usan las API de [PDH.dll](using-the-pdh-functions-to-consume-counter-data.md) para recopilar datos de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="d493a-195">Most performance counter consumers use APIs from [PDH.dll](using-the-pdh-functions-to-consume-counter-data.md) to collect performance data.</span></span> <span data-ttu-id="d493a-196">PDH administra muchos aspectos complejos de la recopilación de contadores de rendimiento, como el análisis de consultas, la coincidencia de instancias entre varias muestras y el cálculo de valores con formato de los datos del contador sin formato.</span><span class="sxs-lookup"><span data-stu-id="d493a-196">PDH manages many complex aspects of gathering performance counters such as parsing queries, matching up instances across multiple samples, and computing formatted values from the raw counter data.</span></span> <span data-ttu-id="d493a-197">La implementación de PDH usa las API del registro cuando se consumen datos de un proveedor V1 y usa las API del consumidor V2 al consumir datos de un proveedor V2.</span><span class="sxs-lookup"><span data-stu-id="d493a-197">The PDH implementation uses the registry APIs when consuming data from a V1 provider and uses the V2 consumer APIs when consuming data from a V2 provider.</span></span>

<span data-ttu-id="d493a-198">Algunos consumidores de contadores de rendimiento anteriores usan las [API del registro](using-the-registry-functions-to-consume-counter-data.md) para recopilar datos de rendimiento de la `HKEY_PERFORMANCE_DATA` clave del registro especial.</span><span class="sxs-lookup"><span data-stu-id="d493a-198">Some older performance counter consumers use the [registry APIs](using-the-registry-functions-to-consume-counter-data.md) to collect performance data from the special `HKEY_PERFORMANCE_DATA` registry key.</span></span> <span data-ttu-id="d493a-199">Esto no se recomienda para el nuevo código porque el procesamiento de los datos del registro es complejo y propenso a errores.</span><span class="sxs-lookup"><span data-stu-id="d493a-199">This is not recommended for new code because processing the data from the registry is complex and error-prone.</span></span> <span data-ttu-id="d493a-200">La implementación de la API del registro admite directamente la recopilación de datos de proveedores de v1.</span><span class="sxs-lookup"><span data-stu-id="d493a-200">The registry API implementation directly supports collecting data from V1 providers.</span></span> <span data-ttu-id="d493a-201">Admite la recopilación indirecta de datos de proveedores V2 a través de una capa de traducción que usa las API de consumidor V2.</span><span class="sxs-lookup"><span data-stu-id="d493a-201">It indirectly supports collecting data from V2 providers through a translation layer that uses the V2 consumer APIs.</span></span>

<span data-ttu-id="d493a-202">Algunos consumidores de contadores de rendimiento usan las [funciones de consumidor de Perflib V2](using-the-perflib-functions-to-consume-counter-data.md) para tener acceso directamente a los datos de los proveedores de V2.</span><span class="sxs-lookup"><span data-stu-id="d493a-202">Some performance counter consumers use the [PerfLib V2 Consumer functions](using-the-perflib-functions-to-consume-counter-data.md) to directly access data from V2 providers.</span></span> <span data-ttu-id="d493a-203">Esto es más complejo que el consumo de datos mediante las API de PDH, pero este enfoque puede ser útil si no se pueden usar las API de PDH debido a problemas de rendimiento o de dependencia.</span><span class="sxs-lookup"><span data-stu-id="d493a-203">This is more complex than consuming data using the PDH APIs, but this approach can be useful if PDH APIs cannot be used due to performance or dependency concerns.</span></span> <span data-ttu-id="d493a-204">La implementación de PerfLib V2 admite directamente la recopilación de datos de proveedores de V2.</span><span class="sxs-lookup"><span data-stu-id="d493a-204">The PerfLib V2 implementation directly supports collecting data from V2 providers.</span></span> <span data-ttu-id="d493a-205">No admite la recopilación de datos de proveedores de v1.</span><span class="sxs-lookup"><span data-stu-id="d493a-205">It does not support collecting data from V1 providers.</span></span>

> [!NOTE]
> <span data-ttu-id="d493a-206">Windows OneCore no incluye PDH.dll y no incluye compatibilidad para consumir datos de contadores de rendimiento a través de las API del registro.</span><span class="sxs-lookup"><span data-stu-id="d493a-206">Windows OneCore does not include PDH.dll and does not include support for consuming performance counter data via the registry APIs.</span></span> <span data-ttu-id="d493a-207">Los consumidores que se ejecutan en OneCore deben usar las funciones de consumidor de PerfLib V2.</span><span class="sxs-lookup"><span data-stu-id="d493a-207">Consumers running on OneCore must use the PerfLib V2 Consumer functions.</span></span>

<span data-ttu-id="d493a-208">Los proveedores v1 se implementan como un archivo DLL de proveedor que se carga en el proceso del consumidor.</span><span class="sxs-lookup"><span data-stu-id="d493a-208">V1 providers are implemented as a provider DLL that is loaded into the consumer process.</span></span> <span data-ttu-id="d493a-209">La implementación de la API del registro administra la carga del archivo DLL del proveedor, la llamada a la DLL para recopilar datos de rendimiento y la descarga del archivo DLL según corresponda.</span><span class="sxs-lookup"><span data-stu-id="d493a-209">The registry API implementation manages loading the provider DLL, calling into the DLL to collect performance data, and unloading the DLL as appropriate.</span></span> <span data-ttu-id="d493a-210">La DLL del proveedor es responsable de la [recopilación de datos de rendimiento según corresponda](communicating-with-your-application.md), por ejemplo, mediante las API normales de Windows, RPC, canalizaciones con nombre, memoria compartida u otros mecanismos de comunicación entre procesos.</span><span class="sxs-lookup"><span data-stu-id="d493a-210">The provider DLL is responsible for [collecting performance data as appropriate](communicating-with-your-application.md), e.g. by using normal Windows APIs, RPC, named pipes, shared memory, or other interprocess communication mechanisms.</span></span>

<span data-ttu-id="d493a-211">Los proveedores de V2 se implementan como un programa en modo de usuario (a menudo un servicio de Windows) o un controlador de modo kernel.</span><span class="sxs-lookup"><span data-stu-id="d493a-211">V2 providers are implemented as either a user-mode program (often a Windows service) or a kernel-mode driver.</span></span> <span data-ttu-id="d493a-212">Normalmente, el código del proveedor de datos de rendimiento se integra directamente en un componente existente (es decir, el controlador o el servicio informa de las estadísticas sobre sí mismo).</span><span class="sxs-lookup"><span data-stu-id="d493a-212">Usually the performance data provider code is integrated directly into an existing component (i.e. the driver or service is reporting statistics about itself).</span></span> <span data-ttu-id="d493a-213">La implementación de PerfLib V2 administra las solicitudes y las respuestas a través de la extensión de kernel de PCW.sys, por lo que el proveedor no suele tener que implementar ninguna comunicación entre procesos para proporcionar los datos de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="d493a-213">The PerfLib V2 implementation manages requests and responses via the PCW.sys kernel extension so the provider usually does not need to implement any interprocess communication to provide the performance data.</span></span>

> [!NOTE]
> <span data-ttu-id="d493a-214">Las herramientas y API del contador de rendimiento de Windows incluyen compatibilidad limitada para tener acceso a los contadores de rendimiento de otros equipos a través del registro remoto (para los proveedores V1) y RPC (para los proveedores V2).</span><span class="sxs-lookup"><span data-stu-id="d493a-214">Windows Performance Counter APIs and tools include limited support for accessing performance counters from other machines via Remote Registry (for V1 providers) and RPC (for V2 providers).</span></span> <span data-ttu-id="d493a-215">Esta compatibilidad suele ser difícil de usar en términos de controles de autenticación (las herramientas y las API solo se pueden autenticar como el usuario actual) así como en términos de [configuración del sistema](accessing-remote-counter-data.md) (los puntos de conexión y servicios necesarios están deshabilitados de forma predeterminada).</span><span class="sxs-lookup"><span data-stu-id="d493a-215">This support is often hard to use in terms of authentication controls (the tools and APIs can only authenticate as the current user) as well as in terms of [system configuration](accessing-remote-counter-data.md) (the necessary endpoints and services are disabled by default).</span></span> <span data-ttu-id="d493a-216">En muchos casos, es mejor acceder a los contadores de rendimiento de sistemas remotos mediante [WMI](/windows/desktop/WmiSdk/monitoring-performance-data) en lugar de a través de la compatibilidad de acceso remoto integrada.</span><span class="sxs-lookup"><span data-stu-id="d493a-216">In many cases, it is better to access the performance counters of remote systems via [WMI](/windows/desktop/WmiSdk/monitoring-performance-data) rather than via the built-in remote access support.</span></span>

## <a name="developer-audience"></a><span data-ttu-id="d493a-217">Audiencia de desarrolladores</span><span class="sxs-lookup"><span data-stu-id="d493a-217">Developer audience</span></span>

<span data-ttu-id="d493a-218">Los administradores suelen usar los contadores de rendimiento para identificar problemas de rendimiento o comportamientos anómalos de los sistemas, por parte de los desarrolladores para estudiar el uso de los recursos de los componentes de software y los usuarios individuales para comprender cómo se comportan los programas en su sistema.</span><span class="sxs-lookup"><span data-stu-id="d493a-218">Performance counters are often consumed by administrators to identify performance issues or abnormal behavior of systems, by developers to study resource usage of software components, and by individual users to understand how programs are behaving on their system.</span></span> <span data-ttu-id="d493a-219">El uso puede producirse a través de herramientas de GUI como el administrador de tareas o el monitor de rendimiento, herramientas de línea de comandos como typeperf.exe o logman.exe, mediante scripting a través de WMI y PowerShell, o a través de las API de C/C++ y .NET.</span><span class="sxs-lookup"><span data-stu-id="d493a-219">Usage may occur via GUI tools like Task Manager or Performance Monitor, command-line tools like typeperf.exe or logman.exe, via scripting via WMI and PowerShell, or through C/C++ and .NET APIs.</span></span>

<span data-ttu-id="d493a-220">Los proveedores de contadores de rendimiento se implementan normalmente como controladores de modo kernel o servicios de modo de usuario.</span><span class="sxs-lookup"><span data-stu-id="d493a-220">Performance counter providers are usually implemented as kernel-mode drivers or user-mode services.</span></span> <span data-ttu-id="d493a-221">Los proveedores de contadores de rendimiento normalmente se escriben en C o C++.</span><span class="sxs-lookup"><span data-stu-id="d493a-221">Performance counter providers are usually written in C or C++.</span></span>

## <a name="run-time-requirements"></a><span data-ttu-id="d493a-222">Requisitos de tiempo de ejecución</span><span class="sxs-lookup"><span data-stu-id="d493a-222">Run-time requirements</span></span>

<span data-ttu-id="d493a-223">Para obtener información sobre los requisitos de tiempo de ejecución para un elemento de programación determinado, vea la sección de requisitos de la página de referencia de ese elemento.</span><span class="sxs-lookup"><span data-stu-id="d493a-223">For information about run-time requirements for a particular programming element, see the Requirements section of the reference page for that element.</span></span>

<span data-ttu-id="d493a-224">Para ver [el](performance-counters-what-s-new.md)historial de versiones, consulte las novedades.</span><span class="sxs-lookup"><span data-stu-id="d493a-224">For version history, see [What's New](performance-counters-what-s-new.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="d493a-225">Vea también</span><span class="sxs-lookup"><span data-stu-id="d493a-225">See also</span></span>

[<span data-ttu-id="d493a-226">Uso de contadores de rendimiento</span><span class="sxs-lookup"><span data-stu-id="d493a-226">Using Performance Counters</span></span>](using-performance-counters.md)

[<span data-ttu-id="d493a-227">Referencia de contadores de rendimiento</span><span class="sxs-lookup"><span data-stu-id="d493a-227">Performance Counters Reference</span></span>](performance-counters-reference.md)
