---
title: Registro de un elemento de menú contextual estático
description: En este tema se describe el registro de un elemento de menú contextual estático que se muestra para Active Directory objetos.
ms.assetid: ed945812-3adb-4058-bdb6-8d9d34468265
ms.tgt_platform: multiple
keywords:
- Registro de un elemento de menú contextual estático AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 89e3ee5336061ca296e2c94f8907ebd385610494
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/17/2020
ms.locfileid: "105656325"
---
# <a name="registering-a-static-context-menu-item"></a><span data-ttu-id="a795a-104">Registro de un elemento de menú contextual estático</span><span class="sxs-lookup"><span data-stu-id="a795a-104">Registering a Static Context Menu Item</span></span>

<span data-ttu-id="a795a-105">Los complementos MMC administrativos de Active Directory Domain Services y el shell de Windows proporcionan un mecanismo para agregar un elemento al menú contextual que se muestra para los objetos de Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="a795a-105">The administrative MMC snap-ins of Active Directory Domain Services and the Windows shell provide a mechanism to add an item to the context menu displayed for objects in Active Directory Domain Services.</span></span> <span data-ttu-id="a795a-106">El menú contextual puede invocar cualquier archivo que se pueda iniciar con la API de [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) , como una aplicación o una dirección URL de la Página Web.</span><span class="sxs-lookup"><span data-stu-id="a795a-106">The context menu can invoke any file that can be started with the [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) API, such as an application or webpage URL.</span></span>

## <a name="registering-with-active-directory-domain-services"></a><span data-ttu-id="a795a-107">Registro con Active Directory Domain Services</span><span class="sxs-lookup"><span data-stu-id="a795a-107">Registering with Active Directory Domain Services</span></span>

<span data-ttu-id="a795a-108">El registro de la extensión del menú contextual es específico de una configuración regional.</span><span class="sxs-lookup"><span data-stu-id="a795a-108">Context menu extension registration is specific to one locale.</span></span> <span data-ttu-id="a795a-109">Si la extensión del menú contextual se aplica a todas las configuraciones regionales, debe registrarse en el objeto [**displaySpecifier**](/windows/desktop/ADSchema/c-displayspecifier) de la clase de objeto en todos los subcontenedores de la configuración regional en el contenedor de especificadores de presentación.</span><span class="sxs-lookup"><span data-stu-id="a795a-109">If the context menu extension applies to all locales, it must be registered in the object class [**displaySpecifier**](/windows/desktop/ADSchema/c-displayspecifier) object in all of the locale subcontainers in the Display Specifiers container.</span></span> <span data-ttu-id="a795a-110">Si la extensión del menú contextual está localizada para una configuración regional determinada, se debe registrar en el objeto **displaySpecifier** en el subcontenedor de la configuración regional.</span><span class="sxs-lookup"><span data-stu-id="a795a-110">If the context menu extension is localized for a certain locale, it must be registered in the **displaySpecifier** object in that locale subcontainer.</span></span> <span data-ttu-id="a795a-111">Para obtener más información sobre el contenedor de especificadores de presentación y configuraciones regionales, vea [especificadores de pantalla](display-specifiers.md) y [contenedor de DisplaySpecifiers](displayspecifiers-container.md).</span><span class="sxs-lookup"><span data-stu-id="a795a-111">For more information about the Display Specifiers container and locales, see [Display Specifiers](display-specifiers.md) and [DisplaySpecifiers Container](displayspecifiers-container.md).</span></span>

<span data-ttu-id="a795a-112">Hay dos atributos de especificador de presentación en los que se puede registrar un elemento de menú contextual estático, [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) y [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu).</span><span class="sxs-lookup"><span data-stu-id="a795a-112">There are two display specifier attributes that a static context menu item can be registered under, [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) and [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu).</span></span>

<span data-ttu-id="a795a-113">El atributo [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) identifica los menús contextuales administrativos que se van a mostrar en los complementos administrativos de Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="a795a-113">The [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) attribute identifies administrative context menus to display in the administrative snap-ins of Active Directory Domain Services.</span></span> <span data-ttu-id="a795a-114">El menú contextual aparece cuando el usuario muestra el menú contextual de los objetos de la clase adecuada en uno de los complementos MMC administrativos.</span><span class="sxs-lookup"><span data-stu-id="a795a-114">The context menu appears when the user displays the context menu for objects of the appropriate class in one of the administrative MMC snap-ins.</span></span>

<span data-ttu-id="a795a-115">El atributo [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) identifica los menús contextuales del usuario final que se van a mostrar en el shell de Windows.</span><span class="sxs-lookup"><span data-stu-id="a795a-115">The [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) attribute identifies end-user context menus to display in the Windows shell.</span></span> <span data-ttu-id="a795a-116">El menú contextual aparece cuando el usuario ve el menú contextual de los objetos de la clase adecuada en el explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="a795a-116">The context menu appears when the user views the context menu for objects of the appropriate class in the Windows Explorer.</span></span> <span data-ttu-id="a795a-117">A partir de Windows Server 2003, el shell de Windows ya no muestra los objetos que provienen de Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="a795a-117">Beginning with Windows Server 2003, the Windows shell no longer displays objects that are from Active Directory Domain Services.</span></span>

<span data-ttu-id="a795a-118">Todos estos atributos tienen varios valores.</span><span class="sxs-lookup"><span data-stu-id="a795a-118">All of these attributes are multi-valued.</span></span>

<span data-ttu-id="a795a-119">Al registrar un elemento de menú contextual estático, los valores de los atributos [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) y [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) requieren el formato siguiente.</span><span class="sxs-lookup"><span data-stu-id="a795a-119">When registering a static context menu item, the values for the [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) and [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) attributes require the following format.</span></span>


```C++
<order number>,<menu text>,<command>
```



<span data-ttu-id="a795a-120">El " &lt; número de pedido &gt; " es un número sin signo que representa la posición del elemento en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="a795a-120">The "&lt;order number&gt;" is an unsigned number that represents the item's position in the context menu.</span></span> <span data-ttu-id="a795a-121">Cuando se muestra un menú contextual, los valores se ordenan mediante una comparación de "número de &lt; pedido" de cada valor &gt; .</span><span class="sxs-lookup"><span data-stu-id="a795a-121">When a context menu is displayed, the values are sorted using a comparison of each value's "&lt;order number&gt;".</span></span> <span data-ttu-id="a795a-122">Si hay más de un valor con el mismo " &lt; número de pedido &gt; ", esas extensiones del menú contextual se cargan en el orden en que se leen en el servidor de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="a795a-122">If more than one value has the same "&lt;order number&gt;", those context menu extensions are loaded in the order they are read from the Active Directory server.</span></span> <span data-ttu-id="a795a-123">Si es posible, use un "número de &lt; pedido" no existente &gt; , es decir, uno que no haya usado otros valores de la propiedad.</span><span class="sxs-lookup"><span data-stu-id="a795a-123">If possible, use a non-existing "&lt;order number&gt;", that is, one that has not been used by other values in the property.</span></span> <span data-ttu-id="a795a-124">No hay ninguna posición de inicio prescrita y se permiten huecos en la &lt; secuencia "número de pedido &gt; ".</span><span class="sxs-lookup"><span data-stu-id="a795a-124">There is no prescribed starting position, and gaps are allowed in the "&lt;order number&gt;" sequence.</span></span>

<span data-ttu-id="a795a-125">El " &lt; texto del menú &gt; " es la cadena que se muestra en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="a795a-125">The "&lt;menu text&gt;" is the string displayed in the context menu.</span></span> <span data-ttu-id="a795a-126">El " &lt; texto de menú &gt; " puede incluir un carácter "&" que precede al carácter de método abreviado de teclado para el elemento de menú.</span><span class="sxs-lookup"><span data-stu-id="a795a-126">The "&lt;menu text&gt;" can include one "&" character that precedes the keyboard shortcut character for the menu item.</span></span> <span data-ttu-id="a795a-127">Esto hará que el carácter precedido esté subrayado.</span><span class="sxs-lookup"><span data-stu-id="a795a-127">This will cause the preceded character to be underlined.</span></span> <span data-ttu-id="a795a-128">Por ejemplo, si el " &lt; texto del menú &gt; " es "&archivo", el texto del menú se mostrará como "archivo", la "f" se subrayará y "f" será el método abreviado de teclado para el elemento de menú.</span><span class="sxs-lookup"><span data-stu-id="a795a-128">For example, if the "&lt;menu text&gt;" is "&File", the menu text will be displayed as "File", the "F" will be underlined and "F" will be the keyboard shortcut for the menu item.</span></span>

<span data-ttu-id="a795a-129">El " &lt; comando &gt; " es el programa o archivo ejecutado por el complemento.</span><span class="sxs-lookup"><span data-stu-id="a795a-129">The "&lt;command&gt;" is the program or file executed by the snap-in.</span></span> <span data-ttu-id="a795a-130">Se debe especificar la ruta de acceso completa o el archivo debe existir en la variable de entorno de ruta de acceso del equipo.</span><span class="sxs-lookup"><span data-stu-id="a795a-130">Either the full path must be specified or the file must exist in the computer path environment variable.</span></span> <span data-ttu-id="a795a-131">El archivo se invoca mediante la función [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) .</span><span class="sxs-lookup"><span data-stu-id="a795a-131">The file is invoked using the [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) function.</span></span> <span data-ttu-id="a795a-132">El " &lt; comando &gt; " no puede contener parámetros adicionales, por ejemplo, Notepad.exe Myfile.txt.</span><span class="sxs-lookup"><span data-stu-id="a795a-132">The "&lt;command&gt;" cannot contain additional parameters, for example, Notepad.exe Myfile.txt.</span></span> <span data-ttu-id="a795a-133">Dado que se utiliza **ShellExecute** , cualquier archivo o dirección que se pueda pasar a **ShellExecute** se puede usar para " &lt; Command &gt; ".</span><span class="sxs-lookup"><span data-stu-id="a795a-133">Because **ShellExecute** is used, any file or address that can be passed to **ShellExecute** can be used for "&lt;command&gt;".</span></span> <span data-ttu-id="a795a-134">Por ejemplo, si " &lt; comando &gt; " contiene "d: \\file.txt", d: \\file.txt se abrirá con la aplicación asociada a la extensión. txt.</span><span class="sxs-lookup"><span data-stu-id="a795a-134">For example, if "&lt;command&gt;" contains "d:\\file.txt", d:\\file.txt will be opened with the application associated with the .txt extension.</span></span> <span data-ttu-id="a795a-135">Del mismo modo, si " &lt; comando &gt; " contiene " https://www.fabrikam.com ", se abrirá el explorador Web predeterminado y se mostrará la Página Web especificada.</span><span class="sxs-lookup"><span data-stu-id="a795a-135">Likewise, if "&lt;command&gt;" contains "https://www.fabrikam.com", the default web browser is opened and will display the specified webpage.</span></span> <span data-ttu-id="a795a-136">Se permiten las rutas de acceso y los nombres de aplicación con espacios.</span><span class="sxs-lookup"><span data-stu-id="a795a-136">Paths and application names with spaces are allowed.</span></span> <span data-ttu-id="a795a-137">Si &lt; el "comando &gt; " es una aplicación, el ADsPath y la clase del objeto seleccionado se pasan como argumentos de la línea de comandos, separados por un espacio.</span><span class="sxs-lookup"><span data-stu-id="a795a-137">If "&lt;command&gt;" is an application, the selected object's ADsPath and class are passed as command line arguments, separated by a space.</span></span>

<span data-ttu-id="a795a-138">En el shell de Windows, se admiten los elementos de menú contextual de selección múltiple.</span><span class="sxs-lookup"><span data-stu-id="a795a-138">In the Windows shell, multiple-selection context menu items are supported.</span></span> <span data-ttu-id="a795a-139">En este caso, &lt; se invoca el "comando &gt; " para cada objeto seleccionado.</span><span class="sxs-lookup"><span data-stu-id="a795a-139">In this case, the "&lt;command&gt;" is invoked for each selected object.</span></span> <span data-ttu-id="a795a-140">En Active Directory Domain Services no se admiten los elementos de menú contextual estático de selección múltiple.</span><span class="sxs-lookup"><span data-stu-id="a795a-140">In Active Directory Domain Services' administrative snap-ins, multiple-selection static context menu items are not supported.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="a795a-141">En el shell de Windows, los datos del especificador de presentación se recuperan al iniciar sesión el usuario y se almacenan en caché para la sesión del usuario.</span><span class="sxs-lookup"><span data-stu-id="a795a-141">For the Windows shell, display specifier data is retrieved at user logon and cached for the user's session.</span></span> <span data-ttu-id="a795a-142">En el caso de los complementos administrativos, los datos del especificador de presentación se recuperan cuando se carga el complemento y se almacenan en memoria caché mientras dure el proceso.</span><span class="sxs-lookup"><span data-stu-id="a795a-142">For the administrative snap-ins, the display specifier data is retrieved when the snap-in is loaded and is cached for the duration of the process.</span></span> <span data-ttu-id="a795a-143">En el caso del shell de Windows, esto significa que los cambios en los especificadores de presentación surten efecto después de que un usuario cierre la sesión y vuelva a iniciarla.</span><span class="sxs-lookup"><span data-stu-id="a795a-143">For the Windows shell, this means changes to display specifiers take effect after a user logs off and back on again.</span></span> <span data-ttu-id="a795a-144">En el caso de los complementos administrativos, los cambios surten efecto cuando se recarga el complemento o el archivo de consola. es decir, si inicia una nueva instancia del archivo de consola o una nueva instancia de Mmc.exe y agrega el complemento, se recuperan los datos del especificador de pantalla más reciente.</span><span class="sxs-lookup"><span data-stu-id="a795a-144">For the administrative snap-ins, changes take effect when the snap-in or console file is reloaded; that is, if you start a new instance of the console file or new Mmc.exe instance and add the snap-in, the latest display specifier data is retrieved.</span></span>

 

<span data-ttu-id="a795a-145">Para obtener más información y un ejemplo de código, vea [código de ejemplo para instalar un elemento de menú contextual estático](example-code-for-installing-a-static-context-menu-item.md).</span><span class="sxs-lookup"><span data-stu-id="a795a-145">For more information, and a code example, see [Example Code for Installing a Static Context Menu Item](example-code-for-installing-a-static-context-menu-item.md).</span></span>

 

 