---
description: 'Más información sobre: columnas de valor largo'
title: Columnas de valor largo
TOCTitle: Long Value Columns
ms:assetid: 0690f9d3-1a58-4e53-92e1-213630fc88f4
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269179(v=EXCHG.10)
ms:contentKeyID: 32765482
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: bb5618227d49de9e246adf69868a3cb2dc498dca
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104082026"
---
# <a name="long-value-columns"></a><span data-ttu-id="583e4-103">Columnas de valor largo</span><span class="sxs-lookup"><span data-stu-id="583e4-103">Long Value Columns</span></span>


<span data-ttu-id="583e4-104">_**Se aplica a:** Windows | Windows Server_</span><span class="sxs-lookup"><span data-stu-id="583e4-104">_**Applies to:** Windows | Windows Server_</span></span>

## <a name="long-value-columns"></a><span data-ttu-id="583e4-105">Columnas de valor largo</span><span class="sxs-lookup"><span data-stu-id="583e4-105">Long Value Columns</span></span>

<span data-ttu-id="583e4-106">Los tipos de columna ESE JET_coltypLongText y JET_coltypLongBinary se denominan tipos de columna de valor largo.</span><span class="sxs-lookup"><span data-stu-id="583e4-106">The ESE column types JET_coltypLongText and JET_coltypLongBinary are called long value column types.</span></span> <span data-ttu-id="583e4-107">Estas columnas son objetos grandes de cadena y binarios grandes que pueden almacenarse en árboles de B + independientes fuera del índice principal.</span><span class="sxs-lookup"><span data-stu-id="583e4-107">These columns are large string and large binary objects that may be stored in separate B+ trees away from the primary index.</span></span> <span data-ttu-id="583e4-108">Cuando se almacenan valores largos independientes del registro principal, se les asigna una clave interna con un identificador de valor largo (LID) y un desplazamiento de bytes, y se obtiene acceso a ellos como una secuencia.</span><span class="sxs-lookup"><span data-stu-id="583e4-108">When long values are stored separate from the primary record, they are internally keyed on a long value ID (LID) and byte offset and accessed as a stream.</span></span> <span data-ttu-id="583e4-109">Las columnas de valor largo se agregan a la tabla en la llamada a [JetAddColumn](./jetaddcolumn-function.md) con el miembro **coltyp** de la estructura [JET_COLUMNDEF](./jet-columndef-structure.md) establecida en JET_coltypLongText o JET_coltypLongBinary.</span><span class="sxs-lookup"><span data-stu-id="583e4-109">Long value columns are added to the table in the call to [JetAddColumn](./jetaddcolumn-function.md) with the **coltyp** member of the [JET_COLUMNDEF](./jet-columndef-structure.md) structure set to either JET_coltypLongText or JET_coltypLongBinary.</span></span> <span data-ttu-id="583e4-110">El tamaño máximo de un valor de texto largo o de columna binaria larga es 2 GB-1.</span><span class="sxs-lookup"><span data-stu-id="583e4-110">The maximum size of a Long Text or Long Binary column value is 2 GB -1.</span></span>

<span data-ttu-id="583e4-111">ESE admite append, sobrescritura de intervalo de bytes y operaciones Set size para columnas de valor largo para admitir implementaciones de secuencias eficaces en estos tipos de columna.</span><span class="sxs-lookup"><span data-stu-id="583e4-111">ESE supports append, byte range overwrite, and set size operations for long value columns to support efficient stream implementations on these column types.</span></span> <span data-ttu-id="583e4-112">De forma predeterminada, los datos de valor largo se almacenan en un árbol B + independiente si es mayor que 1024 bytes, o si el registro no cabe en una sola página de base de datos cuando se almacenan los datos de valor largo en el registro.</span><span class="sxs-lookup"><span data-stu-id="583e4-112">By default, long value data is stored in a separate B+ tree if it is larger than 1024 bytes, or if the record does not fit on a single database page when the long value data is stored in the record.</span></span> <span data-ttu-id="583e4-113">La aplicación tiene la opción de invalidar el comportamiento predeterminado estableciendo opciones para almacenar datos de valor largo en el registro (JET_bitSetIntrinsicLV) o para forzar que se almacenen en el árbol B + independiente (JET_bitSetIntrinsicLV).</span><span class="sxs-lookup"><span data-stu-id="583e4-113">The application has the option to override the default behavior by setting options to store long value data in the record (JET_bitSetIntrinsicLV) or to force them to be stored in the separate B+ tree (JET_bitSetIntrinsicLV).</span></span> <span data-ttu-id="583e4-114">Estos valores se establecen en el parámetro *grbit* en [JetSetColumn](./jetsetcolumn-function.md), o bien el miembro **grbit** [JET_SETCOLUMN](./jet-setcolumn-structure.md) usar en la llamada a [JetSetColumns](./jetsetcolumns-function.md) como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="583e4-114">These values are set in the *grbit* parameter in [JetSetColumn](./jetsetcolumn-function.md), or the **grbit** member [JET_SETCOLUMN](./jet-setcolumn-structure.md) used in the call to [JetSetColumns](./jetsetcolumns-function.md) as follows:</span></span>

  - <span data-ttu-id="583e4-115">Append: (JET_bitSetAppendLV)</span><span class="sxs-lookup"><span data-stu-id="583e4-115">Append: (JET_bitSetAppendLV)</span></span>

  - <span data-ttu-id="583e4-116">Sobrescritura de intervalo de bytes: (JET_bitSetOverwriteLV)</span><span class="sxs-lookup"><span data-stu-id="583e4-116">Byte Range Overwrite: (JET_bitSetOverwriteLV)</span></span>

  - <span data-ttu-id="583e4-117">Tamaño establecido: (JET_bitSetSizeLV)</span><span class="sxs-lookup"><span data-stu-id="583e4-117">Set Size: (JET_bitSetSizeLV)</span></span>

  - <span data-ttu-id="583e4-118">Forzar independiente: (JET_bitSetSeparateLV)</span><span class="sxs-lookup"><span data-stu-id="583e4-118">Force Separate: (JET_bitSetSeparateLV)</span></span>

  - <span data-ttu-id="583e4-119">Almacenar en registro: (JET_bitSetIntrinsicLV)</span><span class="sxs-lookup"><span data-stu-id="583e4-119">Store In Record: (JET_bitSetIntrinsicLV)</span></span>

<span data-ttu-id="583e4-120">Los datos de valor largo se establecen indicando el desplazamiento en el BLOB de valor largo y la longitud de los datos de valor largo en el BLOB.</span><span class="sxs-lookup"><span data-stu-id="583e4-120">The long value data is set by indicating the offset into the long value blob, and the length of the long value data in the blob.</span></span> <span data-ttu-id="583e4-121">El desplazamiento para el BLOB de valor largo se establece en el miembro **ibLongValue** de la estructura [JET_SETINFO](./jet-setinfo-structure.md) (para [JetSetColumn](./jetsetcolumn-function.md)) o el miembro **IbLongValue** de la estructura [JET_SETCOLUMN](./jet-setcolumn-structure.md) (para [JetSetColumns](./jetsetcolumns-function.md)).</span><span class="sxs-lookup"><span data-stu-id="583e4-121">The offset to the long value blob is set in the **ibLongValue** member of [JET_SETINFO](./jet-setinfo-structure.md) structure (for [JetSetColumn](./jetsetcolumn-function.md)) or the **ibLongValue** member of the [JET_SETCOLUMN](./jet-setcolumn-structure.md) structure (for [JetSetColumns](./jetsetcolumns-function.md)).</span></span> <span data-ttu-id="583e4-122">El miembro **pvData** de [JET_SETCOLUMN](./jet-setcolumn-structure.md)y el parámetro *PvData* de la llamada a [JetSetColumn](./jetsetcolumn-function.md) contiene los datos de valor largo.</span><span class="sxs-lookup"><span data-stu-id="583e4-122">The **pvData** member of [JET_SETCOLUMN](./jet-setcolumn-structure.md), and *pvData* parameter in the call to [JetSetColumn](./jetsetcolumn-function.md) contains the long value data.</span></span> <span data-ttu-id="583e4-123">Las actualizaciones de las columnas de valor largo deben realizarse dentro de una transacción.</span><span class="sxs-lookup"><span data-stu-id="583e4-123">Updates to long value columns must be performed inside a transaction.</span></span>

<span data-ttu-id="583e4-124">Los datos de valor largo siempre se almacenan en una tabla independiente cuando la aplicación establece el JET_bitSetSeparateLV o el JET_bitSetIntrinsicLV, de lo contrario se decide de forma heurística.</span><span class="sxs-lookup"><span data-stu-id="583e4-124">The long value data is always stored in a separate table is when the application sets the JET_bitSetSeparateLV or JET_bitSetIntrinsicLV, otherwise it is heuristically decided.</span></span> <span data-ttu-id="583e4-125">ESE almacena el valor Long separado si es mayor que 1024 bytes o si el registro no cabe en una sola página de base de datos si se almacena en el registro.</span><span class="sxs-lookup"><span data-stu-id="583e4-125">ESE stores the long value separated if it is larger than 1024 bytes or if the record would not fit on a single database page if stored in record.</span></span>

<span data-ttu-id="583e4-126">En el diagrama siguiente se muestran los datos de valores largos almacenados en una tabla independiente.</span><span class="sxs-lookup"><span data-stu-id="583e4-126">The following diagram shows the long value data stored in separate table.</span></span> <span data-ttu-id="583e4-127">Cuando un valor largo se almacena fuera del registro, se crea un nuevo identificador de valor largo para hacer referencia a su valor.</span><span class="sxs-lookup"><span data-stu-id="583e4-127">When a long value is stored outside the record, a new long valued ID is created to refer to its value.</span></span> <span data-ttu-id="583e4-128">Esto permite que varios registros hagan referencia al mismo valor de columna.</span><span class="sxs-lookup"><span data-stu-id="583e4-128">This allows multiple records to refer to the same column value.</span></span> <span data-ttu-id="583e4-129">Los recuentos de referencias a los datos aumentan si más de un registro de los datos apunta a los mismos datos de valor largo.</span><span class="sxs-lookup"><span data-stu-id="583e4-129">Reference counts to the data are increased if more than one record in the data points to the same long value data.</span></span>

<span data-ttu-id="583e4-130">![ESE_Documentation_longvaluedtree2](images/Gg269179.ESE_Documentation_longvaluedtree2(EXCHG.10).gif "ESE_Documentation_longvaluedtree2")</span><span class="sxs-lookup"><span data-stu-id="583e4-130">![ESE_Documentation_longvaluedtree2](images/Gg269179.ESE_Documentation_longvaluedtree2(EXCHG.10).gif "ESE_Documentation_longvaluedtree2")</span></span>

<span data-ttu-id="583e4-131">ESE también admite una característica de almacén de instancia única que permite que varios registros hagan referencia al mismo objeto binario grande como si cada registro tuviera su propia copia de la información. por lo tanto, se evitan las copias duplicadas de los datos de valores de columna.</span><span class="sxs-lookup"><span data-stu-id="583e4-131">ESE also supports a single instance store feature that allows multiple records to reference the same large binary object as though each record had its own copy of the information; thus avoiding duplicate copies of the column value data.</span></span> <span data-ttu-id="583e4-132">Esta característica está habilitada en la llamada a [JetPrepareUpdate](./jetprepareupdate-function.md) con la opción JET_prepInsertCopy establecida en el parámetro *Prep* .</span><span class="sxs-lookup"><span data-stu-id="583e4-132">This feature is enabled in the call to [JetPrepareUpdate](./jetprepareupdate-function.md) with the JET_prepInsertCopy option set in the *prep* parameter.</span></span>
