---
title: Implementar la página de propiedades de un complemento DSP
description: Implementar la página de propiedades de un complemento DSP
ms.assetid: 3dd3e547-fd06-4f01-8731-da1f8c958a32
keywords:
- Complementos de Windows Media Player, audio DSP
- complementos, DSP de audio
- Complementos de procesamiento de señal digital, propiedades de audio
- Complementos DSP, propiedades de audio
- Complementos DSP de audio, propiedades
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aec87318b77fec4e9218398c1cb43dd5954a49e0
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/16/2019
ms.locfileid: "103903301"
---
# <a name="implementing-the-property-page-for-a-dsp-plug-in"></a><span data-ttu-id="94b29-108">Implementar la página de propiedades de un complemento DSP</span><span class="sxs-lookup"><span data-stu-id="94b29-108">Implementing the Property Page for a DSP Plug-in</span></span>

<span data-ttu-id="94b29-109">Windows Media Player puede mostrar una página de propiedades para cada complemento de DSP para permitir que los usuarios establezcan valores que cambian el comportamiento del complemento.</span><span class="sxs-lookup"><span data-stu-id="94b29-109">Windows Media Player can display a property page for each DSP plug-in to enable users to set values that change the behavior of the plug-in.</span></span> <span data-ttu-id="94b29-110">Los usuarios pueden tener acceso a la página de propiedades desde **la pestaña** complementos del cuadro de diálogo Opciones; para ello, haga clic en el nombre del complemento DSP para seleccionarlo y, a continuación, haga clic en **propiedades**.</span><span class="sxs-lookup"><span data-stu-id="94b29-110">Users can access the property page from the **Plug-ins** tab of the Options dialog box by clicking the name of the DSP plug-in to select it and then clicking **Properties**.</span></span>

<span data-ttu-id="94b29-111">El código de ejemplo del Asistente para complementos de Windows Media Player proporciona una implementación predeterminada de una página de propiedades que incluye un solo cuadro de edición que recibe del usuario un valor que representa un factor de escala para el volumen de audio.</span><span class="sxs-lookup"><span data-stu-id="94b29-111">The Windows Media Player Plug-in Wizard sample code provides a default implementation of a property page that includes a single edit box that receives from the user a value representing a scale factor for the audio volume.</span></span> <span data-ttu-id="94b29-112">Cuando el usuario hace clic en **aplicar**, la página de propiedades pasa este valor al objeto de complemento para que el complemento pueda cambiar el valor que usa para escalar el volumen durante el procesamiento.</span><span class="sxs-lookup"><span data-stu-id="94b29-112">When the user clicks **Apply**, the property page passes this value to the plug-in object so the plug-in can change the value it uses to scale the volume during processing.</span></span>

## <a name="about-the-property-page-object"></a><span data-ttu-id="94b29-113">Acerca del objeto de página de propiedades</span><span class="sxs-lookup"><span data-stu-id="94b29-113">About the Property Page Object</span></span>

<span data-ttu-id="94b29-114">El objeto de página de propiedades es un objeto COM que implementa la interfaz **IPropertyPage** .</span><span class="sxs-lookup"><span data-stu-id="94b29-114">The property page object is a COM object that implements the **IPropertyPage** interface.</span></span> <span data-ttu-id="94b29-115">El código de ejemplo generado por el Asistente para complementos usa la implementación de ATL de **IPropertyPage**, que se documenta en la documentación de Visual C++ en MSDN.</span><span class="sxs-lookup"><span data-stu-id="94b29-115">The sample code generated by the plug-in wizard uses the ATL implementation of **IPropertyPage**, which is documented in the Visual C++ documentation on MSDN.</span></span> <span data-ttu-id="94b29-116">El código debe proporcionar al menos implementaciones de invalidación para **IPropertyPage:: OnInitDialog**, que controla el evento que se produce cuando se abre la página de propiedades y **IPropertyPage:: Apply**, que controla el evento que se produce cuando el usuario hace clic en **aplicar**.</span><span class="sxs-lookup"><span data-stu-id="94b29-116">Your code at least should provide override implementations for **IPropertyPage::OnInitDialog**, which handles the event that occurs when the property page opens, and **IPropertyPage::Apply**, which handles the event that occurs when the user clicks **Apply**.</span></span> <span data-ttu-id="94b29-117">El Asistente para complementos genera código de ejemplo para cada uno de estos controladores de eventos.</span><span class="sxs-lookup"><span data-stu-id="94b29-117">The plug-in wizard generates sample code for each of these event handlers.</span></span> <span data-ttu-id="94b29-118">La implementación de ejemplo de **OnInitDialog** recupera un valor del registro para que pueda mostrar la configuración del factor de escala actual.</span><span class="sxs-lookup"><span data-stu-id="94b29-118">The sample implementation of **OnInitDialog** retrieves a value from the registry so that it can display the current scale factor setting.</span></span> <span data-ttu-id="94b29-119">La implementación de ejemplo de **Apply** valida los datos proporcionados por el usuario probando para asegurarse de que está dentro de un intervalo especificado y, a continuación, guarda el valor en el registro y, a continuación, pasa el valor (si es válido) al método put de la propiedad del complemento DSP, denominado **\_ Scale Scale**.</span><span class="sxs-lookup"><span data-stu-id="94b29-119">The sample implementation of **Apply** validates the user input by testing to ensure that it falls within a specified range, then persists the value to the registry, and then passes the value (if valid) to the DSP plug-in property put method, named **put\_scale**.</span></span>

<span data-ttu-id="94b29-120">Además, tendrá que agregar código para controlar el evento que se produce cuando el usuario cambia un valor en un control que se proporciona en la página de propiedades.</span><span class="sxs-lookup"><span data-stu-id="94b29-120">Additionally, you will need to add code to handle the event that occurs when the user changes a value in a control you provide in the property page.</span></span> <span data-ttu-id="94b29-121">Por ejemplo, el Asistente para complementos implementa una función denominada **OnChangeScale**, que simplemente habilita el botón **aplicar** cuando el usuario cambia el texto en el cuadro de edición en la página de propiedades llamando al método **SetDirty** con un valor de argumento **true**.</span><span class="sxs-lookup"><span data-stu-id="94b29-121">For example, the plug-in wizard implements a function named **OnChangeScale**, which simply enables the **Apply** button when the user changes the text in the edit box on the property page by calling the **SetDirty** method with an argument value of **TRUE**.</span></span>

## <a name="about-the-property-page-dialog-resource"></a><span data-ttu-id="94b29-122">Acerca del recurso de cuadro de diálogo Página de propiedades</span><span class="sxs-lookup"><span data-stu-id="94b29-122">About the Property Page Dialog Resource</span></span>

<span data-ttu-id="94b29-123">La interfaz de usuario de la página de propiedades se almacena como un recurso de cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="94b29-123">The user interface for the property page is stored as a dialog resource.</span></span> <span data-ttu-id="94b29-124">Puede ver y editar fácilmente el cuadro de diálogo de la página de propiedades en Visual Studio; para ello, seleccione la pestaña **ResourceView** en la ventana del área de trabajo del proyecto, abra la carpeta del **cuadro de diálogo** y, a continuación, haga doble clic en el nombre del recurso de la página de propiedades.</span><span class="sxs-lookup"><span data-stu-id="94b29-124">You can easily view and edit the property page dialog in Visual Studio by selecting the **ResourceView** tab in the Project Workspace window, then opening the **Dialog** folder, and then double-clicking the property page resource name.</span></span> <span data-ttu-id="94b29-125">El editor de recursos de cuadro de diálogo de Visual Studio le proporciona las herramientas que necesita para agregar controles al cuadro de diálogo de la página de propiedades y para crear controladores de eventos que se asignan a los mensajes de Windows adecuados.</span><span class="sxs-lookup"><span data-stu-id="94b29-125">The dialog resource editor in Visual Studio provides you with the tools you need to add controls to the property page dialog and to create event handlers that are mapped to the appropriate Windows messages.</span></span> <span data-ttu-id="94b29-126">Para obtener más información sobre cómo usar el editor de recursos en Visual Studio, consulte la ayuda de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="94b29-126">For details about how to use the resource editor in Visual Studio, refer to Visual Studio Help.</span></span>

## <a name="about-ispecifypropertypages"></a><span data-ttu-id="94b29-127">Acerca de ISpecifyPropertyPages</span><span class="sxs-lookup"><span data-stu-id="94b29-127">About ISpecifyPropertyPages</span></span>

<span data-ttu-id="94b29-128">Si un complemento DSP proporciona una página de propiedades, el complemento debe implementar la interfaz **ISpecifyPropertyPages** .</span><span class="sxs-lookup"><span data-stu-id="94b29-128">If a DSP plug-in provides a property page, the plug-in must implement the **ISpecifyPropertyPages** interface.</span></span> <span data-ttu-id="94b29-129">Esta interfaz contiene un solo método: **ISpecifyPropertyPages:: GetPages**.</span><span class="sxs-lookup"><span data-stu-id="94b29-129">This interface contains only one method: **ISpecifyPropertyPages::GetPages**.</span></span> <span data-ttu-id="94b29-130">Este es el método que asocia la página de propiedades con el complemento DSP.</span><span class="sxs-lookup"><span data-stu-id="94b29-130">This is the method that associates the property page with the DSP plug-in.</span></span> <span data-ttu-id="94b29-131">Windows Media Player llama a este método cuando el usuario invoca la página de propiedades, pasando un parámetro de tipo CAUUID, que es una matriz contada de GUID.</span><span class="sxs-lookup"><span data-stu-id="94b29-131">Windows Media Player calls this method when the user invokes the property page, passing a parameter of type CAUUID, which is a counted array of GUIDs.</span></span> <span data-ttu-id="94b29-132">La implementación del complemento de ejemplo de **GetPages** rellena esta estructura con un único GUID que es el identificador de clase del objeto de página de propiedades del complemento.</span><span class="sxs-lookup"><span data-stu-id="94b29-132">The sample plug-in implementation of **GetPages** fills this structure with a single GUID that is the class id of the plug-in property page object.</span></span> <span data-ttu-id="94b29-133">Windows Media Player usa el ID. de clase para crear el objeto de página de propiedades.</span><span class="sxs-lookup"><span data-stu-id="94b29-133">Windows Media Player then uses the class id to create the property page object.</span></span>

<span data-ttu-id="94b29-134">Es posible que observe que la implementación de ejemplo de **GetPages** usa **CoTaskMemAlloc** para asignar memoria para la estructura de GUID.</span><span class="sxs-lookup"><span data-stu-id="94b29-134">You might notice that the sample implementation of **GetPages** uses **CoTaskMemAlloc** to allocate memory for the GUID structure.</span></span> <span data-ttu-id="94b29-135">Es responsabilidad del autor de la llamada, en este caso Windows Media Player, usar **CoTaskMemFree** para liberar la memoria.</span><span class="sxs-lookup"><span data-stu-id="94b29-135">It is the responsibility of the caller, in this case Windows Media Player, to use **CoTaskMemFree** to release the memory.</span></span> <span data-ttu-id="94b29-136">Para obtener más información sobre la estructura CAUUID, consulte la documentación del SDK de la plataforma.</span><span class="sxs-lookup"><span data-stu-id="94b29-136">For details about the CAUUID structure, see the Platform SDK documentation.</span></span>

## <a name="about-the-proxystub-dll"></a><span data-ttu-id="94b29-137">Acerca de la DLL de proxy/código auxiliar</span><span class="sxs-lookup"><span data-stu-id="94b29-137">About the Proxy/Stub DLL</span></span>

<span data-ttu-id="94b29-138">Para que un complemento de DSP funcione en Windows Media Player 11 que se ejecute en Windows Vista, debe proporcionar un archivo DLL de proxy/código auxiliar para las interfaces personalizadas utilizadas para comunicar los cambios de configuración desde un cuadro de diálogo de página de propiedades a la clase de complemento.</span><span class="sxs-lookup"><span data-stu-id="94b29-138">For a DSP plug-in to work in Windows Media Player 11 running on Windows Vista, you must provide a proxy/stub DLL for custom interfaces used to communicate changes in settings from a property page dialog box to the plug-in class.</span></span> <span data-ttu-id="94b29-139">Se deben calcular las referencias de las llamadas a métodos realizadas a través de estas interfaces cuando las llamadas se realizan a través de límites de proceso o apartamento.</span><span class="sxs-lookup"><span data-stu-id="94b29-139">Method calls made through such interfaces must be marshaled when the calls are made across process or apartment boundaries.</span></span> <span data-ttu-id="94b29-140">La versión más reciente del Asistente para complementos crea un proyecto de archivo DLL de código auxiliar/proxy de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="94b29-140">The latest version of the plug-in wizard creates a sample proxy/stub DLL project.</span></span>

## <a name="related-topics"></a><span data-ttu-id="94b29-141">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="94b29-141">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="94b29-142">**Implementar un complemento de DSP de audio**</span><span class="sxs-lookup"><span data-stu-id="94b29-142">**Implementing an Audio DSP Plug-in**</span></span>](implementing-an-audio-dsp-plug-in.md)
</dt> </dl>

 

 




