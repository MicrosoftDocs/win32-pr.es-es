---
description: Al hacer clic con el botón secundario en un objeto, normalmente se muestra un menú contextual. Este menú contiene una lista de comandos que el usuario puede seleccionar para realizar diversas acciones en el objeto. Esta sección es una introducción a los menús contextuales para los objetos del sistema de archivos.
ms.assetid: d951d1e8-0f88-49c4-8373-e6db0e18cd72
title: Extender menús contextuales
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 895550ff050d559b3523676ddaa2a58099398a97
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104563195"
---
# <a name="extending-shortcut-menus"></a><span data-ttu-id="6d126-105">Extender menús contextuales</span><span class="sxs-lookup"><span data-stu-id="6d126-105">Extending Shortcut Menus</span></span>

<span data-ttu-id="6d126-106">Al hacer clic con el botón secundario en un objeto, normalmente se muestra un *menú contextual*.</span><span class="sxs-lookup"><span data-stu-id="6d126-106">Right-clicking an object normally causes the display of a *shortcut menu*.</span></span> <span data-ttu-id="6d126-107">Este menú contiene una lista de comandos que el usuario puede seleccionar para realizar diversas acciones en el objeto.</span><span class="sxs-lookup"><span data-stu-id="6d126-107">This menu contains a list of commands that the user can select to perform various actions on the object.</span></span> <span data-ttu-id="6d126-108">Esta sección es una introducción a los menús contextuales para los objetos del sistema de archivos.</span><span class="sxs-lookup"><span data-stu-id="6d126-108">This section is an introduction to shortcut menus for file system objects.</span></span>

-   [<span data-ttu-id="6d126-109">Menús contextuales para objetos del sistema de archivos</span><span class="sxs-lookup"><span data-stu-id="6d126-109">Shortcut Menus for File System Objects</span></span>](#shortcut-menus-for-file-system-objects)
-   [<span data-ttu-id="6d126-110">Verbos del menú contextual</span><span class="sxs-lookup"><span data-stu-id="6d126-110">Shortcut Menu Verbs</span></span>](#shortcut-menu-verbs)
    -   [<span data-ttu-id="6d126-111">Verbos canónicos</span><span class="sxs-lookup"><span data-stu-id="6d126-111">Canonical Verbs</span></span>](#canonical-verbs)
    -   [<span data-ttu-id="6d126-112">Verbos extendidos</span><span class="sxs-lookup"><span data-stu-id="6d126-112">Extended Verbs</span></span>](#extended-verbs)
-   [<span data-ttu-id="6d126-113">Extender el menú contextual para un tipo de archivo</span><span class="sxs-lookup"><span data-stu-id="6d126-113">Extending the Shortcut Menu for a File Type</span></span>](#extending-the-shortcut-menu-for-a-file-type)
-   [<span data-ttu-id="6d126-114">Extender el menú contextual para objetos de Shell predefinidos</span><span class="sxs-lookup"><span data-stu-id="6d126-114">Extending the Shortcut Menu for Predefined Shell Objects</span></span>](#extending-the-shortcut-menu-for-predefined-shell-objects)
-   [<span data-ttu-id="6d126-115">Registro de una aplicación para controlar tipos de archivo arbitrarios</span><span class="sxs-lookup"><span data-stu-id="6d126-115">Registering an Application to Handle Arbitrary File Types</span></span>](#registering-an-application-to-handle-arbitrary-file-types)
-   [<span data-ttu-id="6d126-116">Extender el nuevo submenú</span><span class="sxs-lookup"><span data-stu-id="6d126-116">Extending the New Submenu</span></span>](#extending-the-new-submenu)

<span data-ttu-id="6d126-117">Aquí encontrará información adicional:</span><span class="sxs-lookup"><span data-stu-id="6d126-117">Additional information is available here:</span></span>

-   [<span data-ttu-id="6d126-118">Cómo definir verbos extendidos</span><span class="sxs-lookup"><span data-stu-id="6d126-118">How To Define Extended Verbs</span></span>](how-to-define-extended-verbs.md)
-   [<span data-ttu-id="6d126-119">Cómo asociar verbos con comandos DDE</span><span class="sxs-lookup"><span data-stu-id="6d126-119">How To Associate Verbs with DDE Commands</span></span>](how-to-associate-verbs-with-dde-commands.md)

## <a name="shortcut-menus-for-file-system-objects"></a><span data-ttu-id="6d126-120">Menús contextuales para objetos del sistema de archivos</span><span class="sxs-lookup"><span data-stu-id="6d126-120">Shortcut Menus for File System Objects</span></span>

<span data-ttu-id="6d126-121">Cuando un usuario hace clic con el botón secundario en un objeto, como un archivo, que se muestra en el explorador de Windows o en el escritorio, aparece un menú contextual con una lista de comandos.</span><span class="sxs-lookup"><span data-stu-id="6d126-121">When a user right-clicks an object, such as a file, that is displayed in Windows Explorer or on the desktop, a shortcut menu appears with a list of commands.</span></span> <span data-ttu-id="6d126-122">El usuario puede realizar una acción en el archivo, como abrirlo o eliminarlo, seleccionando el comando adecuado.</span><span class="sxs-lookup"><span data-stu-id="6d126-122">The user can then perform an action on the file, such as opening or deleting it, by selecting the appropriate command.</span></span>

<span data-ttu-id="6d126-123">Dado que los menús contextuales suelen usarse para la administración de archivos, el Shell proporciona un conjunto de comandos predeterminados, como cortar y copiar, que aparecen en el menú contextual de cualquier archivo.</span><span class="sxs-lookup"><span data-stu-id="6d126-123">Because shortcut menus are often used for file management, the Shell provides a set of default commands, such as Cut and Copy, that appear on the shortcut menu for any file.</span></span> <span data-ttu-id="6d126-124">Tenga en cuenta que aunque abrir con es un comando predeterminado, no se muestra para algunos tipos de archivo estándar, como. wav.</span><span class="sxs-lookup"><span data-stu-id="6d126-124">Note that although Open With is a default command, it is not displayed for some standard file types, such as .wav.</span></span> <span data-ttu-id="6d126-125">La siguiente ilustración del directorio mis documentos de ejemplo, que también se usó como ejemplo en la [Personalización de iconos](icon.md), muestra un menú contextual predeterminado que se muestra al hacer clic con el botón secundario en MyDocs4.XYZ.</span><span class="sxs-lookup"><span data-stu-id="6d126-125">The following illustration of the sample My Documents directory, which was also used as an example in [Customizing Icons](icon.md), shows a default shortcut menu that was displayed by right-clicking MyDocs4.xyz.</span></span>

![captura de pantalla del menú contextual predeterminado para los objetos del sistema de archivos](images/context1.jpg)

<span data-ttu-id="6d126-127">La razón por la que MyDocs4.xyz muestra un menú contextual predeterminado es que no es miembro de un [tipo de archivo](fa-file-types.md)registrado.</span><span class="sxs-lookup"><span data-stu-id="6d126-127">The reason that MyDocs4.xyz shows a default shortcut menu is that it is not a member of a registered [file type](fa-file-types.md).</span></span> <span data-ttu-id="6d126-128">Por otro lado,. txt es un tipo de archivo registrado.</span><span class="sxs-lookup"><span data-stu-id="6d126-128">On the other hand, .txt is a registered file type.</span></span> <span data-ttu-id="6d126-129">Si hace clic con el botón secundario en uno de los archivos. txt, verá un menú contextual con dos comandos adicionales en la sección superior: **abrir** e **Imprimir**.</span><span class="sxs-lookup"><span data-stu-id="6d126-129">If you right-click one of the .txt files, you will instead see a shortcut menu with two additional commands in its upper section: **Open** and **Print**.</span></span>

![captura de pantalla del menú contextual personalizado para objetos del sistema de archivos](images/context2.jpg)

<span data-ttu-id="6d126-131">Una vez que se registra un tipo de archivo, puede extender su menú contextual con comandos adicionales.</span><span class="sxs-lookup"><span data-stu-id="6d126-131">Once a file type is registered, you can extend its shortcut menu with additional commands.</span></span> <span data-ttu-id="6d126-132">Se muestran encima de los comandos predeterminados cuando se hace clic con el botón derecho en cualquier archivo de ese tipo.</span><span class="sxs-lookup"><span data-stu-id="6d126-132">They are displayed above the default commands when any file of that type is right-clicked.</span></span> <span data-ttu-id="6d126-133">Aunque la mayoría de los comandos que se agregan de esta manera son comunes, como **Imprimir** o **abrir**, es libre de agregar cualquier comando que un usuario pueda encontrar de utilidad.</span><span class="sxs-lookup"><span data-stu-id="6d126-133">Although most of the commands added in this way are common ones, such as **Print** or **Open**, you are free to add any command that a user might find helpful.</span></span>

<span data-ttu-id="6d126-134">Todo lo que se necesita para extender el menú contextual de un tipo de archivo consiste en crear una entrada del registro para cada comando.</span><span class="sxs-lookup"><span data-stu-id="6d126-134">All that is required to extend the shortcut menu for a file type is to create a registry entry for each command.</span></span> <span data-ttu-id="6d126-135">Un enfoque más sofisticado consiste en implementar un *controlador de menú contextual*, que le permite extender el menú contextual de un tipo de archivo cada archivo.</span><span class="sxs-lookup"><span data-stu-id="6d126-135">A more sophisticated approach is to implement a *shortcut menu handler*, which allows you to extend the shortcut menu for a file type on a file-by-file basis.</span></span> <span data-ttu-id="6d126-136">Para obtener más información, vea [crear controladores de menús contextuales](context-menu-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="6d126-136">For more information, see [Creating Context Menu Handlers](context-menu-handlers.md).</span></span>

## <a name="shortcut-menu-verbs"></a><span data-ttu-id="6d126-137">Verbos del menú contextual</span><span class="sxs-lookup"><span data-stu-id="6d126-137">Shortcut Menu Verbs</span></span>

<span data-ttu-id="6d126-138">Cada comando del menú contextual se identifica en el registro mediante su *verbo*.</span><span class="sxs-lookup"><span data-stu-id="6d126-138">Each command on the shortcut menu is identified in the registry by its *verb*.</span></span> <span data-ttu-id="6d126-139">Estos verbos son los mismos que los utilizados por [**ShellExecuteEx**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecuteexa) al iniciar aplicaciones mediante programación.</span><span class="sxs-lookup"><span data-stu-id="6d126-139">These verbs are the same as those used by [**ShellExecuteEx**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecuteexa) when launching applications programmatically.</span></span> <span data-ttu-id="6d126-140">Para obtener más información sobre el uso de **ShellExecuteEx**, vea la explicación de [Launching Applications](launch.md).</span><span class="sxs-lookup"><span data-stu-id="6d126-140">For further information about the use of **ShellExecuteEx**, see the discussion in [Launching Applications](launch.md).</span></span>

<span data-ttu-id="6d126-141">Un verbo es una cadena de texto simple que el shell usa para identificar el comando asociado.</span><span class="sxs-lookup"><span data-stu-id="6d126-141">A verb is a simple text string that is used by the Shell to identify the associated command.</span></span> <span data-ttu-id="6d126-142">Cada verbo corresponde a la *cadena de comandos* que se usa para iniciar el comando en una ventana de la consola o en un archivo por lotes (. bat).</span><span class="sxs-lookup"><span data-stu-id="6d126-142">Each verb corresponds to the *command string* used to launch the command in a console window or batch (.bat) file.</span></span> <span data-ttu-id="6d126-143">Por ejemplo, el verbo **abrir** normalmente inicia un programa para abrir un archivo.</span><span class="sxs-lookup"><span data-stu-id="6d126-143">For example, the **open** verb normally launches a program to open a file.</span></span> <span data-ttu-id="6d126-144">Normalmente, su cadena de comandos tiene un aspecto similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="6d126-144">Its command string typically looks something like this:</span></span>

``` syntax
"My Program.exe" "%1"
```

<span data-ttu-id="6d126-145">"%1" es el marcador de posición estándar para un parámetro de línea de comandos proporcionado con el nombre de archivo.</span><span class="sxs-lookup"><span data-stu-id="6d126-145">"%1" is the standard placeholder for a command line parameter provided with the filename.</span></span> <span data-ttu-id="6d126-146">Por ejemplo, puede especificar que se muestre una página determinada en una vista con pestañas.</span><span class="sxs-lookup"><span data-stu-id="6d126-146">For instance, it can specify a particular page to display in a tabbed view.</span></span>

> [!Note]  
> <span data-ttu-id="6d126-147">Si algún elemento de la cadena de comandos contiene o puede contener espacios, debe escribirse entre comillas.</span><span class="sxs-lookup"><span data-stu-id="6d126-147">If any element of the command string contains or might contain spaces, it must be enclosed in quotation marks.</span></span> <span data-ttu-id="6d126-148">De lo contrario, si el elemento contiene un espacio, no se analizará correctamente.</span><span class="sxs-lookup"><span data-stu-id="6d126-148">Otherwise, if the element contains a space, it will not parse correctly.</span></span> <span data-ttu-id="6d126-149">Por ejemplo, "My Program.exe" iniciará la aplicación correctamente.</span><span class="sxs-lookup"><span data-stu-id="6d126-149">For instance, "My Program.exe" will launch the application properly.</span></span> <span data-ttu-id="6d126-150">Si usa mi Program.exe, el sistema intentará iniciar "My" con "Program.exe" como el primer argumento de la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="6d126-150">If you use My Program.exe, the system will attempt to launch "My" with "Program.exe" as its first command line argument.</span></span> <span data-ttu-id="6d126-151">Siempre debe usar comillas con argumentos como "%1" que se expandan a cadenas mediante el Shell, ya que no puede estar seguro de que la cadena no contendrá un espacio.</span><span class="sxs-lookup"><span data-stu-id="6d126-151">You should always use quotation marks with arguments such as "%1" that are expanded to strings by the Shell, because you cannot be certain that the string will not contain a space.</span></span>

 

<span data-ttu-id="6d126-152">Los verbos también pueden tener una *cadena de presentación* asociada, que se muestra en el menú contextual en lugar de la propia cadena de verbo.</span><span class="sxs-lookup"><span data-stu-id="6d126-152">Verbs can also have a *display string* associated with them, which is displayed on the shortcut menu instead of the verb string itself.</span></span> <span data-ttu-id="6d126-153">Por ejemplo, la cadena de presentación para **openas** está abierta con.</span><span class="sxs-lookup"><span data-stu-id="6d126-153">For example, the display string for **openas** is Open With.</span></span> <span data-ttu-id="6d126-154">Al igual que las cadenas de menú normales, incluso una y comercial (&) en la cadena de presentación permite la selección del teclado del comando.</span><span class="sxs-lookup"><span data-stu-id="6d126-154">Like normal menu strings, including an ampersand (&) in the display string allows keyboard selection of the command.</span></span>

### <a name="canonical-verbs"></a><span data-ttu-id="6d126-155">Verbos canónicos</span><span class="sxs-lookup"><span data-stu-id="6d126-155">Canonical Verbs</span></span>

<span data-ttu-id="6d126-156">En general, las aplicaciones son responsables de proporcionar cadenas de presentación localizadas para los verbos que definen.</span><span class="sxs-lookup"><span data-stu-id="6d126-156">In general, applications are responsible for providing localized display strings for the verbs they define.</span></span> <span data-ttu-id="6d126-157">Sin embargo, para proporcionar un grado de independencia de lenguaje, el sistema define un conjunto estándar de verbos usados comúnmente denominados *verbos canónicos*.</span><span class="sxs-lookup"><span data-stu-id="6d126-157">However, to provide a degree of language independence, the system defines a standard set of commonly used verbs called *canonical verbs*.</span></span> <span data-ttu-id="6d126-158">Un verbo canónico se puede usar con cualquier lenguaje y el sistema genera automáticamente una cadena de presentación localizada correctamente.</span><span class="sxs-lookup"><span data-stu-id="6d126-158">A canonical verb can be used with any language, and the system automatically generates a properly localized display string.</span></span> <span data-ttu-id="6d126-159">Por ejemplo, la cadena de presentación del verbo **abierto** se establecerá en abierto en un sistema en inglés y en öffnen en un sistema alemán.</span><span class="sxs-lookup"><span data-stu-id="6d126-159">For instance, the **open** verb's display string will be set to Open on an English system, and to Öffnen on a German system.</span></span>

<span data-ttu-id="6d126-160">Los verbos canónicos incluyen:</span><span class="sxs-lookup"><span data-stu-id="6d126-160">The canonical verbs include:</span></span>



| <span data-ttu-id="6d126-161">Value</span><span class="sxs-lookup"><span data-stu-id="6d126-161">Value</span></span>      | <span data-ttu-id="6d126-162">Descripción</span><span class="sxs-lookup"><span data-stu-id="6d126-162">Description</span></span>                                                                                 |
|------------|---------------------------------------------------------------------------------------------|
| <span data-ttu-id="6d126-163">abrir</span><span class="sxs-lookup"><span data-stu-id="6d126-163">open</span></span>       | <span data-ttu-id="6d126-164">Abre el archivo o la carpeta.</span><span class="sxs-lookup"><span data-stu-id="6d126-164">Opens the file or folder.</span></span>                                                                   |
| <span data-ttu-id="6d126-165">opennew</span><span class="sxs-lookup"><span data-stu-id="6d126-165">opennew</span></span>    | <span data-ttu-id="6d126-166">Abre el archivo o la carpeta en una nueva ventana.</span><span class="sxs-lookup"><span data-stu-id="6d126-166">Opens the file or folder in a new window.</span></span>                                                   |
| <span data-ttu-id="6d126-167">imprimir</span><span class="sxs-lookup"><span data-stu-id="6d126-167">print</span></span>      | <span data-ttu-id="6d126-168">Imprime el archivo.</span><span class="sxs-lookup"><span data-stu-id="6d126-168">Prints the file.</span></span>                                                                            |
| <span data-ttu-id="6d126-169">explore</span><span class="sxs-lookup"><span data-stu-id="6d126-169">explore</span></span>    | <span data-ttu-id="6d126-170">Abre el explorador de Windows con la carpeta seleccionada.</span><span class="sxs-lookup"><span data-stu-id="6d126-170">Opens Windows Explorer with the folder selected.</span></span>                                            |
| <span data-ttu-id="6d126-171">find</span><span class="sxs-lookup"><span data-stu-id="6d126-171">find</span></span>       | <span data-ttu-id="6d126-172">Abre el cuadro de diálogo de **búsqueda de Windows** con la carpeta establecida como ubicación de búsqueda predeterminada.</span><span class="sxs-lookup"><span data-stu-id="6d126-172">Opens the **Windows Search** dialog box with the folder set as the default search location.</span></span> |
| <span data-ttu-id="6d126-173">abriras</span><span class="sxs-lookup"><span data-stu-id="6d126-173">openas</span></span>     | <span data-ttu-id="6d126-174">Abre el cuadro **de diálogo Abrir con** .</span><span class="sxs-lookup"><span data-stu-id="6d126-174">Opens the **Open With** dialog box.</span></span>                                                         |
| <span data-ttu-id="6d126-175">properties</span><span class="sxs-lookup"><span data-stu-id="6d126-175">properties</span></span> | <span data-ttu-id="6d126-176">Abre la hoja de propiedades del objeto.</span><span class="sxs-lookup"><span data-stu-id="6d126-176">Opens the object's property sheet.</span></span>                                                          |



 

<span data-ttu-id="6d126-177">El verbo printto también es canónico, pero nunca se muestra.</span><span class="sxs-lookup"><span data-stu-id="6d126-177">The printto verb is also canonical but is never displayed.</span></span> <span data-ttu-id="6d126-178">Permite al usuario imprimir un archivo arrastrándolo a un objeto de impresora.</span><span class="sxs-lookup"><span data-stu-id="6d126-178">It allows the user to print a file by dragging it to a printer object.</span></span>

### <a name="extended-verbs"></a><span data-ttu-id="6d126-179">Verbos extendidos</span><span class="sxs-lookup"><span data-stu-id="6d126-179">Extended Verbs</span></span>

<span data-ttu-id="6d126-180">Cuando el usuario hace clic con el botón secundario en un objeto, el menú contextual contiene todos los verbos normales.</span><span class="sxs-lookup"><span data-stu-id="6d126-180">When the user right-clicks an object, the shortcut menu contains all the normal verbs.</span></span> <span data-ttu-id="6d126-181">Sin embargo, podría haber comandos que desee admitir pero que no se hayan mostrado en cada menú contextual.</span><span class="sxs-lookup"><span data-stu-id="6d126-181">However, there could be commands that you want to support but not have displayed on every shortcut menu.</span></span> <span data-ttu-id="6d126-182">Por ejemplo, podría tener comandos que no se usan habitualmente o que están destinados a usuarios con experiencia.</span><span class="sxs-lookup"><span data-stu-id="6d126-182">For example, you could have commands that are not commonly used or that are intended for experienced users.</span></span> <span data-ttu-id="6d126-183">Por esta razón, también puede definir uno o más *verbos extendidos*.</span><span class="sxs-lookup"><span data-stu-id="6d126-183">For this reason, you can also define one or more *extended verbs*.</span></span> <span data-ttu-id="6d126-184">Estos verbos también son cadenas de caracteres y son similares a los verbos normales.</span><span class="sxs-lookup"><span data-stu-id="6d126-184">These verbs are also character strings and are similar to normal verbs.</span></span> <span data-ttu-id="6d126-185">Se distinguen de los verbos normales por la forma en que se registran.</span><span class="sxs-lookup"><span data-stu-id="6d126-185">They are distinguished from normal verbs by the way they are registered.</span></span> <span data-ttu-id="6d126-186">Para tener acceso a los comandos asociados a los verbos extendidos, el usuario debe hacer clic con el botón derecho en un objeto mientras presiona la tecla Mayús.</span><span class="sxs-lookup"><span data-stu-id="6d126-186">To have access to the commands associated with extended verbs, the user must right-click an object while pressing the SHIFT key.</span></span> <span data-ttu-id="6d126-187">Los verbos extendidos se mostrarán junto con los verbos normales.</span><span class="sxs-lookup"><span data-stu-id="6d126-187">The extended verbs will then be displayed along with the normal verbs.</span></span>

## <a name="extending-the-shortcut-menu-for-a-file-type"></a><span data-ttu-id="6d126-188">Extender el menú contextual para un tipo de archivo</span><span class="sxs-lookup"><span data-stu-id="6d126-188">Extending the Shortcut Menu for a File Type</span></span>

<span data-ttu-id="6d126-189">La manera más sencilla de extender el menú contextual para un tipo de archivo es con el registro.</span><span class="sxs-lookup"><span data-stu-id="6d126-189">The simplest way to extend the shortcut menu for a file type is with the registry.</span></span> <span data-ttu-id="6d126-190">Para ello, agregue una subclave de **Shell** debajo de la clave para el ProgID de la aplicación asociada con el [tipo de archivo](fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="6d126-190">To do this, add a **Shell** subkey below the key for the ProgID of the application associated with the [file type](fa-file-types.md).</span></span> <span data-ttu-id="6d126-191">Opcionalmente, puede definir un *verbo predeterminado* para el tipo de archivo convirtiéndolo en el valor predeterminado de la subclave del **Shell** .</span><span class="sxs-lookup"><span data-stu-id="6d126-191">Optionally, you can define a *default verb* for the file type by making it the default value of the **Shell** subkey.</span></span>

<span data-ttu-id="6d126-192">En primer lugar, se muestra el verbo predeterminado en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="6d126-192">The default verb is displayed first on the shortcut menu.</span></span> <span data-ttu-id="6d126-193">Su finalidad es proporcionar el shell con un verbo que se puede usar cuando se llama a [**ShellExecuteEx**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecuteexa) pero no se especifica ningún verbo.</span><span class="sxs-lookup"><span data-stu-id="6d126-193">Its purpose is to provide the Shell with a verb it can use when [**ShellExecuteEx**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecuteexa) is called but no verb is specified.</span></span> <span data-ttu-id="6d126-194">El shell no selecciona necesariamente el verbo predeterminado cuando se usa **ShellExecuteEx** de este modo.</span><span class="sxs-lookup"><span data-stu-id="6d126-194">The Shell does not necessarily select the default verb when **ShellExecuteEx** is used in this fashion.</span></span> <span data-ttu-id="6d126-195">En el caso de [las versiones](versions.md) de Shell 5,0 y posteriores, que se encuentran en los sistemas Windows 2000 y versiones posteriores, el shell usa el primer verbo disponible de la lista siguiente.</span><span class="sxs-lookup"><span data-stu-id="6d126-195">For Shell [versions 5.0](versions.md) and later, found on Windows 2000 and later systems, the Shell uses the first available verb from the following list.</span></span> <span data-ttu-id="6d126-196">Si no hay ninguno disponible, se produce un error en la operación.</span><span class="sxs-lookup"><span data-stu-id="6d126-196">If none are available, the operation fails.</span></span>

-   <span data-ttu-id="6d126-197">El verbo Open</span><span class="sxs-lookup"><span data-stu-id="6d126-197">The open verb</span></span>
-   <span data-ttu-id="6d126-198">El verbo predeterminado</span><span class="sxs-lookup"><span data-stu-id="6d126-198">The default verb</span></span>
-   <span data-ttu-id="6d126-199">Primer verbo del registro</span><span class="sxs-lookup"><span data-stu-id="6d126-199">The first verb in the registry</span></span>
-   <span data-ttu-id="6d126-200">El verbo OpenWith</span><span class="sxs-lookup"><span data-stu-id="6d126-200">The openwith verb</span></span>

<span data-ttu-id="6d126-201">En el caso de las versiones de Shell anteriores a la [versión 5,0](versions.md), omita el tercer elemento.</span><span class="sxs-lookup"><span data-stu-id="6d126-201">For Shell versions prior to [version 5.0](versions.md), omit the third item.</span></span>

<span data-ttu-id="6d126-202">Debajo de la subclave del **Shell** , cree una subclave para cada verbo que desee agregar.</span><span class="sxs-lookup"><span data-stu-id="6d126-202">Below the **Shell** subkey, create one subkey for each verb you want to add.</span></span> <span data-ttu-id="6d126-203">Cada una de estas subclaves tendrá un valor de **reg \_ SZ** establecido en la cadena de presentación del verbo.</span><span class="sxs-lookup"><span data-stu-id="6d126-203">Each of these subkeys will have a **REG\_SZ** value set to the verb's display string.</span></span> <span data-ttu-id="6d126-204">Puede omitir la cadena de presentación para verbos canónicos, ya que el sistema mostrará automáticamente una cadena localizada correctamente.</span><span class="sxs-lookup"><span data-stu-id="6d126-204">You can omit the display string for canonical verbs because the system will automatically display a properly localized string.</span></span> <span data-ttu-id="6d126-205">Si omite la cadena de presentación para verbos no canónicos, se mostrará la cadena de verbo.</span><span class="sxs-lookup"><span data-stu-id="6d126-205">If you omit the display string for noncanonical verbs, the verb string will be displayed.</span></span> <span data-ttu-id="6d126-206">Para cada subclave de verbo, cree una subclave de **comando** con el valor predeterminado establecido en la cadena de comando.</span><span class="sxs-lookup"><span data-stu-id="6d126-206">For each verb subkey, create a **command** subkey with the default value set to the command string.</span></span>

<span data-ttu-id="6d126-207">En la ilustración siguiente se muestra un menú contextual para el tipo de archivo. MYP que se usa en los [tipos de archivo](fa-file-types.md) y la [Personalización de iconos](icon.md).</span><span class="sxs-lookup"><span data-stu-id="6d126-207">The following illustration shows a shortcut menu for the .myp file type used in [File Types](fa-file-types.md) and [Customizing Icons](icon.md).</span></span> <span data-ttu-id="6d126-208">Ahora tiene los verbos Open, doit, Print e printto en el menú contextual, con doit como el verbo predeterminado.</span><span class="sxs-lookup"><span data-stu-id="6d126-208">It now has open, doit, print, and printto verbs on its shortcut menu, with doit as the default verb.</span></span> <span data-ttu-id="6d126-209">El menú contextual tiene el siguiente aspecto.</span><span class="sxs-lookup"><span data-stu-id="6d126-209">The shortcut menu looks like this.</span></span>

![captura de pantalla del menú contextual personalizado](images/context3.jpg)

<span data-ttu-id="6d126-211">Las entradas del registro que se usan para extender el menú contextual que se muestra en la ilustración anterior son:</span><span class="sxs-lookup"><span data-stu-id="6d126-211">The registry entries used to extend the shortcut menu shown in the preceding illustration are:</span></span>

```
HKEY_CLASSES_ROOT
   .myp
      (Default) = MyProgram.1
   MyProgram.1
      (Default) = MyProgram Application
      Shell
         (Default) = doit
         open
            command
               (Default) = C:\MyDir\MyProgram.exe "%1"
         doit
            (Default) = &Do It
            command
               (Default) = C:\MyDir\MyProgram.exe /d "%1"
         print
            command
               (Default) = C:\MyDir\MyProgram.exe /p "%1"
         printto
            command
               (Default) = C:\MyDir\MyProgram.exe /p "%1" "%2" %3 %4
```

<span data-ttu-id="6d126-212">Aunque el comando **abrir con** está por encima del primer separador, el sistema lo crea automáticamente y no requiere una entrada del registro.</span><span class="sxs-lookup"><span data-stu-id="6d126-212">Although the **Open With** command is above the first separator, it is automatically created by the system and does not require a registry entry.</span></span> <span data-ttu-id="6d126-213">El sistema crea automáticamente nombres para mostrar para los verbos canónicos abrir e imprimir.</span><span class="sxs-lookup"><span data-stu-id="6d126-213">The system automatically creates display names for the canonical verbs open and print.</span></span> <span data-ttu-id="6d126-214">Dado que doit no es un verbo canónico, se le asigna un nombre para mostrar, "&hacerlo", que se puede seleccionar presionando la tecla D.</span><span class="sxs-lookup"><span data-stu-id="6d126-214">Because doit is not a canonical verb, it is assigned a display name, "&Do It", which can be selected by pressing the D key.</span></span> <span data-ttu-id="6d126-215">El verbo printto no aparece en el menú contextual, pero la inclusión permite al usuario imprimir archivos colocándolos en un icono de impresora.</span><span class="sxs-lookup"><span data-stu-id="6d126-215">The printto verb does not appear on the shortcut menu, but including it allows the user to print files by dropping them on a printer icon.</span></span> <span data-ttu-id="6d126-216">En este ejemplo, %1 representa el nombre de archivo y %2 el nombre de la impresora.</span><span class="sxs-lookup"><span data-stu-id="6d126-216">In this example, %1 represents the file name and %2 the printer name.</span></span>

<span data-ttu-id="6d126-217">Los verbos se pueden suprimir a través de la configuración de la Directiva agregando un valor de SuppressionPolicy a la clave del verbo.</span><span class="sxs-lookup"><span data-stu-id="6d126-217">Verbs can be suppressed through policy settings by adding a SuppressionPolicy value to the verb's key.</span></span> <span data-ttu-id="6d126-218">Establezca el valor de SuppressionPolicy en el identificador de la Directiva.</span><span class="sxs-lookup"><span data-stu-id="6d126-218">Set the value of SuppressionPolicy to the policy ID.</span></span> <span data-ttu-id="6d126-219">Si la Directiva está activada, se suprimen el verbo y su entrada de menú contextual asociada.</span><span class="sxs-lookup"><span data-stu-id="6d126-219">If the policy is turned on, the verb and its associated shortcut menu entry are suppressed.</span></span> <span data-ttu-id="6d126-220">Para ver los posibles valores de ID. de Directiva, consulte la enumeración [**restrictions**](/windows/desktop/api/shlobj_core/ne-shlobj_core-restrictions) .</span><span class="sxs-lookup"><span data-stu-id="6d126-220">For possible policy ID values, see the [**RESTRICTIONS**](/windows/desktop/api/shlobj_core/ne-shlobj_core-restrictions) enumeration.</span></span>

## <a name="extending-the-shortcut-menu-for-predefined-shell-objects"></a><span data-ttu-id="6d126-221">Extender el menú contextual para objetos de Shell predefinidos</span><span class="sxs-lookup"><span data-stu-id="6d126-221">Extending the Shortcut Menu for Predefined Shell Objects</span></span>

<span data-ttu-id="6d126-222">Muchos objetos de Shell predefinidos tienen menús contextuales que se pueden extender.</span><span class="sxs-lookup"><span data-stu-id="6d126-222">Many predefined Shell objects have shortcut menus that can be extended.</span></span> <span data-ttu-id="6d126-223">Registre el comando de la misma manera que registra los tipos de archivo típicos, pero use el nombre del objeto predefinido como el nombre del tipo de archivo.</span><span class="sxs-lookup"><span data-stu-id="6d126-223">Register the command in much the same way that you register typical file types, but use the name of the predefined object as the file type name.</span></span>

<span data-ttu-id="6d126-224">Puede encontrar una lista de objetos predefinidos en la sección *objetos de Shell predefinidos* de [crear controladores de extensión de Shell](handlers.md).</span><span class="sxs-lookup"><span data-stu-id="6d126-224">A list of predefined objects can be found in the *Predefined Shell Objects* section of [Creating Shell Extension Handlers](handlers.md).</span></span> <span data-ttu-id="6d126-225">Los objetos de Shell predefinidos cuyos menús contextuales se pueden extender agregando verbos en el registro se marcan en la tabla con la palabra "verbo".</span><span class="sxs-lookup"><span data-stu-id="6d126-225">Those predefined Shell objects whose shortcut menus can be extended by adding verbs in the registry are marked in the table with the word "Verb."</span></span>

## <a name="registering-an-application-to-handle-arbitrary-file-types"></a><span data-ttu-id="6d126-226">Registro de una aplicación para controlar tipos de archivo arbitrarios</span><span class="sxs-lookup"><span data-stu-id="6d126-226">Registering an Application to Handle Arbitrary File Types</span></span>

<span data-ttu-id="6d126-227">En las secciones anteriores de este documento se ha explicado cómo definir los elementos de menú contextual para un tipo de archivo determinado.</span><span class="sxs-lookup"><span data-stu-id="6d126-227">The preceding sections of this document have discussed how to define shortcut menu items for a particular file type.</span></span> <span data-ttu-id="6d126-228">Entre otras cosas, la definición del menú contextual permite especificar el modo en que la aplicación asociada abre un miembro del tipo de archivo.</span><span class="sxs-lookup"><span data-stu-id="6d126-228">Among other things, defining the shortcut menu allows you to specify how the associated application opens a member of the file type.</span></span> <span data-ttu-id="6d126-229">Sin embargo, como se describe en [tipos de archivo](fa-file-types.md), las aplicaciones también pueden registrar un procedimiento predeterminado independiente que se utilizará cuando un usuario intente usar la aplicación para abrir un tipo de archivo que no se haya asociado a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="6d126-229">However, as discussed in [File Types](fa-file-types.md), applications can also register a separate default procedure to be used when a user attempts to use your application to open a file type that you have not associated with the application.</span></span> <span data-ttu-id="6d126-230">Este tema se describe aquí porque el procedimiento predeterminado se registra de forma muy similar a como se registran los elementos de menú contextual.</span><span class="sxs-lookup"><span data-stu-id="6d126-230">This topic is discussed here because you register the default procedure in much the same way you register shortcut menu items.</span></span>

<span data-ttu-id="6d126-231">El procedimiento predeterminado sirve para dos propósitos básicos.</span><span class="sxs-lookup"><span data-stu-id="6d126-231">The default procedure serves two basic purposes.</span></span> <span data-ttu-id="6d126-232">Uno consiste en especificar cómo se debe invocar la aplicación para abrir un tipo de archivo arbitrario.</span><span class="sxs-lookup"><span data-stu-id="6d126-232">One is to specify how your application should be invoked to open an arbitrary file type.</span></span> <span data-ttu-id="6d126-233">Por ejemplo, podría usar una marca de línea de comandos para indicar que se está abriendo un tipo de archivo desconocido.</span><span class="sxs-lookup"><span data-stu-id="6d126-233">You could, for instance, use a command-line flag to indicate that an unknown file type is being opened.</span></span> <span data-ttu-id="6d126-234">El otro propósito es definir las distintas características de un tipo de archivo, como los elementos de menú contextual y el icono.</span><span class="sxs-lookup"><span data-stu-id="6d126-234">The other purpose is to define the various characteristics of a file type, such as the shortcut menu items and the icon.</span></span> <span data-ttu-id="6d126-235">Si un usuario asocia su aplicación con un tipo de archivo adicional, ese tipo tendrá estas características.</span><span class="sxs-lookup"><span data-stu-id="6d126-235">If a user associates your application with an additional file type, that type will have these characteristics.</span></span> <span data-ttu-id="6d126-236">Si el tipo de archivo adicional estaba asociado previamente a otra aplicación, estas características reemplazarán a los originales.</span><span class="sxs-lookup"><span data-stu-id="6d126-236">If the additional file type was previously associated with another application, these characteristics will replace the originals.</span></span>

<span data-ttu-id="6d126-237">Para registrar el procedimiento predeterminado, coloque las mismas claves del registro que creó para el ID. de programa de la aplicación en la subclave de la aplicación de las aplicaciones **\_ \_ raíz HKEY** \\ .</span><span class="sxs-lookup"><span data-stu-id="6d126-237">To register the default procedure, place the same registry keys you created for your application's ProgID under the application's subkey of **HKEY\_CLASSES\_ROOT**\\**Applications**.</span></span> <span data-ttu-id="6d126-238">También puede incluir un valor de FriendlyAppName para proporcionar al sistema un nombre descriptivo para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="6d126-238">You can also include a FriendlyAppName value to provide the system with a friendly name for your application.</span></span> <span data-ttu-id="6d126-239">También se puede extraer el nombre descriptivo de la aplicación de su archivo ejecutable, pero solo si el valor de FriendlyAppName no está presente.</span><span class="sxs-lookup"><span data-stu-id="6d126-239">The application's friendly name may also be extracted from its executable file, but only if the FriendlyAppName value is absent.</span></span> <span data-ttu-id="6d126-240">El siguiente fragmento del registro muestra un procedimiento predeterminado de ejemplo para MyProgram.exe que define un nombre descriptivo y varios elementos de menú contextual.</span><span class="sxs-lookup"><span data-stu-id="6d126-240">The following registry fragment shows a sample default procedure for MyProgram.exe that defines a friendly name and several shortcut menu items.</span></span> <span data-ttu-id="6d126-241">Las cadenas de comandos incluyen la marca/a para notificar a la aplicación que está abriendo un tipo de archivo arbitrario.</span><span class="sxs-lookup"><span data-stu-id="6d126-241">The command strings include the /a flag to notify the application that it is opening an arbitrary file type.</span></span> <span data-ttu-id="6d126-242">Si incluye una subclave **DefaultIcon** , debe usar un icono genérico.</span><span class="sxs-lookup"><span data-stu-id="6d126-242">If you include a **DefaultIcon** subkey, you should use a generic icon.</span></span>

```
HKEY_CLASSES_ROOT
   Applications
      MyProgram.exe
         FriendlyAppName = Friendly Name
         shell
            open
               command
                  (Default) = C:\MyDir\MyProgram.exe /a "%1"
            print
               command
                  (Default) = C:\MyDir\MyProgram.exe /a /p "%1"
            printto
               command
                  (Default) = C:\MyDir\MyProgram.exe /a /p "%1" "%2" %3 %4
```

## <a name="extending-the-new-submenu"></a><span data-ttu-id="6d126-243">Extender el nuevo submenú</span><span class="sxs-lookup"><span data-stu-id="6d126-243">Extending the New Submenu</span></span>

<span data-ttu-id="6d126-244">Cuando un usuario abre el menú **archivo** en el explorador de Windows, el primer comando es **nuevo**.</span><span class="sxs-lookup"><span data-stu-id="6d126-244">When a user opens the **File** menu in Windows Explorer, the first command is **New**.</span></span> <span data-ttu-id="6d126-245">Al seleccionar este comando se muestra un submenú.</span><span class="sxs-lookup"><span data-stu-id="6d126-245">Selecting this command displays a submenu.</span></span> <span data-ttu-id="6d126-246">De forma predeterminada, contiene dos comandos, **carpeta** y **acceso directo**, que permiten a los usuarios crear subcarpetas y accesos directos.</span><span class="sxs-lookup"><span data-stu-id="6d126-246">By default, it contains two commands, **Folder** and **Shortcut**, that allow users to create subfolders and shortcuts.</span></span> <span data-ttu-id="6d126-247">Este submenú se puede extender para incluir comandos de creación de archivos para cualquier tipo de archivo.</span><span class="sxs-lookup"><span data-stu-id="6d126-247">This submenu can be extended to include file creation commands for any file type.</span></span>

<span data-ttu-id="6d126-248">Para agregar un comando de creación de archivos al **nuevo** submenú, los archivos de la aplicación deben tener un [tipo de archivo](fa-file-types.md) asociado.</span><span class="sxs-lookup"><span data-stu-id="6d126-248">To add a file-creation command to the **New** submenu, your application's files must have a [file type](fa-file-types.md) associated with them.</span></span> <span data-ttu-id="6d126-249">Incluya una subclave **ShellNew** en la clave para la extensión de nombre de archivo.</span><span class="sxs-lookup"><span data-stu-id="6d126-249">Include a **ShellNew** subkey under the key for the file name extension.</span></span> <span data-ttu-id="6d126-250">Cuando se selecciona el comando **nuevo** del menú **archivo** , el shell lo agregará al **nuevo** submenú.</span><span class="sxs-lookup"><span data-stu-id="6d126-250">When the **File** menu's **New** command is selected, the Shell will add it to the **New** submenu.</span></span> <span data-ttu-id="6d126-251">La cadena de presentación del comando será la cadena descriptiva que se asigna al ProgID del programa.</span><span class="sxs-lookup"><span data-stu-id="6d126-251">The command's display string will be the descriptive string that is assigned to the program's ProgID.</span></span>

<span data-ttu-id="6d126-252">Asigne uno o más valores de datos a la subclave **ShellNew** para especificar el método de creación de archivos.</span><span class="sxs-lookup"><span data-stu-id="6d126-252">Assign one or more data values to the **ShellNew** subkey to specify the file creation method.</span></span> <span data-ttu-id="6d126-253">Los valores disponibles son los siguientes.</span><span class="sxs-lookup"><span data-stu-id="6d126-253">The available values follow.</span></span>



| <span data-ttu-id="6d126-254">Value</span><span class="sxs-lookup"><span data-stu-id="6d126-254">Value</span></span>    | <span data-ttu-id="6d126-255">Descripción</span><span class="sxs-lookup"><span data-stu-id="6d126-255">Description</span></span>                                                                                                                                                   |
|----------|---------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="6d126-256">Comando</span><span class="sxs-lookup"><span data-stu-id="6d126-256">Command</span></span>  | <span data-ttu-id="6d126-257">Ejecuta una aplicación.</span><span class="sxs-lookup"><span data-stu-id="6d126-257">Executes an application.</span></span> <span data-ttu-id="6d126-258">Se trata de un valor de **reg \_ SZ** que especifica la ruta de acceso de la aplicación que se va a ejecutar.</span><span class="sxs-lookup"><span data-stu-id="6d126-258">This is a **REG\_SZ** value specifying the path of the application to be executed.</span></span> <span data-ttu-id="6d126-259">Por ejemplo, puede establecerlo para iniciar un asistente.</span><span class="sxs-lookup"><span data-stu-id="6d126-259">For example, you could set it to launch a wizard.</span></span> |
| <span data-ttu-id="6d126-260">Datos</span><span class="sxs-lookup"><span data-stu-id="6d126-260">Data</span></span>     | <span data-ttu-id="6d126-261">Crea un archivo que contiene los datos especificados.</span><span class="sxs-lookup"><span data-stu-id="6d126-261">Creates a file containing specified data.</span></span> <span data-ttu-id="6d126-262">Los datos son un valor **\_ binario de registro** con los datos del archivo.</span><span class="sxs-lookup"><span data-stu-id="6d126-262">Data is a **REG\_BINARY** value with the file's data.</span></span> <span data-ttu-id="6d126-263">Los datos se omiten si se especifica NullFile o FileName.</span><span class="sxs-lookup"><span data-stu-id="6d126-263">Data is ignored if either NullFile or FileName is specified.</span></span>  |
| <span data-ttu-id="6d126-264">FileName</span><span class="sxs-lookup"><span data-stu-id="6d126-264">FileName</span></span> | <span data-ttu-id="6d126-265">Crea un archivo que es una copia de un archivo especificado.</span><span class="sxs-lookup"><span data-stu-id="6d126-265">Creates a file that is a copy of a specified file.</span></span> <span data-ttu-id="6d126-266">FileName es un valor de **reg \_ SZ** , establecido en la ruta de acceso completa del archivo que se va a copiar.</span><span class="sxs-lookup"><span data-stu-id="6d126-266">FileName is a **REG\_SZ** value, set to the fully qualified path of the file to be copied.</span></span>                 |
| <span data-ttu-id="6d126-267">NullFile</span><span class="sxs-lookup"><span data-stu-id="6d126-267">NullFile</span></span> | <span data-ttu-id="6d126-268">Crea un archivo vacío.</span><span class="sxs-lookup"><span data-stu-id="6d126-268">Creates an empty file.</span></span> <span data-ttu-id="6d126-269">NullFile no tiene asignado un valor.</span><span class="sxs-lookup"><span data-stu-id="6d126-269">NullFile is not assigned a value.</span></span> <span data-ttu-id="6d126-270">Si se especifica NullFile, se omiten los valores de los datos y del nombre de archivo.</span><span class="sxs-lookup"><span data-stu-id="6d126-270">If NullFile is specified, the Data and FileName values are ignored.</span></span>                                  |



 

<span data-ttu-id="6d126-271">En la ilustración siguiente se muestra el **nuevo** submenú para el tipo de archivo. MYP que se usa como ejemplo en [tipos de archivo](fa-file-types.md) y [personalizar iconos](icon.md).</span><span class="sxs-lookup"><span data-stu-id="6d126-271">The following illustration shows the **New** submenu for the .myp file type used as an example in [File Types](fa-file-types.md) and [Customizing Icons](icon.md).</span></span> <span data-ttu-id="6d126-272">Ahora tiene un comando, una **aplicación de programa**.</span><span class="sxs-lookup"><span data-stu-id="6d126-272">It now has a command, **MyProgram Application**.</span></span> <span data-ttu-id="6d126-273">Cuando un usuario selecciona mi **aplicación** en el submenú **nuevo** , el shell crea un archivo denominado "New MYP Application." y lo pasa a MyProgram.exe.</span><span class="sxs-lookup"><span data-stu-id="6d126-273">When a user selects **MyProgram Application** from the **New** submenu, the Shell creates a file named "New MyProgram Application.myp" and passes it to MyProgram.exe.</span></span>

![captura de pantalla del menú nuevo personalizado](images/context5.png)

<span data-ttu-id="6d126-275">La entrada del registro es ahora como sigue:</span><span class="sxs-lookup"><span data-stu-id="6d126-275">The registry entry is now as follows:</span></span>

```
HKEY_CLASSES_ROOT
   .myp
      (Default) = MyProgram.1
      MyProgram.1
         ShellNew
            NullFile
   MyProgram.1
      (Default) = MyProgram Application
      DefaultIcon
         (Default) = C:\MyDir\MyProgram.exe,2
      Shell
         (Default) = doit
         open
            command
               (Default) = C:\MyDir\MyProgram.exe "%1"
         doit
            (Default) = &Do It
            command
               (Default) = C:\MyDir\MyProgram.exe /d "%1"
         print
            command
               (Default) = C:\MyDir\MyProgram.exe /p "%1"
         printto
            command
               (Default) = C:\MyDir\MyProgram.exe /p "%1" "%2" %3 %4
```

 

 



