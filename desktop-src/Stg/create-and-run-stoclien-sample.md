---
title: Crear y ejecutar el ejemplo StoClien
description: StoClien funciona en cooperación con un objeto de copapeles en un servidor COM para lograr un almacenamiento persistente de dibujos en archivos compuestos COM.
ms.assetid: bf622104-10dd-4649-88f0-e2bfb15289b1
keywords:
- Crear y ejecutar el ejemplo StoClien
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6f00274293c05e21e660dc8e9448ca95946cab8a
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/16/2019
ms.locfileid: "105665634"
---
# <a name="create-and-run-stoclien-sample"></a><span data-ttu-id="c9ae5-104">Crear y ejecutar el ejemplo StoClien</span><span class="sxs-lookup"><span data-stu-id="c9ae5-104">Create and Run StoClien Sample</span></span>

<span data-ttu-id="c9ae5-105">**StoClien** funciona en cooperación con un objeto de copapeles en un servidor com para lograr un almacenamiento persistente de dibujos en archivos compuestos com.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-105">**StoClien** works in cooperation with a COPaper object in a COM server to achieve persistent storage of drawings in COM compound files.</span></span> <span data-ttu-id="c9ae5-106">Para obtener más información sobre el uso de las secuencias en el archivo compuesto proporcionado al copaper por **StoClien**, vea ejemplo [**StoServe**](structured-storage-server-sample--stoserve-.md) y STOSERVE.HTM.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-106">For more information about COPaper's use of streams in the compound file provided to COPaper by **StoClien**, see [**StoServe**](structured-storage-server-sample--stoserve-.md) sample and STOSERVE.HTM.</span></span> <span data-ttu-id="c9ae5-107">La construcción del copaper y su interfaz IPaper también se incluyen en el ejemplo **StoServe** .</span><span class="sxs-lookup"><span data-stu-id="c9ae5-107">COPaper's construction and its IPaper interface are also covered in the **StoServe** sample.</span></span>

## <a name="code-tour"></a><span data-ttu-id="c9ae5-108">Paseo por código</span><span class="sxs-lookup"><span data-stu-id="c9ae5-108">Code Tour</span></span>

<span data-ttu-id="c9ae5-109">Los temas principales que se tratan en este tutorial de código son:</span><span class="sxs-lookup"><span data-stu-id="c9ae5-109">The major topics covered in this code tour are:</span></span>

-   <span data-ttu-id="c9ae5-110">Cómo encapsula **CGuiPaper** el comportamiento de la GUI del papel de dibujo electrónico de **StoClien**</span><span class="sxs-lookup"><span data-stu-id="c9ae5-110">How **CGuiPaper** encapsulates the GUI behavior of **StoClien**'s electronic drawing paper</span></span>
-   <span data-ttu-id="c9ae5-111">Cómo captura **StoClien** y muestra la actividad de dibujo interactivo</span><span class="sxs-lookup"><span data-stu-id="c9ae5-111">How **StoClien** captures and displays interactive drawing activity</span></span>
-   <span data-ttu-id="c9ae5-112">Cómo usa el objeto **CGuiPaper** el copaper para grabar datos de dibujo</span><span class="sxs-lookup"><span data-stu-id="c9ae5-112">How the **CGuiPaper** object uses COPaper to record drawing data</span></span>
-   <span data-ttu-id="c9ae5-113">Cómo se usa una conexión IPaperSink en la repintado</span><span class="sxs-lookup"><span data-stu-id="c9ae5-113">How an IPaperSink connection is used in repainting</span></span>
-   <span data-ttu-id="c9ae5-114">Cómo los métodos **Load** y **Save** de CPapFile usan el almacenamiento estructurado en archivos compuestos</span><span class="sxs-lookup"><span data-stu-id="c9ae5-114">How the CPapFile **Load** and **Save** methods use the structured storage in compound files</span></span>

<span data-ttu-id="c9ae5-115">Como la clase **CGuiBall** que se usa en los ejemplos FRECLIEN y CONCLIEN encapsulado el comportamiento de una bola de rebote, **StoClien** usa una clase de **CGuiPaper** C++ para encapsular los datos y el comportamiento de la GUI del papel de dibujo electrónico.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-115">As the **CGuiBall** class used in the FRECLIEN and CONCLIEN samples encapsulated the behavior of a bouncing ball, **StoClien** uses a **CGuiPaper** C++ class to encapsulate the data and GUI behavior of electronic drawing paper.</span></span>

<span data-ttu-id="c9ae5-116">En la tabla siguiente se enumeran los archivos pertinentes para el ejemplo **StoClien** .</span><span class="sxs-lookup"><span data-stu-id="c9ae5-116">The following table lists the files pertinent to the **StoClien** sample.</span></span>



| <span data-ttu-id="c9ae5-117">Archivos</span><span class="sxs-lookup"><span data-stu-id="c9ae5-117">Files</span></span>        | <span data-ttu-id="c9ae5-118">Descripción</span><span class="sxs-lookup"><span data-stu-id="c9ae5-118">Description</span></span>                                                                                                                      |
|--------------|----------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="c9ae5-119">STOCLIEN.TXT</span><span class="sxs-lookup"><span data-stu-id="c9ae5-119">STOCLIEN.TXT</span></span> | <span data-ttu-id="c9ae5-120">Breve descripción del ejemplo.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-120">Short sample description.</span></span>                                                                                                        |
| <span data-ttu-id="c9ae5-121">MAKE</span><span class="sxs-lookup"><span data-stu-id="c9ae5-121">MAKEFILE</span></span>     | <span data-ttu-id="c9ae5-122">El archivo make genérico para compilar el ejemplo de código.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-122">The generic makefile for building the code sample.</span></span>                                                                               |
| <span data-ttu-id="c9ae5-123">STOCLIEN. C</span><span class="sxs-lookup"><span data-stu-id="c9ae5-123">STOCLIEN.H</span></span>   | <span data-ttu-id="c9ae5-124">El archivo de inclusión de la aplicación **StoClien** .</span><span class="sxs-lookup"><span data-stu-id="c9ae5-124">The include file for the **StoClien** application.</span></span> <span data-ttu-id="c9ae5-125">Contiene declaraciones de clase, prototipos de función e identificadores de recursos.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-125">Contains class declarations, function prototypes, and resource identifiers.</span></span>   |
| <span data-ttu-id="c9ae5-126">STOCLIEN. CPP</span><span class="sxs-lookup"><span data-stu-id="c9ae5-126">STOCLIEN.CPP</span></span> | <span data-ttu-id="c9ae5-127">El archivo de implementación principal para STOCLIEN.EXE.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-127">The main implementation file for STOCLIEN.EXE.</span></span> <span data-ttu-id="c9ae5-128">Tiene la implementación de WinMain y CMainWindow, así como el menú principal de distribución.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-128">Has WinMain and CMainWindow implementation, as well as the main menu dispatching.</span></span> |
| <span data-ttu-id="c9ae5-129">STOCLIEN. CR</span><span class="sxs-lookup"><span data-stu-id="c9ae5-129">STOCLIEN.RC</span></span>  | <span data-ttu-id="c9ae5-130">El archivo de definición de recursos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-130">The application resource definition file.</span></span>                                                                                        |
| <span data-ttu-id="c9ae5-131">STOCLIEN. ICO</span><span class="sxs-lookup"><span data-stu-id="c9ae5-131">STOCLIEN.ICO</span></span> | <span data-ttu-id="c9ae5-132">El recurso de icono de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-132">The application icon resource.</span></span>                                                                                                   |
| <span data-ttu-id="c9ae5-133">STOCLIEN. Papanicolau</span><span class="sxs-lookup"><span data-stu-id="c9ae5-133">STOCLIEN.PAP</span></span> | <span data-ttu-id="c9ae5-134">Un archivo de dibujo de papel predeterminado para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-134">A default paper drawing file for the application.</span></span>                                                                                |
| <span data-ttu-id="c9ae5-135">Lápiz. Espacia</span><span class="sxs-lookup"><span data-stu-id="c9ae5-135">PENCIL.CUR</span></span>   | <span data-ttu-id="c9ae5-136">Una imagen de lápiz para el cursor de la ventana de cliente.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-136">A pencil image for the client window cursor.</span></span>                                                                                     |
| <span data-ttu-id="c9ae5-137">Receptor. C</span><span class="sxs-lookup"><span data-stu-id="c9ae5-137">SINK.H</span></span>       | <span data-ttu-id="c9ae5-138">La declaración de clase para la clase de objeto COM COPaperSink.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-138">The class declaration for the COPaperSink COM object class.</span></span>                                                                      |
| <span data-ttu-id="c9ae5-139">Receptor. CPP</span><span class="sxs-lookup"><span data-stu-id="c9ae5-139">SINK.CPP</span></span>     | <span data-ttu-id="c9ae5-140">Archivo de implementación para la clase de objeto COM COPaperSink.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-140">Implementation file for the COPaperSink COM object class.</span></span>                                                                        |
| <span data-ttu-id="c9ae5-141">PAPFILE. C</span><span class="sxs-lookup"><span data-stu-id="c9ae5-141">PAPFILE.H</span></span>    | <span data-ttu-id="c9ae5-142">La declaración de clase para la clase de C++ **CPapFile** .</span><span class="sxs-lookup"><span data-stu-id="c9ae5-142">The class declaration for the **CPapFile** C++ class.</span></span>                                                                            |
| <span data-ttu-id="c9ae5-143">PAPFILE. CPP</span><span class="sxs-lookup"><span data-stu-id="c9ae5-143">PAPFILE.CPP</span></span>  | <span data-ttu-id="c9ae5-144">Archivo de implementación para la clase de C++ **CPapFile** .</span><span class="sxs-lookup"><span data-stu-id="c9ae5-144">Implementation file for the **CPapFile** C++ class.</span></span>                                                                              |
| <span data-ttu-id="c9ae5-145">GUIPAPER. C</span><span class="sxs-lookup"><span data-stu-id="c9ae5-145">GUIPAPER.H</span></span>   | <span data-ttu-id="c9ae5-146">La declaración de clase para la clase de C++ **CGuiPaper** .</span><span class="sxs-lookup"><span data-stu-id="c9ae5-146">The class declaration for the **CGuiPaper** C++ class.</span></span>                                                                           |
| <span data-ttu-id="c9ae5-147">GUIPAPER. CPP</span><span class="sxs-lookup"><span data-stu-id="c9ae5-147">GUIPAPER.CPP</span></span> | <span data-ttu-id="c9ae5-148">Archivo de implementación para la clase de C++ **CGuiPaper** .</span><span class="sxs-lookup"><span data-stu-id="c9ae5-148">Implementation file for the **CGuiPaper** C++ class.</span></span>                                                                             |
| <span data-ttu-id="c9ae5-149">STOCLIEN. DSP</span><span class="sxs-lookup"><span data-stu-id="c9ae5-149">STOCLIEN.DSP</span></span> | <span data-ttu-id="c9ae5-150">Microsoft Visual Studio archivo de proyecto.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-150">Microsoft Visual Studio Project file.</span></span>                                                                                            |



 

## <a name="compound-files"></a><span data-ttu-id="c9ae5-151">archivos compuestos</span><span class="sxs-lookup"><span data-stu-id="c9ae5-151">Compound Files</span></span>

<span data-ttu-id="c9ae5-152">**StoClien** se basa en el copapel para grabar datos de dibujo.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-152">**StoClien** relies on COPaper to record drawing data.</span></span> <span data-ttu-id="c9ae5-153">También se basa en el copapel para almacenar los datos en un archivo compuesto.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-153">It also relies on COPaper to store the data in a compound file.</span></span> <span data-ttu-id="c9ae5-154">Sin embargo, en una división típica de trabajo entre el cliente y el servidor COM, **StoClien** comparte parte de la responsabilidad del almacenamiento de archivos.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-154">However, in a typical division of labor between COM client and server, **StoClien** shares part of the responsibility for file storage.</span></span> <span data-ttu-id="c9ae5-155">Esta división de trabajo es importante en las aplicaciones COM donde el cliente es un contenedor y el servidor es un objeto incrustado.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-155">This division of labor is important in COM applications where the client is a container and the server is an embedded object.</span></span> <span data-ttu-id="c9ae5-156">En esta disposición, el cliente es responsable de crear o abrir un archivo de almacenamiento estructurado, mientras que el objeto de servidor es responsable de usar ese almacenamiento para sus propios fines de almacenamiento de datos.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-156">In this arrangement, the client is responsible for creating or opening a structured storage file, while the server object is responsible for using that storage for its own data storage purposes.</span></span> <span data-ttu-id="c9ae5-157">Esto puede implicar que el objeto de servidor cree subalmacenamientos en el almacenamiento que se le proporciona.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-157">This may involve the server object creating substorages in the storage that is given to it.</span></span> <span data-ttu-id="c9ae5-158">Normalmente implica el objeto de servidor que crea los objetos de secuencia en el almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-158">It usually involves the server object creating stream objects in the storage.</span></span> <span data-ttu-id="c9ae5-159">El uso del copaper de flujos de almacenamiento se detalla en el ejemplo **StoClien** .</span><span class="sxs-lookup"><span data-stu-id="c9ae5-159">COPaper's use of storage streams is detailed in the **StoClien** sample.</span></span>

<span data-ttu-id="c9ae5-160">El cliente y el objeto de servidor usan la interfaz [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) para realizar operaciones de archivo.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-160">The [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) interface is used by both client and server object to perform file operations.</span></span> <span data-ttu-id="c9ae5-161">Se usa la implementación de archivos compuestos de la arquitectura de almacenamiento estructurado.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-161">The compound files implementation of the Structured Storage architecture is used.</span></span> <span data-ttu-id="c9ae5-162">Las funciones de servicio estándar se utilizan para las operaciones en archivos compuestos.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-162">Standard service functions are used for operations on compound files.</span></span> <span data-ttu-id="c9ae5-163">Por ejemplo, la función [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) crea inicialmente un archivo compuesto y devuelve un puntero **IStorage** que se puede usar para manipular el archivo.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-163">For example, the [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) function initially creates a compound file and passes back an **IStorage** pointer that can be used to manipulate the file.</span></span> <span data-ttu-id="c9ae5-164">Se llama a esta función concreta en **StoClien**.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-164">This particular function is called in **StoClien**.</span></span> <span data-ttu-id="c9ae5-165">La interfaz **IStorage** que obtiene se pasa como un parámetro al copaper para su uso.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-165">The **IStorage** interface it obtains is passed as a parameter to COPaper for its use.</span></span> <span data-ttu-id="c9ae5-166">El objeto de copaper no crea ni abre archivos compuestos por sí solo: usa las interfaces **IStorage** y [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) para trabajar en archivos compuestos que se le proporcionan.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-166">The COPaper object does not create or open compound files on its own: It uses the **IStorage** and [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) interfaces to work in compound files that are given to it.</span></span>

<span data-ttu-id="c9ae5-167">Estas interfaces [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) y [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) no se implementan dentro de **StoClien** o **StoServe**.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-167">These [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) and [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) interfaces are not implemented within **StoClien** or **StoServe**.</span></span> <span data-ttu-id="c9ae5-168">Se implementan dentro de las bibliotecas COM.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-168">They are implemented within the COM libraries.</span></span> <span data-ttu-id="c9ae5-169">Cuando se obtiene un puntero a una de estas interfaces, los métodos se usan esencialmente como un conjunto de servicios para operar en un archivo compuesto.</span><span class="sxs-lookup"><span data-stu-id="c9ae5-169">When a pointer to one of these interfaces is obtained, their methods are essentially used as a set of services to operate on a compound file.</span></span>

 

 




