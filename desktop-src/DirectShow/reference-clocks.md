---
description: Relojes de referencia
ms.assetid: 43f1a4d6-dbed-4940-a301-d863ddd34bce
title: Relojes de referencia
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f9b958787f4dbdb20cd595b10cf486f59222a072
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/06/2021
ms.locfileid: "105677094"
---
# <a name="reference-clocks"></a><span data-ttu-id="0d14d-103">Relojes de referencia</span><span class="sxs-lookup"><span data-stu-id="0d14d-103">Reference Clocks</span></span>

<span data-ttu-id="0d14d-104">Una función del administrador de gráficos de filtros es sincronizar todos los filtros del gráfico con el mismo reloj, denominado el *reloj de referencia*.</span><span class="sxs-lookup"><span data-stu-id="0d14d-104">One function of the Filter Graph Manager is to synchronize all of the filters in the graph to the same clock, called the *reference clock*.</span></span>

<span data-ttu-id="0d14d-105">Cualquier objeto que exponga la interfaz [**IReferenceClock**](/windows/desktop/api/Strmif/nn-strmif-ireferenceclock) puede actuar como el reloj de referencia.</span><span class="sxs-lookup"><span data-stu-id="0d14d-105">Any object that exposes the [**IReferenceClock**](/windows/desktop/api/Strmif/nn-strmif-ireferenceclock) interface can act as the reference clock.</span></span> <span data-ttu-id="0d14d-106">El reloj de referencia puede proporcionarse mediante un filtro de DirectShow, normalmente el representador de audio, que tiene acceso a un temporizador de hardware.</span><span class="sxs-lookup"><span data-stu-id="0d14d-106">The reference clock might be provided by a DirectShow filter—typically the audio renderer, which has access to a hardware timer.</span></span> <span data-ttu-id="0d14d-107">Como reserva, el administrador de gráficos de filtro puede usar la hora del sistema.</span><span class="sxs-lookup"><span data-stu-id="0d14d-107">As a fallback, the Filter Graph Manager can use the system time.</span></span>

<span data-ttu-id="0d14d-108">Nominalmente, un reloj de referencia mide el tiempo en intervalos de 100 segundos, aunque la precisión real del reloj puede ser menor.</span><span class="sxs-lookup"><span data-stu-id="0d14d-108">Nominally, a reference clock measures time in 100-nanosecond intervals, although the actual accuracy of the clock might be less.</span></span> <span data-ttu-id="0d14d-109">Para recuperar la hora actual del reloj, llame al método [**IReferenceClock:: getTime**](/windows/desktop/api/Strmif/nf-strmif-ireferenceclock-gettime) .</span><span class="sxs-lookup"><span data-stu-id="0d14d-109">To retrieve the clock's current time, call the [**IReferenceClock::GetTime**](/windows/desktop/api/Strmif/nf-strmif-ireferenceclock-gettime) method.</span></span> <span data-ttu-id="0d14d-110">La línea de base del reloj (el tiempo desde el que empieza el recuento) depende de la implementación, por lo que el valor devuelto por **getTime** no es inherentemente significativo.</span><span class="sxs-lookup"><span data-stu-id="0d14d-110">The clock's baseline—the time from which it starts counting—depends on the implementation, so the value returned by **GetTime** is not inherently meaningful.</span></span> <span data-ttu-id="0d14d-111">Lo que importa es la diferencia entre el momento en que el gráfico empezó a ejecutarse.</span><span class="sxs-lookup"><span data-stu-id="0d14d-111">What matters is the delta from when the graph started running.</span></span>

<span data-ttu-id="0d14d-112">Aunque la precisión de un reloj de referencia puede variar, se garantiza que las horas devueltas por el método [**getTime**](/windows/desktop/api/Strmif/nf-strmif-ireferenceclock-gettime) aumenten de forma continuada.</span><span class="sxs-lookup"><span data-stu-id="0d14d-112">Although the accuracy of a reference clock can vary, the times returned by the [**GetTime**](/windows/desktop/api/Strmif/nf-strmif-ireferenceclock-gettime) method are guaranteed to increase monotonically.</span></span> <span data-ttu-id="0d14d-113">En otras palabras, las horas de reloj nunca se retroceden.</span><span class="sxs-lookup"><span data-stu-id="0d14d-113">In other words, clock times will never go backward.</span></span> <span data-ttu-id="0d14d-114">Si un reloj de referencia está generando horas de reloj desde un origen de hardware y el reloj de hardware salta hacia atrás (por ejemplo, si hay un ajuste en el reloj), el método **getTime** debe continuar devolviendo la última hora detectada hasta que el reloj de hardware se ponga al día.</span><span class="sxs-lookup"><span data-stu-id="0d14d-114">If a reference clock is generating clock times from a hardware source and the hardware clock jumps backward (for example, if there is an adjustment to the clock), the **GetTime** method should continue to return the last reported time until the hardware clock catches up.</span></span> <span data-ttu-id="0d14d-115">Para obtener más información, consulte [**clase CBaseReferenceClock**](cbasereferenceclock.md).</span><span class="sxs-lookup"><span data-stu-id="0d14d-115">For more information, see [**CBaseReferenceClock Class**](cbasereferenceclock.md).</span></span>

<span data-ttu-id="0d14d-116">**Reloj de referencia predeterminado**</span><span class="sxs-lookup"><span data-stu-id="0d14d-116">**Default Reference Clock**</span></span>

<span data-ttu-id="0d14d-117">Filter Graph Manager selecciona automáticamente un reloj de referencia cuando se ejecuta el gráfico.</span><span class="sxs-lookup"><span data-stu-id="0d14d-117">The Filter Graph Manager automatically selects a reference clock when the graph runs.</span></span> <span data-ttu-id="0d14d-118">Usa el siguiente algoritmo para seleccionar el reloj:</span><span class="sxs-lookup"><span data-stu-id="0d14d-118">It uses the following algorithm to select the clock:</span></span>

-   <span data-ttu-id="0d14d-119">Si la aplicación ha seleccionado un reloj (vea más abajo), use ese reloj.</span><span class="sxs-lookup"><span data-stu-id="0d14d-119">If the application has selected a clock (see below), use that clock.</span></span>
-   <span data-ttu-id="0d14d-120">Si el gráfico contiene un filtro de origen activo que admite [**IReferenceClock**](/windows/desktop/api/Strmif/nn-strmif-ireferenceclock), use ese filtro.</span><span class="sxs-lookup"><span data-stu-id="0d14d-120">If the graph contains a live source filter that supports [**IReferenceClock**](/windows/desktop/api/Strmif/nn-strmif-ireferenceclock), use that filter.</span></span> <span data-ttu-id="0d14d-121">Para ver la definición de un origen en directo, vea [orígenes en directo](live-sources.md).</span><span class="sxs-lookup"><span data-stu-id="0d14d-121">For the definition of a live source, see [Live Sources](live-sources.md).</span></span>
-   <span data-ttu-id="0d14d-122">Si el gráfico no contiene ningún filtro de código fuente activo, use cualquier filtro del gráfico que admita [**IReferenceClock**](/windows/desktop/api/Strmif/nn-strmif-ireferenceclock), empezando por los representadores y el flujo de trabajo ascendente.</span><span class="sxs-lookup"><span data-stu-id="0d14d-122">If the graph does NOT contain any live source filters, use any filter in the graph that supports [**IReferenceClock**](/windows/desktop/api/Strmif/nn-strmif-ireferenceclock), starting from the renderers and working upstream.</span></span> <span data-ttu-id="0d14d-123">Prefiere filtros conectados a través de filtros no conectados.</span><span class="sxs-lookup"><span data-stu-id="0d14d-123">Prefer connected filters over unconnected filters.</span></span> <span data-ttu-id="0d14d-124">(Si el gráfico representa una secuencia de audio, este paso del algoritmo normalmente seleccionará el filtro de representador de audio).</span><span class="sxs-lookup"><span data-stu-id="0d14d-124">(If the graph is rendering an audio stream, this step in the algorithm will normally select the audio renderer filter.)</span></span>
-   <span data-ttu-id="0d14d-125">Si ningún filtro proporciona un reloj adecuado, use el [reloj de referencia del sistema](system-reference-clock.md), que se basa en la hora del sistema.</span><span class="sxs-lookup"><span data-stu-id="0d14d-125">If no filter provides a suitable clock, use the [System Reference Clock](system-reference-clock.md), which is based on the system time.</span></span>

<span data-ttu-id="0d14d-126">**Establecer el reloj de referencia**</span><span class="sxs-lookup"><span data-stu-id="0d14d-126">**Setting the Reference Clock**</span></span>

<span data-ttu-id="0d14d-127">Una aplicación puede seleccionar un reloj llamando al método [**IMediaFilter:: SetSyncSource**](/windows/desktop/api/Strmif/nf-strmif-imediafilter-setsyncsource) en el administrador de gráficos de filtro.</span><span class="sxs-lookup"><span data-stu-id="0d14d-127">An application can select a clock by calling the [**IMediaFilter::SetSyncSource**](/windows/desktop/api/Strmif/nf-strmif-imediafilter-setsyncsource) method on the Filter Graph Manager.</span></span> <span data-ttu-id="0d14d-128">Solo debe hacerlo si tiene una razón determinada para preferir otro reloj.</span><span class="sxs-lookup"><span data-stu-id="0d14d-128">You should do this only if you have a particular reason to prefer another clock.</span></span>

<span data-ttu-id="0d14d-129">Puede indicar al administrador de gráficos de filtro que no use un reloj de referencia mediante una llamada a [**SetSyncSource**](/windows/desktop/api/Strmif/nf-strmif-imediafilter-setsyncsource) con el valor **null**.</span><span class="sxs-lookup"><span data-stu-id="0d14d-129">You can instruct the Filter Graph Manager not to use a reference clock by calling [**SetSyncSource**](/windows/desktop/api/Strmif/nf-strmif-imediafilter-setsyncsource) with the value **NULL**.</span></span> <span data-ttu-id="0d14d-130">Por ejemplo, podría hacer esto para procesar los ejemplos lo más rápido posible.</span><span class="sxs-lookup"><span data-stu-id="0d14d-130">For example, you might do this to process samples as quickly as possible.</span></span> <span data-ttu-id="0d14d-131">Para restaurar el reloj de referencia predeterminado, llame al método [**IFilterGraph:: SetDefaultSyncSource**](/windows/desktop/api/Strmif/nf-strmif-ifiltergraph-setdefaultsyncsource) en el administrador de gráficos de filtro.</span><span class="sxs-lookup"><span data-stu-id="0d14d-131">To restore the default reference clock, call the [**IFilterGraph::SetDefaultSyncSource**](/windows/desktop/api/Strmif/nf-strmif-ifiltergraph-setdefaultsyncsource) method on the Filter Graph Manager.</span></span>

<span data-ttu-id="0d14d-132">Cada vez que cambia el reloj de referencia, el administrador de gráficos de filtro notifica a cada filtro mediante una llamada a su método [**IMediaFilter:: SetSyncSource**](/windows/desktop/api/Strmif/nf-strmif-imediafilter-setsyncsource) .</span><span class="sxs-lookup"><span data-stu-id="0d14d-132">Whenever the reference clock changes, the Filter Graph Manager notifies each filter by calling its [**IMediaFilter::SetSyncSource**](/windows/desktop/api/Strmif/nf-strmif-imediafilter-setsyncsource) method.</span></span> <span data-ttu-id="0d14d-133">Las aplicaciones nunca deben llamar a este método en los filtros.</span><span class="sxs-lookup"><span data-stu-id="0d14d-133">Applications should never call this method on filters.</span></span>

## <a name="related-topics"></a><span data-ttu-id="0d14d-134">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="0d14d-134">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="0d14d-135">Establecer el reloj del gráfico</span><span class="sxs-lookup"><span data-stu-id="0d14d-135">Setting the Graph Clock</span></span>](setting-the-graph-clock.md)
</dt> <dt>

[<span data-ttu-id="0d14d-136">Hora y relojes en DirectShow</span><span class="sxs-lookup"><span data-stu-id="0d14d-136">Time and Clocks in DirectShow</span></span>](time-and-clocks-in-directshow.md)
</dt> </dl>

 

 



