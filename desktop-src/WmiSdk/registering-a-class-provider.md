---
description: Para crear un proveedor de clase WMI, debe registrar la \_ \_ instancia de Win32Provider que representa el proveedor mediante una instancia de \_ \_ ClassProviderRegistration.
ms.assetid: ed834969-47e9-47df-9db8-c805b2eb71da
ms.tgt_platform: multiple
title: Registrar un proveedor de clases
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7bc15893e654f96f8c4e476219389a1f8f2c464a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104001545"
---
# <a name="registering-a-class-provider"></a><span data-ttu-id="add9e-103">Registrar un proveedor de clases</span><span class="sxs-lookup"><span data-stu-id="add9e-103">Registering a Class Provider</span></span>

<span data-ttu-id="add9e-104">Para crear un proveedor de clase WMI, debe registrar la instancia de [**\_ \_ Win32Provider**](--win32provider.md) que representa el proveedor mediante una instancia de [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md).</span><span class="sxs-lookup"><span data-stu-id="add9e-104">To create a WMI class provider you must register the [**\_\_Win32Provider**](--win32provider.md) instance that represents your provider using an instance of [**\_\_ClassProviderRegistration**](--classproviderregistration.md).</span></span> <span data-ttu-id="add9e-105">Como objeto COM, el proveedor debe registrarse en el sistema operativo y en WMI.</span><span class="sxs-lookup"><span data-stu-id="add9e-105">As a COM object, your provider must register with the operating system and WMI.</span></span> <span data-ttu-id="add9e-106">En el procedimiento siguiente se supone que ya ha implementado el proceso de registro como se describe en [registrar un proveedor](registering-a-provider.md).</span><span class="sxs-lookup"><span data-stu-id="add9e-106">The following procedure assumes that you have already implemented the registration process as described in [Registering a Provider](registering-a-provider.md).</span></span> <span data-ttu-id="add9e-107">Si el proveedor almacena la mayoría de los datos en el repositorio WMI y los datos se actualizan solo en la inicialización de WMI, registre la clase como un proveedor de clase de inserciones.</span><span class="sxs-lookup"><span data-stu-id="add9e-107">If your provider stores most data in the WMI repository and that data is updated only on WMI initialization, then register your class as a push class provider.</span></span> <span data-ttu-id="add9e-108">Si los datos que va a proporcionar cambian con frecuencia y el código lo recupera dinámicamente en cada solicitud de WMI, registre el proveedor como un proveedor de clase de extracción.</span><span class="sxs-lookup"><span data-stu-id="add9e-108">If the data you are providing changes frequently and is retrieved dynamically by your code on every request from WMI, then register your provider as a pull class provider.</span></span>

<span data-ttu-id="add9e-109">En el procedimiento siguiente se describe cómo registrar un proveedor de clase de inserciones.</span><span class="sxs-lookup"><span data-stu-id="add9e-109">The following procedure describes how to register a push class provider.</span></span>

<span data-ttu-id="add9e-110">**Para registrar un proveedor de clase de inserciones**</span><span class="sxs-lookup"><span data-stu-id="add9e-110">**To register a push class provider**</span></span>

-   <span data-ttu-id="add9e-111">Establezca la propiedad **InteractionType** de la instancia de [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md) en 1.</span><span class="sxs-lookup"><span data-stu-id="add9e-111">Set the **InteractionType** property of the [**\_\_ClassProviderRegistration**](--classproviderregistration.md) instance to 1.</span></span>

    <span data-ttu-id="add9e-112">La creación de una instancia de [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md) forma parte del proceso de registro.</span><span class="sxs-lookup"><span data-stu-id="add9e-112">Creating an instance of [**\_\_ClassProviderRegistration**](--classproviderregistration.md) is part of the registration process.</span></span>

<span data-ttu-id="add9e-113">En el procedimiento siguiente se describe cómo registrar un proveedor de clase de extracción.</span><span class="sxs-lookup"><span data-stu-id="add9e-113">The following procedure describes how to register a pull class provider.</span></span>

<span data-ttu-id="add9e-114">**Para registrar un proveedor de clase de extracción**</span><span class="sxs-lookup"><span data-stu-id="add9e-114">**To register a pull class provider**</span></span>

1.  <span data-ttu-id="add9e-115">Cree una instancia de la clase [**\_ \_ Win32Provider**](--win32provider.md) que describa el proveedor.</span><span class="sxs-lookup"><span data-stu-id="add9e-115">Create an instance of the [**\_\_Win32Provider**](--win32provider.md) class that describes the provider.</span></span>
2.  <span data-ttu-id="add9e-116">Cree una instancia de la clase [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md) que describa el conjunto de características del proveedor.</span><span class="sxs-lookup"><span data-stu-id="add9e-116">Create an instance of the [**\_\_ClassProviderRegistration**](--classproviderregistration.md) class that describes the feature set of the provider.</span></span>

    <span data-ttu-id="add9e-117">Dentro de la instancia de [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md) :</span><span class="sxs-lookup"><span data-stu-id="add9e-117">Within the [**\_\_ClassProviderRegistration**](--classproviderregistration.md) instance:</span></span>

    1.  <span data-ttu-id="add9e-118">Establezca la propiedad **InteractionType** para indicar si el proveedor es un proveedor de inserción o de extracción.</span><span class="sxs-lookup"><span data-stu-id="add9e-118">Set the **InteractionType** property to indicate whether the provider is a push or pull provider.</span></span>
    2.  <span data-ttu-id="add9e-119">Etiquete la clase con los calificadores de [**proveedor**](/windows/desktop/api/Provider/nl-provider-provider) y [**dinámicos**](standard-wmi-qualifiers.md) .</span><span class="sxs-lookup"><span data-stu-id="add9e-119">Tag the class with both the [**Dynamic**](standard-wmi-qualifiers.md) and [**Provider**](/windows/desktop/api/Provider/nl-provider-provider) qualifiers.</span></span>

        <span data-ttu-id="add9e-120">El calificador [**dinámico**](standard-wmi-qualifiers.md) indica que WMI debe utilizar un proveedor para recuperar las instancias de clase.</span><span class="sxs-lookup"><span data-stu-id="add9e-120">The [**Dynamic**](standard-wmi-qualifiers.md) qualifier signals that WMI should use a provider to retrieve the class instances.</span></span> <span data-ttu-id="add9e-121">El calificador de [**proveedor**](/windows/desktop/api/Provider/nl-provider-provider) especifica el nombre del proveedor que debe usar WMI.</span><span class="sxs-lookup"><span data-stu-id="add9e-121">The [**Provider**](/windows/desktop/api/Provider/nl-provider-provider) qualifier specifies the name of the provider that WMI should use.</span></span>

    3.  <span data-ttu-id="add9e-122">Defina las propiedades **ResultSetQueries**, **ReferencedSetQueries** y **UnsupportedQueries** .</span><span class="sxs-lookup"><span data-stu-id="add9e-122">Define the **ResultSetQueries**, **ReferencedSetQueries**, and **UnsupportedQueries** properties.</span></span>

        <span data-ttu-id="add9e-123">Estas propiedades de consulta describen información detallada sobre la clase admitida.</span><span class="sxs-lookup"><span data-stu-id="add9e-123">These query properties describe detailed information about the supported class.</span></span>

<span data-ttu-id="add9e-124">Además de describir los distintos métodos admitidos de una clase, la clase [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md) también tiene tres propiedades que describen una serie de consultas.</span><span class="sxs-lookup"><span data-stu-id="add9e-124">In addition to describing the various supported methods of a class, the [**\_\_ClassProviderRegistration**](--classproviderregistration.md) class also has three properties that describe a series of queries.</span></span> <span data-ttu-id="add9e-125">Cuando se usan juntas, estas tres propiedades describen el intervalo completo de clases proporcionadas por el proveedor de clases.</span><span class="sxs-lookup"><span data-stu-id="add9e-125">When used together, these three properties describe the entire range of classes supplied by the class provider.</span></span> <span data-ttu-id="add9e-126">Cada propiedad de consulta contiene una instrucción SELECT de WQL, denominada "consulta de esquema", para especificar los tipos de clases admitidas.</span><span class="sxs-lookup"><span data-stu-id="add9e-126">Each query property contains a WQL SELECT statement, called a "schema query," to specify the types of supported classes.</span></span> <span data-ttu-id="add9e-127">Las consultas de esquema especifican un nombre de clase especial denominado meta \_ Class.</span><span class="sxs-lookup"><span data-stu-id="add9e-127">Schema queries specify a special class name called meta\_class.</span></span> <span data-ttu-id="add9e-128">En la tabla siguiente se enumeran las propiedades de la consulta.</span><span class="sxs-lookup"><span data-stu-id="add9e-128">The following table lists the query properties.</span></span>



| <span data-ttu-id="add9e-129">Propiedad</span><span class="sxs-lookup"><span data-stu-id="add9e-129">Property</span></span>                 | <span data-ttu-id="add9e-130">Descripción</span><span class="sxs-lookup"><span data-stu-id="add9e-130">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|--------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="add9e-131">**ResultSetQueries**</span><span class="sxs-lookup"><span data-stu-id="add9e-131">**ResultSetQueries**</span></span>     | <span data-ttu-id="add9e-132">Contiene información sobre el conjunto de resultados que proporciona el proveedor.</span><span class="sxs-lookup"><span data-stu-id="add9e-132">Contains information about the result set the provider supplies.</span></span> <span data-ttu-id="add9e-133">WMI utiliza la información para determinar si se debe invocar al proveedor para satisfacer una consulta de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="add9e-133">WMI uses the information to determine whether to invoke the provider to satisfy a query from an application.</span></span> <span data-ttu-id="add9e-134">Esta propiedad describe el conjunto de todas las clases que el proveedor puede proporcionar o un supraconjunto de las clases disponibles, pero nunca un subconjunto.</span><span class="sxs-lookup"><span data-stu-id="add9e-134">This property describes either the set of all classes that the provider can supply or a superset of the available classes, but never a subset.</span></span> <span data-ttu-id="add9e-135">WMI requiere que un proveedor especifique al menos una consulta en esta propiedad.</span><span class="sxs-lookup"><span data-stu-id="add9e-135">WMI requires a provider to specify at least one query in this property.</span></span><br/> <span data-ttu-id="add9e-136">En el ejemplo siguiente se muestra cómo establecer **ResultSetQueries** cuando un proveedor proporciona una clase de asociación que hace referencia a la clase [**Win32 \_ LogicalDisk**](/windows/desktop/CIMWin32Prov/win32-logicaldisk) .</span><span class="sxs-lookup"><span data-stu-id="add9e-136">The following example shows how to set **ResultSetQueries** when a provider supplies an association class that references the [**Win32\_LogicalDisk**](/windows/desktop/CIMWin32Prov/win32-logicaldisk) class.</span></span><br/> `SELECT * FROM meta_class WHERE __Class = "Win32_LogicalDisk"`<br/> <span data-ttu-id="add9e-137">En el ejemplo siguiente se muestra cómo especificar una consulta general cuando un proveedor suministra clases que hacen referencia a otras clases desconocidas.</span><span class="sxs-lookup"><span data-stu-id="add9e-137">The following example shows how to specify a general query when a provider supplies classes that reference other unknown classes.</span></span><br/> `SELECT * FROM meta_class`<br/> <span data-ttu-id="add9e-138">En el ejemplo siguiente se muestra cómo establecer **ResultSetQueries** cuando un proveedor solo suministra subclases, pero no la clase primaria de una clase determinada.</span><span class="sxs-lookup"><span data-stu-id="add9e-138">The following example shows how to set **ResultSetQueries** when a provider supplies only subclasses, but not the parent class of a given class.</span></span><br/> `SELECT * FROM meta_class WHERE __Dynasty = "MyClass"`<br/> <span data-ttu-id="add9e-139">En el ejemplo siguiente se muestra cómo usar la \_ \_ propiedad especial this y establecer **ResultSetQueries** cuando un proveedor proporciona todas las clases y subclases.</span><span class="sxs-lookup"><span data-stu-id="add9e-139">The following example shows how to use the special \_\_this property and set **ResultSetQueries** when a provider supplies all class and subclasses.</span></span><br/> `SELECT * FROM meta_class WHERE __this ISA "MyClass"`<br/> |
| <span data-ttu-id="add9e-140">**ReferencedSetQueries**</span><span class="sxs-lookup"><span data-stu-id="add9e-140">**ReferencedSetQueries**</span></span> | <span data-ttu-id="add9e-141">Determina si se omitirá el proveedor en las consultas de esquema en las que se solicitan las asociaciones y referencias.</span><span class="sxs-lookup"><span data-stu-id="add9e-141">Determines whether to bypass the provider in schema queries where associations and references are being requested.</span></span> <span data-ttu-id="add9e-142">Los proveedores que pueden proporcionar clases de asociación deben incluir al menos una consulta en su propiedad **ReferencedSetQueries** .</span><span class="sxs-lookup"><span data-stu-id="add9e-142">Providers that can supply association classes must include at least one query in their **ReferencedSetQueries** property.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="add9e-143">**UnsupportedQueries**</span><span class="sxs-lookup"><span data-stu-id="add9e-143">**UnsupportedQueries**</span></span>   | <span data-ttu-id="add9e-144">Contiene información sobre el conjunto de resultados que no proporciona un proveedor de clases.</span><span class="sxs-lookup"><span data-stu-id="add9e-144">Contains information about the result set that a class provider does not supply.</span></span> <span data-ttu-id="add9e-145">WMI usa esta propiedad para restar del conjunto de clases implícitas por **ResultSetQueries**.</span><span class="sxs-lookup"><span data-stu-id="add9e-145">WMI uses this property to subtract from the set of classes implied by **ResultSetQueries**.</span></span> <span data-ttu-id="add9e-146">Por ejemplo, un proveedor de clase puede especificar en la compatibilidad con **ResultSetQueries** para todas las clases derivadas de MyClass y especificar en **UnsupportedQueries** una falta de compatibilidad con una clase derivada determinada.</span><span class="sxs-lookup"><span data-stu-id="add9e-146">For example, a class provider can specify in **ResultSetQueries** support for all classes derived from MyClass and specify in **UnsupportedQueries** a lack of support for one particular derived class.</span></span><br/> <span data-ttu-id="add9e-147">Cuanto más información pueda registrar un proveedor sobre sus capacidades de procesamiento de consultas, más rápido se ejecutará.</span><span class="sxs-lookup"><span data-stu-id="add9e-147">The more information that a provider can register about its query processing capabilities, the faster it runs.</span></span> <span data-ttu-id="add9e-148">Escribir una o más consultas en la propiedad **UnsupportedQueries** es una forma de ser específica y es especialmente importante cuando un proveedor se basa en una clase que no proporciona.</span><span class="sxs-lookup"><span data-stu-id="add9e-148">Entering one or more queries in the **UnsupportedQueries** property is one way to be specific and is particularly important when a provider relies on a class that it does not supply.</span></span> <span data-ttu-id="add9e-149">Cuando se realiza una solicitud de una clase que aparece en una consulta en la propiedad **UnsupportedQueries** , WMI puede proporcionar la propia clase o invocar a un proveedor alternativo para proporcionarla.</span><span class="sxs-lookup"><span data-stu-id="add9e-149">When a request is made for a class that is listed in a query in the **UnsupportedQueries** property, WMI can supply the class itself or invoke an alternate provider to supply it.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                             |



 

<span data-ttu-id="add9e-150">Dado que WMI no admite la cláusula OR, debe crear una consulta independiente para cada clase.</span><span class="sxs-lookup"><span data-stu-id="add9e-150">Because WMI does not support the OR clause, you must create a separate query for each class.</span></span>

<span data-ttu-id="add9e-151">Las siguientes consultas se especifican en **ResultSetQueries** cuando un proveedor de clases proporciona myclass1, MyClass2 y MyClass3.</span><span class="sxs-lookup"><span data-stu-id="add9e-151">The following queries are specified in **ResultSetQueries** when a class provider supplies MyClass1, MyClass2, and MyClass3.</span></span>


```sql
SELECT * FROM meta_class WHERE __Class = "MyClass1"
SELECT * FROM meta_class WHERE __Class = "MyClass2"
SELECT * FROM meta_class WHERE __Class = "MyClass3"
```



<span data-ttu-id="add9e-152">Solo los administradores pueden registrar o eliminar un proveedor mediante la creación de una instancia de [**\_ \_ Win32Provider**](--win32provider.md) y [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md).</span><span class="sxs-lookup"><span data-stu-id="add9e-152">Only administrators can register or delete a provider by creating an instance of [**\_\_Win32Provider**](--win32provider.md) and [**\_\_ClassProviderRegistration**](--classproviderregistration.md).</span></span>

 

