---
description: Una valiosa característica de telefonía es el pequeño conjunto de funciones llamadas telefonía asistida.
ms.assetid: 1c41f52b-f8bf-410e-a966-9323a690a4d5
title: Información general sobre telefonía asistida
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7b6a8826fd0c273936204d9250fb91504333d807
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "104002323"
---
# <a name="assisted-telephony-overview"></a><span data-ttu-id="939cc-103">Información general sobre telefonía asistida</span><span class="sxs-lookup"><span data-stu-id="939cc-103">Assisted Telephony Overview</span></span>

<span data-ttu-id="939cc-104">Una valiosa característica de telefonía es el pequeño conjunto de funciones llamadas telefonía asistida.</span><span class="sxs-lookup"><span data-stu-id="939cc-104">A valuable feature of telephony is the small set of functions called Assisted Telephony.</span></span> <span data-ttu-id="939cc-105">La telefonía asistida está diseñada para que el establecimiento de llamadas de voz y de llamadas multimedia esté disponible para cualquier aplicación, no solo las dedicadas a la funcionalidad de telefonía.</span><span class="sxs-lookup"><span data-stu-id="939cc-105">Assisted Telephony is designed to make the establishment of voice calls and of media calls available to any application, not just those dedicated to telephonic functionality.</span></span> <span data-ttu-id="939cc-106">En otras palabras, la telefonía asistida permite a las aplicaciones realizar llamadas telefónicas sin necesidad de conocer los detalles de los servicios de la API de telefonía completa.</span><span class="sxs-lookup"><span data-stu-id="939cc-106">In other words, Assisted Telephony lets applications make telephone calls without needing to be aware of the details of the services of the full Telephony API.</span></span> <span data-ttu-id="939cc-107">Extiende la telefonía a aplicaciones de procesamiento de texto, hojas de cálculo, bases de datos, administradores de información personal y otras aplicaciones que no son de telefonía.</span><span class="sxs-lookup"><span data-stu-id="939cc-107">It extends telephony to word-processing applications, spreadsheets, databases, personal information managers, and other non-telephony applications.</span></span>

<span data-ttu-id="939cc-108">Para obtener una lista de las funciones de telefonía básicas de la telefonía básica de TAPI 2. x, consulte [referencia rápida](./tapi-quick-function-reference.md)de funciones de TAPI.</span><span class="sxs-lookup"><span data-stu-id="939cc-108">For a list of TAPI 2.x Assisted Telephony functions of Basic Telephony, see [TAPI Quick Function Reference](./tapi-quick-function-reference.md).</span></span> <span data-ttu-id="939cc-109">TAPI 3. x admite la telefonía asistida a través de la interfaz [**ITRequest**](/windows/desktop/api/tapi3if/nn-tapi3if-itrequest) .</span><span class="sxs-lookup"><span data-stu-id="939cc-109">TAPI 3.x supports assisted telephony through the [**ITRequest**](/windows/desktop/api/tapi3if/nn-tapi3if-itrequest) interface.</span></span>

<span data-ttu-id="939cc-110">La utilidad de la telefonía asistida se puede ilustrar en el ejemplo siguiente.</span><span class="sxs-lookup"><span data-stu-id="939cc-110">The usefulness of Assisted Telephony can be illustrated by the following example.</span></span> <span data-ttu-id="939cc-111">Una aplicación de hoja de cálculo puede incorporar funciones que marcan un número de teléfono para una llamada de voz.</span><span class="sxs-lookup"><span data-stu-id="939cc-111">A spreadsheet application can incorporate functions that dial a telephone number for a speech call.</span></span> <span data-ttu-id="939cc-112">Siempre que la aplicación no necesite el control de llamadas detallado proporcionado por la API de telefonía completa, la telefonía asistida es la forma más sencilla y eficaz de proporcionarle funcionalidad de telefonía.</span><span class="sxs-lookup"><span data-stu-id="939cc-112">As long as the application needs none of the detailed call control provided by the full Telephony API, Assisted Telephony is the easiest and most efficient way to give it telephonic functionality.</span></span>

![telefonía asistida con una aplicación de hoja de cálculo](images/assist4.png)

<span data-ttu-id="939cc-114">La telefonía asistida y la API de telefonía completa se usan e implementan de maneras diferentes, por lo que no se recomienda mezclar llamadas a funciones de telefonía asistida y llamadas a funciones de API de telefonía en una sola aplicación.</span><span class="sxs-lookup"><span data-stu-id="939cc-114">Assisted Telephony and the full Telephony API are used and implemented in different ways, so it is not advised to mix Assisted Telephony function calls and Telephony API function calls within a single application.</span></span>

## <a name="using-assisted-telephony"></a><span data-ttu-id="939cc-115">Usar telefonía asistida</span><span class="sxs-lookup"><span data-stu-id="939cc-115">Using Assisted Telephony</span></span>

<span data-ttu-id="939cc-116">Las aplicaciones que utilizan servicios de telefonía asistidos solo inician solicitudes de llamadas que TAPI pone en cola temporalmente.</span><span class="sxs-lookup"><span data-stu-id="939cc-116">Applications that use Assisted Telephony services only initiate call requests that are temporarily queued by TAPI.</span></span> <span data-ttu-id="939cc-117">La aplicación de destinatario de la solicitud recupera estas solicitudes y las ejecuta en nombre de la aplicación de telefonía asistida.</span><span class="sxs-lookup"><span data-stu-id="939cc-117">The request recipient application retrieves these requests and executes them on behalf of the Assisted Telephony application.</span></span> <span data-ttu-id="939cc-118">La función [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall) solicita el establecimiento de una llamada de voz.</span><span class="sxs-lookup"><span data-stu-id="939cc-118">The [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall) function requests the establishment of a voice call.</span></span> <span data-ttu-id="939cc-119">La aplicación que realiza la solicitud no controla la llamada.</span><span class="sxs-lookup"><span data-stu-id="939cc-119">The requesting application does not control the call.</span></span>

<span data-ttu-id="939cc-120">TAPI permite al usuario establecer distintas aplicaciones del destinatario de la solicitud para cada uno de estos servicios.</span><span class="sxs-lookup"><span data-stu-id="939cc-120">TAPI allows the user to establish different or the same request recipient applications for each of these services.</span></span> <span data-ttu-id="939cc-121">Una aplicación se convierte en un destinatario de la solicitud mediante el registro con [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient), en el que **true** se especifica como el valor del parámetro *bEnable*.</span><span class="sxs-lookup"><span data-stu-id="939cc-121">An application becomes a request recipient by registering with [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient), in which **TRUE** is specified as the value for the parameter *bEnable*.</span></span> <span data-ttu-id="939cc-122">(Si se especifica **false** , se anula el registro de la aplicación como un destinatario de la solicitud, lo que debe hacer cuando se ha determinado que sus deberes de destinatario están a través de para la sesión actual). La aplicación selecciona los servicios que desea administrar en el parámetro *dwRequestMode* de **lineRegisterRequestRecipient**.</span><span class="sxs-lookup"><span data-stu-id="939cc-122">(Specifying **FALSE** deregisters the application as a request recipient, which it should do when it has determined that its recipient duties are through for the current session.) The application selects the services it wants to handle in the *dwRequestMode* parameter of **lineRegisterRequestRecipient**.</span></span> <span data-ttu-id="939cc-123">Un valor posible para una solicitud es LINEREQUESTMODE \_ MAKECALL para mostrar que la aplicación controlará las solicitudes [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall) .</span><span class="sxs-lookup"><span data-stu-id="939cc-123">A possible value for a request is LINEREQUESTMODE\_MAKECALL, to show that the application will handle [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall) requests.</span></span> <span data-ttu-id="939cc-124">Si varias aplicaciones se registran para los mismos servicios, se usa un esquema de prioridad para permitir al usuario seleccionar qué aplicación es la preferida para controlar las solicitudes.</span><span class="sxs-lookup"><span data-stu-id="939cc-124">If multiple applications register for the same services, a priority scheme is used to allow the user to select which application is preferred for handling requests.</span></span> <span data-ttu-id="939cc-125">Este esquema de prioridad es idéntico al que se usa para la entrega de llamadas y el enrutamiento de llamadas entrantes en función de una lista de nombres de archivo en **HandoffPriorities** en el registro.</span><span class="sxs-lookup"><span data-stu-id="939cc-125">This priority scheme is identical to that used for call handoff and the routing of incoming calls based on a list of file names in **HandoffPriorities** in the registry.</span></span>

## <a name="call-requests"></a><span data-ttu-id="939cc-126">Solicitudes de llamadas</span><span class="sxs-lookup"><span data-stu-id="939cc-126">Call Requests</span></span>

<span data-ttu-id="939cc-127">La telefonía asistida proporciona aplicaciones habilitadas para telefonía con un mecanismo fácil de usar para realizar llamadas telefónicas sin necesidad de que el desarrollador se convierta completamente en una telefonía.</span><span class="sxs-lookup"><span data-stu-id="939cc-127">Assisted Telephony provides telephony-enabled applications with an easy-to-use mechanism for making phone calls without requiring the developer to become fully literate in telephony.</span></span>

<span data-ttu-id="939cc-128">La función [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall) solicita una llamada de voz entre el usuario y una parte remota especificada por su número de teléfono.</span><span class="sxs-lookup"><span data-stu-id="939cc-128">The [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall) function requests a voice call between the user and a remote party specified by its phone number.</span></span> <span data-ttu-id="939cc-129">La solicitud se realiza a TAPI, que la pasa a una aplicación registrada como destinatario de dichas solicitudes.</span><span class="sxs-lookup"><span data-stu-id="939cc-129">The request is made to TAPI, which passes it to an application that is registered as a recipient of such requests.</span></span> <span data-ttu-id="939cc-130">Este destinatario es una aplicación de administrador de llamadas.</span><span class="sxs-lookup"><span data-stu-id="939cc-130">This recipient is a call manager application.</span></span>

<span data-ttu-id="939cc-131">Una vez que la aplicación ha realizado la solicitud, la llamada se controla completamente desde la aplicación del administrador de llamadas, porque las aplicaciones de telefonía asistidas no pueden administrar las llamadas.</span><span class="sxs-lookup"><span data-stu-id="939cc-131">After the application has made the request, the call is controlled entirely from the call manager application because Assisted Telephony applications cannot manage calls.</span></span> <span data-ttu-id="939cc-132">Dado que la aplicación del administrador de llamadas controla los aspectos más complejos de la telefonía y todas las operaciones de la interfaz de usuario, las aplicaciones habilitadas para telefonía no deben modificarse de ninguna manera sustancial.</span><span class="sxs-lookup"><span data-stu-id="939cc-132">Because the more complex aspects of telephony and all user-interface operations are handled by the call manager application, telephony-enabled applications need not be modified in any substantial way.</span></span> <span data-ttu-id="939cc-133">De hecho, es posible que las aplicaciones que permiten invocar esta operación desde su lenguaje de script integrado no tengan que modificarse en absoluto.</span><span class="sxs-lookup"><span data-stu-id="939cc-133">In fact, applications that allow this operation to be invoked from their built-in script language may not need to be modified at all.</span></span>

<span data-ttu-id="939cc-134">La función [**tapiGetLocationInfo**](/windows/win32/api/tapi/nf-tapi-tapigetlocationinfo) devuelve a la aplicación el código de país o región y el código de ciudad (área) que el usuario ha establecido en los parámetros de ubicación actuales en el panel de control de telefonía.</span><span class="sxs-lookup"><span data-stu-id="939cc-134">The [**tapiGetLocationInfo**](/windows/win32/api/tapi/nf-tapi-tapigetlocationinfo) function returns to the application the country or region code and city (area) code that the user has set in the current location parameters in the Telephony Control Panel.</span></span> <span data-ttu-id="939cc-135">La aplicación puede usar esta información para ayudar al usuario a formar números de teléfono canónicos correctos, por ejemplo, si los ofrece como valores predeterminados cuando se introducen nuevos números en una entrada de la libreta de teléfonos o en un registro de base de datos.</span><span class="sxs-lookup"><span data-stu-id="939cc-135">The application can use this information to assist the user in forming proper canonical telephone numbers, such as by offering these as defaults when new numbers are entered in a phone book entry or database record.</span></span>

## <a name="request-recipients"></a><span data-ttu-id="939cc-136">Solicitar destinatarios</span><span class="sxs-lookup"><span data-stu-id="939cc-136">Request Recipients</span></span>

<span data-ttu-id="939cc-137">Se necesitan dos tipos de aplicaciones para ejecutar la telefonía asistida.</span><span class="sxs-lookup"><span data-stu-id="939cc-137">Two kinds of applications are needed to run Assisted Telephony.</span></span> <span data-ttu-id="939cc-138">*Los clientes* de telefonía asistidos son aplicaciones que usan telefonía asistida llamando a las funciones que tienen el prefijo "TAPI".</span><span class="sxs-lookup"><span data-stu-id="939cc-138">Assisted Telephony *clients* are applications that use Assisted Telephony by calling the functions that have the prefix "tapi."</span></span> <span data-ttu-id="939cc-139">Un ejemplo de este tipo de aplicación cliente sería una hoja de cálculo a la que se agrega un comando de menú de **marcado** o un botón de barra de herramientas.</span><span class="sxs-lookup"><span data-stu-id="939cc-139">An example of such a client application would be a spreadsheet to which a **Dial** menu command or toolbar button is added.</span></span>

<span data-ttu-id="939cc-140">*Los servidores* de telefonía asistidos son aplicaciones que pueden ejecutar funciones de la API de telefonía que se derivan de la llamada de otra aplicación a una función con prefijo "TAPI".</span><span class="sxs-lookup"><span data-stu-id="939cc-140">Assisted Telephony *servers* are applications that can execute Telephony API functions that result from another application's call to a "tapi"-prefixed function.</span></span> <span data-ttu-id="939cc-141">Para que sea conocido como un servidor de telefonía asistido, una aplicación de este tipo se registra como una mediante la función [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient) .</span><span class="sxs-lookup"><span data-stu-id="939cc-141">To make itself known as an Assisted Telephony server, such an application registers as one using the [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient) function.</span></span>

<span data-ttu-id="939cc-142">Las funciones de telefonía asistida (que comienzan por el prefijo "TAPI") se conocen como *funciones de solicitud*.</span><span class="sxs-lookup"><span data-stu-id="939cc-142">The functions of Assisted Telephony (which begin with the prefix "tapi") are known as *request functions*.</span></span> <span data-ttu-id="939cc-143">Las aplicaciones de telefonía asistida que procesan estas solicitudes (servidores de telefonía asistidos) se denominan *destinatarios* de la solicitud.</span><span class="sxs-lookup"><span data-stu-id="939cc-143">Assisted Telephony applications that process these requests—Assisted Telephony servers—are called *request recipients*.</span></span>

## <a name="processing-assisted-telephony-requests"></a><span data-ttu-id="939cc-144">Procesamiento de solicitudes de telefonía asistida</span><span class="sxs-lookup"><span data-stu-id="939cc-144">Processing Assisted Telephony Requests</span></span>

<span data-ttu-id="939cc-145">El proceso con el que se entregan y se realizan los servicios de las solicitudes es el siguiente:</span><span class="sxs-lookup"><span data-stu-id="939cc-145">The process with which requests are delivered and serviced is as follows:</span></span>

1.  <span data-ttu-id="939cc-146">Cuando TAPI recibe una solicitud de telefonía asistida, busca un destinatario de la solicitud, es decir, una aplicación registrada actualmente para procesar ese tipo de solicitud.</span><span class="sxs-lookup"><span data-stu-id="939cc-146">When TAPI receives an Assisted Telephony request, it checks for a request recipient, that is, an application currently registered to process that type of request.</span></span> <span data-ttu-id="939cc-147">Si hay un destinatario de la solicitud, la solicitud se pone en cola y se envía un mensaje de [**\_ solicitud de línea**](./line-request.md) a la aplicación de prioridad más alta que se ha registrado para el servicio de esa solicitud.</span><span class="sxs-lookup"><span data-stu-id="939cc-147">If there is a request recipient, the request is queued, and the highest-priority application that has registered for that request's service is sent a [**LINE\_REQUEST**](./line-request.md) message.</span></span> <span data-ttu-id="939cc-148">El mensaje notifica al destinatario de la solicitud que ha llegado una solicitud nueva y lleva una indicación del modo de la solicitud.</span><span class="sxs-lookup"><span data-stu-id="939cc-148">The message notifies the request recipient that a new request has arrived, and it carries an indication of the request's mode.</span></span>
2.  <span data-ttu-id="939cc-149">Si TAPI no encuentra una aplicación actualmente en ejecución para procesar dicha solicitud, intenta iniciar una aplicación que se ha registrado como capaz de hacerlo.</span><span class="sxs-lookup"><span data-stu-id="939cc-149">If TAPI cannot find a currently running application to process such a request, it tries to launch an application that has been registered as capable of doing so.</span></span> <span data-ttu-id="939cc-150">Esta información de registro se registra en **HandoffPriorities** en el registro.</span><span class="sxs-lookup"><span data-stu-id="939cc-150">This registration information is recorded in **HandoffPriorities** in the registry.</span></span> <span data-ttu-id="939cc-151">TAPI intenta iniciar aplicaciones en el orden en el que aparecen en la sección **HandoffPriorities** .</span><span class="sxs-lookup"><span data-stu-id="939cc-151">TAPI tries to launch applications in the order in which they are listed in the **HandoffPriorities** section.</span></span> <span data-ttu-id="939cc-152">(Consulte el paso siguiente).</span><span class="sxs-lookup"><span data-stu-id="939cc-152">(See the following step.)</span></span>

    <span data-ttu-id="939cc-153">Si no hay ninguna aplicación registrada actualmente, TAPI examinará la lista de aplicaciones de procesamiento de solicitudes en la entrada asociada en **HandoffPriorities**.</span><span class="sxs-lookup"><span data-stu-id="939cc-153">If no application is currently registered, TAPI examines the list of request-processing applications on the associated entry in **HandoffPriorities**.</span></span> <span data-ttu-id="939cc-154">Si falta la línea asociada en el archivo, si no hay ninguna aplicación enumerada, o si no se puede iniciar ninguna de las aplicaciones de la lista, la solicitud se rechaza con el error TAPIERR \_ NOREQUESTRECIPIENT.</span><span class="sxs-lookup"><span data-stu-id="939cc-154">If the associated line is missing from the file, if there are no applications listed on it, or if none of the applications in the list can be launched, the request is rejected with the error TAPIERR\_NOREQUESTRECIPIENT.</span></span>

    <span data-ttu-id="939cc-155">Cuando se inicia un destinatario de la solicitud (tanto si TAPI lo inició como si no), es su deber llamar a [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient) durante el proceso de inicio y registrarse como destinatario de la solicitud.</span><span class="sxs-lookup"><span data-stu-id="939cc-155">When a request recipient is launched (whether or not it has been launched by TAPI) it is its duty to call [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient) during the startup process and register itself as a request recipient.</span></span>

3.  <span data-ttu-id="939cc-156">Si una o varias aplicaciones se enumeran en la entrada, TAPI comienza con la primera aplicación de la lista (prioridad más alta) e intenta iniciarla con la función [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa) .</span><span class="sxs-lookup"><span data-stu-id="939cc-156">If one or more applications are listed in the entry, TAPI begins with the first listed application (highest priority), and attempts to launch it using the [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa) function.</span></span> <span data-ttu-id="939cc-157">Si se produce un error al intentar iniciar la aplicación, TAPI intenta iniciar la siguiente aplicación de la lista.</span><span class="sxs-lookup"><span data-stu-id="939cc-157">If the attempt to launch the application fails, TAPI attempts to launch the next application in the list.</span></span> <span data-ttu-id="939cc-158">Cuando una aplicación se inicia correctamente, TAPI simplemente pone en cola la solicitud y devuelve una indicación de éxito a la aplicación aunque la solicitud todavía no se haya señalado al destinatario de la solicitud.</span><span class="sxs-lookup"><span data-stu-id="939cc-158">When any application launches successfully, TAPI simply queues the request and returns a success indication to the application even though the request hasn't yet been signaled to the request recipient.</span></span>

    <span data-ttu-id="939cc-159">Una vez iniciada la aplicación de destinatario de la solicitud, llama a [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient), que hace que se envíe un mensaje de [**\_ solicitud de línea**](./line-request.md) , señalando que la solicitud está en cola.</span><span class="sxs-lookup"><span data-stu-id="939cc-159">After the request recipient application is launched, it calls [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient), which causes a [**LINE\_REQUEST**](./line-request.md) message to be sent, signaling that the request is queued.</span></span> <span data-ttu-id="939cc-160">Si, por alguna razón, la aplicación iniciada no se registra nunca, la solicitud permanece en cola y permanece en la cola indefinidamente hasta que una aplicación se registra para ese tipo de solicitud.</span><span class="sxs-lookup"><span data-stu-id="939cc-160">If for some reason the launched application never registers, the request remains queued and remains in the queue indefinitely until an application registers for that type of request.</span></span>

4.  <span data-ttu-id="939cc-161">Si TAPI encuentra una aplicación registrada que ya se está ejecutando o inicia una correctamente, pone en cola la solicitud, envía un mensaje de solicitud de línea \_ a la aplicación de servidor y devuelve una indicación de éxito para la llamada de función a la aplicación de telefonía asistida.</span><span class="sxs-lookup"><span data-stu-id="939cc-161">If TAPI finds such a registered application already running or successfully launches one, it queues the request, sending a LINE\_REQUEST message to the server application, and returns a success indication for the function call to the Assisted Telephony application.</span></span> <span data-ttu-id="939cc-162">Este mensaje de operación correcta solo indica que la solicitud se ha aceptado y puesto en cola, no que se ha ejecutado correctamente.</span><span class="sxs-lookup"><span data-stu-id="939cc-162">This success message states only that the request has been accepted and queued, not that it has been successfully executed.</span></span>

<span data-ttu-id="939cc-163">Cuando la aplicación de servidor está lista para procesar una solicitud, llama a la función [**lineGetRequest**](/windows/win32/api/tapi/nf-tapi-linegetrequest) .</span><span class="sxs-lookup"><span data-stu-id="939cc-163">When the server application is ready to process a request, it calls the [**lineGetRequest**](/windows/win32/api/tapi/nf-tapi-linegetrequest) function.</span></span> <span data-ttu-id="939cc-164">Esto le permite recibir toda la información que necesita, como una dirección para marcar.</span><span class="sxs-lookup"><span data-stu-id="939cc-164">This lets it receive any information it needs, such as an address to dial.</span></span> <span data-ttu-id="939cc-165">A continuación, procesa la solicitud mediante las funciones TAPI (como [**lineMakeCall**](/windows/win32/api/tapi/nf-tapi-linemakecall) y [**lineDrop**](/windows/win32/api/tapi/nf-tapi-linedrop)) que, de lo contrario, se utilizaría para realizar la llamada.</span><span class="sxs-lookup"><span data-stu-id="939cc-165">It then processes the request, using the TAPI functions (such as [**lineMakeCall**](/windows/win32/api/tapi/nf-tapi-linemakecall) and [**lineDrop**](/windows/win32/api/tapi/nf-tapi-linedrop)) that would otherwise be used to place the call.</span></span> <span data-ttu-id="939cc-166">Al invocar **lineGetRequest** se quita la solicitud de TAPI y los parámetros de la solicitud se copian en un búfer de solicitud asignado por la aplicación.</span><span class="sxs-lookup"><span data-stu-id="939cc-166">Invoking **lineGetRequest** removes the request from TAPI, and the request parameters are copied in an application-allocated request buffer.</span></span> <span data-ttu-id="939cc-167">El tamaño y la interpretación del contenido del búfer dependen del modo de solicitud.</span><span class="sxs-lookup"><span data-stu-id="939cc-167">The size and interpretation of the contents of the buffer depend on the request mode.</span></span>

<span data-ttu-id="939cc-168">El servidor debe asegurarse de que usa los parámetros correctos al ejecutar las solicitudes.</span><span class="sxs-lookup"><span data-stu-id="939cc-168">The server must ensure that it uses the correct parameters when executing requests.</span></span> <span data-ttu-id="939cc-169">Al hacerlo, se siguen estos pasos:</span><span class="sxs-lookup"><span data-stu-id="939cc-169">When doing so, these steps are followed:</span></span>

1.  <span data-ttu-id="939cc-170">El destinatario de la solicitud recibe primero un mensaje de [**\_ solicitud de línea**](./line-request.md) que le informa de que pueden existir solicitudes en la cola de solicitudes.</span><span class="sxs-lookup"><span data-stu-id="939cc-170">The request recipient first receives a [**LINE\_REQUEST**](./line-request.md) message informing it that requests can exist for it in the request queue.</span></span> <span data-ttu-id="939cc-171">Esto indica a la aplicación que llame a [**lineGetRequest**](/windows/win32/api/tapi/nf-tapi-linegetrequest) y siga llamándolo hasta que se vacíe la cola (si la solicitud es para realizar una nueva llamada) o para quitar una llamada existente.</span><span class="sxs-lookup"><span data-stu-id="939cc-171">This tells the application to call [**lineGetRequest**](/windows/win32/api/tapi/nf-tapi-linegetrequest) and keep calling it until the queue is drained (if the request is for making a new call), or to drop an existing call.</span></span> <span data-ttu-id="939cc-172">Este mensaje no contiene los parámetros de la solicitud, excepto en el caso de una solicitud para quitar una llamada existente.</span><span class="sxs-lookup"><span data-stu-id="939cc-172">This message does not contain the parameters for the request, except in the case of a request to drop an existing call.</span></span>
2.  <span data-ttu-id="939cc-173">Si la solicitud es crear una nueva llamada, el servidor de telefonía asistido utiliza la función [**lineGetRequest**](/windows/win32/api/tapi/nf-tapi-linegetrequest) para recuperar la solicitud completa, que incluye los parámetros de la solicitud.</span><span class="sxs-lookup"><span data-stu-id="939cc-173">If the request is to make a new call, the Assisted Telephony server uses the [**lineGetRequest**](/windows/win32/api/tapi/nf-tapi-linegetrequest) function to retrieve the full request, which includes the request's parameters.</span></span> <span data-ttu-id="939cc-174">El servidor ahora tiene toda la información que necesita, como el número que se debe marcar o la identificación del creador de la solicitud.</span><span class="sxs-lookup"><span data-stu-id="939cc-174">The server now has all the information it needs, such as the number to dial or the identification of the maker of the request.</span></span> <span data-ttu-id="939cc-175">En primer lugar, sin embargo, el servidor debe asignar la memoria necesaria para almacenar esta información.</span><span class="sxs-lookup"><span data-stu-id="939cc-175">First, however, the server must allocate the memory needed to store this information.</span></span>
3.  <span data-ttu-id="939cc-176">Por último, el servidor ejecuta la solicitud mediante la invocación de la función o el conjunto de funciones TAPI adecuado.</span><span class="sxs-lookup"><span data-stu-id="939cc-176">Finally, the server executes the request by invoking the appropriate TAPI function or set of functions.</span></span>

<span data-ttu-id="939cc-177">Si TAPI no puede iniciar una aplicación capaz de servir como destinatario de la solicitud, se produce un error en la llamada de telefonía asistida y se devuelve el error TAPIERR \_ NOREQUESTRECIPIENT.</span><span class="sxs-lookup"><span data-stu-id="939cc-177">If TAPI cannot launch an application capable of serving as a request recipient, the Assisted Telephony call fails and returns the error TAPIERR\_NOREQUESTRECIPIENT.</span></span>

## <a name="notes-on-request-recipient-operations"></a><span data-ttu-id="939cc-178">Notas sobre las operaciones del destinatario de la solicitud</span><span class="sxs-lookup"><span data-stu-id="939cc-178">Notes on Request Recipient Operations</span></span>

<span data-ttu-id="939cc-179">La siguiente información se refiere a los sistemas en los que se procesan las solicitudes de telefonía asistidas:</span><span class="sxs-lookup"><span data-stu-id="939cc-179">The following information concerns systems on which Assisted Telephony requests are processed:</span></span>

-   <span data-ttu-id="939cc-180">El registro predeterminado debe mostrar una aplicación de administrador de llamadas en la lista de prioridades de [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall).</span><span class="sxs-lookup"><span data-stu-id="939cc-180">The default registry should list a call manager application in the priority list for [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall).</span></span> <span data-ttu-id="939cc-181">Sería útil, pero no esencial, que la aplicación del administrador de llamadas tenga una opción de menú que permita a los usuarios establecerla en la prioridad más alta.</span><span class="sxs-lookup"><span data-stu-id="939cc-181">It would be helpful, but not essential, for the call manager application to have a menu option that allows users to set it to the highest priority.</span></span>
-   <span data-ttu-id="939cc-182">Cuando TAPI inicia automáticamente una aplicación de destinatario de telefonía asistida y se trata de la única aplicación TAPI del sistema, esta acción inicializa TAPI.</span><span class="sxs-lookup"><span data-stu-id="939cc-182">When an Assisted Telephony recipient application is launched automatically by TAPI and if it is the only TAPI application in the system, this action initializes TAPI.</span></span> <span data-ttu-id="939cc-183">Si la aplicación de destinatario de telefonía asistida se inicializa y cierra el dispositivo de línea antes de registrarse para las solicitudes de telefonía asistida, TAPI también se apaga y se pierde la solicitud de telefonía asistida.</span><span class="sxs-lookup"><span data-stu-id="939cc-183">If the Assisted Telephony recipient application initializes and shuts down the line device before registering for Assisted Telephony requests, TAPI is shut down as well, and the Assisted Telephony request is lost.</span></span> <span data-ttu-id="939cc-184">También es posible que se pierdan solicitudes de telefonía asistidas cuando otra aplicación TAPI iniciada realiza una inicialización y cierre.</span><span class="sxs-lookup"><span data-stu-id="939cc-184">Assisted Telephony requests might also be lost when another TAPI application that is launched performs an initialize and shutdown.</span></span>

 

 
