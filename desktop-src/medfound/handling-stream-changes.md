---
description: En este tema se describe cómo una transformación de Media Foundation (MFT) debe controlar los cambios de formato durante el streaming.
ms.assetid: b0a94760-b4dd-4e50-a5ce-a1f674dde156
title: Control de los cambios de flujo
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2adf3cbc0504a37fe611b77047c73f85b9d1e742
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104275773"
---
# <a name="handling-stream-changes"></a><span data-ttu-id="bcb21-103">Control de los cambios de flujo</span><span class="sxs-lookup"><span data-stu-id="bcb21-103">Handling Stream Changes</span></span>

<span data-ttu-id="bcb21-104">En este tema se describe cómo una transformación de Media Foundation (MFT) debe controlar los cambios de formato durante el streaming.</span><span class="sxs-lookup"><span data-stu-id="bcb21-104">This topic describes how a Media Foundation transform (MFT) should handle format changes during streaming.</span></span>

> [!IMPORTANT]
>
> <span data-ttu-id="bcb21-105">Este tema no se aplica a los codificadores.</span><span class="sxs-lookup"><span data-stu-id="bcb21-105">This topic does not apply to encoders.</span></span> <span data-ttu-id="bcb21-106">Los codificadores no deben propagar los cambios de formato tal y como se describe en este tema.</span><span class="sxs-lookup"><span data-stu-id="bcb21-106">Encoders should not propagate format changes as described in this topic.</span></span> <span data-ttu-id="bcb21-107">Los codificadores solo deben aceptar un tipo de entrada que coincida con el tipo de salida configurado actualmente.</span><span class="sxs-lookup"><span data-stu-id="bcb21-107">Encoders should only accept an input type that matches the currently configured output type.</span></span>

 

## <a name="overview-of-format-changes"></a><span data-ttu-id="bcb21-108">Información general de los cambios de formato</span><span class="sxs-lookup"><span data-stu-id="bcb21-108">Overview of Format Changes</span></span>

<span data-ttu-id="bcb21-109">Por lo general, hay dos razones por las que un formato puede cambiar durante el streaming.</span><span class="sxs-lookup"><span data-stu-id="bcb21-109">Generally, there are two reasons that a format can change during streaming.</span></span>

-   <span data-ttu-id="bcb21-110">El cliente puede cambiar a un flujo con un nuevo formato.</span><span class="sxs-lookup"><span data-stu-id="bcb21-110">The client might switch to a stream with a new format.</span></span> <span data-ttu-id="bcb21-111">Por ejemplo, en televisión digital, esto puede ocurrir debido a un cambio de canal.</span><span class="sxs-lookup"><span data-stu-id="bcb21-111">For example, in digital television, this can occur due to a channel change.</span></span>
-   <span data-ttu-id="bcb21-112">En algunos formatos de vídeo, como H. 264, el fragmentada puede indicar un cambio de formato.</span><span class="sxs-lookup"><span data-stu-id="bcb21-112">In some video formats, such as H.264, the bitstream can signal a format change.</span></span> <span data-ttu-id="bcb21-113">Estos cambios pueden incluir cambios en la superposición de los campos, la resolución de vídeo o la relación de aspecto de píxeles.</span><span class="sxs-lookup"><span data-stu-id="bcb21-113">Such changes might include changes in field dominance, video resolution, or pixel aspect ratio.</span></span>

<span data-ttu-id="bcb21-114">Si el tipo de codificación cambia, es posible que el cliente tenga que quitar el MFT de la canalización y reemplazarlo por otro MFT.</span><span class="sxs-lookup"><span data-stu-id="bcb21-114">If the encoding type changes, the client might need to remove the MFT from the pipeline and replace it with another MFT.</span></span> <span data-ttu-id="bcb21-115">(Por ejemplo, es posible que el cliente necesite intercambiarse en un nuevo descodificador). En este tema no se trata esta situación.</span><span class="sxs-lookup"><span data-stu-id="bcb21-115">(For example, the client might need to swap in a new decoder.) This topic does not cover that situation.</span></span> <span data-ttu-id="bcb21-116">En este tema solo se trata el caso en el que la MFT actual puede controlar el nuevo formato.</span><span class="sxs-lookup"><span data-stu-id="bcb21-116">This topic covers only the case where the current MFT can handle the new format.</span></span>

<span data-ttu-id="bcb21-117">Si el formato cambia, el MFT podría requerir un nuevo tipo de entrada, un nuevo tipo de salida o ambos.</span><span class="sxs-lookup"><span data-stu-id="bcb21-117">If the format changes, the MFT might require a new input type, a new output type, or both.</span></span>

-   <span data-ttu-id="bcb21-118">El cliente inicia los cambios en el tipo de entrada.</span><span class="sxs-lookup"><span data-stu-id="bcb21-118">Changes to input type are initiated by the client.</span></span> <span data-ttu-id="bcb21-119">Una MFT nunca cambia su propio tipo de entrada.</span><span class="sxs-lookup"><span data-stu-id="bcb21-119">An MFT never changes its own input type.</span></span>
-   <span data-ttu-id="bcb21-120">La MFT inicia los cambios en el tipo de salida.</span><span class="sxs-lookup"><span data-stu-id="bcb21-120">Changes to output type are initiated by the MFT.</span></span> <span data-ttu-id="bcb21-121">La MFT indica que requiere un nuevo tipo de salida y el cliente negocia el nuevo tipo de salida con la MFT.</span><span class="sxs-lookup"><span data-stu-id="bcb21-121">The MFT signals that it requires a new output type, and the client negotiates the new output type with the MFT.</span></span>

<span data-ttu-id="bcb21-122">Por lo tanto, son posibles tres casos distintos:</span><span class="sxs-lookup"><span data-stu-id="bcb21-122">Thus, three distinct cases are possible:</span></span>

-   <span data-ttu-id="bcb21-123">El cliente establece un nuevo tipo de entrada.</span><span class="sxs-lookup"><span data-stu-id="bcb21-123">The client sets a new input type.</span></span> <span data-ttu-id="bcb21-124">La MFT usa el nuevo formato, sin ningún cambio en su tipo de salida.</span><span class="sxs-lookup"><span data-stu-id="bcb21-124">The MFT consumes the new format, with no change to its output type.</span></span>
-   <span data-ttu-id="bcb21-125">El cliente establece un nuevo tipo de entrada y desencadena un cambio en el tipo de salida.</span><span class="sxs-lookup"><span data-stu-id="bcb21-125">The client sets a new input type, and this triggers a change in the output type.</span></span>
-   <span data-ttu-id="bcb21-126">El tipo de entrada no cambia, pero el MFT detecta un cambio de formato en fragmentada, lo que requiere un nuevo tipo de salida.</span><span class="sxs-lookup"><span data-stu-id="bcb21-126">The input type does not change, but the MFT detects a format change in the bitstream, which requires a new output type.</span></span>

## <a name="implementing-format-changes"></a><span data-ttu-id="bcb21-127">Implementar cambios de formato</span><span class="sxs-lookup"><span data-stu-id="bcb21-127">Implementing Format Changes</span></span>

<span data-ttu-id="bcb21-128">En el resto de este tema se describe cómo el cliente debe procesar un cambio de formato y cómo implementar los cambios de formato en una MFT.</span><span class="sxs-lookup"><span data-stu-id="bcb21-128">The remainder of this topic describes how the client should process a format change, and how to implement format changes in an MFT.</span></span>

### <a name="output-type"></a><span data-ttu-id="bcb21-129">Tipo de salida</span><span class="sxs-lookup"><span data-stu-id="bcb21-129">Output Type</span></span>

<span data-ttu-id="bcb21-130">Cualquier MFT puede iniciar un cambio en su tipo de salida, como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="bcb21-130">Any MFT can initiate a change to its output type, as follows:</span></span>

1.  <span data-ttu-id="bcb21-131">El cliente llama a [**IMFTransform::P rocessoutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput).</span><span class="sxs-lookup"><span data-stu-id="bcb21-131">The client calls [**IMFTransform::ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput).</span></span> <span data-ttu-id="bcb21-132">La MFT responde de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="bcb21-132">The MFT responds as follows:</span></span>
    1.  <span data-ttu-id="bcb21-133">MFT no genera un ejemplo de salida en [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput).</span><span class="sxs-lookup"><span data-stu-id="bcb21-133">The MFT does not produce an output sample in [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput).</span></span>
    2.  <span data-ttu-id="bcb21-134">MFT establece la marca **de \_ \_ cambio del \_ \_ formato \_ de búfer de datos de salida de MFT** en el miembro **dwStatus** de la estructura de búfer de [**\_ \_ datos \_ de salida MFT**](/windows/desktop/api/mftransform/ns-mftransform-mft_output_data_buffer) .</span><span class="sxs-lookup"><span data-stu-id="bcb21-134">The MFT sets the **MFT\_OUTPUT\_DATA\_BUFFER\_FORMAT\_CHANGE** flag in the **dwStatus** member of the [**MFT\_OUTPUT\_DATA\_BUFFER**](/windows/desktop/api/mftransform/ns-mftransform-mft_output_data_buffer) structure.</span></span>
    3.  <span data-ttu-id="bcb21-135">El método [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) devuelve el código de error **MF \_ E transformar el \_ \_ \_ cambio de flujo**.</span><span class="sxs-lookup"><span data-stu-id="bcb21-135">The [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) method returns the error code **MF\_E\_TRANSFORM\_STREAM\_CHANGE**.</span></span>
2.  <span data-ttu-id="bcb21-136">El cliente llama a [**IMFTransform:: GetOutputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputavailabletype).</span><span class="sxs-lookup"><span data-stu-id="bcb21-136">The client calls [**IMFTransform::GetOutputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputavailabletype).</span></span> <span data-ttu-id="bcb21-137">Este método devuelve un conjunto actualizado de tipos de salida.</span><span class="sxs-lookup"><span data-stu-id="bcb21-137">This method returns an updated set of output types.</span></span>
3.  <span data-ttu-id="bcb21-138">El cliente llama a [**SetOutputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setoutputtype) para establecer un nuevo tipo de salida.</span><span class="sxs-lookup"><span data-stu-id="bcb21-138">The client calls [**SetOutputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setoutputtype) to set a new output type.</span></span>
4.  <span data-ttu-id="bcb21-139">El cliente reanuda la llamada a [**ProcessInput**](/windows/desktop/api/mfidl/nf-mfidl-imfqualitymanager-notifyprocessinput) / [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput).</span><span class="sxs-lookup"><span data-stu-id="bcb21-139">The client resumes calling [**ProcessInput**](/windows/desktop/api/mfidl/nf-mfidl-imfqualitymanager-notifyprocessinput)/[**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput).</span></span>

### <a name="input-type"></a><span data-ttu-id="bcb21-140">Tipo de entrada</span><span class="sxs-lookup"><span data-stu-id="bcb21-140">Input Type</span></span>

<span data-ttu-id="bcb21-141">El cliente inicia los cambios en el tipo de entrada, nunca el MFT.</span><span class="sxs-lookup"><span data-stu-id="bcb21-141">Changes to the input type are initiated by the client, never by the MFT.</span></span> <span data-ttu-id="bcb21-142">Si el tipo de entrada cambia, podría desencadenar un cambio en el tipo de salida.</span><span class="sxs-lookup"><span data-stu-id="bcb21-142">If the input type changes, it might trigger a change to the output type.</span></span>

<span data-ttu-id="bcb21-143">La secuencia exacta de eventos depende del valor del atributo de [**\_ cambio de \_ \_ formato dinámico \_ compatible con MFT**](mft-support-dynamic-format-change-attribute.md) .</span><span class="sxs-lookup"><span data-stu-id="bcb21-143">The exact sequence of events depends on the value of the [**MFT\_SUPPORT\_DYNAMIC\_FORMAT\_CHANGE**](mft-support-dynamic-format-change-attribute.md) attribute.</span></span>



| <span data-ttu-id="bcb21-144">Value</span><span class="sxs-lookup"><span data-stu-id="bcb21-144">Value</span></span>     | <span data-ttu-id="bcb21-145">Descripción</span><span class="sxs-lookup"><span data-stu-id="bcb21-145">Description</span></span>                                                     |
|-----------|-----------------------------------------------------------------|
| <span data-ttu-id="bcb21-146">**FALSE**</span><span class="sxs-lookup"><span data-stu-id="bcb21-146">**FALSE**</span></span> | <span data-ttu-id="bcb21-147">Antes de que el cliente establezca un nuevo tipo de entrada, debe purgar la MFT.</span><span class="sxs-lookup"><span data-stu-id="bcb21-147">Before the client sets a new input type, it must drain the MFT.</span></span> |
| <span data-ttu-id="bcb21-148">**TRUE**</span><span class="sxs-lookup"><span data-stu-id="bcb21-148">**TRUE**</span></span>  | <span data-ttu-id="bcb21-149">El cliente puede establecer un nuevo tipo de entrada sin agotar la MFT.</span><span class="sxs-lookup"><span data-stu-id="bcb21-149">The client can set a new input type without draining the MFT.</span></span>   |



 

<span data-ttu-id="bcb21-150">Un MFT expone este atributo a través de su método [**IMFTransform:: GetAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getattributes) .</span><span class="sxs-lookup"><span data-stu-id="bcb21-150">An MFT exposes this attribute through its [**IMFTransform::GetAttributes**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getattributes) method.</span></span> <span data-ttu-id="bcb21-151">El valor predeterminado de este atributo es **false**; Si MFT no establece el atributo, trate el valor como **false**.</span><span class="sxs-lookup"><span data-stu-id="bcb21-151">The default value of this attribute is **FALSE**; if the MFT does not set the attribute, treat the value as **FALSE**.</span></span>

<span data-ttu-id="bcb21-152">**La \_ compatibilidad con el \_ cambio de formato dinámico de MFT \_ \_ es falsa**</span><span class="sxs-lookup"><span data-stu-id="bcb21-152">**MFT\_SUPPORT\_DYNAMIC\_FORMAT\_CHANGE is FALSE**</span></span>

1.  <span data-ttu-id="bcb21-153">El cliente envía el mensaje de [**agotamiento del comando del mensaje de MFT \_ \_ \_**](mft-message-command-drain.md) .</span><span class="sxs-lookup"><span data-stu-id="bcb21-153">The client sends the [**MFT\_MESSAGE\_COMMAND\_DRAIN**](mft-message-command-drain.md) message.</span></span>
2.  <span data-ttu-id="bcb21-154">El cliente purga la MFT mediante una llamada a [**IMFTransform::P rocessoutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) hasta que **ProcessOutput** devuelve la **\_ transformación MF E \_ \_ necesita \_ más \_ entrada**.</span><span class="sxs-lookup"><span data-stu-id="bcb21-154">The client drains the MFT by calling [**IMFTransform::ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) until **ProcessOutput** returns **MF\_E\_TRANSFORM\_NEED\_MORE\_INPUT**.</span></span>
3.  <span data-ttu-id="bcb21-155">El cliente llama a [**IMFTransform:: SetInputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setinputtype) para establecer el nuevo tipo de entrada.</span><span class="sxs-lookup"><span data-stu-id="bcb21-155">The client calls [**IMFTransform::SetInputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setinputtype) to set the new input type.</span></span>
4.  <span data-ttu-id="bcb21-156">La MFT valida el tipo de entrada.</span><span class="sxs-lookup"><span data-stu-id="bcb21-156">The MFT validates the input type.</span></span> <span data-ttu-id="bcb21-157">Si el tipo no es válido, [**SetInputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setinputtype) devuelve **MF \_ E \_ INVALIDMEDIATYPE** u otro código de error.</span><span class="sxs-lookup"><span data-stu-id="bcb21-157">If the type is invalid, [**SetInputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setinputtype) returns **MF\_E\_INVALIDMEDIATYPE** or another error code.</span></span> <span data-ttu-id="bcb21-158">De lo contrario, **SetInputType** devuelve S \_ OK.</span><span class="sxs-lookup"><span data-stu-id="bcb21-158">Otherwise, **SetInputType** returns S\_OK.</span></span>
5.  <span data-ttu-id="bcb21-159">Suponiendo que el tipo de entrada es válido, el MFT evalúa si el tipo de salida también cambia.</span><span class="sxs-lookup"><span data-stu-id="bcb21-159">Assuming the input type is valid, the MFT evaluates whether the output type also changes.</span></span> <span data-ttu-id="bcb21-160">En caso contrario, continúa la transmisión por secuencias y no es necesario realizar ninguna otra acción.</span><span class="sxs-lookup"><span data-stu-id="bcb21-160">If not, streaming continues, and no further action is required.</span></span>
6.  <span data-ttu-id="bcb21-161">Si el tipo de salida cambia:</span><span class="sxs-lookup"><span data-stu-id="bcb21-161">If the output type changes:</span></span>
    1.  <span data-ttu-id="bcb21-162">La MFT invalida su tipo de medio de salida actual y actualiza la lista de tipos de medios de salida disponibles.</span><span class="sxs-lookup"><span data-stu-id="bcb21-162">The MFT invalidates its current output media type, and updates the list of available output media types.</span></span>
    2.  <span data-ttu-id="bcb21-163">La siguiente llamada a [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) devuelve **el \_ \_ cambio de \_ secuencia \_ de transformación MF E**, como se describe en la sección anterior.</span><span class="sxs-lookup"><span data-stu-id="bcb21-163">The next call to [**ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) returns **MF\_E\_TRANSFORM\_STREAM\_CHANGE**, as described in the previous section.</span></span>
    3.  <span data-ttu-id="bcb21-164">El cliente llama a [**IMFTransform:: GetOutputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputavailabletype) para obtener la lista actualizada de tipos de salida.</span><span class="sxs-lookup"><span data-stu-id="bcb21-164">The client calls [**IMFTransform::GetOutputAvailableType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-getoutputavailabletype) to get the updated list of output types.</span></span>
    4.  <span data-ttu-id="bcb21-165">El cliente llama a [**SetOutputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setoutputtype).</span><span class="sxs-lookup"><span data-stu-id="bcb21-165">The client calls [**SetOutputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setoutputtype).</span></span>

<span data-ttu-id="bcb21-166">**La \_ compatibilidad con el \_ cambio de formato dinámico de MFT \_ \_ es true**</span><span class="sxs-lookup"><span data-stu-id="bcb21-166">**MFT\_SUPPORT\_DYNAMIC\_FORMAT\_CHANGE is TRUE**</span></span>

1.  <span data-ttu-id="bcb21-167">El cliente llama a [**IMFTransform:: SetInputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setinputtype) para establecer el nuevo tipo de entrada.</span><span class="sxs-lookup"><span data-stu-id="bcb21-167">The client calls [**IMFTransform::SetInputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setinputtype) to set the new input type.</span></span>
2.  <span data-ttu-id="bcb21-168">La MFT valida el tipo de entrada.</span><span class="sxs-lookup"><span data-stu-id="bcb21-168">The MFT validates the input type.</span></span> <span data-ttu-id="bcb21-169">Si el tipo no es válido, [**SetInputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setinputtype) devuelve **MF \_ E \_ INVALIDMEDIATYPE** u otro código de error.</span><span class="sxs-lookup"><span data-stu-id="bcb21-169">If the type is invalid, [**SetInputType**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-setinputtype) returns **MF\_E\_INVALIDMEDIATYPE** or another error code.</span></span> <span data-ttu-id="bcb21-170">De lo contrario, **SetInputType** devuelve S \_ OK.</span><span class="sxs-lookup"><span data-stu-id="bcb21-170">Otherwise, **SetInputType** returns S\_OK.</span></span>
3.  <span data-ttu-id="bcb21-171">Suponiendo que el tipo de entrada es válido, el MFT evalúa si el tipo de salida también cambia.</span><span class="sxs-lookup"><span data-stu-id="bcb21-171">Assuming the input type is valid, the MFT evaluates whether the output type also changes.</span></span> <span data-ttu-id="bcb21-172">En caso contrario, continúa la transmisión por secuencias y no es necesario realizar ninguna otra acción.</span><span class="sxs-lookup"><span data-stu-id="bcb21-172">If not, streaming continues, and no further action is required.</span></span>
4.  <span data-ttu-id="bcb21-173">Antes de que el tipo de salida cambie, el MFT debe procesar cualquier ejemplo de entrada en caché, como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="bcb21-173">Before the output type changes, the MFT must process any cached input samples, as follows:</span></span>
    1.  <span data-ttu-id="bcb21-174">MFT no invalida su tipo de salida actual.</span><span class="sxs-lookup"><span data-stu-id="bcb21-174">The MFT does not invalidate its current output type.</span></span>
    2.  <span data-ttu-id="bcb21-175">La MFT genera tantas salidas como pueda de los ejemplos de entrada almacenados en caché.</span><span class="sxs-lookup"><span data-stu-id="bcb21-175">The MFT produces as much output as it can from the cached input samples.</span></span>
    3.  <span data-ttu-id="bcb21-176">Es opcional si el MFT acepta nuevos ejemplos de entrada mientras procesa los ejemplos almacenados en caché.</span><span class="sxs-lookup"><span data-stu-id="bcb21-176">It is optional whether the MFT accepts new input samples while it processes the cached samples.</span></span> <span data-ttu-id="bcb21-177">Si es así, los nuevos ejemplos de entrada usarán el nuevo formato de entrada, por lo que la MFT debe realizar un seguimiento del punto cuando el formato cambie.</span><span class="sxs-lookup"><span data-stu-id="bcb21-177">If so, the new input samples will use the new input format, so the MFT must keep track of the point when the format changed.</span></span>
5.  <span data-ttu-id="bcb21-178">Una vez que el MFT procesa todos los ejemplos que recibió antes de que se cambiara el tipo de entrada, [**IMFTransform::P rocessoutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) devuelve el **\_ cambio de flujo de \_ transformación \_ \_ MF E**.</span><span class="sxs-lookup"><span data-stu-id="bcb21-178">After the MFT processes all of the samples that it received before the input type changed, the [**IMFTransform::ProcessOutput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) returns **MF\_E\_TRANSFORM\_STREAM\_CHANGE**.</span></span>
6.  <span data-ttu-id="bcb21-179">La MFT invalida su tipo de salida actual y actualiza la lista de tipos de medios de salida disponibles.</span><span class="sxs-lookup"><span data-stu-id="bcb21-179">The MFT invalidates its current output type, and updates the list of available output media types.</span></span>
7.  <span data-ttu-id="bcb21-180">El cliente negocia el nuevo tipo de salida, tal y como se ha descrito anteriormente.</span><span class="sxs-lookup"><span data-stu-id="bcb21-180">The client negotiates the new output type, as described previously.</span></span>

<span data-ttu-id="bcb21-181">Los [MFTs asincrónicos](asynchronous-mfts.md) deben devolver el valor **true** para el atributo de [**\_ \_ \_ \_ cambio de formato dinámico de compatibilidad con MFT**](mft-support-dynamic-format-change-attribute.md) .</span><span class="sxs-lookup"><span data-stu-id="bcb21-181">[Asynchronous MFTs](asynchronous-mfts.md) must return the value **TRUE** for the [**MFT\_SUPPORT\_DYNAMIC\_FORMAT\_CHANGE**](mft-support-dynamic-format-change-attribute.md) attribute.</span></span> <span data-ttu-id="bcb21-182">Cuando se usa una MFT asincrónica, el cliente puede suponer que el atributo **\_ compatibilidad con el \_ \_ \_ cambio de formato dinámico de MFT** está establecido en **true**.</span><span class="sxs-lookup"><span data-stu-id="bcb21-182">When using an asynchronous MFT, the client can assume that the **MFT\_SUPPORT\_DYNAMIC\_FORMAT\_CHANGE** attribute is set to **TRUE**.</span></span>

<span data-ttu-id="bcb21-183">Cuando [**la \_ compatibilidad con el \_ \_ \_ cambio de formato dinámico de MFT**](mft-support-dynamic-format-change-attribute.md) es **true**, la principal diferencia es que el cliente no necesita purgar la MFT antes de establecer un nuevo tipo de entrada.</span><span class="sxs-lookup"><span data-stu-id="bcb21-183">When [**MFT\_SUPPORT\_DYNAMIC\_FORMAT\_CHANGE**](mft-support-dynamic-format-change-attribute.md) is **TRUE**, the main difference is that the client is not required to drain the MFT before setting a new input type.</span></span> <span data-ttu-id="bcb21-184">Como resultado, el tipo de entrada puede cambiar mientras la MFT contiene los ejemplos de entrada.</span><span class="sxs-lookup"><span data-stu-id="bcb21-184">As a result, the input type might change while the MFT is holding onto input samples.</span></span> <span data-ttu-id="bcb21-185">Es importante que la MFT no quite simplemente estos ejemplos.</span><span class="sxs-lookup"><span data-stu-id="bcb21-185">It is important that the MFT does not simply drop these samples.</span></span> <span data-ttu-id="bcb21-186">Además, el tipo de salida no puede cambiar hasta que la MFT procese todos los datos almacenados en caché.</span><span class="sxs-lookup"><span data-stu-id="bcb21-186">Also, the output type cannot change until the MFT processes all of its cached data.</span></span>

<span data-ttu-id="bcb21-187">El párrafo anterior se aplica especialmente a los descodificadores de vídeo, que pueden recibir fotogramas intercodificados fuera del orden temporal y, por tanto, deben almacenarse en caché.</span><span class="sxs-lookup"><span data-stu-id="bcb21-187">The previous paragraph applies especially to video decoders, which can receive inter-coded frames out of temporal order, and thus need to cache them.</span></span> <span data-ttu-id="bcb21-188">Si una MFT no almacena en caché los ejemplos de entrada, la purga es esencialmente una operación no operativa.</span><span class="sxs-lookup"><span data-stu-id="bcb21-188">If an MFT does not cache input samples, draining is essentially a no-op.</span></span> <span data-ttu-id="bcb21-189">En ese caso, el MFT puede establecer [**el \_ \_ cambio de \_ formato \_ dinámico de compatibilidad con MFT**](mft-support-dynamic-format-change-attribute.md) en **false** (o dejar el atributo sin definir).</span><span class="sxs-lookup"><span data-stu-id="bcb21-189">In that case, the MFT can set [**MFT\_SUPPORT\_DYNAMIC\_FORMAT\_CHANGE**](mft-support-dynamic-format-change-attribute.md) to **FALSE** (or leave the attribute unset).</span></span>

<span data-ttu-id="bcb21-190">Además, tenga en cuenta que se espera que cada MFT controle los cambios de formato correctamente tras su purga.</span><span class="sxs-lookup"><span data-stu-id="bcb21-190">Also, note that every MFT is expected to handle format changes correctly after being drained.</span></span> <span data-ttu-id="bcb21-191">El atributo de [**\_ \_ \_ \_ cambio de formato dinámico de MFT**](mft-support-dynamic-format-change-attribute.md) indica si la MFT admite cambios de formato sin purgar.</span><span class="sxs-lookup"><span data-stu-id="bcb21-191">The [**MFT\_SUPPORT\_DYNAMIC\_FORMAT\_CHANGE**](mft-support-dynamic-format-change-attribute.md) attribute indicates whether the MFT supports format changes without draining.</span></span>

## <a name="change-in-interlace-mode"></a><span data-ttu-id="bcb21-192">Cambiar en modo entrelazado</span><span class="sxs-lookup"><span data-stu-id="bcb21-192">Change in Interlace Mode</span></span>

<span data-ttu-id="bcb21-193">Los cambios en el modo de entrelazado de vídeo son un caso especial, ya que no invalidan el tipo de medio actual.</span><span class="sxs-lookup"><span data-stu-id="bcb21-193">Changes in the video interlacing mode are a special case, because they do not invalidate the current media type.</span></span> <span data-ttu-id="bcb21-194">En su lugar, se especifica el modo entrelazado para cada fotograma de vídeo mediante el establecimiento de atributos en el ejemplo multimedia.</span><span class="sxs-lookup"><span data-stu-id="bcb21-194">Instead, the interlace mode is specified for each video frame by setting attributes on the media sample.</span></span> <span data-ttu-id="bcb21-195">Un MFT de vídeo debe comprobar cada ejemplo de entrada para la presencia de estas marcas.</span><span class="sxs-lookup"><span data-stu-id="bcb21-195">A video MFT should check each input sample for the presence of these flags.</span></span>

<span data-ttu-id="bcb21-196">El modo entrelazado puede cambiar cuando el campo dominador cambia de campo superior a campo inferior, o cuando el vídeo cambia entre imágenes progresivas e entrelazadas.</span><span class="sxs-lookup"><span data-stu-id="bcb21-196">The interlace mode can change when the field dominance switches from top-field to bottom-field, or when the video switches between progressive and interlaced pictures.</span></span>

<span data-ttu-id="bcb21-197">Para obtener más información, vea el apartado [sobre marcas de entrelazado en ejemplos](video-interlacing.md).</span><span class="sxs-lookup"><span data-stu-id="bcb21-197">For more information, see [Interlace Flags on Samples](video-interlacing.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="bcb21-198">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="bcb21-198">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="bcb21-199">Escribir una MFT personalizada</span><span class="sxs-lookup"><span data-stu-id="bcb21-199">Writing a Custom MFT</span></span>](writing-a-custom-mft.md)
</dt> </dl>

 

 



