---
title: Autenticación para conexiones remotas
description: Administración remota de Windows mantiene la seguridad para la comunicación entre equipos al admitir varios métodos estándar de autenticación y cifrado de mensajes.
ms.assetid: 97a13b07-ae7a-4d2f-8841-77a22c91b204
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
topic_type:
- kbArticle
api_name: ''
api_type: ''
api_location: ''
ms.openlocfilehash: 0e9aa125f2ccf5d8c224eee645a6dba1ec2fd96e
ms.sourcegitcommit: 25c6d442ab55cbf0e065398a006b1d409349fffd
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/27/2020
ms.locfileid: "104077455"
---
# <a name="authentication-for-remote-connections"></a><span data-ttu-id="fb374-103">Autenticación para conexiones remotas</span><span class="sxs-lookup"><span data-stu-id="fb374-103">Authentication for Remote Connections</span></span>

<span data-ttu-id="fb374-104">Administración remota de Windows mantiene la seguridad para la comunicación entre equipos al admitir varios métodos estándar de autenticación y cifrado de mensajes.</span><span class="sxs-lookup"><span data-stu-id="fb374-104">Windows Remote Management maintains security for communication between computers by supporting several standard methods of authentication and message encryption.</span></span>

## <a name="default-group-access"></a><span data-ttu-id="fb374-105">Acceso al grupo predeterminado</span><span class="sxs-lookup"><span data-stu-id="fb374-105">Default Group Access</span></span>

<span data-ttu-id="fb374-106">Durante la instalación, WinRM crea el grupo **local \_ \_ WinRMRemoteWMIUsers**.</span><span class="sxs-lookup"><span data-stu-id="fb374-106">During setup, WinRM creates the local group **WinRMRemoteWMIUsers\_\_**.</span></span> <span data-ttu-id="fb374-107">WinRM restringe el acceso remoto a cualquier usuario que no sea miembro del grupo de administración local o del grupo **WinRMRemoteWMIUsers \_ \_** .</span><span class="sxs-lookup"><span data-stu-id="fb374-107">WinRM then restricts remote access to any user that is not a member of either the local administration group or the **WinRMRemoteWMIUsers\_\_** group.</span></span> <span data-ttu-id="fb374-108">Puede Agregar un usuario local, un usuario de dominio o un grupo de dominio a **WinRMRemoteWMIUsers \_ \_** escribiendo **net localgroup WinRMRemoteWMIUsers \_ \_ /Add <domain> \\ <username>** en el símbolo del sistema.</span><span class="sxs-lookup"><span data-stu-id="fb374-108">You can add a local user, domain user, or domain group to **WinRMRemoteWMIUsers\_\_** by typing **net localgroup WinRMRemoteWMIUsers\_\_ /add <domain>\\<username>** at the command prompt.</span></span> <span data-ttu-id="fb374-109">Opcionalmente, puede usar el directiva de grupo para agregar un usuario al grupo.</span><span class="sxs-lookup"><span data-stu-id="fb374-109">Optionally, you can use the Group Policy to add a user to the group.</span></span>

## <a name="default-authentication-settings"></a><span data-ttu-id="fb374-110">Configuración de autenticación predeterminada</span><span class="sxs-lookup"><span data-stu-id="fb374-110">Default Authentication Settings</span></span>

<span data-ttu-id="fb374-111">Las credenciales predeterminadas, el nombre de usuario y la contraseña son las credenciales de la cuenta de usuario que ha iniciado la sesión que ejecuta el script.</span><span class="sxs-lookup"><span data-stu-id="fb374-111">The default credentials, user name, and password, are the credentials for the logged-on user account that runs the script.</span></span>

<span data-ttu-id="fb374-112">**Para cambiar a otra cuenta en un equipo remoto**</span><span class="sxs-lookup"><span data-stu-id="fb374-112">**To change to another account on a remote computer**</span></span>

1.  <span data-ttu-id="fb374-113">Especifique las credenciales en un objeto [**ConnectionOptions**](connectionoptions.md) o [**IWSManConnectionOptions**](/windows/desktop/api/WSManDisp/nn-wsmandisp-iwsmanconnectionoptions) y proporcione esto a la llamada [**createSession**](wsman-createsession.md) .</span><span class="sxs-lookup"><span data-stu-id="fb374-113">Specify the credentials in a [**ConnectionOptions**](connectionoptions.md) or [**IWSManConnectionOptions**](/windows/desktop/api/WSManDisp/nn-wsmandisp-iwsmanconnectionoptions) object and supply that to the [**CreateSession**](wsman-createsession.md) call.</span></span>
2.  <span data-ttu-id="fb374-114">Establezca **WSManFlagCredUserNamePassword** en el parámetro *Flags* de la llamada a [**createSession**](wsman-createsession.md) .</span><span class="sxs-lookup"><span data-stu-id="fb374-114">Set the **WSManFlagCredUserNamePassword** in the *flags* parameter in the [**CreateSession**](wsman-createsession.md) call.</span></span>

<span data-ttu-id="fb374-115">La lista siguiente contiene una lista de lo que ocurre cuando un script o una aplicación se ejecuta con las credenciales predeterminadas:</span><span class="sxs-lookup"><span data-stu-id="fb374-115">The following list contains a list of what occurs when a script or application runs under the default credentials:</span></span>

-   <span data-ttu-id="fb374-116">[*Kerberos*](windows-remote-management-glossary.md) es el método predeterminado de autenticación cuando el cliente está en un dominio y la cadena de destino remoto no es una de las siguientes: localhost, 127.0.0.1 o \[ :: 1 \] .</span><span class="sxs-lookup"><span data-stu-id="fb374-116">[*Kerberos*](windows-remote-management-glossary.md) is the default method of authentication when the client is in a domain and the remote destination string is not one of the following: localhost, 127.0.0.1, or \[::1\].</span></span>
-   <span data-ttu-id="fb374-117">[*Negotiate*](windows-remote-management-glossary.md) es el método predeterminado cuando el cliente no está en un dominio, pero la cadena de destino remoto es uno de los siguientes: localhost, 127.0.0.1 o \[ :: 1 \] .</span><span class="sxs-lookup"><span data-stu-id="fb374-117">[*Negotiate*](windows-remote-management-glossary.md) is the default method when the client is not in a domain, but the remote destination string is one of the following: localhost, 127.0.0.1, or \[::1\].</span></span>

<span data-ttu-id="fb374-118">Si proporciona credenciales explícitas con un objeto [**ConnectionOptions**](connectionoptions.md) , Negotiate es el método predeterminado.</span><span class="sxs-lookup"><span data-stu-id="fb374-118">If you supply explicit credentials with a [**ConnectionOptions**](connectionoptions.md) object, Negotiate is the default method.</span></span> <span data-ttu-id="fb374-119">Negociar autenticación determina si el método de autenticación en curso es Kerberos o NTLM, en función de si los equipos están en un dominio o grupo de trabajo.</span><span class="sxs-lookup"><span data-stu-id="fb374-119">Negotiate authentication determines whether the ongoing authentication method is Kerberos or NTLM, depending on whether the computers are in a domain or workgroup.</span></span> <span data-ttu-id="fb374-120">Si se conecta a un equipo de destino remoto mediante una cuenta local, la cuenta debe tener como prefijo el nombre del equipo.</span><span class="sxs-lookup"><span data-stu-id="fb374-120">If connecting to a remote target computer using a local account, then the account should be prefixed with the computer name.</span></span> <span data-ttu-id="fb374-121">Por ejemplo, mi \\ nombreDeUsuario.</span><span class="sxs-lookup"><span data-stu-id="fb374-121">For example, myComputer\\myUsername.</span></span>

<span data-ttu-id="fb374-122">Si especifica la autenticación Negotiate, Digest o Basic y no proporciona un objeto [**ConnectionOptions**](connectionoptions.md) , recibirá un error que indica que se requieren credenciales explícitas.</span><span class="sxs-lookup"><span data-stu-id="fb374-122">If you specify Negotiate, Digest, or Basic authentication and fail to supply a [**ConnectionOptions**](connectionoptions.md) object, then you will receive an error indicating that explicit credentials are required.</span></span> <span data-ttu-id="fb374-123">Si HTTPS no es el transporte, el equipo remoto de destino debe configurarse en la lista de equipos host de confianza.</span><span class="sxs-lookup"><span data-stu-id="fb374-123">If HTTPS is not the transport, then the target remote computer must be configured in the list of trusted host computers.</span></span>

<span data-ttu-id="fb374-124">Para obtener más información sobre los tipos de autenticación que están habilitados en los valores de configuración predeterminados, vea [instalación y configuración de administración remota de Windows](installation-and-configuration-for-windows-remote-management.md).</span><span class="sxs-lookup"><span data-stu-id="fb374-124">For more information about the authentication types that are enabled in the default configuration settings, see [Installation and Configuration for Windows Remote Management](installation-and-configuration-for-windows-remote-management.md).</span></span>

## <a name="basic-authentication"></a><span data-ttu-id="fb374-125">Autenticación básica</span><span class="sxs-lookup"><span data-stu-id="fb374-125">Basic Authentication</span></span>

<span data-ttu-id="fb374-126">Para establecer explícitamente la autenticación [*básica*](windows-remote-management-glossary.md) en la llamada a [**WSMan. createSession**](wsman-createsession.md), establezca las marcas **WSManFlagUseBasic** y **WSManFlagCredUserNamePassword** en el parámetro *Flags* .</span><span class="sxs-lookup"><span data-stu-id="fb374-126">To explicitly establish [*Basic*](windows-remote-management-glossary.md) authentication in the call to [**WSMan.CreateSession**](wsman-createsession.md), set the **WSManFlagUseBasic** and **WSManFlagCredUserNamePassword** flags in the *flags* parameter.</span></span> <span data-ttu-id="fb374-127">La autenticación básica está deshabilitada en los valores de configuración predeterminados para el cliente WinRM y el servidor WinRM.</span><span class="sxs-lookup"><span data-stu-id="fb374-127">Basic authentication is disabled in the default configuration settings for both the WinRM client and the WinRM server.</span></span>

## <a name="digest-authentication"></a><span data-ttu-id="fb374-128">Autenticación implícita</span><span class="sxs-lookup"><span data-stu-id="fb374-128">Digest Authentication</span></span>

<span data-ttu-id="fb374-129">Para establecer explícitamente la autenticación [*implícita*](windows-remote-management-glossary.md) en la llamada a [**WSMan. createSession**](wsman-createsession.md), establezca la marca **WSManFlagUseDigest** en el parámetro *Flags* .</span><span class="sxs-lookup"><span data-stu-id="fb374-129">To explicitly establish [*Digest*](windows-remote-management-glossary.md) authentication in the call to [**WSMan.CreateSession**](wsman-createsession.md), set the **WSManFlagUseDigest** flag in the *flags* parameter.</span></span> <span data-ttu-id="fb374-130">No se admite la síntesis.</span><span class="sxs-lookup"><span data-stu-id="fb374-130">Digest is not supported.</span></span> <span data-ttu-id="fb374-131">No se puede configurar para el componente de servidor WinRM.</span><span class="sxs-lookup"><span data-stu-id="fb374-131">It cannot be configured, for the WinRM server component.</span></span>

## <a name="negotiate-authentication"></a><span data-ttu-id="fb374-132">Negociar la autenticación</span><span class="sxs-lookup"><span data-stu-id="fb374-132">Negotiate Authentication</span></span>

<span data-ttu-id="fb374-133">Para establecer explícitamente la autenticación [*Negotiate*](windows-remote-management-glossary.md) , también conocida como autenticación integrada de Windows, en la llamada a [**WSMan. createSession**](wsman-createsession.md), establezca la marca **WSManFlagUseNegotiate** en el parámetro *Flags* .</span><span class="sxs-lookup"><span data-stu-id="fb374-133">To explicitly establish [*Negotiate*](windows-remote-management-glossary.md) authentication, also known as Windows Integrated Authentication, in the call to [**WSMan.CreateSession**](wsman-createsession.md), set the **WSManFlagUseNegotiate** flag in the *flags* parameter.</span></span>

<span data-ttu-id="fb374-134">[Control de cuentas de usuario (UAC)](https://support.microsoft.com/help/922708/how-to-use-user-account-control-uac-in-windows-vista) afecta al acceso al servicio WinRM.</span><span class="sxs-lookup"><span data-stu-id="fb374-134">[User Account Control (UAC)](https://support.microsoft.com/help/922708/how-to-use-user-account-control-uac-in-windows-vista) affects access to the WinRM service.</span></span> <span data-ttu-id="fb374-135">Cuando se usa Negotiate Authentication en un grupo de trabajo, solo la cuenta de administrador integrada puede tener acceso al servicio.</span><span class="sxs-lookup"><span data-stu-id="fb374-135">When Negotiate authentication is used in a workgroup, only the built-in Administrator account can access the service.</span></span> <span data-ttu-id="fb374-136">Para permitir que todas las cuentas del grupo administradores tengan acceso al servicio, establezca el siguiente valor del registro:</span><span class="sxs-lookup"><span data-stu-id="fb374-136">To allow all accounts in the Administrators group to access the service, set the following registry value:</span></span>

<span data-ttu-id="fb374-137">**HKEY \_ SOFTWARE de \_ equipo local** \\  \\ **Microsoft** \\ **Windows** \\ **CurrentVersion** \\ **Policies** \\ **System** \\ **LocalAccountTokenFilterPolicy** = 1</span><span class="sxs-lookup"><span data-stu-id="fb374-137">**HKEY\_LOCAL\_MACHINE**\\**SOFTWARE**\\**Microsoft**\\**Windows**\\**CurrentVersion**\\**Policies**\\**System**\\**LocalAccountTokenFilterPolicy** = 1</span></span>

## <a name="kerberos-authentication"></a><span data-ttu-id="fb374-138">Autenticación Kerberos</span><span class="sxs-lookup"><span data-stu-id="fb374-138">Kerberos Authentication</span></span>

<span data-ttu-id="fb374-139">Para establecer explícitamente la autenticación [*Kerberos*](windows-remote-management-glossary.md) en la llamada a [**WSMan. createSession**](wsman-createsession.md), establezca la marca **WSManFlagUseKerberos** en el parámetro *Flags* .</span><span class="sxs-lookup"><span data-stu-id="fb374-139">To explicitly establish [*Kerberos*](windows-remote-management-glossary.md) authentication in the call to [**WSMan.CreateSession**](wsman-createsession.md), set the **WSManFlagUseKerberos** flag in the *flags* parameter.</span></span> <span data-ttu-id="fb374-140">Los equipos cliente y servidor deben estar Unidos a un dominio.</span><span class="sxs-lookup"><span data-stu-id="fb374-140">Both the client and the server computers must be joined to a domain.</span></span> <span data-ttu-id="fb374-141">Si usa Kerberos como método de autenticación, no puede usar una dirección IP en la llamada a [**WSMan. createSession**](wsman-createsession.md) o [**IWSMan:: createSession**](/windows/desktop/api/WSManDisp/nf-wsmandisp-iwsman-createsession).</span><span class="sxs-lookup"><span data-stu-id="fb374-141">If you use Kerberos as the authentication method, you cannot use an IP address in the call to [**WSMan.CreateSession**](wsman-createsession.md) or [**IWSMan::CreateSession**](/windows/desktop/api/WSManDisp/nf-wsmandisp-iwsman-createsession).</span></span>

## <a name="client-certificate-based-authentication"></a><span data-ttu-id="fb374-142">Autenticación basada en certificado de cliente</span><span class="sxs-lookup"><span data-stu-id="fb374-142">Client Certificate-based Authentication</span></span>

<span data-ttu-id="fb374-143">Para establecer la autenticación basada en certificados de cliente en la llamada a [**WSMan. createSession**](wsman-createsession.md), establezca la marca **WSManFlagUseClientCertificate** en el parámetro *Flags* .</span><span class="sxs-lookup"><span data-stu-id="fb374-143">To establish client certificate-based authentication in the call to [**WSMan.CreateSession**](wsman-createsession.md), set the **WSManFlagUseClientCertificate** flag in the *flags* parameter.</span></span>

<span data-ttu-id="fb374-144">En primer lugar, debe habilitar la autenticación de certificados en el cliente y el servicio mediante la herramienta de línea de comandos de WinRM.</span><span class="sxs-lookup"><span data-stu-id="fb374-144">You must first enable certificate authentication on both the client and service by using the Winrm command line tool.</span></span> <span data-ttu-id="fb374-145">Para obtener más información, vea [Habilitar opciones de autenticación](#enabling-or-disabling-authentication-options).</span><span class="sxs-lookup"><span data-stu-id="fb374-145">For more information, see [Enabling Authentication Options](#enabling-or-disabling-authentication-options).</span></span> <span data-ttu-id="fb374-146">También debe crear una entrada en la tabla CertMapping en el equipo del servidor WinRM.</span><span class="sxs-lookup"><span data-stu-id="fb374-146">You must also create an entry in the CertMapping table on the WinRM server computer.</span></span> <span data-ttu-id="fb374-147">Esto establece una asignación entre uno o varios certificados y una cuenta local.</span><span class="sxs-lookup"><span data-stu-id="fb374-147">This establishes a mapping between one or more certificates and a local account.</span></span> <span data-ttu-id="fb374-148">Una vez que se ha utilizado el certificado para la autenticación y la autorización, se usa la cuenta local correspondiente para las operaciones realizadas por el servicio WinRM.</span><span class="sxs-lookup"><span data-stu-id="fb374-148">After the certificate has been used for authentication and authorization, the corresponding local account is used for operations performed by the WinRM service.</span></span>

<span data-ttu-id="fb374-149">La asignación se puede crear para un URI de recurso específico.</span><span class="sxs-lookup"><span data-stu-id="fb374-149">The mapping can be created for a specific resource URI.</span></span> <span data-ttu-id="fb374-150">Para obtener más información, incluido cómo crear una entrada de la tabla CertMapping, escriba **WinRM Help CertMapping** en el símbolo del sistema.</span><span class="sxs-lookup"><span data-stu-id="fb374-150">To learn more, including how to create a CertMapping table entry, type **winrm help certmapping** at the command prompt.</span></span>

> [!Note]  
> <span data-ttu-id="fb374-151">El certificado de tamaño máximo que WinRM puede usar en este contexto es 16 KB.</span><span class="sxs-lookup"><span data-stu-id="fb374-151">The maximum size certificate usable by WinRM in this context is 16KB.</span></span>

 

## <a name="enabling-or-disabling-authentication-options"></a><span data-ttu-id="fb374-152">Habilitar o deshabilitar las opciones de autenticación</span><span class="sxs-lookup"><span data-stu-id="fb374-152">Enabling or Disabling Authentication Options</span></span>

<span data-ttu-id="fb374-153">La opción de autenticación predeterminada en la instalación del sistema es Kerberos.</span><span class="sxs-lookup"><span data-stu-id="fb374-153">The default authentication option at system installation is Kerberos.</span></span> <span data-ttu-id="fb374-154">Para obtener más información, vea [instalación y configuración de administración remota de Windows](installation-and-configuration-for-windows-remote-management.md).</span><span class="sxs-lookup"><span data-stu-id="fb374-154">For more information, see [Installation and Configuration for Windows Remote Management](installation-and-configuration-for-windows-remote-management.md).</span></span>

<span data-ttu-id="fb374-155">Si el script o la aplicación requieren un método de autenticación específico que no está habilitado, debe cambiar la configuración para habilitar este tipo de autenticación.</span><span class="sxs-lookup"><span data-stu-id="fb374-155">If your script or application requires a specific authentication method that is not enabled, you must change the configuration to enable this type of authentication.</span></span> <span data-ttu-id="fb374-156">Este cambio se puede realizar mediante la herramienta de línea de comandos **WinRM** o a través de directiva de grupo para el **objeto Directiva de Grupo administración remota de Windows**.</span><span class="sxs-lookup"><span data-stu-id="fb374-156">This change can be made using the **Winrm** command-line tool or through Group Policy for the **Windows Remote Management Group Policy Object**.</span></span> <span data-ttu-id="fb374-157">También puede optar por deshabilitar ciertos métodos de autenticación.</span><span class="sxs-lookup"><span data-stu-id="fb374-157">You may also choose to disable certain methods of authentication.</span></span>

<span data-ttu-id="fb374-158">**Para habilitar o deshabilitar la autenticación con la herramienta WinRM**</span><span class="sxs-lookup"><span data-stu-id="fb374-158">**To enable or disable authentication with the Winrm tool**</span></span>

1.  <span data-ttu-id="fb374-159">Para establecer la configuración del cliente WinRM, use el comando **WinRM Set** y especifique el cliente.</span><span class="sxs-lookup"><span data-stu-id="fb374-159">To set the configuration for the WinRM client, use the **Winrm Set** command and specify the client.</span></span> <span data-ttu-id="fb374-160">Por ejemplo, el siguiente comando deshabilita la autenticación implícita para el cliente.</span><span class="sxs-lookup"><span data-stu-id="fb374-160">For example, the following command disables digest authentication for the client.</span></span>

    <span data-ttu-id="fb374-161">**WinRM Set WinRM/config/Client/auth @ {Digest = "false"}**</span><span class="sxs-lookup"><span data-stu-id="fb374-161">**winrm set winrm/config/client/auth @{Digest="false"}**</span></span>

2.  <span data-ttu-id="fb374-162">Para establecer la configuración del servidor WinRM, use el comando **WinRM Set** y especifique el servicio.</span><span class="sxs-lookup"><span data-stu-id="fb374-162">To set the configuration for the WinRM server, use the **Winrm Set** command and specify the service.</span></span> <span data-ttu-id="fb374-163">Por ejemplo, el siguiente comando habilita la autenticación Kerberos para el servicio.</span><span class="sxs-lookup"><span data-stu-id="fb374-163">For example, the following command enables Kerberos authentication for the service.</span></span>

    <span data-ttu-id="fb374-164">**WinRM Set WinRM/config/Service/auth @ {Kerberos = "true"}**</span><span class="sxs-lookup"><span data-stu-id="fb374-164">**winrm set winrm/config/service/auth @{Kerberos="true"}**</span></span>

## <a name="related-topics"></a><span data-ttu-id="fb374-165">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="fb374-165">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="fb374-166">Acerca de Administración remota de Windows</span><span class="sxs-lookup"><span data-stu-id="fb374-166">About Windows Remote Management</span></span>](about-windows-remote-management.md)
</dt> <dt>

[<span data-ttu-id="fb374-167">**WSMan. CreateSession**</span><span class="sxs-lookup"><span data-stu-id="fb374-167">**WSMan.CreateSession**</span></span>](wsman-createsession.md)
</dt> <dt>

[<span data-ttu-id="fb374-168">Usar Administración remota de Windows</span><span class="sxs-lookup"><span data-stu-id="fb374-168">Using Windows Remote Management</span></span>](using-windows-remote-management.md)
</dt> </dl>

 

 




