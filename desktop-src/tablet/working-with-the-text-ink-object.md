---
description: Para ayudar a la compatibilidad con la entrada de lápiz en las aplicaciones, hay dos objetos, que se pueden incrustar y son compatibles con cualquier contenedor OLE, el objeto de entrada manuscrita de texto (tInk) y el objeto de entrada de lápiz (receptor) del boceto.
ms.assetid: 0202e91c-c7a0-4e7b-a1c6-a2f58c11c0be
title: Trabajar con el objeto de entrada manuscrita de texto
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 082323f7e67e76f7ae39c6b592a86f2be0945a86
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "105696592"
---
# <a name="working-with-the-text-ink-object"></a><span data-ttu-id="1f611-103">Trabajar con el objeto de entrada manuscrita de texto</span><span class="sxs-lookup"><span data-stu-id="1f611-103">Working with the Text Ink Object</span></span>

<span data-ttu-id="1f611-104">Para ayudar a la compatibilidad con la entrada de lápiz en las aplicaciones, hay dos objetos, que se pueden incrustar y son compatibles con cualquier contenedor OLE, el objeto de entrada manuscrita de texto (tInk) y el objeto de entrada de lápiz (receptor) del boceto.</span><span class="sxs-lookup"><span data-stu-id="1f611-104">To aid the support of ink in applications, there are two objects, both of which can be embedded and are supported by any OLE container, the text ink object (tInk) and the sketch ink object (sInk).</span></span>

<span data-ttu-id="1f611-105">El objeto de entrada manuscrita de texto es un objeto OLE que representa la tinta que se espera que forme palabras.</span><span class="sxs-lookup"><span data-stu-id="1f611-105">The text ink object is an OLE object representing ink that is expected to form words.</span></span> <span data-ttu-id="1f611-106">Un objeto de entrada manuscrita de texto permite convertir la tinta manuscrita en texto eligiendo en una lista de alternativas.</span><span class="sxs-lookup"><span data-stu-id="1f611-106">A text ink object enables the handwritten ink to be converted to text by choosing from a list of alternates.</span></span> <span data-ttu-id="1f611-107">El color y el tamaño del objeto de entrada de lápiz se pueden establecer mediante programación y se pueden basar en los atributos del texto alrededor del objeto.</span><span class="sxs-lookup"><span data-stu-id="1f611-107">The color and size of the text ink object can be set programmatically and can be based on the attributes of the text around the object.</span></span> <span data-ttu-id="1f611-108">El objeto de entrada de lápiz de texto está diseñado para que contenga una sola palabra.</span><span class="sxs-lookup"><span data-stu-id="1f611-108">The text ink object is intended to contain a single word.</span></span>

<span data-ttu-id="1f611-109">El objeto de entrada manuscrita de texto admite el conjunto estándar de interfaces OLE necesarias para la incrustación y la compatibilidad con el portapapeles.</span><span class="sxs-lookup"><span data-stu-id="1f611-109">The text ink object supports the standard set of OLE interfaces required for embedding and clipboard support.</span></span> <span data-ttu-id="1f611-110">La interfaz [**IPersistStream**](/windows/win32/api/objidl/nn-objidl-ipersiststream) Lee y escribe en una secuencia en formato serializado de tinta (ISF).</span><span class="sxs-lookup"><span data-stu-id="1f611-110">The [**IPersistStream**](/windows/win32/api/objidl/nn-objidl-ipersiststream) interface reads from and writes to a stream in ink serialized format (ISF).</span></span> <span data-ttu-id="1f611-111">El objeto de entrada manuscrita de texto proporciona la interfaz [**IInkLineInfo**](/windows/desktop/api/msinkaut/nn-msinkaut-iinklineinfo) para tener acceso a sus propiedades de presentación y a la lista de resultados de reconocimiento.</span><span class="sxs-lookup"><span data-stu-id="1f611-111">The text ink object provides the [**IInkLineInfo**](/windows/desktop/api/msinkaut/nn-msinkaut-iinklineinfo) interface to access its display properties, and recognition result list.</span></span>

<span data-ttu-id="1f611-112">El objeto de entrada manuscrita de texto se puede usar para la interoperabilidad entre aplicaciones, ya sea colocándolo en la ranura del objeto OLE del portapapeles, mediante la inserción en formato RTF o su persistencia en una secuencia ISF.</span><span class="sxs-lookup"><span data-stu-id="1f611-112">The text ink object can be used for interoperability between applications either by placing it in the OLE object slot on the Clipboard, by embedding it in RTF, or by persisting it in an ISF stream.</span></span>

<span data-ttu-id="1f611-113">Se puede generar un objeto de entrada de lápiz de texto de las siguientes maneras.</span><span class="sxs-lookup"><span data-stu-id="1f611-113">A text ink object can be generated in the following ways.</span></span>

-   <span data-ttu-id="1f611-114">El control [InkEdit](inkedit-control-reference.md) usa el objeto de entrada manuscrita de texto.</span><span class="sxs-lookup"><span data-stu-id="1f611-114">The [InkEdit](inkedit-control-reference.md) control makes use of the text ink object.</span></span> <span data-ttu-id="1f611-115">La funcionalidad del control InkEdit es un superconjunto de la funcionalidad del control RichEdit estándar.</span><span class="sxs-lookup"><span data-stu-id="1f611-115">The InkEdit control's functionality is a super-set of the standard RichEdit control functionality.</span></span> <span data-ttu-id="1f611-116">La entrada de lápiz se inserta en el flujo RTF del control InkEdit como un objeto de entrada manuscrita de texto.</span><span class="sxs-lookup"><span data-stu-id="1f611-116">Ink is inserted into the InkEdit control's RTF stream as a text ink object.</span></span>
-   <span data-ttu-id="1f611-117">Cuando una aplicación copia un objeto [InkStrokes](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) o [InkEdit](inkedit-control-reference.md) en el portapapeles y se establece el formato de [**enumeración InkClipboardFormats**](/windows/desktop/api/msinkaut/ne-msinkaut-inkclipboardformats) , la ranura del portapapeles OLE contiene un objeto OLE de entrada manuscrita.</span><span class="sxs-lookup"><span data-stu-id="1f611-117">When an application copies an [InkStrokes](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) or an [InkEdit](inkedit-control-reference.md) object onto the Clipboard and the [**InkClipboardFormats Enumeration**](/windows/desktop/api/msinkaut/ne-msinkaut-inkclipboardformats) format is set, the OLE object Clipboard slot contains a text ink OLE object.</span></span>
-   <span data-ttu-id="1f611-118">El panel de entrada de Tablet PC puede generar objetos de texto manuscrito.</span><span class="sxs-lookup"><span data-stu-id="1f611-118">Tablet PC Input Panel can generate text ink objects.</span></span>

<span data-ttu-id="1f611-119">Por ejemplo, la aplicación puede reconocer la escritura a mano y agregar el resultado del reconocimiento a los trazos.</span><span class="sxs-lookup"><span data-stu-id="1f611-119">For example, your application can recognize handwriting and add the recognition result to the strokes.</span></span> <span data-ttu-id="1f611-120">Después, si copia y pega los trazos en Microsoft Word como un objeto de entrada de lápiz de texto, las alternativas para esa palabra estarán disponibles en Word 2003 y versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="1f611-120">Then, if you copy and paste the strokes to Microsoft Word as a text ink object, alternates for that word is available in Word 2003 and later versions.</span></span>

<span data-ttu-id="1f611-121">Para contener correctamente objetos de entrada de lápiz de texto, una aplicación debe implementar la compatibilidad con contenedores OLE para los objetos incrustados.</span><span class="sxs-lookup"><span data-stu-id="1f611-121">In order to successfully contain text ink objects, an application must implement OLE container support for embedded objects.</span></span> <span data-ttu-id="1f611-122">A continuación, para que el contenedor sea totalmente compatible con la tinta de texto, debe establecer lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="1f611-122">Then, to make the container fully support text ink, you must institute:</span></span>

-   <span data-ttu-id="1f611-123">Modificaciones en la aplicación para buscar y reemplazar.</span><span class="sxs-lookup"><span data-stu-id="1f611-123">Modifications to the application for Find and Replace.</span></span> <span data-ttu-id="1f611-124">En lugar de omitir los objetos incrustados en la búsqueda, estos objetos se deben interrogar para el tipo.</span><span class="sxs-lookup"><span data-stu-id="1f611-124">Instead of skipping embedded objects in the search, these objects must be interrogated for type.</span></span> <span data-ttu-id="1f611-125">Si se trata de un objeto de entrada manuscrita de texto, se les debe crear una instancia y consultar su texto correspondiente.</span><span class="sxs-lookup"><span data-stu-id="1f611-125">If they are a text ink object, they must be instantiated and queried for their corresponding text.</span></span>
-   <span data-ttu-id="1f611-126">Modificaciones en el comportamiento de la selección.</span><span class="sxs-lookup"><span data-stu-id="1f611-126">Modifications to selection behavior.</span></span> <span data-ttu-id="1f611-127">La selección de los objetos de lápiz de texto nunca debe aparecer con los controladores de tamaño.</span><span class="sxs-lookup"><span data-stu-id="1f611-127">Selection of text ink objects should never appear with sizing handles.</span></span> <span data-ttu-id="1f611-128">Deben seleccionarse de la misma manera en que se selecciona texto en el documento.</span><span class="sxs-lookup"><span data-stu-id="1f611-128">They should be selected in the same way that text is selected in the document.</span></span> <span data-ttu-id="1f611-129">El código de selección de los objetos debe detectar si el tipo es una entrada de lápiz de texto y mostrar la selección adecuadamente.</span><span class="sxs-lookup"><span data-stu-id="1f611-129">Selection code for objects must detect if the type is text ink and display the selection appropriately.</span></span>
-   <span data-ttu-id="1f611-130">Uso de propiedades de ambiente.</span><span class="sxs-lookup"><span data-stu-id="1f611-130">Use of ambient properties.</span></span> <span data-ttu-id="1f611-131">Las propiedades de ambiente como el tamaño de fuente, el color y el formato de negrita deben transmitirse al objeto de entrada manuscrita de texto.</span><span class="sxs-lookup"><span data-stu-id="1f611-131">Ambient properties such as font size, color, and bold formatting need to be transmitted to the text ink object.</span></span> <span data-ttu-id="1f611-132">La aplicación de estas propiedades cambia el ancho de la tinta manuscrita, por lo que se requiere una actualización del tamaño llamando al método [**IInkLineInfo:: GetInkExtent**](/windows/desktop/api/msinkaut/nf-msinkaut-iinklineinfo-getinkextent) o [**IOleObject:: GetExtent**](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) .</span><span class="sxs-lookup"><span data-stu-id="1f611-132">Application of these properties changes the width of the handwritten ink, so a size update is required by calling the [**IInkLineInfo::GetInkExtent**](/windows/desktop/api/msinkaut/nf-msinkaut-iinklineinfo-getinkextent) or [**IOleObject::GetExtent**](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) method.</span></span>

## <a name="in-this-section"></a><span data-ttu-id="1f611-133">En esta sección</span><span class="sxs-lookup"><span data-stu-id="1f611-133">In This Section</span></span>

-   [<span data-ttu-id="1f611-134">Convertir un objeto de entrada de lápiz de texto en tinta</span><span class="sxs-lookup"><span data-stu-id="1f611-134">Converting a Text Ink Object to Ink</span></span>](converting-a-text-ink-object-to-ink.md)
-   [<span data-ttu-id="1f611-135">API de entrada manuscrita de texto</span><span class="sxs-lookup"><span data-stu-id="1f611-135">Text Ink APIs</span></span>](text-ink-apis.md)
-   [<span data-ttu-id="1f611-136">Objetos sInk y tInk</span><span class="sxs-lookup"><span data-stu-id="1f611-136">sInk and tInk Objects</span></span>](sink-and-tink-objects.md)

 

 
