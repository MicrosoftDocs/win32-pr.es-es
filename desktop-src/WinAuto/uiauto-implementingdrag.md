---
title: Arrastrar patrón de control
description: Proporciona directrices y convenciones para implementar el patrón de control de arrastre mediante IDragProvider, incluida información sobre propiedades y métodos. El patrón de control arrastrar se usa para admitir controles arrastrables o controles con elementos arrastrables.
ms.assetid: 9853E9CB-D04B-4F67-8E9E-7F1F99BACEA7
keywords:
- Automatización de la interfaz de usuario, implementar el patrón de control arrastrar
- Automatización de la interfaz de usuario, arrastrar patrón de control
- Automatización de la interfaz de usuario, IDragProvider
- IDragProvider
- implementar patrones de control de arrastre de automatización de la interfaz de usuario
- Arrastrar patrones de control
- patrones de control, IDragProvider
- patrones de control, implementar la automatización de la interfaz de usuario
- patrones de control, arrastrar
- interfaces, IDragProvider
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 548f0212eca37e1890596143f27e9af70e1fb19a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104077973"
---
# <a name="drag-control-pattern"></a><span data-ttu-id="bbaad-114">Arrastrar patrón de control</span><span class="sxs-lookup"><span data-stu-id="bbaad-114">Drag Control Pattern</span></span>

<span data-ttu-id="bbaad-115">Proporciona directrices y convenciones para implementar el patrón de control de **arrastre** mediante [**IDragProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider), incluida información sobre propiedades y métodos.</span><span class="sxs-lookup"><span data-stu-id="bbaad-115">Provides guidelines and conventions for implementing the **Drag** control pattern by using [**IDragProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider), including information about properties and methods.</span></span> <span data-ttu-id="bbaad-116">El patrón de control **arrastrar** se usa para admitir controles arrastrables o controles con elementos arrastrables.</span><span class="sxs-lookup"><span data-stu-id="bbaad-116">The **Drag** control pattern is used to support draggable controls, or controls with draggable items.</span></span>

## <a name="implementation-guidelines-and-conventions"></a><span data-ttu-id="bbaad-117">Directrices y convenciones de implementación</span><span class="sxs-lookup"><span data-stu-id="bbaad-117">Implementation Guidelines and Conventions</span></span>

<span data-ttu-id="bbaad-118">Al implementar el patrón de control de **arrastre** , use estas directrices y convenciones:</span><span class="sxs-lookup"><span data-stu-id="bbaad-118">When implementing the **Drag** control pattern, use these guidelines and conventions:</span></span>

-   <span data-ttu-id="bbaad-119">La interfaz [**IDragProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) admite dos estilos de arrastre diferentes: el estilo de origen y destino, y el estilo de solo origen.</span><span class="sxs-lookup"><span data-stu-id="bbaad-119">The [**IDragProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) interface supports two different dragging styles: the source/target style, and the source-only style.</span></span> <span data-ttu-id="bbaad-120">Debe elegir el estilo que mejor se adapte a los escenarios de arrastrar y colocar:</span><span class="sxs-lookup"><span data-stu-id="bbaad-120">You need to choose the style that works best for your drag-and-drop scenarios:</span></span>
    -   <span data-ttu-id="bbaad-121">**Estilo de origen/destino:** Cada posible destino de colocación se representa mediante un elemento que implementa la interfaz [**IDropTargetProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idroptargetprovider) .</span><span class="sxs-lookup"><span data-stu-id="bbaad-121">**Source/target style:** Each possible drop target is represented by an element that implements the [**IDropTargetProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idroptargetprovider) interface.</span></span> <span data-ttu-id="bbaad-122">Durante una operación de arrastre, los eventos de automatización de la interfaz de usuario de Microsoft se originan a partir del elemento que se está arrastrando y de los elementos de destino.</span><span class="sxs-lookup"><span data-stu-id="bbaad-122">During a drag operation, Microsoft UI Automation events originate from the element that is being dragged, and from the drop-target elements.</span></span>
    -   <span data-ttu-id="bbaad-123">**Estilo de solo origen:** Los destinos de colocación no se representan mediante elementos de automatización de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="bbaad-123">**Source-only style:** Drop targets are not represented by UI Automation elements.</span></span> <span data-ttu-id="bbaad-124">Durante una operación de arrastre, los eventos solo se originan desde el elemento que se está arrastrando.</span><span class="sxs-lookup"><span data-stu-id="bbaad-124">During a drag operation, events originate only from the element that is being dragged.</span></span>
-   <span data-ttu-id="bbaad-125">[**IDragProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) es una interfaz de solo lectura diseñada para la supervisión de operaciones de arrastre.</span><span class="sxs-lookup"><span data-stu-id="bbaad-125">[**IDragProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) is a read-only interface intended for monitoring drag operations.</span></span> <span data-ttu-id="bbaad-126">No se puede utilizar para controlar una operación de arrastre.</span><span class="sxs-lookup"><span data-stu-id="bbaad-126">You cannot use it to control a drag operation.</span></span> <span data-ttu-id="bbaad-127">Puede automatizar las operaciones de arrastre enviando la entrada del mouse a un control.</span><span class="sxs-lookup"><span data-stu-id="bbaad-127">You can automate drag operations by sending mouse input to a control.</span></span>
-   <span data-ttu-id="bbaad-128">La propiedad [**IDragProvider:: IsGrabbed**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed) es obligatoria.</span><span class="sxs-lookup"><span data-stu-id="bbaad-128">The [**IDragProvider::IsGrabbed**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed) property is required.</span></span>
-   <span data-ttu-id="bbaad-129">Las propiedades [**IDragProvider::D ropeffect**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffect) y [**IDragProvider::D ropeffects**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffects) son necesarias para una implementación de estilo de solo origen y están prohibidas para una implementación de estilo de origen/destino.</span><span class="sxs-lookup"><span data-stu-id="bbaad-129">The [**IDragProvider::DropEffect**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffect) and [**IDragProvider::DropEffects**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffects) properties are required for a source-only style implementation, and prohibited for a source/target style implementation.</span></span> <span data-ttu-id="bbaad-130">En una implementación de estilo de origen/destino, se pueden consultar los elementos de destino de colocación para sus efectos de colocación.</span><span class="sxs-lookup"><span data-stu-id="bbaad-130">In a source/target style implementation, drop-target elements can be queried for their drop effects.</span></span>
-   <span data-ttu-id="bbaad-131">La propiedad [**IDragProvider:: GrabbedItems**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-getgrabbeditems) representa el arrastre de varios elementos.</span><span class="sxs-lookup"><span data-stu-id="bbaad-131">The [**IDragProvider::GrabbedItems**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-getgrabbeditems) property represents the dragging of multiple items.</span></span> <span data-ttu-id="bbaad-132">Cuando el usuario inicia la operación de arrastre, debe crear un nuevo elemento de automatización de la interfaz de usuario para actuar como el elemento de origen del evento.</span><span class="sxs-lookup"><span data-stu-id="bbaad-132">When the user begins the drag operation, you need to create a new UI Automation element to serve as the event source element.</span></span> <span data-ttu-id="bbaad-133">Este nuevo elemento activa todos los eventos que el elemento de origen habría desencadenado en el modo de origen/destino o de solo origen, mientras que ninguno de los elementos que se arrastran realmente activa cualquier evento.</span><span class="sxs-lookup"><span data-stu-id="bbaad-133">This new element fires all events that the source element would have fired in either the source/target or source-only mode, while none of the elements that are actually being dragged fire any events.</span></span> <span data-ttu-id="bbaad-134">Una vez completada la operación de arrastre, destruya el elemento de origen del evento.</span><span class="sxs-lookup"><span data-stu-id="bbaad-134">When the drag operation is complete, destroy the event source element.</span></span>
-   <span data-ttu-id="bbaad-135">El elemento debe desencadenar eventos de cambio de propiedad para las propiedades **DropEffect** ([**UIA \_ DragDropEffectPropertyId**](uiauto-control-pattern-propids.md)) y **DropEffects** ([**UIA \_ DragDropEffectsPropertyId**](uiauto-control-pattern-propids.md)) cuando cambian.</span><span class="sxs-lookup"><span data-stu-id="bbaad-135">The element must fire property-changed events for the **DropEffect** ([**UIA\_DragDropEffectPropertyId**](uiauto-control-pattern-propids.md)) and **DropEffects** ([**UIA\_DragDropEffectsPropertyId**](uiauto-control-pattern-propids.md)) properties when they change.</span></span> <span data-ttu-id="bbaad-136">Se permiten eventos de cambio de propiedad para las demás propiedades, pero se pueden inferir a partir de los eventos **DragStart** ([**UIA \_ Drag \_ DragStartEventId**](uiauto-event-ids.md)), **DragCancel** ([**UIA \_ Drag \_ DragCancelEventId**](uiauto-event-ids.md)) y **DragComplete** ([**UIA \_ Drag \_ DragCompleteEventId**](uiauto-event-ids.md)) necesarios.</span><span class="sxs-lookup"><span data-stu-id="bbaad-136">Property-changed events for the other properties are allowed, but can be inferred from the required **DragStart** ([**UIA\_Drag\_DragStartEventId**](uiauto-event-ids.md)), **DragCancel** ([**UIA\_Drag\_DragCancelEventId**](uiauto-event-ids.md)), and **DragComplete** ([**UIA\_Drag\_DragCompleteEventId**](uiauto-event-ids.md)) events.</span></span>
-   

## <a name="required-members-for-idragprovider"></a><span data-ttu-id="bbaad-137">Miembros requeridos para **IDragProvider**</span><span class="sxs-lookup"><span data-stu-id="bbaad-137">Required Members for **IDragProvider**</span></span>

<span data-ttu-id="bbaad-138">Se requieren las siguientes propiedades y métodos para implementar la interfaz [**IDragProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider) .</span><span class="sxs-lookup"><span data-stu-id="bbaad-138">The following properties and methods are required for implementing the [**IDragProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider) interface.</span></span>



| <span data-ttu-id="bbaad-139">Miembros requeridos</span><span class="sxs-lookup"><span data-stu-id="bbaad-139">Required members</span></span>                                                                        | <span data-ttu-id="bbaad-140">Tipo de miembro</span><span class="sxs-lookup"><span data-stu-id="bbaad-140">Member type</span></span> | <span data-ttu-id="bbaad-141">Notas</span><span class="sxs-lookup"><span data-stu-id="bbaad-141">Notes</span></span>                                                                         |
|-----------------------------------------------------------------------------------------|-------------|-------------------------------------------------------------------------------|
| [<span data-ttu-id="bbaad-142">**IsGrabbed**</span><span class="sxs-lookup"><span data-stu-id="bbaad-142">**IsGrabbed**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed)                                     | <span data-ttu-id="bbaad-143">Propiedad</span><span class="sxs-lookup"><span data-stu-id="bbaad-143">Property</span></span>    | <span data-ttu-id="bbaad-144">None</span><span class="sxs-lookup"><span data-stu-id="bbaad-144">None</span></span>                                                                          |
| [<span data-ttu-id="bbaad-145">**DropEffect**</span><span class="sxs-lookup"><span data-stu-id="bbaad-145">**DropEffect**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffect)                                   | <span data-ttu-id="bbaad-146">Propiedad</span><span class="sxs-lookup"><span data-stu-id="bbaad-146">Property</span></span>    | <span data-ttu-id="bbaad-147">Se requiere para una implementación del estilo de solo origen.</span><span class="sxs-lookup"><span data-stu-id="bbaad-147">Required for an implementation of the source-only style.</span></span>                      |
| [<span data-ttu-id="bbaad-148">**DropEffects**</span><span class="sxs-lookup"><span data-stu-id="bbaad-148">**DropEffects**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffects)                                 | <span data-ttu-id="bbaad-149">Propiedad</span><span class="sxs-lookup"><span data-stu-id="bbaad-149">Property</span></span>    | <span data-ttu-id="bbaad-150">Obligatorio si hay más de un posible efecto de colocar para el elemento capturado.</span><span class="sxs-lookup"><span data-stu-id="bbaad-150">Required if there is more than one possible drop effect for the grabbed item.</span></span> |
| [<span data-ttu-id="bbaad-151">**GetGrabbedItems**</span><span class="sxs-lookup"><span data-stu-id="bbaad-151">**GetGrabbedItems**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-getgrabbeditems)                         | <span data-ttu-id="bbaad-152">Método</span><span class="sxs-lookup"><span data-stu-id="bbaad-152">Method</span></span>      | <span data-ttu-id="bbaad-153">Se requiere para una operación de arrastre de varios elementos.</span><span class="sxs-lookup"><span data-stu-id="bbaad-153">Required for a multiple-item drag operation.</span></span>                                  |
| [<span data-ttu-id="bbaad-154">**UIA \_ arrastrar \_ DragStartEventId**</span><span class="sxs-lookup"><span data-stu-id="bbaad-154">**UIA\_Drag\_DragStartEventId**</span></span>](uiauto-event-ids.md)       | <span data-ttu-id="bbaad-155">Evento</span><span class="sxs-lookup"><span data-stu-id="bbaad-155">Event</span></span>       | <span data-ttu-id="bbaad-156">None</span><span class="sxs-lookup"><span data-stu-id="bbaad-156">None</span></span>                                                                          |
| [<span data-ttu-id="bbaad-157">**UIA \_ arrastrar \_ DragCancelEventId**</span><span class="sxs-lookup"><span data-stu-id="bbaad-157">**UIA\_Drag\_DragCancelEventId**</span></span>](uiauto-event-ids.md)     | <span data-ttu-id="bbaad-158">Evento</span><span class="sxs-lookup"><span data-stu-id="bbaad-158">Event</span></span>       | <span data-ttu-id="bbaad-159">None</span><span class="sxs-lookup"><span data-stu-id="bbaad-159">None</span></span>                                                                          |
| [<span data-ttu-id="bbaad-160">**UIA \_ arrastrar \_ DragCompleteEventId**</span><span class="sxs-lookup"><span data-stu-id="bbaad-160">**UIA\_Drag\_DragCompleteEventId**</span></span>](uiauto-event-ids.md) | <span data-ttu-id="bbaad-161">Evento</span><span class="sxs-lookup"><span data-stu-id="bbaad-161">Event</span></span>       | <span data-ttu-id="bbaad-162">None</span><span class="sxs-lookup"><span data-stu-id="bbaad-162">None</span></span>                                                                          |



 

## <a name="related-topics"></a><span data-ttu-id="bbaad-163">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="bbaad-163">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="bbaad-164">Tipos de control y sus patrones de control admitidos</span><span class="sxs-lookup"><span data-stu-id="bbaad-164">Control Types and their Supported Control Patterns</span></span>](uiauto-controlpatternmapping.md)
</dt> <dt>

[<span data-ttu-id="bbaad-165">Patrón de control DropTarget</span><span class="sxs-lookup"><span data-stu-id="bbaad-165">DropTarget Control Pattern</span></span>](/windows/desktop/WinAuto/uiauto-implementingdroptarget)
</dt> <dt>

[<span data-ttu-id="bbaad-166">Información general acerca de los patrones de control de UI Automation</span><span class="sxs-lookup"><span data-stu-id="bbaad-166">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="bbaad-167">Información general sobre el árbol de la UI Automation</span><span class="sxs-lookup"><span data-stu-id="bbaad-167">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)
</dt> <dt>

[<span data-ttu-id="bbaad-168">Compatibilidad de UI Automation para arrastrar y colocar</span><span class="sxs-lookup"><span data-stu-id="bbaad-168">UI Automation Support for Drag-and-Drop</span></span>](ui-automation-support-for-drag-and-drop.md)
</dt> </dl>

 

 