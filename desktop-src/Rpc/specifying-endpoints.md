---
title: Especificar puntos de conexión
description: Especificar puntos de conexión conocidos y dinámicos en llamada a procedimiento remoto (RPC).
ms.assetid: fc39b527-11e6-45a7-b3b5-8bcf469633d8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 373fb2818dd14670f5a939aa524c81fcdb05e20b
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "105651378"
---
# <a name="specifying-endpoints"></a><span data-ttu-id="244a3-103">Especificar puntos de conexión</span><span class="sxs-lookup"><span data-stu-id="244a3-103">Specifying Endpoints</span></span>

<span data-ttu-id="244a3-104">Un punto de conexión es una dirección específica de la red de un proceso de servidor para llamadas a procedimientos remotos.</span><span class="sxs-lookup"><span data-stu-id="244a3-104">An endpoint is a network-specific address of a server process for remote procedure calls.</span></span> <span data-ttu-id="244a3-105">El nombre real del punto de conexión depende de la secuencia de protocolos utilizada.</span><span class="sxs-lookup"><span data-stu-id="244a3-105">The actual name of the endpoint depends on the protocol sequence used.</span></span> <span data-ttu-id="244a3-106">Por ejemplo, TCP, UDP y puertos de uso HTTP.</span><span class="sxs-lookup"><span data-stu-id="244a3-106">For example, TCP, UDP, and HTTP use ports.</span></span> <span data-ttu-id="244a3-107">Las canalizaciones con nombre usan un nombre de canalización con nombre.</span><span class="sxs-lookup"><span data-stu-id="244a3-107">Named pipes uses a named pipe name.</span></span> <span data-ttu-id="244a3-108">Las aplicaciones cliente/servidor pueden usar un punto de conexión bien conocido o un punto de conexión dinámico.</span><span class="sxs-lookup"><span data-stu-id="244a3-108">Client/server applications can use a well-known endpoint or a dynamic endpoint.</span></span> <span data-ttu-id="244a3-109">En esta sección se presentan las técnicas que los programas de servidor usan para especificar puntos de conexión conocidos y dinámicos.</span><span class="sxs-lookup"><span data-stu-id="244a3-109">This section presents the techniques that server programs use to specify well-known and dynamic endpoints.</span></span> <span data-ttu-id="244a3-110">La información se describe en los temas siguientes:</span><span class="sxs-lookup"><span data-stu-id="244a3-110">The information is discussed in the following topics:</span></span>

-   [<span data-ttu-id="244a3-111">Especificar puntos de conexión conocidos</span><span class="sxs-lookup"><span data-stu-id="244a3-111">Specifying Well-known Endpoints</span></span>](#specifying-well-known-endpoints)
-   [<span data-ttu-id="244a3-112">Especificar puntos de conexión dinámicos</span><span class="sxs-lookup"><span data-stu-id="244a3-112">Specifying Dynamic Endpoints</span></span>](#specifying-dynamic-endpoints)

## <a name="specifying-well-known-endpoints"></a><span data-ttu-id="244a3-113">Especificar puntos de conexión conocidos</span><span class="sxs-lookup"><span data-stu-id="244a3-113">Specifying Well-known Endpoints</span></span>

<span data-ttu-id="244a3-114">Cuando el servidor usa un punto de conexión conocido, puede incluir los datos del punto de conexión como parte de su entrada de base de datos del servicio de nombres.</span><span class="sxs-lookup"><span data-stu-id="244a3-114">When your server uses a well-known endpoint, it can include the endpoint data as part of its name service database entry.</span></span> <span data-ttu-id="244a3-115">Si es así, el identificador de enlace del cliente contiene una dirección de servidor completa que incluye el punto de conexión conocido cuando el cliente importa el identificador de enlace desde la entrada del servidor.</span><span class="sxs-lookup"><span data-stu-id="244a3-115">If it does, the client's binding handle contains a complete server address that includes the well-known endpoint when the client imports the binding handle from the server entry.</span></span>

<span data-ttu-id="244a3-116">El programa del servidor también puede especificar puntos de conexión conocidos al mismo tiempo que especifica secuencias de protocolos.</span><span class="sxs-lookup"><span data-stu-id="244a3-116">Your server program can also specify well-known endpoints at the same time it specifies protocol sequences.</span></span> <span data-ttu-id="244a3-117">Invocar la función [**RpcServerUseProtseqEp**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqep) o [**RpcServerUseProtseqEpEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqepex) .</span><span class="sxs-lookup"><span data-stu-id="244a3-117">Invoke either the [**RpcServerUseProtseqEp**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqep) or [**RpcServerUseProtseqEpEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqepex) function.</span></span> <span data-ttu-id="244a3-118">La diferencia entre ambos es que la última función tiene un parámetro adicional que el servidor puede usar para controlar la asignación dinámica de puertos.</span><span class="sxs-lookup"><span data-stu-id="244a3-118">The difference between the two is that the latter function has an extra parameter your server can use to control dynamic port allocation.</span></span>

<span data-ttu-id="244a3-119">Si el programa de servidor especifica su información de punto de conexión de esta manera, también debe llamar a la función [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) para registrar el punto de conexión en la asignación de punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="244a3-119">If your server program specifies its endpoint information in this way, it should also call the [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) function to register the endpoint in the endpoint map.</span></span> <span data-ttu-id="244a3-120">Aunque el punto de conexión siempre es el mismo, el cliente puede usar la asignación de punto de conexión para buscar el servidor.</span><span class="sxs-lookup"><span data-stu-id="244a3-120">Even though the endpoint is always the same, the client may use the endpoint map to find the server.</span></span>

<span data-ttu-id="244a3-121">Al igual que las secuencias de protocolo, una aplicación puede especificar información de punto de conexión en su archivo IDL.</span><span class="sxs-lookup"><span data-stu-id="244a3-121">Like protocol sequences, an application can specify endpoint information in its IDL file.</span></span> <span data-ttu-id="244a3-122">Cuando lo hace, debe registrar las secuencias de protocolos y los puntos de conexión al mismo tiempo mediante la invocación de la función [**RpcServerUseAllProtseqsIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsif) o [**RpcServerUseAllProtseqsIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsifex) .</span><span class="sxs-lookup"><span data-stu-id="244a3-122">When it does, it should register both the protocol sequences and endpoints at the same time by invoking the [**RpcServerUseAllProtseqsIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsif) or [**RpcServerUseAllProtseqsIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsifex) function.</span></span> <span data-ttu-id="244a3-123">En este caso, el cliente tiene acceso a la información del punto de conexión a través de la especificación de interfaz en el archivo IDL.</span><span class="sxs-lookup"><span data-stu-id="244a3-123">In this case, the client has access to the endpoint information through the interface specification in the IDL file.</span></span> <span data-ttu-id="244a3-124">Por lo tanto, no es necesario llamar a la función [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) .</span><span class="sxs-lookup"><span data-stu-id="244a3-124">Therefore, it is not necessary to call the [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) function.</span></span>

## <a name="specifying-dynamic-endpoints"></a><span data-ttu-id="244a3-125">Especificar puntos de conexión dinámicos</span><span class="sxs-lookup"><span data-stu-id="244a3-125">Specifying Dynamic Endpoints</span></span>

<span data-ttu-id="244a3-126">Un extremo dinámico es un punto de conexión que el equipo host del servidor asigna cuando el servidor inicia la ejecución.</span><span class="sxs-lookup"><span data-stu-id="244a3-126">A dynamic endpoint is an endpoint that the server host computer assigns when the server begins execution.</span></span> <span data-ttu-id="244a3-127">La mayoría de las aplicaciones de servidor usan puntos de conexión dinámicos para evitar conflictos con otros programas en el número limitado de puertos que están disponibles en el sistema del equipo host del servidor.</span><span class="sxs-lookup"><span data-stu-id="244a3-127">Most server applications use dynamic endpoints to avoid conflict with other programs over the limited number of ports that are available on the server host computer system.</span></span> <span data-ttu-id="244a3-128">Sin embargo, los programas que utilizan canalizaciones con nombre o la secuencia del protocolo [**ncalrpc**](/windows/desktop/Midl/ncalrpc) tienen un espacio de nombres de punto de conexión muy grande.</span><span class="sxs-lookup"><span data-stu-id="244a3-128">However, programs using named pipes or the [**ncalrpc**](/windows/desktop/Midl/ncalrpc) protocol sequence have a very large endpoint name space.</span></span> <span data-ttu-id="244a3-129">Aprovechan menos puntos de conexión dinámicos que los programas que usan otros transportes.</span><span class="sxs-lookup"><span data-stu-id="244a3-129">They benefit less from dynamic endpoints than programs using other transports.</span></span>

<span data-ttu-id="244a3-130">Los programas de servidor registran puntos de conexión dinámicos en una base de datos de asignación de extremos.</span><span class="sxs-lookup"><span data-stu-id="244a3-130">Server programs register dynamic endpoints in an endpoint map database.</span></span> <span data-ttu-id="244a3-131">Si desea que el servidor use cualquier punto de conexión disponible, llame a [**RpcServerUseAllProtSeqs**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqs), [**RpcServerUseAllProtseqsEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsex), [**RpcServerUseProtseq**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseq) o [**RpcServerUseProtseqEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqex).</span><span class="sxs-lookup"><span data-stu-id="244a3-131">If you want the server to use any available endpoint, call [**RpcServerUseAllProtSeqs**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqs), [**RpcServerUseAllProtseqsEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsex), [**RpcServerUseProtseq**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseq) or [**RpcServerUseProtseqEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqex).</span></span> <span data-ttu-id="244a3-132">Esto establece la biblioteca en tiempo de ejecución de RPC para usar todas o una secuencia de protocolo válida con puntos de conexión dinámicos.</span><span class="sxs-lookup"><span data-stu-id="244a3-132">This sets the RPC run-time library to use all or one valid protocol sequence(s) with dynamic endpoints.</span></span> <span data-ttu-id="244a3-133">A continuación, el servidor debe llamar a [**RpcServerInqBindings**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverinqbindings) para obtener un conjunto de identificadores de enlace válidos.</span><span class="sxs-lookup"><span data-stu-id="244a3-133">The server should then call [**RpcServerInqBindings**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverinqbindings) to obtain a set of valid binding handles.</span></span> <span data-ttu-id="244a3-134">El servidor pasa el conjunto de identificadores de enlace, o vector de enlace, a la función [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) para registrar todos los extremos adecuados en la asignación de extremo.</span><span class="sxs-lookup"><span data-stu-id="244a3-134">The server passes the set of binding handles, or binding vector, to the function [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) to register all suitable endpoints in the endpoint map.</span></span> <span data-ttu-id="244a3-135">Para cada llamada que el servidor realiza a **RpcEpRegister**, debe haber una llamada correspondiente a [**RpcBindingVectorFree**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingvectorfree) para liberar la memoria que usa el vector de enlace.</span><span class="sxs-lookup"><span data-stu-id="244a3-135">For each call your server makes to **RpcEpRegister**, there should be a corresponding call to [**RpcBindingVectorFree**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingvectorfree) to release the memory that the binding vector uses.</span></span>

<span data-ttu-id="244a3-136">Tenga en cuenta que los programas de servidor pueden usar la función [**RpcEpRegisterNoReplace**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregisternoreplace) en lugar de [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister).</span><span class="sxs-lookup"><span data-stu-id="244a3-136">Note that server programs can use the [**RpcEpRegisterNoReplace**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregisternoreplace) function rather than [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister).</span></span> <span data-ttu-id="244a3-137">Los programas suelen usar **RpcEpRegisterNoReplace** cuando se deben ejecutar varias copias de un programa de servidor en un sistema host de servidor.</span><span class="sxs-lookup"><span data-stu-id="244a3-137">Programs typically use **RpcEpRegisterNoReplace** when multiple copies of a server program must run on a server host system.</span></span>

<span data-ttu-id="244a3-138">Las funciones [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) y [**RpcEpRegisterNoReplace**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregisternoreplace) agregan las interfaces y los identificadores de enlace del servidor a la base de datos del asignador de extremos.</span><span class="sxs-lookup"><span data-stu-id="244a3-138">Both the [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) and [**RpcEpRegisterNoReplace**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregisternoreplace) functions add the server's interfaces and binding handles to the endpoint mapper database.</span></span> <span data-ttu-id="244a3-139">Cuando el cliente realiza una llamada a procedimiento remoto mediante un identificador de enlace parcial, la biblioteca en tiempo de ejecución del cliente pide al asignador de extremos del equipo servidor el extremo de una instancia de servidor compatible.</span><span class="sxs-lookup"><span data-stu-id="244a3-139">When the client makes a remote procedure call using a partially bound handle, the client's run-time library asks the server computer's endpoint mapper for the endpoint of a compatible server instance.</span></span> <span data-ttu-id="244a3-140">La biblioteca cliente proporciona el UUID de la interfaz, la secuencia del protocolo y, si está presente, el UUID del objeto en el identificador de enlace del cliente.</span><span class="sxs-lookup"><span data-stu-id="244a3-140">The client library supplies the interface UUID, protocol sequence, and, if present, the object UUID in the client binding handle.</span></span> <span data-ttu-id="244a3-141">El asignador de extremos busca una entrada de base de datos que coincida con la información del cliente.</span><span class="sxs-lookup"><span data-stu-id="244a3-141">The endpoint mapper looks for a database entry that matches the client's information.</span></span> <span data-ttu-id="244a3-142">El UUID de la interfaz cliente/servidor, la versión principal de la interfaz y la secuencia del protocolo deben coincidir exactamente.</span><span class="sxs-lookup"><span data-stu-id="244a3-142">The client/server interface UUID, the interface major version, and protocol sequence must all match exactly.</span></span> <span data-ttu-id="244a3-143">Además, la versión secundaria de la interfaz del servidor debe ser mayor o igual que la versión secundaria del cliente.</span><span class="sxs-lookup"><span data-stu-id="244a3-143">In addition, the server's interface minor version must be greater than or equal to the client's minor version.</span></span>

<span data-ttu-id="244a3-144">Si todas las pruebas se realizan correctamente, el asignador de extremos devuelve el punto de conexión válido y la biblioteca en tiempo de ejecución del cliente actualiza el punto de conexión en el identificador de enlace.</span><span class="sxs-lookup"><span data-stu-id="244a3-144">If all tests are successful, the endpoint mapper returns the valid endpoint and the client run-time library updates the endpoint in the binding handle.</span></span>

<span data-ttu-id="244a3-145">Los puntos de conexión dinámicos se purgan automáticamente de la base de datos del asignador de extremos cuando el proceso del servidor deja de ejecutarse.</span><span class="sxs-lookup"><span data-stu-id="244a3-145">Dynamic endpoints are automatically purged from the endpoint mapper database when the server process stops running.</span></span> <span data-ttu-id="244a3-146">Puede quitar el extremo de la base de datos del asignador de extremos antes de que el programa de servidor salga con la función [**RpcEpUnregister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepunregister) , o puede permitir la limpieza automática para administrar la eliminación del punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="244a3-146">You can either remove the endpoint from the endpoint mapper database before the server program exits using the [**RpcEpUnregister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepunregister) function, or you can allow automatic cleanup to manage removal of the endpoint.</span></span>

 

 