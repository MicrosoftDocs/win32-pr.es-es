---
description: La fragmentación del montón es un estado en el que la memoria disponible se divide en pequeños bloques no contiguos.
ms.assetid: d10abf82-423c-4942-b05e-55de3a5c4219
title: Montón de baja fragmentación
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8ad14a97fa6d95b663f63b21f0982332ba0de01e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "105687445"
---
# <a name="low-fragmentation-heap"></a><span data-ttu-id="3d8a6-103">Montón de baja fragmentación</span><span class="sxs-lookup"><span data-stu-id="3d8a6-103">Low-fragmentation Heap</span></span>

<span data-ttu-id="3d8a6-104">\[La información de este tema se aplica a Windows Server 2003 y Windows XP.</span><span class="sxs-lookup"><span data-stu-id="3d8a6-104">\[The information in this topic applies to Windows Server 2003 and Windows XP.</span></span> <span data-ttu-id="3d8a6-105">A partir de Windows Vista, el sistema usa el montón de baja fragmentación (LFH) según sea necesario para atender las solicitudes de asignación de memoria.</span><span class="sxs-lookup"><span data-stu-id="3d8a6-105">Starting with Windows Vista, the system uses the low-fragmentation heap (LFH) as needed to service memory allocation requests.</span></span> <span data-ttu-id="3d8a6-106">Las aplicaciones no necesitan habilitar LFH para sus montones.\]</span><span class="sxs-lookup"><span data-stu-id="3d8a6-106">Applications do not need to enable the LFH for their heaps.\]</span></span>

<span data-ttu-id="3d8a6-107">La fragmentación del montón es un estado en el que la memoria disponible se divide en pequeños bloques no contiguos.</span><span class="sxs-lookup"><span data-stu-id="3d8a6-107">Heap fragmentation is a state in which available memory is broken into small, noncontiguous blocks.</span></span> <span data-ttu-id="3d8a6-108">Cuando se fragmenta un montón, se puede producir un error en la asignación de memoria incluso cuando la memoria total disponible en el montón es suficiente para satisfacer una solicitud, ya que ningún bloque de memoria único es lo suficientemente grande.</span><span class="sxs-lookup"><span data-stu-id="3d8a6-108">When a heap is fragmented, memory allocation can fail even when the total available memory in the heap is enough to satisfy a request, because no single block of memory is large enough.</span></span> <span data-ttu-id="3d8a6-109">El montón de baja fragmentación (LFH) ayuda a reducir la fragmentación del montón.</span><span class="sxs-lookup"><span data-stu-id="3d8a6-109">The low-fragmentation heap (LFH) helps to reduce heap fragmentation.</span></span>

<span data-ttu-id="3d8a6-110">LFH no es un montón independiente.</span><span class="sxs-lookup"><span data-stu-id="3d8a6-110">The LFH is not a separate heap.</span></span> <span data-ttu-id="3d8a6-111">En su lugar, se trata de una directiva que las aplicaciones pueden habilitar para sus montones.</span><span class="sxs-lookup"><span data-stu-id="3d8a6-111">Instead, it is a policy that applications can enable for their heaps.</span></span> <span data-ttu-id="3d8a6-112">Cuando el LFH está habilitado, el sistema asigna memoria en ciertos tamaños predeterminados.</span><span class="sxs-lookup"><span data-stu-id="3d8a6-112">When the LFH is enabled, the system allocates memory in certain predetermined sizes.</span></span> <span data-ttu-id="3d8a6-113">Cuando una aplicación solicita una asignación de memoria de un montón que tiene habilitada la LFH, el sistema asigna el bloque más pequeño de memoria que es lo suficientemente grande como para contener el tamaño solicitado.</span><span class="sxs-lookup"><span data-stu-id="3d8a6-113">When an application requests a memory allocation from a heap that has the LFH enabled, the system allocates the smallest block of memory that is large enough to contain the requested size.</span></span> <span data-ttu-id="3d8a6-114">El sistema no usa LFH para las asignaciones mayores de 16 KB, tanto si el LFH está habilitado como si no.</span><span class="sxs-lookup"><span data-stu-id="3d8a6-114">The system does not use the LFH for allocations larger than 16 KB, whether or not the LFH is enabled.</span></span>

<span data-ttu-id="3d8a6-115">Una aplicación solo debe habilitar LFH para el montón predeterminado del proceso de llamada o para los [montones privados](heap-functions.md) que ha creado la aplicación.</span><span class="sxs-lookup"><span data-stu-id="3d8a6-115">An application should enable the LFH only for the default heap of the calling process or for [private heaps](heap-functions.md) that the application has created.</span></span> <span data-ttu-id="3d8a6-116">Para habilitar LFH para un montón, use la función [**GetProcessHeap**](/windows/desktop/api/HeapApi/nf-heapapi-getprocessheap) para obtener un identificador para el montón predeterminado del proceso de llamada, o bien use el identificador para un montón privado creado por la función [**HeapCreate**](/windows/desktop/api/HeapApi/nf-heapapi-heapcreate) .</span><span class="sxs-lookup"><span data-stu-id="3d8a6-116">To enable the LFH for a heap, use the [**GetProcessHeap**](/windows/desktop/api/HeapApi/nf-heapapi-getprocessheap) function to obtain a handle to the default heap of the calling process, or use the handle to a private heap created by the [**HeapCreate**](/windows/desktop/api/HeapApi/nf-heapapi-heapcreate) function.</span></span> <span data-ttu-id="3d8a6-117">A continuación, llame a la función [**HeapSetInformation**](/windows/desktop/api/HeapApi/nf-heapapi-heapsetinformation) con el identificador.</span><span class="sxs-lookup"><span data-stu-id="3d8a6-117">Then call the [**HeapSetInformation**](/windows/desktop/api/HeapApi/nf-heapapi-heapsetinformation) function with the handle.</span></span>

<span data-ttu-id="3d8a6-118">LFH no se puede habilitar para montones creados con el **montón \_ no \_ SERIALIZE** o para montones creados con un tamaño fijo.</span><span class="sxs-lookup"><span data-stu-id="3d8a6-118">The LFH cannot be enabled for heaps created with **HEAP\_NO\_SERIALIZE** or for heaps created with a fixed size.</span></span> <span data-ttu-id="3d8a6-119">LFH tampoco se puede habilitar si usa las herramientas de depuración del montón en [herramientas de depuración para Windows](/windows-hardware/drivers/debugger/) o [Microsoft comprobador de aplicaciones](https://www.microsoft.com/downloads/details.aspx?FamilyID=c4a25ab9-649d-4a1b-b4a7-c9d8b095df18&displaylang=en).</span><span class="sxs-lookup"><span data-stu-id="3d8a6-119">The LFH also cannot be enabled if you are using the heap debugging tools in [Debugging Tools for Windows](/windows-hardware/drivers/debugger/) or [Microsoft Application Verifier](https://www.microsoft.com/downloads/details.aspx?FamilyID=c4a25ab9-649d-4a1b-b4a7-c9d8b095df18&displaylang=en).</span></span>

<span data-ttu-id="3d8a6-120">Una vez que se ha habilitado LFH para un montón, no se puede deshabilitar.</span><span class="sxs-lookup"><span data-stu-id="3d8a6-120">After the LFH has been enabled for a heap, it cannot be disabled.</span></span>

<span data-ttu-id="3d8a6-121">Las aplicaciones que se benefician de la mayoría de los LFH son aplicaciones multiproceso que asignan memoria con frecuencia y usan una variedad de tamaños de asignación de 16 KB.</span><span class="sxs-lookup"><span data-stu-id="3d8a6-121">Applications that benefit most from the LFH are multithreaded applications that allocate memory frequently and use a variety of allocation sizes under 16 KB.</span></span> <span data-ttu-id="3d8a6-122">Sin embargo, no todas las aplicaciones se benefician de LFH.</span><span class="sxs-lookup"><span data-stu-id="3d8a6-122">However, not all applications benefit from the LFH.</span></span> <span data-ttu-id="3d8a6-123">Para evaluar los efectos de habilitar LFH en la aplicación, use los datos de generación de perfiles de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="3d8a6-123">To assess the effects of enabling the LFH in your application, use performance profiling data.</span></span>

 

 
