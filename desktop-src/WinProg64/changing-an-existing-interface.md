---
title: Cambiar una interfaz existente
description: Siempre que sea posible, implemente una nueva interfaz para la aplicación, en lugar de realizar cambios en una existente.
ms.assetid: 29845cf5-445c-403d-b298-d4e07c3536b7
keywords:
- cambiar interfaces existentes programación de Windows de 64 bits
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 51a656ee768dcc2e88725d2cff0ddc5604fd771f
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104533304"
---
# <a name="changing-an-existing-interface"></a><span data-ttu-id="56326-104">Cambiar una interfaz existente</span><span class="sxs-lookup"><span data-stu-id="56326-104">Changing an Existing Interface</span></span>

<span data-ttu-id="56326-105">Siempre que sea posible, implemente una nueva interfaz para la aplicación, en lugar de realizar cambios en una existente.</span><span class="sxs-lookup"><span data-stu-id="56326-105">Whenever possible, implement a new interface for your application, rather than making changes to an existing one.</span></span> <span data-ttu-id="56326-106">Si no puede evitar el cambio de una interfaz existente, use los nuevos tipos de datos solo en los nuevos métodos.</span><span class="sxs-lookup"><span data-stu-id="56326-106">If you cannot avoid changing an existing interface, use new data types in new methods only.</span></span> <span data-ttu-id="56326-107">La introducción de un nuevo tipo de datos o la modificación de un tipo existente es la fuente más común de problemas de incompatibilidad.</span><span class="sxs-lookup"><span data-stu-id="56326-107">Introducing a new data type or modifying an existing type is the most common source of incompatibility problems.</span></span> <span data-ttu-id="56326-108">El modelo de tiempo de ejecución de RPC supone que la aplicación receptora conoce los tipos de datos que recibe, por lo que los datos se colocan en la conexión sin una descripción de datos genéricos.</span><span class="sxs-lookup"><span data-stu-id="56326-108">The RPC run-time model assumes that the receiving application knows about the types of data that it receives, so data is put onto the wire without a generic data description.</span></span> <span data-ttu-id="56326-109">Cuando el destinatario espera un tipo de datos diferente del que el remitente ha colocado en la conexión, el código auxiliar genera una excepción (o se produce un error en la transmisión de otra manera menos estable).</span><span class="sxs-lookup"><span data-stu-id="56326-109">When the recipient expects a different data type than what the sender has put on the wire, the stub raises an exception (or transmission fails in some other less graceful manner).</span></span>

<span data-ttu-id="56326-110">Una interfaz RPC se define mediante su UUID y sus números de versión principal y secundaria.</span><span class="sxs-lookup"><span data-stu-id="56326-110">An RPC interface is defined by its UUID and its major and minor version numbers.</span></span> <span data-ttu-id="56326-111">Al cambiar una interfaz existente, debe agregar los nuevos métodos al final de la interfaz y cambiar el número de versión secundaria.</span><span class="sxs-lookup"><span data-stu-id="56326-111">When you change an existing interface, you should add the new methods at the end of the interface and change the minor version number.</span></span> <span data-ttu-id="56326-112">Si agrega métodos en cualquier lugar o realiza cualquier otro cambio en la interfaz, también deberá cambiar el número de versión principal.</span><span class="sxs-lookup"><span data-stu-id="56326-112">If you add methods anywhere else or make any other changes to the interface, you will also need to change the major version number.</span></span>

<span data-ttu-id="56326-113">En realidad, hay ocasiones en las que no se puede cambiar ni siquiera el número de versión secundaria, ya que un nuevo cliente no podrá comunicarse con un servidor antiguo y no podrá actualizar el servidor.</span><span class="sxs-lookup"><span data-stu-id="56326-113">Realistically, there are times when you cannot change even the minor version number, because a new client will not be able to communicate with an old server and you cannot update the server.</span></span> <span data-ttu-id="56326-114">El tiempo de ejecución de RPC genera una excepción \_ , \_ PROCNUM \_ de RPC S fuera \_ del \_ intervalo, cuando un cliente llama a un método más allá de los especificados para su interfaz con el servidor.</span><span class="sxs-lookup"><span data-stu-id="56326-114">The RPC run time raises an exception, RPC\_S\_PROCNUM\_OUT\_OF\_RANGE, when a client calls a method beyond the ones specified for its interface with the server.</span></span> <span data-ttu-id="56326-115">La solución alternativa consiste en dejar sin modificar los números de versión y escribir el código de cliente para controlar esta excepción de forma correcta, por lo que el cliente degrada su rendimiento, por ejemplo, o por cualquier medio que sea adecuado para su aplicación.</span><span class="sxs-lookup"><span data-stu-id="56326-115">The workaround is to leave the version numbers unchanged and write your client code to handle this exception gracefully—by the client degrading its performance, for example, or by whatever means are appropriate for your application.</span></span>

<span data-ttu-id="56326-116">Existe una solución similar para un caso especial de cambiar un tipo de datos en un método existente.</span><span class="sxs-lookup"><span data-stu-id="56326-116">There is a similar workaround for one special case of changing a data type in an existing method.</span></span> <span data-ttu-id="56326-117">Si tiene una [**Unión**](/windows/desktop/Midl/union) cuyas ramas son punteros y que no tiene una rama predeterminada para tipos no reconocidos, puede Agregar una nueva bifurcación que use el nuevo tipo de datos.</span><span class="sxs-lookup"><span data-stu-id="56326-117">If you have a [**union**](/windows/desktop/Midl/union) whose branches are pointers and that does not have a default branch for unrecognized types, you can add a new branch that uses the new data type.</span></span> <span data-ttu-id="56326-118">Esto no cambiará el tamaño de la estructura de datos.</span><span class="sxs-lookup"><span data-stu-id="56326-118">This will not change the size of the data structure.</span></span> <span data-ttu-id="56326-119">Cuando el cliente se comunica con un nuevo servidor, puede usar el nuevo tipo de datos.</span><span class="sxs-lookup"><span data-stu-id="56326-119">When your client talks to a new server, it can use the new data type.</span></span> <span data-ttu-id="56326-120">Sin embargo, cuando el cliente se comunica con un servidor anterior, el tiempo de ejecución generará la excepción la \_ \_ etiqueta no válida RPC S \_ .</span><span class="sxs-lookup"><span data-stu-id="56326-120">However, when your client talks to an old server, the run time will raise the exception RPC\_S\_INVALID\_TAG.</span></span> <span data-ttu-id="56326-121">De nuevo, debe escribir el código de cliente para controlar esta excepción de forma adecuada.</span><span class="sxs-lookup"><span data-stu-id="56326-121">Again, you will need to write your client code to handle this exception appropriately.</span></span>

<span data-ttu-id="56326-122">Una interfaz DCOM se identifica mediante su GUID.</span><span class="sxs-lookup"><span data-stu-id="56326-122">A DCOM interface is identified by its GUID.</span></span> <span data-ttu-id="56326-123">En DCOM, las interfaces se consideran inmutables y solo puede realizar cambios creando una nueva interfaz que herede de la antigua.</span><span class="sxs-lookup"><span data-stu-id="56326-123">In DCOM, interfaces are considered immutable and you can make changes only by creating a new interface that inherits from the old one.</span></span> <span data-ttu-id="56326-124">Estas reglas garantizan que los clientes y los servidores sigan siendo compatibles.</span><span class="sxs-lookup"><span data-stu-id="56326-124">These rules ensure that clients and servers remain compatible.</span></span>

 

 