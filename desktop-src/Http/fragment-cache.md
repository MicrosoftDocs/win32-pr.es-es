---
title: Caché de fragmentos
description: La API del servidor HTTP proporciona funcionalidad para que los usuarios almacenen fragmentos de datos en una memoria caché para su uso en respuestas HTTP de forma rápida.
ms.assetid: 0f9a768e-723c-4c7b-a746-6b817441409c
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a3979fb03c4f8898644329fd27eafb7007adbcc9
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/16/2019
ms.locfileid: "103994016"
---
# <a name="fragment-cache"></a><span data-ttu-id="30417-103">Caché de fragmentos</span><span class="sxs-lookup"><span data-stu-id="30417-103">Fragment Cache</span></span>

<span data-ttu-id="30417-104">La API del servidor HTTP proporciona funcionalidad para que los usuarios almacenen fragmentos de datos en una memoria caché para su uso en respuestas HTTP de forma rápida.</span><span class="sxs-lookup"><span data-stu-id="30417-104">The HTTP Server API provides functionality for users to store data fragments in a cache for use in rapidly forming HTTP responses.</span></span>

<span data-ttu-id="30417-105">Los fragmentos se pueden agregar a la memoria caché mediante una llamada a la función [**HttpAddFragmentToCache**](/windows/desktop/api/Http/nf-http-httpaddfragmenttocache) .</span><span class="sxs-lookup"><span data-stu-id="30417-105">Fragments can be added to the cache by calling the [**HttpAddFragmentToCache**](/windows/desktop/api/Http/nf-http-httpaddfragmenttocache) function.</span></span> <span data-ttu-id="30417-106">Un fragmento se identifica mediante una dirección URL contenida en el parámetro *pUrlPrefix* .</span><span class="sxs-lookup"><span data-stu-id="30417-106">A Fragment is identified by a URL contained in the *pUrlPrefix* parameter.</span></span> <span data-ttu-id="30417-107">Una llamada a esta función con la dirección URL de un fragmento existente sobrescribe el fragmento existente.</span><span class="sxs-lookup"><span data-stu-id="30417-107">A call to this function with the URL of an existing fragment overwrites the existing fragment.</span></span>

<span data-ttu-id="30417-108">El propietario de la cola de solicitudes que agregó inicialmente el fragmento puede eliminar o sobrescribir un fragmento.</span><span class="sxs-lookup"><span data-stu-id="30417-108">A fragment can be deleted or overwritten by the owner of the request queue that initially added the fragment.</span></span> <span data-ttu-id="30417-109">La función [**HttpFlushResponseCache**](/windows/desktop/api/Http/nf-http-httpflushresponsecache) llamada a UrlPrefix elimina todos los fragmentos de ese prefijo, así como los descendientes jerárquicos de ese UrlPrefix.</span><span class="sxs-lookup"><span data-stu-id="30417-109">The [**HttpFlushResponseCache**](/windows/desktop/api/Http/nf-http-httpflushresponsecache) function called with a UrlPrefix deletes all fragments within that prefix as well as the hierarchical descendants of that UrlPrefix.</span></span> <span data-ttu-id="30417-110">La función [**HttpReadFragmentFromCache**](/windows/desktop/api/Http/nf-http-httpreadfragmentfromcache) lee el fragmento completo o un intervalo de bytes especificado dentro del fragmento.</span><span class="sxs-lookup"><span data-stu-id="30417-110">The [**HttpReadFragmentFromCache**](/windows/desktop/api/Http/nf-http-httpreadfragmentfromcache) function reads in the entire fragment or a specified byte range within the fragment.</span></span>

> [!Note]  
> <span data-ttu-id="30417-111">Al agregar un fragmento a la memoria caché, no se garantiza que esté disponible para futuras llamadas para enviar una respuesta.</span><span class="sxs-lookup"><span data-stu-id="30417-111">Adding a fragment to the cache does not guarantee that it is available for future calls to send a response.</span></span> <span data-ttu-id="30417-112">Las entradas de la caché de fragmentos pueden dejar de estar disponibles en cualquier momento.</span><span class="sxs-lookup"><span data-stu-id="30417-112">Fragment cache entries can become unavailable at any time.</span></span> <span data-ttu-id="30417-113">Se produce un error en una llamada que utiliza un fragmento que no está disponible.</span><span class="sxs-lookup"><span data-stu-id="30417-113">A call that uses a fragment that is not available fails.</span></span> <span data-ttu-id="30417-114">Las aplicaciones que usan la memoria caché de fragmentos deben estar preparadas para controlar este error.</span><span class="sxs-lookup"><span data-stu-id="30417-114">Applications that use the fragment cache must be prepared to handle this failure.</span></span>

 

## <a name="sending-a-response-with-a-fragment"></a><span data-ttu-id="30417-115">Enviar una respuesta con un fragmento</span><span class="sxs-lookup"><span data-stu-id="30417-115">Sending a Response With a Fragment</span></span>

<span data-ttu-id="30417-116">Los fragmentos se pueden usar para formar todas o partes de un cuerpo de entidad de respuestas HTTP.</span><span class="sxs-lookup"><span data-stu-id="30417-116">Fragments can be used to form all or portions of an HTTP responses entity body.</span></span> <span data-ttu-id="30417-117">Puede enviar una respuesta y un cuerpo de entidad en una llamada a la función [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) especificando una matriz de estructuras de [**\_ \_ fragmentos de datos http**](/windows/desktop/api/Http/ns-http-http_data_chunk) en la estructura de [**\_ respuesta http**](http-response.md) .</span><span class="sxs-lookup"><span data-stu-id="30417-117">You can send a response and entity body in one call to the [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) function by specifying an array of [**HTTP\_DATA\_CHUNK**](/windows/desktop/api/Http/ns-http-http_data_chunk) structures in the [**HTTP\_RESPONSE**](http-response.md) structure.</span></span>

<span data-ttu-id="30417-118">Un [**\_ \_ fragmento de datos http**](/windows/desktop/api/Http/ns-http-http_data_chunk) puede especificar un bloque de memoria, un identificador de un archivo ya abierto o una entrada de la caché de fragmentos.</span><span class="sxs-lookup"><span data-stu-id="30417-118">An [**HTTP\_DATA\_CHUNK**](/windows/desktop/api/Http/ns-http-http_data_chunk) can specify a block of memory, a handle to an already opened file or a fragment cache entry.</span></span> <span data-ttu-id="30417-119">Estos se corresponden con los tipos de **\_ \_ fragmentos de datos http** : **HttpDataChunkFromMemory**, **HttpDataChunkFromFileHandle** y **HttpDataChunkFromFragmentCache**, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="30417-119">These correspond to the **HTTP\_DATA\_CHUNK** types: **HttpDataChunkFromMemory**, **HttpDataChunkFromFileHandle**, and **HttpDataChunkFromFragmentCache**, respectively.</span></span> <span data-ttu-id="30417-120">Las respuestas completas en la memoria caché HTTP también se pueden usar como fragmentos en la estructura de [**\_ respuesta http**](http-response.md) , aunque no se recomienda esta práctica.</span><span class="sxs-lookup"><span data-stu-id="30417-120">Full responses in the HTTP cache can also be used as fragments in the [**HTTP\_RESPONSE**](http-response.md) structure, although this practice is not recommended.</span></span>

<span data-ttu-id="30417-121">La estructura de [**\_ respuesta http**](http-response.md) contiene un puntero a una matriz de estructuras de [**\_ \_ fragmentos de datos http**](/windows/desktop/api/Http/ns-http-http_data_chunk) que componen el cuerpo de la entidad de la respuesta.</span><span class="sxs-lookup"><span data-stu-id="30417-121">The [**HTTP\_RESPONSE**](http-response.md) structure contains a pointer to an array of [**HTTP\_DATA\_CHUNK**](/windows/desktop/api/Http/ns-http-http_data_chunk) structures that comprise the entity body of the response.</span></span> <span data-ttu-id="30417-122">La estructura de **\_ respuesta http** también contiene un recuento coincidente que especifica la dimensión de la matriz de estructuras de **\_ \_ fragmentos de datos http** .</span><span class="sxs-lookup"><span data-stu-id="30417-122">The **HTTP\_RESPONSE** structure also contains a matching count which specifies the dimension of the array of **HTTP\_DATA\_CHUNK** structures.</span></span> <span data-ttu-id="30417-123">El valor HttpDataChunkFromFragmentCache de la estructura de **\_ \_ fragmentos de datos http** especifica el tipo de caché de fragmentos del fragmento de datos.</span><span class="sxs-lookup"><span data-stu-id="30417-123">The HttpDataChunkFromFragmentCache value in the **HTTP\_DATA\_CHUNK** structure specifies the fragment cache type of the data chunk.</span></span> <span data-ttu-id="30417-124">La estructura de **\_ \_ fragmentos de datos http** también especifica el nombre del fragmento.</span><span class="sxs-lookup"><span data-stu-id="30417-124">The **HTTP\_DATA\_CHUNK** structure also specifies the fragment name.</span></span>

<span data-ttu-id="30417-125">Se produce un ERROR en una respuesta que contiene un fragmento en caché con una \_ ruta \_ de acceso no \_ encontrada si alguna de las entradas de la caché de fragmentos no está disponible.</span><span class="sxs-lookup"><span data-stu-id="30417-125">A response that contains a cached fragment fails with an ERROR\_PATH\_NOT\_FOUND if any of the fragment cache entries are not available.</span></span> <span data-ttu-id="30417-126">Dado que no se garantiza que las entradas de la caché de fragmentos estén disponibles, las aplicaciones deben estar preparadas para controlar este caso.</span><span class="sxs-lookup"><span data-stu-id="30417-126">Since the fragment cache entries are not guaranteed to be available, applications must be prepared to handle this case.</span></span> <span data-ttu-id="30417-127">Una manera de controlar este caso es intentar volver a agregar la entrada de caché de fragmentos y reenviar la respuesta.</span><span class="sxs-lookup"><span data-stu-id="30417-127">One way to handle this case is to attempt to re-add the fragment cache entry and resend the response.</span></span> <span data-ttu-id="30417-128">Si se producen errores repetidos, la aplicación puede usar fragmentos de datos almacenados en búferes de memoria en lugar de entradas de caché de fragmentos.</span><span class="sxs-lookup"><span data-stu-id="30417-128">If repeated failures occur, the application can use data chunks stored in memory buffers instead of fragment cache entries.</span></span>

<span data-ttu-id="30417-129">Las entradas de la caché de fragmentos también se pueden especificar en la función [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) .</span><span class="sxs-lookup"><span data-stu-id="30417-129">Fragment cache entries can also be specified in the [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) function.</span></span> <span data-ttu-id="30417-130">El fragmento se agrega al cuerpo de la entidad en la estructura de [**\_ \_ fragmentos de datos http**](/windows/desktop/api/Http/ns-http-http_data_chunk) tal y como se ha descrito anteriormente.</span><span class="sxs-lookup"><span data-stu-id="30417-130">The fragment is added to the entity body in the [**HTTP\_DATA\_CHUNK**](/windows/desktop/api/Http/ns-http-http_data_chunk) structure as described above.</span></span> <span data-ttu-id="30417-131">De nuevo, el envío puede producir un error si alguna de las entradas de caché de fragmentos especificadas no está disponible.</span><span class="sxs-lookup"><span data-stu-id="30417-131">Again, the send can fail if any of the specified fragment cache entries are not available.</span></span>

 

 




