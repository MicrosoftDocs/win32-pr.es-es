---
title: Usar la anotación del servidor
description: En este tema se proporciona información sobre cómo utilizar la anotación de servidor para especificar un objeto de devolución de llamada.
ms.assetid: eeeebddc-2752-4d8f-b4fa-38ce156acc08
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb545cd4dd016901d69f67d5ab5cab15dda08875
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "105695676"
---
# <a name="using-server-annotation"></a><span data-ttu-id="57896-103">Usar la anotación del servidor</span><span class="sxs-lookup"><span data-stu-id="57896-103">Using Server Annotation</span></span>

<span data-ttu-id="57896-104">En este tema se proporciona información sobre cómo utilizar la anotación de servidor para especificar un objeto de devolución de llamada.</span><span class="sxs-lookup"><span data-stu-id="57896-104">This topic provides information about using server annotation to specify a callback object.</span></span>

<span data-ttu-id="57896-105">**Para reemplazar una propiedad que especifica un objeto de devolución de llamada**</span><span class="sxs-lookup"><span data-stu-id="57896-105">**To override a property that specifies a callback object**</span></span>

1.  <span data-ttu-id="57896-106">Obtener un puntero de interfaz [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) al elemento accesible que se va a anotar.</span><span class="sxs-lookup"><span data-stu-id="57896-106">Obtain an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer to the accessible element that is to be annotated.</span></span>
2.  <span data-ttu-id="57896-107">Llame a [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) en el elemento accesible para obtener un puntero de interfaz [**IAccIdentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) .</span><span class="sxs-lookup"><span data-stu-id="57896-107">Call [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) on the accessible element to get an [**IAccIdentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) interface pointer.</span></span>
3.  <span data-ttu-id="57896-108">Llame a [**IAccIdentity:: GetIdentityString ()**](/windows/desktop/api/Oleacc/nf-oleacc-iaccidentity-getidentitystring) en el puntero de la interfaz [**IAccIdentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) para obtener una cadena que identifique de forma única el elemento accesible que se va a anotar.</span><span class="sxs-lookup"><span data-stu-id="57896-108">Call [**IAccIdentity::GetIdentityString()**](/windows/desktop/api/Oleacc/nf-oleacc-iaccidentity-getidentitystring) on the [**IAccIdentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) interface pointer to obtain a string that uniquely identifies the accessible element that is to be annotated.</span></span>
4.  <span data-ttu-id="57896-109">Use [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) o [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) para crear el objeto [**IAccPropServices**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropservices) .</span><span class="sxs-lookup"><span data-stu-id="57896-109">Use [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) or [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) to create the [**IAccPropServices**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropservices) object.</span></span>
5.  <span data-ttu-id="57896-110">Cree un objeto de modelo de objetos componentes (COM) que implemente [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver).</span><span class="sxs-lookup"><span data-stu-id="57896-110">Create a Component Object Model (COM) object that implements [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver).</span></span>
6.  <span data-ttu-id="57896-111">Llame a [**IAccPropServices:: SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver), pasando la cadena de identidad, un GUID que indica la propiedad que se va a reemplazar y un puntero al objeto de devolución de llamada [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver) .</span><span class="sxs-lookup"><span data-stu-id="57896-111">Call [**IAccPropServices::SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver), passing the identity string, a GUID indicating the property to be overridden, and a pointer to the [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver) callback object.</span></span>
7.  <span data-ttu-id="57896-112">Punteros de interfaz de versión y memoria libre.</span><span class="sxs-lookup"><span data-stu-id="57896-112">Release interface pointers and free memory.</span></span>

<span data-ttu-id="57896-113">Cuando un cliente solicita la propiedad del elemento accesible, se llamará al objeto de devolución de llamada y se devolverá el valor al cliente.</span><span class="sxs-lookup"><span data-stu-id="57896-113">When a client requests the property of the accessible element, the callback object will be called and will return the value to the client.</span></span>

<span data-ttu-id="57896-114">Al igual que cuando se especifica un valor, los desarrolladores del servidor pueden usar el método [**IAccPropServices:: ComposeHwndIdentityString**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-composehwndidentitystring) para obtener una cadena de identidad. o bien, pueden usar el método [**IAccPropServices:: SetHwndPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) y especificar los parámetros *hWnd*, *idObject* o *idChild* en lugar de una cadena de identidad.</span><span class="sxs-lookup"><span data-stu-id="57896-114">As when specifying a value, server developers can alternatively use the [**IAccPropServices::ComposeHwndIdentityString**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-composehwndidentitystring) method to obtain an identity string; or they can use the [**IAccPropServices::SetHwndPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) method and specify the *hwnd*, *idObject*, or *idChild* parameters instead of an identity string.</span></span>

<span data-ttu-id="57896-115">Cuando se usa [**SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver) o [**SetHwndPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) en un objeto contenedor, los desarrolladores de servidores pueden especificar opcionalmente que la información de invalidación también debe aplicarse a todos los elementos secundarios de dicho contenedor.</span><span class="sxs-lookup"><span data-stu-id="57896-115">When using either [**SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver) or [**SetHwndPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) on a container object, server developers can optionally specify that the overriding information should also apply to all element children of that container.</span></span>

<span data-ttu-id="57896-116">Los servidores pueden borrar explícitamente la anotación en cualquier momento mediante [**IAccPropServices:: ClearProps**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-clearprops).</span><span class="sxs-lookup"><span data-stu-id="57896-116">Servers can explicitly clear the annotation at any time by using [**IAccPropServices::ClearProps**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-clearprops).</span></span> <span data-ttu-id="57896-117">Normalmente, esto no es necesario, ya que el servicio de anotaciones limpiará y liberará automáticamente la información de la anotación cuando desaparezca el elemento accesible que se va a anotar.</span><span class="sxs-lookup"><span data-stu-id="57896-117">This is usually not required, as the annotation service will automatically clean up and release annotation information when the accessible element being annotated disappears.</span></span>

<span data-ttu-id="57896-118">A continuación se muestra una lista de las propiedades que se pueden anotar mediante este procedimiento.</span><span class="sxs-lookup"><span data-stu-id="57896-118">Below is a list of properties that can be annotated using this procedure.</span></span>

## <a name="properties-supported-when-specifying-a-callback"></a><span data-ttu-id="57896-119">Propiedades admitidas al especificar una devolución de llamada</span><span class="sxs-lookup"><span data-stu-id="57896-119">Properties Supported When Specifying a Callback</span></span>

<span data-ttu-id="57896-120">Al especificar una devolución de llamada, se pueden anotar las siguientes propiedades.</span><span class="sxs-lookup"><span data-stu-id="57896-120">When specifying a callback, the following properties can be annotated.</span></span> <span data-ttu-id="57896-121">Actualmente, estas propiedades no se pueden anotar directamente especificando un valor.</span><span class="sxs-lookup"><span data-stu-id="57896-121">Currently these properties cannot be annotated directly by specifying a value.</span></span>



| <span data-ttu-id="57896-122">Propiedad</span><span class="sxs-lookup"><span data-stu-id="57896-122">Property</span></span>                      | <span data-ttu-id="57896-123">Tipo</span><span class="sxs-lookup"><span data-stu-id="57896-123">Type</span></span>                                                             |
|-------------------------------|------------------------------------------------------------------|
| <span data-ttu-id="57896-124">nombre de la \_ ACC \_</span><span class="sxs-lookup"><span data-stu-id="57896-124">PROPID\_ACC\_NAME</span></span>             | <span data-ttu-id="57896-125">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="57896-125">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="57896-126">Descripción de la definición del PROPID \_ \_</span><span class="sxs-lookup"><span data-stu-id="57896-126">PROPID\_ACC\_DESCRIPTION</span></span>      | <span data-ttu-id="57896-127">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="57896-127">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="57896-128">rol de PROPID \_ ACC \_</span><span class="sxs-lookup"><span data-stu-id="57896-128">PROPID\_ACC\_ROLE</span></span>             | <span data-ttu-id="57896-129">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="57896-129">VT\_I4</span></span>                                                           |
| <span data-ttu-id="57896-130">Estado de la ACC de PROPID \_ \_</span><span class="sxs-lookup"><span data-stu-id="57896-130">PROPID\_ACC\_STATE</span></span>            | <span data-ttu-id="57896-131">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="57896-131">VT\_I4</span></span>                                                           |
| <span data-ttu-id="57896-132">ayuda de la ACC de PROPID \_ \_</span><span class="sxs-lookup"><span data-stu-id="57896-132">PROPID\_ACC\_HELP</span></span>             | <span data-ttu-id="57896-133">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="57896-133">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="57896-134">KEYBOARDSHORTCUT de la \_ ACC \_</span><span class="sxs-lookup"><span data-stu-id="57896-134">PROPID\_ACC\_KEYBOARDSHORTCUT</span></span> | <span data-ttu-id="57896-135">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="57896-135">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="57896-136">PROPID \_ ACC \_ DEFAULTACTION</span><span class="sxs-lookup"><span data-stu-id="57896-136">PROPID\_ACC\_DEFAULTACTION</span></span>    | <span data-ttu-id="57896-137">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="57896-137">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="57896-138">PROPID \_ ACC \_ VALUEMAP</span><span class="sxs-lookup"><span data-stu-id="57896-138">PROPID\_ACC\_VALUEMAP</span></span>         | <span data-ttu-id="57896-139">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="57896-139">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="57896-140">ROLEMAP de la \_ ACC \_</span><span class="sxs-lookup"><span data-stu-id="57896-140">PROPID\_ACC\_ROLEMAP</span></span>          | <span data-ttu-id="57896-141">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="57896-141">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="57896-142">STATEMAP de la \_ ACC \_</span><span class="sxs-lookup"><span data-stu-id="57896-142">PROPID\_ACC\_STATEMAP</span></span>         | <span data-ttu-id="57896-143">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="57896-143">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="57896-144">el \_ foco de la ACC \_</span><span class="sxs-lookup"><span data-stu-id="57896-144">PROPID\_ACC\_FOCUS</span></span>            | <span data-ttu-id="57896-145">distribución de VT \_</span><span class="sxs-lookup"><span data-stu-id="57896-145">VT\_DISPATCH</span></span><br/> <span data-ttu-id="57896-146">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="57896-146">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="57896-147">selección de la \_ ACC. \_</span><span class="sxs-lookup"><span data-stu-id="57896-147">PROPID\_ACC\_SELECTION</span></span>        | <span data-ttu-id="57896-148">distribución de VT \_</span><span class="sxs-lookup"><span data-stu-id="57896-148">VT\_DISPATCH</span></span><br/> <span data-ttu-id="57896-149">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="57896-149">VT\_I4</span></span><br/> <span data-ttu-id="57896-150">VT \_ desconocido</span><span class="sxs-lookup"><span data-stu-id="57896-150">VT\_UNKNOWN</span></span><br/> |
| <span data-ttu-id="57896-151">PROPID \_ ACC \_ Parent</span><span class="sxs-lookup"><span data-stu-id="57896-151">PROPID\_ACC\_PARENT</span></span>           | <span data-ttu-id="57896-152">distribución de VT \_</span><span class="sxs-lookup"><span data-stu-id="57896-152">VT\_DISPATCH</span></span>                                                     |
| <span data-ttu-id="57896-153">\_parabar \_ \_ de PROPID</span><span class="sxs-lookup"><span data-stu-id="57896-153">PROPID\_ACC\_NAV\_UP</span></span>          | <span data-ttu-id="57896-154">distribución de VT \_</span><span class="sxs-lookup"><span data-stu-id="57896-154">VT\_DISPATCH</span></span><br/> <span data-ttu-id="57896-155">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="57896-155">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="57896-156">\_Nº de \_ denav de la ACC \_</span><span class="sxs-lookup"><span data-stu-id="57896-156">PROPID\_ACC\_NAV\_DOWN</span></span>        | <span data-ttu-id="57896-157">distribución de VT \_</span><span class="sxs-lookup"><span data-stu-id="57896-157">VT\_DISPATCH</span></span><br/> <span data-ttu-id="57896-158">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="57896-158">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="57896-159">se \_ ha \_ dejado la ACC de PROPID \_</span><span class="sxs-lookup"><span data-stu-id="57896-159">PROPID\_ACC\_NAV\_LEFT</span></span>        | <span data-ttu-id="57896-160">distribución de VT \_</span><span class="sxs-lookup"><span data-stu-id="57896-160">VT\_DISPATCH</span></span><br/> <span data-ttu-id="57896-161">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="57896-161">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="57896-162">derecho de la ACC de PROPID \_ \_ \_</span><span class="sxs-lookup"><span data-stu-id="57896-162">PROPID\_ACC\_NAV\_RIGHT</span></span>       | <span data-ttu-id="57896-163">distribución de VT \_</span><span class="sxs-lookup"><span data-stu-id="57896-163">VT\_DISPATCH</span></span><br/> <span data-ttu-id="57896-164">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="57896-164">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="57896-165">Nº de NAV de la \_ ACC \_ \_ prev</span><span class="sxs-lookup"><span data-stu-id="57896-165">PROPID\_ACC\_NAV\_PREV</span></span>        | <span data-ttu-id="57896-166">distribución de VT \_</span><span class="sxs-lookup"><span data-stu-id="57896-166">VT\_DISPATCH</span></span><br/> <span data-ttu-id="57896-167">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="57896-167">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="57896-168">\_ \_ \_ siguiente</span><span class="sxs-lookup"><span data-stu-id="57896-168">PROPID\_ACC\_NAV\_NEXT</span></span>        | <span data-ttu-id="57896-169">distribución de VT \_</span><span class="sxs-lookup"><span data-stu-id="57896-169">VT\_DISPATCH</span></span><br/> <span data-ttu-id="57896-170">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="57896-170">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="57896-171">PROPID \_ ACC \_ NAV \_ FIRSTCHILD</span><span class="sxs-lookup"><span data-stu-id="57896-171">PROPID\_ACC\_NAV\_FIRSTCHILD</span></span>  | <span data-ttu-id="57896-172">distribución de VT \_</span><span class="sxs-lookup"><span data-stu-id="57896-172">VT\_DISPATCH</span></span><br/> <span data-ttu-id="57896-173">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="57896-173">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="57896-174">PROPID \_ ACC \_ NAV \_ LASTCHILD</span><span class="sxs-lookup"><span data-stu-id="57896-174">PROPID\_ACC\_NAV\_LASTCHILD</span></span>   | <span data-ttu-id="57896-175">distribución de VT \_</span><span class="sxs-lookup"><span data-stu-id="57896-175">VT\_DISPATCH</span></span><br/> <span data-ttu-id="57896-176">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="57896-176">VT\_I4</span></span><br/>                        |



 

 

