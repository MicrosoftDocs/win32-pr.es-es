---
title: Cadenas de formato NDR de RPC
description: Cadenas de formato NDR de llamada a procedimiento remoto (RPC).
ms.assetid: 9c83a039-49d3-491d-8110-29d1548730de
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cf0569a913d6c5a4b19b342cc288d6a8682dfc4a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "103904789"
---
# <a name="rpc-ndr-format-strings"></a><span data-ttu-id="5493d-103">Cadenas de formato NDR de RPC</span><span class="sxs-lookup"><span data-stu-id="5493d-103">RPC NDR Format Strings</span></span>

## <a name="ndr-engine-32-bit-interpreter"></a><span data-ttu-id="5493d-104">Motor NDR: intérprete de 32 bits</span><span class="sxs-lookup"><span data-stu-id="5493d-104">NDR Engine: 32-bit Interpreter</span></span>

<span data-ttu-id="5493d-105">En este documento se describen los descriptores de cadena de formato, a veces denominados MOPs, para el motor NDR de 32 bits.</span><span class="sxs-lookup"><span data-stu-id="5493d-105">This document describes the format string descriptors, sometimes referred to as MOPs, for the 32-bit NDR engine.</span></span> <span data-ttu-id="5493d-106">En esta sección se describen los cambios asociados con la evolución del intérprete [**– OI**](/windows/desktop/Midl/-oi) a la capa de intérpretes **– salientes** , así como las adiciones relacionadas con las canalizaciones y la compatibilidad asincrónica.</span><span class="sxs-lookup"><span data-stu-id="5493d-106">This section describes changes associated with the evolution from the [**–Oi**](/windows/desktop/Midl/-oi) interpreter to the **–Oif** interpreter layer, as well as additions related to pipes and asynchronous support.</span></span>

<span data-ttu-id="5493d-107">En este documento se describe la tecnología de Lenguaje de definición de interfaz de Microsoft actual (MIDL) desde la perspectiva del motor y el motor NDR actual.</span><span class="sxs-lookup"><span data-stu-id="5493d-107">This document describes current Microsoft Interface Definition Language (MIDL) technology from the engine perspective, and the current NDR engine.</span></span>

## <a name="overview"></a><span data-ttu-id="5493d-108">Información general</span><span class="sxs-lookup"><span data-stu-id="5493d-108">Overview</span></span>

<span data-ttu-id="5493d-109">El motor NDR es el motor de serialización de los componentes llamada a procedimiento remoto (RPC) y DCOM.</span><span class="sxs-lookup"><span data-stu-id="5493d-109">The NDR engine is the marshaling engine of the Remote Procedure Call (RPC) and DCOM components.</span></span> <span data-ttu-id="5493d-110">Controla todos los problemas relacionados con el código auxiliar de una llamada remota.</span><span class="sxs-lookup"><span data-stu-id="5493d-110">It handles all stub-related issues of a remote call.</span></span> <span data-ttu-id="5493d-111">Como proceso, el cálculo de referencias de NDR está controlado por el código C de los códigos auxiliares generados por MIDL, un generador de tipos JIT de MIDL o por códigos auxiliares generados por otras herramientas o escritos manualmente.</span><span class="sxs-lookup"><span data-stu-id="5493d-111">As a process, NDR marshaling is driven by the C code from MIDL-generated stubs, a MIDL JIT-type generator, or by stubs generated by other tools or written manually.</span></span> <span data-ttu-id="5493d-112">A su vez, el motor NDR impulsa el tiempo de ejecución subyacente (DCOM o RPC) que se comunica con transportes específicos.</span><span class="sxs-lookup"><span data-stu-id="5493d-112">In turn, the NDR engine drives the underlying run time (DCOM or RPC) that communicates with specific transports.</span></span>

<span data-ttu-id="5493d-113">El objetivo original del diseño era proporcionar una herramienta para la serialización efectiva de datos arbitrarios, en función de la información proporcionada por el compilador de MIDL.</span><span class="sxs-lookup"><span data-stu-id="5493d-113">The original goal of the design had been to provide a tool for effective marshaling for arbitrary data, based on information provided by the MIDL compiler.</span></span> <span data-ttu-id="5493d-114">Las cadenas de formato descritas en este documento y, en realidad, toda la información generada por el compilador para el consumo del motor NDR, siempre se han considerado una interfaz interna entre el compilador y el motor.</span><span class="sxs-lookup"><span data-stu-id="5493d-114">The format strings described in this document—and indeed all information generated by the compiler for NDR engine consumption—have always been considered an internal interface between the compiler and the engine.</span></span> <span data-ttu-id="5493d-115">Del mismo modo, las interfaces disponibles para el motor para controlar los problemas en tiempo de ejecución también son principalmente internas (algunas excepciones existen en el lado de ejecución de RPC y algunas interfaces DCOM utilizadas por el motor son externas).</span><span class="sxs-lookup"><span data-stu-id="5493d-115">Similarly, interfaces available to the engine to handle run-time issues are also mostly internal (some exceptions exist on the RPC run-time side, and some DCOM interfaces used by the engine are external).</span></span>

<span data-ttu-id="5493d-116">Dos enfoques típicos para calcular las referencias se han realizado siempre en línea y en la tecnología controlada por datos (interpretada).</span><span class="sxs-lookup"><span data-stu-id="5493d-116">Two typical approaches to marshaling have always been inline and data-driven (interpreted) technology.</span></span> <span data-ttu-id="5493d-117">MIDL admite a través de sus modificadores [**– os**](/windows/desktop/Midl/-os) y [**– OI \***](/windows/desktop/Midl/-oi) en sus códigos auxiliares generados por C.</span><span class="sxs-lookup"><span data-stu-id="5493d-117">MIDL supports both through its [**–Os**](/windows/desktop/Midl/-os) and [**–Oi\***](/windows/desktop/Midl/-oi) switches in its C-generated stubs.</span></span> <span data-ttu-id="5493d-118">Además, MIDL puede generar las bibliotecas TLB usadas por el paquete oleautomation.</span><span class="sxs-lookup"><span data-stu-id="5493d-118">In addition, MIDL can generate the TLB libraries used by the oleautomation package.</span></span> <span data-ttu-id="5493d-119">En consecuencia, una perspectiva de los elementos internos del motor es que se compone de dos partes.</span><span class="sxs-lookup"><span data-stu-id="5493d-119">Accordingly, one perspective of the engine's internals is that it consists of two parts.</span></span>

<span data-ttu-id="5493d-120">El primero es un conjunto de rutinas que controlan el tamaño, el cálculo de referencias, etc., que se corresponde con objetos de tipo de datos típicos como una estructura o una matriz.</span><span class="sxs-lookup"><span data-stu-id="5493d-120">The first is a set of routines that handle sizing, marshaling, and so on, corresponding to typical data type objects like a structure or an array.</span></span> <span data-ttu-id="5493d-121">Estas rutinas se ajustan para mejorar el rendimiento; por ejemplo, normalmente intentan bloquear la copia de datos siempre que sea posible.</span><span class="sxs-lookup"><span data-stu-id="5493d-121">These routines are fine-tuned for performance; for example, they typically attempt to block-copy data wherever possible.</span></span> <span data-ttu-id="5493d-122">Esta parte se conoce a menudo como el motor NDR principal.</span><span class="sxs-lookup"><span data-stu-id="5493d-122">This part is often referred to as the core NDR engine.</span></span>

<span data-ttu-id="5493d-123">La segunda parte consta de un intérprete y sus elementos relacionados.</span><span class="sxs-lookup"><span data-stu-id="5493d-123">The second part consists of an interpreter and its related pieces.</span></span> <span data-ttu-id="5493d-124">El intérprete usa rutinas del motor de NDR principal, como si se tratase de una biblioteca interna, para ejecutar una llamada remota con todos sus argumentos calculados y cuyas referencias no se han calculado, según corresponda.</span><span class="sxs-lookup"><span data-stu-id="5493d-124">The interpreter uses routines from the core NDR engine, as if from an internal library, in order to execute a remote call with all its arguments marshaled and unmarshaled, as appropriate.</span></span>

<span data-ttu-id="5493d-125">El motor NDR principal se utiliza de forma similar si se utiliza desde código auxiliar en línea o desde el intérprete.</span><span class="sxs-lookup"><span data-stu-id="5493d-125">The core NDR engine is used in a similar manner whether used from inline stubs or from the interpreter.</span></span> <span data-ttu-id="5493d-126">Todas las rutinas del motor principal dependen del estado pasado por una estructura de mensaje de código auxiliar.</span><span class="sxs-lookup"><span data-stu-id="5493d-126">All core engine routines depend on the state passed in by a stub message structure.</span></span> <span data-ttu-id="5493d-127">La estructura se configura correctamente mediante el código auxiliar en línea o el intérprete.</span><span class="sxs-lookup"><span data-stu-id="5493d-127">The structure is set up appropriately by the inline stub or by the interpreter.</span></span> <span data-ttu-id="5493d-128">A lo largo de los años, el motor principal se usaba en un contexto diferente. Actualmente, el intérprete es realmente un conjunto de varios bucles intérprete distintos.</span><span class="sxs-lookup"><span data-stu-id="5493d-128">Over the years the core engine had been used in a different context; currently the interpreter is actually a set of several distinct interpreter loops.</span></span> <span data-ttu-id="5493d-129">Estos se relacionan con los intérpretes antiguos y nuevos ([**– OI**](/windows/desktop/Midl/-oi) frente a las **interfaces**), así como con los bucles relacionados con la serialización de datos (picking), la compatibilidad con RPC Async y la compatibilidad ASINCRÓNICA de DCOM (RPC y DCOM tienen diferentes modelos de programación asincrónica).</span><span class="sxs-lookup"><span data-stu-id="5493d-129">These are related to the old and new ([**–Oi**](/windows/desktop/Midl/-oi) versus **–Oif**) interpreters, as well as to loops related to data serialization (pickling), RPC async support and DCOM async support (RPC and DCOM have different asynchronous programming models).</span></span>

<span data-ttu-id="5493d-130">Además de agregar nuevas características, un aspecto importante de la evolución del motor de NDR es un cambio general en el enfoque de los intérpretes.</span><span class="sxs-lookup"><span data-stu-id="5493d-130">Beyond the addition of new features, an important aspect of the NDR engine evolution is a general shift in the approach to interpreters.</span></span> <span data-ttu-id="5493d-131">La versión 1.1 de NDR comenzó como parte de un nuevo enfoque MIDL 2,0 para la serialización, con el código auxiliar en línea que se prefiere para las consideraciones de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="5493d-131">NDR version1.1 began as part of a new MIDL 2.0 approach to marshaling, with the inline stubs being preferred for performance considerations.</span></span> <span data-ttu-id="5493d-132">Con la versión más reciente de NDR, [**– las interfaces**](/windows/desktop/Midl/-oi) se han convertido en el modo de uso más extendido del compilador, casi a la exclusión de códigos auxiliares en línea.</span><span class="sxs-lookup"><span data-stu-id="5493d-132">With the most recent version of NDR, [**–Oif**](/windows/desktop/Midl/-oi) has become the most widely used mode of the compiler, almost to the exclusion of inline stubs.</span></span>

<span data-ttu-id="5493d-133">Los descriptores de cadena de formato del motor NDR de RPC se describen con más detalle en los temas siguientes:</span><span class="sxs-lookup"><span data-stu-id="5493d-133">RPC NDR Engine format string descriptors are described in more detail in the following topics:</span></span>

-   [<span data-ttu-id="5493d-134">Cadenas de formato</span><span class="sxs-lookup"><span data-stu-id="5493d-134">Format Strings</span></span>](format-strings.md)
-   [<span data-ttu-id="5493d-135">Cadenas de formato de procedimiento</span><span class="sxs-lookup"><span data-stu-id="5493d-135">Procedure Format Strings</span></span>](procedure-format-strings.md)
-   [<span data-ttu-id="5493d-136">Descriptor de encabezado de procedimiento</span><span class="sxs-lookup"><span data-stu-id="5493d-136">Procedure Header Descriptor</span></span>](procedure-header-descriptor.md)
-   [<span data-ttu-id="5493d-137">Handles</span><span class="sxs-lookup"><span data-stu-id="5493d-137">Handles</span></span>](handles.md)
-   [<span data-ttu-id="5493d-138">El encabezado</span><span class="sxs-lookup"><span data-stu-id="5493d-138">The Header</span></span>](the-header.md)
-   [<span data-ttu-id="5493d-139">Descriptores de parámetros</span><span class="sxs-lookup"><span data-stu-id="5493d-139">Parameter Descriptors</span></span>](parameter-descriptors.md)
-   [<span data-ttu-id="5493d-140">Cadenas de formato de tipo</span><span class="sxs-lookup"><span data-stu-id="5493d-140">Type Format Strings</span></span>](type-format-strings.md)

 

 