---
title: Crear controladores de búsqueda
description: El shell admite varias utilidades de búsqueda que permiten a los usuarios buscar objetos de espacio de nombres, como archivos o impresoras. Puede crear un motor de búsqueda personalizado y hacer que esté disponible para los usuarios implementando y registrando un controlador de búsqueda.
ms.assetid: ffd023bb-16ab-43ce-b00b-5e32656c8013
keywords:
- Controladores de búsqueda
- registro, controladores de búsqueda
- Controladores de búsqueda estáticos
- registro, controladores de búsqueda estáticos
- Controladores de búsqueda dinámica
- registro, controladores de búsqueda dinámica
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e6476109302a176822137747353b2762b0caea8a
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/19/2020
ms.locfileid: "104358940"
---
# <a name="creating-search-handlers"></a><span data-ttu-id="a5b5d-110">Crear controladores de búsqueda</span><span class="sxs-lookup"><span data-stu-id="a5b5d-110">Creating Search Handlers</span></span>

<span data-ttu-id="a5b5d-111">\[Esta característica solo se admite en Windows XP o versiones anteriores.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-111">\[This feature is supported only under Windows XP or earlier.</span></span> <span data-ttu-id="a5b5d-112">En su lugar, use Windows Search.\]</span><span class="sxs-lookup"><span data-stu-id="a5b5d-112">Use Windows Search instead.\]</span></span>

<span data-ttu-id="a5b5d-113">El shell admite varias utilidades de búsqueda que permiten a los usuarios buscar objetos de espacio de nombres, como archivos o impresoras.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-113">The Shell supports several search utilities that allow users to locate namespace objects such as files or printers.</span></span> <span data-ttu-id="a5b5d-114">Puede crear un motor de búsqueda personalizado y hacer que esté disponible para los usuarios implementando y registrando un *controlador de búsqueda*.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-114">You can create a custom search engine and make it available to users by implementing and registering a *search handler*.</span></span>

<span data-ttu-id="a5b5d-115">Los procedimientos generales para implementar y registrar un controlador de extensión de Shell se explican en [crear controladores de extensión de Shell](/windows/desktop/shell/handlers).</span><span class="sxs-lookup"><span data-stu-id="a5b5d-115">The general procedures for implementing and registering a Shell extension handler are discussed in [Creating Shell Extension Handlers](/windows/desktop/shell/handlers).</span></span> <span data-ttu-id="a5b5d-116">Este documento se centra en los aspectos de la implementación que son específicos de los controladores de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-116">This document focuses on those aspects of implementation that are specific to search handlers.</span></span>

-   [<span data-ttu-id="a5b5d-117">Cómo funcionan los controladores de búsqueda</span><span class="sxs-lookup"><span data-stu-id="a5b5d-117">How Search Handlers Work</span></span>](#how-search-handlers-work)
-   [<span data-ttu-id="a5b5d-118">Registrando controladores de búsqueda</span><span class="sxs-lookup"><span data-stu-id="a5b5d-118">Registering Search Handlers</span></span>](#registering-search-handlers)
    -   [<span data-ttu-id="a5b5d-119">Registrar un controlador de búsqueda estático</span><span class="sxs-lookup"><span data-stu-id="a5b5d-119">Registering a Static Search Handler</span></span>](#registering-a-static-search-handler)
    -   [<span data-ttu-id="a5b5d-120">Registrar un controlador de búsqueda dinámica</span><span class="sxs-lookup"><span data-stu-id="a5b5d-120">Registering a Dynamic Search Handler</span></span>](#registering-a-dynamic-search-handler)
-   [<span data-ttu-id="a5b5d-121">Implementar controladores de búsqueda</span><span class="sxs-lookup"><span data-stu-id="a5b5d-121">Implementing Search Handlers</span></span>](#implementing-search-handlers)

## <a name="how-search-handlers-work"></a><span data-ttu-id="a5b5d-122">Cómo funcionan los controladores de búsqueda</span><span class="sxs-lookup"><span data-stu-id="a5b5d-122">How Search Handlers Work</span></span>

<span data-ttu-id="a5b5d-123">Los usuarios tienen dos maneras de seleccionar un motor de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-123">Users have two ways to select a search engine.</span></span> <span data-ttu-id="a5b5d-124">La primera manera es desde el menú Inicio.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-124">The first way is from the Start menu.</span></span> <span data-ttu-id="a5b5d-125">Con sistemas anteriores a Windows 2000, al seleccionar el comando **Buscar** en el menú **Inicio** se muestra un submenú de los motores de búsqueda disponibles.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-125">With systems earlier than Windows 2000, selecting the **Find** command on the **Start** menu displays a submenu of the available search engines.</span></span> <span data-ttu-id="a5b5d-126">Con Windows 2000 y versiones posteriores, el nombre del comando **Buscar** del menú de **St** Art se cambia a Search.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-126">With Windows 2000 and later, the **St** art menu's **Find** command is renamed Search.</span></span> <span data-ttu-id="a5b5d-127">En la ilustración siguiente se muestra el botón **Buscar** en un sistema Windows XP.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-127">The following illustration shows the **Search** button on a Windows XP system.</span></span>

![el submenú buscar del menú Inicio](images/searchhandler1.jpg)

<span data-ttu-id="a5b5d-129">Los usuarios también pueden iniciar una búsqueda desde el explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-129">Users can also launch a search from Windows Explorer.</span></span> <span data-ttu-id="a5b5d-130">En sistemas anteriores a Windows 2000, se hace clic en el comando **Buscar** del menú **herramientas** para mostrar esencialmente el mismo menú que el asociado al menú **Inicio** .</span><span class="sxs-lookup"><span data-stu-id="a5b5d-130">On systems earlier than Windows 2000, they click the **Find** command on the **Tools** menu to display essentially the same menu as the one associated with the **Start** menu.</span></span> <span data-ttu-id="a5b5d-131">Sin embargo, el explorador de Windows para Windows 2000 controla los motores de búsqueda de una manera muy diferente.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-131">However, Windows Explorer for Windows 2000 handles search engines in a very different way.</span></span> <span data-ttu-id="a5b5d-132">En lugar de controlar los motores de búsqueda como un submenú del menú **herramientas** , ahora hay un botón **Buscar** en la barra de herramientas.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-132">Instead of handling search engines as a submenu of the **Tools** menu, there is now a **Search** button on the toolbar.</span></span> <span data-ttu-id="a5b5d-133">Al hacer clic en este botón, se abre el panel de **búsqueda** de la barra del explorador.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-133">Clicking this button opens the Explorer bar's **Search** pane.</span></span> <span data-ttu-id="a5b5d-134">En la ilustración siguiente se muestra el panel **de búsqueda buscar archivos y carpetas** .</span><span class="sxs-lookup"><span data-stu-id="a5b5d-134">The following illustration shows the **Search For Files And Folders** search pane.</span></span>

![panel de búsqueda de la barra del explorador de Windows](images/searchhandler2.jpg)

<span data-ttu-id="a5b5d-136">Hay una serie de diferencias en el modo en que Windows 2000 y los sistemas anteriores administran los controladores de búsqueda que afectan tanto a la implementación como al registro.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-136">There are a number of differences in how Windows 2000 and earlier systems manage search handlers that affect both implementation and registration.</span></span>



| <span data-ttu-id="a5b5d-137">Anterior a Windows 2000</span><span class="sxs-lookup"><span data-stu-id="a5b5d-137">Pre-Windows 2000</span></span>                                                                                                                                                                                                       | <span data-ttu-id="a5b5d-138">Windows 2000 y versiones posteriores</span><span class="sxs-lookup"><span data-stu-id="a5b5d-138">Windows 2000 and later</span></span>                                                                                                                                                                                                                                                                                            |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="a5b5d-139">Los controladores de búsqueda se implementan como un tipo de [controlador de menú contextual](/windows/desktop/shell/context-menu-handlers).</span><span class="sxs-lookup"><span data-stu-id="a5b5d-139">Search handlers are implemented as a type of [shortcut menu handler](/windows/desktop/shell/context-menu-handlers).</span></span>                                                                                                                     | <span data-ttu-id="a5b5d-140">Los controladores de búsqueda se pueden implementar como controladores de menú contextual o como documentos HTML dinámico (DHTML).</span><span class="sxs-lookup"><span data-stu-id="a5b5d-140">Search handlers can be implemented as shortcut menu handlers, or as Dynamic HTML (DHTML) documents.</span></span>                                                                                                                                                                                                               |
| <span data-ttu-id="a5b5d-141">Los controladores de búsqueda pueden ser estáticos o dinámicos.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-141">Search handlers can be either static or dynamic.</span></span> <span data-ttu-id="a5b5d-142">Los controladores estáticos solo se cargan cuando los selecciona el usuario.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-142">Static handlers are loaded only when they are selected by the user.</span></span> <span data-ttu-id="a5b5d-143">El shell carga los controladores dinámicos en el inicio y no finalizan hasta que se cierra el shell.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-143">Dynamic handlers are loaded by the Shell at startup and are not terminated until the Shell exits.</span></span> | <span data-ttu-id="a5b5d-144">Los controladores implementados como controladores de menús contextuales pueden ser estáticos o dinámicos.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-144">Handlers implemented as shortcut menu handlers can be either static or dynamic.</span></span> <span data-ttu-id="a5b5d-145">Los controladores implementados como documentos DHTML deben ser estáticos.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-145">Handlers implemented as DHTML documents must be static.</span></span>                                                                                                                                                                           |
| <span data-ttu-id="a5b5d-146">Los controladores de búsqueda aparecen en el submenú **Buscar** del menú **Inicio** y en el submenú **Buscar** del menú  **herramientas** del explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-146">Search handlers appear on the **Find** submenu of the **Start** menu and the **Find** submenu of the Windows Explorer **Tools** menu.</span></span>                                                                                  | <span data-ttu-id="a5b5d-147">Los controladores de búsqueda solo aparecen en el submenú **Buscar** del menú **Inicio** .</span><span class="sxs-lookup"><span data-stu-id="a5b5d-147">Search handlers appear only on the **Search** submenu of the **Start** menu.</span></span> <span data-ttu-id="a5b5d-148">Para que un panel de búsqueda personalizado esté disponible a través de la barra de menús del explorador de Windows, debe implementarlo como un [objeto de banda](/previous-versions/windows/desktop/legacy/cc144099(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="a5b5d-148">To make a custom search pane available through the Windows Explorer menu bar, you must implement it as a [band object](/previous-versions/windows/desktop/legacy/cc144099(v=vs.85)).</span></span> <span data-ttu-id="a5b5d-149">A continuación, se muestra en el submenú de la **barra del explorador** del menú  **vista** del explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-149">It is then listed on the **Explorer Bar** submenu of the Windows Explorer **View** menu.</span></span> |



 

## <a name="registering-search-handlers"></a><span data-ttu-id="a5b5d-150">Registrando controladores de búsqueda</span><span class="sxs-lookup"><span data-stu-id="a5b5d-150">Registering Search Handlers</span></span>

<span data-ttu-id="a5b5d-151">Los controladores de búsqueda se registran en la subclave **FindExtensions** de los tipos de archivo.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-151">Search handlers are registered under the file types's **FindExtensions** subkey.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
```

<span data-ttu-id="a5b5d-152">Desde este punto, el procedimiento de registro depende de si el controlador debe ser estático o dinámico.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-152">From this point, the registration procedure depends on whether the handler is to be static or dynamic.</span></span> <span data-ttu-id="a5b5d-153">Para obtener información general sobre cómo registrar controladores de extensión de Shell, vea [crear controladores de extensión de Shell](/windows/desktop/shell/handlers).</span><span class="sxs-lookup"><span data-stu-id="a5b5d-153">For a general discussion of how to register Shell extension handlers, see [Creating Shell Extension Handlers](/windows/desktop/shell/handlers).</span></span>

### <a name="registering-a-static-search-handler"></a><span data-ttu-id="a5b5d-154">Registrar un controlador de búsqueda estático</span><span class="sxs-lookup"><span data-stu-id="a5b5d-154">Registering a Static Search Handler</span></span>

<span data-ttu-id="a5b5d-155">Los controladores de búsqueda estáticos solo se cargan cuando los inicia el usuario.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-155">Static search handlers are loaded only when they are launched by the user.</span></span> <span data-ttu-id="a5b5d-156">Este enfoque funciona mejor para los archivos DLL que son pequeños y se pueden cargar rápidamente.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-156">This approach works best for DLLs that are small and can be loaded quickly.</span></span> <span data-ttu-id="a5b5d-157">Si utiliza DHTML para implementar el controlador, debe ser estático.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-157">If you are using DHTML to implement your handler, it must be static.</span></span> <span data-ttu-id="a5b5d-158">Para registrar un controlador de extensión estático, cree una subclave denominada para el controlador bajo la subclave **static** de la subclave **FindExtensions** .</span><span class="sxs-lookup"><span data-stu-id="a5b5d-158">To register a static extension handler, create a subkey named for the handler under the **Static** subkey of the **FindExtensions** subkey.</span></span> <span data-ttu-id="a5b5d-159">El sistema no utiliza el nombre, pero no debe ser idéntico a otros nombres de controlador de búsqueda de la subclave **FindExtensions** .</span><span class="sxs-lookup"><span data-stu-id="a5b5d-159">The name is not used by the system, but it must not be identical to other search handler names under the **FindExtensions** subkey.</span></span>

### <a name="shortcut-menu-based-search-handlers"></a><span data-ttu-id="a5b5d-160">Controladores de búsqueda basados en menús contextuales</span><span class="sxs-lookup"><span data-stu-id="a5b5d-160">Shortcut menu-based search handlers</span></span>

<span data-ttu-id="a5b5d-161">Si el controlador se implementa como [controlador de menú contextual](/windows/desktop/shell/context-menu-handlers), establezca el valor predeterminado de la subclave Name del controlador en el GUID del identificador de clase (CLSID) del objeto.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-161">If your handler is implemented as a [shortcut menu handler](/windows/desktop/shell/context-menu-handlers), set the default value of the handler's name subkey to the object's class identifier (CLSID) GUID.</span></span> <span data-ttu-id="a5b5d-162">En la subclave nombre del controlador, cree una subclave denominada **0**   (cero) y establezca su valor predeterminado en la cadena que se mostrará en el submenú **Buscar** o **Buscar** .</span><span class="sxs-lookup"><span data-stu-id="a5b5d-162">Under the handler's name subkey, create a subkey named **0** (zero) and set its default value to the string that will be displayed in the **Search** or **Find** submenu.</span></span> <span data-ttu-id="a5b5d-163">Puede habilitar los métodos abreviados de teclado de la manera habitual, precediendo el carácter de acceso directo con una y comercial (&).</span><span class="sxs-lookup"><span data-stu-id="a5b5d-163">You can enable keyboard shortcuts in the usual way, by preceding the shortcut character with an ampersand (&).</span></span> <span data-ttu-id="a5b5d-164">Puede hacer que se muestre un icono pequeño opcional a la derecha del texto del menú mediante la creación de una subclave **DefaultIcon** en la subclave **0** .</span><span class="sxs-lookup"><span data-stu-id="a5b5d-164">You can have an optional small icon displayed to the right of the menu text by creating a **DefaultIcon** subkey under the **0** subkey.</span></span> <span data-ttu-id="a5b5d-165">Establezca su valor predeterminado en una cadena que contenga la ruta de acceso del archivo que contiene el icono, seguida de una coma, seguida del índice basado en cero del icono.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-165">Set its default value to a string containing the path of the file containing the icon, followed by a comma, followed by the icon's zero-based index.</span></span>

<span data-ttu-id="a5b5d-166">En el ejemplo siguiente se registra el controlador de búsqueda de **MySearchEngine** .</span><span class="sxs-lookup"><span data-stu-id="a5b5d-166">The following example registers the **MySearchEngine** search handler.</span></span> <span data-ttu-id="a5b5d-167">El texto del menú es "My Search Engine", donde M se especifica como la tecla de método abreviado.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-167">The menu text is "My Search Engine", with M specified as the shortcut key.</span></span> <span data-ttu-id="a5b5d-168">El icono está en C: \\ MyDir \\MySearch.dll, con un índice de 2.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-168">The icon is in C:\\MyDir\\MySearch.dll, with an index of 2.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
                     Static
                        MySearchEngine
                           (Default) = {MySearchEngine CLSID GUID}
                           0
                              (Default) = &My Search Engine
                              DefaultIcon
                                 (Default) = c:\MyDir\MySearch.dll,2
```

### <a name="dhtml-based-search-handlers"></a><span data-ttu-id="a5b5d-169">Controladores de búsqueda basados en DHTML</span><span class="sxs-lookup"><span data-stu-id="a5b5d-169">DHTML-based search handlers</span></span>

<span data-ttu-id="a5b5d-170">Con Windows 2000, también puede implementar un controlador de búsqueda como un documento DHTML.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-170">With Windows 2000, you can also implement a search handler as a DHTML document.</span></span> <span data-ttu-id="a5b5d-171">Su nombre se muestra en el submenú **Buscar** del menú **Inicio** .</span><span class="sxs-lookup"><span data-stu-id="a5b5d-171">Its name is listed in the **Search** submenu of the **Start** menu.</span></span> <span data-ttu-id="a5b5d-172">Cuando el usuario lo selecciona, inicia el explorador de Windows con la barra del explorador abierta al documento de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-172">When the user selects it, it launches Windows Explorer with the Explorer bar opened to the search document.</span></span> <span data-ttu-id="a5b5d-173">También puede especificar un documento DHTML para que se muestre a la derecha de la barra del explorador.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-173">You can also specify a DHTML document to be displayed to the right of the Explorer bar.</span></span> <span data-ttu-id="a5b5d-174">No hay ninguna manera de iniciar un controlador diferente a partir del panel de búsqueda predeterminado.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-174">There is no way to launch a different handler from the default Search pane.</span></span> <span data-ttu-id="a5b5d-175">Los motores de búsqueda se pueden iniciar directamente desde el explorador de Windows, pero solo si se implementan como [objetos de banda](/previous-versions/windows/desktop/legacy/cc144099(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="a5b5d-175">Search engines can be launched directly from Windows Explorer, but only if they are implemented as as [band objects](/previous-versions/windows/desktop/legacy/cc144099(v=vs.85)).</span></span>

<span data-ttu-id="a5b5d-176">Para registrar un controlador de búsqueda basado en DHTML, establezca la subclave Name del controlador en la forma de cadena de CLSID \_ ShellSearchExt (actualmente {169A0691-8DF9-11D1-A1C4-00C04FD75D13}) y cree las siguientes subclaves.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-176">To register a DHTML-based search handler, set the handler's name subkey to the string form of CLSID\_ShellSearchExt (currently {169A0691-8DF9-11d1-A1C4-00C04FD75D13}) and create the following subkeys.</span></span>

1.  <span data-ttu-id="a5b5d-177">Cree una subclave **0**(cero) en la subclave de nombre de controlador y establezca su valor predeterminado en el texto de menú.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-177">Create a **0**(zero) subkey under the handler name subkey and set its default value to the menu text.</span></span>
2.  <span data-ttu-id="a5b5d-178">Para que se muestre un icono junto al texto del menú, cree una subclave **DefaultIcon** en **0** y establezca su valor predeterminado en la ruta de acceso y el índice del icono.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-178">To have an icon displayed next to the menu text, create a **DefaultIcon** subkey under **0** and set its default value to the icon's path and index.</span></span>
3.  <span data-ttu-id="a5b5d-179">Cree una subclave **SearchGUID** en **0**.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-179">Create a **SearchGUID** subkey under **0**.</span></span> <span data-ttu-id="a5b5d-180">Asigne un GUID al documento DHTML y establezca el valor predeterminado de **SearchGUID** en su forma de cadena.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-180">Assign a GUID to the DHTML document and set the default value of **SearchGUID** to its string form.</span></span> <span data-ttu-id="a5b5d-181">No es necesario registrar este GUID en el **\_ \_ \\ CLSID raíz de las clases HKEY**.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-181">This GUID does not need to be registered under **HKEY\_CLASSES\_ROOT\\CLSID**.</span></span>
4.  <span data-ttu-id="a5b5d-182">Cree una subclave de **dirección URL** en **SearchGUID**.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-182">Create a **Url** subkey under **SearchGUID**.</span></span> <span data-ttu-id="a5b5d-183">Establezca su valor predeterminado en la ruta de acceso del documento HTML que aparecerá en la barra del explorador.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-183">Set its default value to the path of the HTML document that will appear in the Explorer bar.</span></span>
5.  <span data-ttu-id="a5b5d-184">Cree una subclave **UrlNavNew** en **SearchGUID**.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-184">Create a **UrlNavNew** subkey under **SearchGUID**.</span></span> <span data-ttu-id="a5b5d-185">Establezca su valor predeterminado en la ruta de acceso del documento HTML que aparecerá a la derecha de la barra del explorador.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-185">Set its default value to the path of the HTML document that will appear to the right of the Explorer bar.</span></span>

<span data-ttu-id="a5b5d-186">En el ejemplo siguiente se registra el controlador de búsqueda de **MySearchEngine** implementado como un documento DHTML.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-186">The following example registers the **MySearchEngine** search handler implemented as a DHTML document.</span></span> <span data-ttu-id="a5b5d-187">El texto del menú es "My Search Engine", donde M se especifica como la tecla de método abreviado.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-187">The menu text is "My Search Engine", with M specified as the shortcut key.</span></span> <span data-ttu-id="a5b5d-188">El icono está en C: \\ MyDir \\MySearch.dll, con un índice de 2.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-188">The icon is in C:\\MyDir\\MySearch.dll, with an index of 2.</span></span> <span data-ttu-id="a5b5d-189">El documento DHTML de la barra del explorador es C: \\ MyDir \\MySearch.htm y el documento que se mostrará a la derecha de la barra del explorador es c: \\ MyDir \\MySearchPage.htm.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-189">The Explorer bar's DHTML document is C:\\MyDir\\MySearch.htm, and the document that will be displayed to the right of the Explorer bar is C:\\MyDir\\MySearchPage.htm.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
                     Static
                        MySearchEngine
                           (Default) = {169A0691-8DF9-11d1-A1C4-00C04FD75D13}
                           0
                              (Default) = &My Search Engine
                              DefaultIcon
                                 (Default) = c:\MyDir\MySearch.dll,2
                                 SearchGUID
                                    (Default) = {My Search GUID}
                                    Url
                                       (Default) = C:\MyDir\MySearch.htm
                                    UrlNavNew
                                       (Default) = C:\MyDir\MySearchPage.htm
```

### <a name="registering-a-dynamic-search-handler"></a><span data-ttu-id="a5b5d-190">Registrar un controlador de búsqueda dinámica</span><span class="sxs-lookup"><span data-stu-id="a5b5d-190">Registering a Dynamic Search Handler</span></span>

<span data-ttu-id="a5b5d-191">Si el controlador se implementa como un [controlador de menú contextual](/windows/desktop/shell/context-menu-handlers), también puede registrarlo como un controlador dinámico.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-191">If your handler is implemented as a [shortcut menu handler](/windows/desktop/shell/context-menu-handlers), you can also register it as a dynamic handler.</span></span> <span data-ttu-id="a5b5d-192">En ese caso, se cargará con el Shell y finalizará solo cuando se cierre el shell.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-192">In that case, it will be loaded with the Shell and will terminate only when the Shell exits.</span></span> <span data-ttu-id="a5b5d-193">Los controladores de búsqueda dinámica responden mucho más rápidamente que los controladores estáticos cuando los inicia el usuario.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-193">Dynamic search handlers respond much more quickly than static handlers when they are launched by the user.</span></span> <span data-ttu-id="a5b5d-194">Este enfoque funciona mejor si la DLL del controlador puede tardar mucho tiempo en cargarse, o si es probable que se llame con frecuencia.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-194">This approach works best if your handler's DLL might take a long time to load, or if it is likely to be called frequently.</span></span>

<span data-ttu-id="a5b5d-195">Los controladores de búsqueda dinámica se registran en la subclave **FindExtensions** .</span><span class="sxs-lookup"><span data-stu-id="a5b5d-195">Dynamic search handlers are registered under the **FindExtensions** subkey.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
```

<span data-ttu-id="a5b5d-196">Cree una subclave de **FindExtensions** denominada para el controlador y establezca su valor predeterminado en el GUID de CLSID del controlador.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-196">Create a subkey of **FindExtensions** named for the handler, and set its default value to the handler's CLSID GUID.</span></span> <span data-ttu-id="a5b5d-197">Los iconos de menú no se admiten para los controladores de búsqueda dinámica.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-197">Menu icons are not supported for dynamic search handlers.</span></span> <span data-ttu-id="a5b5d-198">En el ejemplo siguiente se registra MySearchEngine como controlador de búsqueda dinámica.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-198">The following example registers MySearchEngine as a dynamic search handler.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
                     MySearchEngine
                        (Default) = {MySearchEngine CLSID GUID}
                        0
                           (Default) = &My Search Engine
```

<span data-ttu-id="a5b5d-199">A diferencia de los controladores de búsqueda estáticos, no se especifica el texto del menú en el registro.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-199">Unlike static search handlers, you do not specify the menu text in the registry.</span></span> <span data-ttu-id="a5b5d-200">Cuando se carga el controlador, el shell llamará al método [**IContextMenu:: QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) del controlador para agregar elementos al submenú **Buscar** o **Buscar** .</span><span class="sxs-lookup"><span data-stu-id="a5b5d-200">When the handler is loaded, the Shell will call the handler's [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) method to add items to the **Find** or **Search** submenu.</span></span>

## <a name="implementing-search-handlers"></a><span data-ttu-id="a5b5d-201">Implementar controladores de búsqueda</span><span class="sxs-lookup"><span data-stu-id="a5b5d-201">Implementing Search Handlers</span></span>

<span data-ttu-id="a5b5d-202">Los controladores de búsqueda se pueden implementar como controladores de menú contextual para todas las versiones de Windows.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-202">Search handlers can be implemented as shortcut menu handlers for all versions of Windows.</span></span> <span data-ttu-id="a5b5d-203">En Windows 2000, también se pueden implementar como documentos DHTML.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-203">For Windows 2000, they can also be implemented as DHTML documents.</span></span>

<span data-ttu-id="a5b5d-204">Para obtener una explicación general sobre cómo implementar controladores de menús contextuales, vea [crear controladores de menús contextuales](/windows/desktop/shell/context-menu-handlers).</span><span class="sxs-lookup"><span data-stu-id="a5b5d-204">For a general discussion of how to implement shortcut menu handlers, see [Creating Context Menu Handlers](/windows/desktop/shell/context-menu-handlers).</span></span> <span data-ttu-id="a5b5d-205">Los controladores de búsqueda se diferencian de los controladores de menú contextual estándar solo en algunas maneras.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-205">Search handlers differ from standard shortcut menu handlers in only a few ways.</span></span>

<span data-ttu-id="a5b5d-206">En el caso de los controladores de menú estáticos, el submenú **Buscar** o **Buscar** se crea a partir de la información del registro.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-206">For static menu handlers, the **Find** or **Search** submenu is created from the information in the registry.</span></span> <span data-ttu-id="a5b5d-207">No es necesario que el controlador agregue un elemento de menú, como haría un controlador de menú contextual normal.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-207">There is no need to have the handler add a menu item, as a normal shortcut menu handler would.</span></span> <span data-ttu-id="a5b5d-208">El shell administra los controladores de menú estáticos de la siguiente manera.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-208">The Shell manages static menu handlers in the following way.</span></span>

-   <span data-ttu-id="a5b5d-209">Cuando el usuario inicia el elemento de menú del controlador, el shell carga el archivo DLL del controlador y llama a [**IContextMenu:: InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) para notificar al controlador que inicie el motor de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-209">When the user launches the handler's menu item, the Shell loads the handler's DLL and calls [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) to notify the handler to launch the search engine.</span></span> <span data-ttu-id="a5b5d-210">No se llama a los métodos [**IShellExtInit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) y [**IContextMenu:: QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) .</span><span class="sxs-lookup"><span data-stu-id="a5b5d-210">The [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) and [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) methods are not called.</span></span>
-   <span data-ttu-id="a5b5d-211">Cuando se llama a [**IContextMenu:: InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) , el miembro **lpVerb** de la estructura [**CMINVOKECOMMANDINFO**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-cminvokecommandinfo) que se pasa identifica el comando.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-211">When [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) is called, the **lpVerb** member of the [**CMINVOKECOMMANDINFO**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-cminvokecommandinfo) structure that is passed in identifies the command.</span></span> <span data-ttu-id="a5b5d-212">La palabra de orden inferior de **lpVerb** se establece en el equivalente numérico del nombre de la subclave del comando.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-212">The low-order word of **lpVerb** is set to the numerical equivalent of the command's subkey name.</span></span> <span data-ttu-id="a5b5d-213">Puesto que esta subclave se denomina normalmente **0**, **lpVerb** normalmente se establece en cero.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-213">Since this subkey is normally named **0**, **lpVerb** is usually set to zero.</span></span> <span data-ttu-id="a5b5d-214">Después, el controlador debe iniciar el motor de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-214">The handler should then launch the search engine.</span></span>

<span data-ttu-id="a5b5d-215">Los controladores de búsqueda dinámica se implementan de forma muy similar a los controladores de menú contextuales normales.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-215">Dynamic search handlers are implemented in much the same way as normal shortcut menu handlers.</span></span> <span data-ttu-id="a5b5d-216">La excepción principal es que cuando se llama a [**IShellExtInit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) , los argumentos *pidlFolder* y *lpdobj* se establecen en **null**.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-216">The primary exception is that when [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) is called, the *pidlFolder* and *lpdobj* arguments are set to **NULL**.</span></span>

<span data-ttu-id="a5b5d-217">Los controladores de búsqueda basados en DHTML se implementan como un documento DHTML normal.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-217">DHTML-based search handlers are implemented as a normal DHTML document.</span></span> <span data-ttu-id="a5b5d-218">Pueden incluir cualquier tecnología HTML, DHTML o de scripting que sea compatible con Windows Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="a5b5d-218">They can include any HTML, DHTML, or scripting technology that is supported by Windows Internet Explorer.</span></span>

 

 