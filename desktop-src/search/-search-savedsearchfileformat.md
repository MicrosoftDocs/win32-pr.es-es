---
description: Los usuarios de Windows pueden guardar las búsquedas como una carpeta de búsqueda generada por un archivo XML que almacena la consulta en un formulario que puede usar el subsistema de búsqueda de Windows.
ms.assetid: 1c73e220-a999-4243-879c-ac7310151def
title: Formato de archivo de búsqueda guardado
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d19cf936f78b045814bf7cba31a123c40d61927a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104540686"
---
# <a name="saved-search-file-format"></a><span data-ttu-id="71b86-103">Formato de archivo de búsqueda guardado</span><span class="sxs-lookup"><span data-stu-id="71b86-103">Saved Search File Format</span></span>

<span data-ttu-id="71b86-104">En Windows Vista y versiones posteriores, los usuarios pueden guardar las búsquedas como una carpeta de búsqueda generada por un archivo XML que almacena la consulta en un formulario que puede usar el subsistema de búsqueda de Windows.</span><span class="sxs-lookup"><span data-stu-id="71b86-104">In Windows Vista and later, users can save searches as a Search Folder which is generated by an XML file that stores the query in a form that can be used by the Windows search subsystem.</span></span> <span data-ttu-id="71b86-105">En este tema se describe el formato de archivo ( \* . Search-MS) e incluye las siguientes secciones:</span><span class="sxs-lookup"><span data-stu-id="71b86-105">This topic describes the file format (\*.search-ms) and includes the following sections:</span></span>

- [<span data-ttu-id="71b86-106">Información general de las búsquedas guardadas</span><span class="sxs-lookup"><span data-stu-id="71b86-106">Overview of Saved Searches</span></span>](#overview-of-saved-searches)
- [<span data-ttu-id="71b86-107">Elemento \<viewInfo></span><span class="sxs-lookup"><span data-stu-id="71b86-107">\<viewInfo> Element</span></span>](/windows)
  - [<span data-ttu-id="71b86-108">\<viewInfo> Sus</span><span class="sxs-lookup"><span data-stu-id="71b86-108">\<viewInfo> Attributes</span></span>](/windows)
  - [<span data-ttu-id="71b86-109">\<viewInfo> Elementos secundarios</span><span class="sxs-lookup"><span data-stu-id="71b86-109">\<viewInfo> Child Elements</span></span>](/windows)
- [<span data-ttu-id="71b86-110">Elemento \<query></span><span class="sxs-lookup"><span data-stu-id="71b86-110">\<query> Element</span></span>](/windows)
  - [<span data-ttu-id="71b86-111">\<query> Elementos secundarios</span><span class="sxs-lookup"><span data-stu-id="71b86-111">\<query> Child Elements</span></span>](/windows)
- [<span data-ttu-id="71b86-112">Elemento \<properties></span><span class="sxs-lookup"><span data-stu-id="71b86-112">\<properties> Element</span></span>](/windows)
- [<span data-ttu-id="71b86-113">Especificación completa del formato de archivo de MS Search</span><span class="sxs-lookup"><span data-stu-id="71b86-113">Full Specification of the search-ms File Format</span></span>](#full-specification-of-the-search-ms-file-format)
- [<span data-ttu-id="71b86-114">Ejemplos de búsquedas guardadas</span><span class="sxs-lookup"><span data-stu-id="71b86-114">Examples of Saved Searches</span></span>](#examples-of-saved-searches)

## <a name="overview-of-saved-searches"></a><span data-ttu-id="71b86-115">Información general de las búsquedas guardadas</span><span class="sxs-lookup"><span data-stu-id="71b86-115">Overview of Saved Searches</span></span>

<span data-ttu-id="71b86-116">Los usuarios pueden guardar una consulta de búsqueda como una carpeta de búsqueda, una carpeta virtual que se muestra en el explorador de Windows en la carpeta búsquedas.</span><span class="sxs-lookup"><span data-stu-id="71b86-116">Users can save a search query as a Search Folder, a virtual folder displayed in Windows Explorer under the Searches folder.</span></span> <span data-ttu-id="71b86-117">Al abrir una carpeta de búsqueda se ejecuta la búsqueda guardada y se muestran los resultados actualizados.</span><span class="sxs-lookup"><span data-stu-id="71b86-117">Opening a Search Folder runs the saved search and displays up-to-date results.</span></span> <span data-ttu-id="71b86-118">El archivo de búsqueda guardado almacena la consulta en un formato en el que Windows Search puede actuar, especificando qué buscar, dónde buscar y cómo presentar los resultados.</span><span class="sxs-lookup"><span data-stu-id="71b86-118">The saved search file stores the query in a format Windows Search can act on, specifying what to search for, where to search, and how to present the results.</span></span>

<span data-ttu-id="71b86-119">La búsqueda guardada se genera a partir de un archivo XML ( \* . Search-MS) en la carpeta% userprofile% \\ búsquedas.</span><span class="sxs-lookup"><span data-stu-id="71b86-119">The saved search is generated from an XML file (\*.search-ms) in the %userprofile%\\Searches folder.</span></span> <span data-ttu-id="71b86-120">Los datos se dividen en tres elementos principales en el archivo XML:</span><span class="sxs-lookup"><span data-stu-id="71b86-120">The data is divided into three primary elements in the XML file:</span></span>

- <span data-ttu-id="71b86-121">\<viewInfo> Especifica la información de presentación</span><span class="sxs-lookup"><span data-stu-id="71b86-121">\<viewInfo> specifies presentation information</span></span>
- <span data-ttu-id="71b86-122">\<query> especifica (buscar información de consulta</span><span class="sxs-lookup"><span data-stu-id="71b86-122">\<query> specifies (search query information</span></span>
- <span data-ttu-id="71b86-123">\<properties> especifica las propiedades del \* propio archivo. Search-MS</span><span class="sxs-lookup"><span data-stu-id="71b86-123">\<properties> specifies properties of the \*.search-ms file itself</span></span>

<span data-ttu-id="71b86-124">En el ejemplo siguiente se muestra la estructura de alto nivel de un archivo de búsqueda guardado.</span><span class="sxs-lookup"><span data-stu-id="71b86-124">The following example shows the high-level structure of a saved search file.</span></span>

```XML
<?xml version="1.0"?>
<persistedQuery version="1.0">

    <viewInfo ...>
        ...
    </viewInfo>

    <query>
        ...
    </query>

    <properties>
        ...
    </properties>

</persistedQuery>
```

## <a name="viewinfo-element"></a><span data-ttu-id="71b86-125">\<viewInfo> (Elemento)</span><span class="sxs-lookup"><span data-stu-id="71b86-125">\<viewInfo> Element</span></span>

<span data-ttu-id="71b86-126">El \<viewInfo> elemento especifica cómo se presentan los resultados al usuario final.</span><span class="sxs-lookup"><span data-stu-id="71b86-126">The \<viewInfo> element specifies how the results are presented to the end user.</span></span> <span data-ttu-id="71b86-127">En el ejemplo siguiente se muestra la estructura del elemento.</span><span class="sxs-lookup"><span data-stu-id="71b86-127">The following example shows the structure of the element.</span></span>

```XML
...
    <viewInfo viewMode=""
              iconSize=""
              stackIconSize=""
              autoListFlags=""
              folderFlags=""
              taskFlags=""
              displayName="">

        <visibleColumns>
            <column viewField=""/>
        </visibleColumns>

        <frequentlyUsedColumns>
            <column viewField= ""/>
        </frequentlyUsedColumns>

        <columnChooserColumns >
            <column viewField=""/>
        </columnChooserColumns >

        <groupBy viewField=""
                 direction=""/>

        <stackList>
            <stack viewField=""/>
        </stackList>

        <sortList>
            <sort viewField=""
                  direction=""/>
        </sortList>
    </viewInfo>
...
```

### <a name="viewinfo-attributes"></a><span data-ttu-id="71b86-128">\<viewInfo> Sus</span><span class="sxs-lookup"><span data-stu-id="71b86-128">\<viewInfo> Attributes</span></span>

<span data-ttu-id="71b86-129">En la tabla siguiente se describen los atributos del elemento \<viewInfo>:</span><span class="sxs-lookup"><span data-stu-id="71b86-129">The following table describes the attributes of the \<viewInfo> element.</span></span>

| <span data-ttu-id="71b86-130">Atributo</span><span class="sxs-lookup"><span data-stu-id="71b86-130">Attribute</span></span>     | <span data-ttu-id="71b86-131">Descripción</span><span class="sxs-lookup"><span data-stu-id="71b86-131">Description</span></span>                                                                     | <span data-ttu-id="71b86-132">Valores</span><span class="sxs-lookup"><span data-stu-id="71b86-132">Values</span></span>                     |
|---------------|---------------------------------------------------------------------------------|----------------------------|
| <span data-ttu-id="71b86-133">viewMode</span><span class="sxs-lookup"><span data-stu-id="71b86-133">viewMode</span></span>      | <span data-ttu-id="71b86-134">Especifica la vista de la carpeta.</span><span class="sxs-lookup"><span data-stu-id="71b86-134">Specifies the folder view.</span></span>                                                      | <span data-ttu-id="71b86-135">\|Iconos de iconos de detalles \|</span><span class="sxs-lookup"><span data-stu-id="71b86-135">Details \| Icons \| Tiles</span></span>  |
| <span data-ttu-id="71b86-136">iconSize</span><span class="sxs-lookup"><span data-stu-id="71b86-136">iconSize</span></span>      | <span data-ttu-id="71b86-137">Controla el tamaño predeterminado de los iconos y las miniaturas de los elementos cuando no están apilados.</span><span class="sxs-lookup"><span data-stu-id="71b86-137">Controls the default size of the icons and thumbnails for items when not stack.</span></span> | <span data-ttu-id="71b86-138">Entero entre 16 y 256</span><span class="sxs-lookup"><span data-stu-id="71b86-138">Integer between 16 and 256</span></span> |
| <span data-ttu-id="71b86-139">stackIconSize</span><span class="sxs-lookup"><span data-stu-id="71b86-139">stackIconSize</span></span> | <span data-ttu-id="71b86-140">Solo para uso interno.</span><span class="sxs-lookup"><span data-stu-id="71b86-140">For internal use only.</span></span> <span data-ttu-id="71b86-141">No debe usarse.</span><span class="sxs-lookup"><span data-stu-id="71b86-141">Do not use.</span></span>                                              | <span data-ttu-id="71b86-142">N/D</span><span class="sxs-lookup"><span data-stu-id="71b86-142">n/a</span></span>                        |
| <span data-ttu-id="71b86-143">DisplayName</span><span class="sxs-lookup"><span data-stu-id="71b86-143">displayName</span></span>   | <span data-ttu-id="71b86-144">Solo para uso interno.</span><span class="sxs-lookup"><span data-stu-id="71b86-144">For internal use only.</span></span> <span data-ttu-id="71b86-145">No debe usarse.</span><span class="sxs-lookup"><span data-stu-id="71b86-145">Do not use.</span></span>                                              | <span data-ttu-id="71b86-146">N/D</span><span class="sxs-lookup"><span data-stu-id="71b86-146">n/a</span></span>                        |
| <span data-ttu-id="71b86-147">autoListFlags</span><span class="sxs-lookup"><span data-stu-id="71b86-147">autoListFlags</span></span> | <span data-ttu-id="71b86-148">Solo para uso interno.</span><span class="sxs-lookup"><span data-stu-id="71b86-148">For internal use only.</span></span> <span data-ttu-id="71b86-149">No debe usarse.</span><span class="sxs-lookup"><span data-stu-id="71b86-149">Do not use.</span></span>                                              | <span data-ttu-id="71b86-150">N/D</span><span class="sxs-lookup"><span data-stu-id="71b86-150">n/a</span></span>                        |
| <span data-ttu-id="71b86-151">folderFlags</span><span class="sxs-lookup"><span data-stu-id="71b86-151">folderFlags</span></span>   | <span data-ttu-id="71b86-152">Solo para uso interno.</span><span class="sxs-lookup"><span data-stu-id="71b86-152">For internal use only.</span></span> <span data-ttu-id="71b86-153">No debe usarse.</span><span class="sxs-lookup"><span data-stu-id="71b86-153">Do not use.</span></span>                                              | <span data-ttu-id="71b86-154">N/D</span><span class="sxs-lookup"><span data-stu-id="71b86-154">n/a</span></span>                        |
| <span data-ttu-id="71b86-155">taskFlags</span><span class="sxs-lookup"><span data-stu-id="71b86-155">taskFlags</span></span>     | <span data-ttu-id="71b86-156">Solo para uso interno.</span><span class="sxs-lookup"><span data-stu-id="71b86-156">For internal use only.</span></span> <span data-ttu-id="71b86-157">No debe usarse.</span><span class="sxs-lookup"><span data-stu-id="71b86-157">Do not use.</span></span>                                              | <span data-ttu-id="71b86-158">N/D</span><span class="sxs-lookup"><span data-stu-id="71b86-158">n/a</span></span>                        |

### <a name="viewinfo-child-elements"></a><span data-ttu-id="71b86-159">\<viewInfo> Elementos secundarios</span><span class="sxs-lookup"><span data-stu-id="71b86-159">\<viewInfo> Child Elements</span></span>

<span data-ttu-id="71b86-160">Los elementos secundarios del \<viewInfo> elemento especifican qué columnas aparecen en los resultados de búsqueda del explorador de Windows y cómo se agrupan y ordenan los resultados.</span><span class="sxs-lookup"><span data-stu-id="71b86-160">The child elements of the \<viewInfo> element specify which columns appear in the Windows Explorer search results and how the results are grouped and sorted.</span></span> <span data-ttu-id="71b86-161">Cada elemento secundario contiene un conjunto ordenado de columnas, identificado por nombres canónicos de propiedades del sistema (por ejemplo, System. DisplayName).</span><span class="sxs-lookup"><span data-stu-id="71b86-161">Each child element contains an ordered set of columns, identified by canonical names of system properties (for example, System.DisplayName).</span></span> <span data-ttu-id="71b86-162">Si no se define en el archivo de búsqueda guardado, los resultados de la búsqueda se presentan con un conjunto predeterminado de columnas adecuado para los tipos de archivo mostrados.</span><span class="sxs-lookup"><span data-stu-id="71b86-162">If not defined in the saved search file, the search results are presented with a default set of columns appropriate for the file types displayed.</span></span>

| <span data-ttu-id="71b86-163">Elemento</span><span class="sxs-lookup"><span data-stu-id="71b86-163">Element</span></span>               | <span data-ttu-id="71b86-164">Descripción</span><span class="sxs-lookup"><span data-stu-id="71b86-164">Description</span></span>                                                                                        | <span data-ttu-id="71b86-165">Valores</span><span class="sxs-lookup"><span data-stu-id="71b86-165">Values</span></span>                                                       |
|-----------------------|----------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
| <span data-ttu-id="71b86-166">visibleColumns</span><span class="sxs-lookup"><span data-stu-id="71b86-166">visibleColumns</span></span>        | <span data-ttu-id="71b86-167">Especifica una lista ordenada de columnas para que aparezca en la vista de resultados.</span><span class="sxs-lookup"><span data-stu-id="71b86-167">Specifies an ordered list of columns to appear in the results view.</span></span> <span data-ttu-id="71b86-168">El usuario puede cambiar esta lista.</span><span class="sxs-lookup"><span data-stu-id="71b86-168">The user can change this list.</span></span> | <span data-ttu-id="71b86-169">Cualquier propiedad del sistema.</span><span class="sxs-lookup"><span data-stu-id="71b86-169">Any system property.</span></span>                                         |
| <span data-ttu-id="71b86-170">frequentlyUsedColumns</span><span class="sxs-lookup"><span data-stu-id="71b86-170">frequentlyUsedColumns</span></span> | <span data-ttu-id="71b86-171">Solo para uso interno.</span><span class="sxs-lookup"><span data-stu-id="71b86-171">For internal use only.</span></span> <span data-ttu-id="71b86-172">No debe usarse.</span><span class="sxs-lookup"><span data-stu-id="71b86-172">Do not use.</span></span>                                                                 | <span data-ttu-id="71b86-173">N/D</span><span class="sxs-lookup"><span data-stu-id="71b86-173">n/a</span></span>                                                          |
| <span data-ttu-id="71b86-174">columnChooserColumns</span><span class="sxs-lookup"><span data-stu-id="71b86-174">columnChooserColumns</span></span>  | <span data-ttu-id="71b86-175">Solo para uso interno.</span><span class="sxs-lookup"><span data-stu-id="71b86-175">For internal use only.</span></span> <span data-ttu-id="71b86-176">No debe usarse.</span><span class="sxs-lookup"><span data-stu-id="71b86-176">Do not use.</span></span>                                                                 | <span data-ttu-id="71b86-177">N/D</span><span class="sxs-lookup"><span data-stu-id="71b86-177">n/a</span></span>                                                          |
| <span data-ttu-id="71b86-178">groupBy</span><span class="sxs-lookup"><span data-stu-id="71b86-178">groupBy</span></span>               | <span data-ttu-id="71b86-179">Especifica una única propiedad del sistema por la que se van a agrupar los resultados.</span><span class="sxs-lookup"><span data-stu-id="71b86-179">Specifies a single system property by which to group the results.</span></span> <span data-ttu-id="71b86-180">El usuario puede cambiar este valor.</span><span class="sxs-lookup"><span data-stu-id="71b86-180">The user can change this value.</span></span>  | <span data-ttu-id="71b86-181">Cualquier propiedad del sistema.</span><span class="sxs-lookup"><span data-stu-id="71b86-181">Any system property.</span></span>                                         |
| <span data-ttu-id="71b86-182">sortList</span><span class="sxs-lookup"><span data-stu-id="71b86-182">sortList</span></span>              | <span data-ttu-id="71b86-183">Especifica una lista ordenada de columnas por las que ordenar los resultados.</span><span class="sxs-lookup"><span data-stu-id="71b86-183">Specifies an ordered list of columns to sort the results by.</span></span>                                       | <span data-ttu-id="71b86-184">Hasta cuatro propiedades del sistema.</span><span class="sxs-lookup"><span data-stu-id="71b86-184">Up to four system properties.</span></span> <span data-ttu-id="71b86-185">El usuario puede cambiar esta lista.</span><span class="sxs-lookup"><span data-stu-id="71b86-185">The user can change this list.</span></span> |
| <span data-ttu-id="71b86-186">stackList</span><span class="sxs-lookup"><span data-stu-id="71b86-186">stackList</span></span>             | <span data-ttu-id="71b86-187">Solo para uso interno.</span><span class="sxs-lookup"><span data-stu-id="71b86-187">For internal use only.</span></span> <span data-ttu-id="71b86-188">No debe usarse.</span><span class="sxs-lookup"><span data-stu-id="71b86-188">Do not use.</span></span>                                                                 | <span data-ttu-id="71b86-189">N/D</span><span class="sxs-lookup"><span data-stu-id="71b86-189">n/a</span></span>                                                          |

## <a name="query-element"></a><span data-ttu-id="71b86-190">\<query> (Elemento)</span><span class="sxs-lookup"><span data-stu-id="71b86-190">\<query> Element</span></span>

<span data-ttu-id="71b86-191">El \<query> elemento especifica los atributos que definen cómo se consultan los resultados.</span><span class="sxs-lookup"><span data-stu-id="71b86-191">The \<query> element specifies the attributes which define how the results are queried.</span></span> <span data-ttu-id="71b86-192">En el ejemplo siguiente se muestra la estructura del elemento.</span><span class="sxs-lookup"><span data-stu-id="71b86-192">The following example shows the structure of the element.</span></span>

```XML
...
    <query>
        <providers>
            <provider clsid=""/>    <!-- Do not use -->
        </providers>

        <subQueries>
            <subQuery path=""/>           <!-- Do not use -->
            <subQuery knownSearch=""/>    <!-- Do not use -->
        </subQueries>

        <scope>
            <include path=""        nonRecursive=""/>   <!-- [path of location to include] -->
            <include knownFolder="" nonRecursive=""/>   <!-- Known folder ID  -->
            <exclude path=""        nonRecursive=""/>   <!-- [path of location to exclude] -->
            <exclude knownFolder="" nonRecursive=""/>   <!-- Known folder ID  -->
        </scope>

        <kindList>
            <kind name=""/>     <!-- Kind value -->
        </kindList>

        <conditions>
            <condition type="" ...>     <!-- andCondition | orCondition | notCondition | leafCondition -->
                <attributes>
                    <attribute attributeID="" .../> <!-- Do not use -->
                </attributes>
            </condition>
        </conditions>
    </query>
...
```

### <a name="query-child-elements"></a><span data-ttu-id="71b86-193">\<query> Elementos secundarios</span><span class="sxs-lookup"><span data-stu-id="71b86-193">\<query> Child Elements</span></span>

<span data-ttu-id="71b86-194">En la siguiente tabla se describen los elementos secundarios del elemento \<scope>.</span><span class="sxs-lookup"><span data-stu-id="71b86-194">The following table describes the child elements of the \<scope> element.</span></span>

| <span data-ttu-id="71b86-195">Elemento</span><span class="sxs-lookup"><span data-stu-id="71b86-195">Element</span></span>    | <span data-ttu-id="71b86-196">Descripción</span><span class="sxs-lookup"><span data-stu-id="71b86-196">Description</span></span>                                                                                                               | <span data-ttu-id="71b86-197">Value</span><span class="sxs-lookup"><span data-stu-id="71b86-197">Value</span></span>                                                                                                                                                                                                                                                          |
|------------|---------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="71b86-198">providers</span><span class="sxs-lookup"><span data-stu-id="71b86-198">providers</span></span>  | <span data-ttu-id="71b86-199">Solo para uso interno.</span><span class="sxs-lookup"><span data-stu-id="71b86-199">For internal use only.</span></span> <span data-ttu-id="71b86-200">No debe usarse.</span><span class="sxs-lookup"><span data-stu-id="71b86-200">Do not use.</span></span>                                                                                        | <span data-ttu-id="71b86-201">N/D</span><span class="sxs-lookup"><span data-stu-id="71b86-201">n/a</span></span>                                                                                                                                                                                                                                                            |
| <span data-ttu-id="71b86-202">Subconsultas</span><span class="sxs-lookup"><span data-stu-id="71b86-202">subQueries</span></span> | <span data-ttu-id="71b86-203">Solo para uso interno.</span><span class="sxs-lookup"><span data-stu-id="71b86-203">For internal use only.</span></span> <span data-ttu-id="71b86-204">No debe usarse.</span><span class="sxs-lookup"><span data-stu-id="71b86-204">Do not use.</span></span>                                                                                        | <span data-ttu-id="71b86-205">N/D</span><span class="sxs-lookup"><span data-stu-id="71b86-205">n/a</span></span>                                                                                                                                                                                                                                                            |
| <span data-ttu-id="71b86-206">Ámbito</span><span class="sxs-lookup"><span data-stu-id="71b86-206">Scope</span></span>      | <span data-ttu-id="71b86-207">Identifica las ubicaciones que se van a incluir o excluir en la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="71b86-207">Identifies locations to include or exclude in the search.</span></span>                                                                 | <span data-ttu-id="71b86-208">Una ruta de acceso o un [identificador de carpeta conocido](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iknownfolder-getid) de la ubicación que se va a incluir o excluir.</span><span class="sxs-lookup"><span data-stu-id="71b86-208">Either a path or a [known folder ID](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iknownfolder-getid) of the location to be included or excluded.</span></span> <span data-ttu-id="71b86-209">Este elemento también puede especificar si la búsqueda debe incluir o excluir las rutas de acceso secundarias (búsqueda superficial o profunda).</span><span class="sxs-lookup"><span data-stu-id="71b86-209">This element can also specify whether the search should include/exclude child paths (a shallow or deep search).</span></span> |
| <span data-ttu-id="71b86-210">kindList</span><span class="sxs-lookup"><span data-stu-id="71b86-210">kindList</span></span>   | <span data-ttu-id="71b86-211">Identifica el tipo de archivos que se van a buscar.</span><span class="sxs-lookup"><span data-stu-id="71b86-211">Identifies the kind of file(s) to search for.</span></span>                                                                             | <span data-ttu-id="71b86-212">Cualquier valor System. Kind.</span><span class="sxs-lookup"><span data-stu-id="71b86-212">Any System.Kind value.</span></span>                                                                                                                                                                                                                                         |
| <span data-ttu-id="71b86-213">condiciones</span><span class="sxs-lookup"><span data-stu-id="71b86-213">conditions</span></span> | <span data-ttu-id="71b86-214">Especifica reglas para filtrar los resultados.</span><span class="sxs-lookup"><span data-stu-id="71b86-214">Specifies rules for filtering results.</span></span> <span data-ttu-id="71b86-215">Por ejemplo, los resultados se pueden limitar a los mensajes de correo electrónico enviados por o a una persona determinada.</span><span class="sxs-lookup"><span data-stu-id="71b86-215">For example, results could be limited to emails sent by or to a particular person.</span></span> | <span data-ttu-id="71b86-216">andCondition, orCondition, notCondition, leafCondition.</span><span class="sxs-lookup"><span data-stu-id="71b86-216">andCondition, orCondition, notCondition, leafCondition.</span></span>                                                                                                                                                                                                        |

### <a name="scope-element"></a><span data-ttu-id="71b86-217">\<scope> (Elemento)</span><span class="sxs-lookup"><span data-stu-id="71b86-217">\<scope> Element</span></span>

<span data-ttu-id="71b86-218">El \<scope> elemento identifica las ubicaciones que se van a incluir o excluir de la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="71b86-218">The \<scope> element identifies the locations to include or exclude from the search.</span></span> <span data-ttu-id="71b86-219">El \<scope> elemento debe contener al menos un \<include> elemento secundario presente y cero o más \<exclude> elementos.</span><span class="sxs-lookup"><span data-stu-id="71b86-219">The \<scope> element must contain at least one \<include> child element present and zero or more \<exclude> elements.</span></span> <span data-ttu-id="71b86-220">Las ubicaciones se pueden especificar como una ruta de acceso (se admiten las variables de entorno) o como un [identificador de carpeta conocido](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iknownfolder-getid).</span><span class="sxs-lookup"><span data-stu-id="71b86-220">The locations can be specified as either a path (environment variables are supported) or as a [known folder identifier](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iknownfolder-getid).</span></span> <span data-ttu-id="71b86-221">Además, se puede especificar que cada una de estas ubicaciones se busque en profundidad o superficial estableciendo no recursiva en "true" o "false" (el valor predeterminado es Recursive).</span><span class="sxs-lookup"><span data-stu-id="71b86-221">Furthermore, each of these locations can be specified to be searched deep or shallow by setting the nonRecursive to "true" or "false" (default is recursive).</span></span> <span data-ttu-id="71b86-222">Las partes de la lista de ubicaciones incluidas se pueden excluir especificando elementos exclude.</span><span class="sxs-lookup"><span data-stu-id="71b86-222">Parts of the included list of locations can be excluded by specifying exclude elements.</span></span>

<span data-ttu-id="71b86-223">A continuación se muestra un \<scope> elemento que buscará en la carpeta especial documentos, pero no en sus elementos secundarios, el volumen "e:" y sus elementos secundarios, pero no el directorio "e: \\ Windows" ni ninguno de sus elementos secundarios:</span><span class="sxs-lookup"><span data-stu-id="71b86-223">The following shows a \<scope> element that will search the documents special folder, but not its children, the "E:" volume and its children, but not "E:\\windows" directory or any of its children:</span></span>

```XML
...
    <query>
        ...
        <scope>
            <include knownFolder="{FDD39AD0-238F-46AF-ADB4-6C85480369C7}" nonRecursive="true"/>
            <include path="E:\"/>
            <exclude path="E:\Windows" nonRecursive="false"/>
        </scope>
        ...
    </query>
...
```

### <a name="kindlist-element"></a><span data-ttu-id="71b86-224">\<kindList> (Elemento)</span><span class="sxs-lookup"><span data-stu-id="71b86-224">\<kindList> Element</span></span>

<span data-ttu-id="71b86-225">Estos elementos definen la Unión del "tipo" de los elementos que deben aparecer en la biblioteca.</span><span class="sxs-lookup"><span data-stu-id="71b86-225">These elements define the union of the "kind" of items that should appear in the library.</span></span> <span data-ttu-id="71b86-226">Los valores válidos son:</span><span class="sxs-lookup"><span data-stu-id="71b86-226">The valid values are:</span></span>

- <span data-ttu-id="71b86-227">calendario</span><span class="sxs-lookup"><span data-stu-id="71b86-227">calendar</span></span>
- <span data-ttu-id="71b86-228">communication</span><span class="sxs-lookup"><span data-stu-id="71b86-228">communication</span></span>
- <span data-ttu-id="71b86-229">contact</span><span class="sxs-lookup"><span data-stu-id="71b86-229">contact</span></span>
- <span data-ttu-id="71b86-230">documento</span><span class="sxs-lookup"><span data-stu-id="71b86-230">document</span></span>
- <span data-ttu-id="71b86-231">email</span><span class="sxs-lookup"><span data-stu-id="71b86-231">email</span></span>
- <span data-ttu-id="71b86-232">feed</span><span class="sxs-lookup"><span data-stu-id="71b86-232">feed</span></span>
- <span data-ttu-id="71b86-233">folder</span><span class="sxs-lookup"><span data-stu-id="71b86-233">folder</span></span>
- <span data-ttu-id="71b86-234">fin</span><span class="sxs-lookup"><span data-stu-id="71b86-234">game</span></span>
- <span data-ttu-id="71b86-235">instantmessage</span><span class="sxs-lookup"><span data-stu-id="71b86-235">instantmessage</span></span>
- <span data-ttu-id="71b86-236">diario</span><span class="sxs-lookup"><span data-stu-id="71b86-236">journal</span></span>
- <span data-ttu-id="71b86-237">link</span><span class="sxs-lookup"><span data-stu-id="71b86-237">link</span></span>
- <span data-ttu-id="71b86-238">ésta</span><span class="sxs-lookup"><span data-stu-id="71b86-238">movie</span></span>
- <span data-ttu-id="71b86-239">music</span><span class="sxs-lookup"><span data-stu-id="71b86-239">music</span></span>
- <span data-ttu-id="71b86-240">nota</span><span class="sxs-lookup"><span data-stu-id="71b86-240">note</span></span>
- <span data-ttu-id="71b86-241">picture</span><span class="sxs-lookup"><span data-stu-id="71b86-241">picture</span></span>
- <span data-ttu-id="71b86-242">programa</span><span class="sxs-lookup"><span data-stu-id="71b86-242">program</span></span>
- <span data-ttu-id="71b86-243">recordedtv</span><span class="sxs-lookup"><span data-stu-id="71b86-243">recordedtv</span></span>
- <span data-ttu-id="71b86-244">searchfolder</span><span class="sxs-lookup"><span data-stu-id="71b86-244">searchfolder</span></span>
- <span data-ttu-id="71b86-245">task</span><span class="sxs-lookup"><span data-stu-id="71b86-245">task</span></span>
- <span data-ttu-id="71b86-246">video</span><span class="sxs-lookup"><span data-stu-id="71b86-246">video</span></span>
- <span data-ttu-id="71b86-247">Historial de webhistory</span><span class="sxs-lookup"><span data-stu-id="71b86-247">webhistory</span></span>
- <span data-ttu-id="71b86-248">item</span><span class="sxs-lookup"><span data-stu-id="71b86-248">item</span></span>
- <span data-ttu-id="71b86-249">Otros</span><span class="sxs-lookup"><span data-stu-id="71b86-249">other</span></span>

### <a name="conditions-element"></a><span data-ttu-id="71b86-250">\<conditions> (Elemento)</span><span class="sxs-lookup"><span data-stu-id="71b86-250">\<conditions> Element</span></span>

<span data-ttu-id="71b86-251">Las condiciones son filtros en los que se comparan los resultados de la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="71b86-251">Conditions are filters against which search results are compared.</span></span> <span data-ttu-id="71b86-252">Por ejemplo, puede filtrar los resultados que cumplen ciertos criterios, como el nombre del autor o el tamaño del archivo.</span><span class="sxs-lookup"><span data-stu-id="71b86-252">For example, you can filter results that meet certain criteria, like author name or file size.</span></span> <span data-ttu-id="71b86-253">El conjunto de condiciones se integra en un único árbol de condición con ramas AND y NOT lógicas.</span><span class="sxs-lookup"><span data-stu-id="71b86-253">The set of conditions are built into a single condition tree with logical AND, OR and NOT branches.</span></span>

<span data-ttu-id="71b86-254">En el ejemplo siguiente se muestra la estructura del \<condition> elemento.</span><span class="sxs-lookup"><span data-stu-id="71b86-254">The following example shows the structure of the \<condition> element.</span></span>

```XML
...
    <query>
        ...
        <conditions>
            <condition type="" ...>
                <attributes>
                    <attribute attributeID="" .../>
                </attributes>
            </condition>
        </conditions>
    </query>
...
```

<span data-ttu-id="71b86-255">El tipo de condición puede ser uno de los siguientes:</span><span class="sxs-lookup"><span data-stu-id="71b86-255">The condition type can be one of the following:</span></span>

| <span data-ttu-id="71b86-256">Tipo</span><span class="sxs-lookup"><span data-stu-id="71b86-256">Type</span></span>          | <span data-ttu-id="71b86-257">Descripción</span><span class="sxs-lookup"><span data-stu-id="71b86-257">Description</span></span>                                 | <span data-ttu-id="71b86-258">Atributos disponibles</span><span class="sxs-lookup"><span data-stu-id="71b86-258">Available Attributes</span></span>                               |
|---------------|---------------------------------------------|----------------------------------------------------|
| <span data-ttu-id="71b86-259">andCondition</span><span class="sxs-lookup"><span data-stu-id="71b86-259">andCondition</span></span>  | <span data-ttu-id="71b86-260">Conjunción de dos o más condiciones secundarias</span><span class="sxs-lookup"><span data-stu-id="71b86-260">Conjunction of two or more child conditions</span></span> | <span data-ttu-id="71b86-261">N/D</span><span class="sxs-lookup"><span data-stu-id="71b86-261">n/a</span></span>                                                |
| <span data-ttu-id="71b86-262">orCondition</span><span class="sxs-lookup"><span data-stu-id="71b86-262">orCondition</span></span>   | <span data-ttu-id="71b86-263">Disyunción de dos de las condiciones secundarias</span><span class="sxs-lookup"><span data-stu-id="71b86-263">Disjunction of two of more child conditions</span></span> | <span data-ttu-id="71b86-264">N/D</span><span class="sxs-lookup"><span data-stu-id="71b86-264">n/a</span></span>                                                |
| <span data-ttu-id="71b86-265">notCondition</span><span class="sxs-lookup"><span data-stu-id="71b86-265">notCondition</span></span>  | <span data-ttu-id="71b86-266">Negación de una condición secundaria</span><span class="sxs-lookup"><span data-stu-id="71b86-266">Negation of a child condition</span></span>               | <span data-ttu-id="71b86-267">N/D</span><span class="sxs-lookup"><span data-stu-id="71b86-267">n/a</span></span>                                                |
| <span data-ttu-id="71b86-268">leafCondition</span><span class="sxs-lookup"><span data-stu-id="71b86-268">leafCondition</span></span> | <span data-ttu-id="71b86-269">Compara una propiedad con el valor</span><span class="sxs-lookup"><span data-stu-id="71b86-269">Compares a property to value</span></span>                | <span data-ttu-id="71b86-270">Property, propertyType, Operator, Value, ValueType</span><span class="sxs-lookup"><span data-stu-id="71b86-270">property, propertyType, operator, value, valuetype</span></span> |

<span data-ttu-id="71b86-271">Los \<leafCondition> atributos del elemento identifican las propiedades y los valores con los que se filtran los resultados.</span><span class="sxs-lookup"><span data-stu-id="71b86-271">The \<leafCondition> element's attributes identify the properties and values the results are filtered against.</span></span>

### <a name="example-conditions-element"></a><span data-ttu-id="71b86-272">Ejemplo: \<conditions> elemento</span><span class="sxs-lookup"><span data-stu-id="71b86-272">Example: \<conditions> Element</span></span>

<span data-ttu-id="71b86-273">En el ejemplo siguiente se filtran los resultados de todos los elementos no leídos creados por John.</span><span class="sxs-lookup"><span data-stu-id="71b86-273">The following example filters results for all unread items authored by John.</span></span> <span data-ttu-id="71b86-274">Es decir, la propiedad System. IsRead es false y la cadena "John" aparece en las propiedades System. Author o System. ItemAuthors.</span><span class="sxs-lookup"><span data-stu-id="71b86-274">That is, the System.IsRead property is false and the string "john" appears in the System.Author or System.ItemAuthors properties.</span></span>

```XML
...
    <query>
        ...
        <conditions>

            <condition type="andCondition">

                <condition type="leafCondition"
                           property="System.IsRead"
                           operator="eq"
                           value="FALSE"/>

                <condition type="orCondition">

                    <condition type="leafCondition"
                               property="System.Author"
                               propertyType="string"
                               operator="wordmatch"
                               value="John"
                               valueType="System.StructuredQueryType.String"/>

                    <condition type="leafCondition"
                               property="System.ItemAuthors"
                               propertyType="string"
                               operator="wordmatch"
                               value="John"
                               valueType="System.StructuredQueryType.String"/>

                </condition>

            </condition>

        </conditions>

    </query>
...
```

## <a name="properties-element"></a><span data-ttu-id="71b86-275">\<properties> (Elemento)</span><span class="sxs-lookup"><span data-stu-id="71b86-275">\<properties> Element</span></span>

<span data-ttu-id="71b86-276">El \<properties> elemento describe las propiedades de la búsqueda guardada.</span><span class="sxs-lookup"><span data-stu-id="71b86-276">The \<properties> element describes the properties of the saved search itself.</span></span> <span data-ttu-id="71b86-277">Los archivos de búsqueda guardados admiten cuatro propiedades: \<author> , \<kind> , \<description> y \<tags> .</span><span class="sxs-lookup"><span data-stu-id="71b86-277">Saved search files support four properties: \<author>, \<kind>, \<description>, and \<tags>.</span></span> <span data-ttu-id="71b86-278">Solo son para uso interno.</span><span class="sxs-lookup"><span data-stu-id="71b86-278">These are for internal use only.</span></span>

## <a name="full-specification-of-the-search-ms-file-format"></a><span data-ttu-id="71b86-279">Especificación completa del formato de archivo de MS Search</span><span class="sxs-lookup"><span data-stu-id="71b86-279">Full Specification of the search-ms File Format</span></span>

<span data-ttu-id="71b86-280">El siguiente es un ejemplo del código XML completo de un archivo de búsqueda guardado.</span><span class="sxs-lookup"><span data-stu-id="71b86-280">The following is an example of the full XML for a saved search file.</span></span>

```XML
<?xml version="1.0"?>

<persistedQuery version="1.0">

    <!-- The viewInfo section defines how results are displayed to the end user -->
    <viewInfo viewMode=""       <!-- details | icons | tiles -->
              iconSize=""       <!-- Integer -->
              stackIconSize=""  <!-- Do not use -->
              displayName=""    <!-- Do not use -->
              folderFlags=""    <!-- Do not use -->
              taskFlags=""      <!-- Do not use -->
              autoListFlags=""> <!-- Do not use -->

        <visibleColumns>
            <column viewField=""/>  <!-- System.[propertyname] -->
        </visibleColumns>

        <frequentlyUsedColumns>
            <column viewField= ""/> <!-- Do not use -->
        </frequentlyUsedColumns>

        <columnChooserColumns >
            <column viewField=""/>  <!-- Do not use -->
        </columnChooserColumns >

        <groupBy viewField=""       <!-- System.[propertyname] -->
                 direction=""/>     <!-- ascending | descending -->

        <stackList>
            <stack viewField=""/>   <!-- Do not use -->
        </stackList>

        <sortList>
            <sort viewField=""      <!-- System.[propertyname] -->
                  direction=""/>    <!-- ascending | descending -->
        </sortList>
    </viewInfo>

    <!-- The query section defines what gets searched (locations, file kinds) -->
    <query>
        <providers>
            <provider clsid=""/>          <!-- Do not use -->
        </providers>

        <subQueries>
            <subQuery path=""/>           <!-- Do not use -->
            <subQuery knownSearch=""/>    <!-- Do not use -->
        </subQueries>

        <scope>
            <include path=""        nonRecursive=""/>   <!-- [path of location to include] -->
            <include knownFolder="" nonRecursive=""/>   <!-- Known folder ID  -->
            <exclude path=""        nonRecursive=""/>   <!-- [path of location to exclude] -->
            <exclude knownFolder="" nonRecursive=""/>   <!-- Known folder ID  -->
        </scope>

        <kindList>
            <kind name=""/>     <!-- Kind value -->
        </kindList>

        <conditions>
            <condition type="" ...>     <!-- andCondition | orCondition | notCondition | leafCondition -->
                <attributes>
                    <attribute attributeID="" .../> <!-- Do not use -->
                </attributes>
            </condition>
        </conditions>
    </query>

    <!-- The properties section identifies properties of the saved search file itself. -->
    <properties>
        ...             <!-- Do not use -->
    </properties>

</persistedQuery>
```

## <a name="examples-of-saved-searches"></a><span data-ttu-id="71b86-281">Ejemplos de búsquedas guardadas</span><span class="sxs-lookup"><span data-stu-id="71b86-281">Examples of Saved Searches</span></span>

<span data-ttu-id="71b86-282">A continuación se muestran ejemplos de \* . Search-MS files.</span><span class="sxs-lookup"><span data-stu-id="71b86-282">The following are examples of \*.search-ms files.</span></span>

### <a name="recent-documentssearch-ms"></a><span data-ttu-id="71b86-283">Documentos recientes. Search-MS</span><span class="sxs-lookup"><span data-stu-id="71b86-283">Recent Documents.search-ms</span></span>

```XML
<?xml version="1.0"?>
<persistedQuery version="1.0">
    <viewInfo viewMode="details" iconSize="16">
        <sortList>
            <sort viewField="System.DateModified" direction="descending"/>
        </sortList>
    </viewInfo>

    <query>
        <conditions>
            <condition type="leafCondition" valuetype="System.StructuredQueryType.DateTime" property="System.DateModified" operator="imp" value="R00UUUUUUUUZZXD-30NU" propertyType="wstr" />
        </conditions>
        <kindList>
            <kind name="Document"/>
        </kindList>
        <subQueries>
            <subQuery knownSearch="{4f800859-0bd6-4e63-bbdc-38d3b616ca48}"/>
        </subQueries>
    </query>
</persistedQuery>
```

### <a name="recent-musicsearch-ms"></a><span data-ttu-id="71b86-284">Música reciente. Search-MS</span><span class="sxs-lookup"><span data-stu-id="71b86-284">Recent Music.search-ms</span></span>

```XML
<?xml version="1.0"?>
<persistedQuery version="1.0">
    <viewInfo viewMode="details" iconSize="16">
        <sortList>
            <sort viewField="System.DateModified" direction="descending"/>
        </sortList>
    </viewInfo>

    <query>
        <conditions>
            <condition type="leafCondition" valuetype="System.StructuredQueryType.DateTime" property="System.DateModified" operator="imp" value="R00UUUUUUUUW-1WNNU" propertyType="wstr"/>
        </conditions>
        <kindList>
            <kind name="Music"/>
        </kindList>
        <subQueries>
            <subQuery knownSearch="{4f800859-0bd6-4e63-bbdc-38d3b616ca48}"/>
        </subQueries>
    </query>
</persistedQuery>
```

### <a name="recently-shared-by-mesearch-ms"></a><span data-ttu-id="71b86-285">Compartidos recientemente por mí. Search-MS</span><span class="sxs-lookup"><span data-stu-id="71b86-285">Recently Shared by Me.search-ms</span></span>

```XML
<?xml version="1.0"?>
<persistedQuery version="1.0">
    <viewInfo viewMode="details" iconSize="16">
        <visibleColumns>
            <column viewField="System.ItemNameDisplay"/>
            <column viewField="System.DateModified"/>
            <column viewField="System.Keywords"/>
            <column viewField="System.SharedWith"/>
            <column viewField="System.ItemFolderPathDisplayNarrow"/>
        </visibleColumns>
        <frequentlyUsedColumns>
            <column viewField="System.Author"/>
            <column viewField="System.Kind"/>
            <column viewField="System.Size"/>
            <column viewField="System.Title"/>
            <column viewField="System.Rating"/>
        </frequentlyUsedColumns>
        <sortList>
            <sort viewField="System.SharedWith" direction="descending"/>
        </sortList>
    </viewInfo>

    <query>
        <conditions>
            <condition type="andCondition">
                <condition type="leafCondition" property="System.IsShared" operator="eq" value="true"/>
                <condition type="leafCondition" property="System.FileOwner" operator="eq" value="[Me]"/>
            </condition>
        </conditions>
        <kindList>
            <kind name="item"/>
        </kindList>
        <scope>
            <include knownFolder="{5E6C858F-0E22-4760-9AFE-EA3317B67173}"/>
            <include knownFolder="{DFDF76A2-C82A-4D63-906A-5644AC457385}"/>
        </scope>
    </query>
</persistedQuery>
```
