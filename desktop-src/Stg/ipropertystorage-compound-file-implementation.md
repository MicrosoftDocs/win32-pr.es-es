---
title: IPropertyStorage-Compound la implementación de archivos
description: La implementación COM de la arquitectura de almacenamiento estructurado se denomina archivos compuestos.
ms.assetid: c4b4f313-de58-44f2-8ce1-a07cc187d8ca
keywords:
- IPropertyStorage Strctd STG, implementaciones, archivo compuesto
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 03d927b0145077f12e5ba508ca65554ca33633a3
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "103904669"
---
# <a name="ipropertystorage-compound-file-implementation"></a><span data-ttu-id="59eca-104">IPropertyStorage-Compound la implementación de archivos</span><span class="sxs-lookup"><span data-stu-id="59eca-104">IPropertyStorage-Compound File Implementation</span></span>

<span data-ttu-id="59eca-105">La implementación COM de la arquitectura de almacenamiento estructurado se denomina [archivos compuestos](istorage-compound-file-implementation.md).</span><span class="sxs-lookup"><span data-stu-id="59eca-105">The COM implementation of the Structured Storage architecture is called [compound files](istorage-compound-file-implementation.md).</span></span> <span data-ttu-id="59eca-106">Los objetos de almacenamiento tal como se implementan en archivos compuestos incluyen una implementación de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), la interfaz que administra un único conjunto de propiedades persistentes y [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage), la interfaz que administra grupos de conjuntos de propiedades persistentes.</span><span class="sxs-lookup"><span data-stu-id="59eca-106">Storage objects as implemented in compound files include an implementation of both [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), the interface that manages a single persistent property set, and [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage), the interface that manages groups of persistent property sets.</span></span> <span data-ttu-id="59eca-107">Para obtener más información sobre la interfaz **IPropertyStorage** , consulte consideraciones sobre el [almacenamiento de propiedades](property-storage-considerations.md)y **IPropertyStorage** .</span><span class="sxs-lookup"><span data-stu-id="59eca-107">For more information about the **IPropertyStorage** interface, see **IPropertyStorage** and [Property Storage Considerations](property-storage-considerations.md).</span></span>

<span data-ttu-id="59eca-108">Para obtener un puntero a la implementación de archivo compuesto de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), llame a [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) para crear un nuevo objeto de archivo compuesto o [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) para abrir un objeto de archivo compuesto creado previamente.</span><span class="sxs-lookup"><span data-stu-id="59eca-108">To get a pointer to the compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), call [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) to create a new compound file object or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) to open a previously created compound file object.</span></span> <span data-ttu-id="59eca-109">En el caso de **StgCreateStorageEx**, el parámetro *stgfmt* debe establecerse en stgfmt \_ Storage.</span><span class="sxs-lookup"><span data-stu-id="59eca-109">In the case of **StgCreateStorageEx**, the *stgfmt* parameter should be set to STGFMT\_STORAGE.</span></span> <span data-ttu-id="59eca-110">En el caso de **StgOpenStorageEx**, el parámetro *stgfmt* debe establecerse en stgfmt \_ Storage o stgfmt \_ any.</span><span class="sxs-lookup"><span data-stu-id="59eca-110">In the case of **StgOpenStorageEx**, the *stgfmt* parameter should be set to STGFMT\_STORAGE or STGFMT\_ANY.</span></span> <span data-ttu-id="59eca-111">En ambos casos, el parámetro *riid* debe establecerse en IID \_ IPropertySetStorage.</span><span class="sxs-lookup"><span data-stu-id="59eca-111">In both cases, the *riid* parameter should be set to IID\_IPropertySetStorage.</span></span> <span data-ttu-id="59eca-112">Ambas funciones proporcionan un puntero a la interfaz [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) del objeto.</span><span class="sxs-lookup"><span data-stu-id="59eca-112">Both functions supply a pointer to the object [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface.</span></span> <span data-ttu-id="59eca-113">Llamando al método [**Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) o [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) de la interfaz, obtendrá un puntero a la interfaz **IPropertyStorage** , que puede usar para llamar a cualquiera de sus métodos.</span><span class="sxs-lookup"><span data-stu-id="59eca-113">By calling either the [**Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) or [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) method of that interface, you will get a pointer to the **IPropertyStorage** interface, which you can use to call any of its methods.</span></span>

<span data-ttu-id="59eca-114">Una manera alternativa de obtener un puntero a la implementación de archivo compuesto de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) es llamar a las funciones anteriores [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) y [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) , o especificar un parámetro *riid* de IID \_ IStorage para la función [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) o [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) .</span><span class="sxs-lookup"><span data-stu-id="59eca-114">An alternative way to get a pointer to the compound file implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) is to call the older [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) and [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) functions, or to specify an *riid* parameter of IID\_IStorage to the [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) function.</span></span> <span data-ttu-id="59eca-115">En cualquier caso, se devuelve un puntero a la interfaz [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) del objeto.</span><span class="sxs-lookup"><span data-stu-id="59eca-115">In either case, a pointer to the object's [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) interface is returned.</span></span> <span data-ttu-id="59eca-116">Con conjuntos de propiedades persistentes, llame a [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) para la interfaz **IPropertySetStorage** , especificando el nombre definido por el encabezado para el IID del identificador de interfaz (IID) \_ IPropertySetStorage.</span><span class="sxs-lookup"><span data-stu-id="59eca-116">With persistent property sets, call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) for the **IPropertySetStorage** interface, specifying the header-defined name for the interface identifier (IID) IID\_IPropertySetStorage.</span></span>

## <a name="when-to-use"></a><span data-ttu-id="59eca-117">Cuándo usar</span><span class="sxs-lookup"><span data-stu-id="59eca-117">When to Use</span></span>

<span data-ttu-id="59eca-118">Use [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) para administrar propiedades dentro de un único conjunto de propiedades.</span><span class="sxs-lookup"><span data-stu-id="59eca-118">Use [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) to manage properties within a single property set.</span></span> <span data-ttu-id="59eca-119">Sus métodos permiten leer, escribir y eliminar ambas propiedades y los nombres de cadena opcionales que se pueden asociar a los identificadores de propiedad.</span><span class="sxs-lookup"><span data-stu-id="59eca-119">Its methods support reading, writing, and deleting both properties and the optional string names that can be associated with property identifiers.</span></span> <span data-ttu-id="59eca-120">Otros métodos admiten las operaciones de almacenamiento estándar commit y Revert.</span><span class="sxs-lookup"><span data-stu-id="59eca-120">Other methods support the standard commit and revert storage operations.</span></span> <span data-ttu-id="59eca-121">También hay un método que permite establecer las horas asociadas al almacenamiento de propiedades y otro que permite la asignación de un CLSID que se puede utilizar para asociar otro código, como el código de la interfaz de usuario, con el conjunto de propiedades.</span><span class="sxs-lookup"><span data-stu-id="59eca-121">There is also a method that enables you to set times associated with the property storage, and another that permits the assignment of a CLSID that can be used to associate other code, such as user interface code, with the property set.</span></span> <span data-ttu-id="59eca-122">La llamada al método [**enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) proporciona un puntero a la implementación de archivo compuesto de [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), que permite enumerar las propiedades del conjunto.</span><span class="sxs-lookup"><span data-stu-id="59eca-122">Calling the [**Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) method supplies a pointer to the compound file implementation of [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), which allows you to enumerate the properties in the set.</span></span>

> [!Note]  
> <span data-ttu-id="59eca-123">Si obtiene un puntero a [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) llamando a [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile), [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex), [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) o [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) en un almacenamiento de conjunto de propiedades de modo simple, los métodos **IPropertyStorage** se adhieren a las reglas de flujos de modo simple.</span><span class="sxs-lookup"><span data-stu-id="59eca-123">If you obtain a pointer to [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) by calling [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile), [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex), [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) on a simple-mode property set storage, the **IPropertyStorage** methods adhere to the rules of simple-mode streams.</span></span> <span data-ttu-id="59eca-124">El almacenamiento del conjunto de propiedades es un modo simple si se obtuvo para un archivo que se creó o se abrió con la \_ marca simple STGM.</span><span class="sxs-lookup"><span data-stu-id="59eca-124">The property set storage is simple mode if it was obtained for a file that was created or opened with the STGM\_SIMPLE flag.</span></span> <span data-ttu-id="59eca-125">En este caso, no siempre es posible aumentar el flujo subyacente y no es posible reemplazar las propiedades existentes con propiedades más grandes.</span><span class="sxs-lookup"><span data-stu-id="59eca-125">In this case, it is not always possible to make the underlying stream larger and it is not possible to replace existing properties with larger properties.</span></span> <span data-ttu-id="59eca-126">Para obtener más información, vea [IPropertySetStorage: implementación de archivos compuestos](ipropertysetstorage-compound-file-implementation.md).</span><span class="sxs-lookup"><span data-stu-id="59eca-126">For more information, see [IPropertySetStorage-Compound File Implementation](ipropertysetstorage-compound-file-implementation.md).</span></span>

 

## <a name="ipropertystorage-and-caching"></a><span data-ttu-id="59eca-127">IPropertyStorage y Caching</span><span class="sxs-lookup"><span data-stu-id="59eca-127">IPropertyStorage and Caching</span></span>

<span data-ttu-id="59eca-128">La implementación de archivo compuesto de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) almacena en caché los conjuntos de propiedades abiertos en memoria para mejorar el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="59eca-128">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) caches open property sets in memory in order to improve performance.</span></span> <span data-ttu-id="59eca-129">Como resultado, los cambios en un conjunto de propiedades no se escriben en el archivo compuesto hasta que se llama a los métodos [**commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) o **Release** (última referencia).</span><span class="sxs-lookup"><span data-stu-id="59eca-129">As a result, changes to a property set are not written to the compound file until the [**Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) or **Release** (last reference) methods are called.</span></span>

## <a name="simple-mode-property-sets"></a><span data-ttu-id="59eca-130">Conjuntos de propiedades de modo simple</span><span class="sxs-lookup"><span data-stu-id="59eca-130">Simple Mode Property Sets</span></span>

<span data-ttu-id="59eca-131">Un objeto de almacenamiento de propiedades está en modo simple si se crea a partir de un objeto de almacenamiento de conjunto de propiedades de modo simple.</span><span class="sxs-lookup"><span data-stu-id="59eca-131">A property storage object is in simple mode if it is created from a simple mode property set storage object.</span></span> <span data-ttu-id="59eca-132">Por ejemplo, un objeto de almacenamiento de conjunto de propiedades sería en modo simple si se obtuvo de la función [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) , con la \_ marca simple STGM establecida en el parámetro *grfMode* .</span><span class="sxs-lookup"><span data-stu-id="59eca-132">For example, a property set storage object would be in simple mode if it were obtained from the [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) function, with the STGM\_SIMPLE flag set in the *grfMode* parameter.</span></span> <span data-ttu-id="59eca-133">Tenga en cuenta que "modo simple" no está relacionado con "conjuntos de propiedades simples".</span><span class="sxs-lookup"><span data-stu-id="59eca-133">Note that "simple mode" is unrelated to "simple property sets".</span></span> <span data-ttu-id="59eca-134">Un conjunto de propiedades es sencillo si se crea llamando a [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) con la marca de PROPSETFLAG no \_ simple establecida en el parámetro *grfFlags* .</span><span class="sxs-lookup"><span data-stu-id="59eca-134">A property set is simple if it is created by calling [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) with the PROPSETFLAG\_NONSIMPLE flag set in the *grfFlags* parameter.</span></span> <span data-ttu-id="59eca-135">Para obtener más información sobre los conjuntos de propiedades simples y no simples, vea [almacenamiento y objetos de secuencia para un conjunto de propiedades](storage-vs--stream-for-a-property-set.md).</span><span class="sxs-lookup"><span data-stu-id="59eca-135">For more information about simple and nonsimple property sets, see [Storage and Stream Objects for a Property Set](storage-vs--stream-for-a-property-set.md).</span></span>

<span data-ttu-id="59eca-136">Cuando se crea un objeto de almacenamiento de propiedades de modo simple, no hay restricciones en su uso.</span><span class="sxs-lookup"><span data-stu-id="59eca-136">When a simple mode property storage object is created, there are no restrictions on its use.</span></span> <span data-ttu-id="59eca-137">Cuando se abre un objeto de almacenamiento de propiedades de modo simple existente, no se puede incrementar el objeto de secuencia subyacente que almacena el conjunto de propiedades.</span><span class="sxs-lookup"><span data-stu-id="59eca-137">When an existing simple-mode property storage object is opened, the underlying stream object that stores the property set cannot be grown.</span></span> <span data-ttu-id="59eca-138">Por consiguiente, no siempre es posible modificar este tipo de objeto de almacenamiento de propiedades si el cambio requiere una secuencia más grande.</span><span class="sxs-lookup"><span data-stu-id="59eca-138">Consequently, it is not always possible to modify such a property storage object if the change requires a larger stream.</span></span>

## <a name="property-set-formats"></a><span data-ttu-id="59eca-139">Formatos de conjunto de propiedades</span><span class="sxs-lookup"><span data-stu-id="59eca-139">Property Set Formats</span></span>

<span data-ttu-id="59eca-140">La implementación de archivo compuesto de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) admite los formatos de serialización de la versión 0 y la de la versión 1.</span><span class="sxs-lookup"><span data-stu-id="59eca-140">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) supports both the version 0 and the version 1 property set serialization formats.</span></span> <span data-ttu-id="59eca-141">El formato de la versión 1 se admite en equipos que ejecutan Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="59eca-141">The version 1 format is supported on computers running on Windows 2000.</span></span> <span data-ttu-id="59eca-142">Para obtener más información, vea [serialización de conjuntos de propiedades](version-0-vs--version-1-property-set-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="59eca-142">For more information, see [Property Set Serialization](version-0-vs--version-1-property-set-serialization.md).</span></span> <span data-ttu-id="59eca-143">Los conjuntos de propiedades se crean en el formato de la versión 0 y permanecen en ese formato a menos que se soliciten nuevas características.</span><span class="sxs-lookup"><span data-stu-id="59eca-143">Property sets are created in version 0 format and remain in that format unless new features are requested.</span></span> <span data-ttu-id="59eca-144">En ese caso, el formato se actualiza a la versión 1.</span><span class="sxs-lookup"><span data-stu-id="59eca-144">When that occurs, the format is updated to version 1.</span></span>

<span data-ttu-id="59eca-145">Por ejemplo, si se crea un conjunto de propiedades con la \_ marca predeterminada PROPSETFLAG, su formato es la versión 0.</span><span class="sxs-lookup"><span data-stu-id="59eca-145">For example, if a property set is created with the PROPSETFLAG\_DEFAULT flag, its format is version 0.</span></span> <span data-ttu-id="59eca-146">Siempre que los tipos de propiedad que se ajustan al formato de la versión 0 se escriben y se leen de ese conjunto de propiedades, el conjunto de propiedades permanece en formato de la versión 0.</span><span class="sxs-lookup"><span data-stu-id="59eca-146">As long as property types that conform to the version 0 format are written to and read from that property set, the property set remains in version 0 format.</span></span> <span data-ttu-id="59eca-147">Si un tipo de propiedad de la versión 1 se escribe en el conjunto de propiedades, el conjunto de propiedades se actualiza automáticamente a la versión 1.</span><span class="sxs-lookup"><span data-stu-id="59eca-147">If a version 1 property type is written to the property set, the property set is automatically updated to version 1.</span></span> <span data-ttu-id="59eca-148">Posteriormente, las implementaciones que reconocen solo la versión 0 ya no podrán leer ese conjunto de propiedades.</span><span class="sxs-lookup"><span data-stu-id="59eca-148">Subsequently, that property set can no longer be read by implementations that recognize only version 0.</span></span>

## <a name="ipropertystorage-and-variant-types"></a><span data-ttu-id="59eca-149">Tipos IPropertyStorage y Variant</span><span class="sxs-lookup"><span data-stu-id="59eca-149">IPropertyStorage and Variant Types</span></span>

<span data-ttu-id="59eca-150">La implementación de archivo compuesto de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) no admite los tipos Variant VT \_ Unknown o VT \_ Dispatch en el miembro **VT** de la estructura [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="59eca-150">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) does not support the variant types VT\_UNKNOWN or VT\_DISPATCH in the **vt** member of the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

<span data-ttu-id="59eca-151">En la tabla siguiente se enumeran los tipos Variant que se admiten en SafeArray; es decir, estos valores se pueden combinar con \_ la matriz VT en el miembro **VT** de la estructura [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="59eca-151">The following table lists variant types that are supported within a SafeArray; that is, these values can be combined with VT\_ARRAY in the **vt** member of the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>



<span data-ttu-id="59eca-152">Tipos de variante admitidos en SafeArray por implementación de archivo compuesto de IPropertyStorage</span><span class="sxs-lookup"><span data-stu-id="59eca-152">Variant types supported within SafeArray by compound file implementation of IPropertyStorage</span></span>

<span data-ttu-id="59eca-153">VT \_ I1</span><span class="sxs-lookup"><span data-stu-id="59eca-153">VT\_I1</span></span>

<span data-ttu-id="59eca-154">VT \_ UI1</span><span class="sxs-lookup"><span data-stu-id="59eca-154">VT\_UI1</span></span>

<span data-ttu-id="59eca-155">I2 de VT \_</span><span class="sxs-lookup"><span data-stu-id="59eca-155">VT\_I2</span></span>

<span data-ttu-id="59eca-156">VT \_ UI2</span><span class="sxs-lookup"><span data-stu-id="59eca-156">VT\_UI2</span></span>

<span data-ttu-id="59eca-157">VT \_ I4</span><span class="sxs-lookup"><span data-stu-id="59eca-157">VT\_I4</span></span>

<span data-ttu-id="59eca-158">VT \_ UI4</span><span class="sxs-lookup"><span data-stu-id="59eca-158">VT\_UI4</span></span>

<span data-ttu-id="59eca-159">VT \_ int</span><span class="sxs-lookup"><span data-stu-id="59eca-159">VT\_INT</span></span>

<span data-ttu-id="59eca-160">VT \_ uint</span><span class="sxs-lookup"><span data-stu-id="59eca-160">VT\_UINT</span></span>

<span data-ttu-id="59eca-161">VT \_ R4</span><span class="sxs-lookup"><span data-stu-id="59eca-161">VT\_R4</span></span>

<span data-ttu-id="59eca-162">VT \_ R8</span><span class="sxs-lookup"><span data-stu-id="59eca-162">VT\_R8</span></span>

<span data-ttu-id="59eca-163">VT \_ CY</span><span class="sxs-lookup"><span data-stu-id="59eca-163">VT\_CY</span></span>

<span data-ttu-id="59eca-164">fecha de VT \_</span><span class="sxs-lookup"><span data-stu-id="59eca-164">VT\_DATE</span></span>

<span data-ttu-id="59eca-165">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="59eca-165">VT\_BSTR</span></span>

<span data-ttu-id="59eca-166">VT \_ bool</span><span class="sxs-lookup"><span data-stu-id="59eca-166">VT\_BOOL</span></span>

<span data-ttu-id="59eca-167">VT \_ decimal</span><span class="sxs-lookup"><span data-stu-id="59eca-167">VT\_DECIMAL</span></span>

<span data-ttu-id="59eca-168">ERROR de VT \_</span><span class="sxs-lookup"><span data-stu-id="59eca-168">VT\_ERROR</span></span>

<span data-ttu-id="59eca-169">VT ( \_ variante)</span><span class="sxs-lookup"><span data-stu-id="59eca-169">VT\_VARIANT</span></span>

 



 

<span data-ttu-id="59eca-170">Cuando \_ se combina VT Variant con una \_ matriz de VT, el propio SafeArray contiene estructuras [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="59eca-170">When VT\_VARIANT is combined with VT\_ARRAY, the SafeArray itself holds [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structures.</span></span> <span data-ttu-id="59eca-171">Sin embargo, los tipos de estos elementos se deben tomar de la lista anterior, no pueden ser de \_ tipo VT y no pueden incluir los indicadores de VT \_ , \_ matriz VT o VT \_ BYREF.</span><span class="sxs-lookup"><span data-stu-id="59eca-171">However, the types of these elements must be taken from the preceding list, cannot be VT\_VARIANT, and cannot include the VT\_VECTOR, VT\_ARRAY, or VT\_BYREF indicators.</span></span>

## <a name="ipropertystorage-methods"></a><span data-ttu-id="59eca-172">Métodos IPropertyStorage</span><span class="sxs-lookup"><span data-stu-id="59eca-172">IPropertyStorage Methods</span></span>

<span data-ttu-id="59eca-173">La implementación de archivo compuesto de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) admite los siguientes métodos:</span><span class="sxs-lookup"><span data-stu-id="59eca-173">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) supports the following methods:</span></span>

<dl> <dt>

<span data-ttu-id="59eca-174"><span id="IPropertyStorage__ReadMultiple"></span><span id="ipropertystorage__readmultiple"></span><span id="IPROPERTYSTORAGE__READMULTIPLE"></span>[**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple)</span><span class="sxs-lookup"><span data-stu-id="59eca-174"><span id="IPropertyStorage__ReadMultiple"></span><span id="ipropertystorage__readmultiple"></span><span id="IPROPERTYSTORAGE__READMULTIPLE"></span>[**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple)</span></span>
</dt> <dd>

<span data-ttu-id="59eca-175">Lee las propiedades especificadas en la matriz *rgpspec* y proporciona los valores de todas las propiedades válidas en la matriz *rgvar* de PROPVARIANTs.</span><span class="sxs-lookup"><span data-stu-id="59eca-175">Reads the properties specified in the *rgpspec* array and supplies the values of all valid properties in the *rgvar* array of PROPVARIANTs.</span></span> <span data-ttu-id="59eca-176">En la implementación de archivo compuesto COM, los identificadores de propiedad duplicados que hacen referencia a los tipos de flujo o de almacenamiento dan como resultado varias llamadas a [**IStorage:: OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) o [**IStorage:: OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) y el éxito o el error de **ReadMultiple** depende de la capacidad de la implementación de almacenamiento subyacente para compartir operaciones de apertura.</span><span class="sxs-lookup"><span data-stu-id="59eca-176">In the COM compound file implementation, duplicate property identifiers that refer to stream or storage types result in multiple calls to [**IStorage::OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) or [**IStorage::OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) and the success or failure of **ReadMultiple** depends on the underlying storage implementation's ability to share opening operations.</span></span> <span data-ttu-id="59eca-177">Dado que en un archivo compuesto STGM \_ recurso compartido \_ exclusivo se fuerza, se producirá un error en varios intentos de apertura.</span><span class="sxs-lookup"><span data-stu-id="59eca-177">Because in a compound file STGM\_SHARE\_EXCLUSIVE is forced, multiple open attempts will fail.</span></span> <span data-ttu-id="59eca-178">No se admite la apertura del mismo objeto de almacenamiento más de una vez desde el mismo almacenamiento primario.</span><span class="sxs-lookup"><span data-stu-id="59eca-178">Opening the same storage object more than once from the same parent storage is not supported.</span></span> <span data-ttu-id="59eca-179">\_Se debe especificar la marca de uso compartido STGM \_ .</span><span class="sxs-lookup"><span data-stu-id="59eca-179">The STGM\_SHARE\_EXCLUSIVE flag must be specified.</span></span>

<span data-ttu-id="59eca-180">Además, para asegurarse de que la operación segura para subprocesos se solicita varias veces a través del mismo puntero [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) en la implementación de archivo compuesto com, la operación de apertura se realizará correctamente o producirá un error dependiendo de si la propiedad ya está abierta y si el sistema de archivos subyacente controla varias aperturas de una secuencia o almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="59eca-180">In addition, to ensure thread-safe operation if the same stream- or storage-valued property is requested several times through the same [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) pointer in the COM compound file implementation, the open operation will succeed or fail depending on whether the property is already open and whether the underlying file system handles multiple openings of a stream or storage.</span></span> <span data-ttu-id="59eca-181">Por lo tanto, la operación **ReadMultiple** en una propiedad de flujo o de valor de almacenamiento siempre da como resultado una llamada a [**IStorage:: OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream)o [**IStorage:: OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage), que pasa el acceso (STGM \_ ReadWrite, etc.) y las marcas de uso compartido (STGM \_ compartir \_ exclusivo, etc.) que se especifican cuando se abre o se crea el conjunto de propiedades original.</span><span class="sxs-lookup"><span data-stu-id="59eca-181">Thus, the **ReadMultiple** operation on a stream- or storage-valued property always results in a call to [**IStorage::OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream), or [**IStorage::OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage), which passes the access (STGM\_READWRITE, and so forth) and share flags (STGM\_SHARE\_EXCLUSIVE, and so on) specified when the original property set was opened or created.</span></span>

<span data-ttu-id="59eca-182">Si se produce un error en el método, los valores escritos en *rgvar* no \[ \] están definidos.</span><span class="sxs-lookup"><span data-stu-id="59eca-182">If the method fails, the values written to *rgvar*\[\] are undefined.</span></span> <span data-ttu-id="59eca-183">Si algunas propiedades de flujo o de valor de almacenamiento se abren correctamente pero se produce un error antes de que se complete la ejecución, se deben liberar antes de que el método devuelva.</span><span class="sxs-lookup"><span data-stu-id="59eca-183">If some stream- or storage-valued properties are opened successfully but an error occurs before execution is complete, these should be released before the method returns.</span></span>

</dd> <dt>

<span data-ttu-id="59eca-184"><span id="IPropertyStorage__WriteMultiple"></span><span id="ipropertystorage__writemultiple"></span><span id="IPROPERTYSTORAGE__WRITEMULTIPLE"></span>[**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple)</span><span class="sxs-lookup"><span data-stu-id="59eca-184"><span id="IPropertyStorage__WriteMultiple"></span><span id="ipropertystorage__writemultiple"></span><span id="IPROPERTYSTORAGE__WRITEMULTIPLE"></span>[**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple)</span></span>
</dt> <dd>

<span data-ttu-id="59eca-185">Escribe las propiedades especificadas en la matriz *rgpspec* \[ \] , asignándoles las etiquetas y los valores de [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) especificados en *rgvar* \[ \] .</span><span class="sxs-lookup"><span data-stu-id="59eca-185">Writes the properties specified in the *rgpspec*\[\] array, assigning them the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) tags and values specified in *rgvar*\[\].</span></span> <span data-ttu-id="59eca-186">A las propiedades que ya existen se les asignan los valores de **PROPVARIANT** especificados.</span><span class="sxs-lookup"><span data-stu-id="59eca-186">Properties that already exist are assigned the specified **PROPVARIANT** values.</span></span> <span data-ttu-id="59eca-187">Se crean las propiedades que no existen actualmente.</span><span class="sxs-lookup"><span data-stu-id="59eca-187">Properties that do not currently exist are created.</span></span>

</dd> <dt>

<span data-ttu-id="59eca-188"><span id="IPropertyStorage__DeleteMultiple"></span><span id="ipropertystorage__deletemultiple"></span><span id="IPROPERTYSTORAGE__DELETEMULTIPLE"></span>[**IPropertyStorage::D eleteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletemultiple)</span><span class="sxs-lookup"><span data-stu-id="59eca-188"><span id="IPropertyStorage__DeleteMultiple"></span><span id="ipropertystorage__deletemultiple"></span><span id="IPROPERTYSTORAGE__DELETEMULTIPLE"></span>[**IPropertyStorage::DeleteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletemultiple)</span></span>
</dt> <dd>

<span data-ttu-id="59eca-189">Elimina las propiedades especificadas en *rgpspec* \[ \] .</span><span class="sxs-lookup"><span data-stu-id="59eca-189">Deletes the properties specified in the *rgpspec*\[\].</span></span>

</dd> <dt>

<span data-ttu-id="59eca-190"><span id="IPropertyStorage__ReadPropertyNames"></span><span id="ipropertystorage__readpropertynames"></span><span id="IPROPERTYSTORAGE__READPROPERTYNAMES"></span>[**IPropertyStorage::ReadPropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readpropertynames)</span><span class="sxs-lookup"><span data-stu-id="59eca-190"><span id="IPropertyStorage__ReadPropertyNames"></span><span id="ipropertystorage__readpropertynames"></span><span id="IPROPERTYSTORAGE__READPROPERTYNAMES"></span>[**IPropertyStorage::ReadPropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readpropertynames)</span></span>
</dt> <dd>

<span data-ttu-id="59eca-191">Lee los nombres de cadena existentes asociados a los identificadores de propiedad especificados en la matriz *rgpropid* \[ \] .</span><span class="sxs-lookup"><span data-stu-id="59eca-191">Reads existing string names associated with the property IDs specified in the *rgpropid*\[\] array.</span></span>

</dd> <dt>

<span data-ttu-id="59eca-192"><span id="IPropertyStorage__WritePropertyNames"></span><span id="ipropertystorage__writepropertynames"></span><span id="IPROPERTYSTORAGE__WRITEPROPERTYNAMES"></span>[**IPropertyStorage::WritePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames)</span><span class="sxs-lookup"><span data-stu-id="59eca-192"><span id="IPropertyStorage__WritePropertyNames"></span><span id="ipropertystorage__writepropertynames"></span><span id="IPROPERTYSTORAGE__WRITEPROPERTYNAMES"></span>[**IPropertyStorage::WritePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames)</span></span>
</dt> <dd>

<span data-ttu-id="59eca-193">Asigna nombres de cadena especificados en la matriz *rglpwstrName* a los identificadores de propiedad especificados en la matriz *rgpropid* .</span><span class="sxs-lookup"><span data-stu-id="59eca-193">Assigns string names specified in the *rglpwstrName* array to property IDs specified in the *rgpropid* array.</span></span>

</dd> <dt>

<span data-ttu-id="59eca-194"><span id="IPropertyStorage__DeletePropertyNames"></span><span id="ipropertystorage__deletepropertynames"></span><span id="IPROPERTYSTORAGE__DELETEPROPERTYNAMES"></span>[**IPropertyStorage::D eletePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletepropertynames)</span><span class="sxs-lookup"><span data-stu-id="59eca-194"><span id="IPropertyStorage__DeletePropertyNames"></span><span id="ipropertystorage__deletepropertynames"></span><span id="IPROPERTYSTORAGE__DELETEPROPERTYNAMES"></span>[**IPropertyStorage::DeletePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletepropertynames)</span></span>
</dt> <dd>

<span data-ttu-id="59eca-195">Elimina los nombres de propiedad de las propiedades especificadas en la matriz *rgpropid* \[ \] .</span><span class="sxs-lookup"><span data-stu-id="59eca-195">Deletes property names for the properties specified in the *rgpropid*\[\] array.</span></span>

</dd> <dt>

<span data-ttu-id="59eca-196"><span id="IPropertyStorage__SetClass"></span><span id="ipropertystorage__setclass"></span><span id="IPROPERTYSTORAGE__SETCLASS"></span>[**IPropertyStorage::SetClass**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-setclass)</span><span class="sxs-lookup"><span data-stu-id="59eca-196"><span id="IPropertyStorage__SetClass"></span><span id="ipropertystorage__setclass"></span><span id="IPROPERTYSTORAGE__SETCLASS"></span>[**IPropertyStorage::SetClass**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-setclass)</span></span>
</dt> <dd>

<span data-ttu-id="59eca-197">Establece el **CLSID** de la secuencia del conjunto de propiedades.</span><span class="sxs-lookup"><span data-stu-id="59eca-197">Sets the **CLSID** of the property set stream.</span></span> <span data-ttu-id="59eca-198">En la implementación de archivo compuesto, al establecer el CLSID en un conjunto de propiedades no simples (que puede contener legalmente propiedades de almacenamiento o con valores de flujo, como se describe en [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)) también se establece el CLSID en el subalmacenamiento subyacente para que se pueda obtener a través de una llamada a [**IStorage:: Stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat).</span><span class="sxs-lookup"><span data-stu-id="59eca-198">In the compound file implementation, setting the CLSID on a nonsimple property set (one that can legally contain storage- or stream-valued properties, as described in [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)) also sets the CLSID on the underlying substorage so that it can be obtained through a call to [**IStorage::Stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat).</span></span>

</dd> <dt>

<span data-ttu-id="59eca-199"><span id="IPropertyStorage__Commit"></span><span id="ipropertystorage__commit"></span><span id="IPROPERTYSTORAGE__COMMIT"></span>[**IPropertyStorage:: commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit)</span><span class="sxs-lookup"><span data-stu-id="59eca-199"><span id="IPropertyStorage__Commit"></span><span id="ipropertystorage__commit"></span><span id="IPROPERTYSTORAGE__COMMIT"></span>[**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit)</span></span>
</dt> <dd>

<span data-ttu-id="59eca-200">En el caso de conjuntos de propiedades simples y no simples, vacía la imagen de la memoria del conjunto de propiedades en el almacenamiento subyacente.</span><span class="sxs-lookup"><span data-stu-id="59eca-200">For both simple and nonsimple property sets, flushes the property set memory image to the underlying storage.</span></span> <span data-ttu-id="59eca-201">Además, en el caso de conjuntos de propiedades de modo de transacción no simples, este método realiza una confirmación (como en [**IStorage:: commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit)) en el almacenamiento que contiene el conjunto de propiedades.</span><span class="sxs-lookup"><span data-stu-id="59eca-201">In addition, for nonsimple transacted-mode property sets, this method performs a commit (as in [**IStorage::Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit)) on the storage which contains the property set.</span></span>

</dd> <dt>

<span data-ttu-id="59eca-202"><span id="IPropertyStorage__Revert"></span><span id="ipropertystorage__revert"></span><span id="IPROPERTYSTORAGE__REVERT"></span>[**IPropertyStorage:: revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert)</span><span class="sxs-lookup"><span data-stu-id="59eca-202"><span id="IPropertyStorage__Revert"></span><span id="ipropertystorage__revert"></span><span id="IPROPERTYSTORAGE__REVERT"></span>[**IPropertyStorage::Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert)</span></span>
</dt> <dd>

<span data-ttu-id="59eca-203">Solo para conjuntos de propiedades no simples, llama al método [**Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) del almacenamiento subyacente y vuelve a abrir la secuencia ' contents '.</span><span class="sxs-lookup"><span data-stu-id="59eca-203">For nonsimple property sets only, calls the [**Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) method of the underlying storage and reopens the 'contents' stream.</span></span> <span data-ttu-id="59eca-204">En el caso de los conjuntos de propiedades simples, esta interfaz siempre devuelve S \_ correcto.</span><span class="sxs-lookup"><span data-stu-id="59eca-204">For simple property sets, this interface always returns S\_OK.</span></span> <span data-ttu-id="59eca-205">Los conjuntos de propiedades no simples son aquellos que se crearon con la \_ marca PROPSETFLAG nonsimple en el método [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) .</span><span class="sxs-lookup"><span data-stu-id="59eca-205">Nonsimple property sets are those which were created using the PROPSETFLAG\_NONSIMPLE flag in the [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) method.</span></span> <span data-ttu-id="59eca-206">Para obtener más información, consulte [almacenamiento y objetos de secuencia para un conjunto de propiedades](storage-vs--stream-for-a-property-set.md) .</span><span class="sxs-lookup"><span data-stu-id="59eca-206">For more information, see [Storage and Stream Objects for a Property Set](storage-vs--stream-for-a-property-set.md) .</span></span>

</dd> <dt>

<span data-ttu-id="59eca-207"><span id="IPropertyStorage__Enum"></span><span id="ipropertystorage__enum"></span><span id="IPROPERTYSTORAGE__ENUM"></span>[**IPropertyStorage:: enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum)</span><span class="sxs-lookup"><span data-stu-id="59eca-207"><span id="IPropertyStorage__Enum"></span><span id="ipropertystorage__enum"></span><span id="IPROPERTYSTORAGE__ENUM"></span>[**IPropertyStorage::Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum)</span></span>
</dt> <dd>

<span data-ttu-id="59eca-208">Construye una instancia de [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), los métodos de los que se puede llamar para enumerar las estructuras [**STATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) que proporcionan información sobre cada una de las propiedades del conjunto.</span><span class="sxs-lookup"><span data-stu-id="59eca-208">Constructs an instance of [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), the methods of which can be called to enumerate the [**STATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) structures that provide information about each of the properties in the set.</span></span> <span data-ttu-id="59eca-209">Esta implementación crea una matriz en la que se lee todo el conjunto de propiedades y que se puede compartir cuando se llama a **IEnumSTATPROPSTG:: Clone** .</span><span class="sxs-lookup"><span data-stu-id="59eca-209">This implementation creates an array into which the entire property set is read and which can be shared when **IEnumSTATPROPSTG::Clone** is called.</span></span> <span data-ttu-id="59eca-210">Los cambios en el conjunto de propiedades no se reflejan en una instancia abierta de **IEnumSTATPROPSTG** .</span><span class="sxs-lookup"><span data-stu-id="59eca-210">Changes to the property set are not reflected in an open **IEnumSTATPROPSTG** instance.</span></span> <span data-ttu-id="59eca-211">Para ver estos cambios, se debe construir una nueva instancia de este enumerador.</span><span class="sxs-lookup"><span data-stu-id="59eca-211">To see such changes, a new instance of this enumerator must be constructed.</span></span>

</dd> <dt>

<span data-ttu-id="59eca-212"><span id="IPropertyStorage__Stat"></span><span id="ipropertystorage__stat"></span><span id="IPROPERTYSTORAGE__STAT"></span>[**IPropertyStorage:: Stat**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-stat)</span><span class="sxs-lookup"><span data-stu-id="59eca-212"><span id="IPropertyStorage__Stat"></span><span id="ipropertystorage__stat"></span><span id="IPROPERTYSTORAGE__STAT"></span>[**IPropertyStorage::Stat**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-stat)</span></span>
</dt> <dd>

<span data-ttu-id="59eca-213">Rellena los miembros de una estructura [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) , que contiene datos sobre la propiedad establecida en su totalidad.</span><span class="sxs-lookup"><span data-stu-id="59eca-213">Fills in the members of a [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structure, which contains data about the property set as a whole.</span></span> <span data-ttu-id="59eca-214">En la devolución, proporciona un puntero a la estructura.</span><span class="sxs-lookup"><span data-stu-id="59eca-214">On return, supplies a pointer to the structure.</span></span> <span data-ttu-id="59eca-215">En el caso de los conjuntos de almacenamiento no simples, esta implementación llama a [**IStorage:: Stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat) (o [**IStream:: Stat**](/windows/desktop/api/Objidl/nf-objidl-istream-stat)) para obtener las horas de la secuencia o el almacenamiento subyacente.</span><span class="sxs-lookup"><span data-stu-id="59eca-215">For nonsimple storage sets, this implementation calls [**IStorage::Stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat) (or [**IStream::Stat**](/windows/desktop/api/Objidl/nf-objidl-istream-stat)) to get the times from the underlying storage or stream.</span></span> <span data-ttu-id="59eca-216">En el caso de los conjuntos de almacenamiento simples, no se mantiene ninguna hora.</span><span class="sxs-lookup"><span data-stu-id="59eca-216">For simple storage sets, no times are maintained.</span></span>

</dd> <dt>

<span data-ttu-id="59eca-217"><span id="IPropertyStorage__SetTimes"></span><span id="ipropertystorage__settimes"></span><span id="IPROPERTYSTORAGE__SETTIMES"></span>[**IPropertyStorage::SetTimes**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes)</span><span class="sxs-lookup"><span data-stu-id="59eca-217"><span id="IPropertyStorage__SetTimes"></span><span id="ipropertystorage__settimes"></span><span id="IPROPERTYSTORAGE__SETTIMES"></span>[**IPropertyStorage::SetTimes**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes)</span></span>
</dt> <dd>

<span data-ttu-id="59eca-218">Solo para conjuntos de propiedades no simples, establece las horas admitidas por el almacenamiento subyacente.</span><span class="sxs-lookup"><span data-stu-id="59eca-218">For nonsimple property sets only, sets the times supported by the underlying storage.</span></span> <span data-ttu-id="59eca-219">La implementación de almacenamiento de archivos compuesto admite los tres: modificación, acceso y creación.</span><span class="sxs-lookup"><span data-stu-id="59eca-219">The compound file storage implementation supports all three: modification, access, and creation.</span></span> <span data-ttu-id="59eca-220">Esta implementación de [**SetTimes**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes) llama al método [**IStorage:: SetElementTimes**](/windows/desktop/api/Objidl/nf-objidl-istorage-setelementtimes) del almacenamiento subyacente para recuperar estas horas.</span><span class="sxs-lookup"><span data-stu-id="59eca-220">This implementation of [**SetTimes**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes) calls the [**IStorage::SetElementTimes**](/windows/desktop/api/Objidl/nf-objidl-istorage-setelementtimes) method of the underlying storage to retrieve these times.</span></span>

</dd> </dl>

## <a name="related-topics"></a><span data-ttu-id="59eca-221">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="59eca-221">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="59eca-222">**IPropertyStorage**</span><span class="sxs-lookup"><span data-stu-id="59eca-222">**IPropertyStorage**</span></span>](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage)
</dt> <dt>

[<span data-ttu-id="59eca-223">**IStorage:: SetElementTimes**</span><span class="sxs-lookup"><span data-stu-id="59eca-223">**IStorage::SetElementTimes**</span></span>](/windows/desktop/api/Objidl/nf-objidl-istorage-setelementtimes)
</dt> </dl>

 

 