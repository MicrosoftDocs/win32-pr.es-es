---
description: Un escritor puede producir un error por diversos motivos de programación.
ms.assetid: 50eced73-3917-4d7e-96cc-2d793b448738
title: Errores y vetos del escritor
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7c24c15ad10766fc6ec395ed058ab3cb72a689d9
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104275420"
---
# <a name="writer-errors-and-vetoes"></a><span data-ttu-id="cd79f-103">Errores y vetos del escritor</span><span class="sxs-lookup"><span data-stu-id="cd79f-103">Writer Errors and Vetoes</span></span>

<span data-ttu-id="cd79f-104">Un escritor puede producir un error por diversos motivos de programación.</span><span class="sxs-lookup"><span data-stu-id="cd79f-104">A writer can fail for numerous programmatic reasons.</span></span> <span data-ttu-id="cd79f-105">Cuando esto sucede, debe vetar la operación de copia de seguridad, restauración o instantánea en curso llamando al método [**CVssWriter:: SetWriterFailure**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-setwriterfailure) en uno de sus métodos de controlador (por ejemplo, [**CVssWriter:: alfreeze**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onfreeze) o [**CVssWriter:: OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore)) y devolviendo **true**.</span><span class="sxs-lookup"><span data-stu-id="cd79f-105">When this happens, it should veto the ongoing backup, restore, or shadow copy operation by calling the [**CVssWriter::SetWriterFailure**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-setwriterfailure) method in one of its handler methods (for example, [**CVssWriter::OnFreeze**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onfreeze) or [**CVssWriter::OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore)) and returning **TRUE**.</span></span> <span data-ttu-id="cd79f-106">Opcionalmente, también puede establecer una cadena de mensaje de error en respuesta a una condición de error en ciertos métodos de controlador con los métodos [**IVssComponentEx:: SetPrepareForBackupFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponentex-setprepareforbackupfailuremsg), [**IVssComponentEx:: SetPostSnapshotFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponentex-setpostsnapshotfailuremsg), [**IVssComponent:: SetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg)y [**IVssComponent:: SetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg) .</span><span class="sxs-lookup"><span data-stu-id="cd79f-106">It can also optionally set an error message string in response to a failure condition in certain handler methods with the [**IVssComponentEx::SetPrepareForBackupFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponentex-setprepareforbackupfailuremsg), [**IVssComponentEx::SetPostSnapshotFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponentex-setpostsnapshotfailuremsg), [**IVssComponent::SetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg), and [**IVssComponent::SetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg) methods.</span></span> <span data-ttu-id="cd79f-107">El solicitante puede aceptar la veto o continuar con la copia de seguridad, omitiendo la veto.</span><span class="sxs-lookup"><span data-stu-id="cd79f-107">The requester can accept the veto or continue with the backup, ignoring the veto.</span></span>

<span data-ttu-id="cd79f-108">Un solicitante debe comprobar el estado del escritor (mediante [**IVssBackupComponents:: GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) y [**IVssBackupComponents:: GetWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwriterstatus)) después de cada evento que genera.</span><span class="sxs-lookup"><span data-stu-id="cd79f-108">A requester should check the writer status (using [**IVssBackupComponents::GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) and [**IVssBackupComponents::GetWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwriterstatus)) following each event it generates.</span></span>

<span data-ttu-id="cd79f-109">En algunos casos, los mensajes de error se pueden recuperar de estos errores (mediante los métodos [**IVssComponentEx:: GetPrepareForBackupFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponentex-getprepareforbackupfailuremsg), [**IVssComponent:: GetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getprerestorefailuremsg), [**IVssComponentEx:: GetPostSnapshotFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponentex-getpostsnapshotfailuremsg)y [**IVssComponent:: GetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpostrestorefailuremsg) ), o un escritor puede optar por establecer metadatos (mediante [**IVssComponent:: SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata) y [**IVssComponent:: SetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata) con información de estado de error).</span><span class="sxs-lookup"><span data-stu-id="cd79f-109">In some cases, error messages can be retrieved from these failures (using the [**IVssComponentEx::GetPrepareForBackupFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponentex-getprepareforbackupfailuremsg), [**IVssComponent::GetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getprerestorefailuremsg), [**IVssComponentEx::GetPostSnapshotFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponentex-getpostsnapshotfailuremsg), and [**IVssComponent::GetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpostrestorefailuremsg) methods), or a writer may choose to set metadata (using [**IVssComponent::SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata) and [**IVssComponent::SetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata) with error state information).</span></span> <span data-ttu-id="cd79f-110">Para ver un ejemplo de código que muestra cómo ver estos mensajes de error, consulte [**IVssComponentEx:: GetPrepareForBackupFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponentex-getprepareforbackupfailuremsg).</span><span class="sxs-lookup"><span data-stu-id="cd79f-110">For example code that shows how to view such error messages, see [**IVssComponentEx::GetPrepareForBackupFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponentex-getprepareforbackupfailuremsg).</span></span>

<span data-ttu-id="cd79f-111">En función del estado de error, un solicitante o su operador podría reiniciar la copia de seguridad y la instantánea con cualquier modificación necesaria en el estado del trabajo o sistema de copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="cd79f-111">Depending on the error state, a requester or its operator could restart the backup and shadow copy with any necessary modification to the state of the backup job or system.</span></span>

<span data-ttu-id="cd79f-112">Por ejemplo, supongamos que [**GetWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwriterstatus) devuelve lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="cd79f-112">For example, suppose [**GetWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwriterstatus) returned the following:</span></span>

-   <span data-ttu-id="cd79f-113">**VSS \_ E \_ WRITERERROR \_ INCONSISTENTSNAPSHOT** sugiere que un solicitante podría agregar volúmenes adicionales a la instantánea.</span><span class="sxs-lookup"><span data-stu-id="cd79f-113">**VSS\_E\_WRITERERROR\_INCONSISTENTSNAPSHOT** suggests that a requester might add additional volumes to the shadow copy</span></span>
-   <span data-ttu-id="cd79f-114">**VSS \_ E \_ WRITERERROR \_ retryme** indica que el reintento sin reconfiguración podría funcionar.</span><span class="sxs-lookup"><span data-stu-id="cd79f-114">**VSS\_E\_WRITERERROR\_RETRYABLE** indicates that retrying without reconfiguration might work.</span></span> <span data-ttu-id="cd79f-115">Si el escritor continúa devolviendo el error después de varios reintentos, intente reiniciar el servicio que hospeda el escritor.</span><span class="sxs-lookup"><span data-stu-id="cd79f-115">If the writer continues to return the error after several retries, try restarting the service that hosts the writer.</span></span> <span data-ttu-id="cd79f-116">Los escritores siguientes se hospedan en el servicio VSS: escritor del registro, escritor de base de datos de registro de clases COM+, escritor de optimización de instantáneas y escritor de recuperación automática del sistema (ASR).</span><span class="sxs-lookup"><span data-stu-id="cd79f-116">The following writers are hosted in the VSS service: registry writer, COM+ class registration database writer, shadow copy optimization writer, and Automated System Recovery (ASR) writer.</span></span> <span data-ttu-id="cd79f-117">Si el escritor pertenece a una aplicación que hospeda el escritor en su propio proceso, intente reiniciar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="cd79f-117">If the writer belongs to an application that hosts the writer in its own process, try restarting the application.</span></span>

    <span data-ttu-id="cd79f-118">**Windows Server 2003 y Windows XP:** Los siguientes escritores se hospedan en el servicio VSS: escritor del registro, escritor de la base de datos de registro de clases COM+, escritor de registros de eventos de aplicación y Microsoft SQL Server 2000 Desktop Engine (MSDE) Writer.</span><span class="sxs-lookup"><span data-stu-id="cd79f-118">**Windows Server 2003 and Windows XP:** The following writers are hosted in the VSS service: registry writer, COM+ class registration database writer, application event log writer, and Microsoft SQL Server 2000 Desktop Engine (MSDE) writer.</span></span>

-   <span data-ttu-id="cd79f-119">\_ \_ El estado de VSS E Writer \_ \_ no \_ está disponible indica que un sistema de escritura puede haber alcanzado el número máximo de sesiones de copia de seguridad y restauración disponibles y el reintento podría funcionar cuando el sistema esté menos ocupado.</span><span class="sxs-lookup"><span data-stu-id="cd79f-119">VSS\_E\_WRITER\_STATUS\_NOT\_AVAILABLE indicates that a writer may have reached the maximum number of available backup and restore sessions, and retrying might work when the system is less busy.</span></span>
-   <span data-ttu-id="cd79f-120">**VSS \_ E \_ WRITERERROR \_ OUTOFRESOURCES** o **VSS \_ e \_ WRITERERROR de \_ tiempo de espera** podrían sugerir que se reduzca la carga del sistema antes de volver a intentarlo</span><span class="sxs-lookup"><span data-stu-id="cd79f-120">**VSS\_E\_WRITERERROR\_OUTOFRESOURCES** or **VSS\_E\_WRITERERROR\_TIMEOUT** might suggest that system load be reduced prior to retrying</span></span>
-   <span data-ttu-id="cd79f-121">**VSS \_ E \_ WRITERERROR \_** que no se puede reintentar o que el **escritor de VSS \_ \_ \_ no \_ responde** podría indicar un error del escritor tan grave como para impedir el intento de realizar una copia de seguridad de sus datos con VSS.</span><span class="sxs-lookup"><span data-stu-id="cd79f-121">**VSS\_E\_WRITERERROR\_NONRETRYABLE** or **VSS\_E\_WRITER\_NOT\_RESPONDING** would likely indicate a writer error so severe as to preclude trying to back up its data with VSS.</span></span>

<span data-ttu-id="cd79f-122">En función del escritor y de los componentes que los generen, no siempre es necesario que una aplicación de copia de seguridad se anule tras una veto o un error.</span><span class="sxs-lookup"><span data-stu-id="cd79f-122">Depending on which writer and which components generate them, it is not always necessary for a backup application to abort following a veto or error.</span></span>

<span data-ttu-id="cd79f-123">Por ejemplo, un solicitante puede decidir que la intención de la instantánea es realizar una copia de seguridad de la aplicación A y que se ha recibido el veto del escritor para la aplicación de copia de seguridad B. En este caso, es absolutamente aceptable continuar con la copia de seguridad de la aplicación A mientras se omite la veto.</span><span class="sxs-lookup"><span data-stu-id="cd79f-123">For example, a requester may decide that the intent of the shadow copy is to back up application A and the veto has been received from the writer for backup application B. In this case, it is perfectly acceptable to continue to back up application A while ignoring the veto.</span></span>

<span data-ttu-id="cd79f-124">A continuación se muestran ejemplos de veto de escritor:</span><span class="sxs-lookup"><span data-stu-id="cd79f-124">The following are examples of a writer veto:</span></span>

-   <span data-ttu-id="cd79f-125">El escritor veta el proceso de creación de instantáneas cuando no pudo suspender sus actividades durante el tiempo de creación de la instantánea.</span><span class="sxs-lookup"><span data-stu-id="cd79f-125">The writer vetoes the shadow copy creation process when it could not suspend its activities during the time the shadow copy was being created.</span></span> <span data-ttu-id="cd79f-126">Esto indica que hay una alta probabilidad de que la instantánea no sea válida porque se ha producido una operación de escritura durante el estado de inmovilización.</span><span class="sxs-lookup"><span data-stu-id="cd79f-126">This indicates that there is a high probability that the shadow copy is not valid because a write operation has occurred during the Freeze state.</span></span>
-   <span data-ttu-id="cd79f-127">Una aplicación de copia de seguridad ha solicitado una instantánea del volumen C: y un escritor determina que una instantánea de C: y D: es realizar una copia de seguridad de sus datos.</span><span class="sxs-lookup"><span data-stu-id="cd79f-127">A backup application has requested a shadow copy of only volume C: and a writer determines that a shadow copy of C: and D: is to back up its data.</span></span> <span data-ttu-id="cd79f-128">En este caso, el escritor será veto.</span><span class="sxs-lookup"><span data-stu-id="cd79f-128">In this case, the writer will veto.</span></span> <span data-ttu-id="cd79f-129">La aplicación de copia de seguridad puede examinar los metadatos y determinar si se omitirá el escritor o se anulará el proceso de creación de instantáneas y se reiniciará más adelante.</span><span class="sxs-lookup"><span data-stu-id="cd79f-129">The backup application may examine the metadata and determine whether the writer will be ignored or the shadow copy creation process will be aborted and later restarted.</span></span>

 

 



