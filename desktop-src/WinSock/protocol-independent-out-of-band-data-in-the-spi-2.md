---
description: Los datos fuera de banda (OOB) son un canal de transmisión independiente lógicamente asociado a un par de sockets de secuencias conectados.
ms.assetid: 30f667cd-5be9-45f2-9d55-bff04834078f
title: Datos de protocolo IndependentOut-of-Band en el SPI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b53e5c7c5c8c8ad7a5985ec101dd157370c5f32f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104541510"
---
# <a name="protocol-independentout-of-band-data-in-the-spi"></a><span data-ttu-id="e8280-103">Datos de protocolo IndependentOut-of-Band en el SPI</span><span class="sxs-lookup"><span data-stu-id="e8280-103">Protocol IndependentOut-of-Band Data in the SPI</span></span>

<span data-ttu-id="e8280-104">Los datos fuera de banda (OOB) son un canal de transmisión independiente lógicamente asociado a un par de sockets de secuencias conectados.</span><span class="sxs-lookup"><span data-stu-id="e8280-104">Out-of-Band (OOB) data is a logically independent transmission channel associated with a pair of connected stream sockets.</span></span> <span data-ttu-id="e8280-105">Los datos OOB se pueden entregar al usuario independientemente de los datos normales.</span><span class="sxs-lookup"><span data-stu-id="e8280-105">OOB data may be delivered to the user independently of normal data.</span></span> <span data-ttu-id="e8280-106">La abstracción define que los servicios de datos OOB deben admitir la entrega confiable de al menos un bloque de datos OOB a la vez.</span><span class="sxs-lookup"><span data-stu-id="e8280-106">The abstraction defines that the OOB data facilities must support the reliable delivery of at least one OOB data block at a time.</span></span> <span data-ttu-id="e8280-107">Este bloque de datos puede contener al menos un byte de datos, y al menos un bloque de datos OOB puede estar pendiente de entrega al usuario en un momento dado.</span><span class="sxs-lookup"><span data-stu-id="e8280-107">This data block may contain at least one byte of data, and at least one OOB data block may be pending delivery to the user at any one time.</span></span> <span data-ttu-id="e8280-108">En el caso de los protocolos de comunicaciones que admiten la señalización en banda (es decir, TCP, donde los datos urgentes se entregan en secuencia con los datos normales), el sistema normalmente extrae los datos OOB del flujo de datos normal y los almacena por separado (quedando un hueco en el flujo de datos normal).</span><span class="sxs-lookup"><span data-stu-id="e8280-108">For communications protocols which support in-band signaling (that is, TCP, where the urgent data is delivered in sequence with the normal data), the system normally extracts the OOB data from the normal data stream and stores it separately (leaving a gap in the normal data stream).</span></span> <span data-ttu-id="e8280-109">Esto permite a los usuarios elegir entre recibir los datos OOB en orden y recibirlos fuera de secuencia sin tener que almacenar en búfer todos los datos que intervienen.</span><span class="sxs-lookup"><span data-stu-id="e8280-109">This allows users to choose between receiving the OOB data in order and receiving it out of sequence without having to buffer all the intervening data.</span></span> <span data-ttu-id="e8280-110">Es posible inspeccionar los datos OOB.</span><span class="sxs-lookup"><span data-stu-id="e8280-110">It is possible to peek at OOB data.</span></span>

<span data-ttu-id="e8280-111">Un usuario puede determinar si hay algún dato OOB en espera de ser leído mediante la función [**WSPIoctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85)) (SIOCATMARK).</span><span class="sxs-lookup"><span data-stu-id="e8280-111">A user can determine if there is any OOB data waiting to be read using the [**WSPIoctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85)) (SIOCATMARK) function.</span></span> <span data-ttu-id="e8280-112">En el caso de los protocolos en los que el concepto de la posición del bloque de datos OOB dentro del flujo de datos normal es significativo (es decir, TCP), un proveedor de servicios de Windows Sockets mantendrá un marcador conceptual que indica la posición del último byte de los datos OOB en el flujo de datos normal.</span><span class="sxs-lookup"><span data-stu-id="e8280-112">For protocols where the concept of the position of the OOB data block within the normal data stream is meaningful (that is, TCP), a Windows Sockets service provider will maintain a conceptual marker indicating the position of the last byte of OOB data within the normal data stream.</span></span> <span data-ttu-id="e8280-113">Esto no es necesario para la implementación de la funcionalidad de **WSPIoctl** (SIOCATMARK): la presencia o ausencia de datos Oob es todo lo que se necesita.</span><span class="sxs-lookup"><span data-stu-id="e8280-113">This is not necessary for the implementation of the **WSPIoctl** (SIOCATMARK) functionality — the presence or absence of OOB data is all that is required.</span></span>

<span data-ttu-id="e8280-114">En el caso de los protocolos en los que el concepto de la posición del bloque de datos OOB en el flujo de datos normal es significativo, es posible que una aplicación prefiera procesar los datos fuera de banda en línea, como parte del flujo de datos normal.</span><span class="sxs-lookup"><span data-stu-id="e8280-114">For protocols where the concept of the position of the OOB data block within the normal data stream is meaningful an application may prefer to process out-of-band data inline, as part of the normal data stream.</span></span> <span data-ttu-id="e8280-115">Esto se consigue estableciendo la opción de socket de modo que \_ OOBINLINE (vea la sección [**WSPIoctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85))).</span><span class="sxs-lookup"><span data-stu-id="e8280-115">This is achieved by setting the socket option SO\_OOBINLINE (see section [**WSPIoctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85))).</span></span> <span data-ttu-id="e8280-116">En el caso de otros protocolos en los que los bloques de datos OOB son verdaderamente independientes del flujo de datos normal, si se intenta establecer el valor de OOBINLINE, se producirá \_ un error.</span><span class="sxs-lookup"><span data-stu-id="e8280-116">For other protocols where the OOB data blocks are truly independent of the normal data stream, attempting to set SO\_OOBINLINE will result in an error.</span></span> <span data-ttu-id="e8280-117">Una aplicación puede usar el comando SIOCATMARK WSPIoctl para determinar si hay algún dato OOB de no lectura delante de la marca.</span><span class="sxs-lookup"><span data-stu-id="e8280-117">An application can use the SIOCATMARK WSPIoctl command to determine whether there is any unread OOB data preceding the mark.</span></span> <span data-ttu-id="e8280-118">Por ejemplo, podría utilizar esto para volver a sincronizar con su elemento del mismo nivel asegurándose de que todos los datos hasta la marca del flujo de datos se descartan cuando sea necesario.</span><span class="sxs-lookup"><span data-stu-id="e8280-118">For example, it might use this to resynchronize with its peer by ensuring that all data up to the mark in the data stream is discarded when appropriate.</span></span>

<span data-ttu-id="e8280-119">Con SO \_ OOBINLINE deshabilitado (de forma predeterminada):</span><span class="sxs-lookup"><span data-stu-id="e8280-119">With SO\_OOBINLINE disabled (by default):</span></span>

-   <span data-ttu-id="e8280-120">El proveedor de servicios Winsock notifica a un cliente de un \_ evento FD OOB, si el cliente se ha registrado para recibir notificaciones con [**WSPAsyncSelect**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)), exactamente de la misma manera \_ que se usa FD Read para notificar la presencia de datos normales.</span><span class="sxs-lookup"><span data-stu-id="e8280-120">The Winsock service provider notifies a client of an FD\_OOB event, if the client registered for notification with [**WSPAsyncSelect**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)), in exactly the same way FD\_READ is used to notify of the presence of normal data.</span></span> <span data-ttu-id="e8280-121">Es decir, \_ se publica FD OOB cuando llegan los datos de OOB y no había datos OOB previamente en cola, y también cuando se leen los datos mediante la marca de mensaje \_ OOB y algunos datos de OOB permanecen para ser leídos después de que se haya devuelto la operación de lectura.</span><span class="sxs-lookup"><span data-stu-id="e8280-121">That is, FD\_OOB is posted when OOB data arrives and there was no OOB data previously queued, and also when data is read using the MSG\_OOB flag, and some OOB data remains to be read after the read operation has returned.</span></span> <span data-ttu-id="e8280-122">\_Los mensajes de lectura FD no se publican para los datos OOB.</span><span class="sxs-lookup"><span data-stu-id="e8280-122">FD\_READ messages are not posted for OOB data.</span></span>
-   <span data-ttu-id="e8280-123">El proveedor de servicios Winsock vuelve de [**WSPSelect**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)) con el conjunto de sockets *exceptfds* adecuado si los datos OOB se ponen en cola en el socket.</span><span class="sxs-lookup"><span data-stu-id="e8280-123">The Winsock service provider returns from [**WSPSelect**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)) with the appropriate *exceptfds* socket set if OOB data is queued on the socket.</span></span>
-   <span data-ttu-id="e8280-124">El cliente puede llamar a [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) con el mensaje \_ OOB para leer el bloque de datos urgentes en cualquier momento.</span><span class="sxs-lookup"><span data-stu-id="e8280-124">The client can call [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) with MSG\_OOB to read the urgent data block at any time.</span></span> <span data-ttu-id="e8280-125">El bloque de datos OOB salta la cola.</span><span class="sxs-lookup"><span data-stu-id="e8280-125">The block of OOB data jumps the queue.</span></span>
-   <span data-ttu-id="e8280-126">El cliente puede llamar a [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) sin msg \_ OOB para leer el flujo de datos normal.</span><span class="sxs-lookup"><span data-stu-id="e8280-126">The client can call [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) without MSG\_OOB to read the normal data stream.</span></span> <span data-ttu-id="e8280-127">El bloque de datos OOB no aparecerá en el flujo de datos con datos normales.</span><span class="sxs-lookup"><span data-stu-id="e8280-127">The OOB data block will not appear in the data stream with normal data.</span></span> <span data-ttu-id="e8280-128">Si los datos OOB permanecen después de cualquier llamada a **WSPRecv**, el proveedor de servicios notifica al cliente con FD \_ OOB o a través de *Exceptfds* cuando se usa [**WSPSelect**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="e8280-128">If OOB data remains after any call to **WSPRecv**, the service provider notifies the client with FD\_OOB or through *exceptfds* when using [**WSPSelect**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)).</span></span>
-   <span data-ttu-id="e8280-129">En el caso de los protocolos en los que los datos OOB tienen una posición dentro del flujo de datos normal, una sola operación [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) no abarcará esa posición.</span><span class="sxs-lookup"><span data-stu-id="e8280-129">For protocols where the OOB data has a position within the normal data stream, a single [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) operation will not span that position.</span></span> <span data-ttu-id="e8280-130">Una **WSPRecv** devolverá los datos normales antes de la marca y se requiere un segundo **WSPRecv** para empezar a leer los datos después de la marca.</span><span class="sxs-lookup"><span data-stu-id="e8280-130">One **WSPRecv** will return the normal data before the mark, and a second **WSPRecv** is required to begin reading data after the mark.</span></span>

<span data-ttu-id="e8280-131">Con SO \_ OOBINLINE habilitado:</span><span class="sxs-lookup"><span data-stu-id="e8280-131">With SO\_OOBINLINE enabled:</span></span>

-   <span data-ttu-id="e8280-132">Los \_ mensajes de FD OOB no se publican para los datos OOB; para el propósito de las funciones [**WSPSelect**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)) y [**WSPAsyncSelect**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)) , los datos de OOB se tratan como datos normales y se indican mediante el establecimiento del socket en *readfds* o mediante el envío de un mensaje de lectura FD, \_ respectivamente.</span><span class="sxs-lookup"><span data-stu-id="e8280-132">FD\_OOB messages are not posted for OOB data — for the purpose of the [**WSPSelect**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)) and [**WSPAsyncSelect**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)) functions, OOB data is treated as normal data, and indicated by setting the socket in *readfds* or by sending an FD\_READ message respectively.</span></span>
-   <span data-ttu-id="e8280-133">El cliente no puede llamar a [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) con la \_ marca de mensaje OOB establecida para leer el bloque de datos OOB; se devolverá el código de error WSAEINVAL.</span><span class="sxs-lookup"><span data-stu-id="e8280-133">The client may not call [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) with the MSG\_OOB flag set to read the OOB data block — the error code WSAEINVAL will be returned.</span></span>
-   <span data-ttu-id="e8280-134">El cliente puede llamar a [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) sin la \_ marca OOB de mensaje establecida.</span><span class="sxs-lookup"><span data-stu-id="e8280-134">The client can call [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) without the MSG\_OOB flag set.</span></span> <span data-ttu-id="e8280-135">Cualquier dato OOB se entregará en su orden correcto dentro del flujo de datos normal.</span><span class="sxs-lookup"><span data-stu-id="e8280-135">Any OOB data will be delivered in its correct order within the normal data stream.</span></span> <span data-ttu-id="e8280-136">Los datos OOB nunca se combinarán con los datos normales; debe haber tres solicitudes de lectura para poder más allá de los datos OOB.</span><span class="sxs-lookup"><span data-stu-id="e8280-136">OOB data will never be mixed with normal data — there must be three read requests to get past the OOB data.</span></span> <span data-ttu-id="e8280-137">El primero devuelve los datos normales antes del bloque de datos OOB, el segundo devuelve los datos OOB, el tercero devuelve los datos normales que siguen a los datos OOB.</span><span class="sxs-lookup"><span data-stu-id="e8280-137">The first returns the normal data prior to the OOB data block, the second returns the OOB data, the third returns the normal data following the OOB data.</span></span> <span data-ttu-id="e8280-138">En otras palabras, los límites del bloque de datos OOB se conservan.</span><span class="sxs-lookup"><span data-stu-id="e8280-138">In other words, the OOB data block boundaries are preserved.</span></span>

<span data-ttu-id="e8280-139">La rutina [**WSPAsyncSelect**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)) es especialmente adecuada para controlar la presencia de datos OOB cuando \_ OOBINLINE está desactivada.</span><span class="sxs-lookup"><span data-stu-id="e8280-139">The [**WSPAsyncSelect**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)) routine is particularly well suited to handling notification of the presence of OOB data when SO\_OOBINLINE is off.</span></span>

 

 
