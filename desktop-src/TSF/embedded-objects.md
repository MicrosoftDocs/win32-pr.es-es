---
title: Objetos incrustados (marco de trabajo de servicios de texto)
description: El marco de trabajo de servicios de texto permite que un servicio de texto inserte objetos en una secuencia de texto de la aplicación.
ms.assetid: 44cb22b5-707b-4f21-b986-5258ed273543
keywords:
- Text Services Framework (TSF), objetos incrustados
- TSF (marco de trabajo de servicios de texto), objetos incrustados
- Aplicaciones habilitadas para TSF, objetos incrustados
- objetos incrustados
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 39e4f819e6f42cc4e8d2ed81e47c79efe5ff7407
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 12/10/2020
ms.locfileid: "104571374"
---
# <a name="embedded-objects-text-services-framework"></a><span data-ttu-id="7dc03-107">Objetos incrustados (marco de trabajo de servicios de texto)</span><span class="sxs-lookup"><span data-stu-id="7dc03-107">Embedded Objects (Text Services Framework)</span></span>

<span data-ttu-id="7dc03-108">El marco de trabajo de servicios de texto permite que un servicio de texto inserte objetos en una secuencia de texto de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="7dc03-108">Text Services Framework enables a text service to embed objects in an application text stream.</span></span> <span data-ttu-id="7dc03-109">Los objetos incrustados se insertan en la secuencia de texto mediante el valor de [carácter de TS \_ \_ incrustado](ts-char--constants.md).</span><span class="sxs-lookup"><span data-stu-id="7dc03-109">Embedded objects are inserted into the text stream using the value [TS\_CHAR\_EMBEDDED](ts-char--constants.md).</span></span> <span data-ttu-id="7dc03-110">Este valor se resuelve como el carácter de reemplazo del objeto Unicode U + fffc, mediante la notación hexadecimal.</span><span class="sxs-lookup"><span data-stu-id="7dc03-110">This value resolves to the Unicode object replacement character U+fffc, using hexadecimal notation.</span></span> <span data-ttu-id="7dc03-111">Por ejemplo, en la siguiente ilustración se muestra la representación de un objeto incrustado que representa el ideograma japonés *HI*, en combinación con la secuencia de caracteres Unicode que representan la traducción en Inglés de "Sun".</span><span class="sxs-lookup"><span data-stu-id="7dc03-111">For example, the following illustration shows the rendering of an embedded object that represents the Japanese ideograph *hi*, in combination with the sequence of Unicode characters that represent the English translation of "Sun."</span></span>

![codificación de caracteres de un objeto incrustado](images/emb-obj.gif)

<span data-ttu-id="7dc03-113">La fila superior de la ilustración contiene el texto traducido, que consta de la palabra "Sun" seguida del carácter japonés de Sun, *HI*.</span><span class="sxs-lookup"><span data-stu-id="7dc03-113">The top row of the figure contains the translated text, consisting of the word "Sun" followed by the Japanese character for sun, *hi*.</span></span> <span data-ttu-id="7dc03-114">La fila central de la ilustración muestra el carácter Unicode.</span><span class="sxs-lookup"><span data-stu-id="7dc03-114">The center row of the figure shows the Unicode character.</span></span> <span data-ttu-id="7dc03-115">En el caso de U + fffc, este es el carácter de reemplazo de objeto.</span><span class="sxs-lookup"><span data-stu-id="7dc03-115">In the case of U+fffc, this is the object replacement character.</span></span> <span data-ttu-id="7dc03-116">La fila inferior de la ilustración muestra el valor hexadecimal de cada carácter.</span><span class="sxs-lookup"><span data-stu-id="7dc03-116">The bottom row of the figure shows the hexadecimal value of each character.</span></span>

## <a name="supporting-embedded-objects-in-an-application"></a><span data-ttu-id="7dc03-117">Compatibilidad de objetos incrustados en una aplicación</span><span class="sxs-lookup"><span data-stu-id="7dc03-117">Supporting Embedded Objects in an Application</span></span>

<span data-ttu-id="7dc03-118">El administrador de TSF inserta un objeto incrustado en la secuencia de texto mediante una llamada a [ITextStoreACP:: InsertEmbedded](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-insertembedded) para una aplicación basada en ACP, o [ITextStoreAnchor:: InsertEmbedded](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-insertembedded) para una aplicación basada en delimitadores.</span><span class="sxs-lookup"><span data-stu-id="7dc03-118">The TSF manager inserts an embedded object into the text stream by calling [ITextStoreACP::InsertEmbedded](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-insertembedded) for an ACP-based application, or [ITextStoreAnchor::InsertEmbedded](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-insertembedded) for an anchor-based application.</span></span> <span data-ttu-id="7dc03-119">Cuando se inserta un objeto incrustado, la aplicación debe colocar el valor **\_ \_ incrustado de carácter de TS** en la posición de carácter (o ubicación de delimitador) donde se incrusta el objeto y almacenar el IDataObject asociado al objeto incrustado.</span><span class="sxs-lookup"><span data-stu-id="7dc03-119">When an embedded object is inserted, the application should place the **TS\_CHAR\_EMBEDDED** value at the character position (or anchor location) where the object is embedded and store the IDataObject associated with the embedded object.</span></span> <span data-ttu-id="7dc03-120">Cuando se llama a [ITextStoreACP:: gettext](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-gettext) o [ITextStoreAnchor:: gettext](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-gettext) y un objeto incrustado se encuentra dentro del texto obtenido, el valor **\_ \_ incrustado de carácter de TS** indica la presencia y la ubicación del objeto incrustado.</span><span class="sxs-lookup"><span data-stu-id="7dc03-120">When [ITextStoreACP::GetText](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-gettext) or [ITextStoreAnchor::GetText](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-gettext) is called and an embedded object is contained within the text obtained, the **TS\_CHAR\_EMBEDDED** value indicates the presence and location of the embedded object.</span></span> <span data-ttu-id="7dc03-121">Para obtener el objeto incrustado, llame a [ITextStoreACP:: GetEmbedded](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-getembedded) con la posición de carácter del objeto incrustado o [ITextStoreAnchor:: GetEmbedded](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-getembedded) con la ubicación de delimitador del objeto incrustado.</span><span class="sxs-lookup"><span data-stu-id="7dc03-121">To obtain the embedded object, call [ITextStoreACP::GetEmbedded](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-getembedded) with the character position of the embedded object, or [ITextStoreAnchor::GetEmbedded](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-getembedded) with the anchor location of the embedded object.</span></span>

<span data-ttu-id="7dc03-122">Normalmente, la aplicación no reconoce el contenido del objeto incrustado.</span><span class="sxs-lookup"><span data-stu-id="7dc03-122">The application does not normally recognize the embedded object contents.</span></span> <span data-ttu-id="7dc03-123">La aplicación puede intentar obtener información de pantalla del propio objeto.</span><span class="sxs-lookup"><span data-stu-id="7dc03-123">The application can attempt to obtain display information from the object itself.</span></span> <span data-ttu-id="7dc03-124">Si el objeto incrustado puede proporcionar datos en un formato reconocido por la aplicación, como el \_ mapa de bits UNICODETEXT o CF \_ , la aplicación puede mostrar información gráfica proporcionada por el objeto.</span><span class="sxs-lookup"><span data-stu-id="7dc03-124">If the embedded object can supply data in a format that the application recognizes, such as CF\_UNICODETEXT or CF\_BITMAP, the application can display graphic information supplied by the object.</span></span>

## <a name="inserting-embedded-objects"></a><span data-ttu-id="7dc03-125">Insertar objetos incrustados</span><span class="sxs-lookup"><span data-stu-id="7dc03-125">Inserting Embedded Objects</span></span>

<span data-ttu-id="7dc03-126">Un servicio de texto inserta un objeto incrustado en un contexto mediante una llamada a [ITfRange:: InsertEmbedded](/windows/desktop/api/msctf/nf-msctf-itfrange-insertembedded) o [ITfInsertAtSelection:: InsertEmbeddedAtSelection](/windows/desktop/api/msctf/nf-msctf-itfinsertatselection-insertembeddedatselection).</span><span class="sxs-lookup"><span data-stu-id="7dc03-126">A text service inserts an embedded object into a context by calling [ITfRange::InsertEmbedded](/windows/desktop/api/msctf/nf-msctf-itfrange-insertembedded) or [ITfInsertAtSelection::InsertEmbeddedAtSelection](/windows/desktop/api/msctf/nf-msctf-itfinsertatselection-insertembeddedatselection).</span></span> <span data-ttu-id="7dc03-127">El servicio de texto debe proporcionar la IDataObject incrustada.</span><span class="sxs-lookup"><span data-stu-id="7dc03-127">The text service must supply the embedded IDataObject.</span></span>

 

 
