---
description: Un proceso secundario puede heredar varias propiedades y recursos de su proceso primario.
ms.assetid: c530e723-2d40-4022-a259-dfc650604e44
title: Herencia (procesos y subprocesos)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4713fe398360b510fab3c66f5cf74dc07b642dac
ms.sourcegitcommit: 3d718d8f69d3f86eaecf94c5705d761c5a9ef4a1
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 10/20/2020
ms.locfileid: "105676521"
---
# <a name="inheritance"></a><span data-ttu-id="e8928-103">Herencia</span><span class="sxs-lookup"><span data-stu-id="e8928-103">Inheritance</span></span>

<span data-ttu-id="e8928-104">Un proceso secundario puede heredar varias propiedades y recursos de su proceso primario.</span><span class="sxs-lookup"><span data-stu-id="e8928-104">A child process can inherit several properties and resources from its parent process.</span></span> <span data-ttu-id="e8928-105">También puede impedir que un proceso secundario herede propiedades de su proceso primario.</span><span class="sxs-lookup"><span data-stu-id="e8928-105">You can also prevent a child process from inheriting properties from its parent process.</span></span> <span data-ttu-id="e8928-106">Se puede heredar lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="e8928-106">The following can be inherited:</span></span>

-   <span data-ttu-id="e8928-107">Abrir los identificadores devueltos por la función [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) .</span><span class="sxs-lookup"><span data-stu-id="e8928-107">Open handles returned by the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function.</span></span> <span data-ttu-id="e8928-108">Esto incluye los identificadores de los archivos, los búferes de entrada de la consola, los búferes de pantalla, las canalizaciones con nombre, los dispositivos de comunicación en serie y los buzones.</span><span class="sxs-lookup"><span data-stu-id="e8928-108">This includes handles to files, console input buffers, console screen buffers, named pipes, serial communication devices, and mailslots.</span></span>
-   <span data-ttu-id="e8928-109">Abrir los identificadores de proceso, subproceso, exclusión mutua, evento, semáforo, canalización con nombre, canalización anónima y objetos de asignación de archivos.</span><span class="sxs-lookup"><span data-stu-id="e8928-109">Open handles to process, thread, mutex, event, semaphore, named-pipe, anonymous-pipe, and file-mapping objects.</span></span> <span data-ttu-id="e8928-110">Los devuelven las funciones [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa), [**CreateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread), [**CreateMutex**](/windows/desktop/api/synchapi/nf-synchapi-createmutexa), [**CreateEvent**](/windows/desktop/api/synchapi/nf-synchapi-createeventa), [**createsemaphore (**](/windows/desktop/api/winbase/nf-winbase-createsemaphorea), [**CreateNamedPipe**](/windows/desktop/api/winbase/nf-winbase-createnamedpipea), [**CreatePipe**](/windows/desktop/api/namedpipeapi/nf-namedpipeapi-createpipe)y [**CreateFileMapping**](/windows/desktop/api/winbase/nf-winbase-createfilemappinga) , respectivamente.</span><span class="sxs-lookup"><span data-stu-id="e8928-110">These are returned by the [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa), [**CreateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createthread), [**CreateMutex**](/windows/desktop/api/synchapi/nf-synchapi-createmutexa), [**CreateEvent**](/windows/desktop/api/synchapi/nf-synchapi-createeventa), [**CreateSemaphore**](/windows/desktop/api/winbase/nf-winbase-createsemaphorea), [**CreateNamedPipe**](/windows/desktop/api/winbase/nf-winbase-createnamedpipea), [**CreatePipe**](/windows/desktop/api/namedpipeapi/nf-namedpipeapi-createpipe), and [**CreateFileMapping**](/windows/desktop/api/winbase/nf-winbase-createfilemappinga) functions, respectively.</span></span>
-   <span data-ttu-id="e8928-111">Variables de entorno.</span><span class="sxs-lookup"><span data-stu-id="e8928-111">Environment variables.</span></span>
-   <span data-ttu-id="e8928-112">El directorio actual.</span><span class="sxs-lookup"><span data-stu-id="e8928-112">The current directory.</span></span>
-   <span data-ttu-id="e8928-113">La consola, a menos que se desasocie el proceso o se cree una nueva consola.</span><span class="sxs-lookup"><span data-stu-id="e8928-113">The console, unless the process is detached or a new console is created.</span></span> <span data-ttu-id="e8928-114">Un proceso de consola secundaria también puede heredar los identificadores estándar del elemento primario, así como el acceso al búfer de entrada y al búfer de pantalla activo.</span><span class="sxs-lookup"><span data-stu-id="e8928-114">A child console process can also inherit the parent's standard handles, as well as access to the input buffer and the active screen buffer.</span></span>
-   <span data-ttu-id="e8928-115">El modo de error, según lo establecido por la función [**SetErrorMode**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-seterrormode) .</span><span class="sxs-lookup"><span data-stu-id="e8928-115">The error mode, as set by the [**SetErrorMode**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-seterrormode) function.</span></span>
-   <span data-ttu-id="e8928-116">Máscara de afinidad del procesador.</span><span class="sxs-lookup"><span data-stu-id="e8928-116">The processor affinity mask.</span></span>
-   <span data-ttu-id="e8928-117">Asociación con un trabajo.</span><span class="sxs-lookup"><span data-stu-id="e8928-117">The association with a job.</span></span>

<span data-ttu-id="e8928-118">El proceso secundario no hereda lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="e8928-118">The child process does not inherit the following:</span></span>

-   <span data-ttu-id="e8928-119">Clase de prioridad.</span><span class="sxs-lookup"><span data-stu-id="e8928-119">Priority class.</span></span>
-   <span data-ttu-id="e8928-120">Identificadores devueltos por [**LocalAlloc**](/windows/desktop/api/winbase/nf-winbase-localalloc), [**GlobalAlloc**](/windows/desktop/api/winbase/nf-winbase-globalalloc), [**HeapCreate**](/windows/desktop/api/heapapi/nf-heapapi-heapcreate)y [**HeapAlloc**](/windows/desktop/api/heapapi/nf-heapapi-heapalloc).</span><span class="sxs-lookup"><span data-stu-id="e8928-120">Handles returned by [**LocalAlloc**](/windows/desktop/api/winbase/nf-winbase-localalloc), [**GlobalAlloc**](/windows/desktop/api/winbase/nf-winbase-globalalloc), [**HeapCreate**](/windows/desktop/api/heapapi/nf-heapapi-heapcreate), and [**HeapAlloc**](/windows/desktop/api/heapapi/nf-heapapi-heapalloc).</span></span>
-   <span data-ttu-id="e8928-121">Pseudo manipuladores, como en los identificadores devueltos por la función [**GetCurrentProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getcurrentprocess) o [**GetCurrentThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getcurrentthread) .</span><span class="sxs-lookup"><span data-stu-id="e8928-121">Pseudo handles, as in the handles returned by the [**GetCurrentProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getcurrentprocess) or [**GetCurrentThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getcurrentthread) function.</span></span> <span data-ttu-id="e8928-122">Estos identificadores solo son válidos para el proceso de llamada.</span><span class="sxs-lookup"><span data-stu-id="e8928-122">These handles are valid only for the calling process.</span></span>
-   <span data-ttu-id="e8928-123">Identificadores de módulo DLL devueltos por la función [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) .</span><span class="sxs-lookup"><span data-stu-id="e8928-123">DLL module handles returned by the [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) function.</span></span>
-   <span data-ttu-id="e8928-124">GDI o identificadores de usuario, como **hBitmap** o **HMENU**.</span><span class="sxs-lookup"><span data-stu-id="e8928-124">GDI or USER handles, such as **HBITMAP** or **HMENU**.</span></span>

## <a name="inheriting-handles"></a><span data-ttu-id="e8928-125">Herencia de identificadores</span><span class="sxs-lookup"><span data-stu-id="e8928-125">Inheriting Handles</span></span>

<span data-ttu-id="e8928-126">Un proceso secundario puede heredar algunos de sus identificadores principales, pero no heredar otros.</span><span class="sxs-lookup"><span data-stu-id="e8928-126">A child process can inherit some of its parent's handles, but not inherit others.</span></span> <span data-ttu-id="e8928-127">Para hacer que un identificador se herede, debe hacer dos cosas:</span><span class="sxs-lookup"><span data-stu-id="e8928-127">To cause a handle to be inherited, you must do two things:</span></span>

-   <span data-ttu-id="e8928-128">Especifique que el identificador se va a heredar al crear, abrir o duplicar el identificador.</span><span class="sxs-lookup"><span data-stu-id="e8928-128">Specify that the handle is to be inherited when you create, open, or duplicate the handle.</span></span> <span data-ttu-id="e8928-129">Las funciones de creación suelen usar el miembro **bInheritHandle** de una estructura de [**\_ atributos de seguridad**](/previous-versions/windows/desktop/legacy/aa379560(v=vs.85)) para este propósito.</span><span class="sxs-lookup"><span data-stu-id="e8928-129">Creation functions typically use the **bInheritHandle** member of a [**SECURITY\_ATTRIBUTES**](/previous-versions/windows/desktop/legacy/aa379560(v=vs.85)) structure for this purpose.</span></span> <span data-ttu-id="e8928-130">[**DuplicateHandle**](/windows/desktop/api/handleapi/nf-handleapi-duplicatehandle) usa el parámetro *bInheritHandles* .</span><span class="sxs-lookup"><span data-stu-id="e8928-130">[**DuplicateHandle**](/windows/desktop/api/handleapi/nf-handleapi-duplicatehandle) uses the *bInheritHandles* parameter.</span></span>
-   <span data-ttu-id="e8928-131">Especifique que se hereden los identificadores heredables estableciendo el parámetro *bInheritHandles* en true al llamar a la función [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) .</span><span class="sxs-lookup"><span data-stu-id="e8928-131">Specify that inheritable handles are to be inherited by setting the *bInheritHandles* parameter to TRUE when calling the [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) function.</span></span> <span data-ttu-id="e8928-132">Además, para heredar los identificadores de entrada estándar, salida estándar y error estándar, el miembro **dwFlags** de la estructura [**STARTUPINFO**](/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfoa) debe incluir STARTF \_ USESTDHANDLES.</span><span class="sxs-lookup"><span data-stu-id="e8928-132">Additionally, to inherit the standard input, standard output, and standard error handles, the **dwFlags** member of the [**STARTUPINFO**](/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfoa) structure must include STARTF\_USESTDHANDLES.</span></span>

<span data-ttu-id="e8928-133">Para especificar una lista de los identificadores que debe heredar un proceso secundario concreto, llame a la función [**UpdateProcThreadAttribute**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-updateprocthreadattribute) con la marca *PROC_THREAD_ATTRIBUTE_HANDLE_LIST* .</span><span class="sxs-lookup"><span data-stu-id="e8928-133">To specify a list of the handles that should be inherited by a specific child process, call the [**UpdateProcThreadAttribute**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-updateprocthreadattribute) function with the *PROC_THREAD_ATTRIBUTE_HANDLE_LIST* flag.</span></span>

<span data-ttu-id="e8928-134">Un identificador heredado hace referencia al mismo objeto en el proceso secundario que en el proceso primario.</span><span class="sxs-lookup"><span data-stu-id="e8928-134">An inherited handle refers to the same object in the child process as it does in the parent process.</span></span> <span data-ttu-id="e8928-135">También tiene el mismo valor y privilegios de acceso.</span><span class="sxs-lookup"><span data-stu-id="e8928-135">It also has the same value and access privileges.</span></span> <span data-ttu-id="e8928-136">Por lo tanto, cuando un proceso cambia el estado del objeto, el cambio afecta a ambos procesos.</span><span class="sxs-lookup"><span data-stu-id="e8928-136">Therefore, when one process changes the state of the object, the change affects both processes.</span></span> <span data-ttu-id="e8928-137">Para usar un identificador, el proceso secundario debe recuperar el valor del identificador y "conocer" el objeto al que hace referencia.</span><span class="sxs-lookup"><span data-stu-id="e8928-137">To use a handle, the child process must retrieve the handle value and "know" the object to which it refers.</span></span> <span data-ttu-id="e8928-138">Normalmente, el proceso primario comunica esta información al proceso secundario a través de la línea de comandos, el bloque de entorno o algún tipo de [comunicación entre procesos](/windows/desktop/ipc/interprocess-communications).</span><span class="sxs-lookup"><span data-stu-id="e8928-138">Usually, the parent process communicates this information to the child process through its command line, environment block, or some form of [interprocess communication](/windows/desktop/ipc/interprocess-communications).</span></span>

<span data-ttu-id="e8928-139">Utilice la función [**SetHandleInformation**](/windows/win32/api/handleapi/nf-handleapi-sethandleinformation) para controlar si un identificador existente es heredable o no.</span><span class="sxs-lookup"><span data-stu-id="e8928-139">Use the [**SetHandleInformation**](/windows/win32/api/handleapi/nf-handleapi-sethandleinformation) function to control if an existing handle is inheritable or not.</span></span>

## <a name="inheriting-environment-variables"></a><span data-ttu-id="e8928-140">Heredar variables de entorno</span><span class="sxs-lookup"><span data-stu-id="e8928-140">Inheriting Environment Variables</span></span>

<span data-ttu-id="e8928-141">De forma predeterminada, un proceso secundario hereda las variables de entorno del proceso primario.</span><span class="sxs-lookup"><span data-stu-id="e8928-141">A child process inherits the environment variables of its parent process by default.</span></span> <span data-ttu-id="e8928-142">Sin embargo, [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) permite al proceso primario especificar un bloque diferente de variables de entorno.</span><span class="sxs-lookup"><span data-stu-id="e8928-142">However, [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) enables the parent process to specify a different block of environment variables.</span></span> <span data-ttu-id="e8928-143">Para obtener más información, consulte [variables de entorno](environment-variables.md).</span><span class="sxs-lookup"><span data-stu-id="e8928-143">For more information, see [Environment Variables](environment-variables.md).</span></span>

## <a name="inheriting-the-current-directory"></a><span data-ttu-id="e8928-144">Heredar el directorio actual</span><span class="sxs-lookup"><span data-stu-id="e8928-144">Inheriting the Current Directory</span></span>

<span data-ttu-id="e8928-145">La función [**GetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-getcurrentdirectory) recupera el directorio actual del proceso que realiza la llamada.</span><span class="sxs-lookup"><span data-stu-id="e8928-145">The [**GetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-getcurrentdirectory) function retrieves the current directory of the calling process.</span></span> <span data-ttu-id="e8928-146">De forma predeterminada, un proceso secundario hereda el directorio actual de su proceso primario.</span><span class="sxs-lookup"><span data-stu-id="e8928-146">A child process inherits the current directory of its parent process by default.</span></span> <span data-ttu-id="e8928-147">Sin embargo, [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) permite al proceso primario especificar un directorio actual diferente para el proceso secundario.</span><span class="sxs-lookup"><span data-stu-id="e8928-147">However, [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) enables the parent process to specify a different current directory for the child process.</span></span> <span data-ttu-id="e8928-148">Para cambiar el directorio actual del proceso de llamada, use la función [**SetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-setcurrentdirectory) .</span><span class="sxs-lookup"><span data-stu-id="e8928-148">To change the current directory of the calling process, use the [**SetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-setcurrentdirectory) function.</span></span>
