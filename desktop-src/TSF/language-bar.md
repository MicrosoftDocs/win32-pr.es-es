---
title: Barra de idioma (Text Services)
description: Barra de idioma
ms.assetid: 82b92567-fdc1-488c-b395-4cb95257955c
keywords:
- Text Services Framework (TSF),barra de idioma
- TSF (Text Services Framework),barra de idioma
- servicios de texto, barra de idioma
- barra de idioma
- Text Services Framework (TSF),buttons
- TSF (Text Services Framework),buttons
- servicios de texto, botones
- Text Services Framework (TSF),menus
- TSF (Text Services Framework),menus
- servicios de texto, menús
- estilos de botón
- botones de menú
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0e3c4359c6753f5d96613435f9501036f1d5f317
ms.sourcegitcommit: 8ebcf6cd36f67f8bcf78e76ae8923d65b8995c8a
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/05/2021
ms.locfileid: "111524449"
---
# <a name="language-bar-text-services"></a><span data-ttu-id="9ec8c-115">Barra de idioma (Text Services)</span><span class="sxs-lookup"><span data-stu-id="9ec8c-115">Language Bar (Text Services)</span></span>

## <a name="implementing-the-language-bar-object"></a><span data-ttu-id="9ec8c-116">Implementar el objeto de barra de lenguaje</span><span class="sxs-lookup"><span data-stu-id="9ec8c-116">Implementing the Language Bar Object</span></span>

<span data-ttu-id="9ec8c-117">Para admitir la adición de un elemento a la barra de lenguaje, un servicio de texto debe implementar un objeto que admita la interfaz [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) y uno de los elementos de control [ITfLangBarItem.](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritem)</span><span class="sxs-lookup"><span data-stu-id="9ec8c-117">To support adding an item to the language bar, a text service must implement an object that supports the [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) interface and one of the [ITfLangBarItem](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritem) control elements.</span></span> <span data-ttu-id="9ec8c-118">Cuando se instala el elemento, la barra de idioma instala un receptor [ITfLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemsink) llamando al [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) del elemento con IID \_ ITfLangBarItemSink.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-118">When the item is installed, the language bar installs an [ITfLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemsink) sink by calling the item's [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfLangBarItemSink.</span></span> <span data-ttu-id="9ec8c-119">El elemento usa la **interfaz ITfLangBarItemSink** para notificar a la barra de idioma los cambios, por ejemplo, cuando el elemento está oculto, mostrado, habilitado o deshabilitado.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-119">The item uses the **ITfLangBarItemSink** interface to notify the language bar of changes, for example when the item is hidden, shown, enabled, or disabled.</span></span>

<span data-ttu-id="9ec8c-120">Se pueden instalar cuatro tipos de elementos de barra de lenguaje y cada una de las interfaces necesarias se crea a partir **de ITfLangBarItem**.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-120">Four types of language bar items can be installed and each of the required interfaces is created from **ITfLangBarItem**.</span></span> <span data-ttu-id="9ec8c-121">Los siguientes son posibles elementos de control **ITfLangBarItem.**</span><span class="sxs-lookup"><span data-stu-id="9ec8c-121">The following are possible **ITfLangBarItem** control elements.</span></span>



|   <span data-ttu-id="9ec8c-122">Elemento</span><span class="sxs-lookup"><span data-stu-id="9ec8c-122">Element</span></span>            |    <span data-ttu-id="9ec8c-123">Descripción</span><span class="sxs-lookup"><span data-stu-id="9ec8c-123">Description</span></span>                                                                                                                                                                               |
|---------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="9ec8c-124">Botón</span><span class="sxs-lookup"><span data-stu-id="9ec8c-124">Button</span></span>        | <span data-ttu-id="9ec8c-125">Un botón de barra de idioma funciona como un botón de comando, un control de alternancia o un menú en la barra de idioma.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-125">A language bar button functions as a command button, toggle control, or a menu on the language bar.</span></span> <span data-ttu-id="9ec8c-126">El objeto debe admitir la interfaz ITfLangBarItemButton.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-126">The object must support the ITfLangBarItemButton interface.</span></span>                   |
| <span data-ttu-id="9ec8c-127">Globo</span><span class="sxs-lookup"><span data-stu-id="9ec8c-127">Balloon</span></span>       | <span data-ttu-id="9ec8c-128">Un globo de barra de idioma funciona como una notificación emergente en la barra de idioma.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-128">A language bar balloon functions as a pop-up notification on the language bar.</span></span> <span data-ttu-id="9ec8c-129">El objeto debe admitir la interfaz ITfLangBarItemBalloon.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-129">The object must support the ITfLangBarItemBalloon interface.</span></span>                                       |
| <span data-ttu-id="9ec8c-130">Bitmap</span><span class="sxs-lookup"><span data-stu-id="9ec8c-130">Bitmap</span></span>        | <span data-ttu-id="9ec8c-131">Un mapa de bits de barra de idioma funciona como un elemento estático en la barra de idioma que muestra un mapa de bits.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-131">A language bar bitmap functions as a static element on the language bar that displays a bitmap.</span></span> <span data-ttu-id="9ec8c-132">El objeto debe admitir la interfaz ITfLangBarItemBitmap.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-132">The object must support the ITfLangBarItemBitmap interface.</span></span>                       |
| <span data-ttu-id="9ec8c-133">Botón De mapa de bits</span><span class="sxs-lookup"><span data-stu-id="9ec8c-133">Bitmap Button</span></span> | <span data-ttu-id="9ec8c-134">Un botón de mapa de bits de barra de idioma funciona como un elemento de botón en la barra de idioma que muestra texto y un mapa de bits.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-134">A language bar bitmap button functions as a button element on the language bar that displays text and a bitmap.</span></span> <span data-ttu-id="9ec8c-135">El objeto debe admitir la interfaz ITfLangBarItemBitmapButton.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-135">The object must support the ITfLangBarItemBitmapButton interface.</span></span> |



 

## <a name="button-styles"></a><span data-ttu-id="9ec8c-136">Estilos de botón</span><span class="sxs-lookup"><span data-stu-id="9ec8c-136">Button Styles</span></span>

<span data-ttu-id="9ec8c-137">Un elemento de botón puede funcionar como cualquiera de las siguientes.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-137">A button element can function as any of the following.</span></span> <span data-ttu-id="9ec8c-138">La función del elemento de botón viene determinada por las marcas establecidas en el **miembro dwStyle** de la estructura [ \_ LANGBARITEMINFO de TF](/windows/desktop/api/ctfutb/ns-ctfutb-tf_langbariteminfo) en el método [ITfLangBarItem::GetInfo.](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritem-getinfo)</span><span class="sxs-lookup"><span data-stu-id="9ec8c-138">The function of the button item is determined by the flags set in the **dwStyle** member of the [TF\_LANGBARITEMINFO](/windows/desktop/api/ctfutb/ns-ctfutb-tf_langbariteminfo) structure in the [ITfLangBarItem::GetInfo](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritem-getinfo) method.</span></span>



|    <span data-ttu-id="9ec8c-139">Elemento</span><span class="sxs-lookup"><span data-stu-id="9ec8c-139">Element</span></span>           |    <span data-ttu-id="9ec8c-140">Descripción</span><span class="sxs-lookup"><span data-stu-id="9ec8c-140">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                  |
|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="9ec8c-141">Botón</span><span class="sxs-lookup"><span data-stu-id="9ec8c-141">Button</span></span>        | <span data-ttu-id="9ec8c-142">El botón funciona como un botón de comando estándar.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-142">The button functions as a standard command button.</span></span> <span data-ttu-id="9ec8c-143">Este estilo de botón se identifica mediante el estilo \_ TF LBI \_ STYLE \_ BTN \_ BUTTON.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-143">This button style is identified by the TF\_LBI\_STYLE\_BTN\_BUTTON style.</span></span> <span data-ttu-id="9ec8c-144">Se llama a ITfLangBarItemButton::OnClick cuando se hace clic en el elemento.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-144">ITfLangBarItemButton::OnClick is called when the item is clicked.</span></span> <span data-ttu-id="9ec8c-145">No se usan ITfLangBarItemButton::InitMenu e ITfLangBarItemButton::OnMenuSelect.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-145">ITfLangBarItemButton::InitMenu and ITfLangBarItemButton::OnMenuSelect are not used.</span></span>                                                                                                   |
| <span data-ttu-id="9ec8c-146">Botón de alternancia</span><span class="sxs-lookup"><span data-stu-id="9ec8c-146">Toggle Button</span></span> | <span data-ttu-id="9ec8c-147">El botón funciona como un control de alternancia que puede mantener un estado en el que se ha hecho clic, de forma similar a una casilla.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-147">The button functions as a toggle control that can maintain a clicked state, similar to a check box.</span></span> <span data-ttu-id="9ec8c-148">Este estilo de botón se identifica mediante el estilo \_ TF LBI \_ STYLE \_ BTN \_ TOGGLE.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-148">This button style is identified by the TF\_LBI\_STYLE\_BTN\_TOGGLE style.</span></span> <span data-ttu-id="9ec8c-149">Se llama a ITfLangBarItemButton::OnClick cuando se hace clic en el elemento.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-149">ITfLangBarItemButton::OnClick is called when the item is clicked.</span></span> <span data-ttu-id="9ec8c-150">No se usan ITfLangBarItemButton::InitMenu e ITfLangBarItemButton::OnMenuSelect.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-150">ITfLangBarItemButton::InitMenu and ITfLangBarItemButton::OnMenuSelect are not used.</span></span>                                                  |
| <span data-ttu-id="9ec8c-151">Menú</span><span class="sxs-lookup"><span data-stu-id="9ec8c-151">Menu</span></span>          | <span data-ttu-id="9ec8c-152">El botón funciona como un menú desplegable.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-152">The button functions as a drop-down menu.</span></span> <span data-ttu-id="9ec8c-153">Este estilo de botón se identifica mediante el estilo TF \_ LBI \_ STYLE \_ BTN \_ MENU.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-153">This button style is identified by the TF\_LBI\_STYLE\_BTN\_MENU style.</span></span> <span data-ttu-id="9ec8c-154">Cuando se hace clic en el botón, se llama a ITfLangBarItemButton::InitMenu.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-154">ITfLangBarItemButton::InitMenu is called when the button is clicked.</span></span> <span data-ttu-id="9ec8c-155">Cuando el usuario selecciona un elemento en el menú, la barra de idioma llama a ITfLangBarItemButton::OnMenuSelect con el identificador del elemento de menú seleccionado.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-155">When the user selects an item in the menu, the language bar calls ITfLangBarItemButton::OnMenuSelect with the identifier of the selected menu item.</span></span> <span data-ttu-id="9ec8c-156">ITfLangBarItemButton::OnClick no se usa.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-156">ITfLangBarItemButton::OnClickis not used.</span></span> |



 

## <a name="implementing-a-menu-button"></a><span data-ttu-id="9ec8c-157">Implementar un botón de menú</span><span class="sxs-lookup"><span data-stu-id="9ec8c-157">Implementing a Menu Button</span></span>

<span data-ttu-id="9ec8c-158">Cuando el usuario hace clic en un botón de menú, la barra de idioma llama a [ITfLangBarItemButton::InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu).</span><span class="sxs-lookup"><span data-stu-id="9ec8c-158">When the user clicks a menu button, the language bar calls [ITfLangBarItemButton::InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu).</span></span> <span data-ttu-id="9ec8c-159">El elemento agrega elementos al menú mediante la [interfaz ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) pasada a InitMenu.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-159">The item adds items to the menu using the [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) interface passed to InitMenu.</span></span>

<span data-ttu-id="9ec8c-160">Para agregar un submenú al menú, llame a [ITfMenu::AddMenuItem](/windows/desktop/api/Ctfutb/nf-ctfutb-itfmenu-addmenuitem) con TF \_ LBMENUF \_ SUBMENU.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-160">To add a submenu to the menu, call [ITfMenu::AddMenuItem](/windows/desktop/api/Ctfutb/nf-ctfutb-itfmenu-addmenuitem) with TF\_LBMENUF\_SUBMENU.</span></span> <span data-ttu-id="9ec8c-161">Cuando esto se hace, se devuelve un nuevo **objeto ITfMenu** que representa el submenú en el parámetro *ppMenu* de AddMenuItem.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-161">When this is done, a new **ITfMenu** object that represents the submenu is returned in the *ppMenu* parameter of AddMenuItem.</span></span> <span data-ttu-id="9ec8c-162">Este nuevo objeto de menú se usa para agregar elementos al submenú.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-162">This new menu object is used to add items to the submenu.</span></span>

<span data-ttu-id="9ec8c-163">Cuando el usuario selecciona un elemento en el menú, la barra de idioma llama a [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) con el identificador del elemento de menú seleccionado.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-163">When the user selects an item in the menu, the language bar calls [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) with the identifier of the selected menu item.</span></span>

## <a name="adding-items-to-the-language-bar"></a><span data-ttu-id="9ec8c-164">Agregar elementos a la barra de idioma</span><span class="sxs-lookup"><span data-stu-id="9ec8c-164">Adding Items to the Language Bar</span></span>

<span data-ttu-id="9ec8c-165">Un servicio de texto debe agregar sus elementos a la barra de lenguaje cuando se llama a su método [ITfTextInputProcessor::Activate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-activate) y quitarlos cuando se llama a [su ITfTextInputProcessor::D eactivate.](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-deactivate)</span><span class="sxs-lookup"><span data-stu-id="9ec8c-165">A text service should add its items to the language bar when its [ITfTextInputProcessor::Activate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-activate) method is called and remove them when its [ITfTextInputProcessor::Deactivate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-deactivate) is called.</span></span>

<span data-ttu-id="9ec8c-166">Para agregar un elemento a la barra de lenguaje, el servicio de texto obtiene una interfaz [ITfLangBarItemMgr](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemmgr) mediante una llamada a ITfThreadMgr::QueryInterface con IID \_ ITfLangBarItemMgr.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-166">To add an item to the language bar, the text service obtains an [ITfLangBarItemMgr](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemmgr) interface by calling ITfThreadMgr::QueryInterface with IID\_ITfLangBarItemMgr.</span></span> <span data-ttu-id="9ec8c-167">A continuación, el servicio de texto [llama a ITfLangBarItemMgr::AddItem con](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-additem) el puntero al objeto de elemento de la barra de lenguaje.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-167">The text service then calls [ITfLangBarItemMgr::AddItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-additem) with the pointer to the language bar item object.</span></span>

<span data-ttu-id="9ec8c-168">El servicio de texto debe quitar el elemento cuando esté desactivado.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-168">The text service must remove the item when deactivated.</span></span> <span data-ttu-id="9ec8c-169">El servicio de texto usa la misma **interfaz ITfLangBarItemMgr** que se usa para agregar los elementos u obtiene otra instancia de la interfaz.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-169">The text service either uses the same **ITfLangBarItemMgr** interface used to add the items or obtains another instance of the interface.</span></span> <span data-ttu-id="9ec8c-170">A continuación, el servicio de texto llama a [ITfLangBarItemMgr::RemoveItem con](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-removeitem) el puntero de interfaz del elemento que se va a quitar.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-170">The text service then calls [ITfLangBarItemMgr::RemoveItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-removeitem) with the interface pointer of the item to remove.</span></span>

## <a name="extending-system-language-bar-items"></a><span data-ttu-id="9ec8c-171">Extender elementos de la barra de lenguaje del sistema</span><span class="sxs-lookup"><span data-stu-id="9ec8c-171">Extending System Language Bar Items</span></span>

<span data-ttu-id="9ec8c-172">TSF proporciona la capacidad de agregar elementos de menú a los menús de la barra de idioma existentes.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-172">TSF provides the ability to add menu items to existing language bar menus.</span></span> <span data-ttu-id="9ec8c-173">Esto permite que un servicio de texto agregue elementos al menú de otro servicio de texto sin tener que agregar un botón independiente a la barra de herramientas.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-173">This enables a text service to add items to the menu of another text service without having to add a separate button to the toolbar.</span></span> <span data-ttu-id="9ec8c-174">Esto también permite que los elementos de menú se organicen en grupos lógicos.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-174">This also enables the menu items to be organized into logical groups.</span></span> <span data-ttu-id="9ec8c-175">Por ejemplo, un servicio de texto que proporciona características adicionales al servicio de texto de voz estándar puede agregar elementos al menú del servicio de texto de voz en lugar de agregar su propio botón de menú de nivel superior.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-175">For example, a text service that provides additional features to the standard speech text service can add items to the speech text service menu rather than adding its own top-level menu button.</span></span>

<span data-ttu-id="9ec8c-176">Un servicio de texto proporciona una extensión de menú de barra de lenguaje mediante la implementación de un objeto que admite la [interfaz ITfSystemLangBarItemSink.](/windows/desktop/api/ctfutb/nn-ctfutb-itfsystemlangbaritemsink)</span><span class="sxs-lookup"><span data-stu-id="9ec8c-176">A text service provides a language bar menu extension by implementing an object that supports the [ITfSystemLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itfsystemlangbaritemsink) interface.</span></span> <span data-ttu-id="9ec8c-177">Esta interfaz funciona exactamente igual que la [interfaz ITfLangBarItemButton](/windows/desktop/api/Ctfutb/nn-ctfutb-itflangbaritembutton) para un botón de menú.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-177">This interface works exactly like the [ITfLangBarItemButton](/windows/desktop/api/Ctfutb/nn-ctfutb-itflangbaritembutton) interface for a menu button.</span></span> <span data-ttu-id="9ec8c-178">Cuando se muestra el menú, el servicio de texto extendido llama a [ITfSystemLangBarItemSink::InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu).</span><span class="sxs-lookup"><span data-stu-id="9ec8c-178">When the menu is displayed, the text service being extended calls [ITfSystemLangBarItemSink::InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu).</span></span> <span data-ttu-id="9ec8c-179">La extensión agrega elementos al menú mediante la [interfaz ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) pasada a **InitMenu**.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-179">The extension adds items to the menu using the [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) interface passed to **InitMenu**.</span></span> <span data-ttu-id="9ec8c-180">Cuando el usuario selecciona un elemento agregado por la extensión, el servicio de texto extendido llama a [ITfSystemLangBarItemSink::OnMenuSelect](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-onmenuselect) con el identificador del elemento de menú seleccionado.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-180">When the user selects an item added by the extension, the text service being extended calls [ITfSystemLangBarItemSink::OnMenuSelect](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-onmenuselect) with the identifier of the selected menu item.</span></span>

<span data-ttu-id="9ec8c-181">Para instalar una extensión de menú de barra de idioma, el servicio de texto completa los pasos siguientes.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-181">To install a language bar menu extension, the text service completes the following steps.</span></span>

1.  <span data-ttu-id="9ec8c-182">Obtenga la **interfaz ITfLangBarItem** para que el elemento se extienda mediante una llamada a [ITfLangBarItemMgr::GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem) con el **GUID** para el elemento que se va a extender.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-182">Obtain the **ITfLangBarItem** interface for the item to extend by calling [ITfLangBarItemMgr::GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem) with the **GUID** for the item to be extended.</span></span>
2.  <span data-ttu-id="9ec8c-183">Obtenga la **interfaz ITfSource del** elemento que se va a extender llamando a ITfLangBarItem::QueryInterface con IID \_ ITfSource.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-183">Obtain the **ITfSource** interface for the item to extend by calling ITfLangBarItem::QueryInterface with IID\_ITfSource.</span></span>
3.  <span data-ttu-id="9ec8c-184">Llame [a ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) con IID ITfSystemLangBarItemSink y el puntero al \_ objeto **ITfSystemLangBarItemSink.**</span><span class="sxs-lookup"><span data-stu-id="9ec8c-184">Call [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfSystemLangBarItemSink and the pointer to the **ITfSystemLangBarItemSink** object.</span></span> <span data-ttu-id="9ec8c-185">Si se produce un error en ITfSource::AdviseSink, el servicio de texto no admite extensiones de menú.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-185">If ITfSource::AdviseSink fails, the text service does not support menu extensions.</span></span>

<span data-ttu-id="9ec8c-186">[ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink)**ITfSource::AdviseSink**</span><span class="sxs-lookup"><span data-stu-id="9ec8c-186">[ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink)**ITfSource::AdviseSink**</span></span>

## <a name="supporting-language-bar-menu-extensions"></a><span data-ttu-id="9ec8c-187">Compatibilidad con las extensiones de menú de la barra de idioma</span><span class="sxs-lookup"><span data-stu-id="9ec8c-187">Supporting Language Bar Menu Extensions</span></span>

<span data-ttu-id="9ec8c-188">Un servicio de texto puede permitir que otros servicios de texto agreguen elementos a los menús de la barra de idioma, como se ha mostrado anteriormente.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-188">A text service can enable other text services to add items to its language bar menus as shown above.</span></span> <span data-ttu-id="9ec8c-189">El servicio de texto que debe publicar su GUID para que el elemento se pueda obtener llamando a [ITfLangBarItemMgr::GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem).</span><span class="sxs-lookup"><span data-stu-id="9ec8c-189">The text service that must publish its GUID so that the item can be obtained by calling [ITfLangBarItemMgr::GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem).</span></span>

<span data-ttu-id="9ec8c-190">Para admitir extensiones de menú, el servicio de texto debe admitir la [interfaz ITfSource.](/windows/desktop/api/msctf/nn-msctf-itfsource)</span><span class="sxs-lookup"><span data-stu-id="9ec8c-190">To support menu extensions, the text service must support the [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) interface.</span></span> <span data-ttu-id="9ec8c-191">Los pasos siguientes habilitan la compatibilidad con una o varias extensiones de menú.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-191">The following steps enable support for one or more menu extensions.</span></span>

1.  <span data-ttu-id="9ec8c-192">Cuando se llama a [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) con IID ITfSystemLangBarItemSink, el servicio de texto debe almacenar la interfaz \_ **ITfSystemLangBarItemSink** y devolver un valor de cookie que identifique la extensión.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-192">When [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfSystemLangBarItemSink is called, the text service must store the **ITfSystemLangBarItemSink** interface and return a cookie value that will identify the extension.</span></span>
2.  <span data-ttu-id="9ec8c-193">Cuando se llama a [ITfLangBarItemButton::InitMenu,](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu) el servicio de texto llama al método [ITfSystemLangBarItemSink::InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu) de la extensión.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-193">When [ITfLangBarItemButton::InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu) is called, the text service calls the extension's [ITfSystemLangBarItemSink::InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu) method.</span></span> <span data-ttu-id="9ec8c-194">El servicio de texto debe implementar una manera de identificar los elementos de menú agregados por la extensión en lugar de los elementos agregados por el propio servicio de texto.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-194">The text service must implement a way to identify the menu items added by the extension as opposed to the items added by the text service itself.</span></span>
3.  <span data-ttu-id="9ec8c-195">Cuando se llama a [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) con un identificador de elemento de menú que pertenece a una extensión, el servicio de texto llama al método **ITfSystemLangBarItemSink::OnMenuSelect** de las extensiones.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-195">When [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) is called with a menu item identifier that belongs to an extension, the text service calls the extensions's **ITfSystemLangBarItemSink::OnMenuSelect** method.</span></span>
4.  <span data-ttu-id="9ec8c-196">Cuando [se llama a ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink) con la cookie adecuada, el servicio de texto quita la extensión de menú.</span><span class="sxs-lookup"><span data-stu-id="9ec8c-196">When [ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink) is called with the appropriate cookie, the text service removes the menu extension.</span></span>

## <a name="related-topics"></a><span data-ttu-id="9ec8c-197">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="9ec8c-197">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="9ec8c-198">Configuración de Text Services Framework</span><span class="sxs-lookup"><span data-stu-id="9ec8c-198">How To Set Up Text Services Framework</span></span>](how-to-set-up-tsf.md)
</dt> <dt>

[<span data-ttu-id="9ec8c-199">Barra de lenguaje (aplicaciones)</span><span class="sxs-lookup"><span data-stu-id="9ec8c-199">Language Bar (Applications)</span></span>](language-bar-app.md)
</dt> </dl>

 

 
