---
description: .
ms.assetid: 0e5a633e-1703-4b72-8a04-6da71aec0ae2
title: Consulta del proceso en Windows Search
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d92d868cb843e96b04d6b4bd575284638b6652ee
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "103808911"
---
# <a name="querying-process-in-windows-search"></a><span data-ttu-id="8998c-103">Consulta del proceso en Windows Search</span><span class="sxs-lookup"><span data-stu-id="8998c-103">Querying Process in Windows Search</span></span>

<span data-ttu-id="8998c-104">Este tema se organiza de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="8998c-104">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="8998c-105">Acerca de las consultas en Windows Search</span><span class="sxs-lookup"><span data-stu-id="8998c-105">About Querying in Windows Search</span></span>](#about-querying-in-windows-search)
    -   [<span data-ttu-id="8998c-106">Consultas locales y remotas</span><span class="sxs-lookup"><span data-stu-id="8998c-106">Local and Remote Queries</span></span>](#local-and-remote-queries)
    -   [<span data-ttu-id="8998c-107">Información general sobre la API de consulta estructurada</span><span class="sxs-lookup"><span data-stu-id="8998c-107">Structured Query API Overview</span></span>](#structured-query-api-overview)
-   [<span data-ttu-id="8998c-108">Consultar escenarios</span><span class="sxs-lookup"><span data-stu-id="8998c-108">Querying Scenarios</span></span>](#querying-scenarios)
    -   [<span data-ttu-id="8998c-109">Extracción de condiciones y análisis de consultas</span><span class="sxs-lookup"><span data-stu-id="8998c-109">Condition Extraction and Query Parsing</span></span>](#condition-extraction-and-query-parsing)
    -   [<span data-ttu-id="8998c-110">Consultar el índice</span><span class="sxs-lookup"><span data-stu-id="8998c-110">Querying the Index</span></span>](#querying-the-index)
-   [<span data-ttu-id="8998c-111">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="8998c-111">Related topics</span></span>](#related-topics)

## <a name="about-querying-in-windows-search"></a><span data-ttu-id="8998c-112">Acerca de las consultas en Windows Search</span><span class="sxs-lookup"><span data-stu-id="8998c-112">About Querying in Windows Search</span></span>

<span data-ttu-id="8998c-113">La consulta en Windows Search se basa en los cuatro métodos siguientes:</span><span class="sxs-lookup"><span data-stu-id="8998c-113">Querying in Windows Search is based on the following four approaches:</span></span>

-   <span data-ttu-id="8998c-114">[Sintaxis de consulta avanzada](-search-3x-advancedquerysyntax.md) (AQS)</span><span class="sxs-lookup"><span data-stu-id="8998c-114">[Advanced Query Syntax](-search-3x-advancedquerysyntax.md) (AQS)</span></span>
-   <span data-ttu-id="8998c-115">Sintaxis de consulta natural (NQS)</span><span class="sxs-lookup"><span data-stu-id="8998c-115">Natural Query Syntax (NQS)</span></span>
-   <span data-ttu-id="8998c-116">Lenguaje de consulta estructurado (SQL)</span><span class="sxs-lookup"><span data-stu-id="8998c-116">Structured Query Language (SQL)</span></span>
-   <span data-ttu-id="8998c-117">Interfaces de consulta estructuradas</span><span class="sxs-lookup"><span data-stu-id="8998c-117">Structured query interfaces</span></span>

<span data-ttu-id="8998c-118">AQS es la sintaxis de consulta predeterminada que usa Windows Search para consultar el índice y para refinar y restringir los parámetros de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="8998c-118">AQS is the default query syntax used by Windows Search to query the index and to refine and narrow search parameters.</span></span> <span data-ttu-id="8998c-119">AQS es principalmente orientada al usuario y puede ser utilizada por los usuarios para compilar consultas AQS, pero también pueden ser usadas por los desarrolladores para compilar consultas mediante programación.</span><span class="sxs-lookup"><span data-stu-id="8998c-119">AQS is primarily user facing, and can be used by users to build AQS queries, but can also be used by developers to build queries programmatically.</span></span> <span data-ttu-id="8998c-120">En Windows 7, se presentó una AQS canónica y se debe usar para generar consultas AQS mediante programación.</span><span class="sxs-lookup"><span data-stu-id="8998c-120">In Windows 7, canonical AQS was introduced and must be used to programmatically generate AQS queries.</span></span> <span data-ttu-id="8998c-121">En Windows 7 y versiones posteriores, una opción de menú contextual puede estar disponible en función de si se cumple una condición de AQS.</span><span class="sxs-lookup"><span data-stu-id="8998c-121">In Windows 7 and later, a shortcut menu option can be available based on whether an AQS condition is met.</span></span> <span data-ttu-id="8998c-122">Para obtener más información, vea "obtener el comportamiento dinámico para verbos estáticos mediante la sintaxis de consulta avanzada" en [crear controladores de menú contextuales](../shell/context-menu-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="8998c-122">For more information, see "Getting Dynamic Behavior for Static Verbs by Using Advanced Query Syntax" in [Creating Context Menu Handlers](../shell/context-menu-handlers.md).</span></span> <span data-ttu-id="8998c-123">Las consultas AQS se pueden limitar a tipos específicos de archivos, que se conocen como tipos de archivo.</span><span class="sxs-lookup"><span data-stu-id="8998c-123">AQS queries can be limited to specific types of files, which are known as file kinds.</span></span> <span data-ttu-id="8998c-124">Para obtener más información, vea [tipos de archivo y asociaciones](../shell/fa-intro.md).</span><span class="sxs-lookup"><span data-stu-id="8998c-124">For more information, see [File Types and Associations](../shell/fa-intro.md).</span></span> <span data-ttu-id="8998c-125">Para obtener documentación de referencia sobre las propiedades pertinentes, vea [System. Kind](../properties/props-system-kind.md)y [System. KindText](../properties/props-system-kindtext.md).</span><span class="sxs-lookup"><span data-stu-id="8998c-125">For reference documentation on the relevant properties, see [System.Kind](../properties/props-system-kind.md), and [System.KindText](../properties/props-system-kindtext.md).</span></span>

<span data-ttu-id="8998c-126">NQS es una sintaxis de consulta que es más relajada que AQS y es similar a la lengua humana.</span><span class="sxs-lookup"><span data-stu-id="8998c-126">NQS is a query syntax that is more relaxed than AQS, and is similar to human language.</span></span> <span data-ttu-id="8998c-127">La búsqueda de Windows puede usar NQS para consultar el índice si se selecciona NQS en lugar del valor predeterminado, AQS.</span><span class="sxs-lookup"><span data-stu-id="8998c-127">NQS can be used by Windows Search to query the index if NQS is selected instead of the default, AQS.</span></span>

<span data-ttu-id="8998c-128">SQL es un lenguaje de texto que define las consultas.</span><span class="sxs-lookup"><span data-stu-id="8998c-128">SQL is a text language that defines queries.</span></span> <span data-ttu-id="8998c-129">SQL es común en muchas tecnologías de base de datos diferentes.</span><span class="sxs-lookup"><span data-stu-id="8998c-129">SQL is common across many different database technologies.</span></span> <span data-ttu-id="8998c-130">Windows Search usa SQL, implementa un subconjunto del mismo y lo amplía agregando elementos al lenguaje.</span><span class="sxs-lookup"><span data-stu-id="8998c-130">Windows Search uses SQL, implements a subset of it, and extends it by adding elements to the language.</span></span> <span data-ttu-id="8998c-131">Windows Search SQL amplía la sintaxis de consulta de base de datos SQL-92 y SQL-99 para mejorar su utilidad con las búsquedas basadas en texto.</span><span class="sxs-lookup"><span data-stu-id="8998c-131">Windows Search SQL extends the standard SQL-92 and SQL-99 database query syntax to enhance its usefulness with text-based searches.</span></span> <span data-ttu-id="8998c-132">Todas las características de Windows Search SQL son compatibles con Windows Search en Windows XP y Windows Server 2003 y versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="8998c-132">All features of Windows Search SQL are compatible with Windows Search on Windows XP and Windows Server 2003, and later.</span></span> <span data-ttu-id="8998c-133">Para obtener más información sobre SQL Search, vea [consultar el índice con la sintaxis de SQL](-search-sql-windowssearch-entry.md)de Windows Search e [información general sobre la sintaxis SQL de Windows Search](-search-sql-ovwofsearchquery.md).</span><span class="sxs-lookup"><span data-stu-id="8998c-133">For more information about Windows Search SQL, see [Querying the Index with Windows Search SQL Syntax](-search-sql-windowssearch-entry.md), and [Overview of Windows Search SQL Syntax](-search-sql-ovwofsearchquery.md).</span></span>

<span data-ttu-id="8998c-134">Las API de consulta estructurada se describen más adelante en este tema.</span><span class="sxs-lookup"><span data-stu-id="8998c-134">The structured query APIs are described later in this topic.</span></span> <span data-ttu-id="8998c-135">Para obtener documentación de referencia sobre las API de consulta estructurada, vea [consultar interfaces](-search-querying-interfaces-entry-page.md).</span><span class="sxs-lookup"><span data-stu-id="8998c-135">For reference documentation on the structured query APIs, see [Querying Interfaces](-search-querying-interfaces-entry-page.md).</span></span> <span data-ttu-id="8998c-136">Las interfaces como [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) ayudan a construir cadenas SQL a partir de un conjunto de valores de entrada.</span><span class="sxs-lookup"><span data-stu-id="8998c-136">Interfaces such as [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) help construct SQL strings from a set of input values.</span></span> <span data-ttu-id="8998c-137">Esta interfaz convierte las consultas de usuario AQS en SQL de búsqueda de Windows y especifica restricciones de consulta que se pueden expresar en SQL, pero no en AQS.</span><span class="sxs-lookup"><span data-stu-id="8998c-137">This interface converts AQS user queries to Windows Search SQL and specifies query restrictions that can be expressed in SQL but not in AQS.</span></span> <span data-ttu-id="8998c-138">[**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) también obtiene una cadena de conexión OLE DB para conectarse a la base de datos de Windows Search.</span><span class="sxs-lookup"><span data-stu-id="8998c-138">[**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) also obtains an OLE DB connection string to connect to the Windows Search database.</span></span>

### <a name="local-and-remote-queries"></a><span data-ttu-id="8998c-139">Consultas locales y remotas</span><span class="sxs-lookup"><span data-stu-id="8998c-139">Local and Remote Queries</span></span>

<span data-ttu-id="8998c-140">Puede ejecutar las consultas de forma local o remota.</span><span class="sxs-lookup"><span data-stu-id="8998c-140">You can execute your queries either locally or remotely.</span></span> <span data-ttu-id="8998c-141">En el ejemplo siguiente se muestra una consulta local con la [cláusula FROM](-search-sql-from.md) .</span><span class="sxs-lookup"><span data-stu-id="8998c-141">A local query using the [FROM clause](-search-sql-from.md) is shown in the following example.</span></span> <span data-ttu-id="8998c-142">Una consulta local solo consulta el catálogo SystemIndex local.</span><span class="sxs-lookup"><span data-stu-id="8998c-142">A local query queries the local SystemIndex catalog only.</span></span>


```
FROM SystemIndex
```



<span data-ttu-id="8998c-143">En el ejemplo siguiente se muestra una consulta remota con la [cláusula FROM](-search-sql-from.md) .</span><span class="sxs-lookup"><span data-stu-id="8998c-143">A remote query using the [FROM clause](-search-sql-from.md) is shown in the following example.</span></span> <span data-ttu-id="8998c-144">Al agregar ComputerName, se transforma el ejemplo anterior en una consulta remota.</span><span class="sxs-lookup"><span data-stu-id="8998c-144">Adding ComputerName transforms the previous example into a remote query.</span></span>


```
FROM [<ComputerName>.]SystemIndex
```



<span data-ttu-id="8998c-145">De forma predeterminada, Windows XP y Windows Server 2003 no tienen instalado Windows Search.</span><span class="sxs-lookup"><span data-stu-id="8998c-145">By default, Windows XP and Windows Server 2003 do not have Windows Search installed.</span></span> <span data-ttu-id="8998c-146">Solo Windows Search 4 (WS4) proporciona compatibilidad con consultas remotas.</span><span class="sxs-lookup"><span data-stu-id="8998c-146">Only Windows Search 4 (WS4) provides remote query support.</span></span> <span data-ttu-id="8998c-147">Las versiones anteriores de la búsqueda de escritorio de Windows (WDS), como 3,01 y versiones anteriores, no admiten las consultas remotas.</span><span class="sxs-lookup"><span data-stu-id="8998c-147">Previous versions of Windows Desktop Search (WDS), such as 3.01 and earlier, do not support remote querying.</span></span> <span data-ttu-id="8998c-148">Con el explorador de Windows puede consultar el índice local de un equipo remoto para los elementos del sistema de archivos (elementos administrados por el protocolo "File:").</span><span class="sxs-lookup"><span data-stu-id="8998c-148">With Windows Explorer you can query the local index of a remote computer for file system items (items handled by the "file:" protocol).</span></span>

<span data-ttu-id="8998c-149">Para recuperar un elemento mediante una consulta remota, el elemento debe cumplir los siguientes requisitos:</span><span class="sxs-lookup"><span data-stu-id="8998c-149">To retrieve an item by remote query, the item must meet the following requirements:</span></span>

-   <span data-ttu-id="8998c-150">Ser accesible a través de la ruta de acceso UNC (Convención de nomenclatura universal).</span><span class="sxs-lookup"><span data-stu-id="8998c-150">Be accessible via Universal Naming Convention (UNC) path.</span></span>
-   <span data-ttu-id="8998c-151">Existe en el equipo remoto al que el cliente tiene acceso.</span><span class="sxs-lookup"><span data-stu-id="8998c-151">Exist on the remote computer to which the client has access.</span></span>
-   <span data-ttu-id="8998c-152">Tenga su seguridad establecida para permitir que el cliente tenga acceso de lectura.</span><span class="sxs-lookup"><span data-stu-id="8998c-152">Have its security set to allow the client to have Read access.</span></span>

<span data-ttu-id="8998c-153">El explorador de Windows tiene características para compartir elementos, incluido un recurso compartido "público" ( \\ \\ equipo \\ público \\ ...) en el **centro de redes y recursos compartidos**, y un recurso compartido de "usuarios" ( \\ \\ \\ usuarios de la máquina \\ ...) para elementos compartidos mediante el Asistente para compartir.</span><span class="sxs-lookup"><span data-stu-id="8998c-153">Windows Explorer has features for sharing items, including a "Public" share (\\\\Machine\\Public\\...) in the **Network and Sharing Center**, and a "Users" share (\\\\Machine\\Users\\...) for items shared via the Sharing Wizard.</span></span> <span data-ttu-id="8998c-154">Después de compartir las carpetas, puede consultar el índice local especificando el nombre del equipo del equipo remoto en la cláusula FROM y una ruta de acceso UNC en el equipo remoto en la cláusula SCOPE.</span><span class="sxs-lookup"><span data-stu-id="8998c-154">After you share the folder(s), you can query the local index by specifying the remote computer's machine name in the FROM clause, and a UNC path on the remote computer in the SCOPE clause.</span></span> <span data-ttu-id="8998c-155">En el ejemplo siguiente se muestra una consulta remota con las cláusulas FROM y SCOPE.</span><span class="sxs-lookup"><span data-stu-id="8998c-155">A remote query using the FROM and SCOPE clauses is shown in the following example.</span></span>


```
SELECT System.ItemName FROM MachineName.SystemIndex WHERE SCOPE='file://MachineName/<path>' 
```



<span data-ttu-id="8998c-156">Los ejemplos que se proporcionan aquí usan SQL.</span><span class="sxs-lookup"><span data-stu-id="8998c-156">The examples provided here use SQL.</span></span>

### <a name="structured-query-api-overview"></a><span data-ttu-id="8998c-157">Información general sobre la API de consulta estructurada</span><span class="sxs-lookup"><span data-stu-id="8998c-157">Structured Query API Overview</span></span>

<span data-ttu-id="8998c-158">Una consulta estructurada proporciona la capacidad de buscar información por combinaciones booleanas de consultas sobre propiedades individuales.</span><span class="sxs-lookup"><span data-stu-id="8998c-158">A structured query provides the ability to search for information by Boolean combinations of queries over individual properties.</span></span> <span data-ttu-id="8998c-159">En este tema se describe la funcionalidad de las API y los métodos de consulta estructurados más importantes.</span><span class="sxs-lookup"><span data-stu-id="8998c-159">In this topic we outline the functionality of the most important structured query APIs and methods.</span></span> <span data-ttu-id="8998c-160">Para obtener documentación de referencia sobre las API de consulta estructurada, vea [consultar interfaces](-search-querying-interfaces-entry-page.md).</span><span class="sxs-lookup"><span data-stu-id="8998c-160">For reference documentation on the structured query APIs, see [Querying Interfaces](-search-querying-interfaces-entry-page.md).</span></span>

### <a name="iqueryparser"></a><span data-ttu-id="8998c-161">IQueryParser</span><span class="sxs-lookup"><span data-stu-id="8998c-161">IQueryParser</span></span>

<span data-ttu-id="8998c-162">El método [**IQueryParser::P arse**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) analiza una cadena de entrada del usuario y genera una interpretación en forma de [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution).</span><span class="sxs-lookup"><span data-stu-id="8998c-162">The [**IQueryParser::Parse**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) method parses a user input string, and produces an interpretation in the form of an [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution).</span></span> <span data-ttu-id="8998c-163">Si el parámetro *pCustomProperties* de ese método no es null, es una enumeración de objetos [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) (uno para cada propiedad personalizada reconocida).</span><span class="sxs-lookup"><span data-stu-id="8998c-163">If the *pCustomProperties* parameter of that method is not null, then it is an enumeration of [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) objects(one for each recognized custom property).</span></span> <span data-ttu-id="8998c-164">Los otros métodos de [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) permiten que la aplicación establezca varias opciones, como la configuración regional, un esquema, un separador de palabras y controladores para varios tipos de entidades con nombre.</span><span class="sxs-lookup"><span data-stu-id="8998c-164">The other [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) methods permit the application to set several options, such as locale, a schema, a word breaker, and handlers for various types of named entities.</span></span> <span data-ttu-id="8998c-165">[**IQueryParser:: GetSchemaProvider**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-getschemaprovider) devuelve una interfaz [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) para examinar el esquema cargado.</span><span class="sxs-lookup"><span data-stu-id="8998c-165">[**IQueryParser::GetSchemaProvider**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-getschemaprovider) returns an [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) interface for browsing the loaded schema.</span></span>

### <a name="iquerysolution--iconditionfactory"></a><span data-ttu-id="8998c-166">IQuerySolution : IConditionFactory</span><span class="sxs-lookup"><span data-stu-id="8998c-166">IQuerySolution : IConditionFactory</span></span>

<span data-ttu-id="8998c-167">La interfaz [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) proporciona toda la información sobre el resultado del análisis de una cadena de entrada.</span><span class="sxs-lookup"><span data-stu-id="8998c-167">The [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) interface provides all information about the result of parsing an input string.</span></span> <span data-ttu-id="8998c-168">Dado que **IQuerySolution** también es una interfaz [**IConditionFactory**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditionfactory) , se pueden crear nodos de árbol de condiciones adicionales.</span><span class="sxs-lookup"><span data-stu-id="8998c-168">Because **IQuerySolution** is also an [**IConditionFactory**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditionfactory) interface, additional condition tree nodes can be created.</span></span> <span data-ttu-id="8998c-169">El método [**IQuerySolution:: GetQuery**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getquery) genera un árbol de condiciones para la interpretación.</span><span class="sxs-lookup"><span data-stu-id="8998c-169">The [**IQuerySolution::GetQuery**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getquery) method produces a condition tree for the interpretation.</span></span> <span data-ttu-id="8998c-170">**IQuerySolution:: GetQuery** también devuelve el tipo semántico.</span><span class="sxs-lookup"><span data-stu-id="8998c-170">**IQuerySolution::GetQuery** also returns the semantic type.</span></span>

### <a name="iconditionfactory"></a><span data-ttu-id="8998c-171">IConditionFactory</span><span class="sxs-lookup"><span data-stu-id="8998c-171">IConditionFactory</span></span>

<span data-ttu-id="8998c-172">[**IConditionFactory**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditionfactory) crea nodos de árbol de condiciones.</span><span class="sxs-lookup"><span data-stu-id="8998c-172">[**IConditionFactory**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditionfactory) creates condition tree nodes.</span></span> <span data-ttu-id="8998c-173">Si el parámetro de *simplificación* de [**IConditionFactory:: MakeNot**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makenot) es **Variant \_ true**, se simplifica la [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) resultante y no es necesario que sea un nodo de negación.</span><span class="sxs-lookup"><span data-stu-id="8998c-173">If the *simplify* parameter of [**IConditionFactory::MakeNot**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makenot) is **VARIANT\_TRUE**, then the resulting [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) is simplified, and need not be a negation node.</span></span> <span data-ttu-id="8998c-174">Si el parámetro *pSubConditions* de [**IConditionFactory:: MakeAndOr**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeandor) no es null, ese parámetro debe ser una enumeración de los objetos [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) y convertirse en subárboles. [**IConditionFactory:: MakeLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeleaf) crea un nodo hoja con un nombre de propiedad, una operación y un valor especificados.</span><span class="sxs-lookup"><span data-stu-id="8998c-174">If the *pSubConditions* parameter of [**IConditionFactory::MakeAndOr**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeandor) is not null, then that parameter should be an enumeration of [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) objects, and become subtrees.[**IConditionFactory::MakeLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeleaf) constructs a leaf node with a specified property name, operation, and value.</span></span> <span data-ttu-id="8998c-175">La cadena del parámetro *pValueType* debe ser el nombre de un tipo semántico del esquema.</span><span class="sxs-lookup"><span data-stu-id="8998c-175">The string in the *pValueType* parameter should be the name of a semantic type from the schema.</span></span> <span data-ttu-id="8998c-176">Si el parámetro *Expand* es **Variant \_ true** y la propiedad es virtual, el árbol de condiciones resultante suele ser una disyunción derivada de expandir la propiedad a sus componentes definidos.</span><span class="sxs-lookup"><span data-stu-id="8998c-176">If the *expand* parameter is **VARIANT\_TRUE** and the property is virtual, the resulting condition tree is typically a disjunction resulting from expanding the property to its defined constituents.</span></span> <span data-ttu-id="8998c-177">Si no es null, los parámetros *pPropertyNameTerm*, *pOperatorTerm* y *pValueTerm* deben identificar los términos que indican la propiedad, la operación y el valor.</span><span class="sxs-lookup"><span data-stu-id="8998c-177">If not null, the *pPropertyNameTerm*, *pOperatorTerm*, and *pValueTerm* parameters should identify terms indicating the property, operation, and value.</span></span>

### <a name="icondition--ipersiststream"></a><span data-ttu-id="8998c-178">ICondition: IPersistStream</span><span class="sxs-lookup"><span data-stu-id="8998c-178">ICondition : IPersistStream</span></span>

<span data-ttu-id="8998c-179">La interfaz [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) es un nodo único en un árbol de condiciones.</span><span class="sxs-lookup"><span data-stu-id="8998c-179">The [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) interface is a single node in a condition tree.</span></span> <span data-ttu-id="8998c-180">El nodo puede ser un nodo de negación, un nodo, un nodo o un nodo hoja.</span><span class="sxs-lookup"><span data-stu-id="8998c-180">The node can be a negation node, AND node, OR node, or a leaf node.</span></span> <span data-ttu-id="8998c-181">Para un nodo no hoja [**ICondition:: GetSubConditions**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getsubconditions) devuelve una enumeración de los subárboles.</span><span class="sxs-lookup"><span data-stu-id="8998c-181">For a non-leaf node [**ICondition::GetSubConditions**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getsubconditions) returns an enumeration of the subtrees.</span></span> <span data-ttu-id="8998c-182">Para un nodo hoja, los siguientes métodos de [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) devuelven los siguientes valores:</span><span class="sxs-lookup"><span data-stu-id="8998c-182">For a leaf node the following methods of [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) return the following values:</span></span>

-   <span data-ttu-id="8998c-183">[**GetComparisonInfo**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getcomparisoninfo) devuelve el nombre, la operación y el valor de la propiedad.</span><span class="sxs-lookup"><span data-stu-id="8998c-183">[**GetComparisonInfo**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getcomparisoninfo) returns the property name, operation, and value.</span></span>
-   <span data-ttu-id="8998c-184">[**GetValueType**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getvaluetype) devuelve el tipo semántico del valor, que se specificied en el parámetro *pszValueType* de [**IConditionFactory:: MakeLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeleaf).</span><span class="sxs-lookup"><span data-stu-id="8998c-184">[**GetValueType**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getvaluetype) returns the semantic type of the value, which was specificied in the *pszValueType* parameter of [**IConditionFactory::MakeLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeleaf).</span></span>
-   <span data-ttu-id="8998c-185">[**GetValueNormalization**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getvaluenormalization) devuelve una forma de cadena del valor.</span><span class="sxs-lookup"><span data-stu-id="8998c-185">[**GetValueNormalization**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getvaluenormalization) returns a string form of the value.</span></span> <span data-ttu-id="8998c-186">(Si el valor ya era una cadena, este formulario se normalizará con respecto a mayúsculas y minúsculas, etc.)</span><span class="sxs-lookup"><span data-stu-id="8998c-186">(If the value was already a string, this form will be normalized with regard to case, accents, and so forth.)</span></span>
-   <span data-ttu-id="8998c-187">[**GetInputTerms**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getinputterms) devuelve información sobre qué partes de la oración de entrada generaron el nombre de la propiedad, la operación y el valor.</span><span class="sxs-lookup"><span data-stu-id="8998c-187">[**GetInputTerms**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getinputterms) returns information about which parts of the input sentence generated the property name, the operation, and the value.</span></span>
-   <span data-ttu-id="8998c-188">[**Clone**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-clone) devuelve una copia en profundidad de un árbol de condiciones.</span><span class="sxs-lookup"><span data-stu-id="8998c-188">[**Clone**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-clone) returns a deep copy of a condition tree.</span></span>

### <a name="irichchunk"></a><span data-ttu-id="8998c-189">IRichChunk</span><span class="sxs-lookup"><span data-stu-id="8998c-189">IRichChunk</span></span>

<span data-ttu-id="8998c-190">Cada objeto [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) identifica un intervalo de token y una cadena.</span><span class="sxs-lookup"><span data-stu-id="8998c-190">Each [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) object identifies a token span and a string.</span></span> <span data-ttu-id="8998c-191">**IRichChunk** es una interfaz de utilidad que representa información sobre un intervalo (normalmente un intervalo de tokens) identificado por una posición inicial y una longitud.</span><span class="sxs-lookup"><span data-stu-id="8998c-191">**IRichChunk** is a utility interface that represents information about a span (typically a span of tokens) identified by a starting position and length.</span></span> <span data-ttu-id="8998c-192">Esta información de intervalo incluye una cadena o una **variante**.</span><span class="sxs-lookup"><span data-stu-id="8998c-192">This span information includes a string and/or a **VARIANT**.</span></span>

### <a name="iconditiongenerator"></a><span data-ttu-id="8998c-193">IConditionGenerator</span><span class="sxs-lookup"><span data-stu-id="8998c-193">IConditionGenerator</span></span>

<span data-ttu-id="8998c-194">La aplicación proporciona la interfaz [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) para controlar el reconocimiento y la generación del árbol de condiciones para un tipo de entidad con nombre.</span><span class="sxs-lookup"><span data-stu-id="8998c-194">The [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) interface is provided by the application to handle recognition and condition tree generation for a named entity type.</span></span> <span data-ttu-id="8998c-195">Se asigna un generador de condiciones a un [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) a través de [**IQueryParser:: SetMultiOption**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-setmultioption).</span><span class="sxs-lookup"><span data-stu-id="8998c-195">A condition generator is given to an [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) through [**IQueryParser::SetMultiOption**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-setmultioption).</span></span> <span data-ttu-id="8998c-196">[**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) llama a [**IConditionGenerator:: Initialize**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-initialize) con un [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) para el esquema cargado actualmente.</span><span class="sxs-lookup"><span data-stu-id="8998c-196">[**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) calls [**IConditionGenerator::Initialize**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-initialize) with an [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) for the currently loaded schema.</span></span> <span data-ttu-id="8998c-197">Esto permite a [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) obtener cualquier información de esquema necesaria.</span><span class="sxs-lookup"><span data-stu-id="8998c-197">Doing so permits [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) to obtain any schema information that is required.</span></span> <span data-ttu-id="8998c-198">Al analizar una cadena de entrada, **IQueryParser** llama al método [**IConditionGenerator:: RecognizeNamedEntities**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-recognizenamedentities) de cada [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator), de modo que se puede informar de la aparición de entidades con nombre que reconoce en la cadena de entrada.</span><span class="sxs-lookup"><span data-stu-id="8998c-198">When parsing an input string, **IQueryParser** calls the [**IConditionGenerator::RecognizeNamedEntities**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-recognizenamedentities) method of each [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator), so that the occurrence of named entities it recognizes in the input string can be reported.</span></span> <span data-ttu-id="8998c-199">**IQueryParser** puede usar la configuración regional actual y debe hacer uso de la tokenización de la entrada, ya que necesita informar de los intervalos de token de las entidades con nombre.</span><span class="sxs-lookup"><span data-stu-id="8998c-199">**IQueryParser** can make use of the current locale and should make use of the tokenization of the input as it needs to report the token spans of any named entities.</span></span>

<span data-ttu-id="8998c-200">Cuando [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) está a punto de emitir un nodo hoja y el tipo semántico del valor coincide con el tipo de entidad con nombre para un [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator), **IQueryParser** llama a [**IConditionGenerator:: GenerateforLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-generateforleaf) con la información del nodo que se va a generar.</span><span class="sxs-lookup"><span data-stu-id="8998c-200">When [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) is about to emit a leaf node, and the semantic type of the value matches the named entity type for an [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator), **IQueryParser** calls [**IConditionGenerator::GenerateforLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-generateforleaf) with the information for the node to be generated.</span></span> <span data-ttu-id="8998c-201">Si [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) devuelve S \_ OK, debe devolver un árbol de condiciones (que no tiene que ser un nodo hoja) e informar a **IQueryParser** de si se debe suprimir la interpretación de cadena alternativa que normalmente generaría como precaución.</span><span class="sxs-lookup"><span data-stu-id="8998c-201">If the [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) returns S\_OK, it should return a condition tree (which does not have to be a leaf node), and inform **IQueryParser** whether to suppress the alternative string interpretation that it would normally generate as a precaution.</span></span>

### <a name="itokencollection"></a><span data-ttu-id="8998c-202">ITokenCollection</span><span class="sxs-lookup"><span data-stu-id="8998c-202">ITokenCollection</span></span>

<span data-ttu-id="8998c-203">El método [**ITokenCollection:: NumberOfTokens**](/windows/desktop/api/Structuredquery/nf-structuredquery-itokencollection-numberoftokens) devuelve el número de tokens. [**ITokenCollection:: GetToken**](/windows/desktop/api/Structuredquery/nf-structuredquery-itokencollection-gettoken) devuelve información sobre el token *i*.</span><span class="sxs-lookup"><span data-stu-id="8998c-203">The [**ITokenCollection::NumberOfTokens**](/windows/desktop/api/Structuredquery/nf-structuredquery-itokencollection-numberoftokens) method returns the number of tokens.[**ITokenCollection::GetToken**](/windows/desktop/api/Structuredquery/nf-structuredquery-itokencollection-gettoken) returns information about the *i* th token.</span></span> <span data-ttu-id="8998c-204">El principio y la longitud son posiciones de caracteres en la cadena de entrada.</span><span class="sxs-lookup"><span data-stu-id="8998c-204">The beginning and length are character positions in the input string.</span></span> <span data-ttu-id="8998c-205">El texto devuelto no será null solo si hay un texto que invalide los caracteres de la cadena de entrada.</span><span class="sxs-lookup"><span data-stu-id="8998c-205">The returned text will be non-null only if there is a text overriding the characters from the input string.</span></span> <span data-ttu-id="8998c-206">Esto se usa, por ejemplo, para reemplazar un guión de la cadena de entrada con NOT cuando ese guión está en un contexto donde se debe interpretar como una negación.</span><span class="sxs-lookup"><span data-stu-id="8998c-206">This is used, for example, to override a dash in the input string with NOT when that dash is in a context where it should be interpreted as a negation.</span></span>

### <a name="inamedentitycollector"></a><span data-ttu-id="8998c-207">INamedEntityCollector</span><span class="sxs-lookup"><span data-stu-id="8998c-207">INamedEntityCollector</span></span>

<span data-ttu-id="8998c-208">[**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) llama a [**INamedEntityCollector:: Add**](/windows/desktop/api/Structuredquery/nf-structuredquery-inamedentitycollector-add) para cada entidad con nombre que reconoció.</span><span class="sxs-lookup"><span data-stu-id="8998c-208">[**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) calls [**INamedEntityCollector::Add**](/windows/desktop/api/Structuredquery/nf-structuredquery-inamedentitycollector-add) for each named entity it recognized.</span></span> <span data-ttu-id="8998c-209">Los intervalos son intervalos de tokens.</span><span class="sxs-lookup"><span data-stu-id="8998c-209">The spans are token spans.</span></span> <span data-ttu-id="8998c-210">Siempre debe ser el caso de *beginSpan* ?</span><span class="sxs-lookup"><span data-stu-id="8998c-210">It must always be the case that *beginSpan* ?</span></span> <span data-ttu-id="8998c-211">*beginActual*  <  *endActual* ?</span><span class="sxs-lookup"><span data-stu-id="8998c-211">*beginActual* < *endActual* ?</span></span> <span data-ttu-id="8998c-212">*endSpan*.</span><span class="sxs-lookup"><span data-stu-id="8998c-212">*endSpan*.</span></span> <span data-ttu-id="8998c-213">*beginSpan* y *endSpan* pueden diferir de *beginActual* y *endActual* si la entidad con nombre comienza o termina con tokens semánticamente insignificantes, como comillas (que no están incluidas en la entidad con nombre).</span><span class="sxs-lookup"><span data-stu-id="8998c-213">*beginSpan* and *endSpan* may differ from *beginActual* and *endActual* if the named entity begins and/or ends with semantically insignificant tokens such as quotation marks (that are nevertheless covered by the named entity).</span></span> <span data-ttu-id="8998c-214">El valor se debe expresar como una cadena y aparecerá posteriormente en una llamada a [**IConditionGenerator:: GenerateForLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-generateforleaf).</span><span class="sxs-lookup"><span data-stu-id="8998c-214">The value must be expressed as a string and will subsequently appear in a call to [**IConditionGenerator::GenerateForLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-generateforleaf).</span></span>

### <a name="ischemaprovider"></a><span data-ttu-id="8998c-215">ISchemaProvider</span><span class="sxs-lookup"><span data-stu-id="8998c-215">ISchemaProvider</span></span>

<span data-ttu-id="8998c-216">La interfaz [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) se puede usar para examinar un esquema cargado para entidades (tipos) y relaciones (propiedades).</span><span class="sxs-lookup"><span data-stu-id="8998c-216">The [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) interface can be used to browse a loaded schema for entities (types) and relations (properties).</span></span> <span data-ttu-id="8998c-217">Estos son los métodos individuales:</span><span class="sxs-lookup"><span data-stu-id="8998c-217">Here's what it's individual methods do:</span></span>

-   <span data-ttu-id="8998c-218">[**Entidades**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-entities) devuelve una enumeración de todas las entidades ([**IEntity**](/windows/desktop/api/Structuredquery/nn-structuredquery-ientity)) del esquema.</span><span class="sxs-lookup"><span data-stu-id="8998c-218">[**Entities**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-entities) returns an enumeration of every entity ([**IEntity**](/windows/desktop/api/Structuredquery/nn-structuredquery-ientity)) in the schema.</span></span>
-   <span data-ttu-id="8998c-219">[**RootEntity**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-rootentity) devuelve la entidad raíz del esquema.</span><span class="sxs-lookup"><span data-stu-id="8998c-219">[**RootEntity**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-rootentity) returns the root entity of the schema.</span></span> <span data-ttu-id="8998c-220">Para un esquema plano, se devuelve el tipo principal de cada [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) .</span><span class="sxs-lookup"><span data-stu-id="8998c-220">For a flat schema, the main type of every [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) is returned.</span></span>
-   <span data-ttu-id="8998c-221">[**GetEntity**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-getentity) busca una entidad por su nombre y devuelve S \_ false si no hay ninguna entidad en el esquema.</span><span class="sxs-lookup"><span data-stu-id="8998c-221">[**GetEntity**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-getentity) finds an entity by name and returns S\_FALSE if there is no such entity in the schema.</span></span>
-   <span data-ttu-id="8998c-222">[**Metadata**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-metadata) devuelve una enumeración de las interfaces [**IMetaData**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) .</span><span class="sxs-lookup"><span data-stu-id="8998c-222">[**MetaData**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-metadata) returns an enumeration of [**IMetaData**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) interfaces.</span></span>

### <a name="ientity"></a><span data-ttu-id="8998c-223">IEntity</span><span class="sxs-lookup"><span data-stu-id="8998c-223">IEntity</span></span>

<span data-ttu-id="8998c-224">La interfaz [**IEntity**](/windows/desktop/api/Structuredquery/nn-structuredquery-ientity) es una entidad de esquema que representa un tipo que tiene un nombre, tiene varias relaciones con nombre para otros tipos (propiedades) y se deriva de una entidad base.</span><span class="sxs-lookup"><span data-stu-id="8998c-224">The [**IEntity**](/windows/desktop/api/Structuredquery/nn-structuredquery-ientity) interface is a schema entity that represents a type that has a name, has a number of named relationships to other types (properties), and derives from a base entity.</span></span> <span data-ttu-id="8998c-225">Estos son los métodos individuales:</span><span class="sxs-lookup"><span data-stu-id="8998c-225">Here's what its individual methods do:</span></span>

-   <span data-ttu-id="8998c-226">[**IEntity:: Relationships**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-relationships) devuelve una enumeración de objetos [**IRelationship**](/windows/desktop/api/Structuredquery/nn-structuredquery-irelationship) , uno para cada relación de salida de este tipo.</span><span class="sxs-lookup"><span data-stu-id="8998c-226">[**IEntity::Relationships**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-relationships) returns an enumeration of [**IRelationship**](/windows/desktop/api/Structuredquery/nn-structuredquery-irelationship) objects, one for each outgoing relation of this type.</span></span> <span data-ttu-id="8998c-227">Cada relación saliente de una entidad tiene un nombre.</span><span class="sxs-lookup"><span data-stu-id="8998c-227">Each outgoing relation of an entity has a name.</span></span>
-   <span data-ttu-id="8998c-228">[**IEntity:: GetRelationship**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-getrelationship) busca una relación por nombre y devuelve S \_ false si no hay ninguna relación de este tipo para esta entidad.</span><span class="sxs-lookup"><span data-stu-id="8998c-228">[**IEntity::GetRelationship**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-getrelationship) finds a relationship by name, and returns S\_FALSE if there is no such relationship for this entity.</span></span>
-   <span data-ttu-id="8998c-229">[**IEntity:: Metadata**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-metadata) devuelve una enumeración de interfaces [**IMetaData**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) , una para cada par de metadatos de esta entidad.</span><span class="sxs-lookup"><span data-stu-id="8998c-229">[**IEntity::MetaData**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-metadata) returns an enumeration of [**IMetaData**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) interfaces, one for each metadata pair of this entity.</span></span>
-   <span data-ttu-id="8998c-230">[**IEntity::D efaultphrase**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-defaultphrase) devuelve una frase predeterminada para facilitar la generación de una reexpresión AQS o NQS de un árbol de condiciones.</span><span class="sxs-lookup"><span data-stu-id="8998c-230">[**IEntity::DefaultPhrase**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-defaultphrase) returns a default phrase to facilitate generating an AQS or NQS restatement of a condition tree.</span></span>

### <a name="irelationship"></a><span data-ttu-id="8998c-231">IRelationship</span><span class="sxs-lookup"><span data-stu-id="8998c-231">IRelationship</span></span>

<span data-ttu-id="8998c-232">La interfaz [**IRelationship**](/windows/desktop/api/Structuredquery/nn-structuredquery-irelationship) representa una relación entre dos entidades: un origen y un destino.</span><span class="sxs-lookup"><span data-stu-id="8998c-232">The [**IRelationship**](/windows/desktop/api/Structuredquery/nn-structuredquery-irelationship) interface represents a relationship between two entities: a source and a destination.</span></span> <span data-ttu-id="8998c-233">Estos son los métodos individuales:</span><span class="sxs-lookup"><span data-stu-id="8998c-233">Here's what it's individual methods do:</span></span>

-   <span data-ttu-id="8998c-234">[**IRelationship:: IsReal**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-isreal) informa de si una relación es real.</span><span class="sxs-lookup"><span data-stu-id="8998c-234">[**IRelationship::IsReal**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-isreal) reports whether a relationship is real.</span></span> <span data-ttu-id="8998c-235">Por ejemplo, si la entidad A deriva de la entidad B y hereda una relación denominada R de ella, todavía puede tener su propia relación denominada R. Sin embargo, la relación beween A y R debe tener el mismo tipo de destino que el de B, y la única razón para que exista es almacenar los metadatos específicos de B. Se dice que una relación de B no es real.</span><span class="sxs-lookup"><span data-stu-id="8998c-235">For example, if entity A derives from entity B and inherits a relationship named R from it, A may still have its own relationship named R. However, the relationship beween A and R must have the same destination type as that of B, and the only reason for it to exist is to store metadata specific to B. Such a relationship of B is said not to be real.</span></span>
-   <span data-ttu-id="8998c-236">[**IRelationship:: metadatos**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-metadata) devuelve una enumeración de interfaces [**IMetaData**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) , una para cada par de metadatos de esta entidad.</span><span class="sxs-lookup"><span data-stu-id="8998c-236">[**IRelationship::Medadata**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-metadata) returns an enumeration of [**IMetaData**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) interfaces, one for each metadata pair of this entity.</span></span>
-   <span data-ttu-id="8998c-237">[**IRelationship::D efaultphrase**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-defaultphrase) devuelve la frase predeterminada que se va a usar para esta relación en las reinstrucciones.</span><span class="sxs-lookup"><span data-stu-id="8998c-237">[**IRelationship::DefaultPhrase**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-defaultphrase) returns the default phrase to use for this relationship in restatements.</span></span> <span data-ttu-id="8998c-238">Cada relación tiene una frase predeterminada que indica que facilite la generación de una reexpresión AQS o NQS de un árbol de condiciones.</span><span class="sxs-lookup"><span data-stu-id="8998c-238">Each relationship has a default phrase that denotes it to facilitate generating an AQS or NQS restatement of a condition tree.</span></span>

### <a name="imetadata"></a><span data-ttu-id="8998c-239">IMetaData</span><span class="sxs-lookup"><span data-stu-id="8998c-239">IMetaData</span></span>

<span data-ttu-id="8998c-240">Los metadatos son pares clave-valor que están asociados a una entidad, una relación o todo el esquema.</span><span class="sxs-lookup"><span data-stu-id="8998c-240">Metadata are key-value pairs that are each associated with either an entity, a relationship, or the whole schema.</span></span> <span data-ttu-id="8998c-241">Dado que las claves no son necesariamente únicas, una colección de metadatos se puede considerar como un mapa múltiple.</span><span class="sxs-lookup"><span data-stu-id="8998c-241">Because keys are not necessarily unique, a collection of metadata can be thought of as a multi-map.</span></span> <span data-ttu-id="8998c-242">Se llama a [**IMetaData:: GetData**](/windows/desktop/api/Structuredquery/nf-structuredquery-imetadata-getdata) para recuperar la clave y el valor de un par metatdata.</span><span class="sxs-lookup"><span data-stu-id="8998c-242">[**IMetaData::GetData**](/windows/desktop/api/Structuredquery/nf-structuredquery-imetadata-getdata) is called to retrieve the key and value for a metatdata pair.</span></span>

## <a name="querying-scenarios"></a><span data-ttu-id="8998c-243">Consultar escenarios</span><span class="sxs-lookup"><span data-stu-id="8998c-243">Querying Scenarios</span></span>

<span data-ttu-id="8998c-244">En los escenarios siguientes se describe el uso de las API de consulta estructuradas en la búsqueda de Windows en escenarios comunes de consulta, como la creación de un árbol de condiciones y la consulta del índice.</span><span class="sxs-lookup"><span data-stu-id="8998c-244">The following scenarios describe the use of structured query APIs in Windows Search in common querying scenarios, such as creating a condition tree and querying the index.</span></span>

### <a name="condition-extraction-and-query-parsing"></a><span data-ttu-id="8998c-245">Extracción de condiciones y análisis de consultas</span><span class="sxs-lookup"><span data-stu-id="8998c-245">Condition Extraction and Query Parsing</span></span>

<span data-ttu-id="8998c-246">Cuando se crea una consulta, su ámbito se define indicando al sistema dónde debe realizarse la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="8998c-246">When a query is created, its scope is defined by telling the system where to search.</span></span> <span data-ttu-id="8998c-247">Esto restringe los resultados de la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="8998c-247">This restricts the search results.</span></span> <span data-ttu-id="8998c-248">Una vez definido el ámbito, se aplica un filtro y se devuelve un conjunto de filtros.</span><span class="sxs-lookup"><span data-stu-id="8998c-248">After the scope is defined, a filter is applied, and a filter set is returned.</span></span> <span data-ttu-id="8998c-249">Los resultados de la búsqueda se restringen mediante la creación de un árbol de condiciones con nodos hoja, similar a un gráfico.</span><span class="sxs-lookup"><span data-stu-id="8998c-249">Search results are restricted by building a condition tree with leaf nodes, similar to a graph.</span></span> <span data-ttu-id="8998c-250">Después se extraen esas condiciones.</span><span class="sxs-lookup"><span data-stu-id="8998c-250">Those conditions are then extracted.</span></span> <span data-ttu-id="8998c-251">Un árbol de condiciones es una combinación booleana (AND, OR, NOT) de las condiciones hoja, cada una de las cuales relaciona una propiedad, a través de una operación, con un valor.</span><span class="sxs-lookup"><span data-stu-id="8998c-251">A condition tree is a Boolean combination (AND, OR, NOT) of leaf conditions, each of which relates a property, through an operation, to a value.</span></span> <span data-ttu-id="8998c-252">Un nodo hoja representa una restricción de una sola propiedad a un valor a través de algunas operaciones.</span><span class="sxs-lookup"><span data-stu-id="8998c-252">A leaf node represents a restriction on a single property to a value through some operations.</span></span>

<span data-ttu-id="8998c-253">Una restricción de filtro requiere una expresión lógica que describa la restricción.</span><span class="sxs-lookup"><span data-stu-id="8998c-253">A filter restriction requires a logical expression that describes the restriction.</span></span> <span data-ttu-id="8998c-254">La definición de esta expresión se inicia con la interfaz [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) , que se usa para crear un nodo único en un árbol de condiciones.</span><span class="sxs-lookup"><span data-stu-id="8998c-254">Defining this expression starts with the [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) interface, which is used to create a single node in a condition tree.</span></span> <span data-ttu-id="8998c-255">Dado que solo hay una condición en el ejemplo siguiente, el árbol no cambia.</span><span class="sxs-lookup"><span data-stu-id="8998c-255">Because there is only one condition in the following example, the tree does not change.</span></span>


```C++
    
    [
        object,
        uuid(0FC988D4-C935-4b97-A973-46282EA175C8),
        pointer_default(unique)
    ]
    interface ICondition : IPersistStream
    {
        HRESULT GetConditionType([out, retval] CONDITION_TYPE* pNodeType);
        HRESULT GetSubConditions([in] REFIID riid, [out, retval, iid_is(riid)] void** ppv);
        [local] HRESULT GetComparisonInfo([out, annotation("__deref_opt_out")] LPWSTR *ppszPropertyName, [out, annotation("__out_opt")] CONDITION_OPERATION *pOperation, [out, annotation("__out_opt")] PROPVARIANT *pValue);
        HRESULT GetValueType([out, retval] LPWSTR* ppszValueTypeName);
        HRESULT GetValueNormalization([out, retval] LPWSTR* ppszNormalization);
        [local] HRESULT GetInputTerms([out, annotation("__out_opt")] IRichChunk** ppPropertyTerm, [out, annotation("__out_opt")] IRichChunk** ppOperationTerm, [out, annotation("__out_opt")] IRichChunk** ppValueTerm);
        HRESULT Clone([out, retval] ICondition** ppc);
    };


```



<span data-ttu-id="8998c-256">Si hay más de una condición de filtro, se usan y y otros operadores booleanos para lograr un único árbol.</span><span class="sxs-lookup"><span data-stu-id="8998c-256">If there is more than one filter condition, then AND and other Boolean operators are used to achieve a single tree.</span></span> <span data-ttu-id="8998c-257">Y-los árboles y o-árboles representan conjunciones y desuniones de sus subárboles.</span><span class="sxs-lookup"><span data-stu-id="8998c-257">AND-trees and OR-trees represent conjunctions and disjunctions of their subtrees.</span></span> <span data-ttu-id="8998c-258">Un árbol NOT representa la negación de su único subárbol.</span><span class="sxs-lookup"><span data-stu-id="8998c-258">A NOT-tree represents the negation of its single subtree.</span></span> <span data-ttu-id="8998c-259">AQS proporciona un enfoque de texto para lograr expresiones lógicas con operadores booleanos y, a menudo, es más sencillo.</span><span class="sxs-lookup"><span data-stu-id="8998c-259">AQS provides a text approach to achieving logical expressions with Boolean operators, and is often simpler.</span></span>

<span data-ttu-id="8998c-260">En el ejemplo siguiente, se convierte el árbol de condición ([**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition)) en un formulario visual.</span><span class="sxs-lookup"><span data-stu-id="8998c-260">In the next example we convert the condition tree ([**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition)) into visual form.</span></span> <span data-ttu-id="8998c-261">El analizador de consultas, mediante la interfaz [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) , convierte el [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) en una cadena de consulta con formato de texto enriquecido (RTF).</span><span class="sxs-lookup"><span data-stu-id="8998c-261">The query parser, using the [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) interface, converts the [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) into a rich text formatted (RTF) query string.</span></span> <span data-ttu-id="8998c-262">El método [**IQueryParser:: RestateToString**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-restatetostring) devuelve el texto de la consulta, mientras que el método [**IQueryParser::P arse**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) genera una interfaz [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) .</span><span class="sxs-lookup"><span data-stu-id="8998c-262">The [**IQueryParser::RestateToString**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-restatetostring) method returns the query text, while the [**IQueryParser::Parse**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) method produces an [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) interface.</span></span> <span data-ttu-id="8998c-263">En el ejemplo siguiente se muestra cómo hacer todo eso.</span><span class="sxs-lookup"><span data-stu-id="8998c-263">The following example shows how to do all that.</span></span>


```C++
    [
        object,
        uuid(2EBDEE67-3505-43f8-9946-EA44ABC8E5B0),
        pointer_default(unique)
    ]
    interface IQueryParser : IUnknown
    {
        HRESULT Parse([in] LPCWSTR pszInputString, [in] IEnumUnknown* pCustomProperties, [out, retval] IQuerySolution** ppSolution);
        HRESULT SetOption([in] STRUCTURED_QUERY_SINGLE_OPTION option, [in] PROPVARIANT const* pOptionValue);
        HRESULT GetOption([in] STRUCTURED_QUERY_SINGLE_OPTION option, [out, retval] PROPVARIANT* pOptionValue);
        HRESULT SetMultiOption([in] STRUCTURED_QUERY_MULTIOPTION option, [in] LPCWSTR pszOptionKey, [in] PROPVARIANT const* pOptionValue);
        HRESULT GetSchemaProvider([out, retval] ISchemaProvider** ppSchemaProvider);
        HRESULT RestateToString([in] ICondition* pCondition, [in] BOOL fUseEnglish, [out] LPWSTR* ppszQueryString);
        HRESULT ParsePropertyValue([in] LPCWSTR pszPropertyName, [in] LPCWSTR pszInputString, [out, retval] IQuerySolution** ppSolution);
        HRESULT RestatePropertyValueToString([in] ICondition* pCondition, [in] BOOL fUseEnglish, [out] LPWSTR* ppszPropertyName, [out] LPWSTR* ppszQueryString);
    };

```



<span data-ttu-id="8998c-264">La entrada principal de [**IQueryParser::P arse**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) es una cadena de entrada de usuario que se va a analizar, pero la aplicación también puede informar al analizador de consultas de las propiedades que reconoce en la entrada (desde la sintaxis específica de la aplicación).</span><span class="sxs-lookup"><span data-stu-id="8998c-264">The main input of [**IQueryParser::Parse**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) is a user input string to be parsed, but the application can also inform the query parser of any properties it has recognized in the input (from application-specific syntax).</span></span> <span data-ttu-id="8998c-265">La salida de **IQueryParser::P arse** es un [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution), que proporciona toda la información relativa a esa invocación del análisis.</span><span class="sxs-lookup"><span data-stu-id="8998c-265">The output of **IQueryParser::Parse** is an [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution), which provides all information pertaining to that parse invocation.</span></span> <span data-ttu-id="8998c-266">Existen métodos para obtener la cadena de entrada, el modo en que se ha acortado la cadena de entrada, los errores de análisis y la consulta analizada como árbol de condiciones, representada por un [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition).</span><span class="sxs-lookup"><span data-stu-id="8998c-266">There are methods for obtaining the input string, how the input string was tokenized, any parse errors, and the parsed query as condition tree, represented by an [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition).</span></span> <span data-ttu-id="8998c-267">En el ejemplo siguiente se muestra...</span><span class="sxs-lookup"><span data-stu-id="8998c-267">The following example shows ...</span></span>


```C++
    [
        object,
        uuid(D6EBC66B-8921-4193-AFDD-A1789FB7FF57),
        pointer_default(unique)
    ]
    interface IQuerySolution : IConditionFactory
    {
        [local] HRESULT GetQuery([out, annotation("__out_opt")] ICondition** ppQueryNode, [out, annotation("__out_opt")] IEntity** ppMainType);
        HRESULT GetErrors([in] REFIID riid, [out, retval, iid_is(riid)] void** ppParseErrors);
        [local] HRESULT GetLexicalData([out, annotation("__deref_opt_out")] LPWSTR* ppszInputString, [out, annotation("__out_opt")] ITokenCollection** ppTokens, [out, annotation("__out_opt")] LCID* pLocale, [out, annotation("__out_opt")] IUnknown** ppWordBreaker);
    }    

    

```



<span data-ttu-id="8998c-268">En el ejemplo anterior, [**IQuerySolution:: GetQuery**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getquery) podría obtener cualquier información sobre la consulta, incluido el texto original, los tokens que componen el texto o el árbol de condiciones.</span><span class="sxs-lookup"><span data-stu-id="8998c-268">In the previous example, [**IQuerySolution::GetQuery**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getquery) could obtain any information about the query including the original text, tokens that comprise the text, or the condition tree.</span></span> <span data-ttu-id="8998c-269">En la tabla siguiente se muestran ejemplos de posibles valores de consulta devueltos.</span><span class="sxs-lookup"><span data-stu-id="8998c-269">Examples of possible returned query values are listed in the following table.</span></span>



| <span data-ttu-id="8998c-270">Ejemplos de valores de consulta devueltos</span><span class="sxs-lookup"><span data-stu-id="8998c-270">Examples of returned query values</span></span>                        | <span data-ttu-id="8998c-271">Descripción</span><span class="sxs-lookup"><span data-stu-id="8998c-271">Description</span></span>                                                                                               |
|----------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|
| `  author:relja OR author:tyler`                         | <span data-ttu-id="8998c-272">El texto de la consulta que [**IQueryParser:: RestateToString**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-restatetostring) devuelve</span><span class="sxs-lookup"><span data-stu-id="8998c-272">The query text that [**IQueryParser::RestateToString**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-restatetostring) returns</span></span> |
| `?author?, ?:?, ?relja?, ?OR?, ?author?, ?:?, ?tyler?`   | <span data-ttu-id="8998c-273">La división de tokens</span><span class="sxs-lookup"><span data-stu-id="8998c-273">The break-down of tokens</span></span>                                                                                  |
| ![un árbol de condiciones sin resolver](images/queryvalues1.png) | <span data-ttu-id="8998c-275">Un árbol de condiciones sin resolver</span><span class="sxs-lookup"><span data-stu-id="8998c-275">An unresolved condition tree</span></span>                                                                              |



 

<span data-ttu-id="8998c-276">El árbol de condiciones inicial que se devuelve no se resuelve.</span><span class="sxs-lookup"><span data-stu-id="8998c-276">The initial condition tree that is returned is unresolved.</span></span> <span data-ttu-id="8998c-277">En un árbol de condiciones sin resolver, las referencias de fecha y hora, como `date:yesterday` , no se convierten en tiempo absoluto.</span><span class="sxs-lookup"><span data-stu-id="8998c-277">In an unresolved condition tree, date and time references, such as `date:yesterday`, are not converted to absolute time.</span></span> <span data-ttu-id="8998c-278">Además, las propiedades virtuales no se expanden.</span><span class="sxs-lookup"><span data-stu-id="8998c-278">Also, virtual properties are not expanded.</span></span> <span data-ttu-id="8998c-279">Las propiedades virtuales son propiedades que actúan como agregados de varias propiedades.</span><span class="sxs-lookup"><span data-stu-id="8998c-279">Virtual properties are properties that act as aggregates of multiple properties.</span></span>

<span data-ttu-id="8998c-280">Por ejemplo, la consulta `kind:email from:reljai` genera los siguientes árboles de condiciones sin resolver y resueltos.</span><span class="sxs-lookup"><span data-stu-id="8998c-280">For example, the query `kind:email from:reljai` produces the following unresolved and resolved condition trees.</span></span> <span data-ttu-id="8998c-281">El árbol de condiciones sin resolver está a la izquierda y el árbol de condición resuelto está a la derecha.</span><span class="sxs-lookup"><span data-stu-id="8998c-281">The unresolved condition tree is to the left, and the resolved condition tree is to the right.</span></span>

![árboles de condiciones sin resolver y resueltos](images/conditiontree.png)

<span data-ttu-id="8998c-283">El árbol resuelto se puede obtener llamando a [**IConditionFactory:: Resolve**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-resolve).</span><span class="sxs-lookup"><span data-stu-id="8998c-283">The resolved tree can be obtained by calling [**IConditionFactory::Resolve**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-resolve).</span></span> <span data-ttu-id="8998c-284">Sin embargo, si se pasa [**SQRO not \_ \_ Resolve \_ DateTime**](/windows/desktop/api/Structuredquery/ne-structuredquery-structured_query_resolve_option) , la fecha y hora no se resuelven.</span><span class="sxs-lookup"><span data-stu-id="8998c-284">However, passing [**SQRO\_DONT\_RESOLVE\_DATETIME**](/windows/desktop/api/Structuredquery/ne-structuredquery-structured_query_resolve_option) leaves the date and time unresolved.</span></span> <span data-ttu-id="8998c-285">Hay ventajas en un árbol de condiciones sin resolver, porque un árbol de condiciones sin resolver contiene información sobre la consulta.</span><span class="sxs-lookup"><span data-stu-id="8998c-285">There are advantages to an unresolved condition tree, because an unresolved condition tree contains information about the query.</span></span> <span data-ttu-id="8998c-286">Cada nodo hoja apunta a los tokens devueltos por [**IQuerySolution:: GetLexicalData**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getlexicaldata), que corresponden a la propiedad, el operador y el valor cuando se usa la interfaz [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) .</span><span class="sxs-lookup"><span data-stu-id="8998c-286">Each leaf node points to the tokens returned by [**IQuerySolution::GetLexicalData**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getlexicaldata), which correspond to the property, operator, and value when using the [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) interface.</span></span> <span data-ttu-id="8998c-287">En el ejemplo siguiente se muestra...</span><span class="sxs-lookup"><span data-stu-id="8998c-287">The following example shows ...</span></span>


```C++
    interface ITokenCollection : IUnknown
    {
        HRESULT NumberOfTokens(ULONG* pCount);
        HRESULT GetToken([in] ULONG i, [out, annotation("__out_opt")] ULONG* pBegin, [out, annotation("__out_opt")] ULONG* pLength, [out, annotation("__deref_opt_out")] LPWSTR* ppsz);
    };

ICondition:: GetInputTerms([out, annotation("__out_opt")] 
IRichChunk** ppPropertyTerm, [out, annotation("__out_opt")] 
IRichChunk** ppOperationTerm, [out, annotation("__out_opt")] 
IRichChunk** ppValueTerm);

    interface IRichChunk : IUnknown
    {
        HRESULT GetData([out, annotation("__out_opt")] ULONG* pFirstPos, [out, annotation("__out_opt")] ULONG* pLength, [out, annotation("__deref_opt_out")] LPWSTR* ppsz, [out, annotation("__out_opt")] PROPVARIANT* pValue);
    }
```



### <a name="querying-the-index"></a><span data-ttu-id="8998c-288">Consultar el índice</span><span class="sxs-lookup"><span data-stu-id="8998c-288">Querying the Index</span></span>

<span data-ttu-id="8998c-289">Hay varios enfoques para consultar el índice.</span><span class="sxs-lookup"><span data-stu-id="8998c-289">There are several approaches to querying the index.</span></span> <span data-ttu-id="8998c-290">Algunas se basan en SQL y otras se basan en AQS.</span><span class="sxs-lookup"><span data-stu-id="8998c-290">Some are based on the SQL and others are based on AQS.</span></span> <span data-ttu-id="8998c-291">También puede consultar el índice de búsqueda de Windows mediante programación con las [interfaces de consulta](./-search-querying-interfaces-entry-page.md).</span><span class="sxs-lookup"><span data-stu-id="8998c-291">You can also query the Windows Search index programmatically by using [querying interfaces](./-search-querying-interfaces-entry-page.md).</span></span> <span data-ttu-id="8998c-292">Hay tres interfaces que son específicas de la consulta del índice: [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper), [**IRowsetPrioritization**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetprioritization)y [**IRowsetEvents**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetevents).</span><span class="sxs-lookup"><span data-stu-id="8998c-292">There are three interfaces that are specific to querying the index: [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper), [**IRowsetPrioritization**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetprioritization), and [**IRowsetEvents**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetevents).</span></span> <span data-ttu-id="8998c-293">Para obtener información conceptual, consulte [consultar el índice mediante programación](-search-3x-wds-qryidx-overview.md).</span><span class="sxs-lookup"><span data-stu-id="8998c-293">For conceptual information, see [Querying the Index Programmatically](-search-3x-wds-qryidx-overview.md).</span></span>

<span data-ttu-id="8998c-294">Puede desarrollar un componente o una clase auxiliar para consultar el índice mediante la interfaz [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) .</span><span class="sxs-lookup"><span data-stu-id="8998c-294">You can develop a component or helper class to query the index by using the [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) interface.</span></span> <span data-ttu-id="8998c-295">Esta interfaz se implementa como una clase auxiliar para [**ISearchCatalogManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager) (y [**ISearchCatalogManager2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager2)) y se obtiene llamando a [**ISearchCatalogManager:: GetQueryHelper**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-getqueryhelper).</span><span class="sxs-lookup"><span data-stu-id="8998c-295">This interface is implemented as a helper class to [**ISearchCatalogManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager) (and [**ISearchCatalogManager2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager2)), and is obtained by calling [**ISearchCatalogManager::GetQueryHelper**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-getqueryhelper).</span></span> <span data-ttu-id="8998c-296">Para obtener información conceptual, consulte [consultar el índice con ISearchQueryHelper](-search-3x-wds-qryidx-searchqueryhelper.md).</span><span class="sxs-lookup"><span data-stu-id="8998c-296">For conceptual information, see [Querying the Index with ISearchQueryHelper](-search-3x-wds-qryidx-searchqueryhelper.md).</span></span>

<span data-ttu-id="8998c-297">[**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) le permite:</span><span class="sxs-lookup"><span data-stu-id="8998c-297">[**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) permits you to:</span></span>

-   <span data-ttu-id="8998c-298">Obtenga una cadena de conexión OLE DB para conectarse a la base de datos de Windows Search.</span><span class="sxs-lookup"><span data-stu-id="8998c-298">Obtain an OLE DB connection string to connect to the Windows Search database.</span></span>
-   <span data-ttu-id="8998c-299">Convertir consultas de usuario AQS en SQL de Windows Search.</span><span class="sxs-lookup"><span data-stu-id="8998c-299">Convert AQS user queries to Windows Search SQL.</span></span>
-   <span data-ttu-id="8998c-300">Especifique restricciones de consulta que se pueden expresar en SQL, pero no en AQS.</span><span class="sxs-lookup"><span data-stu-id="8998c-300">Specify query restrictions that can be expressed in SQL but not in AQS.</span></span>

<span data-ttu-id="8998c-301">En Windows 7 y versiones posteriores se admiten los eventos de indización y priorización de indexación.</span><span class="sxs-lookup"><span data-stu-id="8998c-301">Indexing prioritization and rowset events are supported in Windows 7 and later.</span></span> <span data-ttu-id="8998c-302">Con [**IRowsetPrioritization**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetprioritization) hay una pila de prioridades que permite al cliente solicitar que los ámbitos utilizados en una consulta determinada se proporcionen más alto que la prioridad normal.</span><span class="sxs-lookup"><span data-stu-id="8998c-302">With [**IRowsetPrioritization**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetprioritization) there is a priority stack that enables the client to request that the scopes used in a particular query be given higher than normal priority.</span></span> <span data-ttu-id="8998c-303">[**IRowsetEvents**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetevents) proporciona una notificación de los cambios en los elementos de los conjuntos de filas, incluida la adición de nuevos elementos, la eliminación de elementos y la modificación de los datos de los elementos.</span><span class="sxs-lookup"><span data-stu-id="8998c-303">[**IRowsetEvents**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetevents) provides notification of changes to items in rowsets, including the addition of new items, the deletion of items, and the modification of item data.</span></span> <span data-ttu-id="8998c-304">El uso de notificaciones de eventos de conjunto de filas garantiza que los resultados de las consultas existentes estén tan actualizados como sea posible.</span><span class="sxs-lookup"><span data-stu-id="8998c-304">Using rowset event notifications ensures that the results for existing queries are as up to date as possible.</span></span> <span data-ttu-id="8998c-305">Para obtener información conceptual, consulte [Indexing Priority and Rowset Events in Windows 7](indexing-prioritization-and-rowset-events.md).</span><span class="sxs-lookup"><span data-stu-id="8998c-305">For conceptual information, see [Indexing Prioritization and Rowset Events in Windows 7](indexing-prioritization-and-rowset-events.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="8998c-306">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="8998c-306">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8998c-307">Indexación, consulta y notificaciones en Windows Search</span><span class="sxs-lookup"><span data-stu-id="8998c-307">Indexing, Querying and Notifications in Windows Search</span></span>](-search-3x-wds-included-in-index.md)
</dt> <dt>

[<span data-ttu-id="8998c-308">Qué se incluye en el índice</span><span class="sxs-lookup"><span data-stu-id="8998c-308">What is Included in the Index</span></span>](-search-indexing-process-overview.md)
</dt> <dt>

[<span data-ttu-id="8998c-309">Proceso de indexación en Windows Search</span><span class="sxs-lookup"><span data-stu-id="8998c-309">Indexing Process in Windows Search</span></span>](-search-indexing-process-overview.md)
</dt> <dt>

[<span data-ttu-id="8998c-310">Proceso de notificaciones en Windows Search</span><span class="sxs-lookup"><span data-stu-id="8998c-310">Notifications Process in Windows Search</span></span>](-search-3x-wds-support.md)
</dt> <dt>

[<span data-ttu-id="8998c-311">Requisitos de formato de dirección URL</span><span class="sxs-lookup"><span data-stu-id="8998c-311">URL Formatting Requirements</span></span>](url-formatting-requirements.md)
</dt> </dl>

 

 
