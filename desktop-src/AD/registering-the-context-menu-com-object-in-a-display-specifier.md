---
title: Registrar el objeto COM del menú contextual en un especificador de presentación
description: En este tema se muestran las claves del registro que deben modificarse para registrar un objeto COM de menú contextual.
ms.assetid: 389bc249-4849-4763-9d1b-b35598a51050
ms.tgt_platform: multiple
keywords:
- Registrar el objeto COM del menú contextual en un especificador de presentación
- menú contextual AD (objeto), registrar
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 62ae30c1a60a1a0bc5a8ec388a3578ab13829c95
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/17/2020
ms.locfileid: "104077499"
---
# <a name="registering-the-context-menu-com-object-in-a-display-specifier"></a><span data-ttu-id="2e179-105">Registrar el objeto COM del menú contextual en un especificador de presentación</span><span class="sxs-lookup"><span data-stu-id="2e179-105">Registering the Context Menu COM Object in a Display Specifier</span></span>

<span data-ttu-id="2e179-106">Cuando se usa COM para crear un archivo DLL de extensión de menú contextual para un servicio de directorio de Active Directory, la extensión se debe registrar con el registro de Windows y Active Directory Domain Services para notificar a los Active Directory complementos de MMC administrativos y el shell de Windows de la extensión.</span><span class="sxs-lookup"><span data-stu-id="2e179-106">When you use COM to create a context menu extension DLL for an Active Directory directory service, the extension must be registered with the Windows registry and Active Directory Domain Services to notify the Active Directory administrative MMC snap-ins and the Windows shell of the extension.</span></span>

## <a name="registering-in-the-windows-registry"></a><span data-ttu-id="2e179-107">Registro en el registro de Windows</span><span class="sxs-lookup"><span data-stu-id="2e179-107">Registering in the Windows Registry</span></span>

<span data-ttu-id="2e179-108">Al igual que todos los servidores COM, se debe registrar una extensión de menú contextual en el registro.</span><span class="sxs-lookup"><span data-stu-id="2e179-108">Like all COM servers, a context menu extension must be registered in the registry.</span></span> <span data-ttu-id="2e179-109">La extensión se registra con la siguiente clave.</span><span class="sxs-lookup"><span data-stu-id="2e179-109">The extension is registered under the following key.</span></span>

```
HKEY_CLASSES_ROOT
   CLSID
      <clsid>
```

<span data-ttu-id="2e179-110">*<clsid>* es la representación de cadena del CLSID tal y como la produce la función [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) .</span><span class="sxs-lookup"><span data-stu-id="2e179-110">*<clsid>* is the string representation of the CLSID as produced by the [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) function.</span></span> <span data-ttu-id="2e179-111">En la *<clsid>* clave, hay una clave **InProcServer32** que identifica el objeto como servidor de 32 bits en proceso.</span><span class="sxs-lookup"><span data-stu-id="2e179-111">Under the *<clsid>* key, there is an **InProcServer32** key that identifies the object as a 32-bit in-proc server.</span></span> <span data-ttu-id="2e179-112">En la clave **InProcServer32** , la ubicación del archivo dll se especifica en el valor predeterminado y el modelo de subprocesos se especifica en el valor **ThreadingModel** .</span><span class="sxs-lookup"><span data-stu-id="2e179-112">Under the **InProcServer32** key, the location of the DLL is specified in the default value and the threading model is specified in the **ThreadingModel** value.</span></span> <span data-ttu-id="2e179-113">Todas las extensiones del menú contextual deben usar el modelo de subprocesos "Apartamento".</span><span class="sxs-lookup"><span data-stu-id="2e179-113">All context menu extension must use the "Apartment" threading model.</span></span>

## <a name="registering-with-active-directory-domain-services"></a><span data-ttu-id="2e179-114">Registro con Active Directory Domain Services</span><span class="sxs-lookup"><span data-stu-id="2e179-114">Registering with Active Directory Domain Services</span></span>

<span data-ttu-id="2e179-115">El registro de la extensión del menú contextual es específico de una configuración regional.</span><span class="sxs-lookup"><span data-stu-id="2e179-115">Context menu extension registration is specific to one locale.</span></span> <span data-ttu-id="2e179-116">Si la extensión del menú contextual se aplica a todas las configuraciones regionales, debe registrarse en el objeto [**displaySpecifier**](/windows/desktop/ADSchema/c-displayspecifier) de la clase de objeto en todos los subcontenedores de la configuración regional en el contenedor de especificadores de presentación.</span><span class="sxs-lookup"><span data-stu-id="2e179-116">If the context menu extension applies to all locales, it must be registered in the object class [**displaySpecifier**](/windows/desktop/ADSchema/c-displayspecifier) object in all of the locale subcontainers in the Display Specifiers container.</span></span> <span data-ttu-id="2e179-117">Si la extensión del menú contextual se localiza para una configuración regional determinada, se debe registrar en el objeto **displaySpecifier** en el subcontenedor de la configuración regional.</span><span class="sxs-lookup"><span data-stu-id="2e179-117">If the context menu extension is localized for a certain locale, it must be registered in the **displaySpecifier** object in that locale's subcontainer.</span></span> <span data-ttu-id="2e179-118">Para obtener más información sobre el contenedor de especificadores de presentación y configuraciones regionales, vea [especificadores de pantalla](display-specifiers.md) y [contenedor de DisplaySpecifiers](displayspecifiers-container.md).</span><span class="sxs-lookup"><span data-stu-id="2e179-118">For more information about the Display Specifiers container and locales, see [Display Specifiers](display-specifiers.md) and [DisplaySpecifiers Container](displayspecifiers-container.md).</span></span>

<span data-ttu-id="2e179-119">Hay dos atributos de especificador de presentación en los que se puede registrar un elemento de extensión de menú contextual.</span><span class="sxs-lookup"><span data-stu-id="2e179-119">There are two display specifier attributes that a context menu extension item can be registered under.</span></span> <span data-ttu-id="2e179-120">Son [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) y [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu).</span><span class="sxs-lookup"><span data-stu-id="2e179-120">These are [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) and [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu).</span></span>

<span data-ttu-id="2e179-121">El atributo [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) identifica los menús contextuales administrativos que se van a mostrar en Active Directory complementos administrativos. El menú contextual aparece cuando el usuario muestra el menú contextual de los objetos de la clase adecuada en una de las Active Directory complementos administrativos de MMC.</span><span class="sxs-lookup"><span data-stu-id="2e179-121">The [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) attribute identifies administrative context menus to display in Active Directory administrative snap-ins. The context menu appears when the user displays the context menu for objects of the appropriate class in one of the Active Directory administrative MMC snap-ins.</span></span>

<span data-ttu-id="2e179-122">El atributo [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) identifica los menús contextuales del usuario final que se van a mostrar en el shell de Windows.</span><span class="sxs-lookup"><span data-stu-id="2e179-122">The [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) attribute identifies end-user context menus to display in the Windows shell.</span></span> <span data-ttu-id="2e179-123">El menú contextual aparece cuando el usuario ve el menú contextual de los objetos de la clase adecuada en el explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="2e179-123">The context menu appears when the user views the context menu for objects of the appropriate class in the Windows Explorer.</span></span> <span data-ttu-id="2e179-124">A partir de Windows Server 2003, el shell de Windows ya no muestra objetos de Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="2e179-124">Beginning with Windows Server 2003, the Windows shell no longer displays objects of Active Directory Domain Services.</span></span>

<span data-ttu-id="2e179-125">Todos estos atributos tienen varios valores.</span><span class="sxs-lookup"><span data-stu-id="2e179-125">All of these attributes are multi-valued.</span></span>

<span data-ttu-id="2e179-126">Al registrar una extensión de menú contextual, los valores de los atributos [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) y [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) requieren el formato siguiente.</span><span class="sxs-lookup"><span data-stu-id="2e179-126">When registering a context menu extension, the values for the [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) and [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) attributes require the following format.</span></span>


```C++
<order number>,<clsid>
```



<span data-ttu-id="2e179-127">El " &lt; número &gt; de pedido" es un número sin signo que representa la posición del elemento en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="2e179-127">The "&lt;order number&gt;" is an unsigned number that represents the item position in the context menu.</span></span> <span data-ttu-id="2e179-128">Cuando se muestra un menú contextual, los valores se ordenan mediante una comparación de "número de &lt; pedido" de cada valor &gt; .</span><span class="sxs-lookup"><span data-stu-id="2e179-128">When a context menu is displayed, the values are sorted using a comparison of each value's "&lt;order number&gt;".</span></span> <span data-ttu-id="2e179-129">Si hay más de un valor con el mismo " &lt; número de pedido &gt; ", esas extensiones del menú contextual se cargan en el orden en que se leen en el servidor de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="2e179-129">If more than one value has the same "&lt;order number&gt;", those context menu extensions are loaded in the order they are read from the Active Directory server.</span></span> <span data-ttu-id="2e179-130">Si es posible, use un "número de &lt; pedido" no existente &gt; , es decir, uno que no haya usado otros valores de la propiedad.</span><span class="sxs-lookup"><span data-stu-id="2e179-130">If possible, use a non-existing "&lt;order number&gt;", that is, one that has not been used by other values in the property.</span></span> <span data-ttu-id="2e179-131">No hay ninguna posición de inicio prescrita y se permiten brechas en la &lt; secuencia "número de pedido &gt; ".</span><span class="sxs-lookup"><span data-stu-id="2e179-131">There is no prescribed starting position and gaps are allowed in the "&lt;order number&gt;" sequence.</span></span>

<span data-ttu-id="2e179-132">" &lt; CLSID &gt; " es la representación de cadena del CLSID tal y como la produce la función [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) .</span><span class="sxs-lookup"><span data-stu-id="2e179-132">The "&lt;clsid&gt;" is the string representation of the CLSID as produced by the [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) function.</span></span>

<span data-ttu-id="2e179-133">En el shell de Windows, se admiten los elementos de menú contextual de selección múltiple.</span><span class="sxs-lookup"><span data-stu-id="2e179-133">In the Windows shell, multiple-selection context menu items are supported.</span></span> <span data-ttu-id="2e179-134">En este caso, la extensión del menú contextual se invoca para cada objeto seleccionado.</span><span class="sxs-lookup"><span data-stu-id="2e179-134">In this case, the context menu extension is invoked for each selected object.</span></span> <span data-ttu-id="2e179-135">En Active Directory complementos administrativos, también se admiten los elementos de extensión del menú contextual de selección múltiple.</span><span class="sxs-lookup"><span data-stu-id="2e179-135">In Active Directory administrative snap-ins, multiple-selection context menu extension items are also supported.</span></span> <span data-ttu-id="2e179-136">En este caso, la estructura [**DSOBJECTNAMES**](/windows/desktop/api/Dsclient/ns-dsclient-dsobjectnames) contendrá una estructura [**DSOBJECT**](/windows/desktop/api/Dsclient/ns-dsclient-dsobject) para cada objeto de directorio seleccionado.</span><span class="sxs-lookup"><span data-stu-id="2e179-136">In this case, the [**DSOBJECTNAMES**](/windows/desktop/api/Dsclient/ns-dsclient-dsobjectnames) structure will contain a [**DSOBJECT**](/windows/desktop/api/Dsclient/ns-dsclient-dsobject) structure for each directory object selected.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="2e179-137">En el shell de Windows, la información del especificador de presentación se recupera en el inicio de sesión del usuario y se almacena en caché para la sesión del usuario.</span><span class="sxs-lookup"><span data-stu-id="2e179-137">For the Windows shell, display specifier information is retrieved at user logon and cached for the user's session.</span></span> <span data-ttu-id="2e179-138">En el caso de los complementos administrativos, los datos del especificador de presentación se recuperan cuando se carga el complemento y se almacenan en memoria caché mientras dure el proceso.</span><span class="sxs-lookup"><span data-stu-id="2e179-138">For the administrative snap-ins, the display specifier data is retrieved when the snap-in is loaded and is cached for the duration of the process.</span></span> <span data-ttu-id="2e179-139">En el caso del shell de Windows, esto significa que los cambios en los especificadores de presentación surten efecto después de que un usuario cierre la sesión y vuelva a iniciarla.</span><span class="sxs-lookup"><span data-stu-id="2e179-139">For the Windows shell, this means changes to display specifiers take effect after a user logs off and back on again.</span></span> <span data-ttu-id="2e179-140">En el caso de los complementos administrativos, los cambios surten efecto cuando se vuelve a cargar el complemento o el archivo de consola, es decir, si se inicia una nueva instancia del archivo de consola o una nueva instancia de Mmc.exe y se agrega el complemento, se recuperan los datos del especificador de pantalla más reciente.</span><span class="sxs-lookup"><span data-stu-id="2e179-140">For the administrative snap-ins, changes take effect when the snap-in or console file is reloaded, that is, if you start a new instance of the console file or new Mmc.exe instance and add the snap-in, the latest display specifier data is retrieved.</span></span>

 

<span data-ttu-id="2e179-141">Para obtener más información y un ejemplo de código sobre cómo implementar una extensión de menú contextual, vea [código de ejemplo para la implementación del objeto com del menú contextual](example-code-for-implementation-of-the-context-menu-com-object.md).</span><span class="sxs-lookup"><span data-stu-id="2e179-141">For more information, and a code example of how to implement a context menu extension, see [Example Code for Implementation of the Context Menu COM Object](example-code-for-implementation-of-the-context-menu-com-object.md).</span></span>

 

 