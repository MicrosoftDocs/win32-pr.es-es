---
title: Desplazarse por QueryInterface en un objeto
description: Desplazarse por QueryInterface en un objeto
ms.assetid: 7dec015f-7609-40eb-a71e-f6e9c9b9f8ff
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3dbd44d200bf0a992f47bc375d0782bdadacf6a3
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/29/2020
ms.locfileid: "104358619"
---
# <a name="queryinterface-navigating-in-an-object"></a><span data-ttu-id="fc7fa-103">QueryInterface: desplazarse por un objeto</span><span class="sxs-lookup"><span data-stu-id="fc7fa-103">QueryInterface: Navigating in an Object</span></span>

<span data-ttu-id="fc7fa-104">Después de tener un puntero inicial a una interfaz en un objeto, COM tiene un mecanismo muy sencillo para averiguar si el objeto es compatible con otra interfaz específica y, en caso afirmativo, obtener un puntero a él.</span><span class="sxs-lookup"><span data-stu-id="fc7fa-104">After you have an initial pointer to an interface on an object, COM has a very simple mechanism to find out whether the object supports another specific interface and, if so, to get a pointer to it.</span></span> <span data-ttu-id="fc7fa-105">(Para obtener información sobre cómo obtener un puntero inicial a una interfaz en un objeto, vea [obtener un puntero a un objeto](getting-a-pointer-to-an-object.md)). Este mecanismo es el método [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) de la interfaz [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) .</span><span class="sxs-lookup"><span data-stu-id="fc7fa-105">(For information about getting an initial pointer to an interface on an object, see [Getting a Pointer to an Object](getting-a-pointer-to-an-object.md).) This mechanism is the [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) method of the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface.</span></span> <span data-ttu-id="fc7fa-106">Si el objeto admite la interfaz solicitada, el método debe devolver un puntero a esa interfaz.</span><span class="sxs-lookup"><span data-stu-id="fc7fa-106">If the object supports the requested interface, the method must return a pointer to that interface.</span></span> <span data-ttu-id="fc7fa-107">Esto permite que un objeto navegue libremente a través de las interfaces que admite un objeto.</span><span class="sxs-lookup"><span data-stu-id="fc7fa-107">This permits an object to navigate freely through the interfaces that an object supports.</span></span> <span data-ttu-id="fc7fa-108">**QueryInterface** separa la solicitud "¿se admite un contrato determinado?"</span><span class="sxs-lookup"><span data-stu-id="fc7fa-108">**QueryInterface** separates the request "Do you support a given contract?"</span></span> <span data-ttu-id="fc7fa-109">desde el uso de alto rendimiento de ese contrato una vez que las negociaciones se hayan realizado correctamente.</span><span class="sxs-lookup"><span data-stu-id="fc7fa-109">from the high-performance use of that contract once negotiations have been successful.</span></span>

<span data-ttu-id="fc7fa-110">Cuando un cliente obtiene acceso inicialmente a un objeto, ese cliente recibirá, como mínimo, un puntero de interfaz [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) (la interfaz más fundamental) a través de la cual puede controlar la duración del objeto. para ello, indique el objeto cuando se realice mediante el objeto e invoque [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)).</span><span class="sxs-lookup"><span data-stu-id="fc7fa-110">When a client initially gains access to an object, that client will receive, at a minimum, an [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface pointer (the most fundamental interface) through which it can control the lifetime of the object—by telling the object when it is done using the object—and invoke [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)).</span></span> <span data-ttu-id="fc7fa-111">El cliente está programado para preguntar a cada objeto que administra para realizar algunas operaciones, pero la interfaz **IUnknown** no tiene funciones para esas operaciones.</span><span class="sxs-lookup"><span data-stu-id="fc7fa-111">The client is programmed to ask each object it manages to perform some operations, but the **IUnknown** interface has no functions for those operations.</span></span> <span data-ttu-id="fc7fa-112">En su lugar, esas operaciones se expresan a través de otras interfaces.</span><span class="sxs-lookup"><span data-stu-id="fc7fa-112">Instead, those operations are expressed through other interfaces.</span></span> <span data-ttu-id="fc7fa-113">Por tanto, el cliente está programado para negociar con objetos de esas interfaces.</span><span class="sxs-lookup"><span data-stu-id="fc7fa-113">The client is thus programmed to negotiate with objects for those interfaces.</span></span> <span data-ttu-id="fc7fa-114">En concreto, el cliente llamará a **QueryInterface** para solicitar un objeto para una interfaz a través de la cual el cliente pueda invocar las operaciones deseadas.</span><span class="sxs-lookup"><span data-stu-id="fc7fa-114">Specifically, the client will call **QueryInterface** to ask an object for an interface through which the client may invoke the desired operations.</span></span>

<span data-ttu-id="fc7fa-115">Dado que el objeto implementa [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)), tiene la capacidad de aceptar o rechazar la solicitud.</span><span class="sxs-lookup"><span data-stu-id="fc7fa-115">Because the object implements [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)), it has the ability to accept or reject the request.</span></span> <span data-ttu-id="fc7fa-116">Si el objeto acepta la solicitud del cliente, **QueryInterface** devuelve un nuevo puntero a la interfaz solicitada al cliente.</span><span class="sxs-lookup"><span data-stu-id="fc7fa-116">If the object accepts the client's request, **QueryInterface** returns a new pointer to the requested interface to the client.</span></span> <span data-ttu-id="fc7fa-117">A través de ese puntero de interfaz, el cliente tiene acceso a los métodos de esa interfaz.</span><span class="sxs-lookup"><span data-stu-id="fc7fa-117">Through that interface pointer, the client has access to the methods of that interface.</span></span> <span data-ttu-id="fc7fa-118">Por otro lado, si el objeto rechaza la solicitud del cliente, **QueryInterface** devuelve un puntero nulo (un error) y el cliente no tiene ningún puntero a través del que llamar a las funciones deseadas.</span><span class="sxs-lookup"><span data-stu-id="fc7fa-118">If, on the other hand, the object rejects the client's request, **QueryInterface** returns a null pointer—an error—and the client has no pointer through which to call the desired functions.</span></span> <span data-ttu-id="fc7fa-119">En este caso, el cliente debe tratar correctamente la posibilidad.</span><span class="sxs-lookup"><span data-stu-id="fc7fa-119">In this case, the client must deal gracefully with that possibility.</span></span> <span data-ttu-id="fc7fa-120">Por ejemplo, suponga que un cliente tiene un puntero a la interfaz a en un objeto y solicita las interfaces B y C. suponga también que el objeto admite la interfaz B pero no admite la interfaz C. El resultado es que el objeto devuelve un puntero a B y notifica que C no se admite.</span><span class="sxs-lookup"><span data-stu-id="fc7fa-120">For example, suppose a client has a pointer to interface A on an object and asks for interfaces B and C. Suppose also that the object supports interface B but does not support interface C. The result is that the object returns a pointer to B and reports that C is not supported.</span></span>

<span data-ttu-id="fc7fa-121">Un punto clave es que cuando un objeto rechaza una llamada a [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)), no es posible que el cliente solicite al objeto que realice las operaciones expresadas a través de la interfaz solicitada.</span><span class="sxs-lookup"><span data-stu-id="fc7fa-121">A key point is that when an object rejects a call to [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)), it is impossible for the client to ask the object to perform the operations expressed through the requested interface.</span></span> <span data-ttu-id="fc7fa-122">Un cliente debe tener un puntero de interfaz para invocar métodos en esa interfaz.</span><span class="sxs-lookup"><span data-stu-id="fc7fa-122">A client must have an interface pointer to invoke methods in that interface.</span></span> <span data-ttu-id="fc7fa-123">Si el objeto rechaza proporcionar el puntero solicitado, el cliente debe estar preparado para llevar a cabo sin, ya sea no haciendo lo que tenía previsto hacer con ese objeto o intentando revertir a otra interfaz, quizás menos eficaz.</span><span class="sxs-lookup"><span data-stu-id="fc7fa-123">If the object refuses to provide the requested pointer, the client must be prepared to do without, either by not doing whatever it had intended to do with that object or by attempting to fall back on another, perhaps less powerful, interface.</span></span> <span data-ttu-id="fc7fa-124">Esta característica de la funcionalidad COM funciona bien en comparación con otros sistemas orientados a objetos en los que no puede saber si una función funcionará hasta que llame a esa función, e incluso después, el control de errores es cierto.</span><span class="sxs-lookup"><span data-stu-id="fc7fa-124">This feature of COM functionality works well in comparison with other object-oriented systems in which you cannot know whether a function will work until you call that function, and even then, handling failure is uncertain.</span></span> <span data-ttu-id="fc7fa-125">**QueryInterface** proporciona una forma confiable y coherente de saber si un objeto admite una interfaz antes de intentar llamar a sus métodos.</span><span class="sxs-lookup"><span data-stu-id="fc7fa-125">**QueryInterface** provides a reliable and consistent way to know whether an object supports an interface before attempting to call its methods.</span></span>

<span data-ttu-id="fc7fa-126">El método [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) también proporciona una forma sólida y confiable de que un objeto indique que no admite un contrato determinado.</span><span class="sxs-lookup"><span data-stu-id="fc7fa-126">The [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) method also provides a robust and reliable way for an object to indicate that it does not support a given contract.</span></span> <span data-ttu-id="fc7fa-127">Es decir, si en una llamada a **QueryInterface** se le pide un objeto "antiguo", ya sea compatible con una interfaz "nueva" (por ejemplo, que se ha inventado después de que se haya enviado el objeto anterior), el objeto antiguo será confiable, sin provocar un bloqueo, responder "no".</span><span class="sxs-lookup"><span data-stu-id="fc7fa-127">That is, if in a call to **QueryInterface** one asks an "old" object whether it supports a "new" interface (one, for example, that was invented after the old object had been shipped), the old object will reliably, without causing a crash, answer "no."</span></span> <span data-ttu-id="fc7fa-128">La tecnología que es compatible con este es el algoritmo por el que se asignan IID.</span><span class="sxs-lookup"><span data-stu-id="fc7fa-128">The technology that supports this is the algorithm by which IIDs are allocated.</span></span> <span data-ttu-id="fc7fa-129">Aunque esto puede parecer un punto pequeño, es sumamente importante para la arquitectura global del sistema y la capacidad de consultar los elementos heredados sobre la nueva funcionalidad es, sorprendentemente, una característica que no está presente en la mayoría de las demás arquitecturas de objetos.</span><span class="sxs-lookup"><span data-stu-id="fc7fa-129">While this may seem like a small point, it is extremely important to the overall architecture of the system, and the ability to inquire of legacy elements about new functionality is, surprisingly, a feature not present in most other object architectures.</span></span>

## <a name="related-topics"></a><span data-ttu-id="fc7fa-130">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="fc7fa-130">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="fc7fa-131">Usar e implementar IUnknown</span><span class="sxs-lookup"><span data-stu-id="fc7fa-131">Using and Implementing IUnknown</span></span>](using-and-implementing-iunknown.md)
</dt> </dl>

 

 




