---
title: Almacenar conjuntos de propiedades
description: Las aplicaciones pueden exponer algunos de los datos de estado de sus documentos para que otras aplicaciones puedan buscar y leer esos datos.
ms.assetid: 2e0b5f6c-da1d-47f2-a50d-1ac7f2f0c45d
keywords:
- Almacenar conjuntos de propiedades almacenamiento estructurado
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 60710b84b52fcc709f8ba3ad1e930d6f5a50a4cd
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/16/2019
ms.locfileid: "103903200"
---
# <a name="storing-property-sets"></a><span data-ttu-id="2e494-104">Almacenar conjuntos de propiedades</span><span class="sxs-lookup"><span data-stu-id="2e494-104">Storing Property Sets</span></span>

<span data-ttu-id="2e494-105">Las aplicaciones pueden exponer algunos de los datos de estado de sus documentos para que otras aplicaciones puedan buscar y leer esos datos.</span><span class="sxs-lookup"><span data-stu-id="2e494-105">Applications can expose some of the state data of their documents so that other applications can locate and read that data.</span></span> <span data-ttu-id="2e494-106">Algunos ejemplos son un conjunto de propiedades que describen el autor, el título y las palabras clave de un documento creado con un procesador de textos, o la lista de fuentes utilizadas en un documento.</span><span class="sxs-lookup"><span data-stu-id="2e494-106">Some examples are a property set describing the author, title, and keywords of a document created with a word processor, or the list of fonts used in a document.</span></span> <span data-ttu-id="2e494-107">Esta instalación no está restringida a los documentos; también se puede utilizar en objetos incrustados.</span><span class="sxs-lookup"><span data-stu-id="2e494-107">This facility is not restricted to documents; it can also be used on embedded objects.</span></span> <span data-ttu-id="2e494-108">Por lo general, el acceso a los conjuntos de propiedades debe realizarse a través de las interfaces [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) y [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) , pero en esta sección se describe el método recomendado previamente.</span><span class="sxs-lookup"><span data-stu-id="2e494-108">Generally, access to property sets should be through the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) and [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interfaces, but this section describes the previously recommended way.</span></span>

> [!Note]  
> <span data-ttu-id="2e494-109">Si almacena un conjunto de propiedades que es interno de la aplicación, es posible que no desee usar las siguientes directrices.</span><span class="sxs-lookup"><span data-stu-id="2e494-109">If storing a property set that is internal to your application, you may not want to use the following guidelines.</span></span> <span data-ttu-id="2e494-110">Para exponer la propiedad establecida en otras aplicaciones, siga estas instrucciones.</span><span class="sxs-lookup"><span data-stu-id="2e494-110">To expose your property set to other applications, follow these guidelines.</span></span>

 

<span data-ttu-id="2e494-111">**Para almacenar un conjunto de propiedades en un archivo compuesto**</span><span class="sxs-lookup"><span data-stu-id="2e494-111">**To store a property set in a compound file**</span></span>

1.  <span data-ttu-id="2e494-112">Cree una instancia de [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) o [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) en el mismo nivel de la estructura de almacenamiento que sus flujos de datos.</span><span class="sxs-lookup"><span data-stu-id="2e494-112">Create an [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) or [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) instance in the same level of the storage structure as its data streams.</span></span> <span data-ttu-id="2e494-113">Siga el nombre de la instancia de **IStorage** o **IStream** con " \\ 005".</span><span class="sxs-lookup"><span data-stu-id="2e494-113">Follow the name of your **IStorage** or **IStream** instance with "\\005."</span></span> <span data-ttu-id="2e494-114">Los nombres de flujo y almacenamiento que comienzan por 0x05 se reservan para los conjuntos de propiedades comunes que se pueden compartir entre las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="2e494-114">Stream and storage names that begin with 0x05 are reserved for common property sets that can be shared among applications.</span></span> <span data-ttu-id="2e494-115">Además, las secuencias que comienzan con ese valor se limitan a 256 KB.</span><span class="sxs-lookup"><span data-stu-id="2e494-115">Also, streams beginning with that value are limited to 256 KB.</span></span> <span data-ttu-id="2e494-116">Los nombres pueden seleccionarse desde nombres y formatos publicados, o bien asignando la propiedad set a FMTID y derivando el nombre de FMTID según las convenciones descritas en [convenciones de nomenclatura de objetos de almacenamiento](storage-object-naming-conventions.md).</span><span class="sxs-lookup"><span data-stu-id="2e494-116">The names can be selected from either published names and formats, or by assigning the property set a FMTID and deriving the name from the FMTID according to the conventions described in [Storage Object Naming Conventions](storage-object-naming-conventions.md).</span></span>
2.  <span data-ttu-id="2e494-117">Un conjunto de propiedades se puede almacenar en una única instancia de [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) o en una instancia de [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) que contenga varias secuencias y almacenamientos.</span><span class="sxs-lookup"><span data-stu-id="2e494-117">A property set may be stored in a single [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) instance or in an [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) instance containing multiple streams and storages.</span></span> <span data-ttu-id="2e494-118">En el caso de una instancia de **IStorage** , el flujo contenido denominado Contents es el flujo principal que contiene los valores de propiedad, donde algunos valores pueden ser nombres de otras secuencias o instancias de almacenamiento en el almacenamiento de este conjunto de propiedades.</span><span class="sxs-lookup"><span data-stu-id="2e494-118">In the case of an **IStorage** instance, the contained stream named Contents is the primary stream containing property values, where some values may be names of other streams or storage instances within the storage for this property set.</span></span>
3.  <span data-ttu-id="2e494-119">Especifique el CLSID de la clase de objeto que puede mostrar o proporcionar acceso mediante programación a los valores de propiedad.</span><span class="sxs-lookup"><span data-stu-id="2e494-119">Specify the CLSID of the object class that can display or provide programmatic access to the property values.</span></span> <span data-ttu-id="2e494-120">Si no hay ninguna clase de este tipo, el CLSID debe establecerse en el identificador de formato del conjunto de propiedades.</span><span class="sxs-lookup"><span data-stu-id="2e494-120">If there is no such class, the CLSID should be set to the format identifier of the property set.</span></span> <span data-ttu-id="2e494-121">En el caso de un conjunto de propiedades que use una instancia de [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) , establezca el CLSID de la instancia de **IStorage** para que sea el mismo que el almacenado en el flujo de contenido o en **CLSID \_ null**; el valor de una instancia de **IStorage** recién creada.</span><span class="sxs-lookup"><span data-stu-id="2e494-121">For a property set that uses an [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) instance, either set the CLSID of the **IStorage** instance to be the same as that stored in the Contents stream or to **CLSID\_NULL**; the value in a newly created **IStorage** instance.</span></span>
4.  <span data-ttu-id="2e494-122">Tiene la opción de especificar nombres que se puede mostrar que conforman el contenido del diccionario.</span><span class="sxs-lookup"><span data-stu-id="2e494-122">You have the option of specifying displayable names that form the contents of the dictionary.</span></span>

<span data-ttu-id="2e494-123">Algunas aplicaciones pueden leer solo las implementaciones de conjuntos de propiedades almacenadas como instancias de [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) .</span><span class="sxs-lookup"><span data-stu-id="2e494-123">Some applications can read only implementations of property sets stored as [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) instances.</span></span> <span data-ttu-id="2e494-124">Las aplicaciones se deben escribir para esperar que un conjunto de propiedades se pueda almacenar en una instancia de [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) o **IStream** , a menos que la definición del conjunto de propiedades indique lo contrario.</span><span class="sxs-lookup"><span data-stu-id="2e494-124">Applications should be written to expect that a property set may be stored in either an [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) or **IStream** instance, unless the property set definition indicates otherwise.</span></span> <span data-ttu-id="2e494-125">Por ejemplo, la definición del conjunto de propiedades información de Resumen indica que solo se puede almacenar en una instancia de **IStream** con nombre.</span><span class="sxs-lookup"><span data-stu-id="2e494-125">For example, the Summary Information property set definition states that it can only be stored in a named **IStream** instance.</span></span> <span data-ttu-id="2e494-126">En los casos en los que se busca un conjunto de propiedades y no se sabe si se trata de un almacenamiento o una secuencia, busque una instancia de **IStream** con el nombre del conjunto de propiedades en primer lugar.</span><span class="sxs-lookup"><span data-stu-id="2e494-126">In cases where you are searching for a property set and do not know whether it is a storage or stream, look for an **IStream** instance with your property set name first.</span></span> <span data-ttu-id="2e494-127">Si se produce un error, busque una instancia de **IStorage** .</span><span class="sxs-lookup"><span data-stu-id="2e494-127">If that fails, look for an **IStorage** instance.</span></span>

<span data-ttu-id="2e494-128">Para comprender mejor el almacenamiento de conjuntos de propiedades en una implementación de [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) , supongamos que hay una clase de aplicaciones que editan información sobre animales.</span><span class="sxs-lookup"><span data-stu-id="2e494-128">To better understand storing property sets in an [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) implementation, suppose there is a class of applications that edit information about animals.</span></span> <span data-ttu-id="2e494-129">En primer lugar, se define un CLSID (CLSID \_ AnimalApp) para este conjunto de aplicaciones, por lo que pueden indicar que comprenden conjuntos de propiedades que contienen información de los animales (**FMTID \_ AnimalInfo**) y otros que contienen información médica (**FMTID \_ MedicalInfo**).</span><span class="sxs-lookup"><span data-stu-id="2e494-129">First, a CLSID (CLSID\_AnimalApp) is defined for this set of applications, so they can indicate that they understand property sets that contain animal information (**FMTID\_AnimalInfo**), and others that contain medical information (**FMTID\_MedicalInfo**).</span></span>

``` syntax
IStorage (File): "C:\OLE\REVO.DOC" 
  IStorage: "\005AnimalInfo", CLSID = CLSID_AnimalApp 
    IStream: "Contents" 
      WORD wByteOrder, WORD wFmtVersion, DWORD dwOSVer, 
      CLSID CLSID_AnimalApp, DWORD cSections... 
      ... 
      FMTID = FMTID_AnimalInfo 
      Property: Type = PID_ANIMALTYPE, Type = VT_LPWSTR, 
              Value = L"Dog" 
      Property: Type = PID_ANIMALNAME, Type = VT_LPWSTR, 
              Value = L"Revo" 
      Property: Type = PID_MEDICALHISTORY, Type = VT_STREAMED_OBJECT, 
              Value = "MedicalInfo" 
      ... 
    IStream: "MedicalInfo" 
      WORD wByteOrder, WORD wFmtVersion, DWORD dwOSVer, 
      CLSID CLSID_AnimalApp, DWORD cSections... 
      ... 
      FMTID = CLSID_MedicalInfo 
      Property: Type = PID_VETNAME, Type = VT_LPWSTR, 
              Value = L"Dr. Woof" 
      Property: Type = PID_LASTEXAM, Type = VT_DATE, Value = ...
```

<span data-ttu-id="2e494-130">Tenga en cuenta que el CLSID de la interfaz [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) y ambos conjuntos de propiedades es **CLSID \_ AnimalApp**.</span><span class="sxs-lookup"><span data-stu-id="2e494-130">Be aware that the CLSID of the [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) interface and both property sets is **CLSID\_AnimalApp**.</span></span> <span data-ttu-id="2e494-131">Esto identifica cualquier aplicación que pueda mostrar y/o proporcionar acceso mediante programación a estos conjuntos de propiedades.</span><span class="sxs-lookup"><span data-stu-id="2e494-131">This identifies any application that can display and/or provide programmatic access to these property sets.</span></span> <span data-ttu-id="2e494-132">Cualquier aplicación puede leer los datos de los conjuntos de propiedades (los conjuntos de propiedades de punto detrás), pero solo las aplicaciones identificadas con el identificador de clase de CLSID \_ AnimalApp pueden entender el significado de los datos en los conjuntos de propiedades.</span><span class="sxs-lookup"><span data-stu-id="2e494-132">Any application can read the data within the property sets (the point behind property sets), but only applications identified with the class identifier of CLSID\_AnimalApp can understand the meaning of the data in the property sets.</span></span>

 

 




