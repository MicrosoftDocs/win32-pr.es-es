---
description: Cuando un usuario hace clic con el botón secundario en un objeto de Shell, el menú contextual que se muestra normalmente incluye un elemento propiedades.
title: Controladores de hoja de propiedades
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 72233ab5-212d-498c-8df1-1a96c8eda892
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: 40ccb8d1cee0fffb993aef417b979816597cf707
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "103910769"
---
# <a name="property-sheet-handlers"></a><span data-ttu-id="e7aa7-103">Controladores de hoja de propiedades</span><span class="sxs-lookup"><span data-stu-id="e7aa7-103">Property Sheet Handlers</span></span>

<span data-ttu-id="e7aa7-104">Cuando un usuario hace clic con el botón secundario en un objeto de Shell, el menú contextual que se muestra normalmente incluye un elemento **propiedades** .</span><span class="sxs-lookup"><span data-stu-id="e7aa7-104">When a user right-clicks a Shell object, the shortcut menu that is displayed normally includes a **Properties** item.</span></span> <span data-ttu-id="e7aa7-105">Al seleccionar ese elemento se inicia una hoja de propiedades que permite al usuario ver y, en algunos casos, modificar las propiedades del objeto.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-105">Selecting that item launches a property sheet that allows the user to view, and in some cases modify, the object's properties.</span></span> <span data-ttu-id="e7aa7-106">Puede personalizar esta hoja de propiedades implementando y registrando un *controlador* de la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-106">You can customize this property sheet by implementing and registering a *property sheet handler*.</span></span>

<span data-ttu-id="e7aa7-107">Los procedimientos generales para implementar y registrar un controlador de extensión de Shell se explican en [crear controladores de extensión de Shell](handlers.md).</span><span class="sxs-lookup"><span data-stu-id="e7aa7-107">The general procedures for implementing and registering a Shell extension handler are discussed in [Creating Shell Extension Handlers](handlers.md).</span></span> <span data-ttu-id="e7aa7-108">Este documento se centra en los aspectos de la implementación que son específicos de los controladores de hojas de propiedades.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-108">This document focuses on those aspects of implementation that are specific to property sheet handlers.</span></span>

-   [<span data-ttu-id="e7aa7-109">Cómo funcionan los controladores de hoja de propiedades</span><span class="sxs-lookup"><span data-stu-id="e7aa7-109">How Property Sheet Handlers Work</span></span>](#how-property-sheet-handlers-work)
-   [<span data-ttu-id="e7aa7-110">Registro e implementación de un controlador de hoja de propiedades para una unidad montada</span><span class="sxs-lookup"><span data-stu-id="e7aa7-110">Registering and Implementing a Property Sheet Handler for a Mounted Drive</span></span>](#registering-and-implementing-a-property-sheet-handler-for-a-mounted-drive)
-   [<span data-ttu-id="e7aa7-111">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="e7aa7-111">Related topics</span></span>](#related-topics)

## <a name="how-property-sheet-handlers-work"></a><span data-ttu-id="e7aa7-112">Cómo funcionan los controladores de hoja de propiedades</span><span class="sxs-lookup"><span data-stu-id="e7aa7-112">How Property Sheet Handlers Work</span></span>

<span data-ttu-id="e7aa7-113">En la ilustración siguiente se muestra la hoja de propiedades propiedades de un archivo de texto de Windows XP.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-113">The following illustration shows the Properties property sheet for a Windows XP text file.</span></span>

![hoja de propiedades](images/propsheethandler1.jpg)

<span data-ttu-id="e7aa7-115">En esta ilustración se muestra la hoja de propiedades de propiedades predeterminadas que se muestra para cualquier archivo.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-115">This illustration shows the default Properties property sheet that is displayed for any file.</span></span> <span data-ttu-id="e7aa7-116">Para muchas de estas hojas de propiedades, puede Agregar una o varias páginas a la hoja de propiedades implementando y registrando un controlador de la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-116">For many such property sheets, you can add one or more pages to the property sheet by implementing and registering a property sheet handler.</span></span>

<span data-ttu-id="e7aa7-117">Los controladores de hoja de propiedades se registran normalmente para un [tipo de archivo](fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="e7aa7-117">Property sheet handlers are most commonly registered for a [file type](fa-file-types.md).</span></span> <span data-ttu-id="e7aa7-118">Cada controlador puede Agregar una página personalizada a la hoja de propiedades de propiedades de la clase.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-118">Each handler can add one custom page to the Properties property sheet for the class.</span></span> <span data-ttu-id="e7aa7-119">Normalmente, estas páginas proporcionan a los usuarios acceso a las propiedades que son específicas del tipo de archivo determinado.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-119">These pages typically give users access to properties that are specific to the particular file type.</span></span> <span data-ttu-id="e7aa7-120">Un tipo de archivo que consta de documentos de texto podría, por ejemplo, mostrar una página con el título y el autor, y un resumen del documento.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-120">A file type consisting of text documents could, for instance, display a page that listed the title and author, and an abstract of the document.</span></span> <span data-ttu-id="e7aa7-121">Se utiliza un caso especial de este tipo de controlador de la hoja de propiedades para agregar una página a la hoja de propiedades propiedades de una unidad montada.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-121">A special case of this type of property sheet handler is used to add a page to the Properties property sheet for a mounted drive.</span></span>

<span data-ttu-id="e7aa7-122">El otro uso para los controladores de hojas de propiedades es reemplazar las páginas de las hojas de propiedades que se muestran en las aplicaciones del panel de control.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-122">The other use for property sheet handlers is to replace pages in the property sheets displayed by Control Panel applications.</span></span> <span data-ttu-id="e7aa7-123">Un fabricante del mouse, por ejemplo, puede usar un controlador de la hoja de propiedades para reemplazar la página **botones** de la hoja de propiedades del **mouse** del panel de control por una página personalizada para las características del mouse.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-123">A mouse manufacturer, for instance, can use a property sheet handler to replace the **Buttons** page on the Control Panel's **Mouse Properties** property sheet with a page that is customized for the characteristics of its mouse.</span></span>

<span data-ttu-id="e7aa7-124">Al igual que todos los controladores de extensión de Shell, los controladores de hoja de propiedades son objetos de modelo de objetos componentes (COM) en proceso implementados como archivos dll.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-124">Like all Shell extension handlers, property sheet handlers are in-process Component Object Model (COM) objects implemented as DLLs.</span></span> <span data-ttu-id="e7aa7-125">Deben exportar dos interfaces además de [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown): [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) y [**IShellPropSheetExt**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext).</span><span class="sxs-lookup"><span data-stu-id="e7aa7-125">They must export two interfaces in addition to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown): [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) and [**IShellPropSheetExt**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext).</span></span>

<span data-ttu-id="e7aa7-126">El shell usa la interfaz [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) para inicializar el controlador.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-126">The [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface is used by the Shell to initialize the handler.</span></span> <span data-ttu-id="e7aa7-127">Cuando el shell llama a [**IShellExtInit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize), pasa un objeto de datos con el nombre del objeto y el puntero a una lista de identificadores de elemento (PIDL) de la carpeta que contiene el archivo.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-127">When the Shell calls [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize), it passes in a data object with the object's name, and the pointer to an item identifier list (PIDL) of the folder that contains the file.</span></span> <span data-ttu-id="e7aa7-128">El parámetro *hRegKey* no se utiliza con controladores de hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-128">The *hRegKey* parameter is not used with property sheet handlers.</span></span> <span data-ttu-id="e7aa7-129">El método **IShellExtInit:: Initialize** debe extraer el nombre de archivo del objeto de datos y almacenar el nombre y el PIDL de la carpeta para su uso posterior.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-129">The **IShellExtInit::Initialize** method must extract the file name from the data object, and store the name and the folder's PIDL for later use.</span></span> <span data-ttu-id="e7aa7-130">Para obtener más información, vea la sección *implementación de IShellExtInit* de creación de controladores de [extensión de Shell](handlers.md).</span><span class="sxs-lookup"><span data-stu-id="e7aa7-130">For further details, see the *Implementing IShellExtInit* section of [Creating Shell Extension Handlers](handlers.md).</span></span>

<span data-ttu-id="e7aa7-131">El resto de la operación se lleva a cabo a través de la interfaz [**IShellPropSheetExt**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext) del controlador.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-131">The remainder of the operation takes place through the handler's [**IShellPropSheetExt**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext) interface.</span></span> <span data-ttu-id="e7aa7-132">Si la hoja de propiedades está asociada a un tipo de archivo, el shell llama a [**IShellPropSheetExt:: AddPages**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) para permitir que el controlador agregue una página a la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-132">If the property sheet is associated with a file type, the Shell calls [**IShellPropSheetExt::AddPages**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) to allow the handler to add a page to the property sheet.</span></span> <span data-ttu-id="e7aa7-133">Si la hoja de propiedades está asociada a una aplicación del panel de control, el shell llama a [**IShellPropSheetExt:: ReplacePage**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-replacepage) para permitir que el controlador reemplace una página.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-133">If the property sheet is associated with a Control Panel application, the Shell calls [**IShellPropSheetExt::ReplacePage**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-replacepage) to allow the handler to replace a page.</span></span>

## <a name="registering-and-implementing-a-property-sheet-handler-for-a-mounted-drive"></a><span data-ttu-id="e7aa7-134">Registro e implementación de un controlador de hoja de propiedades para una unidad montada</span><span class="sxs-lookup"><span data-stu-id="e7aa7-134">Registering and Implementing a Property Sheet Handler for a Mounted Drive</span></span>

<span data-ttu-id="e7aa7-135">Cada unidad montada tiene una hoja de propiedades que el usuario puede mostrar.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-135">Each mounted drive has a Properties sheet that can be displayed by the user.</span></span> <span data-ttu-id="e7aa7-136">La siguiente ilustración muestra una hoja de propiedades de propiedades de una unidad de CD-ROM.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-136">The following illustration shows a Properties property sheet for a CD-ROM drive.</span></span>

![propiedades de CD-ROM (hoja de propiedades)](images/propsheethandler2.jpg)

<span data-ttu-id="e7aa7-138">Hay una amplia variedad de dispositivos que se pueden montar como unidades.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-138">There are a wide variety of devices that can be mounted as drives.</span></span> <span data-ttu-id="e7aa7-139">Dado que la hoja de propiedades predeterminada, diseñada para unidades de disco, podría no ser suficiente para algunos dispositivos, se puede implementar un controlador de hoja de propiedades para agregar una página específica del dispositivo montado.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-139">Because the default property sheet, designed for disk drives, might not be sufficient for some devices, a property sheet handler can be implemented to add a page that is specific to the mounted device.</span></span> <span data-ttu-id="e7aa7-140">La implementación básica de este tipo de controlador de la hoja de propiedades es idéntica a la que se describe en [Cómo registrar e implementar un controlador de hoja de propiedades para un tipo de archivo](how-to-register-and-implement-a-property-sheet-handler-for-a-file-type.md), con dos excepciones.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-140">The basic implementation of this type of property sheet handler is identical to that discussed in [How to Register and Implement a Property Sheet Handler for a File Type](how-to-register-and-implement-a-property-sheet-handler-for-a-file-type.md), with two exceptions.</span></span>

-   <span data-ttu-id="e7aa7-141">El objeto de datos que se pasa al método [**IShellExtInit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) del controlador puede contener la ruta de acceso de la unidad en el formato [CFSTR \_ MOUNTEDVOLUME](clipboard.md) en lugar del formato [CF \_ HDROP](clipboard.md) .</span><span class="sxs-lookup"><span data-stu-id="e7aa7-141">The data object passed to the handler's [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) method may contain the drive path in the [CFSTR\_MOUNTEDVOLUME](clipboard.md) format instead of the [CF\_HDROP](clipboard.md) format.</span></span> <span data-ttu-id="e7aa7-142">El \_ formato CF HDROP se usa cuando el dispositivo se monta en una letra de unidad.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-142">The CF\_HDROP format is used when the device is mounted to a drive letter.</span></span> <span data-ttu-id="e7aa7-143">El \_ formato CFSTR MOUNTEDVOLUME se usa con sistemas de archivos NTFS cuando el dispositivo remoto se monta en una carpeta en lugar de en una letra de unidad.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-143">The CFSTR\_MOUNTEDVOLUME format is used with NTFS file systems when the remote device is mounted to a folder rather than to a drive letter.</span></span>
-   <span data-ttu-id="e7aa7-144">El GUID del controlador se registra en la **\_ \_** \\  \\ clave **shellex** \\ **PropertySheetHandlers** de la unidad raíz HKEY.</span><span class="sxs-lookup"><span data-stu-id="e7aa7-144">The handler's GUID is registered under the **HKEY\_CLASSES\_ROOT**\\**Drive**\\**shellex**\\**PropertySheetHandlers** key.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e7aa7-145">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="e7aa7-145">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e7aa7-146">Cómo registrar e implementar un controlador de hoja de propiedades para un tipo de archivo</span><span class="sxs-lookup"><span data-stu-id="e7aa7-146">How to Register and Implement a Property Sheet Handler for a File Type</span></span>](how-to-register-and-implement-a-property-sheet-handler-for-a-file-type.md)
</dt> <dt>

[<span data-ttu-id="e7aa7-147">Cómo registrar e implementar un controlador de la hoja de propiedades para una aplicación del panel de control</span><span class="sxs-lookup"><span data-stu-id="e7aa7-147">How to Register and Implement a Property Sheet Handler for a Control Panel Application</span></span>](how-to-register-and-implement-a-property-sheet-handler-for-a-control-panel-application.md)
</dt> </dl>

 

 
