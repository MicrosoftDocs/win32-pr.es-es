---
description: A continuación se indican sugerencias para interoperar correctamente con diversas características de seguridad y del sistema de archivos que se introdujeron en Windows Vista y Windows Server 2008.
ms.assetid: 3e8a1fd2-59e5-4f18-aafc-0ce5ac1e1cfa
title: Trabajar con el sistema de archivos y las características de seguridad
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 12903599beb7ed153965f4b803ad8147fd32067a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104154323"
---
# <a name="working-with-file-system-and-security-features"></a><span data-ttu-id="b9852-103">Trabajar con el sistema de archivos y las características de seguridad</span><span class="sxs-lookup"><span data-stu-id="b9852-103">Working with File System and Security Features</span></span>

<span data-ttu-id="b9852-104">A continuación se indican sugerencias para interoperar correctamente con diversas características de seguridad y del sistema de archivos que se introdujeron en Windows Vista y Windows Server 2008.</span><span class="sxs-lookup"><span data-stu-id="b9852-104">The following are hints for interoperating correctly with various file system and security features that were introduced in Windows Vista and Windows Server 2008.</span></span>

## <a name="interoperability-with-transactions"></a><span data-ttu-id="b9852-105">Interoperabilidad con transacciones</span><span class="sxs-lookup"><span data-stu-id="b9852-105">Interoperability with Transactions</span></span>

<span data-ttu-id="b9852-106">Para admitir transacciones, VSS garantiza que el administrador de transacciones de kernel (KTM) y el Coordinador de transacciones distribuidas (DTC) estén inmovilizados antes de la creación de instantáneas de volumen.</span><span class="sxs-lookup"><span data-stu-id="b9852-106">To support transactions, VSS ensures that both the Kernel Transaction Manager (KTM) and the Distributed Transaction Coordinator (DTC) are frozen prior to the creation of volume shadow copies.</span></span> <span data-ttu-id="b9852-107">Si el sistema no puede inmovilizar o reanudar KTM o DTC, los siguientes errores de tiempo de espera pueden ser devueltos por el método [**IVssBackupComponents::D osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) :</span><span class="sxs-lookup"><span data-stu-id="b9852-107">If the system fails to freeze or thaw KTM or DTC, the following timeout errors may be returned by the [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) method:</span></span>

<dl> <span data-ttu-id="b9852-108">\_tiempo de \_ \_ espera de inmovilización de transacción de VSS E \_</span><span class="sxs-lookup"><span data-stu-id="b9852-108">VSS\_E\_TRANSACTION\_FREEZE\_TIMEOUT</span></span>  
<span data-ttu-id="b9852-109">\_tiempo de \_ \_ espera de reanudación de transacción de VSS E \_</span><span class="sxs-lookup"><span data-stu-id="b9852-109">VSS\_E\_TRANSACTION\_THAW\_TIMEOUT</span></span>  
</dl>

<span data-ttu-id="b9852-110">Si el solicitante recibe uno de estos códigos de error, debe reintentar la creación de la instantánea.</span><span class="sxs-lookup"><span data-stu-id="b9852-110">If the requester receives one of these error codes, it must retry the shadow copy creation.</span></span>

<span data-ttu-id="b9852-111">También se pueden realizar transacciones al registro y a las operaciones del sistema de archivos.</span><span class="sxs-lookup"><span data-stu-id="b9852-111">Registry and file system operations can also be transacted.</span></span> <span data-ttu-id="b9852-112">En el caso del registro, el sistema de escritura del registro es responsable de garantizar la coherencia transaccional.</span><span class="sxs-lookup"><span data-stu-id="b9852-112">In the case of the registry, the registry writer is responsible for ensuring transactional consistency.</span></span> <span data-ttu-id="b9852-113">En el caso de las operaciones del sistema de archivos NTFS (TxF) transaccionales, el proveedor del sistema es responsable de garantizar la coherencia transaccional.</span><span class="sxs-lookup"><span data-stu-id="b9852-113">In the case of Transactional NTFS (TxF) file system operations, the system provider is responsible for ensuring transactional consistency.</span></span> <span data-ttu-id="b9852-114">Esto se consigue montando la instantánea como de lectura/escritura una vez creada para permitir la recuperación automática.</span><span class="sxs-lookup"><span data-stu-id="b9852-114">This is accomplished by mounting the shadow copy as read/write after it is created to allow for auto-recovery.</span></span> <span data-ttu-id="b9852-115">Durante la fase de recuperación automática, KTM revierte las transacciones incompletas.</span><span class="sxs-lookup"><span data-stu-id="b9852-115">During the auto-recovery phase, KTM rolls back any incomplete transactions.</span></span>

## <a name="identifying-and-creating-hard-links"></a><span data-ttu-id="b9852-116">Identificación y creación de vínculos físicos</span><span class="sxs-lookup"><span data-stu-id="b9852-116">Identifying and Creating Hard Links</span></span>

<span data-ttu-id="b9852-117">Al realizar copias de seguridad de archivos, una aplicación de copia de seguridad debe identificar todos los vínculos físicos de cada archivo para evitar realizar una copia de seguridad del mismo archivo más de una vez.</span><span class="sxs-lookup"><span data-stu-id="b9852-117">When backing up files, a backup application must identify all hard links to each file to avoid backing up the same file more than once.</span></span> <span data-ttu-id="b9852-118">Hay disponibles dos nuevas funciones para enumerar vínculos físicos: [**FindFirstFileNameW**](/windows/win32/api/fileapi/nf-fileapi-findfirstfilenamew) y [**FindNextFileNameW**](/windows/win32/api/fileapi/nf-fileapi-findnextfilenamew).</span><span class="sxs-lookup"><span data-stu-id="b9852-118">Two new functions are available for enumerating hard links: [**FindFirstFileNameW**](/windows/win32/api/fileapi/nf-fileapi-findfirstfilenamew) and [**FindNextFileNameW**](/windows/win32/api/fileapi/nf-fileapi-findnextfilenamew).</span></span>

<span data-ttu-id="b9852-119">Del mismo modo, al restaurar archivos, la aplicación de copia de seguridad debe restaurar los vínculos físicos mediante la función [**CreateHardLink**](/windows/win32/api/winbase/nf-winbase-createhardlinka) .</span><span class="sxs-lookup"><span data-stu-id="b9852-119">Similarly, when restoring files, the backup application must restore hard links using the [**CreateHardLink**](/windows/win32/api/winbase/nf-winbase-createhardlinka) function.</span></span>

<span data-ttu-id="b9852-120">Las aplicaciones de copia de seguridad también deben validar el privilegio de nombre de copia de seguridad de SE \_ \_ durante la fase de copia de seguridad y el nombre de restauración de se \_ \_ durante la fase de restauración.</span><span class="sxs-lookup"><span data-stu-id="b9852-120">Backup applications must also assert the SE\_BACKUP\_NAME privilege during the backup phase and the SE\_RESTORE\_NAME during the restore phase.</span></span>

## <a name="permissions-and-privileges-required-by-backup-applications"></a><span data-ttu-id="b9852-121">Permisos y privilegios necesarios para las aplicaciones de copia de seguridad</span><span class="sxs-lookup"><span data-stu-id="b9852-121">Permissions and Privileges Required by Backup Applications</span></span>

<span data-ttu-id="b9852-122">Las aplicaciones de copia de seguridad que restauran archivos del sistema requieren los privilegios siguientes:</span><span class="sxs-lookup"><span data-stu-id="b9852-122">Backup applications that restore system files require the following privileges:</span></span>

<dl> <span data-ttu-id="b9852-123">nombre de copia de seguridad de SE \_ \_</span><span class="sxs-lookup"><span data-stu-id="b9852-123">SE\_BACKUP\_NAME</span></span>  
<span data-ttu-id="b9852-124">nombre de la restauración de SE \_ \_</span><span class="sxs-lookup"><span data-stu-id="b9852-124">SE\_RESTORE\_NAME</span></span>  
<span data-ttu-id="b9852-125">\_nombre de seguridad de se \_</span><span class="sxs-lookup"><span data-stu-id="b9852-125">SE\_SECURITY\_NAME</span></span>  
<span data-ttu-id="b9852-126">SE \_ toma \_ \_ el nombre de propiedad</span><span class="sxs-lookup"><span data-stu-id="b9852-126">SE\_TAKE\_OWNERSHIP\_NAME</span></span>  
</dl>

<span data-ttu-id="b9852-127">Las aplicaciones de copia de seguridad también deben solicitar \_ derechos de acceso de propietario de escritura durante la fase de restauración.</span><span class="sxs-lookup"><span data-stu-id="b9852-127">Backup applications must also request WRITE\_OWNER access rights during the restore phase.</span></span>

## <a name="windows-media-digital-rights-management"></a><span data-ttu-id="b9852-128">Rights Management digital de Windows Media</span><span class="sxs-lookup"><span data-stu-id="b9852-128">Windows Media Digital Rights Management</span></span>

<span data-ttu-id="b9852-129">El cliente de Windows Media Digital Rights Management (DRM) mantiene un directorio de archivos de estado confidencial y de licencia en el directorio% ProgramData% \\ Microsoft \\ Windows \\ DRM.</span><span class="sxs-lookup"><span data-stu-id="b9852-129">Windows Media Digital Rights Management (DRM) client maintains a directory of sensitive state and license files in the %ProgramData%\\Microsoft\\Windows\\DRM directory.</span></span> <span data-ttu-id="b9852-130">Los archivos de este directorio se deben purgar al mismo tiempo que los archivos temporales y de caché.</span><span class="sxs-lookup"><span data-stu-id="b9852-130">The files in this directory should be purged at the same time as temporary and cache files.</span></span> <span data-ttu-id="b9852-131">Para asegurarse de que el cliente DRM de Windows permanece en un estado coherente, debe evitar la copia de seguridad o la restauración de estos archivos.</span><span class="sxs-lookup"><span data-stu-id="b9852-131">To ensure that the Windows DRM client remains in a consistent state, you must avoid backing up or restoring these files.</span></span> <span data-ttu-id="b9852-132">Este directorio aparece en la clave del registro FilesNotToBackup.</span><span class="sxs-lookup"><span data-stu-id="b9852-132">This directory is listed in the FilesNotToBackup registry key.</span></span> <span data-ttu-id="b9852-133">Para obtener más información acerca de la clave FilesNotToBackup, consulte [generar un conjunto de copia de seguridad](generating-a-backup-set.md).</span><span class="sxs-lookup"><span data-stu-id="b9852-133">For more information about the FilesNotToBackup key, see [Generating a Backup Set](generating-a-backup-set.md).</span></span>

## <a name="user-account-control"></a><span data-ttu-id="b9852-134">Control de cuentas de usuario</span><span class="sxs-lookup"><span data-stu-id="b9852-134">User Account Control</span></span>

<span data-ttu-id="b9852-135">La introducción de control de cuentas de usuario (UAC) en Windows Vista significa que, a menos que se especifique lo contrario, las aplicaciones deben ejecutarse en una cuenta de usuario estándar.</span><span class="sxs-lookup"><span data-stu-id="b9852-135">The introduction of User Account Control (UAC) in Windows Vista means that unless specified otherwise, applications must run under a standard user account.</span></span> <span data-ttu-id="b9852-136">Además, la característica de virtualización de archivos y del registro de UAC modifica las ubicaciones donde se almacenan los datos de usuario.</span><span class="sxs-lookup"><span data-stu-id="b9852-136">Additionally, the file and registry virtualization feature of UAC alters the locations where user data is stored.</span></span> <span data-ttu-id="b9852-137">Para obtener más información sobre cómo trabajar con UAC y la virtualización del registro y de archivos, vea las siguientes referencias:</span><span class="sxs-lookup"><span data-stu-id="b9852-137">For more information about how to work with UAC and file and registry virtualization, see the following references:</span></span>

<dl>

<span data-ttu-id="b9852-138">[Caso de desarrollador de Windows Vista y Windows Server 2008: requisitos de desarrollo de aplicaciones de Windows Vista para el control de cuentas de usuario (UAC)](/previous-versions/aa905330(v=msdn.10))</span><span class="sxs-lookup"><span data-stu-id="b9852-138">[The Windows Vista and Windows Server 2008 Developer Story: Windows Vista Application Development Requirements for User Account Control (UAC)](/previous-versions/aa905330(v=msdn.10))</span></span>  
<span data-ttu-id="b9852-139">[Requisitos de desarrollo de aplicaciones de Windows Vista para la compatibilidad de control de cuentas de usuario](/previous-versions/dotnet/articles/bb530410(v=msdn.10))</span><span class="sxs-lookup"><span data-stu-id="b9852-139">[Windows Vista Application Development Requirements for User Account Control Compatibility](/previous-versions/dotnet/articles/bb530410(v=msdn.10))</span></span>  
[<span data-ttu-id="b9852-140">Revisión de control de cuentas de usuario (UAC)</span><span class="sxs-lookup"><span data-stu-id="b9852-140">User Account Control (UAC) Patching</span></span>](../msi/user-account-control--uac--patching.md)  
</dl>

## <a name="bitlocker-drive-encryption"></a><span data-ttu-id="b9852-141">Cifrado BitLocker de unidades</span><span class="sxs-lookup"><span data-stu-id="b9852-141">BitLocker Drive Encryption</span></span>

<span data-ttu-id="b9852-142">Cifrado de unidad BitLocker es una característica nueva de Windows Vista Enterprise, Windows Vista Ultimate y Windows Server 2008 que ofrece un inicio seguro y un cifrado de volumen completo.</span><span class="sxs-lookup"><span data-stu-id="b9852-142">BitLocker Drive Encryption is a new feature in Windows Vista Enterprise, Windows Vista Ultimate, and Windows Server 2008 that offers secure startup and full volume encryption.</span></span> <span data-ttu-id="b9852-143">Comprender esta característica es importante para los desarrolladores de aplicaciones de copia de seguridad que realizan restauraciones sin conexión en las que es posible que sea necesario restaurar los datos en una unidad cifrada.</span><span class="sxs-lookup"><span data-stu-id="b9852-143">Understanding this feature is important for developers of backup applications that perform offline restores where data may need to be restored onto an encrypted drive.</span></span>

<span data-ttu-id="b9852-144">Para restaurar los datos en una unidad cifrada, siga estos pasos:</span><span class="sxs-lookup"><span data-stu-id="b9852-144">To restore data onto an encrypted drive, perform the following steps:</span></span>

1.  <span data-ttu-id="b9852-145">Desbloquee la unidad.</span><span class="sxs-lookup"><span data-stu-id="b9852-145">Unlock the drive.</span></span>
2.  <span data-ttu-id="b9852-146">Desactive Cifrado de unidad BitLocker.</span><span class="sxs-lookup"><span data-stu-id="b9852-146">Turn off BitLocker Drive Encryption.</span></span>
3.  <span data-ttu-id="b9852-147">Lleve a cabo la restauración.</span><span class="sxs-lookup"><span data-stu-id="b9852-147">Perform the restore.</span></span>
4.  <span data-ttu-id="b9852-148">Arranque en el sistema operativo restaurado y Active Cifrado de unidad BitLocker.</span><span class="sxs-lookup"><span data-stu-id="b9852-148">Boot into the restored operating system and turn on BitLocker Drive Encryption.</span></span>

<span data-ttu-id="b9852-149">Para obtener información detallada acerca de Cifrado de unidad BitLocker, incluida una guía paso a paso, consulte [cifrado de unidad BitLocker](https://www.microsoft.com/technet/windowsvista/security/bitlockr.mspx) en el sitio web de Microsoft TechNet Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="b9852-149">For detailed information about BitLocker Drive Encryption, including a step-by-step guide, see [BitLocker Drive Encryption](https://www.microsoft.com/technet/windowsvista/security/bitlockr.mspx) on the Microsoft TechNet Windows Vista website.</span></span> <span data-ttu-id="b9852-150">Para obtener información acerca del proveedor de Cifrado de unidad BitLocker WMI, consulte [cifrado de unidad BitLocker Provider](../secprov/bitlocker-drive-encryption-provider.md).</span><span class="sxs-lookup"><span data-stu-id="b9852-150">For information about the BitLocker Drive Encryption WMI provider, see [BitLocker Drive Encryption Provider](../secprov/bitlocker-drive-encryption-provider.md).</span></span>

 

 
