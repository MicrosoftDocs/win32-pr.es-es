---
title: Implementación básica
description: Un proveedor ADSI admite las siguientes características
ms.assetid: 39798237-a181-43b4-8441-ac711f923d4d
ms.tgt_platform: multiple
keywords:
- ADSI de implementación básica
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f62068bd77553f89e222422431811da1ef251ccd
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/21/2020
ms.locfileid: "104078371"
---
# <a name="core-implementation"></a><span data-ttu-id="0f609-104">Implementación básica</span><span class="sxs-lookup"><span data-stu-id="0f609-104">Core Implementation</span></span>

<span data-ttu-id="0f609-105">Un proveedor ADSI admite las siguientes características:</span><span class="sxs-lookup"><span data-stu-id="0f609-105">An ADSI provider supports the following features:</span></span>

-   <span data-ttu-id="0f609-106">Cadenas ADsPath en formato COM y URL.</span><span class="sxs-lookup"><span data-stu-id="0f609-106">ADsPath strings in both COM and URL format.</span></span> <span data-ttu-id="0f609-107">Por definición, puede recuperar un objeto de Active Directory mediante una ADsPath.</span><span class="sxs-lookup"><span data-stu-id="0f609-107">By definition, you can retrieve an Active Directory object using an ADsPath.</span></span> <span data-ttu-id="0f609-108">Los proveedores admiten la sintaxis que su servicio de directorio requiere mediante la implementación de **ParseDisplayName** .</span><span class="sxs-lookup"><span data-stu-id="0f609-108">Providers support the syntax that their directory service requires using the **ParseDisplayName** implementation.</span></span>
-   <span data-ttu-id="0f609-109">Un objeto de espacio de nombres de nivel superior que admite [**IParseDisplayName::P arsedisplayname**](/windows/win32/api/oleidl/nf-oleidl-iparsedisplayname-parsedisplayname) y [**IADsOpenDSObject**](/windows/desktop/api/Iads/nn-iads-iadsopendsobject).</span><span class="sxs-lookup"><span data-stu-id="0f609-109">A top-level Namespace object that supports [**IParseDisplayName::ParseDisplayName**](/windows/win32/api/oleidl/nf-oleidl-iparsedisplayname-parsedisplayname) and [**IADsOpenDSObject**](/windows/desktop/api/Iads/nn-iads-iadsopendsobject).</span></span> <span data-ttu-id="0f609-110">Este objeto contiene los nodos raíz de este espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="0f609-110">This object contains the root nodes for this namespace.</span></span> <span data-ttu-id="0f609-111">Una parte de la implementación de **ParseDisplayName** debe incluir un analizador que compruebe si hay errores de sintaxis para su propio espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="0f609-111">Part of the **ParseDisplayName** implementation must include a parser that checks for syntax errors for its own namespace.</span></span> <span data-ttu-id="0f609-112">Este objeto también debe ser compatible con [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) y **IADsOpenDSObject**.</span><span class="sxs-lookup"><span data-stu-id="0f609-112">This object must also support [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) and **IADsOpenDSObject**.</span></span>
-   <span data-ttu-id="0f609-113">La interfaz [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) .</span><span class="sxs-lookup"><span data-stu-id="0f609-113">The [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) interface.</span></span> <span data-ttu-id="0f609-114">Esto incluye una implementación de caché de propiedades simple a través de [**IADs:: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) y [**IADs:: SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo).</span><span class="sxs-lookup"><span data-stu-id="0f609-114">This includes a simple property cache implementation through [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) and [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo).</span></span> <span data-ttu-id="0f609-115">Las operaciones que obtienen o establecen propiedades de objeto se producen en el modo de almacenamiento en caché.</span><span class="sxs-lookup"><span data-stu-id="0f609-115">Operations that get or set object properties occur in cached mode.</span></span> <span data-ttu-id="0f609-116">Los valores de caché se escriben en el almacén de directorios subyacente durante **:: SetInfo**.</span><span class="sxs-lookup"><span data-stu-id="0f609-116">Cache values are written to the underlying directory store during **IADs::SetInfo**.</span></span> <span data-ttu-id="0f609-117">Sin embargo, un método ADSI no se almacena en caché, pero se ejecuta inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="0f609-117">An ADSI method, however, is not cached, but executes immediately.</span></span>
-   <span data-ttu-id="0f609-118">Las interfaces [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist), [**IADsPropertyEntry**](/windows/desktop/api/Iads/nn-iads-iadspropertyentry) y [**IADsPropertyValue**](/windows/desktop/api/Iads/nn-iads-iadspropertyvalue) para tener acceso directamente a las propiedades y enumerarlas en la caché de propiedades.</span><span class="sxs-lookup"><span data-stu-id="0f609-118">The [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist), [**IADsPropertyEntry**](/windows/desktop/api/Iads/nn-iads-iadspropertyentry) and [**IADsPropertyValue**](/windows/desktop/api/Iads/nn-iads-iadspropertyvalue) interfaces for directly accessing and enumerating the properties in the property cache.</span></span> <span data-ttu-id="0f609-119">En el caso de los servicios de directorio que no exponen un esquema, esta interfaz permite manipular las propiedades de un objeto.</span><span class="sxs-lookup"><span data-stu-id="0f609-119">For directory services that do not expose a schema, this interface allows you to manipulate the properties of an object.</span></span>
-   <span data-ttu-id="0f609-120">La interfaz [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) para los clientes que no son de automatización.</span><span class="sxs-lookup"><span data-stu-id="0f609-120">The [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) interface for non-Automation clients.</span></span> <span data-ttu-id="0f609-121">Utiliza el Protocolo por cable para obtener el máximo rendimiento y omite la memoria caché de propiedades.</span><span class="sxs-lookup"><span data-stu-id="0f609-121">This uses over-the-wire protocol for maximum performance and bypasses the property cache.</span></span>
-   <span data-ttu-id="0f609-122">Interfaz [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) .</span><span class="sxs-lookup"><span data-stu-id="0f609-122">The [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) interface.</span></span> <span data-ttu-id="0f609-123">Cada Active Directory objeto tiene un contenedor primario que controla su duración.</span><span class="sxs-lookup"><span data-stu-id="0f609-123">Every Active Directory object has a parent container that controls its lifetime.</span></span> <span data-ttu-id="0f609-124">Tenga en cuenta que para los objetos contenedores de ADs, [**IADs:: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) solo afecta a las propiedades del contenedor y no a su contenido.</span><span class="sxs-lookup"><span data-stu-id="0f609-124">Be aware that for ADs container objects, [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) affects only the container properties and not its contents.</span></span> <span data-ttu-id="0f609-125">La propiedad SetInfo en los objetos contenedores de ADs solo afecta a las propiedades del contenedor y no afecta a los objetos recién creados u objetos que ya existen dentro del contenedor.</span><span class="sxs-lookup"><span data-stu-id="0f609-125">SetInfo on ADs container objects affects only the container properties and does not affect newly created objects or objects that already exist within the container.</span></span>
-   <span data-ttu-id="0f609-126">Interfaz [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) .</span><span class="sxs-lookup"><span data-stu-id="0f609-126">The [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) interface.</span></span> <span data-ttu-id="0f609-127">Esta es la interfaz de automatización para lenguajes como Visual Basic Scripting Edition, que no utilizan el enlace en tiempo de compilación.</span><span class="sxs-lookup"><span data-stu-id="0f609-127">This is the Automation interface for languages like Visual Basic Scripting Edition, that do not use compile-time binding.</span></span> <span data-ttu-id="0f609-128">Relacionado con esto, se trata de los datos de la biblioteca de tipos que un proveedor debe proporcionar.</span><span class="sxs-lookup"><span data-stu-id="0f609-128">Related to this is the type library data that a provider must supply.</span></span> <span data-ttu-id="0f609-129">Para obtener más información, vea [problemas de implementación para proveedores ADSI](implementation-issues-for-adsi-providers.md).</span><span class="sxs-lookup"><span data-stu-id="0f609-129">For more information, see [Implementation Issues for ADSI Providers](implementation-issues-for-adsi-providers.md).</span></span>
-   <span data-ttu-id="0f609-130">Un objeto contenedor de clase de esquema y los objetos de sintaxis, propiedad y clase de esquema adecuados que admiten [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax), [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty)y [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass) , respectivamente.</span><span class="sxs-lookup"><span data-stu-id="0f609-130">A schema class container object and the appropriate syntax, property, and schema class objects that support [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax), [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty), and [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass) respectively.</span></span> <span data-ttu-id="0f609-131">Como mínimo, cada nodo raíz debe contener su propio objeto contenedor de clase de esquema.</span><span class="sxs-lookup"><span data-stu-id="0f609-131">At a minimum, each root node must contain its own schema class container object.</span></span>
-   <span data-ttu-id="0f609-132">La interfaz [**IADsMembers**](/windows/desktop/api/Iads/nn-iads-iadsmembers) , si alguno de los atributos admitidos son colecciones de objetos ADSI, como grupos de seguridad.</span><span class="sxs-lookup"><span data-stu-id="0f609-132">The [**IADsMembers**](/windows/desktop/api/Iads/nn-iads-iadsmembers) interface, if any supported attributes are collections of ADSI objects, such as security groups.</span></span>
-   <span data-ttu-id="0f609-133">La interfaz [**IADsCollection**](/windows/desktop/api/Iads/nn-iads-iadscollection) , si alguno de los atributos admitidos son colecciones del mismo tipo de elemento de directorio con la funcionalidad [**IADsCollection:: Add**](/windows/desktop/api/Iads/nf-iads-iadscollection-add) y [**IADsCollection:: Remove**](/windows/desktop/api/Iads/nf-iads-iadscollection-remove) .</span><span class="sxs-lookup"><span data-stu-id="0f609-133">The [**IADsCollection**](/windows/desktop/api/Iads/nn-iads-iadscollection) interface, if any supported attributes are collections of the same directory element type with [**IADsCollection::Add**](/windows/desktop/api/Iads/nf-iads-iadscollection-add) and [**IADsCollection::Remove**](/windows/desktop/api/Iads/nf-iads-iadscollection-remove) capability.</span></span>
-   <span data-ttu-id="0f609-134">La enumeración **IEnumXXXX** admite todos los objetos de enumerador concretos.</span><span class="sxs-lookup"><span data-stu-id="0f609-134">The **IEnumXXXX** enumeration supports all specific enumerator objects.</span></span>
-   <span data-ttu-id="0f609-135">Rutinas para asignar sintaxis y convertir datos nativos en el tipo de datos [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) .</span><span class="sxs-lookup"><span data-stu-id="0f609-135">Routines to map syntax and convert native data to the [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) data type.</span></span>
-   <span data-ttu-id="0f609-136">Siga las convenciones de ADSI para los objetos ADSI proporcionados por el proveedor.</span><span class="sxs-lookup"><span data-stu-id="0f609-136">Follow ADSI conventions for provider-supplied ADSI objects.</span></span> <span data-ttu-id="0f609-137">Incluir archivos de ayuda y bibliotecas de tipos documentar las propiedades y los métodos de la interfaz.</span><span class="sxs-lookup"><span data-stu-id="0f609-137">Include help files and type libraries documenting the interface properties and methods.</span></span>

<span data-ttu-id="0f609-138">Al igual que con cualquier implementación de COM, las llamadas a [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) deben devolver **e \_ nointerface** para interfaces no implementadas, **e \_ NOTIMPL** para los métodos no implementados de interfaces que, de otro modo, se implementan y devuelven la **propiedad de \_ ADS \_ \_ no \_ admitida** para las propiedades no implementadas.</span><span class="sxs-lookup"><span data-stu-id="0f609-138">As with any COM implementation, calls to [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) must return **E\_NOINTERFACE** for unimplemented interfaces, **E\_NOTIMPL** for unimplemented methods of interfaces that are otherwise implemented and return **E\_ADS\_PROPERTY\_NOT\_SUPPORTED** for unimplemented properties.</span></span> <span data-ttu-id="0f609-139">Para obtener más información sobre las interfaces duales y cómo afectan a la implementación de propiedades, consulte [interfaces duales](dual-interfaces.md).</span><span class="sxs-lookup"><span data-stu-id="0f609-139">For more information about dual interfaces and how they affect property implementation, see [Dual Interfaces](dual-interfaces.md).</span></span>

 

 