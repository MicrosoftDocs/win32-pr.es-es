---
description: Vaciar
ms.assetid: 868218c4-3e1a-4da0-89fa-30a9848da0e8
title: Vaciar
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 575f311020c2c7a567e544b80ba323a29051cc38
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/06/2021
ms.locfileid: "104537953"
---
# <a name="flushing"></a><span data-ttu-id="6b74e-103">Vaciar</span><span class="sxs-lookup"><span data-stu-id="6b74e-103">Flushing</span></span>

<span data-ttu-id="6b74e-104">Mientras se ejecuta el gráfico de filtros, se pueden mover cantidades arbitrarias de datos a través del gráfico.</span><span class="sxs-lookup"><span data-stu-id="6b74e-104">While the filter graph is running, arbitrary amounts of data can be moving through the graph.</span></span> <span data-ttu-id="6b74e-105">Algunos de ellos pueden estar en colas, en espera de ser entregados.</span><span class="sxs-lookup"><span data-stu-id="6b74e-105">Some of it might be in queues, waiting to be delivered.</span></span> <span data-ttu-id="6b74e-106">Hay ocasiones en las que el gráfico de filtros debe quitar estos datos pendientes lo más rápidamente posible y reemplazarlos por datos nuevos.</span><span class="sxs-lookup"><span data-stu-id="6b74e-106">There are times when the filter graph needs to remove this pending data as quickly as possible and replace it with new data.</span></span> <span data-ttu-id="6b74e-107">Después de un comando de búsqueda, por ejemplo, el filtro de origen genera ejemplos a partir de una nueva posición en el origen.</span><span class="sxs-lookup"><span data-stu-id="6b74e-107">After a seek command, for example, the source filter generates samples from a new position in the source.</span></span> <span data-ttu-id="6b74e-108">Para minimizar la latencia, los filtros de nivel inferior deben descartar las muestras que se crearon antes del comando de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="6b74e-108">To minimize latency, downstream filters should discard any samples that were created before the seek command.</span></span> <span data-ttu-id="6b74e-109">El proceso de descartar ejemplos se denomina *vaciado*.</span><span class="sxs-lookup"><span data-stu-id="6b74e-109">The process of discarding samples is called *flushing*.</span></span> <span data-ttu-id="6b74e-110">Permite que el gráfico tenga mayor capacidad de respuesta cuando los eventos modifican el flujo de datos normal.</span><span class="sxs-lookup"><span data-stu-id="6b74e-110">It enables the graph to be more responsive when events alter the normal data flow.</span></span>

<span data-ttu-id="6b74e-111">El modelo de extracción controla de forma ligeramente diferente el vaciado que el modelo de inserción.</span><span class="sxs-lookup"><span data-stu-id="6b74e-111">Flushing is handled slightly differently by the pull model than the push model.</span></span> <span data-ttu-id="6b74e-112">En este artículo se empieza por describir el modelo de envío. a continuación, se describen las diferencias en el modelo de extracción.</span><span class="sxs-lookup"><span data-stu-id="6b74e-112">This article starts by describing the push model; then it describes the differences in the pull model.</span></span>

<span data-ttu-id="6b74e-113">El vaciado se produce en dos fases.</span><span class="sxs-lookup"><span data-stu-id="6b74e-113">Flushing happens in two stages.</span></span>

-   <span data-ttu-id="6b74e-114">En primer lugar, el filtro de origen llama a [**IPin:: BeginFlush**](/windows/desktop/api/Strmif/nf-strmif-ipin-beginflush) en el PIN de entrada del filtro de nivel inferior.</span><span class="sxs-lookup"><span data-stu-id="6b74e-114">First, the source filter calls [**IPin::BeginFlush**](/windows/desktop/api/Strmif/nf-strmif-ipin-beginflush) on the downstream filter's input pin.</span></span> <span data-ttu-id="6b74e-115">El filtro de nivel inferior comienza a rechazar ejemplos de nivel superior.</span><span class="sxs-lookup"><span data-stu-id="6b74e-115">The downstream filter starts rejecting samples from upstream.</span></span> <span data-ttu-id="6b74e-116">También descarta cualquier ejemplo que contiene y envía la llamada **BeginFlush** de nivel inferior al filtro siguiente.</span><span class="sxs-lookup"><span data-stu-id="6b74e-116">It also discards any samples it is holding, and sends the **BeginFlush** call downstream to the next filter.</span></span>
-   <span data-ttu-id="6b74e-117">Cuando el filtro de origen está listo para enviar datos nuevos, llama a [**IPin:: EndFlush**](/windows/desktop/api/Strmif/nf-strmif-ipin-endflush) en el PIN de entrada.</span><span class="sxs-lookup"><span data-stu-id="6b74e-117">When the source filter is ready to send new data, it calls [**IPin::EndFlush**](/windows/desktop/api/Strmif/nf-strmif-ipin-endflush) on the input pin.</span></span> <span data-ttu-id="6b74e-118">Esto indica al filtro de bajada que puede recibir muestras nuevas.</span><span class="sxs-lookup"><span data-stu-id="6b74e-118">This signals the downstream filter that it can receive new samples.</span></span> <span data-ttu-id="6b74e-119">El filtro de nivel inferior envía la llamada **EndFlush** al siguiente filtro.</span><span class="sxs-lookup"><span data-stu-id="6b74e-119">The downstream filter sends the **EndFlush** call to the next filter.</span></span>

<span data-ttu-id="6b74e-120">En el método **BeginFlush** , el PIN de entrada hace lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="6b74e-120">In the **BeginFlush** method, the input pin does the following:</span></span>

1.  <span data-ttu-id="6b74e-121">Llama a **BeginFlush** en clavijas de entrada de nivel inferior.</span><span class="sxs-lookup"><span data-stu-id="6b74e-121">Calls **BeginFlush** on downstream input pins.</span></span>
2.  <span data-ttu-id="6b74e-122">Rechaza las llamadas posteriores que transmiten los datos, incluidos **Receive** y **EndOfStream**.</span><span class="sxs-lookup"><span data-stu-id="6b74e-122">Rejects any further calls that stream data, including **Receive** and **EndOfStream**.</span></span>
3.  <span data-ttu-id="6b74e-123">Desbloquea todos los filtros ascendentes que están bloqueados en espera de una muestra del asignador del filtro.</span><span class="sxs-lookup"><span data-stu-id="6b74e-123">Unblocks any upstream filters that are blocked waiting for a sample from the filter's allocator.</span></span> <span data-ttu-id="6b74e-124">Algunos filtros anulan la confirmación de los asignadores para este fin.</span><span class="sxs-lookup"><span data-stu-id="6b74e-124">Some filters decommit their allocators for this purpose.</span></span>
4.  <span data-ttu-id="6b74e-125">Sale de cualquier espera que bloquee el flujo.</span><span class="sxs-lookup"><span data-stu-id="6b74e-125">Exits from any waits that block streaming.</span></span> <span data-ttu-id="6b74e-126">Por ejemplo, los filtros de representador se bloquean cuando están en pausa.</span><span class="sxs-lookup"><span data-stu-id="6b74e-126">For example, renderer filters block when paused.</span></span> <span data-ttu-id="6b74e-127">También se bloquean cuando están a la espera de representar una muestra en el momento de la secuencia correcta.</span><span class="sxs-lookup"><span data-stu-id="6b74e-127">They also block when they are waiting to render a sample at the correct stream time.</span></span> <span data-ttu-id="6b74e-128">El filtro debe desbloquearse, de modo que se puedan entregar y rechazar los ejemplos en cola de nivel superior.</span><span class="sxs-lookup"><span data-stu-id="6b74e-128">The filter must unblock, so that samples queued upstream can be delivered and rejected.</span></span> <span data-ttu-id="6b74e-129">Este paso garantiza que todos los filtros ascendentes se desbloqueen.</span><span class="sxs-lookup"><span data-stu-id="6b74e-129">This step ensures that all upstream filters eventually unblock.</span></span>

<span data-ttu-id="6b74e-130">En el método **EndFlush** , el PIN de entrada hace lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="6b74e-130">In the **EndFlush** method, the input pin does the following:</span></span>

1.  <span data-ttu-id="6b74e-131">Espera a que se descarten todas las muestras en cola.</span><span class="sxs-lookup"><span data-stu-id="6b74e-131">Waits for all queued samples to be discarded.</span></span>
2.  <span data-ttu-id="6b74e-132">Libera los datos almacenados en búfer.</span><span class="sxs-lookup"><span data-stu-id="6b74e-132">Frees any buffered data.</span></span> <span data-ttu-id="6b74e-133">En ocasiones, este paso se puede realizar en el método **BeginFlush** .</span><span class="sxs-lookup"><span data-stu-id="6b74e-133">This step can sometimes be performed in the **BeginFlush** method.</span></span> <span data-ttu-id="6b74e-134">Sin embargo, **BeginFlush** no está sincronizado con el subproceso de streaming.</span><span class="sxs-lookup"><span data-stu-id="6b74e-134">However, **BeginFlush** is not synchronized with the streaming thread.</span></span> <span data-ttu-id="6b74e-135">El filtro no debe procesar ni almacenar en búfer más datos entre la llamada a **BeginFlush** y la llamada a **EndFlush**.</span><span class="sxs-lookup"><span data-stu-id="6b74e-135">The filter must not process or buffer any more data between the call to **BeginFlush** and the call to **EndFlush**.</span></span>
3.  <span data-ttu-id="6b74e-136">Borra todas las \_ notificaciones completas de EC pendientes.</span><span class="sxs-lookup"><span data-stu-id="6b74e-136">Clears any pending EC\_COMPLETE notifications.</span></span>
4.  <span data-ttu-id="6b74e-137">Llama a **EndFlush** downstream.</span><span class="sxs-lookup"><span data-stu-id="6b74e-137">Calls **EndFlush** downstream.</span></span>

<span data-ttu-id="6b74e-138">En este momento, el filtro puede aceptar los ejemplos de nuevo.</span><span class="sxs-lookup"><span data-stu-id="6b74e-138">At this point, the filter can accept samples again.</span></span> <span data-ttu-id="6b74e-139">Se garantiza que todos los ejemplos son más recientes que el vaciado.</span><span class="sxs-lookup"><span data-stu-id="6b74e-139">All samples are guaranteed to be more recent than the flush.</span></span>

<span data-ttu-id="6b74e-140">En el modelo de extracción, el filtro del analizador inicia el vaciado, en lugar del filtro de origen.</span><span class="sxs-lookup"><span data-stu-id="6b74e-140">In the pull model, the parser filter initiates flushing, rather than the source filter.</span></span> <span data-ttu-id="6b74e-141">No solo llama a **IPin:: BeginFlush** y **IPin:: EndFlush** en el filtro de nivel inferior, sino que también llama a [**IAsyncReader:: BeginFlush**](/windows/desktop/api/Strmif/nf-strmif-iasyncreader-beginflush) y [**IAsyncReader:: EndFlush**](/windows/desktop/api/Strmif/nf-strmif-iasyncreader-endflush) en el PIN de *salida* del filtro de origen.</span><span class="sxs-lookup"><span data-stu-id="6b74e-141">Not only does it call **IPin::BeginFlush** and **IPin::EndFlush** on the downstream filter, it also calls [**IAsyncReader::BeginFlush**](/windows/desktop/api/Strmif/nf-strmif-iasyncreader-beginflush) and [**IAsyncReader::EndFlush**](/windows/desktop/api/Strmif/nf-strmif-iasyncreader-endflush) on the *output* pin of the source filter.</span></span> <span data-ttu-id="6b74e-142">Si el filtro de origen tiene solicitudes de lectura pendientes, se descartarán.</span><span class="sxs-lookup"><span data-stu-id="6b74e-142">If the source filter has pending read requests, it will discard them.</span></span>

## <a name="related-topics"></a><span data-ttu-id="6b74e-143">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="6b74e-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="6b74e-144">Vaciar datos</span><span class="sxs-lookup"><span data-stu-id="6b74e-144">Flushing Data</span></span>](flushing-data.md)
</dt> </dl>

 

 



