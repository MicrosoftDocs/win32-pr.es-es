---
title: Transacción de autenticación DLL de seguridad de RAS
description: El servidor RAS de Windows NT/Windows 2000 llama a la función RasSecurityDialogBegin del archivo DLL de seguridad para iniciar la autenticación de un usuario remoto.
ms.assetid: e6549812-d906-4163-b9c8-86f8f1cb1ad3
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 109f6ad5cd3d7b76e30db099a478ffaf562feb32
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104533429"
---
# <a name="ras-security-dll-authentication-transaction"></a><span data-ttu-id="5cbce-103">Transacción de autenticación DLL de seguridad de RAS</span><span class="sxs-lookup"><span data-stu-id="5cbce-103">RAS Security DLL Authentication Transaction</span></span>

<span data-ttu-id="5cbce-104">El servidor RAS de Windows NT/Windows 2000 llama a la función [**RasSecurityDialogBegin**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogbegin) del archivo dll de seguridad para iniciar la autenticación de un usuario remoto.</span><span class="sxs-lookup"><span data-stu-id="5cbce-104">Windows NT/Windows 2000 RAS server calls the security DLL's [**RasSecurityDialogBegin**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogbegin) function to begin an authentication of a remote user.</span></span> <span data-ttu-id="5cbce-105">El servidor RAS está bloqueado y no puede aceptar ninguna otra llamada hasta que **RasSecurityDialogBegin** devuelve.</span><span class="sxs-lookup"><span data-stu-id="5cbce-105">The RAS server is blocked and cannot accept any other calls until **RasSecurityDialogBegin** returns.</span></span> <span data-ttu-id="5cbce-106">Por esta razón, **RasSecurityDialogBegin** debe copiar los parámetros de entrada, crear un subproceso para realizar la autenticación y volver lo más rápido posible.</span><span class="sxs-lookup"><span data-stu-id="5cbce-106">For this reason, **RasSecurityDialogBegin** should copy the input parameters, create a thread to perform the authentication, and return as quickly as possible.</span></span>

<span data-ttu-id="5cbce-107">El subproceso creado por el archivo DLL de seguridad utiliza las funciones [**RasSecurityDialogSend**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogsend) y [**RasSecurityDialogReceive**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogreceive) para comunicarse con el equipo remoto.</span><span class="sxs-lookup"><span data-stu-id="5cbce-107">The thread created by the security DLL uses the [**RasSecurityDialogSend**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogsend) and [**RasSecurityDialogReceive**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogreceive) functions to communicate with the remote computer.</span></span> <span data-ttu-id="5cbce-108">Estas funciones no están disponibles para la importación estática desde cualquier biblioteca.</span><span class="sxs-lookup"><span data-stu-id="5cbce-108">These functions are not available for static import from any library.</span></span> <span data-ttu-id="5cbce-109">En su lugar, el archivo DLL de seguridad debe utilizar las funciones [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) y [**GetProcAddress**](/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress) para vincular dinámicamente a estas funciones en RASMAN.DLL.</span><span class="sxs-lookup"><span data-stu-id="5cbce-109">Instead, the security DLL must use the [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) and [**GetProcAddress**](/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress) functions to dynamically link to these functions in RASMAN.DLL.</span></span>

<span data-ttu-id="5cbce-110">Durante una transacción de autenticación, el administrador de conexiones RAS del equipo remoto muestra una ventana de terminal.</span><span class="sxs-lookup"><span data-stu-id="5cbce-110">During an authentication transaction, the RAS connection manager on the remote computer displays a terminal window.</span></span> <span data-ttu-id="5cbce-111">El subproceso del archivo DLL de seguridad llama a [**RasSecurityDialogSend**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogsend) para enviar un mensaje que se mostrará en la ventana de terminal.</span><span class="sxs-lookup"><span data-stu-id="5cbce-111">The thread of the security DLL calls [**RasSecurityDialogSend**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogsend) to send a message to display in the terminal window.</span></span> <span data-ttu-id="5cbce-112">A continuación, el subproceso llama a [**RasSecurityDialogReceive**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogreceive) para recibir la entrada que el usuario remoto escribe en la ventana de terminal.</span><span class="sxs-lookup"><span data-stu-id="5cbce-112">The thread then calls [**RasSecurityDialogReceive**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogreceive) to receive the input that the remote user types in the terminal window.</span></span> <span data-ttu-id="5cbce-113">El subproceso puede realizar cualquier número de llamadas a **RasSecurityDialogSend** , con cada llamada seguida de una llamada a **RasSecurityDialogReceive** .</span><span class="sxs-lookup"><span data-stu-id="5cbce-113">The thread can make any number of **RasSecurityDialogSend** calls, with each call followed by a **RasSecurityDialogReceive** call.</span></span> <span data-ttu-id="5cbce-114">Después de cada llamada a **RasSecurityDialogReceive**, el subproceso debe llamar a una de las funciones de espera, como [**WaitForSingleObject**](/windows/win32/api/synchapi/nf-synchapi-waitforsingleobject), para esperar a que se completen las operaciones asincrónicas de envío y recepción.</span><span class="sxs-lookup"><span data-stu-id="5cbce-114">After each call to **RasSecurityDialogReceive**, the thread must call one of the wait functions, such as [**WaitForSingleObject**](/windows/win32/api/synchapi/nf-synchapi-waitforsingleobject), to wait for the asynchronous send and receive operations to be completed.</span></span> <span data-ttu-id="5cbce-115">El servidor RAS indica un objeto de evento cuando se ha completado la operación de recepción o cuando ha transcurrido un intervalo de tiempo de espera opcional.</span><span class="sxs-lookup"><span data-stu-id="5cbce-115">The RAS server signals an event object when the receive operation has been completed or when an optional time-out interval has elapsed.</span></span>

<span data-ttu-id="5cbce-116">Cuando el subproceso ha terminado de autenticar al usuario remoto, llama a la función [**RasSecurityDialogComplete**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogcomplete) .</span><span class="sxs-lookup"><span data-stu-id="5cbce-116">When the thread has finished authenticating the remote user, it calls the [**RasSecurityDialogComplete**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogcomplete) function.</span></span> <span data-ttu-id="5cbce-117">Esta llamada pasa una estructura de [**\_ mensajes de seguridad**](/windows/desktop/api/Rasshost/ns-rasshost-security_message) que contiene los resultados de la transacción de autenticación al servidor RAS.</span><span class="sxs-lookup"><span data-stu-id="5cbce-117">This call passes a [**SECURITY\_MESSAGE**](/windows/desktop/api/Rasshost/ns-rasshost-security_message) structure containing the results of the authentication transaction to the RAS server.</span></span> <span data-ttu-id="5cbce-118">A continuación, el servidor RAS realiza una secuencia de limpieza que incluye una llamada a la función [**RasSecurityDialogEnd**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogend) del archivo dll.</span><span class="sxs-lookup"><span data-stu-id="5cbce-118">The RAS server then performs a cleanup sequence that includes a call to the DLL's [**RasSecurityDialogEnd**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogend) function.</span></span> <span data-ttu-id="5cbce-119">Esto proporciona al archivo DLL de seguridad una oportunidad para realizar cualquier limpieza necesaria.</span><span class="sxs-lookup"><span data-stu-id="5cbce-119">This gives the security DLL an opportunity to perform any necessary cleanup.</span></span>

<span data-ttu-id="5cbce-120">El archivo DLL de seguridad puede llamar a la función [**RasSecurityDialogGetInfo**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialoggetinfo) para recuperar información sobre el puerto asociado a una transacción de autenticación.</span><span class="sxs-lookup"><span data-stu-id="5cbce-120">The security DLL can call the [**RasSecurityDialogGetInfo**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialoggetinfo) function to retrieve information about the port associated with an authentication transaction.</span></span> <span data-ttu-id="5cbce-121">**RasSecurityDialogGetInfo** rellena una estructura de [**\_ \_ información de seguridad de Ras**](/windows/desktop/api/Rasshost/ns-rasshost-ras_security_info) que indica el estado de la última llamada a [**RasSecurityDialogReceive**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogreceive) para el puerto.</span><span class="sxs-lookup"><span data-stu-id="5cbce-121">**RasSecurityDialogGetInfo** fills in a [**RAS\_SECURITY\_INFO**](/windows/desktop/api/Rasshost/ns-rasshost-ras_security_info) structure that indicates the state of the last [**RasSecurityDialogReceive**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogreceive) call for the port.</span></span>

 

 