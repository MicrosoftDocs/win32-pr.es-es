---
description: El servicio de activación Just-in-Time (JIT) permite a COM+ desactivar un objeto mientras un cliente todavía mantiene una referencia activa a ese objeto.
ms.assetid: dbc7b257-8506-42c8-8a78-3474c6d4f4b6
title: Conceptos de activación Just-in-Time de COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6c942bfeb342ea305083e0c7d7ebdea2fe96bf24
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "105714801"
---
# <a name="com-just-in-time-activation-concepts"></a><span data-ttu-id="5317b-103">Conceptos de activación Just-in-Time de COM+</span><span class="sxs-lookup"><span data-stu-id="5317b-103">COM+ Just-in-Time Activation Concepts</span></span>

<span data-ttu-id="5317b-104">El servicio de activación Just-in-Time (JIT) permite a COM+ desactivar un objeto mientras un cliente todavía mantiene una referencia activa a ese objeto.</span><span class="sxs-lookup"><span data-stu-id="5317b-104">The just-in-time (JIT) activation service enables COM+ to deactivate an object while a client still holds an active reference to that object.</span></span> <span data-ttu-id="5317b-105">La próxima vez que el cliente llame a un método en el objeto, que el cliente considera que sigue activo, el servicio de activación JIT de COM+ reactiva el objeto de forma transparente para el cliente, justo a tiempo.</span><span class="sxs-lookup"><span data-stu-id="5317b-105">The next time the client calls a method on the object, which the client believes to be still active, the COM+ JIT activation service reactivates the object transparently to the client, just in time.</span></span>

<span data-ttu-id="5317b-106">La principal ventaja de utilizar la activación COM + JIT es que puede permitir que los clientes mantengan referencias a objetos mientras los necesiten, sin necesidad de disponer de recursos de servidor valiosos, como la memoria.</span><span class="sxs-lookup"><span data-stu-id="5317b-106">The main advantage of using COM + JIT activation is that you can enable clients to hold references to objects for as long as they need them, without necessarily tying up valuable server resources such as memory.</span></span> <span data-ttu-id="5317b-107">Otras ventajas importantes son las siguientes:</span><span class="sxs-lookup"><span data-stu-id="5317b-107">Other important benefits include the following:</span></span>

-   <span data-ttu-id="5317b-108">El uso del servicio de activación JIT de COM+ simplifica en gran medida el modelo de programación del cliente porque el cliente no tiene que pensar en cómo utiliza los recursos de servidor y los objetos de servidor costosos.</span><span class="sxs-lookup"><span data-stu-id="5317b-108">Using the COM+ JIT activation service greatly simplifies the programming model for the client because the client doesn't have to think about how it uses expensive server objects and server resources.</span></span> <span data-ttu-id="5317b-109">Sin la activación JIT, los clientes pueden suponer una penalización significativa cuando suelen necesitar llamar a los objetos y liberarlos.</span><span class="sxs-lookup"><span data-stu-id="5317b-109">Without JIT activation, clients can incur a significant penalty when they frequently need to call and release objects.</span></span>
    > [!Note]  
    > <span data-ttu-id="5317b-110">Puede perfeccionar aún más esta ventaja de rendimiento mediante el servicio de [agrupación de objetos com+](com--object-pooling.md) .</span><span class="sxs-lookup"><span data-stu-id="5317b-110">You can refine this performance benefit further by using the [COM+ Object Pooling](com--object-pooling.md) service.</span></span> <span data-ttu-id="5317b-111">Al agrupar los objetos activados en JIT, puede acelerar considerablemente la reactivación de objetos para los clientes mientras se reutilizan los recursos que puedan contener, lo que le proporciona un control más preciso sobre la cantidad de memoria que utiliza un objeto determinado en el servidor.</span><span class="sxs-lookup"><span data-stu-id="5317b-111">By pooling JIT-activated objects, you can greatly speed object reactivation for clients while reusing whatever resources they might be holding, giving you more precise control over how much memory is used by a given object on the server.</span></span> <span data-ttu-id="5317b-112">Para obtener más información, consulte [agrupación de objetos y activación JIT de com+](object-pooling-and-com--jit-activation.md).</span><span class="sxs-lookup"><span data-stu-id="5317b-112">For more detail, see [Object Pooling and COM+ JIT Activation](object-pooling-and-com--jit-activation.md).</span></span>

     

-   <span data-ttu-id="5317b-113">Con las aplicaciones distribuidas, se requiere un ciclo de ida y vuelta de red costoso para la creación de todos los objetos, y cuanto más lejos es el cliente del servidor, mayores son los costos de activar y calcular las referencias del objeto de servidor, abrir el canal y configurar el proxy y el código auxiliar.</span><span class="sxs-lookup"><span data-stu-id="5317b-113">With distributed applications, an expensive network round-trip is required for the creation of every object, and the farther the client is from the server, the greater the costs of activating and marshaling the server object, opening the channel, and setting up the proxy and stub.</span></span> <span data-ttu-id="5317b-114">Mediante el servicio de activación JIT de COM+, puede minimizar la frecuencia de creación de objetos para mejorar significativamente el rendimiento de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="5317b-114">By using the COM+ JIT activation service, you can minimize the frequency of object creation to significantly improve the performance of your application.</span></span>
-   <span data-ttu-id="5317b-115">Cuando se usa la activación JIT de COM+ para activar los objetos en los que los clientes contienen referencias de larga duración, pero que no tienen que usar todo el tiempo, la memoria del servidor no siempre está ligada al mantenimiento de los objetos activos.</span><span class="sxs-lookup"><span data-stu-id="5317b-115">When you use COM+ JIT activation to activate those objects to which clients hold long-lived references but which they aren't necessarily using all the time, server memory is not always tied up keeping those objects alive.</span></span> <span data-ttu-id="5317b-116">Esto puede aumentar significativamente la escalabilidad de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="5317b-116">This can significantly increase the scalability of your application.</span></span> <span data-ttu-id="5317b-117">El único impacto en el rendimiento que los clientes ven es el tiempo que tarda COM+ en reactivar el objeto, por lo general, con un margen de tiempo mayor que el necesario para asignar memoria para el objeto y menos sustancialmente que el recorrido de ida y vuelta de red para la creación de objetos remotos.</span><span class="sxs-lookup"><span data-stu-id="5317b-117">The only performance hit that clients see is the time it takes COM+ to reactivate the object, usually just marginally more time than it takes to allocate memory for the object and substantially less than the network round-trip for remote object creation.</span></span>

## <a name="enabling-com-jit-activation"></a><span data-ttu-id="5317b-118">Habilitación de la activación JIT de COM+</span><span class="sxs-lookup"><span data-stu-id="5317b-118">Enabling COM+ JIT Activation</span></span>

<span data-ttu-id="5317b-119">Puede habilitar el servicio de activación JIT de COM+ para un componente mediante la herramienta administrativa Servicios de componentes o las funciones administrativas.</span><span class="sxs-lookup"><span data-stu-id="5317b-119">You can enable the COM+ JIT activation service for a component by using either the Component Services administrative tool or the Administrative functions.</span></span> <span data-ttu-id="5317b-120">Para obtener más información sobre cómo hacerlo, vea [Habilitar la activación JIT para un componente](enabling-jit-activation-for-a-component.md).</span><span class="sxs-lookup"><span data-stu-id="5317b-120">For details about how to do this, see [Enabling JIT Activation for a Component](enabling-jit-activation-for-a-component.md).</span></span>

<span data-ttu-id="5317b-121">La activación JIT de COM+ puede interactuar con otros servicios COM+, como los siguientes:</span><span class="sxs-lookup"><span data-stu-id="5317b-121">COM+ JIT activation can interact with other COM+ services, such as the following:</span></span>

-   <span data-ttu-id="5317b-122">Cuando el componente requiere transacciones, la activación JIT se habilita automáticamente.</span><span class="sxs-lookup"><span data-stu-id="5317b-122">When your component requires transactions, JIT activation is automatically enabled for it.</span></span> <span data-ttu-id="5317b-123">Para obtener más detalles, consulte [transacciones y activación JIT de com+](transactions-and-com--jit-activation.md).</span><span class="sxs-lookup"><span data-stu-id="5317b-123">For greater detail, see [Transactions and COM+ JIT Activation](transactions-and-com--jit-activation.md).</span></span>
-   <span data-ttu-id="5317b-124">Cuando el componente está habilitado para la activación JIT, la sincronización se establece automáticamente en requerido.</span><span class="sxs-lookup"><span data-stu-id="5317b-124">When your component is enabled for JIT activation, synchronization is automatically set to required.</span></span> <span data-ttu-id="5317b-125">Esto significa que, si dos clientes llaman simultáneamente a un componente activado en JIT y una llamada al método para uno de ellos devuelven, lo que provoca que el objeto se desactive, el otro no se deja en desuso.</span><span class="sxs-lookup"><span data-stu-id="5317b-125">This means that if two clients simultaneously call a JIT-activated component and a method call for one of them returns, causing the object to be deactivated, the other is not left stranded.</span></span>

## <a name="how-deactivation-is-triggered"></a><span data-ttu-id="5317b-126">Cómo se desencadena la desactivación</span><span class="sxs-lookup"><span data-stu-id="5317b-126">How Deactivation Is Triggered</span></span>

<span data-ttu-id="5317b-127">COM+ desactiva un objeto basándose en el estado del bit de realización en el contexto del objeto.</span><span class="sxs-lookup"><span data-stu-id="5317b-127">COM+ deactivates an object based on the status of the doneness bit on the object context.</span></span> <span data-ttu-id="5317b-128">El objeto puede utilizar este bit para indicar si se ha hecho, es decir, está listo para desactivarse, durante una llamada al método determinado.</span><span class="sxs-lookup"><span data-stu-id="5317b-128">Your object can use this bit to signal whether it is done—that is, ready to be deactivated—during a given method call.</span></span> <span data-ttu-id="5317b-129">Para obtener más información, vea [establecer el bit Done](setting-the-done-bit.md).</span><span class="sxs-lookup"><span data-stu-id="5317b-129">For more information, see [Setting the Done Bit](setting-the-done-bit.md).</span></span>

## <a name="using-the-auto-done-property"></a><span data-ttu-id="5317b-130">Usar la propiedad auto-Done</span><span class="sxs-lookup"><span data-stu-id="5317b-130">Using the Auto-Done Property</span></span>

<span data-ttu-id="5317b-131">Con la herramienta administrativa Servicios de componentes, puede configurar un método de forma que el objeto se desactive automáticamente en la devolución del método.</span><span class="sxs-lookup"><span data-stu-id="5317b-131">Using the Component Services administrative tool, you can configure a method such that the object is automatically deactivated on method return.</span></span> <span data-ttu-id="5317b-132">(Vea [Habilitar auto-Done para un método](enabling-auto-done-for-a-method.md) para obtener instrucciones sobre cómo establecer esta propiedad). Al seleccionar esta opción, puede eliminar las llamadas de método repetitivas para votar en transacciones.</span><span class="sxs-lookup"><span data-stu-id="5317b-132">(See [Enabling Auto-Done for a Method](enabling-auto-done-for-a-method.md) for instructions about how to set this property.) By selecting this option, you can eliminate the repetitive method calls for voting in transactions.</span></span> <span data-ttu-id="5317b-133">Dado que la configuración predeterminada para el bit de coherencia es true, si ha cambiado el bit Done a true también y no realiza ninguna acción para cambiar esta configuración, se llama a [**IObjectContext:: SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) automáticamente después de que el método devuelva un valor.</span><span class="sxs-lookup"><span data-stu-id="5317b-133">Because the default setting for the consistency bit is True, if you have changed the done bit to True as well and you take no action to change these settings, [**IObjectContext::SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) is called automatically after the method returns.</span></span>

<span data-ttu-id="5317b-134">Sin embargo, hay una advertencia en este comportamiento: COM+ examinará el valor HRESULT que devuelve el método.</span><span class="sxs-lookup"><span data-stu-id="5317b-134">However, there is one caveat to this behavior: COM+ will examine the HRESULT that the method returns.</span></span> <span data-ttu-id="5317b-135">Si ese HRESULT indica un error, el bit de coherencia se establece en false y el resultado es el mismo que si hubiera llamado a [**IObjectContext:: SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort).</span><span class="sxs-lookup"><span data-stu-id="5317b-135">If that HRESULT indicates failure, the consistency bit is set to False and the result is the same as if you had called [**IObjectContext::SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort).</span></span>

<span data-ttu-id="5317b-136">En Resumen, si selecciona auto-Done para un método y no realiza ninguna acción para establecer bits, y si se devuelve un valor HRESULT (HR), se aplica lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="5317b-136">To summarize, if you select auto-done for a method and don't take any action to set any bits, and if an HRESULT(hr) is returned, the following applies:</span></span>

-   <span data-ttu-id="5317b-137">Si se realiza correctamente (HR), es como si se llamase a [**SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete).</span><span class="sxs-lookup"><span data-stu-id="5317b-137">If SUCCEEDS(hr), it is as though you called [**SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete).</span></span>
-   <span data-ttu-id="5317b-138">Si se produce un error (HR), es como si hubiera llamado a [**SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort).</span><span class="sxs-lookup"><span data-stu-id="5317b-138">If FAILED(hr), it is as though you called [**SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort).</span></span>

## <a name="using-iobjectcontrol-to-manage-object-activation-and-deactivation"></a><span data-ttu-id="5317b-139">Usar IObjectControl para administrar la activación y desactivación de objetos</span><span class="sxs-lookup"><span data-stu-id="5317b-139">Using IObjectControl to Manage Object Activation and Deactivation</span></span>

<span data-ttu-id="5317b-140">Puede implementar la interfaz [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol) para que el tiempo de ejecución de com+ Administre automáticamente la desactivación y reactivación de los objetos.</span><span class="sxs-lookup"><span data-stu-id="5317b-140">You can implement the [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol) interface so that the COM+ runtime automatically manages deactivation and reactivation for your objects.</span></span> <span data-ttu-id="5317b-141">Cuando un objeto implementa esta interfaz, COM+ llama a [**IObjectControl::D eactivate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate) cuando desactiva el objeto y [**IObjectControl:: Activate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) cuando lo vuelve a activar.</span><span class="sxs-lookup"><span data-stu-id="5317b-141">When an object implements this interface, COM+ calls [**IObjectControl::Deactivate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate) when it deactivates the object and [**IObjectControl::Activate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) when it reactivates it.</span></span> <span data-ttu-id="5317b-142">Estos métodos permiten la inicialización de contexto automática en la activación de objetos y la limpieza del estado durante la desactivación.</span><span class="sxs-lookup"><span data-stu-id="5317b-142">These methods enable automatic context initialization on object activation and cleanup of state on deactivation.</span></span>

<span data-ttu-id="5317b-143">Si está agrupando objetos que utilizan la activación JIT de COM+, se recomienda encarecidamente implementar [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol).</span><span class="sxs-lookup"><span data-stu-id="5317b-143">If you are pooling objects that use COM+ JIT activation, it is highly recommended that you implement [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol).</span></span> <span data-ttu-id="5317b-144">Para obtener más información, consulte [agrupación de objetos y activación JIT de com+](object-pooling-and-com--jit-activation.md).</span><span class="sxs-lookup"><span data-stu-id="5317b-144">For more detail, see [Object Pooling and COM+ JIT Activation](object-pooling-and-com--jit-activation.md).</span></span>

## <a name="statelessness-and-jit-activation"></a><span data-ttu-id="5317b-145">Estados y activación JIT</span><span class="sxs-lookup"><span data-stu-id="5317b-145">Statelessness and JIT Activation</span></span>

<span data-ttu-id="5317b-146">Los objetos transaccionales no tienen estado necesariamente porque no se puede compartir el estado a través de un límite de transacción.</span><span class="sxs-lookup"><span data-stu-id="5317b-146">Transactional objects are necessarily stateless because you cannot share state across a transaction boundary.</span></span> <span data-ttu-id="5317b-147">Por lo tanto, solo se usaría la activación JIT si el objeto no tiene ningún Estado que se perdería en la desactivación; de lo contrario, se infringe el aislamiento de las transacciones.</span><span class="sxs-lookup"><span data-stu-id="5317b-147">Therefore, you would use JIT activation only when your object holds no state that would be lost on deactivation; otherwise, you violate the isolation of the transactions.</span></span> <span data-ttu-id="5317b-148">Debido a los patrones de uso natural de los objetos transaccionales, realizan alguna unidad de trabajo y liberan el objeto cuando la transacción se confirma o se anula: la activación JIT y las transacciones automáticas están estrechamente relacionadas.</span><span class="sxs-lookup"><span data-stu-id="5317b-148">Due to the natural use patterns of transactional objects—they do some unit of work and release the object when the transaction commits or aborts—JIT activation and automatic transactions are closely related.</span></span> <span data-ttu-id="5317b-149">La configuración de un objeto para requerir transacciones habilita la activación JIT de COM+ automáticamente.</span><span class="sxs-lookup"><span data-stu-id="5317b-149">Configuring an object to require transactions enables COM+ JIT activation automatically.</span></span>

## <a name="related-topics"></a><span data-ttu-id="5317b-150">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="5317b-150">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="5317b-151">Tareas de activación Just-in-Time de COM+</span><span class="sxs-lookup"><span data-stu-id="5317b-151">COM+ Just-in-Time Activation Tasks</span></span>](com--just-in-time-activation-tasks.md)
</dt> <dt>

[<span data-ttu-id="5317b-152">Agrupación de objetos y activación JIT de COM+</span><span class="sxs-lookup"><span data-stu-id="5317b-152">Object Pooling and COM+ JIT Activation</span></span>](object-pooling-and-com--jit-activation.md)
</dt> <dt>

[<span data-ttu-id="5317b-153">Transacciones y activación JIT de COM+</span><span class="sxs-lookup"><span data-stu-id="5317b-153">Transactions and COM+ JIT Activation</span></span>](transactions-and-com--jit-activation.md)
</dt> </dl>

 

 



