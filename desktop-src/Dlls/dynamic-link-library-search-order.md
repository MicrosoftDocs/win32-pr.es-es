---
description: Las aplicaciones pueden controlar la ubicación desde la que se carga un archivo DLL mediante la especificación de una ruta de acceso completa o mediante otro mecanismo, como un manifiesto. Si no se utilizan estos métodos, el sistema busca el archivo DLL en tiempo de carga como se describe en este tema.
ms.assetid: 44228cf2-6306-466c-8f16-f513cd3ba8b5
title: Orden de búsqueda de la biblioteca de vínculos dinámicos
ms.topic: article
ms.date: 09/11/2020
ms.custom: contperf-fy21q1
ms.openlocfilehash: 928cf9030e24c91145ae95e1eed680017bf68533
ms.sourcegitcommit: f374b50b37160b683da16b59ac9340282a8f50a5
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/04/2021
ms.locfileid: "104536400"
---
# <a name="dynamic-link-library-search-order"></a><span data-ttu-id="db7f3-104">Orden de búsqueda de la biblioteca de vínculos dinámicos</span><span class="sxs-lookup"><span data-stu-id="db7f3-104">Dynamic-Link Library Search Order</span></span>

<span data-ttu-id="db7f3-105">Un sistema puede contener varias versiones de la misma biblioteca de vínculos dinámicos (DLL).</span><span class="sxs-lookup"><span data-stu-id="db7f3-105">A system can contain multiple versions of the same dynamic-link library (DLL).</span></span> <span data-ttu-id="db7f3-106">Las aplicaciones pueden controlar la ubicación desde la que se carga un archivo DLL mediante la especificación de una ruta de acceso completa o mediante otro mecanismo, como un manifiesto.</span><span class="sxs-lookup"><span data-stu-id="db7f3-106">Applications can control the location from which a DLL is loaded by specifying a full path or using another mechanism such as a manifest.</span></span> <span data-ttu-id="db7f3-107">Si no se utilizan estos métodos, el sistema busca el archivo DLL en tiempo de carga como se describe en este tema.</span><span class="sxs-lookup"><span data-stu-id="db7f3-107">If these methods are not used, the system searches for the DLL at load time as described in this topic.</span></span>

-   [<span data-ttu-id="db7f3-108">Factores que afectan a la búsqueda</span><span class="sxs-lookup"><span data-stu-id="db7f3-108">Factors That Affect Searching</span></span>](#factors-that-affect-searching)
-   [<span data-ttu-id="db7f3-109">Buscar el orden de las aplicaciones para UWP</span><span class="sxs-lookup"><span data-stu-id="db7f3-109">Search Order for UWP Apps</span></span>](#search-order-for-uwp-apps)
    -   [<span data-ttu-id="db7f3-110">Orden de búsqueda estándar para aplicaciones para UWP</span><span class="sxs-lookup"><span data-stu-id="db7f3-110">Standard Search Order for UWP Apps</span></span>](#standard-search-order-for-uwp-apps)
    -   [<span data-ttu-id="db7f3-111">Orden de búsqueda alternativo para aplicaciones para UWP</span><span class="sxs-lookup"><span data-stu-id="db7f3-111">Alternate Search Order for UWP Apps</span></span>](#alternate-search-order-for-uwp-apps)
-   [<span data-ttu-id="db7f3-112">Orden de búsqueda de aplicaciones de escritorio</span><span class="sxs-lookup"><span data-stu-id="db7f3-112">Search Order for Desktop Applications</span></span>](#search-order-for-desktop-applications)
    -   [<span data-ttu-id="db7f3-113">Orden de búsqueda estándar para aplicaciones de escritorio</span><span class="sxs-lookup"><span data-stu-id="db7f3-113">Standard Search Order for Desktop Applications</span></span>](#standard-search-order-for-desktop-applications)
    -   [<span data-ttu-id="db7f3-114">Orden de búsqueda alternativo para aplicaciones de escritorio</span><span class="sxs-lookup"><span data-stu-id="db7f3-114">Alternate Search Order for Desktop Applications</span></span>](#alternate-search-order-for-desktop-applications)
    -   [<span data-ttu-id="db7f3-115">Buscar el orden usando las marcas de **\_ \_ búsqueda** de la biblioteca de carga</span><span class="sxs-lookup"><span data-stu-id="db7f3-115">Search Order Using **LOAD\_LIBRARY\_SEARCH** Flags</span></span>](/windows)
-   [<span data-ttu-id="db7f3-116">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="db7f3-116">Related topics</span></span>](#related-topics)

## <a name="factors-that-affect-searching"></a><span data-ttu-id="db7f3-117">Factores que afectan a la búsqueda</span><span class="sxs-lookup"><span data-stu-id="db7f3-117">Factors That Affect Searching</span></span>

<span data-ttu-id="db7f3-118">Los siguientes factores influyen en si el sistema busca un archivo DLL:</span><span class="sxs-lookup"><span data-stu-id="db7f3-118">The following factors affect whether the system searches for a DLL:</span></span>

-   <span data-ttu-id="db7f3-119">Si un archivo DLL con el mismo nombre de módulo ya está cargado en la memoria, el sistema comprueba solo la redirección y un manifiesto antes de resolver el archivo DLL cargado, con independencia del directorio en el que se encuentre.</span><span class="sxs-lookup"><span data-stu-id="db7f3-119">If a DLL with the same module name is already loaded in memory, the system checks only for redirection and a manifest before resolving to the loaded DLL, no matter which directory it is in.</span></span> <span data-ttu-id="db7f3-120">El sistema no busca el archivo DLL.</span><span class="sxs-lookup"><span data-stu-id="db7f3-120">The system does not search for the DLL.</span></span>
-   <span data-ttu-id="db7f3-121">Si el archivo DLL está en la lista de archivos dll conocidos para la versión de Windows en la que se está ejecutando la aplicación, el sistema utiliza su copia del archivo DLL conocido (y los archivos DLL dependientes del archivo DLL conocido, si existen) en lugar de buscar el archivo DLL.</span><span class="sxs-lookup"><span data-stu-id="db7f3-121">If the DLL is on the list of known DLLs for the version of Windows on which the application is running, the system uses its copy of the known DLL (and the known DLL's dependent DLLs, if any) instead of searching for the DLL.</span></span> <span data-ttu-id="db7f3-122">Para obtener una lista de los archivos dll conocidos en el sistema actual, consulte la siguiente clave del registro: **HKEY \_ local \_ Machine \\ System \\ CurrentControlSet \\ control \\ Session Manager \\ KnownDLLs**.</span><span class="sxs-lookup"><span data-stu-id="db7f3-122">For a list of known DLLs on the current system, see the following registry key: **HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs**.</span></span>
-   <span data-ttu-id="db7f3-123">Si un archivo DLL tiene dependencias, el sistema busca los archivos DLL dependientes como si estuvieran cargados con solo los nombres de los módulos.</span><span class="sxs-lookup"><span data-stu-id="db7f3-123">If a DLL has dependencies, the system searches for the dependent DLLs as if they were loaded with just their module names.</span></span> <span data-ttu-id="db7f3-124">Esto es así incluso si el primer archivo DLL se cargó especificando una ruta de acceso completa.</span><span class="sxs-lookup"><span data-stu-id="db7f3-124">This is true even if the first DLL was loaded by specifying a full path.</span></span>

## <a name="search-order-for-uwp-apps"></a><span data-ttu-id="db7f3-125">Buscar el orden de las aplicaciones para UWP</span><span class="sxs-lookup"><span data-stu-id="db7f3-125">Search Order for UWP apps</span></span>

<span data-ttu-id="db7f3-126">Cuando una aplicación de UWP para Windows 10 (o una aplicación de la tienda para Windows 8. x) carga un módulo empaquetado mediante una llamada a la función [**LoadPackagedLibrary**](/windows/desktop/api/Winbase/nf-winbase-loadpackagedlibrary) , el archivo DLL debe estar en el gráfico de dependencias del paquete del proceso.</span><span class="sxs-lookup"><span data-stu-id="db7f3-126">When a UWP app for Windows 10 (or a Store app for Windows 8.x) loads a packaged module by calling the [**LoadPackagedLibrary**](/windows/desktop/api/Winbase/nf-winbase-loadpackagedlibrary) function, the DLL must be in the package dependency graph of the process.</span></span> <span data-ttu-id="db7f3-127">Para obtener más información, vea **LoadPackagedLibrary**.</span><span class="sxs-lookup"><span data-stu-id="db7f3-127">For more information, see **LoadPackagedLibrary**.</span></span> <span data-ttu-id="db7f3-128">Cuando una aplicación para UWP carga un módulo por otros medios y no especifica una ruta de acceso completa, el sistema busca el archivo DLL y sus dependencias en tiempo de carga, tal y como se describe en esta sección.</span><span class="sxs-lookup"><span data-stu-id="db7f3-128">When a UWP app loads a module by other means and does not specify a full path, the system searches for the DLL and its dependencies at load time as described in this section.</span></span>

<span data-ttu-id="db7f3-129">Antes de que el sistema busque un archivo DLL, comprueba lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="db7f3-129">Before the system searches for a DLL, it checks the following:</span></span>

-   <span data-ttu-id="db7f3-130">Si un archivo DLL con el mismo nombre de módulo ya está cargado en la memoria, el sistema utiliza el archivo DLL cargado, con independencia del directorio en el que se encuentre.</span><span class="sxs-lookup"><span data-stu-id="db7f3-130">If a DLL with the same module name is already loaded in memory, the system uses the loaded DLL, no matter which directory it is in.</span></span> <span data-ttu-id="db7f3-131">El sistema no busca el archivo DLL.</span><span class="sxs-lookup"><span data-stu-id="db7f3-131">The system does not search for the DLL.</span></span>
-   <span data-ttu-id="db7f3-132">Si el archivo DLL está en la lista de archivos dll conocidos para la versión de Windows en la que se está ejecutando la aplicación, el sistema utiliza su copia del archivo DLL conocido (y los archivos DLL dependientes del archivo DLL conocido, si existen).</span><span class="sxs-lookup"><span data-stu-id="db7f3-132">If the DLL is on the list of known DLLs for the version of Windows on which the application is running, the system uses its copy of the known DLL (and the known DLL's dependent DLLs, if any).</span></span> <span data-ttu-id="db7f3-133">El sistema no busca el archivo DLL.</span><span class="sxs-lookup"><span data-stu-id="db7f3-133">The system does not search for the DLL.</span></span> <span data-ttu-id="db7f3-134">Para obtener una lista de los archivos dll conocidos en el sistema actual, consulte la siguiente clave del registro: **HKEY \_ local \_ Machine \\ System \\ CurrentControlSet \\ control \\ Session Manager \\ KnownDLLs**.</span><span class="sxs-lookup"><span data-stu-id="db7f3-134">For a list of known DLLs on the current system, see the following registry key: **HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs**.</span></span>

<span data-ttu-id="db7f3-135">Si el sistema debe buscar un módulo o sus dependencias, siempre usa el orden de búsqueda de las aplicaciones para UWP incluso si una dependencia no es código de aplicación de UWP.</span><span class="sxs-lookup"><span data-stu-id="db7f3-135">If the system must search for a module or its dependencies, it always uses the search order for UWP apps even if a dependency is not UWP app code.</span></span>

### <a name="standard-search-order-for-uwp-apps"></a><span data-ttu-id="db7f3-136">Orden de búsqueda estándar para aplicaciones para UWP</span><span class="sxs-lookup"><span data-stu-id="db7f3-136">Standard Search Order for UWP apps</span></span>

<span data-ttu-id="db7f3-137">Si el módulo no está ya cargado o en la lista de archivos dll conocidos, el sistema busca en estas ubicaciones en este orden:</span><span class="sxs-lookup"><span data-stu-id="db7f3-137">If the module is not already loaded or on the list of known DLLs, the system searches these locations in this order:</span></span>

1.  <span data-ttu-id="db7f3-138">Gráfico de dependencias del paquete del proceso.</span><span class="sxs-lookup"><span data-stu-id="db7f3-138">The package dependency graph of the process.</span></span> <span data-ttu-id="db7f3-139">Este es el paquete de la aplicación más las dependencias especificadas como `<PackageDependency>` en la `<Dependencies>` sección del manifiesto del paquete de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="db7f3-139">This is the application's package plus any dependencies specified as `<PackageDependency>` in the `<Dependencies>` section of the application's package manifest.</span></span> <span data-ttu-id="db7f3-140">Las dependencias se buscan en el orden en el que aparecen en el manifiesto.</span><span class="sxs-lookup"><span data-stu-id="db7f3-140">Dependencies are searched in the order they appear in the manifest.</span></span>
2.  <span data-ttu-id="db7f3-141">Directorio desde el que se cargó el proceso de llamada.</span><span class="sxs-lookup"><span data-stu-id="db7f3-141">The directory the calling process was loaded from.</span></span>
3.  <span data-ttu-id="db7f3-142">Directorio del sistema (% SystemRoot% \\ system32).</span><span class="sxs-lookup"><span data-stu-id="db7f3-142">The system directory (%SystemRoot%\\system32).</span></span>

<span data-ttu-id="db7f3-143">Si un archivo DLL tiene dependencias, el sistema busca los archivos DLL dependientes como si estuvieran cargados con solo los nombres de los módulos.</span><span class="sxs-lookup"><span data-stu-id="db7f3-143">If a DLL has dependencies, the system searches for the dependent DLLs as if they were loaded with just their module names.</span></span> <span data-ttu-id="db7f3-144">Esto es así incluso si el primer archivo DLL se cargó especificando una ruta de acceso completa.</span><span class="sxs-lookup"><span data-stu-id="db7f3-144">This is true even if the first DLL was loaded by specifying a full path.</span></span>

### <a name="alternate-search-order-for-uwp-apps"></a><span data-ttu-id="db7f3-145">Orden de búsqueda alternativo para aplicaciones para UWP</span><span class="sxs-lookup"><span data-stu-id="db7f3-145">Alternate Search Order for UWP apps</span></span>

<span data-ttu-id="db7f3-146">Si un módulo cambia el orden de búsqueda estándar mediante una llamada a la función [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) con la **carga \_ con la \_ \_ \_ ruta de búsqueda modificada**, el sistema busca en el directorio en el que se cargó el módulo especificado, en lugar del directorio del proceso de llamada.</span><span class="sxs-lookup"><span data-stu-id="db7f3-146">If a module changes the standard search order by calling the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function with **LOAD\_WITH\_ALTERED\_SEARCH\_PATH**, the system searches the directory the specified module was loaded from instead of the directory of the calling process.</span></span> <span data-ttu-id="db7f3-147">El sistema busca en estas ubicaciones en este orden:</span><span class="sxs-lookup"><span data-stu-id="db7f3-147">The system searches these locations in this order:</span></span>

1.  <span data-ttu-id="db7f3-148">Gráfico de dependencias del paquete del proceso.</span><span class="sxs-lookup"><span data-stu-id="db7f3-148">The package dependency graph of the process.</span></span> <span data-ttu-id="db7f3-149">Este es el paquete de la aplicación más las dependencias especificadas como `<PackageDependency>` en la `<Dependencies>` sección del manifiesto del paquete de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="db7f3-149">This is the application's package plus any dependencies specified as `<PackageDependency>` in the `<Dependencies>` section of the application's package manifest.</span></span> <span data-ttu-id="db7f3-150">Las dependencias se buscan en el orden en el que aparecen en el manifiesto.</span><span class="sxs-lookup"><span data-stu-id="db7f3-150">Dependencies are searched in the order they appear in the manifest.</span></span>
2.  <span data-ttu-id="db7f3-151">Directorio desde el que se cargó el módulo especificado.</span><span class="sxs-lookup"><span data-stu-id="db7f3-151">The directory the specified module was loaded from.</span></span>
3.  <span data-ttu-id="db7f3-152">Directorio del sistema (% SystemRoot% \\ system32).</span><span class="sxs-lookup"><span data-stu-id="db7f3-152">The system directory (%SystemRoot%\\system32).</span></span>

## <a name="search-order-for-desktop-applications"></a><span data-ttu-id="db7f3-153">Orden de búsqueda de aplicaciones de escritorio</span><span class="sxs-lookup"><span data-stu-id="db7f3-153">Search Order for Desktop Applications</span></span>

<span data-ttu-id="db7f3-154">Las aplicaciones de escritorio pueden controlar la ubicación desde la que se carga un archivo DLL mediante la especificación de una ruta de acceso completa, el uso de la [redirección de dll](dynamic-link-library-redirection.md)o el uso de un [manifiesto](/windows/desktop/SbsCs/manifests).</span><span class="sxs-lookup"><span data-stu-id="db7f3-154">Desktop applications can control the location from which a DLL is loaded by specifying a full path, using [DLL redirection](dynamic-link-library-redirection.md), or by using a [manifest](/windows/desktop/SbsCs/manifests).</span></span> <span data-ttu-id="db7f3-155">Si no se usa ninguno de estos métodos, el sistema busca el archivo DLL en tiempo de carga tal y como se describe en esta sección.</span><span class="sxs-lookup"><span data-stu-id="db7f3-155">If none of these methods are used, the system searches for the DLL at load time as described in this section.</span></span>

<span data-ttu-id="db7f3-156">Antes de que el sistema busque un archivo DLL, comprueba lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="db7f3-156">Before the system searches for a DLL, it checks the following:</span></span>

-   <span data-ttu-id="db7f3-157">Si un archivo DLL con el mismo nombre de módulo ya está cargado en la memoria, el sistema utiliza el archivo DLL cargado, con independencia del directorio en el que se encuentre.</span><span class="sxs-lookup"><span data-stu-id="db7f3-157">If a DLL with the same module name is already loaded in memory, the system uses the loaded DLL, no matter which directory it is in.</span></span> <span data-ttu-id="db7f3-158">El sistema no busca el archivo DLL.</span><span class="sxs-lookup"><span data-stu-id="db7f3-158">The system does not search for the DLL.</span></span>
-   <span data-ttu-id="db7f3-159">Si el archivo DLL está en la lista de archivos dll conocidos para la versión de Windows en la que se está ejecutando la aplicación, el sistema utiliza su copia del archivo DLL conocido (y los archivos DLL dependientes del archivo DLL conocido, si existen).</span><span class="sxs-lookup"><span data-stu-id="db7f3-159">If the DLL is on the list of known DLLs for the version of Windows on which the application is running, the system uses its copy of the known DLL (and the known DLL's dependent DLLs, if any).</span></span> <span data-ttu-id="db7f3-160">El sistema no busca el archivo DLL.</span><span class="sxs-lookup"><span data-stu-id="db7f3-160">The system does not search for the DLL.</span></span> <span data-ttu-id="db7f3-161">Para obtener una lista de los archivos dll conocidos en el sistema actual, consulte la siguiente clave del registro: **HKEY \_ local \_ Machine \\ System \\ CurrentControlSet \\ control \\ Session Manager \\ KnownDLLs**.</span><span class="sxs-lookup"><span data-stu-id="db7f3-161">For a list of known DLLs on the current system, see the following registry key: **HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs**.</span></span>

<span data-ttu-id="db7f3-162">Si un archivo DLL tiene dependencias, el sistema busca los archivos DLL dependientes como si estuvieran cargados con solo los nombres de los módulos.</span><span class="sxs-lookup"><span data-stu-id="db7f3-162">If a DLL has dependencies, the system searches for the dependent DLLs as if they were loaded with just their module names.</span></span> <span data-ttu-id="db7f3-163">Esto es así incluso si el primer archivo DLL se cargó especificando una ruta de acceso completa.</span><span class="sxs-lookup"><span data-stu-id="db7f3-163">This is true even if the first DLL was loaded by specifying a full path.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="db7f3-164">Si un atacante obtiene el control de uno de los directorios en los que se realiza la búsqueda, puede colocar una copia malintencionada del archivo DLL en ese directorio.</span><span class="sxs-lookup"><span data-stu-id="db7f3-164">If an attacker gains control of one of the directories that is searched, it can place a malicious copy of the DLL in that directory.</span></span> <span data-ttu-id="db7f3-165">Para obtener más formas de evitar estos ataques, consulte [seguridad de la biblioteca de vínculos dinámicos](dynamic-link-library-security.md).</span><span class="sxs-lookup"><span data-stu-id="db7f3-165">For ways to help prevent such attacks, see [Dynamic-Link Library Security](dynamic-link-library-security.md).</span></span>

### <a name="standard-search-order-for-desktop-applications"></a><span data-ttu-id="db7f3-166">Orden de búsqueda estándar para aplicaciones de escritorio</span><span class="sxs-lookup"><span data-stu-id="db7f3-166">Standard Search Order for Desktop Applications</span></span>

<span data-ttu-id="db7f3-167">El orden de búsqueda de DLL estándar que usa el sistema depende de si está habilitado o deshabilitado el modo de búsqueda de archivos DLL seguros.</span><span class="sxs-lookup"><span data-stu-id="db7f3-167">The standard DLL search order used by the system depends on whether safe DLL search mode is enabled or disabled.</span></span> <span data-ttu-id="db7f3-168">El modo de búsqueda segura de DLL coloca el directorio actual del usuario más adelante en el orden de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="db7f3-168">Safe DLL search mode places the user's current directory later in the search order.</span></span>

<span data-ttu-id="db7f3-169">El modo de búsqueda segura de DLL está habilitado de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="db7f3-169">Safe DLL search mode is enabled by default.</span></span> <span data-ttu-id="db7f3-170">Para deshabilitar esta característica, cree el valor del registro **HKEY \_ local \_ Machine \\ System \\ CurrentControlSet \\ control \\ Session Manager** \\ **SafeDllSearchMode** y establézcalo en 0.</span><span class="sxs-lookup"><span data-stu-id="db7f3-170">To disable this feature, create the **HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager**\\**SafeDllSearchMode** registry value and set it to 0.</span></span> <span data-ttu-id="db7f3-171">La llamada a la función [**SetDllDirectory**](/windows/desktop/api/winbase/nf-winbase-setdlldirectorya) deshabilita **SafeDllSearchMode** de forma eficaz mientras el directorio especificado se encuentra en la ruta de búsqueda y cambia el orden de búsqueda tal y como se describe en este tema.</span><span class="sxs-lookup"><span data-stu-id="db7f3-171">Calling the [**SetDllDirectory**](/windows/desktop/api/winbase/nf-winbase-setdlldirectorya) function effectively disables **SafeDllSearchMode** while the specified directory is in the search path and changes the search order as described in this topic.</span></span>

<span data-ttu-id="db7f3-172">Si **SafeDllSearchMode** está habilitado, el orden de búsqueda es el siguiente:</span><span class="sxs-lookup"><span data-stu-id="db7f3-172">If **SafeDllSearchMode** is enabled, the search order is as follows:</span></span>

1.  <span data-ttu-id="db7f3-173">Directorio desde el que se cargó la aplicación.</span><span class="sxs-lookup"><span data-stu-id="db7f3-173">The directory from which the application loaded.</span></span>
2.  <span data-ttu-id="db7f3-174">Directorio del sistema.</span><span class="sxs-lookup"><span data-stu-id="db7f3-174">The system directory.</span></span> <span data-ttu-id="db7f3-175">Utilice la función [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) para obtener la ruta de acceso de este directorio.</span><span class="sxs-lookup"><span data-stu-id="db7f3-175">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
3.  <span data-ttu-id="db7f3-176">Directorio del sistema de 16 bits.</span><span class="sxs-lookup"><span data-stu-id="db7f3-176">The 16-bit system directory.</span></span> <span data-ttu-id="db7f3-177">No hay ninguna función que obtenga la ruta de acceso de este directorio, pero se busca.</span><span class="sxs-lookup"><span data-stu-id="db7f3-177">There is no function that obtains the path of this directory, but it is searched.</span></span>
4.  <span data-ttu-id="db7f3-178">El directorio de Windows.</span><span class="sxs-lookup"><span data-stu-id="db7f3-178">The Windows directory.</span></span> <span data-ttu-id="db7f3-179">Utilice la función [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) para obtener la ruta de acceso de este directorio.</span><span class="sxs-lookup"><span data-stu-id="db7f3-179">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
5.  <span data-ttu-id="db7f3-180">El directorio actual.</span><span class="sxs-lookup"><span data-stu-id="db7f3-180">The current directory.</span></span>
6.  <span data-ttu-id="db7f3-181">Los directorios que aparecen en la variable de entorno PATH.</span><span class="sxs-lookup"><span data-stu-id="db7f3-181">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="db7f3-182">Tenga en cuenta que esto no incluye la ruta de acceso por aplicación especificada por la clave del registro de **rutas** de acceso de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="db7f3-182">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="db7f3-183">La clave de rutas de acceso de la **aplicación** no se usa al calcular la ruta de búsqueda de dll.</span><span class="sxs-lookup"><span data-stu-id="db7f3-183">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="db7f3-184">Si **SafeDllSearchMode** está deshabilitado, el orden de búsqueda es el siguiente:</span><span class="sxs-lookup"><span data-stu-id="db7f3-184">If **SafeDllSearchMode** is disabled, the search order is as follows:</span></span>

1.  <span data-ttu-id="db7f3-185">Directorio desde el que se cargó la aplicación.</span><span class="sxs-lookup"><span data-stu-id="db7f3-185">The directory from which the application loaded.</span></span>
2.  <span data-ttu-id="db7f3-186">El directorio actual.</span><span class="sxs-lookup"><span data-stu-id="db7f3-186">The current directory.</span></span>
3.  <span data-ttu-id="db7f3-187">Directorio del sistema.</span><span class="sxs-lookup"><span data-stu-id="db7f3-187">The system directory.</span></span> <span data-ttu-id="db7f3-188">Utilice la función [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) para obtener la ruta de acceso de este directorio.</span><span class="sxs-lookup"><span data-stu-id="db7f3-188">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
4.  <span data-ttu-id="db7f3-189">Directorio del sistema de 16 bits.</span><span class="sxs-lookup"><span data-stu-id="db7f3-189">The 16-bit system directory.</span></span> <span data-ttu-id="db7f3-190">No hay ninguna función que obtenga la ruta de acceso de este directorio, pero se busca.</span><span class="sxs-lookup"><span data-stu-id="db7f3-190">There is no function that obtains the path of this directory, but it is searched.</span></span>
5.  <span data-ttu-id="db7f3-191">El directorio de Windows.</span><span class="sxs-lookup"><span data-stu-id="db7f3-191">The Windows directory.</span></span> <span data-ttu-id="db7f3-192">Utilice la función [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) para obtener la ruta de acceso de este directorio.</span><span class="sxs-lookup"><span data-stu-id="db7f3-192">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
6.  <span data-ttu-id="db7f3-193">Los directorios que aparecen en la variable de entorno PATH.</span><span class="sxs-lookup"><span data-stu-id="db7f3-193">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="db7f3-194">Tenga en cuenta que esto no incluye la ruta de acceso por aplicación especificada por la clave del registro de **rutas** de acceso de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="db7f3-194">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="db7f3-195">La clave de rutas de acceso de la **aplicación** no se usa al calcular la ruta de búsqueda de dll.</span><span class="sxs-lookup"><span data-stu-id="db7f3-195">The **App Paths** key is not used when computing the DLL search path.</span></span>

### <a name="alternate-search-order-for-desktop-applications"></a><span data-ttu-id="db7f3-196">Orden de búsqueda alternativo para aplicaciones de escritorio</span><span class="sxs-lookup"><span data-stu-id="db7f3-196">Alternate Search Order for Desktop Applications</span></span>

<span data-ttu-id="db7f3-197">Se puede cambiar el orden de búsqueda estándar que usa el sistema mediante una llamada a la función [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) con la **carga \_ con la \_ \_ \_ ruta de búsqueda modificada**.</span><span class="sxs-lookup"><span data-stu-id="db7f3-197">The standard search order used by the system can be changed by calling the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function with **LOAD\_WITH\_ALTERED\_SEARCH\_PATH**.</span></span> <span data-ttu-id="db7f3-198">El orden de búsqueda estándar también se puede cambiar mediante una llamada a la función [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) .</span><span class="sxs-lookup"><span data-stu-id="db7f3-198">The standard search order can also be changed by calling the [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function.</span></span>

> [!NOTE]
> <span data-ttu-id="db7f3-199">El orden de búsqueda estándar del proceso también se verá afectado por la llamada a la función [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) en el proceso primario antes del inicio del proceso actual.</span><span class="sxs-lookup"><span data-stu-id="db7f3-199">The standard search order of the process will also be affected by calling the [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function in the parent process before start of the current process.</span></span>

<span data-ttu-id="db7f3-200">Si especifica una estrategia de búsqueda alternativa, su comportamiento continúa hasta que se hayan encontrado todos los módulos ejecutables asociados.</span><span class="sxs-lookup"><span data-stu-id="db7f3-200">If you specify an alternate search strategy, its behavior continues until all associated executable modules have been located.</span></span> <span data-ttu-id="db7f3-201">Una vez que el sistema inicia el procesamiento de rutinas de inicialización de DLL, el sistema vuelve a la estrategia de búsqueda estándar.</span><span class="sxs-lookup"><span data-stu-id="db7f3-201">After the system starts processing DLL initialization routines, the system reverts to the standard search strategy.</span></span>

<span data-ttu-id="db7f3-202">La función [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) admite un orden de búsqueda alternativo si la llamada especifica la **carga con la \_ \_ \_ \_ ruta de búsqueda modificada** y el parámetro *lpFileName* especifica una ruta de acceso absoluta.</span><span class="sxs-lookup"><span data-stu-id="db7f3-202">The [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function supports an alternate search order if the call specifies **LOAD\_WITH\_ALTERED\_SEARCH\_PATH** and the *lpFileName* parameter specifies an absolute path.</span></span>

<span data-ttu-id="db7f3-203">Tenga en cuenta que la estrategia de búsqueda estándar y la estrategia de búsqueda alternativa especificada por [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) con la **\_ \_ \_ \_ ruta de búsqueda modificada** difieren solo en una manera: la búsqueda estándar comienza en el directorio de la aplicación que realiza la llamada y la búsqueda alternativa comienza en el directorio del módulo ejecutable que se está cargando en **loadlibraryex** .</span><span class="sxs-lookup"><span data-stu-id="db7f3-203">Note that the standard search strategy and the alternate search strategy specified by [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) with **LOAD\_WITH\_ALTERED\_SEARCH\_PATH** differ in just one way: The standard search begins in the calling application's directory, and the alternate search begins in the directory of the executable module that **LoadLibraryEx** is loading.</span></span>

<span data-ttu-id="db7f3-204">Si **SafeDllSearchMode** está habilitado, el orden de búsqueda alternativo es el siguiente:</span><span class="sxs-lookup"><span data-stu-id="db7f3-204">If **SafeDllSearchMode** is enabled, the alternate search order is as follows:</span></span>

1.  <span data-ttu-id="db7f3-205">El directorio especificado por *lpFileName*.</span><span class="sxs-lookup"><span data-stu-id="db7f3-205">The directory specified by *lpFileName*.</span></span>
2.  <span data-ttu-id="db7f3-206">Directorio del sistema.</span><span class="sxs-lookup"><span data-stu-id="db7f3-206">The system directory.</span></span> <span data-ttu-id="db7f3-207">Utilice la función [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) para obtener la ruta de acceso de este directorio.</span><span class="sxs-lookup"><span data-stu-id="db7f3-207">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
3.  <span data-ttu-id="db7f3-208">Directorio del sistema de 16 bits.</span><span class="sxs-lookup"><span data-stu-id="db7f3-208">The 16-bit system directory.</span></span> <span data-ttu-id="db7f3-209">No hay ninguna función que obtenga la ruta de acceso de este directorio, pero se busca.</span><span class="sxs-lookup"><span data-stu-id="db7f3-209">There is no function that obtains the path of this directory, but it is searched.</span></span>
4.  <span data-ttu-id="db7f3-210">El directorio de Windows.</span><span class="sxs-lookup"><span data-stu-id="db7f3-210">The Windows directory.</span></span> <span data-ttu-id="db7f3-211">Utilice la función [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) para obtener la ruta de acceso de este directorio.</span><span class="sxs-lookup"><span data-stu-id="db7f3-211">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
5.  <span data-ttu-id="db7f3-212">El directorio actual.</span><span class="sxs-lookup"><span data-stu-id="db7f3-212">The current directory.</span></span>
6.  <span data-ttu-id="db7f3-213">Los directorios que aparecen en la variable de entorno PATH.</span><span class="sxs-lookup"><span data-stu-id="db7f3-213">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="db7f3-214">Tenga en cuenta que esto no incluye la ruta de acceso por aplicación especificada por la clave del registro de **rutas** de acceso de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="db7f3-214">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="db7f3-215">La clave de rutas de acceso de la **aplicación** no se usa al calcular la ruta de búsqueda de dll.</span><span class="sxs-lookup"><span data-stu-id="db7f3-215">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="db7f3-216">Si **SafeDllSearchMode** está deshabilitado, el orden de búsqueda alternativo es el siguiente:</span><span class="sxs-lookup"><span data-stu-id="db7f3-216">If **SafeDllSearchMode** is disabled, the alternate search order is as follows:</span></span>

1.  <span data-ttu-id="db7f3-217">El directorio especificado por *lpFileName*.</span><span class="sxs-lookup"><span data-stu-id="db7f3-217">The directory specified by *lpFileName*.</span></span>
2.  <span data-ttu-id="db7f3-218">El directorio actual.</span><span class="sxs-lookup"><span data-stu-id="db7f3-218">The current directory.</span></span>
3.  <span data-ttu-id="db7f3-219">Directorio del sistema.</span><span class="sxs-lookup"><span data-stu-id="db7f3-219">The system directory.</span></span> <span data-ttu-id="db7f3-220">Utilice la función [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) para obtener la ruta de acceso de este directorio.</span><span class="sxs-lookup"><span data-stu-id="db7f3-220">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
4.  <span data-ttu-id="db7f3-221">Directorio del sistema de 16 bits.</span><span class="sxs-lookup"><span data-stu-id="db7f3-221">The 16-bit system directory.</span></span> <span data-ttu-id="db7f3-222">No hay ninguna función que obtenga la ruta de acceso de este directorio, pero se busca.</span><span class="sxs-lookup"><span data-stu-id="db7f3-222">There is no function that obtains the path of this directory, but it is searched.</span></span>
5.  <span data-ttu-id="db7f3-223">El directorio de Windows.</span><span class="sxs-lookup"><span data-stu-id="db7f3-223">The Windows directory.</span></span> <span data-ttu-id="db7f3-224">Utilice la función [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) para obtener la ruta de acceso de este directorio.</span><span class="sxs-lookup"><span data-stu-id="db7f3-224">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
6.  <span data-ttu-id="db7f3-225">Los directorios que aparecen en la variable de entorno PATH.</span><span class="sxs-lookup"><span data-stu-id="db7f3-225">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="db7f3-226">Tenga en cuenta que esto no incluye la ruta de acceso por aplicación especificada por la clave del registro de **rutas** de acceso de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="db7f3-226">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="db7f3-227">La clave de rutas de acceso de la **aplicación** no se usa al calcular la ruta de búsqueda de dll.</span><span class="sxs-lookup"><span data-stu-id="db7f3-227">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="db7f3-228">La función [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) admite un orden de búsqueda alternativo si el parámetro *lpPathName* especifica una ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="db7f3-228">The [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function supports an alternate search order if the *lpPathName* parameter specifies a path.</span></span> <span data-ttu-id="db7f3-229">El orden de búsqueda alternativo es el siguiente:</span><span class="sxs-lookup"><span data-stu-id="db7f3-229">The alternate search order is as follows:</span></span>

1.  <span data-ttu-id="db7f3-230">Directorio desde el que se cargó la aplicación.</span><span class="sxs-lookup"><span data-stu-id="db7f3-230">The directory from which the application loaded.</span></span>
2.  <span data-ttu-id="db7f3-231">El directorio especificado por el parámetro *lpPathName* de [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya).</span><span class="sxs-lookup"><span data-stu-id="db7f3-231">The directory specified by the *lpPathName* parameter of [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya).</span></span>
3.  <span data-ttu-id="db7f3-232">Directorio del sistema.</span><span class="sxs-lookup"><span data-stu-id="db7f3-232">The system directory.</span></span> <span data-ttu-id="db7f3-233">Utilice la función [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) para obtener la ruta de acceso de este directorio.</span><span class="sxs-lookup"><span data-stu-id="db7f3-233">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span> <span data-ttu-id="db7f3-234">El nombre de este directorio es system32.</span><span class="sxs-lookup"><span data-stu-id="db7f3-234">The name of this directory is System32.</span></span>
4.  <span data-ttu-id="db7f3-235">Directorio del sistema de 16 bits.</span><span class="sxs-lookup"><span data-stu-id="db7f3-235">The 16-bit system directory.</span></span> <span data-ttu-id="db7f3-236">No hay ninguna función que obtenga la ruta de acceso de este directorio, pero se busca.</span><span class="sxs-lookup"><span data-stu-id="db7f3-236">There is no function that obtains the path of this directory, but it is searched.</span></span> <span data-ttu-id="db7f3-237">El nombre de este directorio es System.</span><span class="sxs-lookup"><span data-stu-id="db7f3-237">The name of this directory is System.</span></span>
5.  <span data-ttu-id="db7f3-238">El directorio de Windows.</span><span class="sxs-lookup"><span data-stu-id="db7f3-238">The Windows directory.</span></span> <span data-ttu-id="db7f3-239">Utilice la función [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) para obtener la ruta de acceso de este directorio.</span><span class="sxs-lookup"><span data-stu-id="db7f3-239">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
6.  <span data-ttu-id="db7f3-240">Los directorios que aparecen en la variable de entorno PATH.</span><span class="sxs-lookup"><span data-stu-id="db7f3-240">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="db7f3-241">Tenga en cuenta que esto no incluye la ruta de acceso por aplicación especificada por la clave del registro de **rutas** de acceso de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="db7f3-241">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="db7f3-242">La clave de rutas de acceso de la **aplicación** no se usa al calcular la ruta de búsqueda de dll.</span><span class="sxs-lookup"><span data-stu-id="db7f3-242">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="db7f3-243">Si el parámetro *lpPathName* es una cadena vacía, la llamada quita el directorio actual del orden de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="db7f3-243">If the *lpPathName* parameter is an empty string, the call removes the current directory from the search order.</span></span>

<span data-ttu-id="db7f3-244">[**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) deshabilita de forma eficaz el modo de búsqueda de dll segura mientras el directorio especificado está en la ruta de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="db7f3-244">[**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) effectively disables safe DLL search mode while the specified directory is in the search path.</span></span> <span data-ttu-id="db7f3-245">Para restaurar el modo de búsqueda de DLL segura según el valor del registro **SafeDllSearchMode** y restaurar el directorio actual en el orden de búsqueda, llame a **SetDllDirectory** con *lpPathName* como null.</span><span class="sxs-lookup"><span data-stu-id="db7f3-245">To restore safe DLL search mode based on the **SafeDllSearchMode** registry value and restore the current directory to the search order, call **SetDllDirectory** with *lpPathName* as NULL.</span></span>

### <a name="search-order-using-load_library_search-flags"></a><span data-ttu-id="db7f3-246">Buscar el orden usando las marcas de **\_ \_ búsqueda** de la biblioteca de carga</span><span class="sxs-lookup"><span data-stu-id="db7f3-246">Search Order Using **LOAD\_LIBRARY\_SEARCH** Flags</span></span>

<span data-ttu-id="db7f3-247">Una aplicación puede especificar un orden de búsqueda mediante el uso de una o más marcas de **\_ \_ búsqueda** de la biblioteca de carga con la función [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) .</span><span class="sxs-lookup"><span data-stu-id="db7f3-247">An application can specify a search order by using one or more **LOAD\_LIBRARY\_SEARCH** flags with the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function.</span></span> <span data-ttu-id="db7f3-248">Una aplicación también puede utilizar las marcas de **\_ \_ búsqueda** de la biblioteca de carga con la función [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) para establecer un orden de búsqueda de dll para un proceso.</span><span class="sxs-lookup"><span data-stu-id="db7f3-248">An application can also use **LOAD\_LIBRARY\_SEARCH** flags with the [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) function to establish a DLL search order for a process.</span></span> <span data-ttu-id="db7f3-249">La aplicación puede especificar directorios adicionales para el orden de búsqueda de DLL de proceso mediante las funciones [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) o [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) .</span><span class="sxs-lookup"><span data-stu-id="db7f3-249">The application can specify additional directories for the process DLL search order by using the [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) or [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) functions.</span></span>

<span data-ttu-id="db7f3-250">Los directorios en los que se realiza la búsqueda dependen de las marcas especificadas con [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) o [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa).</span><span class="sxs-lookup"><span data-stu-id="db7f3-250">The directories that are searched depend on the flags specified with [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) or [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa).</span></span> <span data-ttu-id="db7f3-251">Si se usa más de una marca, se busca en los directorios correspondientes en el orden siguiente:</span><span class="sxs-lookup"><span data-stu-id="db7f3-251">If more than one flag is used, the corresponding directories are searched in the following order:</span></span>

1.  <span data-ttu-id="db7f3-252">Directorio que contiene el archivo DLL (**cargar \_ \_ Directorio de \_ \_ carga de \_ dll de búsqueda de biblioteca**).</span><span class="sxs-lookup"><span data-stu-id="db7f3-252">The directory that contains the DLL (**LOAD\_LIBRARY\_SEARCH\_DLL\_LOAD\_DIR**).</span></span> <span data-ttu-id="db7f3-253">Solo se busca en este directorio las dependencias de la DLL que se va a cargar.</span><span class="sxs-lookup"><span data-stu-id="db7f3-253">This directory is searched only for dependencies of the DLL to be loaded.</span></span>
2.  <span data-ttu-id="db7f3-254">Directorio de la aplicación (carga de la **\_ aplicación de \_ búsqueda de \_ \_ biblioteca**).</span><span class="sxs-lookup"><span data-stu-id="db7f3-254">The application directory (**LOAD\_LIBRARY\_SEARCH\_APPLICATION\_DIR**).</span></span>
3.  <span data-ttu-id="db7f3-255">Las rutas de acceso se agregan explícitamente con la función [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) (**cargar \_ directorios de usuario de \_ búsqueda \_ \_ de biblioteca**) o la función [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) .</span><span class="sxs-lookup"><span data-stu-id="db7f3-255">Paths explicitly added with the [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) function (**LOAD\_LIBRARY\_SEARCH\_USER\_DIRS**) or the [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function.</span></span> <span data-ttu-id="db7f3-256">Si se ha agregado más de una ruta, no se especifica el orden en el que se buscan las rutas de acceso.</span><span class="sxs-lookup"><span data-stu-id="db7f3-256">If more than one path has been added, the order in which the paths are searched is unspecified.</span></span>
4.  <span data-ttu-id="db7f3-257">Directorio del sistema (**Load \_ Library \_ Search \_ system32**).</span><span class="sxs-lookup"><span data-stu-id="db7f3-257">The System directory (**LOAD\_LIBRARY\_SEARCH\_SYSTEM32**).</span></span>

<span data-ttu-id="db7f3-258">Si la aplicación no llama a [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) con ninguna marca de **\_ \_ búsqueda** de la biblioteca de carga o establece un orden de búsqueda de dll para el proceso, el sistema busca los archivos DLL mediante el orden de búsqueda estándar o el orden de búsqueda alternativo.</span><span class="sxs-lookup"><span data-stu-id="db7f3-258">If the application does not call [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) with any **LOAD\_LIBRARY\_SEARCH** flags or establish a DLL search order for the process, the system searches for DLLs using either the standard search order or the alternate search order.</span></span>

## <a name="related-topics"></a><span data-ttu-id="db7f3-259">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="db7f3-259">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="db7f3-260">**AddDllDirectory**</span><span class="sxs-lookup"><span data-stu-id="db7f3-260">**AddDllDirectory**</span></span>](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory)
</dt> <dt>

[<span data-ttu-id="db7f3-261">Registro de aplicaciones</span><span class="sxs-lookup"><span data-stu-id="db7f3-261">Application Registration</span></span>](/windows/desktop/shell/app-registration)
</dt> <dt>

[<span data-ttu-id="db7f3-262">Redirección de biblioteca de vínculos dinámicos</span><span class="sxs-lookup"><span data-stu-id="db7f3-262">Dynamic-Link Library Redirection</span></span>](dynamic-link-library-redirection.md)
</dt> <dt>

[<span data-ttu-id="db7f3-263">Seguridad de la biblioteca de vínculos dinámicos</span><span class="sxs-lookup"><span data-stu-id="db7f3-263">Dynamic-Link Library Security</span></span>](dynamic-link-library-security.md)
</dt> <dt>

[<span data-ttu-id="db7f3-264">**LoadLibrary**</span><span class="sxs-lookup"><span data-stu-id="db7f3-264">**LoadLibrary**</span></span>](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya)
</dt> <dt>

[<span data-ttu-id="db7f3-265">**LoadLibraryEx**</span><span class="sxs-lookup"><span data-stu-id="db7f3-265">**LoadLibraryEx**</span></span>](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa)
</dt> <dt>

[<span data-ttu-id="db7f3-266">**LoadPackagedLibrary**</span><span class="sxs-lookup"><span data-stu-id="db7f3-266">**LoadPackagedLibrary**</span></span>](/windows/desktop/api/Winbase/nf-winbase-loadpackagedlibrary)
</dt> <dt>

[<span data-ttu-id="db7f3-267">**SetDefaultDllDirectories**</span><span class="sxs-lookup"><span data-stu-id="db7f3-267">**SetDefaultDllDirectories**</span></span>](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories)
</dt> <dt>

[<span data-ttu-id="db7f3-268">**SetDllDirectory**</span><span class="sxs-lookup"><span data-stu-id="db7f3-268">**SetDllDirectory**</span></span>](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya)
</dt> <dt>

[<span data-ttu-id="db7f3-269">Componentes en paralelo</span><span class="sxs-lookup"><span data-stu-id="db7f3-269">Side-by-side Components</span></span>](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal)
</dt> </dl>

 

 