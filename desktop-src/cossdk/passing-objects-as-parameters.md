---
description: Pasar objetos como parámetros
ms.assetid: 174847c8-4545-4f61-ae13-42bdec1405e7
title: Pasar objetos como parámetros
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a58e012138bc65cec481f714ac216bb8227fb924
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104539184"
---
# <a name="passing-objects-as-parameters"></a><span data-ttu-id="cb8bd-103">Pasar objetos como parámetros</span><span class="sxs-lookup"><span data-stu-id="cb8bd-103">Passing Objects as Parameters</span></span>

<span data-ttu-id="cb8bd-104">El servicio de componentes en cola COM+ no habilita la puesta en cola para todos los componentes COM existentes.</span><span class="sxs-lookup"><span data-stu-id="cb8bd-104">The COM+ queued components service does not enable queuing for every existing COM component.</span></span> <span data-ttu-id="cb8bd-105">Existen restricciones en los tipos de métodos que se pueden poner en cola.</span><span class="sxs-lookup"><span data-stu-id="cb8bd-105">There are restrictions on the types of methods that can be queued.</span></span> <span data-ttu-id="cb8bd-106">Debido a las restricciones de mensajería, los métodos deben cumplir las siguientes reglas:</span><span class="sxs-lookup"><span data-stu-id="cb8bd-106">Because of messaging constraints, methods must adhere to the following rules:</span></span>

-   <span data-ttu-id="cb8bd-107">Solo deben contener parámetros de entrada.</span><span class="sxs-lookup"><span data-stu-id="cb8bd-107">They must contain input parameters only.</span></span>
-   <span data-ttu-id="cb8bd-108">No deben devolver ningún resultado específico de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="cb8bd-108">They must return no application-specific result.</span></span>

<span data-ttu-id="cb8bd-109">Además, existen restricciones en los tipos de parámetros de entrada que se pueden pasar a un componente en cola.</span><span class="sxs-lookup"><span data-stu-id="cb8bd-109">Additionally, there are restrictions on the types of input parameters that can be passed to a queued component.</span></span> <span data-ttu-id="cb8bd-110">En tiempo de ejecución, el servicio de componentes en cola empaqueta los argumentos en el cliente y los pasa al componente de servidor mediante [Message Queue Server](/previous-versions/windows/desktop/legacy/ms711472(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="cb8bd-110">At run time, the queued components service packages the arguments at the client and passes them to the server component by using [Message Queuing](/previous-versions/windows/desktop/legacy/ms711472(v=vs.85)).</span></span> <span data-ttu-id="cb8bd-111">Los tipos simples, como enteros y booleanos, se pueden serializar fácilmente; no se pueden calcular las referencias de tipos más complejos sin ayuda.</span><span class="sxs-lookup"><span data-stu-id="cb8bd-111">Simple types, such as integers and Booleans, can be marshaled easily—more complex types cannot be marshaled without help.</span></span>

<span data-ttu-id="cb8bd-112">En el caso de pasar un objeto a través de una llamada al método de un componente en cola como parámetro, el cliente pasa el objeto a la grabadora.</span><span class="sxs-lookup"><span data-stu-id="cb8bd-112">In the case of passing an object through a queued component's method call as a parameter, the client passes the object to the recorder.</span></span> <span data-ttu-id="cb8bd-113">La grabadora calcula las referencias del objeto en un mensaje de Message Queuing y lo pasa al agente de escucha.</span><span class="sxs-lookup"><span data-stu-id="cb8bd-113">The recorder marshals the object into a Message Queuing message and passes it to the listener.</span></span> <span data-ttu-id="cb8bd-114">Una vez que el agente de escucha recoge el mensaje y lo pasa al reproductor, el reproductor debe crear una instancia del objeto para enviarlo a la llamada al método especificada por el cliente.</span><span class="sxs-lookup"><span data-stu-id="cb8bd-114">After the listener picks up the message and passes it to the player, the player must reinstantiate the object to dispatch it to the method call specified by the client.</span></span> <span data-ttu-id="cb8bd-115">En función de la duración del cliente y del servidor en un entorno en cola, la implicación es que estos objetos deben ser capaces de calcular las referencias por valor.</span><span class="sxs-lookup"><span data-stu-id="cb8bd-115">Based on the lifetimes of the client and server in a queued environment, the implication is that these objects must be able to marshal by value.</span></span> <span data-ttu-id="cb8bd-116">Dado que COM+ no proporciona la semántica de paso por valor para los objetos COM estándar, la grabadora y el reproductor necesitan ayuda del componente para calcular las referencias del objeto y no calcular las referencias del mismo.</span><span class="sxs-lookup"><span data-stu-id="cb8bd-116">Because COM+ does not provide pass-by-value semantics for standard COM objects, the recorder and player need help from the component to marshal and unmarshal the object.</span></span>

<span data-ttu-id="cb8bd-117">Las referencias de objeto que admiten [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) se pueden usar como parámetros para llamadas a métodos en componentes en cola.</span><span class="sxs-lookup"><span data-stu-id="cb8bd-117">Object references that support [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) can be used as parameters to method calls on queued components.</span></span> <span data-ttu-id="cb8bd-118">El objeto no puede realizar suposiciones sobre cuándo se va a crear una instancia.</span><span class="sxs-lookup"><span data-stu-id="cb8bd-118">The object cannot make assumptions about when it will be reinstantiated.</span></span> <span data-ttu-id="cb8bd-119">Por ejemplo, puede que el servidor no esté disponible o que el componente del servidor no se inicie hasta más tarde en el día.</span><span class="sxs-lookup"><span data-stu-id="cb8bd-119">For example, the server may be unavailable or the server component may not be started until later in the day.</span></span> <span data-ttu-id="cb8bd-120">Los objetos que no admiten **IPersistStream** devolverán un error.</span><span class="sxs-lookup"><span data-stu-id="cb8bd-120">Objects that do not support **IPersistStream** will return an error.</span></span>

## <a name="visual-basic-persistable-objects"></a><span data-ttu-id="cb8bd-121">Visual Basic objetos que se conservan</span><span class="sxs-lookup"><span data-stu-id="cb8bd-121">Visual Basic Persistable Objects</span></span>

<span data-ttu-id="cb8bd-122">Microsoft Visual Basic 6 permite crear objetos con persistencia.</span><span class="sxs-lookup"><span data-stu-id="cb8bd-122">Microsoft Visual Basic 6 allows persistable objects to be created.</span></span> <span data-ttu-id="cb8bd-123">Estos objetos admiten [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) y se pueden pasar como parámetros a las llamadas a métodos de componentes en cola.</span><span class="sxs-lookup"><span data-stu-id="cb8bd-123">These objects support [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) and can be passed as parameters to queued component method calls.</span></span> <span data-ttu-id="cb8bd-124">Antes de que un objeto de Visual Basic se pueda pasar a un componente en cola, se debe inicializar el objeto que se puede guardar.</span><span class="sxs-lookup"><span data-stu-id="cb8bd-124">Before a Visual Basic object can be passed to a queued component, the persistable object must be initialized.</span></span> <span data-ttu-id="cb8bd-125">Esto puede realizarse de una de las dos maneras siguientes:</span><span class="sxs-lookup"><span data-stu-id="cb8bd-125">This can be done in one of the following two ways:</span></span>

-   <span data-ttu-id="cb8bd-126">Si la aplicación que crea el objeto persistente se escribe en Visual Basic, el motor en tiempo de ejecución de Visual Basic controla la inicialización del objeto automáticamente.</span><span class="sxs-lookup"><span data-stu-id="cb8bd-126">If the application creating the persistable object is written in Visual Basic, the Visual Basic runtime handles the object initialization automatically.</span></span>
-   <span data-ttu-id="cb8bd-127">Si la aplicación que crea el Visual Basic objeto con persistencia se escribe en un lenguaje distinto de Visual Basic, como Microsoft Visual C++, la aplicación debe inicializar explícitamente el componente consultando la interfaz [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) del objeto persistente o llamando al método [**IPersistStreamInit:: InitNew**](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-initnew)o [**IPersistStream:: Load**](/windows/desktop/api/objidl/nf-objidl-ipersiststream-load) .</span><span class="sxs-lookup"><span data-stu-id="cb8bd-127">If the application that creates the Visual Basic persistable object is written in a language other than Visual Basic, such as Microsoft Visual C++, the application must explicitly initialize the component by either querying for the persistable object's [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) interface or calling the [**IPersistStreamInit::InitNew**](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-initnew), or [**IPersistStream::Load**](/windows/desktop/api/objidl/nf-objidl-ipersiststream-load) method.</span></span>

## <a name="ado-recordsets-and-ole-db-rowsets"></a><span data-ttu-id="cb8bd-128">Conjuntos de registros ADO y conjuntos de filas de OLE DB</span><span class="sxs-lookup"><span data-stu-id="cb8bd-128">ADO Recordsets and OLE DB Rowsets</span></span>

<span data-ttu-id="cb8bd-129">Pasar objetos de **conjunto** de filas de ADO o OLE DB entre componentes permite que un componente procese los resultados de las consultas ejecutadas por otro componente.</span><span class="sxs-lookup"><span data-stu-id="cb8bd-129">Passing ADO **Recordset** or OLE DB rowset objects between components allows one component to process the results of queries executed by another component.</span></span> <span data-ttu-id="cb8bd-130">Esto resulta útil cuando se implementa una aplicación en varios equipos.</span><span class="sxs-lookup"><span data-stu-id="cb8bd-130">This is helpful when deploying an application across multiple computers.</span></span> <span data-ttu-id="cb8bd-131">Los objetos **Recordset** y Rowset se pueden pasar como parámetros de método a los componentes en cola, con las restricciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="cb8bd-131">**Recordset** and rowset objects can be passed as method parameters to queued components, with the following restrictions:</span></span>

-   <span data-ttu-id="cb8bd-132">No se pueden calcular las referencias de los objetos de **conjunto de registros** del lado servidor mediante [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream).</span><span class="sxs-lookup"><span data-stu-id="cb8bd-132">Server-side **Recordset** objects cannot be marshaled using [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream).</span></span> <span data-ttu-id="cb8bd-133">Solo los objetos de **conjunto de registros** del lado cliente se pueden pasar como parámetros a una llamada de método de componente en cola.</span><span class="sxs-lookup"><span data-stu-id="cb8bd-133">Only client-side **Recordset** objects can be passed as parameters to a queued component method call.</span></span>
-   <span data-ttu-id="cb8bd-134">Si trabaja directamente con OLE DB, el conjunto de filas OLE DB debe definirse como un conjunto de filas del lado cliente.</span><span class="sxs-lookup"><span data-stu-id="cb8bd-134">If you work directly with OLE DB, the OLE DB rowset must be defined as a client-side rowset.</span></span>

 

 
