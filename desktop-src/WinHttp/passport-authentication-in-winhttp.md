---
description: Los servicios HTTP de Microsoft Windows (WinHTTP) admiten por completo el uso del lado cliente del Protocolo de autenticación de Microsoft Passport. En este tema se proporciona información general sobre las transacciones implicadas en la autenticación de Passport y cómo controlarlas.
ms.assetid: 395d7aef-4da0-4664-8328-7d31ce58fedd
title: Autenticación de Passport en WinHTTP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7b8fc00217c7c14fbd4635fab68398d2056c1ea5
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104496889"
---
# <a name="passport-authentication-in-winhttp"></a><span data-ttu-id="7a86c-104">Autenticación de Passport en WinHTTP</span><span class="sxs-lookup"><span data-stu-id="7a86c-104">Passport Authentication in WinHTTP</span></span>

<span data-ttu-id="7a86c-105">Los servicios HTTP de Microsoft Windows (WinHTTP) admiten por completo el uso del lado cliente del Protocolo de autenticación de Microsoft Passport.</span><span class="sxs-lookup"><span data-stu-id="7a86c-105">Microsoft Windows HTTP Services (WinHTTP) fully support the client side use of the Microsoft Passport authentication protocol.</span></span> <span data-ttu-id="7a86c-106">En este tema se proporciona información general sobre las transacciones implicadas en la autenticación de Passport y cómo controlarlas.</span><span class="sxs-lookup"><span data-stu-id="7a86c-106">This topic provides an overview of the transactions involved in Passport authentication and how to handle them.</span></span>

> [!Note]  
> <span data-ttu-id="7a86c-107">En WinHTTP 5,1, la autenticación de Passport está deshabilitada de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="7a86c-107">In WinHTTP 5.1, Passport authentication is disabled by default.</span></span>

 

## <a name="passport-14"></a><span data-ttu-id="7a86c-108">Passport 1,4</span><span class="sxs-lookup"><span data-stu-id="7a86c-108">Passport 1.4</span></span>

<span data-ttu-id="7a86c-109">Passport es un componente básico de los servicios de bloques de creación de Microsoft .NET.</span><span class="sxs-lookup"><span data-stu-id="7a86c-109">Passport is a core component of the Microsoft .NET building block services.</span></span> <span data-ttu-id="7a86c-110">Permite a las empresas desarrollar y ofrecer servicios Web distribuidos a través de una amplia gama de aplicaciones y permite a sus miembros usar un nombre de inicio de sesión y una contraseña en todos los sitios web participantes.</span><span class="sxs-lookup"><span data-stu-id="7a86c-110">It enables businesses to develop and offer distributed Web services across a wide range of applications and enables its members to use one sign-in name and password at all participating Web sites.</span></span>

<span data-ttu-id="7a86c-111">WinHTTP proporciona compatibilidad con la plataforma para Microsoft Passport 1,4 mediante la implementación del protocolo del lado cliente para la autenticación de Passport 1,4.</span><span class="sxs-lookup"><span data-stu-id="7a86c-111">WinHTTP provides platform support for Microsoft Passport 1.4 by implementing the client-side protocol for Passport 1.4 authentication.</span></span> <span data-ttu-id="7a86c-112">Libera a las aplicaciones de los detalles de la interacción con la infraestructura de Passport y los nombres de usuario y contraseñas almacenados en Windows XP.</span><span class="sxs-lookup"><span data-stu-id="7a86c-112">It frees applications from the details of interacting with the Passport infrastructure and the Stored User Names and Passwords in Windows XP.</span></span> <span data-ttu-id="7a86c-113">Esta abstracción hace que el uso de Passport no sea diferente de la perspectiva de un desarrollador que el uso de esquemas de autenticación tradicionales como Basic o Digest.</span><span class="sxs-lookup"><span data-stu-id="7a86c-113">This abstraction makes using Passport no different from a developer's perspective than using traditional authentication schemes like Basic or Digest.</span></span>

<span data-ttu-id="7a86c-114">**Windows XP:** La clave del registro **HKCU \\ software \\ Microsoft \\ Windows \\ CurrentVersion \\ Internet Settings de \\ Passport \\ NumRegistrationRuns** identifica el número de veces que se muestra el Asistente de autenticación de Passport cuando se requiere la autenticación de Passport.</span><span class="sxs-lookup"><span data-stu-id="7a86c-114">**Windows XP:** The **HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Passport\\NumRegistrationRuns** registry key identifies the number of times the Passport Authentication Wizard is displayed when PassPort authentication is required.</span></span> <span data-ttu-id="7a86c-115">Si el valor de esta clave se establece en un número mayor que 5, no se muestra el asistente.</span><span class="sxs-lookup"><span data-stu-id="7a86c-115">If the value for this key is set to a number greater than 5, the wizard is not displayed.</span></span>

<span data-ttu-id="7a86c-116">En las secciones siguientes se describen las transacciones implicadas en la autenticación de Passport desde el punto de vista de una aplicación cliente.</span><span class="sxs-lookup"><span data-stu-id="7a86c-116">The following sections describe the transactions involved in Passport authentication from the point of view of a client application.</span></span> <span data-ttu-id="7a86c-117">Para el desarrollo de pasaporte del lado servidor, consulte la documentación de Passport SDK.</span><span class="sxs-lookup"><span data-stu-id="7a86c-117">For server-side Passport development, see the Passport SDK Documentation Overview.</span></span>

-   [<span data-ttu-id="7a86c-118">Solicitud inicial</span><span class="sxs-lookup"><span data-stu-id="7a86c-118">Initial Request</span></span>](#initial-request)
-   [<span data-ttu-id="7a86c-119">Servidor de inicio de sesión de Passport</span><span class="sxs-lookup"><span data-stu-id="7a86c-119">Passport Login Server</span></span>](#passport-login-server)
-   [<span data-ttu-id="7a86c-120">Solicitud autenticada</span><span class="sxs-lookup"><span data-stu-id="7a86c-120">Authenticated Request</span></span>](#authenticated-request)

### <a name="initial-request"></a><span data-ttu-id="7a86c-121">Solicitud inicial</span><span class="sxs-lookup"><span data-stu-id="7a86c-121">Initial Request</span></span>

<span data-ttu-id="7a86c-122">Cuando un cliente solicita un recurso en un servidor que requiere autenticación de Passport, el servidor comprueba la solicitud de presencia de [*vales*](glossary.md).</span><span class="sxs-lookup"><span data-stu-id="7a86c-122">When a client requests a resource on a server that requires Passport authentication, the server checks the request for the presence of [*tickets*](glossary.md).</span></span> <span data-ttu-id="7a86c-123">Si se envía un *vale* válido con la solicitud, el servidor responde con el recurso solicitado.</span><span class="sxs-lookup"><span data-stu-id="7a86c-123">If a valid *ticket* is sent with the request, the server responds with the requested resource.</span></span> <span data-ttu-id="7a86c-124">Si el *vale* no existe en el cliente, el servidor responde con un código de estado 302.</span><span class="sxs-lookup"><span data-stu-id="7a86c-124">If the *ticket* does not exist on the client, the server responds with a 302 status code.</span></span> <span data-ttu-id="7a86c-125">La respuesta incluye el encabezado Challenge, "WWW-Authenticate: Passport 1.4".</span><span class="sxs-lookup"><span data-stu-id="7a86c-125">The response includes the challenge header, "WWW-Authenticate: Passport1.4".</span></span> <span data-ttu-id="7a86c-126">Los clientes que no utilizan Passport pueden seguir el redireccionamiento al servidor de inicio de sesión de Passport.</span><span class="sxs-lookup"><span data-stu-id="7a86c-126">Clients that are not using Passport can follow the redirection to the Passport login server.</span></span> <span data-ttu-id="7a86c-127">Normalmente, los clientes más avanzados se pongan en contacto con el nexo de Passport para determinar la ubicación del servidor de inicio de sesión de Passport.</span><span class="sxs-lookup"><span data-stu-id="7a86c-127">More advanced clients typically contact the Passport nexus to determine the location of the Passport login server.</span></span>

> [!Note]  
> <span data-ttu-id="7a86c-128">El centro de la red Microsoft Passport es el *nexo* de Passport, que facilita la sincronización de sitios de participantes de Passport para garantizar que cada sitio tiene los detalles más recientes sobre la configuración de red y otros problemas.</span><span class="sxs-lookup"><span data-stu-id="7a86c-128">Central to the Microsoft Passport network is the Passport *Nexus*, which facilitates synchronization of Passport participant sites to assure that each site has the latest details on network configuration and other issues.</span></span> <span data-ttu-id="7a86c-129">Cada componente de Passport (Administrador de Passport, servidores de inicio de sesión, servidores de actualización, etc.) se comunica periódicamente con el nexo para recuperar la información que necesita para localizar y comunicarse correctamente con los demás componentes de la red de Passport.</span><span class="sxs-lookup"><span data-stu-id="7a86c-129">Each Passport component (Passport Manager, Login servers, Update servers, and so on) periodically communicates with the Nexus to retrieve the information it needs to locate, and properly communicate with, the other components in the Passport network.</span></span> <span data-ttu-id="7a86c-130">Esta información se recupera como un documento XML denominado documento de configuración de componentes o CCD.</span><span class="sxs-lookup"><span data-stu-id="7a86c-130">This information is retrieved as an XML document called a Component Configuration Document, or CCD.</span></span>

 

<span data-ttu-id="7a86c-131">La siguiente imagen muestra la solicitud inicial a una afiliada de Passport.</span><span class="sxs-lookup"><span data-stu-id="7a86c-131">The following image shows the initial request to a Passport affiliate.</span></span>

![imagen muestra la solicitud inicial a una afiliada de Passport.](images/art-passport1.png)

### <a name="passport-login-server"></a><span data-ttu-id="7a86c-133">Servidor de inicio de sesión de Passport</span><span class="sxs-lookup"><span data-stu-id="7a86c-133">Passport Login Server</span></span>

<span data-ttu-id="7a86c-134">Un servidor de inicio de sesión de Passport administra todas las solicitudes de [*vales*](glossary.md) de cualquier recurso de una *entidad de dominio* de Passport.</span><span class="sxs-lookup"><span data-stu-id="7a86c-134">A Passport login server handles all requests for [*tickets*](glossary.md) for any resource in a Passport *domain authority*.</span></span> <span data-ttu-id="7a86c-135">Antes de poder autenticar una solicitud mediante Passport, la aplicación cliente debe ponerse en contacto con el servidor de inicio de sesión para obtener los *vales* adecuados.</span><span class="sxs-lookup"><span data-stu-id="7a86c-135">Before a request can be authenticated using Passport, the client application must contact the login server to obtain the appropriate *tickets*.</span></span>

<span data-ttu-id="7a86c-136">Cuando un cliente solicita [*vales*](glossary.md) de un servidor de inicio de sesión de Passport, el servidor de inicio de sesión responde normalmente con un código de estado 401 para indicar que se deben proporcionar las credenciales del usuario.</span><span class="sxs-lookup"><span data-stu-id="7a86c-136">When a client requests [*tickets*](glossary.md) from a Passport login server, the login server typically responds with a 401 status code to indicate that user credentials must be provided.</span></span> <span data-ttu-id="7a86c-137">Cuando se proporcionan estas credenciales, el servidor de inicio de sesión responde con los *vales* necesarios para tener acceso al recurso especificado en el servidor que contiene el recurso solicitado originalmente.</span><span class="sxs-lookup"><span data-stu-id="7a86c-137">When these credentials are provided, the login server responds with the *tickets* required to access the specified resource on the server that contains the originally requested resource.</span></span> <span data-ttu-id="7a86c-138">El servidor de inicio de sesión también puede redirigir el cliente a otro servidor que pueda proporcionar el recurso solicitado.</span><span class="sxs-lookup"><span data-stu-id="7a86c-138">The login server can also redirect the client to another server that can provide the requested resource.</span></span>

![la imagen muestra una solicitud de vale de cliente a un servidor de inicio de sesión de Passport.](images/art-passport2.png)

### <a name="authenticated-request"></a><span data-ttu-id="7a86c-140">Solicitud autenticada</span><span class="sxs-lookup"><span data-stu-id="7a86c-140">Authenticated Request</span></span>

<span data-ttu-id="7a86c-141">Cuando el cliente tiene los [*vales*](glossary.md) que corresponden a un servidor determinado, dichos *vales* se incluyen con todas las solicitudes a ese servidor.</span><span class="sxs-lookup"><span data-stu-id="7a86c-141">When the client has the [*tickets*](glossary.md) that correspond to a given server, those *tickets* are included with all requests to that server.</span></span> <span data-ttu-id="7a86c-142">Si los *vales* no se han modificado desde que se recuperaron del servidor de inicio de sesión de Passport y los *vales* son válidos para el servidor de recursos, el servidor de recursos envía una respuesta que incluye el recurso y las cookies solicitados que indican que el usuario se autentica para futuras solicitudes.</span><span class="sxs-lookup"><span data-stu-id="7a86c-142">If the *tickets* have not been modified since they were retrieved from the Passport login server, and the *tickets* are valid for the resource server, the resource server sends a response that includes both the requested resource and cookies that indicate that the user is authenticated for future requests.</span></span>

<span data-ttu-id="7a86c-143">Las cookies adicionales de la respuesta están pensadas para acelerar el proceso de autenticación.</span><span class="sxs-lookup"><span data-stu-id="7a86c-143">The additional cookies in the response are intended to speed the authentication process.</span></span> <span data-ttu-id="7a86c-144">Las solicitudes adicionales en la misma sesión para los recursos de los servidores de la misma entidad de dominio de Passport incluyen estas cookies adicionales.</span><span class="sxs-lookup"><span data-stu-id="7a86c-144">Additional requests in the same session for resources on servers in the same Passport Domain Authority all include these additional cookies.</span></span> <span data-ttu-id="7a86c-145">No es necesario que las credenciales se envíen al servidor de inicio de sesión de nuevo hasta que expiren las cookies.</span><span class="sxs-lookup"><span data-stu-id="7a86c-145">Credentials do not need to be sent to the login server again until the cookies expire.</span></span>

![imagen muestra una solicitud autenticada al servidor de inicio de sesión de Passport.](images/art-passport3.png)

## <a name="using-passport-in-winhttp"></a><span data-ttu-id="7a86c-147">Usar Passport en WinHTTP</span><span class="sxs-lookup"><span data-stu-id="7a86c-147">Using Passport in WinHTTP</span></span>

<span data-ttu-id="7a86c-148">La autenticación de Passport en WinHTTP es muy similar a otros esquemas de autenticación.</span><span class="sxs-lookup"><span data-stu-id="7a86c-148">Passport authentication in WinHTTP is very similar to other authentication schemes.</span></span> <span data-ttu-id="7a86c-149">Vea [autenticación en WinHTTP](authentication-in-winhttp.md) para obtener información general sobre la autenticación en winhttp.</span><span class="sxs-lookup"><span data-stu-id="7a86c-149">See [Authentication in WinHTTP](authentication-in-winhttp.md) for an overview of authentication in WinHTTP.</span></span>

<span data-ttu-id="7a86c-150">En WinHTTP 5,1, la autenticación de Passport está deshabilitada de forma predeterminada y debe habilitarse explícitamente con [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) antes de su uso.</span><span class="sxs-lookup"><span data-stu-id="7a86c-150">In WinHTTP 5.1, Passport authentication is disabled by default and must be explicitly enabled with [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) before use.</span></span>

<span data-ttu-id="7a86c-151">WinHTTP controla muchos de los detalles de la transacción internamente para la autenticación de Passport.</span><span class="sxs-lookup"><span data-stu-id="7a86c-151">WinHTTP handles many of the transaction details internally for Passport authentication.</span></span> <span data-ttu-id="7a86c-152">Durante la solicitud inicial, el servidor responde con un código de estado 302 cuando se necesita autenticación.</span><span class="sxs-lookup"><span data-stu-id="7a86c-152">During the initial request, the server responds with a 302 status code when authentication is necessary.</span></span> <span data-ttu-id="7a86c-153">El código de estado 302 indica realmente una redirección y forma parte del protocolo Passport para la compatibilidad con versiones anteriores.</span><span class="sxs-lookup"><span data-stu-id="7a86c-153">The 302 status code actually indicates a redirection and is part of the Passport protocol for backwards compatibility.</span></span> <span data-ttu-id="7a86c-154">WinHTTP oculta el código de estado 302 y se pone en contacto con el nexo de Passport y, después, con el servidor de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="7a86c-154">WinHTTP hides the 302 status code and contacts the Passport nexus, and then the login server.</span></span> <span data-ttu-id="7a86c-155">La aplicación WinHTTP recibe una notificación del código de estado 401 enviado por el servidor de inicio de sesión para solicitar las credenciales de usuario.</span><span class="sxs-lookup"><span data-stu-id="7a86c-155">The WinHTTP application is notified of the 401 status code sent by the login server to request user credentials.</span></span> <span data-ttu-id="7a86c-156">Sin embargo, en la aplicación aparece como si el estado 401 fuera del servidor desde el que se solicitó el recurso.</span><span class="sxs-lookup"><span data-stu-id="7a86c-156">To the application, however, it appears as if the 401 status originates from the server from which the resource was requested.</span></span> <span data-ttu-id="7a86c-157">De esta manera, la aplicación WinHTTP no es consciente de las interacciones con otros servidores y puede controlar la autenticación de Passport con el mismo código que controla otros esquemas de autenticación.</span><span class="sxs-lookup"><span data-stu-id="7a86c-157">In this way, the WinHTTP application is unaware of interactions with other servers, and it can handle Passport authentication with the same code that handles other authentication schemes.</span></span>

<span data-ttu-id="7a86c-158">Normalmente, una aplicación WinHTTP responde a un código de estado 401 proporcionando credenciales de autenticación.</span><span class="sxs-lookup"><span data-stu-id="7a86c-158">Typically, a WinHTTP application responds to a 401 status code by supplying authentication credentials.</span></span> <span data-ttu-id="7a86c-159">Cuando las credenciales se suministran con [**WinHttpSetCredentials**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetcredentials) o [**SetCredentials**](iwinhttprequest-setcredentials.md) para la autenticación de Passport, las credenciales se envían realmente al servidor de inicio de sesión, no al servidor indicado en la solicitud.</span><span class="sxs-lookup"><span data-stu-id="7a86c-159">When credentials are supplied with [**WinHttpSetCredentials**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetcredentials) or [**SetCredentials**](iwinhttprequest-setcredentials.md) for passport authentication, the credentials are actually being sent to the login server, not to the server indicated in the request.</span></span>

<span data-ttu-id="7a86c-160">Sin embargo, cuando se responde a un código de estado 407, una aplicación WinHTTP debe usar [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) para proporcionar credenciales de proxy, en lugar de [**WinHttpSetCredentials**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetcredentials).</span><span class="sxs-lookup"><span data-stu-id="7a86c-160">However, when responding to a 407 status code, a WinHTTP application must use [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) to provide proxy credentials, rather than [**WinHttpSetCredentials**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetcredentials).</span></span> <span data-ttu-id="7a86c-161">Dado que **WinHttpSetOption** es una manera menos segura de proporcionar credenciales, normalmente se debe evitar.</span><span class="sxs-lookup"><span data-stu-id="7a86c-161">Because **WinHttpSetOption** is a less secure way to supply credentials, it should normally be avoided.</span></span>

<span data-ttu-id="7a86c-162">Una vez recuperados, los [*vales*](glossary.md) se administran internamente y se envían automáticamente a los servidores correspondientes en solicitudes futuras.</span><span class="sxs-lookup"><span data-stu-id="7a86c-162">Once retrieved, [*tickets*](glossary.md) are managed internally and are automatically sent to applicable servers in future requests.</span></span>

> [!Note]  
> <span data-ttu-id="7a86c-163">WinHTTP le permite deshabilitar el redireccionamiento automático mediante una llamada a la función [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) para la [**\_ opción WinHTTP \_ deshabilitar \_**](option-flags.md) la marca de características y especificar un valor de [**WinHTTP \_ Disable \_ redirects**](option-flags.md).</span><span class="sxs-lookup"><span data-stu-id="7a86c-163">WinHTTP enables you to disable automatic redirection by calling the [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) function for the [**WINHTTP\_OPTION\_DISABLE\_FEATURE**](option-flags.md) flag and specifying a value of [**WINHTTP\_DISABLE\_REDIRECTS**](option-flags.md).</span></span> <span data-ttu-id="7a86c-164">Deshabilitar el redireccionamiento no interfiere con la redirección que WinHTTP controla internamente para las transacciones de Passport.</span><span class="sxs-lookup"><span data-stu-id="7a86c-164">Disabling redirection does not interfere with the redirection that WinHTTP handles internally for Passport transactions.</span></span>

 

<span data-ttu-id="7a86c-165">WinHTTP puede completar correctamente la autenticación de Passport aunque una aplicación deshabilite la redirección automática.</span><span class="sxs-lookup"><span data-stu-id="7a86c-165">WinHTTP can successfully complete the Passport authentication even if an application disables auto redirection.</span></span> <span data-ttu-id="7a86c-166">Sin embargo, una vez completada la autenticación de Passport, se debe producir una redirección implícita desde la dirección URL del servidor de inicio de sesión de Passport de nuevo a la dirección URL original.</span><span class="sxs-lookup"><span data-stu-id="7a86c-166">However, after the Passport authentication is complete, an implicit redirect must occur from the Passport login server URL back to the original URL.</span></span> <span data-ttu-id="7a86c-167">Una respuesta HTTP 302 no desencadena esta redirección, pero está implícita en el protocolo Passport.</span><span class="sxs-lookup"><span data-stu-id="7a86c-167">This redirect is not triggered by a 302 HTTP response, but is implicit in the Passport protocol.</span></span>

<span data-ttu-id="7a86c-168">WinHTTP controla este redireccionamiento implícito de forma especial.</span><span class="sxs-lookup"><span data-stu-id="7a86c-168">WinHTTP handles this implicit redirect specially.</span></span> <span data-ttu-id="7a86c-169">Si una aplicación ha deshabilitado el redireccionamiento automático, WinHTTP requiere que la aplicación proporcione "permiso" de WinHTTP para redirigir automáticamente en este caso especial.</span><span class="sxs-lookup"><span data-stu-id="7a86c-169">If an application has disabled automatic redirection, WinHTTP requires that the application give WinHTTP "permission" to redirect automatically in this special case.</span></span>

<span data-ttu-id="7a86c-170">Para hacer que WinHTTP redirija a la dirección URL original después de la autenticación, la aplicación debe registrar una función de devolución de llamada mediante [**WinHttpSetStatusCallback**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetstatuscallback).</span><span class="sxs-lookup"><span data-stu-id="7a86c-170">In order to have WinHTTP redirect back to the original URL after authentication, the application must register a callback function using [**WinHttpSetStatusCallback**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetstatuscallback).</span></span> <span data-ttu-id="7a86c-171">A continuación, WinHTTP puede notificar a la aplicación con una \_ devolución de llamada de REdirección de estado de devolución de llamada \_ de WinHTTP \_ , que permite a la aplicación cancelar la redirección.</span><span class="sxs-lookup"><span data-stu-id="7a86c-171">WinHTTP can then notify the application with a WINHTTP\_CALLBACK\_STATUS\_REDIRECT callback, which allows the application to cancel the redirect.</span></span> <span data-ttu-id="7a86c-172">No es necesario que una aplicación proporcione ninguna funcionalidad en la función de devolución de llamada. el registro de la devolución de llamada es suficiente para permitir que WinHTTP siga esta redirección de casos especiales.</span><span class="sxs-lookup"><span data-stu-id="7a86c-172">An application does not need to provide any functionality in the callback function; registration of the callback is sufficient to enable WinHTTP to follow this special-case redirect.</span></span>

<span data-ttu-id="7a86c-173">El mensaje de error de \_ Inicio de sesión de WinHTTP \_ \_ se genera si la aplicación no establece una función de devolución de llamada.</span><span class="sxs-lookup"><span data-stu-id="7a86c-173">The ERROR\_WINHTTP\_LOGIN\_FAILURE message is generated if a callback function is not set by the application.</span></span>

### <a name="passport-cobranding"></a><span data-ttu-id="7a86c-174">Personalización de marca de Passport</span><span class="sxs-lookup"><span data-stu-id="7a86c-174">Passport Cobranding</span></span>

<span data-ttu-id="7a86c-175">A diferencia de los esquemas de autenticación tradicionales que admite WinHTTP, Passport puede tener una [*copersonalización*](glossary.md)ampliada.</span><span class="sxs-lookup"><span data-stu-id="7a86c-175">Unlike traditional authentication schemes supported by WinHTTP, Passport can be extensively [*cobranded*](glossary.md).</span></span> <span data-ttu-id="7a86c-176">Al recibir un código de estado 401 que indica un desafío, una aplicación puede recuperar el texto y el gráfico de *copersonalización de marca* .</span><span class="sxs-lookup"><span data-stu-id="7a86c-176">Upon receiving a 401 status code that indicates a challenge, an application can retrieve the *cobranding* graphic and text.</span></span> <span data-ttu-id="7a86c-177">Recupere una dirección URL para el gráfico de *copersonalización* mediante una llamada a [**WinHttpQueryOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryoption) con la \_ opción WinHTTP \_ \_ dirección URL de copersonalización de marca de Passport \_ .</span><span class="sxs-lookup"><span data-stu-id="7a86c-177">Retrieve a URL for the *cobranding* graphic by calling [**WinHttpQueryOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryoption) with the WINHTTP\_OPTION\_PASSPORT\_COBRANDING\_URL flag.</span></span> <span data-ttu-id="7a86c-178">Recupere el texto de la *Personalización de marca* mediante una llamada a [**WinHttpQueryOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryoption) con la opción de WinHTTP de \_ \_ \_ copersonalización de marca de Passport \_ .</span><span class="sxs-lookup"><span data-stu-id="7a86c-178">Retrieve the *cobranding* text by calling [**WinHttpQueryOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryoption) with the WINHTTP\_OPTION\_PASSPORT\_COBRANDING\_TEXT flag.</span></span> <span data-ttu-id="7a86c-179">Estos elementos se pueden usar para personalizar un cuadro de diálogo de recopilación de credenciales.</span><span class="sxs-lookup"><span data-stu-id="7a86c-179">These items can be used to customize a credential-gathering dialog.</span></span>

### <a name="stored-user-names-and-passwords"></a><span data-ttu-id="7a86c-180">Nombres de usuarios y contraseñas almacenados</span><span class="sxs-lookup"><span data-stu-id="7a86c-180">Stored User Names and Passwords</span></span>

<span data-ttu-id="7a86c-181">Windows XP presentó el concepto de nombres de usuario y contraseñas almacenados.</span><span class="sxs-lookup"><span data-stu-id="7a86c-181">Windows XP introduced the concept of Stored User Names and Passwords.</span></span> <span data-ttu-id="7a86c-182">Si las credenciales de Passport de un usuario se guardan mediante el **Asistente para registro de Passport** o el **cuadro de diálogo credencial** estándar, se guardan en los nombres de usuario y contraseñas almacenados.</span><span class="sxs-lookup"><span data-stu-id="7a86c-182">If a user's Passport credentials are saved through the **Passport Registration Wizard** or the standard **Credential Dialog**, it is saved in the Stored User Names and Passwords.</span></span> <span data-ttu-id="7a86c-183">Al usar WinHTTP en Windows XP o versiones posteriores, WinHTTP usa automáticamente las credenciales en los nombres de usuario y contraseñas almacenados si no se establecen explícitamente las credenciales.</span><span class="sxs-lookup"><span data-stu-id="7a86c-183">When using WinHTTP on Windows XP or later, WinHTTP automatically uses the credentials in the Stored User Names and Passwords if credentials are not explicitly set.</span></span> <span data-ttu-id="7a86c-184">Esto es similar a la compatibilidad con las credenciales de inicio de sesión predeterminadas para NTLM/Kerberos.</span><span class="sxs-lookup"><span data-stu-id="7a86c-184">This is similar to the support of default logon credentials for NTLM/Kerberos.</span></span> <span data-ttu-id="7a86c-185">Sin embargo, el uso de las credenciales predeterminadas de Passport no está sujeto a la configuración de la Directiva de inicio de sesión automático.</span><span class="sxs-lookup"><span data-stu-id="7a86c-185">However, use of default Passport credentials is not subject to the automatic logon policy settings.</span></span>

### <a name="disabling-passport-authentication"></a><span data-ttu-id="7a86c-186">Deshabilitación de la autenticación de Passport</span><span class="sxs-lookup"><span data-stu-id="7a86c-186">Disabling Passport Authentication</span></span>

<span data-ttu-id="7a86c-187">Es posible que algunas aplicaciones requieran la posibilidad de deshabilitar la autenticación de Passport.</span><span class="sxs-lookup"><span data-stu-id="7a86c-187">Some applications might require the ability to disable Passport authentication.</span></span> <span data-ttu-id="7a86c-188">Por ejemplo, cuando una filial de Passport responde con el código de estado 302 inicial, podría ser preferible seguir el redireccionamiento indicado y representar la página de autenticación de Passport HTML en lugar de permitir que WinHTTP controle la autenticación internamente.</span><span class="sxs-lookup"><span data-stu-id="7a86c-188">For example, when a Passport affiliate responds with the initial 302 status code, it might be preferable to follow the indicated redirection and render the HTML Passport authentication page rather than allowing WinHTTP to handle the authentication internally.</span></span> <span data-ttu-id="7a86c-189">La autenticación de Passport está deshabilitada en WinHTTP mediante una llamada a la función [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) con la \_ opción WinHTTP \_ configure \_ Passport \_ auth y pasando el valor WinHTTP \_ Disable \_ Passport \_ auth.</span><span class="sxs-lookup"><span data-stu-id="7a86c-189">Passport authentication is disabled in WinHTTP by calling the [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) function with the WINHTTP\_OPTION\_CONFIGURE\_PASSPORT\_AUTH option and passing the value WINHTTP\_DISABLE\_PASSPORT\_AUTH.</span></span> <span data-ttu-id="7a86c-190">Posteriormente, se puede volver a habilitar con WINHTTP \_ habilitar \_ Passport \_ auth.</span><span class="sxs-lookup"><span data-stu-id="7a86c-190">It can later be re-enabled with WINHTTP\_ENABLE\_PASSPORT\_AUTH.</span></span>

<span data-ttu-id="7a86c-191">No se puede deshabilitar la autenticación de Passport cuando se usa el objeto [**WinHttpRequest**](winhttprequest.md) .</span><span class="sxs-lookup"><span data-stu-id="7a86c-191">Passport authentication cannot be disabled when using the [**WinHttpRequest**](winhttprequest.md) object.</span></span>

<span data-ttu-id="7a86c-192">Como se indicó anteriormente en esta sección, la autenticación de Passport está deshabilitada de forma predeterminada en WinHTTP 5,1 y debe habilitarse explícitamente con [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) antes de su uso.</span><span class="sxs-lookup"><span data-stu-id="7a86c-192">As noted earlier in this section, Passport authentication is disabled by default in WinHTTP 5.1, and must be explicitly enabled with [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) before use.</span></span>

## <a name="passport-configuration-overrides-used-for-testing"></a><span data-ttu-id="7a86c-193">Invalidaciones de configuración de Passport utilizadas para las pruebas</span><span class="sxs-lookup"><span data-stu-id="7a86c-193">Passport Configuration Overrides Used for Testing</span></span>

<span data-ttu-id="7a86c-194">WinHTTP se basa en la información de configuración que descarga del servidor de Passport Nexus para admitir la autenticación de Passport 1,4.</span><span class="sxs-lookup"><span data-stu-id="7a86c-194">WinHTTP relies on the configuration information it downloads from the passport nexus server to support Passport 1.4 authentication.</span></span> <span data-ttu-id="7a86c-195">De forma predeterminada, este servidor seguro (SSL) es nexus.passport.com y el recurso de configuración es RDR/pprdr. asp, que se conoce como la configuración de Passport "activa".</span><span class="sxs-lookup"><span data-stu-id="7a86c-195">By default this secure (SSL) server is nexus.passport.com, and the configuration resource is rdr/pprdr.asp, which is known as the "live" passport configuration.</span></span> <span data-ttu-id="7a86c-196">El formato de la información es un encabezado HTTP personalizado "PassportURLs", seguido de pares de atributo-valor delimitados por comas.</span><span class="sxs-lookup"><span data-stu-id="7a86c-196">The format of the information is a custom HTTP header "PassportURLs", followed by comma delimited attribute-value pairs.</span></span>

<span data-ttu-id="7a86c-197">Por ejemplo, " https://nexus.passport.com/rdr/pprdr.asp " devuelve la siguiente información de configuración:</span><span class="sxs-lookup"><span data-stu-id="7a86c-197">For example, "https://nexus.passport.com/rdr/pprdr.asp" returns the following configuration information:</span></span>

``` syntax
PassportURLs: DARealm=Passport.net,
DALogin=login.passport.com/login2.asp,
DAReg=https://register.passport.com/defaultwiz.asp,
Properties=https://memberservices.passport.com/ppsecure/MSRV_EditProfile.asp,
Privacy=https://www.passport.com/consumer/privacypolicy.asp,
GeneralRedir=https://nexusrdr.passport.com/redir.asp,
Help=https://memberservices.passport.com/UI/MSRV_UI_Help.asp,
ConfigVersion=2
\r\n
```

<span data-ttu-id="7a86c-198">Las partes que son relevantes para WinHTTP son DARealm, DALogin y ConfigVersion.</span><span class="sxs-lookup"><span data-stu-id="7a86c-198">The parts that are relevant to WinHTTP are DARealm, DALogin, and ConfigVersion.</span></span> <span data-ttu-id="7a86c-199">Por motivos de rendimiento, se almacenan en memoria caché mientras dure una sesión de WinHTTP.</span><span class="sxs-lookup"><span data-stu-id="7a86c-199">For performance reasons, they are cached for the lifetime of a WinHTTP session.</span></span> <span data-ttu-id="7a86c-200">Estos tres valores pueden ser invalidados por aplicaciones que son necesarias para trabajar con otra infraestructura de Passport distinta de la configuración de producción "activa" cambiando la configuración del registro adecuada en</span><span class="sxs-lookup"><span data-stu-id="7a86c-200">These three values can be overridden by applications that are required to work with another passport infrastructure other than the "live" production setup by changing the appropriate registry settings under</span></span>

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Microsoft
         Windows
            CurrentVersion
               Internet Settings
                  WinHttp
                     Passport Test
```

``` syntax
LoginServerRealm (REG_SZ)    For example: abc.net
LoginServerUrl (REG_SZ)      For example: https://private-login.passport.com/login2.asp
ConfigVersion (REG_DWORD)    For example: 10
```

<span data-ttu-id="7a86c-201">Si LoginServerUrl está presente en el registro, WinHTTP no se pone en contacto con el servidor de Nexus para obtener otros valores de configuración.</span><span class="sxs-lookup"><span data-stu-id="7a86c-201">If LoginServerUrl is present in the registry, WinHTTP does not contact the nexus server for other configuration values.</span></span> <span data-ttu-id="7a86c-202">En este caso, LoginServerRealm y ConfigVersion también se deben establecer en el registro para corregir los valores.</span><span class="sxs-lookup"><span data-stu-id="7a86c-202">In this case, LoginServerRealm and ConfigVersion should also be set through the registry to correct values.</span></span>

<span data-ttu-id="7a86c-203">Una aplicación puede, con fines de prueba, ser necesaria para descargar la configuración de Passport de un servidor de Nexus privado.</span><span class="sxs-lookup"><span data-stu-id="7a86c-203">An application may, for testing purposes, be required to download passport configuration from a private nexus server.</span></span> <span data-ttu-id="7a86c-204">Esto puede hacerse invalidando dos valores del registro en</span><span class="sxs-lookup"><span data-stu-id="7a86c-204">This can be done by overriding two registry values under</span></span>

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Microsoft
         Windows
            CurrentVersion
               Internet Settings
                  WinHttp
                     Passport Test
```

``` syntax
NexusHost (REG_SZ)    e.g. private-nexus.passport.com
NexusObj(REG_SZ)      e.g. config/passport.asp
```

## <a name="related-topics"></a><span data-ttu-id="7a86c-205">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="7a86c-205">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="7a86c-206">Autenticación en WinHTTP</span><span class="sxs-lookup"><span data-stu-id="7a86c-206">Authentication in WinHTTP</span></span>](authentication-in-winhttp.md)
</dt> </dl>

 

 



