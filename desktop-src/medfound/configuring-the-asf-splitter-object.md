---
description: Configurar el objeto divisor de ASF
ms.assetid: 8e2ba659-e1f6-42be-afd6-21fc841dc8d3
title: Configurar el objeto divisor de ASF
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 14f27885e602dd52012808d330d997f9b7a7e983
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104153666"
---
# <a name="configuring-the-asf-splitter-object"></a><span data-ttu-id="73470-103">Configurar el objeto divisor de ASF</span><span class="sxs-lookup"><span data-stu-id="73470-103">Configuring the ASF Splitter Object</span></span>

<span data-ttu-id="73470-104">El objeto de *separador* ASF es un objeto de capa WMContainer que analiza el objeto de datos ASF de un archivo de formato de sistema avanzado (ASF).</span><span class="sxs-lookup"><span data-stu-id="73470-104">The ASF *splitter* object is a WMContainer layer object that parses the ASF Data Object of an Advanced Systems Format (ASF) file.</span></span> <span data-ttu-id="73470-105">Una vez creado e inicializado el divisor para analizar el objeto de datos ASF de un archivo multimedia, el divisor debe configurarse para generar ejemplos para flujos concretos.</span><span class="sxs-lookup"><span data-stu-id="73470-105">After the splitter is created and initialized to parse the ASF Data Object of a media file, the splitter must be configured to generate samples for specific streams.</span></span> <span data-ttu-id="73470-106">Llame a [**IMFASFSplitter:: SelectStreams**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-selectstreams) para seleccionar los flujos necesarios.</span><span class="sxs-lookup"><span data-stu-id="73470-106">Call [**IMFASFSplitter::SelectStreams**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-selectstreams) to select the required streams.</span></span>

<span data-ttu-id="73470-107">Opcionalmente, una aplicación también puede configurarla para generar ejemplos en orden inverso o generar ejemplos para contenido protegido.</span><span class="sxs-lookup"><span data-stu-id="73470-107">Optionally, an application can also configure it to generate samples in reverse order or generate samples for protected content.</span></span> <span data-ttu-id="73470-108">Para establecer estas opciones, llame a [**IMFASFSplitter:: SetFlags**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-setflags) y pase la combinación bit a bit necesaria de las marcas admitidas.</span><span class="sxs-lookup"><span data-stu-id="73470-108">To set these options, call [**IMFASFSplitter::SetFlags**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-setflags) and pass the required bitwise combination of the supported flags.</span></span> <span data-ttu-id="73470-109">Antes de llamar a este método, el cliente debe completar la llamada a [**IMFASFSplitter:: Initialize**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-initialize) correctamente; en caso contrario, se produce un error en **SetFlags** con el código de error de **MF \_ E \_ no \_ inicializado** .</span><span class="sxs-lookup"><span data-stu-id="73470-109">Before calling this method, the client must complete the [**IMFASFSplitter::Initialize**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-initialize) call successfully; otherwise, **SetFlags** fails with **MF\_E\_NOT\_INITIALIZED** error code.</span></span> <span data-ttu-id="73470-110">Para obtener información sobre cómo inicializar el divisor, vea [crear el objeto divisor de ASF](creating-the-asf-splitter-object.md).</span><span class="sxs-lookup"><span data-stu-id="73470-110">For information about initializing the splitter, see [Creating the ASF Splitter Object](creating-the-asf-splitter-object.md).</span></span>

<span data-ttu-id="73470-111">Para comprobar si esta marca está establecida actualmente en el divisor, llame a [**IMFASFSplitter:: GetFlags**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-getflags).</span><span class="sxs-lookup"><span data-stu-id="73470-111">To check whether this flag is currently set on the splitter, call [**IMFASFSplitter::GetFlags**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-getflags).</span></span>

## <a name="selecting-streams-for-parsing"></a><span data-ttu-id="73470-112">Seleccionar secuencias para el análisis</span><span class="sxs-lookup"><span data-stu-id="73470-112">Selecting Streams for Parsing</span></span>

<span data-ttu-id="73470-113">Durante el proceso de inicialización a través de la llamada a [**IMFASFSplitter:: Initialize**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-initialize) , el divisor detecta el número de secuencias y los identificadores de flujo en el archivo ASF.</span><span class="sxs-lookup"><span data-stu-id="73470-113">During the initialization process through [**IMFASFSplitter::Initialize**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-initialize) call, the splitter detects the number of streams and the stream identifiers in the ASF file.</span></span> <span data-ttu-id="73470-114">De forma predeterminada, el divisor selecciona ningún flujo.</span><span class="sxs-lookup"><span data-stu-id="73470-114">By default, no streams are selected by the splitter.</span></span> <span data-ttu-id="73470-115">La aplicación debe seleccionar los flujos mediante una llamada a [**IMFASFSplitter:: SelectStreams**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-selectstreams).</span><span class="sxs-lookup"><span data-stu-id="73470-115">The application must select the streams by calling [**IMFASFSplitter::SelectStreams**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-selectstreams).</span></span> <span data-ttu-id="73470-116">Este método toma una matriz de números de secuencia.</span><span class="sxs-lookup"><span data-stu-id="73470-116">This method takes an array of stream numbers.</span></span> <span data-ttu-id="73470-117">Para obtener el número de secuencia de una secuencia, llame a [**IMFASFProfile:: GetStream**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfprofile-getstream) en el perfil ASF o llame a [**IMFStreamDescriptor:: GetStreamIdentifier**](/windows/desktop/api/mfidl/nf-mfidl-imfstreamdescriptor-getstreamidentifier) en el descriptor de flujo.</span><span class="sxs-lookup"><span data-stu-id="73470-117">To get the stream number for a stream, call [**IMFASFProfile::GetStream**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfprofile-getstream) on the ASF profile or call [**IMFStreamDescriptor::GetStreamIdentifier**](/windows/desktop/api/mfidl/nf-mfidl-imfstreamdescriptor-getstreamidentifier) on the stream descriptor.</span></span> <span data-ttu-id="73470-118">(Puede obtener el perfil ASF y el descriptor de secuencia del objeto ContentInfo). Si el cliente pasa un número de secuencia que el divisor no reconoce, se produce un error **de \_ \_ INVALIDSTREAMNUMBER MF E** .</span><span class="sxs-lookup"><span data-stu-id="73470-118">(You can obtain both the ASF profile and the stream descriptor from the ContentInfo object.) If the client passes a stream number that is not recognized by the splitter, it fails with a **MF\_E\_INVALIDSTREAMNUMBER** error.</span></span>

<span data-ttu-id="73470-119">Al llamar a [**SelectStreams**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-selectstreams) se borran las selecciones anteriores.</span><span class="sxs-lookup"><span data-stu-id="73470-119">Calling [**SelectStreams**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-selectstreams) clears the previous selections.</span></span> <span data-ttu-id="73470-120">No se selecciona ningún flujo que no se haya especificado en la matriz.</span><span class="sxs-lookup"><span data-stu-id="73470-120">Any stream that is not specified in the array is not selected.</span></span> <span data-ttu-id="73470-121">Para obtener una lista de las secuencias que están seleccionadas actualmente, llame a [**IMFASFSplitter:: GetSelectedStreams**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-getselectedstreams).</span><span class="sxs-lookup"><span data-stu-id="73470-121">To get a list of streams that are currently selected, call [**IMFASFSplitter::GetSelectedStreams**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-getselectedstreams).</span></span> <span data-ttu-id="73470-122">Este método toma un puntero a una matriz, que el método rellena con los números de secuencia.</span><span class="sxs-lookup"><span data-stu-id="73470-122">This method takes a pointer to an array, which the method fills with the stream numbers.</span></span> <span data-ttu-id="73470-123">Si el tamaño de la matriz es menor que el número de secuencias seleccionadas, se produce un error en el método con el error **MF \_ E \_ BUFFERTOOSMALL** .</span><span class="sxs-lookup"><span data-stu-id="73470-123">If the array size is less than the number of selected streams, the method fails with the **MF\_E\_BUFFERTOOSMALL** error.</span></span> <span data-ttu-id="73470-124">En este caso, el método devuelve el número de secuencias seleccionadas en el parámetro *pwNumStreams* .</span><span class="sxs-lookup"><span data-stu-id="73470-124">In this case, the method returns the number of selected streams in the *pwNumStreams* parameter.</span></span> <span data-ttu-id="73470-125">Después, puede usar este número para asignar una matriz del tamaño correcto y volver a llamar al método.</span><span class="sxs-lookup"><span data-stu-id="73470-125">You can then use this number to allocate an array of the correct size and call the method again.</span></span>

<span data-ttu-id="73470-126">Para obtener código de ejemplo, vea "seleccionar una secuencia para el análisis" en [Tutorial: leer un archivo ASF](tutorial--reading-an-asf-file.md).</span><span class="sxs-lookup"><span data-stu-id="73470-126">For example code, see "Select a Stream for Parsing" in [Tutorial: Reading an ASF File](tutorial--reading-an-asf-file.md).</span></span>

## <a name="reverse-playback-setting"></a><span data-ttu-id="73470-127">Configuración de reproducción inversa</span><span class="sxs-lookup"><span data-stu-id="73470-127">Reverse Playback Setting</span></span>

<span data-ttu-id="73470-128">Durante el proceso de inicialización del divisor, determina si el contenido ASF admite la reproducción inversa.</span><span class="sxs-lookup"><span data-stu-id="73470-128">During the initialization process of the splitter, it determines if the ASF content supports reverse playback.</span></span> <span data-ttu-id="73470-129">Si es así, el divisor puede configurarse para generar ejemplos en orden inverso estableciendo la marca de **\_ \_ reverso del divisor MFASF** .</span><span class="sxs-lookup"><span data-stu-id="73470-129">If it does, the splitter can be configured to generate samples in reverse order by setting the **MFASF\_SPLITTER\_REVERSE** flag.</span></span> <span data-ttu-id="73470-130">Si el contenido no admite la reproducción inversa, [**IMFASFSplitter:: SetFlags**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-setflags) devuelve **MF \_ E \_ INVALIDREQUEST**, pero la marca se establece en el divisor.</span><span class="sxs-lookup"><span data-stu-id="73470-130">If the content does not support reverse playback, the [**IMFASFSplitter::SetFlags**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-setflags) returns **MF\_E\_INVALIDREQUEST**, but the flag is set on the splitter.</span></span>

<span data-ttu-id="73470-131">Si el divisor está configurado para analizar en dirección inversa, el divisor siempre comienza el análisis al final del búfer que contiene el objeto de datos ASF.</span><span class="sxs-lookup"><span data-stu-id="73470-131">If the splitter is configured to parse in the reverse direction, then the splitter always starts parsing at the end of the buffer that contains the ASF Data Object.</span></span> <span data-ttu-id="73470-132">Por lo tanto, para el análisis inverso, el desplazamiento de los datos y la longitud de los datos que se van a analizar deben establecerse de forma adecuada.</span><span class="sxs-lookup"><span data-stu-id="73470-132">Therefore, for reverse parsing the data offset and the length of the data to parse must be set appropriately.</span></span> <span data-ttu-id="73470-133">Para obtener información acerca de cómo establecer los valores correctos, vea [generar ejemplos de secuencias a partir de un objeto de datos ASF existente](generating-stream-samples-from-an-existing-asf-data-object.md).</span><span class="sxs-lookup"><span data-stu-id="73470-133">For information about setting the correct values, see [Generating Stream Samples from an Existing ASF Data Object](generating-stream-samples-from-an-existing-asf-data-object.md).</span></span>

## <a name="protected-content-setting"></a><span data-ttu-id="73470-134">Configuración de contenido protegido</span><span class="sxs-lookup"><span data-stu-id="73470-134">Protected Content Setting</span></span>

<span data-ttu-id="73470-135">El divisor puede configurarse para trabajar con el contenido de cifrado de nivel de paquete estableciendo el **\_ divisor de MFASF \_ WMDRM** a través de [**IMFASFSplitter:: SetFlags**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-setflags).</span><span class="sxs-lookup"><span data-stu-id="73470-135">The splitter can be configured to work with packet-level encryption content by setting the **MFASF\_SPLITTER\_WMDRM** through [**IMFASFSplitter::SetFlags**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-setflags).</span></span> <span data-ttu-id="73470-136">Esto indica al divisor que proporcione ejemplos de contenido protegido por Rights Management digital (DRM) de Windows Media.</span><span class="sxs-lookup"><span data-stu-id="73470-136">This instructs the splitter to deliver samples for content that is protected by Windows Media Digital Rights Management (DRM).</span></span> <span data-ttu-id="73470-137">Cuando se establece esta marca, los ejemplos generados por el divisor contienen información necesaria para descifrar los datos multimedia y reconstruir los fotogramas, como el atributo [**\_ PacketCrossOffsets de MFSampleExtension**](mfsampleextension-packetcrossoffsets-attribute.md) .</span><span class="sxs-lookup"><span data-stu-id="73470-137">When this flag is set, the samples generated by the splitter contain information required to decrypt media data and reconstruct the frames, such as the [**MFSampleExtension\_PacketCrossOffsets**](mfsampleextension-packetcrossoffsets-attribute.md) attribute.</span></span> <span data-ttu-id="73470-138">Este atributo es un BLOB que contiene una matriz de **DWORD** s.</span><span class="sxs-lookup"><span data-stu-id="73470-138">This attribute is a blob that contains an array of **DWORD** s.</span></span> <span data-ttu-id="73470-139">Cada **DWORD** proporciona los límites de carga para el marco con respecto al principio del marco.</span><span class="sxs-lookup"><span data-stu-id="73470-139">Each **DWORD** provides you the payload boundaries for the frame relative to the beginning of the frame.</span></span> <span data-ttu-id="73470-140">Si este atributo no está presente, el marco se incluye en una sola carga.</span><span class="sxs-lookup"><span data-stu-id="73470-140">If this attribute is not present, the frame is contained in a single payload.</span></span> <span data-ttu-id="73470-141">Normalmente, los ejemplos generados por el divisor contienen varios búferes multimedia, la aplicación puede copiar todos los búferes en un búfer contiguo mediante una llamada a [**IMFSample:: ConvertToContiguousBuffer**](/windows/desktop/api/mfobjects/nf-mfobjects-imfsample-converttocontiguousbuffer).</span><span class="sxs-lookup"><span data-stu-id="73470-141">Typically, the samples generated by the splitter contain multiple media buffers, the application can copy all the buffers into one contiguous buffer by calling [**IMFSample::ConvertToContiguousBuffer**](/windows/desktop/api/mfobjects/nf-mfobjects-imfsample-converttocontiguousbuffer).</span></span> <span data-ttu-id="73470-142">El búfer resultante contiene el marco y el valor del atributo contiene los desplazamientos en este búfer.</span><span class="sxs-lookup"><span data-stu-id="73470-142">The resulting buffer contains the frame and the attribute value contains offsets into this buffer.</span></span>

## <a name="related-topics"></a><span data-ttu-id="73470-143">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="73470-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="73470-144">Divisor ASF</span><span class="sxs-lookup"><span data-stu-id="73470-144">ASF Splitter</span></span>](asf-splitter.md)
</dt> </dl>

 

 



