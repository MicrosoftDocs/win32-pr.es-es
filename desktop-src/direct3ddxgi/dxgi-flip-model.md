---
description: Windows 8 agrega compatibilidad con Flip Presentation Model y sus estadísticas presentes asociadas en DXGI 1,2.
ms.assetid: E132DAF5-80B7-4C52-A760-3779CC140CE7
title: Modelo de volteo de DXGI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 49ee82febd13a3b57a06d93fd01eb8d230d6b78a
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/06/2021
ms.locfileid: "103906660"
---
# <a name="dxgi-flip-model"></a><span data-ttu-id="0cd31-103">Modelo de volteo de DXGI</span><span class="sxs-lookup"><span data-stu-id="0cd31-103">DXGI flip model</span></span>

<span data-ttu-id="0cd31-104">Windows 8 agrega compatibilidad con Flip Presentation Model y sus estadísticas presentes asociadas en DXGI 1,2.</span><span class="sxs-lookup"><span data-stu-id="0cd31-104">Windows 8 adds support for flip presentation model and its associated present statistics in DXGI 1.2.</span></span> <span data-ttu-id="0cd31-105">El modelo de presentación de Windows 8 DXGI Flip es similar a la [presentación del modo Flip de Direct3D 9EX](../direct3darticles/direct3d-9ex-improvements.md)de Windows 7.</span><span class="sxs-lookup"><span data-stu-id="0cd31-105">Windows 8’s DXGI flip presentation model is similar to Windows 7’s [Direct3D 9EX Flip Mode Presentation](../direct3darticles/direct3d-9ex-improvements.md).</span></span> <span data-ttu-id="0cd31-106">Las aplicaciones de presentación basadas en la velocidad de fotogramas y de vídeo, como los juegos, pueden beneficiarse de la mayoría mediante Flip Presentation Model.</span><span class="sxs-lookup"><span data-stu-id="0cd31-106">Video or frame rate-based presentation apps such as games can benefit most by using flip presentation model.</span></span> <span data-ttu-id="0cd31-107">Las aplicaciones que usan el modelo de presentación de DXGI Flip reducen la carga de recursos del sistema y aumentan el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="0cd31-107">Apps that use DXGI flip presentation model reduce the system resource load and increase performance.</span></span> <span data-ttu-id="0cd31-108">Las aplicaciones también pueden usar mejoras de estadísticas presentes con Flip Presentation Model para controlar mejor la velocidad de presentación al proporcionar mecanismos de corrección y comentarios en tiempo real.</span><span class="sxs-lookup"><span data-stu-id="0cd31-108">Apps can also use present statistics enhancements with flip presentation model to better control the rate of presentation by providing real-time feedback and correction mechanisms.</span></span>

-   [<span data-ttu-id="0cd31-109">Comparación del modelo de volteo de DXGI y el modelo de BitBlt</span><span class="sxs-lookup"><span data-stu-id="0cd31-109">Comparing the DXGI flip model and the BitBlt model</span></span>](#comparing-the-dxgi-flip-model-and-the-bitblt-model)
-   [<span data-ttu-id="0cd31-110">Cómo usar DXGI Flip Model</span><span class="sxs-lookup"><span data-stu-id="0cd31-110">How to use DXGI flip model</span></span>](#how-to-use-dxgi-flip-model)
-   [<span data-ttu-id="0cd31-111">Sincronización de fotogramas de las aplicaciones de DXGI Flip Model</span><span class="sxs-lookup"><span data-stu-id="0cd31-111">Frame synchronization of DXGI flip model apps</span></span>](#frame-synchronization-of-dxgi-flip-model-apps)
-   [<span data-ttu-id="0cd31-112">Prevención, detección y recuperación de problemas</span><span class="sxs-lookup"><span data-stu-id="0cd31-112">Avoiding, detecting, and recovering from glitches</span></span>](#avoiding-detecting-and-recovering-from-glitches)
-   [<span data-ttu-id="0cd31-113">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="0cd31-113">Related topics</span></span>](#related-topics)

## <a name="comparing-the-dxgi-flip-model-and-the-bitblt-model"></a><span data-ttu-id="0cd31-114">Comparación del modelo de volteo de DXGI y el modelo de BitBlt</span><span class="sxs-lookup"><span data-stu-id="0cd31-114">Comparing the DXGI flip model and the BitBlt model</span></span>

<span data-ttu-id="0cd31-115">El motor en tiempo de ejecución usa la transferencia de bloque de bits (bitblt) y los modelos de presentación de flip para presentar el contenido de los gráficos en monitores de pantalla.</span><span class="sxs-lookup"><span data-stu-id="0cd31-115">The runtime uses the bit-block transfer (bitblt) and flip presentation models to present graphics content on display monitors.</span></span> <span data-ttu-id="0cd31-116">La diferencia más grande entre los modelos de presentación bitblt y de volteo es cómo el contenido del búfer de reserva se obtiene en el DWM de Windows 8 para su composición.</span><span class="sxs-lookup"><span data-stu-id="0cd31-116">The biggest difference between bitblt and flip presentation models is how back-buffer contents get to the Windows 8 DWM for composition.</span></span> <span data-ttu-id="0cd31-117">En el modelo bitblt, el contenido del búfer de reserva se copia en la superficie de redirección en cada llamada a [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1).</span><span class="sxs-lookup"><span data-stu-id="0cd31-117">In the bitblt model, contents of the back buffer are copied into the redirection surface on each call to [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1).</span></span> <span data-ttu-id="0cd31-118">En el modelo Flip, todos los búferes de reserva se comparten con el Administrador de ventanas de escritorio (DWM).</span><span class="sxs-lookup"><span data-stu-id="0cd31-118">In the flip model, all back buffers are shared with the Desktop Window Manager (DWM).</span></span> <span data-ttu-id="0cd31-119">Por lo tanto, el DWM puede componerse directamente desde los búferes de reserva sin ninguna operación de copia adicional.</span><span class="sxs-lookup"><span data-stu-id="0cd31-119">Therefore, the DWM can compose straight from those back buffers without any additional copy operations.</span></span> <span data-ttu-id="0cd31-120">En general, el modelo de volteo es más eficaz.</span><span class="sxs-lookup"><span data-stu-id="0cd31-120">In general, the flip model is more efficient.</span></span> <span data-ttu-id="0cd31-121">El modelo Flip también proporciona más características, como estadísticas presentes mejoradas.</span><span class="sxs-lookup"><span data-stu-id="0cd31-121">The flip model also provides more features, such as enhanced present statistics.</span></span>

<span data-ttu-id="0cd31-122">Si tiene componentes heredados que usan Windows Interfaz de dispositivo gráfico (GDI) para escribir directamente en un [**hWnd**](../winprog/windows-data-types.md) , use el modelo BitBlt.</span><span class="sxs-lookup"><span data-stu-id="0cd31-122">If you have legacy components that use Windows Graphics Device Interface (GDI) to write to an [**HWND**](../winprog/windows-data-types.md) directly, use the bitblt model.</span></span>

<span data-ttu-id="0cd31-123">Las mejoras de rendimiento de DXGI Flip Model son significativas cuando la aplicación está en modo de ventana.</span><span class="sxs-lookup"><span data-stu-id="0cd31-123">Performance improvements of DXGI flip model are significant when the app is in windowed mode.</span></span> <span data-ttu-id="0cd31-124">La secuencia de esta tabla y la ilustración comparan los usos de ancho de banda de memoria y las lecturas y escrituras del sistema de aplicaciones en ventanas que eligen Flip Model frente al modelo BitBlt.</span><span class="sxs-lookup"><span data-stu-id="0cd31-124">The sequence in this table and the illustration compare memory bandwidth usages and system reads and writes of windowed apps that choose flip model versus the bitblt model.</span></span>



| <span data-ttu-id="0cd31-125">Paso</span><span class="sxs-lookup"><span data-stu-id="0cd31-125">Step</span></span> | <span data-ttu-id="0cd31-126">Modelo BitBlt presente en DWM</span><span class="sxs-lookup"><span data-stu-id="0cd31-126">BitBlt model present to DWM</span></span>                                                                               | <span data-ttu-id="0cd31-127">Modelo de volteo de DXGI presente en DWM</span><span class="sxs-lookup"><span data-stu-id="0cd31-127">DXGI flip model present to DWM</span></span>                                   |
|------|-----------------------------------------------------------------------------------------------------------|------------------------------------------------------------------|
| <span data-ttu-id="0cd31-128">1.</span><span class="sxs-lookup"><span data-stu-id="0cd31-128">1.</span></span>   | <span data-ttu-id="0cd31-129">La aplicación actualiza su marco (escritura)</span><span class="sxs-lookup"><span data-stu-id="0cd31-129">The app updates its frame (Write)</span></span><br/>                                                              | <span data-ttu-id="0cd31-130">La aplicación actualiza su marco (escritura)</span><span class="sxs-lookup"><span data-stu-id="0cd31-130">The app updates its frame (Write)</span></span><br/>                     |
| <span data-ttu-id="0cd31-131">2.</span><span class="sxs-lookup"><span data-stu-id="0cd31-131">2.</span></span>   | <span data-ttu-id="0cd31-132">El tiempo de ejecución de Direct3D copia el contenido de la superficie en una superficie de redirección de DWM (lectura, escritura)</span><span class="sxs-lookup"><span data-stu-id="0cd31-132">Direct3D runtime copies surface contents to a DWM redirection surface (Read, Write)</span></span><br/>            | <span data-ttu-id="0cd31-133">El tiempo de ejecución de Direct3D pasa la superficie de la aplicación a DWM</span><span class="sxs-lookup"><span data-stu-id="0cd31-133">Direct3D runtime passes the app surface to DWM</span></span><br/>        |
| <span data-ttu-id="0cd31-134">3.</span><span class="sxs-lookup"><span data-stu-id="0cd31-134">3.</span></span>   | <span data-ttu-id="0cd31-135">Una vez completada la copia de la superficie compartida, DWM representa la superficie de la aplicación en la pantalla (lectura, escritura)</span><span class="sxs-lookup"><span data-stu-id="0cd31-135">After the shared surface copy completes, DWM renders the app surface onto screen (Read, Write)</span></span><br/> | <span data-ttu-id="0cd31-136">DWM representa la superficie de la aplicación en la pantalla (lectura, escritura)</span><span class="sxs-lookup"><span data-stu-id="0cd31-136">DWM renders the app surface onto screen (Read, Write)</span></span><br/> |



 

![Ilustración de una comparación del modelo BLT y el modelo Flip](images/blt-flip-mode-present.png)

<span data-ttu-id="0cd31-138">Flip Model reduce el uso de memoria del sistema al reducir el número de lecturas y escrituras realizadas por el tiempo de ejecución de Direct3D para la composición de marcos en ventanas mediante DWM.</span><span class="sxs-lookup"><span data-stu-id="0cd31-138">Flip model reduces system memory usage by reducing the number of reads and writes by the Direct3D runtime for the windowed frame composition by DWM.</span></span>

## <a name="how-to-use-dxgi-flip-model"></a><span data-ttu-id="0cd31-139">Cómo usar DXGI Flip Model</span><span class="sxs-lookup"><span data-stu-id="0cd31-139">How to use DXGI flip model</span></span>

<span data-ttu-id="0cd31-140">Las aplicaciones de Direct3D 11,1 que tienen como destino Windows 8 usan Flip Model mediante la creación de la cadena de intercambio con el valor de la enumeración [**\_ \_ \_ \_ secuencial Flip del efecto de intercambio de dxgi**](/windows/desktop/api/DXGI/ne-dxgi-dxgi_swap_effect) establecido en el miembro **SwapEffect** de la estructura DESC1 de la [**\_ cadena de intercambio de \_ \_ dxgi**](/windows/desktop/api/DXGI1_2/ns-dxgi1_2-dxgi_swap_chain_desc1) .</span><span class="sxs-lookup"><span data-stu-id="0cd31-140">Direct3D 11.1 apps that target Windows 8 use flip model by creating the swap chain with the [**DXGI\_SWAP\_EFFECT\_FLIP\_SEQUENTIAL**](/windows/desktop/api/DXGI/ne-dxgi-dxgi_swap_effect) enumeration value set in the **SwapEffect** member of the [**DXGI\_SWAP\_CHAIN\_DESC1**](/windows/desktop/api/DXGI1_2/ns-dxgi1_2-dxgi_swap_chain_desc1) structure.</span></span> <span data-ttu-id="0cd31-141">Cuando establezca **SwapEffect** en el **efecto de intercambio de dxgi \_ \_ \_ Flip \_ Sequential**, establezca también estos miembros de la **cadena de intercambio de dxgi \_ \_ \_ DESC1** en los valores indicados:</span><span class="sxs-lookup"><span data-stu-id="0cd31-141">When you set **SwapEffect** to **DXGI\_SWAP\_EFFECT\_FLIP\_SEQUENTIAL**, also set these members of **DXGI\_SWAP\_CHAIN\_DESC1** to the indicated values:</span></span>

-   <span data-ttu-id="0cd31-142">**BufferCount** en un valor entre 2 y 16 para evitar una reducción del rendimiento como resultado de esperar a que DWM libere el búfer de presentación anterior.</span><span class="sxs-lookup"><span data-stu-id="0cd31-142">**BufferCount** to a value between 2 and 16 to prevent a performance penalty as a result of waiting on DWM to release the previous presentation buffer.</span></span>
-   <span data-ttu-id="0cd31-143">**Dar formato** al formato de dxgi \_ \_ R16G16B16A16 \_ float, formato de dxgi \_ \_ B8G8R8A8 \_ UNORM o formato de dxgi \_ \_ R8G8B8A8 \_ UNORM</span><span class="sxs-lookup"><span data-stu-id="0cd31-143">**Format** to DXGI\_FORMAT\_R16G16B16A16\_FLOAT, DXGI\_FORMAT\_B8G8R8A8\_UNORM, or DXGI\_FORMAT\_R8G8B8A8\_UNORM</span></span>
-   <span data-ttu-id="0cd31-144">**Miembro Count** de la [**estructura \_ \_ DESC de ejemplo de dxgi**](/windows/desktop/api/dxgicommon/ns-dxgicommon-dxgi_sample_desc) que el miembro **SampleDesc** especifica a uno y el miembro **Quality** de **dxgi \_ Sample \_ DESC** en cero porque no se admite el suavizado de contorno de muestra múltiple (MSAA)</span><span class="sxs-lookup"><span data-stu-id="0cd31-144">**Count** member of the [**DXGI\_SAMPLE\_DESC**](/windows/desktop/api/dxgicommon/ns-dxgicommon-dxgi_sample_desc) structure that the **SampleDesc** member specifies to one and the **Quality** member of **DXGI\_SAMPLE\_DESC** to zero because multiple sample antialiasing (MSAA) is not supported</span></span>

<span data-ttu-id="0cd31-145">Si usa el [**efecto de intercambio de DXGI \_ \_ \_ Flip \_ Sequential**](/windows/desktop/api/DXGI/ne-dxgi-dxgi_swap_effect) en Windows 7 o en un sistema operativo anterior, se produce un error en la creación del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="0cd31-145">If you use [**DXGI\_SWAP\_EFFECT\_FLIP\_SEQUENTIAL**](/windows/desktop/api/DXGI/ne-dxgi-dxgi_swap_effect) on Windows 7 or earlier operating system, device creation fails.</span></span> <span data-ttu-id="0cd31-146">Cuando se usa Flip Model, se pueden usar las estadísticas presentes en modo de pantalla completa en modo de ventana.</span><span class="sxs-lookup"><span data-stu-id="0cd31-146">When you use flip model, you can use full-screen present statistics in windowed mode.</span></span> <span data-ttu-id="0cd31-147">El comportamiento de la pantalla completa no se ve afectado.</span><span class="sxs-lookup"><span data-stu-id="0cd31-147">Full-screen behavior is not affected.</span></span> <span data-ttu-id="0cd31-148">Si se pasa un **valor null** al parámetro *pFullscreenDesc* de [**IDXGIFactory2:: CreateSwapChainForHwnd**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgifactory2-createswapchainforhwnd) para una cadena de intercambio en ventana y se establece **SwapEffect** en el **efecto de intercambio de DXGI, \_ \_ \_ Flip \_ Sequential**, el tiempo de ejecución crea un búfer de reserva adicional y gira el identificador que pertenece al búfer que se convierte en el búfer frontal en el momento de la presentación.</span><span class="sxs-lookup"><span data-stu-id="0cd31-148">If you pass **NULL** to the *pFullscreenDesc* parameter of [**IDXGIFactory2::CreateSwapChainForHwnd**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgifactory2-createswapchainforhwnd) for a windowed swap chain and set **SwapEffect** to **DXGI\_SWAP\_EFFECT\_FLIP\_SEQUENTIAL**, the runtime creates one extra back buffer and rotates whichever handle belongs to the buffer that becomes the front buffer at presentation time.</span></span>

<span data-ttu-id="0cd31-149">Al usar Flip Model, tenga en cuenta estas sugerencias:</span><span class="sxs-lookup"><span data-stu-id="0cd31-149">When you use flip model, consider these tips:</span></span>

-   <span data-ttu-id="0cd31-150">Use una cadena de intercambio de modelo de volteo por [**hWnd**](../winprog/windows-data-types.md).</span><span class="sxs-lookup"><span data-stu-id="0cd31-150">Use one flip model swap chain per [**HWND**](../winprog/windows-data-types.md).</span></span> <span data-ttu-id="0cd31-151">No tener como destino varias cadenas de intercambio de modelo de volteo en el mismo **hWnd**.</span><span class="sxs-lookup"><span data-stu-id="0cd31-151">Do not target multiple flip model swap chains to the same **HWND**.</span></span>
-   <span data-ttu-id="0cd31-152">No use la cadena de intercambio de volteo del modelo con la función [**ScrollWindow**](/windows/win32/api/winuser/nf-winuser-scrollwindow) o [**ScrollWindowEx**](/windows/win32/api/winuser/nf-winuser-scrollwindowex) de GDI.</span><span class="sxs-lookup"><span data-stu-id="0cd31-152">Do not use flip model swap chain with GDI's [**ScrollWindow**](/windows/win32/api/winuser/nf-winuser-scrollwindow) or [**ScrollWindowEx**](/windows/win32/api/winuser/nf-winuser-scrollwindowex) function.</span></span> <span data-ttu-id="0cd31-153">Algunas aplicaciones de Direct3D usan las funciones **ScrollWindow** y **ScrollWindowEx** de GDI para actualizar el contenido de la ventana después de que se produzca un evento de desplazamiento del usuario.</span><span class="sxs-lookup"><span data-stu-id="0cd31-153">Some Direct3D apps use GDI's **ScrollWindow** and **ScrollWindowEx** functions to update window contents after a user scroll event occurs.</span></span> <span data-ttu-id="0cd31-154">**ScrollWindow** y **ScrollWindowEx** realizan bitblts de contenido de la ventana en la pantalla cuando el usuario desplaza una ventana.</span><span class="sxs-lookup"><span data-stu-id="0cd31-154">**ScrollWindow** and **ScrollWindowEx** perform bitblts of window contents on screen as the user scrolls a window.</span></span> <span data-ttu-id="0cd31-155">Estas funciones también requieren actualizaciones del modelo bitblt para el contenido de GDI y de Direct3D.</span><span class="sxs-lookup"><span data-stu-id="0cd31-155">These functions also require bitblt model updates for GDI and Direct3D content.</span></span> <span data-ttu-id="0cd31-156">Las aplicaciones que usan cualquiera de las funciones no mostrarán necesariamente el desplazamiento del contenido de la ventana visible en la pantalla cuando la aplicación esté en modo de ventana.</span><span class="sxs-lookup"><span data-stu-id="0cd31-156">Apps that use either function will not necessarily display visible window contents scrolling on screen when the app is in windowed mode.</span></span> <span data-ttu-id="0cd31-157">Se recomienda que no utilice las funciones **ScrollWindow** y **ScrollWindowEx** de GDI y que, en su lugar, vuelva a dibujar el contenido de GDI y Direct3D en la pantalla en respuesta al desplazamiento.</span><span class="sxs-lookup"><span data-stu-id="0cd31-157">We recommend that you not use GDI's **ScrollWindow** and **ScrollWindowEx** functions, and instead redraw GDI and Direct3D contents on screen in response to scrolling.</span></span>
-   <span data-ttu-id="0cd31-158">Use Flip Model en un [**hWnd**](../winprog/windows-data-types.md) que tampoco sea el destino de otras API, incluido el modelo de presentación de de DXGI bitblt, otras versiones de Direct3D o GDI.</span><span class="sxs-lookup"><span data-stu-id="0cd31-158">Use flip model in an [**HWND**](../winprog/windows-data-types.md) that is not also targeted by other APIs, including DXGI bitblt presentation model, other versions of Direct3D, or GDI.</span></span> <span data-ttu-id="0cd31-159">Dado que el modelo bitblt mantiene una copia adicional de la superficie, puede Agregar GDI y otro contenido de Direct3D al mismo **hWnd** a través de actualizaciones por etapas de Direct3D y GDI.</span><span class="sxs-lookup"><span data-stu-id="0cd31-159">Because bitblt model maintains an additional copy of the surface, you can add GDI and other Direct3D contents to the same **HWND** through piecemeal updates from Direct3D and GDI.</span></span> <span data-ttu-id="0cd31-160">Cuando se usa el modelo Flip, solo se puede ver el contenido de Direct3D en las cadenas de intercambio del modelo Flip que el tiempo de ejecución pasa a DWM.</span><span class="sxs-lookup"><span data-stu-id="0cd31-160">When you use the flip model, only Direct3D content in flip model swap chains that the runtime passes to DWM are visible.</span></span> <span data-ttu-id="0cd31-161">El tiempo de ejecución omite todas las demás actualizaciones de contenido de Direct3D o GDI del modelo BitBlt.</span><span class="sxs-lookup"><span data-stu-id="0cd31-161">The runtime ignores all other bitblt model Direct3D or GDI content updates.</span></span>

## <a name="frame-synchronization-of-dxgi-flip-model-apps"></a><span data-ttu-id="0cd31-162">Sincronización de fotogramas de las aplicaciones de DXGI Flip Model</span><span class="sxs-lookup"><span data-stu-id="0cd31-162">Frame synchronization of DXGI flip model apps</span></span>

<span data-ttu-id="0cd31-163">Las estadísticas presentes son información de temporización de fotogramas que usan las aplicaciones multimedia para sincronizar secuencias de audio y vídeo y recuperarse de problemas de reproducción de vídeo.</span><span class="sxs-lookup"><span data-stu-id="0cd31-163">Present statistics are frame-timing information that media apps use to synchronize video and audio streams and recover from video playback glitches.</span></span> <span data-ttu-id="0cd31-164">Las aplicaciones pueden usar la información de temporización de fotogramas en estadísticas presentes para ajustar la velocidad de presentación de los fotogramas de vídeo para una presentación más fluida.</span><span class="sxs-lookup"><span data-stu-id="0cd31-164">Apps can use the frame-timing information in present statistics to adjust the presentation rate of their video frames for smoother presentation.</span></span> <span data-ttu-id="0cd31-165">Para obtener información de estadísticas presentes, llame al método [**IDXGISwapChain:: GetFrameStatistics**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getframestatistics) para obtener la estructura de [**\_ \_ estadísticas de fotogramas de DXGI**](/windows/desktop/api/DXGI/ns-dxgi-dxgi_frame_statistics) .</span><span class="sxs-lookup"><span data-stu-id="0cd31-165">To obtain present statistics information, call the [**IDXGISwapChain::GetFrameStatistics**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getframestatistics) method to obtain the [**DXGI\_FRAME\_STATISTICS**](/windows/desktop/api/DXGI/ns-dxgi-dxgi_frame_statistics) structure.</span></span> <span data-ttu-id="0cd31-166">**DXGI \_ \_Estadísticas de FOTOgramas** contiene estadísticas sobre [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) llamadas.</span><span class="sxs-lookup"><span data-stu-id="0cd31-166">**DXGI\_FRAME\_STATISTICS** contains statistics about [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) calls.</span></span> <span data-ttu-id="0cd31-167">Una cadena de intercambio de volteo del modelo proporciona información de estadísticas presentes en los modos de pantalla completa y de ventana.</span><span class="sxs-lookup"><span data-stu-id="0cd31-167">A flip model swap chain provides present statistics information in both windowed and full-screen modes.</span></span> <span data-ttu-id="0cd31-168">En el caso de las cadenas de intercambio del modelo bitblt en modo de ventana, todos los valores de las **\_ \_ estadísticas de fotogramas de DXGI** son ceros.</span><span class="sxs-lookup"><span data-stu-id="0cd31-168">For bitblt model swap chains in windowed mode, all **DXGI\_FRAME\_STATISTICS** values are zeroes.</span></span>

<span data-ttu-id="0cd31-169">En el caso de las estadísticas de Flip Model Present, [**IDXGISwapChain:: GetFrameStatistics**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getframestatistics) devuelve las **\_ \_ estadísticas de fotogramas de \_ \_ errores de DXGI** en estas situaciones:</span><span class="sxs-lookup"><span data-stu-id="0cd31-169">For flip model present statistics, [**IDXGISwapChain::GetFrameStatistics**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getframestatistics) returns **DXGI\_ERROR\_FRAME\_STATISTICS\_DISJOINT** in these situations:</span></span>

-   <span data-ttu-id="0cd31-170">Primera llamada a [**GetFrameStatistics**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getframestatistics), que indica el principio de una secuencia</span><span class="sxs-lookup"><span data-stu-id="0cd31-170">First call to [**GetFrameStatistics**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getframestatistics), which indicates the beginning of a sequence</span></span>
-   <span data-ttu-id="0cd31-171">Cambio de modo: modo de ventana a o desde pantalla completa o pantalla completa hasta transiciones de pantalla completa</span><span class="sxs-lookup"><span data-stu-id="0cd31-171">Mode change: either windowed mode to or from full screen or full screen to full screen transitions</span></span>

<span data-ttu-id="0cd31-172">Los valores de los miembros **PresentRefreshCount**, **SyncRefreshCount** y **SyncQPCTime** de [**las \_ \_ estadísticas de fotogramas de DXGI**](/windows/desktop/api/DXGI/ns-dxgi-dxgi_frame_statistics) tienen las siguientes características:</span><span class="sxs-lookup"><span data-stu-id="0cd31-172">The values in **PresentRefreshCount**, **SyncRefreshCount**, and **SyncQPCTime** members of [**DXGI\_FRAME\_STATISTICS**](/windows/desktop/api/DXGI/ns-dxgi-dxgi_frame_statistics) have the following characteristics:</span></span>

-   <span data-ttu-id="0cd31-173">**PresentRefreshCount** es igual a **SyncRefreshCount** cuando la aplicación se presenta en cada VSYNC.</span><span class="sxs-lookup"><span data-stu-id="0cd31-173">**PresentRefreshCount** is equal to **SyncRefreshCount** when the app presents on every vsync.</span></span>
-   <span data-ttu-id="0cd31-174">**SyncRefreshCount** se obtiene en el intervalo de VSYNC cuando se envió el presente, **SyncQPCTime** es aproximadamente el tiempo asociado con el intervalo de VSYNC.</span><span class="sxs-lookup"><span data-stu-id="0cd31-174">**SyncRefreshCount** is obtained on the vsync interval when the present was submitted, **SyncQPCTime** is approximately the time associated with the vsync interval.</span></span>

<span data-ttu-id="0cd31-175">El método [**IDXGISwapChain:: GetLastPresentCount**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getlastpresentcount) devuelve el último recuento presente, es decir, el identificador actual de la última llamada correcta [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) realizada por un dispositivo de pantalla que está asociado a la cadena de intercambio.</span><span class="sxs-lookup"><span data-stu-id="0cd31-175">The [**IDXGISwapChain::GetLastPresentCount**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getlastpresentcount) method returns the last present count, that is, the present ID of the last successful [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) call made by a display device that is associated with the swap chain.</span></span> <span data-ttu-id="0cd31-176">Este identificador actual es el valor del miembro **PresentCount** de la estructura [**de \_ \_ estadísticas de fotogramas de DXGI**](/windows/desktop/api/DXGI/ns-dxgi-dxgi_frame_statistics) .</span><span class="sxs-lookup"><span data-stu-id="0cd31-176">This present ID is the value of the **PresentCount** member of the [**DXGI\_FRAME\_STATISTICS**](/windows/desktop/api/DXGI/ns-dxgi-dxgi_frame_statistics) structure.</span></span> <span data-ttu-id="0cd31-177">En el caso de las cadenas de intercambio del modelo bitblt, mientras que en el modo de ventana, todos los valores de las **\_ \_ estadísticas de fotogramas de DXGI** son ceros.</span><span class="sxs-lookup"><span data-stu-id="0cd31-177">For bitblt model swap chains, while in windowed mode, all **DXGI\_FRAME\_STATISTICS** values are zeroes.</span></span>

## <a name="avoiding-detecting-and-recovering-from-glitches"></a><span data-ttu-id="0cd31-178">Prevención, detección y recuperación de problemas</span><span class="sxs-lookup"><span data-stu-id="0cd31-178">Avoiding, detecting, and recovering from glitches</span></span>

<span data-ttu-id="0cd31-179">Siga estos pasos para evitar, detectar y recuperarse de los problemas en la presentación de fotogramas:</span><span class="sxs-lookup"><span data-stu-id="0cd31-179">Perform these steps to avoid, detect, and recover from glitches in frame presentation:</span></span>

1.  <span data-ttu-id="0cd31-180">Queue [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) llama a (es decir, llamar a **IDXGISwapChain1::P resent1** varias veces, lo que hace que se recopilen en una cola).</span><span class="sxs-lookup"><span data-stu-id="0cd31-180">Queue [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) calls (that is, call **IDXGISwapChain1::Present1** multiple times, which causes them to collect in a queue).</span></span>
2.  <span data-ttu-id="0cd31-181">Cree una estructura present-Queue para almacenar todas las IDXGISwapChain1 enviadas correctamente [**:P:**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1)el identificador actual de resent1 (devuelto por [**IDXGISwapChain:: GetLastPresentCount**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getlastpresentcount)) y los valores de **PresentRefreshCount** asociados, calculados o esperados.</span><span class="sxs-lookup"><span data-stu-id="0cd31-181">Create a present-queue structure to store all successfully submitted [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1)'s present ID (returned by [**IDXGISwapChain::GetLastPresentCount**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getlastpresentcount)) and associated, calculated/expected **PresentRefreshCount** values.</span></span>
3.  <span data-ttu-id="0cd31-182">Para detectar un problema:</span><span class="sxs-lookup"><span data-stu-id="0cd31-182">To detect a glitch:</span></span>

    -   <span data-ttu-id="0cd31-183">Llame a [**IDXGISwapChain:: GetFrameStatistics**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getframestatistics).</span><span class="sxs-lookup"><span data-stu-id="0cd31-183">Call [**IDXGISwapChain::GetFrameStatistics**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getframestatistics).</span></span>
    -   <span data-ttu-id="0cd31-184">Para este marco, obtenga el identificador actual (**PresentCount**) y el recuento de VSYNC en el que el sistema operativo presentó la última imagen al monitor (**PresentRefreshCount**).</span><span class="sxs-lookup"><span data-stu-id="0cd31-184">For this frame, get the present ID (**PresentCount**) and vsync count where the operating system presented the last image to the monitor (**PresentRefreshCount**).</span></span>
    -   <span data-ttu-id="0cd31-185">Recupere el **PresentRefreshCount** esperado que está asociado al identificador actual y que almacenó anteriormente en la estructura present-Queue.</span><span class="sxs-lookup"><span data-stu-id="0cd31-185">Retrieve the expected **PresentRefreshCount** that is associated with the present ID and that you previously stored in the present-queue structure.</span></span>
    -   <span data-ttu-id="0cd31-186">Si el **PresentRefreshCount** real es posterior al **PresentRefreshCount** esperado, se ha producido un problema.</span><span class="sxs-lookup"><span data-stu-id="0cd31-186">If the actual **PresentRefreshCount** is later than the expected **PresentRefreshCount**, a glitch has occurred.</span></span>

4.  <span data-ttu-id="0cd31-187">Para recuperarse del problema:</span><span class="sxs-lookup"><span data-stu-id="0cd31-187">To recover from the glitch:</span></span>

    -   <span data-ttu-id="0cd31-188">Calcule el número de fotogramas que se van a omitir para recuperarse del problema.</span><span class="sxs-lookup"><span data-stu-id="0cd31-188">Calculate the number of frames to skip to recover from the glitch.</span></span> <span data-ttu-id="0cd31-189">Por ejemplo, si el paso 3 revela que el número de VSYNC esperado (**PresentRefreshCount**) para un identificador presente (**PresentCount**) es 5 y el número real de VSYNC para el ID. actual es 8, el número de fotogramas que se omitirá para recuperarse del problema es de 3 fotogramas.</span><span class="sxs-lookup"><span data-stu-id="0cd31-189">For example, if step 3 reveals that the expected vsync count (**PresentRefreshCount**) for a present ID (**PresentCount**) is 5 and the actual vsync count for the present ID is 8, the number of frames to skip to recover from the glitch is 3 frames.</span></span>
    -   <span data-ttu-id="0cd31-190">Pase 0 al parámetro *SyncInterval* en este número de llamadas a [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) para descartar y omitir este número de Marcos.</span><span class="sxs-lookup"><span data-stu-id="0cd31-190">Pass 0 to the *SyncInterval* parameter in this number of calls to [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) to discard and skip this number of frames.</span></span>

        > [!Note]  
        > <span data-ttu-id="0cd31-191">Si el problema consta de un gran número de fotogramas, llame a [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) con el parámetro *Flags* establecido en [**DXGI \_ present \_ restart**](dxgi-present.md) para descartar y omitir todas las presentaciones en cola pendientes.</span><span class="sxs-lookup"><span data-stu-id="0cd31-191">If the glitch consists of a large number of frames, call [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) with the *Flags* parameter set to [**DXGI\_PRESENT\_RESTART**](dxgi-present.md) to discard and skip all outstanding queued presents.</span></span>

         

<span data-ttu-id="0cd31-192">Este es un escenario de ejemplo de recuperación de problemas en la presentación de fotogramas:</span><span class="sxs-lookup"><span data-stu-id="0cd31-192">Here is an example scenario of recovering from glitches in frame presentation:</span></span>

![Ilustración de un escenario de ejemplo de recuperación de problemas en la presentación de fotogramas](images/frame-sync-glitch-recover.png)

<span data-ttu-id="0cd31-194">En el escenario de ejemplo, se espera que el marco a vaya a la pantalla en un recuento de VSYNC de 1.</span><span class="sxs-lookup"><span data-stu-id="0cd31-194">In the example scenario, you expect frame A to go on screen on a vsync count of 1.</span></span> <span data-ttu-id="0cd31-195">Pero realmente detecta el número de VSYNC que el marco A aparece en la pantalla como 4.</span><span class="sxs-lookup"><span data-stu-id="0cd31-195">But you actually detect the vsync count that frame A appears on screen as 4.</span></span> <span data-ttu-id="0cd31-196">Por lo tanto, determinará que se ha producido un problema.</span><span class="sxs-lookup"><span data-stu-id="0cd31-196">Therefore, you determine that a glitch occurred.</span></span> <span data-ttu-id="0cd31-197">Después, puede descartar 3 fotogramas, es decir, puede pasar 0 al parámetro *SyncInterval* en 3 llamadas a [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1).</span><span class="sxs-lookup"><span data-stu-id="0cd31-197">You can then discard 3 frames, that is, you can pass 0 to the *SyncInterval* parameter in 3 calls to [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1).</span></span> <span data-ttu-id="0cd31-198">En el escenario de ejemplo anterior, para recuperarse del problema, necesita un total de 8 **IDXGISwapChain1::P resent1** llamadas.</span><span class="sxs-lookup"><span data-stu-id="0cd31-198">In the preceding example scenario, to recover from the glitch, you need a total of 8 **IDXGISwapChain1::Present1** calls.</span></span> <span data-ttu-id="0cd31-199">El fotograma noveno es visible según el recuento de VSYNC que espera.</span><span class="sxs-lookup"><span data-stu-id="0cd31-199">The 9th frame is then visible as per the vsync count that you expect.</span></span>

<span data-ttu-id="0cd31-200">Esta es una línea de tiempo de eventos de presentación.</span><span class="sxs-lookup"><span data-stu-id="0cd31-200">Here's a time line of presentation events.</span></span> <span data-ttu-id="0cd31-201">Cada línea vertical representa una VSYNC.</span><span class="sxs-lookup"><span data-stu-id="0cd31-201">Each vertical line represents a vsync.</span></span> <span data-ttu-id="0cd31-202">La dirección horizontal es la hora, que aumenta a la derecha.</span><span class="sxs-lookup"><span data-stu-id="0cd31-202">The horizontal direction is time, which increases to the right.</span></span> <span data-ttu-id="0cd31-203">Puede usar la figura para imaginar cómo se pueden producir los problemas.</span><span class="sxs-lookup"><span data-stu-id="0cd31-203">You can use the figure to imagine how glitches can occur.</span></span>

![Ilustración de una línea de tiempo de eventos de presentación](images/present-timeline.png)

<span data-ttu-id="0cd31-205">En la ilustración se muestra esta secuencia:</span><span class="sxs-lookup"><span data-stu-id="0cd31-205">The figure illustrates this sequence:</span></span>

1.  <span data-ttu-id="0cd31-206">La aplicación se activa en VSYNC, se representa en azul, llama a [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1)y, a continuación, vuelve a entrar en suspensión.</span><span class="sxs-lookup"><span data-stu-id="0cd31-206">The app wakes up on vsync, renders blue, calls [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1), and then goes back to sleep.</span></span>
2.  <span data-ttu-id="0cd31-207">La unidad de procesamiento de gráficos (GPU) se activa desde el estado inactivo, realiza la representación en azul y, a continuación, vuelve a entrar en suspensión.</span><span class="sxs-lookup"><span data-stu-id="0cd31-207">The graphics processing unit (GPU) wakes up from idle, performs the render to blue, and then goes back to sleep.</span></span>
3.  <span data-ttu-id="0cd31-208">El DWM se activa en la siguiente VSYNC, se compone de azul en su búfer de reserva, llama a [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1)y, a continuación, vuelve a entrar en suspensión.</span><span class="sxs-lookup"><span data-stu-id="0cd31-208">The DWM wakes up at the next vsync, composes blue into its back buffer, calls [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1), and then goes back to sleep.</span></span>
4.  <span data-ttu-id="0cd31-209">La aplicación se activa, se representa en verde, llama a [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1)y, a continuación, vuelve a entrar en suspensión.</span><span class="sxs-lookup"><span data-stu-id="0cd31-209">The app wakes up, renders green, calls [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1), and then goes back to sleep.</span></span>
    > [!Note]  
    > <span data-ttu-id="0cd31-210">La aplicación se ejecuta simultáneamente mientras la GPU realiza la redacción de azul.</span><span class="sxs-lookup"><span data-stu-id="0cd31-210">The app concurrently executes while the GPU performs the compose of blue.</span></span>

     

5.  <span data-ttu-id="0cd31-211">A continuación, la GPU se representa en verde para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="0cd31-211">Next, the GPU renders green for the app.</span></span>
6.  <span data-ttu-id="0cd31-212">Por último, el convertidor digital a analógico (DAC) muestra los resultados de la composición DWM en el monitor en la siguiente VSYNC.</span><span class="sxs-lookup"><span data-stu-id="0cd31-212">Finally, the digital to analog converter (DAC) shows results of the DWM composition on the monitor on the next vsync.</span></span>

<span data-ttu-id="0cd31-213">Desde la línea de tiempo, puede imaginarse la latencia de las estadísticas presentes y cómo se pueden producir los problemas.</span><span class="sxs-lookup"><span data-stu-id="0cd31-213">From the time line, you can imagine the latency of present statistics and how glitches can occur.</span></span> <span data-ttu-id="0cd31-214">Por ejemplo, para mostrar un problema de DWM para el color verde que aparece en la pantalla, Imagine que amplía el cuadro verde/rojo para que el lado derecho del cuadro verde/rojo coincida con el lado derecho del cuadro púrpura/rojo.</span><span class="sxs-lookup"><span data-stu-id="0cd31-214">For example, to show a DWM glitch for the green color appearing on screen, imagine widening the green/red box so that the right side of the green/red box matches up to the right side of the purple/red box.</span></span> <span data-ttu-id="0cd31-215">En este escenario, la DAC muestra dos fotogramas de azul y luego el marco verde.</span><span class="sxs-lookup"><span data-stu-id="0cd31-215">In this scenario, the DAC shows two frames of blue and then the green frame.</span></span> <span data-ttu-id="0cd31-216">Puede ver que este problema se produjo al leer estadísticas actuales.</span><span class="sxs-lookup"><span data-stu-id="0cd31-216">You can see that this glitch occurred from reading present statistics.</span></span>

## <a name="related-topics"></a><span data-ttu-id="0cd31-217">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="0cd31-217">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="0cd31-218">Mejorar la presentación con el modelo de volteo, los rectángulos modificados y las áreas desplazadas</span><span class="sxs-lookup"><span data-stu-id="0cd31-218">Enhancing presentation with the flip model, dirty rectangles, and scrolled areas</span></span>](dxgi-1-2-presentation-improvements.md)
</dt> </dl>

 

 
