---
title: Programación de comandos
description: Cada comando tiene una prioridad asociada.
ms.assetid: 63f6ba9d-0b87-403b-916b-aa8550f98a11
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 06512f0748aa88f6b32de3291e2ed1c262212ba2
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/16/2019
ms.locfileid: "105665677"
---
# <a name="command-scheduling"></a><span data-ttu-id="afc1d-103">Programación de comandos</span><span class="sxs-lookup"><span data-stu-id="afc1d-103">Command Scheduling</span></span>

## <a name="command-scheduling"></a><span data-ttu-id="afc1d-104">Programación de comandos</span><span class="sxs-lookup"><span data-stu-id="afc1d-104">Command Scheduling</span></span>

<span data-ttu-id="afc1d-105">Los comandos se pueden enviar a TBS desde varios contextos en cualquier momento.</span><span class="sxs-lookup"><span data-stu-id="afc1d-105">Commands can be submitted to the TBS from multiple contexts at any time.</span></span> <span data-ttu-id="afc1d-106">Sin embargo, un TPM físico solo puede procesar un comando cada vez y algunos comandos pueden ejecutarse durante un período de tiempo considerable.</span><span class="sxs-lookup"><span data-stu-id="afc1d-106">However, a physical TPM can only process one command at a time, and some commands can run for a significant period of time.</span></span> <span data-ttu-id="afc1d-107">Cuando hay varios comandos pendientes, el TBS decide qué comando se va a enviar a TPM.</span><span class="sxs-lookup"><span data-stu-id="afc1d-107">When multiple commands are pending, the TBS decides which command to send to the TPM.</span></span> <span data-ttu-id="afc1d-108">Cuando se envía un comando, cada comando tiene una prioridad asociada.</span><span class="sxs-lookup"><span data-stu-id="afc1d-108">When a command is submitted, each command has a priority associated with it.</span></span> <span data-ttu-id="afc1d-109">TBS usa estas prioridades para determinar qué comando pendiente debe enviar siempre que el TPM sea gratuito.</span><span class="sxs-lookup"><span data-stu-id="afc1d-109">The TBS uses these priorities to determine which pending command to submit whenever the TPM is free.</span></span> <span data-ttu-id="afc1d-110">Los cuatro niveles de prioridad son baja, normal, alta y sistema.</span><span class="sxs-lookup"><span data-stu-id="afc1d-110">The four levels of priority are low, normal, high, and system.</span></span> <span data-ttu-id="afc1d-111">Las aplicaciones deben usar prioridad baja, normal o alta.</span><span class="sxs-lookup"><span data-stu-id="afc1d-111">Applications should use low, normal, or high priority.</span></span> <span data-ttu-id="afc1d-112">Aunque los comandos de prioridad alta normalmente se ejecutan antes que los comandos de prioridad baja, el programador de comandos de TBS tiene una directiva de caducidad que finalmente proporciona prioridad muy alta a los comandos que se han bloqueado durante períodos de tiempo importantes.</span><span class="sxs-lookup"><span data-stu-id="afc1d-112">Although high-priority commands are usually executed before low-priority commands, the TBS command scheduler has an aging policy that eventually gives very high priority to commands that have been blocked for significant periods of time.</span></span>

## <a name="context-management"></a><span data-ttu-id="afc1d-113">Administración de contexto</span><span class="sxs-lookup"><span data-stu-id="afc1d-113">Context Management</span></span>

<span data-ttu-id="afc1d-114">Cuando \_ se envía un comando SaveContext o TPM2 de TPM con un identificador virtual a un recurso que administra TBS, el TBS ejecuta el comando adecuado en el recurso físico y devuelve el resultado al llamador si el recurso está físicamente presente en el TPM.</span><span class="sxs-lookup"><span data-stu-id="afc1d-114">When a TPM\_SaveContext or TPM2 ContextSave command is submitted with a virtual handle to a resource that the TBS is managing, the TBS executes the appropriate command on the physical resource and returns the result to the caller if the resource is physically present in the TPM.</span></span> <span data-ttu-id="afc1d-115">Si el recurso no está físicamente presente en el TPM, el preprocesamiento del \_ comando SaveContext o ContextSave de TPM2 de TPM \_ provoca que se vuelva a cargar el recurso, momento en el que el contexto se guardará y se devolverá al autor de la llamada.</span><span class="sxs-lookup"><span data-stu-id="afc1d-115">If the resource is not physically present in the TPM, the preprocessing of the TPM\_SaveContext or TPM2\_ContextSave command causes the resource to be reloaded, at which point the context will be saved and returned to the caller.</span></span> <span data-ttu-id="afc1d-116">Si el recurso que se está guardando es de un tipo que normalmente se vacía automáticamente desde el TPM después de guardar, el TBS invalida el recurso virtual al completarse este comando.</span><span class="sxs-lookup"><span data-stu-id="afc1d-116">If the resource being saved is of a type that is normally flushed automatically from the TPM after saving, the TBS invalidates the virtual resource upon completion of this command.</span></span> <span data-ttu-id="afc1d-117">Cuando \_ se envía un comando LoadContext o TPM2 de TPM \_ a TBS, el TBS ejecuta el comando inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="afc1d-117">When a TPM\_LoadContext or TPM2\_ContextLoad command is submitted to the TBS, the TBS executes the command immediately.</span></span> <span data-ttu-id="afc1d-118">Si el comando se completa correctamente, el TBS virtualiza el identificador de recursos y pasa la secuencia de bytes de TPM resultante al llamador.</span><span class="sxs-lookup"><span data-stu-id="afc1d-118">If the command completes successfully, the TBS virtualizes the resource handle and passes the resulting TPM byte stream to the caller.</span></span> <span data-ttu-id="afc1d-119">Cuando \_ se envía un comando FlushSpecific o TPM2 de TPM \_ con un identificador virtual a un recurso que administra TBS, el TBS ejecuta un \_ comando TPM FlushSpecific o TPM2 \_ FlushContext para expulsar el recurso del TPM, si está presente físicamente.</span><span class="sxs-lookup"><span data-stu-id="afc1d-119">When a TPM\_FlushSpecific or TPM2\_FlushContext command is submitted with a virtual handle to a resource that the TBS is managing, the TBS executes a TPM\_FlushSpecific or TPM2\_FlushContext command to evict the resource from the TPM if it is physically present.</span></span> <span data-ttu-id="afc1d-120">En este caso, el TBS invalida el recurso virtual y devuelve el resultado del comando FLUSH al llamador.</span><span class="sxs-lookup"><span data-stu-id="afc1d-120">In this case, the TBS invalidates the virtual resource and returns the result of the flush command to the caller.</span></span> <span data-ttu-id="afc1d-121">Si el recurso no está físicamente presente en el TPM, el preprocesamiento del \_ comando FlushSpecific de TPM o de TPM2 \_ FlushContext cargará el recurso correspondiente al identificador virtual, pero se vaciará cuando el comando se procese realmente.</span><span class="sxs-lookup"><span data-stu-id="afc1d-121">If the resource is not physically present in the TPM, the preprocessing of the TPM\_FlushSpecific or TPM2\_FlushContext command will load the resource that corresponds to the virtual handle, but it will then be flushed when the command is actually processed.</span></span> <span data-ttu-id="afc1d-122">TBS no admite el \_ bit KeyControlOwner de TPM o la funcionalidad keepHandle de la \_ operación LOADCONTEXT de TPM, por lo que no asignará a un recurso el mismo identificador que tenía antes de que se guardara el contexto.</span><span class="sxs-lookup"><span data-stu-id="afc1d-122">The TBS does not support the TPM\_KeyControlOwner bit or the keepHandle functionality of the TPM\_LoadContext operation, so it will not give a resource the same handle it had before the context was saved.</span></span>

## <a name="other-commands"></a><span data-ttu-id="afc1d-123">Otros comandos</span><span class="sxs-lookup"><span data-stu-id="afc1d-123">Other Commands</span></span>

<span data-ttu-id="afc1d-124">Los comandos que no se mencionan en esta documentación se procesan reemplazando los identificadores de clave virtual por los identificadores de clave física (si es necesario) y enviándolos al TPM.</span><span class="sxs-lookup"><span data-stu-id="afc1d-124">Commands that are not mentioned in this documentation are processed by replacing virtual key handles with physical key handles (if necessary) and submitting them to the TPM.</span></span> <span data-ttu-id="afc1d-125">Esto se hace después de realizar las operaciones adecuadas para asegurarse de que los recursos que se están usando están físicamente presentes en el TPM.</span><span class="sxs-lookup"><span data-stu-id="afc1d-125">This is done after performing the appropriate operations to ensure that resources being used are physically present on the TPM.</span></span> <span data-ttu-id="afc1d-126">No se realiza ningún procesamiento especial adicional.</span><span class="sxs-lookup"><span data-stu-id="afc1d-126">No additional special processing is performed.</span></span> <span data-ttu-id="afc1d-127">TBS no intenta mejorar la fidelidad de la virtualización mediante la modificación de los datos que se devuelven desde el TPM como parte de una \_ consulta GetCapabilities de TPM o de TPM2 \_ GetCapability.</span><span class="sxs-lookup"><span data-stu-id="afc1d-127">The TBS does not attempt to improve the fidelity of the virtualization by modifying data passed back from the TPM as part of a TPM\_GetCapabilities or TPM2\_GetCapability query.</span></span> <span data-ttu-id="afc1d-128">TBS también admite comandos de presencia física de TCG.</span><span class="sxs-lookup"><span data-stu-id="afc1d-128">The TBS also supports TCG Physical Presence commands.</span></span> <span data-ttu-id="afc1d-129">TBS actúa como un paso para los comandos de presencia física; el propio TBS no realiza ningún procesamiento especial.</span><span class="sxs-lookup"><span data-stu-id="afc1d-129">The TBS acts as a pass-through for Physical Presence commands; no special processing is performed by the TBS itself.</span></span>

## <a name="cleanup"></a><span data-ttu-id="afc1d-130">Limpieza</span><span class="sxs-lookup"><span data-stu-id="afc1d-130">Cleanup</span></span>

<span data-ttu-id="afc1d-131">Cuando se cierra un contexto, se limpian todos los recursos físicos y virtuales asociados a él, por lo que ya no consumen recursos del sistema.</span><span class="sxs-lookup"><span data-stu-id="afc1d-131">When a context exits, all physical and virtual resources associated with it are cleaned up so they no longer consume system resources.</span></span>

 

 




