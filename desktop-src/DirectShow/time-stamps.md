---
description: Marcas de tiempo
ms.assetid: 445fe6b9-9d5b-45fd-9c9e-8c632c5228ae
title: Marcas de tiempo
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 855d2c472d7964ccad6ec8bbc87efd39b1c4cdd6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "105688733"
---
# <a name="time-stamps"></a><span data-ttu-id="d5954-103">Marcas de tiempo</span><span class="sxs-lookup"><span data-stu-id="d5954-103">Time Stamps</span></span>

<span data-ttu-id="d5954-104">La *marca de tiempo* define las horas de inicio y finalización de un ejemplo multimedia, medida en el tiempo de la secuencia.</span><span class="sxs-lookup"><span data-stu-id="d5954-104">The *time stamp* defines a media sample's start and finish times, measured in stream time.</span></span> <span data-ttu-id="d5954-105">La marca de tiempo se denomina a veces *hora de presentación*.</span><span class="sxs-lookup"><span data-stu-id="d5954-105">The time stamp is sometimes called the *presentation time*.</span></span> <span data-ttu-id="d5954-106">Al leer el resto de este artículo, es importante recordar que no todos los formatos usan marcas de tiempo de la misma manera.</span><span class="sxs-lookup"><span data-stu-id="d5954-106">When reading the rest of this article, it is important to remember that not all formats use time stamps in the same way.</span></span> <span data-ttu-id="d5954-107">Por ejemplo, no todos los ejemplos de MPEG tienen marca de tiempo.</span><span class="sxs-lookup"><span data-stu-id="d5954-107">For example, not all MPEG samples are time stamped.</span></span> <span data-ttu-id="d5954-108">En los gráficos de filtros MPEG, la marca de tiempo no se aplica a cada fotograma hasta que se genera desde el descodificador.</span><span class="sxs-lookup"><span data-stu-id="d5954-108">In MPEG filter graphs, the time stamp is not applied to each frame until they are output from the decoder.</span></span>

<span data-ttu-id="d5954-109">Cuando un filtro de representador recibe un ejemplo, programa la representación en función de la marca de tiempo.</span><span class="sxs-lookup"><span data-stu-id="d5954-109">When a renderer filter receives a sample, it schedules rendering based on the time stamp.</span></span> <span data-ttu-id="d5954-110">Si el ejemplo llega tarde o no tiene ninguna marca de tiempo, el filtro representa el ejemplo inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="d5954-110">If the sample arrives late, or has no time stamp, the filter renders the sample immediately.</span></span> <span data-ttu-id="d5954-111">De lo contrario, el filtro espera hasta la hora de inicio del ejemplo antes de representar el ejemplo.</span><span class="sxs-lookup"><span data-stu-id="d5954-111">Otherwise, the filter waits until the sample's start time before it renders the sample.</span></span> <span data-ttu-id="d5954-112">(Espera la hora de inicio mediante una llamada al método [**IReferenceClock:: AdviseTime**](/windows/desktop/api/Strmif/nf-strmif-ireferenceclock-advisetime) ).</span><span class="sxs-lookup"><span data-stu-id="d5954-112">(It waits for the start time by calling the [**IReferenceClock::AdviseTime**](/windows/desktop/api/Strmif/nf-strmif-ireferenceclock-advisetime) method.)</span></span>

<span data-ttu-id="d5954-113">Los filtros de origen y los filtros de analizador son responsables de establecer las marcas de tiempo correctas en los ejemplos que procesan.</span><span class="sxs-lookup"><span data-stu-id="d5954-113">Source filters and parser filters are responsible for setting the correct time stamps on the samples they process.</span></span> <span data-ttu-id="d5954-114">Utilice las siguientes directrices.</span><span class="sxs-lookup"><span data-stu-id="d5954-114">Use the following guidelines.</span></span>

-   <span data-ttu-id="d5954-115">Reproducción de archivos: el primer ejemplo tiene una marca de tiempo con una hora de inicio de cero.</span><span class="sxs-lookup"><span data-stu-id="d5954-115">File playback: The first sample is time stamped with a start time of zero.</span></span> <span data-ttu-id="d5954-116">Las marcas de tiempo subsiguientes se determinan por la longitud de muestra y la velocidad de reproducción, que a su vez viene determinada por el formato de archivo.</span><span class="sxs-lookup"><span data-stu-id="d5954-116">Subsequent time stamps are determined by the sample length and the playback rate, which itself is determined by the file format.</span></span> <span data-ttu-id="d5954-117">El filtro que analiza el archivo es responsable de calcular las marcas de tiempo correctas (por ejemplo, el [divisor de AVI](avi-splitter-filter.md)).</span><span class="sxs-lookup"><span data-stu-id="d5954-117">The filter that parses the file is responsible for calculating the correct time stamps (for example, the [AVI Splitter](avi-splitter-filter.md)).</span></span>
-   <span data-ttu-id="d5954-118">Captura de vídeo y audio: cada muestra tiene una marca de tiempo con una hora de inicio igual a la hora de la secuencia en que se capturó, con las siguientes salvedades:</span><span class="sxs-lookup"><span data-stu-id="d5954-118">Video and audio capture: Every sample is time stamped with a start time equal to the stream time when it was captured, with the following caveats:</span></span>
    -   <span data-ttu-id="d5954-119">Los fotogramas de vídeo de un PIN de vista previa (en lugar de un PIN de captura) no tienen marca de tiempo.</span><span class="sxs-lookup"><span data-stu-id="d5954-119">Video frames from a preview pin (as opposed to a capture pin) are not time stamped.</span></span> <span data-ttu-id="d5954-120">Debido a la latencia del grafo, un fotograma de vídeo que se marca con el tiempo de captura siempre llegará tarde en el representador de vídeo.</span><span class="sxs-lookup"><span data-stu-id="d5954-120">Because of graph latency, a video frame that is stamped with the capture time will always arrive late at the video renderer.</span></span> <span data-ttu-id="d5954-121">Esto puede hacer que el representador Quite fotogramas, en un intento de control de calidad.</span><span class="sxs-lookup"><span data-stu-id="d5954-121">This may cause the renderer to drop frames, in an attempt at quality control.</span></span> <span data-ttu-id="d5954-122">Para obtener información sobre el control de calidad, consulte [Administración de control de calidad](quality-control-management.md).</span><span class="sxs-lookup"><span data-stu-id="d5954-122">For information about quality control, see [Quality-Control Management](quality-control-management.md).</span></span>
    -   <span data-ttu-id="d5954-123">Captura de audio: el filtro de captura de audio usa su propio conjunto de búferes, que son independientes de los usados por el controlador de audio.</span><span class="sxs-lookup"><span data-stu-id="d5954-123">Audio capture: The audio capture filter uses its own set of buffers, which are separate from those used by the audio driver.</span></span> <span data-ttu-id="d5954-124">El controlador de audio rellena los búferes del filtro de captura a intervalos fijos.</span><span class="sxs-lookup"><span data-stu-id="d5954-124">The audio driver fills the capture filter's buffers at fixed intervals.</span></span> <span data-ttu-id="d5954-125">El intervalo depende del controlador, pero por lo general no es superior a 10 milisegundos.</span><span class="sxs-lookup"><span data-stu-id="d5954-125">The interval depends on the driver, but generally is not more than 10 milliseconds.</span></span> <span data-ttu-id="d5954-126">Las marcas de tiempo de las muestras de audio reflejan la hora a la que el controlador llenó los búferes del filtro de captura de audio.</span><span class="sxs-lookup"><span data-stu-id="d5954-126">The time stamps on the audio samples reflect the time when the driver filled the audio capture filter's buffers.</span></span> <span data-ttu-id="d5954-127">Estas horas pueden ser ligeramente inexactas, especialmente si la aplicación usa un tamaño de búfer muy pequeño.</span><span class="sxs-lookup"><span data-stu-id="d5954-127">These times can be slightly inaccurate, especially if the application is using a very small buffer size.</span></span> <span data-ttu-id="d5954-128">Sin embargo, los tiempos de los medios reflejarán con precisión el número de muestras de audio en el búfer.</span><span class="sxs-lookup"><span data-stu-id="d5954-128">However, the media times will accurately reflect the number audio samples in the buffer.</span></span>
-   <span data-ttu-id="d5954-129">Filtros MUX: dependiendo del formato de salida, es posible que un filtro MUX tenga que generar marcas de tiempo o no.</span><span class="sxs-lookup"><span data-stu-id="d5954-129">Mux filters: Depending on the output format, a mux filter may need to generate time stamps, or it may not.</span></span> <span data-ttu-id="d5954-130">Por ejemplo, el formato de archivo AVI usa una velocidad de fotogramas fija sin marcas de tiempo, por lo que el filtro de [AVI MUX](avi-mux-filter.md) supone que los ejemplos llegan aproximadamente en el momento adecuado.</span><span class="sxs-lookup"><span data-stu-id="d5954-130">For example, the AVI file format uses a fixed frame rate with no time stamps, so the [AVI Mux](avi-mux-filter.md) filter assumes that samples are arriving at approximately the right time.</span></span> <span data-ttu-id="d5954-131">Sin embargo, si las marcas de tiempo de entrada muestran un hueco mayor de un fotograma, el MUX de AVI escribe una entrada de índice con el tamaño cero, para indicar un fotograma colocado.</span><span class="sxs-lookup"><span data-stu-id="d5954-131">If the incoming time stamps show a gap larger than one frame, however, the AVI Mux writes an index entry with size zero, to indicate a dropped frame.</span></span> <span data-ttu-id="d5954-132">En la reproducción de archivos, se generan nuevas marcas de tiempo en tiempo de ejecución, como se ha descrito anteriormente.</span><span class="sxs-lookup"><span data-stu-id="d5954-132">On file playback, new time stamps are generated at run time, as described previously.</span></span>

<span data-ttu-id="d5954-133">Para establecer la marca de tiempo en un ejemplo, llame al método [**IMediaSample:: setTime**](/windows/desktop/api/Strmif/nf-strmif-imediasample-settime) .</span><span class="sxs-lookup"><span data-stu-id="d5954-133">To set the time stamp on a sample, call the [**IMediaSample::SetTime**](/windows/desktop/api/Strmif/nf-strmif-imediasample-settime) method.</span></span>

<span data-ttu-id="d5954-134">**Horas de medios**</span><span class="sxs-lookup"><span data-stu-id="d5954-134">**Media Times**</span></span>

<span data-ttu-id="d5954-135">Opcionalmente, el filtro también puede especificar una *hora de medio* para el ejemplo.</span><span class="sxs-lookup"><span data-stu-id="d5954-135">Optionally, the filter can also specify a *media time* for the sample.</span></span> <span data-ttu-id="d5954-136">En una secuencia de vídeo, el tiempo medio representa el número de marco.</span><span class="sxs-lookup"><span data-stu-id="d5954-136">In a video stream, media time represents the frame number.</span></span> <span data-ttu-id="d5954-137">En una secuencia de audio, tiempo medio representa el número de muestra del paquete.</span><span class="sxs-lookup"><span data-stu-id="d5954-137">In an audio stream, media time represents the sample number in the packet.</span></span> <span data-ttu-id="d5954-138">Por ejemplo, si cada paquete contiene un segundo de audio 44,1 kilohercios (kHz), el primer paquete tendrá una hora de inicio del medio de cero y un tiempo de detención del medio de 44100.</span><span class="sxs-lookup"><span data-stu-id="d5954-138">For example, if each packet contains one second of 44.1 kilohertz (kHz) audio, the first packet has a media start time of zero and a media stop time of 44100.</span></span> <span data-ttu-id="d5954-139">En una secuencia que se pueda buscar, la hora del medio siempre es relativa a la hora de inicio de la secuencia.</span><span class="sxs-lookup"><span data-stu-id="d5954-139">In a seekable stream, the media time is always relative to the start time of the stream.</span></span> <span data-ttu-id="d5954-140">Por ejemplo, supongamos que busca 2 segundos desde el inicio de una secuencia de vídeo de 15 fps.</span><span class="sxs-lookup"><span data-stu-id="d5954-140">For example, suppose you seek to 2 seconds from the start of a 15-fps video stream.</span></span> <span data-ttu-id="d5954-141">El primer ejemplo multimedia después de la búsqueda tiene una marca de tiempo de cero, pero un tiempo medio de 30.</span><span class="sxs-lookup"><span data-stu-id="d5954-141">The first media sample after the seek has a time stamp of zero but a media time of 30.</span></span>

<span data-ttu-id="d5954-142">Los filtros de representador y MUX pueden utilizar la hora del medio para determinar si se han quitado marcos o muestras, comprobando si hay huecos.</span><span class="sxs-lookup"><span data-stu-id="d5954-142">Renderer and mux filters can use the media time to determine whether frames or samples have been dropped, by checking for gaps.</span></span> <span data-ttu-id="d5954-143">Sin embargo, los filtros no son necesarios para establecer la hora del medio.</span><span class="sxs-lookup"><span data-stu-id="d5954-143">However, filters are not required to set the media time.</span></span> <span data-ttu-id="d5954-144">Para establecer la hora del medio en un ejemplo, llame al método [**IMediaSample:: SetMediaTime**](/windows/desktop/api/Strmif/nf-strmif-imediasample-setmediatime) .</span><span class="sxs-lookup"><span data-stu-id="d5954-144">To set the media time on a sample, call the [**IMediaSample::SetMediaTime**](/windows/desktop/api/Strmif/nf-strmif-imediasample-setmediatime) method.</span></span>

## <a name="related-topics"></a><span data-ttu-id="d5954-145">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="d5954-145">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d5954-146">Hora y relojes en DirectShow</span><span class="sxs-lookup"><span data-stu-id="d5954-146">Time and Clocks in DirectShow</span></span>](time-and-clocks-in-directshow.md)
</dt> </dl>

 

 



