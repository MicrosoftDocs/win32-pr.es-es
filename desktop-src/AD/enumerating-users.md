---
title: Enumerar usuarios
description: A diferencia de los dominios de Windows NT 4,0, los usuarios de Windows 2000 se pueden colocar en cualquier contenedor o unidad organizativa (OU) de un dominio, así como en la raíz del dominio.
ms.assetid: 4a35af7a-f43b-4cf9-a030-77f6c2518ae7
ms.tgt_platform: multiple
keywords:
- Enumerar AD de usuarios
- usuarios AD, enumeración de un usuario
- Active Directory, uso, usuarios, enumeración de un usuario
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e922d92f4313ed0238ff068f7ae1c0fbf693d497
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/17/2020
ms.locfileid: "105656349"
---
# <a name="enumerating-users"></a><span data-ttu-id="aa71f-106">Enumerar usuarios</span><span class="sxs-lookup"><span data-stu-id="aa71f-106">Enumerating Users</span></span>

<span data-ttu-id="aa71f-107">A diferencia de los dominios de Windows NT 4,0, los usuarios de Windows 2000 se pueden colocar en cualquier contenedor o unidad organizativa (OU) de un dominio, así como en la raíz del dominio.</span><span class="sxs-lookup"><span data-stu-id="aa71f-107">Unlike Windows NT 4.0 domains, Windows 2000 users can be placed in any container or organizational unit (OU) in a domain as well as the root of the domain.</span></span> <span data-ttu-id="aa71f-108">Esto significa que los usuarios pueden estar en varias ubicaciones en la jerarquía de directorios.</span><span class="sxs-lookup"><span data-stu-id="aa71f-108">This means that users can be in numerous locations in the directory hierarchy.</span></span> <span data-ttu-id="aa71f-109">Por lo tanto, tiene dos opciones para enumerar los usuarios:</span><span class="sxs-lookup"><span data-stu-id="aa71f-109">Therefore, you have two choices for enumerating users:</span></span>

-   <span data-ttu-id="aa71f-110">Enumerar los usuarios que se encuentran directamente en un contenedor, una unidad organizativa o en la raíz del dominio:</span><span class="sxs-lookup"><span data-stu-id="aa71f-110">Enumerate the users directly contained in a container, OU, or at the root of the domain:</span></span>

    <span data-ttu-id="aa71f-111">Enlace explícitamente al objeto contenedor que contiene los usuarios que está interesado en enumerar, establezca un filtro que contenga "User" como la clase mediante la propiedad [**IADsContainer. Filter**](/windows/desktop/ADSI/iadscontainer-property-methods) y use el método [**IADsContainer:: get \_ \_ NewEnum**](/windows/desktop/api/iads/nf-iads-iadscontainer-get__newenum) para enumerar los objetos de usuario.</span><span class="sxs-lookup"><span data-stu-id="aa71f-111">Explicitly bind to the container object that contains the users you are interested in enumerating, set a filter containing "user" as the class using the [**IADsContainer.Filter**](/windows/desktop/ADSI/iadscontainer-property-methods) property, and use the [**IADsContainer::get\_\_NewEnum**](/windows/desktop/api/iads/nf-iads-iadscontainer-get__newenum) method to enumerate the user objects.</span></span>

    <span data-ttu-id="aa71f-112">Esta técnica se puede usar para enumerar los usuarios que están contenidos directamente en un contenedor o un objeto de unidad organizativa.</span><span class="sxs-lookup"><span data-stu-id="aa71f-112">This technique can be used to enumerate users that are directly contained in a container or OU object.</span></span> <span data-ttu-id="aa71f-113">Si el contenedor contiene otros contenedores que pueden contener otros usuarios, debe enlazar a esos contenedores y enumerar de forma recursiva los usuarios de esos contenedores.</span><span class="sxs-lookup"><span data-stu-id="aa71f-113">If the container contains other containers that can potentially contain other users, you must bind to those containers and recursively enumerate the users on those containers.</span></span> <span data-ttu-id="aa71f-114">Si no es necesario manipular los objetos de usuario y solo necesita leer propiedades específicas, use la búsqueda en profundidad que se describe en la opción 2.</span><span class="sxs-lookup"><span data-stu-id="aa71f-114">If it is not required that you manipulate the user objects, and only need to read specific properties, use the deep search described in Option 2.</span></span>

    <span data-ttu-id="aa71f-115">Dado que la enumeración devuelve punteros a objetos COM ADSI que representan cada objeto de usuario, puede llamar a [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) para obtener punteros de interfaz [**IADs**](/windows/desktop/api/iads/nn-iads-iads), [**IADsUser**](/windows/desktop/api/iads/nn-iads-iadsuser)y [**IADsPropertyList**](/windows/desktop/api/iads/nn-iads-iadspropertylist) al objeto de usuario.</span><span class="sxs-lookup"><span data-stu-id="aa71f-115">Because enumeration returns pointers to ADSI COM objects representing each user object, you can call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) to get [**IADs**](/windows/desktop/api/iads/nn-iads-iads), [**IADsUser**](/windows/desktop/api/iads/nn-iads-iadsuser), and [**IADsPropertyList**](/windows/desktop/api/iads/nn-iads-iadspropertylist) interface pointers to the user object.</span></span> <span data-ttu-id="aa71f-116">Esto significa que puede obtener punteros de interfaz a cada objeto de usuario enumerado en un contenedor sin tener que enlazar explícitamente a cada objeto de usuario.</span><span class="sxs-lookup"><span data-stu-id="aa71f-116">This means you can get interface pointers to each enumerated user object in a container without having to explicitly bind to each user object.</span></span> <span data-ttu-id="aa71f-117">Para realizar operaciones en todos los usuarios directamente dentro de un contenedor, la enumeración evita tener que enlazar a cada usuario para poder llamar a métodos **IADs** o **IADsUser** .</span><span class="sxs-lookup"><span data-stu-id="aa71f-117">To perform operations on all the users directly within a container, enumeration avoids having to bind to each user in order to call **IADs** or **IADsUser** methods.</span></span> <span data-ttu-id="aa71f-118">Para recuperar propiedades específicas de los usuarios, use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) tal y como se describe en la opción 2.</span><span class="sxs-lookup"><span data-stu-id="aa71f-118">To retrieve specific properties from users, use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) as described in option 2.</span></span>

-   <span data-ttu-id="aa71f-119">Realice una búsqueda en profundidad (& (objectClass = User) (objectCategory = person)) para buscar todos los usuarios en un árbol:</span><span class="sxs-lookup"><span data-stu-id="aa71f-119">Perform a deep search for (&(objectClass=user)(objectCategory=person)) to find all users in a tree:</span></span>

    <span data-ttu-id="aa71f-120">En primer lugar, enlace al objeto contenedor en el que va a comenzar la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="aa71f-120">First, bind to the container object where to begin the search.</span></span> <span data-ttu-id="aa71f-121">Por ejemplo, para buscar todos los usuarios de un dominio, enlace a la raíz del dominio; para buscar todos los usuarios del bosque, enlace con el catálogo global y busque desde la raíz del GC.</span><span class="sxs-lookup"><span data-stu-id="aa71f-121">For example, to find all users in a domain, bind to root of the domain; to find all users in the forest, bind to the global catalog and search from the root of the GC.</span></span>

    <span data-ttu-id="aa71f-122">A continuación, use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) para consultar mediante un filtro de búsqueda que contenga (& (objectClass = User) (objectCategory = person)) y la preferencia de búsqueda del \_ subárbol del ámbito de ADS \_ .</span><span class="sxs-lookup"><span data-stu-id="aa71f-122">Then use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) to query using a search filter containing (&(objectClass=user)(objectCategory=person)) and search preference of ADS\_SCOPE\_SUBTREE.</span></span>

    <span data-ttu-id="aa71f-123">Puede realizar una búsqueda con una preferencia de búsqueda del ámbito de ADS \_ \_ onelevel para limitar la búsqueda al contenido directo del objeto contenedor al que se ha enlazado.</span><span class="sxs-lookup"><span data-stu-id="aa71f-123">You can perform a search with a search preference of ADS\_SCOPE\_ONELEVEL to limit the search to the direct contents of the container object that you bound to.</span></span>

    <span data-ttu-id="aa71f-124">[**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) solo recupera los valores de propiedades específicas de los usuarios.</span><span class="sxs-lookup"><span data-stu-id="aa71f-124">[**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) retrieves only the values of specific properties from users.</span></span> <span data-ttu-id="aa71f-125">Para recuperar valores, use **IDirectorySearch**.</span><span class="sxs-lookup"><span data-stu-id="aa71f-125">To retrieve values, use **IDirectorySearch**.</span></span> <span data-ttu-id="aa71f-126">Para manipular los objetos de usuario devueltos por una búsqueda, es decir, desea usar métodos [**IADs**](/windows/desktop/api/iads/nn-iads-iads) o [**IADsUser**](/windows/desktop/api/iads/nn-iads-iadsuser) , debe enlazarlos explícitamente.</span><span class="sxs-lookup"><span data-stu-id="aa71f-126">To manipulate the user objects returned from a search, that is, you want to use [**IADs**](/windows/desktop/api/iads/nn-iads-iads) or [**IADsUser**](/windows/desktop/api/iads/nn-iads-iadsuser) methods, you must explicitly bind to them.</span></span> <span data-ttu-id="aa71f-127">Para ello, especifique **distinguishedName** como una de las propiedades que se van a devolver de la búsqueda y use los nombres distintivos devueltos para enlazar con cada usuario devuelto en la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="aa71f-127">To do this, specify **distinguishedName** as one of the properties to return from the search and use the returned distinguished names to bind to each user returned in the search.</span></span>

    <span data-ttu-id="aa71f-128">Solo se recuperan las propiedades específicas.</span><span class="sxs-lookup"><span data-stu-id="aa71f-128">Only specific properties are retrieved.</span></span> <span data-ttu-id="aa71f-129">No se pueden recuperar todos los atributos sin especificar explícitamente cada atributo posible de la clase de usuario.</span><span class="sxs-lookup"><span data-stu-id="aa71f-129">You cannot retrieve all attributes without explicitly specifying every possible attribute of the user class.</span></span>

 

 