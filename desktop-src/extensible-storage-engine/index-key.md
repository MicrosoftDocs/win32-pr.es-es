---
description: 'Más información acerca de: clave de índice'
title: Clave de índice
TOCTitle: Index Key
ms:assetid: 104bdb1c-71ac-44f4-bbda-c553131aaad4
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269188(v=EXCHG.10)
ms:contentKeyID: 32765491
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: eff0812f363fa83d133ab087140d415d8e2dbad3
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104558093"
---
# <a name="index-key"></a><span data-ttu-id="f6638-103">Clave de índice</span><span class="sxs-lookup"><span data-stu-id="f6638-103">Index Key</span></span>


<span data-ttu-id="f6638-104">_**Se aplica a:** Windows | Windows Server_</span><span class="sxs-lookup"><span data-stu-id="f6638-104">_**Applies to:** Windows | Windows Server_</span></span>

## <a name="index-key"></a><span data-ttu-id="f6638-105">Clave de índice</span><span class="sxs-lookup"><span data-stu-id="f6638-105">Index Key</span></span>

<span data-ttu-id="f6638-106">Se crea un índice sobre los datos de la tabla con [JetCreateIndex](./jetcreateindex-function.md) o varios índices, que se pueden crear simultáneamente con [JetCreateIndex2](./jetcreateindex2-function.md) mediante la estructura de [JET_INDEXCREATE](./jet-indexcreate-structure.md) .</span><span class="sxs-lookup"><span data-stu-id="f6638-106">An index is created over data in the table with [JetCreateIndex](./jetcreateindex-function.md) or multiple indexes may be created simultaneously with [JetCreateIndex2](./jetcreateindex2-function.md) using the [JET_INDEXCREATE](./jet-indexcreate-structure.md) structure.</span></span> <span data-ttu-id="f6638-107">El índice se define en términos de una matriz de columnas, en orden de prioridad.</span><span class="sxs-lookup"><span data-stu-id="f6638-107">The index is defined in terms of an array of columns, in precedence order.</span></span> <span data-ttu-id="f6638-108">Esta matriz de columnas también se denomina clave de índice.</span><span class="sxs-lookup"><span data-stu-id="f6638-108">This array of columns is also called the index key.</span></span> <span data-ttu-id="f6638-109">La clave de índice se puede definir como índice principal cuando se establece la opción JET_bitIndexPrimary en el parámetro *grbit* de [JetCreateIndex](./jetcreateindex-function.md) o [JET_INDEXCREATE](./jet-indexcreate-structure.md).</span><span class="sxs-lookup"><span data-stu-id="f6638-109">The index key may be defined as the primary index when the JET_bitIndexPrimary option is set in the *grbit* parameter of [JetCreateIndex](./jetcreateindex-function.md) or [JET_INDEXCREATE](./jet-indexcreate-structure.md).</span></span> <span data-ttu-id="f6638-110">La clave de índice es una cadena terminada en NULL de tokens terminados en null, tal y como se muestra en el ejemplo siguiente:</span><span class="sxs-lookup"><span data-stu-id="f6638-110">The index key is a null terminated string of null terminated tokens as shown in the following example:</span></span>

<span data-ttu-id="f6638-111">\+Col1 \\ 0-Col2 \\ 0 + Col3 \\ 0 \\ 0</span><span class="sxs-lookup"><span data-stu-id="f6638-111">\+Col1\\0-Col2\\0+Col3\\0\\0</span></span>

<span data-ttu-id="f6638-112">La clave del ejemplo se puede usar para crear un índice en tres columnas de la tabla.</span><span class="sxs-lookup"><span data-stu-id="f6638-112">The key in the example may be used to create an index over three columns in the table.</span></span> <span data-ttu-id="f6638-113">Cada columna especificada en el índice se conoce como "segmento de índice" o "columna de clave".</span><span class="sxs-lookup"><span data-stu-id="f6638-113">Each column specified in the index is referred to as the "index segment" or "key column".</span></span> <span data-ttu-id="f6638-114">El segmento de índice puede ser ascendente o descendente en cuanto a su contribución de ordenación.</span><span class="sxs-lookup"><span data-stu-id="f6638-114">The index segment may be either ascending or descending in terms of its ordering contribution.</span></span> <span data-ttu-id="f6638-115">En el ejemplo anterior, el nombre de la primera columna del índice es col1.</span><span class="sxs-lookup"><span data-stu-id="f6638-115">In the example above, the name of the first column in the index is Col1.</span></span> <span data-ttu-id="f6638-116">El objeto + indica que col1 está indexado en orden ascendente.</span><span class="sxs-lookup"><span data-stu-id="f6638-116">The + indicates that Col1 is indexed in ascending order.</span></span> <span data-ttu-id="f6638-117">El – antes de Col2 indica que está indexado en orden descendente.</span><span class="sxs-lookup"><span data-stu-id="f6638-117">The – before Col2 indicates that it is indexed in descending order.</span></span>

<span data-ttu-id="f6638-118">Cuando las columnas condicionales están presentes en el índice, la estructura de [JET_CONDITIONALCOLUMN](./jet-conditionalcolumn-structure.md) se usa para indicar cómo se indexan.</span><span class="sxs-lookup"><span data-stu-id="f6638-118">When conditional columns are present in the index, the [JET_CONDITIONALCOLUMN](./jet-conditionalcolumn-structure.md) structure is used to indicate how they are indexed.</span></span> <span data-ttu-id="f6638-119">Una columna condicional se puede usar para controlar la presencia o ausencia de una entrada de índice en un índice basándose en el valor de la columna condicional correspondiente sin afectar al criterio de ordenación del índice.</span><span class="sxs-lookup"><span data-stu-id="f6638-119">A conditional column may be used to control the presence or absence of an index entry in an index based on the value in the corresponding conditional column without affecting the sort order of the index.</span></span> <span data-ttu-id="f6638-120">Una columna condicional puede incluir o excluir una entrada de índice del índice si el valor de esa columna condicional es NULL para el registro correspondiente.</span><span class="sxs-lookup"><span data-stu-id="f6638-120">A conditional column may include or exclude an index entry from the index if the value of that conditional column is NULL for the corresponding record.</span></span>

<span data-ttu-id="f6638-121">De forma predeterminada, el tamaño máximo de la clave de índice viene determinado por la constante JET_cbKeyMost, que siempre ha sido 255 bytes de datos normalizados (bytes de datos, incluida la sobrecarga de indización).</span><span class="sxs-lookup"><span data-stu-id="f6638-121">By default, the maximum size of the index key is given by the JET_cbKeyMost constant which has always been 255 bytes of normalized data (bytes of data including the indexing overhead).</span></span> <span data-ttu-id="f6638-122">A partir de Windows Vista, el tamaño máximo de la clave de índice se puede establecer con la estructura [JET_INDEXCREATE](./jet-indexcreate-structure.md) .</span><span class="sxs-lookup"><span data-stu-id="f6638-122">Starting with Windows Vista, the maximum size of the index key can be set with the [JET_INDEXCREATE](./jet-indexcreate-structure.md) structure.</span></span> <span data-ttu-id="f6638-123">El tamaño máximo de la clave de índice corresponde al tamaño de página de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="f6638-123">The maximum size of the index key corresponds to the database page size.</span></span> <span data-ttu-id="f6638-124">Para habilitar un tamaño de clave máximo personalizado, especifique la opción Jet_bitIndexKeyMost en el miembro grbits de [JET_INDEXCREATE](./jet-indexcreate-structure.md)y establezca el miembro **cbKeyMost** en uno de los siguientes valores:</span><span class="sxs-lookup"><span data-stu-id="f6638-124">To enable a custom maximum key size, specify the Jet_bitIndexKeyMost option in the grbits member of [JET_INDEXCREATE](./jet-indexcreate-structure.md), and set the **cbKeyMost** member to one of the following values:</span></span>

  - <span data-ttu-id="f6638-125">JET_cbKeyMost2KBytePage: cuando el tamaño de la página de la base de datos es de 2048 bytes, el tamaño máximo de la clave de índice puede estar entre 255 bytes como mínimo y 500 bytes como máximo.</span><span class="sxs-lookup"><span data-stu-id="f6638-125">JET_cbKeyMost2KBytePage: When the database page size is 2048 bytes, the maximum index key size can be between 255 bytes minimum, and 500 bytes maximum.</span></span>

  - <span data-ttu-id="f6638-126">JET_cbKeyMost4KBytePage: cuando el tamaño de la página de la base de datos es de 4096 bytes, el tamaño máximo de la clave de índice puede estar entre 255 bytes como mínimo y 1000 bytes como máximo.</span><span class="sxs-lookup"><span data-stu-id="f6638-126">JET_cbKeyMost4KBytePage: When the database page size is 4096 bytes, the maximum index key size can be between 255 bytes minimum, and 1000 bytes maximum.</span></span>

  - <span data-ttu-id="f6638-127">JET_cbKeyMost8KBytePage: cuando el tamaño de la página de la base de datos es de 8196 bytes, el tamaño máximo de la clave de índice puede estar entre 255 bytes como mínimo y 2000 bytes como máximo.</span><span class="sxs-lookup"><span data-stu-id="f6638-127">JET_cbKeyMost8KBytePage: When the database page size is 8196 bytes, the maximum index key size can be between 255 bytes minimum, and 2000 bytes maximum.</span></span>

<span data-ttu-id="f6638-128">En el ejemplo del diagrama siguiente se muestra una tabla que contiene información de los empleados.</span><span class="sxs-lookup"><span data-stu-id="f6638-128">The example in the diagram below shows a table containing employee information.</span></span> <span data-ttu-id="f6638-129">La tabla tiene seis columnas, cada una de las cuales define un atributo de empleado específico.</span><span class="sxs-lookup"><span data-stu-id="f6638-129">The table has 6 columns, each defining a specific employee attribute.</span></span> <span data-ttu-id="f6638-130">Un registro de la tabla contiene los valores de un empleado, como el nombre del empleado en la columna 1 y el ID. de empleado en la columna 2.</span><span class="sxs-lookup"><span data-stu-id="f6638-130">A record in the table contains values for an employee, such as the employee name in column 1 and employee ID in column 2.</span></span> <span data-ttu-id="f6638-131">Un índice principal creado para esta tabla organiza los datos según el nombre del empleado en primer lugar y el ID. de empleado.</span><span class="sxs-lookup"><span data-stu-id="f6638-131">A primary index created for this table organizes the data according to the employee name first, and the employee ID second.</span></span> <span data-ttu-id="f6638-132">El nombre y el identificador se indizan en orden ascendente.</span><span class="sxs-lookup"><span data-stu-id="f6638-132">Both name and ID are indexed in ascending order.</span></span> <span data-ttu-id="f6638-133">Por ejemplo, un registro que contenga el nombre Johnson y el ID. de empleado 12345 se enumerarán antes de un registro con un nombre de empleado Jones y un identificador de 10000.</span><span class="sxs-lookup"><span data-stu-id="f6638-133">For example, a record containing the name Johnson and employee ID 12345 will be listed before of a record with an employee name Jones and an ID of 10000.</span></span> <span data-ttu-id="f6638-134">Todos los registros de Jones se almacenan juntos en la tabla, con sus identificadores de empleado en orden ascendente, tal como se muestra en la tabla.</span><span class="sxs-lookup"><span data-stu-id="f6638-134">All the records for Jones are stored together in the table, with their employee IDs in ascending order as shown in the table.</span></span>

<span data-ttu-id="f6638-135">![ESE_Documentation_IndexTable](images/Gg269188.ESE_Documentation_IndexTable(EXCHG.10).gif "ESE_Documentation_IndexTable")</span><span class="sxs-lookup"><span data-stu-id="f6638-135">![ESE_Documentation_IndexTable](images/Gg269188.ESE_Documentation_IndexTable(EXCHG.10).gif "ESE_Documentation_IndexTable")</span></span>

<span data-ttu-id="f6638-136">La clave del índice principal debe ser única, pero las claves del índice secundario pueden ser duplicados.</span><span class="sxs-lookup"><span data-stu-id="f6638-136">The key in the primary index must be unique, but the keys in the secondary index can be duplicates.</span></span> <span data-ttu-id="f6638-137">Por ejemplo, si se crea un índice con el apellido y hay dos personas con Stevens en la base de datos, ESE devuelve un error de Jet_errKeyDuplicate de [JetUpdate](./jetupdate-function.md) o [JetUpdate2](./jetupdate2-function.md), cuando la aplicación intenta insertar el segundo "Stevens".</span><span class="sxs-lookup"><span data-stu-id="f6638-137">For example, if an index is created over last name, and there are two people with Stevens in the database, ESE returns a Jet_errKeyDuplicate error from [JetUpdate](./jetupdate-function.md) or [JetUpdate2](./jetupdate2-function.md), when the application attempts to insert the second "Stevens".</span></span> <span data-ttu-id="f6638-138">Cuando la clave real es mayor que el tamaño de clave máximo, se trunca la clave.</span><span class="sxs-lookup"><span data-stu-id="f6638-138">When the actual key is larger than the maximum key size, the key is truncated.</span></span> <span data-ttu-id="f6638-139">La búsqueda y la unicidad de los efectos de truncamiento de clave y deben ser administrados por la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f6638-139">Key truncation effects searching and uniqueness and should be managed by the application.</span></span> <span data-ttu-id="f6638-140">Por ejemplo, si "Stevens" y "Stevenson" se almacenaron en un índice por encima del apellido y el tamaño máximo de la clave era demasiado pequeño para almacenar la parte "ON" de "Stevenson", el truncamiento de claves daría lugar a que el motor de base de datos declarara que "Stevens" y "Stevenson" son duplicados aunque no lo sean.</span><span class="sxs-lookup"><span data-stu-id="f6638-140">For example, if "Stevens" and "Stevenson" were stored in an index over last name and the max key size were too small to store the "on" portion of "Stevenson" then key truncation would result in the database engine declaring that "Stevens" and "Stevenson" are duplicates even though they are not.</span></span> <span data-ttu-id="f6638-141">La aplicación debe estar preparada para controlar los casos como este durante la búsqueda y la actualización si la definición del índice y los valores de columna que indexa son tales que el truncamiento de claves es una posibilidad.</span><span class="sxs-lookup"><span data-stu-id="f6638-141">The application must be prepared to handle cases like this during search and update if the index definition and the column values it indexes are such that key truncation is a possibility.</span></span> <span data-ttu-id="f6638-142">A partir de Windows Vista, las aplicaciones pueden especificar la opción Jet_bitIndexDisallowTruncation en [JET_INDEXCREATE](./jet-indexcreate-structure.md) o [JetMakeKey](./jetmakekey-function.md).</span><span class="sxs-lookup"><span data-stu-id="f6638-142">Starting in Windows Vista, applications can specify the Jet_bitIndexDisallowTruncation option in [JET_INDEXCREATE](./jet-indexcreate-structure.md) or [JetMakeKey](./jetmakekey-function.md).</span></span> <span data-ttu-id="f6638-143">Si se especifica este marcador, se producirá un error en cualquier actualización del índice que dé lugar a una clave truncada con JET_errKeyTruncated.</span><span class="sxs-lookup"><span data-stu-id="f6638-143">Specifying this flag will cause any update to the index that would result in a truncated key to fail with JET_errKeyTruncated.</span></span> <span data-ttu-id="f6638-144">De lo contrario, las claves se truncarán de forma silenciosa.</span><span class="sxs-lookup"><span data-stu-id="f6638-144">Otherwise, keys will be silently truncated.</span></span> <span data-ttu-id="f6638-145">Esto permitirá que la aplicación funcione sin preocuparse por los artefactos causados por el truncamiento de clave que se ha descrito anteriormente.</span><span class="sxs-lookup"><span data-stu-id="f6638-145">This will allow the application to function without concern for the artifacts caused by key truncation that were previously described.</span></span>
