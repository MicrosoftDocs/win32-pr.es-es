---
title: Administrar propiedades
description: Cada propiedad está formada por un identificador de propiedad (único dentro de su conjunto de propiedades), una etiqueta de tipo variante (VT o VarType) que representa el tipo de un valor y el propio valor.
ms.assetid: d220ecb4-b014-4ac9-a636-9a493187cc87
keywords:
- Almacenamiento estructurado Strctd STG, usar, administrar propiedades
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 10dd78a1f8a8484090728dba6fe149840e940461
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "103904668"
---
# <a name="managing-properties"></a><span data-ttu-id="0999a-104">Administrar propiedades</span><span class="sxs-lookup"><span data-stu-id="0999a-104">Managing Properties</span></span>

<span data-ttu-id="0999a-105">Cada propiedad está formada por un *identificador de propiedad* (único dentro de su conjunto de propiedades), una etiqueta de *tipo variante (VT o VarType)* que representa el tipo de un valor y el propio *valor* .</span><span class="sxs-lookup"><span data-stu-id="0999a-105">Every property consists of a *property identifier* (unique within its property set), a *variant type (VT or VarType) tag* that represents the type of a value, and the *value* itself.</span></span> <span data-ttu-id="0999a-106">La etiqueta de tipo variante describe la representación de los datos en el valor.</span><span class="sxs-lookup"><span data-stu-id="0999a-106">The variant type tag describes the representation of the data in the value.</span></span> <span data-ttu-id="0999a-107">Además, una propiedad también puede tener asignado un *nombre de cadena* que se puede usar para identificar la propiedad, en lugar de usar el identificador de propiedad numérico (ID.) necesario.</span><span class="sxs-lookup"><span data-stu-id="0999a-107">In addition, a property may also be assigned a *string name* that can be used to identify the property, rather than using the required numerical property identifier (ID).</span></span> <span data-ttu-id="0999a-108">Para crear y administrar propiedades, COM define la interfaz [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) .</span><span class="sxs-lookup"><span data-stu-id="0999a-108">To create and manage properties, COM defines the [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interface.</span></span>

<span data-ttu-id="0999a-109">La interfaz [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) incluye métodos para leer y escribir matrices de propiedades o nombres de propiedad.</span><span class="sxs-lookup"><span data-stu-id="0999a-109">The [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interface includes methods to read and write arrays of either properties or property names.</span></span> <span data-ttu-id="0999a-110">La interfaz incluye métodos [**commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) y [**Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) que son similares a los métodos [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) del mismo nombre.</span><span class="sxs-lookup"><span data-stu-id="0999a-110">The interface includes [**Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) and [**Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) methods that are similar to [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) methods of the same name.</span></span> <span data-ttu-id="0999a-111">Existen métodos de utilidad que permiten establecer el identificador de clase (CLSID) del conjunto de propiedades, establecer las horas asociadas al conjunto y obtener estadísticas sobre el conjunto de propiedades.</span><span class="sxs-lookup"><span data-stu-id="0999a-111">There are utility methods that allow you to set the class identifier (CLSID) of the property set, set the times associated with the set, and get statistics about the property set.</span></span> <span data-ttu-id="0999a-112">Por último, el método [**enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) crea un enumerador y devuelve un puntero a su interfaz [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) .</span><span class="sxs-lookup"><span data-stu-id="0999a-112">Finally, the [**Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) method creates an enumerator and returns a pointer to its [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) interface.</span></span> <span data-ttu-id="0999a-113">Puede llamar a los métodos de esta interfaz para enumerar las estructuras [**STATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) en el objeto, que proporcionará información sobre todas las propiedades del conjunto de propiedades actual.</span><span class="sxs-lookup"><span data-stu-id="0999a-113">You can call the methods of this interface to enumerate [**STATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) structures on your object, which will provide information about all of the properties in the current property set.</span></span>

<span data-ttu-id="0999a-114">A continuación se presenta un ejemplo de cómo se representan las propiedades.</span><span class="sxs-lookup"><span data-stu-id="0999a-114">The following is an example of how properties are represented.</span></span> <span data-ttu-id="0999a-115">Si una propiedad específica de un conjunto de propiedades contiene el nombre científico de un animal, ese nombre podría almacenarse como una cadena terminada en cero.</span><span class="sxs-lookup"><span data-stu-id="0999a-115">If a specific property in a property set holds an animal's scientific name, that name could be stored as a zero-terminated string.</span></span> <span data-ttu-id="0999a-116">Almacenado junto con el nombre sería un indicador de tipo para indicar que el valor es una cadena terminada en cero.</span><span class="sxs-lookup"><span data-stu-id="0999a-116">Stored along with the name would be a type indicator to indicate that the value is a zero-terminated string.</span></span> <span data-ttu-id="0999a-117">Estas propiedades pueden tener las siguientes características:</span><span class="sxs-lookup"><span data-stu-id="0999a-117">These properties might have the following characteristics:</span></span>



| <span data-ttu-id="0999a-118">Id. de propiedad</span><span class="sxs-lookup"><span data-stu-id="0999a-118">Property ID</span></span> | <span data-ttu-id="0999a-119">Identificador de cadena</span><span class="sxs-lookup"><span data-stu-id="0999a-119">String identifier</span></span> | <span data-ttu-id="0999a-120">Indicador de tipo</span><span class="sxs-lookup"><span data-stu-id="0999a-120">Type indicator</span></span> | <span data-ttu-id="0999a-121">Valor representado</span><span class="sxs-lookup"><span data-stu-id="0999a-121">Value represented</span></span>              |
|-------------|-------------------|----------------|--------------------------------|
| <span data-ttu-id="0999a-122">02</span><span class="sxs-lookup"><span data-stu-id="0999a-122">02</span></span>          | <span data-ttu-id="0999a-123">PID \_ ANIMALNAME</span><span class="sxs-lookup"><span data-stu-id="0999a-123">PID\_ANIMALNAME</span></span>   | <span data-ttu-id="0999a-124">VT \_ LPWStr</span><span class="sxs-lookup"><span data-stu-id="0999a-124">VT\_LPWSTR</span></span>     | <span data-ttu-id="0999a-125">Cadena Unicode terminada en cero</span><span class="sxs-lookup"><span data-stu-id="0999a-125">Zero-terminated Unicode string</span></span> |
| <span data-ttu-id="0999a-126">03</span><span class="sxs-lookup"><span data-stu-id="0999a-126">03</span></span>          | <span data-ttu-id="0999a-127">PID \_ LEGCOUNT</span><span class="sxs-lookup"><span data-stu-id="0999a-127">PID\_LEGCOUNT</span></span>     | <span data-ttu-id="0999a-128">I2 de VT \_</span><span class="sxs-lookup"><span data-stu-id="0999a-128">VT\_I2</span></span>         | <span data-ttu-id="0999a-129">WORD</span><span class="sxs-lookup"><span data-stu-id="0999a-129">WORD</span></span>                           |



 

<span data-ttu-id="0999a-130">Cualquier aplicación que reconozca el formato del conjunto de propiedades, que lo identifica a través de su identificador de formato (FMTID), puede examinar la propiedad con un identificador de PID \_ ANIMALNAME, determinar que es una cadena terminada en cero y leer y escribir el valor.</span><span class="sxs-lookup"><span data-stu-id="0999a-130">Any application that recognizes the property set format—identifying it through its format identifier (FMTID)—can look at the property with an identifier of PID\_ANIMALNAME, determine that it is a zero-terminated string, and read and write the value.</span></span> <span data-ttu-id="0999a-131">Aunque la aplicación puede llamar a [**IPropertyStorage:: ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) para leer alguno o todos los conjuntos de propiedades (que primero obtuvieron un puntero), la aplicación debe saber cómo interpretar el conjunto de propiedades.</span><span class="sxs-lookup"><span data-stu-id="0999a-131">Although the application can call [**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) to read any or all of a property set (having first obtained a pointer), the application must know how to interpret the property set.</span></span>

<span data-ttu-id="0999a-132">Un valor de propiedad se pasa a través de las interfaces de propiedad como una instancia del tipo [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant).</span><span class="sxs-lookup"><span data-stu-id="0999a-132">A property value is passed through property interfaces as an instance of the type [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant).</span></span>

<span data-ttu-id="0999a-133">Es importante distinguir entre estas propiedades almacenadas (persistentes) y las propiedades en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="0999a-133">It is important to distinguish between these stored (persistent) properties, and run-time properties.</span></span> <span data-ttu-id="0999a-134">Las constantes de valor de tipo variante tienen nombres que empiezan por VT \_ .</span><span class="sxs-lookup"><span data-stu-id="0999a-134">Variant-type value constants have names beginning with VT\_.</span></span> <span data-ttu-id="0999a-135">Sin embargo, el conjunto de PROPVARIANTs válidos no es totalmente equivalente al conjunto de variantes usadas en Automation y controles ActiveX.</span><span class="sxs-lookup"><span data-stu-id="0999a-135">The set of valid PROPVARIANTs is, however, not entirely equivalent to the set of VARIANTs used in Automation and ActiveX controls.</span></span>

<span data-ttu-id="0999a-136">La única diferencia entre las dos estructuras es el conjunto permitido de etiquetas VT \_ (tipo variante/VarType) en cada una de ellas.</span><span class="sxs-lookup"><span data-stu-id="0999a-136">The only difference between the two structures is the allowable set of VT\_ (Variant Type / VarType) tags in each.</span></span> <span data-ttu-id="0999a-137">Cuando se puede usar un tipo de propiedad determinado en una variante y en un PROPVARIANT, la etiqueta de tipo (el valor de VT \_ ) siempre tiene un valor idéntico.</span><span class="sxs-lookup"><span data-stu-id="0999a-137">Where a certain property type can be used in both a VARIANT and a PROPVARIANT, the type tag (the VT\_ value) always has an identical value.</span></span> <span data-ttu-id="0999a-138">Además, para un valor de VT determinado \_ , la representación en memoria utilizada en las variantes y PROPVARIANTs es idéntica.</span><span class="sxs-lookup"><span data-stu-id="0999a-138">Further, for a given VT\_ value, the in-memory representation used in VARIANTs and PROPVARIANTs is identical.</span></span> <span data-ttu-id="0999a-139">En conjunto, este enfoque permite que el sistema de tipos detecte etiquetas de tipo no permitidas, al mismo tiempo que permite a un cliente con conocimiento de la implementación de un puntero convertido cuando sea necesario.</span><span class="sxs-lookup"><span data-stu-id="0999a-139">Taken all together, this approach allows the type system to catch disallowed type tags, while at the same time allowing a knowledgeable client to implement a pointer cast when appropriate.</span></span>

<span data-ttu-id="0999a-140">Para obtener más información, vea la sección siguiente, [consideraciones sobre el almacenamiento de propiedades](property-storage-considerations.md).</span><span class="sxs-lookup"><span data-stu-id="0999a-140">For more information, see the following section, [Property Storage Considerations](property-storage-considerations.md).</span></span>

 

 