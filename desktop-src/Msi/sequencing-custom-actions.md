---
description: Las acciones personalizadas se programan en las tablas de secuencia de la misma manera que las acciones estándar.
ms.assetid: 1aea75b1-a498-405e-9208-91672455496b
title: Secuenciar acciones personalizadas
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ad7c24fb91247a36880cb808c9b8e10437312cf7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "104279323"
---
# <a name="sequencing-custom-actions"></a><span data-ttu-id="ee5e8-103">Secuenciar acciones personalizadas</span><span class="sxs-lookup"><span data-stu-id="ee5e8-103">Sequencing Custom Actions</span></span>

<span data-ttu-id="ee5e8-104">Las acciones personalizadas se programan en las tablas de secuencia de la misma manera que las acciones estándar.</span><span class="sxs-lookup"><span data-stu-id="ee5e8-104">Custom actions are scheduled in sequence tables in the same way as standard actions.</span></span>

<span data-ttu-id="ee5e8-105">**Para programar una acción personalizada en una tabla de secuencia**</span><span class="sxs-lookup"><span data-stu-id="ee5e8-105">**To schedule a custom action in a sequence table**</span></span>

1.  <span data-ttu-id="ee5e8-106">Escriba el nombre de la acción personalizada (que es la clave principal de la tabla [CustomAction](customaction-table.md)) en la columna Acción de la tabla de [secuencia](sequence-table-detailed-example.md) .</span><span class="sxs-lookup"><span data-stu-id="ee5e8-106">Enter the custom action name (which is the primary key of the [CustomAction](customaction-table.md)) table into the Action column of the [Sequence](sequence-table-detailed-example.md) table.</span></span>
2.  <span data-ttu-id="ee5e8-107">Escriba la secuencia de la acción personalizada en relación con las demás acciones de la tabla en la columna secuencia de la tabla de [secuencia](sequence-table-detailed-example.md) .</span><span class="sxs-lookup"><span data-stu-id="ee5e8-107">Enter the custom action's sequence relative to the other actions in the table into the Sequence column of the [Sequence](sequence-table-detailed-example.md) table.</span></span> <span data-ttu-id="ee5e8-108">Para obtener más información sobre las tablas de secuencia, vea [usar una tabla de secuencia](using-a-sequence-table.md).</span><span class="sxs-lookup"><span data-stu-id="ee5e8-108">For more information about sequence tables, see [Using a Sequence Table](using-a-sequence-table.md).</span></span>
3.  <span data-ttu-id="ee5e8-109">Para omitir condicionalmente la acción, escriba una expresión condicional en la columna condición de la tabla de [secuencia](sequence-table-detailed-example.md) .</span><span class="sxs-lookup"><span data-stu-id="ee5e8-109">To conditionally skip the action, enter a conditional expression into the Condition column of the [Sequence](sequence-table-detailed-example.md) table.</span></span> <span data-ttu-id="ee5e8-110">El instalador omite esta acción si la expresión se evalúa como FALSE.</span><span class="sxs-lookup"><span data-stu-id="ee5e8-110">The installer skips this action if the expression evaluates to FALSE.</span></span>

<span data-ttu-id="ee5e8-111">Como en el caso de las acciones estándar, las acciones personalizadas que se programan en [InstallUISequence](installuisequence-table.md) o [AdminUISequence](adminuisequence-table.md) solo se ejecutan si la interfaz de usuario interna está establecida en el nivel completo.</span><span class="sxs-lookup"><span data-stu-id="ee5e8-111">As in the case of standard actions, custom actions that are scheduled in the [InstallUISequence](installuisequence-table.md) or [AdminUISequence](adminuisequence-table.md) run only if the internal user interface is set to the full level.</span></span> <span data-ttu-id="ee5e8-112">El nivel de interfaz de usuario se establece mediante la función [**MsiSetInternalUI**](/windows/desktop/api/Msi/nf-msi-msisetinternalui) .</span><span class="sxs-lookup"><span data-stu-id="ee5e8-112">The UI level is set by using the [**MsiSetInternalUI**](/windows/desktop/api/Msi/nf-msi-msisetinternalui) function.</span></span>

<span data-ttu-id="ee5e8-113">Las acciones estándar y personalizadas programadas en las tablas [InstallExecuteSequence](installexecutesequence-table.md), [AdminExecuteSequence](adminexecutesequence-table.md)o [AdvtExecuteSequence](advtexecutesequence-table.md) no realizan cambios en el sistema.</span><span class="sxs-lookup"><span data-stu-id="ee5e8-113">Standard and custom actions scheduled in the [InstallExecuteSequence](installexecutesequence-table.md), [AdminExecuteSequence](adminexecutesequence-table.md), or [AdvtExecuteSequence](advtexecutesequence-table.md) tables do not make system changes.</span></span> <span data-ttu-id="ee5e8-114">En su lugar, el instalador pone en cola los registros de ejecución en un script para su posterior ejecución durante el servicio de instalación.</span><span class="sxs-lookup"><span data-stu-id="ee5e8-114">Instead the installer queues up execution records in a script for subsequent execution during the install service.</span></span> <span data-ttu-id="ee5e8-115">Si no hay ningún servicio de instalación, las acciones programadas en estas tablas se ejecutan en el mismo contexto que la secuencia de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="ee5e8-115">If there is no install service, then the actions scheduled in these tables are run in the same context as the UI sequence.</span></span>

<span data-ttu-id="ee5e8-116">Si el servidor del instalador no está registrado, las acciones personalizadas se ejecutan en el lado cliente.</span><span class="sxs-lookup"><span data-stu-id="ee5e8-116">If the installer server is not registered, the custom actions are executed on the client side.</span></span> <span data-ttu-id="ee5e8-117">Si el servidor está registrado y usa el modo de interfaz de usuario completa, las acciones personalizadas se ejecutan en el lado del servidor.</span><span class="sxs-lookup"><span data-stu-id="ee5e8-117">If the server is registered and using the full UI mode, then the custom actions are run on the server side.</span></span>

<span data-ttu-id="ee5e8-118">Si usa la interfaz de usuario completa con el servidor, las acciones iniciales anteriores a la acción [InstallValidate](installvalidate-action.md) se ejecutan en el cliente para permitir una interacción completa.</span><span class="sxs-lookup"><span data-stu-id="ee5e8-118">If using full UI with the server, the initial actions prior to the [InstallValidate](installvalidate-action.md) action are run on the client to allow full interaction.</span></span> <span data-ttu-id="ee5e8-119">La ejecución se cambia al servidor, que repite las acciones y ejecuta las acciones de ejecución del script.</span><span class="sxs-lookup"><span data-stu-id="ee5e8-119">Execution is then switched to the server which repeats those actions and runs the script execution actions.</span></span> <span data-ttu-id="ee5e8-120">Esto va seguido de una devolución al cliente para las acciones finales.</span><span class="sxs-lookup"><span data-stu-id="ee5e8-120">This is followed by a return to the client for the final actions.</span></span>

<span data-ttu-id="ee5e8-121">Tenga en cuenta que si se quita un producto al establecer su característica Top en absent, la propiedad [**Remove**](remove.md) puede no ser igual a toda hasta después de la acción [InstallValidate](installvalidate-action.md) .</span><span class="sxs-lookup"><span data-stu-id="ee5e8-121">Note that if a product is removed by setting its top feature to absent, the [**REMOVE**](remove.md) property may not equal ALL until after the [InstallValidate](installvalidate-action.md) action.</span></span> <span data-ttu-id="ee5e8-122">Esto significa que cualquier acción personalizada que dependa de REMOVE = ALL se debe secuenciar después de la acción InstallValidate.</span><span class="sxs-lookup"><span data-stu-id="ee5e8-122">This means that any custom action that depends on REMOVE=ALL must be sequenced after the InstallValidate action.</span></span> <span data-ttu-id="ee5e8-123">Una acción personalizada puede activar quitar para determinar si se ha configurado un producto para que se desinstale por completo.</span><span class="sxs-lookup"><span data-stu-id="ee5e8-123">A custom action may check REMOVE to determine whether a product has been set to be completely uninstalled.</span></span>

<span data-ttu-id="ee5e8-124">Las acciones personalizadas que hacen referencia a un archivo instalado como origen, como el tipo de acción personalizada 17 (DLL), el tipo de acción personalizada 18 (EXE), el tipo de acción personalizada 21 (JScript) y el tipo de acción personalizada 22 (VBScript), deben cumplir las siguientes restricciones de secuenciación.</span><span class="sxs-lookup"><span data-stu-id="ee5e8-124">Custom actions that reference an installed file as their source, such as Custom Action Type 17 (DLL), Custom Action Type 18 (EXE), Custom Action Type 21 (JScript), and Custom Action Type 22 (VBScript), must adhere to the following sequencing restrictions.</span></span>

-   <span data-ttu-id="ee5e8-125">La acción personalizada se debe secuenciar después de la acción [CostFinalize](costfinalize-action.md) para que se pueda resolver la ruta de acceso al archivo al que se hace referencia.</span><span class="sxs-lookup"><span data-stu-id="ee5e8-125">The custom action must be sequenced after the [CostFinalize](costfinalize-action.md) action so that the path to the referenced file can be resolved.</span></span>
-   <span data-ttu-id="ee5e8-126">Si el archivo de origen todavía no está instalado en el equipo, las acciones personalizadas diferidas (en script) deben secuenciarse después de la [InstallFiles](installfiles-action.md).</span><span class="sxs-lookup"><span data-stu-id="ee5e8-126">If the source file is not already installed on the computer, deferred (in-script) custom actions must be sequenced after the [InstallFiles](installfiles-action.md).</span></span>
-   <span data-ttu-id="ee5e8-127">Si el archivo de código fuente no está ya instalado en el equipo, las acciones personalizadas de nondeferred se deben secuenciar después de la acción [InstallInitialize](installinitialize-action.md) .</span><span class="sxs-lookup"><span data-stu-id="ee5e8-127">If the source file is not already installed on the computer, nondeferred custom actions must be sequenced after the [InstallInitialize](installinitialize-action.md) action.</span></span>

<span data-ttu-id="ee5e8-128">Las siguientes restricciones de secuenciación se aplican a las acciones personalizadas que cambian o actualizan un paquete de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="ee5e8-128">The following sequencing restrictions apply to custom actions that change or update a Windows Installer package.</span></span>

-   <span data-ttu-id="ee5e8-129">Si la acción personalizada cambia el paquete, por ejemplo agregando filas a una tabla, la acción se debe secuenciar antes de la acción [InstallInitialize](installinitialize-action.md) .</span><span class="sxs-lookup"><span data-stu-id="ee5e8-129">If the custom action changes the package, such as by adding rows to a table, the action must be sequenced before the [InstallInitialize](installinitialize-action.md) action.</span></span>
-   <span data-ttu-id="ee5e8-130">Si la acción personalizada realiza cambios que afectan a los costos, se debe secuenciar antes de la acción [CostInitialize](costfinalize-action.md) .</span><span class="sxs-lookup"><span data-stu-id="ee5e8-130">If the custom action makes changes that would affect costing, then it should be sequenced before the [CostInitialize](costfinalize-action.md) action.</span></span>
-   <span data-ttu-id="ee5e8-131">Si la acción personalizada cambia el estado de la instalación de las características o componentes, se debe secuenciar antes de la acción [InstallValidate](installvalidate-action.md) .</span><span class="sxs-lookup"><span data-stu-id="ee5e8-131">If the custom action changes the installation state of features or components, it must be sequenced before the [InstallValidate](installvalidate-action.md) action.</span></span>

 

 



