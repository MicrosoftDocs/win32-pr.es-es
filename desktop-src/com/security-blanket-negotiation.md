---
title: Negociación de la capa de seguridad
description: Negociación de la capa de seguridad
ms.assetid: 5a01912d-611c-4a6e-ab9d-0243cba331f1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e51407de908eaaf0f79eea452046f8e424ccf900
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/21/2020
ms.locfileid: "104078443"
---
# <a name="security-blanket-negotiation"></a><span data-ttu-id="289ad-103">Negociación de la capa de seguridad</span><span class="sxs-lookup"><span data-stu-id="289ad-103">Security Blanket Negotiation</span></span>

<span data-ttu-id="289ad-104">Una capa de seguridad es un grupo de valores que describen la configuración de seguridad que se aplica a todos los servidores proxy de un proceso o solo a un proxy de interfaz determinado.</span><span class="sxs-lookup"><span data-stu-id="289ad-104">A security blanket is a group of values that describe the security settings that apply to all proxies in a process or to just a particular interface proxy.</span></span> <span data-ttu-id="289ad-105">Un marco de seguridad consta de los siguientes valores:</span><span class="sxs-lookup"><span data-stu-id="289ad-105">A security blanket comprises the following values:</span></span>

-   <span data-ttu-id="289ad-106">Servicio de autenticación</span><span class="sxs-lookup"><span data-stu-id="289ad-106">Authentication service</span></span>
-   <span data-ttu-id="289ad-107">Servicio de autorización</span><span class="sxs-lookup"><span data-stu-id="289ad-107">Authorization service</span></span>
-   <span data-ttu-id="289ad-108">Nombre principal</span><span class="sxs-lookup"><span data-stu-id="289ad-108">Principal name</span></span>
-   <span data-ttu-id="289ad-109">Nivel de autenticación</span><span class="sxs-lookup"><span data-stu-id="289ad-109">Authentication level</span></span>
-   <span data-ttu-id="289ad-110">Nivel de suplantación</span><span class="sxs-lookup"><span data-stu-id="289ad-110">Impersonation level</span></span>
-   <span data-ttu-id="289ad-111">Identidad de autenticación</span><span class="sxs-lookup"><span data-stu-id="289ad-111">Authentication identity</span></span>
-   <span data-ttu-id="289ad-112">Funcionalidades</span><span class="sxs-lookup"><span data-stu-id="289ad-112">Capabilities</span></span>
-   <span data-ttu-id="289ad-113">Una lista de control de acceso (ACL) (solo servidores)</span><span class="sxs-lookup"><span data-stu-id="289ad-113">An access control list (ACL) (servers only)</span></span>

<span data-ttu-id="289ad-114">La negociación de la capa de seguridad es el proceso que utiliza COM para elegir la configuración de seguridad de un proxy cuando se crea.</span><span class="sxs-lookup"><span data-stu-id="289ad-114">Security blanket negotiation is the process that COM uses to choose the security settings for a proxy when it is created.</span></span> <span data-ttu-id="289ad-115">Este proceso implica comparar el marco de seguridad del servidor con la capa de seguridad del cliente y usar esos valores para crear una capa de seguridad predeterminada adecuada para el proxy.</span><span class="sxs-lookup"><span data-stu-id="289ad-115">This process involves comparing the server's security blanket with the client's security blanket and using those values to create an appropriate default security blanket for the proxy.</span></span> <span data-ttu-id="289ad-116">En los párrafos siguientes se explica dónde provienen los elementos de las mantas de seguridad del cliente y del servidor, y se describe cómo COM negocia la capa de seguridad para el proxy utilizando las operaciones de seguridad del cliente y del servidor.</span><span class="sxs-lookup"><span data-stu-id="289ad-116">The following paragraphs explain where the client's and the server's security blankets come from and describe how COM negotiates the security blanket for the proxy using the client's and server's security blankets.</span></span>

<span data-ttu-id="289ad-117">El cliente y el servidor pueden llamar a [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) para especificar sus respectivos mantas de seguridad.</span><span class="sxs-lookup"><span data-stu-id="289ad-117">The client and the server can each call [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) to specify their respective security blankets.</span></span> <span data-ttu-id="289ad-118">Si una aplicación no llama a **CoInitializeSecurity** explícitamente, com lo llama implícitamente para la aplicación, con los valores predeterminados adecuados.</span><span class="sxs-lookup"><span data-stu-id="289ad-118">If an application doesn't call **CoInitializeSecurity** explicitly, COM calls it implicitly for the application, using appropriate default values.</span></span> <span data-ttu-id="289ad-119">Para obtener más información sobre estos valores predeterminados, vea valores [predeterminados de seguridad com](com-security-defaults.md).</span><span class="sxs-lookup"><span data-stu-id="289ad-119">For more information about these default values, see [COM Security Defaults](com-security-defaults.md).</span></span>

<span data-ttu-id="289ad-120">Algunos parámetros de [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) se aplican cuando la aplicación es un servidor y otros se aplican cuando la aplicación es un cliente.</span><span class="sxs-lookup"><span data-stu-id="289ad-120">Some parameters to [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) apply when the application is a server, and some apply when the application is a client.</span></span> <span data-ttu-id="289ad-121">Cuando la aplicación actúa como un servidor, estos parámetros son relevantes: una ACL, una lista de tuplas de servicio de autenticación/servicio de autorización/nombre de entidad de seguridad y un nivel de autenticación.</span><span class="sxs-lookup"><span data-stu-id="289ad-121">When the application is acting as a server, these parameters are relevant: an ACL, a list of authentication service/authorization service/principal name tuples, and an authentication level.</span></span> <span data-ttu-id="289ad-122">La llamada de un servidor a **CoInitializeSecurity**, ya sea implícita o explícita, determina el marco de seguridad del servidor, que permanece fijo.</span><span class="sxs-lookup"><span data-stu-id="289ad-122">A server's call to **CoInitializeSecurity**, whether implicit or explicit, determines the server's security blanket, which remains fixed.</span></span>

<span data-ttu-id="289ad-123">Cuando la aplicación actúa como cliente, los siguientes valores pasados a [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) son relevantes: un nivel de autenticación, un nivel de suplantación, la identidad de autenticación y las capacidades.</span><span class="sxs-lookup"><span data-stu-id="289ad-123">When the application is acting as a client, the following values passed to [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) are relevant: an authentication level, an impersonation level, the authentication identity, and capabilities.</span></span> <span data-ttu-id="289ad-124">La llamada implícita o explícita de un cliente a **CoInitializeSecurity** indica el marco de seguridad que el cliente desea.</span><span class="sxs-lookup"><span data-stu-id="289ad-124">A client's implicit or explicit call to **CoInitializeSecurity** indicates the security blanket that the client wants.</span></span>

<span data-ttu-id="289ad-125">Cuando se crea un proxy, COM usa los valores especificados por la capa de seguridad del servidor y la capa de seguridad del cliente para negociar una manta de seguridad predeterminada que sea adecuada para el proxy.</span><span class="sxs-lookup"><span data-stu-id="289ad-125">When a proxy is created, COM uses the values specified by the server's security blanket and the client's security blanket to negotiate a default security blanket that is appropriate for the proxy.</span></span> <span data-ttu-id="289ad-126">COM elige un servicio de autenticación que funciona tanto en el cliente como en el servidor.</span><span class="sxs-lookup"><span data-stu-id="289ad-126">COM picks an authentication service that works on both the client and server.</span></span> <span data-ttu-id="289ad-127">El servicio de autorización y el nombre de la entidad de seguridad se eligen para trabajar con el servicio de autenticación.</span><span class="sxs-lookup"><span data-stu-id="289ad-127">The authorization service and principal name are chosen to work with the authentication service.</span></span> <span data-ttu-id="289ad-128">Para el nivel de autenticación, COM elige el mayor de los niveles de autenticación especificados por el cliente y el servidor.</span><span class="sxs-lookup"><span data-stu-id="289ad-128">For the authentication level, COM chooses the higher of the authentication levels specified by the client and the server.</span></span> <span data-ttu-id="289ad-129">El nivel de suplantación y las capacidades elegidas por COM son las especificadas por el cliente.</span><span class="sxs-lookup"><span data-stu-id="289ad-129">The impersonation level and the capabilities chosen by COM are the ones specified by the client.</span></span> <span data-ttu-id="289ad-130">La identidad de autenticación es la especificada por el cliente para el servicio de autenticación elegido.</span><span class="sxs-lookup"><span data-stu-id="289ad-130">The authentication identity is the one specified by the client for the chosen authentication service.</span></span>

<span data-ttu-id="289ad-131">Una vez que se ha calculado la capa de seguridad predeterminada, sus valores se asignan al proxy recién creado.</span><span class="sxs-lookup"><span data-stu-id="289ad-131">Once the default security blanket has been computed, its values are assigned to the newly created proxy.</span></span> <span data-ttu-id="289ad-132">El cliente puede invalidar la configuración de seguridad para el proxy mediante una llamada a [**IClientSecurity:: SetBlanket**](/windows/win32/api/objidl/nf-objidl-iclientsecurity-setblanket).</span><span class="sxs-lookup"><span data-stu-id="289ad-132">The client can override the security settings for the proxy by calling [**IClientSecurity::SetBlanket**](/windows/win32/api/objidl/nf-objidl-iclientsecurity-setblanket).</span></span> <span data-ttu-id="289ad-133">Los valores especificados en **SetBlanket** no se negocian; simplemente se asignan al proxy especificado.</span><span class="sxs-lookup"><span data-stu-id="289ad-133">The values specified to **SetBlanket** are not negotiated; they are simply assigned to the specified proxy.</span></span> <span data-ttu-id="289ad-134">Sin embargo, si los parámetros predeterminados (como \_ valor predeterminado de nivel de Imp de RPC C \_ \_ \_ ) se pasan a **SetBlanket**, com usa el algoritmo de negociación de la capa de seguridad que se ha descrito anteriormente para calcular los parámetros predeterminados.</span><span class="sxs-lookup"><span data-stu-id="289ad-134">However, if default parameters (such as RPC\_C\_IMP\_LEVEL\_DEFAULT) are passed to **SetBlanket**, COM uses the previously described security blanket negotiation algorithm to compute the default parameters.</span></span>

## <a name="related-topics"></a><span data-ttu-id="289ad-135">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="289ad-135">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="289ad-136">Seguridad en COM</span><span class="sxs-lookup"><span data-stu-id="289ad-136">Security in COM</span></span>](security-in-com.md)
</dt> </dl>

 

 