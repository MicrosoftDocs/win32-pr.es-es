---
title: Implementación de una vista de carpetas
description: Windows Shell proporciona una implementación predeterminada de la vista de carpetas, suele conocida como DefView, para que pueda evitar gran parte del trabajo de implementar su propia extensión de espacio de nombres.
ms.assetid: 8c6712d8-c3cb-4450-8277-3a8675622651
keywords:
- objeto de vista de carpeta
- IShellView
- IShellBrowser, objetos de vista de carpeta
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 48c7b86d587154a034f276d4bdab903e5337ed4b
ms.sourcegitcommit: 469b6de41e2a565b7ead231d7f282ec4071ac158
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/11/2020
ms.locfileid: "104421558"
---
# <a name="implementing-a-folder-view"></a><span data-ttu-id="465f0-106">Implementación de una vista de carpetas</span><span class="sxs-lookup"><span data-stu-id="465f0-106">Implementing a Folder View</span></span>

<span data-ttu-id="465f0-107">Windows Shell proporciona una implementación predeterminada de la vista de carpetas, suele conocida como DefView, para que pueda evitar gran parte del trabajo de implementar su propia extensión de espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="465f0-107">Windows Shell provides a default implementation of the folder view, colloquially known as DefView, so that you can avoid much of the work of implementing your own namespace extension.</span></span> <span data-ttu-id="465f0-108">Dado que algunas características de vista no se pueden lograr mediante vistas personalizadas, a menudo se recomienda usar el objeto de vista de carpeta del sistema predeterminado en lugar de una vista personalizada.</span><span class="sxs-lookup"><span data-stu-id="465f0-108">Because some view features cannot be achieved through custom views, it is often recommended that the default system folder view object is used in place of a custom view.</span></span> <span data-ttu-id="465f0-109">Para obtener más información, vea [**SHCreateShellFolderView**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview).</span><span class="sxs-lookup"><span data-stu-id="465f0-109">For more information, see [**SHCreateShellFolderView**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview).</span></span> <span data-ttu-id="465f0-110">En el resto de este tema se describe la implementación de una vista de carpeta personalizada que no admite las características de vista más recientes.</span><span class="sxs-lookup"><span data-stu-id="465f0-110">The remainder of this topic discusses implementing a custom folder view that cannot support newer view features.</span></span>

<span data-ttu-id="465f0-111">A diferencia de la vista de árbol, el explorador de Windows no administra el contenido de una vista de carpeta.</span><span class="sxs-lookup"><span data-stu-id="465f0-111">Unlike the tree view, Windows Explorer does not manage the contents of a folder view.</span></span> <span data-ttu-id="465f0-112">En su lugar, la ventana vista de carpetas hospeda una ventana secundaria proporcionada por el objeto de carpeta.</span><span class="sxs-lookup"><span data-stu-id="465f0-112">Instead, the folder view window hosts a child window that is provided by the folder object.</span></span> <span data-ttu-id="465f0-113">El objeto de carpeta es responsable de crear un objeto de vista de carpeta para mostrar el contenido de la carpeta en la ventana secundaria.</span><span class="sxs-lookup"><span data-stu-id="465f0-113">The folder object is responsible for creating a folder view object to display the folder's contents in the child window.</span></span>

<span data-ttu-id="465f0-114">La clave para implementar un objeto de vista de carpeta es la interfaz [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) .</span><span class="sxs-lookup"><span data-stu-id="465f0-114">The key to implementing a folder view object is the [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) interface.</span></span> <span data-ttu-id="465f0-115">El explorador de Windows usa esta interfaz para comunicarse con el objeto de vista de carpeta.</span><span class="sxs-lookup"><span data-stu-id="465f0-115">This interface is used by Windows Explorer to communicate with the folder view object.</span></span> <span data-ttu-id="465f0-116">Antes de mostrar una vista de carpeta, el explorador de Windows llama al método [**IShellFolder:: CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) del objeto de carpeta con *RIID* establecido en IID \_ IShellView.</span><span class="sxs-lookup"><span data-stu-id="465f0-116">Before displaying a folder view, Windows Explorer calls the folder object's [**IShellFolder::CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) method with *riid* set to IID\_IShellView.</span></span> <span data-ttu-id="465f0-117">Cree un objeto de vista de carpeta y devuelva su interfaz **IShellView** .</span><span class="sxs-lookup"><span data-stu-id="465f0-117">Create a folder view object and return its **IShellView** interface.</span></span> <span data-ttu-id="465f0-118">A continuación, el objeto de vista de carpeta debe crear una ventana secundaria de la ventana de vista de carpetas y usar la ventana secundaria para mostrar información sobre el contenido de la carpeta.</span><span class="sxs-lookup"><span data-stu-id="465f0-118">The folder view object must then create a child window of the folder view window and use the child window to display information about the folder's contents.</span></span>

<span data-ttu-id="465f0-119">Además de controlar el modo en que se muestran los datos, las extensiones también pueden personalizar varias características del explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="465f0-119">In addition to controlling how data is displayed, extensions can also customize a number of the features of Windows Explorer.</span></span> <span data-ttu-id="465f0-120">Por ejemplo, una extensión puede agregar elementos a la barra de herramientas o a la barra de menús, o Mostrar información en la barra de estado.</span><span class="sxs-lookup"><span data-stu-id="465f0-120">For instance, an extension can add items to the toolbar or menu bar, or display information on the status bar.</span></span>

-   [<span data-ttu-id="465f0-121">Objeto de vista de carpeta</span><span class="sxs-lookup"><span data-stu-id="465f0-121">The Folder View Object</span></span>](#the-folder-view-object)
-   [<span data-ttu-id="465f0-122">Inicializar el objeto de vista de carpeta</span><span class="sxs-lookup"><span data-stu-id="465f0-122">Initializing the Folder View Object</span></span>](#initializing-the-folder-view-object)
-   [<span data-ttu-id="465f0-123">Mostrar la vista de carpetas</span><span class="sxs-lookup"><span data-stu-id="465f0-123">Displaying the Folder View</span></span>](#displaying-the-folder-view)
-   [<span data-ttu-id="465f0-124">Implementación de IShellView</span><span class="sxs-lookup"><span data-stu-id="465f0-124">Implementing IShellView</span></span>](#implementing-ishellview)
    -   [<span data-ttu-id="465f0-125">AddPropertySheetPages</span><span class="sxs-lookup"><span data-stu-id="465f0-125">AddPropertySheetPages</span></span>](#addpropertysheetpages)
    -   [<span data-ttu-id="465f0-126">GetCurrentInfo</span><span class="sxs-lookup"><span data-stu-id="465f0-126">GetCurrentInfo</span></span>](#getcurrentinfo)
    -   [<span data-ttu-id="465f0-127">Actualizar</span><span class="sxs-lookup"><span data-stu-id="465f0-127">Refresh</span></span>](#refresh)
    -   [<span data-ttu-id="465f0-128">SaveViewState</span><span class="sxs-lookup"><span data-stu-id="465f0-128">SaveViewState</span></span>](#saveviewstate)
    -   [<span data-ttu-id="465f0-129">TranslateAcelerator</span><span class="sxs-lookup"><span data-stu-id="465f0-129">TranslateAcelerator</span></span>](#translateacelerator)
-   [<span data-ttu-id="465f0-130">Uso de IShellBrowser para comunicarse con el explorador de Windows</span><span class="sxs-lookup"><span data-stu-id="465f0-130">Using IShellBrowser to Communicate with Windows Explorer</span></span>](#using-ishellbrowser-to-communicate-with-windows-explorer)
    -   [<span data-ttu-id="465f0-131">Modificar la barra de menús del explorador de Windows</span><span class="sxs-lookup"><span data-stu-id="465f0-131">Modifying the Windows Explorer Menu Bar</span></span>](#modifying-the-windows-explorer-menu-bar)
    -   [<span data-ttu-id="465f0-132">Modificar la barra de herramientas del explorador de Windows</span><span class="sxs-lookup"><span data-stu-id="465f0-132">Modifying the Windows Explorer Toolbar</span></span>](#modifying-the-windows-explorer-toolbar)
    -   [<span data-ttu-id="465f0-133">Modificar la barra de estado del explorador de Windows</span><span class="sxs-lookup"><span data-stu-id="465f0-133">Modifying the Windows Explorer Status Bar</span></span>](#modifying-the-windows-explorer-status-bar)
    -   [<span data-ttu-id="465f0-134">Almacenar información específica de la vista</span><span class="sxs-lookup"><span data-stu-id="465f0-134">Storing View-specific Information</span></span>](#storing-view-specific-information)

## <a name="the-folder-view-object"></a><span data-ttu-id="465f0-135">Objeto de vista de carpeta</span><span class="sxs-lookup"><span data-stu-id="465f0-135">The Folder View Object</span></span>

<span data-ttu-id="465f0-136">Un objeto de vista de carpeta es un objeto de modelo de objetos componentes (COM) que expone una interfaz [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) .</span><span class="sxs-lookup"><span data-stu-id="465f0-136">A folder view object is a Component Object Model (COM) object that exposes an [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) interface.</span></span> <span data-ttu-id="465f0-137">Este objeto es responsable de:</span><span class="sxs-lookup"><span data-stu-id="465f0-137">This object is responsible for:</span></span>

-   <span data-ttu-id="465f0-138">Crear una ventana secundaria de la ventana vista de carpetas y utilizarla para mostrar el contenido de la carpeta.</span><span class="sxs-lookup"><span data-stu-id="465f0-138">Creating a child window of the folder view window and using it to display the contents of the folder.</span></span>
-   <span data-ttu-id="465f0-139">Controlar la comunicación con el explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="465f0-139">Handling communication with Windows Explorer.</span></span>
-   <span data-ttu-id="465f0-140">Agregar comandos específicos de la carpeta a la barra de menús y la barra de herramientas del explorador de Windows y controlar esos comandos cuando se seleccionan.</span><span class="sxs-lookup"><span data-stu-id="465f0-140">Adding folder-specific commands to the Windows Explorer menu bar and toolbar and handling those commands when they are selected.</span></span>
-   <span data-ttu-id="465f0-141">Administrar la interacción del usuario con la ventana vista de carpetas, como mostrar menús contextuales o controlar las operaciones de arrastrar y colocar.</span><span class="sxs-lookup"><span data-stu-id="465f0-141">Managing user interaction with the folder view window, such as displaying shortcut menus or handling drag-and-drop operations.</span></span>

<span data-ttu-id="465f0-142">En este documento se describen los tres primeros temas.</span><span class="sxs-lookup"><span data-stu-id="465f0-142">This document discusses the first three topics.</span></span> <span data-ttu-id="465f0-143">Dado que la interacción del usuario con la vista de carpetas tiene lugar dentro de la ventana secundaria, el objeto de vista de carpeta es responsable de controlarlo como lo haría con cualquier otra ventana.</span><span class="sxs-lookup"><span data-stu-id="465f0-143">Because user interaction with the folder view takes place within your child window, your folder view object is responsible for handling it as it would for any other window.</span></span>

<span data-ttu-id="465f0-144">El explorador de Windows solicita un objeto de vista de carpeta mediante una llamada a la [**IShellFolder:: CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) del objeto de carpeta con el valor de *RIID* establecido en IID \_ IShellView.</span><span class="sxs-lookup"><span data-stu-id="465f0-144">Windows Explorer requests a folder view object by calling your folder object's [**IShellFolder::CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) with *riid* set to IID\_IShellView.</span></span> <span data-ttu-id="465f0-145">El procedimiento para crear una vista de carpeta es:</span><span class="sxs-lookup"><span data-stu-id="465f0-145">The procedure for creating a folder view is:</span></span>

1.  <span data-ttu-id="465f0-146">El objeto de carpeta crea una nueva instancia del objeto de vista de carpeta y devuelve un puntero a su interfaz [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) .</span><span class="sxs-lookup"><span data-stu-id="465f0-146">Your folder object creates a new instance of your folder view object and returns a pointer to its [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) interface.</span></span>
2.  <span data-ttu-id="465f0-147">El explorador de Windows inicializa el objeto de vista de carpeta mediante una llamada al método [**IShellView:: CreateViewWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-createviewwindow) .</span><span class="sxs-lookup"><span data-stu-id="465f0-147">Windows Explorer initializes the folder view object by calling the [**IShellView::CreateViewWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-createviewwindow) method.</span></span> <span data-ttu-id="465f0-148">Cree una ventana secundaria de la ventana vista de carpetas y devuelva su identificador al explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="465f0-148">Create a child window of the folder view window and return its handle to Windows Explorer.</span></span>
3.  <span data-ttu-id="465f0-149">El objeto vista de carpeta usa la interfaz [**IShellBrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) del explorador de Windows para personalizar la barra de herramientas del explorador de Windows, la barra de menús y la barra de estado.</span><span class="sxs-lookup"><span data-stu-id="465f0-149">The folder view object uses the Windows Explorer [**IShellBrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) interface to customize the Windows Explorer toolbar, menu bar, and status bar.</span></span>
4.  <span data-ttu-id="465f0-150">El objeto de vista de carpeta muestra el contenido de la carpeta en la ventana secundaria.</span><span class="sxs-lookup"><span data-stu-id="465f0-150">The folder view object displays the contents of the folder in the child window.</span></span>
5.  <span data-ttu-id="465f0-151">El objeto de vista de carpeta controla la interacción del usuario con la vista de carpetas y cualquier barra de herramientas o elemento de barra de menús específico de la carpeta.</span><span class="sxs-lookup"><span data-stu-id="465f0-151">The folder view object handles user interaction with the folder view and any folder-specific toolbar or menu bar items.</span></span>

## <a name="initializing-the-folder-view-object"></a><span data-ttu-id="465f0-152">Inicializar el objeto de vista de carpeta</span><span class="sxs-lookup"><span data-stu-id="465f0-152">Initializing the Folder View Object</span></span>

<span data-ttu-id="465f0-153">El explorador de Windows inicializa el objeto de vista de carpeta mediante una llamada al método [**IShellView:: CreateViewWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-createviewwindow) .</span><span class="sxs-lookup"><span data-stu-id="465f0-153">Windows Explorer initializes the folder view object by calling the [**IShellView::CreateViewWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-createviewwindow) method.</span></span> <span data-ttu-id="465f0-154">Los parámetros del método proporcionan el objeto de vista de carpeta con la información que necesita para crear la ventana secundaria que se usará para mostrar el contenido de la carpeta:</span><span class="sxs-lookup"><span data-stu-id="465f0-154">The method's parameters provide the folder view object with the information it needs to create the child window that will be used to display the folder's contents:</span></span>

-   <span data-ttu-id="465f0-155">Puntero a la interfaz [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) del objeto de vista de carpeta anterior.</span><span class="sxs-lookup"><span data-stu-id="465f0-155">A pointer to the previous folder view object's [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) interface.</span></span> <span data-ttu-id="465f0-156">Este parámetro se puede establecer en **null**.</span><span class="sxs-lookup"><span data-stu-id="465f0-156">This parameter can be set to **NULL**.</span></span>
-   <span data-ttu-id="465f0-157">Estructura [**FOLDERSETTINGS**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) que contiene la configuración de la vista de carpeta anterior.</span><span class="sxs-lookup"><span data-stu-id="465f0-157">A [**FOLDERSETTINGS**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) structure that contains the previous folder view's settings.</span></span>
-   <span data-ttu-id="465f0-158">Puntero a la interfaz [**IShellBrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) del explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="465f0-158">A pointer to the Windows Explorer [**IShellBrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) interface.</span></span>
-   <span data-ttu-id="465f0-159">Estructura [Rect](/previous-versions//ms536136(v=vs.85)) con las dimensiones de la ventana de vista de carpetas.</span><span class="sxs-lookup"><span data-stu-id="465f0-159">A [RECT](/previous-versions//ms536136(v=vs.85)) structure with the dimensions of the folder view window.</span></span>

<span data-ttu-id="465f0-160">Se llama al método [**IShellView:: CreateViewWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-createviewwindow) antes de que se destruya el objeto anterior de la vista de carpeta.</span><span class="sxs-lookup"><span data-stu-id="465f0-160">The [**IShellView::CreateViewWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-createviewwindow) method is called before the previous folder view object is destroyed.</span></span> <span data-ttu-id="465f0-161">Así, el puntero de la interfaz [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) permite comunicarse con el objeto anterior de la vista de carpetas.</span><span class="sxs-lookup"><span data-stu-id="465f0-161">The [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) interface pointer thus allows you to communicate with the previous folder view object.</span></span> <span data-ttu-id="465f0-162">Esta interfaz es principalmente útil si la carpeta anterior pertenecía a la extensión y utilizó el mismo esquema de presentación.</span><span class="sxs-lookup"><span data-stu-id="465f0-162">This interface is primarily useful if the previous folder belonged to your extension and used the same display scheme.</span></span> <span data-ttu-id="465f0-163">Si es así, puede comunicarse con el objeto de vista de carpeta anterior para tales propósitos como intercambiar la configuración privada.</span><span class="sxs-lookup"><span data-stu-id="465f0-163">If so, you can communicate with the previous folder view object for such purposes as exchanging private settings.</span></span>

<span data-ttu-id="465f0-164">Una manera sencilla de determinar si el puntero [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) pertenece a la extensión es que todos los objetos de vista de carpeta expongan una interfaz privada.</span><span class="sxs-lookup"><span data-stu-id="465f0-164">A simple way to determine whether the [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) pointer belongs to your extension is to have all your folder view objects expose a private interface.</span></span> <span data-ttu-id="465f0-165">Llame a [IShellView:: QueryInterface](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) para solicitar la interfaz privada y examine el valor devuelto para determinar si el objeto de vista de carpeta es uno de los suyos.</span><span class="sxs-lookup"><span data-stu-id="465f0-165">Call [IShellView::QueryInterface](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) to request the private interface, and examine the return value to determine whether the folder view object is one of yours.</span></span> <span data-ttu-id="465f0-166">Después, puede usar un método privado en esa interfaz para intercambiar información.</span><span class="sxs-lookup"><span data-stu-id="465f0-166">You can then use a private method on that interface to exchange information.</span></span>

<span data-ttu-id="465f0-167">La estructura [**FOLDERSETTINGS**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) contiene la configuración de pantalla de la vista de carpeta anterior.</span><span class="sxs-lookup"><span data-stu-id="465f0-167">The [**FOLDERSETTINGS**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) structure contains the previous folder view's display settings.</span></span> <span data-ttu-id="465f0-168">La configuración principal es el modo de visualización: icono grande, icono pequeño, lista o detalles.</span><span class="sxs-lookup"><span data-stu-id="465f0-168">The primary setting is the viewing mode: large icon, small icon, list, or details.</span></span> <span data-ttu-id="465f0-169">También hay una marca que contiene los valores de una variedad de opciones de presentación, por ejemplo, si la vista debe alinearse a la izquierda.</span><span class="sxs-lookup"><span data-stu-id="465f0-169">There is also a flag that contains the settings of a variety of display options, such as whether the view should be left-aligned.</span></span> <span data-ttu-id="465f0-170">La visualización de la carpeta debe seguir estos valores en la medida de lo posible, para ofrecer a los usuarios una experiencia coherente a medida que pasan de una carpeta a otra.</span><span class="sxs-lookup"><span data-stu-id="465f0-170">Your folder display should follow these settings to the extent possible, to give users a consistent experience as they go from one folder to another.</span></span> <span data-ttu-id="465f0-171">Debe almacenar esta estructura y actualizarla con el cambio de configuración.</span><span class="sxs-lookup"><span data-stu-id="465f0-171">You should store this structure and update it as the settings change.</span></span> <span data-ttu-id="465f0-172">El explorador de Windows llama a [**IShellView:: GetCurrentInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-getcurrentinfo) para obtener el valor más reciente de esta estructura antes de abrir la siguiente vista de carpeta.</span><span class="sxs-lookup"><span data-stu-id="465f0-172">Windows Explorer calls [**IShellView::GetCurrentInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-getcurrentinfo) to obtain the most recent value of this structure before it opens the next folder view.</span></span>

<span data-ttu-id="465f0-173">La interfaz [**IShellBrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) se expone mediante el explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="465f0-173">The [**IShellBrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) interface is exposed by Windows Explorer.</span></span> <span data-ttu-id="465f0-174">Esta interfaz es un complemento de [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) y permite que un objeto de vista de carpeta se comunique con el explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="465f0-174">This interface is a companion to [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) and allows a folder view object to communicate with Windows Explorer.</span></span> <span data-ttu-id="465f0-175">No hay ninguna otra manera de recuperar este puntero de interfaz, por lo que el objeto de vista de carpeta debe almacenarlo para su uso posterior.</span><span class="sxs-lookup"><span data-stu-id="465f0-175">There is no other way to retrieve this interface pointer, so your folder view object should store it for later use.</span></span> <span data-ttu-id="465f0-176">En concreto, debe llamar a [IShellBrowser:: GetWindow](/windows/win32/api/oleidl/nf-oleidl-iolewindow-getwindow) para recuperar la ventana de la vista de carpeta primaria que usará para crear la ventana secundaria.</span><span class="sxs-lookup"><span data-stu-id="465f0-176">In particular, you will need to call [IShellBrowser::GetWindow](/windows/win32/api/oleidl/nf-oleidl-iolewindow-getwindow) to retrieve the parent folder view window that you will use to create your child window.</span></span> <span data-ttu-id="465f0-177">Tenga en cuenta que el método IShellBrowser:: GetWindow no se incluye en la documentación de **IShellBrowser** porque se hereda de [IOleWindow](/windows/win32/api/oleidl/nn-oleidl-iolewindow).</span><span class="sxs-lookup"><span data-stu-id="465f0-177">Note that the IShellBrowser::GetWindow method is not included in the **IShellBrowser** documentation because it is inherited from [IOleWindow](/windows/win32/api/oleidl/nn-oleidl-iolewindow).</span></span> <span data-ttu-id="465f0-178">Después de almacenar el puntero de interfaz, recuerde llamar a [IShellBrowser:: AddRef](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) para incrementar el recuento de referencias de la interfaz.</span><span class="sxs-lookup"><span data-stu-id="465f0-178">After storing the interface pointer, remember to call [IShellBrowser::AddRef](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) to increment the interface's reference count.</span></span> <span data-ttu-id="465f0-179">Cuando ya no necesite la interfaz, llame a [IShellBrowser:: Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release).</span><span class="sxs-lookup"><span data-stu-id="465f0-179">When you no longer need the interface, call [IShellBrowser::Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release).</span></span>

<span data-ttu-id="465f0-180">Para crear la ventana secundaria:</span><span class="sxs-lookup"><span data-stu-id="465f0-180">To create your child window:</span></span>

1.  <span data-ttu-id="465f0-181">Examine las estructuras [**FOLDERSETTINGS**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) y [Rect](/previous-versions//ms536136(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="465f0-181">Examine the [**FOLDERSETTINGS**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) and [RECT](/previous-versions//ms536136(v=vs.85)) structures.</span></span>
2.  <span data-ttu-id="465f0-182">Si es necesario, obtenga la configuración privada del objeto de vista de carpeta anterior.</span><span class="sxs-lookup"><span data-stu-id="465f0-182">If needed, obtain private settings from the previous folder view object.</span></span>
3.  <span data-ttu-id="465f0-183">Llame a [IShellBrowser:: GetWindow](/windows/win32/api/oleidl/nf-oleidl-iolewindow-getwindow) para recuperar la ventana de la vista de carpeta primaria.</span><span class="sxs-lookup"><span data-stu-id="465f0-183">Call [IShellBrowser::GetWindow](/windows/win32/api/oleidl/nf-oleidl-iolewindow-getwindow) to retrieve the parent folder view window.</span></span>
4.  <span data-ttu-id="465f0-184">Cree un elemento secundario de la ventana vista de carpetas obtenida en el paso anterior y vuelva al explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="465f0-184">Create a child of the folder view window obtained in the previous step and return it to Windows Explorer.</span></span>

## <a name="displaying-the-folder-view"></a><span data-ttu-id="465f0-185">Mostrar la vista de carpetas</span><span class="sxs-lookup"><span data-stu-id="465f0-185">Displaying the Folder View</span></span>

<span data-ttu-id="465f0-186">Después de crear la ventana secundaria y devolverla al explorador de Windows, puede mostrar el contenido de la carpeta.</span><span class="sxs-lookup"><span data-stu-id="465f0-186">Once you have created the child window and returned it to Windows Explorer, you can display the folder's contents.</span></span> <span data-ttu-id="465f0-187">Normalmente, las extensiones muestran su información haciendo que la ventana secundaria hospede un [control de vista de lista](../controls/list-view-control-reference.md) o un **control WebBrowser**.</span><span class="sxs-lookup"><span data-stu-id="465f0-187">Typically, extensions display their information by having the child window host either a [list view control](../controls/list-view-control-reference.md) or a **WebBrowser control**.</span></span> <span data-ttu-id="465f0-188">El control de vista de lista le permite replicar la [vista clásica](web-view.md)del explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="465f0-188">The list view control allows you to replicate the Windows Explorer [classic view](web-view.md).</span></span> <span data-ttu-id="465f0-189">El control WebBrowser permite usar un documento HTML dinámico (DHTML) para mostrar la información, de forma similar a la vista Web del explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="465f0-189">The WebBrowser control allows you to use a Dynamic HTML (DHTML) document to display your information, much like the Windows Explorer Web view.</span></span> <span data-ttu-id="465f0-190">Para obtener más información, consulte la documentación de esos controles.</span><span class="sxs-lookup"><span data-stu-id="465f0-190">For further information, refer to the documentation of those controls.</span></span>

<span data-ttu-id="465f0-191">La ventana vista de carpetas siempre existe, incluso si no tiene el foco.</span><span class="sxs-lookup"><span data-stu-id="465f0-191">The folder view window always exists, even if it does not have focus.</span></span> <span data-ttu-id="465f0-192">Por lo tanto, debe mantener tres Estados para la ventana secundaria:</span><span class="sxs-lookup"><span data-stu-id="465f0-192">You should therefore maintain three states for your child window:</span></span>

-   <span data-ttu-id="465f0-193">Activado con el foco.</span><span class="sxs-lookup"><span data-stu-id="465f0-193">Activated with focus.</span></span> <span data-ttu-id="465f0-194">La vista de carpetas se ha creado y tiene el foco.</span><span class="sxs-lookup"><span data-stu-id="465f0-194">The folder view has been created and has focus.</span></span> <span data-ttu-id="465f0-195">Establezca los elementos de la barra de menús o de la barra de herramientas adecuados para un estado enfocado.</span><span class="sxs-lookup"><span data-stu-id="465f0-195">Set the menu bar or toolbar items that are appropriate for a focused state.</span></span>
-   <span data-ttu-id="465f0-196">Activado sin foco.</span><span class="sxs-lookup"><span data-stu-id="465f0-196">Activated without focus.</span></span> <span data-ttu-id="465f0-197">La vista de carpetas se ha creado y está activa, pero no tiene el foco.</span><span class="sxs-lookup"><span data-stu-id="465f0-197">The folder view has been created and is active, but it does not have focus.</span></span> <span data-ttu-id="465f0-198">Establezca los elementos de la barra de menús o de la barra de herramientas adecuados para un estado sin foco.</span><span class="sxs-lookup"><span data-stu-id="465f0-198">Set the menu bar or toolbar items that are appropriate for a nonfocused state.</span></span> <span data-ttu-id="465f0-199">Omitir los elementos que se aplican a la selección de elementos en la vista de carpeta.</span><span class="sxs-lookup"><span data-stu-id="465f0-199">Omit any items that apply to the selection of items within the folder view.</span></span>
-   <span data-ttu-id="465f0-200">Desactivado.</span><span class="sxs-lookup"><span data-stu-id="465f0-200">Deactivated.</span></span> <span data-ttu-id="465f0-201">La vista de carpetas está a punto de ser destruida.</span><span class="sxs-lookup"><span data-stu-id="465f0-201">The folder view is about to be destroyed.</span></span> <span data-ttu-id="465f0-202">Quitar todos los elementos de menú específicos de la carpeta.</span><span class="sxs-lookup"><span data-stu-id="465f0-202">Remove all folder-specific menu items.</span></span>

<span data-ttu-id="465f0-203">El explorador de Windows notifica al objeto de vista de carpetas cuándo cambia el estado de la ventana mediante una llamada a [**IShellView:: UIActivate**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate).</span><span class="sxs-lookup"><span data-stu-id="465f0-203">Windows Explorer notifies your folder view object when the window state changes by calling [**IShellView::UIActivate**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate).</span></span> <span data-ttu-id="465f0-204">A su vez, el objeto de vista de carpeta debe notificar al explorador de Windows cuando un usuario activa la ventana de vista de carpetas mediante una llamada a [**IShellBrowser:: OnViewWindowActive**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-onviewwindowactive).</span><span class="sxs-lookup"><span data-stu-id="465f0-204">In turn, the folder view object should notify Windows Explorer when a user activates the folder view window by calling [**IShellBrowser::OnViewWindowActive**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-onviewwindowactive).</span></span> <span data-ttu-id="465f0-205">Para obtener más información sobre esta interfaz, consulte [uso de IShellBrowser para comunicarse con el explorador de Windows](#using-ishellbrowser-to-communicate-with-windows-explorer).</span><span class="sxs-lookup"><span data-stu-id="465f0-205">For further discussion of this interface, see [Using IShellBrowser to Communicate with Windows Explorer](#using-ishellbrowser-to-communicate-with-windows-explorer).</span></span>

<span data-ttu-id="465f0-206">Mientras la vista de la carpeta está activa, debe procesar los mensajes de Windows, como [el \_ tamaño de WM](../winmsg/wm-size.md), que pertenecen a la ventana secundaria.</span><span class="sxs-lookup"><span data-stu-id="465f0-206">While the folder view is active, you need to process any Windows messages, such as [WM\_SIZE](../winmsg/wm-size.md), that belong to your child window.</span></span> <span data-ttu-id="465f0-207">El procedimiento de ventana también recibirá mensajes de [ \_ comandos de WM](../menurc/wm-command.md) para cualquier elemento que se haya agregado a la barra de menús o la barra de herramientas del explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="465f0-207">Your window procedure will also receive [WM\_COMMAND](../menurc/wm-command.md) messages for any items you have added to the Windows Explorer menu bar or toolbar.</span></span>

<span data-ttu-id="465f0-208">Después de crear la vista de carpetas, el explorador de Windows llama a la interfaz [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) del objeto de vista de carpeta para pasarle una gran variedad de información.</span><span class="sxs-lookup"><span data-stu-id="465f0-208">After creating the folder view, Windows Explorer calls the folder view object's [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) interface to pass it a variety of information.</span></span> <span data-ttu-id="465f0-209">El objeto debe modificar su presentación en consecuencia.</span><span class="sxs-lookup"><span data-stu-id="465f0-209">Your object must modify its display accordingly.</span></span> <span data-ttu-id="465f0-210">Cuando la vista de carpetas está a punto de ser destruida, el explorador de Windows notifica el objeto de vista de carpeta mediante una llamada a su método [**IShellView::D estroyviewwindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-destroyviewwindow) .</span><span class="sxs-lookup"><span data-stu-id="465f0-210">When the folder view is about to be destroyed, Windows Explorer notifies the folder view object by calling its [**IShellView::DestroyViewWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-destroyviewwindow) method.</span></span>

## <a name="implementing-ishellview"></a><span data-ttu-id="465f0-211">Implementación de IShellView</span><span class="sxs-lookup"><span data-stu-id="465f0-211">Implementing IShellView</span></span>

<span data-ttu-id="465f0-212">Una vez creado el objeto de carpeta, el explorador de Windows llama a varios métodos [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) para solicitar información o notificar a un objeto de un cambio en el estado del explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="465f0-212">After the folder object has been created, Windows Explorer calls various [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) methods to either request information or notify the object of a change in the state of Windows Explorer.</span></span> <span data-ttu-id="465f0-213">En esta sección se describe cómo implementar esos métodos **IShellView** .</span><span class="sxs-lookup"><span data-stu-id="465f0-213">This section outlines how to implement those **IShellView** methods.</span></span> <span data-ttu-id="465f0-214">Los métodos restantes se usan para fines más especializados, como el cuadro de diálogo Abrir archivo común.</span><span class="sxs-lookup"><span data-stu-id="465f0-214">The remaining methods are used for more specialized purposes, such as the File Open common dialog box.</span></span> <span data-ttu-id="465f0-215">Para obtener más información, consulte la documentación de **IShellView** .</span><span class="sxs-lookup"><span data-stu-id="465f0-215">For details, see the **IShellView** documentation.</span></span>

### <a name="addpropertysheetpages"></a><span data-ttu-id="465f0-216">AddPropertySheetPages</span><span class="sxs-lookup"><span data-stu-id="465f0-216">AddPropertySheetPages</span></span>

<span data-ttu-id="465f0-217">Cuando un usuario selecciona **Opciones de carpeta** en el menú **herramientas** del explorador de Windows, se muestra una hoja de propiedades que permite al usuario modificar las opciones de carpeta.</span><span class="sxs-lookup"><span data-stu-id="465f0-217">When a user selects **Folder Options** from the Windows Explorer **Tools** menu, a property sheet is displayed that allows the user to modify the folder options.</span></span> <span data-ttu-id="465f0-218">El explorador de Windows llama al método [**IShellView:: AddPropertySheetPages**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-addpropertysheetpages) del objeto de vista de carpeta para que pueda agregar una página a esta hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="465f0-218">Windows Explorer calls your folder view object's [**IShellView::AddPropertySheetPages**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-addpropertysheetpages) method to allow you to add a page to this property sheet.</span></span>

<span data-ttu-id="465f0-219">El explorador de Windows pasa un puntero a una función de devolución de llamada [AddPropSheetPageProc](/windows/win32/api/prsht/nc-prsht-lpfnaddpropsheetpage) en el parámetro *lpfn* de [**IShellView:: AddPropertySheetPages**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-addpropertysheetpages).</span><span class="sxs-lookup"><span data-stu-id="465f0-219">Windows Explorer passes a pointer to an [AddPropSheetPageProc](/windows/win32/api/prsht/nc-prsht-lpfnaddpropsheetpage) callback function in the *lpfn* parameter of [**IShellView::AddPropertySheetPages**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-addpropertysheetpages).</span></span> <span data-ttu-id="465f0-220">Llame a [CreatePropertySheetPage](/windows/win32/api/prsht/nf-prsht-createpropertysheetpagea) para crear la página y, a continuación, llame a AddPropSheetPageProc para agregarla a la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="465f0-220">Call [CreatePropertySheetPage](/windows/win32/api/prsht/nf-prsht-createpropertysheetpagea) to create the page, and then call the AddPropSheetPageProc to add it to the property sheet.</span></span> <span data-ttu-id="465f0-221">Para obtener más información sobre cómo controlar las hojas de propiedades, vea [hojas de propiedades](../controls/property-sheets.md).</span><span class="sxs-lookup"><span data-stu-id="465f0-221">For further discussion of how to handle property sheets, see [Property Sheets](../controls/property-sheets.md).</span></span>

### <a name="getcurrentinfo"></a><span data-ttu-id="465f0-222">GetCurrentInfo</span><span class="sxs-lookup"><span data-stu-id="465f0-222">GetCurrentInfo</span></span>

<span data-ttu-id="465f0-223">Cuando el usuario cambia de una carpeta a otra, el explorador de Windows intenta mantener una vista de carpeta similar.</span><span class="sxs-lookup"><span data-stu-id="465f0-223">When the user switches from one folder to another, Windows Explorer attempts to maintain a similar folder view.</span></span> <span data-ttu-id="465f0-224">Por ejemplo, si la vista de carpeta anterior mostró iconos grandes, el siguiente también debe ser.</span><span class="sxs-lookup"><span data-stu-id="465f0-224">For instance, if the previous folder view showed large icons, the next should as well.</span></span> <span data-ttu-id="465f0-225">Cuando el explorador de Windows llama a [**IShellView:: CreateViewWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-createviewwindow) para inicializar el objeto de vista de carpeta, el método recibe una estructura [**FOLDERSETTINGS**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) .</span><span class="sxs-lookup"><span data-stu-id="465f0-225">When Windows Explorer calls [**IShellView::CreateViewWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-createviewwindow) to initialize your folder view object, the method receives a [**FOLDERSETTINGS**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) structure.</span></span> <span data-ttu-id="465f0-226">Esta estructura contiene información que le permite hacer que la vista de carpetas sea coherente con la vista de carpeta anterior.</span><span class="sxs-lookup"><span data-stu-id="465f0-226">This structure contains information that allows you to make your folder view display consistent with the previous folder view.</span></span>

<span data-ttu-id="465f0-227">Para asegurarse de que la vista siguiente sea coherente con la vista actual, almacene la estructura [**FOLDERSETTINGS**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) .</span><span class="sxs-lookup"><span data-stu-id="465f0-227">To help ensure that the next view is consistent with the current view, store the [**FOLDERSETTINGS**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) structure.</span></span> <span data-ttu-id="465f0-228">Si la vista cambia, por ejemplo, de iconos grandes a pequeños, actualice la estructura en consecuencia.</span><span class="sxs-lookup"><span data-stu-id="465f0-228">If the view changes, for instance from large to small icons, update the structure accordingly.</span></span> <span data-ttu-id="465f0-229">Antes de cambiar de vista, el explorador de Windows llamará a [**IShellView:: GetCurrentInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-getcurrentinfo) para solicitar los valores de **FOLDERSETTINGS** actuales para pasarlos al siguiente objeto de vista de carpeta.</span><span class="sxs-lookup"><span data-stu-id="465f0-229">Prior to switching views, Windows Explorer will call [**IShellView::GetCurrentInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-getcurrentinfo) to request the current **FOLDERSETTINGS** values to pass them to the next folder view object.</span></span>

### <a name="refresh"></a><span data-ttu-id="465f0-230">Actualizar</span><span class="sxs-lookup"><span data-stu-id="465f0-230">Refresh</span></span>

<span data-ttu-id="465f0-231">El usuario puede asegurarse de que la vista de carpetas refleja el estado actual de la carpeta seleccionando **Actualizar** en el menú **Ver** o presionando la tecla F5.</span><span class="sxs-lookup"><span data-stu-id="465f0-231">The user can ensure that the folder view reflects the current state of the folder by selecting **Refresh** from the **View** menu or pressing the F5 key.</span></span> <span data-ttu-id="465f0-232">Cuando el usuario lo hace, el explorador de Windows llama al método [**IShellView:: Refresh**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-refresh) .</span><span class="sxs-lookup"><span data-stu-id="465f0-232">When the user does so, Windows Explorer calls the [**IShellView::Refresh**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-refresh) method.</span></span> <span data-ttu-id="465f0-233">El objeto de vista de carpeta debe actualizar inmediatamente la presentación de la vista de carpetas.</span><span class="sxs-lookup"><span data-stu-id="465f0-233">Your folder view object should immediately update the folder view display.</span></span>

### <a name="saveviewstate"></a><span data-ttu-id="465f0-234">SaveViewState</span><span class="sxs-lookup"><span data-stu-id="465f0-234">SaveViewState</span></span>

<span data-ttu-id="465f0-235">El explorador de Windows llama al método [**IShellView:: SaveViewState**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-saveviewstate) para solicitar al objeto de vista de carpeta que guarde su estado de vista.</span><span class="sxs-lookup"><span data-stu-id="465f0-235">Windows Explorer calls the [**IShellView::SaveViewState**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-saveviewstate) method to prompt your folder view object to save its view state.</span></span> <span data-ttu-id="465f0-236">Después, puede recuperar el estado la próxima vez que se vea la carpeta.</span><span class="sxs-lookup"><span data-stu-id="465f0-236">You can then recover the state the next time the folder is viewed.</span></span> <span data-ttu-id="465f0-237">La mejor manera de guardar el estado de vista es llamando al método [**IShellBrowser:: GetViewStateStream**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-getviewstatestream) .</span><span class="sxs-lookup"><span data-stu-id="465f0-237">The preferred way to save a view state is by calling the [**IShellBrowser::GetViewStateStream**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-getviewstatestream) method.</span></span> <span data-ttu-id="465f0-238">Este método devuelve una interfaz [IStream](/windows/win32/api/objidl/nn-objidl-istream) que el objeto de vista de carpetas puede usar para guardar su estado.</span><span class="sxs-lookup"><span data-stu-id="465f0-238">This method returns an [IStream](/windows/win32/api/objidl/nn-objidl-istream) interface that your folder view object can use to save its state.</span></span> <span data-ttu-id="465f0-239">Al crear otra vista de carpetas, puede llamar al mismo método **IShellBrowser:: GetViewStateStream** para obtener un puntero IStream que le permita leer la configuración guardada por vistas de carpeta anteriores.</span><span class="sxs-lookup"><span data-stu-id="465f0-239">When you create another folder view, you can call the same **IShellBrowser::GetViewStateStream** method to obtain an IStream pointer that allows you to read the settings saved by previous folder views.</span></span>

### <a name="translateacelerator"></a><span data-ttu-id="465f0-240">TranslateAcelerator</span><span class="sxs-lookup"><span data-stu-id="465f0-240">TranslateAcelerator</span></span>

<span data-ttu-id="465f0-241">Cuando el usuario presiona una tecla de método abreviado, el explorador de Windows pasa el mensaje al objeto de vista de carpeta mediante una llamada a [**IShellView:: TranslateAccelerator**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-translateaccelerator).</span><span class="sxs-lookup"><span data-stu-id="465f0-241">When the user presses a shortcut key, Windows Explorer passes the message to the folder view object by calling [**IShellView::TranslateAccelerator**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-translateaccelerator).</span></span> <span data-ttu-id="465f0-242">Devuelve S \_ false para que el explorador de Windows procese el mensaje.</span><span class="sxs-lookup"><span data-stu-id="465f0-242">Return S\_FALSE to have Windows Explorer process the message.</span></span> <span data-ttu-id="465f0-243">Si el objeto de vista de carpeta ha procesado el mensaje, devuelva el valor \_ correcto.</span><span class="sxs-lookup"><span data-stu-id="465f0-243">If your folder view object has processed the message, return S\_OK.</span></span>

<span data-ttu-id="465f0-244">Cuando la ventana vista de carpetas tiene el foco, el explorador de Windows llama a [**IShellView:: TranslateAccelerator**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-translateaccelerator) antes de procesar el mensaje.</span><span class="sxs-lookup"><span data-stu-id="465f0-244">When the folder view window has focus, Windows Explorer calls [**IShellView::TranslateAccelerator**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-translateaccelerator) before it processes the message.</span></span> <span data-ttu-id="465f0-245">Dado que la mayoría de los mensajes están asociados normalmente con los comandos de barra de menús o barra de herramientas del explorador de Windows, el objeto de vista de carpeta normalmente debería devolver S \_ false.</span><span class="sxs-lookup"><span data-stu-id="465f0-245">Because most of the messages are typically associated with Windows Explorer menu bar or toolbar commands, your folder view object should normally return S\_FALSE.</span></span> <span data-ttu-id="465f0-246">Después, el explorador de Windows puede procesar el mensaje con normalidad.</span><span class="sxs-lookup"><span data-stu-id="465f0-246">Windows Explorer can then process the message normally.</span></span> <span data-ttu-id="465f0-247">Devuelve S \_ OK solo si el mensaje es específico de la carpeta y no desea que el explorador de Windows realice ningún procesamiento adicional.</span><span class="sxs-lookup"><span data-stu-id="465f0-247">Return S\_OK only if the message is folder-specific and you do not want Windows Explorer to do any further processing.</span></span> <span data-ttu-id="465f0-248">Si la vista de la carpeta no tiene el foco, el explorador de Windows procesa el mensaje en primer lugar.</span><span class="sxs-lookup"><span data-stu-id="465f0-248">If the folder view does not have focus, Windows Explorer processes the message first.</span></span> <span data-ttu-id="465f0-249">Solo llama a [**IShellBrowser:: TranslateAcceleratorSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-translateacceleratorsb) si no controla el mensaje.</span><span class="sxs-lookup"><span data-stu-id="465f0-249">It calls [**IShellBrowser::TranslateAcceleratorSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-translateacceleratorsb) only if it does not handle the message.</span></span>

## <a name="using-ishellbrowser-to-communicate-with-windows-explorer"></a><span data-ttu-id="465f0-250">Uso de IShellBrowser para comunicarse con el explorador de Windows</span><span class="sxs-lookup"><span data-stu-id="465f0-250">Using IShellBrowser to Communicate with Windows Explorer</span></span>

<span data-ttu-id="465f0-251">El objeto de vista de carpeta usa la interfaz [**IShellBrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) para comunicarse con el explorador de Windows para una variedad de propósitos, entre los que se incluyen:</span><span class="sxs-lookup"><span data-stu-id="465f0-251">The [**IShellBrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) interface is used by the folder view object to communicate with Windows Explorer for a variety of purposes, including:</span></span>

-   [<span data-ttu-id="465f0-252">Modificar la barra de menús del explorador de Windows</span><span class="sxs-lookup"><span data-stu-id="465f0-252">Modifying the Windows Explorer Menu Bar</span></span>](#modifying-the-windows-explorer-menu-bar)
-   [<span data-ttu-id="465f0-253">Modificar la barra de herramientas del explorador de Windows</span><span class="sxs-lookup"><span data-stu-id="465f0-253">Modifying the Windows Explorer Toolbar</span></span>](#modifying-the-windows-explorer-toolbar)
-   [<span data-ttu-id="465f0-254">Modificar la barra de estado del explorador de Windows</span><span class="sxs-lookup"><span data-stu-id="465f0-254">Modifying the Windows Explorer Status Bar</span></span>](#modifying-the-windows-explorer-status-bar)
-   [<span data-ttu-id="465f0-255">Almacenar información específica de la vista</span><span class="sxs-lookup"><span data-stu-id="465f0-255">Storing View-specific Information</span></span>](#storing-view-specific-information)

### <a name="modifying-the-windows-explorer-menu-bar"></a><span data-ttu-id="465f0-256">Modificar la barra de menús del explorador de Windows</span><span class="sxs-lookup"><span data-stu-id="465f0-256">Modifying the Windows Explorer Menu Bar</span></span>

<span data-ttu-id="465f0-257">La barra de menús del explorador de Windows permite al usuario iniciar diversos comandos.</span><span class="sxs-lookup"><span data-stu-id="465f0-257">The Windows Explorer menu bar allows the user to launch a variety of commands.</span></span> <span data-ttu-id="465f0-258">De forma predeterminada, la barra de menús solo admite comandos que son específicos del explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="465f0-258">By default, the menu bar only supports commands that are specific to Windows Explorer.</span></span> <span data-ttu-id="465f0-259">El explorador de Windows procesa los mensajes de [ \_ comando de WM](../menurc/wm-command.md) relacionados y no se pasan al objeto de vista de carpeta.</span><span class="sxs-lookup"><span data-stu-id="465f0-259">The related [WM\_COMMAND](../menurc/wm-command.md) messages are processed by Windows Explorer and are not passed to your folder view object.</span></span> <span data-ttu-id="465f0-260">Sin embargo, puede modificar la barra de menús para incluir uno o varios elementos de menú específicos de la carpeta con [**IShellBrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser).</span><span class="sxs-lookup"><span data-stu-id="465f0-260">However, you can modify the menu bar to include one or more folder-specific menu items with [**IShellBrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser).</span></span> <span data-ttu-id="465f0-261">El explorador de Windows pasa los \_ mensajes de comando de WM asociados de esos elementos al procedimiento de ventana del objeto de carpeta para su procesamiento.</span><span class="sxs-lookup"><span data-stu-id="465f0-261">Windows Explorer passes the associated WM\_COMMAND messages of those items to your folder object's window procedure for processing.</span></span> <span data-ttu-id="465f0-262">También puede quitar o deshabilitar los comandos estándar que no se aplican a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="465f0-262">You can also remove or disable any standard commands that do not apply to your application.</span></span>

<span data-ttu-id="465f0-263">Los objetos de vista de carpeta normalmente modifican la barra de menús antes de que se muestre la vista de carpetas por primera vez.</span><span class="sxs-lookup"><span data-stu-id="465f0-263">Folder view objects typically modify the menu bar before the folder view is first displayed.</span></span> <span data-ttu-id="465f0-264">Deben devolver la barra de menús a su estado original cuando se destruya la vista de carpetas.</span><span class="sxs-lookup"><span data-stu-id="465f0-264">They must return the menu bar to its original state when the folder view is destroyed.</span></span> <span data-ttu-id="465f0-265">Es posible que también tenga que modificar la barra de menús cada vez que la vista de carpetas gane o pierda el foco.</span><span class="sxs-lookup"><span data-stu-id="465f0-265">You might also need to modify the menu bar each time your folder view gains or loses focus.</span></span>

<span data-ttu-id="465f0-266">Dado que el explorador de Windows llama a [**IShellView:: UIActivate**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate) cada vez que cambia el estado de la ventana de vista de carpeta, la modificación de la barra de menús se incluye normalmente en la implementación de ese método.</span><span class="sxs-lookup"><span data-stu-id="465f0-266">Because Windows Explorer calls [**IShellView::UIActivate**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate) each time the folder view window's state changes, menu bar modification is normally included in that method's implementation.</span></span> <span data-ttu-id="465f0-267">El procedimiento básico para modificar la barra de menús del explorador de Windows es:</span><span class="sxs-lookup"><span data-stu-id="465f0-267">The basic procedure for modifying the Windows Explorer menu bar is:</span></span>

1.  <span data-ttu-id="465f0-268">Llame a [CreateMenu](/windows/win32/api/winuser/nf-winuser-createmenu) para crear un identificador de menú.</span><span class="sxs-lookup"><span data-stu-id="465f0-268">Call [CreateMenu](/windows/win32/api/winuser/nf-winuser-createmenu) to create a menu handle.</span></span>
2.  <span data-ttu-id="465f0-269">Pase ese identificador de menú al explorador de Windows mediante una llamada a [**IShellBrowser:: InsertMenusSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-insertmenussb).</span><span class="sxs-lookup"><span data-stu-id="465f0-269">Pass that menu handle to Windows Explorer by calling [**IShellBrowser::InsertMenusSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-insertmenussb).</span></span> <span data-ttu-id="465f0-270">El explorador de Windows rellenará la información del menú.</span><span class="sxs-lookup"><span data-stu-id="465f0-270">Windows Explorer will fill in its menu information.</span></span>
3.  <span data-ttu-id="465f0-271">Modifique el menú según sea necesario.</span><span class="sxs-lookup"><span data-stu-id="465f0-271">Modify the menu as needed.</span></span>
4.  <span data-ttu-id="465f0-272">Llame a [**IShellBrowser:: SetMenuSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-setmenusb) para que el explorador de Windows muestre la barra de menús modificada.</span><span class="sxs-lookup"><span data-stu-id="465f0-272">Call [**IShellBrowser::SetMenuSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-setmenusb) to have Windows Explorer display the modified menu bar.</span></span>

<span data-ttu-id="465f0-273">El explorador de Windows tiene seis menús emergentes en la barra de menús.</span><span class="sxs-lookup"><span data-stu-id="465f0-273">Windows Explorer has six pop-up menus on its menu bar.</span></span> <span data-ttu-id="465f0-274">Al igual que con todos los contenedores OLE, el menú del explorador de Windows se divide en seis grupos: archivo, edición, contenedor, objeto, ventana y ayuda.</span><span class="sxs-lookup"><span data-stu-id="465f0-274">As with all OLE containers, the Windows Explorer menu is divided into six groups: File, Edit, Container, Object, Window, and Help.</span></span> <span data-ttu-id="465f0-275">En la tabla siguiente se enumeran los menús emergentes del explorador de Windows y su grupo asociado, junto con los identificadores de menú.</span><span class="sxs-lookup"><span data-stu-id="465f0-275">The following table lists the Windows Explorer pop-up menus and their associated group, along with the menu IDs.</span></span>



| <span data-ttu-id="465f0-276">Menú emergente</span><span class="sxs-lookup"><span data-stu-id="465f0-276">Pop-up menu</span></span> | <span data-ttu-id="465f0-277">id</span><span class="sxs-lookup"><span data-stu-id="465f0-277">ID</span></span>                     | <span data-ttu-id="465f0-278">Grupo</span><span class="sxs-lookup"><span data-stu-id="465f0-278">Group</span></span>     |
|-------------|------------------------|-----------|
| <span data-ttu-id="465f0-279">Archivo</span><span class="sxs-lookup"><span data-stu-id="465f0-279">File</span></span>        | <span data-ttu-id="465f0-280">\_archivo de menú FCIDM \_</span><span class="sxs-lookup"><span data-stu-id="465f0-280">FCIDM\_MENU\_FILE</span></span>      | <span data-ttu-id="465f0-281">Archivo</span><span class="sxs-lookup"><span data-stu-id="465f0-281">File</span></span>      |
| <span data-ttu-id="465f0-282">Editar</span><span class="sxs-lookup"><span data-stu-id="465f0-282">Edit</span></span>        | <span data-ttu-id="465f0-283">\_edición del menú FCIDM \_</span><span class="sxs-lookup"><span data-stu-id="465f0-283">FCIDM\_MENU\_EDIT</span></span>      | <span data-ttu-id="465f0-284">Archivo</span><span class="sxs-lookup"><span data-stu-id="465f0-284">File</span></span>      |
| <span data-ttu-id="465f0-285">Ver</span><span class="sxs-lookup"><span data-stu-id="465f0-285">View</span></span>        | <span data-ttu-id="465f0-286">\_vista de menú FCIDM \_</span><span class="sxs-lookup"><span data-stu-id="465f0-286">FCIDM\_MENU\_VIEW</span></span>      | <span data-ttu-id="465f0-287">Contenedor</span><span class="sxs-lookup"><span data-stu-id="465f0-287">Container</span></span> |
| <span data-ttu-id="465f0-288">Favoritos</span><span class="sxs-lookup"><span data-stu-id="465f0-288">Favorites</span></span>   | <span data-ttu-id="465f0-289">\_favoritos del menú FCIDM \_</span><span class="sxs-lookup"><span data-stu-id="465f0-289">FCIDM\_MENU\_FAVORITES</span></span> | <span data-ttu-id="465f0-290">Contenedor</span><span class="sxs-lookup"><span data-stu-id="465f0-290">Container</span></span> |
| <span data-ttu-id="465f0-291">Herramientas</span><span class="sxs-lookup"><span data-stu-id="465f0-291">Tools</span></span>       | <span data-ttu-id="465f0-292">\_herramientas de menú FCIDM \_</span><span class="sxs-lookup"><span data-stu-id="465f0-292">FCIDM\_MENU\_TOOLS</span></span>     | <span data-ttu-id="465f0-293">Contenedor</span><span class="sxs-lookup"><span data-stu-id="465f0-293">Container</span></span> |
| <span data-ttu-id="465f0-294">Ayuda</span><span class="sxs-lookup"><span data-stu-id="465f0-294">Help</span></span>        | <span data-ttu-id="465f0-295">\_ayuda del menú FCIDM \_</span><span class="sxs-lookup"><span data-stu-id="465f0-295">FCIDM\_MENU\_HELP</span></span>      | <span data-ttu-id="465f0-296">Periodo</span><span class="sxs-lookup"><span data-stu-id="465f0-296">Window</span></span>    |



 

<span data-ttu-id="465f0-297">Al pasar el identificador de menú al explorador de Windows mediante una llamada a [**IShellBrowser:: InsertMenusSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-insertmenussb), también debe pasar un puntero a una estructura [OLEMENUGROUPWIDTHS](/windows/win32/api/oleidl/ns-oleidl-olemenugroupwidths) cuyos miembros se hayan inicializado en cero.</span><span class="sxs-lookup"><span data-stu-id="465f0-297">When you pass the menu handle to Windows Explorer by calling [**IShellBrowser::InsertMenusSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-insertmenussb), you must also pass a pointer to an [OLEMENUGROUPWIDTHS](/windows/win32/api/oleidl/ns-oleidl-olemenugroupwidths) structure whose members have been initialized to zero.</span></span>

<span data-ttu-id="465f0-298">Cuando [**IShellBrowser:: InsertMenusSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-insertmenussb) devuelve, el explorador de Windows habrá agregado sus elementos de menú.</span><span class="sxs-lookup"><span data-stu-id="465f0-298">When [**IShellBrowser::InsertMenusSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-insertmenussb) returns, Windows Explorer will have added its menu items.</span></span> <span data-ttu-id="465f0-299">Después, puede usar el identificador de menú devuelto con las funciones de menú estándar de Windows, como [InsertMenuItem](/windows/win32/api/winuser/nf-winuser-insertmenuitema) :</span><span class="sxs-lookup"><span data-stu-id="465f0-299">You can then use the returned menu handle with standard Windows menu functions such as [InsertMenuItem](/windows/win32/api/winuser/nf-winuser-insertmenuitema) to:</span></span>

-   <span data-ttu-id="465f0-300">Agregar elementos a los menús emergentes del explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="465f0-300">Add items to the Windows Explorer pop-up menus.</span></span>
-   <span data-ttu-id="465f0-301">Modificar o eliminar elementos existentes en los menús emergentes del explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="465f0-301">Modify or delete existing items in the Windows Explorer pop-up menus.</span></span>
-   <span data-ttu-id="465f0-302">Agregar nuevos menús emergentes.</span><span class="sxs-lookup"><span data-stu-id="465f0-302">Add new pop-up menus.</span></span>

<span data-ttu-id="465f0-303">Use los identificadores enumerados en la tabla para identificar los distintos menús emergentes del explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="465f0-303">Use the IDs listed in the table to identify the various Windows Explorer pop-up menus.</span></span>

> [!Note]  
> <span data-ttu-id="465f0-304">Para evitar conflictos con los identificadores de comando del explorador de Windows, los identificadores de los elementos de menú que agregue deben estar entre FCIDM \_ SHVIEWFIRST y FCIDM \_ SHVIEWLAST.</span><span class="sxs-lookup"><span data-stu-id="465f0-304">To avoid conflicts with Windows Explorer command IDs, the IDs of any menu items that you add must fall between FCIDM\_SHVIEWFIRST and FCIDM\_SHVIEWLAST.</span></span> <span data-ttu-id="465f0-305">Estos dos valores se definen en ShlObj. h.</span><span class="sxs-lookup"><span data-stu-id="465f0-305">These two values are defined in Shlobj.h.</span></span>

 

<span data-ttu-id="465f0-306">Cuando haya terminado de modificar el menú, llame a [**IShellBrowser:: SetMenuSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-setmenusb) para que el explorador de Windows muestre la nueva barra de menús.</span><span class="sxs-lookup"><span data-stu-id="465f0-306">Once you have finished modifying the menu, call [**IShellBrowser::SetMenuSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-setmenusb) to have Windows Explorer display the new menu bar.</span></span>

<span data-ttu-id="465f0-307">Después de mostrar inicialmente la vista de carpetas, el explorador de Windows llama a [**IShellView:: UIActivate**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate) cada vez que la vista de carpeta gana o pierde el foco.</span><span class="sxs-lookup"><span data-stu-id="465f0-307">After the folder view is initially displayed, Windows Explorer calls [**IShellView::UIActivate**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate) each time the folder view gains or loses focus.</span></span> <span data-ttu-id="465f0-308">Si tiene algún elemento de menú que sea sensible al estado de la vista de la carpeta, debe modificar el menú en consecuencia, cada vez que cambie el estado.</span><span class="sxs-lookup"><span data-stu-id="465f0-308">If you have any menu items that are sensitive to the state of the folder view, you should modify the menu accordingly, each time the state changes.</span></span> <span data-ttu-id="465f0-309">Por ejemplo, podría tener un elemento de menú que actúe en un elemento de la vista de carpetas seleccionado por el usuario.</span><span class="sxs-lookup"><span data-stu-id="465f0-309">For instance, you might have a menu item that acts on an item in the folder view that has been selected by the user.</span></span> <span data-ttu-id="465f0-310">Debe deshabilitar o quitar este elemento de menú cuando la vista de carpetas pierda el foco.</span><span class="sxs-lookup"><span data-stu-id="465f0-310">You should disable or remove this menu item when the folder view loses focus.</span></span>

<span data-ttu-id="465f0-311">Cuando el explorador de Windows llama a [**IShellView:: UIActivate**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate) para indicar que la vista de carpetas se está desactivando, restaure la barra de menús a su estado original llamando a [**IShellBrowser:: RemoveMenusSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-removemenussb).</span><span class="sxs-lookup"><span data-stu-id="465f0-311">When Windows Explorer calls [**IShellView::UIActivate**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate) to indicate that the folder view is being deactivated, restore the menu bar to its original state by calling [**IShellBrowser::RemoveMenusSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-removemenussb).</span></span>

### <a name="modifying-the-windows-explorer-toolbar"></a><span data-ttu-id="465f0-312">Modificar la barra de herramientas del explorador de Windows</span><span class="sxs-lookup"><span data-stu-id="465f0-312">Modifying the Windows Explorer Toolbar</span></span>

<span data-ttu-id="465f0-313">Además de modificar la barra de menús del explorador de Windows, también puede agregar botones a la barra de herramientas.</span><span class="sxs-lookup"><span data-stu-id="465f0-313">In addition to modifying the Windows Explorer menu bar, you can also add buttons to the toolbar.</span></span> <span data-ttu-id="465f0-314">Al igual que con la barra de menús, la modificación de la barra de herramientas suele ser parte de la implementación [**IShellView:: UIActivate**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate) .</span><span class="sxs-lookup"><span data-stu-id="465f0-314">As with the menu bar, toolbar modification is usually part of the [**IShellView::UIActivate**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate) implementation.</span></span> <span data-ttu-id="465f0-315">El procedimiento para agregar botones a la barra de herramientas del explorador de Windows es:</span><span class="sxs-lookup"><span data-stu-id="465f0-315">The procedure for adding buttons to the Windows Explorer toolbar is:</span></span>

1.  <span data-ttu-id="465f0-316">Agregue el mapa de bits del botón a la lista de imágenes de la barra de herramientas.</span><span class="sxs-lookup"><span data-stu-id="465f0-316">Add the button's bitmap to the toolbar's image list.</span></span>
2.  <span data-ttu-id="465f0-317">Defina la cadena de texto del botón.</span><span class="sxs-lookup"><span data-stu-id="465f0-317">Define the button's text string.</span></span>
3.  <span data-ttu-id="465f0-318">Agregue el botón a la barra de herramientas.</span><span class="sxs-lookup"><span data-stu-id="465f0-318">Add the button to the toolbar.</span></span>

<span data-ttu-id="465f0-319">Para agregar un mapa de bits a la lista de imágenes de una barra de herramientas, envíe la barra de herramientas a un mensaje de [TB \_ ADDBITMAP](../controls/tb-addbitmap.md) llamando a [**IShellBrowser:: SendControlMsg**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-sendcontrolmsg).</span><span class="sxs-lookup"><span data-stu-id="465f0-319">To add a bitmap to a toolbar's image list, send the toolbar a [TB\_ADDBITMAP](../controls/tb-addbitmap.md) message by calling [**IShellBrowser::SendControlMsg**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-sendcontrolmsg).</span></span> <span data-ttu-id="465f0-320">Para especificar el control de barra de herramientas, establezca el parámetro *ID* del método en la **barra de \_ herramientas FCW**.</span><span class="sxs-lookup"><span data-stu-id="465f0-320">To specify the toolbar control, set the method's *id* parameter to **FCW\_TOOLBAR**.</span></span> <span data-ttu-id="465f0-321">Establezca *wParam* en el número de imágenes de botón en el mapa de bits y *lParam* en la dirección de una estructura [TBADDBITMAP](/windows/win32/api/commctrl/ns-commctrl-tbaddbitmap) .</span><span class="sxs-lookup"><span data-stu-id="465f0-321">Set *wParam* to the number of button images in the bitmap, and *lParam* to the address of a [TBADDBITMAP](/windows/win32/api/commctrl/ns-commctrl-tbaddbitmap) structure.</span></span> <span data-ttu-id="465f0-322">El índice de la imagen se devuelve en el parámetro *pret* .</span><span class="sxs-lookup"><span data-stu-id="465f0-322">The image index is returned in the *pret* parameter.</span></span>

<span data-ttu-id="465f0-323">Hay dos maneras de definir una cadena para el botón:</span><span class="sxs-lookup"><span data-stu-id="465f0-323">There are two ways to define a string for the button:</span></span>

-   <span data-ttu-id="465f0-324">Asigne la cadena al miembro **iString** de la estructura [TBBUTTON](/windows/win32/api/commctrl/ns-commctrl-tbbutton) del botón.</span><span class="sxs-lookup"><span data-stu-id="465f0-324">Assign the string to the **iString** member of the button's [TBBUTTON](/windows/win32/api/commctrl/ns-commctrl-tbbutton) structure.</span></span>
-   <span data-ttu-id="465f0-325">Llame a [**IShellBrowser:: SendControlMsg**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-sendcontrolmsg) para enviar el control de la barra de herramientas a un mensaje de [TB \_ ADDSTRING](../controls/tb-addstring.md) .</span><span class="sxs-lookup"><span data-stu-id="465f0-325">Call [**IShellBrowser::SendControlMsg**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-sendcontrolmsg) to send the toolbar control a [TB\_ADDSTRING](../controls/tb-addstring.md) message.</span></span> <span data-ttu-id="465f0-326">El parámetro *wParam* debe establecerse en cero y el parámetro *lParam* en la cadena.</span><span class="sxs-lookup"><span data-stu-id="465f0-326">The *wParam* parameter should be set to zero and the *lParam* parameter to the string.</span></span> <span data-ttu-id="465f0-327">El índice de cadena se devuelve en el parámetro *pret* .</span><span class="sxs-lookup"><span data-stu-id="465f0-327">The string index is returned in the *pret* parameter.</span></span>

<span data-ttu-id="465f0-328">Para agregar el botón a la barra de herramientas, rellene una estructura [TBBUTTON](/windows/win32/api/commctrl/ns-commctrl-tbbutton) y pásela a [**IShellBrowser:: SetToolbarItems**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-settoolbaritems).</span><span class="sxs-lookup"><span data-stu-id="465f0-328">To add the button to the toolbar, fill in a [TBBUTTON](/windows/win32/api/commctrl/ns-commctrl-tbbutton) structure and pass it to [**IShellBrowser::SetToolbarItems**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-settoolbaritems).</span></span> <span data-ttu-id="465f0-329">Como con el menú, el identificador de comando debe estar entre FCIDM \_ SHVIEWFIRST y FCIDM \_ SHVIEWLAST.</span><span class="sxs-lookup"><span data-stu-id="465f0-329">As with the menu, your command ID must fall between FCIDM\_SHVIEWFIRST and FCIDM\_SHVIEWLAST.</span></span> <span data-ttu-id="465f0-330">A continuación, la barra de herramientas anexará el botón a la derecha de los botones existentes.</span><span class="sxs-lookup"><span data-stu-id="465f0-330">The toolbar will then append the button to the right of the existing buttons.</span></span>

<span data-ttu-id="465f0-331">Por ejemplo, el siguiente fragmento de código agrega un botón estándar a la barra de herramientas del explorador de Windows con un ID. de comando de IDB \_ MyButton.</span><span class="sxs-lookup"><span data-stu-id="465f0-331">For instance, the following code fragment adds one standard button to the Windows Explorer toolbar with a command ID of IDB\_MYBUTTON.</span></span>


```
TBADDBITMAP tbadbm;
int iButtonIndex;
TBBUTTON tbb;

tbadbm.hInst = g_hInstance;    // The module's instance handle
tbadbm.nID = IDB_BUTTONIMAGE;  // The bitmap's resource ID

psb->SendControlMsg(FCW_TOOLBAR, TB_ADDBITMAP, 1,
                    reinterpret_cast<LPARAM>(&tbadbm), &iButtonIndex);

psb->SendControlMsg(FCW_TOOLBAR, TB_ADDSTRING, NULL,
                    reinterpret_cast<LPARAM>(szLabel), &iStringIndex);

ZeroMemory(&tbb, sizeof(TBBUTTON));
tbb.iBitmap = iButtonIndex;
tbb.iCommand = IDB_MYBUTTON;
tbb.iString = iStringIndex;
tbb.fsState = TBSTATE_ENABLED;
tbb.fsStyle = TBSTYLE_BUTTON;

psb->SetToolbarItems(&tbb, 1, FCT_MERGE);
```



<span data-ttu-id="465f0-332">Para obtener más información sobre cómo controlar los controles de la barra de herramientas, vea [controles de barra de herramientas](../controls/toolbar-control-reference.md).</span><span class="sxs-lookup"><span data-stu-id="465f0-332">For further discussion of how to handle toolbar controls, see [Toolbar Controls](../controls/toolbar-control-reference.md).</span></span>

### <a name="modifying-the-windows-explorer-status-bar"></a><span data-ttu-id="465f0-333">Modificar la barra de estado del explorador de Windows</span><span class="sxs-lookup"><span data-stu-id="465f0-333">Modifying the Windows Explorer Status Bar</span></span>

<span data-ttu-id="465f0-334">Puede usar la barra de estado del explorador de Windows para mostrar una gran variedad de información útil.</span><span class="sxs-lookup"><span data-stu-id="465f0-334">You can use the Windows Explorer status bar to display a variety of useful information.</span></span> <span data-ttu-id="465f0-335">Hay dos maneras de usar la barra de estado:</span><span class="sxs-lookup"><span data-stu-id="465f0-335">There are two ways to use the status bar:</span></span>

-   <span data-ttu-id="465f0-336">Use [**IShellBrowser:: SetStatusTextSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-setstatustextsb) para mostrar una cadena de texto en la barra de estado.</span><span class="sxs-lookup"><span data-stu-id="465f0-336">Use [**IShellBrowser::SetStatusTextSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-setstatustextsb) to display a text string on the status bar.</span></span>
-   <span data-ttu-id="465f0-337">Enviar mensajes directamente al control de barra de estado con [**IShellBrowser:: SendControlMsg**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-sendcontrolmsg).</span><span class="sxs-lookup"><span data-stu-id="465f0-337">Send messages directly to the status bar control with [**IShellBrowser::SendControlMsg**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-sendcontrolmsg).</span></span>

<span data-ttu-id="465f0-338">El primer método es sencillo, pero suficiente para muchos propósitos.</span><span class="sxs-lookup"><span data-stu-id="465f0-338">The first method is straightforward but sufficient for many purposes.</span></span> <span data-ttu-id="465f0-339">Para mayor flexibilidad, puede enviar mensajes directamente al control de la barra de estado mediante una llamada a [**IShellBrowser:: SendControlMsg**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-sendcontrolmsg) con el parámetro *ID* establecido en **FCW \_ status**.</span><span class="sxs-lookup"><span data-stu-id="465f0-339">For greater flexibility, you can send messages directly to the status bar control by calling [**IShellBrowser::SendControlMsg**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-sendcontrolmsg) with the *id* parameter set to **FCW\_STATUS**.</span></span> <span data-ttu-id="465f0-340">Para obtener más información sobre los controles de barra de estado, vea [barras de estado](../controls/status-bars.md).</span><span class="sxs-lookup"><span data-stu-id="465f0-340">For further discussion of status bar controls, see [Status Bars](../controls/status-bars.md).</span></span>

### <a name="storing-view-specific-information"></a><span data-ttu-id="465f0-341">Almacenar información específica de la vista</span><span class="sxs-lookup"><span data-stu-id="465f0-341">Storing View-specific Information</span></span>

<span data-ttu-id="465f0-342">Cuando una vista está a punto de ser destruida, a menudo resulta útil almacenar información como el estado o la configuración de la vista.</span><span class="sxs-lookup"><span data-stu-id="465f0-342">When a view is about to be destroyed, it is often useful to store information such as the view's state or settings.</span></span> <span data-ttu-id="465f0-343">El explorador de Windows le pide que realice esta tarea mediante una llamada a [**IShellView:: SaveViewState**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-saveviewstate).</span><span class="sxs-lookup"><span data-stu-id="465f0-343">Windows Explorer prompts you to do this task by calling [**IShellView::SaveViewState**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-saveviewstate).</span></span> <span data-ttu-id="465f0-344">La mejor manera de guardar la información específica de la vista es llamar a [**IShellBrowser:: GetViewStateStream**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-getviewstatestream).</span><span class="sxs-lookup"><span data-stu-id="465f0-344">The preferred way to save view-specific information is to call [**IShellBrowser::GetViewStateStream**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-getviewstatestream).</span></span> <span data-ttu-id="465f0-345">Este método proporciona una interfaz [IStream](/windows/win32/api/objidl/nn-objidl-istream) que puede usar para almacenar la información.</span><span class="sxs-lookup"><span data-stu-id="465f0-345">This method provides you with an [IStream](/windows/win32/api/objidl/nn-objidl-istream) interface that you can use to store the information.</span></span> <span data-ttu-id="465f0-346">Puede usar cualquier formato de datos adecuado.</span><span class="sxs-lookup"><span data-stu-id="465f0-346">You are free to use any suitable data format.</span></span>

 

 
