---
title: Selector de objetos de directorio
description: El cuadro de diálogo Selector de objetos de directorio permite al usuario seleccionar uno o más objetos del catálogo global, un dominio o un equipo o un grupo de trabajo.
ms.assetid: 5b3e5d71-afd2-49db-b3a2-f9a49f0b2b3a
ms.tgt_platform: multiple
keywords:
- AD de selector de objetos de directorio
- Selector de objetos AD
- objetos AD, selector de objetos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 24f6ba7fd053aa8ab3245bf72c693f0a887aa983
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/17/2020
ms.locfileid: "104077529"
---
# <a name="directory-object-picker"></a><span data-ttu-id="5247c-106">Selector de objetos de directorio</span><span class="sxs-lookup"><span data-stu-id="5247c-106">Directory Object Picker</span></span>

<span data-ttu-id="5247c-107">El cuadro de diálogo Selector de objetos de directorio permite al usuario seleccionar uno o más objetos del catálogo global, un dominio o un equipo o un grupo de trabajo.</span><span class="sxs-lookup"><span data-stu-id="5247c-107">The directory object picker dialog box enables a user to select one or more objects from either the global catalog, a domain or computer, or a workgroup.</span></span> <span data-ttu-id="5247c-108">Los tipos de objeto entre los que un usuario puede seleccionar son los objetos de usuario, contacto, grupo y equipo.</span><span class="sxs-lookup"><span data-stu-id="5247c-108">The object types from which a user can select include user, contact, group, and computer objects.</span></span> <span data-ttu-id="5247c-109">Para obtener más información acerca de Active Directory Domain Services, vea [Active Directory Domain Services](active-directory-domain-services.md).</span><span class="sxs-lookup"><span data-stu-id="5247c-109">For more information about Active Directory Domain Services, see [Active Directory Domain Services](active-directory-domain-services.md).</span></span>

<span data-ttu-id="5247c-110">Para mostrar un cuadro de diálogo Selector de objetos:</span><span class="sxs-lookup"><span data-stu-id="5247c-110">To display an object picker dialog box:</span></span>

1.  <span data-ttu-id="5247c-111">Llame a la función [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) o [**CoCreateInstanceEx**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstanceex) para crear una instancia de la interfaz [**IDsObjectPicker**](/windows/desktop/api/Objsel/nn-objsel-idsobjectpicker) .</span><span class="sxs-lookup"><span data-stu-id="5247c-111">Call the [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) or [**CoCreateInstanceEx**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstanceex) function to create an instance of the [**IDsObjectPicker**](/windows/desktop/api/Objsel/nn-objsel-idsobjectpicker) interface.</span></span>
2.  <span data-ttu-id="5247c-112">Llame al método [**IDsObjectPicker:: Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) para inicializar el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="5247c-112">Call the [**IDsObjectPicker::Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) method to initialize the dialog box.</span></span>
3.  <span data-ttu-id="5247c-113">Llame al método [**IDsObjectPicker:: InvokeDialog**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-invokedialog) para mostrar el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="5247c-113">Call the [**IDsObjectPicker::InvokeDialog**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-invokedialog) method to display the dialog box.</span></span>
4.  <span data-ttu-id="5247c-114">Llame al método [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) de la instancia de [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) que devuelve el cuadro de diálogo Selector de objetos para recuperar los datos de la [**lista de selección de CFSTR \_ DSOP \_ DS \_ \_**](cfstr-dsop-ds-selection-list.md) .</span><span class="sxs-lookup"><span data-stu-id="5247c-114">Call the [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method of the [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) instance returned by the object picker dialog box to retrieve the [**CFSTR\_DSOP\_DS\_SELECTION\_LIST**](cfstr-dsop-ds-selection-list.md) data.</span></span> <span data-ttu-id="5247c-115">El formato del portapapeles de la **\_ \_ \_ \_ lista de selección DS de CFSTR DSOP** proporciona un **HGLOBAL** que contiene una estructura de [**lista de \_ selección \_ de DS**](/windows/desktop/api/Objsel/ns-objsel-ds_selection_list) .</span><span class="sxs-lookup"><span data-stu-id="5247c-115">The **CFSTR\_DSOP\_DS\_SELECTION\_LIST** clipboard format provides an **HGLOBAL** that contains a [**DS\_SELECTION\_LIST**](/windows/desktop/api/Objsel/ns-objsel-ds_selection_list) structure.</span></span> <span data-ttu-id="5247c-116">La estructura de la **\_ \_ lista de selección de DS** contiene datos sobre los elementos seleccionados en el cuadro de diálogo Selector de objetos.</span><span class="sxs-lookup"><span data-stu-id="5247c-116">The **DS\_SELECTION\_LIST** structure contains data about the items selected in the object picker dialog box.</span></span>

<span data-ttu-id="5247c-117">Si se requiere el identificador de seguridad (SID) para un objeto, debe solicitarse directamente desde el selector de objetos agregando el atributo **objectSid** a la lista de atributos que se van a recuperar para el objeto seleccionado.</span><span class="sxs-lookup"><span data-stu-id="5247c-117">If the Security Identifier (SID) is required for an object, this should be requested directly from the object picker by adding the **objectSID** attribute to the list of attributes to retrieve for the selected object.</span></span> <span data-ttu-id="5247c-118">No se recomienda pasar el nombre de objeto devuelto a la función [**LsaLookupNames**](/windows/desktop/api/ntsecapi/nf-ntsecapi-lsalookupnames) o [**LookupAccountName**](/windows/desktop/api/winbase/nf-winbase-lookupaccountnamea) porque la búsqueda de nombre será redundante y puede producir un error en algunos casos.</span><span class="sxs-lookup"><span data-stu-id="5247c-118">Passing the returned object name to the [**LsaLookupNames**](/windows/desktop/api/ntsecapi/nf-ntsecapi-lsalookupnames) or [**LookupAccountName**](/windows/desktop/api/winbase/nf-winbase-lookupaccountnamea) function is not recommended because the name lookup will be redundant and may fail in some cases.</span></span>

<span data-ttu-id="5247c-119">Si se va a guardar una referencia a los objetos seleccionados, el nombre distintivo no se debe guardar porque el objeto puede moverse, cambiarse de nombre o puede cambiar debido a las diferencias de configuración regional.</span><span class="sxs-lookup"><span data-stu-id="5247c-119">If a reference to any selected objects will be saved, the distinguished name should not be saved because the object may move, get renamed, or may change due to locale differences.</span></span> <span data-ttu-id="5247c-120">En el caso de las entidades de seguridad, se debe solicitar el **objectSid** para el objeto y guardarlo de forma segura.</span><span class="sxs-lookup"><span data-stu-id="5247c-120">For security principals, the **objectSID** should be requested for the object and securely saved.</span></span> <span data-ttu-id="5247c-121">Si más adelante se necesita el nombre de la entidad de seguridad, se puede recuperar con la función [**LookupAccountSid**](/windows/desktop/api/winbase/nf-winbase-lookupaccountsida) .</span><span class="sxs-lookup"><span data-stu-id="5247c-121">If the name of the security principal is needed later, it can be retrieved with the [**LookupAccountSid**](/windows/desktop/api/winbase/nf-winbase-lookupaccountsida) function.</span></span> <span data-ttu-id="5247c-122">En el caso de todos los demás objetos, debe solicitarse y guardarse el **objectGUID** .</span><span class="sxs-lookup"><span data-stu-id="5247c-122">For all other objects, the **objectGUID** should be requested and saved.</span></span>

## <a name="initialization"></a><span data-ttu-id="5247c-123">Inicialización</span><span class="sxs-lookup"><span data-stu-id="5247c-123">Initialization</span></span>

<span data-ttu-id="5247c-124">Cuando se inicializa el cuadro de diálogo Selector de objetos, se especifica un conjunto de tipos de ámbito y filtros.</span><span class="sxs-lookup"><span data-stu-id="5247c-124">When the object picker dialog box is initialized, a set of scope types and filters is specified.</span></span> <span data-ttu-id="5247c-125">Los tipos de ámbito especificados determinan las ubicaciones, los dominios o los equipos, por ejemplo, desde el que un usuario puede seleccionar objetos.</span><span class="sxs-lookup"><span data-stu-id="5247c-125">The specified scope types determine the locations, domains or computers for example, from which a user can select objects.</span></span> <span data-ttu-id="5247c-126">Los filtros determinan los tipos de objetos que un usuario puede seleccionar a partir de un tipo de ámbito determinado.</span><span class="sxs-lookup"><span data-stu-id="5247c-126">The filters determine the types of objects that a user can select from a given scope type.</span></span> <span data-ttu-id="5247c-127">Para obtener más información, vea la sección ámbitos y filtros más adelante.</span><span class="sxs-lookup"><span data-stu-id="5247c-127">For more information, see the Scopes and Filters section below.</span></span>

<span data-ttu-id="5247c-128">De forma predeterminada, un usuario puede seleccionar un solo objeto en el cuadro de diálogo Selector de objetos de directorio.</span><span class="sxs-lookup"><span data-stu-id="5247c-128">By default, a user can select a single object in the directory object picker dialog box.</span></span> <span data-ttu-id="5247c-129">Para habilitar las selecciones múltiples, establezca la marca DSOP de la **\_ marca de \_ selección** múltiple en el miembro **flOptions** de la estructura [**DSOP \_ init \_ info**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) al inicializarse el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="5247c-129">To enable multiple selections, set the **DSOP\_FLAG\_MULTISELECT** flag in the **flOptions** member of the [**DSOP\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) structure when the dialog box initialized.</span></span>

## <a name="scopes-and-filters"></a><span data-ttu-id="5247c-130">Ámbitos y filtros</span><span class="sxs-lookup"><span data-stu-id="5247c-130">Scopes and Filters</span></span>

<span data-ttu-id="5247c-131">La lista desplegable **Buscar en** contiene los ámbitos de los que un usuario puede seleccionar objetos.</span><span class="sxs-lookup"><span data-stu-id="5247c-131">The **Look in** drop-down list contains the scopes from which a user can select objects.</span></span> <span data-ttu-id="5247c-132">Un ámbito es un dominio, un equipo, un grupo de trabajo o un catálogo global que almacena datos sobre y proporciona acceso a un conjunto de objetos disponibles.</span><span class="sxs-lookup"><span data-stu-id="5247c-132">A scope is a domain, computer, workgroup, or global catalog that stores data about, and provides access to, a set of available objects.</span></span> <span data-ttu-id="5247c-133">Las entradas de la lista de ámbitos dependen de los tipos de ámbito y el equipo de destino especificado cuando se llamó por última vez al método [**IDsObjectPicker:: Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) para inicializar el cuadro de diálogo Selector de objetos.</span><span class="sxs-lookup"><span data-stu-id="5247c-133">The entries in the scope list depend on the scope types and the target computer specified when the [**IDsObjectPicker::Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) method was last called to initialize the object picker dialog box.</span></span>

<span data-ttu-id="5247c-134">Un tipo de ámbito es una categoría genérica de ámbitos, como todos los dominios de la empresa a los que pertenece el equipo de destino, o el catálogo global de la empresa del equipo de destino o el propio equipo de destino.</span><span class="sxs-lookup"><span data-stu-id="5247c-134">A scope type is a generic category of scopes, such as all domains in the enterprise to which the target computer belongs, or the global catalog for the target computer's enterprise, or the target computer itself.</span></span> <span data-ttu-id="5247c-135">Para cada tipo de ámbito especificado, el cuadro de diálogo utiliza el contexto del equipo de destino para determinar las entradas de la lista de ámbitos.</span><span class="sxs-lookup"><span data-stu-id="5247c-135">For each specified scope type, the dialog box uses the context of the target computer to determine the scope list entries.</span></span>

<span data-ttu-id="5247c-136">El método [**IDsObjectPicker:: Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) toma un puntero a una estructura de [**información de DSOP \_ init \_**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) que contiene una matriz de estructuras de [**\_ \_ \_ información de ámbito de DSOP**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) .</span><span class="sxs-lookup"><span data-stu-id="5247c-136">The [**IDsObjectPicker::Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) method takes a pointer to a [**DSOP\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) structure that contains an array of [**DSOP\_SCOPE\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) structures.</span></span> <span data-ttu-id="5247c-137">Cada entrada de la matriz de **información de DSOP \_ Scope \_ init \_** especifica uno o varios tipos de ámbito, así como los filtros aplicables y otros atributos.</span><span class="sxs-lookup"><span data-stu-id="5247c-137">Each entry in the **DSOP\_SCOPE\_INIT\_INFO** array specifies one or more scope types as well as applicable filters and other attributes.</span></span> <span data-ttu-id="5247c-138">Los filtros determinan los tipos de objetos, como usuarios, grupos, contactos y equipos, que el usuario puede seleccionar en un tipo de ámbito determinado.</span><span class="sxs-lookup"><span data-stu-id="5247c-138">The filters determine the types of objects, such as users, groups, contacts, and computers, that the user can select from a given scope type.</span></span> <span data-ttu-id="5247c-139">Cuando el usuario selecciona un ámbito de la lista, el cuadro de diálogo aplica los filtros de ese tipo de ámbito para mostrar una lista de objetos entre los que el usuario puede seleccionar.</span><span class="sxs-lookup"><span data-stu-id="5247c-139">When the user selects a scope from the list, the dialog box applies the filters for that scope type to display a list of objects from which the user can select.</span></span>

<span data-ttu-id="5247c-140">Cada estructura [**DSOP \_ Scope \_ init \_ info**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) contiene una estructura de [**\_ \_ marcas de filtro DSOP**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) que especifica los filtros para ese tipo de ámbito.</span><span class="sxs-lookup"><span data-stu-id="5247c-140">Each [**DSOP\_SCOPE\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) structure contains a [**DSOP\_FILTER\_FLAGS**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) structure that specifies the filters for that scope type.</span></span> <span data-ttu-id="5247c-141">La estructura de **\_ \_ marcas de filtro de DSOP** distingue entre los ámbitos de nivel superior y nivel inferior:</span><span class="sxs-lookup"><span data-stu-id="5247c-141">The **DSOP\_FILTER\_FLAGS** structure distinguishes between up-level and down-level scopes:</span></span>

-   <span data-ttu-id="5247c-142">Un ámbito de nivel superior es un catálogo global o un dominio que admite el [proveedor LDAP](/windows/desktop/ADSI/adsi-ldap-provider)de ADSI.</span><span class="sxs-lookup"><span data-stu-id="5247c-142">An up-level scope is a global catalog or a domain that supports the ADSI [LDAP provider](/windows/desktop/ADSI/adsi-ldap-provider).</span></span>
-   <span data-ttu-id="5247c-143">Un ámbito de nivel inferior incluye grupos de trabajo y todos los equipos individuales.</span><span class="sxs-lookup"><span data-stu-id="5247c-143">A down-level scope includes workgroups and all individual computers.</span></span> <span data-ttu-id="5247c-144">El cuadro de diálogo utiliza el proveedor WinNT de ADSI para tener acceso a un ámbito de nivel inferior.</span><span class="sxs-lookup"><span data-stu-id="5247c-144">The dialog box uses the ADSI WinNT provider to access a down-level scope.</span></span>

<span data-ttu-id="5247c-145">Hay dos conjuntos de marcas de filtro definidas para su uso en la estructura de [**\_ \_ marcas de filtro DSOP**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) : una para ámbitos de nivel superior y otra para ámbitos de nivel inferior.</span><span class="sxs-lookup"><span data-stu-id="5247c-145">There are two sets of filter flags defined for use in the [**DSOP\_FILTER\_FLAGS**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) structure: one for up-level scopes and one for down-level scopes.</span></span> <span data-ttu-id="5247c-146">El miembro de **nivel superior** de la estructura de **\_ \_ marcas de filtro DSOP** es una estructura de filtros de nivel superior DSOP que especifica los filtros para ámbitos de nivel superior. [**\_ \_ \_**](/windows/desktop/api/Objsel/ns-objsel-dsop_uplevel_filter_flags)</span><span class="sxs-lookup"><span data-stu-id="5247c-146">The **Uplevel** member of the **DSOP\_FILTER\_FLAGS** structure is a [**DSOP\_UPLEVEL\_FILTER\_FLAGS**](/windows/desktop/api/Objsel/ns-objsel-dsop_uplevel_filter_flags) structure that specifies the filters for up-level scopes.</span></span> <span data-ttu-id="5247c-147">El miembro **flDownlevel** de la estructura de **\_ \_ marcas de filtro DSOP** es un conjunto de marcas que especifican los filtros para los ámbitos de nivel inferior.</span><span class="sxs-lookup"><span data-stu-id="5247c-147">The **flDownlevel** member of the **DSOP\_FILTER\_FLAGS** structure is a set of flags that specify the filters for down-level scopes.</span></span>

 

 