---
description: En esta sección se describe cómo enviar mensajes de acciones personalizadas que realmente realizan una parte de la instalación mediante una llamada a una biblioteca de vínculos dinámicos o un script.
ms.assetid: 637efccf-920d-421d-9183-528cc3515bf8
title: Devolver mensajes de error de acciones personalizadas
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 480a9e7891680aadc9d8eb4eedba2bad0d2e3dd4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104155516"
---
# <a name="returning-error-messages-from-custom-actions"></a><span data-ttu-id="8b358-103">Devolver mensajes de error de acciones personalizadas</span><span class="sxs-lookup"><span data-stu-id="8b358-103">Returning Error Messages from Custom Actions</span></span>

<span data-ttu-id="8b358-104">En esta sección se describe cómo enviar mensajes de acciones personalizadas que realmente realizan una parte de la instalación mediante una llamada a una biblioteca de vínculos dinámicos o un script.</span><span class="sxs-lookup"><span data-stu-id="8b358-104">This section describes how to send messages from custom actions that actually perform a part of the installation by calling a dynamic link library or script.</span></span> <span data-ttu-id="8b358-105">Tenga en cuenta que el [tipo de acción personalizada 19](custom-action-type-19.md) solo envía un mensaje de error especificado, devuelve un error y, a continuación, finaliza la instalación.</span><span class="sxs-lookup"><span data-stu-id="8b358-105">Note that [Custom Action Type 19](custom-action-type-19.md) only sends a specified error message, returns failure, and then terminates the installation.</span></span> <span data-ttu-id="8b358-106">El tipo de acción personalizada 19 no realiza ninguna parte de la instalación.</span><span class="sxs-lookup"><span data-stu-id="8b358-106">Custom Action Type 19 does not perform any part of the installation.</span></span>

<span data-ttu-id="8b358-107">Para enviar un mensaje de error desde una acción personalizada que usa una [biblioteca de vínculos dinámicos](dynamic-link-libraries.md) (dll), haga que la acción personalizada llame a [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage).</span><span class="sxs-lookup"><span data-stu-id="8b358-107">To send an error message from a custom action that uses a [dynamic-link library](dynamic-link-libraries.md) (DLL), have the custom action call [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage).</span></span> <span data-ttu-id="8b358-108">Tenga en cuenta que las acciones personalizadas iniciadas por una [ControlEvent, de acción](doaction-controlevent.md) pueden enviar mensajes con el método de [**mensaje**](session-message.md) , pero no pueden enviar un mensaje con **MsiProcessMessage**.</span><span class="sxs-lookup"><span data-stu-id="8b358-108">Note that custom actions launched by a [DoAction ControlEvent](doaction-controlevent.md) can send messages with the [**Message**](session-message.md) method but cannot send a message with **MsiProcessMessage**.</span></span> <span data-ttu-id="8b358-109">En sistemas anteriores a Windows Server 2003, las acciones personalizadas iniciadas por una acción ControlEvent, no pueden enviar mensajes con **MsiProcessMessage** o un método de **mensaje** .</span><span class="sxs-lookup"><span data-stu-id="8b358-109">On systems earlier than Windows Server 2003, custom actions launched by a DoAction ControlEvent cannot send messages with **MsiProcessMessage** or **Message** method.</span></span> <span data-ttu-id="8b358-110">Para obtener más información, consulte [envío de mensajes a Windows Installer mediante MsiProcessMessage](sending-messages-to-windows-installer-using-msiprocessmessage.md).</span><span class="sxs-lookup"><span data-stu-id="8b358-110">For more information, see [Sending Messages to Windows Installer Using MsiProcessMessage](sending-messages-to-windows-installer-using-msiprocessmessage.md).</span></span>

<span data-ttu-id="8b358-111">**Para mostrar un mensaje de error desde una acción personalizada mediante un archivo DLL**</span><span class="sxs-lookup"><span data-stu-id="8b358-111">**To display an error message from within a custom action using a DLL**</span></span>

1.  <span data-ttu-id="8b358-112">La acción personalizada debe llamar a [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) y pasar los parámetros *hInstall*, *eMessageType* y *hRecord*.</span><span class="sxs-lookup"><span data-stu-id="8b358-112">The custom action should call [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) and pass in the parameters *hInstall*, *eMessageType*, and *hRecord*.</span></span> <span data-ttu-id="8b358-113">El identificador de la instalación, el [tipo de acción personalizada 19](custom-action-type-19.md), se puede proporcionar a la acción personalizada, como se describe en [obtener acceso a la sesión del instalador actual desde una acción personalizada](accessing-the-current-installer-session-from-inside-a-custom-action.md) o desde [**MsiOpenProduct**](/windows/desktop/api/Msi/nf-msi-msiopenproducta) o [**MsiOpenPackage**](/windows/desktop/api/Msi/nf-msi-msiopenpackagea).</span><span class="sxs-lookup"><span data-stu-id="8b358-113">The handle to the installation, [Custom Action Type 19](custom-action-type-19.md), may be provided to the custom action as described in [Accessing the Current Installer Session from Inside a Custom Action](accessing-the-current-installer-session-from-inside-a-custom-action.md) or from [**MsiOpenProduct**](/windows/desktop/api/Msi/nf-msi-msiopenproducta) or [**MsiOpenPackage**](/windows/desktop/api/Msi/nf-msi-msiopenpackagea).</span></span>
2.  <span data-ttu-id="8b358-114">El parámetro *eMessageType* debe especificar uno de los tipos de mensaje, tal y como se muestra en [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage).</span><span class="sxs-lookup"><span data-stu-id="8b358-114">The parameter *eMessageType* should specify one of the message types as listed in [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage).</span></span>
3.  <span data-ttu-id="8b358-115">El parámetro *hRecord* de la función [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) depende del tipo de mensaje.</span><span class="sxs-lookup"><span data-stu-id="8b358-115">The *hRecord* parameter of the [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) function depends upon the message type.</span></span> <span data-ttu-id="8b358-116">Consulte [envío de mensajes a Windows Installer mediante MsiProcessMessage](sending-messages-to-windows-installer-using-msiprocessmessage.md).</span><span class="sxs-lookup"><span data-stu-id="8b358-116">See [Sending Messages to Windows Installer Using MsiProcessMessage](sending-messages-to-windows-installer-using-msiprocessmessage.md).</span></span> <span data-ttu-id="8b358-117">Si el mensaje contiene datos con formato, escriba el mensaje en la tabla de [errores](error-table.md) con el formato descrito en [con formato](formatted.md).</span><span class="sxs-lookup"><span data-stu-id="8b358-117">If the message contains formatted data, enter the message into the [Error](error-table.md) table using the formatting described in [Formatted](formatted.md).</span></span>

<span data-ttu-id="8b358-118">Para enviar un mensaje de error desde una acción personalizada que usa [scripts](scripts.md), la acción personalizada puede llamar al método de [**mensaje**](session-message.md) del objeto de [**sesión**](session-object.md) .</span><span class="sxs-lookup"><span data-stu-id="8b358-118">To send an error message from a custom action that uses [Scripts](scripts.md), the custom action may call the [**Message**](session-message.md) method of the [**Session**](session-object.md) object.</span></span>

<span data-ttu-id="8b358-119">**Para mostrar un mensaje de error desde una acción personalizada mediante un script**</span><span class="sxs-lookup"><span data-stu-id="8b358-119">**To display an error message from within a custom action using script**</span></span>

1.  <span data-ttu-id="8b358-120">La acción personalizada debe llamar al método de [**mensaje**](session-message.md) del objeto de [**sesión**](session-object.md) y pasar el *tipo* y el *registro* de los parámetros.</span><span class="sxs-lookup"><span data-stu-id="8b358-120">The custom action should call the [**Message**](session-message.md) method of the [**Session**](session-object.md) object and pass in the parameters *kind* and *record*.</span></span>
2.  <span data-ttu-id="8b358-121">El *tipo* de parámetro debe especificar uno de los tipos de mensaje que aparecen en el método de [**mensaje**](session-message.md) .</span><span class="sxs-lookup"><span data-stu-id="8b358-121">The parameter *kind* should specify one of the message types listed in the [**Message**](session-message.md) method.</span></span>
3.  <span data-ttu-id="8b358-122">El parámetro de *registro* del método de [**mensaje**](session-message.md) depende del tipo de mensaje.</span><span class="sxs-lookup"><span data-stu-id="8b358-122">The *record* parameter of the [**Message**](session-message.md) method depends upon the message type.</span></span> <span data-ttu-id="8b358-123">Si el mensaje contiene datos con formato, escriba el mensaje en la tabla de [errores](error-table.md) con el formato descrito en [con formato](formatted.md).</span><span class="sxs-lookup"><span data-stu-id="8b358-123">If the message contains formatted data, enter the message into the [Error](error-table.md) table using the formatting described in [Formatted](formatted.md).</span></span>

<span data-ttu-id="8b358-124">Las acciones personalizadas que utilizan [archivos ejecutables](executable-files.md) no pueden enviar un mensaje mediante una llamada a [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) o el método de [**mensaje**](session-message.md) porque no pueden obtener un identificador para la instalación.</span><span class="sxs-lookup"><span data-stu-id="8b358-124">Custom actions using [Executable Files](executable-files.md) cannot send a message by calling [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) or the [**Message**](session-message.md) method because they cannot get a handle to the installation.</span></span>

## <a name="related-topics"></a><span data-ttu-id="8b358-125">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="8b358-125">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8b358-126">Valores devueltos de la acción personalizada</span><span class="sxs-lookup"><span data-stu-id="8b358-126">Custom Action Return Values</span></span>](custom-action-return-values.md)
</dt> </dl>

 

 



