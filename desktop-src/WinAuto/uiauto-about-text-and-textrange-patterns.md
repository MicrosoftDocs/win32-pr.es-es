---
title: Acerca de los patrones de control Text y TextRange
description: El contenido textual de un control se expone mediante el patrón de control Text, que representa el contenido de un contenedor de texto como una secuencia de texto.
ms.assetid: acc2b513-9367-416a-b0d9-3c2bcc14a8a7
keywords:
- Automatización de la interfaz de usuario, compatibilidad de contenido textual
- UI Automation, información general sobre el patrón de texto
- Automatización de la interfaz de usuario, información general sobre controles de texto
- Automatización de la interfaz de usuario, patrón de control Text
- Automatización de la interfaz de usuario, Text Services Framework (TSF)
- Automatización de la interfaz de usuario, TSF
- Automatización de la interfaz de usuario, rendimiento
- patrones de texto, acerca de
- patrones de texto, Text Services Framework (TSF)
- controles de texto, acerca de
- contenido textual, compatibilidad con
- controles de texto, rendimiento
- Text (patrón de control)
- patrones de control, texto
- Text Services Framework (TSF)
- TSF (marco de trabajo de servicios de texto)
- rendimiento
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bb9ff1eb75227454e3e9df6035798a304096a958
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "105705019"
---
# <a name="about-the-text-and-textrange-control-patterns"></a><span data-ttu-id="338f1-120">Acerca de los patrones de control Text y TextRange</span><span class="sxs-lookup"><span data-stu-id="338f1-120">About the Text and TextRange Control Patterns</span></span>

<span data-ttu-id="338f1-121">El contenido textual de un control se expone mediante el patrón de control [Text](uiauto-implementingtextandtextrange.md) , que representa el contenido de un contenedor de texto como una secuencia de texto.</span><span class="sxs-lookup"><span data-stu-id="338f1-121">The textual content of a control is exposed by using the [Text](uiauto-implementingtextandtextrange.md) control pattern, which represents the contents of a text container as a text stream.</span></span> <span data-ttu-id="338f1-122">El patrón de control Text requiere la compatibilidad del patrón de control TextRange para exponer los atributos Format y Style.</span><span class="sxs-lookup"><span data-stu-id="338f1-122">The Text control pattern requires the support of the TextRange control pattern to expose format and style attributes.</span></span> <span data-ttu-id="338f1-123">El patrón de control TextRange admite el patrón de control text mediante la representación de intervalos de texto contiguos o varios (o rangos) en un contenedor de texto con una colección de extremos de inicio y fin.</span><span class="sxs-lookup"><span data-stu-id="338f1-123">The TextRange control pattern supports the Text control pattern by representing contiguous or multiple, disjoint text spans (or ranges) in a text container with a collection of start and end endpoints.</span></span> <span data-ttu-id="338f1-124">El patrón de control TextRange admite funcionalidad como selección, comparación, recuperación y exploración transversal.</span><span class="sxs-lookup"><span data-stu-id="338f1-124">The TextRange control pattern supports functionality such as selection, comparison, retrieval and traversal.</span></span>

> [!Note]  
> <span data-ttu-id="338f1-125">El patrón de control [Text](uiauto-implementingtextandtextrange.md) no proporciona un medio para insertar o modificar texto.</span><span class="sxs-lookup"><span data-stu-id="338f1-125">The [Text](uiauto-implementingtextandtextrange.md) control pattern does not provide a means to insert or modify text.</span></span> <span data-ttu-id="338f1-126">Sin embargo, dependiendo del control, esto puede realizarse mediante el patrón de control [valor](uiauto-implementingvalue.md) de Microsoft UI Automation o a través de la entrada de teclado directa.</span><span class="sxs-lookup"><span data-stu-id="338f1-126">However, depending on the control, this may be accomplished by using the Microsoft UI Automation [Value](uiauto-implementingvalue.md) control pattern or through direct keyboard input.</span></span> <span data-ttu-id="338f1-127">También hay un patrón [**TextEdit**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itexteditprovider) que admite el cambio mediante programación del texto.</span><span class="sxs-lookup"><span data-stu-id="338f1-127">There's also a [**TextEdit**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itexteditprovider) pattern that supports programmatic change to text.</span></span>

 

<span data-ttu-id="338f1-128">La funcionalidad descrita en este tema es fundamental para los proveedores de tecnología de asistencia y sus usuarios finales.</span><span class="sxs-lookup"><span data-stu-id="338f1-128">The functionality described in this topic is vital to assistive technology vendors and their end users.</span></span> <span data-ttu-id="338f1-129">Las tecnologías de asistencia pueden usar la automatización de la interfaz de usuario para recopilar información de formato de texto completa para el usuario y proporcionar navegación y selección de texto mediante programación por [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) (carácter, palabra, línea o párrafo).</span><span class="sxs-lookup"><span data-stu-id="338f1-129">Assistive technologies can use UI Automation to gather complete text formatting information for the user and provide programmatic navigation and selection of text by [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) (character, word, line, or paragraph).</span></span>

<span data-ttu-id="338f1-130">Este tema contiene las siguientes secciones:</span><span class="sxs-lookup"><span data-stu-id="338f1-130">This topic contains the following sections:</span></span>

-   [<span data-ttu-id="338f1-131">UI Automation TextPattern y el marco de trabajo de servicios de texto</span><span class="sxs-lookup"><span data-stu-id="338f1-131">UI Automation TextPattern and the Text Services Framework</span></span>](#ui-automation-textpattern-and-the-text-services-framework)
-   [<span data-ttu-id="338f1-132">Tipos de controles</span><span class="sxs-lookup"><span data-stu-id="338f1-132">Control Types</span></span>](#control-types)
-   [<span data-ttu-id="338f1-133">Interfaces de proveedor</span><span class="sxs-lookup"><span data-stu-id="338f1-133">Provider Interfaces</span></span>](#provider-interfaces)
-   [<span data-ttu-id="338f1-134">Interfaces de cliente</span><span class="sxs-lookup"><span data-stu-id="338f1-134">Client Interfaces</span></span>](#client-interfaces)
-   [<span data-ttu-id="338f1-135">Rendimiento</span><span class="sxs-lookup"><span data-stu-id="338f1-135">Performance</span></span>](#performance)
-   [<span data-ttu-id="338f1-136">Patrón de texto y objetos incrustados virtualizados</span><span class="sxs-lookup"><span data-stu-id="338f1-136">Text Pattern and Virtualized Embedded Objects</span></span>](#text-pattern-and-virtualized-embedded-objects)
-   [<span data-ttu-id="338f1-137">Usar el tipo de control personalizado con el patrón de control Text</span><span class="sxs-lookup"><span data-stu-id="338f1-137">Using the Custom Control Type with the Text Control Pattern</span></span>](#using-the-custom-control-type-with-the-text-control-pattern)
-   [<span data-ttu-id="338f1-138">Duración de un intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="338f1-138">Lifetime of a Text Range</span></span>](#lifetime-of-a-text-range)
-   [<span data-ttu-id="338f1-139">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="338f1-139">Related topics</span></span>](#related-topics)

## <a name="ui-automation-textpattern-and-the-text-services-framework"></a><span data-ttu-id="338f1-140">UI Automation TextPattern y el marco de trabajo de servicios de texto</span><span class="sxs-lookup"><span data-stu-id="338f1-140">UI Automation TextPattern and the Text Services Framework</span></span>

<span data-ttu-id="338f1-141">Text Services Framework (TSF) es un marco de trabajo del sistema simple y escalable que habilita los servicios de lenguaje natural y la entrada de texto avanzada en el escritorio y en las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="338f1-141">Text Services Framework (TSF) is a simple and scalable system framework that enables natural language services and advanced text input on the desktop and in applications.</span></span> <span data-ttu-id="338f1-142">Además de proporcionar interfaces para que las aplicaciones expongan su almacén de texto, también admite metadatos para el almacén de texto.</span><span class="sxs-lookup"><span data-stu-id="338f1-142">In addition to providing interfaces for applications to expose their text store, it also supports metadata for the text store.</span></span>

<span data-ttu-id="338f1-143">TSF se diseñó para aplicaciones que necesitan insertar entradas en escenarios que contengan contexto.</span><span class="sxs-lookup"><span data-stu-id="338f1-143">TSF was designed for applications that need to inject input into context-aware scenarios.</span></span> <span data-ttu-id="338f1-144">Sin embargo, el patrón de control [Text](uiauto-implementingtextandtextrange.md) es una solución de solo lectura diseñada para proporcionar acceso optimizado a un almacén de texto para los lectores de pantalla y dispositivos Braille.</span><span class="sxs-lookup"><span data-stu-id="338f1-144">The [Text](uiauto-implementingtextandtextrange.md) control pattern, however, is a read-only solution that is intended to provide optimized access to a text store for screen-readers and Braille devices.</span></span>

<span data-ttu-id="338f1-145">Las tecnologías accesibles que requieren acceso de solo lectura a un almacén de texto pueden usar el patrón de control Text, pero necesitarán la funcionalidad de TSF para la entrada contextual.</span><span class="sxs-lookup"><span data-stu-id="338f1-145">Accessible technologies that require read-only access to a text store can use the Text control pattern, but will need the functionality of TSF for context-aware input.</span></span>

<span data-ttu-id="338f1-146">Para obtener más información, vea [Text Services Framework](/windows/desktop/TSF/text-services-framework).</span><span class="sxs-lookup"><span data-stu-id="338f1-146">For more information, see [Text Services Framework](/windows/desktop/TSF/text-services-framework).</span></span>

## <a name="control-types"></a><span data-ttu-id="338f1-147">Tipos de controles</span><span class="sxs-lookup"><span data-stu-id="338f1-147">Control Types</span></span>

<span data-ttu-id="338f1-148">El tipo de control de [edición](uiauto-supporteditcontroltype.md) de automatización de la interfaz de usuario y el tipo de control de [documento](uiauto-supportdocumentcontroltype.md) deben admitir el patrón de control [Text](uiauto-implementingtextandtextrange.md) .</span><span class="sxs-lookup"><span data-stu-id="338f1-148">The UI Automation [Edit](uiauto-supporteditcontroltype.md) control type and [Document](uiauto-supportdocumentcontroltype.md) control type must support the [Text](uiauto-implementingtextandtextrange.md) control pattern.</span></span> <span data-ttu-id="338f1-149">Para mejorar la accesibilidad, Microsoft recomienda que los tipos de control de texto y la [información sobre herramientas](uiauto-supporttooltipcontroltype.md) también admitan el patrón de control Text, pero no es obligatorio.</span><span class="sxs-lookup"><span data-stu-id="338f1-149">For improved accessibility, Microsoft recommends that the [ToolTip](uiauto-supporttooltipcontroltype.md) and Text control types also support the Text control pattern, but it is not required.</span></span>

## <a name="provider-interfaces"></a><span data-ttu-id="338f1-150">Interfaces de proveedor</span><span class="sxs-lookup"><span data-stu-id="338f1-150">Provider Interfaces</span></span>

<span data-ttu-id="338f1-151">Los proveedores de automatización de la interfaz de usuario admiten el patrón de control de [texto](uiauto-implementingtextandtextrange.md) para un control mediante la implementación de las interfaces [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) y [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) .</span><span class="sxs-lookup"><span data-stu-id="338f1-151">UI Automation providers support the [Text](uiauto-implementingtextandtextrange.md) control pattern for a control by implementing the [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) and [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interfaces.</span></span> <span data-ttu-id="338f1-152">Estas interfaces exponen información detallada sobre los atributos del texto del control y proporcionan capacidades de navegación sólidas.</span><span class="sxs-lookup"><span data-stu-id="338f1-152">These interfaces expose detailed attribute information for text in the control and provide robust navigational capabilities.</span></span>

<span data-ttu-id="338f1-153">No es necesario que un proveedor admita todos los atributos de texto si el control no tiene compatibilidad con ningún atributo determinado.</span><span class="sxs-lookup"><span data-stu-id="338f1-153">A provider does not need to support all text attributes if the control lacks support for any particular attribute.</span></span>

<span data-ttu-id="338f1-154">Un proveedor debe admitir los métodos [**ITextProvider:: getSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) y [**ITextRangeProvider:: SELECT**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select) si el control admite la selección de texto o la ubicación del cursor de texto (o símbolo de inserción) dentro del área de texto.</span><span class="sxs-lookup"><span data-stu-id="338f1-154">A provider must support the [**ITextProvider::GetSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) and [**ITextRangeProvider::Select**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select) methods if the control supports text selection or placement of the text cursor (or system caret) within the text area.</span></span> <span data-ttu-id="338f1-155">Si el control no admite esta funcionalidad, no es necesario que admita ninguno de estos métodos.</span><span class="sxs-lookup"><span data-stu-id="338f1-155">If the control does not support this functionality, it does not need to support either of these methods.</span></span> <span data-ttu-id="338f1-156">Sin embargo, el control debe exponer el tipo de selección de texto que admite implementando la propiedad [**ITextProvider:: SupportedTextSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection) .</span><span class="sxs-lookup"><span data-stu-id="338f1-156">However, the control must expose the type of text selection it supports by implementing the [**ITextProvider::SupportedTextSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection) property.</span></span>

<span data-ttu-id="338f1-157">Un proveedor siempre debe admitir las constantes [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) , **TextUnit \_** y **TextUnit \_**, así como cualquier otro que sea capaz de admitir.</span><span class="sxs-lookup"><span data-stu-id="338f1-157">A provider must always support the [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) constants, **TextUnit\_Character** and **TextUnit\_Document**, as well as any others it is capable of supporting.</span></span>

> [!Note]  
> <span data-ttu-id="338f1-158">El proveedor puede omitir la compatibilidad con un [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) específico aplazando la siguiente unidad más grande admitida en el siguiente orden: **\_ carácter TextUnit**, **\_ formato TextUnit**, **TextUnit \_ Word**, **TextUnit \_ line**, **TextUnit \_ Paragraph**, **TextUnit \_ Page** y **TextUnit \_ Document**.</span><span class="sxs-lookup"><span data-stu-id="338f1-158">The provider may skip support for a specific [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) by deferring to the next largest unit supported in the following order: **TextUnit\_Character**, **TextUnit\_Format**, **TextUnit\_Word**, **TextUnit\_Line**, **TextUnit\_Paragraph**, **TextUnit\_Page**, and **TextUnit\_Document**.</span></span>

 

## <a name="client-interfaces"></a><span data-ttu-id="338f1-159">Interfaces de cliente</span><span class="sxs-lookup"><span data-stu-id="338f1-159">Client Interfaces</span></span>

<span data-ttu-id="338f1-160">Las aplicaciones cliente de automatización de la interfaz de usuario usan las interfaces [**IUIAutomationTextPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextpattern) y [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) para tener acceso al contenido textual de un control de texto.</span><span class="sxs-lookup"><span data-stu-id="338f1-160">UI Automation client applications use the [**IUIAutomationTextPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextpattern) and [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) interfaces to access the textual content of a text control.</span></span> <span data-ttu-id="338f1-161">Los clientes usan **IUIAutomationTextPattern** para seleccionar intervalos de texto denominados *intervalos de texto* y para recuperar punteros a interfaces de **IUIAutomationTextRange** para los intervalos.</span><span class="sxs-lookup"><span data-stu-id="338f1-161">Clients use **IUIAutomationTextPattern** to select spans of text called *text ranges*, and to retrieve pointers to **IUIAutomationTextRange** interfaces for the ranges.</span></span> <span data-ttu-id="338f1-162">La interfaz **IUIAutomationTextRange** permite a los clientes manipular el intervalo de texto y recuperar información sobre el texto del intervalo, incluidos atributos como el nombre de la fuente, el color de primer plano, el estilo de subrayado, etc.</span><span class="sxs-lookup"><span data-stu-id="338f1-162">The **IUIAutomationTextRange** interface enables clients to manipulate the text range, and to retrieve information about the text in the range, including attributes such as font name, foreground color, underline style, and so on.</span></span> <span data-ttu-id="338f1-163">Para obtener más información, vea [identificadores de atributos de texto](uiauto-textattribute-ids.md).</span><span class="sxs-lookup"><span data-stu-id="338f1-163">For more information, see [Text Attribute Identifiers](uiauto-textattribute-ids.md).</span></span>

## <a name="performance"></a><span data-ttu-id="338f1-164">Rendimiento</span><span class="sxs-lookup"><span data-stu-id="338f1-164">Performance</span></span>

<span data-ttu-id="338f1-165">El patrón de control **Text** se basa en las llamadas entre procesos para la mayor parte de su funcionalidad, por lo que no proporciona un mecanismo de almacenamiento en caché para mejorar el rendimiento al procesar el contenido.</span><span class="sxs-lookup"><span data-stu-id="338f1-165">The **Text** control pattern relies on cross-process calls for most of its functionality, so it does not provide a caching mechanism to improve performance when it processes content.</span></span> <span data-ttu-id="338f1-166">Se puede tener acceso a otros patrones de control de la automatización de la interfaz de usuario de Microsoft mediante el método [**IUIAutomationElement:: GetCachedPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedpattern) .</span><span class="sxs-lookup"><span data-stu-id="338f1-166">Other control patterns in Microsoft UI Automation can be accessed by using the [**IUIAutomationElement::GetCachedPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedpattern) method.</span></span>

<span data-ttu-id="338f1-167">Una técnica para mejorar el rendimiento es asegurarse de que los clientes de automatización de la interfaz de usuario intenten recuperar bloques de texto de tamaño moderado mediante el método [**IUIAutomationTextRange:: gettext**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext) .</span><span class="sxs-lookup"><span data-stu-id="338f1-167">One technique for improving performance is to ensure that UI Automation clients attempt to retrieve moderately sized blocks of text by using the [**IUIAutomationTextRange::GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext) method.</span></span> <span data-ttu-id="338f1-168">Por ejemplo, el uso de **gettext** para recuperar caracteres individuales incurrirá en los resultados entre procesos para cada carácter, mientras que si no se especifica una longitud máxima cuando se llama a **gettext** , se producirá un acierto entre procesos, pero puede tener una latencia elevada según el tamaño del intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="338f1-168">For example, using **GetText** to retrieve single characters will incur cross-process hits for each character, whereas not specifying a maximum length when calling **GetText** will incur one cross-process hit, but can have high latency depending on the size of the text range.</span></span>

## <a name="text-pattern-and-virtualized-embedded-objects"></a><span data-ttu-id="338f1-169">Patrón de texto y objetos incrustados virtualizados</span><span class="sxs-lookup"><span data-stu-id="338f1-169">Text Pattern and Virtualized Embedded Objects</span></span>

<span data-ttu-id="338f1-170">Siempre que sea posible, una implementación de proveedor de [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) y [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) debe admitir todo el texto de un documento, incluido cualquier texto situado fuera de la ventanilla.</span><span class="sxs-lookup"><span data-stu-id="338f1-170">Whenever possible, a provider implementation of [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) and [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) should support the entire text of a document, including any text outside of the viewport.</span></span> <span data-ttu-id="338f1-171">En el caso de texto sin pantalla o de objetos incrustados que están virtualizados, los proveedores deben admitir el [patrón de control VirtualizedItem](uiauto-implementingvirtualizeditem.md) ([**IVirtualizedItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider)).</span><span class="sxs-lookup"><span data-stu-id="338f1-171">For off-screen text or embedded objects that are virtualized, providers should support the [VirtualizedItem control pattern](uiauto-implementingvirtualizeditem.md) ([**IVirtualizedItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider)).</span></span>

<span data-ttu-id="338f1-172">Si un documento está virtualizado mientras toda la secuencia de texto sigue disponible, la propiedad [**ITextProvider::D ocumentrange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange) recuperará un intervalo de texto que incluye todo el documento.</span><span class="sxs-lookup"><span data-stu-id="338f1-172">If a document is virtualized while the entire text stream is still available, the [**ITextProvider::DocumentRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange) property will retrieve a text range that includes the entire document.</span></span> <span data-ttu-id="338f1-173">Sin embargo, al llamar al método [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren) se recuperará una colección de objetos virtualizados que representan todos los objetos incrustados en el documento.</span><span class="sxs-lookup"><span data-stu-id="338f1-173">However, calling the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren) method will retrieve a collection of virtualized objects that represent all embedded objects in the document.</span></span> <span data-ttu-id="338f1-174">Para interactuar con un objeto incrustado virtualizado, los clientes deben llamar al método [**IVirtualizedItemProvider::**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivirtualizeditemprovider-realize) , que hace que los elementos sean totalmente accesibles como elementos de automatización de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="338f1-174">To interact with a virtualized embedded object, clients must call the [**IVirtualizedItemProvider::Realize**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivirtualizeditemprovider-realize) method, which makes the items fully accessible as UI Automation elements.</span></span> <span data-ttu-id="338f1-175">Los clientes deben seguir un proceso similar para trabajar con elementos de cuadrícula en una tabla incrustada en la que una parte de la tabla está fuera de la pantalla y virtualizada.</span><span class="sxs-lookup"><span data-stu-id="338f1-175">Clients must follow a similar process to work with grid elements in an embedded table where a portion of the table is off-screen and virtualized.</span></span>

## <a name="using-the-custom-control-type-with-the-text-control-pattern"></a><span data-ttu-id="338f1-176">Usar el tipo de control personalizado con el patrón de control Text</span><span class="sxs-lookup"><span data-stu-id="338f1-176">Using the Custom Control Type with the Text Control Pattern</span></span>

<span data-ttu-id="338f1-177">Aunque el patrón de control [Text](uiauto-implementingtextandtextrange.md) admite muchos atributos de texto y objetos incrustados, no es posible definir de antemano todos los posibles elementos de documento y tipos de presentación.</span><span class="sxs-lookup"><span data-stu-id="338f1-177">While the [Text](uiauto-implementingtextandtextrange.md) control pattern supports many text attributes and embedded objects, it is not possible to define in advance all possible document elements and presentation types.</span></span> <span data-ttu-id="338f1-178">En el caso de los elementos de documento que no son compatibles con los atributos existentes o los tipos de control estándar, los proveedores pueden usar las características de extensibilidad proporcionadas por el tipo de control **personalizado** de automatización de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="338f1-178">For document elements that are not supported by the existing attributes or standard control types, providers can use the extensibility features provided by the UI Automation **Custom** control type.</span></span>

<span data-ttu-id="338f1-179">En el caso de las aplicaciones y las interfaces de usuario basadas en presentaciones de páginas, el límite y la presentación de diseño de "página" también se pueden expresar como un objeto incrustado que tiene un tipo de control personalizado (es decir, `LocalizedControlType="page"` ).</span><span class="sxs-lookup"><span data-stu-id="338f1-179">For applications and user interfaces that are based on page presentations, the boundary and layout presentation of "page" can also be expressed as an embedded object that has a custom control type (that is, `LocalizedControlType="page"`).</span></span> <span data-ttu-id="338f1-180">De este modo, el objeto incrustado puede hospedar otros elementos de página que no pueden formar parte fácilmente de la secuencia de texto del documento, como los campos de encabezado y de pie de página de cada página, como elementos secundarios del objeto incrustado de la "página".</span><span class="sxs-lookup"><span data-stu-id="338f1-180">That way, the embedded object can host other page elements that cannot easily be part of the document text stream, such as the header and footer fields of each page, as children of the "page" embedded object.</span></span> <span data-ttu-id="338f1-181">Como alternativa, cada objeto de "página" puede admitir el patrón de control de [texto](uiauto-implementingtextandtextrange.md) de forma independiente, lo que funciona bien con aplicaciones como herramientas de creación para presentaciones de presentación o entornos de publicación de escritorio basados en páginas.</span><span class="sxs-lookup"><span data-stu-id="338f1-181">Alternatively, each "page" object can support the [Text](uiauto-implementingtextandtextrange.md) control pattern independently, which works well for applications such as authoring tools for slide show presentations, or page-based desktop publishing environments.</span></span>

## <a name="lifetime-of-a-text-range"></a><span data-ttu-id="338f1-182">Duración de un intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="338f1-182">Lifetime of a Text Range</span></span>

<span data-ttu-id="338f1-183">Si es posible, un proveedor debe asegurarse de que cualquier cambio de texto, como eliminaciones, inserciones y movimientos, se refleja en el intervalo de texto asociado.</span><span class="sxs-lookup"><span data-stu-id="338f1-183">If possible, a provider should ensure that any text changes, such as deletions, insertions, and moves, are reflected in the associated text range.</span></span> <span data-ttu-id="338f1-184">Si no es posible actualizar el intervalo de texto, el proveedor debe generar un evento de [**\_ \_ TextChangedEventId de texto de UIA**](uiauto-event-ids.md) para notificar a los clientes que el intervalo de texto ya no es válido y se debe recuperar uno nuevo.</span><span class="sxs-lookup"><span data-stu-id="338f1-184">If updating the text range is not possible, the provider should raise a [**UIA\_Text\_TextChangedEventId**](uiauto-event-ids.md) event to notify clients that the text range is no longer valid and a new one must be retrieved.</span></span>

## <a name="related-topics"></a><span data-ttu-id="338f1-185">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="338f1-185">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="338f1-186">**Vista**</span><span class="sxs-lookup"><span data-stu-id="338f1-186">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="338f1-187">Cómo la automatización de la interfaz de usuario admite objetos incrustados</span><span class="sxs-lookup"><span data-stu-id="338f1-187">How UI Automation Supports Embedded Objects</span></span>](uiauto-textpattern-and-embedded-objects-overview.md)
</dt> <dt>

[<span data-ttu-id="338f1-188">Información general acerca de los patrones de control de UI Automation</span><span class="sxs-lookup"><span data-stu-id="338f1-188">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="338f1-189">Compatibilidad de UI Automation para el contenido textual</span><span class="sxs-lookup"><span data-stu-id="338f1-189">UI Automation Support for Textual Content</span></span>](uiauto-ui-automation-textpattern-overview.md)
</dt> <dt>

[<span data-ttu-id="338f1-190">Trabajar con controles basados en texto</span><span class="sxs-lookup"><span data-stu-id="338f1-190">Working with Text-based Controls</span></span>](uiauto-workingwithtextbasedcontrols.md)
</dt> <dt>

<span data-ttu-id="338f1-191">**Otros recursos**</span><span class="sxs-lookup"><span data-stu-id="338f1-191">**Other Resources**</span></span>
</dt> <dt>

[<span data-ttu-id="338f1-192">Text Services Framework (TSF)</span><span class="sxs-lookup"><span data-stu-id="338f1-192">Text Services Framework</span></span>](/windows/desktop/TSF/text-services-framework)
</dt> </dl>

 

 