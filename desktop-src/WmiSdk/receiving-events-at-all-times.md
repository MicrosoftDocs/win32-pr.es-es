---
description: Es posible que desee escribir una aplicación que pueda reaccionar a los eventos en cualquier momento.
ms.assetid: 475dca47-b1e5-4362-ab00-9ab9383e92f9
ms.tgt_platform: multiple
title: Recepción de eventos en todo momento
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5559068e1e108c6f4185c31f8858a9e4169c50c9
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104360545"
---
# <a name="receiving-events-at-all-times"></a><span data-ttu-id="35fe8-103">Recepción de eventos en todo momento</span><span class="sxs-lookup"><span data-stu-id="35fe8-103">Receiving Events at All Times</span></span>

<span data-ttu-id="35fe8-104">Es posible que desee escribir una aplicación que pueda reaccionar a los eventos en cualquier momento.</span><span class="sxs-lookup"><span data-stu-id="35fe8-104">You may want to write an application that can react to events at any time.</span></span> <span data-ttu-id="35fe8-105">Por ejemplo, es posible que un administrador desee recibir un mensaje de correo electrónico cuando las medidas de rendimiento específicas disminuyan en los servidores de red.</span><span class="sxs-lookup"><span data-stu-id="35fe8-105">For example, an administrator may want to receive an email message when specific performance measures decline on network servers.</span></span> <span data-ttu-id="35fe8-106">En este caso, la aplicación debe ejecutarse en todo momento.</span><span class="sxs-lookup"><span data-stu-id="35fe8-106">In this case, your application should run at all times.</span></span> <span data-ttu-id="35fe8-107">Sin embargo, la ejecución continua de una aplicación no es un uso eficaz de los recursos del sistema.</span><span class="sxs-lookup"><span data-stu-id="35fe8-107">However, running an application continuously is not an efficient use of system resources.</span></span> <span data-ttu-id="35fe8-108">En su lugar, WMI le permite crear un consumidor de eventos permanente.</span><span class="sxs-lookup"><span data-stu-id="35fe8-108">Instead, WMI allows you to create a permanent event consumer.</span></span> <span data-ttu-id="35fe8-109">Los consumidores de eventos permanentes deben cumplir requisitos de seguridad especiales.</span><span class="sxs-lookup"><span data-stu-id="35fe8-109">Permanent event consumers must meet special security requirements.</span></span> <span data-ttu-id="35fe8-110">Para obtener más información, consulte [protección de eventos WMI](securing-wmi-events.md).</span><span class="sxs-lookup"><span data-stu-id="35fe8-110">For more information, see [Securing WMI Events](securing-wmi-events.md).</span></span>

<span data-ttu-id="35fe8-111">Un consumidor de eventos permanente recibe eventos hasta que su registro se cancela explícitamente.</span><span class="sxs-lookup"><span data-stu-id="35fe8-111">A permanent event consumer receives events until its registration is explicitly canceled.</span></span>

<span data-ttu-id="35fe8-112">Un consumidor de eventos permanente es una combinación de las siguientes clases, filtros y objetos COM de WMI que residen en el sistema:</span><span class="sxs-lookup"><span data-stu-id="35fe8-112">A permanent event consumer is a combination of the following WMI classes, filters, and COM objects that reside on your system:</span></span>

-   <span data-ttu-id="35fe8-113">Objeto COM denominado consumidor físico.</span><span class="sxs-lookup"><span data-stu-id="35fe8-113">A COM object called a physical consumer.</span></span> <span data-ttu-id="35fe8-114">WMI proporciona varios consumidores permanentes estándar.</span><span class="sxs-lookup"><span data-stu-id="35fe8-114">WMI supplies several standard permanent consumers.</span></span> <span data-ttu-id="35fe8-115">Por ejemplo, el consumidor de eventos Active script [ejecuta un script cuando se produce un evento](running-a-script-based-on-an-event.md).</span><span class="sxs-lookup"><span data-stu-id="35fe8-115">For example, the Active Script Event consumer [runs a script when an event occurs](running-a-script-based-on-an-event.md).</span></span>
-   <span data-ttu-id="35fe8-116">Nueva clase de consumidor permanente.</span><span class="sxs-lookup"><span data-stu-id="35fe8-116">A new permanent consumer class.</span></span>
-   <span data-ttu-id="35fe8-117">Instancia de la clase de consumidor permanente denominada consumidor lógico.</span><span class="sxs-lookup"><span data-stu-id="35fe8-117">An instance of the permanent consumer class called a logical consumer.</span></span>
-   <span data-ttu-id="35fe8-118">Filtro que contiene la consulta de eventos.</span><span class="sxs-lookup"><span data-stu-id="35fe8-118">A filter that contains the query for events.</span></span>
-   <span data-ttu-id="35fe8-119">Una vinculación entre el consumidor y el filtro.</span><span class="sxs-lookup"><span data-stu-id="35fe8-119">A linkage between the consumer and the filter.</span></span>

<span data-ttu-id="35fe8-120">Las propiedades de un consumidor de eventos lógicos especifican las acciones que se deben realizar cuando se notifica un evento, pero no definen las consultas de eventos con las que están asociadas.</span><span class="sxs-lookup"><span data-stu-id="35fe8-120">The properties of a logical event consumer specify the actions to perform when notified of an event, but do not define the event queries with which they are associated.</span></span> <span data-ttu-id="35fe8-121">Cuando se señala, WMI carga automáticamente el objeto COM que representa el consumidor de eventos permanente en la memoria activa.</span><span class="sxs-lookup"><span data-stu-id="35fe8-121">When signaled, WMI automatically loads the COM object that represents the permanent event consumer into active memory.</span></span> <span data-ttu-id="35fe8-122">Normalmente, esto sucede durante el inicio o en respuesta a un evento desencadenador.</span><span class="sxs-lookup"><span data-stu-id="35fe8-122">Typically, this occurs during startup or in response to a triggering event.</span></span> <span data-ttu-id="35fe8-123">Tras su activación, el consumidor de eventos permanente actúa como un consumidor de eventos normal, pero permanece hasta que el sistema operativo ha descargado de forma específica.</span><span class="sxs-lookup"><span data-stu-id="35fe8-123">After being activated, the permanent event consumer acts as a normal event consumer, but remains until specifically unloaded by the operating system.</span></span>

<span data-ttu-id="35fe8-124">Puede escribir su propio consumidor de eventos permanente o usar las [clases de consumidor estándar](standard-consumer-classes.md)preinstaladas de WMI, como [**ActiveScriptEventConsumer**](activescripteventconsumer.md).</span><span class="sxs-lookup"><span data-stu-id="35fe8-124">You can write your own permanent event consumer or use the WMI preinstalled [Standard Consumer Classes](standard-consumer-classes.md), such as [**ActiveScriptEventConsumer**](activescripteventconsumer.md).</span></span> <span data-ttu-id="35fe8-125">Para obtener más información, vea [clases de consumidor estándar](standard-consumer-classes.md), [supervisión y respuesta a eventos con consumidores estándar](monitoring-and-responding-to-events-with-standard-consumers.md)y [eventos de supervisión](monitoring-events.md).</span><span class="sxs-lookup"><span data-stu-id="35fe8-125">For more information, see [Standard Consumer Classes](standard-consumer-classes.md), [Monitoring and Responding to Events with Standard Consumers](monitoring-and-responding-to-events-with-standard-consumers.md), and [Monitoring Events](monitoring-events.md).</span></span>

<span data-ttu-id="35fe8-126">En el procedimiento siguiente se describe cómo crear su propio consumidor de eventos permanente.</span><span class="sxs-lookup"><span data-stu-id="35fe8-126">The following procedure describes how to create your own permanent event consumer.</span></span>

<span data-ttu-id="35fe8-127">**Para crear su propio consumidor de eventos permanente**</span><span class="sxs-lookup"><span data-stu-id="35fe8-127">**To create your own permanent event consumer**</span></span>

1.  <span data-ttu-id="35fe8-128">Determine qué tipo de eventos desea recibir.</span><span class="sxs-lookup"><span data-stu-id="35fe8-128">Determine what kind of events you want to receive.</span></span>

    <span data-ttu-id="35fe8-129">WMI admite eventos intrínsecos y extrínsecos.</span><span class="sxs-lookup"><span data-stu-id="35fe8-129">WMI supports intrinsic and extrinsic events.</span></span> <span data-ttu-id="35fe8-130">Un evento intrínseco es un evento predefinido por WMI, mientras que un evento extrínseco es un evento definido por un proveedor de terceros.</span><span class="sxs-lookup"><span data-stu-id="35fe8-130">An intrinsic event is an event predefined by WMI, whereas an extrinsic event is an event defined by a third party provider.</span></span> <span data-ttu-id="35fe8-131">Para obtener más información, vea [determinar el tipo de evento que se va a recibir](determining-the-type-of-event-to-receive.md).</span><span class="sxs-lookup"><span data-stu-id="35fe8-131">For more information, see [Determining the Type of Event to Receive](determining-the-type-of-event-to-receive.md).</span></span>

2.  <span data-ttu-id="35fe8-132">[Implemente un consumidor físico](implementing-a-physical-consumer.md).</span><span class="sxs-lookup"><span data-stu-id="35fe8-132">[Implement a physical consumer](implementing-a-physical-consumer.md).</span></span>

    <span data-ttu-id="35fe8-133">La diferencia principal entre una aplicación de administración y un [*consumidor físico*](gloss-p.md) es que un usuario carga y descarga una aplicación de administración, mientras que WMI carga y descarga un consumidor físico.</span><span class="sxs-lookup"><span data-stu-id="35fe8-133">The main difference between a management application and a [*physical consumer*](gloss-p.md) is that a user loads and unloads a management application, whereas WMI loads and unloads a physical consumer.</span></span> <span data-ttu-id="35fe8-134">La mayor parte del código debe estar en el consumidor físico.</span><span class="sxs-lookup"><span data-stu-id="35fe8-134">Most of your coding should be in the physical consumer.</span></span>

    > [!Note]  
    > <span data-ttu-id="35fe8-135">Este paso es el primero en el procedimiento para facilitar la explicación.</span><span class="sxs-lookup"><span data-stu-id="35fe8-135">This step is first in the procedure for ease of explanation.</span></span> <span data-ttu-id="35fe8-136">En cuanto a la codificación, debe crear el consumidor físico en último lugar.</span><span class="sxs-lookup"><span data-stu-id="35fe8-136">In terms of coding, you should actually create the physical consumer last.</span></span> <span data-ttu-id="35fe8-137">De este modo, puede diseñar los parámetros y la lógica para su proveedor de eventos permanente antes de comenzar la codificación larga.</span><span class="sxs-lookup"><span data-stu-id="35fe8-137">That way you can lay out your parameters and logic for your permanent event provider before you start lengthy coding.</span></span> <span data-ttu-id="35fe8-138">Sin embargo, no hay ninguna restricción sobre la escritura del consumidor físico en primer lugar.</span><span class="sxs-lookup"><span data-stu-id="35fe8-138">However, there is no restriction against writing the physical consumer first.</span></span>

     

3.  <span data-ttu-id="35fe8-139">[Cree una nueva clase de consumidor que describa el consumidor físico](creating-a-new-permanent-event-consumer-class.md).</span><span class="sxs-lookup"><span data-stu-id="35fe8-139">[Create a new consumer class describing the physical consumer](creating-a-new-permanent-event-consumer-class.md).</span></span>

    <span data-ttu-id="35fe8-140">Como cualquier clase, la clase de consumidor describe los parámetros generales de un consumidor de eventos permanente en WMI.</span><span class="sxs-lookup"><span data-stu-id="35fe8-140">Like any class, the consumer class describes the general parameters of a permanent event consumer to WMI.</span></span>

4.  <span data-ttu-id="35fe8-141">[Cree una instancia de la clase Consumer](creating-a-logical-consumer.md).</span><span class="sxs-lookup"><span data-stu-id="35fe8-141">[Create an instance of the consumer class](creating-a-logical-consumer.md).</span></span>

    <span data-ttu-id="35fe8-142">Al igual que cualquier otra clase WMI, debe crear una instancia de la clase Consumer si desea implementar la clase.</span><span class="sxs-lookup"><span data-stu-id="35fe8-142">Like any other WMI class, you must create an instance of the consumer class if you want to implement the class.</span></span> <span data-ttu-id="35fe8-143">Una instancia de una clase de consumidor también se conoce como [*consumidor lógico*](gloss-l.md).</span><span class="sxs-lookup"><span data-stu-id="35fe8-143">An instance of a consumer class is also known as a [*logical consumer*](gloss-l.md).</span></span> <span data-ttu-id="35fe8-144">El consumidor lógico representa al consumidor físico en WMI.</span><span class="sxs-lookup"><span data-stu-id="35fe8-144">The logical consumer represents the physical consumer to WMI.</span></span>

5.  <span data-ttu-id="35fe8-145">[Cree un filtro de eventos](creating-an-event-filter.md).</span><span class="sxs-lookup"><span data-stu-id="35fe8-145">[Create an event filter](creating-an-event-filter.md).</span></span>

    <span data-ttu-id="35fe8-146">Las consultas de eventos que activan consumidores de eventos permanentes se denominan [*filtros de eventos*](gloss-e.md).</span><span class="sxs-lookup"><span data-stu-id="35fe8-146">The event queries that activate permanent event consumers are called [*event filters*](gloss-e.md).</span></span> <span data-ttu-id="35fe8-147">Un filtro de evento único se puede asociar a varios consumidores de eventos lógicos.</span><span class="sxs-lookup"><span data-stu-id="35fe8-147">A single event filter can be associated with multiple logical event consumers.</span></span> <span data-ttu-id="35fe8-148">Además, se pueden asociar varios filtros de eventos a un único consumidor de eventos lógicos.</span><span class="sxs-lookup"><span data-stu-id="35fe8-148">Furthermore, multiple event filters can be associated with a single logical event consumer.</span></span> <span data-ttu-id="35fe8-149">El filtro es una instancia de [**\_ \_ EventFilter**](--eventfilter.md).</span><span class="sxs-lookup"><span data-stu-id="35fe8-149">The filter is an instance of [**\_\_EventFilter**](--eventfilter.md).</span></span>

    <span data-ttu-id="35fe8-150">Un evento de registro NT se genera cuando se produce un error en la consulta del consumidor de eventos permanente.</span><span class="sxs-lookup"><span data-stu-id="35fe8-150">An NT Log event is generated when a permanent event consumer's query fails.</span></span> <span data-ttu-id="35fe8-151">El origen del evento es WinMgmt, el ID. de evento es 10 y el tipo de evento es error.</span><span class="sxs-lookup"><span data-stu-id="35fe8-151">The event's source is WinMgmt, the event ID is 10, and the event type is Error.</span></span>

6.  <span data-ttu-id="35fe8-152">[Vincule el filtro de eventos al consumidor lógico](binding-an-event-filter-with-a-logical-consumer.md).</span><span class="sxs-lookup"><span data-stu-id="35fe8-152">[Link the event filter to the logical consumer](binding-an-event-filter-with-a-logical-consumer.md).</span></span>

    <span data-ttu-id="35fe8-153">Al vincular el filtro de eventos al consumidor lógico, se indica a WMI sobre qué filtro de eventos pertenece al consumidor lógico.</span><span class="sxs-lookup"><span data-stu-id="35fe8-153">By linking the event filter to the logical consumer, you instruct WMI about which event filter belongs to which logical consumer.</span></span> <span data-ttu-id="35fe8-154">Los consumidores de eventos lógicos y los filtros de eventos están vinculados por una instancia de clase de Asociación de [**\_ \_ FilterToConsumerBinding**](--filtertoconsumerbinding.md).</span><span class="sxs-lookup"><span data-stu-id="35fe8-154">Logical event consumers and event filters are linked by an association class instance of [**\_\_FilterToConsumerBinding**](--filtertoconsumerbinding.md).</span></span> <span data-ttu-id="35fe8-155">Cuando se recibe un evento que coincide con una consulta de evento descrita en un filtro de eventos, WMI busca el consumidor de eventos lógicos asociado examinando la instancia de la clase de asociación.</span><span class="sxs-lookup"><span data-stu-id="35fe8-155">When an event is received that matches an event query described in an event filter, WMI finds the associated logical event consumer by looking at the association class instance.</span></span> <span data-ttu-id="35fe8-156">Una vez que se encuentra la instancia del consumidor de eventos lógicos, WMI utiliza una instancia de la clase [**\_ \_ EventConsumerProviderRegistration**](--eventconsumerproviderregistration.md) para buscar y ejecutar el consumidor de eventos físicos asociado a esta instancia.</span><span class="sxs-lookup"><span data-stu-id="35fe8-156">After the logical event consumer instance is located, WMI uses an instance of the [**\_\_EventConsumerProviderRegistration**](--eventconsumerproviderregistration.md) class to locate and run the physical event consumer associated with this instance.</span></span>

7.  <span data-ttu-id="35fe8-157">[Escribir un proveedor de consumidor de eventos](writing-an-event-consumer-provider.md).</span><span class="sxs-lookup"><span data-stu-id="35fe8-157">[Writing an event consumer provider](writing-an-event-consumer-provider.md).</span></span>

    <span data-ttu-id="35fe8-158">El proveedor del consumidor de eventos es un objeto COM que busca el consumidor físico para WMI.</span><span class="sxs-lookup"><span data-stu-id="35fe8-158">The event consumer provider is a COM object that locates the physical consumer for WMI.</span></span>

 

 



