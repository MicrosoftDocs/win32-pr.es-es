---
description: Diagramas de vistas de tráfico de red para un bloqueo oportunista de nivel 1, un bloqueo oportunista de lotes y un bloqueo oportunista de filtro.
ms.assetid: 78830113-b18e-40c7-8ec4-8896dbc58030
title: Ejemplos de bloqueos oportunistas
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ae8b8a0c5b04897ddc2fc8f2e3bdec20f2fdb02d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "104545710"
---
# <a name="opportunistic-lock-examples"></a><span data-ttu-id="49fef-103">Ejemplos de bloqueos oportunistas</span><span class="sxs-lookup"><span data-stu-id="49fef-103">Opportunistic Lock Examples</span></span>

<span data-ttu-id="49fef-104">En los ejemplos siguientes se muestran datos y movimientos de mensajes SMB, ya que se realizan bloqueos oportunistas y se rompen.</span><span class="sxs-lookup"><span data-stu-id="49fef-104">The following examples show data and SMB message movements as opportunistic locks are made and broken.</span></span> <span data-ttu-id="49fef-105">Tenga en cuenta que los clientes pueden almacenar en caché datos de atributos de archivos, así como datos de archivos.</span><span class="sxs-lookup"><span data-stu-id="49fef-105">Note that clients can cache file attribute data as well as file data.</span></span>

<span data-ttu-id="49fef-106">Tenga en cuenta también que estos ejemplos se basan en situaciones en las que las aplicaciones cliente solicitan bloqueos oportunistas desde servidores remotos.</span><span class="sxs-lookup"><span data-stu-id="49fef-106">Also note that these examples are based on situations where client applications are requesting opportunistic locks from remote servers.</span></span> <span data-ttu-id="49fef-107">Estos procesos los inicia automáticamente el redirector de red y el servidor remoto; no hay ninguna implicación directa por parte de la aplicación o aplicaciones cliente.</span><span class="sxs-lookup"><span data-stu-id="49fef-107">These processes are automatically initiated by the network redirector and the remote server—there is no direct involvement by the client application or applications.</span></span> <span data-ttu-id="49fef-108">Los procesos descritos en estos ejemplos se pueden generalizar en situaciones en las que las aplicaciones cliente locales están solicitando directamente bloqueos oportunistas del sistema de archivos local, con la excepción de que no interviene el intercambio de datos a través de la red.</span><span class="sxs-lookup"><span data-stu-id="49fef-108">The processes described by these examples can be generalized into situations where local client applications are directly requesting opportunistic locks from the local file system, with the exception that no exchange of data over the network is involved.</span></span>

## <a name="level-1-opportunistic-lock"></a><span data-ttu-id="49fef-109">Bloqueo oportunista de nivel 1</span><span class="sxs-lookup"><span data-stu-id="49fef-109">Level 1 Opportunistic Lock</span></span>

<span data-ttu-id="49fef-110">En el diagrama siguiente se muestra una vista de tráfico de red de un bloqueo oportunista de nivel 1 en un archivo.</span><span class="sxs-lookup"><span data-stu-id="49fef-110">The following diagram shows a network-traffic view of a level 1 opportunistic lock on a file.</span></span> <span data-ttu-id="49fef-111">Las flechas indican la dirección del movimiento de datos, si existe.</span><span class="sxs-lookup"><span data-stu-id="49fef-111">The arrows indicate the direction of data movement, if any.</span></span>



| <span data-ttu-id="49fef-112">Evento</span><span class="sxs-lookup"><span data-stu-id="49fef-112">Event</span></span> | <span data-ttu-id="49fef-113">Cliente X</span><span class="sxs-lookup"><span data-stu-id="49fef-113">Client X</span></span>                                          | <span data-ttu-id="49fef-114">Servidor</span><span class="sxs-lookup"><span data-stu-id="49fef-114">Server</span></span>                                   | <span data-ttu-id="49fef-115">Cliente Y</span><span class="sxs-lookup"><span data-stu-id="49fef-115">Client Y</span></span>                                          |
|-------|---------------------------------------------------|------------------------------------------|---------------------------------------------------|
| <span data-ttu-id="49fef-116">1</span><span class="sxs-lookup"><span data-stu-id="49fef-116">1</span></span>     | <span data-ttu-id="49fef-117">Abre el archivo, nivel de solicitudes 1 Lock = =></span><span class="sxs-lookup"><span data-stu-id="49fef-117">Opens file, requests level 1 lock ==></span></span>          |                                          |                                                   |
| <span data-ttu-id="49fef-118">2</span><span class="sxs-lookup"><span data-stu-id="49fef-118">2</span></span>     |                                                   | <span data-ttu-id="49fef-119"><= = concede un bloqueo oportunista de nivel 1</span><span class="sxs-lookup"><span data-stu-id="49fef-119"><== Grants level 1 opportunistic lock</span></span> |                                                   |
| <span data-ttu-id="49fef-120">3</span><span class="sxs-lookup"><span data-stu-id="49fef-120">3</span></span>     | <span data-ttu-id="49fef-121">Realiza operaciones de lectura, escritura y otras = =></span><span class="sxs-lookup"><span data-stu-id="49fef-121">Performs read, write, and other operations ==></span></span> |                                          |                                                   |
| <span data-ttu-id="49fef-122">4</span><span class="sxs-lookup"><span data-stu-id="49fef-122">4</span></span>     |                                                   |                                          | <span data-ttu-id="49fef-123"><= = solicitudes para abrir el archivo</span><span class="sxs-lookup"><span data-stu-id="49fef-123"><== Requests to open file</span></span>                      |
| <span data-ttu-id="49fef-124">5</span><span class="sxs-lookup"><span data-stu-id="49fef-124">5</span></span>     |                                                   | <span data-ttu-id="49fef-125"><= = interrumpe el bloqueo oportunista</span><span class="sxs-lookup"><span data-stu-id="49fef-125"><== Breaks opportunistic lock</span></span>         |                                                   |
| <span data-ttu-id="49fef-126">6</span><span class="sxs-lookup"><span data-stu-id="49fef-126">6</span></span>     | <span data-ttu-id="49fef-127">Descarta los datos de lectura previa</span><span class="sxs-lookup"><span data-stu-id="49fef-127">Discards read-ahead data</span></span>                          |                                          |                                                   |
| <span data-ttu-id="49fef-128">7</span><span class="sxs-lookup"><span data-stu-id="49fef-128">7</span></span>     | <span data-ttu-id="49fef-129">Escribe Data = =></span><span class="sxs-lookup"><span data-stu-id="49fef-129">Writes data ==></span></span>                                |                                          |                                                   |
| <span data-ttu-id="49fef-130">8</span><span class="sxs-lookup"><span data-stu-id="49fef-130">8</span></span>     | <span data-ttu-id="49fef-131">Envía el mensaje "CLOSE" o "Done" = =></span><span class="sxs-lookup"><span data-stu-id="49fef-131">Sends "close" or "done" message ==></span></span>            |                                          |                                                   |
| <span data-ttu-id="49fef-132">9</span><span class="sxs-lookup"><span data-stu-id="49fef-132">9</span></span>     |                                                   | <span data-ttu-id="49fef-133">Correcto operación de apertura = =></span><span class="sxs-lookup"><span data-stu-id="49fef-133">Okays open operation ==></span></span>              |                                                   |
| <span data-ttu-id="49fef-134">10</span><span class="sxs-lookup"><span data-stu-id="49fef-134">10</span></span>    | <span data-ttu-id="49fef-135">Realiza operaciones de lectura, escritura y otras = =></span><span class="sxs-lookup"><span data-stu-id="49fef-135">Performs read, write, and other operations ==></span></span> |                                          | <span data-ttu-id="49fef-136"><= = realiza operaciones de lectura, escritura y otras.</span><span class="sxs-lookup"><span data-stu-id="49fef-136"><== Performs read, write, and other operations</span></span> |



 

<span data-ttu-id="49fef-137">En el evento 1, el cliente X abre un archivo y, como parte de la operación de apertura, solicita un bloqueo oportunista de nivel 1 en el archivo.</span><span class="sxs-lookup"><span data-stu-id="49fef-137">In event 1, client X opens a file and as part of the open operation requests a level 1 opportunistic lock on the file.</span></span> <span data-ttu-id="49fef-138">En el evento 2, el servidor concede el bloqueo de nivel 1 porque ningún otro cliente tiene abierto el archivo.</span><span class="sxs-lookup"><span data-stu-id="49fef-138">In event 2, the server grants the level 1 lock because no other client has the file open.</span></span> <span data-ttu-id="49fef-139">El cliente continúa accediendo al archivo de la manera habitual en el evento 3.</span><span class="sxs-lookup"><span data-stu-id="49fef-139">The client proceeds to access the file in the usual manner in event 3.</span></span>

<span data-ttu-id="49fef-140">En el evento 4, el cliente Y intenta abrir el archivo y solicita un bloqueo oportunista.</span><span class="sxs-lookup"><span data-stu-id="49fef-140">In event 4, client Y attempts to open the file and requests an opportunistic lock.</span></span> <span data-ttu-id="49fef-141">El servidor ve que el cliente X tiene el archivo abierto.</span><span class="sxs-lookup"><span data-stu-id="49fef-141">The server sees that client X has the file open.</span></span> <span data-ttu-id="49fef-142">El servidor omite la solicitud de Y, mientras que el cliente X vacía los datos de escritura y abandona su caché de lectura para el archivo.</span><span class="sxs-lookup"><span data-stu-id="49fef-142">The server ignores Y's request while client X flushes any write data and abandons its read cache for the file.</span></span>

<span data-ttu-id="49fef-143">El servidor fuerza la limpieza de X mediante el envío de a X un mensaje SMB que interrumpa el bloqueo oportunista, el evento 5.</span><span class="sxs-lookup"><span data-stu-id="49fef-143">The server forces X to clean up by sending to X an SMB message breaking the opportunistic lock, event 5.</span></span> <span data-ttu-id="49fef-144">El cliente X "silenciosamente" descarta cualquier dato de lectura previa; en otras palabras, este proceso no genera tráfico de red.</span><span class="sxs-lookup"><span data-stu-id="49fef-144">Client X "silently" discards any read-ahead data; in other words, this process generates no network traffic.</span></span> <span data-ttu-id="49fef-145">En el evento 7, el cliente X escribe los datos escritos en caché en el servidor.</span><span class="sxs-lookup"><span data-stu-id="49fef-145">In event 7, client X writes any cached write data to the server.</span></span> <span data-ttu-id="49fef-146">Cuando el cliente X ha terminado de escribir los datos en caché en el servidor, el cliente X envía un mensaje "cerrar" o "listo" al servidor, evento 8.</span><span class="sxs-lookup"><span data-stu-id="49fef-146">When client X is done writing cached data to the server, client X sends either a "close" or a "done" message to the server, event 8.</span></span>

<span data-ttu-id="49fef-147">Una vez que se ha notificado al servidor que el cliente X ha terminado de vaciar la memoria caché de escritura en el servidor o ha cerrado el archivo, el servidor puede abrir el archivo para el cliente Y, en el evento 9.</span><span class="sxs-lookup"><span data-stu-id="49fef-147">After the server has been notified that client X is done flushing its write cache to the server or has closed the file, then the server can open the file for client Y, in event 9.</span></span> <span data-ttu-id="49fef-148">Dado que ahora el servidor tiene dos clientes con el mismo archivo abierto, concede un bloqueo oportunista a ninguno.</span><span class="sxs-lookup"><span data-stu-id="49fef-148">Because the server now has two clients with the same file open, it grants an opportunistic lock to neither.</span></span> <span data-ttu-id="49fef-149">Ambos clientes continúan leyendo desde el archivo y uno o ninguno de los dos escribe en el archivo.</span><span class="sxs-lookup"><span data-stu-id="49fef-149">Both clients proceed to read from the file, and one or neither writes to the file.</span></span>

## <a name="batch-opportunistic-lock"></a><span data-ttu-id="49fef-150">Bloqueo oportunista de Batch</span><span class="sxs-lookup"><span data-stu-id="49fef-150">Batch Opportunistic Lock</span></span>

<span data-ttu-id="49fef-151">En el diagrama siguiente se muestra una vista de tráfico de red de un bloqueo oportunista de batch.</span><span class="sxs-lookup"><span data-stu-id="49fef-151">The following diagram shows a network-traffic view of a batch opportunistic lock.</span></span> <span data-ttu-id="49fef-152">Las flechas indican la dirección del movimiento de datos, si existe.</span><span class="sxs-lookup"><span data-stu-id="49fef-152">The arrows indicate the direction of data movement, if any.</span></span>



| <span data-ttu-id="49fef-153">Evento</span><span class="sxs-lookup"><span data-stu-id="49fef-153">Event</span></span> | <span data-ttu-id="49fef-154">Cliente X</span><span class="sxs-lookup"><span data-stu-id="49fef-154">Client X</span></span>                               | <span data-ttu-id="49fef-155">Servidor</span><span class="sxs-lookup"><span data-stu-id="49fef-155">Server</span></span>                                 | <span data-ttu-id="49fef-156">Cliente Y</span><span class="sxs-lookup"><span data-stu-id="49fef-156">Client Y</span></span>                                          |
|-------|----------------------------------------|----------------------------------------|---------------------------------------------------|
| <span data-ttu-id="49fef-157">1</span><span class="sxs-lookup"><span data-stu-id="49fef-157">1</span></span>     | <span data-ttu-id="49fef-158">Abre el archivo, requests batch Lock = =></span><span class="sxs-lookup"><span data-stu-id="49fef-158">Opens file, requests batch lock ==></span></span> |                                        |                                                   |
| <span data-ttu-id="49fef-159">2</span><span class="sxs-lookup"><span data-stu-id="49fef-159">2</span></span>     |                                        | <span data-ttu-id="49fef-160"><= = concede el bloqueo oportunista de Batch</span><span class="sxs-lookup"><span data-stu-id="49fef-160"><== Grants batch opportunistic lock</span></span> |                                                   |
| <span data-ttu-id="49fef-161">3</span><span class="sxs-lookup"><span data-stu-id="49fef-161">3</span></span>     | <span data-ttu-id="49fef-162">Lee archivo = =></span><span class="sxs-lookup"><span data-stu-id="49fef-162">Reads file ==></span></span>                      |                                        |                                                   |
| <span data-ttu-id="49fef-163">4</span><span class="sxs-lookup"><span data-stu-id="49fef-163">4</span></span>     |                                        | <span data-ttu-id="49fef-164"><= = envía datos</span><span class="sxs-lookup"><span data-stu-id="49fef-164"><== Sends data</span></span>                      |                                                   |
| <span data-ttu-id="49fef-165">5</span><span class="sxs-lookup"><span data-stu-id="49fef-165">5</span></span>     | <span data-ttu-id="49fef-166">Cierra el archivo</span><span class="sxs-lookup"><span data-stu-id="49fef-166">Closes file</span></span>                            |                                        |                                                   |
| <span data-ttu-id="49fef-167">6</span><span class="sxs-lookup"><span data-stu-id="49fef-167">6</span></span>     | <span data-ttu-id="49fef-168">Abre el archivo</span><span class="sxs-lookup"><span data-stu-id="49fef-168">Opens file</span></span>                             |                                        |                                                   |
| <span data-ttu-id="49fef-169">7</span><span class="sxs-lookup"><span data-stu-id="49fef-169">7</span></span>     | <span data-ttu-id="49fef-170">Busca datos</span><span class="sxs-lookup"><span data-stu-id="49fef-170">Searches for data</span></span>                      |                                        |                                                   |
| <span data-ttu-id="49fef-171">8</span><span class="sxs-lookup"><span data-stu-id="49fef-171">8</span></span>     | <span data-ttu-id="49fef-172">Lee Data = =></span><span class="sxs-lookup"><span data-stu-id="49fef-172">Reads data ==></span></span>                      |                                        |                                                   |
| <span data-ttu-id="49fef-173">9</span><span class="sxs-lookup"><span data-stu-id="49fef-173">9</span></span>     |                                        | <span data-ttu-id="49fef-174"><= = envía datos</span><span class="sxs-lookup"><span data-stu-id="49fef-174"><== Sends data</span></span>                      |                                                   |
| <span data-ttu-id="49fef-175">10</span><span class="sxs-lookup"><span data-stu-id="49fef-175">10</span></span>    | <span data-ttu-id="49fef-176">Cierra el archivo</span><span class="sxs-lookup"><span data-stu-id="49fef-176">Closes file</span></span>                            |                                        |                                                   |
| <span data-ttu-id="49fef-177">11</span><span class="sxs-lookup"><span data-stu-id="49fef-177">11</span></span>    |                                        |                                        | <span data-ttu-id="49fef-178"><= = abre el archivo</span><span class="sxs-lookup"><span data-stu-id="49fef-178"><== Opens file</span></span>                                 |
| <span data-ttu-id="49fef-179">12</span><span class="sxs-lookup"><span data-stu-id="49fef-179">12</span></span>    |                                        | <span data-ttu-id="49fef-180"><= = interrumpe el bloqueo oportunista</span><span class="sxs-lookup"><span data-stu-id="49fef-180"><== Breaks opportunistic lock</span></span>       |                                                   |
| <span data-ttu-id="49fef-181">13</span><span class="sxs-lookup"><span data-stu-id="49fef-181">13</span></span>    | <span data-ttu-id="49fef-182">Cierra File = =></span><span class="sxs-lookup"><span data-stu-id="49fef-182">Closes file ==></span></span>                     |                                        |                                                   |
| <span data-ttu-id="49fef-183">14</span><span class="sxs-lookup"><span data-stu-id="49fef-183">14</span></span>    |                                        | <span data-ttu-id="49fef-184">Correcto operación de apertura = =></span><span class="sxs-lookup"><span data-stu-id="49fef-184">Okays open operation ==></span></span>            |                                                   |
| <span data-ttu-id="49fef-185">15</span><span class="sxs-lookup"><span data-stu-id="49fef-185">15</span></span>    |                                        |                                        | <span data-ttu-id="49fef-186"><= = realiza operaciones de lectura, escritura y otras.</span><span class="sxs-lookup"><span data-stu-id="49fef-186"><== Performs read, write, and other operations</span></span> |



 

<span data-ttu-id="49fef-187">En el bloqueo oportunista de batch, el cliente X abre un archivo, el evento 1 y el servidor concede al cliente X un bloqueo por lotes en el evento 2.</span><span class="sxs-lookup"><span data-stu-id="49fef-187">In the batch opportunistic lock, client X opens a file, event 1, and the server grants client X a batch lock in event 2.</span></span> <span data-ttu-id="49fef-188">Client X intenta leer datos, evento 3, a los que el servidor responde con datos, evento 4.</span><span class="sxs-lookup"><span data-stu-id="49fef-188">Client X attempts to read data, event 3, to which the server responds with data, event 4.</span></span>

<span data-ttu-id="49fef-189">El evento 5 muestra el bloqueo oportunista de batch en el trabajo.</span><span class="sxs-lookup"><span data-stu-id="49fef-189">Event 5 shows the batch opportunistic lock at work.</span></span> <span data-ttu-id="49fef-190">La aplicación en el cliente X cierra el archivo.</span><span class="sxs-lookup"><span data-stu-id="49fef-190">The application on Client X closes the file.</span></span> <span data-ttu-id="49fef-191">Sin embargo, el redirector de red filtra la operación de cierre y no transmite un mensaje de cierre, con lo que se realiza un cierre "silencioso".</span><span class="sxs-lookup"><span data-stu-id="49fef-191">However, the network redirector filters out the close operation and does not transmit a close message, thus performing a "silent" close.</span></span> <span data-ttu-id="49fef-192">El redirector de red puede hacer esto porque el cliente X tiene propiedad exclusiva del archivo.</span><span class="sxs-lookup"><span data-stu-id="49fef-192">The network redirector can do this because client X has sole ownership of the file.</span></span> <span data-ttu-id="49fef-193">Más adelante, en el evento 6, la aplicación vuelve a abrir el archivo.</span><span class="sxs-lookup"><span data-stu-id="49fef-193">Later on, in event 6, the application reopens the file.</span></span> <span data-ttu-id="49fef-194">De nuevo, ningún flujo de datos fluye a través de la red.</span><span class="sxs-lookup"><span data-stu-id="49fef-194">Again, no data flows across the network.</span></span> <span data-ttu-id="49fef-195">En lo que respecta al servidor, este cliente ha tenido abierto el archivo desde el evento 2.</span><span class="sxs-lookup"><span data-stu-id="49fef-195">As far as the server is concerned, this client has had the file open since event 2.</span></span>

<span data-ttu-id="49fef-196">Los eventos 7, 8 y 9 muestran el curso habitual del tráfico de red.</span><span class="sxs-lookup"><span data-stu-id="49fef-196">Events 7, 8, and 9 show the usual course of network traffic.</span></span> <span data-ttu-id="49fef-197">En el evento 10, se produce otro cierre silencioso.</span><span class="sxs-lookup"><span data-stu-id="49fef-197">In event 10, another silent close occurs.</span></span>

<span data-ttu-id="49fef-198">En el evento 11, el cliente Y intenta abrir el archivo.</span><span class="sxs-lookup"><span data-stu-id="49fef-198">In event 11, client Y attempts to open the file.</span></span> <span data-ttu-id="49fef-199">La vista del archivo del servidor es que el cliente X lo tiene abierto, aunque la aplicación en el cliente X la ha cerrado.</span><span class="sxs-lookup"><span data-stu-id="49fef-199">The server's view of the file is that client X has it open, even though the application on client X has closed it.</span></span> <span data-ttu-id="49fef-200">Por lo tanto, el servidor envía un mensaje que interrumpe el bloqueo oportunista al cliente X. Client X envía ahora el mensaje de cierre a través de la red, evento 13.</span><span class="sxs-lookup"><span data-stu-id="49fef-200">Therefore, the server sends an a message breaking the opportunistic lock to client X. Client X now sends the close message across the network, event 13.</span></span> <span data-ttu-id="49fef-201">El evento 14 sigue a medida que el servidor abre el archivo para el cliente Y. La aplicación en el cliente X ha cerrado el archivo, por lo que no realiza más transferencias hacia o desde el servidor para ese archivo.</span><span class="sxs-lookup"><span data-stu-id="49fef-201">Event 14 follows as the server opens the file for client Y. The application on client X has closed the file, so it does no more transfers to or from the server for that file.</span></span> <span data-ttu-id="49fef-202">El cliente Y comienza las transferencias de datos como de costumbre en el evento 15.</span><span class="sxs-lookup"><span data-stu-id="49fef-202">Client Y begins data transfers as usual in event 15.</span></span>

<span data-ttu-id="49fef-203">Entre el momento en que el cliente X se le concede el bloqueo en el archivo en el evento 2 y el cierre final en el evento 13, los datos de archivos que el cliente ha almacenado en caché son válidos, a pesar de las operaciones de apertura y cierre de la aplicación que intervienen.</span><span class="sxs-lookup"><span data-stu-id="49fef-203">Between the time client X is granted the lock on the file in event 2 and the final close at event 13, any file data that the client has cached is valid, in spite of the intervening application open and close operations.</span></span> <span data-ttu-id="49fef-204">Sin embargo, una vez interrumpido el bloqueo oportunista, los datos almacenados en caché no se pueden considerar válidos.</span><span class="sxs-lookup"><span data-stu-id="49fef-204">However, after the opportunistic lock is broken, cached data cannot be considered valid.</span></span>

## <a name="filter-opportunistic-lock"></a><span data-ttu-id="49fef-205">Filtrar bloqueo oportunista</span><span class="sxs-lookup"><span data-stu-id="49fef-205">Filter Opportunistic Lock</span></span>

<span data-ttu-id="49fef-206">En el diagrama siguiente se muestra una vista de tráfico de red de un bloqueo oportunista de filtro.</span><span class="sxs-lookup"><span data-stu-id="49fef-206">The following diagram shows a network-traffic view of a filter opportunistic lock.</span></span> <span data-ttu-id="49fef-207">Las flechas indican la dirección del movimiento de datos, si existe.</span><span class="sxs-lookup"><span data-stu-id="49fef-207">The arrows indicate the direction of data movement, if any.</span></span>



| <span data-ttu-id="49fef-208">Evento</span><span class="sxs-lookup"><span data-stu-id="49fef-208">Event</span></span> | <span data-ttu-id="49fef-209">Cliente X</span><span class="sxs-lookup"><span data-stu-id="49fef-209">Client X</span></span>                                | <span data-ttu-id="49fef-210">Servidor</span><span class="sxs-lookup"><span data-stu-id="49fef-210">Server</span></span>                   | <span data-ttu-id="49fef-211">Cliente Y</span><span class="sxs-lookup"><span data-stu-id="49fef-211">Client Y</span></span>                    |
|-------|-----------------------------------------|--------------------------|-----------------------------|
| <span data-ttu-id="49fef-212">1</span><span class="sxs-lookup"><span data-stu-id="49fef-212">1</span></span>     | <span data-ttu-id="49fef-213">Abre el archivo sin derechos de acceso = =></span><span class="sxs-lookup"><span data-stu-id="49fef-213">Opens file with no access rights ==></span></span> |                          |                             |
| <span data-ttu-id="49fef-214">2</span><span class="sxs-lookup"><span data-stu-id="49fef-214">2</span></span>     |                                         | <span data-ttu-id="49fef-215"><= = abre el archivo</span><span class="sxs-lookup"><span data-stu-id="49fef-215"><== Opens the file</span></span>    |                             |
| <span data-ttu-id="49fef-216">3</span><span class="sxs-lookup"><span data-stu-id="49fef-216">3</span></span>     | <span data-ttu-id="49fef-217">Filtro de solicitudes Lock = =></span><span class="sxs-lookup"><span data-stu-id="49fef-217">Requests filter lock==></span></span>              |                          |                             |
| <span data-ttu-id="49fef-218">4</span><span class="sxs-lookup"><span data-stu-id="49fef-218">4</span></span>     |                                         | <span data-ttu-id="49fef-219"><= = concede el bloqueo</span><span class="sxs-lookup"><span data-stu-id="49fef-219"><== Grants lock</span></span>       |                             |
| <span data-ttu-id="49fef-220">5</span><span class="sxs-lookup"><span data-stu-id="49fef-220">5</span></span>     | <span data-ttu-id="49fef-221">Abre el archivo para lectura = =></span><span class="sxs-lookup"><span data-stu-id="49fef-221">Opens file for reading ==></span></span>           |                          |                             |
| <span data-ttu-id="49fef-222">6</span><span class="sxs-lookup"><span data-stu-id="49fef-222">6</span></span>     |                                         | <span data-ttu-id="49fef-223"><= = vuelve a abrir el archivo</span><span class="sxs-lookup"><span data-stu-id="49fef-223"><== Reopens the file</span></span>  |                             |
| <span data-ttu-id="49fef-224">7</span><span class="sxs-lookup"><span data-stu-id="49fef-224">7</span></span>     | <span data-ttu-id="49fef-225">Lee datos mediante el identificador de lectura = =></span><span class="sxs-lookup"><span data-stu-id="49fef-225">Reads data using the read handle ==></span></span> |                          |                             |
| <span data-ttu-id="49fef-226">8</span><span class="sxs-lookup"><span data-stu-id="49fef-226">8</span></span>     |                                         | <span data-ttu-id="49fef-227"><= = envía datos</span><span class="sxs-lookup"><span data-stu-id="49fef-227"><== Sends data</span></span>        |                             |
| <span data-ttu-id="49fef-228">9</span><span class="sxs-lookup"><span data-stu-id="49fef-228">9</span></span>     |                                         | <span data-ttu-id="49fef-229"><= = envía datos</span><span class="sxs-lookup"><span data-stu-id="49fef-229"><== Sends data</span></span>        |                             |
| <span data-ttu-id="49fef-230">10</span><span class="sxs-lookup"><span data-stu-id="49fef-230">10</span></span>    |                                         | <span data-ttu-id="49fef-231"><= = envía datos</span><span class="sxs-lookup"><span data-stu-id="49fef-231"><== Sends data</span></span>        |                             |
| <span data-ttu-id="49fef-232">11</span><span class="sxs-lookup"><span data-stu-id="49fef-232">11</span></span>    |                                         |                          | <span data-ttu-id="49fef-233"><= = abre el archivo</span><span class="sxs-lookup"><span data-stu-id="49fef-233"><== Opens the file</span></span>       |
| <span data-ttu-id="49fef-234">12</span><span class="sxs-lookup"><span data-stu-id="49fef-234">12</span></span>    |                                         | <span data-ttu-id="49fef-235">Abre el archivo = =></span><span class="sxs-lookup"><span data-stu-id="49fef-235">Opens the file ==></span></span>    |                             |
| <span data-ttu-id="49fef-236">13</span><span class="sxs-lookup"><span data-stu-id="49fef-236">13</span></span>    |                                         |                          | <span data-ttu-id="49fef-237"><= = bloqueo de filtrado de solicitudes</span><span class="sxs-lookup"><span data-stu-id="49fef-237"><== Requests filter lock</span></span> |
| <span data-ttu-id="49fef-238">14</span><span class="sxs-lookup"><span data-stu-id="49fef-238">14</span></span>    |                                         | <span data-ttu-id="49fef-239">Deniega el bloqueo de filtro = =></span><span class="sxs-lookup"><span data-stu-id="49fef-239">Denies filter lock==></span></span> |                             |
| <span data-ttu-id="49fef-240">15</span><span class="sxs-lookup"><span data-stu-id="49fef-240">15</span></span>    |                                         |                          | <span data-ttu-id="49fef-241"><= = lee datos</span><span class="sxs-lookup"><span data-stu-id="49fef-241"><== Reads data</span></span>           |
| <span data-ttu-id="49fef-242">16</span><span class="sxs-lookup"><span data-stu-id="49fef-242">16</span></span>    |                                         | <span data-ttu-id="49fef-243">Envía Data = =></span><span class="sxs-lookup"><span data-stu-id="49fef-243">Sends data ==></span></span>        |                             |
| <span data-ttu-id="49fef-244">17</span><span class="sxs-lookup"><span data-stu-id="49fef-244">17</span></span>    | <span data-ttu-id="49fef-245">Lee datos (almacenados en caché)</span><span class="sxs-lookup"><span data-stu-id="49fef-245">Reads (cached) data</span></span>                     |                          |                             |
| <span data-ttu-id="49fef-246">18</span><span class="sxs-lookup"><span data-stu-id="49fef-246">18</span></span>    | <span data-ttu-id="49fef-247">Cierra File = =></span><span class="sxs-lookup"><span data-stu-id="49fef-247">Closes file ==></span></span>                      |                          |                             |
| <span data-ttu-id="49fef-248">19</span><span class="sxs-lookup"><span data-stu-id="49fef-248">19</span></span>    |                                         |                          | <span data-ttu-id="49fef-249"><= = cierra el archivo</span><span class="sxs-lookup"><span data-stu-id="49fef-249"><== Closes file</span></span>          |



 

<span data-ttu-id="49fef-250">En el bloqueo oportunista de filtro, el cliente X abre un archivo, el evento 1 y el servidor responde en el evento 2.</span><span class="sxs-lookup"><span data-stu-id="49fef-250">In the filter opportunistic lock, client X opens a file, event 1, and the server responds in event 2.</span></span> <span data-ttu-id="49fef-251">Después, el cliente solicita un bloqueo oportunista de filtro en el evento 3, seguido del servidor que concede el bloqueo oportunista en el evento 4.</span><span class="sxs-lookup"><span data-stu-id="49fef-251">The client then requests a filter opportunistic lock in event 3, followed by the server granting the opportunistic lock in event 4.</span></span> <span data-ttu-id="49fef-252">El cliente X vuelve a abrir el archivo para leerlo en el evento 5, al que el servidor responde en el evento 6.</span><span class="sxs-lookup"><span data-stu-id="49fef-252">Client X then opens the file again for reading in event 5, to which the server responds in event 6.</span></span> <span data-ttu-id="49fef-253">Después, el cliente intenta leer los datos, a los que el servidor responde con datos, evento 8.</span><span class="sxs-lookup"><span data-stu-id="49fef-253">The client then attempts to read data, to which the server responds with data, event 8.</span></span>

<span data-ttu-id="49fef-254">El evento 9 muestra el bloqueo oportunista de filtro en el trabajo.</span><span class="sxs-lookup"><span data-stu-id="49fef-254">Event 9 shows the filter opportunistic lock at work.</span></span> <span data-ttu-id="49fef-255">El servidor se lee por la delantera del cliente y envía los datos a través de la red, aunque el cliente no lo haya solicitado.</span><span class="sxs-lookup"><span data-stu-id="49fef-255">The server reads ahead of the client and sends the data over the network even though the client has not requested it.</span></span> <span data-ttu-id="49fef-256">El cliente almacena en caché los datos.</span><span class="sxs-lookup"><span data-stu-id="49fef-256">The client caches the data.</span></span> <span data-ttu-id="49fef-257">En el evento 10, el servidor también anticipa una solicitud futura de datos y envía otra parte del archivo para que el cliente lo almacene en la memoria caché.</span><span class="sxs-lookup"><span data-stu-id="49fef-257">In event 10, the server also anticipates a future request for data and sends another portion of the file for the client to cache.</span></span>

<span data-ttu-id="49fef-258">En el evento 11 y 12, otro cliente, Y, abre el archivo.</span><span class="sxs-lookup"><span data-stu-id="49fef-258">In event 11 and 12, another client, Y, opens the file.</span></span> <span data-ttu-id="49fef-259">El cliente Y también solicita un bloqueo oportunista de filtro.</span><span class="sxs-lookup"><span data-stu-id="49fef-259">Client Y also requests a filter opportunistic lock.</span></span> <span data-ttu-id="49fef-260">En el evento 14, el servidor lo deniega.</span><span class="sxs-lookup"><span data-stu-id="49fef-260">In event 14, the server denies it.</span></span> <span data-ttu-id="49fef-261">En el evento 15, el cliente Y solicita los datos, que el servidor envía en el evento 16.</span><span class="sxs-lookup"><span data-stu-id="49fef-261">In event 15, client Y requests data, which the server sends in event 16.</span></span> <span data-ttu-id="49fef-262">Ninguno de esto afecta a Client X. En cualquier momento, otro cliente puede abrir este archivo para el acceso de lectura.</span><span class="sxs-lookup"><span data-stu-id="49fef-262">None of this affects client X. At any time, another client can open this file for read access.</span></span> <span data-ttu-id="49fef-263">Ningún otro cliente afecta al bloqueo del filtro del cliente X.</span><span class="sxs-lookup"><span data-stu-id="49fef-263">No other client affects client X's filter lock.</span></span>

<span data-ttu-id="49fef-264">El evento 17 muestra los datos de lectura del cliente X.</span><span class="sxs-lookup"><span data-stu-id="49fef-264">Event 17 shows client X reading data.</span></span> <span data-ttu-id="49fef-265">Sin embargo, dado que el servidor ya ha enviado los datos y el cliente los ha almacenado en la memoria caché, ningún tráfico cruza la red.</span><span class="sxs-lookup"><span data-stu-id="49fef-265">However, because the server has already sent the data and the client has cached it, no traffic crosses the network.</span></span>

<span data-ttu-id="49fef-266">En este ejemplo, el cliente X nunca intenta leer todos los datos del archivo, por lo que la lectura anticipada indicada por los eventos 9 y 10 está "desperdiciada"; es decir, los datos nunca se utilizan realmente.</span><span class="sxs-lookup"><span data-stu-id="49fef-266">In this example, client X never tries to read all the data in the file, so the read-ahead indicated by events 9 and 10 is "wasted"; that is, the data is never actually used.</span></span> <span data-ttu-id="49fef-267">Se trata de una pérdida aceptable porque la lectura previa sped la aplicación.</span><span class="sxs-lookup"><span data-stu-id="49fef-267">This is an acceptable loss because the read-ahead has sped up the application.</span></span>

<span data-ttu-id="49fef-268">En el evento 18, el cliente X cierra el archivo.</span><span class="sxs-lookup"><span data-stu-id="49fef-268">In event 18, client X closes the file.</span></span> <span data-ttu-id="49fef-269">El redirector de red del cliente abandona los datos almacenados en caché.</span><span class="sxs-lookup"><span data-stu-id="49fef-269">The client's network redirector abandons the cached data.</span></span> <span data-ttu-id="49fef-270">El servidor cierra el archivo.</span><span class="sxs-lookup"><span data-stu-id="49fef-270">The server closes the file.</span></span>

 

 



