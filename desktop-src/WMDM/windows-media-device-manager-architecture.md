---
title: Arquitectura de Administrador de dispositivos de Windows Media
description: Arquitectura de Administrador de dispositivos de Windows Media
ms.assetid: 3c1b2da4-559d-427b-b502-5ef8dc055a8e
keywords:
- Windows Media Administrador de dispositivos, arquitectura
- Administrador de dispositivos, arquitectura
- arquitectura para Windows Media Administrador de dispositivos
- Windows Media Administrador de dispositivos, aplicaciones de escritorio
- Administrador de dispositivos, aplicaciones de escritorio
- Windows Media Administrador de dispositivos, proveedores de servicios
- Administrador de dispositivos, proveedores de servicios
- Administrador de dispositivos de Windows Media, Complementos
- Administrador de dispositivos, Complementos
- aplicaciones de escritorio, arquitectura de Administrador de dispositivos de Windows Media
- proveedores de servicios, arquitectura de Administrador de dispositivos de Windows Media
- complementos, arquitectura de Administrador de dispositivos de Windows Media
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9fda87e4ed4bce2c82bbb9c0863c119851965940
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/16/2019
ms.locfileid: "104268504"
---
# <a name="windows-media-device-manager-architecture"></a><span data-ttu-id="647e9-115">Arquitectura de Administrador de dispositivos de Windows Media</span><span class="sxs-lookup"><span data-stu-id="647e9-115">Windows Media Device Manager Architecture</span></span>

<span data-ttu-id="647e9-116">Windows Media Administrador de dispositivos permite que una aplicación o un complemento se comuniquen con un dispositivo.</span><span class="sxs-lookup"><span data-stu-id="647e9-116">Windows Media Device Manager enables an application or plug-in to communicate with a device.</span></span> <span data-ttu-id="647e9-117">Las aplicaciones pueden solicitar metadatos de dispositivos, enumerar y explorar dispositivos conectados, y enviar o recibir objetos (carpetas, archivos, listas de reproducción, etc.).</span><span class="sxs-lookup"><span data-stu-id="647e9-117">Applications can request device metadata, enumerate and explore attached devices, and send or receive objects (folders, files, playlists, and so on).</span></span> <span data-ttu-id="647e9-118">Windows Media Administrador de dispositivos proporciona una única API a la aplicación que realiza la llamada, independientemente del tipo de dispositivo al que se llame (clase de almacenamiento de MTP o de almacenamiento masivo, proveedores de servicios creados en la versión 10 o proveedores de servicios creados en versiones anteriores de Windows Media Administrador de dispositivos).</span><span class="sxs-lookup"><span data-stu-id="647e9-118">Windows Media Device Manager provides a single API to the calling application, no matter what type of device is being called (MTP or Mass Storage Class, service providers built on version 10 or service providers built on earlier versions of Windows Media Device Manager).</span></span>

<span data-ttu-id="647e9-119">Windows Media Administrador de dispositivos actúa como un paso entre los tres componentes principales del sistema: la aplicación, que realiza solicitudes (para obtener información, para leer o escribir datos, etc.); un proveedor de contenido seguro, que es un componente que controla la comunicación con archivos protegidos con DRM; y un proveedor de servicios, que recibe solicitudes de la aplicación y se comunica con el dispositivo para realizar estas solicitudes.</span><span class="sxs-lookup"><span data-stu-id="647e9-119">Windows Media Device Manager acts as a go-between for the three major components of the system: the application, which makes requests (for information, to read or write data, and so on); a secure content provider, which is a component that handles communication with DRM-protected files; and a service provider, which receives requests from the application and communicates with the device to perform these requests.</span></span> <span data-ttu-id="647e9-120">Tanto la aplicación como el proveedor de servicios se basan en el SDK de Administrador de dispositivos de Windows Media.</span><span class="sxs-lookup"><span data-stu-id="647e9-120">Both the application and the service provider are built on the Windows Media Device Manager SDK.</span></span>

<span data-ttu-id="647e9-121">En el diagrama siguiente se muestra cómo una aplicación de escritorio se comunica con un dispositivo mediante Windows Media Administrador de dispositivos 11.</span><span class="sxs-lookup"><span data-stu-id="647e9-121">The following diagram shows how a desktop application communicates with a device using Windows Media Device Manager 11.</span></span>

![diagrama que muestra una aplicación que se comunica con cuatro tipos diferentes de dispositivos.](images/wmdm-device-communication.gif)

<span data-ttu-id="647e9-123">En el diagrama anterior se muestra una aplicación que se comunica con cuatro tipos diferentes de dispositivos, cada uno con su propio proveedor de servicios.</span><span class="sxs-lookup"><span data-stu-id="647e9-123">The preceding diagram shows an application communicating with four different types of devices, each with its own service provider.</span></span> <span data-ttu-id="647e9-124">Todos los proveedores de servicios están diseñados para comunicarse con un tipo específico de dispositivo; en este diagrama se muestran los tres proveedores de servicios proporcionados por Microsoft (controladores de clases genéricas para dispositivos de clase de almacenamiento masivo, dispositivos RAPI y dispositivos MTP), así como un proveedor de servicios personalizado para un dispositivo propietario creado por terceros.</span><span class="sxs-lookup"><span data-stu-id="647e9-124">Every service provider is designed to communicate with a specific type of device; this diagram shows the three Microsoft-provided service providers (generic class drivers for Mass Storage Class devices, RAPI devices, and MTP devices), as well as a custom service provider for a proprietary device built by a third party.</span></span> <span data-ttu-id="647e9-125">Cuando se conecta un dispositivo, Windows Media Administrador de dispositivos crea instancias de una instancia del proveedor de servicios registrada para ese dispositivo.</span><span class="sxs-lookup"><span data-stu-id="647e9-125">When a device connects, Windows Media Device Manager instantiates an instance of the service provider registered for that device.</span></span> <span data-ttu-id="647e9-126">Los proveedores de servicios obtienen solicitudes de la aplicación a través de las interfaces de Windows Media Administrador de dispositivos que implementan, usan los controladores adecuados para comunicarse con el dispositivo y devuelven los resultados adecuados.</span><span class="sxs-lookup"><span data-stu-id="647e9-126">The service providers get requests from the application through Windows Media Device Manager interfaces that they implement, use appropriate drivers to communicate with the device, and return appropriate results.</span></span> <span data-ttu-id="647e9-127">La comunicación entre el proveedor de servicios y el dispositivo está fuera del dominio de Windows Media Administrador de dispositivos.</span><span class="sxs-lookup"><span data-stu-id="647e9-127">Communication between the service provider and the device is outside the domain of Windows Media Device Manager.</span></span>

<span data-ttu-id="647e9-128">Los proveedores de servicios son invisibles para la aplicación; una aplicación solo ve una lista de "dispositivos" porque Windows Media Administrador de dispositivos expone un conjunto estándar de métodos e interfaces para todos los dispositivos.</span><span class="sxs-lookup"><span data-stu-id="647e9-128">Service providers are invisible to the application; an application sees only a list of "devices" because Windows Media Device Manager exposes a standard set of methods and interfaces for all devices.</span></span> <span data-ttu-id="647e9-129">Si un fabricante crea un proveedor de servicios personalizado, debe administrar todos los métodos estándar de Windows Media Administrador de dispositivos si las aplicaciones van a poder usar el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="647e9-129">If a manufacturer creates a custom service provider, it must handle all the standard Windows Media Device Manager methods if applications are to be able to use the device.</span></span>

<span data-ttu-id="647e9-130">En este diagrama también se muestra un módulo de proveedor de contenido seguro (SCP).</span><span class="sxs-lookup"><span data-stu-id="647e9-130">This diagram also shows a secure content provider (SCP) module.</span></span> <span data-ttu-id="647e9-131">Este módulo es responsable de administrar el contenido protegido de administración de derechos digitales (DRM).</span><span class="sxs-lookup"><span data-stu-id="647e9-131">This module is responsible for handling digital rights management (DRM) protected content.</span></span> <span data-ttu-id="647e9-132">Microsoft proporciona un módulo SCP que puede controlar archivos WMA y WMV protegidos con DRM.</span><span class="sxs-lookup"><span data-stu-id="647e9-132">Microsoft provides an SCP module that can handle DRM-protected WMA and WMV files.</span></span> <span data-ttu-id="647e9-133">Si una aplicación o un dispositivo intenta controlar otros formatos protegidos, debe proporcionar su propio módulo SCP.</span><span class="sxs-lookup"><span data-stu-id="647e9-133">If an application or device intends to handle other protected formats, it must provide its own SCP module.</span></span> <span data-ttu-id="647e9-134">Ni la aplicación ni el proveedor de servicios tratan directamente con el SCP.</span><span class="sxs-lookup"><span data-stu-id="647e9-134">Neither the application nor the service provider deals with the SCP directly.</span></span>

<span data-ttu-id="647e9-135">Tanto la aplicación como el proveedor de servicios se basan en Windows Media Administrador de dispositivos, que enruta las llamadas entre la aplicación y el proveedor de servicios adecuado para un dispositivo. el proveedor de servicios es responsable de la comunicación directa con el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="647e9-135">Both the application and the service provider are built on Windows Media Device Manager, which routes calls between the application and the appropriate service provider for a device; the service provider is responsible for communicating directly with the device.</span></span> <span data-ttu-id="647e9-136">Windows Media Administrador de dispositivos realiza algunas acciones (por ejemplo, enumerar dispositivos conectados, llamadas de enrutamiento y controlar la comprobación de componentes); sin embargo, la mayor parte del trabajo lo realiza el proveedor de servicios, que recibe las solicitudes de la aplicación y se comunica con el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="647e9-136">Windows Media Device Manager does perform some actions itself (such as enumerating connected devices, routing calls, and handling component verification); however, most of the work is done by the service provider, which receives requests from the application and communicates with the device.</span></span>

<span data-ttu-id="647e9-137">Una aplicación basada en Windows Media Administrador de dispositivos puede comunicarse con dispositivos y proveedores de servicios creados en versiones anteriores de Windows Media Administrador de dispositivos; sin embargo, estos dispositivos anteriores se ejecutarán a través de los componentes de la serie 9 (no se muestra) y no admitirán las características más recientes, especialmente la tecnología de administración de derechos digitales más avanzada.</span><span class="sxs-lookup"><span data-stu-id="647e9-137">An application built on Windows Media Device Manager can communicate with devices and service providers built on earlier versions of Windows Media Device Manager; however, these older devices will be run through 9 Series components (not shown), and will not support the newest features, particularly the more advanced digital rights management technology.</span></span>

<span data-ttu-id="647e9-138">Arquitectura de un dispositivo</span><span class="sxs-lookup"><span data-stu-id="647e9-138">Architecture of a Device</span></span>

<span data-ttu-id="647e9-139">En el diagrama siguiente se muestra una jerarquía simplificada de dispositivos y almacenamientos tal como la ve una aplicación mediante Windows Media Administrador de dispositivos.</span><span class="sxs-lookup"><span data-stu-id="647e9-139">The following diagram shows a simplified hierarchy of devices and storages as seen by an application using Windows Media Device Manager.</span></span>

![diagrama que muestra los almacenamientos en un dispositivo.](images/wmdm-basic-device-layout.gif)

<span data-ttu-id="647e9-141">En el diagrama anterior se muestra una versión simplificada de una unidad flash conectada, como se ve en una aplicación de Windows Media Administrador de dispositivos.</span><span class="sxs-lookup"><span data-stu-id="647e9-141">The preceding diagram shows a simplified version of a connected flash drive, as seen by a Windows Media Device Manager application.</span></span> <span data-ttu-id="647e9-142">La unidad Flash tiene atributos y propiedades, como un número de serie y configuraciones de formato admitidas.</span><span class="sxs-lookup"><span data-stu-id="647e9-142">The flash drive has attributes and properties, such as a serial number and supported format configurations.</span></span> <span data-ttu-id="647e9-143">Un elemento secundario inmediato del dispositivo Flash es el objeto de almacenamiento raíz, que contiene una carpeta, que contiene una imagen y una canción.</span><span class="sxs-lookup"><span data-stu-id="647e9-143">An immediate child of the flash device is the root storage object, which contains a folder, which itself contains an image and a song.</span></span>

<span data-ttu-id="647e9-144">Una aplicación enumera la lista de dispositivos conectados llamando a un método de enumeración expuesto por la interfaz raíz [**IWMDeviceManager**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdevicemanager) .</span><span class="sxs-lookup"><span data-stu-id="647e9-144">An application enumerates the list of attached devices by calling an enumeration method exposed by the root [**IWMDeviceManager**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdevicemanager) interface.</span></span> <span data-ttu-id="647e9-145">Los dispositivos se representan mediante una interfaz [**IWMDMDevice**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmdevice) (o derivada).</span><span class="sxs-lookup"><span data-stu-id="647e9-145">Devices are represented by an [**IWMDMDevice**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmdevice) (or a derived) interface.</span></span> <span data-ttu-id="647e9-146">Esta interfaz expone métodos para recuperar el nombre del dispositivo, las capacidades de formato, el número de serie, etc., así como un método que enumera los *almacenamientos* en el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="647e9-146">This interface exposes methods to retrieve the device name, format capabilities, serial number, and so on, as well as a method that enumerates *storages* on the device.</span></span> <span data-ttu-id="647e9-147">En Windows Media Administrador de dispositivos, un almacenamiento es cualquier tipo de objeto en el dispositivo, ya sea un BLOB de datos real.</span><span class="sxs-lookup"><span data-stu-id="647e9-147">In Windows Media Device Manager, a storage is any kind of object on the device, whether or not it is an actual blob of data.</span></span> <span data-ttu-id="647e9-148">Por ejemplo: los archivos de audio, los archivos de texto, las carpetas, las listas de reproducción almacenadas como archivos y las listas de reproducción almacenadas como metadatos se consideran almacenamientos, aunque es probable que las carpetas y los elementos de metadatos no representen un archivo físico.</span><span class="sxs-lookup"><span data-stu-id="647e9-148">For example: audio files, text files, folders, playlists stored as files, and playlists stored as metadata are all considered storages, even though folders and metadata items probably do not represent a physical file.</span></span> <span data-ttu-id="647e9-149">El tipo (o formato) de un almacenamiento se puede recuperar llamando a [**GetAttributes**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage-getattributes) (o [**GetMetadata**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage3-getmetadata), solicitando el formato del almacenamiento).</span><span class="sxs-lookup"><span data-stu-id="647e9-149">The type (or format) of a storage can be retrieved by calling [**GetAttributes**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage-getattributes) (or [**GetMetadata**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage3-getmetadata), requesting the format of the storage).</span></span>

<span data-ttu-id="647e9-150">Los almacenamientos de un dispositivo se almacenan jerárquicamente y todos los dispositivos tienen un almacenamiento raíz.</span><span class="sxs-lookup"><span data-stu-id="647e9-150">Storages on a device are stored hierarchically, and all devices have a root storage.</span></span> <span data-ttu-id="647e9-151">Cada almacenamiento puede contener cero o más objetos secundarios, enumerados mediante una llamada al método [**IWMDMStorage:: EnumStorage**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage-enumstorage) del almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="647e9-151">Each storage can hold zero or more child objects, enumerated by calling that storage's [**IWMDMStorage::EnumStorage**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage-enumstorage) method.</span></span>

<span data-ttu-id="647e9-152">Tenga en cuenta que cada almacenamiento del diagrama tiene atributos y metadatos asociados a él (no se muestran todos los valores).</span><span class="sxs-lookup"><span data-stu-id="647e9-152">Note that each storage in the diagram has attributes and metadata associated with it (not all values are shown).</span></span> <span data-ttu-id="647e9-153">Los atributos son simples, la información booleana a menudo describe la información de administración o navegación (como "tiene carpetas" o "se puede eliminar"), mientras que los metadatos pueden ser valores de cadena, números o información compleja (como capacidades de representación).</span><span class="sxs-lookup"><span data-stu-id="647e9-153">Attributes are simple, Boolean information often describing management or navigational information (such as "has folders" or "can delete"), whereas metadata can be string values, numbers, or complex information (such as rendering capabilities).</span></span> <span data-ttu-id="647e9-154">Los atributos se describen mediante un conjunto de marcas bastante limitado definido por el SDK y se recuperan mediante una llamada a [**IWMDMStorage:: GetAttributes**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage-getattributes) o [**IWMDMStorage2:: GetAttributes2**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage2-getattributes2).</span><span class="sxs-lookup"><span data-stu-id="647e9-154">Attributes are described by a fairly limited set of flags defined by the SDK and retrieved by calling [**IWMDMStorage::GetAttributes**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage-getattributes) or [**IWMDMStorage2::GetAttributes2**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage2-getattributes2).</span></span> <span data-ttu-id="647e9-155">Los valores de metadatos se recuperan mediante un nombre único; el SDK define una serie de valores de metadatos que los dispositivos deben admitir, pero los dispositivos pueden definir sus propias [constantes de metadatos](metadata-constants.md).</span><span class="sxs-lookup"><span data-stu-id="647e9-155">Metadata values are retrieved by a unique name; the SDK defines a number of metadata values that devices should support, but devices can define their own [metadata constants](metadata-constants.md).</span></span> <span data-ttu-id="647e9-156">Sin embargo, si un dispositivo o un proveedor de servicios define una nueva constante de metadatos, las aplicaciones no podrán solicitar o establecer este valor a menos que los desarrolladores de aplicaciones conozcan esta nueva constante.</span><span class="sxs-lookup"><span data-stu-id="647e9-156">However, if a device or service provider defines a new metadata constant, applications won't be able to request or set this value unless the application developers were aware of this new constant.</span></span> <span data-ttu-id="647e9-157">Un proveedor de servicios debe admitir [**IWMDMStorage3**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmstorage3) o posterior para admitir la recuperación o la configuración de metadatos.</span><span class="sxs-lookup"><span data-stu-id="647e9-157">A service provider must support [**IWMDMStorage3**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmstorage3) or later to support retrieving or setting metadata.</span></span> <span data-ttu-id="647e9-158">Para obtener más información, vea [obtener y establecer metadatos y atributos](getting-and-setting-metadata-and-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="647e9-158">For more information, see [Getting and Setting Metadata and Attributes](getting-and-setting-metadata-and-attributes.md).</span></span>

<span data-ttu-id="647e9-159">Proveedores de servicios</span><span class="sxs-lookup"><span data-stu-id="647e9-159">Service Providers</span></span>

<span data-ttu-id="647e9-160">El proveedor de servicios actúa como intermediario entre la aplicación y el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="647e9-160">The service provider acts as a middleman between the application and the device.</span></span> <span data-ttu-id="647e9-161">El proveedor de servicios es invisible para el desarrollador de la aplicación, por lo que un desarrollador de aplicaciones no necesita saber nada sobre el desarrollo de un proveedor de servicios.</span><span class="sxs-lookup"><span data-stu-id="647e9-161">The service provider is invisible to the application developer, so an application developer does not need to know anything about developing a service provider.</span></span> <span data-ttu-id="647e9-162">Sin embargo, es el proveedor de servicios el que realiza la comunicación con un dispositivo.</span><span class="sxs-lookup"><span data-stu-id="647e9-162">However, it is the service provider that does the work of communicating with a device.</span></span>

<span data-ttu-id="647e9-163">Un proveedor de servicios es un archivo DLL COM basado en Windows Media Administrador de dispositivos que recibe solicitudes de una aplicación y se comunica con el dispositivo para realizarlas.</span><span class="sxs-lookup"><span data-stu-id="647e9-163">A service provider is a COM DLL built on Windows Media Device Manager that receives requests from an application and communicates with the device to perform them.</span></span> <span data-ttu-id="647e9-164">La comunicación con la aplicación de escritorio se corrige con Windows Media Administrador de dispositivos; la comunicación con el dispositivo está bajo el control del proveedor de servicios.</span><span class="sxs-lookup"><span data-stu-id="647e9-164">Communication with the desktop application is mediated by Windows Media Device Manager; communication with the device is under the control of the service provider.</span></span>

<span data-ttu-id="647e9-165">Un proveedor de servicios recibe solicitudes de la aplicación para enumerar el contenido del dispositivo, las solicitudes de capacidades del dispositivo, las solicitudes de lectura o escritura de datos, etc.</span><span class="sxs-lookup"><span data-stu-id="647e9-165">A service provider receives requests from the application to enumerate device content, requests for device capabilities, requests to read or write data, and so on.</span></span> <span data-ttu-id="647e9-166">Debe conocer el diseño de un dispositivo lo suficiente para que pueda enviar comandos en el formato y protocolo adecuados.</span><span class="sxs-lookup"><span data-stu-id="647e9-166">It must know the design of a device well enough that it can send commands in the proper format and protocol.</span></span> <span data-ttu-id="647e9-167">También debe ser capaz de ocultar los requisitos específicos del dispositivo, como una extensión de archivo necesaria para las listas de reproducción, de modo que las aplicaciones no necesiten conocer estos requisitos para poder usar el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="647e9-167">It should also be able to hide device-specific requirements, such as a required file extension for playlists, so that applications do not need to know these requirements in order to use the device.</span></span>

<span data-ttu-id="647e9-168">Microsoft proporciona varios proveedores de servicios para los tipos de dispositivos estándar, incluidos los dispositivos MTP genéricos, los dispositivos de clase de almacenamiento masivo y los dispositivos RAPI.</span><span class="sxs-lookup"><span data-stu-id="647e9-168">Microsoft provides a number of service providers for standard device types, including generic MTP devices, Mass Storage Class devices, and RAPI devices.</span></span> <span data-ttu-id="647e9-169">La única razón por la que un diseñador de dispositivos debe crear un proveedor de servicios personalizado es si un dispositivo tiene algunos requisitos de almacenamiento de datos específicos o inusuales que los proveedores de servicios estándar no administran (por ejemplo, si los archivos deben almacenarse en ubicaciones específicas y el sistema operativo del dispositivo no lo controla automáticamente).</span><span class="sxs-lookup"><span data-stu-id="647e9-169">The only reason a device designer should need to create a custom service provider is if a device has some specific or unusual data storage requirements that the standard service providers do not handle—for instance, if files must be stored in specific locations and the device operating system does not handle this automatically.</span></span>

<span data-ttu-id="647e9-170">Cuando un dispositivo se conecta al equipo, el sistema operativo crea una instancia del proveedor de servicios adecuado para cada aplicación de Windows Media Administrador de dispositivos.</span><span class="sxs-lookup"><span data-stu-id="647e9-170">When a device is connected to the computer, the operating system creates one instance of the appropriate service provider for each Windows Media Device Manager application.</span></span> <span data-ttu-id="647e9-171">Si se inicia una segunda aplicación de Windows Media Administrador de dispositivos, se cargará una segunda instancia del proveedor de servicios.</span><span class="sxs-lookup"><span data-stu-id="647e9-171">If a second Windows Media Device Manager application starts, a second instance of the service provider will be loaded.</span></span> <span data-ttu-id="647e9-172">Sin embargo, cada proveedor de servicios puede administrar varios dispositivos.</span><span class="sxs-lookup"><span data-stu-id="647e9-172">However, each service provider can handle multiple devices.</span></span> <span data-ttu-id="647e9-173">En el diagrama siguiente se ilustra esto.</span><span class="sxs-lookup"><span data-stu-id="647e9-173">The following diagram illustrates this.</span></span>

![diagrama que muestra dos dispositivos MTP que se comunican con dos aplicaciones.](images/wmdm-sp-to-device.gif)

<span data-ttu-id="647e9-175">En el diagrama anterior se muestran dos aplicaciones diferentes que se comunican con dos dispositivos MTP.</span><span class="sxs-lookup"><span data-stu-id="647e9-175">The preceding diagram shows two different applications communicating with two MTP devices.</span></span> <span data-ttu-id="647e9-176">Los dispositivos usan la misma clase de proveedor de servicios, pero cada aplicación tiene su propia instancia del mismo proveedor de servicios.</span><span class="sxs-lookup"><span data-stu-id="647e9-176">The devices use the same service provider class, but each application has its own instance of the same service provider.</span></span> <span data-ttu-id="647e9-177">Cada instancia del proveedor de servicios se comunica con los dispositivos.</span><span class="sxs-lookup"><span data-stu-id="647e9-177">Each service provider instance is communicating with devices.</span></span> <span data-ttu-id="647e9-178">Las distintas instancias del proveedor de servicios no se reconocen entre sí.</span><span class="sxs-lookup"><span data-stu-id="647e9-178">The different instances of the service provider are not aware of each other.</span></span>

<span data-ttu-id="647e9-179">Muchos métodos de aplicación tienen un método de proveedor de servicios con nombre correspondiente.</span><span class="sxs-lookup"><span data-stu-id="647e9-179">Many application methods have a correspondingly named service provider method.</span></span> <span data-ttu-id="647e9-180">Cuando la aplicación llama a un método, Windows Media Administrador de dispositivos enruta la llamada al método correspondiente en el proveedor de servicios (aunque podría realizar algunas acciones internas adicionales primero).</span><span class="sxs-lookup"><span data-stu-id="647e9-180">When the application calls a method, Windows Media Device Manager routes the call to the corresponding method on the service provider (though it might perform some additional internal actions first).</span></span> <span data-ttu-id="647e9-181">Por ejemplo, cuando la aplicación llama a [**IWMDMDevice3:: GetProperty**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmdevice3-getproperty), Windows Media administrador de dispositivos enruta esta llamada a la implementación del proveedor de servicios de [**IMDSPDevice3:: GetProperty**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice3-getproperty).</span><span class="sxs-lookup"><span data-stu-id="647e9-181">For example, when the application calls [**IWMDMDevice3::GetProperty**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmdevice3-getproperty), Windows Media Device Manager routes this call to the service provider's implementation of [**IMDSPDevice3::GetProperty**](/windows/desktop/api/mswmdm/nf-mswmdm-imdspdevice3-getproperty).</span></span> <span data-ttu-id="647e9-182">(La mayoría de las interfaces de aplicación comienzan por IWMDM y la interfaz del proveedor de servicios correspondiente comienza con IMDSP).</span><span class="sxs-lookup"><span data-stu-id="647e9-182">(Most application interfaces begin with IWMDM, and the corresponding service provider interface begins with IMDSP).</span></span> <span data-ttu-id="647e9-183">Se espera que el proveedor de servicios controle esta llamada al método y devuelva un resultado adecuado.</span><span class="sxs-lookup"><span data-stu-id="647e9-183">The service provider is expected to handle this method call and return an appropriate result.</span></span>

<span data-ttu-id="647e9-184">Una aplicación nunca explora o se comunica con un dispositivo directamente (a menos que llame a [**IWMDMDevice3::D eviceiocontrol**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmdevice3-deviceiocontrol) o [**IWMDMStorage:: SendOpaqueCommand**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage-sendopaquecommand)); la aplicación se comunica con el proveedor de servicios, que debe representar un dispositivo de la forma más sencilla y lógica posible.</span><span class="sxs-lookup"><span data-stu-id="647e9-184">An application never explores or communicates with a device directly (unless it calls [**IWMDMDevice3::DeviceIoControl**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmdevice3-deviceiocontrol) or [**IWMDMStorage::SendOpaqueCommand**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmstorage-sendopaquecommand)); the application communicates with the service provider, which must represent a device in the most logical and simple manner possible.</span></span> <span data-ttu-id="647e9-185">Cuando la aplicación solicita información sobre el dispositivo, o enumera objetos en el dispositivo, el proveedor de servicios consulta el dispositivo de la manera adecuada y adquiere y devuelve la información adecuada.</span><span class="sxs-lookup"><span data-stu-id="647e9-185">When the application requests information about the device, or enumerates objects on the device, the service provider queries the device in an appropriate manner and acquires and returns the appropriate information.</span></span> <span data-ttu-id="647e9-186">Puede exponer la organización de archivos en el dispositivo de forma distinta a como se almacena físicamente en el dispositivo, si es adecuado.</span><span class="sxs-lookup"><span data-stu-id="647e9-186">It may expose the file organization on the device differently from how it is physically stored on the device, if that is appropriate.</span></span> <span data-ttu-id="647e9-187">Sin embargo, expone el dispositivo, debe estar de forma coherente y lógica, para permitir que la aplicación encuentre lo que necesita y controle los comandos que envía.</span><span class="sxs-lookup"><span data-stu-id="647e9-187">However it exposes the device, it should be in a consistent, logical manner, to enable the application to find what it needs and handle the commands it sends.</span></span> <span data-ttu-id="647e9-188">Un buen proveedor de servicios ocultará las peculiaridades específicas del dispositivo (por ejemplo, si el dispositivo almacena físicamente una lista de reproducción como un archivo con una extensión de archivo personalizada), el proveedor de servicios debe agregar esa extensión automáticamente cuando la aplicación cree una lista de reproducción en el dispositivo. no debe esperar que la aplicación Conozca la extensión adecuada al crear un objeto de lista de reproducción.</span><span class="sxs-lookup"><span data-stu-id="647e9-188">A good service provider will hide device-specific peculiarities—for example, if the device physically stores a playlist as a file with a custom file extension, the service provider should add that extension automatically when the application creates a playlist on the device; it should not expect the application to know the proper extension when creating a playlist object.</span></span>

<span data-ttu-id="647e9-189">Los proveedores de servicios se ejecutan dentro del proceso de la aplicación que realiza la llamada.</span><span class="sxs-lookup"><span data-stu-id="647e9-189">Service providers run inside the process of the calling application.</span></span> <span data-ttu-id="647e9-190">La única excepción a esto es el proveedor de servicios MTP, que se ejecuta en su propio proceso.</span><span class="sxs-lookup"><span data-stu-id="647e9-190">The only exception to this is the MTP service provider, which runs in its own process.</span></span> <span data-ttu-id="647e9-191">Por este motivo, hay algún riesgo de que un proveedor de servicios bloqueados cause el bloqueo de la aplicación que realiza la llamada.</span><span class="sxs-lookup"><span data-stu-id="647e9-191">Because of this, there is some risk that a blocked service provider will cause the calling application to block.</span></span> <span data-ttu-id="647e9-192">Por lo tanto, los proveedores de servicios deben diseñarse para ser sólidos y evitar el bloqueo, y las aplicaciones deben diseñarse para evitar detenerse si una llamada a un método determinado no vuelve rápidamente.</span><span class="sxs-lookup"><span data-stu-id="647e9-192">Therefore, service providers should be designed to be robust and prevent blocking, and applications should be designed to avoid stalling if a particular method call does not return quickly.</span></span>

## <a name="related-topics"></a><span data-ttu-id="647e9-193">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="647e9-193">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="647e9-194">**Introducción**</span><span class="sxs-lookup"><span data-stu-id="647e9-194">**Getting Started**</span></span>](getting-started.md)
</dt> </dl>

 

 




