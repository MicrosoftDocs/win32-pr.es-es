---
description: WMI proporciona diversas técnicas para recuperar y manipular información de clase e instancia de WMI, mediante Microsoft PowerShell, visual&\# 160; Basic Scripting Edition (VBScript) y C++.
ms.assetid: 682cbe12-1487-4681-8d2f-4caf21cb068a
ms.tgt_platform: multiple
title: Manipular información de clase e instancia
ms.topic: article
ms.date: 05/31/2018
topic_type:
- kbArticle
api_name: ''
api_type: ''
api_location: ''
ms.openlocfilehash: 86e3e84deae73e206f41e9ea25e02b5d11373f3d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "105716865"
---
# <a name="manipulating-class-and-instance-information"></a><span data-ttu-id="6db5e-103">Manipular información de clase e instancia</span><span class="sxs-lookup"><span data-stu-id="6db5e-103">Manipulating Class and Instance Information</span></span>

<span data-ttu-id="6db5e-104">WMI proporciona diversas técnicas para recuperar y manipular información de clase e instancia de WMI, mediante Microsoft PowerShell, Visual Basic Scripting Edition (VBScript) y C++.</span><span class="sxs-lookup"><span data-stu-id="6db5e-104">WMI provides a variety of techniques to retrieve and manipulate WMI class and instance information, using Microsoft PowerShell, Visual Basic Scripting Edition (VBScript) and C++.</span></span>

<span data-ttu-id="6db5e-105">En la tabla siguiente se enumeran los temas en los que se describen las técnicas para recuperar y manipular información de clase e instancia de WMI.</span><span class="sxs-lookup"><span data-stu-id="6db5e-105">The following table lists the topics that discuss the techniques to retrieve and manipulate WMI class and instance information.</span></span>



| <span data-ttu-id="6db5e-106">Tema</span><span class="sxs-lookup"><span data-stu-id="6db5e-106">Topic</span></span>                                                                                  | <span data-ttu-id="6db5e-107">Descripción</span><span class="sxs-lookup"><span data-stu-id="6db5e-107">Description</span></span>                                                                                                                                                                       |
|----------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="6db5e-108">Recuperación de datos de clase o instancia de WMI</span><span class="sxs-lookup"><span data-stu-id="6db5e-108">Retrieving WMI Class or Instance Data</span></span>](retrieving-class-or-instance-data.md)         | <span data-ttu-id="6db5e-109">Recuperar y establecer datos de y en el repositorio de información de WMI.</span><span class="sxs-lookup"><span data-stu-id="6db5e-109">Retrieve and set data from and to the WMI information repository.</span></span>                                                                                                                 |
| [<span data-ttu-id="6db5e-110">Modificar una propiedad de instancia</span><span class="sxs-lookup"><span data-stu-id="6db5e-110">Modifying an Instance Property</span></span>](modifying-an-instance-property.md)                   | <span data-ttu-id="6db5e-111">Cambie la información de la instancia una vez recuperada.</span><span class="sxs-lookup"><span data-stu-id="6db5e-111">Change the information in the instance after it is retrieved.</span></span>                                                                                                                     |
| [<span data-ttu-id="6db5e-112">Cambiar la herencia de una instancia</span><span class="sxs-lookup"><span data-stu-id="6db5e-112">Changing the Inheritance of an Instance</span></span>](changing-the-inheritance-of-an-instance.md) | <span data-ttu-id="6db5e-113">Cambie la clase primaria de una instancia de.</span><span class="sxs-lookup"><span data-stu-id="6db5e-113">Change the parent class of an instance.</span></span>                                                                                                                                           |
| [<span data-ttu-id="6db5e-114">Modificar un método</span><span class="sxs-lookup"><span data-stu-id="6db5e-114">Modifying a Method</span></span>](modifying-a-method.md)                                           | <span data-ttu-id="6db5e-115">Modifique los parámetros de una instancia.</span><span class="sxs-lookup"><span data-stu-id="6db5e-115">Modify the parameters of an instance.</span></span>                                                                                                                                             |
| [<span data-ttu-id="6db5e-116">Enumerar WMI</span><span class="sxs-lookup"><span data-stu-id="6db5e-116">Enumerating WMI</span></span>](enumerating-wmi.md)                                                 | <span data-ttu-id="6db5e-117">Enumerar objetos WMI.</span><span class="sxs-lookup"><span data-stu-id="6db5e-117">Enumerate WMI objects.</span></span>                                                                                                                                                            |
| [<span data-ttu-id="6db5e-118">Consultando WMI</span><span class="sxs-lookup"><span data-stu-id="6db5e-118">Querying WMI</span></span>](querying-wmi.md)                                                       | <span data-ttu-id="6db5e-119">Consultar objetos de WMI.</span><span class="sxs-lookup"><span data-stu-id="6db5e-119">Query WMI objects.</span></span>                                                                                                                                                                |
| [<span data-ttu-id="6db5e-120">Llamar a un método</span><span class="sxs-lookup"><span data-stu-id="6db5e-120">Calling a Method</span></span>](calling-a-method.md)                                               | <span data-ttu-id="6db5e-121">Use métodos asociados creados por Microsoft u otros desarrolladores de terceros para manipular más objetos WMI, o bien afectar directamente al objeto que representa el objeto WMI.</span><span class="sxs-lookup"><span data-stu-id="6db5e-121">Use associated methods created by Microsoft or other third-party developers to further manipulate WMI objects, or else directly affect the object that the WMI object represents.</span></span> |
| [<span data-ttu-id="6db5e-122">Obtener acceso a una colección</span><span class="sxs-lookup"><span data-stu-id="6db5e-122">Accessing a Collection</span></span>](accessing-a-collection.md)                                   | <span data-ttu-id="6db5e-123">Enumerar colecciones en el script.</span><span class="sxs-lookup"><span data-stu-id="6db5e-123">Enumerate collections in script.</span></span>                                                                                                                                                  |



 

## <a name="manipulating-data-using-vbscript"></a><span data-ttu-id="6db5e-124">Manipular datos mediante VBScript</span><span class="sxs-lookup"><span data-stu-id="6db5e-124">Manipulating Data Using VBScript</span></span>

<span data-ttu-id="6db5e-125">Puede usar el acceso directo para tener acceso a las propiedades de WMI de una clase o instancia de WMI directamente en un [**SWbemObject**](swbemobject.md), en lugar de a través de la [colección](accessing-a-collection.md) de propiedades de ese objeto.</span><span class="sxs-lookup"><span data-stu-id="6db5e-125">You can use direct access to access the WMI properties of a WMI class or instance directly on an [**SWbemObject**](swbemobject.md), rather than through the property [collection](accessing-a-collection.md) of that object.</span></span> <span data-ttu-id="6db5e-126">También puede ejecutar métodos en ese objeto en el estilo nativo del lenguaje de programación en lugar de usar la llamada [**SWbemServices.ExecMethod**](swbemservices-execmethod.md) .</span><span class="sxs-lookup"><span data-stu-id="6db5e-126">You can also execute methods on that object in the native style of the programming language rather than using the [**SWbemServices.ExecMethod**](swbemservices-execmethod.md) call.</span></span> <span data-ttu-id="6db5e-127">Por ejemplo, el método [**Create**](/windows/desktop/CIMWin32Prov/create-method-in-class-win32-process) en [**el \_ proceso Win32**](/windows/desktop/CIMWin32Prov/win32-process) tenía tres parámetros en Windows 2000, pero tiene cuatro parámetros en Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="6db5e-127">For example, the [**Create**](/windows/desktop/CIMWin32Prov/create-method-in-class-win32-process) method in [**Win32\_Process**](/windows/desktop/CIMWin32Prov/win32-process) had three parameters in Windows 2000 but has four parameters in Windows Server 2003.</span></span>

<span data-ttu-id="6db5e-128">Con el acceso directo, puede tratar las propiedades y los métodos de WMI como si fueran propiedades y métodos de automatización de [**SWbemObject**](swbemobject.md).</span><span class="sxs-lookup"><span data-stu-id="6db5e-128">Using direct access, you can treat WMI properties and methods as if they were automation properties and methods of [**SWbemObject**](swbemobject.md).</span></span>

<span data-ttu-id="6db5e-129">En el ejemplo siguiente se muestra cómo se puede tener acceso a una propiedad.</span><span class="sxs-lookup"><span data-stu-id="6db5e-129">The following example shows how you can access a property.</span></span>


```VB
VolumeName = MyDisk.Properties_("VolumeName")
```



<span data-ttu-id="6db5e-130">En el ejemplo siguiente se muestra cómo puede tener acceso a una propiedad cuando tiene acceso directo.</span><span class="sxs-lookup"><span data-stu-id="6db5e-130">The following example shows how you can access a property when you have direct access.</span></span>


```VB
VolumeName = MyDisk.VolumeName
```



<span data-ttu-id="6db5e-131">También se admite el encadenamiento de objetos.</span><span class="sxs-lookup"><span data-stu-id="6db5e-131">Chaining of objects is also acceptable.</span></span>

<span data-ttu-id="6db5e-132">En el ejemplo siguiente se muestra cómo obtener acceso a una propiedad de un objeto que está incrustado en otro objeto.</span><span class="sxs-lookup"><span data-stu-id="6db5e-132">The following example shows how to access a property of an object that is embedded in another object.</span></span>


```VB
value = MyComputer.MyDisk.VolumeName
```



<span data-ttu-id="6db5e-133">En el ejemplo siguiente se muestra cómo obtener acceso a una propiedad con la notación de subíndice de matriz.</span><span class="sxs-lookup"><span data-stu-id="6db5e-133">The following example shows how to access a property with array subscript notation.</span></span>


```VB
valueOfElement = MyDisk.MyArrayProperty(3)
```



<span data-ttu-id="6db5e-134">En el ejemplo de código de VBScript siguiente se muestra cómo generar una instancia de los parámetros de entrada para el método [**Create**](/windows/desktop/CIMWin32Prov/create-method-in-class-win32-process) de la clase de [**\_ proceso de Win32**](/windows/desktop/CIMWin32Prov/win32-process) como [**SWbemObject**](swbemobject.md), rellenar las propiedades de entrada y, a continuación, ejecutar el método **Create** con [**SWbemServices.ExecMethod**](swbemservices-execmethod.md).</span><span class="sxs-lookup"><span data-stu-id="6db5e-134">The following VBScript code example shows how to spawn an instance of the input parameters to the [**Create**](/windows/desktop/CIMWin32Prov/create-method-in-class-win32-process) method in the [**Win32\_Process**](/windows/desktop/CIMWin32Prov/win32-process) class as an [**SWbemObject**](swbemobject.md), populate the input properties, and then execute the **Create** method using [**SWbemServices.ExecMethod**](swbemservices-execmethod.md).</span></span>

<span data-ttu-id="6db5e-135">La propiedad [**SWbemObject. \_ Methods**](swbemobject-methods-.md) devuelve una colección [**SWbemMethodSet**](swbemmethodset.md) de los métodos de [**\_ proceso de Win32**](/windows/desktop/CIMWin32Prov/win32-process) .</span><span class="sxs-lookup"><span data-stu-id="6db5e-135">The [**SWbemObject.Methods\_**](swbemobject-methods-.md) property returns an [**SWbemMethodSet**](swbemmethodset.md) collection of the [**Win32\_Process**](/windows/desktop/CIMWin32Prov/win32-process) methods.</span></span> <span data-ttu-id="6db5e-136">Los miembros del conjunto de métodos son objetos [**SWbemMethod**](swbemmethod.md) y [**SWbemMethod. Parameters**](swbemmethod-inparameters.md) devuelve los parámetros de entrada para el método [**Create**](/windows/desktop/CIMWin32Prov/create-method-in-class-win32-process) .</span><span class="sxs-lookup"><span data-stu-id="6db5e-136">The members of the method set are [**SWbemMethod**](swbemmethod.md) objects and [**SWbemMethod.InParameters**](swbemmethod-inparameters.md) returns the input parameters for the [**Create**](/windows/desktop/CIMWin32Prov/create-method-in-class-win32-process) method.</span></span> <span data-ttu-id="6db5e-137">El parámetro de entrada de *línea de comandos* necesario se establece en "calc.exe".</span><span class="sxs-lookup"><span data-stu-id="6db5e-137">The required *CommandLine* input parameter is set to "calc.exe".</span></span> <span data-ttu-id="6db5e-138">A continuación, [**SWbemServices.ExecMethod**](swbemservices-execmethod.md)ejecuta el método, lo que produce el inicio de un proceso de calc.exe.</span><span class="sxs-lookup"><span data-stu-id="6db5e-138">The method is then executed by [**SWbemServices.ExecMethod**](swbemservices-execmethod.md), resulting in the launch of a calc.exe process.</span></span>


```VB
set Services = GetObject("winmgmts:root\cimv2")
Set obj = Services.Get("Win32_Process")
Set objIns = obj.Methods_("Create").InParameters.SpawnInstance_
objIns.CommandLine = "calc.exe"
Set objOut = Services.ExecMethod("Win32_Process", "Create", objIns)
MsgBox "Return value = " & objOut.returnvalue & VBCRLF & "Process ID = " & objOut.processid
```



<span data-ttu-id="6db5e-139">En el ejemplo de código siguiente se muestra cómo realizar la operación anterior mediante el acceso directo.</span><span class="sxs-lookup"><span data-stu-id="6db5e-139">The following code example shows how to perform the previous operation using direct access.</span></span>


```VB
set Services = GetObject("winmgmts:root\cimv2")
Set Obj = Services.Get("Win32_Process")
returnvalue = Obj.create("calc.exe",,,processid)
MsgBox "Return value = " & returnvalue & VBCRLF & "Process ID = " & processid
```



<span data-ttu-id="6db5e-140">Para obtener más información, consulte [llamar a un método de proveedor](calling-a-provider-method.md) y [scripting con SWbemObject](scripting-with-swbemobject.md).</span><span class="sxs-lookup"><span data-stu-id="6db5e-140">For more information, see [Calling a Provider Method](calling-a-provider-method.md) and [Scripting with SWbemObject](scripting-with-swbemobject.md).</span></span>

 

 
