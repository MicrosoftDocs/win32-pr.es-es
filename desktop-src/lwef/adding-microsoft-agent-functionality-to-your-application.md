---
title: Agregar la funcionalidad de Microsoft Agent a la aplicación
description: Agregar la funcionalidad de Microsoft Agent a la aplicación
ms.assetid: 2b4816dd-11bf-4c17-873e-4bdbb7fa1ccf
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8a2972b0251a4114e5d280d8f739d416ebc5dc1c
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/19/2020
ms.locfileid: "104358874"
---
# <a name="adding-microsoft-agent-functionality-to-your-application"></a><span data-ttu-id="7e61d-103">Agregar la funcionalidad de Microsoft Agent a la aplicación</span><span class="sxs-lookup"><span data-stu-id="7e61d-103">Adding Microsoft Agent Functionality to Your Application</span></span>

<span data-ttu-id="7e61d-104">\[Microsoft Agent está en desuso a partir de Windows 7 y puede que no esté disponible en versiones posteriores de Windows.\]</span><span class="sxs-lookup"><span data-stu-id="7e61d-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="7e61d-105">Para tener acceso a las interfaces de servidor de Microsoft Agent, el agente ya debe estar instalado en el sistema de destino.</span><span class="sxs-lookup"><span data-stu-id="7e61d-105">To access Microsoft Agent's server interfaces, Agent must already be installed on the target system.</span></span> <span data-ttu-id="7e61d-106">No se admite la instalación que no sea con el archivo ejecutable de instalación automática del agente, como intentar copiar y registrar archivos de componente de agente.</span><span class="sxs-lookup"><span data-stu-id="7e61d-106">Installation other than using Agent's self-installing executable file, such as attempting to copy and register Agent component files, is not supported.</span></span> <span data-ttu-id="7e61d-107">Esto garantiza una instalación coherente y completa.</span><span class="sxs-lookup"><span data-stu-id="7e61d-107">This ensures consistent and complete installation.</span></span> <span data-ttu-id="7e61d-108">Tenga en cuenta que el archivo de instalación automática de Microsoft Agent no se instalará en los sistemas operativos Microsoft Windows 2000 y versiones posteriores, ya que estas versiones del sistema operativo ya incluyen su propia versión del agente.</span><span class="sxs-lookup"><span data-stu-id="7e61d-108">Note that the Microsoft Agent self-installing file will not install on Microsoft Windows 2000 and later operating systems because these versions of the operating system already include their own version of Agent.</span></span>

<span data-ttu-id="7e61d-109">Para instalar correctamente el agente en un sistema de destino con un sistema operativo Microsoft Windows anterior, también debe asegurarse de que el sistema de destino tiene una versión reciente de Microsoft Visual C++ Runtime (Msvcrt.dll), la herramienta de registro de Microsoft (Regsvr32.dll) y los archivos dll de Microsoft COM.</span><span class="sxs-lookup"><span data-stu-id="7e61d-109">To successfully install Agent on a target system with a prior Microsoft Windows operating system, you must also ensure that the target system has a recent version of the Microsoft Visual C++ runtime (Msvcrt.dll), Microsoft registration tool (Regsvr32.dll), and Microsoft COM dlls.</span></span> <span data-ttu-id="7e61d-110">La manera más sencilla de asegurarse de que los componentes necesarios están en el sistema de destino es requerir la instalación de Microsoft Internet Explorer 3,02 o posterior.</span><span class="sxs-lookup"><span data-stu-id="7e61d-110">The easiest way to ensure that the necessary components are on the target system is to require that Microsoft Internet Explorer 3.02 or later is installed.</span></span> <span data-ttu-id="7e61d-111">Como alternativa, puede instalar los dos primeros componentes que están disponibles como parte de Microsoft Visual C++.</span><span class="sxs-lookup"><span data-stu-id="7e61d-111">Alternatively, you can install the first two components which are available as part of Microsoft Visual C++.</span></span> <span data-ttu-id="7e61d-112">Los archivos DLL COM necesarios se pueden instalar como parte de la actualización DCOM de Microsoft, disponible en el sitio web de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="7e61d-112">The necessary COM dlls can be installed as part of the Microsoft DCOM update, available at the Microsoft website.</span></span> <span data-ttu-id="7e61d-113">Puede encontrar más información e información de licencia para estos componentes en el sitio web de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="7e61d-113">You can find further information and licensing information for these components at the Microsoft website.</span></span>

<span data-ttu-id="7e61d-114">Los componentes de idioma del agente se pueden instalar de la misma manera.</span><span class="sxs-lookup"><span data-stu-id="7e61d-114">Agent's language components can be installed the same way.</span></span> <span data-ttu-id="7e61d-115">De forma similar, puede usar esta técnica para instalar el formato de ACS de los caracteres de Microsoft disponibles para la distribución desde el sitio web del agente de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="7e61d-115">Similarly, you can use this technique to install the ACS format of the Microsoft characters available for distribution from the Microsoft Agent website.</span></span> <span data-ttu-id="7e61d-116">Los archivos de caracteres se instalan automáticamente en el subdirectorio de caracteres del agente de Microsoft \\ .</span><span class="sxs-lookup"><span data-stu-id="7e61d-116">The character files automatically install to the Microsoft Agent \\Chars subdirectory.</span></span>

<span data-ttu-id="7e61d-117">Dado que los componentes de Microsoft Agent están diseñados como componentes del sistema operativo, es posible que el agente no se desinstale.</span><span class="sxs-lookup"><span data-stu-id="7e61d-117">Because Microsoft Agent's components are designed as operating system components, Agent may not be uninstalled.</span></span> <span data-ttu-id="7e61d-118">Del mismo modo, si el agente ya está instalado como parte del sistema operativo Windows, es posible que el archivo. cab de instalación automática del agente no se instale.</span><span class="sxs-lookup"><span data-stu-id="7e61d-118">Similarly, where Agent is already installed as part of the Windows operating system, the Agent self-installing cabinet may not install.</span></span>

<span data-ttu-id="7e61d-119">Una vez instalado, para llamar a las interfaces del agente, cree una instancia del servidor y solicite un puntero a una interfaz específica que el servidor admita mediante la Convención COM estándar.</span><span class="sxs-lookup"><span data-stu-id="7e61d-119">Once installed, to call Agent's interfaces, create an instance of the server and request a pointer to a specific interface that the server supports using the standard COM convention.</span></span> <span data-ttu-id="7e61d-120">En concreto, la biblioteca COM proporciona una función de API, [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance), que crea una instancia del objeto y devuelve un puntero a la interfaz solicitada del objeto.</span><span class="sxs-lookup"><span data-stu-id="7e61d-120">In particular, the COM library provides an API function, [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance), that creates an instance of the object and returns a pointer to the requested interface of the object.</span></span> <span data-ttu-id="7e61d-121">Solicite un puntero a la interfaz [**IAgent**](iagent.md) o [**IAgentEx**](iagentex.md) en la llamada a **CoCreateInstance** o en una llamada subsiguiente a [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)).</span><span class="sxs-lookup"><span data-stu-id="7e61d-121">Request a pointer to the [**IAgent**](iagent.md) or [**IAgentEx**](iagentex.md) interface in your **CoCreateInstance** call or in a subsequent call to [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)).</span></span>

<span data-ttu-id="7e61d-122">En el código siguiente se muestra esto en C/C++.</span><span class="sxs-lookup"><span data-stu-id="7e61d-122">The following code illustrates this in C/C++.</span></span>


```
hRes = CoCreateInstance(CLSID_AgentServer,
                     NULL,
                     CLSCTX_SERVER,
                     IID_IAgentEx,
                     (LPVOID *)&amp;pAgentEx);
```



<span data-ttu-id="7e61d-123">Si el servidor de agente de Microsoft está ejecutando, esta función se conecta al servidor; de lo contrario, inicia el servidor.</span><span class="sxs-lookup"><span data-stu-id="7e61d-123">If the Microsoft Agent server is running, this function connects to the server; otherwise, it starts up the server.</span></span>

<span data-ttu-id="7e61d-124">Tenga en cuenta que las interfaces de servidor del agente de Microsoft suelen incluir interfaces extendidas que incluyen un sufijo "ex".</span><span class="sxs-lookup"><span data-stu-id="7e61d-124">Note that the Microsoft Agent server interfaces often include extended interfaces that include an "Ex" suffix.</span></span> <span data-ttu-id="7e61d-125">Estas interfaces se derivan de y, por tanto, incluyen toda la funcionalidad de, sus homólogos no ex.</span><span class="sxs-lookup"><span data-stu-id="7e61d-125">These interfaces are derived from, and therefore include all the functionality of, their non-Ex counterparts.</span></span> <span data-ttu-id="7e61d-126">Si desea utilizar cualquiera de las características extendidas, use las interfaces ex.</span><span class="sxs-lookup"><span data-stu-id="7e61d-126">If you want to use any of the extended features, use the Ex interfaces.</span></span>

<span data-ttu-id="7e61d-127">Las funciones que toman punteros a BSTR asignan memoria mediante [**SysAllocString**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-sysallocstring).</span><span class="sxs-lookup"><span data-stu-id="7e61d-127">Functions that take pointers to BSTRs allocate memory using [**SysAllocString**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-sysallocstring).</span></span> <span data-ttu-id="7e61d-128">Es responsabilidad del autor de la llamada liberar esta memoria mediante [**SysFreeString**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-sysfreestring).</span><span class="sxs-lookup"><span data-stu-id="7e61d-128">It is the caller's responsibility to free this memory using [**SysFreeString**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-sysfreestring).</span></span>

 

 