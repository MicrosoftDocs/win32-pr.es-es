---
description: Crear un filtro de publicador
ms.assetid: d91efecc-f02a-41c6-acf7-37b74723e7e8
title: Crear un filtro de publicador
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 997fe37cf0021bcb2aa153c2dc4b73597e0c43cc
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104153465"
---
# <a name="creating-a-publisher-filter"></a><span data-ttu-id="f4929-103">Crear un filtro de publicador</span><span class="sxs-lookup"><span data-stu-id="f4929-103">Creating a Publisher Filter</span></span>

<span data-ttu-id="f4929-104">Hay dos métodos para establecer el filtro del publicador: mediante la propiedad MultiPublisherFilterCLSID de la clase de eventos o mediante [**IEventControl:: SetPublisherFilter**](/windows/desktop/api/Eventsys/nf-eventsys-ieventcontrol-setpublisherfilter).</span><span class="sxs-lookup"><span data-stu-id="f4929-104">There are two methods to establish the publisher filter: using the MultiPublisherFilterCLSID property of the event class, or using [**IEventControl::SetPublisherFilter**](/windows/desktop/api/Eventsys/nf-eventsys-ieventcontrol-setpublisherfilter).</span></span>

-   <span data-ttu-id="f4929-105">Dado que permite crear el objeto de evento con el servicio de [componentes en cola de com+](com--queued-components.md) , el método preferido es usar la propiedad MultiPublisherFilterCLSID en la clase de eventos para establecer el filtro del publicador.</span><span class="sxs-lookup"><span data-stu-id="f4929-105">Because it allows you to compose the event object with the [COM+ queued components](com--queued-components.md) service, the preferred method is to use the MultiPublisherFilterCLSID property in the event class to set the publisher filter.</span></span> <span data-ttu-id="f4929-106">Esto establece un objeto de filtro para todos los métodos de las interfaces de eventos de un objeto de evento.</span><span class="sxs-lookup"><span data-stu-id="f4929-106">This establishes one filter object for all the methods of the event interfaces for an event object.</span></span> <span data-ttu-id="f4929-107">El objeto de evento activa el filtro del publicador cuando se crea una instancia del objeto de la clase de evento mediante [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance).</span><span class="sxs-lookup"><span data-stu-id="f4929-107">The event object activates the publisher filter when the event class object is instantiated using [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance).</span></span>
-   <span data-ttu-id="f4929-108">También puede usar [**SetPublisherFilter**](/windows/desktop/api/Eventsys/nf-eventsys-ieventcontrol-setpublisherfilter).</span><span class="sxs-lookup"><span data-stu-id="f4929-108">You can also use [**SetPublisherFilter**](/windows/desktop/api/Eventsys/nf-eventsys-ieventcontrol-setpublisherfilter).</span></span> <span data-ttu-id="f4929-109">Sin embargo, si elige este método, la interfaz no se queuable y, por lo tanto, no puede usar el objeto de evento con el servicio de componentes en cola de COM+ entre el publicador y el objeto de la clase de evento.</span><span class="sxs-lookup"><span data-stu-id="f4929-109">However, if you choose this method, the interface is not queuable and therefore cannot use the event object with the COM+ queued components service between the publisher and the event class object.</span></span> <span data-ttu-id="f4929-110">Para obtener información adicional acerca del uso del servicio de componentes en cola con eventos COM+, vea [using com+ events with com+ queued Components](using-com--events-with-com--queued-components.md).</span><span class="sxs-lookup"><span data-stu-id="f4929-110">For additional information about using the queued components service with COM+ Events, see [Using COM+ Events with COM+ Queued Components](using-com--events-with-com--queued-components.md).</span></span>

<span data-ttu-id="f4929-111">Un evento puede tener uno o más objetos de filtro o ninguno.</span><span class="sxs-lookup"><span data-stu-id="f4929-111">An event can have one or more filter objects or none at all.</span></span> <span data-ttu-id="f4929-112">Los objetos de filtro del publicador deben admitir [**IPublisherFilter**](/windows/desktop/api/EventSys/nn-eventsys-ipublisherfilter) o [**IMultiInterfacePublisherFilter**](/windows/desktop/api/EventSys/nn-eventsys-imultiinterfacepublisherfilter), en función de si tiene una sola interfaz de activación o varias interfaces de activación en el objeto de la clase de evento.</span><span class="sxs-lookup"><span data-stu-id="f4929-112">The publisher filter objects must support either [**IPublisherFilter**](/windows/desktop/api/EventSys/nn-eventsys-ipublisherfilter) or [**IMultiInterfacePublisherFilter**](/windows/desktop/api/EventSys/nn-eventsys-imultiinterfacepublisherfilter), depending on whether you have a single firing interface or multiple firing interfaces on the event class object.</span></span> <span data-ttu-id="f4929-113">Las interfaces **IPublisherFilter** y **IMultiInterfacePublisherFilter** especifican un método **Initialize** .</span><span class="sxs-lookup"><span data-stu-id="f4929-113">The **IPublisherFilter** and **IMultiInterfacePublisherFilter** interfaces both specify an **Initialize** method.</span></span> <span data-ttu-id="f4929-114">El objeto de la clase de eventos llama al método **Initialize** inmediatamente después de crear el objeto de filtro.</span><span class="sxs-lookup"><span data-stu-id="f4929-114">The **Initialize** method is called by the event class object immediately after creating the filter object.</span></span>

<span data-ttu-id="f4929-115">Los eventos COM+ intentan invocar dos métodos en el filtro.</span><span class="sxs-lookup"><span data-stu-id="f4929-115">COM+ Events tries to invoke two methods on the filter.</span></span> <span data-ttu-id="f4929-116">En primer lugar, llama a [**IPublisherFilter::P reparetofire**](/windows/desktop/api/EventSys/nf-eventsys-ipublisherfilter-preparetofire) y pasa un puntero de interfaz [**IFiringControl**](/windows/desktop/api/EventSys/nn-eventsys-ifiringcontrol) al filtro.</span><span class="sxs-lookup"><span data-stu-id="f4929-116">First it calls [**IPublisherFilter::PrepareToFire**](/windows/desktop/api/EventSys/nf-eventsys-ipublisherfilter-preparetofire) and passes an [**IFiringControl**](/windows/desktop/api/EventSys/nn-eventsys-ifiringcontrol) interface pointer to the filter.</span></span> <span data-ttu-id="f4929-117">A continuación, consulta el objeto de filtro de la interfaz de eventos.</span><span class="sxs-lookup"><span data-stu-id="f4929-117">Then it queries the filter object for the event interface.</span></span> <span data-ttu-id="f4929-118">Si el filtro es compatible con la interfaz de eventos, invoca un método en él.</span><span class="sxs-lookup"><span data-stu-id="f4929-118">If the filter supports the event interface, it invokes a method on it.</span></span> <span data-ttu-id="f4929-119">Esto proporciona acceso a los parámetros del publicador para un evento.</span><span class="sxs-lookup"><span data-stu-id="f4929-119">This provides access to the publisher parameters for an event.</span></span> <span data-ttu-id="f4929-120">El filtro puede utilizar estos parámetros para determinar qué suscripciones se van a activar.</span><span class="sxs-lookup"><span data-stu-id="f4929-120">The filter can use these parameters to determine which subscriptions to fire.</span></span>

## <a name="related-topics"></a><span data-ttu-id="f4929-121">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="f4929-121">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f4929-122">Filtrado de eventos en COM+</span><span class="sxs-lookup"><span data-stu-id="f4929-122">Filtering Events in COM+</span></span>](filtering-events-in-com-.md)
</dt> </dl>

 

 
