---
description: 'Este tema se organiza de la siguiente manera:'
title: Prácticas recomendadas para los controladores de menú contextual y varios verbos
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 4D352ECB-6214-4f6e-A3E5-F79E154D090A
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: f8b47807c4647aec274e64dbcd137833d13e23cb
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "104985767"
---
# <a name="best-practices-for-shortcut-menu-handlers-and-multiple-verbs"></a><span data-ttu-id="f9c4c-103">Prácticas recomendadas para los controladores de menú contextual y varios verbos</span><span class="sxs-lookup"><span data-stu-id="f9c4c-103">Best Practices for Shortcut Menu Handlers and Multiple Verbs</span></span>

<span data-ttu-id="f9c4c-104">Este tema se organiza de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="f9c4c-104">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="f9c4c-105">Procedimientos recomendados</span><span class="sxs-lookup"><span data-stu-id="f9c4c-105">Best Practices</span></span>](#best-practices-for-shortcut-menu-handlers-and-multiple-verbs)
    -   [<span data-ttu-id="f9c4c-106">Prácticas recomendadas para implementaciones de verbo</span><span class="sxs-lookup"><span data-stu-id="f9c4c-106">Best Practices for Verb Implementations</span></span>](#best-practices-for-verb-implementations)
-   [<span data-ttu-id="f9c4c-107">Prácticas recomendadas para varios verbos de selección</span><span class="sxs-lookup"><span data-stu-id="f9c4c-107">Best Practices for Multiple Selection Verbs</span></span>](#best-practices-for-multiple-selection-verbs)
    -   [<span data-ttu-id="f9c4c-108">Selecciones heterogéneas</span><span class="sxs-lookup"><span data-stu-id="f9c4c-108">Heterogenous Selections</span></span>](#heterogenous-selections)
-   [<span data-ttu-id="f9c4c-109">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="f9c4c-109">Related topics</span></span>](#related-topics)

## <a name="best-practices"></a><span data-ttu-id="f9c4c-110">Prácticas recomendadas</span><span class="sxs-lookup"><span data-stu-id="f9c4c-110">Best Practices</span></span>

<span data-ttu-id="f9c4c-111">Los verbos estáticos son verbos más sencillos para implementar y proporcionan una funcionalidad enriquecida.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-111">Static verb are simplest verbs to implement, and provide rich functionality.</span></span> <span data-ttu-id="f9c4c-112">Le recomendamos encarecidamente que implemente un verbo con uno de los métodos estáticos Verb.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-112">We strongly encourage you to implement a verb using one of the static verb methods.</span></span>

### <a name="best-practices-for-verb-implementations"></a><span data-ttu-id="f9c4c-113">Prácticas recomendadas para implementaciones de verbo</span><span class="sxs-lookup"><span data-stu-id="f9c4c-113">Best Practices for Verb Implementations</span></span>

<span data-ttu-id="f9c4c-114">La lista siguiente representa los procedimientos recomendados para las implementaciones de verbo:</span><span class="sxs-lookup"><span data-stu-id="f9c4c-114">The following list represents best practices for verb implementations:</span></span>

-   <span data-ttu-id="f9c4c-115">Elija siempre el método de verbo más sencillo que se ajuste a sus necesidades.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-115">Always chose the simplest verb method that meets your needs.</span></span>
-   <span data-ttu-id="f9c4c-116">Si es posible, use un método de verbo estático.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-116">Use a static verb method, if possible.</span></span>
-   <span data-ttu-id="f9c4c-117">No realice operaciones con un uso intensivo de recursos ni e/s en el subproceso de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-117">Do not perform resource-intensive operations or I/O on the UI thread.</span></span> <span data-ttu-id="f9c4c-118">Tanto [**IShellExtInit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) como [**IContextMenu:: QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) deben ser muy conservadores en el trabajo que realizan.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-118">Both [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) and [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) need to be very conservative in the work they perform.</span></span> <span data-ttu-id="f9c4c-119">[**IContextMenu:: InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) se debe realizar en otro proceso o se debe crear un nuevo subproceso para evitar el bloqueo del llamador.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-119">[**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) must be performed in another process, or you must create a new thread to avoid blocking the caller.</span></span>
-   <span data-ttu-id="f9c4c-120">Prefije los verbos con el nombre del fabricante de software independiente (ISV) como se indica a continuación `ISVName.verb` .</span><span class="sxs-lookup"><span data-stu-id="f9c4c-120">Prefix verbs with the independent software vendor (ISV) name as follows, `ISVName.verb`.</span></span> <span data-ttu-id="f9c4c-121">El uso de nombres no completos puede producir colisiones con varios ISV que eligen el mismo nombre de verbo.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-121">Using unqualified names can result in collisions with multiple ISVs that chose the same verb name.</span></span>
-   <span data-ttu-id="f9c4c-122">Use siempre un ProgID específico de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-122">Always use an application-specific ProgID.</span></span> <span data-ttu-id="f9c4c-123">Dado que algunos tipos de elemento no usan esta asignación, es necesario que los nombres sean únicos para el proveedor.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-123">Because some item types do not use this mapping, there is a need for vendor-unique names.</span></span>
-   <span data-ttu-id="f9c4c-124">Coloca la interfaz de usuario en relación con el método de invocación, pero no se ejecuta en un subproceso invocador.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-124">Position the UI relative to the invoking method, but do not run on an invoker thread.</span></span>
-   <span data-ttu-id="f9c4c-125">No acepte el valor devuelto **S \_ OK** para verbos canónicos pasados al método [**IContextMenu:: InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) .</span><span class="sxs-lookup"><span data-stu-id="f9c4c-125">Do not accept the return value **S\_OK** for canonical verbs passed to the [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) method.</span></span> <span data-ttu-id="f9c4c-126">Si lo hace, se producirá un error en la implementación del verbo real y se devolverá un código de error para verbos canónicos.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-126">Doing so causes a failure for the real verb implementation to be invoked, and returns a failure code for canonical verbs.</span></span> <span data-ttu-id="f9c4c-127">Si no admite verbos canónicos, devolverá un error cuando se encuentre un valor de HIWORD distinto de cero (lpVerb).</span><span class="sxs-lookup"><span data-stu-id="f9c4c-127">If you do not support canonical verbs, then return failure when a nonzero HIWORD(lpVerb) value is encountered.</span></span>
-   <span data-ttu-id="f9c4c-128">Evite el uso de **rundll32.exe** como host para el verbo.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-128">Avoid the use of **rundll32.exe** as the host for your verb.</span></span>
-   <span data-ttu-id="f9c4c-129">Al implementar [**IContextMenu:: QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) Asegúrese de devolver el número de verbos que se han agregado al menú a través del valor **HRESULT** mediante la macro ResultFromShort.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-129">When implementing [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) be sure to return the number of verbs that have been added to the menu through the **HRESULT** value using the ResultFromShort macro.</span></span>
-   <span data-ttu-id="f9c4c-130">Si se registra en una de las siguientes entradas de clave del registro, preste atención y asegúrese de registrar el controlador en el tipo más específico para reducir las consecuencias posiblemente no deseadas:</span><span class="sxs-lookup"><span data-stu-id="f9c4c-130">If you register on one of the following registry key entries, then exercise caution and be sure to register your handler on the most specific type to reduce the possibly unintended consequences:</span></span>
    -   <span data-ttu-id="f9c4c-131">\**HKEY \_ \_raíz \\ de clases \** _</span><span class="sxs-lookup"><span data-stu-id="f9c4c-131">\**HKEY\_CLASSES\_ROOT\\\** _</span></span>
    -   <span data-ttu-id="f9c4c-132">_ *HKEY \_ classes \_ root \\ AllFileSystemObjects*\*</span><span class="sxs-lookup"><span data-stu-id="f9c4c-132">_ *HKEY\_CLASSES\_ROOT\\AllFileSystemObjects*\*</span></span>
    -   <span data-ttu-id="f9c4c-133">**\_Clase HKEY \_ raíz ( \\ carpeta raíz)**</span><span class="sxs-lookup"><span data-stu-id="f9c4c-133">**HKEY\_CLASSES\_ROOT\\Folder**</span></span>
    -   <span data-ttu-id="f9c4c-134">**HKEY \_ clases \_ raíz \\ Directory**</span><span class="sxs-lookup"><span data-stu-id="f9c4c-134">**HKEY\_CLASSES\_ROOT\\Directory**</span></span>
-   <span data-ttu-id="f9c4c-135">Establezca la clave **MayChangeDefaultMenu** solo si prevé que podría necesitar cambiar el verbo predeterminado en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-135">Set the **MayChangeDefaultMenu** key only if you anticipate that you might need to change the default verb in the shortcut menu.</span></span> <span data-ttu-id="f9c4c-136">Si el controlador no cambia el verbo predeterminado, no debe establecer esta clave, ya que esto hace que el sistema cargue el archivo DLL innecesariamente.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-136">If your handler does not change the default verb, then you should not set this key because doing so causes the system to load your DLL unnecessarily.</span></span>
-   <span data-ttu-id="f9c4c-137">Minimice el trabajo que realiza en [**IShellExtInit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize).</span><span class="sxs-lookup"><span data-stu-id="f9c4c-137">Minimize the work you perform in [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize).</span></span> <span data-ttu-id="f9c4c-138">Para los controladores de menú contextual, Capture el objeto de datos pasado a **IShellExtInit:: Initialize** y, a continuación, procese en [**IContextMenu:: QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu)o [**IContextMenu:: InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand).</span><span class="sxs-lookup"><span data-stu-id="f9c4c-138">For shortcut menu handlers, capture the data object passed to **IShellExtInit::Initialize**, and then process it in [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu), or [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand).</span></span>

## <a name="best-practices-for-multiple-selection-verbs"></a><span data-ttu-id="f9c4c-139">Prácticas recomendadas para varios verbos de selección</span><span class="sxs-lookup"><span data-stu-id="f9c4c-139">Best Practices for Multiple Selection Verbs</span></span>

<span data-ttu-id="f9c4c-140">Dado que el número de elementos de un escenario de verbo de selección múltiple puede ser grande, es importante tener en cuenta las implicaciones de rendimiento de las implementaciones de verbo.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-140">Because the number of items in a multi-selection verb scenario can be large, it is important that you consider the performance implications of your verb implementations.</span></span> <span data-ttu-id="f9c4c-141">Por ejemplo, cuando un usuario busca " \* " en un ámbito que incluye un gran número de elementos y, a continuación, hace clic en **seleccionar todo** y hace clic con el botón secundario, el verbo se presenta con una selección que puede tener miles de elementos en él.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-141">For example, when a user searches for "\*" over a scope that includes large numbers of items, and then clicks **Select All** and right-clicks, the verb is presented with a selection that can have thousands of items in it.</span></span> <span data-ttu-id="f9c4c-142">Como resultado, los verbos solo deben tener en cuenta el primer elemento de la selección y el recuento total de elementos.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-142">As a result, verbs should only consider the first item in the selection, and the overall item count.</span></span> <span data-ttu-id="f9c4c-143">El primer elemento se define como el elemento en la parte superior de la vista o el elemento en el que el usuario hizo clic con el botón derecho.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-143">The first item is defined as either the item at the top of the view, or the item that the user first right-clicked.</span></span>

<span data-ttu-id="f9c4c-144">En Windows 7 y versiones posteriores, el número de elementos que se pasan a un verbo está limitado a 16 cuando se consulta un menú contextual.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-144">In Windows 7 and later, the number of items passed to a verb is limited to 16 when a shortcut menu is queried.</span></span> <span data-ttu-id="f9c4c-145">A continuación, el verbo se vuelve a crear y se vuelve a inicializar con la selección completa cuando se invoca ese verbo.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-145">The verb is then re-created and re-initialized with the full selection when that verb is invoked.</span></span>

<span data-ttu-id="f9c4c-146">En algunos casos, es conveniente considerar un pequeño número de elementos fijos.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-146">It is appropriate in some cases to consider a small number of fixed items.</span></span> <span data-ttu-id="f9c4c-147">Por ejemplo, es adecuado para un verbo "diff" considerar solo los dos primeros elementos.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-147">For example, it is appropriate for a "diff" verb to consider only the first two items.</span></span> <span data-ttu-id="f9c4c-148">Por lo general, no es necesario probar todos los elementos de la selección para ver si se trata de un tipo determinado, o bien realizar una consulta en todos los elementos de la selección para sus propiedades.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-148">Generally, you need not test every item in the selection to see if it is a certain type, or query every item in the selection for its properties.</span></span> <span data-ttu-id="f9c4c-149">Fíjese en el primer elemento y decida si es adecuado agregar el verbo.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-149">Look rather at the first item and decide if it is appropriate to add your verb.</span></span>

### <a name="heterogenous-selections"></a><span data-ttu-id="f9c4c-150">Selecciones heterogéneas</span><span class="sxs-lookup"><span data-stu-id="f9c4c-150">Heterogenous Selections</span></span>

<span data-ttu-id="f9c4c-151">Los verbos optimistas se agregan automáticamente en el caso de selección múltiple, suponiendo que los elementos no inspeccionados se pueden controlar mediante el verbo.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-151">Optimistic verbs are automatically added in the multi-selection case, assuming that uninspected items can be handled by the verb.</span></span> <span data-ttu-id="f9c4c-152">En cambio, los verbos pesimistas no se agregan cuando la selección contiene elementos sin inspeccionar y solo se agregan en casos en los que el número de elementos es pequeño.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-152">In contrast, pessimistic verbs are not added when the selection contains uninspected items, and are only added in cases where the number of items is small.</span></span>

<span data-ttu-id="f9c4c-153">Los verbos de estilo de reproductor deben ser optimistas y omitir silenciosamente los elementos que no se controlan.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-153">Player style verbs should be optimistic, and silently skip the items that are not handled.</span></span> <span data-ttu-id="f9c4c-154">Si un error al actuar en los elementos puede provocar la pérdida de datos o confusión, el verbo debe advertir a los usuarios sobre los elementos que no se pueden procesar.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-154">If a failure to act on items can cause data loss or confusion, then the verb should warn users about items that cannot be processed.</span></span> <span data-ttu-id="f9c4c-155">Por ejemplo, un verbo "backup" debería indicar que no se pudo realizar una copia de seguridad de algunos elementos.</span><span class="sxs-lookup"><span data-stu-id="f9c4c-155">For example a "backup" verb should indicate that some items could not be backed up.</span></span>

## <a name="related-topics"></a><span data-ttu-id="f9c4c-156">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="f9c4c-156">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f9c4c-157">Elegir un verbo estático o dinámico para el menú contextual</span><span class="sxs-lookup"><span data-stu-id="f9c4c-157">Choosing a Static or Dynamic Verb for your Shortcut Menu</span></span>](shortcut-choose-method.md)
</dt> <dt>

[<span data-ttu-id="f9c4c-158">Crear controladores de menú contextual</span><span class="sxs-lookup"><span data-stu-id="f9c4c-158">Creating Shortcut Menu Handlers</span></span>](context-menu-handlers.md)
</dt> <dt>

[<span data-ttu-id="f9c4c-159">Personalización de un menú contextual mediante verbos dinámicos</span><span class="sxs-lookup"><span data-stu-id="f9c4c-159">Customizing a Shortcut Menu Using Dynamic Verbs</span></span>](shortcut-menu-using-dynamic-verbs.md)
</dt> <dt>

[<span data-ttu-id="f9c4c-160">Menús contextuales y controladores de menú contextual</span><span class="sxs-lookup"><span data-stu-id="f9c4c-160">Shortcut (Context) Menus and Shortcut Menu Handlers</span></span>](context-menu.md)
</dt> <dt>

[<span data-ttu-id="f9c4c-161">Verbos y asociaciones de archivo</span><span class="sxs-lookup"><span data-stu-id="f9c4c-161">Verbs and File Associations</span></span>](fa-verbs.md)
</dt> <dt>

[<span data-ttu-id="f9c4c-162">Referencia del menú contextual</span><span class="sxs-lookup"><span data-stu-id="f9c4c-162">Shortcut Menu Reference</span></span>](context-menu-reference.md)
</dt> </dl>

 

 



