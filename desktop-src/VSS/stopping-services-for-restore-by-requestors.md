---
description: Puede que sea necesario detener un servicio antes de y reiniciarlo después de una operación de restauración.
ms.assetid: 111d1281-ad83-49bc-868c-1106a0e25a2a
title: Detención de servicios para restauración por solicitante
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 548af25a4b4550d35a8e6fa4d4c0e791897b6e0a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "105697146"
---
# <a name="stopping-services-for-restore-by-requesters"></a><span data-ttu-id="7e96d-103">Detención de servicios para restauración por solicitante</span><span class="sxs-lookup"><span data-stu-id="7e96d-103">Stopping Services for Restore by Requesters</span></span>

<span data-ttu-id="7e96d-104">Puede que sea necesario detener un servicio antes de y reiniciarlo después de una operación de restauración.</span><span class="sxs-lookup"><span data-stu-id="7e96d-104">It may be necessary for a service to be stopped prior to and restarted following a restore operation.</span></span>

<span data-ttu-id="7e96d-105">Normalmente, la detención e inicio de un servicio para admitir una restauración la realizaría un escritor al controlar el evento [*Prerestore*](vssgloss-p.md) (con [**CVssWriter:: OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore)) y el evento [*postrestore*](vssgloss-p.md) (con [**CVssWriter:: OnPostRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostrestore)).</span><span class="sxs-lookup"><span data-stu-id="7e96d-105">Typically, stopping and starting a service to support a restore would be performed by a writer when handling the [*PreRestore*](vssgloss-p.md) event (with [**CVssWriter::OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore)) and the [*PostRestore*](vssgloss-p.md) event (with [**CVssWriter::OnPostRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostrestore)).</span></span>

<span data-ttu-id="7e96d-106">Sin embargo, puede haber casos en los que sea necesario que un solicitante detenga explícitamente un servicio en ejecución.</span><span class="sxs-lookup"><span data-stu-id="7e96d-106">However, there may be cases when it is necessary for a requester to explicitly stop a running service.</span></span> <span data-ttu-id="7e96d-107">Los escritores indican si este es el caso estableciendo el \_ \_ valor de VSS RME STOP \_ restore \_ Start o VSS \_ RME \_ restore \_ Stop \_ Start de la enumeración de [**\_ \_ enumeración RESTOREMETHOD de VSS**](/windows/desktop/api/VsWriter/ne-vswriter-vss_restoremethod_enum) como argumento de método de restauración de una llamada al método [**IVssCreateWriterMetadata:: SetRestoreMethod**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setrestoremethod) y especificando el nombre del servicio que se va a detener.</span><span class="sxs-lookup"><span data-stu-id="7e96d-107">Writers indicate if this is the case by setting the VSS\_RME\_STOP\_RESTORE\_START or VSS\_RME\_RESTORE\_STOP\_START value of the [**VSS\_RESTOREMETHOD\_ENUM**](/windows/desktop/api/VsWriter/ne-vswriter-vss_restoremethod_enum) enumeration as the restore method argument of a call to the [**IVssCreateWriterMetadata::SetRestoreMethod**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setrestoremethod) method and specifying the name of the service to be stopped.</span></span>

<span data-ttu-id="7e96d-108">Un solicitante obtiene información sobre el método restore y el nombre del servicio que se va a detener cuando se trabaja con metadatos del escritor mediante el método [**IVssExamineWriterMetadata:: GetRestoreMethod**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getrestoremethod) .</span><span class="sxs-lookup"><span data-stu-id="7e96d-108">A requester obtains information about the restore method and the name of the service to be stopped when working with writer metadata by using the [**IVssExamineWriterMetadata::GetRestoreMethod**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getrestoremethod) method.</span></span>

<span data-ttu-id="7e96d-109">Es importante que el escritor, al especificar el nombre de un servicio que se va a detener, use el nombre público conocido de ese servicio.</span><span class="sxs-lookup"><span data-stu-id="7e96d-109">It is important that the writer, when specifying the name of a service to be stopped, uses the correct publicly known name of that service.</span></span> <span data-ttu-id="7e96d-110">Un nombre ambiguo o inexacto puede dar lugar a que los solicitantes detengan el servicio equivocado o no puedan determinar qué servicio se debe detener.</span><span class="sxs-lookup"><span data-stu-id="7e96d-110">An ambiguous or inaccurate name may result in requesters stopping the wrong service or being unable to determine which service to stop.</span></span>

<span data-ttu-id="7e96d-111">Una vez finalizada la operación de restauración, los solicitantes deben reiniciar el servicio.</span><span class="sxs-lookup"><span data-stu-id="7e96d-111">After the completion of the restore operation, requesters must restart the service.</span></span>

<span data-ttu-id="7e96d-112">Debe tener cuidado al diseñar e implementar escritores que admitan servicios que los solicitantes deben detener y reiniciar.</span><span class="sxs-lookup"><span data-stu-id="7e96d-112">You must be careful in designing and implementing writers that support services that requesters must stop and restart.</span></span> <span data-ttu-id="7e96d-113">En concreto, estos escritores no deberían formar parte del servicio, es decir, el propio escritor no debe detenerse y reiniciarse en el transcurso de la operación de restauración.</span><span class="sxs-lookup"><span data-stu-id="7e96d-113">Specifically, such writers should not actually be part of the service—that is, the writer itself should not need to be stopped and then restarted in the course of the restore operation.</span></span>

<span data-ttu-id="7e96d-114">Un escritor cuyo proceso se detiene tendrá una instancia de escritor diferente tras el reinicio.</span><span class="sxs-lookup"><span data-stu-id="7e96d-114">A writer whose process is stopped will have a different writer instance upon restart.</span></span> <span data-ttu-id="7e96d-115">La nueva instancia del escritor no recibirá eventos de VSS destinados a la instancia original del escritor.</span><span class="sxs-lookup"><span data-stu-id="7e96d-115">The new instance of the writer will not receive VSS events intended for the original instance of the writer.</span></span> <span data-ttu-id="7e96d-116">En concreto, si se detiene el proceso de una instancia de escritor después de controlar un evento de prerestauración, la nueva instancia no recibirá el evento postrestore.</span><span class="sxs-lookup"><span data-stu-id="7e96d-116">Specifically, if the process of a writer instance is stopped after handling a PreRestore event, the new instance will not receive the PostRestore event.</span></span> <span data-ttu-id="7e96d-117">Además, VSS generará un error que indica la pérdida de un escritor participante en la operación de restauración y [**IVssBackupComponents::P ostrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore) puede devolver un error.</span><span class="sxs-lookup"><span data-stu-id="7e96d-117">Further, VSS will generate an error indicating the loss of a participating writer in the restore operation, and [**IVssBackupComponents::PostRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore) may return a failure.</span></span>

 

 



