---
description: Objeto que encapsula varios DSP relacionados con la captura de voz.
ms.assetid: 6c77c8f6-289e-4130-b56a-e1f0bcc40f3e
title: DSP de captura de voz (Wmcodecdsp. h)
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 6e48c3b3194873008f45ef80ef3a21dad416158b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "103812571"
---
# <a name="voice-capture-dsp"></a><span data-ttu-id="227b8-103">DSP de captura de voz</span><span class="sxs-lookup"><span data-stu-id="227b8-103">Voice Capture DSP</span></span>

<span data-ttu-id="227b8-104">Objeto que encapsula varios DSP relacionados con la captura de voz.</span><span class="sxs-lookup"><span data-stu-id="227b8-104">An object that encapsulates several DSPs related to voice capture.</span></span>

## <a name="clsid"></a><span data-ttu-id="227b8-105">CLSID</span><span class="sxs-lookup"><span data-stu-id="227b8-105">CLSID</span></span>

<span data-ttu-id="227b8-106">CLSID \_ CWMAudioAEC</span><span class="sxs-lookup"><span data-stu-id="227b8-106">CLSID\_CWMAudioAEC</span></span>

## <a name="interfaces"></a><span data-ttu-id="227b8-107">Interfaces</span><span class="sxs-lookup"><span data-stu-id="227b8-107">Interfaces</span></span>

-   [<span data-ttu-id="227b8-108">**IMediaObject**</span><span class="sxs-lookup"><span data-stu-id="227b8-108">**IMediaObject**</span></span>](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediaobject)
-   <span data-ttu-id="227b8-109">**IPropertyStore**</span><span class="sxs-lookup"><span data-stu-id="227b8-109">**IPropertyStore**</span></span>

## <a name="properties"></a><span data-ttu-id="227b8-110">Propiedades</span><span class="sxs-lookup"><span data-stu-id="227b8-110">Properties</span></span>



| <span data-ttu-id="227b8-111">Propiedad</span><span class="sxs-lookup"><span data-stu-id="227b8-111">Property</span></span>                                                                                     | <span data-ttu-id="227b8-112">Descripción</span><span class="sxs-lookup"><span data-stu-id="227b8-112">Description</span></span>                                                                                       |
|----------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="227b8-113">MFPKEY \_ \_ índices de dispositivo WMAAECMA \_</span><span class="sxs-lookup"><span data-stu-id="227b8-113">MFPKEY\_WMAAECMA\_DEVICE\_INDEXES</span></span>](mfpkey-wmaaecma-device-indexesproperty.md)              | <span data-ttu-id="227b8-114">Especifica qué dispositivos de audio usa DMO para capturar y representar audio.</span><span class="sxs-lookup"><span data-stu-id="227b8-114">Specifies which audio devices the DMO uses for capturing and rendering audio.</span></span>                     |
| [<span data-ttu-id="227b8-115">MFPKEY \_ WMAAECMA \_ DEVICEPAIR \_ GUID</span><span class="sxs-lookup"><span data-stu-id="227b8-115">MFPKEY\_WMAAECMA\_DEVICEPAIR\_GUID</span></span>](mfpkey-wmaaecma-devicepair-guidproperty.md)            | <span data-ttu-id="227b8-116">Identifica la combinación de dispositivos de audio que la aplicación está usando actualmente.</span><span class="sxs-lookup"><span data-stu-id="227b8-116">Identifies the combination of audio devices that the application is currently using.</span></span>              |
| [<span data-ttu-id="227b8-117">modo de origen de MFPKEY \_ WMAAECMA \_ DMO \_ \_</span><span class="sxs-lookup"><span data-stu-id="227b8-117">MFPKEY\_WMAAECMA\_DMO\_SOURCE\_MODE</span></span>](mfpkey-wmaaecma-dmo-source-modeproperty.md)           | <span data-ttu-id="227b8-118">Especifica si DMO utiliza el modo de origen o el modo de filtro.</span><span class="sxs-lookup"><span data-stu-id="227b8-118">Specifies whether the DMO uses source mode or filter mode.</span></span>                                        |
| [<span data-ttu-id="227b8-119">MFPKEY \_ WMAAECMA \_ feat \_ AES</span><span class="sxs-lookup"><span data-stu-id="227b8-119">MFPKEY\_WMAAECMA\_FEATR\_AES</span></span>](mfpkey-wmaaecma-featr-aesproperty.md)                        | <span data-ttu-id="227b8-120">Especifica el número de veces que DMO realiza la supresión del eco acústico (AES) en la señal residual.</span><span class="sxs-lookup"><span data-stu-id="227b8-120">Specifies how many times the DMO performs acoustic echo suppression (AES) on the residual signal.</span></span> |
| [<span data-ttu-id="227b8-121">MFPKEY \_ WMAAECMA \_ feat \_ AGC</span><span class="sxs-lookup"><span data-stu-id="227b8-121">MFPKEY\_WMAAECMA\_FEATR\_AGC</span></span>](mfpkey-wmaaecma-featr-agcproperty.md)                        | <span data-ttu-id="227b8-122">Especifica si DMO realiza el control de ganancia automática.</span><span class="sxs-lookup"><span data-stu-id="227b8-122">Specifies whether the DMO performs automatic gain control.</span></span>                                        |
| [<span data-ttu-id="227b8-123">\_clip del \_ \_ Centro \_ de MFPKEY WMAAECMA</span><span class="sxs-lookup"><span data-stu-id="227b8-123">MFPKEY\_WMAAECMA\_FEATR\_CENTER\_CLIP</span></span>](mfpkey-wmaaecma-featr-center-clipproperty.md)       | <span data-ttu-id="227b8-124">Especifica si DMO realiza el recorte del centro.</span><span class="sxs-lookup"><span data-stu-id="227b8-124">Specifies whether the DMO performs center clipping.</span></span>                                               |
| [<span data-ttu-id="227b8-125">\_longitud del \_ eco del funcdor de MFPKEY WMAAECMA \_ \_</span><span class="sxs-lookup"><span data-stu-id="227b8-125">MFPKEY\_WMAAECMA\_FEATR\_ECHO\_LENGTH</span></span>](mfpkey-wmaaecma-featr-echo-lengthproperty.md)       | <span data-ttu-id="227b8-126">Especifica la duración del eco que puede controlar el algoritmo de cancelación del eco acústico (AEC).</span><span class="sxs-lookup"><span data-stu-id="227b8-126">Specifies the duration of echo that the acoustic echo cancellation (AEC) algorithm can handle.</span></span>    |
| [<span data-ttu-id="227b8-127">\_tamaño de \_ \_ marco \_ del MFPKEY de WMAAECMA</span><span class="sxs-lookup"><span data-stu-id="227b8-127">MFPKEY\_WMAAECMA\_FEATR\_FRAME\_SIZE</span></span>](mfpkey-wmaaecma-featr-frame-sizeproperty.md)         | <span data-ttu-id="227b8-128">Especifica el tamaño del fotograma de audio.</span><span class="sxs-lookup"><span data-stu-id="227b8-128">Specifies the audio frame size.</span></span>                                                                   |
| [<span data-ttu-id="227b8-129">MFPKEY \_ WMAAECMA \_ feat \_ MICARR \_</span><span class="sxs-lookup"><span data-stu-id="227b8-129">MFPKEY\_WMAAECMA\_FEATR\_MICARR\_BEAM</span></span>](mfpkey-wmaaecma-featr-micarr-beamproperty.md)       | <span data-ttu-id="227b8-130">Especifica qué viga utiliza DMO para el procesamiento de la matriz de micrófono.</span><span class="sxs-lookup"><span data-stu-id="227b8-130">Specifies which beam the DMO uses for microphone array processing.</span></span>                                |
| [<span data-ttu-id="227b8-131">\_ \_ \_ modo MICARR MFPKEY WMAAECMA feat \_</span><span class="sxs-lookup"><span data-stu-id="227b8-131">MFPKEY\_WMAAECMA\_FEATR\_MICARR\_MODE</span></span>](mfpkey-wmaaecma-featr-micarr-modeproperty.md)       | <span data-ttu-id="227b8-132">Especifica cómo DMO realiza el procesamiento de la matriz de micrófono.</span><span class="sxs-lookup"><span data-stu-id="227b8-132">Specifies how the DMO performs microphone array processing.</span></span>                                       |
| [<span data-ttu-id="227b8-133">MFPKEY \_ WMAAECMA \_ feat \_ MICARR \_ preproc</span><span class="sxs-lookup"><span data-stu-id="227b8-133">MFPKEY\_WMAAECMA\_FEATR\_MICARR\_PREPROC</span></span>](mfpkey-wmaaecma-featr-micarr-preprocproperty.md) | <span data-ttu-id="227b8-134">Especifica si DMO realiza el preprocesamiento de la matriz de micrófono.</span><span class="sxs-lookup"><span data-stu-id="227b8-134">Specifies whether the DMO performs microphone array preprocessing.</span></span>                                |
| [<span data-ttu-id="227b8-135">\_relleno de \_ \_ ruido \_ de MFPKEY WMAAECMA</span><span class="sxs-lookup"><span data-stu-id="227b8-135">MFPKEY\_WMAAECMA\_FEATR\_NOISE\_FILL</span></span>](mfpkey-wmaaecma-featr-noise-fillproperty.md)         | <span data-ttu-id="227b8-136">Especifica si DMO realiza el relleno de ruido.</span><span class="sxs-lookup"><span data-stu-id="227b8-136">Specifies whether the DMO performs noise filling.</span></span>                                                 |
| [<span data-ttu-id="227b8-137">MFPKEY \_ WMAAECMA \_ feat \_</span><span class="sxs-lookup"><span data-stu-id="227b8-137">MFPKEY\_WMAAECMA\_FEATR\_NS</span></span>](mfpkey-wmaaecma-featr-nsproperty.md)                          | <span data-ttu-id="227b8-138">Especifica si DMO realiza la supresión de ruido.</span><span class="sxs-lookup"><span data-stu-id="227b8-138">Specifies whether the DMO performs noise suppression.</span></span>                                             |
| [<span data-ttu-id="227b8-139">MFPKEY \_ WMAAECMA \_ feat \_ VAD</span><span class="sxs-lookup"><span data-stu-id="227b8-139">MFPKEY\_WMAAECMA\_FEATR\_VAD</span></span>](mfpkey-wmaaecma-featr-vadproperty.md)                        | <span data-ttu-id="227b8-140">Especifica el tipo de detección de la actividad de voz que realiza DMO.</span><span class="sxs-lookup"><span data-stu-id="227b8-140">Specifies the type of voice activity detection that the DMO performs.</span></span>                             |
| [<span data-ttu-id="227b8-141">modo de característica de MFPKEY \_ WMAAECMA \_ \_</span><span class="sxs-lookup"><span data-stu-id="227b8-141">MFPKEY\_WMAAECMA\_FEATURE\_MODE</span></span>](mfpkey-wmaaecma-feature-modeproperty.md)                  | <span data-ttu-id="227b8-142">Permite que la aplicación invalide la configuración predeterminada en varias propiedades.</span><span class="sxs-lookup"><span data-stu-id="227b8-142">Enables the application to override the default settings on various properties.</span></span>                   |
| [<span data-ttu-id="227b8-143">\_ \_ \_ enlazador de ganancia de MFPKEY WMAAECMA MIC \_</span><span class="sxs-lookup"><span data-stu-id="227b8-143">MFPKEY\_WMAAECMA\_MIC\_GAIN\_BOUNDER</span></span>](mfpkey-wmaaecma-mic-gain-bounderproperty.md)         | <span data-ttu-id="227b8-144">Especifica si DMO aplica el límite de ganancia de micrófono.</span><span class="sxs-lookup"><span data-stu-id="227b8-144">Specifies whether the DMO applies microphone gain bounding.</span></span>                                       |
| [<span data-ttu-id="227b8-145">MFPKEY \_ WMAAECMA \_ MICARRAY \_ DESCPTR</span><span class="sxs-lookup"><span data-stu-id="227b8-145">MFPKEY\_WMAAECMA\_MICARRAY\_DESCPTR</span></span>](mfpkey-wmaaecma-micarray-descptrproperty.md)          | <span data-ttu-id="227b8-146">Especifica la geometría de la matriz de micrófono.</span><span class="sxs-lookup"><span data-stu-id="227b8-146">Specifies the microphone array geometry.</span></span>                                                          |
| [<span data-ttu-id="227b8-147">\_ \_ métricas de calidad de MFPKEY WMAAECMA \_</span><span class="sxs-lookup"><span data-stu-id="227b8-147">MFPKEY\_WMAAECMA\_QUALITY\_METRICS</span></span>](mfpkey-wmaaecma-quality-metricsproperty.md)            | <span data-ttu-id="227b8-148">Recupera las métricas de calidad de AEC.</span><span class="sxs-lookup"><span data-stu-id="227b8-148">Retrieves quality metrics for AEC.</span></span>                                                                |
| [<span data-ttu-id="227b8-149">MFPKEY \_ WMAAECMA \_ recuperar \_ estadísticas de TS \_</span><span class="sxs-lookup"><span data-stu-id="227b8-149">MFPKEY\_WMAAECMA\_RETRIEVE\_TS\_STATS</span></span>](mfpkey-wmaaecma-retrieve-ts-statsproperty.md)       | <span data-ttu-id="227b8-150">Especifica si DMO almacena las estadísticas de marca de tiempo en el registro.</span><span class="sxs-lookup"><span data-stu-id="227b8-150">Specifies whether the DMO stores time stamp statistics in the registry.</span></span>                           |
| [<span data-ttu-id="227b8-151">modo de sistema de MFPKEY \_ WMAAECMA \_ \_</span><span class="sxs-lookup"><span data-stu-id="227b8-151">MFPKEY\_WMAAECMA\_SYSTEM\_MODE</span></span>](mfpkey-wmaaecma-system-modeproperty.md)                    | <span data-ttu-id="227b8-152">Establece el modo de procesamiento.</span><span class="sxs-lookup"><span data-stu-id="227b8-152">Sets the processing mode.</span></span>                                                                         |



 

## <a name="remarks"></a><span data-ttu-id="227b8-153">Observaciones</span><span class="sxs-lookup"><span data-stu-id="227b8-153">Remarks</span></span>

<span data-ttu-id="227b8-154">A diferencia de los demás DSP, el objeto de captura de voz encapsula varios DSP en un solo objeto y el objeto es solo un objeto DMO (no implementa [**IMFTransform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform)).</span><span class="sxs-lookup"><span data-stu-id="227b8-154">Unlike the other DSPs, the voice capture object encapsulates multiple DSPs in a single object, and the object is a DMO object only (it does not implement [**IMFTransform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform)).</span></span> <span data-ttu-id="227b8-155">La captura de voz DMO incluye los siguientes componentes de DSP:</span><span class="sxs-lookup"><span data-stu-id="227b8-155">The voice capture DMO includes the following DSP components:</span></span>

-   <span data-ttu-id="227b8-156">Cancelación del eco acústico (AEC)</span><span class="sxs-lookup"><span data-stu-id="227b8-156">Acoustic echo cancellation (AEC)</span></span>
-   <span data-ttu-id="227b8-157">Procesamiento de la matriz de micrófono</span><span class="sxs-lookup"><span data-stu-id="227b8-157">Microphone array processing</span></span>
-   <span data-ttu-id="227b8-158">Supresión de ruido</span><span class="sxs-lookup"><span data-stu-id="227b8-158">Noise suppression</span></span>
-   <span data-ttu-id="227b8-159">Control de ganancia automática</span><span class="sxs-lookup"><span data-stu-id="227b8-159">Automatic gain control</span></span>
-   <span data-ttu-id="227b8-160">Detección de actividad de voz</span><span class="sxs-lookup"><span data-stu-id="227b8-160">Voice activity detection</span></span>

<span data-ttu-id="227b8-161">Las aplicaciones pueden activar y desactivar cada componente de forma individual.</span><span class="sxs-lookup"><span data-stu-id="227b8-161">Applications can turn each component on and off individually.</span></span>

<span data-ttu-id="227b8-162">La captura de voz DMO admite dos modos de funcionamiento, modo de *filtro* y modo de *origen* .</span><span class="sxs-lookup"><span data-stu-id="227b8-162">The voice capture DMO supports two modes of operation, *filter* mode and *source* mode.</span></span> <span data-ttu-id="227b8-163">En el modo de filtro, la aplicación envía muestras de audio desde el micrófono y desde la línea del altavoz hasta el DMO, y el DMO genera una salida.</span><span class="sxs-lookup"><span data-stu-id="227b8-163">In filter mode, the application sends audio samples from the microphone and from the speaker line to the DMO, and the DMO produces output.</span></span>

<span data-ttu-id="227b8-164">En el modo de origen, la aplicación no necesita proporcionar ejemplos a DMO.</span><span class="sxs-lookup"><span data-stu-id="227b8-164">In source mode, the application does not need to deliver samples to the DMO.</span></span> <span data-ttu-id="227b8-165">En su lugar, el DMO administra todas las operaciones en los dispositivos de audio, incluida la inicialización de los dispositivos, la captura y la sincronización de las secuencias de audio, el cálculo de las marcas de tiempo y la recuperación de la geometría de la matriz de micrófono.</span><span class="sxs-lookup"><span data-stu-id="227b8-165">Instead, the DMO manages all of the operations on the audio devices, including initializing the devices, capturing and synchronizing the audio streams, calculating time stamps, and retrieving the geometry of the microphone array.</span></span> <span data-ttu-id="227b8-166">Con el modo de origen, la aplicación simplemente configura DMO y la salida de DMO es una señal de micrófono limpia y procesada.</span><span class="sxs-lookup"><span data-stu-id="227b8-166">Using source mode, the application simply configures the DMO, and the output from the DMO is a clean, processed microphone signal.</span></span> <span data-ttu-id="227b8-167">El modo de origen es mucho más fácil de usar que el modo de filtro y se recomienda para la mayoría de las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="227b8-167">Source mode is significantly easier to use than filter mode, and is recommended for most applications.</span></span>

<span data-ttu-id="227b8-168">Actualmente, la captura de voz DMO solo admite la cancelación de eco acústico (AEC) de canal único, por lo que la salida de la línea de altavoz debe ser de un solo canal.</span><span class="sxs-lookup"><span data-stu-id="227b8-168">Currently the voice capture DMO supports only single-channel acoustic echo cancellation (AEC), so the output from the speaker line must be single-channel.</span></span> <span data-ttu-id="227b8-169">Si el procesamiento de la matriz de micrófono está deshabilitado, la entrada de varios canales se dobla hacia abajo a un canal para el procesamiento de AEC.</span><span class="sxs-lookup"><span data-stu-id="227b8-169">If microphone array processing is disabled, multi-channel input is folded down to one channel for AEC processing.</span></span> <span data-ttu-id="227b8-170">Si el procesamiento de la matriz de micrófonos y el procesamiento de AEC están habilitados, AEC se realiza en cada elemento de micrófono antes del procesamiento de la matriz de micrófono.</span><span class="sxs-lookup"><span data-stu-id="227b8-170">If both microphone array processing and AEC processing are enabled, AEC is performed on each microphone element before microphone array processing.</span></span>

### <a name="microphone-array-processing"></a><span data-ttu-id="227b8-171">Procesamiento de la matriz de micrófono</span><span class="sxs-lookup"><span data-stu-id="227b8-171">Microphone Array Processing</span></span>

<span data-ttu-id="227b8-172">Una matriz de micrófonos es un conjunto de micrófonos muy colocados.</span><span class="sxs-lookup"><span data-stu-id="227b8-172">A microphone array is a set of closely positioned microphones.</span></span> <span data-ttu-id="227b8-173">Las matrices de micrófonos logran una mejor direccional que un micrófono único, ya que las ondas acústicas llegan a cada micrófono en un momento ligeramente diferente.</span><span class="sxs-lookup"><span data-stu-id="227b8-173">Microphone arrays achieve better directionality than a single microphone, because the acoustic waves arrive at each microphone at a slightly different time.</span></span> <span data-ttu-id="227b8-174">Para obtener más información acerca de las matrices de micrófono, consulte los artículos web [compatibilidad con matrices de micrófono en Windows Vista](/windows-hardware/design/component-guidelines/audio) y [cómo compilar y usar matrices de micrófonos para Windows Vista](/windows-hardware/drivers/audio/microphone-array-geometry-descriptor-format).</span><span class="sxs-lookup"><span data-stu-id="227b8-174">For more information on microphone arrays see the web articles [Microphone Array Support in Windows Vista](/windows-hardware/design/component-guidelines/audio) and [How to Build and Use Microphone Arrays for Windows Vista](/windows-hardware/drivers/audio/microphone-array-geometry-descriptor-format).</span></span>

### <a name="using-the-voice-capture-dsp"></a><span data-ttu-id="227b8-175">Uso del DSP de captura de voz</span><span class="sxs-lookup"><span data-stu-id="227b8-175">Using the Voice Capture DSP</span></span>

<span data-ttu-id="227b8-176">Para usar la captura de voz DSP, realice los pasos siguientes.</span><span class="sxs-lookup"><span data-stu-id="227b8-176">To use the Voice Capture DSP, perform the following steps.</span></span>

### <a name="1-initialize-the-dmo"></a><span data-ttu-id="227b8-177">1. inicializar DMO</span><span class="sxs-lookup"><span data-stu-id="227b8-177">1. Initialize the DMO</span></span>

<span data-ttu-id="227b8-178">Cree la función de captura de voz DMO llamando a [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) con CLSID **CLSID \_ CWMAudioAEC**.</span><span class="sxs-lookup"><span data-stu-id="227b8-178">Create the voice capture DMO by calling [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) with the CLSID **CLSID\_CWMAudioAEC**.</span></span> <span data-ttu-id="227b8-179">La captura de voz DSDP expone solo las interfaces [**IMediaObject**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediaobject) y [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) , por lo que solo se puede usar como DMO.</span><span class="sxs-lookup"><span data-stu-id="227b8-179">The voice capture DSDP exposes only the [**IMediaObject**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediaobject) and [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) interfaces, so it can only be used as a DMO.</span></span>

<span data-ttu-id="227b8-180">DMO tiene como valor predeterminado el modo de origen.</span><span class="sxs-lookup"><span data-stu-id="227b8-180">The DMO defaults to source mode.</span></span> <span data-ttu-id="227b8-181">Para seleccionar el modo de filtro, establezca la propiedad [MFPKEY \_ WMAAECMA \_ DMO \_ source \_ mode](mfpkey-wmaaecma-dmo-source-modeproperty.md) en **Variant \_ false**.</span><span class="sxs-lookup"><span data-stu-id="227b8-181">To select filter mode, set the [MFPKEY\_WMAAECMA\_DMO\_SOURCE\_MODE](mfpkey-wmaaecma-dmo-source-modeproperty.md) property to **VARIANT\_FALSE**.</span></span>

<span data-ttu-id="227b8-182">A continuación, configure las propiedades internas de DMO mediante la interfaz [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) .</span><span class="sxs-lookup"><span data-stu-id="227b8-182">Next, configure the internal properties of the DMO by using the [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) interface.</span></span> <span data-ttu-id="227b8-183">La única propiedad que debe establecer una aplicación es la propiedad de [ \_ \_ \_ modo del sistema MFPKEY WMAAECMA](mfpkey-wmaaecma-system-modeproperty.md) .</span><span class="sxs-lookup"><span data-stu-id="227b8-183">The only property that an application must set is the [MFPKEY\_WMAAECMA\_SYSTEM\_MODE](mfpkey-wmaaecma-system-modeproperty.md) property.</span></span> <span data-ttu-id="227b8-184">Esta propiedad configura la canalización de procesamiento dentro de DMO.</span><span class="sxs-lookup"><span data-stu-id="227b8-184">This property configures the processing pipeline within the DMO.</span></span> <span data-ttu-id="227b8-185">Las demás propiedades son opcionales.</span><span class="sxs-lookup"><span data-stu-id="227b8-185">The other properties are optional.</span></span>

### <a name="2-set-the-input-and-output-formats"></a><span data-ttu-id="227b8-186">2. establecer los formatos de entrada y salida</span><span class="sxs-lookup"><span data-stu-id="227b8-186">2. Set the Input and Output Formats</span></span>

<span data-ttu-id="227b8-187">Si usa DMO en modo de filtro, establezca el formato de entrada mediante una llamada a [**IMediaObject:: SetInputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setinputtype).</span><span class="sxs-lookup"><span data-stu-id="227b8-187">If you are using the DMO in filter mode, set the input format by calling [**IMediaObject::SetInputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setinputtype).</span></span> <span data-ttu-id="227b8-188">El formato de entrada puede ser prácticamente cualquier PCM sin comprimir o tipo de audio de punto flotante de IEEE válido.</span><span class="sxs-lookup"><span data-stu-id="227b8-188">The input format can be almost any valid uncompressed PCM or IEEE floating-point audio type.</span></span> <span data-ttu-id="227b8-189">Si el formato de entrada no coincide con el formato de salida, DMO realiza automáticamente la conversión de velocidad de muestra.</span><span class="sxs-lookup"><span data-stu-id="227b8-189">If the input format does not match the output format, the DMO automatically performs sample-rate conversion.</span></span>

<span data-ttu-id="227b8-190">Si usa DMO en modo de origen, no establezca el formato de entrada.</span><span class="sxs-lookup"><span data-stu-id="227b8-190">If you are using the DMO in source mode, do not set the input format.</span></span> <span data-ttu-id="227b8-191">DMO configura automáticamente el formato de entrada basado en los dispositivos de audio.</span><span class="sxs-lookup"><span data-stu-id="227b8-191">The DMO automatically configures the input format based on the audio devices.</span></span>

<span data-ttu-id="227b8-192">En cualquier modo, establezca el formato de salida llamando a [**IMediaObject:: SetOutputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setoutputtype).</span><span class="sxs-lookup"><span data-stu-id="227b8-192">In either mode, set the output format by calling [**IMediaObject::SetOutputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setoutputtype).</span></span> <span data-ttu-id="227b8-193">DMO puede aceptar los siguientes formatos de salida:</span><span class="sxs-lookup"><span data-stu-id="227b8-193">The DMO can accept the following output formats:</span></span>

-   <span data-ttu-id="227b8-194">SubType: **MEDIASUBTYPE \_ PCM** o **MEDIASUBTYPE \_ IEEE \_ float**</span><span class="sxs-lookup"><span data-stu-id="227b8-194">Subtype: **MEDIASUBTYPE\_PCM** or **MEDIASUBTYPE\_IEEE\_FLOAT**</span></span>
-   <span data-ttu-id="227b8-195">Bloque de formato: [**WAVEFORMAT**](/windows/win32/api/mmreg/ns-mmreg-waveformat) o [**WAVEFORMATEX**](/previous-versions/dd757713(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="227b8-195">Format block: [**WAVEFORMAT**](/windows/win32/api/mmreg/ns-mmreg-waveformat) or [**WAVEFORMATEX**](/previous-versions/dd757713(v=vs.85))</span></span>
-   <span data-ttu-id="227b8-196">Muestras por segundo: 8.000; 11.025; 16.000; o 22.050</span><span class="sxs-lookup"><span data-stu-id="227b8-196">Samples per second: 8,000; 11,025; 16,000; or 22,050</span></span>
-   <span data-ttu-id="227b8-197">Canales: 1 para el modo de solo AEC, 2 o 4 para el procesamiento de la matriz de micrófonos</span><span class="sxs-lookup"><span data-stu-id="227b8-197">Channels: 1 for AEC-only mode, 2 or 4 for microphone array processing</span></span>
-   <span data-ttu-id="227b8-198">Bits por muestra: 16</span><span class="sxs-lookup"><span data-stu-id="227b8-198">Bits per sample: 16</span></span>

<span data-ttu-id="227b8-199">El código siguiente establece el tipo de salida en audio PCM de canal único de 16 bits:</span><span class="sxs-lookup"><span data-stu-id="227b8-199">The following code sets the output type to 16-bit single-channel PCM audio:</span></span>


```
DMO_MEDIA_TYPE mt;  // Media type.
mt.majortype = MEDIATYPE_Audio;
mt.subtype = MEDIASUBTYPE_PCM;
mt.lSampleSize = 0;
mt.bFixedSizeSamples = TRUE;
mt.bTemporalCompression = FALSE;
mt.formattype = FORMAT_WaveFormatEx;

// Allocate the format block to hold the WAVEFORMATEX structure.
hr = MoInitMediaType(&mt, sizeof(WAVEFORMATEX));
if (SUCCEEDED(hr))
{
    WAVEFORMATEX *pwav = (WAVEFORMATEX*)mt.pbFormat;
    pwav->wFormatTag = WAVE_FORMAT_PCM;
    pwav->nChannels = 1;
    pwav->nSamplesPerSec = 16000;
    pwav->nAvgBytesPerSec = 32000;
    pwav->nBlockAlign = 2;
    pwav->wBitsPerSample = 16;
    pwav->cbSize = 0;

    // Set the output type.
    if (SUCCEEDED(hr))
    {
        hr = pDMO->SetOutputType(0, &mt, 0); 
    }
    // Free the format block.
    MoFreeMediaType(&mt);
}
```



### <a name="3-process-data"></a><span data-ttu-id="227b8-200">3. procesar datos</span><span class="sxs-lookup"><span data-stu-id="227b8-200">3. Process Data</span></span>

<span data-ttu-id="227b8-201">Antes de procesar los datos, se recomienda llamar a [**IMediaObject:: AllocateStreamingResources**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-allocatestreamingresources).</span><span class="sxs-lookup"><span data-stu-id="227b8-201">Before processing any data, it is recommended to call [**IMediaObject::AllocateStreamingResources**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-allocatestreamingresources).</span></span> <span data-ttu-id="227b8-202">Este método asigna los recursos utilizados internamente por DMO.</span><span class="sxs-lookup"><span data-stu-id="227b8-202">This method allocates the resources used internally by the DMO.</span></span> <span data-ttu-id="227b8-203">Llame a **AllocateStreamingResources** después de los pasos indicados anteriormente, no antes.</span><span class="sxs-lookup"><span data-stu-id="227b8-203">Call **AllocateStreamingResources** after the steps listed previously, not before.</span></span> <span data-ttu-id="227b8-204">Si no llama a este método, DMO asigna automáticamente los recursos cuando se inicia el procesamiento de datos.</span><span class="sxs-lookup"><span data-stu-id="227b8-204">If you do not call this method, the DMO automatically allocates resources when data processing starts.</span></span>

<span data-ttu-id="227b8-205">Si usa DMO en modo de filtro, debe pasar los datos de entrada a DMO mediante una llamada a [**IMediaObject::P rocessinput**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processinput).</span><span class="sxs-lookup"><span data-stu-id="227b8-205">If you are using the DMO in filter mode, you must pass input data to the DMO by calling [**IMediaObject::ProcessInput**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processinput).</span></span> <span data-ttu-id="227b8-206">Los datos de audio del micrófono van a la secuencia 0 y los datos de audio de la línea del altavoz van a la secuencia 1.</span><span class="sxs-lookup"><span data-stu-id="227b8-206">The audio data from the microphone goes to stream 0, and the audio data from the speaker line goes to stream 1.</span></span> <span data-ttu-id="227b8-207">Si usa DMO en modo de origen, no es necesario llamar a **ProcessInput**.</span><span class="sxs-lookup"><span data-stu-id="227b8-207">If you are using the DMO in source mode, you do not need to call **ProcessInput**.</span></span>

<span data-ttu-id="227b8-208">Para obtener los datos de salida del DSP, realice los pasos siguientes:</span><span class="sxs-lookup"><span data-stu-id="227b8-208">To get output data from the DSP, perform the following steps:</span></span>

1.  <span data-ttu-id="227b8-209">Cree un objeto de búfer para almacenar los datos de salida.</span><span class="sxs-lookup"><span data-stu-id="227b8-209">Create a buffer object to hold the output data.</span></span> <span data-ttu-id="227b8-210">El objeto de búfer debe implementar la interfaz [**IMediaBuffer**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediabuffer) .</span><span class="sxs-lookup"><span data-stu-id="227b8-210">The buffer object must implement the [**IMediaBuffer**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediabuffer) interface.</span></span> <span data-ttu-id="227b8-211">El tamaño del búfer depende de los requisitos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="227b8-211">The size of the buffer depends on the requirements of your application.</span></span> <span data-ttu-id="227b8-212">La asignación de un búfer mayor puede reducir las posibilidades de que se produzcan problemas.</span><span class="sxs-lookup"><span data-stu-id="227b8-212">Allocating a larger buffer can reduce the chances of glitches occurring.</span></span>
2.  <span data-ttu-id="227b8-213">Declare una estructura de búfer de datos de salida de DMO y establezca el miembro **pBuffer** para que apunte al objeto de búfer. [**\_ \_ \_**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer)</span><span class="sxs-lookup"><span data-stu-id="227b8-213">Declare a [**DMO\_OUTPUT\_DATA\_BUFFER**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) structure and set the **pBuffer** member to point to your buffer object.</span></span>
3.  <span data-ttu-id="227b8-214">Pase la estructura de búfer de datos de salida de DMO al método [**IMediaObject::P rocessoutput**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processoutput) . [**\_ \_ \_**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer)</span><span class="sxs-lookup"><span data-stu-id="227b8-214">Pass the [**DMO\_OUTPUT\_DATA\_BUFFER**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) structure to the [**IMediaObject::ProcessOutput**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processoutput) method.</span></span>
4.  <span data-ttu-id="227b8-215">Continúe llamando a este método siempre que el DMO tenga datos de salida.</span><span class="sxs-lookup"><span data-stu-id="227b8-215">Continue to call this method for as long as the DMO has output data.</span></span> <span data-ttu-id="227b8-216">El DSP indica que tiene más resultados estableciendo la marca de **datos de salida de DMO \_ \_ \_ BUFFERF \_ incompleta** en el miembro **dwStatus** de la estructura de [**búfer de datos de salida de DMO \_ \_ \_**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) .</span><span class="sxs-lookup"><span data-stu-id="227b8-216">The DSP signals that it has more output by setting the **DMO\_OUTPUT\_DATA\_BUFFERF\_INCOMPLETE** flag in the **dwStatus** member of the [**DMO\_OUTPUT\_DATA\_BUFFER**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) structure.</span></span>

## <a name="requirements"></a><span data-ttu-id="227b8-217">Requisitos</span><span class="sxs-lookup"><span data-stu-id="227b8-217">Requirements</span></span>



| <span data-ttu-id="227b8-218">Requisito</span><span class="sxs-lookup"><span data-stu-id="227b8-218">Requirement</span></span> | <span data-ttu-id="227b8-219">Value</span><span class="sxs-lookup"><span data-stu-id="227b8-219">Value</span></span> |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| <span data-ttu-id="227b8-220">Cliente mínimo compatible</span><span class="sxs-lookup"><span data-stu-id="227b8-220">Minimum supported client</span></span><br/> | <span data-ttu-id="227b8-221">Solo aplicaciones de escritorio de Windows Vista \[\]</span><span class="sxs-lookup"><span data-stu-id="227b8-221">Windows Vista \[desktop apps only\]</span></span><br/>                                          |
| <span data-ttu-id="227b8-222">Servidor mínimo compatible</span><span class="sxs-lookup"><span data-stu-id="227b8-222">Minimum supported server</span></span><br/> | <span data-ttu-id="227b8-223">Solo aplicaciones de escritorio de Windows Server 2008 \[\]</span><span class="sxs-lookup"><span data-stu-id="227b8-223">Windows Server 2008 \[desktop apps only\]</span></span><br/>                                    |
| <span data-ttu-id="227b8-224">Encabezado</span><span class="sxs-lookup"><span data-stu-id="227b8-224">Header</span></span><br/>                   | <dl> <span data-ttu-id="227b8-225"><dt>Wmcodecdsp. h</dt></span><span class="sxs-lookup"><span data-stu-id="227b8-225"><dt>Wmcodecdsp.h</dt></span></span> </dl> |
| <span data-ttu-id="227b8-226">Archivo DLL</span><span class="sxs-lookup"><span data-stu-id="227b8-226">DLL</span></span><br/>                      | <dl> <span data-ttu-id="227b8-227"><dt>Mfwmaaec.dll</dt></span><span class="sxs-lookup"><span data-stu-id="227b8-227"><dt>Mfwmaaec.dll</dt></span></span> </dl> |



## <a name="see-also"></a><span data-ttu-id="227b8-228">Vea también</span><span class="sxs-lookup"><span data-stu-id="227b8-228">See also</span></span>

<dl> <dt>

[<span data-ttu-id="227b8-229">Procesadores de señal digital</span><span class="sxs-lookup"><span data-stu-id="227b8-229">Digital Signal Processors</span></span>](windowsmediadigitalsignalprocessors.md)
</dt> </dl>

 

 
