---
description: Al inicializar una operación de restauración de VSS, un solicitante debe recuperar el documento del componente de copia de seguridad y cada documento de metadatos de escritor pertinente creado y guardado durante la operación de copia de seguridad.
ms.assetid: 0a087125-c9d4-460a-8153-3e2e26633ac2
title: Información general de la inicialización de restauración
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6eb62e5282a74e38cd53d36c8ba004f4b8069746
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104156116"
---
# <a name="overview-of-restore-initialization"></a><span data-ttu-id="84464-103">Información general de la inicialización de restauración</span><span class="sxs-lookup"><span data-stu-id="84464-103">Overview of Restore Initialization</span></span>

<span data-ttu-id="84464-104">Al inicializar una operación de restauración de VSS, un solicitante debe recuperar el documento del componente de copia de seguridad y cada documento de metadatos de escritor pertinente creado y guardado durante la operación de copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="84464-104">In initializing a VSS restore operation, a requester needs to retrieve the Backup Component Document and each relevant Writer Metadata Document created and saved during the backup operation.</span></span> <span data-ttu-id="84464-105">El escritor tendrá su estado actual consultando en el control del [*evento de identificación*](vssgloss-i.md) que genera el solicitante.</span><span class="sxs-lookup"><span data-stu-id="84464-105">The writer will have its current state queried in handling the [*Identify event*](vssgloss-i.md) that the requester generates.</span></span> <span data-ttu-id="84464-106">Para obtener más información, vea [información general sobre el procesamiento de una restauración en VSS](overview-of-processing-a-restore-under-vss.md).</span><span class="sxs-lookup"><span data-stu-id="84464-106">For more information, see [Overview of Processing a Restore Under VSS](overview-of-processing-a-restore-under-vss.md).</span></span>

<span data-ttu-id="84464-107">En la tabla siguiente se muestra la secuencia de acciones y eventos necesarios para inicializar una operación de restauración.</span><span class="sxs-lookup"><span data-stu-id="84464-107">The following table shows the sequence of actions and events that are required to initialize a restore operation.</span></span>



| <span data-ttu-id="84464-108">Acción del solicitante</span><span class="sxs-lookup"><span data-stu-id="84464-108">Requester action</span></span>                                                                                                                                                                                                                                                                                                       | <span data-ttu-id="84464-109">Evento</span><span class="sxs-lookup"><span data-stu-id="84464-109">Event</span></span>                                                     | <span data-ttu-id="84464-110">Acción del escritor</span><span class="sxs-lookup"><span data-stu-id="84464-110">Writer action</span></span>                                                                                                                                                                                                                                                                                                             |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="84464-111">Cree una interfaz [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) , inicialícela para administrar una restauración y cargue los metadatos del solicitante almacenados (vea [**CreateVssBackupComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssbackupcomponents), [**IVssBackupComponents:: InitializeForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore)).</span><span class="sxs-lookup"><span data-stu-id="84464-111">Create an [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface, initialize it to manage a restore, and load stored requester metadata (see [**CreateVssBackupComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssbackupcomponents), [**IVssBackupComponents::InitializeForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore)).</span></span> | <span data-ttu-id="84464-112">None</span><span class="sxs-lookup"><span data-stu-id="84464-112">None</span></span>                                                      | <span data-ttu-id="84464-113">None</span><span class="sxs-lookup"><span data-stu-id="84464-113">None</span></span>                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="84464-114">Llame a [**CreateVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssexaminewritermetadata) para crear interfaces de [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) y cargarla con metadatos de escritor almacenados.</span><span class="sxs-lookup"><span data-stu-id="84464-114">Call [**CreateVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssexaminewritermetadata) to create [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) interfaces and load them with stored writer metadata.</span></span>                                                                                                           | <span data-ttu-id="84464-115">None</span><span class="sxs-lookup"><span data-stu-id="84464-115">None</span></span>                                                      | <span data-ttu-id="84464-116">None</span><span class="sxs-lookup"><span data-stu-id="84464-116">None</span></span>                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="84464-117">Inicie el contacto asincrónico con escritores (consulte [**IVssBackupComponents:: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata)).</span><span class="sxs-lookup"><span data-stu-id="84464-117">Initiate asynchronous contact with writers (see [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).)</span></span>                                                                                                                                                                      | [<span data-ttu-id="84464-118">*Identificar*</span><span class="sxs-lookup"><span data-stu-id="84464-118">*Identify*</span></span>](vssgloss-i.md) | <span data-ttu-id="84464-119">El escritor comienza el control de eventos en la compatibilidad con la restauración.</span><span class="sxs-lookup"><span data-stu-id="84464-119">The writer begins event handling in support of the restore.</span></span> <span data-ttu-id="84464-120">Crea el documento de metadatos de escritor (vea [trabajar con el documento de metadatos del escritor](working-with-the-writer-metadata-document.md), [**CVssWriter::**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify) [**IVssCreateWriterMetadata).**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata)</span><span class="sxs-lookup"><span data-stu-id="84464-120">Creates the Writer Metadata Document (see [Working with the Writer Metadata Document](working-with-the-writer-metadata-document.md), [**CVssWriter::OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify), [**IVssCreateWriterMetadata**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata)).</span></span> |
| <span data-ttu-id="84464-121">El solicitante espera a que los escritores se inicialicen llamando a [**IVssAsync**](/windows/desktop/api/Vss/nn-vss-ivssasync).</span><span class="sxs-lookup"><span data-stu-id="84464-121">The requester waits for writers to initialize by calling [**IVssAsync**](/windows/desktop/api/Vss/nn-vss-ivssasync).</span></span>                                                                                                                                                                                                                               | <span data-ttu-id="84464-122">None</span><span class="sxs-lookup"><span data-stu-id="84464-122">None</span></span>                                                      | <span data-ttu-id="84464-123">None</span><span class="sxs-lookup"><span data-stu-id="84464-123">None</span></span>                                                                                                                                                                                                                                                                                                                      |



 

## <a name="requester-actions-during-restore-initialization"></a><span data-ttu-id="84464-124">Acciones del solicitante durante la inicialización de la restauración</span><span class="sxs-lookup"><span data-stu-id="84464-124">Requester Actions during Restore Initialization</span></span>

<span data-ttu-id="84464-125">Durante la fase de inicialización de una restauración, el solicitante debe tener acceso al documento de componentes de copia de seguridad almacenados y a todos los documentos de metadatos del escritor.</span><span class="sxs-lookup"><span data-stu-id="84464-125">During the initialization phase of a restore, the requester needs to have access to the stored Backup Components Document and all the Writer Metadata Documents.</span></span>

<span data-ttu-id="84464-126">En función de la implementación, esto significa que el solicitante requerirá que el medio de copia de seguridad se monte y se pueda leer, o que esté disponible algún otro mecanismo para tener acceso a los metadatos almacenados.</span><span class="sxs-lookup"><span data-stu-id="84464-126">Depending on the implementation, this will mean either that the requester will require that backup media be mounted and readable, or that some other mechanism for accessing the stored metadata be available.</span></span>

<span data-ttu-id="84464-127">El solicitante usa el documento XML almacenado que contiene el documento componentes de copia de seguridad del solicitante que realizó la copia de seguridad para inicializar su documento de componentes de copia de seguridad mediante [**IVssBackupComponents:: InitializeForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore) puede acceder a la información.</span><span class="sxs-lookup"><span data-stu-id="84464-127">The requester uses the stored XML document containing the Backup Components Document of the requester that performed the backup to initialize its Backup Components Document using [**IVssBackupComponents::InitializeForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore) can access the information.</span></span>

<span data-ttu-id="84464-128">Como era el caso durante la copia de seguridad, el documento componentes de copia de seguridad no tiene información suficiente para admitir una restauración. por lo tanto, el solicitante debe tener acceso a los documentos de metadatos del escritor almacenados durante la copia de seguridad (vea [uso de componentes por parte del solicitante](use-of-components-by-the-requestor.md)).</span><span class="sxs-lookup"><span data-stu-id="84464-128">As was the case during the backup, the Backup Components Document has insufficient information to support a restore; therefore, the requester needs access to those Writer Metadata Documents stored during backup (see [Use of Components by the Requester](use-of-components-by-the-requestor.md)).</span></span>

<span data-ttu-id="84464-129">El solicitante recupera los metadatos del escritor almacenados mediante una llamada a [**CreateVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssexaminewritermetadata) para cada escritor cuyos datos se han copiado y ahora se va a restaurar.</span><span class="sxs-lookup"><span data-stu-id="84464-129">The requester retrieves the stored writer metadata by calling [**CreateVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-createvssexaminewritermetadata) for each writer whose data was backed up and now is to be restored.</span></span> <span data-ttu-id="84464-130">Esta función crea un objeto [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) para cada escritor y carga el documento de metadatos del escritor del escritor en el objeto.</span><span class="sxs-lookup"><span data-stu-id="84464-130">This function creates an [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) object for each writer and loads the writer's Writer Metadata Document into the object.</span></span>

<span data-ttu-id="84464-131">Como era el caso durante la copia de seguridad, para iniciar la cooperación entre él y los escritores del sistema, un solicitante debe generar un evento de [*identificación*](vssgloss-i.md) llamando a [**IVssBackupComponents:: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).</span><span class="sxs-lookup"><span data-stu-id="84464-131">As was the case during the backup, to initiate cooperation between itself and the system's writers, a requester must generate an [*Identify*](vssgloss-i.md) event by calling [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).</span></span> <span data-ttu-id="84464-132">No es necesario llamar a [**IVssBackupComponents:: GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) después de la finalización de [**GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).</span><span class="sxs-lookup"><span data-stu-id="84464-132">It is not necessary to call [**IVssBackupComponents::GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) following the completion of [**GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata).</span></span> <span data-ttu-id="84464-133">Los escritores que no pueden procesar el evento de [*identificación*](vssgloss-i.md) no se incluirán en la lista de escritores que proporcionan los metadatos que se van a devolver mediante [**IVssBackupComponents:: GetWriterMetadataCount**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadatacount) y [**ivssbackupcomponents:: GetWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata) (consulte [determinación del estado del escritor](determining-writer-status.md)).</span><span class="sxs-lookup"><span data-stu-id="84464-133">Writers that fail to process the [*Identify*](vssgloss-i.md) event will not be included in the list of writers providing the metadata to be returned by [**IVssBackupComponents::GetWriterMetadataCount**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadatacount) and [**IVssBackupComponents::GetWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritermetadata) (see [Determining Writer Status](determining-writer-status.md)).</span></span>

<span data-ttu-id="84464-134">Al igual que con la operación de copia de seguridad, un solicitante deberá consultar y analizar la información del documento componentes de copia de seguridad y compararlo con los datos de los documentos de metadatos del escritor para determinar los componentes de los que se realizó una copia de seguridad y elegir los que se van a restaurar (consulte [información general](overview-of-preparing-for-restore.md)sobre la preparación de la restauración).</span><span class="sxs-lookup"><span data-stu-id="84464-134">As with the backup operation, a requester will need to query and parse the information in the Backup Components Document and compare it to data in the Writer Metadata Documents to determine which components were backed up and to choose those to be restored (see [Overview of Preparing for Restore](overview-of-preparing-for-restore.md)).</span></span> <span data-ttu-id="84464-135">Además, el solicitante tendrá que generar una lista detallada que contenga información sobre los archivos del medio de copia de seguridad seleccionado para la restauración, así como cómo y dónde se van a restaurar.</span><span class="sxs-lookup"><span data-stu-id="84464-135">In addition, the requester will need to generate a detailed list containing information about the files on the backup media selected for restore, as well as how and where they are to be restored.</span></span> <span data-ttu-id="84464-136">(Vea [generar un conjunto de restauración](generating-a-restore-set.md)).</span><span class="sxs-lookup"><span data-stu-id="84464-136">(See [Generating a Restore Set](generating-a-restore-set.md).)</span></span>

<span data-ttu-id="84464-137">Por lo tanto, algunas aplicaciones de copia de seguridad pueden resultarle útil almacenar en el medio de copia de seguridad su propia lista (en su propio formato optimizado) de los archivos y su escritor, componente, procedimiento de restauración e información de ubicación asociados.</span><span class="sxs-lookup"><span data-stu-id="84464-137">Therefore, some backup applications may find it useful to have stored on the backup media their own list (in their own optimized format) of the files and their associated writer, component, restore procedure, and location information.</span></span> <span data-ttu-id="84464-138">Esta lista se puede usar para minimizar la cantidad de análisis y comparación de los documentos de metadatos del escritor y los documentos de componentes de copia de seguridad necesarios para admitir una restauración.</span><span class="sxs-lookup"><span data-stu-id="84464-138">This list can be used to minimize the amount of parsing and comparing of Writer Metadata Documents and the Backup Component Documents required to support a restore.</span></span>

## <a name="writer-actions-during-restore-initialization"></a><span data-ttu-id="84464-139">Acciones del escritor durante la inicialización de la restauración</span><span class="sxs-lookup"><span data-stu-id="84464-139">Writer Actions during Restore Initialization</span></span>

<span data-ttu-id="84464-140">Al igual que se hace durante una operación de restauración, en respuesta al evento de identificación, VSS llama al método de controlador virtual de cada escritor [**CVssWriter:: he Identify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify).</span><span class="sxs-lookup"><span data-stu-id="84464-140">Just as is done during a restore operation, in response to the Identify event, VSS calls each writer's virtual handler method [**CVssWriter::OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify).</span></span>

<span data-ttu-id="84464-141">Tenga en cuenta que las aplicaciones que no sean el solicitante actual (por ejemplo, aplicaciones del sistema) pueden generar eventos de identificación, que debe ser administrados por el escritor.</span><span class="sxs-lookup"><span data-stu-id="84464-141">Note that applications other than the current requester (for instance, system applications) can generate Identify events, which must be handled by the writer.</span></span> <span data-ttu-id="84464-142">Además, no hay ninguna manera de que un escritor determine desde dentro de [**CVssWriter:: he Identify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify) qué aplicación ha generado el evento de identificación.</span><span class="sxs-lookup"><span data-stu-id="84464-142">In addition, there is no way for a writer to determine from within [**CVssWriter::OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify) which application has generated the Identify event.</span></span>

<span data-ttu-id="84464-143">Dado que un escritor puede recibir varios eventos de identificación durante el procesamiento de una operación de restauración, los escritores nunca deben establecer información de estado en el controlador [**CVssWriter:: he Identify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify) .</span><span class="sxs-lookup"><span data-stu-id="84464-143">Given that a writer may receive several Identify events while processing a restore operation, writers should never set state information in the [**CVssWriter::OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify) handler.</span></span> <span data-ttu-id="84464-144">En su lugar, deben usar el mismo algoritmo para crear su documento de metadatos del escritor como se hizo durante las operaciones de copia de seguridad (consulte [acciones del escritor durante la inicialización](overview-of-backup-initialization.md) de la copia de seguridad para obtener más información).</span><span class="sxs-lookup"><span data-stu-id="84464-144">Instead, they must use the same algorithm for creating their Writer Metadata Document as was done during backup operations (see [Writer Actions during Backup Initialization](overview-of-backup-initialization.md) for more information).</span></span>

 

 



