---
description: Cuando un subproceso se comunica activamente con un dispositivo de adquisición de imágenes de Windows (WIA) (por ejemplo, transfiriendo datos o escribiendo propiedades de dispositivo) WIA &\# 0034; bloquea&\# 0034; el dispositivo.
ms.assetid: 59533937-284a-4732-a73b-d2e0b5a9a370
title: Comunicación con un dispositivo WIA en varios subprocesos o aplicaciones
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1a7a4b518093c3a0fc09534d67e22e5349d44d09
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104276861"
---
# <a name="communicating-with-a-wia-device-in-multiple-threads-or-applications"></a><span data-ttu-id="b2803-103">Comunicación con un dispositivo WIA en varios subprocesos o aplicaciones</span><span class="sxs-lookup"><span data-stu-id="b2803-103">Communicating with a WIA Device in Multiple Threads or Applications</span></span>

<span data-ttu-id="b2803-104">Cuando un subproceso se comunica activamente con un dispositivo de adquisición de imágenes de Windows (WIA) (por ejemplo, mediante la transferencia de datos o la escritura de propiedades de dispositivo), WIA "bloquea" el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="b2803-104">When a thread is actively communicating with a Windows Image Acquisition (WIA) device (for example, transferring data or writing device properties) WIA "locks" the device.</span></span> <span data-ttu-id="b2803-105">Cuando un dispositivo está bloqueado, ningún otro subproceso o proceso puede comunicarse activamente con ese dispositivo.</span><span class="sxs-lookup"><span data-stu-id="b2803-105">When a device is locked, no other threads or processes can actively communicate with that device.</span></span>

<span data-ttu-id="b2803-106">WIA no prohíbe que varios subprocesos o procesos mantengan conexiones a un único dispositivo.</span><span class="sxs-lookup"><span data-stu-id="b2803-106">WIA does not prohibit multiple threads or processes from maintaining connections to a single device.</span></span> <span data-ttu-id="b2803-107">Es decir, un dispositivo solo está bloqueado durante la comunicación real y dos o más aplicaciones pueden tener un único dispositivo seleccionado simultáneamente.</span><span class="sxs-lookup"><span data-stu-id="b2803-107">That is, a device is locked only during the actual communication, and two or more applications can simultaneously have a single device selected.</span></span>

<span data-ttu-id="b2803-108">WIA crea un árbol de elementos independiente cada vez que cualquier subproceso o aplicación llama a [**IWiaDevMgr:: CreateDevice**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-createdevice) o [**IWiaDevMgr2:: CreateDevice**](-wia-iwiadevmgr2-createdevice.md) para crear una instancia de ese dispositivo.</span><span class="sxs-lookup"><span data-stu-id="b2803-108">WIA creates a separate item tree each time any thread or application calls [**IWiaDevMgr::CreateDevice**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-createdevice) or [**IWiaDevMgr2::CreateDevice**](-wia-iwiadevmgr2-createdevice.md) to create an instance of that device.</span></span> <span data-ttu-id="b2803-109">WIA mantiene información de estado independiente para cada árbol de elementos.</span><span class="sxs-lookup"><span data-stu-id="b2803-109">WIA maintains separate state information for each item tree.</span></span> <span data-ttu-id="b2803-110">Por ejemplo, si un subproceso crea dos instancias de un escáner determinado, puede establecer diferentes resoluciones de digitalización para las dos instancias.</span><span class="sxs-lookup"><span data-stu-id="b2803-110">For example, if a thread creates two instances of a particular scanner, it can set different scan resolutions for the two instances.</span></span> <span data-ttu-id="b2803-111">Cuando se llama a [**IWiaDataTransfer:: idtGetData**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadatatransfer-idtgetdata) en una instancia determinada, WIA carga las propiedades asociadas a esa instancia en el dispositivo antes de que tenga lugar el examen real.</span><span class="sxs-lookup"><span data-stu-id="b2803-111">When [**IWiaDataTransfer::idtGetData**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadatatransfer-idtgetdata) is called on a particular instance, WIA loads the properties associated with that instance to the device before the actual scan takes place.</span></span> <span data-ttu-id="b2803-112">Esto no afecta al estado de la otra instancia del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="b2803-112">This does not affect the state of the other instance of the device.</span></span>

<span data-ttu-id="b2803-113">Si un subproceso tiene un dispositivo bloqueado actualmente (se comunica activamente con ese dispositivo) y otro subproceso intenta llamar a un método que se comunica activamente con el dispositivo, el método devuelve un \_ error de error de WIA \_ .</span><span class="sxs-lookup"><span data-stu-id="b2803-113">If a thread currently has a device locked (it is actively communicating with that device) and another thread attempts to call a method that actively communicates with the device, the method returns a WIA\_ERROR\_BUSY error.</span></span>

<span data-ttu-id="b2803-114">Normalmente, la lectura y la escritura de propiedades de dispositivo tardan tan poco tiempo en que estas operaciones causan un conflicto.</span><span class="sxs-lookup"><span data-stu-id="b2803-114">Typically, reading and writing device properties takes so little time that these operations rarely cause a conflict.</span></span> <span data-ttu-id="b2803-115">La transferencia de datos, sin embargo, normalmente tarda más tiempo y, por lo tanto, es más probable que se creen conflictos de acceso a los dispositivos.</span><span class="sxs-lookup"><span data-stu-id="b2803-115">Transferring data, however, usually takes longer, and therefore is more likely to create device access conflicts.</span></span> <span data-ttu-id="b2803-116">Es una programación de sonido para evitar largas operaciones de dispositivo (transferencias de datos) simultáneamente en subprocesos independientes dentro de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="b2803-116">It is sound programming to avoid lengthy device operations (data transfers) concurrently in separate threads within an application.</span></span>

<span data-ttu-id="b2803-117">Una aplicación nunca debe asumir que es la única aplicación que se comunica con un dispositivo WIA cuando se inicia.</span><span class="sxs-lookup"><span data-stu-id="b2803-117">An application should never assume that it is the only application that is communicating with a WIA device when it starts.</span></span>

 

 



