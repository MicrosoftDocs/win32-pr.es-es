---
description: Para evitar las condiciones de carrera y los interbloqueos, es necesario sincronizar el acceso de varios subprocesos a recursos compartidos. La sincronización también es necesaria para garantizar que el código interdependiente se ejecute en la secuencia adecuada.
ms.assetid: 74af0502-dae1-438c-8e4b-7663093b3fe3
title: Sincronizar la ejecución de varios subprocesos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c6a1b3dd51d666d507771476792e679f7980fab8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "105677828"
---
# <a name="synchronizing-execution-of-multiple-threads"></a><span data-ttu-id="5332d-104">Sincronizar la ejecución de varios subprocesos</span><span class="sxs-lookup"><span data-stu-id="5332d-104">Synchronizing Execution of Multiple Threads</span></span>

<span data-ttu-id="5332d-105">Para evitar las condiciones de carrera y los interbloqueos, es necesario sincronizar el acceso de varios subprocesos a recursos compartidos.</span><span class="sxs-lookup"><span data-stu-id="5332d-105">To avoid race conditions and deadlocks, it is necessary to synchronize access by multiple threads to shared resources.</span></span> <span data-ttu-id="5332d-106">La sincronización también es necesaria para garantizar que el código interdependiente se ejecute en la secuencia adecuada.</span><span class="sxs-lookup"><span data-stu-id="5332d-106">Synchronization is also necessary to ensure that interdependent code is executed in the proper sequence.</span></span>

<span data-ttu-id="5332d-107">Hay una serie de objetos cuyos identificadores se pueden usar para sincronizar varios subprocesos.</span><span class="sxs-lookup"><span data-stu-id="5332d-107">There are a number of objects whose handles can be used to synchronize multiple threads.</span></span> <span data-ttu-id="5332d-108">Estos objetos incluyen:</span><span class="sxs-lookup"><span data-stu-id="5332d-108">These objects include:</span></span>

-   <span data-ttu-id="5332d-109">Búferes de entrada de la consola</span><span class="sxs-lookup"><span data-stu-id="5332d-109">Console input buffers</span></span>
-   <span data-ttu-id="5332d-110">Events</span><span class="sxs-lookup"><span data-stu-id="5332d-110">Events</span></span>
-   <span data-ttu-id="5332d-111">Mutexes</span><span class="sxs-lookup"><span data-stu-id="5332d-111">Mutexes</span></span>
-   <span data-ttu-id="5332d-112">Procesos</span><span class="sxs-lookup"><span data-stu-id="5332d-112">Processes</span></span>
-   <span data-ttu-id="5332d-113">Semáforos</span><span class="sxs-lookup"><span data-stu-id="5332d-113">Semaphores</span></span>
-   <span data-ttu-id="5332d-114">Subprocesos</span><span class="sxs-lookup"><span data-stu-id="5332d-114">Threads</span></span>
-   <span data-ttu-id="5332d-115">Temporizadores</span><span class="sxs-lookup"><span data-stu-id="5332d-115">Timers</span></span>

<span data-ttu-id="5332d-116">El estado de cada uno de estos objetos es señalado o no señalizado.</span><span class="sxs-lookup"><span data-stu-id="5332d-116">The state of each of these objects is either signaled or not signaled.</span></span> <span data-ttu-id="5332d-117">Cuando se especifica un identificador para cualquiera de estos objetos en una llamada a una de las [funciones de espera](../sync/wait-functions.md), la ejecución del subproceso que realiza la llamada se bloquea hasta que se señaliza el estado del objeto especificado.</span><span class="sxs-lookup"><span data-stu-id="5332d-117">When you specify a handle to any of these objects in a call to one of the [wait functions](../sync/wait-functions.md), the execution of the calling thread is blocked until the state of the specified object becomes signaled.</span></span>

<span data-ttu-id="5332d-118">Algunos de estos objetos son útiles para bloquear un subproceso hasta que se produce algún evento.</span><span class="sxs-lookup"><span data-stu-id="5332d-118">Some of these objects are useful in blocking a thread until some event occurs.</span></span> <span data-ttu-id="5332d-119">Por ejemplo, un controlador de búfer de entrada de la consola se señaliza cuando hay una entrada sin leer, como un clic del botón del mouse o de pulsación de tecla.</span><span class="sxs-lookup"><span data-stu-id="5332d-119">For example, a console input buffer handle is signaled when there is unread input, such as a keystroke or mouse button click.</span></span> <span data-ttu-id="5332d-120">Los identificadores de proceso y de subproceso se señalan cuando finaliza el proceso o subproceso.</span><span class="sxs-lookup"><span data-stu-id="5332d-120">Process and thread handles are signaled when the process or thread terminates.</span></span> <span data-ttu-id="5332d-121">Esto permite a un proceso, por ejemplo, crear un proceso secundario y, a continuación, bloquear su propia ejecución hasta que finalice el nuevo proceso.</span><span class="sxs-lookup"><span data-stu-id="5332d-121">This allows a process, for example, to create a child process and then block its own execution until the new process has terminated.</span></span>

<span data-ttu-id="5332d-122">Otros objetos son útiles para proteger los recursos compartidos de acceso simultáneo.</span><span class="sxs-lookup"><span data-stu-id="5332d-122">Other objects are useful in protecting shared resources from simultaneous access.</span></span> <span data-ttu-id="5332d-123">Por ejemplo, varios subprocesos pueden tener un identificador a un objeto mutex.</span><span class="sxs-lookup"><span data-stu-id="5332d-123">For example, multiple threads can each have a handle to a mutex object.</span></span> <span data-ttu-id="5332d-124">Antes de tener acceso a un recurso compartido, los subprocesos deben llamar a una de las [funciones de espera](../sync/wait-functions.md) para esperar a que se señale el estado de la exclusión mutua.</span><span class="sxs-lookup"><span data-stu-id="5332d-124">Before accessing a shared resource, the threads must call one of the [wait functions](../sync/wait-functions.md) to wait for the state of the mutex to be signaled.</span></span> <span data-ttu-id="5332d-125">Cuando se señala la exclusión mutua, solo se libera un subproceso en espera para tener acceso al recurso.</span><span class="sxs-lookup"><span data-stu-id="5332d-125">When the mutex becomes signaled, only one waiting thread is released to access the resource.</span></span> <span data-ttu-id="5332d-126">El estado de la exclusión mutua se restablece inmediatamente a no señalizado, por lo que cualquier otro subproceso en espera permanece bloqueado.</span><span class="sxs-lookup"><span data-stu-id="5332d-126">The state of the mutex is immediately reset to not signaled so any other waiting threads remain blocked.</span></span> <span data-ttu-id="5332d-127">Cuando el subproceso finaliza con el recurso, debe establecer el estado de la exclusión mutua en señalizado para permitir que otros subprocesos tengan acceso al recurso.</span><span class="sxs-lookup"><span data-stu-id="5332d-127">When the thread is finished with the resource, it must set the state of the mutex to signaled to allow other threads to access the resource.</span></span>

<span data-ttu-id="5332d-128">En el caso de los subprocesos de un único proceso, los objetos de sección crítica proporcionan un medio más eficaz de sincronización que las exclusiones mutuas.</span><span class="sxs-lookup"><span data-stu-id="5332d-128">For the threads of a single process, critical-section objects provide a more efficient means of synchronization than mutexes.</span></span> <span data-ttu-id="5332d-129">Una sección crítica se usa como una exclusión mutua para permitir que un subproceso a la vez use el recurso protegido.</span><span class="sxs-lookup"><span data-stu-id="5332d-129">A critical section is used like a mutex to enable one thread at a time to use the protected resource.</span></span> <span data-ttu-id="5332d-130">Un subproceso puede usar la función [**EnterCriticalSection**](/windows/win32/api/synchapi/nf-synchapi-entercriticalsection) para solicitar la propiedad de una sección crítica.</span><span class="sxs-lookup"><span data-stu-id="5332d-130">A thread can use the [**EnterCriticalSection**](/windows/win32/api/synchapi/nf-synchapi-entercriticalsection) function to request ownership of a critical section.</span></span> <span data-ttu-id="5332d-131">Si ya es propiedad de otro subproceso, el subproceso que lo solicita está bloqueado.</span><span class="sxs-lookup"><span data-stu-id="5332d-131">If it is already owned by another thread, the requesting thread is blocked.</span></span> <span data-ttu-id="5332d-132">Un subproceso puede usar la función [**TryEnterCriticalSection**](/windows/win32/api/synchapi/nf-synchapi-tryentercriticalsection) para solicitar la propiedad de una sección crítica, sin bloquearse si se produce un error al obtener la sección crítica.</span><span class="sxs-lookup"><span data-stu-id="5332d-132">A thread can use the [**TryEnterCriticalSection**](/windows/win32/api/synchapi/nf-synchapi-tryentercriticalsection) function to request ownership of a critical section, without blocking upon failure to obtain the critical section.</span></span> <span data-ttu-id="5332d-133">Una vez que recibe la propiedad, el subproceso es libre de usar el recurso protegido.</span><span class="sxs-lookup"><span data-stu-id="5332d-133">After it receives ownership, the thread is free to use the protected resource.</span></span> <span data-ttu-id="5332d-134">La ejecución de los demás subprocesos del proceso no se ve afectada a menos que intenten entrar en la misma sección crítica.</span><span class="sxs-lookup"><span data-stu-id="5332d-134">The execution of the other threads of the process is not affected unless they attempt to enter the same critical section.</span></span>

<span data-ttu-id="5332d-135">La función [**WaitForInputIdle**](/windows/desktop/api/Winuser/nf-winuser-waitforinputidle) hace que un subproceso espere hasta que se inicializa un proceso especificado y se espera la entrada del usuario sin ninguna entrada pendiente.</span><span class="sxs-lookup"><span data-stu-id="5332d-135">The [**WaitForInputIdle**](/windows/desktop/api/Winuser/nf-winuser-waitforinputidle) function makes a thread wait until a specified process is initialized and waiting for user input with no input pending.</span></span> <span data-ttu-id="5332d-136">La llamada a **WaitForInputIdle** puede ser útil para sincronizar procesos primarios y secundarios, porque [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) devuelve sin esperar a que el proceso secundario complete su inicialización.</span><span class="sxs-lookup"><span data-stu-id="5332d-136">Calling **WaitForInputIdle** can be useful for synchronizing parent and child processes, because [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) returns without waiting for the child process to complete its initialization.</span></span>

<span data-ttu-id="5332d-137">Para obtener más información, consulte [Synchronization](../sync/synchronization.md).</span><span class="sxs-lookup"><span data-stu-id="5332d-137">For more information, see [Synchronization](../sync/synchronization.md).</span></span>

 

 
