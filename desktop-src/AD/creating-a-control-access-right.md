---
title: Crear un derecho de acceso a control
description: Para agregar un derecho de acceso de control a un servidor de Active Directory, cree un objeto controlAccessRight en el contenedor Extended-Rights de la partición de configuración.
ms.assetid: dacd42c6-17d9-4dfe-8f51-e4a470766494
ms.tgt_platform: multiple
keywords:
- Creación de un anuncio de derechos de control de acceso
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 11bdc764b09f0fe5bd165e87e23a89db7d368bfe
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/17/2020
ms.locfileid: "103789597"
---
# <a name="creating-a-control-access-right"></a>Crear un derecho de acceso a control

Para agregar un derecho de acceso de control a un servidor de Active Directory, cree un objeto [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) en el contenedor Extended-Rights de la partición de configuración. Para obtener más información y un ejemplo de código, vea [ejemplo de código para crear un derecho de acceso de control](example-code-for-creating-a-control-access-right.md). Para usar el derecho controlar acceso, debe completar algunos pasos más, en función de si el derecho controlar acceso es para una operación especial o para un conjunto de propiedades.

Si define un derecho de acceso de control para un conjunto de propiedades, use el **rightsGUID** del objeto [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) para identificar las propiedades del conjunto. Cada propiedad se define mediante un objeto [**attributeSchema**](/windows/desktop/ADSchema/c-attributeschema) en el esquema de Active Directory. La propiedad [**attributeSecurityGUID**](/windows/desktop/ADSchema/a-attributesecurityguid) de un objeto **attributeSchema** identifica el conjunto de propiedades, si hay alguno, al que pertenece la propiedad. Tenga en cuenta que la propiedad **attributeSecurityGUID** tiene un único valor y almacena el GUID en formato binario (sintaxis de cadena de octeto).

Si define un derecho de acceso de control para aplicar restricciones en el acceso a una operación determinada, la aplicación debe realizar la comprobación de acceso cuando un usuario intente la operación.

**Para configurar la comprobación de acceso**

1.  Cree un derecho de acceso de control que defina el tipo de acceso a la aplicación o servicio. Para obtener más información, vea el siguiente ejemplo de código.
2.  Cree un objeto Active Directory Domain Services que represente la aplicación, el servicio o el recurso que va a proteger.
3.  Agregue ACE de objeto a la DACL en el descriptor de seguridad de objeto para conceder o denegar a los usuarios o grupos el derecho de acceso de control en ese objeto. Para obtener más información, vea [establecer una ACE right de control de acceso en la ACL de un objeto](setting-a-control-access-right-ace-in-an-objectampaposs-acl.md).
4.  Cuando un usuario intenta realizar la operación, compruebe los derechos de usuario pasando el descriptor de seguridad del objeto y el token de acceso del usuario a la función [**AccessCheckByTypeResultList**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-accesscheckbytyperesultlist) . Para obtener más información, vea [comprobar un derecho de acceso a un control en la ACL de un objeto](checking-a-control-access-right-in-an-objectampaposs-acl.md).

Según el resultado de la comprobación de acceso en el objeto, la aplicación o servicio puede permitir o denegar el acceso del usuario a la aplicación o servicio.

Al crear un objeto [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) , establezca los atributos que se enumeran en la tabla siguiente para convertir el objeto en un derecho de acceso de control legal reconocido por Active Directory Domain Services y los sistemas de seguridad de Windows.



| Atributo                                     | Descripción                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|-----------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**CN**](/windows/desktop/ADSchema/a-cn)                       | Propiedad de un solo valor que es el nombre distintivo relativo (RDN) del objeto en el contenedor de Extended-Rights. El **CN** es el nombre del derecho de control de acceso en Active Directory Domain Services.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [**appliesTo**](/windows/desktop/ADSchema/a-appliesto)         | Una propiedad con varios valores que enumera las clases de objetos a las que se aplica el derecho de control de acceso. Por ejemplo, el derecho de control de acceso [**Enviar como**](/windows/desktop/ADSchema/r-send-as) muestra las clases de objetos de [**usuario**](/windows/desktop/ADSchema/c-user) y [**equipo**](/windows/desktop/ADSchema/c-computer) en la propiedad **appliesTo** . En la lista, cada clase de objeto se identifica mediante el [**schemaIDGUID**](/windows/desktop/ADSchema/a-schemaidguid) de su objeto [**ClassSchema**](/windows/desktop/ADSchema/c-classschema) . Los GUID se almacenan como cadenas con el formato generado por la función [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) en la biblioteca com, pero sin las llaves de inicio y finalización ({}). Por ejemplo, el siguiente GUID es el **schemaIDGUID** para la clase [**Computer**](/windows/desktop/ADSchema/c-computer) : bf967a86-0de6-11d0-A285-00aa003049e2.<br/> Tenga en cuenta que la propiedad [**schemaIDGUID**](/windows/desktop/ADSchema/a-schemaidguid) de un objeto [**ClassSchema**](/windows/desktop/ADSchema/c-classschema) se almacena como un GUID binario mediante la sintaxis de la cadena de octeto. Para convertir este formato de cadena de octeto en el formato de cadena que se usa en la propiedad [**appliesTo**](/windows/desktop/ADSchema/a-appliesto) , utilice la función [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) y quite las llaves de la cadena devuelta.<br/> Para obtener más información sobre la propiedad [**schemaIDGUID**](/windows/desktop/ADSchema/a-schemaidguid) de una de las clases de objeto predefinidas, como [**usuario**](/windows/desktop/ADSchema/c-user) o [**equipo**](/windows/desktop/ADSchema/c-computer), consulte la página de referencia de la clase en la referencia de esquema de Active Directory en la [referencia de Active Directory Domain Services](active-directory-domain-services-reference.md). Para obtener más información y un ejemplo de código que recupera un **schemaIDGUID** de un objeto ClassSchema, vea [leer objetos attributeSchema y ClassSchema](reading-attributeschema-and-classschema-objects.md).<br/> |
| [**Mostrar**](/windows/desktop/ADSchema/a-displayname)     | La cadena usada para mostrar el derecho de control de acceso en las interfaces de usuario, como la página de propiedades **seguridad** y otros lugares del complemento MMC usuarios y equipos Active Directory.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [**rightsGuid**](/windows/desktop/ADSchema/a-rightsguid)       | GUID que identifica el derecho de acceso de control en una ACE. El GUID se almacena como una cadena con el formato generado por la función [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) , pero sin las llaves de inicio y de finalización. Use Uuidgen.exe para que otra utilidad genere un GUID para el derecho de acceso de control. Si define un nuevo conjunto de propiedades, use el [**rightsGuid**](/windows/desktop/ADSchema/a-rightsguid) del objeto [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) para identificar las propiedades del conjunto. Para cada propiedad del conjunto de propiedades, establezca el valor de [**attributeSecurityGUID**](/windows/desktop/ADSchema/a-attributesecurityguid) de la propiedad en el valor de **rightsGUID** del conjunto de propiedades. El valor de **attributeSecurityGUID** de una propiedad se almacena en la definición de [**attributeSchema**](/windows/desktop/ADSchema/c-attributeschema) de la propiedad en el esquema de Active Directory. La propiedad **attributeSecurityGUID** tiene un único valor y almacena el GUID en formato binario (sintaxis de cadena de octeto).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**objectClass**](/windows/desktop/ADSchema/a-objectclass)     | Este atributo especifica [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) como la clase de objeto.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [**validAccesses**](/windows/desktop/ADSchema/a-validaccesses) | En el caso de los conjuntos de propiedades, establezca este atributo en 0x30 (**ADS \_ right \_ DS \_ Read \_ prop** \| **ADS \_ right \_ DS \_ Write \_ prop**). En derechos de acceso de control, establezca este atributo en 0x100 (**ad \_ right \_ DS \_ control \_ Access**). La página de propiedades seguridad reconoce los derechos de acceso de control solo si el atributo [**validAccesses**](/windows/desktop/ADSchema/a-validaccesses) está establecido en el valor adecuado. Si es cero, el derecho de acceso de control se omite o no se muestra en la página de propiedades de seguridad.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |



 

Tenga en cuenta que las clases de esquema predefinidas usan el atributo **localizationDisplayId** de un objeto [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) para especificar un identificador de mensaje que se usa para recuperar un nombre para mostrar localizado de Dssec.dll. No establezca el atributo **localizationDisplayId** si define un nuevo objeto **controlAccessRight** .

 

