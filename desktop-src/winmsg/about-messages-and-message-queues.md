---
description: En esta sección se Windows mensajes y colas de mensajes.
ms.assetid: 21a4d40b-52da-49e4-a374-afc4927e96e8
title: Acerca de los mensajes y las colas de mensajes
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b237b13447abf6a1db2edc698e84755d44b6b3859714ad11af1184c6121ae7be
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/11/2021
ms.locfileid: "118200861"
---
# <a name="about-messages-and-message-queues"></a>Acerca de los mensajes y las colas de mensajes

A diferencia de las aplicaciones basadas en MS-DOS, Windows basadas en eventos están controladas por eventos. No hacen llamadas de función explícitas (como llamadas de biblioteca en tiempo de ejecución de C) para obtener la entrada. En su lugar, esperan a que el sistema les pase la entrada.

El sistema pasa toda la entrada de una aplicación a las distintas ventanas de la aplicación. Cada ventana tiene una función, denominada procedimiento de ventana, a la que llama el sistema cada vez que tiene entradas para la ventana. El procedimiento de ventana procesa la entrada y devuelve el control al sistema. Para obtener más información sobre los procedimientos de ventana, vea [Procedimientos de ventana](window-procedures.md).

Si una ventana de nivel superior deja de responder a los mensajes durante más de varios segundos, el sistema considera que la ventana no responde. En este caso, el sistema oculta la ventana y la reemplaza por una ventana fantasma que tiene el mismo orden Z, ubicación, tamaño y atributos visuales. Esto permite al usuario moverla, cambiar su tamaño o incluso cerrar la aplicación. Sin embargo, estas son las únicas acciones disponibles porque la aplicación no responde realmente. Cuando está en modo de depurador, el sistema no genera una ventana fantasma.

En esta sección se de tratan los temas siguientes:

-   [Windows Mensajes](#windows-messages)
-   [Tipos de mensaje](#message-types)
    -   [Mensajes definidos por el sistema](#system-defined-messages)
    -   [Mensajes definidos por la aplicación](#application-defined-messages)
-   [Enrutamiento de mensajes](#message-routing)
    -   [Mensajes en cola](#queued-messages)
    -   [Mensajes no en cola](#nonqueued-messages)
-   [Control de mensajes](#message-handling)
    -   [Bucle de mensajes](#message-loop)
    -   [Procedimiento de ventana](#window-procedure)
-   [Filtrado de mensajes](#message-filtering)
-   [Publicación y envío de mensajes](#posting-and-sending-messages)
    -   [Publicación de mensajes](#posting-messages)
    -   [Envío de mensajes](#sending-messages)
-   [Interbloqueos de mensajes](#message-deadlocks)
-   [Difusión de mensajes](#broadcasting-messages)
-   [Mensajes de consulta](#query-messages)

## <a name="windows-messages"></a>Mensajes de Windows

El sistema pasa la entrada a un procedimiento de ventana en forma de *mensaje*. El sistema y las aplicaciones generan mensajes. El sistema genera un mensaje en cada evento de entrada, por ejemplo, cuando el usuario tipos, mueve el mouse o hace clic en un control como una barra de desplazamiento. El sistema también genera mensajes en respuesta a los cambios en el sistema provocados por una aplicación, como cuando una aplicación cambia el grupo de recursos de fuente del sistema o cambia el tamaño de una de sus ventanas. Una aplicación puede generar mensajes para dirigir sus propias ventanas para realizar tareas o para comunicarse con ventanas en otras aplicaciones.

El sistema envía un mensaje a un procedimiento de ventana con un conjunto de cuatro parámetros: un identificador de ventana, un identificador de mensaje y dos valores denominados *parámetros de mensaje*. El *identificador de* ventana identifica la ventana para la que está previsto el mensaje. El sistema lo usa para determinar qué procedimiento de ventana debe recibir el mensaje.

Un *identificador de* mensaje es una constante con nombre que identifica el propósito de un mensaje. Cuando un procedimiento de ventana recibe un mensaje, usa un identificador de mensaje para determinar cómo procesar el mensaje. Por ejemplo, el identificador de mensaje [**WM \_ PAINT**](/windows/desktop/gdi/wm-paint) indica al procedimiento de ventana que el área de cliente de la ventana ha cambiado y se debe volver a dibujar.

Los parámetros de mensaje especifican los datos o la ubicación de los datos utilizados por un procedimiento de ventana al procesar un mensaje. El significado y el valor de los parámetros del mensaje dependen del mensaje. Un parámetro de mensaje puede contener un entero, marcas de bits empaquetadas, un puntero a una estructura que contiene datos adicionales, y así sucesivamente. Cuando un mensaje no usa parámetros de mensaje, normalmente se establecen en **NULL.** Un procedimiento de ventana debe comprobar el identificador del mensaje para determinar cómo interpretar los parámetros del mensaje.

## <a name="message-types"></a>Tipos de mensajes

En esta sección se describen los dos tipos de mensajes:

-   [Mensajes definidos por el sistema](#system-defined-messages)
-   [Mensajes definidos por la aplicación](#application-defined-messages)

### <a name="system-defined-messages"></a>System-Defined mensajes

El sistema envía o envía un *mensaje definido por el* sistema cuando se comunica con una aplicación. Usa estos mensajes para controlar las operaciones de las aplicaciones y para proporcionar entrada y otra información para que las aplicaciones las procese. Una aplicación también puede enviar o publicar mensajes definidos por el sistema. Por lo general, las aplicaciones usan estos mensajes para controlar el funcionamiento de las ventanas de control creadas mediante clases de ventana registradas previamente.

Cada mensaje definido por el sistema tiene un identificador de mensaje único y una constante simbólica correspondiente (definida en los archivos de encabezado del Kit de desarrollo de software (SDK) que indica el propósito del mensaje. Por ejemplo, la [**constante \_ WM PAINT**](/windows/desktop/gdi/wm-paint) solicita que una ventana pinte su contenido.

Las constantes simbólicas especifican la categoría a la que pertenecen los mensajes definidos por el sistema. El prefijo de la constante identifica el tipo de ventana que puede interpretar y procesar el mensaje. A continuación se encuentran los prefijos y sus categorías de mensajes relacionadas.



| Prefijo                               | Categoría del mensaje             | Documentación                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|--------------------------------------|------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **ABM** y **ABN**                  | Barra de herramientas de escritorio de la aplicación  | [Mensajes y notificaciones del shell](/windows/desktop/shell/control-panel-applications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **ACM** y **ACN**                  | Animation (control)            | [Mensajes de control de animación](/windows/desktop/Controls/bumper-animation-control-reference-messages) y notificaciones de control de [animación](/windows/desktop/Controls/bumper-animation-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **BCM,** **BCN,** **BM** y **BN** | Button (control)               | [Mensajes de control de botón](/windows/desktop/Controls/bumper-button-control-reference-messages) y notificaciones de control de [botón](/windows/desktop/Controls/bumper-button-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **CB** y **CBN**                   | ComboBox (control)             | [Mensajes de control ComboBox](/windows/desktop/Controls/bumper-combobox-control-reference-messages) y [notificaciones de control ComboBox](/windows/desktop/Controls/bumper-combobox-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **CBEM** y **CBEN**                | Control ComboBoxEx           | [Mensajes ComboBoxEx](/windows/desktop/Controls/bumper-comboboxex-control-reference-messages) y [notificaciones ComboBoxEx](/windows/desktop/Controls/bumper-comboboxex-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **Ccm**                              | Control general              | [Mensajes de control](/windows/desktop/Controls/bumper-general-control-reference-messages)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **CDM**                              | Cuadro de diálogo Común            | [Mensajes comunes del cuadro de diálogo](/windows/desktop/dlgbox/common-dialog-box-messages)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **Dfm**                              | Menú contextual predeterminado         | [Mensajes y notificaciones del shell](/windows/desktop/shell/control-panel-applications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **DL**                               | Cuadro de lista de arrastre                | [Arrastrar notificaciones de cuadro de lista](/previous-versions//ff485914(v=vs.85))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **DM**                               | Control de botón de inserción predeterminado  | [Mensajes del cuadro de diálogo](/windows/desktop/dlgbox/dialog-box-messages)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **DTM** y **DTN**                  | Control selector de fecha y hora | [Mensajes del selector de fecha y hora](/windows/desktop/Controls/bumper-date-and-time-picker-control-reference-messages) y notificaciones del selector de fecha y [hora](/windows/desktop/Controls/bumper-date-and-time-picker-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **EM** y **EN**                    | Edit (control)                 | [Editar mensajes de control,](/windows/desktop/Controls/bumper-edit-control-reference-messages) [Editar notificaciones de control,](/windows/desktop/Controls/bumper-edit-control-reference-notifications) [Mensajes de edición enriquecciones](/windows/desktop/Controls/bumper-rich-edit-control-reference-messages)y [Notificaciones de edición enriquecciones](/windows/desktop/Controls/bumper-rich-edit-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **HDM** y **HDN**                  | Control de encabezado               | [Mensajes de control de encabezado](/windows/desktop/Controls/bumper-header-control-reference-messages) y notificaciones de control de [encabezado](/windows/desktop/Controls/bumper-header-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **HKM**                              | Control de tecla de acceso remoto              | [Mensajes de control de teclas de acceso directo](/windows/desktop/Controls/bumper-hot-key-control-reference-messages)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **IPM** e **IPN**                  | control de dirección IP           | [Mensajes de dirección IP](/windows/desktop/Controls/bumper-ip-address-control-reference-messages) y [notificaciones de direcciones IP](/windows/desktop/Controls/bumper-ip-address-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **LB** y **LBN**                   | Control de cuadro de lista             | [Mensajes de cuadro de](/windows/desktop/Controls/bumper-list-box-control-reference-messages) lista [y notificaciones de cuadro de lista](/windows/desktop/Controls/bumper-list-box-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **Lm**                               | Control SysLink              | [Mensajes de control SysLink](/windows/desktop/Controls/bumper-syslink-control-reference-messages)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **LVM** y **LVN**                  | Control de vista de lista            | [Lista de mensajes de vista](/windows/desktop/Controls/bumper-list-view-control-reference-messages) y notificaciones de vista de [lista](/windows/desktop/Controls/bumper-list-view-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **MCM** y **MCN**                  | Control de calendario mensual       | [Mensajes de calendario mensuales](/windows/desktop/Controls/bumper-month-calendar-control-reference-messages) [y notificaciones de calendario mensuales](/windows/desktop/Controls/bumper-month-calendar-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **PBM**                              | Barra de progreso                 | [Mensajes de la barra de progreso](/windows/desktop/Controls/bumper-progress-bar-control-reference-messages)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **PGM** y **PGN**                  | Control De paginación                | [Mensajes de control de paginación](/windows/desktop/Controls/bumper-pager-control-reference-messages) y [notificaciones de control de paginación](/windows/desktop/Controls/bumper-pager-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **PSM** y **PSN**                  | Hoja de propiedades               | [Mensajes de hoja de propiedades](/windows/desktop/Controls/bumper-property-sheets-reference-messages) y notificaciones de hoja de [propiedades](/windows/desktop/Controls/bumper-property-sheets-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **RB** y **RBN**                   | Control Rebar                | [Mensajes de control rebar](/windows/desktop/Controls/bumper-rebar-control-reference-messages) y [notificaciones de control rebar](/windows/desktop/Controls/bumper-rebar-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **SB** y **SBN**                   | Ventana de la barra de estado            | [Mensajes de la barra de estado](/windows/desktop/Controls/bumper-status-bars-reference-messages) y notificaciones de la barra de [estado](/windows/desktop/Controls/bumper-status-bars-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **Sbm**                              | Scroll Bar (control)           | [Mensajes de la barra de desplazamiento](/windows/desktop/Controls/bumper-scroll-bars-reference-messages)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **Smc**                              | Menú Shell                   | [Mensajes y notificaciones del shell](/windows/desktop/shell/control-panel-applications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **STM** y **STN**                  | Control estático               | [Mensajes de control estático](/windows/desktop/Controls/bumper-static-control-reference-messages) y [notificaciones de control estático](/windows/desktop/Controls/bumper-static-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **TB** y **TBN**                   | Barra de herramientas                      | [Mensajes de control de barra de herramientas](/windows/desktop/Controls/bumper-toolbar-control-reference-messages) y notificaciones de control de barra de [herramientas](/windows/desktop/Controls/bumper-toolbar-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **TBM** y **TRBN**                 | Control Trackbar             | [Mensajes de control de la barra de](/windows/desktop/Controls/bumper-trackbar-control-reference-messages) seguimiento y notificaciones de control de la barra de [seguimiento](/windows/desktop/Controls/bumper-trackbar-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **TCM** y **TCN**                  | Control Tab                  | [Mensajes de control de pestañas](/windows/desktop/Controls/bumper-tab-control-reference-messages) [y notificaciones de control de pestañas](/windows/desktop/Controls/bumper-tab-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **TDM** y **TDN**                  | Cuadro de diálogo Tarea                  | [Mensajes del cuadro de diálogo de tareas](/windows/desktop/Controls/bumper-task-dialogs-reference-messages) y notificaciones del cuadro de diálogo de [tareas](/windows/desktop/Controls/bumper-task-dialogs-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **TTM** y **TTN**                  | Control de información sobre herramientas              | [Mensajes de control de información sobre herramientas](/windows/desktop/Controls/bumper-tooltip-control-reference-messages) y notificaciones de control de información sobre [herramientas](/windows/desktop/Controls/bumper-tooltip-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **TVM** y **TVN**                  | Control vista de árbol            | [Mensajes de vista de árbol](/windows/desktop/Controls/bumper-tree-view-control-reference-messages) y notificaciones de vista de [árbol](/windows/desktop/Controls/bumper-tree-view-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **UDM** y **UDN**                  | Control de flechas              | [Mensajes de actualización](/windows/desktop/Controls/bumper-up-down-control-reference-messages) y [notificaciones de actualización](/windows/desktop/Controls/bumper-up-down-control-reference-notifications)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **Wm**                               | General                      | <dl> <dt>[](/windows/desktop/dataxchg/clipboard-messages)</dt> <dt>[](/windows/desktop/dataxchg/clipboard-notifications)</dt> <dt>[](/windows/desktop/dlgbox/common-dialog-box-notifications)</dt> Notificaciones comunes del Portapapeles Notificaciones del Portapapeles Cuadro de diálogo Notificaciones de cursor Notificaciones <dt>[](hook-notifications.md)</dt> <dt>[](/windows/desktop/menurc/keyboard-accelerator-messages)</dt> <dt>[](/windows/desktop/menurc/keyboard-accelerator-notifications)</dt> <dt>[](/windows/desktop/inputdev/keyboard-input-messages)</dt> <dt>[](/windows/desktop/inputdev/keyboard-input-notifications)</dt> <dt>[](/windows/desktop/menurc/menu-notifications)</dt> <dt>[](/windows/desktop/inputdev/mouse-input-notifications)</dt> <dt>[](multiple-document-interface-messages.md)</dt> <dt>[](/windows/desktop/inputdev/raw-input-notifications)</dt> <dt>[](/windows/desktop/Controls/bumper-scroll-bars-reference-notifications)</dt> <dt>[](timer-notifications.md)</dt> <dt>[](window-messages.md)</dt> <dt>[](window-notifications.md)</dt> de <dt>[cursor](/windows/desktop/menurc/cursor-notifications)</dt> <dt>[](/windows/desktop/dataxchg/wm-copydata)</dt> Copia de datos Mensaje <dt>[Administrador de ventanas de escritorio](/windows/desktop/dwm/dwm-messages)</dt> Mensajes <dt>[Administración de dispositivos](/windows/desktop/DevIO/device-management-messages)</dt> Cuadro de <dt>[diálogo](/windows/desktop/dlgbox/dialog-box-notifications)</dt> Notificaciones <dt>[datos dinámicos Exchange](/windows/desktop/dataxchg/dynamic-data-exchange-messages)</dt> Mensajes <dt>[datos dinámicos Exchange](/windows/desktop/dataxchg/dynamic-data-exchange-notifications)</dt> Notificaciones de enlace de notificaciones Del acelerador de teclado Mensajes del acelerador de teclado Notificaciones del acelerador de teclado Mensajes de entrada De teclado Notificaciones de menú Notificaciones de entrada del mouse Notificaciones de entrada de varios mensajes de interfaz de documento Notificaciones de entrada sin formato Notificaciones de barra de desplazamiento Notificaciones de temporizador Notificaciones de ventana Mensajes de ventana </dl> |



 

Los mensajes de ventana generales cubren una amplia gama de información y solicitudes, incluidos los mensajes para la entrada del mouse y el teclado, la entrada de menús y cuadros de diálogo, la creación y administración de ventanas y datos dinámicos Exchange (DDE).

### <a name="application-defined-messages"></a>Application-Defined mensajes

Una aplicación puede crear mensajes que se usarán en sus propias ventanas o para comunicarse con ventanas en otros procesos. Si una aplicación crea sus propios mensajes, el procedimiento de ventana que los recibe debe interpretar los mensajes y proporcionar el procesamiento adecuado.

Los valores de identificador de mensaje se usan de la siguiente manera:

-   El sistema reserva valores de identificador de mensaje en el intervalo 0x0000 a 0x03FF (el valor de [**WM \_ USER**](wm-user.md)  – 1) para los mensajes definidos por el sistema. Las aplicaciones no pueden usar estos valores para los mensajes privados.
-   Los valores del intervalo 0x0400 (el valor de [**WM \_ USER**](wm-user.md)) a 0x7FFF están disponibles para los identificadores de mensaje para las clases de ventana privadas.
-   Si la aplicación está marcada como versión 4.0, puede usar valores de identificador de mensaje en el intervalo 0x8000 ([**WM \_ APP**](wm-app.md)) a 0xBFFF para los mensajes privados.
-   El sistema devuelve un identificador de mensaje en el intervalo 0xC000 a 0xFFFF cuando una aplicación llama a la [**función RegisterWindowMessage**](/windows/win32/api/winuser/nf-winuser-registerwindowmessagea) para registrar un mensaje. Se garantiza que el identificador de mensaje devuelto por esta función es único en todo el sistema. El uso de esta función evita conflictos que pueden surgir si otras aplicaciones usan el mismo identificador de mensaje para fines diferentes.

## <a name="message-routing"></a>Enrutamiento de mensajes

El sistema usa dos métodos para enrutar mensajes a un procedimiento de ventana: publicar mensajes en una cola de primer en salir denominada cola de *mensajes,* un objeto de memoria definido por el sistema que almacena temporalmente mensajes y enviar mensajes directamente a un procedimiento de ventana.

Un mensaje que se publica en una cola de mensajes se denomina *mensaje en cola.* Estos son principalmente el resultado de la entrada del usuario escrita a través del mouse o el teclado, como mensajes [**WM \_ MOUSEMOVE,**](/windows/desktop/inputdev/wm-mousemove) [**WM \_ LBUTTONDOWN,**](/windows/desktop/inputdev/wm-lbuttondown) [**WM \_ KEYDOWN**](/windows/desktop/inputdev/wm-keydown)y [**WM \_ CHAR.**](/windows/desktop/inputdev/wm-char) Otros mensajes en cola incluyen los mensajes de temporizador, pintar y salir: [**WM \_ TIMER,**](wm-timer.md) [**WM \_ PAINT**](/windows/desktop/gdi/wm-paint)y [**WM \_ QUIT**](wm-quit.md). La mayoría de los demás mensajes, que se envían directamente a un procedimiento de ventana, se *denominan mensajes no en cola.*

-   [Mensajes en cola](#queued-messages)
-   [Mensajes no en cola](#nonqueued-messages)

### <a name="queued-messages"></a>Mensajes en cola

El sistema puede mostrar cualquier número de ventanas a la vez. Para enrutar la entrada del mouse y el teclado a la ventana adecuada, el sistema usa colas de mensajes.

El sistema mantiene una única cola de mensajes del sistema y una cola de mensajes específica del subproceso para cada subproceso de la GUI. Para evitar la sobrecarga de crear una cola de mensajes para subprocesos que no son GUI, todos los subprocesos se crean inicialmente sin una cola de mensajes. El sistema crea una cola de mensajes específica del subproceso solo cuando el subproceso realiza su primera llamada a una de las funciones de usuario específicas; ninguna llamada de función gui se genera en la creación de una cola de mensajes.

Cada vez que el usuario mueve el mouse, hace clic en los botones del mouse o en los tipos del teclado, el controlador del dispositivo para el mouse o el teclado convierte la entrada en mensajes y los coloca en la cola de mensajes del sistema. El sistema quita los mensajes, de uno en uno, de la cola de mensajes del sistema, los examina para determinar la ventana de destino y, a continuación, los envía a la cola de mensajes del subproceso que creó la ventana de destino. La cola de mensajes de un subproceso recibe todos los mensajes del mouse y del teclado para las ventanas creadas por el subproceso. El subproceso quita los mensajes de su cola y dirige al sistema para que los envíe al procedimiento de ventana adecuado para su procesamiento.

A excepción del mensaje [**\_ WM PAINT,**](/windows/desktop/gdi/wm-paint) el mensaje [**WM \_ TIMER**](wm-timer.md) y el mensaje [**WM \_ QUIT,**](wm-quit.md) el sistema siempre envía mensajes al final de una cola de mensajes. Esto garantiza que una ventana recibe sus mensajes de entrada en la secuencia FIFO (first in, first out) adecuada. Sin embargo, el mensaje **\_ WM PAINT,** el mensaje **WM \_ TIMER** y el mensaje **WM \_ QUIT** se mantienen en la cola y se reenvía al procedimiento de ventana solo cuando la cola no contiene ningún otro mensaje. Además, varios **mensajes WM \_ PAINT** para la misma ventana se combinan en un único **mensaje DE WM \_ PAINT,** consolidando todas las partes no válidas del área de cliente en un solo área. La combinación **de \_ mensajes WM PAINT** reduce el número de veces que una ventana debe volver a dibujar el contenido de su área cliente.

El sistema envía un mensaje a la cola de mensajes de un subproceso rellenando una estructura [**MSG**](/windows/win32/api/winuser/ns-winuser-msg) y, a continuación, cópielo en la cola de mensajes. La información de **MSG** incluye: el identificador de la ventana para la que está pensado el mensaje, el identificador del mensaje, los dos parámetros de mensaje, la hora en que se publicó el mensaje y la posición del cursor del mouse. Un subproceso puede publicar un mensaje en su propia cola de mensajes o en la cola de otro subproceso mediante la [**función PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) [**o PostThreadMessage.**](/windows/win32/api/winuser/nf-winuser-postthreadmessagea)

Una aplicación puede quitar un mensaje de su cola mediante la [**función GetMessage.**](/windows/win32/api/winuser/nf-winuser-getmessage) Para examinar un mensaje sin quitarlo de su cola, una aplicación puede usar la [**función PeekMessage.**](/windows/win32/api/winuser/nf-winuser-peekmessagea) Esta función rellena [**MSG con**](/windows/win32/api/winuser/ns-winuser-msg) información sobre el mensaje.

Después de quitar un mensaje de su cola, una aplicación puede usar la función [**DispatchMessage**](/windows/win32/api/winuser/nf-winuser-dispatchmessage) para dirigir al sistema para enviar el mensaje a un procedimiento de ventana para su procesamiento. **DispatchMessage** toma un puntero a [**MSG**](/windows/win32/api/winuser/ns-winuser-msg) rellenado por una llamada anterior a la [**función GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) [**o PeekMessage.**](/windows/win32/api/winuser/nf-winuser-peekmessagea) **DispatchMessage** pasa el identificador de ventana, el identificador del mensaje y los dos parámetros de mensaje al procedimiento de ventana, pero no pasa el tiempo que se publicó el mensaje o la posición del cursor del mouse. Una aplicación puede recuperar esta información llamando a las funciones [**GetMessageTime**](/windows/win32/api/winuser/nf-winuser-getmessagetime) y [**GetMessagePos**](/windows/win32/api/winuser/nf-winuser-getmessagepos) al procesar un mensaje.

Un subproceso puede usar la [**función WaitMessage**](/windows/win32/api/winuser/nf-winuser-waitmessage) para producir el control a otros subprocesos cuando no tiene ningún mensaje en su cola de mensajes. La función suspende el subproceso y no devuelve hasta que se coloca un nuevo mensaje en la cola de mensajes del subproceso.

Puede llamar a la [**función SetMessageExtraInfo para**](/windows/win32/api/winuser/nf-winuser-setmessageextrainfo) asociar un valor a la cola de mensajes del subproceso actual. A continuación, llame a la función [**GetMessageExtraInfo**](/windows/win32/api/winuser/nf-winuser-getmessageextrainfo) para obtener el valor asociado al último mensaje recuperado por la función [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) [**o PeekMessage.**](/windows/win32/api/winuser/nf-winuser-peekmessagea)

### <a name="nonqueued-messages"></a>Mensajes no en cola

Los mensajes no en cola se envían inmediatamente al procedimiento de la ventana de destino, omitiendo la cola de mensajes del sistema y la cola de mensajes del subproceso. Normalmente, el sistema envía mensajes no en cola para notificar a una ventana de eventos que le afectan. Por ejemplo, cuando el usuario activa una nueva ventana de aplicación, el sistema envía a la ventana una serie de mensajes, [**incluidos WM \_ ACTIVATE,**](/windows/desktop/inputdev/wm-activate) [**WM \_ SETFOCUS**](/windows/desktop/inputdev/wm-setfocus)y [**WM \_ SETCURSOR.**](/windows/desktop/menurc/wm-setcursor) Estos mensajes notifican a la ventana que se ha activado, que la entrada del teclado se dirige a la ventana y que el cursor del mouse se ha movido dentro de los bordes de la ventana. Los mensajes no en cola también pueden producirse cuando una aplicación llama a determinadas funciones del sistema. Por ejemplo, el sistema envía el [**mensaje \_ WINDOWPOSCHANGED de WM**](wm-windowposchanged.md) después de que una aplicación use la función [**SetWindowPos**](/windows/win32/api/winuser/nf-winuser-setwindowpos) para mover una ventana.

Algunas funciones que envían mensajes no en cola son [**BroadcastSystemMessage**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessage), [**BroadcastSystemMessageEx,**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessageexa) [**SendMessage,**](/windows/win32/api/winuser/nf-winuser-sendmessage) [**SendMessageTimeout**](/windows/win32/api/winuser/nf-winuser-sendmessagetimeouta)y [**SendNotifyMessage.**](/windows/win32/api/winuser/nf-winuser-sendnotifymessagea)

## <a name="message-handling"></a>Tratamiento de mensajes

Una aplicación debe quitar y procesar los mensajes publicados en las colas de mensajes de sus subprocesos. Una aplicación de un solo subproceso suele usar un bucle *de* mensajes en su función [**WinMain**](/windows/win32/api/winbase/nf-winbase-winmain) para quitar y enviar mensajes a los procedimientos de ventana adecuados para su procesamiento. Las aplicaciones con varios subprocesos pueden incluir un bucle de mensajes en cada subproceso que crea una ventana. En las secciones siguientes se describe cómo funciona un bucle de mensajes y se explica el rol de un procedimiento de ventana:

-   [Bucle de mensajes](#message-loop)
-   [Procedimiento de ventana](#window-procedure)

### <a name="message-loop"></a>Bucle de mensajes

Un bucle de mensajes simple consta de una llamada de función a cada una de estas tres funciones: [**GetMessage,**](/windows/win32/api/winuser/nf-winuser-getmessage) [**TranslateMessage**](/windows/win32/api/winuser/nf-winuser-translatemessage)y [**DispatchMessage**](/windows/win32/api/winuser/nf-winuser-dispatchmessage). Tenga en cuenta que si se produce un error, **GetMessage** devuelve –1, por lo que es necesario realizar las pruebas especiales.


```
MSG msg;
BOOL bRet;

while( (bRet = GetMessage( &msg, NULL, 0, 0 )) != 0)
{ 
    if (bRet == -1)
    {
        // handle the error and possibly exit
    }
    else
    {
        TranslateMessage(&msg); 
        DispatchMessage(&msg); 
    }
}
```



La [**función GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) recupera un mensaje de la cola y lo copia en una estructura de tipo [**MSG**](/windows/win32/api/winuser/ns-winuser-msg). Devuelve un valor distinto de cero, a menos que encuentre el mensaje [**\_ QUIT de WM,**](wm-quit.md) en cuyo caso devuelve **FALSE** y finaliza el bucle. En una aplicación de un solo subproceso, finalizar el bucle de mensajes suele ser el primer paso para cerrar la aplicación. Una aplicación puede finalizar su propio bucle mediante la [**función PostQuitMessage,**](/windows/win32/api/winuser/nf-winuser-postquitmessage) normalmente en respuesta al [**mensaje WM \_ DESTROY**](wm-destroy.md) en el procedimiento de ventana de la ventana principal de la aplicación.

Si especifica un identificador de ventana como segundo parámetro de [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage), solo se recuperan de la cola los mensajes de la ventana especificada. **GetMessage** también puede filtrar los mensajes de la cola, recuperando solo los mensajes que se encuentran dentro de un intervalo especificado. Para obtener más información sobre el filtrado de mensajes, vea [Filtrado de mensajes.](#message-filtering)

El bucle de mensajes de un subproceso debe [**incluir TranslateMessage**](/windows/win32/api/winuser/nf-winuser-translatemessage) si el subproceso va a recibir la entrada de caracteres del teclado. El sistema genera mensajes de clave virtual [**(WM \_ KEYDOWN**](/windows/desktop/inputdev/wm-keydown) y [**WM \_ KEYUP)**](/windows/desktop/inputdev/wm-keyup)cada vez que el usuario presiona una tecla. Un mensaje de clave virtual contiene un código de clave virtual que identifica qué tecla se presionó, pero no su valor de carácter. Para recuperar este valor, el bucle de mensajes debe contener **TranslateMessage**, que traduce el mensaje de clave virtual en un mensaje de caracteres [**(WM \_ CHAR)**](/windows/desktop/inputdev/wm-char)y lo coloca de nuevo en la cola de mensajes de la aplicación. El mensaje de carácter se puede quitar después de una iteración posterior del bucle de mensajes y enviarse a un procedimiento de ventana.

La [**función DispatchMessage**](/windows/win32/api/winuser/nf-winuser-dispatchmessage) envía un mensaje al procedimiento de ventana asociado al identificador de ventana especificado en la [**estructura MSG.**](/windows/win32/api/winuser/ns-winuser-msg) Si el identificador de ventana **es HWND \_ TOPMOST,** **DispatchMessage** envía el mensaje a los procedimientos de ventana de todas las ventanas de nivel superior del sistema. Si el identificador de ventana **es NULL,** **DispatchMessage** no hace nada con el mensaje.

El subproceso principal de una aplicación inicia su bucle de mensajes después de inicializar la aplicación y crear al menos una ventana. Una vez iniciado, el bucle de mensajes continúa recuperando mensajes de la cola de mensajes del subproceso y los envía a las ventanas adecuadas. El bucle de mensajes finaliza cuando la [**función GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) quita el [**mensaje \_ QUIT**](wm-quit.md) de WM de la cola de mensajes.

Solo se necesita un bucle de mensajes para una cola de mensajes, incluso si una aplicación contiene muchas ventanas. [**DispatchMessage**](/windows/win32/api/winuser/nf-winuser-dispatchmessage) siempre envía el mensaje a la ventana adecuada; esto se debe a que cada mensaje de la cola es una [**estructura MSG**](/windows/win32/api/winuser/ns-winuser-msg) que contiene el identificador de la ventana a la que pertenece el mensaje.

Puede modificar un bucle de mensajes de varias maneras. Por ejemplo, puede recuperar mensajes de la cola sin enviarlos a una ventana. Esto es útil para las aplicaciones que publican mensajes que no especifican una ventana. También puede dirigir a [**GetMessage para**](/windows/win32/api/winuser/nf-winuser-getmessage) que busque mensajes específicos, dejando otros mensajes en la cola. Esto resulta útil si debe omitir temporalmente el orden FIFO habitual de la cola de mensajes.

Una aplicación que usa teclas de aceleración debe ser capaz de traducir mensajes de teclado en mensajes de comandos. Para ello, el bucle de mensajes de la aplicación debe incluir una llamada a la [**función TranslateAccelerator.**](/windows/desktop/api/winuser/nf-winuser-translateacceleratora) Para obtener más información sobre las teclas de aceleración, vea [Aceleradores de teclado.](/windows/desktop/menurc/keyboard-accelerators)

Si un subproceso usa un cuadro de diálogo modeless, el bucle de mensajes debe incluir la función [**IsDialogMessage**](/windows/desktop/api/winuser/nf-winuser-isdialogmessagea) para que el cuadro de diálogo pueda recibir la entrada del teclado.

### <a name="window-procedure"></a>Procedimiento de ventana

Un procedimiento de ventana es una función que recibe y procesa todos los mensajes enviados a la ventana. Cada clase de ventana tiene un procedimiento de ventana y cada ventana creada con esa clase usa ese mismo procedimiento de ventana para responder a los mensajes.

El sistema envía un mensaje a un procedimiento de ventana pasando los datos del mensaje como argumentos al procedimiento. A continuación, el procedimiento de ventana realiza una acción adecuada para el mensaje; comprueba el identificador del mensaje y, al procesar el mensaje, usa la información especificada por los parámetros del mensaje.

Un procedimiento de ventana no suele omitir un mensaje. Si no procesa un mensaje, debe devolver el mensaje al sistema para su procesamiento predeterminado. El procedimiento de ventana hace esto llamando a la función [**DefWindowProc,**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) que realiza una acción predeterminada y devuelve un resultado del mensaje. A continuación, el procedimiento de ventana debe devolver este valor como resultado de su propio mensaje. La mayoría de los procedimientos de ventana procesan solo algunos mensajes y pasan los demás al sistema mediante una llamada **a DefWindowProc**.

Dado que todas las ventanas que pertenecen a la misma clase comparten un procedimiento de ventana, puede procesar mensajes para varias ventanas diferentes. Para identificar la ventana específica afectada por el mensaje, un procedimiento de ventana puede examinar el identificador de ventana pasado con un mensaje. Para obtener más información sobre los procedimientos de ventana, vea [Procedimientos de ventana](window-procedures.md).

## <a name="message-filtering"></a>Filtrado de mensajes

Una aplicación puede elegir mensajes específicos para recuperar de la cola de mensajes (sin tener en cuenta otros mensajes) mediante la función [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) o [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) para especificar un filtro de mensaje. El filtro es un intervalo de identificadores de mensaje (especificados por un primer y último identificador), un identificador de ventana o ambos. **GetMessage** y **PeekMessage** usan un filtro de mensajes para seleccionar los mensajes que se recuperarán de la cola. El filtrado de mensajes es útil si una aplicación debe buscar en la cola de mensajes los mensajes que han llegado más adelante a la cola. También es útil si una aplicación debe procesar los mensajes de entrada (hardware) antes de procesar los mensajes publicados.

Las **constantes WM \_ KEYFIRST** y **WM \_ KEYLAST** se pueden usar como valores de filtro para recuperar todos los mensajes de teclado; las constantes **WM \_ MOUSEFIRST** y **WM \_ MOUSELAST** se pueden usar para recuperar todos los mensajes del mouse.

Cualquier aplicación que filtre los mensajes debe asegurarse de que se pueda publicar un mensaje que cumpla el filtro del mensaje. Por ejemplo, si una aplicación filtra un mensaje [**\_ WM CHAR**](/windows/desktop/inputdev/wm-char) en una ventana que no recibe entrada de teclado, la función [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage) no devuelve . Esto hace que la aplicación se "cuelgue".

## <a name="posting-and-sending-messages"></a>Publicar y enviar mensajes

Cualquier aplicación puede publicar y enviar mensajes. Al igual que el sistema, una aplicación envía un mensaje al copiarlo en una cola de mensajes y envía un mensaje pasando los datos del mensaje como argumentos a un procedimiento de ventana. Para publicar mensajes, una aplicación usa la [**función PostMessage.**](/windows/win32/api/winuser/nf-winuser-postmessagea) Una aplicación puede enviar un mensaje llamando a la función [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage), [**BroadcastSystemMessage**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessage), [**SendMessageCallback**](/windows/win32/api/winuser/nf-winuser-sendmessagecallbacka), [**SendMessageTimeout,**](/windows/win32/api/winuser/nf-winuser-sendmessagetimeouta) [**SendNotifyMessage**](/windows/win32/api/winuser/nf-winuser-sendnotifymessagea)o [**SendDlgItemMessage.**](/windows/desktop/api/winuser/nf-winuser-senddlgitemmessagea)

### <a name="posting-messages"></a>Publicación de mensajes

Normalmente, una aplicación publica un mensaje para notificar a una ventana específica que realice una tarea. [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) crea una [**estructura MSG**](/windows/win32/api/winuser/ns-winuser-msg) para el mensaje y copia el mensaje en la cola de mensajes. El bucle de mensajes de la aplicación finalmente recupera el mensaje y lo envía al procedimiento de ventana adecuado.

Una aplicación puede publicar un mensaje sin especificar una ventana. Si la aplicación proporciona un **identificador de ventana NULL** al llamar a [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea), el mensaje se publica en la cola asociada al subproceso actual. Dado que no se especifica ningún identificador de ventana, la aplicación debe procesar el mensaje en el bucle de mensajes. Esta es una manera de crear un mensaje que se aplique a toda la aplicación, en lugar de a una ventana específica.

En ocasiones, es posible que quiera publicar un mensaje en todas las ventanas de nivel superior del sistema. Una aplicación puede publicar un mensaje en todas las ventanas de nivel superior llamando a [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) y **especificando HWND \_ TOPMOST** en el *parámetro hwnd.*

Un error de programación común es suponer que la [**función PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) siempre publica un mensaje. Esto no sucede cuando la cola de mensajes está llena. Una aplicación debe comprobar el valor devuelto de la **función PostMessage** para determinar si el mensaje se ha publicado y, si no lo ha sido, volver a publicarlo.

### <a name="sending-messages"></a>enviar mensajes

Normalmente, una aplicación envía un mensaje para notificar a un procedimiento de ventana que realice una tarea inmediatamente. La [**función SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) envía el mensaje al procedimiento de ventana correspondiente a la ventana dada. La función espera hasta que el procedimiento de ventana finaliza el procesamiento y, a continuación, devuelve el resultado del mensaje. Las ventanas primarias y secundarias a menudo se comunican mediante el envío de mensajes entre sí. Por ejemplo, una ventana primaria que tiene un control de edición como ventana secundaria puede establecer el texto del control mediante el envío de un mensaje a él. El control puede notificar a la ventana primaria los cambios en el texto que lleva a cabo el usuario mediante el envío de mensajes al elemento primario.

La [**función SendMessageCallback**](/windows/win32/api/winuser/nf-winuser-sendmessagecallbacka) también envía un mensaje al procedimiento de ventana correspondiente a la ventana dada. Sin embargo, esta función se devuelve inmediatamente. Después de que el procedimiento de ventana procese el mensaje, el sistema llama a la función de devolución de llamada especificada. Para obtener más información sobre la función de devolución de llamada, consulte [**la función SendAsyncProc.**](/windows/win32/api/winuser/nc-winuser-sendasyncproc)

En ocasiones, es posible que quiera enviar un mensaje a todas las ventanas de nivel superior del sistema. Por ejemplo, si la aplicación cambia la hora del sistema, debe notificar a todas las ventanas de nivel superior sobre el cambio mediante el envío de [**un mensaje \_ TIMECHANGE de WM.**](../sysinfo/wm-timechange.md) Una aplicación puede enviar un mensaje a todas las ventanas de nivel superior llamando a [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) y **especificando HWND \_ TOPMOST** en el *parámetro hwnd.* También puede difundir un mensaje a todas las aplicaciones llamando a la función [**BroadcastSystemMessage**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessage) y especificando **BSM \_ APPLICATIONS** en el parámetro *lpdwRecipients.*

Mediante la [**función InSendMessage**](/windows/win32/api/winuser/nf-winuser-insendmessage) o [**InSendMessageEx,**](/windows/win32/api/winuser/nf-winuser-insendmessageex) un procedimiento de ventana puede determinar si está procesando un mensaje enviado por otro subproceso. Esta funcionalidad es útil cuando el procesamiento de mensajes depende del origen del mensaje.

## <a name="message-deadlocks"></a>Interbloqueos de mensajes

Un subproceso que llama a la [**función SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) para enviar un mensaje a otro subproceso no puede continuar ejecutándose hasta que se devuelva el procedimiento de ventana que recibe el mensaje. Si el subproceso receptor produce el control durante el procesamiento del mensaje, el subproceso de envío no puede continuar ejecutándose, porque está esperando a **que SendMessage** devuelva . Si el subproceso receptor está asociado a la misma cola que el remitente, puede provocar un interbloqueo de la aplicación. (Tenga en cuenta que los enlaces de diario adjuntan subprocesos a la misma cola).

Tenga en cuenta que el subproceso receptor no tiene que producir el control explícitamente; Llamar a cualquiera de las funciones siguientes puede hacer que un subproceso produjese el control implícitamente.

-   [**Cuadro de diálogo**](/windows/desktop/api/winuser/nf-winuser-dialogboxa)
-   [**DialogBoxIndirect**](/windows/desktop/api/winuser/nf-winuser-dialogboxindirecta)
-   [**DialogBoxIndirectParam**](/windows/desktop/api/winuser/nf-winuser-dialogboxindirectparama)
-   [**DialogBoxParam**](/windows/desktop/api/winuser/nf-winuser-dialogboxparama)
-   [**GetMessage**](/windows/win32/api/winuser/nf-winuser-getmessage)
-   [**Cuadro de mensajes**](/windows/desktop/api/winuser/nf-winuser-messagebox)
-   [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea)
-   [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage)

Para evitar posibles interbloqueos en la aplicación, considere la posibilidad de usar las [**funciones SendNotifyMessage**](/windows/win32/api/winuser/nf-winuser-sendnotifymessagea) [**o SendMessageTimeout.**](/windows/win32/api/winuser/nf-winuser-sendmessagetimeouta) De lo contrario, un procedimiento de ventana puede determinar si otro subproceso envió un mensaje que ha recibido llamando a la [**función InSendMessage**](/windows/win32/api/winuser/nf-winuser-insendmessage) o [**InSendMessageEx.**](/windows/win32/api/winuser/nf-winuser-insendmessageex) Antes de llamar a cualquiera de las funciones de la lista anterior mientras se procesa un mensaje, el procedimiento de ventana debe llamar primero a **InSendMessage** o **InSendMessageEx.** Si esta función devuelve **TRUE**, el procedimiento de ventana debe llamar a la función [**ReplyMessage**](/windows/win32/api/winuser/nf-winuser-replymessage) antes de cualquier función que haga que el subproceso devuelva el control.

## <a name="broadcasting-messages"></a>Difusión de mensajes

Cada mensaje consta de un identificador de mensaje y dos parámetros, *wParam* *y lParam.* El identificador del mensaje es un valor único que especifica el propósito del mensaje. Los parámetros proporcionan información adicional específica del mensaje, pero el parámetro *wParam* suele ser un valor de tipo que proporciona más información sobre el mensaje.

Una *difusión de* mensajes es simplemente el envío de un mensaje a varios destinatarios del sistema. Para difundir un mensaje desde una aplicación, use la [**función BroadcastSystemMessage,**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessage) especificando los destinatarios del mensaje. En lugar de especificar destinatarios individuales, debe especificar uno o varios tipos de destinatarios. Estos tipos son aplicaciones, controladores instalables, controladores de red y controladores de dispositivo de nivel de sistema. El sistema envía mensajes de difusión a todos los miembros de cada tipo especificado.

Normalmente, el sistema difunde mensajes en respuesta a los cambios que tienen lugar en los controladores de dispositivos de nivel del sistema o en los componentes relacionados. El controlador o componente relacionado difunde el mensaje a las aplicaciones y otros componentes para notificarles el cambio. Por ejemplo, el componente responsable de las unidades de disco difunde un mensaje cada vez que el controlador de dispositivo de la unidad de disquete detecta un cambio de medios, como cuando el usuario inserta un disco en la unidad.

El sistema difunde mensajes a los destinatarios en este orden: controladores de dispositivo de nivel de sistema, controladores de red, controladores instalables y aplicaciones. Esto significa que los controladores de dispositivos de nivel de sistema, si se eligen como destinatarios, siempre tienen la primera oportunidad de responder a un mensaje. Dentro de un tipo de destinatario determinado, no se garantiza que ningún controlador reciba un mensaje determinado antes que ningún otro controlador. Esto significa que un mensaje destinado a un controlador específico debe tener un identificador de mensaje único global para que ningún otro controlador lo procese involuntarlamente.

También puede difundir mensajes a todas las ventanas de nivel superior especificando **HWND \_ BROADCAST** en la función [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage), [**SendMessageCallback,**](/windows/win32/api/winuser/nf-winuser-sendmessagecallbacka) [**SendMessageTimeout**](/windows/win32/api/winuser/nf-winuser-sendmessagetimeouta) [**o SendNotifyMessage.**](/windows/win32/api/winuser/nf-winuser-sendnotifymessagea)

Las aplicaciones reciben mensajes a través del procedimiento de ventana de sus ventanas de nivel superior. Los mensajes no se envían a las ventanas secundarias. Los servicios pueden recibir mensajes a través de un procedimiento de ventana o sus controladores de control de servicio.

> [!Note]  
> Los controladores de dispositivos de nivel de sistema usan una función relacionada de nivel de sistema para difundir mensajes del sistema.

 

## <a name="query-messages"></a>Mensajes de consulta

Puede crear sus propios mensajes personalizados y usarlos para coordinar las actividades entre las aplicaciones y otros componentes del sistema. Esto es especialmente útil si ha creado sus propios controladores instalables o controladores de dispositivo de nivel de sistema. Los mensajes personalizados pueden llevar información hacia y desde el controlador y las aplicaciones que usan el controlador.

Para sondear a los destinatarios el permiso para llevar a cabo una acción determinada, use un *mensaje de consulta*. Puede generar sus propios mensajes de consulta estableciendo el valor query de **BSF \_** en el *parámetro dwFlags* al llamar a [**BroadcastSystemMessage**](/windows/win32/api/winuser/nf-winuser-broadcastsystemmessage). Cada destinatario del mensaje de consulta debe devolver **TRUE para** que la función envíe el mensaje al destinatario siguiente. Si algún destinatario devuelve **BROADCAST \_ QUERY \_ DENY**, la difusión finaliza inmediatamente y la función devuelve un cero.

 

 
