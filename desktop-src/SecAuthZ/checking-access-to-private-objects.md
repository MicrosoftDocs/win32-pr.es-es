---
description: Una aplicación de servidor protegido debe comprobar los derechos de acceso de los clientes antes de permitir que el cliente tenga acceso a un objeto privado protegido.
ms.assetid: dce4dd10-1d5f-40a3-8a7e-ec708d3123c7
title: Comprobar el acceso a objetos privados
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c6b7b3d8b2cd933b00be0be9f1f2b077f5c7a2d2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104001224"
---
# <a name="checking-access-to-private-objects"></a><span data-ttu-id="03f5e-103">Comprobar el acceso a objetos privados</span><span class="sxs-lookup"><span data-stu-id="03f5e-103">Checking Access to Private Objects</span></span>

<span data-ttu-id="03f5e-104">Una aplicación de servidor protegido debe comprobar los derechos de acceso de un cliente antes de permitir que el cliente tenga acceso a un objeto privado protegido.</span><span class="sxs-lookup"><span data-stu-id="03f5e-104">A protected server application must check a client's access rights before allowing the client to access a protected private object.</span></span> <span data-ttu-id="03f5e-105">Para ello, el servidor pasa un [*token de suplantación*](/windows/desktop/SecGloss/i-gly), un descriptor de seguridad y un conjunto de derechos de acceso solicitados a [**AccessCheck**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheck).</span><span class="sxs-lookup"><span data-stu-id="03f5e-105">To do this, the server passes an [*impersonation token*](/windows/desktop/SecGloss/i-gly), a security descriptor, and a set of requested access rights to [**AccessCheck**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheck).</span></span> <span data-ttu-id="03f5e-106">Las [*entradas de control de acceso*](/windows/desktop/SecGloss/a-gly) (ACE) de la DACL [*del descriptor de seguridad*](/windows/desktop/SecGloss/s-gly) especifican los derechos de acceso permitidos o denegados a varios confíantes.</span><span class="sxs-lookup"><span data-stu-id="03f5e-106">The [*access control entries*](/windows/desktop/SecGloss/a-gly) (ACEs) in the [*security descriptor's*](/windows/desktop/SecGloss/s-gly) DACL specify the access rights allowed or denied to various trustees.</span></span> <span data-ttu-id="03f5e-107">La función **AccessCheck** compara el administrador de confianza de cada ACE con los destinatarios identificados en el token de suplantación.</span><span class="sxs-lookup"><span data-stu-id="03f5e-107">The **AccessCheck** function compares the trustee in each ACE to the trustees identified in the impersonation token.</span></span> <span data-ttu-id="03f5e-108">Para obtener una descripción del algoritmo que se usa para conceder o denegar el acceso, vea [Cómo controlan el acceso a un objeto las DACL](how-dacls-control-access-to-an-object.md).</span><span class="sxs-lookup"><span data-stu-id="03f5e-108">For a description of the algorithm used to grant or deny access, see [How DACLs Control Access to an Object](how-dacls-control-access-to-an-object.md).</span></span>

<span data-ttu-id="03f5e-109">La función [**AccessCheckAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckandauditalarma) realiza una comprobación de acceso similar.</span><span class="sxs-lookup"><span data-stu-id="03f5e-109">The [**AccessCheckAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckandauditalarma) function performs a similar access check.</span></span> <span data-ttu-id="03f5e-110">Además, genera registros de auditoría en el registro de eventos de seguridad según la SACL del descriptor de seguridad.</span><span class="sxs-lookup"><span data-stu-id="03f5e-110">In addition, it generates audit records in the security event log depending on the SACL in the security descriptor.</span></span>

<span data-ttu-id="03f5e-111">Las funciones [**AccessCheckByType**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheckbytype) y [**AccessCheckByTypeAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckbytypeandauditalarma) son similares a [**AccessCheck**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheck) y [**AccessCheckAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckandauditalarma) , salvo que permiten comprobar el acceso a los subobjetos de un objeto, como los conjuntos de propiedades o las propiedades.</span><span class="sxs-lookup"><span data-stu-id="03f5e-111">The [**AccessCheckByType**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheckbytype) and [**AccessCheckByTypeAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckbytypeandauditalarma) functions are similar to [**AccessCheck**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheck) and [**AccessCheckAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckandauditalarma) except that they allow you to check access to the subobjects of an object, such as property sets or properties.</span></span> <span data-ttu-id="03f5e-112">Las funciones [**AccessCheckByTypeResultList**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheckbytyperesultlist) y [**AccessCheckByTypeResultListAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckbytyperesultlistandauditalarma) también son similares a **AccessCheck** , salvo que proporcionan los resultados de la comprobación de acceso para cada subobjeto en una jerarquía de las propiedades y los conjuntos de propiedades del objeto.</span><span class="sxs-lookup"><span data-stu-id="03f5e-112">The [**AccessCheckByTypeResultList**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheckbytyperesultlist) and [**AccessCheckByTypeResultListAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckbytyperesultlistandauditalarma) functions are also similar to **AccessCheck** except that they provide the access check results for each subobject in a hierarchy of the object's properties and property sets.</span></span> <span data-ttu-id="03f5e-113">Estas funciones usan la estructura de la [**\_ \_ lista de tipos de objeto**](/windows/desktop/api/Winnt/ns-winnt-object_type_list) para describir la jerarquía de objetos para los que se comprueba el acceso.</span><span class="sxs-lookup"><span data-stu-id="03f5e-113">These functions use the [**OBJECT\_TYPE\_LIST**](/windows/desktop/api/Winnt/ns-winnt-object_type_list) structure to describe the hierarchy of objects for which access is checked.</span></span> <span data-ttu-id="03f5e-114">Las funciones que generan un mensaje de auditoría usan el tipo de enumeración de [**\_ \_ tipo de evento de auditoría**](/windows/desktop/api/Winnt/ne-winnt-audit_event_type) para indicar si el objeto que se está comprobando es un objeto de servicio de directorio.</span><span class="sxs-lookup"><span data-stu-id="03f5e-114">The functions that generate an audit message use the [**AUDIT\_EVENT\_TYPE**](/windows/desktop/api/Winnt/ne-winnt-audit_event_type) enumeration type to indicate whether the object being checked is a directory service object.</span></span> <span data-ttu-id="03f5e-115">Para obtener más información acerca de la jerarquía de un objeto y sus subobjetos, vea [ACE para controlar el acceso a las propiedades de un objeto](aces-to-control-access-to-an-object-s-properties.md).</span><span class="sxs-lookup"><span data-stu-id="03f5e-115">For more information about the hierarchy of an object and its subobjects, see [ACEs to Control Access to an Object's Properties](aces-to-control-access-to-an-object-s-properties.md).</span></span>

<span data-ttu-id="03f5e-116">Los derechos de acceso solicitados que se pasan a las funciones [**AccessCheck**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheck) y [**AccessCheckAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckandauditalarma) no deben incluir [derechos de acceso genéricos](generic-access-rights.md).</span><span class="sxs-lookup"><span data-stu-id="03f5e-116">The requested access rights passed to the [**AccessCheck**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheck) and [**AccessCheckAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckandauditalarma) functions must not include any [generic access rights](generic-access-rights.md).</span></span> <span data-ttu-id="03f5e-117">El servidor puede usar la función [**MapGenericMask**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-mapgenericmask) para convertir los derechos de acceso genéricos en los derechos específicos y estándar correspondientes según la asignación especificada en la estructura de [**\_ asignación genérica**](/windows/desktop/api/Winnt/ns-winnt-generic_mapping) .</span><span class="sxs-lookup"><span data-stu-id="03f5e-117">The server can use the [**MapGenericMask**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-mapgenericmask) function to convert any generic access rights to the corresponding specific and standard rights according to the mapping specified in the [**GENERIC\_MAPPING**](/windows/desktop/api/Winnt/ns-winnt-generic_mapping) structure.</span></span>

<span data-ttu-id="03f5e-118">Las funciones [**AreAllAccessesGranted**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-areallaccessesgranted) y [**AreAnyAccessesGranted**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-areanyaccessesgranted) comparan una [*máscara de acceso*](/windows/desktop/SecGloss/a-gly) solicitada con una máscara de acceso concedida.</span><span class="sxs-lookup"><span data-stu-id="03f5e-118">The [**AreAllAccessesGranted**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-areallaccessesgranted) and [**AreAnyAccessesGranted**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-areanyaccessesgranted) functions compare a requested [*access mask*](/windows/desktop/SecGloss/a-gly) with a granted access mask.</span></span>

<span data-ttu-id="03f5e-119">Para ver el código de ejemplo que usa la función [**AccessCheck**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheck) , vea [comprobar el acceso de cliente con ACL en C++](verifying-client-access-with-acls-in-c--.md).</span><span class="sxs-lookup"><span data-stu-id="03f5e-119">For sample code that uses the [**AccessCheck**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheck) function, see [Verifying Client Access with ACLs in C++](verifying-client-access-with-acls-in-c--.md).</span></span>

<span data-ttu-id="03f5e-120">La función [**ConvertToAutoInheritPrivateObjectSecurity**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-converttoautoinheritprivateobjectsecurity) crea y devuelve un descriptor de seguridad en un formato que permite la propagación automática de las ACE heredables.</span><span class="sxs-lookup"><span data-stu-id="03f5e-120">The [**ConvertToAutoInheritPrivateObjectSecurity**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-converttoautoinheritprivateobjectsecurity) function creates and returns a security descriptor in a format that allows the automatic propagation of inheritable ACEs.</span></span> <span data-ttu-id="03f5e-121">Este descriptor de seguridad contiene todas las ACE, heredadas y no heredadas, en el descriptor de seguridad actual y está en formato [*autorelativo*](/windows/desktop/SecGloss/s-gly) .</span><span class="sxs-lookup"><span data-stu-id="03f5e-121">This security descriptor contains all of the ACEs, inherited and noninherited, in the current security descriptor and is in [*self-relative*](/windows/desktop/SecGloss/s-gly) format.</span></span> <span data-ttu-id="03f5e-122">La función **ConvertToAutoInheritPrivateObjectSecurity** determina si las ACE son heredadas o no heredadas comparando todas las ACE en el descriptor de seguridad actual con todas las ACE en su descriptor de seguridad primario.</span><span class="sxs-lookup"><span data-stu-id="03f5e-122">The **ConvertToAutoInheritPrivateObjectSecurity** function determines whether the ACEs are inherited or noninherited by comparing all of the ACEs in the current security descriptor with all of the ACEs in its parent security descriptor.</span></span> <span data-ttu-id="03f5e-123">Es posible que no haya una correspondencia uno a uno entre los dos grupos de ACE.</span><span class="sxs-lookup"><span data-stu-id="03f5e-123">There may not be a one-to-one correspondence between the two groups of ACEs.</span></span> <span data-ttu-id="03f5e-124">Por ejemplo, una ACE que permita permisos de lectura y escritura puede ser equivalente a dos ACE: una ACE que permita el permiso de lectura y una ACE que permita el permiso de escritura.</span><span class="sxs-lookup"><span data-stu-id="03f5e-124">For instance, an ACE that allows read/write permission can be equivalent to two ACEs: an ACE that allows read permission and an ACE that allows write permission.</span></span> <span data-ttu-id="03f5e-125">No se puede proporcionar un descriptor de seguridad primario cuando el descriptor de seguridad actual es el elemento primario.</span><span class="sxs-lookup"><span data-stu-id="03f5e-125">A parent security descriptor may not be supplied when the current security descriptor is the parent.</span></span>

 

 
