---
title: Interfaces de persistencia
description: Interfaces de persistencia
ms.assetid: a93582b3-bdbf-430d-b4a6-c0df7bc35dc0
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c2e1acbd1074fd5fa4e87e571a1e21ab48d5d075
ms.sourcegitcommit: f848119a8faa29b27585f4df53f6e50ee9666684
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/27/2021
ms.locfileid: "110550510"
---
# <a name="persistence-interfaces"></a><span data-ttu-id="78ed5-103">Interfaces de persistencia</span><span class="sxs-lookup"><span data-stu-id="78ed5-103">Persistence Interfaces</span></span>

<span data-ttu-id="78ed5-104">Los objetos que tienen un estado persistente de cualquier tipo deben implementar al menos una interfaz IPersist y, preferiblemente, varias interfaces, para proporcionar al contenedor la opción más flexible de cómo desea guardar el estado de un \* control.</span><span class="sxs-lookup"><span data-stu-id="78ed5-104">Objects that have a persistent state of any kind must implement at least one IPersist\* interface, and preferably multiple interfaces, in order to provide the container with the most flexible choice of how it wishes to save a control's state.</span></span>

<span data-ttu-id="78ed5-105">Si un control tiene cualquier estado persistente, como mínimo, debe implementar [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) o [**IPersistStreamInit**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit) (los dos son mutuamente excluyentes y no deben implementarse juntos en su mayor parte).</span><span class="sxs-lookup"><span data-stu-id="78ed5-105">If a control has any persistent state whatsoever, it must, as a minimum, implement either [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) or [**IPersistStreamInit**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit) (the two are mutually exclusive and shouldn't be implemented together for the most part).</span></span> <span data-ttu-id="78ed5-106">Este último se usa cuando un control desea saber cuándo se crea nuevo en lugar de volver a cargarse desde un estado persistente existente (**IPersistStream** no tiene la nueva funcionalidad creada).</span><span class="sxs-lookup"><span data-stu-id="78ed5-106">The latter is used when a control wishes to know when it is created new as opposed to reloaded from an existing persistent state (**IPersistStream** does not have the created new capability).</span></span> <span data-ttu-id="78ed5-107">La existencia de cualquiera de las interfaces indica que el control puede guardar y cargar su estado persistente en una secuencia, es decir, una instancia de [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream).</span><span class="sxs-lookup"><span data-stu-id="78ed5-107">The existence of either interface indicates that the control can save and load its persistent state into a stream, that is, an instance of [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream).</span></span>

<span data-ttu-id="78ed5-108">Además de estas dos interfaces basadas en secuencias, las interfaces IPersist enumeradas en la tabla siguiente se pueden proporcionar opcionalmente para admitir la persistencia en ubicaciones distintas de una \* [**IStream ampliable.**](/windows/desktop/api/objidl/nn-objidl-istream)</span><span class="sxs-lookup"><span data-stu-id="78ed5-108">Beyond these two stream-based interfaces, the IPersist\* interfaces listed in the following table can be optionally provided in order to support persistence to locations other than an expandable [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream).</span></span>

<span data-ttu-id="78ed5-109">Se identifica un conjunto de categorías de componentes para cubrir la compatibilidad con interfaces de persistencia, vea [Categorías de componentes](component-categories.md).</span><span class="sxs-lookup"><span data-stu-id="78ed5-109">A set of component categories is identified to cover the support for persistency interfaces see [Component Categories](component-categories.md).</span></span>



| <span data-ttu-id="78ed5-110">Interfaz</span><span class="sxs-lookup"><span data-stu-id="78ed5-110">Interface</span></span>                                                              | <span data-ttu-id="78ed5-111">Uso</span><span class="sxs-lookup"><span data-stu-id="78ed5-111">Usage</span></span>                                                                                                                                                                                                                                                                                                                                                       |
|------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="78ed5-112">[**IPersistMemory**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="78ed5-112">[**IPersistMemory**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85))</span></span><br/>           | <span data-ttu-id="78ed5-113">El objeto puede guardar y cargar su estado en una matriz de bytes secuenciales de longitud fija (en memoria).</span><span class="sxs-lookup"><span data-stu-id="78ed5-113">The object can save and load its state into a fixed-length sequential byte array (in memory).</span></span><br/>                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="78ed5-114">**IPersistStorage**</span><span class="sxs-lookup"><span data-stu-id="78ed5-114">**IPersistStorage**</span></span>](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage)<br/>                  | <span data-ttu-id="78ed5-115">El objeto puede guardar y cargar su estado en una [**instancia de IStorage.**](/windows/desktop/api/objidl/nn-objidl-istorage)</span><span class="sxs-lookup"><span data-stu-id="78ed5-115">The object can save and load its state into an [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) instance.</span></span> <span data-ttu-id="78ed5-116">Los controles que deseen marcarse como Insertable como otros objetos de documento compuestos (para la inserción en contenedores que no tienen en cuenta el control) deben admitir esta interfaz.</span><span class="sxs-lookup"><span data-stu-id="78ed5-116">Controls that wish to be marked Insertable as other compound document objects (for insertion into non-control aware containers) must support this interface.</span></span><br/>                                                                                               |
| [<span data-ttu-id="78ed5-117">**IPersistPropertyBag**</span><span class="sxs-lookup"><span data-stu-id="78ed5-117">**IPersistPropertyBag**</span></span>](/windows/win32/api/ocidl/nn-ocidl-ipersistpropertybag)<br/> | <span data-ttu-id="78ed5-118">El objeto puede guardar y cargar su estado como propiedades individuales escritas en IPropertyBag que implementa el contenedor.</span><span class="sxs-lookup"><span data-stu-id="78ed5-118">The object can save and load its state as individual properties written to IPropertyBag which the container implements.</span></span> <span data-ttu-id="78ed5-119">Esto se usa para la funcionalidad Guardar como texto en algunos contenedores.</span><span class="sxs-lookup"><span data-stu-id="78ed5-119">This is used for Save As Text functionality in some containers.</span></span><br/>                                                                                                                                                          |
| <span data-ttu-id="78ed5-120">[**IPersistMoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="78ed5-120">[**IPersistMoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85))</span></span><br/>  | <span data-ttu-id="78ed5-121">El objeto puede guardar y cargar su estado en una ubicación denominada por un moniker.</span><span class="sxs-lookup"><span data-stu-id="78ed5-121">The object can save and load its state to a location named by a moniker.</span></span> <span data-ttu-id="78ed5-122">El control llama [**a IMoniker::BindToStorage**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtostorage) para recuperar la interfaz de almacenamiento que requiere, como [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage), [**IStream,**](/windows/desktop/api/objidl/nn-objidl-istream) [**ILockBytes,**](/windows/desktop/api/objidl/nn-objidl-ilockbytes) [**IDataObject,**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)etc.</span><span class="sxs-lookup"><span data-stu-id="78ed5-122">The control calls [**IMoniker::BindToStorage**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtostorage) to retrieve the storage interface it requires, such as [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage), [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream), [**ILockBytes**](/windows/desktop/api/objidl/nn-objidl-ilockbytes), [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), etc.</span></span><br/> |



 

<span data-ttu-id="78ed5-123">Aunque la compatibilidad [**con IPersistPropertyBag**](/windows/win32/api/ocidl/nn-ocidl-ipersistpropertybag) es opcional, se recomienda encarecidamente como optimización para contenedores con características de guardar como texto, como Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="78ed5-123">While support for [**IPersistPropertyBag**](/windows/win32/api/ocidl/nn-ocidl-ipersistpropertybag) is optional, it is strongly recommended as an optimization for containers with Save As Text features, such as Visual Basic.</span></span>

<span data-ttu-id="78ed5-124">A excepción de [**IPersistStream::GetSizeMax**](/windows/desktop/api/ObjIdl/nf-objidl-ipersiststream-getsizemax), [**IPersistStreamInit::GetSizeMax**](/windows/desktop/api/OCIdl/nf-ocidl-ipersiststreaminit-getsizemax)e [**IPersistMemory::GetSizeMax**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768208(v=vs.85)), todos los métodos de cada interfaz deben estar totalmente implementados.</span><span class="sxs-lookup"><span data-stu-id="78ed5-124">With the exception of [**IPersistStream::GetSizeMax**](/windows/desktop/api/ObjIdl/nf-objidl-ipersiststream-getsizemax), [**IPersistStreamInit::GetSizeMax**](/windows/desktop/api/OCIdl/nf-ocidl-ipersiststreaminit-getsizemax), and [**IPersistMemory::GetSizeMax**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768208(v=vs.85)), all methods of each interface must be fully implemented.</span></span>

## <a name="related-topics"></a><span data-ttu-id="78ed5-125">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="78ed5-125">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="78ed5-126">Controles</span><span class="sxs-lookup"><span data-stu-id="78ed5-126">Controls</span></span>](controls.md)
</dt> </dl>

 

