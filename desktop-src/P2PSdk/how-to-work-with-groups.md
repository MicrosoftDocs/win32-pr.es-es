---
description: La agrupación punto a punto es una tecnología que permite a los desarrolladores crear una red del mismo nivel segura de forma rápida y eficaz.
ms.assetid: ee72f60b-1e5b-4b69-bda0-2ae80734c144
title: Cómo trabajar con grupos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f7bebf958d0c3fdee6ad0dc400d495c54ec2e6fe
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104545526"
---
# <a name="how-to-work-with-groups"></a><span data-ttu-id="85fd4-103">Cómo trabajar con grupos</span><span class="sxs-lookup"><span data-stu-id="85fd4-103">How to Work With Groups</span></span>

<span data-ttu-id="85fd4-104">La agrupación punto a punto es una tecnología que permite a los desarrolladores crear una red del mismo nivel segura de forma rápida y eficaz.</span><span class="sxs-lookup"><span data-stu-id="85fd4-104">Peer-to-peer Grouping is a technology that allows a developer to create a secure peer network quickly and effectively.</span></span> <span data-ttu-id="85fd4-105">En la lista siguiente se identifican las consideraciones principales para crear una aplicación de agrupación del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="85fd4-105">The following list identifies the major considerations in creating a peer grouping application.</span></span>

-   [<span data-ttu-id="85fd4-106">Obtener una identidad del mismo nivel</span><span class="sxs-lookup"><span data-stu-id="85fd4-106">Obtaining a Peer Identity</span></span>](#obtaining-a-peer-identity)
-   [<span data-ttu-id="85fd4-107">Inicio de un grupo del mismo nivel</span><span class="sxs-lookup"><span data-stu-id="85fd4-107">Starting Up a Peer Group</span></span>](#starting-up-the-peer-grouping-infrastructure)
-   [<span data-ttu-id="85fd4-108">Registro para agrupar eventos</span><span class="sxs-lookup"><span data-stu-id="85fd4-108">Registering for Grouping Events</span></span>](#registering-for-peer-grouping-events)
-   [<span data-ttu-id="85fd4-109">Conexión a un grupo</span><span class="sxs-lookup"><span data-stu-id="85fd4-109">Connecting to a Group</span></span>](#obtaining-a-group-handle)
-   [<span data-ttu-id="85fd4-110">Crear roles de administrador y de miembro</span><span class="sxs-lookup"><span data-stu-id="85fd4-110">Creating Administrator and Member Roles</span></span>](#creating-administrator-and-member-roles)
-   [<span data-ttu-id="85fd4-111">Buscar un elemento del mismo nivel</span><span class="sxs-lookup"><span data-stu-id="85fd4-111">Finding a Peer</span></span>](#finding-a-peer)
-   [<span data-ttu-id="85fd4-112">Conectarse directamente a un elemento del mismo nivel</span><span class="sxs-lookup"><span data-stu-id="85fd4-112">Connecting Directly to a Peer</span></span>](#connecting-directly-to-a-peer)
-   [<span data-ttu-id="85fd4-113">Cerrar y cerrar un grupo</span><span class="sxs-lookup"><span data-stu-id="85fd4-113">Closing and Shutting Down a Group</span></span>](#closing-and-shutting-down-a-peer-group)

## <a name="obtaining-a-peer-identity"></a><span data-ttu-id="85fd4-114">Obtener una identidad del mismo nivel</span><span class="sxs-lookup"><span data-stu-id="85fd4-114">Obtaining a Peer Identity</span></span>

<span data-ttu-id="85fd4-115">Antes de crear o conectarse a un grupo, un elemento del mismo nivel debe obtener una identidad del mismo nivel, que es un nombre que se usa para identificar de forma única un elemento del mismo nivel con un grupo.</span><span class="sxs-lookup"><span data-stu-id="85fd4-115">Before creating or connecting to a group, a peer must obtain a peer identity, which is a name used to uniquely identify a peer to a group.</span></span> <span data-ttu-id="85fd4-116">Para obtener una lista enumerada de todas las identidades del mismo nivel definidas en el elemento del mismo nivel, llame a [**PeerEnumIdentities**](/windows/desktop/api/P2P/nf-p2p-peerenumidentities), que devuelve un identificador a la enumeración.</span><span class="sxs-lookup"><span data-stu-id="85fd4-116">To obtain an enumerated list of all peer identities defined on the peer, call [**PeerEnumIdentities**](/windows/desktop/api/P2P/nf-p2p-peerenumidentities), which returns a handle to the enumeration.</span></span> <span data-ttu-id="85fd4-117">Para obtener las identidades del mismo nivel, llame a [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem) con el identificador de la enumeración y el número de miembros que se van a recuperar.</span><span class="sxs-lookup"><span data-stu-id="85fd4-117">To obtain the peer identities, call [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem) with the enumeration handle and the number of members to retrieve.</span></span> <span data-ttu-id="85fd4-118">Continúe llamando a **PeerGetNextItem** hasta que el parámetro *pCount* devuelva un valor menor que el número de identidades del mismo nivel solicitadas.</span><span class="sxs-lookup"><span data-stu-id="85fd4-118">Continue calling **PeerGetNextItem** until the *pCount* parameter returns a value less than the number of peer identities requested.</span></span>

<span data-ttu-id="85fd4-119">Si no existe una identidad del mismo nivel para el mismo nivel, puede crearse mediante una llamada a [**PeerIdentityCreate**](/windows/desktop/api/P2P/nf-p2p-peeridentitycreate).</span><span class="sxs-lookup"><span data-stu-id="85fd4-119">If a peer identity for the peer does not exist, it can be created by calling [**PeerIdentityCreate**](/windows/desktop/api/P2P/nf-p2p-peeridentitycreate).</span></span> <span data-ttu-id="85fd4-120">Después de crear una identidad del mismo nivel, el elemento del mismo nivel genera un BLOB XML de identidad que contiene la clave pública asignada a él.</span><span class="sxs-lookup"><span data-stu-id="85fd4-120">After creating a peer identity, the peer generates an identity XML blob that contains the public key assigned to it</span></span>

<span data-ttu-id="85fd4-121">La información de identidad del mismo nivel se obtiene llamando a [**PeerIdentityGetXML**](/windows/desktop/api/P2P/nf-p2p-peeridentitygetxml).</span><span class="sxs-lookup"><span data-stu-id="85fd4-121">The peer identity information is obtained by calling [**PeerIdentityGetXML**](/windows/desktop/api/P2P/nf-p2p-peeridentitygetxml).</span></span> <span data-ttu-id="85fd4-122">El creador de grupo o un administrador usan esta información de identidad del mismo nivel para emitir las credenciales necesarias para unirse al grupo, como un BLOB XML de invitación.</span><span class="sxs-lookup"><span data-stu-id="85fd4-122">This peer identity information is used by the group creator or an administrator to issue the credentials needed to join the group, as an invitation XML blob.</span></span>

<span data-ttu-id="85fd4-123">Para obtener más información sobre las identidades del mismo nivel, consulte la documentación de la [API de Identity Manager](identity-manager-api.md) .</span><span class="sxs-lookup"><span data-stu-id="85fd4-123">For more information on peer identities, please refer to the [Identity Manager API](identity-manager-api.md) documentation</span></span>

## <a name="starting-up-the-peer-grouping-infrastructure"></a><span data-ttu-id="85fd4-124">Inicio de la infraestructura de agrupación del mismo nivel</span><span class="sxs-lookup"><span data-stu-id="85fd4-124">Starting Up the Peer Grouping Infrastructure</span></span>

<span data-ttu-id="85fd4-125">Antes de que una aplicación llame a cualquier función de la API de agrupación del mismo nivel, se debe llamar a [**PeerGroupStartup**](/windows/desktop/api/P2P/nf-p2p-peergroupstartup) .</span><span class="sxs-lookup"><span data-stu-id="85fd4-125">Before any function in the Peer Grouping API is called by an application, [**PeerGroupStartup**](/windows/desktop/api/P2P/nf-p2p-peergroupstartup) must be called.</span></span> <span data-ttu-id="85fd4-126">Esta función inicializa la infraestructura de agrupación del mismo nivel para la aplicación y establece la versión admitida.</span><span class="sxs-lookup"><span data-stu-id="85fd4-126">This function initializes the Peer Grouping Infrastructure for the application and sets the supported version.</span></span>

## <a name="obtaining-a-group-handle"></a><span data-ttu-id="85fd4-127">Obtener un identificador de grupo</span><span class="sxs-lookup"><span data-stu-id="85fd4-127">Obtaining a Group Handle</span></span>

<span data-ttu-id="85fd4-128">Para conectarse a un grupo y comenzar a participar, se debe obtener un identificador de un grupo del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="85fd4-128">To connect to a group and begin participating, a handle to a peer group must be obtained.</span></span> <span data-ttu-id="85fd4-129">En la lista siguiente se identifican las tres formas de conectarse a un grupo del mismo nivel:</span><span class="sxs-lookup"><span data-stu-id="85fd4-129">The following list identifies the three ways to connect to a peer group:</span></span>

-   <span data-ttu-id="85fd4-130">Crear un grupo del mismo nivel llamando a [**PeerGroupCreate**](/windows/desktop/api/P2P/nf-p2p-peergroupcreate), que inicializa un nuevo grupo del mismo nivel y devuelve un identificador válido con el elemento del mismo nivel como propietario y administrador único.</span><span class="sxs-lookup"><span data-stu-id="85fd4-130">Creating a peer group by calling [**PeerGroupCreate**](/windows/desktop/api/P2P/nf-p2p-peergroupcreate), which initializes a new peer group and returns a valid handle with the peer as the owner and sole administrator.</span></span>
-   <span data-ttu-id="85fd4-131">Unirse a un grupo del mismo nivel mediante una llamada a [**PeerGroupJoin**](/windows/desktop/api/P2P/nf-p2p-peergroupjoin).</span><span class="sxs-lookup"><span data-stu-id="85fd4-131">Joining a peer group by calling [**PeerGroupJoin**](/windows/desktop/api/P2P/nf-p2p-peergroupjoin).</span></span> <span data-ttu-id="85fd4-132">Para unirse a un grupo del mismo nivel, un elemento del mismo nivel debe recibir una invitación de un administrador de grupo del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="85fd4-132">To join a peer group, a peer must receive an invitation from a peer group administrator.</span></span> <span data-ttu-id="85fd4-133">Para obtener una invitación, envíe el BLOB XML de información de identidad al administrador que crea una invitación y la envía a usted mediante un mecanismo externo, como correo electrónico o FTP.</span><span class="sxs-lookup"><span data-stu-id="85fd4-133">To obtain an invitation, send the identity information XML blob to the administrator who creates an invitation and sends it to you by an external mechanism, such as email or FTP.</span></span> <span data-ttu-id="85fd4-134">La invitación y la identidad del mismo nivel se pasan a **PeerGroupJoin**, que devuelve un identificador válido para el grupo.</span><span class="sxs-lookup"><span data-stu-id="85fd4-134">The invitation and peer identity are passed to **PeerGroupJoin**, which returns a valid handle to the group.</span></span>
-   <span data-ttu-id="85fd4-135">Abrir un grupo del mismo nivel que un elemento del mismo nivel ha unido previamente llamando a [**PeerGroupOpen**](/windows/desktop/api/P2P/nf-p2p-peergroupopen).</span><span class="sxs-lookup"><span data-stu-id="85fd4-135">Opening a peer group that a peer has joined previously by calling [**PeerGroupOpen**](/windows/desktop/api/P2P/nf-p2p-peergroupopen).</span></span> <span data-ttu-id="85fd4-136">En esta situación, no es necesario obtener una invitación.</span><span class="sxs-lookup"><span data-stu-id="85fd4-136">In this situation, obtaining an invitation is not necessary.</span></span>

<span data-ttu-id="85fd4-137">Después de obtener un identificador de grupo del mismo nivel válido de una de las funciones anteriores, puede conectarse a un grupo del mismo nivel llamando a [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect) con el nuevo identificador.</span><span class="sxs-lookup"><span data-stu-id="85fd4-137">After you obtain a valid peer group handle from one of the above functions, you can connect to a peer group by calling [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect) with the new handle.</span></span>

> [!Note]  
> <span data-ttu-id="85fd4-138">Si se produce un error en la conexión a un grupo del mismo nivel, \_ \_ \_ se produce el evento error de conexión de eventos de grupo del mismo nivel \_ .</span><span class="sxs-lookup"><span data-stu-id="85fd4-138">If the connection to a peer group fails, the PEER\_GROUP\_EVENT\_CONNECTION\_FAILED event occurs.</span></span> <span data-ttu-id="85fd4-139">El controlador puede intentar restablecer la conexión con el grupo del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="85fd4-139">The handler can attempt to reestablish the connection to the peer group.</span></span>

 

## <a name="registering-for-peer-grouping-events"></a><span data-ttu-id="85fd4-140">Registrando eventos de agrupación del mismo nivel</span><span class="sxs-lookup"><span data-stu-id="85fd4-140">Registering for Peer Grouping Events</span></span>

<span data-ttu-id="85fd4-141">Antes de que un elemento del mismo nivel participe en un grupo del mismo nivel, el mismo nivel debe registrarse para los eventos de grupo del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="85fd4-141">Before a peer participates in a peer group, the peer must register for peer group events.</span></span> <span data-ttu-id="85fd4-142">Para registrarse para eventos del mismo nivel específicos, llame a [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent)y pase uno o varios de los tipos de evento del mismo nivel definidos en el tipo de evento de grupo del mismo nivel \_ \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="85fd4-142">To register for specific peer events, call [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent), and pass in one or more of the peer event types defined in PEER\_GROUP\_EVENT\_TYPE.</span></span> <span data-ttu-id="85fd4-143">Debe registrarse para cada evento del mismo nivel que se aplique a la aplicación; por ejemplo, para recibir datos a través de una conexión directa, Regístrese para los eventos de datos entrantes de eventos de grupo del mismo nivel y de eventos \_ \_ \_ \_ de grupo del mismo nivel \_ \_ \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="85fd4-143">You must register for each peer event that applies to your application; for example, to receive data over a direct connection, register for the PEER\_GROUP\_EVENT\_DIRECT\_CONNECTION and PEER\_GROUP\_EVENT\_INCOMING\_DATA events.</span></span> <span data-ttu-id="85fd4-144">Cada llamada toma un identificador de evento y devuelve un identificador de **HPEEREVENT** para ese evento del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="85fd4-144">Each call takes an event handle and returns an **HPEEREVENT** handle for that peer event.</span></span>

<span data-ttu-id="85fd4-145">Los controladores de eventos pueden obtener los datos asociados a un evento del mismo nivel pasando el identificador a los eventos del mismo nivel registrados a [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata).</span><span class="sxs-lookup"><span data-stu-id="85fd4-145">Event handlers can obtain the data associated with a peer event by passing the handle to registered peer events to [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata).</span></span> <span data-ttu-id="85fd4-146">Estos datos de eventos del mismo nivel se devuelven como una Unión de datos de eventos de grupo del mismo nivel \_ \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="85fd4-146">This peer event data is returned as a PEER\_GROUP\_EVENT\_DATA union.</span></span> <span data-ttu-id="85fd4-147">Si la cola de eventos del mismo nivel está vacía, esta función devuelve elementos del mismo nivel que \_ \_ no son datos de \_ evento \_ .</span><span class="sxs-lookup"><span data-stu-id="85fd4-147">If the peer event queue is empty, this function returns PEER\_S\_NO\_EVENT\_DATA.</span></span>

<span data-ttu-id="85fd4-148">Puede anular el registro para los eventos del mismo nivel llamando a [**PeerGroupUnregisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupunregisterevent) y proporcionando el identificador del evento del mismo nivel que desea eliminar del registro.</span><span class="sxs-lookup"><span data-stu-id="85fd4-148">You can unregister for peer events by calling [**PeerGroupUnregisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupunregisterevent) and providing the handle for the peer event you want to unregister.</span></span> <span data-ttu-id="85fd4-149">Una vez que se llama a la función, los eventos del mismo nivel asociados al identificador ya no se registran.</span><span class="sxs-lookup"><span data-stu-id="85fd4-149">After the function is called, the peer events associated with the handle are no longer registered.</span></span>

## <a name="creating-administrator-and-member-roles"></a><span data-ttu-id="85fd4-150">Crear roles de administrador y de miembro</span><span class="sxs-lookup"><span data-stu-id="85fd4-150">Creating Administrator and Member Roles</span></span>

<span data-ttu-id="85fd4-151">El elemento del mismo nivel que crea el grupo del mismo nivel se conoce como creador de grupo del mismo nivel y tiene el rol de administrador de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="85fd4-151">The peer who creates the peer group is known as the peer group creator, and has the administrator role by default.</span></span> <span data-ttu-id="85fd4-152">Solo el creador del grupo del mismo nivel puede establecer las propiedades del grupo.</span><span class="sxs-lookup"><span data-stu-id="85fd4-152">Only the peer group creator can set the group properties.</span></span>

<span data-ttu-id="85fd4-153">Los pares invitados al grupo del mismo nivel pueden ser un administrador o un miembro.</span><span class="sxs-lookup"><span data-stu-id="85fd4-153">Peers invited to the peer group can be either an administrator or a member.</span></span> <span data-ttu-id="85fd4-154">Si el administrador que emite la invitación le asigna un rol de administrador, puede invitar a nuevos miembros al grupo del mismo nivel y asignar igualmente el rol de administrador a otros miembros.</span><span class="sxs-lookup"><span data-stu-id="85fd4-154">If they are assigned an administrator role by the administrator issuing the invitation, they can invite new members to the peer group, and likewise assign the administrator role to other members.</span></span>

<span data-ttu-id="85fd4-155">Los roles de los miembros del grupo del mismo nivel se establecen en las invitaciones que el administrador proporciona a un miembro.</span><span class="sxs-lookup"><span data-stu-id="85fd4-155">The roles of peer group members are set in the invitations the administrator gives to a member.</span></span> <span data-ttu-id="85fd4-156">Para agregar más administradores, establezca el valor del parámetro *pRoles* de [**PeerGroupCreateInvitation**](/windows/desktop/api/P2P/nf-p2p-peergroupcreateinvitation) en Administrador de \_ rol de \_ grupo \_ cuando cree una invitación.</span><span class="sxs-lookup"><span data-stu-id="85fd4-156">To add more administrators, set the value of the *pRoles* parameter of [**PeerGroupCreateInvitation**](/windows/desktop/api/P2P/nf-p2p-peergroupcreateinvitation) to PEER\_GROUP\_ROLE\_ADMIN when creating an invitation.</span></span>

<span data-ttu-id="85fd4-157">Los miembros pueden participar en un grupo del mismo nivel, pero no pueden invitar y autorizar nuevos miembros, establecer propiedades de grupo o actualizar o eliminar registros de grupo que no crean específicamente.</span><span class="sxs-lookup"><span data-stu-id="85fd4-157">Members can participate in a peer group, but cannot invite and authorize new members, set group properties, or update or delete group records that they do not specifically create.</span></span> <span data-ttu-id="85fd4-158">Para asignar el estado de un miembro a un elemento del mismo nivel participante, establezca el valor del parámetro **pRoles** de [**PeerGroupCreateInvitation**](/windows/desktop/api/P2P/nf-p2p-peergroupcreateinvitation) en miembro del rol de grupo del mismo nivel \_ \_ \_ cuando cree una invitación para ese mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="85fd4-158">To assign member status to a participating peer, set the value of the **pRoles** parameter of [**PeerGroupCreateInvitation**](/windows/desktop/api/P2P/nf-p2p-peergroupcreateinvitation) to PEER\_GROUP\_ROLE\_MEMBER when you create an invitation for that peer.</span></span>

<span data-ttu-id="85fd4-159">Para cambiar el rol de un miembro, se deben emitir nuevas credenciales que contengan el nuevo rol para ese miembro.</span><span class="sxs-lookup"><span data-stu-id="85fd4-159">To change the role of a member, new credentials containing the new role must be issued to that member.</span></span> <span data-ttu-id="85fd4-160">Para ello, obtenga la estructura [**de \_ \_ información de la credencial del mismo nivel**](/windows/desktop/api/P2P/ns-p2p-peer_credential_info) para este miembro de la estructura de miembro del mismo nivel \_ devuelta por [**PeerGroupEnumMembers**](/windows/desktop/api/P2P/nf-p2p-peergroupenummembers).</span><span class="sxs-lookup"><span data-stu-id="85fd4-160">To accomplish this, obtain the [**PEER\_CREDENTIAL\_INFO**](/windows/desktop/api/P2P/ns-p2p-peer_credential_info) structure for this member from the PEER\_MEMBER structure returned by [**PeerGroupEnumMembers**](/windows/desktop/api/P2P/nf-p2p-peergroupenummembers).</span></span> <span data-ttu-id="85fd4-161">Cambie el campo **pRoles** de la información de la **\_ credencial \_ del mismo nivel** al nuevo rol y pase la estructura a [**PeerGroupIssueCredentials**](/windows/desktop/api/P2P/nf-p2p-peergroupissuecredentials).</span><span class="sxs-lookup"><span data-stu-id="85fd4-161">Change the **pRoles** field in **PEER\_CREDENTIAL\_INFO** to the new role, and pass the structure to [**PeerGroupIssueCredentials**](/windows/desktop/api/P2P/nf-p2p-peergroupissuecredentials).</span></span>

<span data-ttu-id="85fd4-162">Las nuevas credenciales no entrarán en vigor para el elemento del mismo nivel hasta que se conecten al grupo del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="85fd4-162">The new credentials will not go into effect for the peer until they connect to the peer group.</span></span> <span data-ttu-id="85fd4-163">Si están conectados actualmente, deben cerrar el grupo y volver a conectarse para obtener las credenciales actualizadas.</span><span class="sxs-lookup"><span data-stu-id="85fd4-163">If they are currently connected, they must close the group and reconnect to obtain the updated credentials.</span></span>

## <a name="finding-a-peer"></a><span data-ttu-id="85fd4-164">Buscar un elemento del mismo nivel</span><span class="sxs-lookup"><span data-stu-id="85fd4-164">Finding a Peer</span></span>

<span data-ttu-id="85fd4-165">Para obtener una lista enumerada de todos los elementos del mismo nivel que participan en el grupo del mismo nivel, llame a [**PeerGroupEnumMembers**](/windows/desktop/api/P2P/nf-p2p-peergroupenummembers) con el identificador de grupo, que devuelve un identificador a la enumeración.</span><span class="sxs-lookup"><span data-stu-id="85fd4-165">To obtain an enumerated list of all peers participating in the peer group, call [**PeerGroupEnumMembers**](/windows/desktop/api/P2P/nf-p2p-peergroupenummembers) with the group handle, which returns a handle to the enumeration.</span></span> <span data-ttu-id="85fd4-166">Para obtener los miembros, llame a [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem) con el identificador de enumeración y el número de miembros que se van a recuperar.</span><span class="sxs-lookup"><span data-stu-id="85fd4-166">To obtain the members, call [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem) with the enum handle and the number of members to retrieve.</span></span> <span data-ttu-id="85fd4-167">Continúe llamando a **PeerGetNextItem** hasta que el parámetro *pCount* devuelva un valor menor que el número de miembros solicitados.</span><span class="sxs-lookup"><span data-stu-id="85fd4-167">Continue calling **PeerGetNextItem** until the *pCount* parameter returns a value less than the number of members requested.</span></span> <span data-ttu-id="85fd4-168">Tenga en cuenta que es posible que no se devuelva la lista completa de miembros disponibles.</span><span class="sxs-lookup"><span data-stu-id="85fd4-168">Note that the complete list of available members may not be returned.</span></span>

<span data-ttu-id="85fd4-169">Cada miembro se representa como una estructura de [**\_ miembro del mismo nivel**](/windows/desktop/api/P2P/ns-p2p-peer_member) , que contiene la identidad del elemento del mismo nivel, los identificadores de nodo y las direcciones IP para los pares activos.</span><span class="sxs-lookup"><span data-stu-id="85fd4-169">Each member is represented as a [**PEER\_MEMBER**](/windows/desktop/api/P2P/ns-p2p-peer_member) structure, which contains the identity of the peer, node IDs, and IP addresses for active peers.</span></span>

<span data-ttu-id="85fd4-170">Cuando termine, cierre la enumeración y libere la memoria asociada llamando a [**PeerEndEnumeration**](/windows/desktop/api/P2P/nf-p2p-peerendenumeration).</span><span class="sxs-lookup"><span data-stu-id="85fd4-170">When finished, close the enumeration and release the associated memory by calling [**PeerEndEnumeration**](/windows/desktop/api/P2P/nf-p2p-peerendenumeration).</span></span>

## <a name="connecting-directly-to-a-peer"></a><span data-ttu-id="85fd4-171">Conectarse directamente a un elemento del mismo nivel</span><span class="sxs-lookup"><span data-stu-id="85fd4-171">Connecting Directly to a Peer</span></span>

<span data-ttu-id="85fd4-172">Cuando un elemento del mismo nivel se conecta a un grupo del mismo nivel, los intercambios uno a uno directo con otros miembros conectados se inician llamando a [**PeerGroupOpenDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupopendirectconnection) y proporcionando la identidad del otro nodo del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="85fd4-172">When a peer is connected to a peer group, direct one-to-one exchanges with other connected members are initiated by calling [**PeerGroupOpenDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupopendirectconnection) and supplying the identity of the other peer.</span></span> <span data-ttu-id="85fd4-173">Esta llamada es asincrónica y devuelve un identificador de conexión de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="85fd4-173">This call is asynchronous, and returns a 64-bit connection ID.</span></span> <span data-ttu-id="85fd4-174">Si la llamada se realiza correctamente, recibirá el \_ evento del mismo nivel evento de conexión directa de evento de grupo del mismo nivel \_ \_ \_ \_ para indicar que la conexión se ha realizado correctamente.</span><span class="sxs-lookup"><span data-stu-id="85fd4-174">If the call is successful, you receive the PEER\_GROUP\_EVENT\_DIRECT\_CONNECTION\_EVENT peer event to indicate that the connection is successful.</span></span> <span data-ttu-id="85fd4-175">Si la conexión es correcta, el identificador de conexión es válido y se puede usar para enviar y recibir datos a través de la conexión directa.</span><span class="sxs-lookup"><span data-stu-id="85fd4-175">If the connection is successful, the connection ID is valid and can be used to send and receive data through the direct connection.</span></span>

<span data-ttu-id="85fd4-176">Para poder recibir conexiones directas, el otro elemento del mismo nivel también debe haberse registrado previamente para el \_ \_ evento del \_ mismo nivel de conexión directa de eventos de grupo del mismo nivel \_ .</span><span class="sxs-lookup"><span data-stu-id="85fd4-176">To be able to receive direct connections, the other peer must also have previously registered for the PEER\_GROUP\_EVENT\_DIRECT\_CONNECTION peer event.</span></span>

<span data-ttu-id="85fd4-177">Para enviar datos a un elemento del mismo nivel, llame a [**PeerGroupSendData**](/windows/desktop/api/P2P/nf-p2p-peergroupsenddata) con un identificador de conexión válido.</span><span class="sxs-lookup"><span data-stu-id="85fd4-177">To send data to a peer, call [**PeerGroupSendData**](/windows/desktop/api/P2P/nf-p2p-peergroupsenddata) with a valid connection ID.</span></span> <span data-ttu-id="85fd4-178">Para recibir datos, el otro nodo del mismo nivel debe estar registrado para el \_ \_ evento del \_ mismo nivel de datos entrantes del evento de grupo del mismo nivel \_ .</span><span class="sxs-lookup"><span data-stu-id="85fd4-178">To receive data, the other peer must be registered for the PEER\_GROUP\_EVENT\_INCOMING\_DATA peer event.</span></span> <span data-ttu-id="85fd4-179">Del mismo modo, si el elemento de envío del mismo nivel desea recibir datos a su vez, también debe registrarse para el \_ \_ evento del \_ mismo nivel de datos entrantes del evento de grupo del mismo nivel \_ .</span><span class="sxs-lookup"><span data-stu-id="85fd4-179">Likewise, if the sending peer wants to receive data in turn, it also must be registered for the PEER\_GROUP\_EVENT\_INCOMING\_DATA peer event.</span></span>

<span data-ttu-id="85fd4-180">Para recibir el conjunto total de conexiones directas activas actualmente con otros elementos del mismo nivel en un grupo, llame a [**PeerGroupEnumConnections**](/windows/desktop/api/P2P/nf-p2p-peergroupenumconnections) para abrir la enumeración y recorra en iteración la lista de conexiones con [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem).</span><span class="sxs-lookup"><span data-stu-id="85fd4-180">To receive the total set of currently active direct connections with other peers in a group, call [**PeerGroupEnumConnections**](/windows/desktop/api/P2P/nf-p2p-peergroupenumconnections) to open the enumeration and iterate through the list of connections by using [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem).</span></span>

<span data-ttu-id="85fd4-181">Para cerrar una conexión directa, llame a [**PeerGroupCloseDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupclosedirectconnection) y pase el identificador de conexión.</span><span class="sxs-lookup"><span data-stu-id="85fd4-181">To close a direct connection, call [**PeerGroupCloseDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupclosedirectconnection) and pass in the connection ID.</span></span>

## <a name="closing-and-shutting-down-a-peer-group"></a><span data-ttu-id="85fd4-182">Cerrar y apagar un grupo del mismo nivel</span><span class="sxs-lookup"><span data-stu-id="85fd4-182">Closing and Shutting Down a Peer Group</span></span>

<span data-ttu-id="85fd4-183">Para cerrar una conexión a un grupo del mismo nivel, llame a [**PeerGroupClose**](/windows/desktop/api/P2P/nf-p2p-peergroupclose), que invalida el identificador de grupo, pero no cierra la infraestructura de agrupación del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="85fd4-183">To close a connection to a peer group, call [**PeerGroupClose**](/windows/desktop/api/P2P/nf-p2p-peergroupclose), which invalidates the group handle, but does not shut down the Peer Grouping Infrastructure.</span></span> <span data-ttu-id="85fd4-184">Los datos del grupo punto a punto se eliminan llamando a [**PeerGroupDelete**](/windows/desktop/api/P2P/nf-p2p-peergroupdelete).</span><span class="sxs-lookup"><span data-stu-id="85fd4-184">Peer-to-peer group data is deleted by calling [**PeerGroupDelete**](/windows/desktop/api/P2P/nf-p2p-peergroupdelete).</span></span>

<span data-ttu-id="85fd4-185">Cuando la aplicación termine de usar la infraestructura de agrupación del mismo nivel, debe llamar a [**PeerGroupShutdown**](/windows/desktop/api/P2P/nf-p2p-peergroupshutdown).</span><span class="sxs-lookup"><span data-stu-id="85fd4-185">When the application is finished using the Peer Grouping Infrastructure, it must call [**PeerGroupShutdown**](/windows/desktop/api/P2P/nf-p2p-peergroupshutdown).</span></span>

 

 



