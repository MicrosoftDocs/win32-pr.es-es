---
title: Reflexión del registro
description: El redirector del registro aísla las aplicaciones de 32 y 64 bits proporcionando vistas lógicas independientes de ciertas partes del registro en WOW64. Sin embargo, los valores de algunas claves del registro deben ser los mismos en las vistas de 32 bits y de 64 bits.
ms.assetid: eac9038b-9f59-4ac7-8974-f94a4a62a257
keywords:
- reflexión del registro 64 programación de Windows de bits
- Reflection 64 programación de Windows de bits
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 523041004d9570bbdf101050e30f5d9139031913
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "105695682"
---
# <a name="registry-reflection"></a><span data-ttu-id="d1ce8-106">Reflexión del registro</span><span class="sxs-lookup"><span data-stu-id="d1ce8-106">Registry Reflection</span></span>

<span data-ttu-id="d1ce8-107">\[La información de este tema se aplica a Windows Server 2008, Windows Vista, Windows Server 2003 y Windows XP.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-107">\[The information in this topic applies to Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP.</span></span> <span data-ttu-id="d1ce8-108">A partir de Windows 7 y Windows Server 2008 R2, WOW64 ya no utiliza la reflexión del registro y, en su lugar, se comparten claves reflejadas.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-108">Starting with Windows 7 and Windows Server 2008 R2, WOW64 no longer uses registry reflection and formerly reflected keys are shared instead.</span></span> <span data-ttu-id="d1ce8-109">Para obtener más información, consulte [claves del registro afectadas por WOW64](shared-registry-keys.md).\]</span><span class="sxs-lookup"><span data-stu-id="d1ce8-109">For more information, see [Registry Keys Affected by WOW64](shared-registry-keys.md).\]</span></span>

<span data-ttu-id="d1ce8-110">El [redirector del registro](registry-redirector.md) aísla las aplicaciones de 32 y 64 bits proporcionando vistas lógicas independientes de ciertas partes del registro en WOW64.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-110">The [registry redirector](registry-redirector.md) isolates 32-bit and 64-bit applications by providing separate logical views of certain portions of the registry on WOW64.</span></span> <span data-ttu-id="d1ce8-111">Sin embargo, los valores de algunas claves del registro deben ser los mismos en las vistas de 32 bits y de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-111">However, the values of some registry keys must be the same in both the 32-bit and 64-bit views.</span></span>

<span data-ttu-id="d1ce8-112">El proceso de *reflexión del registro* copia las claves y los valores del registro entre dos vistas del registro para mantenerlas sincronizadas.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-112">The process of *registry reflection* copies registry keys and values between two registry views to keep them synchronized.</span></span> <span data-ttu-id="d1ce8-113">Cada vista tiene una copia física independiente de cada clave del registro reflejada, una para la vista del registro de 32 bits y la otra para la vista del registro de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-113">Each view has a separate physical copy of each reflected registry key, one for the 32-bit registry view and the other for the 64-bit registry view.</span></span>

<span data-ttu-id="d1ce8-114">Cuando se cierra una clave mediante una llamada a [**RegCloseKey**](/windows/desktop/api/winreg/nf-winreg-regclosekey), se copia una clave reflejada.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-114">A reflected key is copied when a key is closed by calling [**RegCloseKey**](/windows/desktop/api/winreg/nf-winreg-regclosekey).</span></span> <span data-ttu-id="d1ce8-115">Tenga en cuenta que esto da lugar a una posible condición de carrera: Si más de un proceso cambia la clave reflejada, la última llamada a **RegCloseKey** determina el valor final de la clave.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-115">Note that this gives rise to a possible race condition: if more than one process changes the reflected key, the last **RegCloseKey** call determines the key's final value.</span></span>

<span data-ttu-id="d1ce8-116">El reflector copia los datos de activación COM para los servidores locales entre las vistas, pero no copia los datos en proceso porque 32/64 no se permite la combinación de datos en proceso en Windows de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-116">The reflector copies COM activation data for Local servers between the views, but it does not copy in-process data because 32/64 in-process data mixing is not permitted on 64-bit Windows.</span></span>

<span data-ttu-id="d1ce8-117">La reflexión no está habilitada para las claves del registro compartidas o para las claves del registro que no se redirigen.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-117">Reflection is not enabled for shared registry keys or for registry keys that are not redirected.</span></span> <span data-ttu-id="d1ce8-118">Por ejemplo, la reflexión no está habilitada para la clave **\_ \_ \\ del sistema del equipo local HKEY** .</span><span class="sxs-lookup"><span data-stu-id="d1ce8-118">For example, reflection is not enabled for the **HKEY\_LOCAL\_MACHINE\\System** key.</span></span> <span data-ttu-id="d1ce8-119">Para obtener una lista de las claves del registro que se redirigen, comparten o reflejan, consulte [las claves del registro afectadas por WOW64](shared-registry-keys.md).</span><span class="sxs-lookup"><span data-stu-id="d1ce8-119">For a list of registry keys that are redirected, shared, or reflected, see [Registry Keys Affected by WOW64](shared-registry-keys.md).</span></span>

<span data-ttu-id="d1ce8-120">La reflexión del registro utiliza una directiva de "último escritor WINS" como se muestra en el ejemplo siguiente:</span><span class="sxs-lookup"><span data-stu-id="d1ce8-120">Registry reflection uses a "last writer wins" policy as illustrated in the following example:</span></span>

-   <span data-ttu-id="d1ce8-121">Después de una instalación limpia de Windows de 64 bits, el Wordpad.exe de 64 bits se registra para administrar los archivos. doc.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-121">After a clean installation of 64-bit Windows, 64-bit Wordpad.exe is registered to handle .doc files.</span></span> <span data-ttu-id="d1ce8-122">El reflector copia el registro. doc de la vista del registro de 64 bits en la vista del registro de 32 bits.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-122">The reflector copies the .doc registration from the 64-bit registry view into the 32-bit registry view.</span></span>
-   <span data-ttu-id="d1ce8-123">Un administrador instala Office de 32 bits, que registra Winword.exe de 32 bits para administrar los archivos. doc en la vista del registro de 32 bits.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-123">An administrator installs 32-bit Office, which registers 32-bit Winword.exe to handle .doc files in the 32-bit registry view.</span></span> <span data-ttu-id="d1ce8-124">El reflector del registro copia esta información en la vista del registro de 64 bits, por lo que las aplicaciones de 32 bits y de 64 bits inician la versión de 32 bits de Winword.exe para los archivos. doc.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-124">The registry reflector copies this information into the 64-bit registry view, so both 32-bit and 64-bit applications launch the 32-bit version of Winword.exe for .doc files.</span></span>
-   <span data-ttu-id="d1ce8-125">Un administrador instala Office de 64 bits, que registra Winword.exe de 64 bits para administrar los archivos. doc en la vista del registro de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-125">An administrator installs 64-bit Office, which registers 64-bit Winword.exe to handle .doc files in the 64-bit registry view.</span></span> <span data-ttu-id="d1ce8-126">El reflector del registro copia esta información en el registro de 32 bits, por lo que las aplicaciones de 32 bits y de 64 bits inician la versión de 64 bits de Winword.exe para los archivos. doc.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-126">The registry reflector copies this information into the 32-bit registry, so both 32-bit and 64-bit applications launch the 64-bit version of Winword.exe for .doc files.</span></span>

<span data-ttu-id="d1ce8-127">Por lo tanto, se conserva la información de Asociación de archivos para la aplicación instalada más recientemente.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-127">Therefore, the file association information is preserved for the most recently installed application.</span></span>

<span data-ttu-id="d1ce8-128">Puede ser útil para que las aplicaciones de 32 bits y 64 bits compartan valores de clave del registro específicos que normalmente se escriben en vistas del registro independientes.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-128">It can be useful for 32-bit and 64-bit applications to share specific registry key values that are normally written to separate registry views.</span></span> <span data-ttu-id="d1ce8-129">Por ejemplo, un servidor OLE de 32 bits que puede atender solicitudes de clientes de 32 bits y de 64 bits podría hacer que los datos del registro de 32 bits estén disponibles para la vista de 64 bits del registro del sistema.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-129">For example, a 32-bit OLE server that can serve requests from both 32-bit and 64-bit clients could make its 32-bit registry data available to the 64-bit view of the system registry.</span></span>

<span data-ttu-id="d1ce8-130">Cuando un componente escribe datos en el registro del sistema, WOW64 analiza la información y realiza una copia de los datos en la vista alternativa del registro cuando sea necesario.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-130">When a component writes data in the system registry, WOW64 analyzes the information and makes a copy of the data in the alternate view of the registry when appropriate.</span></span> <span data-ttu-id="d1ce8-131">Normalmente, este proceso mantiene dos copias físicas independientes de las mismas claves del registro en ambas vistas del registro y se denomina reflexión de registro o reflejo de registro.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-131">Typically, this process keeps two separate physical copies of the same registry keys in both views in the registry, and is called registry reflection or registry mirroring.</span></span>

<span data-ttu-id="d1ce8-132">La mayoría de las claves de la raíz de las clases están en esta categoría.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-132">Most of the keys under the classes root are in this category.</span></span> <span data-ttu-id="d1ce8-133">Las actualizaciones de las claves se reflejan cuando se completa la actualización y se cierra el identificador de la clave.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-133">Updates to the keys are reflected when the update completes and the handle to the key closes.</span></span> <span data-ttu-id="d1ce8-134">En casos concretos, las operaciones de escritura en una clave no se reflejan si la clave tiene una dependencia de varios bits.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-134">In specific cases, writes to a key are not reflected if the key has some bitness dependency.</span></span> <span data-ttu-id="d1ce8-135">Por ejemplo, la clave InprocServer32 de 32 bits no es relevante para las aplicaciones de 64 bits, por lo que la clave InprocServer32 no se refleja en la vista del registro de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-135">For example, the 32-bit InprocServer32 key is not relevant for 64-bit applications, so the InprocServer32 key is not reflected to the 64-bit registry view.</span></span> <span data-ttu-id="d1ce8-136">Sin embargo, las aplicaciones de 64 bits pueden usar la clave LocalServer32 de 32 bits y la clave LocalServer32 se refleja.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-136">However, 64-bit applications can use the 32-bit LocalServer32 key and the LocalServer32 key gets reflected.</span></span>

<span data-ttu-id="d1ce8-137">En el caso de **\_ \_ \\ \\ las clases \\ de software de máquina local de HKEY CLSID** y **HKEY clases de software de \_ \_ usuario actuales \\ \\ \\ CLSID**, solo se reflejan los CLSID que no especifican InProcServer32 o InprocHandler32.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-137">For **HKEY\_LOCAL\_MACHINE\\Software\\Classes\\CLSID** and **HKEY\_CURRENT\_USER\\Software\\Classes\\CLSID**, only CLSIDs that do not specify InprocServer32 or InprocHandler32 are reflected.</span></span> <span data-ttu-id="d1ce8-138">Solo se reflejan los CLSID de LocalServer32 porque se ejecutan fuera de proceso y se pueden activar mediante aplicaciones de 32 o 64 bits.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-138">Only LocalServer32 CLSIDs are reflected because they run out-of-process and can be activated by either 32- or 64-bit applications.</span></span> <span data-ttu-id="d1ce8-139">Los CLSID de InProcServer32 no se reflejan porque no es posible cargar un archivo DLL de 32 bits para su ejecución en un proceso de 64 bits o un archivo DLL de 64 bits para su ejecución en un proceso de 32 bits.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-139">InProcServer32 CLSIDs are not reflected because it is not possible to load a 32-bit DLL for execution in a 64-bit process, or a 64-bit DLL for execution in a 32-bit process.</span></span>

<span data-ttu-id="d1ce8-140">En el caso de **\_ \_ \\ \\ las clases \\ de software de máquina local de HKEY AppID** y **HKEY clases de software de \_ \_ usuario actuales \\ \\ \\ AppID**, los valores del registro [DllSurrogate](../com/dllsurrogate.md) y [DllSurrogateExecutable]( ../com/dllsurrogateexecutable.md) no se reflejan si su valor es una cadena vacía.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-140">For **HKEY\_LOCAL\_MACHINE\\Software\\Classes\\Appid** and **HKEY\_CURRENT\_USER\\Software\\Classes\\Appid**, the [DllSurrogate](../com/dllsurrogate.md) and [DllSurrogateExecutable]( ../com/dllsurrogateexecutable.md) registry values are not reflected if their value is an empty string.</span></span>

<span data-ttu-id="d1ce8-141">Para deshabilitar y habilitar la reflexión del registro para una clave reflejada determinada, use las funciones [**RegDisableReflectionKey**](/windows/desktop/api/winreg/nf-winreg-regdisablereflectionkey) y [**RegEnableReflectionKey**](/windows/desktop/api/winreg/nf-winreg-regenablereflectionkey) .</span><span class="sxs-lookup"><span data-stu-id="d1ce8-141">To disable and enable registry reflection for a particular reflected key, use the [**RegDisableReflectionKey**](/windows/desktop/api/winreg/nf-winreg-regdisablereflectionkey) and [**RegEnableReflectionKey**](/windows/desktop/api/winreg/nf-winreg-regenablereflectionkey) functions.</span></span> <span data-ttu-id="d1ce8-142">Estas funciones no afectan a las claves que no están en la lista de claves reflejadas anteriormente en este tema.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-142">These functions do not affect keys that are not on the list of reflected keys earlier in this topic.</span></span> <span data-ttu-id="d1ce8-143">Las aplicaciones solo deben deshabilitar la reflexión para las claves del registro que crean y no intentan deshabilitar la reflexión para las claves predefinidas como **HKEY \_ local \_ Machine** o **HKEY \_ Current \_ User**.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-143">Applications should disable reflection only for the registry keys that they create and not attempt to disable reflection for the predefined keys such as **HKEY\_LOCAL\_MACHINE** or **HKEY\_CURRENT\_USER**.</span></span> <span data-ttu-id="d1ce8-144">Para determinar si se han deshabilitado las claves de la lista de reflexión, utilice la función [**RegQueryReflectionKey**](/windows/desktop/api/winreg/nf-winreg-regqueryreflectionkey) .</span><span class="sxs-lookup"><span data-stu-id="d1ce8-144">To determine whether the keys on the reflection list have been disabled, use the [**RegQueryReflectionKey**](/windows/desktop/api/winreg/nf-winreg-regqueryreflectionkey) function.</span></span>

<span data-ttu-id="d1ce8-145">Las claves reflejadas no deben usarse en operaciones del registro transaccionales.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-145">Reflected keys should not be used in transacted registry operations.</span></span> <span data-ttu-id="d1ce8-146">La escritura en claves reflejadas durante una transacción puede provocar un error en la transacción.</span><span class="sxs-lookup"><span data-stu-id="d1ce8-146">Writing to reflected keys during a transaction can cause the transaction to fail.</span></span> <span data-ttu-id="d1ce8-147">Para obtener más información acerca de las transacciones, consulte [Administrador de transacciones de kernel](/windows/desktop/Ktm/kernel-transaction-manager-portal).</span><span class="sxs-lookup"><span data-stu-id="d1ce8-147">For more information about transactions, see [Kernel Transaction Manager](/windows/desktop/Ktm/kernel-transaction-manager-portal).</span></span>

## <a name="related-topics"></a><span data-ttu-id="d1ce8-148">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="d1ce8-148">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d1ce8-149">Redirector del registro</span><span class="sxs-lookup"><span data-stu-id="d1ce8-149">Registry Redirector</span></span>](registry-redirector.md)
</dt> <dt>

[<span data-ttu-id="d1ce8-150">Reflexión del registro en Windows</span><span class="sxs-lookup"><span data-stu-id="d1ce8-150">Registry Reflection in Windows</span></span>](/windows-hardware/drivers/display/microsoft-windows-vista-display-driver-64-bit-issues)
</dt> <dt>

[<span data-ttu-id="d1ce8-151">Claves del Registro afectadas por WOW64</span><span class="sxs-lookup"><span data-stu-id="d1ce8-151">Registry Keys Affected by WOW64</span></span>](shared-registry-keys.md)
</dt> </dl>

 

 