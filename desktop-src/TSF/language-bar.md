---
title: Barra de idioma (servicios de texto)
description: Barra de idioma
ms.assetid: 82b92567-fdc1-488c-b395-4cb95257955c
keywords:
- Marco de trabajo de servicios de texto (TSF), barra de idioma
- TSF (marco de trabajo de servicios de texto), barra de idioma
- servicios de texto, barra de idioma
- barra de idioma
- Text Services Framework (TSF), botones
- TSF (marco de trabajo de servicios de texto), botones
- servicios de texto, botones
- Text Services Framework (TSF), menús
- TSF (marco de trabajo de servicios de texto), menús
- servicios de texto, menús
- estilos de botón
- botones de menú
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c41d64a488406f6eefcff5fef6c11093af00bc5b
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 12/10/2020
ms.locfileid: "104421860"
---
# <a name="language-bar-text-services"></a><span data-ttu-id="c4a0d-115">Barra de idioma (servicios de texto)</span><span class="sxs-lookup"><span data-stu-id="c4a0d-115">Language Bar (Text Services)</span></span>

## <a name="implementing-the-language-bar-object"></a><span data-ttu-id="c4a0d-116">Implementar el objeto de barra de idioma</span><span class="sxs-lookup"><span data-stu-id="c4a0d-116">Implementing the Language Bar Object</span></span>

<span data-ttu-id="c4a0d-117">Para permitir agregar un elemento a la barra de idioma, un servicio de texto debe implementar un objeto que admita la interfaz [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) y uno de los elementos de control [ITfLangBarItem](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritem) .</span><span class="sxs-lookup"><span data-stu-id="c4a0d-117">To support adding an item to the language bar, a text service must implement an object that supports the [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) interface and one of the [ITfLangBarItem](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritem) control elements.</span></span> <span data-ttu-id="c4a0d-118">Cuando se instala el elemento, la barra de idioma instala un receptor de [ITfLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemsink) llamando a [ITfSource:: AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) del elemento con IID \_ ITfLangBarItemSink.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-118">When the item is installed, the language bar installs an [ITfLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemsink) sink by calling the item's [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfLangBarItemSink.</span></span> <span data-ttu-id="c4a0d-119">El elemento usa la interfaz **ITfLangBarItemSink** para notificar los cambios en la barra de idioma, por ejemplo, cuando el elemento se oculta, se muestra, se habilita o se deshabilita.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-119">The item uses the **ITfLangBarItemSink** interface to notify the language bar of changes, for example when the item is hidden, shown, enabled, or disabled.</span></span>

<span data-ttu-id="c4a0d-120">Se pueden instalar cuatro tipos de elementos de barra de idioma y cada una de las interfaces necesarias se crea a partir de **ITfLangBarItem**.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-120">Four types of language bar items can be installed and each of the required interfaces is created from **ITfLangBarItem**.</span></span> <span data-ttu-id="c4a0d-121">A continuación se muestran los posibles elementos de control **ITfLangBarItem** .</span><span class="sxs-lookup"><span data-stu-id="c4a0d-121">The following are possible **ITfLangBarItem** control elements.</span></span>



|               |                                                                                                                                                                                   |
|---------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="c4a0d-122">Botón</span><span class="sxs-lookup"><span data-stu-id="c4a0d-122">Button</span></span>        | <span data-ttu-id="c4a0d-123">Un botón de barra de idioma funciona como un botón de comando, un control de alternancia o un menú en la barra de idioma.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-123">A language bar button functions as a command button, toggle control, or a menu on the language bar.</span></span> <span data-ttu-id="c4a0d-124">El objeto debe admitir la interfaz ITfLangBarItemButton.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-124">The object must support the ITfLangBarItemButton interface.</span></span>                   |
| <span data-ttu-id="c4a0d-125">LDM</span><span class="sxs-lookup"><span data-stu-id="c4a0d-125">Balloon</span></span>       | <span data-ttu-id="c4a0d-126">Un globo de barra de idioma funciona como una notificación emergente en la barra de idioma.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-126">A language bar balloon functions as a pop-up notification on the language bar.</span></span> <span data-ttu-id="c4a0d-127">El objeto debe admitir la interfaz ITfLangBarItemBalloon.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-127">The object must support the ITfLangBarItemBalloon interface.</span></span>                                       |
| <span data-ttu-id="c4a0d-128">Bitmap</span><span class="sxs-lookup"><span data-stu-id="c4a0d-128">Bitmap</span></span>        | <span data-ttu-id="c4a0d-129">Un mapa de bits de la barra de idioma funciona como un elemento estático en la barra de idioma que muestra un mapa de bits.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-129">A language bar bitmap functions as a static element on the language bar that displays a bitmap.</span></span> <span data-ttu-id="c4a0d-130">El objeto debe admitir la interfaz ITfLangBarItemBitmap.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-130">The object must support the ITfLangBarItemBitmap interface.</span></span>                       |
| <span data-ttu-id="c4a0d-131">Botón de mapa de bits</span><span class="sxs-lookup"><span data-stu-id="c4a0d-131">Bitmap Button</span></span> | <span data-ttu-id="c4a0d-132">Un botón de mapa de bits de la barra de idioma funciona como un elemento de botón en la barra de idioma que muestra texto y un mapa de bits.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-132">A language bar bitmap button functions as a button element on the language bar that displays text and a bitmap.</span></span> <span data-ttu-id="c4a0d-133">El objeto debe admitir la interfaz ITfLangBarItemBitmapButton.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-133">The object must support the ITfLangBarItemBitmapButton interface.</span></span> |



 

## <a name="button-styles"></a><span data-ttu-id="c4a0d-134">Estilos de botón</span><span class="sxs-lookup"><span data-stu-id="c4a0d-134">Button Styles</span></span>

<span data-ttu-id="c4a0d-135">Un elemento Button puede funcionar como cualquiera de los siguientes.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-135">A button element can function as any of the following.</span></span> <span data-ttu-id="c4a0d-136">La función del elemento de botón viene determinada por las marcas establecidas en el miembro **dwStyle** de la estructura [TF \_ LANGBARITEMINFO](/windows/desktop/api/ctfutb/ns-ctfutb-tf_langbariteminfo) en el método [ITfLangBarItem:: GetInfo](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritem-getinfo) .</span><span class="sxs-lookup"><span data-stu-id="c4a0d-136">The function of the button item is determined by the flags set in the **dwStyle** member of the [TF\_LANGBARITEMINFO](/windows/desktop/api/ctfutb/ns-ctfutb-tf_langbariteminfo) structure in the [ITfLangBarItem::GetInfo](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritem-getinfo) method.</span></span>



|               |                                                                                                                                                                                                                                                                                                                                                                                      |
|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="c4a0d-137">Botón</span><span class="sxs-lookup"><span data-stu-id="c4a0d-137">Button</span></span>        | <span data-ttu-id="c4a0d-138">El botón funciona como un botón de comando estándar.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-138">The button functions as a standard command button.</span></span> <span data-ttu-id="c4a0d-139">Este estilo de botón se identifica mediante el estilo de botón del botón de la función de TF \_ LBI \_ \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="c4a0d-139">This button style is identified by the TF\_LBI\_STYLE\_BTN\_BUTTON style.</span></span> <span data-ttu-id="c4a0d-140">Se llama a ITfLangBarItemButton:: OnClick cuando se hace clic en el elemento.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-140">ITfLangBarItemButton::OnClick is called when the item is clicked.</span></span> <span data-ttu-id="c4a0d-141">No se usan ITfLangBarItemButton:: InitMenu y ITfLangBarItemButton:: OnMenuSelect.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-141">ITfLangBarItemButton::InitMenu and ITfLangBarItemButton::OnMenuSelect are not used.</span></span>                                                                                                   |
| <span data-ttu-id="c4a0d-142">Botón de alternancia</span><span class="sxs-lookup"><span data-stu-id="c4a0d-142">Toggle Button</span></span> | <span data-ttu-id="c4a0d-143">El botón funciona como un control de alternancia que puede mantener un estado de clic, similar a una casilla.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-143">The button functions as a toggle control that can maintain a clicked state, similar to a check box.</span></span> <span data-ttu-id="c4a0d-144">Este estilo de botón se identifica mediante el estilo de alternancia de tipo de comando TF \_ LBI \_ \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="c4a0d-144">This button style is identified by the TF\_LBI\_STYLE\_BTN\_TOGGLE style.</span></span> <span data-ttu-id="c4a0d-145">Se llama a ITfLangBarItemButton:: OnClick cuando se hace clic en el elemento.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-145">ITfLangBarItemButton::OnClick is called when the item is clicked.</span></span> <span data-ttu-id="c4a0d-146">No se usan ITfLangBarItemButton:: InitMenu y ITfLangBarItemButton:: OnMenuSelect.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-146">ITfLangBarItemButton::InitMenu and ITfLangBarItemButton::OnMenuSelect are not used.</span></span>                                                  |
| <span data-ttu-id="c4a0d-147">Menú</span><span class="sxs-lookup"><span data-stu-id="c4a0d-147">Menu</span></span>          | <span data-ttu-id="c4a0d-148">El botón funciona como un menú desplegable.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-148">The button functions as a drop-down menu.</span></span> <span data-ttu-id="c4a0d-149">Este estilo de botón se identifica mediante el \_ estilo de menú de TF LBI \_ style \_ BTN \_ .</span><span class="sxs-lookup"><span data-stu-id="c4a0d-149">This button style is identified by the TF\_LBI\_STYLE\_BTN\_MENU style.</span></span> <span data-ttu-id="c4a0d-150">Se llama a ITfLangBarItemButton:: InitMenu cuando se hace clic en el botón.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-150">ITfLangBarItemButton::InitMenu is called when the button is clicked.</span></span> <span data-ttu-id="c4a0d-151">Cuando el usuario selecciona un elemento en el menú, la barra de idioma llama a ITfLangBarItemButton:: OnMenuSelect con el identificador del elemento de menú seleccionado.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-151">When the user selects an item in the menu, the language bar calls ITfLangBarItemButton::OnMenuSelect with the identifier of the selected menu item.</span></span> <span data-ttu-id="c4a0d-152">ITfLangBarItemButton:: unclick no se utiliza.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-152">ITfLangBarItemButton::OnClickis not used.</span></span> |



 

## <a name="implementing-a-menu-button"></a><span data-ttu-id="c4a0d-153">Implementar un botón de menú</span><span class="sxs-lookup"><span data-stu-id="c4a0d-153">Implementing a Menu Button</span></span>

<span data-ttu-id="c4a0d-154">Cuando el usuario hace clic en un botón de menú, la barra de idioma llama a [ITfLangBarItemButton:: InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu).</span><span class="sxs-lookup"><span data-stu-id="c4a0d-154">When the user clicks a menu button, the language bar calls [ITfLangBarItemButton::InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu).</span></span> <span data-ttu-id="c4a0d-155">El elemento agrega elementos al menú mediante la interfaz [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) pasada a InitMenu.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-155">The item adds items to the menu using the [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) interface passed to InitMenu.</span></span>

<span data-ttu-id="c4a0d-156">Para agregar un submenú al menú, llame a [ITfMenu:: AddMenuItem](/windows/desktop/api/Ctfutb/nf-ctfutb-itfmenu-addmenuitem) con el \_ \_ submenú TF LBMENUF.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-156">To add a submenu to the menu, call [ITfMenu::AddMenuItem](/windows/desktop/api/Ctfutb/nf-ctfutb-itfmenu-addmenuitem) with TF\_LBMENUF\_SUBMENU.</span></span> <span data-ttu-id="c4a0d-157">Cuando esto se hace, se devuelve un nuevo objeto **ITfMenu** que representa el submenú en el parámetro *ppMenu* de AddMenuItem.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-157">When this is done, a new **ITfMenu** object that represents the submenu is returned in the *ppMenu* parameter of AddMenuItem.</span></span> <span data-ttu-id="c4a0d-158">Este nuevo objeto de menú se usa para agregar elementos al submenú.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-158">This new menu object is used to add items to the submenu.</span></span>

<span data-ttu-id="c4a0d-159">Cuando el usuario selecciona un elemento en el menú, la barra de idioma llama a [ITfLangBarItemButton:: OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) con el identificador del elemento de menú seleccionado.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-159">When the user selects an item in the menu, the language bar calls [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) with the identifier of the selected menu item.</span></span>

## <a name="adding-items-to-the-language-bar"></a><span data-ttu-id="c4a0d-160">Agregar elementos a la barra de idioma</span><span class="sxs-lookup"><span data-stu-id="c4a0d-160">Adding Items to the Language Bar</span></span>

<span data-ttu-id="c4a0d-161">Un servicio de texto debe agregar sus elementos a la barra de idioma cuando se llama a su método [ITfTextInputProcessor:: Activate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-activate) y quitarlos cuando se llama a [ITfTextInputProcessor::D eactivate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-deactivate) .</span><span class="sxs-lookup"><span data-stu-id="c4a0d-161">A text service should add its items to the language bar when its [ITfTextInputProcessor::Activate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-activate) method is called and remove them when its [ITfTextInputProcessor::Deactivate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-deactivate) is called.</span></span>

<span data-ttu-id="c4a0d-162">Para agregar un elemento a la barra de idioma, el servicio de texto obtiene una interfaz [ITfLangBarItemMgr](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemmgr) llamando a ITfThreadMgr:: QUERYINTERFACE con IID \_ ITfLangBarItemMgr.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-162">To add an item to the language bar, the text service obtains an [ITfLangBarItemMgr](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemmgr) interface by calling ITfThreadMgr::QueryInterface with IID\_ITfLangBarItemMgr.</span></span> <span data-ttu-id="c4a0d-163">Después, el servicio de texto llama a [ITfLangBarItemMgr:: AddItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-additem) con el puntero al objeto de elemento de barra de idioma.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-163">The text service then calls [ITfLangBarItemMgr::AddItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-additem) with the pointer to the language bar item object.</span></span>

<span data-ttu-id="c4a0d-164">El servicio de texto debe quitar el elemento cuando se desactiva.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-164">The text service must remove the item when deactivated.</span></span> <span data-ttu-id="c4a0d-165">El servicio de texto usa la misma interfaz **ITfLangBarItemMgr** que se usa para agregar los elementos u obtener otra instancia de la interfaz.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-165">The text service either uses the same **ITfLangBarItemMgr** interface used to add the items or obtains another instance of the interface.</span></span> <span data-ttu-id="c4a0d-166">Después, el servicio de texto llama a [ITfLangBarItemMgr:: RemoveItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-removeitem) con el puntero de interfaz del elemento que se va a quitar.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-166">The text service then calls [ITfLangBarItemMgr::RemoveItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-removeitem) with the interface pointer of the item to remove.</span></span>

## <a name="extending-system-language-bar-items"></a><span data-ttu-id="c4a0d-167">Extender elementos de la barra de idioma del sistema</span><span class="sxs-lookup"><span data-stu-id="c4a0d-167">Extending System Language Bar Items</span></span>

<span data-ttu-id="c4a0d-168">TSF proporciona la capacidad de agregar elementos de menú a los menús de barra de idioma existentes.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-168">TSF provides the ability to add menu items to existing language bar menus.</span></span> <span data-ttu-id="c4a0d-169">Esto permite a un servicio de texto agregar elementos al menú de otro servicio de texto sin tener que agregar un botón independiente a la barra de herramientas.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-169">This enables a text service to add items to the menu of another text service without having to add a separate button to the toolbar.</span></span> <span data-ttu-id="c4a0d-170">Esto también permite organizar los elementos de menú en grupos lógicos.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-170">This also enables the menu items to be organized into logical groups.</span></span> <span data-ttu-id="c4a0d-171">Por ejemplo, un servicio de texto que proporciona características adicionales al servicio de texto de voz estándar puede agregar elementos al menú servicio de texto de voz en lugar de agregar su propio botón de menú de nivel superior.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-171">For example, a text service that provides additional features to the standard speech text service can add items to the speech text service menu rather than adding its own top-level menu button.</span></span>

<span data-ttu-id="c4a0d-172">Un servicio de texto proporciona una extensión de menú de barra de idioma implementando un objeto que admite la interfaz [ITfSystemLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itfsystemlangbaritemsink) .</span><span class="sxs-lookup"><span data-stu-id="c4a0d-172">A text service provides a language bar menu extension by implementing an object that supports the [ITfSystemLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itfsystemlangbaritemsink) interface.</span></span> <span data-ttu-id="c4a0d-173">Esta interfaz funciona exactamente igual que la interfaz [ITfLangBarItemButton](/windows/desktop/api/Ctfutb/nn-ctfutb-itflangbaritembutton) para un botón de menú.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-173">This interface works exactly like the [ITfLangBarItemButton](/windows/desktop/api/Ctfutb/nn-ctfutb-itflangbaritembutton) interface for a menu button.</span></span> <span data-ttu-id="c4a0d-174">Cuando se muestra el menú, el servicio de texto que se extiende llama a [ITfSystemLangBarItemSink:: InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu).</span><span class="sxs-lookup"><span data-stu-id="c4a0d-174">When the menu is displayed, the text service being extended calls [ITfSystemLangBarItemSink::InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu).</span></span> <span data-ttu-id="c4a0d-175">La extensión agrega elementos al menú mediante la interfaz [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) pasada a **InitMenu**.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-175">The extension adds items to the menu using the [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) interface passed to **InitMenu**.</span></span> <span data-ttu-id="c4a0d-176">Cuando el usuario selecciona un elemento agregado por la extensión, el servicio de texto que se extiende llama a [ITfSystemLangBarItemSink:: OnMenuSelect](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-onmenuselect) con el identificador del elemento de menú seleccionado.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-176">When the user selects an item added by the extension, the text service being extended calls [ITfSystemLangBarItemSink::OnMenuSelect](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-onmenuselect) with the identifier of the selected menu item.</span></span>

<span data-ttu-id="c4a0d-177">Para instalar una extensión de menú de la barra de idioma, el servicio de texto completa los pasos siguientes.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-177">To install a language bar menu extension, the text service completes the following steps.</span></span>

1.  <span data-ttu-id="c4a0d-178">Obtenga la interfaz **ITfLangBarItem** para el elemento que se va a extender llamando a [ITfLangBarItemMgr:: GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem) con el **GUID** para el elemento que se va a extender.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-178">Obtain the **ITfLangBarItem** interface for the item to extend by calling [ITfLangBarItemMgr::GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem) with the **GUID** for the item to be extended.</span></span>
2.  <span data-ttu-id="c4a0d-179">Obtenga la interfaz **ITfSource** para el elemento que se va a extender llamando a ITfLangBarItem:: QUERYINTERFACE con IID \_ ITfSource.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-179">Obtain the **ITfSource** interface for the item to extend by calling ITfLangBarItem::QueryInterface with IID\_ITfSource.</span></span>
3.  <span data-ttu-id="c4a0d-180">Llame a [ITfSource:: AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) con IID \_ ITfSystemLangBarItemSink y el puntero al objeto **ITfSystemLangBarItemSink** .</span><span class="sxs-lookup"><span data-stu-id="c4a0d-180">Call [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfSystemLangBarItemSink and the pointer to the **ITfSystemLangBarItemSink** object.</span></span> <span data-ttu-id="c4a0d-181">Si ITfSource:: AdviseSink produce un error, el servicio de texto no admite extensiones de menú.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-181">If ITfSource::AdviseSink fails, the text service does not support menu extensions.</span></span>

<span data-ttu-id="c4a0d-182">[ITfSource:: UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink)**ITfSource:: AdviseSink**</span><span class="sxs-lookup"><span data-stu-id="c4a0d-182">[ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink)**ITfSource::AdviseSink**</span></span>

## <a name="supporting-language-bar-menu-extensions"></a><span data-ttu-id="c4a0d-183">Extensiones de menú de la barra de idioma compatible</span><span class="sxs-lookup"><span data-stu-id="c4a0d-183">Supporting Language Bar Menu Extensions</span></span>

<span data-ttu-id="c4a0d-184">Un servicio de texto puede permitir que otros servicios de texto agreguen elementos a sus menús de barra de idioma, tal como se mostró anteriormente.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-184">A text service can enable other text services to add items to its language bar menus as shown above.</span></span> <span data-ttu-id="c4a0d-185">Servicio de texto que debe publicar su GUID para que el elemento se pueda obtener llamando a [ITfLangBarItemMgr:: GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem).</span><span class="sxs-lookup"><span data-stu-id="c4a0d-185">The text service that must publish its GUID so that the item can be obtained by calling [ITfLangBarItemMgr::GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem).</span></span>

<span data-ttu-id="c4a0d-186">Para admitir las extensiones de menú, el servicio de texto debe admitir la interfaz [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) .</span><span class="sxs-lookup"><span data-stu-id="c4a0d-186">To support menu extensions, the text service must support the [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) interface.</span></span> <span data-ttu-id="c4a0d-187">Los pasos siguientes habilitan la compatibilidad con una o más extensiones de menú.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-187">The following steps enable support for one or more menu extensions.</span></span>

1.  <span data-ttu-id="c4a0d-188">Cuando se llama a [ITfSource:: AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) con IID \_ ITfSystemLangBarItemSink, el servicio de texto debe almacenar la interfaz **ITfSystemLangBarItemSink** y devolver un valor de cookie que identificará la extensión.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-188">When [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfSystemLangBarItemSink is called, the text service must store the **ITfSystemLangBarItemSink** interface and return a cookie value that will identify the extension.</span></span>
2.  <span data-ttu-id="c4a0d-189">Cuando se llama a [ITfLangBarItemButton:: InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu) , el servicio de texto llama al método [ITfSystemLangBarItemSink:: InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu) de la extensión.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-189">When [ITfLangBarItemButton::InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu) is called, the text service calls the extension's [ITfSystemLangBarItemSink::InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu) method.</span></span> <span data-ttu-id="c4a0d-190">El servicio de texto debe implementar una manera de identificar los elementos de menú agregados por la extensión en lugar de los elementos agregados por el propio servicio de texto.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-190">The text service must implement a way to identify the menu items added by the extension as opposed to the items added by the text service itself.</span></span>
3.  <span data-ttu-id="c4a0d-191">Cuando se llama a [ITfLangBarItemButton:: OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) con un identificador de elemento de menú que pertenece a una extensión, el servicio de texto llama al método **ITfSystemLangBarItemSink:: OnMenuSelect** de las extensiones.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-191">When [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) is called with a menu item identifier that belongs to an extension, the text service calls the extensions's **ITfSystemLangBarItemSink::OnMenuSelect** method.</span></span>
4.  <span data-ttu-id="c4a0d-192">Cuando se llama a [ITfSource:: UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink) con la cookie adecuada, el servicio de texto quita la extensión de menú.</span><span class="sxs-lookup"><span data-stu-id="c4a0d-192">When [ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink) is called with the appropriate cookie, the text service removes the menu extension.</span></span>

## <a name="related-topics"></a><span data-ttu-id="c4a0d-193">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="c4a0d-193">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c4a0d-194">Cómo configurar el marco de trabajo de servicios de texto</span><span class="sxs-lookup"><span data-stu-id="c4a0d-194">How To Set Up Text Services Framework</span></span>](how-to-set-up-tsf.md)
</dt> <dt>

[<span data-ttu-id="c4a0d-195">Barra de idioma (aplicaciones)</span><span class="sxs-lookup"><span data-stu-id="c4a0d-195">Language Bar (Applications)</span></span>](language-bar-app.md)
</dt> </dl>

 

 
