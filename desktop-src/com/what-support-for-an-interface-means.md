---
title: Compatibilidad con una interfaz
description: Compatibilidad con una interfaz
ms.assetid: fa5eae0f-2252-43bc-b504-de00b213cb2a
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1e169ca193a24e1f532d054bf21d5262edef3036
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/21/2020
ms.locfileid: "104533531"
---
# <a name="what-support-for-an-interface-means"></a>Compatibilidad con una interfaz

Además de la interfaz [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) , un control ActiveX o un objeto com para esa cuestión expresa cualquier funcionalidad opcional que admita a través de interfaces adicionales. Esto es para indicar que no se requieren otras interfaces por encima de **IUnknown**. Para ello, en la tabla siguiente se enumeran las interfaces que puede admitir un control ActiveX y lo que significa que admiten esa interfaz.



| Interfaz                                                                                                                                                                                                                                                                                                                                                                       | Comentarios/Qué significa admitir la interfaz                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject)<br/>                                                                                                                                                                                                                                                                                                                                     | Si el control requiere comunicación con su sitio cliente para cualquier elemento que no sea eventos (vea [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer)), [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) es una necesidad. Al implementar esta interfaz, el control también debe admitir la semántica de los siguientes métodos: [**SetHostNames**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-sethostnames), [**Close**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-close), [**EnumVerbs**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-enumverbs), [**Update**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-update), [**IsUpToDate**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-isuptodate), [**GetUserClassID**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getuserclassid), [**GetUserType**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getusertype), [**GetMiscStatus**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getmiscstatus)y los métodos [**Advise**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-advise), [**unaconseje**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-unadvise)y [**EnumAdvise**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-enumadvise) que funcionan en conjunción con la implementación de [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) de un contenedor. Un control que implementa **IOleObject** debe ser capaz de controlar **IAdviseSink** si el contenedor proporciona uno; un contenedor no puede, en cuyo caso un control garantiza, por supuesto, que no intenta llamar a un receptor no existente.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**IOleInPlaceObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject)<br/>                                                                                                                                                                                                                                                                                                                       | Expresa la capacidad del control de estar activada en contexto y posiblemente activada la interfaz de usuario. Esta interfaz significa que el control tiene una interfaz de usuario de algún tipo que se puede activar, y también se admite [**IOleInPlaceActiveObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceactiveobject) . Los métodos obligatorios son [**GetWindow**](/windows/desktop/api/OleIdl/nf-oleidl-iolewindow-getwindow), [**InPlaceDeactivate**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-inplacedeactivate), [**UIDeactivate**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-uideactivate), [**SetObjectRects**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-setobjectrects)y [**ReactivateAndUndo**](/windows/desktop/api/OleIdl/nf-oleidl-ioleinplaceobject-reactivateandundo). La compatibilidad con esta interfaz requiere la compatibilidad con [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**IOleInPlaceActiveObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceactiveobject)<br/>                                                                                                                                                                                                                                                                                                           | Un objeto compatible en contexto que admita [**IOleInPlaceObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject) también debe proporcionar también esta interfaz, aunque el propio control no implementa necesariamente directamente la interfaz.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| [**IOleControl**](/windows/desktop/api/OCIdl/nn-ocidl-iolecontrol)<br/>                                                                                                                                                                                                                                                                                                                                   | Expresa la capacidad del control y desea tratar con (a) teclas de método ([**GetControlInfo**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-getcontrolinfo), métodos de carácter de la [**tecla**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-onmnemonic) ), (b) propiedades de ambiente ([**OnAmbientPropertyChange**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-onambientpropertychange)) y/o (c) eventos que el control requiere que el contenedor administre ([**FreezeEvents**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-freezeevents)). Tenga en cuenta que las teclas de acceso son diferentes de los aceleradores que se administran a través de [**IOleInPlaceActiveObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceactiveobject): los mnemónicos tienen asociada la interfaz de usuario y están activos incluso cuando el control no está activo en la interfaz de usuario. La compatibilidad de un control con las teclas de método indica que el control también sabe cómo usar el método [**IOleControlSite:: OnControlInfoChanged**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-oncontrolinfochanged) del contenedor. Como esto requiere que el control conozca el sitio del contenedor, la compatibilidad con las teclas de método también significa compatibilidad con [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject). Además, el conocimiento de mnemónicos requiere compatibilidad en contexto y, por tanto, [**IOleInPlaceObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject).<br/> Si un control usa cualquier propiedad de ambiente de contenedor, también debe implementar esta interfaz para recibir notificaciones de cambios, según se requiera la semántica de los cambios. Dado que las propiedades de ambiente solo están disponibles a través del **IDispatch** del sitio de contenedor, la compatibilidad con la propiedad de ambiente significa que el control admite [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) (para obtener el sitio) y que puede generar llamadas **IDispatch:: Invoke** .<br/> El método [**FreezeEvents**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-freezeevents) es necesario para los controles que deben saber cuándo un contenedor no va a controlar un evento. esta es la única manera de que el control conozca esta condición. Si **FreezeEvents** solo es necesario de forma aislada, de modo que no se implementen otros métodos de [**IOleControl**](/windows/desktop/api/OCIdl/nn-ocidl-iolecontrol) , **IOleControl** puede ser independiente sin [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) ni [**IOleInPlaceObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject).<br/> |
| [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                                                                                                                                                                                                                                                                                   | Indica que el control puede proporcionar por lo menos (a) representaciones gráficas del control (CF \_ METAFILEPICT es el mínimo si el control tiene objetos visuales en absoluto) y/o (b) conjuntos de propiedades, si el control tiene propiedades que proporcionar. Se requieren los métodos [**GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata), [**QueryGetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-querygetdata), [**del EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc), [**DAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dadvise), [**DUnadvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dunadvise)y [**EnumDAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise) . La compatibilidad con formatos gráficos distintos de CF \_ METAFILEPICT es opcional.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)<br/>                                                                                                                                                                                                                                                                                                                                 | Indica que el control tiene algunos objetos visuales interesantes cuando no está activo en contexto. Si se implementa, un control debe admitir los métodos [**Draw**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject-draw), [**GetAdvise**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject-getadvise), [**SetAdvise**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject-setadvise)y [**GetExtent**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject2-getextent).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **IDispatch**<br/>                                                                                                                                                                                                                                                                                                                                                        | Indica que el control tiene métodos personalizados (a) o (b) propiedades personalizadas que están disponibles a través del enlace en tiempo de ejecución a través de **IDispatch:: Invoke**. Esto también requiere que el control proporcione información de tipo a través de otros métodos **IDispatch** . Un control puede admitir varias implementaciones de **IDispatch** en las que solo hay una asociada a IID \_ IDispatch. los demás deben tener sus propios identificadores dispinterface únicos.<br/> Se recomienda que el control proporcione interfaces duales para el método personalizado y el acceso a las propiedades, pero esto es opcional si existen métodos y propiedades.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer)<br/>                                                                                                                                                                                                                                                                                                       | Indica que un control admite al menos una interfaz de salida, como eventos o notificaciones de cambio de propiedad. Se deben implementar todos los métodos de esta interfaz si esta interfaz está disponible, incluido [**EnumConnectionPoints**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints) , que requiere un objeto independiente con [**IEnumConnectionPoints**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnectionpoints).<br/> La compatibilidad con [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) significa que el objeto también admite uno o más objetos relacionados con [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) que están disponibles a través de métodos **IConnectionPointContainer** . Cada objeto de punto de conexión debe implementar la interfaz **IConnectionPoint** completa, incluido [**EnumConnections**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-enumconnections), que requiere otro objeto de enumerador con la interfaz [**IEnumConnections**](/windows/desktop/api/ocidl/nn-ocidl-ienumconnections) .<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [**IProvideClassInfo**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo)<br/> [**IProvideClassInfo2**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo2)<br/>                                                                                                                                                                                                                                                           | Indica que el objeto puede proporcionar su propia información de tipo de coclase directamente mediante [**IProvideClassInfo:: GetClassInfo**](/windows/desktop/api/OCIdl/nf-ocidl-iprovideclassinfo-getclassinfo). Si el control admite el [**IProvideClassInfo2**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo2)de variación posterior, también indica su capacidad para proporcionar su IID de origen principal a través de [**IProvideClassInfo2:: GetGUID**](/windows/desktop/api/OCIdl/nf-ocidl-iprovideclassinfo2-getguid). Se deben implementar todos los métodos de esta interfaz.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**ISpecifyPropertyPages**](/windows/desktop/api/OCIdl/nn-ocidl-ispecifypropertypages)<br/>                                                                                                                                                                                                                                                                                                               | Indica que el control tiene páginas de propiedades que pueden mostrar que un contenedor puede coordinar las páginas de propiedades de este control con otras páginas del control cuando se van a mostrar páginas de propiedades para una selección de varios controles. Se deben implementar todos los métodos de esta interfaz cuando exista compatibilidad.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [**IPerPropertyBrowsing**](/windows/desktop/api/OCIdl/nn-ocidl-iperpropertybrowsing)<br/>                                                                                                                                                                                                                                                                                                                 | Indica la capacidad del control para (a) proporcionar una cadena de presentación para una propiedad, (b) proporcionar cadenas y valores predefinidos para sus propiedades y/o (c) asignar un DISPID de propiedad a una página de propiedades específica. La compatibilidad con esta interfaz significa que se proporciona compatibilidad con las propiedades a través de IDispatch, tal como se indica anteriormente. Si se admite (c), también significa que las páginas de propiedades del objeto asignadas a través de [**IPerPropertyBrowsing:: MapPropertyToPage**](/windows/desktop/api/OCIdl/nf-ocidl-iperpropertybrowsing-mappropertytopage) implementan [**IPropertyPage2**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertypage2) en lugar de la interfaz [**IPropertyPage**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertypage) básica.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream)<br/> [**IPersistStreamInit**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit)<br/> [**IPersistMemory**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85))<br/> [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage)<br/> [**IPersistMoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85))<br/> [**IPersistPropertyBag**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768205(v=vs.85))<br/> | Consulte [interfaces de persistencia](persistence-interfaces.md).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache)<br/> [**IOleCache2**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache2)<br/>                                                                                                                                                                                                                                                                                           | Indica compatibilidad con el almacenamiento en caché de contenedores de objetos visuales de control. Normalmente, un control obtiene la propia compatibilidad con el almacenamiento en caché a través de la función OLE [**CreateDataCache**](/windows/desktop/api/ObjBase/nf-objbase-createdatacache). Solo los controles con contenido estático significativo deberían elegir hacer esto (aunque no es necesario). Si un control admite el almacenamiento en caché, simplemente debe agregar la memoria caché de datos y exponer las interfaces [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache) y [**IOleCache2**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache2) de la memoria caché de datos. Un control que implementa [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) debe ser capaz de controlar [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) si el contenedor proporciona uno; un contenedor no puede, en cuyo caso un control garantiza, por supuesto, que no intenta llamar a un receptor no existente.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [**IExternalConnection**](/windows/win32/api/objidlbase/nn-objidlbase-iexternalconnection)<br/>                                                                                                                                                                                                                                                                                                                   | Indica que el control admite vínculos externos a sí mismo; es decir, el control no está marcado con OLEMISC \_ CANTLINKINSIDE y admite [**IOleObject:: SetMoniker**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-setmoniker) y [**IOleObject:: GetMoniker**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getmoniker). Un contenedor no consultará nunca esta interfaz ni la llamará directamente a medida que se generen llamadas desde la capa de comunicación remota de OLE.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [**IRunnableObject**](/windows/desktop/api/ObjIdl/nn-objidl-irunnableobject)<br/>                                                                                                                                                                                                                                                                                                                           | Indica que el control diferencia la carga de que se está ejecutando, como hacen algunos objetos en proceso.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |



 

## <a name="related-topics"></a>Temas relacionados

<dl> <dt>

[Controles](controls.md)
</dt> </dl>

 

