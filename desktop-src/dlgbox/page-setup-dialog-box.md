---
title: Configurar página (cuadro de diálogo)
description: Muestra un cuadro de diálogo modal que permite al usuario elegir la configuración que incluye el tipo de papel, el origen del papel, la orientación de la página y el ancho de los márgenes de la página.
ms.assetid: debde0a0-07d4-46ed-a936-e517eab1852d
keywords:
- Interfaz de usuario de Windows, entrada de usuario
- Interfaz de usuario de Windows, biblioteca de cuadros de diálogo comunes
- entrada de usuario, biblioteca de cuadros de diálogo comunes
- capturar la entrada del usuario, la biblioteca de cuadros de diálogo comunes
- Biblioteca de cuadros de diálogo comunes
- cuadros de diálogo comunes
- Configurar página (cuadro de diálogo)
- cuadro de diálogo Personalizar la configuración de página
- enlaces, cuadro de diálogo Configurar página
- cuadros de diálogo predefinidos
- cuadros de diálogo, configurar página
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a4b9a8f7f30a8313017dc3a124cdccb7d00c872b
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104149603"
---
# <a name="page-setup-dialog-box"></a><span data-ttu-id="e2658-114">Configurar página (cuadro de diálogo)</span><span class="sxs-lookup"><span data-stu-id="e2658-114">Page Setup Dialog Box</span></span>

<span data-ttu-id="e2658-115">Muestra un cuadro de diálogo modal que permite al usuario establecer los atributos siguientes de la página impresa:</span><span class="sxs-lookup"><span data-stu-id="e2658-115">Displays a modal dialog box that allows the user to set the following attributes of the printed page:</span></span>

-   <span data-ttu-id="e2658-116">El tipo de papel (sobre, legal, carta, etc.)</span><span class="sxs-lookup"><span data-stu-id="e2658-116">The paper type (envelope, legal, letter, and so on)</span></span>
-   <span data-ttu-id="e2658-117">El origen del papel (alimentación manual, alimentación del tractor, alimentador de hojas, etc.)</span><span class="sxs-lookup"><span data-stu-id="e2658-117">The paper source (manual feed, tractor feed, sheet feeder, and so on)</span></span>
-   <span data-ttu-id="e2658-118">Orientación de la página (vertical u horizontal)</span><span class="sxs-lookup"><span data-stu-id="e2658-118">The page orientation (portrait or landscape)</span></span>
-   <span data-ttu-id="e2658-119">El ancho de los márgenes de página</span><span class="sxs-lookup"><span data-stu-id="e2658-119">The width of the page margins</span></span>

<span data-ttu-id="e2658-120">Para crear y mostrar un cuadro de diálogo **Configurar página** , inicialice una estructura [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) y pase la estructura a la función [**PAGESETUPDLG**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="e2658-120">You create and display a **Page Setup** dialog box by initializing a [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure and passing the structure to the [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) function.</span></span> <span data-ttu-id="e2658-121">Sin embargo, los atributos presentados en el cuadro de diálogo varían en función de las capacidades de la impresora.</span><span class="sxs-lookup"><span data-stu-id="e2658-121">However, the attributes presented in the dialog box vary, depending on the capabilities of the printer.</span></span> <span data-ttu-id="e2658-122">En la ilustración siguiente se muestra un cuadro de diálogo de **configuración de página** típico.</span><span class="sxs-lookup"><span data-stu-id="e2658-122">The following illustration shows a typical **Page Setup** dialog box.</span></span>

![cuadro de diálogo Configurar página](images/pagesetupdialogboxxp.png)

<span data-ttu-id="e2658-124">Si el usuario hace clic en el botón **Aceptar** , [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) devuelve **true** después de establecer varios miembros en la estructura [**PageSetupDlg**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) para especificar las selecciones del usuario.</span><span class="sxs-lookup"><span data-stu-id="e2658-124">If the user clicks the **OK** button, [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) returns **TRUE** after setting various members in the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure to specify the user's selections.</span></span> <span data-ttu-id="e2658-125">Los miembros **ptPaperSize** y **rtMargin** contienen los valores especificados por el usuario.</span><span class="sxs-lookup"><span data-stu-id="e2658-125">The **ptPaperSize** and **rtMargin** members contain the values specified by the user.</span></span> <span data-ttu-id="e2658-126">Los miembros **hDevMode** y **hDevNames** contienen los identificadores de memoria globales para las estructuras [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) y [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) .</span><span class="sxs-lookup"><span data-stu-id="e2658-126">The **hDevMode** and **hDevNames** members contain global memory handles for the [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) and [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structures.</span></span> <span data-ttu-id="e2658-127">Estas estructuras contienen información de página adicional, así como información acerca de la impresora.</span><span class="sxs-lookup"><span data-stu-id="e2658-127">These structures contain additional page information as well as information about the printer.</span></span> <span data-ttu-id="e2658-128">Puede usar esta información para preparar la salida que se va a enviar a la impresora seleccionada.</span><span class="sxs-lookup"><span data-stu-id="e2658-128">You can use this information to prepare the output to be sent to the selected printer.</span></span>

<span data-ttu-id="e2658-129">Si el usuario cancela el cuadro de diálogo **Configurar página** o se produce un error, [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) devuelve **false**.</span><span class="sxs-lookup"><span data-stu-id="e2658-129">If the user cancels the **Page Setup** dialog box or an error occurs, [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) returns **FALSE**.</span></span> <span data-ttu-id="e2658-130">Para determinar la causa del error, llame a la función [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) para recuperar el valor de error extendido.</span><span class="sxs-lookup"><span data-stu-id="e2658-130">To determine the cause of the error, call the [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) function to retrieve the extended error value.</span></span>

<span data-ttu-id="e2658-131">En esta sección se tratan los temas siguientes.</span><span class="sxs-lookup"><span data-stu-id="e2658-131">This section discusses the following topics.</span></span>

-   [<span data-ttu-id="e2658-132">Inicializando el cuadro de diálogo Configurar página</span><span class="sxs-lookup"><span data-stu-id="e2658-132">Initializing the Page Setup Dialog Box</span></span>](#initializing-the-page-setup-dialog-box)
-   [<span data-ttu-id="e2658-133">Personalización del cuadro de diálogo Configurar página</span><span class="sxs-lookup"><span data-stu-id="e2658-133">Customizing the Page Setup Dialog Box</span></span>](#customizing-the-page-setup-dialog-box)
-   [<span data-ttu-id="e2658-134">Personalización de la página de ejemplo</span><span class="sxs-lookup"><span data-stu-id="e2658-134">Customizing the Sample Page</span></span>](#customizing-the-sample-page)

## <a name="initializing-the-page-setup-dialog-box"></a><span data-ttu-id="e2658-135">Inicializando el cuadro de diálogo Configurar página</span><span class="sxs-lookup"><span data-stu-id="e2658-135">Initializing the Page Setup Dialog Box</span></span>

<span data-ttu-id="e2658-136">De forma predeterminada, el cuadro de diálogo **Configurar página** muestra información sobre la impresora predeterminada actual.</span><span class="sxs-lookup"><span data-stu-id="e2658-136">By default, the **Page Setup** dialog box displays information about the current default printer.</span></span> <span data-ttu-id="e2658-137">Para dirigir el cuadro de diálogo para mostrar información sobre una impresora específica, establezca los miembros de una estructura [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) o [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) y asigne los identificadores de memoria globales de estas estructuras al miembro correspondiente de [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga).</span><span class="sxs-lookup"><span data-stu-id="e2658-137">To direct the dialog box to display information about a specific printer, set the members of a [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) or [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structure and assign the global memory handles of these structures to the corresponding member in [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga).</span></span> <span data-ttu-id="e2658-138">Si especifica el nombre de una impresora que no está instalada actualmente, el cuadro de diálogo muestra un mensaje de error.</span><span class="sxs-lookup"><span data-stu-id="e2658-138">If you specify the name of a printer that is not currently installed, the dialog box displays an error message.</span></span> <span data-ttu-id="e2658-139">Para evitar que el cuadro de diálogo muestre los mensajes de error, use el valor **PSD \_ nowarning** .</span><span class="sxs-lookup"><span data-stu-id="e2658-139">To prevent the dialog box from displaying error messages, use the **PSD\_NOWARNING** value.</span></span> <span data-ttu-id="e2658-140">Para recuperar información acerca de la impresora predeterminada sin mostrar el cuadro de diálogo **Configurar página** , use el valor **PSD \_ RETURNDEFAULT** .</span><span class="sxs-lookup"><span data-stu-id="e2658-140">To retrieve information about the default printer without displaying the **Page Setup** dialog box, use the **PSD\_RETURNDEFAULT** value.</span></span>

<span data-ttu-id="e2658-141">Si el sistema de medida predeterminado es pulgadas, el cuadro de diálogo utiliza milésimas de pulgadas como unidad de medida predeterminada.</span><span class="sxs-lookup"><span data-stu-id="e2658-141">If the default measurement system is inches, the dialog box uses thousandths of inches as the default unit of measurement.</span></span> <span data-ttu-id="e2658-142">Si el sistema de medida predeterminado es métrico, el cuadro de diálogo utiliza centésimas de milímetro como unidad de medida predeterminada.</span><span class="sxs-lookup"><span data-stu-id="e2658-142">If the default measurement system is metric, the dialog box uses hundredths of millimeters as the default unit of measurement.</span></span> <span data-ttu-id="e2658-143">Para invalidar la unidad de medida predeterminada, establezca la marca **PSD \_ INHUNDREDTHSOFMILLIMETERS** o **PSD \_ INTHOUSANDTHSOFINCHES** en el miembro **Flags** de la estructura [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) .</span><span class="sxs-lookup"><span data-stu-id="e2658-143">To override the default unit of measurement, set the **PSD\_INHUNDREDTHSOFMILLIMETERS** or **PSD\_INTHOUSANDTHSOFINCHES** flag in the **Flags** member of the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure.</span></span>

<span data-ttu-id="e2658-144">De forma predeterminada, los valores iniciales de los márgenes son de una pulgada.</span><span class="sxs-lookup"><span data-stu-id="e2658-144">The initial values for the margins are one inch, by default.</span></span> <span data-ttu-id="e2658-145">Si establece la marca **de \_ márgenes PSD** , el cuadro de diálogo muestra los valores de margen iniciales especificados en el miembro **rtMargin** .</span><span class="sxs-lookup"><span data-stu-id="e2658-145">If you set the **PSD\_MARGINS** flag, the dialog box displays the initial margin values specified in the **rtMargin** member.</span></span> <span data-ttu-id="e2658-146">Los valores mínimos predeterminados que el usuario puede especificar para los márgenes son los márgenes mínimos permitidos por la impresora.</span><span class="sxs-lookup"><span data-stu-id="e2658-146">The default minimum values that the user can specify for the margins are the minimum margins allowed by the printer.</span></span> <span data-ttu-id="e2658-147">Si establece la marca **PSD \_ MINMARGINS** , el cuadro de diálogo aplica los márgenes mínimos especificados en el miembro **rtMinMargin** .</span><span class="sxs-lookup"><span data-stu-id="e2658-147">If you set the **PSD\_MINMARGINS** flag, the dialog box enforces the minimum margins specified in the **rtMinMargin** member.</span></span>

<span data-ttu-id="e2658-148">Para evitar que los usuarios seleccionen determinadas opciones, establezca cualquier combinación de las marcas siguientes para deshabilitar los controles correspondientes.</span><span class="sxs-lookup"><span data-stu-id="e2658-148">To prevent users from selecting certain options, set any combination of the following flags to disable the corresponding controls.</span></span>



| <span data-ttu-id="e2658-149">Marca</span><span class="sxs-lookup"><span data-stu-id="e2658-149">Flag</span></span>                        | <span data-ttu-id="e2658-150">Significado</span><span class="sxs-lookup"><span data-stu-id="e2658-150">Meaning</span></span>                                                                  |
|-----------------------------|--------------------------------------------------------------------------|
| <span data-ttu-id="e2658-151">**\_DISABLEMARGINS PSD**</span><span class="sxs-lookup"><span data-stu-id="e2658-151">**PSD\_DISABLEMARGINS**</span></span>     | <span data-ttu-id="e2658-152">Deshabilita los controles de edición en los que el usuario especifica la configuración de los márgenes.</span><span class="sxs-lookup"><span data-stu-id="e2658-152">Disables the edit controls in which the user enters the margin settings.</span></span> |
| <span data-ttu-id="e2658-153">**\_DISABLEORIENTATION PSD**</span><span class="sxs-lookup"><span data-stu-id="e2658-153">**PSD\_DISABLEORIENTATION**</span></span> | <span data-ttu-id="e2658-154">Deshabilita los botones de radio **vertical** y **horizontal** .</span><span class="sxs-lookup"><span data-stu-id="e2658-154">Disables the **Portrait** and **Landscape** radio buttons.</span></span>               |
| <span data-ttu-id="e2658-155">**\_DISABLEPAPER PSD**</span><span class="sxs-lookup"><span data-stu-id="e2658-155">**PSD\_DISABLEPAPER**</span></span>       | <span data-ttu-id="e2658-156">Deshabilita los controles para seleccionar el tamaño del papel y el origen del papel.</span><span class="sxs-lookup"><span data-stu-id="e2658-156">Disables the controls for selecting the paper size and paper source.</span></span>     |
| <span data-ttu-id="e2658-157">**\_DISABLEPRINTER PSD**</span><span class="sxs-lookup"><span data-stu-id="e2658-157">**PSD\_DISABLEPRINTER**</span></span>     | <span data-ttu-id="e2658-158">Deshabilita el botón **impresora** .</span><span class="sxs-lookup"><span data-stu-id="e2658-158">Disables the **Printer** button.</span></span>                                         |



 

## <a name="customizing-the-page-setup-dialog-box"></a><span data-ttu-id="e2658-159">Personalización del cuadro de diálogo Configurar página</span><span class="sxs-lookup"><span data-stu-id="e2658-159">Customizing the Page Setup Dialog Box</span></span>

<span data-ttu-id="e2658-160">Puede proporcionar una plantilla personalizada para el cuadro de diálogo **Configurar página** , por ejemplo, si desea incluir controles adicionales que sean únicos para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="e2658-160">You can provide a custom template for the **Page Setup** dialog box, for example, if you want to include additional controls that are unique to your application.</span></span> <span data-ttu-id="e2658-161">La función [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) usa la plantilla personalizada en lugar de la plantilla predeterminada.</span><span class="sxs-lookup"><span data-stu-id="e2658-161">The [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) function uses your custom template in place of the default template.</span></span>

<span data-ttu-id="e2658-162">**Para proporcionar una plantilla personalizada para el cuadro de diálogo Configurar página**</span><span class="sxs-lookup"><span data-stu-id="e2658-162">**To provide a custom template for the Page Setup dialog box**</span></span>

1.  <span data-ttu-id="e2658-163">Cree la plantilla personalizada modificando la plantilla predeterminada especificada en el archivo prnsetup. Dlg.</span><span class="sxs-lookup"><span data-stu-id="e2658-163">Create the custom template by modifying the default template specified in the Prnsetup.dlg file.</span></span> <span data-ttu-id="e2658-164">Los identificadores de control que se usan en la plantilla de cuadro de diálogo **configuración de página** predeterminada se definen en el archivo Dlgs. h.</span><span class="sxs-lookup"><span data-stu-id="e2658-164">The control identifiers used in the default **Page Setup** dialog template are defined in the Dlgs.h file.</span></span>
2.  <span data-ttu-id="e2658-165">Use la estructura [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) para habilitar la plantilla de la manera siguiente:</span><span class="sxs-lookup"><span data-stu-id="e2658-165">Use the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure to enable the template as follows:</span></span>
    -   -   <span data-ttu-id="e2658-166">Si la plantilla personalizada es un recurso de una biblioteca de vínculos dinámicos o de aplicación, establezca la marca **PSD \_ ENABLEPAGESETUPTEMPLATE** en el miembro **Flags** .</span><span class="sxs-lookup"><span data-stu-id="e2658-166">If your custom template is a resource in an application or dynamic-link library, set the **PSD\_ENABLEPAGESETUPTEMPLATE** flag in the **Flags** member.</span></span> <span data-ttu-id="e2658-167">Use los miembros **hInstance** y **lpPageSetupTemplateName** de la estructura para identificar el nombre del módulo y del recurso.</span><span class="sxs-lookup"><span data-stu-id="e2658-167">Use the **hInstance** and **lpPageSetupTemplateName** members of the structure to identify the module and resource name.</span></span>

            <span data-ttu-id="e2658-168">-O bien-</span><span class="sxs-lookup"><span data-stu-id="e2658-168">-Or-</span></span>

        -   <span data-ttu-id="e2658-169">Si la plantilla personalizada ya está en la memoria, establezca la marca **PSD \_ ENABLEPAGESETUPTEMPLATEHANDLE** .</span><span class="sxs-lookup"><span data-stu-id="e2658-169">If your custom template is already in memory, set the **PSD\_ENABLEPAGESETUPTEMPLATEHANDLE** flag.</span></span> <span data-ttu-id="e2658-170">Use el miembro **hPageSetupTemplate** para identificar el objeto de memoria que contiene la plantilla.</span><span class="sxs-lookup"><span data-stu-id="e2658-170">Use the **hPageSetupTemplate** member to identify the memory object that contains the template.</span></span>

<span data-ttu-id="e2658-171">Para filtrar los mensajes enviados al procedimiento del cuadro de diálogo, puede proporcionar un procedimiento de enlace [**PageSetupHook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) .</span><span class="sxs-lookup"><span data-stu-id="e2658-171">To filter messages sent to the dialog box procedure, you can provide a [**PageSetupHook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) hook procedure.</span></span> <span data-ttu-id="e2658-172">Si usa una plantilla personalizada para definir controles adicionales, debe proporcionar un procedimiento de enlace **PageSetupHook** para procesar la entrada para los controles.</span><span class="sxs-lookup"><span data-stu-id="e2658-172">If you use a custom template to define additional controls, you must provide a **PageSetupHook** hook procedure to process input for your controls.</span></span> <span data-ttu-id="e2658-173">Además, puede proporcionar un procedimiento de enlace [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) para personalizar el contenido de la página de ejemplo que se muestra en el cuadro de diálogo **Configurar página** .</span><span class="sxs-lookup"><span data-stu-id="e2658-173">In addition, you can provide a [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure to customize the contents of the sample page displayed by the **Page Setup** dialog box.</span></span> <span data-ttu-id="e2658-174">Para obtener más información sobre el procedimiento de enlace **PagePaintHook** , consulte [personalizar la página de ejemplo](#customizing-the-sample-page).</span><span class="sxs-lookup"><span data-stu-id="e2658-174">For more information about the **PagePaintHook** hook procedure, see [Customizing the Sample Page](#customizing-the-sample-page).</span></span>

<span data-ttu-id="e2658-175">**Para habilitar un procedimiento de enlace PageSetupHook**</span><span class="sxs-lookup"><span data-stu-id="e2658-175">**To enable a PageSetupHook hook procedure**</span></span>

1.  <span data-ttu-id="e2658-176">Establezca la marca de **\_ ENABLEPAGESETUPHOOK PSD** en el miembro **Flags** de la estructura [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) .</span><span class="sxs-lookup"><span data-stu-id="e2658-176">Set the **PSD\_ENABLEPAGESETUPHOOK** flag in the **Flags** member of the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure.</span></span>
2.  <span data-ttu-id="e2658-177">Especifique la dirección del procedimiento de enlace en el miembro **lpfnPageSetupHook** .</span><span class="sxs-lookup"><span data-stu-id="e2658-177">Specify the address of the hook procedure in the **lpfnPageSetupHook** member.</span></span>

<span data-ttu-id="e2658-178">Después de procesar el mensaje de [**\_ INITDIALOG de WM**](wm-initdialog.md) , el procedimiento de cuadro de diálogo envía un mensaje de **WM \_ INITDIALOG** al procedimiento de enlace [**PageSetupHook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) .</span><span class="sxs-lookup"><span data-stu-id="e2658-178">After processing its [**WM\_INITDIALOG**](wm-initdialog.md) message, the dialog box procedure sends a **WM\_INITDIALOG** message to the [**PageSetupHook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) hook procedure.</span></span> <span data-ttu-id="e2658-179">El parámetro *lParam* de este mensaje es un puntero a la estructura [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) que se usa para inicializar el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="e2658-179">The *lParam* parameter of this message is a pointer to the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure used to initialize the dialog box.</span></span>

## <a name="customizing-the-sample-page"></a><span data-ttu-id="e2658-180">Personalización de la página de ejemplo</span><span class="sxs-lookup"><span data-stu-id="e2658-180">Customizing the Sample Page</span></span>

<span data-ttu-id="e2658-181">El cuadro de diálogo **Configurar página** incluye una imagen de una página de ejemplo que muestra cómo afectan las selecciones del usuario a la apariencia de la salida impresa.</span><span class="sxs-lookup"><span data-stu-id="e2658-181">The **Page Setup** dialog box includes an image of a sample page that shows how the user's selections affect the appearance of the printed output.</span></span> <span data-ttu-id="e2658-182">La imagen está formada por un rectángulo que representa el papel o el tipo de sobre seleccionado, con un rectángulo de línea de puntos que representa los márgenes actuales y caracteres parciales (texto griego) para mostrar el aspecto del texto en la página impresa.</span><span class="sxs-lookup"><span data-stu-id="e2658-182">The image consists of a rectangle that represents the selected paper or envelope type, with a dotted-line rectangle representing the current margins, and partial (Greek text) characters to show how text looks on the printed page.</span></span>

<span data-ttu-id="e2658-183">Cuando llame a la función [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) , puede proporcionar un procedimiento de enlace [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) para personalizar la apariencia de la página de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="e2658-183">When you call the [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) function, you can provide a [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure to customize the appearance of the sample page.</span></span>

<span data-ttu-id="e2658-184">**Para habilitar un procedimiento de enlace PagePaintHook**</span><span class="sxs-lookup"><span data-stu-id="e2658-184">**To enable a PagePaintHook hook procedure**</span></span>

1.  <span data-ttu-id="e2658-185">Establezca la marca de **\_ ENABLEPAGEPAINTHOOK PSD** en el miembro **Flags** de la estructura [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) .</span><span class="sxs-lookup"><span data-stu-id="e2658-185">Set the **PSD\_ENABLEPAGEPAINTHOOK** flag in the **Flags** member of the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure.</span></span>
2.  <span data-ttu-id="e2658-186">Especifique la dirección del procedimiento de enlace en el miembro **lpfnPagePaintHook** .</span><span class="sxs-lookup"><span data-stu-id="e2658-186">Specify the address of the hook procedure in the **lpfnPagePaintHook** member.</span></span>

<span data-ttu-id="e2658-187">Cada vez que el cuadro de diálogo está a punto de dibujar el contenido de la página de ejemplo, el procedimiento de enlace recibe los mensajes siguientes en el orden en que aparecen.</span><span class="sxs-lookup"><span data-stu-id="e2658-187">Whenever the dialog box is about to draw the contents of the sample page, the hook procedure receives the following messages in the order in which they are listed.</span></span>



| <span data-ttu-id="e2658-188">Mensaje</span><span class="sxs-lookup"><span data-stu-id="e2658-188">Message</span></span>                                                  | <span data-ttu-id="e2658-189">Significado</span><span class="sxs-lookup"><span data-stu-id="e2658-189">Meaning</span></span>                                                                                                                                          |
|----------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="e2658-190">**\_PAGESETUPDLG de PSD de WM \_**</span><span class="sxs-lookup"><span data-stu-id="e2658-190">**WM\_PSD\_PAGESETUPDLG**</span></span>](wm-psd-pagesetupdlg.md)     | <span data-ttu-id="e2658-191">El cuadro de diálogo está a punto de dibujar la página de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="e2658-191">The dialog box is about to draw the sample page.</span></span> <span data-ttu-id="e2658-192">El procedimiento de enlace puede utilizar este mensaje para preparar la creación de contenido de la página de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="e2658-192">The hook procedure can use this message to prepare to draw the contents of the sample page.</span></span>     |
| [<span data-ttu-id="e2658-193">**\_FULLPAGERECT de PSD de WM \_**</span><span class="sxs-lookup"><span data-stu-id="e2658-193">**WM\_PSD\_FULLPAGERECT**</span></span>](wm-psd-fullpagerect.md)     | <span data-ttu-id="e2658-194">El cuadro de diálogo está a punto de dibujar la página de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="e2658-194">The dialog box is about to draw the sample page.</span></span> <span data-ttu-id="e2658-195">Este mensaje especifica el rectángulo delimitador de la página de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="e2658-195">This message specifies the bounding rectangle of the sample page.</span></span>                               |
| [<span data-ttu-id="e2658-196">**\_MINMARGINRECT de PSD de WM \_**</span><span class="sxs-lookup"><span data-stu-id="e2658-196">**WM\_PSD\_MINMARGINRECT**</span></span>](wm-psd-minmarginrect.md)   | <span data-ttu-id="e2658-197">El cuadro de diálogo está a punto de dibujar la página de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="e2658-197">The dialog box is about to draw the sample page.</span></span> <span data-ttu-id="e2658-198">Este mensaje especifica el rectángulo del margen.</span><span class="sxs-lookup"><span data-stu-id="e2658-198">This message specifies the margin rectangle.</span></span>                                                    |
| [<span data-ttu-id="e2658-199">**\_MARGINRECT de PSD de WM \_**</span><span class="sxs-lookup"><span data-stu-id="e2658-199">**WM\_PSD\_MARGINRECT**</span></span>](wm-psd-marginrect.md)         | <span data-ttu-id="e2658-200">El cuadro de diálogo está a punto de dibujar el rectángulo del margen.</span><span class="sxs-lookup"><span data-stu-id="e2658-200">The dialog box is about to draw the margin rectangle.</span></span>                                                                                            |
| [<span data-ttu-id="e2658-201">**\_GREEKTEXTRECT de PSD de WM \_**</span><span class="sxs-lookup"><span data-stu-id="e2658-201">**WM\_PSD\_GREEKTEXTRECT**</span></span>](wm-psd-greektextrect.md)   | <span data-ttu-id="e2658-202">El cuadro de diálogo está a punto de dibujar el texto griego dentro del rectángulo del margen.</span><span class="sxs-lookup"><span data-stu-id="e2658-202">The dialog box is about to draw the Greek text inside the margin rectangle.</span></span>                                                                      |
| [<span data-ttu-id="e2658-203">**\_ENVSTAMPRECT de PSD de WM \_**</span><span class="sxs-lookup"><span data-stu-id="e2658-203">**WM\_PSD\_ENVSTAMPRECT**</span></span>](wm-psd-envstamprect.md)     | <span data-ttu-id="e2658-204">El cuadro de diálogo está a punto de dibujar en el rectángulo de la marca de sobre de una página de ejemplo de sobre.</span><span class="sxs-lookup"><span data-stu-id="e2658-204">The dialog box is about to draw in the envelope-stamp rectangle of an envelope sample page.</span></span> <span data-ttu-id="e2658-205">Este mensaje se envía solo para los sobres.</span><span class="sxs-lookup"><span data-stu-id="e2658-205">This message is sent for envelopes only.</span></span>             |
| [<span data-ttu-id="e2658-206">**\_YAFULLPAGERECT de PSD de WM \_**</span><span class="sxs-lookup"><span data-stu-id="e2658-206">**WM\_PSD\_YAFULLPAGERECT**</span></span>](wm-psd-yafullpagerect.md) | <span data-ttu-id="e2658-207">El cuadro de diálogo está a punto de dibujar la parte de la dirección de retorno de una página de ejemplo de sobre.</span><span class="sxs-lookup"><span data-stu-id="e2658-207">The dialog box is about to draw the return address portion of an envelope sample page.</span></span> <span data-ttu-id="e2658-208">Este mensaje se envía para los sobres y otros tamaños de papel.</span><span class="sxs-lookup"><span data-stu-id="e2658-208">This message is sent for envelopes and other paper sizes.</span></span> |



 

<span data-ttu-id="e2658-209">Si el procedimiento de enlace devuelve **true** para cualquiera de los tres primeros mensajes de una secuencia de dibujo ([**WM \_ PSD \_ PAGESETUPDLG**](wm-psd-pagesetupdlg.md), [**WM \_ PSD \_ FULLPAGERECT**](wm-psd-fullpagerect.md)o [**WM \_ PSD \_ MINMARGINRECT**](wm-psd-minmarginrect.md)), el cuadro de diálogo no envía más mensajes y no se dibuja en la página de ejemplo hasta la próxima vez que el sistema debe volver a dibujar la página de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="e2658-209">If the hook procedure returns **TRUE** for any of the first three messages of a drawing sequence ([**WM\_PSD\_PAGESETUPDLG**](wm-psd-pagesetupdlg.md), [**WM\_PSD\_FULLPAGERECT**](wm-psd-fullpagerect.md), or [**WM\_PSD\_MINMARGINRECT**](wm-psd-minmarginrect.md)) the dialog box sends no more messages and does not draw in the sample page until the next time the system needs to redraw the sample page.</span></span> <span data-ttu-id="e2658-210">Si el procedimiento de enlace devuelve **false** para los tres mensajes, el cuadro de diálogo envía el resto de los mensajes de la secuencia de dibujo.</span><span class="sxs-lookup"><span data-stu-id="e2658-210">If the hook procedure returns **FALSE** for all three messages, the dialog box sends the remaining messages of the drawing sequence.</span></span>

<span data-ttu-id="e2658-211">Si el procedimiento de enlace devuelve **true** para cualquiera de los mensajes restantes en una secuencia de dibujo, el cuadro de diálogo no dibuja la parte correspondiente de la página de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="e2658-211">If the hook procedure returns **TRUE** for any of the remaining messages in a drawing sequence, the dialog box does not draw the corresponding portion of the sample page.</span></span> <span data-ttu-id="e2658-212">Si el procedimiento de enlace devuelve **false** para cualquiera de estos mensajes, el cuadro de diálogo dibuja esa parte de la página de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="e2658-212">If the hook procedure returns **FALSE** for any of these messages, the dialog box draws that portion of the sample page.</span></span>

<span data-ttu-id="e2658-213">Para evitar que el cuadro de diálogo dibuje el contenido de la página de ejemplo, puede establecer la marca **PSD \_ DISABLEPAGEPAINTING** .</span><span class="sxs-lookup"><span data-stu-id="e2658-213">To prevent the dialog box from drawing the contents of the sample page, you can set the **PSD\_DISABLEPAGEPAINTING** flag.</span></span> <span data-ttu-id="e2658-214">Esta marca no afecta al procedimiento de enlace [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) , que sigue recibiendo todos los **mensajes \_ PSD \_ \* de WM** y puede dibujar el contenido de la página de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="e2658-214">This flag does not affect your [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure, which still receives all the **WM\_PSD\_\*** messages and can draw the sample page contents.</span></span>

 

 