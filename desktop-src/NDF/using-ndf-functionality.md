---
title: Uso de la funcionalidad NDF
description: Microsoft proporciona acceso a la funcionalidad NDF a través de una API pública. Cuando se produce un problema, la aplicación puede usar esta API para aprovechar esta funcionalidad en el contexto de una aplicación específica.
ms.assetid: db06b9a9-a64a-43ff-9b77-95230208cfd6
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5ca74a8a80f7babca75182625ec71dc1ec47cbc7
ms.sourcegitcommit: c9c66a09eeb9e46311879a5181342e89964c1dd8
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/10/2020
ms.locfileid: "104420517"
---
# <a name="using-ndf-functionality"></a><span data-ttu-id="a70e0-104">Uso de la funcionalidad NDF</span><span class="sxs-lookup"><span data-stu-id="a70e0-104">Using NDF Functionality</span></span>

<span data-ttu-id="a70e0-105">Microsoft proporciona acceso a la funcionalidad NDF a través de una API pública.</span><span class="sxs-lookup"><span data-stu-id="a70e0-105">Microsoft provides access to NDF functionality through a public API.</span></span> <span data-ttu-id="a70e0-106">Cuando se produce un problema, la aplicación puede usar esta API para aprovechar esta funcionalidad en el contexto de una aplicación específica.</span><span class="sxs-lookup"><span data-stu-id="a70e0-106">When a problem occurs, the application can use this API to leverage this functionality within the context of a specific application.</span></span>

<span data-ttu-id="a70e0-107">Hay tres fases para realizar el diagnóstico con NDF: creación de un incidente, ejecución de diagnósticos y reparaciones y cierre del incidente.</span><span class="sxs-lookup"><span data-stu-id="a70e0-107">There are three stages of performing diagnosis with NDF: creating an incident, running diagnosis and repairs, and closing the incident.</span></span> <span data-ttu-id="a70e0-108">Esta información general indica qué funciones NDF pueden ser relevantes para un escenario específico.</span><span class="sxs-lookup"><span data-stu-id="a70e0-108">This overview indicates which NDF functions may be relevant for a specific scenario.</span></span> <span data-ttu-id="a70e0-109">Puede encontrar información detallada sobre cada función en la sección de [referencia de NDF](ndf-reference.md) .</span><span class="sxs-lookup"><span data-stu-id="a70e0-109">Detailed information on each function can be found in the [NDF Reference](ndf-reference.md) section.</span></span>

## <a name="creating-an-incident"></a><span data-ttu-id="a70e0-110">Creación de un incidente</span><span class="sxs-lookup"><span data-stu-id="a70e0-110">Creating an Incident</span></span>

<span data-ttu-id="a70e0-111">Una sesión de diagnóstico NDF requiere un incidente específico para diagnosticar.</span><span class="sxs-lookup"><span data-stu-id="a70e0-111">An NDF diagnostics session requires a specific incident to diagnose.</span></span> <span data-ttu-id="a70e0-112">Hay varias funciones que se pueden usar para crear un incidente.</span><span class="sxs-lookup"><span data-stu-id="a70e0-112">There are several functions which can be used to create an incident.</span></span> <span data-ttu-id="a70e0-113">Elija la función que mejor coincida con lo que estaba intentando realizar la aplicación cuando se produjo el error.</span><span class="sxs-lookup"><span data-stu-id="a70e0-113">Choose the function which most closely matches what the application was trying to do when the failure occurred.</span></span>

-   <span data-ttu-id="a70e0-114">[**NdfCreateConnectivityIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreateconnectivityincident): problemas generales de conectividad a Internet que no necesitan información adicional.</span><span class="sxs-lookup"><span data-stu-id="a70e0-114">[**NdfCreateConnectivityIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreateconnectivityincident): General Internet connectivity problems which do not need additional information.</span></span>
-   <span data-ttu-id="a70e0-115">[**NdfCreateWebIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatewebincident) / [**NdfCreateWebIncidentEx**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatewebincidentex): conectarse a una dirección URL http o https.</span><span class="sxs-lookup"><span data-stu-id="a70e0-115">[**NdfCreateWebIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatewebincident)/[**NdfCreateWebIncidentEx**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatewebincidentex): Connecting to an HTTP or HTTPS URL.</span></span>
-   <span data-ttu-id="a70e0-116">[**NdfCreateSharingIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatesharingincident): acceso a una ruta UNC o un recurso compartido de archivos.</span><span class="sxs-lookup"><span data-stu-id="a70e0-116">[**NdfCreateSharingIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatesharingincident): Accessing a UNC path or file share.</span></span>
-   <span data-ttu-id="a70e0-117">[**NdfCreateDNSIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatednsincident): resolución de un nombre de host DNS.</span><span class="sxs-lookup"><span data-stu-id="a70e0-117">[**NdfCreateDNSIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatednsincident): Resolving a DNS host name.</span></span>
-   <span data-ttu-id="a70e0-118">[**NdfCreatePnrpIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatepnrpincident): resolución de un nombre de mismo nivel PNRP.</span><span class="sxs-lookup"><span data-stu-id="a70e0-118">[**NdfCreatePnrpIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatepnrpincident): Resolving a PNRP peer name.</span></span>
-   <span data-ttu-id="a70e0-119">[**NdfCreateGroupingIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreategroupingincident): unirse a un grupo de punto a punto.</span><span class="sxs-lookup"><span data-stu-id="a70e0-119">[**NdfCreateGroupingIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreategroupingincident): Joining a peer-to-peer group.</span></span>
-   <span data-ttu-id="a70e0-120">[**NdfCreateWinSockIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatewinsockincident): conectarse a un destino mediante un socket (cuando no se aplica específicamente ninguna de las otras funciones).</span><span class="sxs-lookup"><span data-stu-id="a70e0-120">[**NdfCreateWinSockIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatewinsockincident): Connecting to a destination by using a socket (when none of the other functions specifically apply).</span></span>
-   <span data-ttu-id="a70e0-121">[**NdfCreateIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreateincident): se usa cuando no es apropiado ningún otro escenario y se conoce la clase auxiliar de NDF específica que se va a invocar (junto con los argumentos que requiere).</span><span class="sxs-lookup"><span data-stu-id="a70e0-121">[**NdfCreateIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreateincident): Used when no other scenario is appropriate and the specific NDF helper class to be invoked is known (along with the arguments it requires).</span></span> <span data-ttu-id="a70e0-122">Se utiliza principalmente con fines de prueba por los desarrolladores de aplicaciones que han escrito su propia clase auxiliar.</span><span class="sxs-lookup"><span data-stu-id="a70e0-122">Primarily used for testing purposes by application developers who have written their own helper class.</span></span>

## <a name="running-diagnosis-and-repairs"></a><span data-ttu-id="a70e0-123">Ejecutar diagnósticos y reparaciones</span><span class="sxs-lookup"><span data-stu-id="a70e0-123">Running Diagnosis and Repairs</span></span>

<span data-ttu-id="a70e0-124">Hay dos maneras de iniciar la funcionalidad de diagnóstico y reparación.</span><span class="sxs-lookup"><span data-stu-id="a70e0-124">There are two ways to launch the diagnosis and repair functionality.</span></span>

-   <span data-ttu-id="a70e0-125">Usar la interfaz de usuario de Windows (recomendado)</span><span class="sxs-lookup"><span data-stu-id="a70e0-125">Using the Windows User Interface (Recommended)</span></span>

    <span data-ttu-id="a70e0-126">Cuando se ejecuta en la interfaz de usuario estándar de Windows, simplemente puede llamar a la función [**NdfExecuteDiagnosis**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfexecutediagnosis) .</span><span class="sxs-lookup"><span data-stu-id="a70e0-126">When running in the standard Windows user interface, you can simply call the [**NdfExecuteDiagnosis**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfexecutediagnosis) function.</span></span> <span data-ttu-id="a70e0-127">El asistente NDF iniciará y ayudará al usuario a identificar (y, si es posible, resolver) el problema.</span><span class="sxs-lookup"><span data-stu-id="a70e0-127">The NDF Wizard will launch and assist the user in identifying (and if possible, and resolving) the problem.</span></span> <span data-ttu-id="a70e0-128">La función devolverá después de que finalice este proceso.</span><span class="sxs-lookup"><span data-stu-id="a70e0-128">The function will return after this process has finished.</span></span> <span data-ttu-id="a70e0-129">Opcionalmente, la interfaz de usuario es modal para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a70e0-129">The user interface is optionally modal to your application.</span></span>

-   <span data-ttu-id="a70e0-130">Usar una interfaz de usuario personalizada (solo Windows 7 y versiones posteriores)</span><span class="sxs-lookup"><span data-stu-id="a70e0-130">Using a Custom User Interface (Windows 7 and later only)</span></span>

    <span data-ttu-id="a70e0-131">Hay diferentes funciones disponibles para su uso en escenarios en los que no se muestra ninguna interfaz de usuario o en los que no se usa la experiencia estándar de Windows (como Media Center, aplicaciones incrustadas y el símbolo del sistema).</span><span class="sxs-lookup"><span data-stu-id="a70e0-131">Different functions are available to use in scenarios where no user interface is being shown, or where the standard Windows experience is not being used (such as Media Center, embedded applications, and the command prompt).</span></span> <span data-ttu-id="a70e0-132">Esta opción omite la funcionalidad de la experiencia del usuario que se proporciona en el asistente NDF, que incluye la limitación de los resultados a causas raíz totalmente compatibles, así como la heurística para presentar a los usuarios reparaciones en el orden recomendado.</span><span class="sxs-lookup"><span data-stu-id="a70e0-132">This option bypasses the user experience functionality provided in the NDF Wizard, which includes limiting the results to fully-supported root causes, as well as heuristics to present repairs to the user in recommended order.</span></span> <span data-ttu-id="a70e0-133">Al usar estas funciones, debe proporcionar esta funcionalidad usted mismo.</span><span class="sxs-lookup"><span data-stu-id="a70e0-133">When using these functions, you must provide any such functionality yourself.</span></span> <span data-ttu-id="a70e0-134">También debe asegurarse de liberar la memoria que usan los resultados del diagnóstico.</span><span class="sxs-lookup"><span data-stu-id="a70e0-134">You must also make sure to free memory used by the diagnosis results.</span></span>

    <span data-ttu-id="a70e0-135">Para iniciar el diagnóstico, llame a la función [**NdfDiagnoseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfdiagnoseincident) .</span><span class="sxs-lookup"><span data-stu-id="a70e0-135">To begin diagnosis, call the [**NdfDiagnoseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfdiagnoseincident) function.</span></span> <span data-ttu-id="a70e0-136">Cualquier problema encontrado se devolverá a la aplicación como una colección de estructuras [**RootCauseInfo**](/windows/win32/api/ndattrib/ns-ndattrib-rootcauseinfo) que describen las causas raíz y las posibles reparaciones identificadas.</span><span class="sxs-lookup"><span data-stu-id="a70e0-136">Any problems found will be returned to the application as a collection of [**RootCauseInfo**](/windows/win32/api/ndattrib/ns-ndattrib-rootcauseinfo) structures describing identified root causes and possible repairs.</span></span>

    <span data-ttu-id="a70e0-137">Después de seleccionar una reparación (o solicitar al usuario que seleccione una reparación), se debe llamar a [**NdfRepairIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfrepairincident) para intentar la reparación y determinar si el problema se ha resuelto.</span><span class="sxs-lookup"><span data-stu-id="a70e0-137">After selecting a repair (or asking the user to select a repair), [**NdfRepairIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfrepairincident) should be called to attempt the repair and determine whether the problem was resolved.</span></span>

    <span data-ttu-id="a70e0-138">En algunos casos, una reparación puede realizarse correctamente, pero no resolverá el problema.</span><span class="sxs-lookup"><span data-stu-id="a70e0-138">In some cases, a repair may be successfully performed but will not resolve the problem.</span></span> <span data-ttu-id="a70e0-139">En tales casos, se recomienda cerrar el incidente existente y, a continuación, abrir uno nuevo.</span><span class="sxs-lookup"><span data-stu-id="a70e0-139">In such cases, closing the existing incident and then opening a new one is recommended.</span></span> <span data-ttu-id="a70e0-140">Así se asegurará de que se identifican los nuevos problemas sin máscara de la reparación inicial.</span><span class="sxs-lookup"><span data-stu-id="a70e0-140">This will ensure that any new problems unmasked by the initial repair are identified.</span></span> <span data-ttu-id="a70e0-141">Por ejemplo, supongamos que no había ninguna red inalámbrica visible.</span><span class="sxs-lookup"><span data-stu-id="a70e0-141">For example, suppose that no wireless networks had been visible.</span></span> <span data-ttu-id="a70e0-142">Después de restablecer el adaptador, las redes inalámbricas están visibles, pero ninguna de ellas se muestra en la lista preferida.</span><span class="sxs-lookup"><span data-stu-id="a70e0-142">After resetting the adapter, wireless networks are visible, but none of them are on the preferred list.</span></span> <span data-ttu-id="a70e0-143">Se trata de un problema nuevo que requeriría un nuevo diagnóstico para identificar.</span><span class="sxs-lookup"><span data-stu-id="a70e0-143">This is a new problem that would require a new diagnosis to identify.</span></span> <span data-ttu-id="a70e0-144">Si un segundo intento de diagnóstico no identifica otros problemas, se puede intentar una reparación diferente para resolver el problema original, o bien se puede informar al usuario de que no se pudo resolver el problema.</span><span class="sxs-lookup"><span data-stu-id="a70e0-144">If such a second diagnosis attempt does not identify additional problems, a different repair can be attempted to resolve the original issue, or the user can be informed that the problem could not be resolved.</span></span>

    <span data-ttu-id="a70e0-145">[**NdfDiagnoseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfdiagnoseincident) y [**NdfRepairIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfrepairincident) son API sincrónicas.</span><span class="sxs-lookup"><span data-stu-id="a70e0-145">[**NdfDiagnoseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfdiagnoseincident) and [**NdfRepairIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfrepairincident) are synchronous APIs.</span></span> <span data-ttu-id="a70e0-146">Si desea cancelar la actividad iniciada por estas funciones, llame a [**NdfCancelIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcancelincident) desde otro subproceso.</span><span class="sxs-lookup"><span data-stu-id="a70e0-146">If you wish to cancel activity initiated by these functions, call [**NdfCancelIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcancelincident) from another thread.</span></span> <span data-ttu-id="a70e0-147">La función devolverá el siguiente punto de detención disponible en el proceso de diagnóstico o reparación.</span><span class="sxs-lookup"><span data-stu-id="a70e0-147">The function will return at the next available stopping point in the diagnosis or repair process.</span></span>

    <span data-ttu-id="a70e0-148">En cualquier momento, puede llamar a [**NdfGetTraceFile**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfgettracefile) para recuperar una copia del registro NDF de la sesión de diagnóstico actual e incluirla en los registros de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a70e0-148">At any point, you may optionally call [**NdfGetTraceFile**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfgettracefile) to retrieve a copy of the NDF log for the current diagnosis session and include it with your application logs.</span></span> <span data-ttu-id="a70e0-149">El registro se vacía una vez que se ha recuperado y las llamadas subsiguientes solo recuperarán los eventos que se produjeron después de la última llamada a esta función.</span><span class="sxs-lookup"><span data-stu-id="a70e0-149">The log is flushed once retrieved, and subsequent calls will only retrieve events which occurred after the last call to this function.</span></span>

## <a name="closing-an-incident"></a><span data-ttu-id="a70e0-150">Cerrar un incidente</span><span class="sxs-lookup"><span data-stu-id="a70e0-150">Closing an Incident</span></span>

<span data-ttu-id="a70e0-151">Cuando haya terminado de diagnosticar un incidente, llame a [**NdfCloseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcloseincident) para liberar los recursos del sistema asociados a la realización de diagnósticos en ese incidente.</span><span class="sxs-lookup"><span data-stu-id="a70e0-151">When you are finished diagnosing an incident, call [**NdfCloseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcloseincident) to free system resources associated with performing diagnostics on that incident.</span></span> <span data-ttu-id="a70e0-152">(Tenga en cuenta que esto no libera los objetos creados por [**NdfDiagnoseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfdiagnoseincident).</span><span class="sxs-lookup"><span data-stu-id="a70e0-152">(Note that this does not free objects created by [**NdfDiagnoseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfdiagnoseincident).</span></span>
