---
title: Cómo consultar un elemento virtualizado en la vista de elementos
description: En este tema se describe cómo usar la automatización de la interfaz de usuario de Microsoft para recuperar información de la interfaz de usuario sobre elementos virtualizados en la vista de elementos de Windows 7.
ms.assetid: a0bff8a1-47b1-4750-8086-e2e65a79099e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a098635d6e1045c6ff4573de088d8455685014d3
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/16/2019
ms.locfileid: "104419042"
---
# <a name="how-to-query-a-virtualized-item-in-items-view"></a><span data-ttu-id="dd45e-103">Cómo consultar un elemento virtualizado en la vista de elementos</span><span class="sxs-lookup"><span data-stu-id="dd45e-103">How to Query a Virtualized Item in Items View</span></span>

<span data-ttu-id="dd45e-104">En este tema se describe cómo usar la automatización de la interfaz de usuario de Microsoft para recuperar información de la interfaz de usuario sobre elementos virtualizados en la vista de elementos de Windows 7.</span><span class="sxs-lookup"><span data-stu-id="dd45e-104">This topic describes how to use Microsoft UI Automation to retrieve UI information about virtualized items in the Windows 7 Items View.</span></span> <span data-ttu-id="dd45e-105">En este tema se incluyen las secciones siguientes.</span><span class="sxs-lookup"><span data-stu-id="dd45e-105">This topic includes the following sections.</span></span>

> [!Note]  
> <span data-ttu-id="dd45e-106">Este tema solo se aplica a Windows 7.</span><span class="sxs-lookup"><span data-stu-id="dd45e-106">This topic applies to Windows 7 only.</span></span> <span data-ttu-id="dd45e-107">Tenga en cuenta que las características de accesibilidad descritas en este tema pueden cambiar en versiones futuras de Windows.</span><span class="sxs-lookup"><span data-stu-id="dd45e-107">Be aware that the accessibility features described in this topic may change in future versions of Windows.</span></span>

 

-   [<span data-ttu-id="dd45e-108">Información general</span><span class="sxs-lookup"><span data-stu-id="dd45e-108">Overview</span></span>](#overview)
-   [<span data-ttu-id="dd45e-109">Estructura de árbol de vista de elementos</span><span class="sxs-lookup"><span data-stu-id="dd45e-109">Items View Tree Structure</span></span>](#items-view-tree-structure)
-   [<span data-ttu-id="dd45e-110">Virtualización</span><span class="sxs-lookup"><span data-stu-id="dd45e-110">Virtualization</span></span>](#virtualization)
-   [<span data-ttu-id="dd45e-111">Obtener un recuento de todos los elementos</span><span class="sxs-lookup"><span data-stu-id="dd45e-111">Obtaining a Count of All Items</span></span>](#obtaining-a-count-of-all-items)
-   [<span data-ttu-id="dd45e-112">Obtener un índice de elemento con respecto a todos los elementos</span><span class="sxs-lookup"><span data-stu-id="dd45e-112">Obtaining an Item Index with Respect to All Items</span></span>](#obtaining-an-item-index-with-respect-to-all-items)
-   [<span data-ttu-id="dd45e-113">Obtener una referencia a un elemento Vitualized</span><span class="sxs-lookup"><span data-stu-id="dd45e-113">Obtaining a Reference to a Vitualized Item</span></span>](#obtaining-a-reference-to-a-vitualized-item)
-   [<span data-ttu-id="dd45e-114">Desplazar un elemento virtualizado en pantalla</span><span class="sxs-lookup"><span data-stu-id="dd45e-114">Scrolling a Virtualized Item on Screen</span></span>](#scrolling-a-virtualized-item-on-screen)
-   [<span data-ttu-id="dd45e-115">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="dd45e-115">Related topics</span></span>](#related-topics)

## <a name="overview"></a><span data-ttu-id="dd45e-116">Información general</span><span class="sxs-lookup"><span data-stu-id="dd45e-116">Overview</span></span>

<span data-ttu-id="dd45e-117">La vista elementos es un componente de la interfaz de usuario que permite a los usuarios ver e interactuar con archivos y otros elementos.</span><span class="sxs-lookup"><span data-stu-id="dd45e-117">Items View is a user interface component that enables users to view and interact with files and other items.</span></span> <span data-ttu-id="dd45e-118">En Windows 7, la vista de elementos reemplaza el control de vista de lista para presentar los elementos en la vista predeterminada del explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="dd45e-118">In Windows 7, Items View replaces the list-view control for presenting items in the default view of Windows Explorer.</span></span> <span data-ttu-id="dd45e-119">La vista elementos también se usa en el cuadro de diálogo elemento común, en los resultados de búsqueda del menú Inicio y en otros elementos de la interfaz de usuario de Windows 7 que usan el control explorador del explorador.</span><span class="sxs-lookup"><span data-stu-id="dd45e-119">Items View is also used in the Common Item Dialog, Start menu search results, and other Windows 7 UI elements that use the Explorer Browser control.</span></span> <span data-ttu-id="dd45e-120">En comparación con el control de vista de lista, la vista de elementos ofrece las siguientes ventajas a los usuarios:</span><span class="sxs-lookup"><span data-stu-id="dd45e-120">Compared to the list-view control, Items View offers the following advantages to users:</span></span>

-   <span data-ttu-id="dd45e-121">La vista de elementos puede presentar elementos de maneras más útiles, deseables y relevantes, lo que permite a los usuarios buscar y organizar los elementos de forma más sencilla, rápida y agradable.</span><span class="sxs-lookup"><span data-stu-id="dd45e-121">Items View can present items in ways that are more useful, desirable, and relevant, enabling users to find and organize items more simply, quickly, and enjoyably.</span></span>
-   <span data-ttu-id="dd45e-122">La vista de elementos puede mostrar grandes conjuntos de elementos de orígenes de datos que tienen diferentes características de rendimiento, lo que permite a los usuarios examinar y buscar toda la colección de elementos en varios orígenes.</span><span class="sxs-lookup"><span data-stu-id="dd45e-122">Items View can display large sets of items from data sources that have different performance characteristics, enabling users to browse and search their entire collection of items across multiple sources.</span></span>

<span data-ttu-id="dd45e-123">En la imagen siguiente se muestra la vista elementos del explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="dd45e-123">The following image shows the Items View in Windows Explorer.</span></span>

![captura de pantalla que muestra el explorador de Windows con el componente de vista de elementos](images/itemsview.gif)

<span data-ttu-id="dd45e-125">Desde la perspectiva del desarrollador, la estructura general y la funcionalidad de la vista de elementos es similar a la del control de vista de lista.</span><span class="sxs-lookup"><span data-stu-id="dd45e-125">From a developer's perspective, the general structure and functionality of Items View is similar to that of the list-view control.</span></span> <span data-ttu-id="dd45e-126">La principal diferencia es que la vista de elementos admite la virtualización, mientras que el control de vista de lista no lo hace.</span><span class="sxs-lookup"><span data-stu-id="dd45e-126">The main difference is that Items View supports virtualization, whereas the list-view control does not.</span></span> <span data-ttu-id="dd45e-127">Además, la vista de elementos usa dos nuevas interfaces de automatización de la interfaz de usuario para garantizar que el contenido virtualizado proporcionado por la vista de elementos sea accesible.</span><span class="sxs-lookup"><span data-stu-id="dd45e-127">Also, Items View uses two new UI Automation interfaces to ensure that virtualized content provided by Items View is accessible.</span></span> <span data-ttu-id="dd45e-128">Estas interfaces se describen en las siguientes secciones de este tema.</span><span class="sxs-lookup"><span data-stu-id="dd45e-128">These interfaces are described in the following sections of this topic.</span></span>

<span data-ttu-id="dd45e-129">Para obtener información general sobre la virtualización en la automatización de la interfaz de usuario, consulte [trabajar con elementos virtualizados](uiauto-workingwithvirtualizeditems.md).</span><span class="sxs-lookup"><span data-stu-id="dd45e-129">For general information about virtualization in UI Automation, see [Working with Virtualized Items](uiauto-workingwithvirtualizeditems.md).</span></span>

## <a name="items-view-tree-structure"></a><span data-ttu-id="dd45e-130">Estructura de árbol de vista de elementos</span><span class="sxs-lookup"><span data-stu-id="dd45e-130">Items View Tree Structure</span></span>

<span data-ttu-id="dd45e-131">En el árbol de automatización de la interfaz de usuario, el elemento de automatización de la interfaz de usuario de nivel superior de la vista de elementos tiene el nombre "ItemsView" y el tipo de control "list".</span><span class="sxs-lookup"><span data-stu-id="dd45e-131">In the UI Automation tree, the top level UI Automation element of Items View has the name "ItemsView" and the control type "list".</span></span> <span data-ttu-id="dd45e-132">En la imagen anterior, el elemento de automatización de la interfaz de usuario de ItemsView se describe en rojo.</span><span class="sxs-lookup"><span data-stu-id="dd45e-132">In the previous image, the ItemsView UI Automation element is outlined in red.</span></span> <span data-ttu-id="dd45e-133">Existen varios elementos de automatización de la interfaz de usuario bajo el nivel superior de ItemsView, pero se hace referencia a otros dos elementos de automatización de la interfaz de usuario en este documento: elementos de grupo y elementos de lista.</span><span class="sxs-lookup"><span data-stu-id="dd45e-133">Various UI Automation elements exist below the top level of ItemsView, but only two other UI Automation elements are referenced in this document: group items and list items.</span></span>

<span data-ttu-id="dd45e-134">Los elementos de grupo son los elementos de automatización de la interfaz de usuario que contienen todos los elementos de lista de ese grupo; su tipo de control es "Group" y sus nombres varían según el nombre del grupo.</span><span class="sxs-lookup"><span data-stu-id="dd45e-134">The group items are the UI Automation elements that contain all of the list items of that group—their control type is "Group" and their names vary depending on the group name.</span></span> <span data-ttu-id="dd45e-135">En la imagen anterior, el primer elemento de grupo contiene el encabezado "A-H (1)" y el elemento de lista "carpeta", y su nombre es "A-H".</span><span class="sxs-lookup"><span data-stu-id="dd45e-135">In the previous image, the first group item contains both the "A-H (1)" header and the "Folder" list item, and its name is "A-H".</span></span>

<span data-ttu-id="dd45e-136">Los elementos de la lista son los elementos de automatización de la interfaz de usuario que representan los elementos hoja de la vista: su tipo de control es "ListItem" y sus nombres varían en función del nombre del elemento.</span><span class="sxs-lookup"><span data-stu-id="dd45e-136">The list items are the UI Automation elements that represent the leaf items in the view—their control type is "ListItem" and their names vary depending on the item name.</span></span> <span data-ttu-id="dd45e-137">En la imagen anterior, los elementos de la lista son los elementos hoja como "carpeta", "música" y "imagen".</span><span class="sxs-lookup"><span data-stu-id="dd45e-137">In the previous image, the list elements are the leaf elements such as "Folder", "Music", and "Picture".</span></span> <span data-ttu-id="dd45e-138">En el resto de este documento, se hace referencia a estos tres elementos de automatización de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="dd45e-138">These three UI Automation elements are referred to by the terms ItemsView element, Group element, and ListItem element in the remainder of this document.</span></span>

## <a name="virtualization"></a><span data-ttu-id="dd45e-139">Virtualización</span><span class="sxs-lookup"><span data-stu-id="dd45e-139">Virtualization</span></span>

<span data-ttu-id="dd45e-140">La vista de elementos utiliza la virtualización, lo que significa que los elementos que se encuentran fuera del área visible de la vista no se capturan del sistema y no se crea la representación de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="dd45e-140">Items View uses virtualization, which means that items outside the visible area of the view are not fetched from the system, and the UI representation of them is not created.</span></span> <span data-ttu-id="dd45e-141">Estos elementos se denominan *elementos virtualizados*.</span><span class="sxs-lookup"><span data-stu-id="dd45e-141">These items are called *virtualized items*.</span></span> <span data-ttu-id="dd45e-142">Dado que no se crean, los elementos virtualizados no tienen elementos de automatización de la interfaz de usuario y, por tanto, no aparecen en el árbol de automatización de la interfaz de usuario cuando un cliente de automatización de la interfaz de usuario enumera el árbol.</span><span class="sxs-lookup"><span data-stu-id="dd45e-142">Because they are not created, virtualized items do not have UI Automation elements and therefore do not appear in the UI Automation tree when a UI Automation client enumerates the tree.</span></span> <span data-ttu-id="dd45e-143">Además, los patrones de control de UI Automation solo funcionan en elementos visibles.</span><span class="sxs-lookup"><span data-stu-id="dd45e-143">Also, UI Automation control patterns operate only on visible elements.</span></span> <span data-ttu-id="dd45e-144">Por ejemplo, el patrón de control [Selection](uiauto-implementingselection.md) devuelve solo los elementos seleccionados visibles cuando un cliente llama al método [**IUIAutomationSelectionPattern:: método getcurrentselection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationselectionpattern-getcurrentselection) .</span><span class="sxs-lookup"><span data-stu-id="dd45e-144">For example, the [Selection](uiauto-implementingselection.md) control pattern returns only the visible selected items when a client calls the [**IUIAutomationSelectionPattern::GetCurrentSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationselectionpattern-getcurrentselection) method.</span></span>

<span data-ttu-id="dd45e-145">La vista de elementos admite la capacidad de recuperar la siguiente información acerca de los elementos virtualizados:</span><span class="sxs-lookup"><span data-stu-id="dd45e-145">Items View supports the ability to retrieve the following information about virtualized items:</span></span>

-   <span data-ttu-id="dd45e-146">Un recuento del número total de elementos, incluidos los elementos virtualizados</span><span class="sxs-lookup"><span data-stu-id="dd45e-146">A count of the total number of items, including virtualized items</span></span>
-   <span data-ttu-id="dd45e-147">Elementos de UI Automation para elementos virtualizados</span><span class="sxs-lookup"><span data-stu-id="dd45e-147">UI Automation elements for virtualized items</span></span>
-   <span data-ttu-id="dd45e-148">Elementos de automatización de la interfaz de usuario para los elementos virtualizados seleccionados</span><span class="sxs-lookup"><span data-stu-id="dd45e-148">UI Automation elements for the virtualized items that are selected</span></span>

## <a name="obtaining-a-count-of-all-items"></a><span data-ttu-id="dd45e-149">Obtener un recuento de todos los elementos</span><span class="sxs-lookup"><span data-stu-id="dd45e-149">Obtaining a Count of All Items</span></span>

<span data-ttu-id="dd45e-150">Un cliente puede utilizar el elemento ItemsView para obtener un recuento de todos los elementos, así como un recuento de los elementos seleccionados.</span><span class="sxs-lookup"><span data-stu-id="dd45e-150">A client can use the ItemsView element to get a count of all items, as well as a count of the selected items.</span></span> <span data-ttu-id="dd45e-151">El elemento ItemsView proporciona dos maneras de obtener estos recuentos.</span><span class="sxs-lookup"><span data-stu-id="dd45e-151">The ItemsView element provides two ways to get these counts.</span></span> <span data-ttu-id="dd45e-152">Lo primero es obtener la propiedad ItemStatus del elemento ItemsView y el segundo es obteniendo propiedades personalizadas del elemento ItemsView.</span><span class="sxs-lookup"><span data-stu-id="dd45e-152">The first is by getting the ItemStatus property of the ItemsView element, and the second is by getting custom properties from the ItemsView element.</span></span>

<span data-ttu-id="dd45e-153">La propiedad ItemStatus es una cadena que especifica el recuento del número total de elementos y un recuento de los elementos seleccionados, separados por una coma.</span><span class="sxs-lookup"><span data-stu-id="dd45e-153">The ItemStatus property is a string that specifies a count of the total number of items and a count of the selected items, separated by a comma.</span></span> <span data-ttu-id="dd45e-154">Por ejemplo: "3 elementos, 1 elemento seleccionado".</span><span class="sxs-lookup"><span data-stu-id="dd45e-154">For example: "3 items, 1 item selected".</span></span> <span data-ttu-id="dd45e-155">Esta cadena está localizada y se puede comunicar directamente al usuario.</span><span class="sxs-lookup"><span data-stu-id="dd45e-155">This string is localized and can be communicated directly to the user.</span></span>

<span data-ttu-id="dd45e-156">Las propiedades personalizadas del elemento ItemsView incluyen una propiedad para el recuento de elementos y otra para el recuento de selección.</span><span class="sxs-lookup"><span data-stu-id="dd45e-156">The custom properties of the ItemsView element include one property for the item count, and another for the selection count.</span></span> <span data-ttu-id="dd45e-157">Incluyen:</span><span class="sxs-lookup"><span data-stu-id="dd45e-157">They include:</span></span>

-   <span data-ttu-id="dd45e-158">\_Propiedad ItemCount \_ GUID (ABBF5C45-5CCC-47b7-BB4E-87CB87BBD162): recuento de todos los elementos únicos de la vista.</span><span class="sxs-lookup"><span data-stu-id="dd45e-158">ItemCount\_Property\_GUID (ABBF5C45-5CCC-47b7-BB4E-87CB87BBD162)—The count of all unique items in the view.</span></span> <span data-ttu-id="dd45e-159">Si se agrupa por una propiedad de varios valores (MVP) para que un único elemento pueda aparecer varias veces, cada elemento se cuenta una sola vez.</span><span class="sxs-lookup"><span data-stu-id="dd45e-159">If grouped by a multi-value property (MVP) so that a single item can appear multiple times, each item is counted only once.</span></span>

    <span data-ttu-id="dd45e-160">(UIAutomationType: [**UIAutomationType \_ int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), nombre de programación: "ItemCount")</span><span class="sxs-lookup"><span data-stu-id="dd45e-160">(UIAutomationType: [**UIAutomationType\_Int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), Programmatic Name: "ItemCount")</span></span>

-   <span data-ttu-id="dd45e-161">\_GUID de la propiedad SelectedItemCount \_ (92A053DA-2969-4021-BF27-514CFC2E4A69): el recuento de todos los elementos únicos seleccionados en la vista.</span><span class="sxs-lookup"><span data-stu-id="dd45e-161">SelectedItemCount\_Property\_GUID (92A053DA-2969-4021-BF27-514CFC2E4A69)—The count of all unique items selected in the view.</span></span> <span data-ttu-id="dd45e-162">Si se agrupa por una propiedad de varios valores (MVP) para que un único elemento pueda aparecer varias veces, cada elemento se cuenta una sola vez.</span><span class="sxs-lookup"><span data-stu-id="dd45e-162">If grouped by a multi-value property (MVP) so that a single item can appear multiple times, each item is counted only once.</span></span>

    <span data-ttu-id="dd45e-163">(UIAutomationType: [**UIAutomationType \_ int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), nombre de programación: "SelectedItemCount")</span><span class="sxs-lookup"><span data-stu-id="dd45e-163">(UIAutomationType: [**UIAutomationType\_Int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), Programmatic Name: "SelectedItemCount")</span></span>

<span data-ttu-id="dd45e-164">Estas propiedades personalizadas se definen en Shlguid. h, que se incluye en el kit de desarrollo de software (SDK) de Windows, y estas propiedades se registran a través del método [**IUIAutomationRegistrar:: RegisterProperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) .</span><span class="sxs-lookup"><span data-stu-id="dd45e-164">These custom properties are defined in Shlguid.h, which is included in the Windows Software Development Kit (SDK), and these properties are registered through the [**IUIAutomationRegistrar::RegisterProperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) method.</span></span> <span data-ttu-id="dd45e-165">Los clientes de automatización de la interfaz de usuario usan **RegisterProperty** para recuperar los identificadores de propiedad (identificadores) de las propiedades personalizadas.</span><span class="sxs-lookup"><span data-stu-id="dd45e-165">UI Automation clients use **RegisterProperty** to retrieve property identifiers (PROPERTYIDs) for the custom properties.</span></span>

## <a name="obtaining-an-item-index-with-respect-to-all-items"></a><span data-ttu-id="dd45e-166">Obtener un índice de elemento con respecto a todos los elementos</span><span class="sxs-lookup"><span data-stu-id="dd45e-166">Obtaining an Item Index with Respect to All Items</span></span>

<span data-ttu-id="dd45e-167">Un cliente puede obtener el índice de un elemento obteniendo la propiedad ItemStatus de un elemento ListItem o obteniendo una propiedad personalizada de un elemento ListItem.</span><span class="sxs-lookup"><span data-stu-id="dd45e-167">A client can obtain the index of an item either by getting the ItemStatus property of a ListItem element, or by getting a custom property of a ListItem element.</span></span>

<span data-ttu-id="dd45e-168">La propiedad ItemStatus es una cadena que contiene el índice de un elemento con respecto al número total de elementos.</span><span class="sxs-lookup"><span data-stu-id="dd45e-168">The ItemStatus property is a string that contains the index of an item with respect to the total number of items.</span></span> <span data-ttu-id="dd45e-169">Por ejemplo: "elemento 1 de 3".</span><span class="sxs-lookup"><span data-stu-id="dd45e-169">For example: "item 1 of 3".</span></span> <span data-ttu-id="dd45e-170">Esta cadena está localizada y se puede comunicar directamente al usuario.</span><span class="sxs-lookup"><span data-stu-id="dd45e-170">This string is localized and can be communicated directly to the user.</span></span>

<span data-ttu-id="dd45e-171">La siguiente propiedad personalizada obtiene el índice de elemento de un elemento ListItem:</span><span class="sxs-lookup"><span data-stu-id="dd45e-171">The following custom property gets the item index of a ListItem element:</span></span>

-   <span data-ttu-id="dd45e-172">\_Propiedad ItemIndex \_ (GUID) (92A053DA-2969-4021-BF27-514CFC2E4A69): el índice absoluto basado en 1 de un elemento.</span><span class="sxs-lookup"><span data-stu-id="dd45e-172">ItemIndex\_Property\_GUID (92A053DA-2969-4021-BF27-514CFC2E4A69)—The 1-based absolute index of an item.</span></span> <span data-ttu-id="dd45e-173">Si se agrupa por una propiedad de varios valores (MVP) para que un único elemento pueda aparecer dos veces, cada aspecto del elemento obtiene un índice independiente.</span><span class="sxs-lookup"><span data-stu-id="dd45e-173">If grouped by a multi-value property (MVP) so that a single item can appear twice, each appearance of the item gets a separate index.</span></span>

    <span data-ttu-id="dd45e-174">(UIAutomationType: [**UIAutomationType \_ int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), nombre de programación: "ItemIndex")</span><span class="sxs-lookup"><span data-stu-id="dd45e-174">(UIAutomationType: [**UIAutomationType\_Int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), Programmatic Name: "ItemIndex")</span></span>

<span data-ttu-id="dd45e-175">Esta propiedad personalizada se define en Shlguid. h, que se incluye en el Windows SDK y se registra a través del método [**IUIAutomationRegistrar:: RegisterProperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) .</span><span class="sxs-lookup"><span data-stu-id="dd45e-175">This custom property is defined in Shlguid.h, which is included in the Windows SDK, and is registered through the [**IUIAutomationRegistrar::RegisterProperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) method.</span></span> <span data-ttu-id="dd45e-176">Los clientes de automatización de la interfaz de usuario usan **RegisterProperty** para recuperar un identificador de propiedad (identificadores) para la propiedad personalizada.</span><span class="sxs-lookup"><span data-stu-id="dd45e-176">UI Automation clients use **RegisterProperty** to retrieve a property identifier (PROPERTYIDs) for the custom property.</span></span>

## <a name="obtaining-a-reference-to-a-vitualized-item"></a><span data-ttu-id="dd45e-177">Obtener una referencia a un elemento Vitualized</span><span class="sxs-lookup"><span data-stu-id="dd45e-177">Obtaining a Reference to a Vitualized Item</span></span>

<span data-ttu-id="dd45e-178">Un elemento ItemsView implementa el patrón de control [ItemContainer](uiauto-implementingitemcontainer.md) (interfaz [**IItemContainerProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iitemcontainerprovider) ), que permite a un cliente obtener un elemento de automatización de la interfaz de usuario para un elemento virtualizado (un elemento que está fuera del área visible).</span><span class="sxs-lookup"><span data-stu-id="dd45e-178">An ItemsView element implements the [ItemContainer](uiauto-implementingitemcontainer.md) control pattern ([**IItemContainerProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iitemcontainerprovider) interface), which allows a client to get a UI Automation element for a virtualized item (an item that is outside the visible area).</span></span> <span data-ttu-id="dd45e-179">ItemsView permite al cliente buscar un elemento ListItem buscando en el nombre y en las propiedades de selección. Si intenta buscar en cualquier otra propiedad, se producirá un error.</span><span class="sxs-lookup"><span data-stu-id="dd45e-179">ItemsView allows the client to find a ListItem element by searching on the Name and Selection properties—attempting to search on any other property will fail.</span></span>

<span data-ttu-id="dd45e-180">Un elemento virtual solo implementa el patrón de control [VirtualizedItem](uiauto-implementingvirtualizeditem.md) (interfaz [**IVirtualizedItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider) ).</span><span class="sxs-lookup"><span data-stu-id="dd45e-180">A virtual element implements only the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern ([**IVirtualizedItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider) interface).</span></span> <span data-ttu-id="dd45e-181">Dado que el elemento representado por un elemento de automatización de la interfaz de usuario virtualizado no existe todavía, se producirá un error al intentar obtener cualquier otro patrón de control o propiedad del elemento.</span><span class="sxs-lookup"><span data-stu-id="dd45e-181">Because the item that is represented by a virtualized UI Automation element does not exist yet, attempting to get any other control pattern or property of the element will fail.</span></span>

<span data-ttu-id="dd45e-182">Los elementos ListItem y Group están virtualizados, pero solo los elementos ListItem pueden devolverse desde el patrón de control [ItemContainer](uiauto-implementingitemcontainer.md) .</span><span class="sxs-lookup"><span data-stu-id="dd45e-182">Both ListItem and Group elements are virtualized, but only ListItem elements can be returned from the [ItemContainer](uiauto-implementingitemcontainer.md) control pattern.</span></span> <span data-ttu-id="dd45e-183">Dado que la llamada al método [**IUIAutomationItemContainerPattern:: FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) se ejecuta en el subproceso de la interfaz de usuario y está bloqueando, la vista no responderá hasta que se devuelva **FindItemByProperty** y cualquier otra llamada al método en el proveedor debe esperar hasta que finalice **FindItemByProperty** .</span><span class="sxs-lookup"><span data-stu-id="dd45e-183">Because the call to the [**IUIAutomationItemContainerPattern::FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) method runs on the UI thread and is blocking, the view will not respond until **FindItemByProperty** returns, and any other method calls on the provider must wait until **FindItemByProperty** finishes.</span></span> <span data-ttu-id="dd45e-184">En algunos casos, **FindItemByProperty** debe procesar todo el conjunto de datos antes de devolverse, lo que puede consumir muchos recursos.</span><span class="sxs-lookup"><span data-stu-id="dd45e-184">In some instances, **FindItemByProperty** must process the entire data set before returning, which can be resource-intensive.</span></span> <span data-ttu-id="dd45e-185">Si se especifica **null** como el elemento de inicio, **FindItemByProperty** inicia la búsqueda con el primer elemento de la vista.</span><span class="sxs-lookup"><span data-stu-id="dd45e-185">Specifying **NULL** as the starting element causes **FindItemByProperty** to begin the search with the first item in the view.</span></span>

<span data-ttu-id="dd45e-186">ItemsView admite las siguientes propiedades para [**FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty):</span><span class="sxs-lookup"><span data-stu-id="dd45e-186">ItemsView supports the following properties for [**FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty):</span></span>

-   <span data-ttu-id="dd45e-187">Nombre (UIA \_ NamePropertyId): busca el primer elemento cuyo nombre coincide con la cadena especificada.</span><span class="sxs-lookup"><span data-stu-id="dd45e-187">Name (UIA\_NamePropertyId)—Searches for the first item whose name fully matches the specified string.</span></span> <span data-ttu-id="dd45e-188">La búsqueda no hace distinción de mayúsculas y minúsculas.</span><span class="sxs-lookup"><span data-stu-id="dd45e-188">The search is not case sensitive.</span></span> <span data-ttu-id="dd45e-189">No se admiten caracteres comodín o coincidencias parciales.</span><span class="sxs-lookup"><span data-stu-id="dd45e-189">Wildcard characters or partial matching is not supported.</span></span> <span data-ttu-id="dd45e-190">Si se especifica un nombre **null** , se devuelve el elemento siguiente después del elemento de inicio.</span><span class="sxs-lookup"><span data-stu-id="dd45e-190">If a **NULL** name is specified, the next item after the starting element is returned.</span></span> <span data-ttu-id="dd45e-191">Si se especifican nombres **null** , se permite que un cliente de automatización de la interfaz de usuario Enumere todos los elementos de la vista. sin embargo, no se recomienda enumerar todos los elementos porque hace que se produzcan todos los elementos de la vista.</span><span class="sxs-lookup"><span data-stu-id="dd45e-191">Specifying **NULL** names allows a UI Automation client to enumerate all items in the view; however, enumerating all items is discouraged because it causes all items in the view to be realized.</span></span>
-   <span data-ttu-id="dd45e-192">SelectionItem \_ IsSelected (UIA \_ SelectionItemIsSelectedPropertyId): busca el primer elemento cuya \_ propiedad IsSelected SelectionItem coincida con el valor especificado.</span><span class="sxs-lookup"><span data-stu-id="dd45e-192">SelectionItem\_IsSelected (UIA\_SelectionItemIsSelectedPropertyId)—Searches for the first item whose SelectionItem\_IsSelected property matches the specified value.</span></span> <span data-ttu-id="dd45e-193">Especifique **true** para buscar el primer elemento seleccionado o **false** para buscar el primer elemento no seleccionado.</span><span class="sxs-lookup"><span data-stu-id="dd45e-193">Specify **TRUE** to find the first selected item, or **FALSE** to find the first non-selected item.</span></span> <span data-ttu-id="dd45e-194">Tenga cuidado al enumerar todos los elementos seleccionados porque el número de elementos seleccionados puede ser muy grande, especialmente si el usuario ha seleccionado todos los elementos.</span><span class="sxs-lookup"><span data-stu-id="dd45e-194">Be careful when enumerating all selected items because the number of selected items can be very large, especially if the user has selected all items.</span></span>

## <a name="scrolling-a-virtualized-item-on-screen"></a><span data-ttu-id="dd45e-195">Desplazar un elemento virtualizado en pantalla</span><span class="sxs-lookup"><span data-stu-id="dd45e-195">Scrolling a Virtualized Item on Screen</span></span>

<span data-ttu-id="dd45e-196">Después de obtener una referencia a un elemento de automatización de la interfaz de usuario para un elemento virtualizado (fuera de la pantalla), el cliente puede desplazar el elemento a la vista mediante el método [**IUIAutomationVirtualizeItemPattern::**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) acview del patrón de control [VirtualizedItem](uiauto-implementingvirtualizeditem.md) .</span><span class="sxs-lookup"><span data-stu-id="dd45e-196">After obtaining a reference to a UI Automation element for a virtualized (off-screen) item, the client can scroll the item into view by using the [**IUIAutomationVirtualizeItemPattern::Realize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) method of the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern.</span></span> <span data-ttu-id="dd45e-197">Una vez realizado el elemento, es visible y todas las propiedades y los patrones de control asociados normalmente a un elemento ListItem están disponibles para el cliente.</span><span class="sxs-lookup"><span data-stu-id="dd45e-197">After the item is realized, it is visible, and all properties and control patterns normally associated with a ListItem element are available to the client.</span></span>

<span data-ttu-id="dd45e-198">Solo los elementos ListItem obtenidos por el método [**IUIAutomationItemContainerPattern:: FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) exponen el patrón de control [VirtualizedItem](uiauto-implementingvirtualizeditem.md) .</span><span class="sxs-lookup"><span data-stu-id="dd45e-198">Only ListItem elements obtained by the [**IUIAutomationItemContainerPattern::FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) method expose the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern.</span></span> <span data-ttu-id="dd45e-199">Cuando un elemento en pantalla se desplaza fuera de la pantalla, el elemento deja de ser válido y el cliente debe llamar a **FindItemByProperty** para obtener la referencia fuera de pantalla.</span><span class="sxs-lookup"><span data-stu-id="dd45e-199">When an on-screen element is scrolled off-screen, the element becomes invalid and the client must call **FindItemByProperty** to get the off-screen reference.</span></span>

<span data-ttu-id="dd45e-200">También es posible desplazar elementos dentro y fuera de la vista mediante el patrón de control [Scroll](uiauto-implementingscroll.md) (o mediante las barras de desplazamiento).</span><span class="sxs-lookup"><span data-stu-id="dd45e-200">It is also possible to move items into and out of view by using the [Scroll](uiauto-implementingscroll.md) control pattern (or by using the scroll bars).</span></span> <span data-ttu-id="dd45e-201">Los elementos y los grupos se llevan a cabo a medida que se desplazan a la vista y se virtualizan cuando se desplazan fuera de la vista.</span><span class="sxs-lookup"><span data-stu-id="dd45e-201">Items and groups are realized as they scroll into view, and are virtualized as they scroll out of view.</span></span>

## <a name="related-topics"></a><span data-ttu-id="dd45e-202">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="dd45e-202">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="dd45e-203">Trabajar con elementos virtualizados</span><span class="sxs-lookup"><span data-stu-id="dd45e-203">Working with Virtualized Items</span></span>](uiauto-workingwithvirtualizeditems.md)
</dt> </dl>

 

 




