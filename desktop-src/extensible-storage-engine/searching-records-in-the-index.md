---
description: Más información acerca de cómo buscar registros en el índice
title: Buscar registros en el índice
TOCTitle: Searching Records in the Index
ms:assetid: 9141b1d6-81b6-49ad-a5d4-2409fe0d511a
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269342(v=EXCHG.10)
ms:contentKeyID: 32765631
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: 89a4ffe1f1c13280f236442ae218580fa5699741
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "105687673"
---
# <a name="searching-records-in-the-index"></a><span data-ttu-id="249df-103">Buscar registros en el índice</span><span class="sxs-lookup"><span data-stu-id="249df-103">Searching Records in the Index</span></span>


<span data-ttu-id="249df-104">_**Se aplica a:** Windows | Windows Server_</span><span class="sxs-lookup"><span data-stu-id="249df-104">_**Applies to:** Windows | Windows Server_</span></span>

## <a name="searching-records-in-the-index"></a><span data-ttu-id="249df-105">Buscar registros en el índice</span><span class="sxs-lookup"><span data-stu-id="249df-105">Searching Records in the Index</span></span>

<span data-ttu-id="249df-106">Las claves de búsqueda se crean para buscar una entrada única o un conjunto de entradas en un índice.</span><span class="sxs-lookup"><span data-stu-id="249df-106">Search keys are created to search for a single entry or a set of entries in an index.</span></span> <span data-ttu-id="249df-107">Las claves de búsqueda solo se pueden construir para las columnas de clave del índice y pueden contener uno o más valores de columna.</span><span class="sxs-lookup"><span data-stu-id="249df-107">Search keys may only be constructed for the key columns in the index, and may contain one or more column values.</span></span> <span data-ttu-id="249df-108">La clave de búsqueda se construye con una sola llamada o una serie de llamadas a [JetMakeKey](./jetmakekey-function.md), y se puede recuperar con [JetRetrieveKey](./jetretrievekey-function.md) mediante JET_bitRetrieveCopy.</span><span class="sxs-lookup"><span data-stu-id="249df-108">The search key is constructed with a single call or a series of calls to [JetMakeKey](./jetmakekey-function.md), and may be retrieved with [JetRetrieveKey](./jetretrievekey-function.md) using JET_bitRetrieveCopy.</span></span> <span data-ttu-id="249df-109">Una vez construida la clave de búsqueda, se puede usar para desplace el cursor al registro del índice.</span><span class="sxs-lookup"><span data-stu-id="249df-109">After the search key is constructed it can be used to move the cursor to the record in the index.</span></span>

<span data-ttu-id="249df-110">Existen tres métodos para buscar registros en una tabla:</span><span class="sxs-lookup"><span data-stu-id="249df-110">There are three methods of finding records in a table:</span></span>

1.  <span data-ttu-id="249df-111">Busque una sola entrada de índice.</span><span class="sxs-lookup"><span data-stu-id="249df-111">Search for a single index entry.</span></span> <span data-ttu-id="249df-112">Para ello, cree la clave de búsqueda con [JetMakeKey](./jetmakekey-function.md)y, a continuación, desplácese a ese registro con [JetSeek](./jetseek-function.md).</span><span class="sxs-lookup"><span data-stu-id="249df-112">To do this, create the search key with [JetMakeKey](./jetmakekey-function.md), and then move to that record with [JetSeek](./jetseek-function.md).</span></span>

2.  <span data-ttu-id="249df-113">Busque en el índice registro por registro.</span><span class="sxs-lookup"><span data-stu-id="249df-113">Search the index record-by-record.</span></span> <span data-ttu-id="249df-114">Los registros se pueden atravesar un registro cada vez llamando a [JetMove](./jetmove-function.md).</span><span class="sxs-lookup"><span data-stu-id="249df-114">Records can be traversed one record at a time by calling [JetMove](./jetmove-function.md).</span></span> <span data-ttu-id="249df-115">El cursor puede moverse al primer registro del índice especificando JET_MoveFirst en el parámetro *cRow* de [JetMove](./jetmove-function.md).</span><span class="sxs-lookup"><span data-stu-id="249df-115">The cursor can be moved to the first record in the index by specifying JET_MoveFirst in the *cRow* parameter of [JetMove](./jetmove-function.md).</span></span> <span data-ttu-id="249df-116">Del mismo modo, el cursor puede moverse hacia delante, hacia atrás o hasta la última entrada del índice.</span><span class="sxs-lookup"><span data-stu-id="249df-116">In the same way, the cursor can be moved forward, backward, or to the last entry in the index.</span></span>

3.  <span data-ttu-id="249df-117">Buscar en un conjunto de registros.</span><span class="sxs-lookup"><span data-stu-id="249df-117">Search through a set of records.</span></span> <span data-ttu-id="249df-118">Para ello, establezca un intervalo de entradas de índice en buscar y, a continuación, desplácese por los registros secuencialmente.</span><span class="sxs-lookup"><span data-stu-id="249df-118">To do this, set a range of index entries to search, then move through the records sequentially.</span></span> <span data-ttu-id="249df-119">Para obtener más información, vea la sección [Buscar en un conjunto de registros]() de este tema.</span><span class="sxs-lookup"><span data-stu-id="249df-119">For more information, see [Searching Through a Set of Records]() section of this topic.</span></span>

### <a name="searching-through-a-set-of-records"></a><span data-ttu-id="249df-120">Buscar en un conjunto de registros</span><span class="sxs-lookup"><span data-stu-id="249df-120">Searching Through a Set of Records</span></span>

<span data-ttu-id="249df-121">En este diagrama se muestra el cursor que se desplaza por un intervalo de entradas de índice definidas por llamadas a [JetSeek](./jetseek-function.md) y [JetSetIndexRange](./jetsetindexrange-function.md).</span><span class="sxs-lookup"><span data-stu-id="249df-121">The diagram here shows the cursor moving through a range of index entries defined by calls to [JetSeek](./jetseek-function.md) and [JetSetIndexRange](./jetsetindexrange-function.md).</span></span>

<span data-ttu-id="249df-122">Utilice el procedimiento siguiente para buscar en un conjunto de registros de un índice.</span><span class="sxs-lookup"><span data-stu-id="249df-122">Use the following procedure to search through a set of records in an index.</span></span>

### <a name="to-search-a-set-of-records-in-an-index"></a><span data-ttu-id="249df-123">Para buscar en un conjunto de registros de un índice</span><span class="sxs-lookup"><span data-stu-id="249df-123">To search a set of records in an index</span></span>

1.  <span data-ttu-id="249df-124">Cree la clave de búsqueda para el primer registro del conjunto de registros que se va a buscar con [JetMakeKey](./jetmakekey-function.md).</span><span class="sxs-lookup"><span data-stu-id="249df-124">Create the search key for the first record in the set of records to be searched with [JetMakeKey](./jetmakekey-function.md).</span></span>

2.  <span data-ttu-id="249df-125">Mueva el cursor al registro indicado en la clave de búsqueda con [JetSeek](./jetseek-function.md).</span><span class="sxs-lookup"><span data-stu-id="249df-125">Move the cursor to the record indicated in the search key with [JetSeek](./jetseek-function.md).</span></span>

3.  <span data-ttu-id="249df-126">Cree otra clave de búsqueda para la última entrada de índice en el intervalo con [JetMakeKey](./jetmakekey-function.md).</span><span class="sxs-lookup"><span data-stu-id="249df-126">Create another search key for the last index entry in the range with [JetMakeKey](./jetmakekey-function.md).</span></span>

4.  <span data-ttu-id="249df-127">Establezca el intervalo de índice con [JetSetIndexRange](./jetsetindexrange-function.md) mediante la clave creada en el paso 3.</span><span class="sxs-lookup"><span data-stu-id="249df-127">Set the index range with [JetSetIndexRange](./jetsetindexrange-function.md) using the key created in step 3.</span></span>

5.  <span data-ttu-id="249df-128">Llame a [JetMove](./jetmove-function.md) para moverse secuencialmente a través de cada registro en el intervalo de índice, tal como se muestra en el diagrama siguiente.</span><span class="sxs-lookup"><span data-stu-id="249df-128">Call [JetMove](./jetmove-function.md) to move sequentially through each record in the index range as shown in the following diagram.</span></span>

<span data-ttu-id="249df-129">![ESE_Documentation_IndexRange](images/Gg269342.ESE_Documentation_IndexRange(EXCHG.10).gif "ESE_Documentation_IndexRange")</span><span class="sxs-lookup"><span data-stu-id="249df-129">![ESE_Documentation_IndexRange](images/Gg269342.ESE_Documentation_IndexRange(EXCHG.10).gif "ESE_Documentation_IndexRange")</span></span>

<span data-ttu-id="249df-130">El cursor del diagrama aquí solo puede desplazarse por el intervalo de índices establecido en la llamada a [JetSetIndexRange](./jetsetindexrange-function.md).</span><span class="sxs-lookup"><span data-stu-id="249df-130">The cursor in the diagram here may only move through the range of indices set in the call to [JetSetIndexRange](./jetsetindexrange-function.md).</span></span> <span data-ttu-id="249df-131">Si la aplicación intenta desplace el cursor más allá del intervalo de índices, ESE devuelve un error de Jet_errNoCurrentRecord de la llamada a [JetMove](./jetmove-function.md).</span><span class="sxs-lookup"><span data-stu-id="249df-131">If the application attempts to move the cursor beyond the index range, ESE returns a Jet_errNoCurrentRecord error from the call to [JetMove](./jetmove-function.md).</span></span> <span data-ttu-id="249df-132">Tenga en cuenta que cualquier tipo de navegación con este cursor que no sea el que se desplaza al Registro siguiente o anterior cancelará el intervalo de índices.</span><span class="sxs-lookup"><span data-stu-id="249df-132">Note that any type of navigation with this cursor other than moving to the next or previous record will cancel the index range.</span></span> <span data-ttu-id="249df-133">Vea [JetSetIndexRange](./jetsetindexrange-function.md) para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="249df-133">See [JetSetIndexRange](./jetsetindexrange-function.md) for more information.</span></span>

<span data-ttu-id="249df-134">El tipo de datos especificado en el parámetro *pvData* para [JetMakeKey](./jetmakekey-function.md) debe coincidir con el tipo de datos y las propiedades especificados para la columna.</span><span class="sxs-lookup"><span data-stu-id="249df-134">The type of data entered in the *pvData* parameter for [JetMakeKey](./jetmakekey-function.md) must match the type of data and properties specified for the column.</span></span> <span data-ttu-id="249df-135">Por ejemplo, al llamar a [JetMakeKey](./jetmakekey-function.md) con "Ben Miller" especificado en el parámetro *pvData* para un tipo de columna JET_coltypText es una coincidencia de tipo de datos válida.</span><span class="sxs-lookup"><span data-stu-id="249df-135">For example, calling [JetMakeKey](./jetmakekey-function.md) with "Ben Miller" specified in the *pvData* parameter for a column type JET_coltypText is a valid data type match.</span></span> <span data-ttu-id="249df-136">Si desea crear una clave de búsqueda para buscar entre los nombres "Ben Miller" y "Max Stevens" en un índice, mueva el cursor al registro con el nombre "Ben Miller" llamando a [JetSeek](./jetseek-function.md).</span><span class="sxs-lookup"><span data-stu-id="249df-136">If you want to create a search key to search between the names "Ben Miller" and "Max Stevens" in an index, move the cursor to the record with the name "Ben Miller" by calling [JetSeek](./jetseek-function.md).</span></span> <span data-ttu-id="249df-137">Llame a [JetMakeKey](./jetmakekey-function.md) una segunda vez y especifique un puntero a una cadena que contenga el nombre "Max Stevens".</span><span class="sxs-lookup"><span data-stu-id="249df-137">Call [JetMakeKey](./jetmakekey-function.md) a second time and specify a pointer to a string containing the name "Max Stevens".</span></span> <span data-ttu-id="249df-138">El intervalo de índice se establece para limitar el cursor y desplazarse entre los nombres "Ben Miller" y "Max Stevens" en la llamada a [JetSetIndexRange](./jetsetindexrange-function.md).</span><span class="sxs-lookup"><span data-stu-id="249df-138">The index range is set to limit the cursor to move between the names "Ben Miller" and "Max Stevens" in the call to [JetSetIndexRange](./jetsetindexrange-function.md).</span></span>
