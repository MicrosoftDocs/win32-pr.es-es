---
description: Con el tiempo, pueden existir diferentes versiones para TAPI, aplicaciones y proveedores de servicios para una línea o un teléfono.
ms.assetid: 36a17ae8-31db-4db9-a401-097d47aa26ad
title: Negociación de la versión de TAPI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f41f4ca6f12862d6fc19f982c48b90bdafe2aaa2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "105678167"
---
# <a name="tapi-version-negotiation"></a><span data-ttu-id="ad057-103">Negociación de la versión de TAPI</span><span class="sxs-lookup"><span data-stu-id="ad057-103">TAPI Version Negotiation</span></span>

<span data-ttu-id="ad057-104">Con el tiempo, pueden existir diferentes versiones para TAPI, aplicaciones y proveedores de servicios para una línea o un teléfono.</span><span class="sxs-lookup"><span data-stu-id="ad057-104">Over time, different versions may exist for TAPI, applications, and service providers for a line or phone.</span></span> <span data-ttu-id="ad057-105">Las nuevas versiones pueden definir nuevas características, nuevos campos para estructuras de datos, etc.</span><span class="sxs-lookup"><span data-stu-id="ad057-105">New versions may define new features, new fields to data structures, and so on.</span></span> <span data-ttu-id="ad057-106">Por lo tanto, los números de versión indican cómo interpretar varias estructuras de datos.</span><span class="sxs-lookup"><span data-stu-id="ad057-106">Version numbers therefore indicate how to interpret various data structures.</span></span>

<span data-ttu-id="ad057-107">Para permitir una interoperabilidad óptima de las distintas versiones de aplicaciones, versiones de TAPI y versiones de proveedores de servicios de diferentes proveedores, TAPI proporciona un mecanismo de negociación de versión simple de dos pasos para las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="ad057-107">To allow optimal interoperability of different versions of applications, versions of TAPI itself, and versions of service providers by different vendors, TAPI provides a simple, two-step version negotiation mechanism for applications.</span></span> <span data-ttu-id="ad057-108">La aplicación, TAPI y el proveedor de servicios de cada dispositivo de línea deben acordar dos versiones diferentes.</span><span class="sxs-lookup"><span data-stu-id="ad057-108">Two different versions must be agreed on by the application, TAPI, and the service provider for each line device.</span></span> <span data-ttu-id="ad057-109">El primero es el número de versión de la telefonía básica y complementaria, y se conoce como la versión de la API.</span><span class="sxs-lookup"><span data-stu-id="ad057-109">The first is the version number for Basic and Supplementary Telephony and is referred to as the API version.</span></span> <span data-ttu-id="ad057-110">El otro es para las extensiones específicas del proveedor, si existen, y se conoce como la versión de la extensión.</span><span class="sxs-lookup"><span data-stu-id="ad057-110">The other is for provider-specific extensions, if any, and is referred to as the extension version.</span></span> <span data-ttu-id="ad057-111">El formato de las estructuras de datos y los tipos de datos que usan las características básicas y complementarias de TAPI se define mediante la versión de la API, mientras que la versión de la extensión determina el formato de las estructuras de datos definidas por las extensiones específicas del proveedor.</span><span class="sxs-lookup"><span data-stu-id="ad057-111">The format of the data structures and datatypes used by TAPI's basic and supplementary features is defined by the API version, while the extension version determines the format of the data structures defined by the vendor-specific extensions.</span></span>

<span data-ttu-id="ad057-112">La negociación de la versión continúa en dos fases.</span><span class="sxs-lookup"><span data-stu-id="ad057-112">Version negotiation proceeds in two phases.</span></span> <span data-ttu-id="ad057-113">En la primera fase, se negocia el número de versión de la API y se obtiene el identificador de extensión asociado a las extensiones específicas del proveedor admitidas en el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="ad057-113">In the first phase, the API version number is negotiated and the extension identifier associated with any vendor-specific extensions supported on the device is obtained.</span></span> <span data-ttu-id="ad057-114">En la segunda fase, se negocia la versión de la extensión.</span><span class="sxs-lookup"><span data-stu-id="ad057-114">In the second phase, the extension version is negotiated.</span></span> <span data-ttu-id="ad057-115">Si la aplicación no usa extensiones de API, omite la segunda fase y las extensiones no están activadas por el proveedor de servicios.</span><span class="sxs-lookup"><span data-stu-id="ad057-115">If the application does not use any API extensions, it skips the second phase and extensions are not activated by the service provider.</span></span> <span data-ttu-id="ad057-116">Si la aplicación desea usar extensiones, pero la aplicación no reconoce las extensiones del proveedor de servicios (el identificador de extensión), la aplicación debe omitir también la negociación de la versión de la extensión.</span><span class="sxs-lookup"><span data-stu-id="ad057-116">If the application does want to use extensions, but the service provider's extensions (the extension identifier) are not recognized by the application, the application should skip the negotiation for extension version as well.</span></span> <span data-ttu-id="ad057-117">Cada proveedor tiene su propio conjunto de versiones válidas (reconocidas) para cada conjunto de especificaciones de extensión que distribuye.</span><span class="sxs-lookup"><span data-stu-id="ad057-117">Each vendor has its own set of legal (recognized) versions for each set of extension specifications it distributes.</span></span>

<span data-ttu-id="ad057-118">La función [**lineNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion) se usa para negociar el número de versión de la API que se va a usar.</span><span class="sxs-lookup"><span data-stu-id="ad057-118">The [**lineNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion) function is used to negotiate the API version number to use.</span></span> <span data-ttu-id="ad057-119">También recupera el identificador de extensión admitido por el dispositivo de línea y devuelve ceros si no se admiten extensiones.</span><span class="sxs-lookup"><span data-stu-id="ad057-119">It also retrieves the extension identifier supported by the line device, returning zeros if no extensions are supported.</span></span> <span data-ttu-id="ad057-120">Con esta llamada de función, la aplicación proporciona el intervalo de versiones de API con el que es compatible.</span><span class="sxs-lookup"><span data-stu-id="ad057-120">With this function call, the application provides the API version range it is compatible with.</span></span> <span data-ttu-id="ad057-121">A su vez, TAPI negocia con el proveedor de servicios de la línea para determinar el intervalo de versión de la API que admite.</span><span class="sxs-lookup"><span data-stu-id="ad057-121">TAPI in turn negotiates with the line's service provider to determine which API version range it supports.</span></span> <span data-ttu-id="ad057-122">A continuación, TAPI selecciona un número de versión (normalmente, aunque no necesariamente, el número de versión más alto) en el intervalo de versiones superpuestos que ha proporcionado la aplicación, el archivo DLL y el proveedor de servicios.</span><span class="sxs-lookup"><span data-stu-id="ad057-122">TAPI next selects a version number (typically, although not necessarily, the highest version number) in the overlapping version range that the application, the DLL, and the service provider have supplied.</span></span> <span data-ttu-id="ad057-123">Este número se devuelve a la aplicación, junto con el identificador de extensión que define las extensiones disponibles en el proveedor de servicios de esa línea.</span><span class="sxs-lookup"><span data-stu-id="ad057-123">This number is returned to the application, along with the extension identifier that defines the extensions available from that line's service provider.</span></span>

<span data-ttu-id="ad057-124">Si la aplicación desea usar las extensiones definidas por el identificador de extensión devuelto, primero debe llamar a [**lineNegotiateExtVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateextversion) para negociar la versión de la extensión.</span><span class="sxs-lookup"><span data-stu-id="ad057-124">If the application wants to use the extensions defined by the returned extension identifier, it must first call [**lineNegotiateExtVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateextversion) to negotiate the extension version.</span></span> <span data-ttu-id="ad057-125">En una fase de negociación similar, la aplicación especifica la versión de API ya acordada y el intervalo de versiones de la extensión que admite.</span><span class="sxs-lookup"><span data-stu-id="ad057-125">In a similar negotiation phase, the application specifies the already agreed-upon API version and the extension version range it supports.</span></span> <span data-ttu-id="ad057-126">TAPI pasa esta información al proveedor de servicios para la línea.</span><span class="sxs-lookup"><span data-stu-id="ad057-126">TAPI passes this information to the service provider for the line.</span></span> <span data-ttu-id="ad057-127">El proveedor de servicios comprueba la versión de la API y el intervalo de versiones de la extensión con respecto a su propio y selecciona el número de versión de la extensión adecuado, si existe.</span><span class="sxs-lookup"><span data-stu-id="ad057-127">The service provider checks the API version and the extension version range against its own, and selects the appropriate extension version number, if one exists.</span></span>

<span data-ttu-id="ad057-128">Cuando la aplicación llama posteriormente a [**lineGetDevCaps**](/windows/desktop/api/Tapi/nf-tapi-linegetdevcaps), devuelve un conjunto de funcionalidades de dispositivo para la línea que corresponde a los resultados de la negociación de la versión.</span><span class="sxs-lookup"><span data-stu-id="ad057-128">When the application later calls [**lineGetDevCaps**](/windows/desktop/api/Tapi/nf-tapi-linegetdevcaps), it returns a set of device capabilities for the line that correspond to the results of version negotiation.</span></span> <span data-ttu-id="ad057-129">Incluyen las funcionalidades de dispositivo de la línea coherentes con la versión de la API y las capacidades específicas del dispositivo de la línea coherentes con la versión de la extensión.</span><span class="sxs-lookup"><span data-stu-id="ad057-129">These include the line's device capabilities consistent with the API version and the line's device-specific capabilities consistent with the extension version.</span></span> <span data-ttu-id="ad057-130">La aplicación debe especificar ambos números de versión cuando abre una línea.</span><span class="sxs-lookup"><span data-stu-id="ad057-130">The application must specify both of these version numbers when it opens a line.</span></span> <span data-ttu-id="ad057-131">En ese momento, la aplicación, el archivo DLL y el proveedor de servicios se confirman con las versiones acordadas.</span><span class="sxs-lookup"><span data-stu-id="ad057-131">At that point, the application, the DLL, and the service provider are committed to using the agreed-upon versions.</span></span> <span data-ttu-id="ad057-132">Si no se van a usar extensiones específicas del dispositivo, la versión de la extensión debe especificarse como cero.</span><span class="sxs-lookup"><span data-stu-id="ad057-132">If device-specific extensions are not to be used, the extension version should be specified as zero.</span></span>

<span data-ttu-id="ad057-133">En un entorno en el que varias aplicaciones abran el mismo dispositivo de línea, la primera aplicación que abra el dispositivo de línea selecciona las versiones de todas las aplicaciones futuras que deseen usar la línea (los proveedores de servicios no admiten varias versiones simultáneamente). Del mismo modo, una aplicación que abra varios dispositivos de línea puede encontrar más fácil el funcionamiento de todos los dispositivos de línea con el mismo número de versión de la API.</span><span class="sxs-lookup"><span data-stu-id="ad057-133">In an environment where multiple applications open the same line device, the first application to open the line device selects the versions for all future applications that want to use the line (service providers do not support multiple versions simultaneously.) Similarly, an application that opens multiple line devices may find it easier to operate all line devices under the same API version number.</span></span>

<span data-ttu-id="ad057-134">Cada función que toma un parámetro *dwAPIVersion* o similar debe establecer este parámetro en la versión de API más alta admitida por la aplicación o en la versión de API negociada mediante la función [**lineNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion) o [**phoneNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-phonenegotiateapiversion) en un dispositivo determinado.</span><span class="sxs-lookup"><span data-stu-id="ad057-134">Every function that takes a *dwAPIVersion* or similar parameter must set this parameter to either the highest API version supported by the application or the API version negotiated using the [**lineNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion) or [**phoneNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-phonenegotiateapiversion) function on a particular device.</span></span> <span data-ttu-id="ad057-135">Use la siguiente tabla como guía:</span><span class="sxs-lookup"><span data-stu-id="ad057-135">Use the following table as a guide:</span></span>



| <span data-ttu-id="ad057-136">Función</span><span class="sxs-lookup"><span data-stu-id="ad057-136">Function</span></span>                                                     | <span data-ttu-id="ad057-137">Significado</span><span class="sxs-lookup"><span data-stu-id="ad057-137">Meaning</span></span>                                                                               |
|--------------------------------------------------------------|---------------------------------------------------------------------------------------|
| [<span data-ttu-id="ad057-138">**lineGetAddressCaps**</span><span class="sxs-lookup"><span data-stu-id="ad057-138">**lineGetAddressCaps**</span></span>](/windows/desktop/api/Tapi/nf-tapi-linegetaddresscaps)             | <span data-ttu-id="ad057-139">Use la versión devuelta por [**lineNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion).</span><span class="sxs-lookup"><span data-stu-id="ad057-139">Use version returned by [**lineNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion).</span></span>   |
| [<span data-ttu-id="ad057-140">**lineGetCountry**</span><span class="sxs-lookup"><span data-stu-id="ad057-140">**lineGetCountry**</span></span>](/windows/desktop/api/Tapi/nf-tapi-linegetcountry)                     | <span data-ttu-id="ad057-141">Use la versión más reciente admitida por la aplicación.</span><span class="sxs-lookup"><span data-stu-id="ad057-141">Use highest version supported by the application.</span></span>                                     |
| [<span data-ttu-id="ad057-142">**lineGetDevCaps**</span><span class="sxs-lookup"><span data-stu-id="ad057-142">**lineGetDevCaps**</span></span>](/windows/desktop/api/Tapi/nf-tapi-linegetdevcaps)                     | <span data-ttu-id="ad057-143">Use la versión devuelta por [**lineNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion).</span><span class="sxs-lookup"><span data-stu-id="ad057-143">Use version returned by [**lineNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion).</span></span>   |
| [<span data-ttu-id="ad057-144">**lineGetProviderList**</span><span class="sxs-lookup"><span data-stu-id="ad057-144">**lineGetProviderList**</span></span>](/windows/desktop/api/Tapi/nf-tapi-linegetproviderlist)           | <span data-ttu-id="ad057-145">Use la versión más reciente admitida por la aplicación.</span><span class="sxs-lookup"><span data-stu-id="ad057-145">Use highest version supported by the application.</span></span>                                     |
| [<span data-ttu-id="ad057-146">**lineGetTranslateCaps**</span><span class="sxs-lookup"><span data-stu-id="ad057-146">**lineGetTranslateCaps**</span></span>](/windows/desktop/api/Tapi/nf-tapi-linegettranslatecaps)         | <span data-ttu-id="ad057-147">Use la versión más reciente admitida por la aplicación.</span><span class="sxs-lookup"><span data-stu-id="ad057-147">Use highest version supported by the application.</span></span>                                     |
| [<span data-ttu-id="ad057-148">**lineNegotiateAPIVersion**</span><span class="sxs-lookup"><span data-stu-id="ad057-148">**lineNegotiateAPIVersion**</span></span>](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion)   | <span data-ttu-id="ad057-149">Use la versión más reciente admitida por la aplicación.</span><span class="sxs-lookup"><span data-stu-id="ad057-149">Use highest version supported by the application.</span></span>                                     |
| [<span data-ttu-id="ad057-150">**lineNegotiateExtVersion**</span><span class="sxs-lookup"><span data-stu-id="ad057-150">**lineNegotiateExtVersion**</span></span>](/windows/desktop/api/Tapi/nf-tapi-linenegotiateextversion)   | <span data-ttu-id="ad057-151">Use la versión devuelta por [**lineNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion).</span><span class="sxs-lookup"><span data-stu-id="ad057-151">Use version returned by [**lineNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion).</span></span>   |
| [<span data-ttu-id="ad057-152">**lineOpen**</span><span class="sxs-lookup"><span data-stu-id="ad057-152">**lineOpen**</span></span>](/windows/desktop/api/Tapi/nf-tapi-lineopen)                                 | <span data-ttu-id="ad057-153">Use la versión devuelta por [**lineNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion).</span><span class="sxs-lookup"><span data-stu-id="ad057-153">Use version returned by [**lineNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-linenegotiateapiversion).</span></span>   |
| [<span data-ttu-id="ad057-154">**lineTranslateAddress**</span><span class="sxs-lookup"><span data-stu-id="ad057-154">**lineTranslateAddress**</span></span>](/windows/desktop/api/Tapi/nf-tapi-linetranslateaddress)         | <span data-ttu-id="ad057-155">Use la versión más reciente admitida por la aplicación.</span><span class="sxs-lookup"><span data-stu-id="ad057-155">Use highest version supported by the application.</span></span>                                     |
| [<span data-ttu-id="ad057-156">**lineTranslateDialog**</span><span class="sxs-lookup"><span data-stu-id="ad057-156">**lineTranslateDialog**</span></span>](/windows/desktop/api/Tapi/nf-tapi-linetranslatedialog)           | <span data-ttu-id="ad057-157">Use la versión más reciente admitida por la aplicación.</span><span class="sxs-lookup"><span data-stu-id="ad057-157">Use highest version supported by the application.</span></span>                                     |
| [<span data-ttu-id="ad057-158">**phoneGetDevCaps**</span><span class="sxs-lookup"><span data-stu-id="ad057-158">**phoneGetDevCaps**</span></span>](/windows/desktop/api/Tapi/nf-tapi-phonegetdevcaps)                   | <span data-ttu-id="ad057-159">Use la versión devuelta por [**phoneNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-phonenegotiateapiversion).</span><span class="sxs-lookup"><span data-stu-id="ad057-159">Use version returned by [**phoneNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-phonenegotiateapiversion).</span></span> |
| [<span data-ttu-id="ad057-160">**phoneNegotiateAPIVersion**</span><span class="sxs-lookup"><span data-stu-id="ad057-160">**phoneNegotiateAPIVersion**</span></span>](/windows/desktop/api/Tapi/nf-tapi-phonenegotiateapiversion) | <span data-ttu-id="ad057-161">Use la versión más reciente admitida por la aplicación.</span><span class="sxs-lookup"><span data-stu-id="ad057-161">Use highest version supported by the application.</span></span>                                     |
| [<span data-ttu-id="ad057-162">**phoneNegotiateExtVersion**</span><span class="sxs-lookup"><span data-stu-id="ad057-162">**phoneNegotiateExtVersion**</span></span>](/windows/desktop/api/Tapi/nf-tapi-phonenegotiateextversion) | <span data-ttu-id="ad057-163">Use la versión devuelta por [**phoneNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-phonenegotiateapiversion).</span><span class="sxs-lookup"><span data-stu-id="ad057-163">Use version returned by [**phoneNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-phonenegotiateapiversion).</span></span> |
| [<span data-ttu-id="ad057-164">**phoneOpen**</span><span class="sxs-lookup"><span data-stu-id="ad057-164">**phoneOpen**</span></span>](/windows/desktop/api/Tapi/nf-tapi-phoneopen)                               | <span data-ttu-id="ad057-165">Use la versión devuelta por [**phoneNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-phonenegotiateapiversion).</span><span class="sxs-lookup"><span data-stu-id="ad057-165">Use version returned by [**phoneNegotiateAPIVersion**](/windows/desktop/api/Tapi/nf-tapi-phonenegotiateapiversion).</span></span> |



 

> [!IMPORTANT]
> <span data-ttu-id="ad057-166">Al negociar una versión de API, establezca siempre los números de versión alta y baja en el intervalo de versiones que pueda admitir la aplicación.</span><span class="sxs-lookup"><span data-stu-id="ad057-166">When negotiating an API version, always set the high and low version numbers to the range of versions that your application can support.</span></span> <span data-ttu-id="ad057-167">Por ejemplo, nunca use 0x00000000 para la versión baja o 0xFFFFFFFF para el alto, ya que estos valores requieren que la aplicación admita todas las versiones de TAPI, tanto en el pasado como en el futuro.</span><span class="sxs-lookup"><span data-stu-id="ad057-167">For example, never use 0x00000000 for the low version or 0xFFFFFFFF for the high because these values require that your application support all versions of TAPI, both past and future.</span></span>

 

 

 



