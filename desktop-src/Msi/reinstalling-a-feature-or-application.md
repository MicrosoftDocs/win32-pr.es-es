---
description: Windows Installer puede reparar, reemplazar y comprobar los archivos contenidos en una aplicación. Es posible que sea necesaria una reinstalación parcial o completa de la aplicación si faltan archivos o entradas del registro asociadas a alguna característica o están dañados.
ms.assetid: fab23ab9-f1ab-4743-b883-cffc29b0124b
title: Reinstalación de una característica o aplicación
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 645f7dbf95204d96202c71a120eafb6e6e054ac6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104156460"
---
# <a name="reinstalling-a-feature-or-application"></a><span data-ttu-id="6db11-104">Reinstalación de una característica o aplicación</span><span class="sxs-lookup"><span data-stu-id="6db11-104">Reinstalling a Feature or Application</span></span>

<span data-ttu-id="6db11-105">Windows Installer puede reparar, reemplazar y comprobar los archivos contenidos en una aplicación.</span><span class="sxs-lookup"><span data-stu-id="6db11-105">Windows Installer can repair, replace, and verify files contained in an application.</span></span> <span data-ttu-id="6db11-106">Es posible que sea necesaria una reinstalación parcial o completa de la aplicación si faltan archivos o entradas del registro asociadas a alguna característica o están dañados.</span><span class="sxs-lookup"><span data-stu-id="6db11-106">A partial or complete application reinstallation might be required if any files or registry entries associated with any feature are missing or corrupt.</span></span>

<span data-ttu-id="6db11-107">Cuando se vuelve a instalar una característica o aplicación, se reinstalan también todos los servicios, las variables de entorno y las acciones personalizadas que pertenecen a la característica o aplicación.</span><span class="sxs-lookup"><span data-stu-id="6db11-107">When a feature or application is reinstalled, all the services, environment variables, and custom actions belonging to the feature or application are reinstalled as well.</span></span> <span data-ttu-id="6db11-108">Tenga en cuenta que esto significa que se perderán los cambios realizados en las variables de entorno entre la instalación original y la reinstalación.</span><span class="sxs-lookup"><span data-stu-id="6db11-108">Note that this means that any changes made to environment variables between the original installation and the reinstallation are lost.</span></span>

<span data-ttu-id="6db11-109">La lista siguiente contiene métodos para reinstalar una característica o un producto.</span><span class="sxs-lookup"><span data-stu-id="6db11-109">The following list contains methods of reinstalling a feature or product.</span></span> <span data-ttu-id="6db11-110">El instalador ha automatizado los dos primeros métodos:</span><span class="sxs-lookup"><span data-stu-id="6db11-110">The first two methods have been automated by the installer:</span></span>

-   <span data-ttu-id="6db11-111">Reparar, reemplazar o comprobar archivos mediante una llamada a la función [**MsiReinstallFeature**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea) .</span><span class="sxs-lookup"><span data-stu-id="6db11-111">Repair, replace, or verify files by calling the [**MsiReinstallFeature**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea) function.</span></span>
-   <span data-ttu-id="6db11-112">Vuelva a instalar todo el producto mediante una llamada a la función [**MsiReinstallProduct**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta) .</span><span class="sxs-lookup"><span data-stu-id="6db11-112">Reinstall the entire product by calling the [**MsiReinstallProduct**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta) function.</span></span>
-   <span data-ttu-id="6db11-113">Reinstale, reemplace o Compruebe los archivos con un botón de control de IU del instalador a través de la [reinstalación de ControlEvent,](reinstall-controlevent.md).</span><span class="sxs-lookup"><span data-stu-id="6db11-113">Reinstall, replace, or verify files with an installer UI control button through the [Reinstall ControlEvent](reinstall-controlevent.md).</span></span>
-   <span data-ttu-id="6db11-114">Reinstale, reemplace o Compruebe los archivos desde una línea de comandos. para ello, establezca la propiedad [**REINSTALL**](reinstall.md) y la propiedad [**REINSTALLMODE**](reinstallmode.md) .</span><span class="sxs-lookup"><span data-stu-id="6db11-114">Reinstall, replace, or verify files from a command line by setting the [**REINSTALL**](reinstall.md) property and the [**REINSTALLMODE**](reinstallmode.md) property.</span></span>

<span data-ttu-id="6db11-115">Para obtener más información sobre la reinstalación de una característica o aplicación, consulte [resistencia](resiliency.md).</span><span class="sxs-lookup"><span data-stu-id="6db11-115">For more information on reinstalling a feature or application, see [Resiliency](resiliency.md).</span></span>

<span data-ttu-id="6db11-116">**Para reinstalar un producto mediante el instalador**</span><span class="sxs-lookup"><span data-stu-id="6db11-116">**To reinstall a product using the installer**</span></span>

-   <span data-ttu-id="6db11-117">Llame a [**MsiReinstallProduct**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta).</span><span class="sxs-lookup"><span data-stu-id="6db11-117">Call [**MsiReinstallProduct**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta).</span></span>

<span data-ttu-id="6db11-118">**Para reinstalar una característica mediante el instalador**</span><span class="sxs-lookup"><span data-stu-id="6db11-118">**To reinstall a feature using the installer**</span></span>

-   <span data-ttu-id="6db11-119">Llame a [**MsiReinstallFeature**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea).</span><span class="sxs-lookup"><span data-stu-id="6db11-119">Call [**MsiReinstallFeature**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea).</span></span>

<span data-ttu-id="6db11-120">**Para reinstalar un producto o característica con una interfaz de usuario del instalador**</span><span class="sxs-lookup"><span data-stu-id="6db11-120">**To reinstall a product or feature with an installer user interface**</span></span>

1.  <span data-ttu-id="6db11-121">Agregar un botón al cuadro de diálogo especificado mediante la adición de una entrada a la [tabla de control](control-table.md).</span><span class="sxs-lookup"><span data-stu-id="6db11-121">Add a button to the specified dialog box by adding an entry to the [Control table](control-table.md).</span></span>
2.  <span data-ttu-id="6db11-122">Agregue un [ReinstallMode ControlEvent,](reinstallmode-controlevent.md) a la tabla ControlEvent,, con los campos de cuadro de diálogo \_ y control que \_ hacen referencia al control de botón creado en el paso 1.</span><span class="sxs-lookup"><span data-stu-id="6db11-122">Add a [ReinstallMode ControlEvent](reinstallmode-controlevent.md) to the ControlEvent table, with the Dialog\_ and Control\_ fields referencing the button control created in step 1.</span></span> <span data-ttu-id="6db11-123">En el campo argumento, escriba una cadena que contenga las letras correspondientes a los modos de reinstalación que desee (los valores aceptables para este campo son idénticos a los aceptados para la propiedad [**REINSTALLMODE**](reinstallmode.md) ).</span><span class="sxs-lookup"><span data-stu-id="6db11-123">In the Argument field, enter a string containing the letters corresponding to the reinstall modes you want (the acceptable values for this field are identical to those accepted for the [**REINSTALLMODE**](reinstallmode.md) property).</span></span> <span data-ttu-id="6db11-124">El valor de la columna de ordenación de este evento debe ser 1.</span><span class="sxs-lookup"><span data-stu-id="6db11-124">The value in the Ordering column for this event should be 1.</span></span>
3.  <span data-ttu-id="6db11-125">Agregue un evento [REINSTALL ControlEvent,](reinstall-controlevent.md) a la [tabla ControlEvent,](controlevent-table.md), de nuevo haciendo referencia al mismo control de botón.</span><span class="sxs-lookup"><span data-stu-id="6db11-125">Add a [Reinstall ControlEvent](reinstall-controlevent.md) event to the [ControlEvent table](controlevent-table.md), again referencing the same button control.</span></span> <span data-ttu-id="6db11-126">El campo de argumento de este evento será normalmente todos, para forzar la reinstalación de todas las características, pero puede colocar el nombre de una característica específica aquí.</span><span class="sxs-lookup"><span data-stu-id="6db11-126">The Argument field for this event will normally be ALL, to force reinstallation of all features, but you can place the name of a specific feature here.</span></span> <span data-ttu-id="6db11-127">El valor de la columna de ordenación de este evento debe ser 2.</span><span class="sxs-lookup"><span data-stu-id="6db11-127">The value in the Ordering column for this event should be 2.</span></span>
4.  <span data-ttu-id="6db11-128">Agregue un evento más asociado al mismo control de botón para iniciar realmente la reinstalación.</span><span class="sxs-lookup"><span data-stu-id="6db11-128">Add one more event tied to the same button control, to actually initiate the reinstallation.</span></span> <span data-ttu-id="6db11-129">Puede ser un evento EndDialog (con un argumento de Return).</span><span class="sxs-lookup"><span data-stu-id="6db11-129">This can be an EndDialog event (with an argument of Return).</span></span> <span data-ttu-id="6db11-130">No obstante, lo más habitual es que se use aquí un evento NewDialog para saltar a un. **¿está seguro de que desea reinstalar?** cuadro de diálogo de confirmación.</span><span class="sxs-lookup"><span data-stu-id="6db11-130">More typically, however, a NewDialog event would be used here to jump to an **Are you sure you want to reinstall?** confirmation dialog box.</span></span> <span data-ttu-id="6db11-131">El valor de la columna de ordenación de este evento debe ser 3.</span><span class="sxs-lookup"><span data-stu-id="6db11-131">The value in the Ordering column for this event should be 3.</span></span>

    <span data-ttu-id="6db11-132">Si lo desea, se pueden crear varios botones de [**reinstalación**](reinstall.md) para un único cuadro de diálogo, lo que permite al usuario seleccionar el tipo de reinstalación realizado.</span><span class="sxs-lookup"><span data-stu-id="6db11-132">If desired, several [**REINSTALL**](reinstall.md) buttons can be created for a single dialog box, allowing the user to select the type of reinstallation performed.</span></span> <span data-ttu-id="6db11-133">En este caso, cada botón se crea como se describe en el procedimiento anterior, con un parámetro [ReinstallMode ControlEvent,](reinstallmode-controlevent.md) diferente para cada botón.</span><span class="sxs-lookup"><span data-stu-id="6db11-133">In this case, each button is authored as outlined in the preceding procedure, with a different [ReinstallMode ControlEvent](reinstallmode-controlevent.md) parameter for each button.</span></span>

<span data-ttu-id="6db11-134">Una vez que se ha instalado un determinado producto (con algunas o todas las características del producto), se puede realizar una reinstalación en la línea de comandos:</span><span class="sxs-lookup"><span data-stu-id="6db11-134">Once a particular product has been installed (with some or all of the product's features), a reinstallation can be performed at the command line:</span></span>

<span data-ttu-id="6db11-135">**Para reinstalar un producto o característica desde una línea de comandos**</span><span class="sxs-lookup"><span data-stu-id="6db11-135">**To reinstall a product or feature from a command line**</span></span>

1.  <span data-ttu-id="6db11-136">En el símbolo del sistema, especifique la propiedad [**REINSTALL**](reinstall.md) .</span><span class="sxs-lookup"><span data-stu-id="6db11-136">From the command prompt, specify the [**REINSTALL**](reinstall.md) property.</span></span>
2.  <span data-ttu-id="6db11-137">En el símbolo del sistema, especifique la propiedad [**REINSTALLMODE**](reinstallmode.md) .</span><span class="sxs-lookup"><span data-stu-id="6db11-137">From the command prompt, specify the [**REINSTALLMODE**](reinstallmode.md) property.</span></span>

    <span data-ttu-id="6db11-138">Si se especifican estas propiedades, el usuario podrá volver a instalar todas las características del producto o todas ellas.</span><span class="sxs-lookup"><span data-stu-id="6db11-138">Specifying these properties allows the user to reinstall any or all of the product's features.</span></span> <span data-ttu-id="6db11-139">También se puede especificar el tipo de reinstalación.</span><span class="sxs-lookup"><span data-stu-id="6db11-139">The type of reinstallation can also be specified.</span></span> <span data-ttu-id="6db11-140">Por ejemplo, puede especificar que solo se deben volver a instalar los archivos que faltan por completo, o que solo los archivos dañados (por ejemplo, cualquier archivo ejecutable cuya suma de comprobación no coincida con el contenido real del archivo) se reemplacen.</span><span class="sxs-lookup"><span data-stu-id="6db11-140">For example, you can specify that only those files that are completely missing should be reinstalled, or that only corrupt files (for example, any executable file whose checksum does not match the actual file contents) be replaced.</span></span>

 

 



