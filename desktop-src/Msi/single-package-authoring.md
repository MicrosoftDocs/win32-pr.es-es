---
description: Un paquete de uso doble es un paquete Windows Installer 5,0 que se ha creado para ser capaz de instalar una aplicación en el contexto de instalación por usuario o por equipo.
ms.assetid: b2da9fba-8fdf-48fa-a662-6b3eee1bfe87
title: Creación de un solo paquete
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 87c22b9be930be2d2178ea4efb7ba1538320823a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "105678145"
---
# <a name="single-package-authoring"></a>Creación de un solo paquete

Un paquete de uso doble es un paquete Windows Installer 5,0 que se ha creado para ser capaz de instalar una aplicación en el [contexto de instalación](installation-context.md)por usuario o por equipo. Los programadores de configuración que usan un paquete de uso doble para su aplicación pueden proporcionar a sus usuarios una selección de contexto de instalación en el momento de la instalación y pueden quitar las solicitudes de credenciales de UAC de las instalaciones por usuario en Windows 7 o Windows Server 2008 R2. El desarrollo de un paquete de doble Windows Installer 5,0 para la instalación en Windows 7 y Windows Server 2008 R2 se denomina creación de un solo paquete.

Puede empezar a desarrollar paquetes de doble finalidad para Windows 7 y Windows Server 2008 R2 mediante Windows Installer 5,0, la propiedad [**MSIINSTALLPERUSER**](msiinstallperuser.md) , la propiedad [**AllUsers**](allusers.md) y las carpetas conocidas y los registros del [Shell de Windows](/previous-versions/windows/desktop/legacy/bb773177(v=vs.85)). Cuando Windows Installer 5,0 instala un paquete de uso dual en el contexto por usuario en Windows 7 o Windows Server 2008 R2, el instalador dirige las entradas del registro y de archivos a las ubicaciones por usuario y no muestra las solicitudes de UAC para las credenciales. Cuando Windows Installer 5,0 instala un paquete de uso dual en el contexto por equipo, el instalador dirige los archivos y las entradas del registro a las ubicaciones por equipo y solicita las credenciales de UAC para confirmar que el usuario tiene privilegios suficientes para instalar software para todos los usuarios del equipo. Una vez Windows Installer 5,0 instala una aplicación, utiliza el mismo contexto de instalación para todas las actualizaciones, reparaciones o desinstalación posteriores de la aplicación.

**[Windows Installer 4,5 o anterior](not-supported-in-windows-installer-4-5.md):** no se admiten la propiedad [**MSIINSTALLPERUSER**](msiinstallperuser.md) y las versiones por usuario de las carpetas a las que hacen referencia las propiedades [**ProgramFilesFolder**](programfilesfolder.md), [**CommonFilesFolder**](commonfilesfolder.md), [**ProgramFiles64Folder**](programfiles64folder.md)y [**CommonFiles64Folder**](commonfiles64folder.md) . Las carpetas **FOLDERID \_ UserProgramFiles** y **FOLDERID \_ UserProgramFilesCommon** están disponibles a partir de Windows 7 y Windows Server 2008 R2. Esto significa que las instalaciones desarrolladas para Windows Installer 4,5 o anteriores archivos directos y entradas del registro a FOLDERID \_ ProgramFiles, FOLDERID \_ PROGRAMFILESCOMMON, FOLDERID \_ ProgramFilesX64 y FOLDERID \_ ProgramFilesCommonX64. Dado que se trata de ubicaciones a las que pueden acceder otros usuarios del equipo, Windows Vista y los sistemas posteriores requieren que se muestren las credenciales de UAC.

Cuando un usuario instala un paquete de doble propósito creado para Windows Installer 5,0 con Windows Installer 4,5 o anterior, el instalador omite la propiedad [**MSIINSTALLPERUSER**](msiinstallperuser.md) . En este caso, la instalación puede dirigir archivos y entradas del registro a ubicaciones a las que pueden acceder otros usuarios y requerir que el sistema muestre solicitudes de UAC para las credenciales. Windows Installer 5,0 puede instalar un paquete que se desarrolló para Windows Installer 4,5 o anterior, sin embargo, la instalación dirige los archivos y las entradas del registro a ubicaciones accesibles para otros usuarios y requiere que el sistema muestre los mensajes de UAC para las credenciales.

## <a name="development-guidelines"></a>Instrucciones de desarrollo

Siga las instrucciones de creación de un único paquete para asegurarse de que el paquete se puede instalar en el contexto por usuario o por equipo. Siga estas instrucciones para permitir al usuario elegir en el momento de la instalación una instalación por usuario o por equipo y para quitar las solicitudes de UAC de las instalaciones por usuario.

-   La instalación por usuario requiere Windows Installer 5,0 en Windows 7 o Windows Server 2008 R2. Debe informar al usuario de que el paquete admite la instalación por equipo de la aplicación en versiones anteriores del sistema.
-   Inicialice los valores de las propiedades [**AllUsers**](allusers.md) y [**MSIINSTALLPERUSER**](msiinstallperuser.md) en la [tabla de propiedades](property-table.md) de su paquete de uso doble. Use el valor de **AllUsers** 2 y un valor de **MSIINSTALLPERUSER** de 1 como los valores iniciales. Esto especifica la instalación por usuario como la predeterminada para el paquete de doble propósito.
-   Considere la posibilidad de crear un cuadro de diálogo para la [interfaz de usuario](user-interface.md) del paquete de doble propósito que permite al usuario elegir el contexto en el momento de la instalación. Cree los controles en este cuadro de diálogo personalizado para establecer los valores de las propiedades [**AllUsers**](allusers.md) y [**MSIINSTALLPERUSER**](msiinstallperuser.md) . En el caso del valor de **AllUsers** de 2, establezca **MSIINSTALLPERUSER** en un valor de 1 para especificar una instalación por usuario y establezca **MSIINSTALLPERUSER** en una cadena vacía ("") para especificar una instalación por equipo. Los usuarios también pueden establecer **AllUsers** y **MSIINSTALLPERUSER** en la línea de comandos si instalan el paquete desde la línea de comandos.
-   Validar el paquete mediante [evaluadores de coherencia internos (CIEM)](internal-consistency-evaluators-ices.md). El paquete debe ser capaz de pasar la validación por [ICE105](ice-105.md) para que sea un paquete de uso dual válido.
-   Use la tabla [del registro](registry-table.md) y la [tabla RemoveRegistry](removeregistry-table.md) para redirigir las entradas del registro a las partes por usuario del registro durante las instalaciones por usuario. En una instalación por usuario, las entradas del registro que tienen-1 en la columna raíz se redirigen al **\_ \_ usuario actual de HKEY** y, en una instalación por equipo, se dirigen a **HKEY \_ local \_ Machine**. En una instalación por usuario, las entradas del registro que tienen msidbRegistryRootClassesRoot (0) en la columna raíz se redirigen a  \\  \\ **las clases** de software HKCU y, en una instalación por equipo, se dirigen a \\  \\ **las clases** de software HKLM.
-   Use la propiedad [**ProgramFilesFolder**](programfilesfolder.md) en la [tabla de directorios](directory-table.md) de paquetes de Windows Installer de [32 bits](32-bit-windows-installer-packages.md) para especificar las ubicaciones de los directorios que contienen componentes de 32 bits que no se comparten entre las aplicaciones. Cuando un usuario instala el paquete de uso doble mediante el contexto por equipo, estos componentes se guardan en la carpeta archivos de programa de las versiones de 32 bits de Windows y en la carpeta archivos de programa (x86) de las versiones de 64 bits del sistema. Todos los usuarios pueden tener acceso a los componentes de estos directorios. Cuando un usuario instala el paquete de doble propósito en Windows 7 o Windows Server 2008 R2 con el contexto por usuario, estos componentes se guardan en la carpeta programas del usuario actual (por ejemplo, en% LocalAppData% \\ Programs) y solo ese usuario puede tener acceso a ellos.
-   Use la propiedad [**CommonFilesFolder**](commonfilesfolder.md) de la [tabla de directorios](directory-table.md) de paquetes de Windows Installer de [32 bits](32-bit-windows-installer-packages.md) para especificar las ubicaciones de los directorios que contienen componentes de 32 bits compartidos entre aplicaciones. Cuando un usuario instala el paquete de uso doble mediante el contexto por equipo, estos componentes se guardan en la carpeta Archivos comunes y todos los usuarios pueden tener acceso a ellos. Cuando un usuario instala el paquete de doble propósito en Windows 7 o Windows Server 2008 R2 con el contexto por usuario, estos componentes se guardan en la carpeta común del usuario actual (por ejemplo, en% LocalAppData% \\ Programs \\ Common) y solo ese usuario puede tener acceso a él.
-   Use la propiedad [**ProgramFiles64Folder**](programfiles64folder.md) de la [tabla de directorios](directory-table.md) de paquetes de Windows Installer de [64 bits](64-bit-windows-installer-packages.md) para especificar las ubicaciones de los directorios que contienen componentes de 64 bits que no se comparten entre las aplicaciones. Cuando un usuario instala el paquete de uso doble mediante el contexto por equipo, estos componentes se guardan en la carpeta archivos de programa. Todos los usuarios pueden tener acceso a los componentes de estos directorios. Cuando un usuario instala el paquete de doble propósito en Windows 7 o Windows Server 2008 R2 con el contexto por usuario, estos componentes se guardan en la carpeta programas del usuario actual (por ejemplo, en% LocalAppData% \\ Programs) y solo ese usuario puede tener acceso a ellos. Para obtener más información acerca de la creación de un paquete para instalar una aplicación en sistemas operativos de 64 bits, consulte [Windows Installer en sistemas operativos de 64](windows-installer-on-64-bit-operating-systems.md)bits.
-   Use la propiedad [**CommonFiles64Folder**](commonfiles64folder.md) de la [tabla de directorios](directory-table.md) de paquetes de Windows Installer de [64 bits](64-bit-windows-installer-packages.md) para especificar las ubicaciones de los directorios que contienen componentes de 64 bits compartidos entre aplicaciones. Cuando un usuario instala el paquete de uso doble mediante el contexto por equipo, estos componentes se guardan en la carpeta Archivos comunes y todos los usuarios pueden tener acceso a ellos. Cuando un usuario instala el paquete de doble propósito en Windows 7 o Windows Server 2008 R2 con el contexto por usuario, estos componentes se guardan en la carpeta común del usuario actual (por ejemplo, en% LocalAppData% \\ Programs \\ Common) y solo ese usuario puede tener acceso a él.
-   Use las propiedades [**ProgramFilesFolder**](programfilesfolder.md) y [**CommonFilesFolder**](commonfilesfolder.md) en la [tabla de directorios](directory-table.md) de paquetes de Windows Installer de [64 bits](64-bit-windows-installer-packages.md) para especificar la ubicación de los directorios que contienen componentes de 32 bits. Use nombres diferentes para las versiones de 32 bits y 64 bits de los componentes proporcionados con el mismo nombre, o bien Guarde las versiones en distintas carpetas. Por ejemplo, agregue información a la tabla del directorio para especificar la ubicación del directorio que contiene la versión de 32 bits como el nombre de la aplicación de nombre de \[ \] \\ *proveedor de ISV* de \\  \\ Program64FilesFolder x86 y la ubicación del directorio que contiene la versión de 64 bits como nombre de la aplicación nombre de \[ ISV de \] \\  \\  \\ x64. Después, una instalación por equipo guarda la versión de 32 bits en el nombre de la aplicación del nombre del ISV de archivos de programa (x86) \\  \\  \\ y guarda la versión de 64 bits en el nombre de la aplicación nombre del ISV de archivos de programa \\  \\  \\ x64. Una instalación por usuario guarda la versión de 32 bits en% LocalAppData% Programs nombre de ISV nombre de \\ \\  \\ *aplicación* \\ x86 e instala la versión de 64 bits en% LocalAppData% programas nombre de proveedor de ISV nombre de \\ \\  \\ *aplicación* \\ .
-   Almacene los datos de configuración de cada usuario para la aplicación en \\ usuarios nombre de usuario \\  \\ appdata.
-   Almacene las plantillas y los archivos generados por la aplicación en subcarpetas en \\ users \\ *username*.
-   Si su aplicación usa extensiones de Shell, debe usar los puntos de [extensibilidad de Shell](https://msdn.microsoft.com/library/bb762762.aspx) compatibles con el usuario que están disponibles a partir de Windows 7 o windows Server 2008 R2.
-   No use acciones personalizadas en el paquete que requieran privilegios elevados para ejecutarse. La tabla [CustomAction](customaction-table.md) no debe contener acciones personalizadas que se hayan marcado para ejecutarse con privilegios elevados. Para obtener más información sobre las acciones personalizadas elevadas, vea seguridad de la [acción personalizada](custom-action-security.md).
-   No escriba en ninguna carpeta global del sistema. La tabla del [directorio](directory-table.md) no debe contener una referencia a ninguna de las siguientes propiedades de la carpeta del sistema.

    <dl>

[**AdminToolsFolder**](admintoolsfolder.md)  
    [**CommonAppDataFolder**](commonappdatafolder.md)  
    [**FontsFolder**](fontsfolder.md)  
    [**System16Folder**](system16folder.md)  
    [**System64Folder**](system64folder.md)  
    [**Carpetadelsistema**](systemfolder.md)  
    [**TempFolder**](tempfolder.md)  
    [**WindowsFolder**](windowsfolder.md)  
    [**WindowsVolume**](windowsvolume.md)  
    </dl>

-   No instale un ensamblado de Common Language Runtime en la caché de ensamblados global (GAC). Para obtener más información sobre cómo instalar ensamblados en la caché global de ensamblados, vea [Agregar ensamblados a un paquete](adding-assemblies-to-a-package.md) e [Instalar ensamblados de Common Language Runtime](installation-of-common-language-runtime-assemblies.md).
-   No instale ningún origen de datos ODBC. No utilice la tabla [ODBCDataSource](odbcdatasource-table.md) para instalar un origen de datos.
-   No instale ningún servicio. No use la tabla [ServiceInstall](serviceinstall-table.md) para instalar un servicio.

## <a name="example"></a>Ejemplo

Un ejemplo de un paquete de doble propósito se proporciona en los [componentes de Windows SDK para Windows Installer desarrolladores](platform-sdk-components-for-windows-installer-developers.md) como PUASample1.msi de archivos. Si tiene el SDK actual, tiene acceso a todas las herramientas y los datos necesarios para reproducir el paquete de instalación de ejemplo. Para obtener más información sobre este ejemplo, vea [ejemplo de creación de un solo paquete](single-package-authoring-example.md).

 

 
