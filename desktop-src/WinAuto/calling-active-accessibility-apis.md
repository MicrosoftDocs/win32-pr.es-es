---
title: Llamar a Active Accessibility API
description: Microsoft Active Accessibility proporciona interfaces de programación de aplicaciones (API) para clientes y servidores.
ms.assetid: c40441d2-7294-4c76-8b42-08ed66eccb7e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 209a239495fddbcaf2275f095abc889295568b3c
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104077895"
---
# <a name="calling-active-accessibility-apis"></a><span data-ttu-id="89a1f-103">Llamar a Active Accessibility API</span><span class="sxs-lookup"><span data-stu-id="89a1f-103">Calling Active Accessibility APIs</span></span>

<span data-ttu-id="89a1f-104">Microsoft Active Accessibility proporciona interfaces de programación de aplicaciones (API) para clientes y servidores.</span><span class="sxs-lookup"><span data-stu-id="89a1f-104">Microsoft Active Accessibility provides application programming interfaces (APIs) for both clients and servers.</span></span> <span data-ttu-id="89a1f-105">La mayoría se implementan en la biblioteca de vínculos dinámicos de Microsoft Active Accessibility, Oleacc.dll, pero [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent), [**SetWinEventHook**](/windows/desktop/api/Winuser/nf-winuser-setwineventhook)y [**UnhookWinEvent**](/windows/desktop/api/Winuser/nf-winuser-unhookwinevent) se implementan en user32.dll, que es un componente básico del sistema operativo Microsoft Windows.</span><span class="sxs-lookup"><span data-stu-id="89a1f-105">Most are implemented in the Microsoft Active Accessibility dynamic-link library, Oleacc.dll, but [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent), [**SetWinEventHook**](/windows/desktop/api/Winuser/nf-winuser-setwineventhook), and [**UnhookWinEvent**](/windows/desktop/api/Winuser/nf-winuser-unhookwinevent) are implemented in user32.dll, which is a core component of the Microsoft Windows operating system.</span></span>

<span data-ttu-id="89a1f-106">Los equipos que ejecutan Windows 95 o Microsoft Windows NT 4,0 no tienen Oleacc.dll y la versión correcta de user32.dll instalado porque Microsoft Active Accessibility se incorporó en fases de las versiones correctas de Windows.</span><span class="sxs-lookup"><span data-stu-id="89a1f-106">Computers running Windows 95 or Microsoft Windows NT 4.0 do not have Oleacc.dll and the correct version of user32.dll installed because Microsoft Active Accessibility was incorporated in stages into succeeding versions of Windows.</span></span> <span data-ttu-id="89a1f-107">Como resultado, las aplicaciones que se ejecutan en estas plataformas se vinculan explícitamente a Oleacc.dll en tiempo de ejecución mediante la función [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) en lugar de depender de las bibliotecas de importación.</span><span class="sxs-lookup"><span data-stu-id="89a1f-107">As a result, applications that run on these platforms explicitly link to Oleacc.dll at run time using the [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) function instead of relying on import libraries.</span></span> <span data-ttu-id="89a1f-108">Active Accessibility 1,3 admite Windows 95 y Microsoft Windows NT 4,0.</span><span class="sxs-lookup"><span data-stu-id="89a1f-108">Active Accessibility 1.3 supports Windows 95 and Microsoft Windows NT 4.0.</span></span> <span data-ttu-id="89a1f-109">Microsoft Active Accessibility no admite versiones anteriores de Windows.</span><span class="sxs-lookup"><span data-stu-id="89a1f-109">Earlier versions of Windows are not supported by Microsoft Active Accessibility.</span></span>

<span data-ttu-id="89a1f-110">Las aplicaciones de servidor usan la función [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) para recuperar la dirección de una función de Microsoft Active Accessibility y, a continuación, realizan la llamada a través de un puntero a función.</span><span class="sxs-lookup"><span data-stu-id="89a1f-110">Server applications use the [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) function to retrieve the address of an Microsoft Active Accessibility function and then make the call through a function pointer.</span></span> <span data-ttu-id="89a1f-111">Si se llama a una función que se implementó en Oleacc.dll, las aplicaciones de servidor usan el identificador devuelto por [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) en la llamada a **GetProcAddress**.</span><span class="sxs-lookup"><span data-stu-id="89a1f-111">If calling a function that was implemented in Oleacc.dll, server applications use the handle returned from [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) in the call to **GetProcAddress**.</span></span> <span data-ttu-id="89a1f-112">Si se llama a una función definida en user32.dll, las aplicaciones de servidor llaman a [**GetModuleHandle**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulehandlea) especificando "user32" y usan el identificador de módulo devuelto en la llamada a **GetProcAddress**.</span><span class="sxs-lookup"><span data-stu-id="89a1f-112">If calling a function defined in user32.dll, server applications call [**GetModuleHandle**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulehandlea) specifying "USER32" and use the returned module handle in the call to **GetProcAddress**.</span></span>

<span data-ttu-id="89a1f-113">Por ejemplo, si una aplicación usa [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent), llama a [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) mediante el identificador de módulo de user32.dll para obtener la dirección de la función.</span><span class="sxs-lookup"><span data-stu-id="89a1f-113">For example, if an application uses [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent), it calls [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) using the module handle of user32.dll to get the address of the function.</span></span> <span data-ttu-id="89a1f-114">Si la llamada es correcta (lo que significa que esta versión de Windows es compatible con Microsoft Active Accessibility), la aplicación establece una marca que indica que es seguro llamar a **NotifyWinEvent**.</span><span class="sxs-lookup"><span data-stu-id="89a1f-114">If the call is successful (meaning that this version of Windows supports Microsoft Active Accessibility), then the application sets a flag that indicates that it is safe to call **NotifyWinEvent**.</span></span> <span data-ttu-id="89a1f-115">La dirección recibida de **GetProcAddress** se almacena en una variable de puntero de función y se usa en todo el código.</span><span class="sxs-lookup"><span data-stu-id="89a1f-115">The address received from **GetProcAddress** is stored in a function pointer variable and used throughout the code.</span></span>

 

 