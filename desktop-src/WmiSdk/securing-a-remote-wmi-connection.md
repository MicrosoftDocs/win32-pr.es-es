---
description: Para conectarse a un equipo remoto mediante WMI, asegúrese de que la configuración DCOM correcta y la configuración de seguridad del espacio de nombres WMI están habilitadas para la conexión.
ms.assetid: 96ebaa9b-a062-4300-a637-8eb71cb80d1c
ms.tgt_platform: multiple
title: Protección de una conexión WMI remota
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: df2a044e49fed5eaa27fbc246dca3306a6c29650
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104544686"
---
# <a name="securing-a-remote-wmi-connection"></a><span data-ttu-id="3a14d-103">Protección de una conexión WMI remota</span><span class="sxs-lookup"><span data-stu-id="3a14d-103">Securing a Remote WMI Connection</span></span>

<span data-ttu-id="3a14d-104">Para conectarse a un equipo remoto mediante WMI, asegúrese de que la configuración DCOM correcta y la configuración de seguridad del espacio de nombres WMI están habilitadas para la conexión.</span><span class="sxs-lookup"><span data-stu-id="3a14d-104">To connect to a remote computer using WMI, ensure that the correct DCOM settings and WMI namespace security settings are enabled for the connection.</span></span>

<span data-ttu-id="3a14d-105">WMI tiene una configuración predeterminada de suplantación, autenticación y servicio de autenticación (NTLM o Kerberos) que requiere el equipo de destino en una conexión remota.</span><span class="sxs-lookup"><span data-stu-id="3a14d-105">WMI has default impersonation, authentication, and authentication service (NTLM or Kerberos) settings that the target computer in a remote connection requires.</span></span> <span data-ttu-id="3a14d-106">El equipo local puede usar valores predeterminados diferentes que el sistema de destino no acepta.</span><span class="sxs-lookup"><span data-stu-id="3a14d-106">Your local machine may use different defaults that the target system does not accept.</span></span> <span data-ttu-id="3a14d-107">Puede cambiar esta configuración en la llamada de conexión.</span><span class="sxs-lookup"><span data-stu-id="3a14d-107">You can change these settings in the connection call.</span></span>

<span data-ttu-id="3a14d-108">En este tema se describen las siguientes secciones:</span><span class="sxs-lookup"><span data-stu-id="3a14d-108">The following sections are discussed in this topic:</span></span>

-   [<span data-ttu-id="3a14d-109">Configuración de suplantación y autenticación de DCOM para WMI</span><span class="sxs-lookup"><span data-stu-id="3a14d-109">DCOM Impersonation and Authentication Settings for WMI</span></span>](#dcom-impersonation-and-authentication-settings-for-wmi)
-   [<span data-ttu-id="3a14d-110">Configuración de la seguridad de DCOM para permitir que un usuario tenga acceso a un equipo de forma remota</span><span class="sxs-lookup"><span data-stu-id="3a14d-110">Setting DCOM Security to Allow a User to Access a Computer Remotely</span></span>](#setting-dcom-security-to-allow-a-user-to-access-a-computer-remotely)
-   [<span data-ttu-id="3a14d-111">Permitir el acceso de los usuarios a un espacio de nombres WMI específico</span><span class="sxs-lookup"><span data-stu-id="3a14d-111">Allowing Users Access to a Specific WMI Namespace</span></span>](#allowing-users-access-to-a-specific-wmi-namespace)
-   [<span data-ttu-id="3a14d-112">Establecer la seguridad del espacio de nombres para requerir el cifrado de datos para las conexiones remotas</span><span class="sxs-lookup"><span data-stu-id="3a14d-112">Setting Namespace Security to Require Data Encryption for Remote Connections</span></span>](#setting-namespace-security-to-require-data-encryption-for-remote-connections)
-   [<span data-ttu-id="3a14d-113">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="3a14d-113">Related topics</span></span>](#related-topics)

## <a name="dcom-impersonation-and-authentication-settings-for-wmi"></a><span data-ttu-id="3a14d-114">Configuración de suplantación y autenticación de DCOM para WMI</span><span class="sxs-lookup"><span data-stu-id="3a14d-114">DCOM Impersonation and Authentication Settings for WMI</span></span>

<span data-ttu-id="3a14d-115">WMI tiene la configuración predeterminada de suplantación, autenticación y servicio de autenticación de DCOM (NTLM o Kerberos) que requiere el sistema remoto.</span><span class="sxs-lookup"><span data-stu-id="3a14d-115">WMI has default DCOM impersonation, authentication, and authentication service (NTLM or Kerberos) settings that the a remote system requires.</span></span> <span data-ttu-id="3a14d-116">El sistema local puede usar valores predeterminados diferentes que el sistema remoto de destino no acepta.</span><span class="sxs-lookup"><span data-stu-id="3a14d-116">Your local system may use different defaults that the target remote system does not accept.</span></span> <span data-ttu-id="3a14d-117">Puede cambiar esta configuración en la llamada de conexión.</span><span class="sxs-lookup"><span data-stu-id="3a14d-117">You can change these settings in the connection call.</span></span> <span data-ttu-id="3a14d-118">Para obtener más información, vea [establecer la seguridad del proceso de aplicación cliente](setting-client-application-process-security.md).</span><span class="sxs-lookup"><span data-stu-id="3a14d-118">For more information, see [Setting Client Application Process Security](setting-client-application-process-security.md).</span></span> <span data-ttu-id="3a14d-119">Sin embargo, para el servicio de autenticación, se recomienda especificar el **\_ \_ \_ valor predeterminado de autenticación de RPC C** y permitir que DCOM elija el servicio adecuado para el equipo de destino.</span><span class="sxs-lookup"><span data-stu-id="3a14d-119">However, for the authentication service, it is recommended that you specify **RPC\_C\_AUTHN\_DEFAULT** and allow DCOM to choose the appropriate service for the target computer.</span></span>

<span data-ttu-id="3a14d-120">Puede proporcionar valores de configuración en los parámetros de las llamadas a [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) o [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket) en C++.</span><span class="sxs-lookup"><span data-stu-id="3a14d-120">You can supply settings in parameters for the calls to [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) or [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket) in C++.</span></span> <span data-ttu-id="3a14d-121">En scripts, puede establecer la configuración de seguridad en las llamadas a [**SWbemLocator. ConnectServer**](swbemlocator-connectserver.md), en un objeto [**SWbemSecurity**](swbemsecurity.md) o en la cadena de [moniker](constructing-a-moniker-string.md) de scripting.</span><span class="sxs-lookup"><span data-stu-id="3a14d-121">In scripts, you can establish security settings in calls to [**SWbemLocator.ConnectServer**](swbemlocator-connectserver.md), in an [**SWbemSecurity**](swbemsecurity.md) object, or in the scripting [moniker](constructing-a-moniker-string.md) string.</span></span>

<span data-ttu-id="3a14d-122">Para obtener una lista de todas las constantes de suplantación de C++, vea [establecer el nivel de seguridad de proceso predeterminado mediante C++](setting-the-default-process-security-level-using-c-.md).</span><span class="sxs-lookup"><span data-stu-id="3a14d-122">For a list of all the C++ impersonation constants, see [Setting the Default Process Security Level Using C++](setting-the-default-process-security-level-using-c-.md).</span></span> <span data-ttu-id="3a14d-123">Para obtener las constantes de Visual Basic y las cadenas de scripting para usar la conexión de moniker, vea [establecer el nivel de seguridad de proceso predeterminado con VBScript](setting-the-default-process-security-level-using-vbscript.md).</span><span class="sxs-lookup"><span data-stu-id="3a14d-123">For the Visual Basic constants and scripting strings for using the moniker connection, see [Setting the Default Process Security Level Using VBScript](setting-the-default-process-security-level-using-vbscript.md).</span></span>

<span data-ttu-id="3a14d-124">En la tabla siguiente se enumeran los valores predeterminados de suplantación, autenticación y servicio de autenticación de DCOM requeridos por el equipo de destino (equipo B) en una conexión remota.</span><span class="sxs-lookup"><span data-stu-id="3a14d-124">The following table lists the default DCOM impersonation, authentication, and authentication service settings required by the target computer (Computer B) in a remote connection.</span></span> <span data-ttu-id="3a14d-125">Para obtener más información, consulte protección de una conexión WMI remota.</span><span class="sxs-lookup"><span data-stu-id="3a14d-125">For more information, see Securing a Remote WMI Connection.</span></span>



| <span data-ttu-id="3a14d-126">Sistema operativo del equipo B</span><span class="sxs-lookup"><span data-stu-id="3a14d-126">Computer B operating system</span></span> | <span data-ttu-id="3a14d-127">Cadena de scripting del nivel de suplantación</span><span class="sxs-lookup"><span data-stu-id="3a14d-127">Impersonation level scripting string</span></span> | <span data-ttu-id="3a14d-128">Cadena de scripting de nivel de autenticación</span><span class="sxs-lookup"><span data-stu-id="3a14d-128">Authentication level scripting string</span></span> | <span data-ttu-id="3a14d-129">Servicio de autenticación</span><span class="sxs-lookup"><span data-stu-id="3a14d-129">Authentication service</span></span> |
|-----------------------------|--------------------------------------|---------------------------------------|------------------------|
| <span data-ttu-id="3a14d-130">Windows Vista o posterior</span><span class="sxs-lookup"><span data-stu-id="3a14d-130">Windows Vista or later</span></span>      | <span data-ttu-id="3a14d-131">Impersonate</span><span class="sxs-lookup"><span data-stu-id="3a14d-131">Impersonate</span></span>                          | <span data-ttu-id="3a14d-132">PKT</span><span class="sxs-lookup"><span data-stu-id="3a14d-132">Pkt</span></span>                                   | <span data-ttu-id="3a14d-133">Kerberos</span><span class="sxs-lookup"><span data-stu-id="3a14d-133">Kerberos</span></span>               |



 

<span data-ttu-id="3a14d-134">Las conexiones remotas WMI se ven afectadas por el [control de cuentas de usuario (UAC)](/previous-versions/aa905108(v=msdn.10)) y el [firewall de Windows](https://www.microsoft.com/technet/itsolutions/network/wf/default.mspx).</span><span class="sxs-lookup"><span data-stu-id="3a14d-134">WMI remote connections are affected by [User Account Control (UAC)](/previous-versions/aa905108(v=msdn.10)) and [Windows Firewall](https://www.microsoft.com/technet/itsolutions/network/wf/default.mspx).</span></span> <span data-ttu-id="3a14d-135">Para obtener más información, vea [conectarse a WMI de forma remota a partir de vista](connecting-to-wmi-remotely-starting-with-vista.md) y [conectarse a través de Firewall de Windows](/windows/desktop/WmiSdk/connecting-to-wmi-remotely-starting-with-vista).</span><span class="sxs-lookup"><span data-stu-id="3a14d-135">For more information, see [Connecting to WMI Remotely Starting with Vista](connecting-to-wmi-remotely-starting-with-vista.md) and [Connecting Through Windows Firewall](/windows/desktop/WmiSdk/connecting-to-wmi-remotely-starting-with-vista).</span></span>

<span data-ttu-id="3a14d-136">Tenga en cuenta que la conexión a WMI en el equipo local tiene un nivel de autenticación predeterminado de **PktPrivacy**.</span><span class="sxs-lookup"><span data-stu-id="3a14d-136">Be aware that connecting to WMI on the local computer has a default authentication level of **PktPrivacy**.</span></span>

## <a name="setting-dcom-security-to-allow-a-user-to-access-a-computer-remotely"></a><span data-ttu-id="3a14d-137">Configuración de la seguridad de DCOM para permitir que un usuario tenga acceso a un equipo de forma remota</span><span class="sxs-lookup"><span data-stu-id="3a14d-137">Setting DCOM Security to Allow a User to Access a Computer Remotely</span></span>

<span data-ttu-id="3a14d-138">La seguridad en WMI está relacionada con la conexión a un espacio de nombres WMI.</span><span class="sxs-lookup"><span data-stu-id="3a14d-138">Security in WMI is related to connecting to a WMI namespace.</span></span> <span data-ttu-id="3a14d-139">WMI utiliza DCOM para controlar llamadas remotas.</span><span class="sxs-lookup"><span data-stu-id="3a14d-139">WMI uses DCOM to handle remote calls.</span></span> <span data-ttu-id="3a14d-140">Una razón para que no se pueda conectar a un equipo remoto se debe a un error de DCOM (error "acceso a DCOM denegado" decimal-2147024891 o Hex 0x80070005).</span><span class="sxs-lookup"><span data-stu-id="3a14d-140">One reason for failure to connect to a remote computer is due to a DCOM failure (error "DCOM Access Denied" decimal -2147024891 or hex 0x80070005).</span></span> <span data-ttu-id="3a14d-141">Para obtener más información sobre la seguridad de DCOM en WMI para aplicaciones de C++, vea [establecer la seguridad de procesos de aplicación cliente](setting-client-application-process-security.md).</span><span class="sxs-lookup"><span data-stu-id="3a14d-141">For more information about DCOM security in WMI for C++ applications, see [Setting Client Application Process Security](setting-client-application-process-security.md).</span></span>

<span data-ttu-id="3a14d-142">Puede configurar DCOM para WMI mediante la utilidad de configuración DCOM (**DCOMCnfg.exe**) que se encuentra en **herramientas administrativas** del **Panel de control**.</span><span class="sxs-lookup"><span data-stu-id="3a14d-142">You can configure DCOM settings for WMI using the DCOM Config utility (**DCOMCnfg.exe**) found in **Administrative Tools** in **Control Panel**.</span></span> <span data-ttu-id="3a14d-143">Esta utilidad expone la configuración que permite a determinados usuarios conectarse al equipo de forma remota a través de DCOM.</span><span class="sxs-lookup"><span data-stu-id="3a14d-143">This utility exposes the settings that enable certain users to connect to the computer remotely through DCOM.</span></span> <span data-ttu-id="3a14d-144">Los miembros del grupo administradores pueden conectarse remotamente al equipo de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="3a14d-144">Members of the Administrators group are allowed to remotely connect to the computer by default.</span></span> <span data-ttu-id="3a14d-145">Con esta utilidad puede establecer la seguridad para iniciar, tener acceso y configurar el servicio WMI.</span><span class="sxs-lookup"><span data-stu-id="3a14d-145">With this utility you can set the security to start, access, and configure the WMI service.</span></span>

<span data-ttu-id="3a14d-146">En el procedimiento siguiente se describe cómo conceder permisos de inicio remoto y activación de DCOM para determinados usuarios y grupos.</span><span class="sxs-lookup"><span data-stu-id="3a14d-146">The following procedure describes how to grant DCOM remote startup and activation permissions for certain users and groups.</span></span> <span data-ttu-id="3a14d-147">Si el equipo A se conecta de forma remota al equipo B, puede establecer estos permisos en el equipo B para permitir que un usuario o grupo que no forma parte del grupo administradores del equipo B ejecute llamadas de inicio y activación de DCOM en el equipo B.</span><span class="sxs-lookup"><span data-stu-id="3a14d-147">If Computer A is connecting remotely to Computer B, you can set these permissions on Computer B to allow a user or group that is not part of the Administrators group on Computer B to execute DCOM startup and activation calls on Computer B.</span></span>

<span data-ttu-id="3a14d-148">**Para conceder permisos de inicio y activación remotos de DCOM para un usuario o grupo**</span><span class="sxs-lookup"><span data-stu-id="3a14d-148">**To grant DCOM remote launch and activation permissions for a user or group**</span></span>

1.  <span data-ttu-id="3a14d-149">Haga clic en **Inicio**, haga clic en **Ejecutar**, escriba **dcomcnfg** y, a continuación, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="3a14d-149">Click **Start**, click **Run**, type **DCOMCNFG**, and then click **OK**.</span></span>
2.  <span data-ttu-id="3a14d-150">En el cuadro de diálogo **servicios de componentes** , expanda **servicios de componentes**, expanda **equipos** y, a continuación, haga clic con el botón secundario en **mi PC** y haga clic en **propiedades**.</span><span class="sxs-lookup"><span data-stu-id="3a14d-150">In the **Component Services** dialog box, expand **Component Services**, expand **Computers**, and then right-click **My Computer** and click **Properties**.</span></span>
3.  <span data-ttu-id="3a14d-151">En el cuadro de diálogo **propiedades de mi PC** , haga clic en la pestaña **seguridad com** .</span><span class="sxs-lookup"><span data-stu-id="3a14d-151">In the **My Computer Properties** dialog box, click the **COM Security** tab.</span></span>
4.  <span data-ttu-id="3a14d-152">En **Permisos de inicio y activación**, haga clic en **Editar límites**.</span><span class="sxs-lookup"><span data-stu-id="3a14d-152">Under **Launch and Activation Permissions**, click **Edit Limits**.</span></span>
5.  <span data-ttu-id="3a14d-153">En el cuadro de diálogo **permiso de inicio** , siga estos pasos si el nombre o el grupo no aparecen en la **lista nombres de grupos o usuarios**:</span><span class="sxs-lookup"><span data-stu-id="3a14d-153">In the **Launch Permission** dialog box, follow these steps if your name or your group does not appear in the **Groups or user names list**:</span></span>

    1.  <span data-ttu-id="3a14d-154">En el cuadro de diálogo **permiso de inicio** , haga clic en **Agregar**.</span><span class="sxs-lookup"><span data-stu-id="3a14d-154">In the **Launch Permission** dialog box, click **Add**.</span></span>
    2.  <span data-ttu-id="3a14d-155">En el cuadro de diálogo **Seleccionar usuarios, equipos o grupos** , agregue el nombre y el grupo en el cuadro **Escriba los nombres de objeto que desea seleccionar** y, a continuación, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="3a14d-155">In the **Select Users, Computers, or Groups** dialog box, add your name and the group in the **Enter the object names to select** box, and then click **OK**.</span></span>

6.  <span data-ttu-id="3a14d-156">En el cuadro de diálogo **permiso de inicio** , seleccione el usuario y el grupo en el cuadro **nombres de grupos o usuarios** .</span><span class="sxs-lookup"><span data-stu-id="3a14d-156">In the **Launch Permission** dialog box, select your user and group in the **Group or user names** box.</span></span> <span data-ttu-id="3a14d-157">En la columna **permitir** en **permisos para usuario**, seleccione **inicio remoto** y seleccione **activación remota** y, a continuación, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="3a14d-157">In the **Allow** column under **Permissions for User**, select **Remote Launch** and select **Remote Activation**, and then click **OK**.</span></span>

<span data-ttu-id="3a14d-158">En el procedimiento siguiente se describe cómo conceder permisos de acceso remoto DCOM para determinados usuarios y grupos.</span><span class="sxs-lookup"><span data-stu-id="3a14d-158">The following procedure describes how to grant DCOM remote access permissions for certain users and groups.</span></span> <span data-ttu-id="3a14d-159">Si el equipo A se conecta de forma remota al equipo B, puede establecer estos permisos en el equipo B para permitir que un usuario o grupo que no forma parte del grupo administradores del equipo B se conecte al equipo B.</span><span class="sxs-lookup"><span data-stu-id="3a14d-159">If Computer A is connecting remotely to Computer B, you can set these permissions on Computer B to allow a user or group that is not part of the Administrators group on Computer B to connect to Computer B.</span></span>

<span data-ttu-id="3a14d-160">**Para conceder permisos de acceso remoto DCOM**</span><span class="sxs-lookup"><span data-stu-id="3a14d-160">**To grant DCOM remote access permissions**</span></span>

1.  <span data-ttu-id="3a14d-161">Haga clic en **Inicio**, haga clic en **Ejecutar**, escriba **dcomcnfg** y, a continuación, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="3a14d-161">Click **Start**, click **Run**, type **DCOMCNFG**, and then click **OK**.</span></span>
2.  <span data-ttu-id="3a14d-162">En el cuadro de diálogo **servicios de componentes** , expanda **servicios de componentes**, expanda **equipos** y, a continuación, haga clic con el botón secundario en **mi PC** y haga clic en **propiedades**.</span><span class="sxs-lookup"><span data-stu-id="3a14d-162">In the **Component Services** dialog box, expand **Component Services**, expand **Computers**, and then right-click **My Computer** and click **Properties**.</span></span>
3.  <span data-ttu-id="3a14d-163">En el cuadro de diálogo **propiedades de mi PC** , haga clic en la pestaña **seguridad com** .</span><span class="sxs-lookup"><span data-stu-id="3a14d-163">In the **My Computer Properties** dialog box, click the **COM Security** tab.</span></span>
4.  <span data-ttu-id="3a14d-164">En **Permisos de acceso**, haga clic en **Editar límites**.</span><span class="sxs-lookup"><span data-stu-id="3a14d-164">Under **Access Permissions**, click **Edit Limits**.</span></span>
5.  <span data-ttu-id="3a14d-165">En el cuadro de diálogo **permiso de acceso** , seleccione nombre de **Inicio de sesión anónimo** en el cuadro **nombres de grupos o usuarios** .</span><span class="sxs-lookup"><span data-stu-id="3a14d-165">In the **Access Permission** dialog box, select **ANONYMOUS LOGON** name in the **Group or user names** box.</span></span> <span data-ttu-id="3a14d-166">En la columna **permitir** en **permisos de usuario**, seleccione **acceso remoto** y, a continuación, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="3a14d-166">In the **Allow** column under **Permissions for User**, select **Remote Access**, and then click **OK**.</span></span>

## <a name="allowing-users-access-to-a-specific-wmi-namespace"></a><span data-ttu-id="3a14d-167">Permitir el acceso de los usuarios a un espacio de nombres WMI específico</span><span class="sxs-lookup"><span data-stu-id="3a14d-167">Allowing Users Access to a Specific WMI Namespace</span></span>

<span data-ttu-id="3a14d-168">Puede permitir o impedir el acceso de los usuarios a un espacio de nombres WMI específico estableciendo el permiso "acceso remoto habilitado" en el control WMI para un espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="3a14d-168">You can allow or disallow users access to a specific WMI namespace by setting the "Remote Enable" permission in the WMI Control for a namespace.</span></span> <span data-ttu-id="3a14d-169">Si un usuario intenta conectarse a un espacio de nombres al que no se le permite el acceso, recibirá el error 0x80041003.</span><span class="sxs-lookup"><span data-stu-id="3a14d-169">If a user tries to connect to a namespace they are not allowed access to, they will receive error 0x80041003.</span></span> <span data-ttu-id="3a14d-170">De forma predeterminada, este permiso solo está habilitado para los administradores.</span><span class="sxs-lookup"><span data-stu-id="3a14d-170">By default, this permission is enabled only for administrators.</span></span> <span data-ttu-id="3a14d-171">Un administrador puede habilitar el acceso remoto a espacios de nombres WMI específicos para un usuario que no sea de administrador.</span><span class="sxs-lookup"><span data-stu-id="3a14d-171">An administrator can enable remote access to specific WMI namespaces for a nonadministrator user.</span></span>

<span data-ttu-id="3a14d-172">El siguiente procedimiento establece los permisos de habilitación remota para un usuario que no es administrador.</span><span class="sxs-lookup"><span data-stu-id="3a14d-172">The following procedure sets remote enable permissions for a non-administrator user.</span></span>

<span data-ttu-id="3a14d-173">**Para establecer permisos de habilitación remota**</span><span class="sxs-lookup"><span data-stu-id="3a14d-173">**To set remote enable permissions**</span></span>

1.  <span data-ttu-id="3a14d-174">Conéctese al equipo remoto mediante el control WMI.</span><span class="sxs-lookup"><span data-stu-id="3a14d-174">Connect to the remote computer using the WMI Control.</span></span>

    <span data-ttu-id="3a14d-175">Para obtener más información sobre el control WMI, vea [establecer la seguridad de los espacios de nombres con el control WMI](setting-namespace-security-with-the-wmi-control.md).</span><span class="sxs-lookup"><span data-stu-id="3a14d-175">For more information about the WMI Control, see [Setting Namespace Security with the WMI Control](setting-namespace-security-with-the-wmi-control.md).</span></span>

2.  <span data-ttu-id="3a14d-176">En la pestaña **seguridad** , seleccione el espacio de nombres y haga clic en **seguridad**.</span><span class="sxs-lookup"><span data-stu-id="3a14d-176">In the **Security** tab, select the namespace and click **Security**.</span></span>
3.  <span data-ttu-id="3a14d-177">Busque la cuenta adecuada y Active **Habilitar remoto** en la lista de **permisos** .</span><span class="sxs-lookup"><span data-stu-id="3a14d-177">Locate the appropriate account and check **Remote Enable** in the **Permissions** list.</span></span>

## <a name="setting-namespace-security-to-require-data-encryption-for-remote-connections"></a><span data-ttu-id="3a14d-178">Establecer la seguridad del espacio de nombres para requerir el cifrado de datos para las conexiones remotas</span><span class="sxs-lookup"><span data-stu-id="3a14d-178">Setting Namespace Security to Require Data Encryption for Remote Connections</span></span>

<span data-ttu-id="3a14d-179">Un administrador o un archivo MOF pueden configurar un espacio de nombres de WMI para que no se devuelvan datos a menos que se use la privacidad de paquetes (**\_ \_ \_ \_ \_ privacidad de nivel de autenticación de RPC C** o **PktPrivacy** como moniker en un script) en una conexión a ese espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="3a14d-179">An administrator or a MOF file can configure a WMI namespace so that no data is returned unless you use packet privacy (**RPC\_C\_AUTHN\_LEVEL\_PKT\_PRIVACY** or **PktPrivacy** as a moniker in a script) in a connection to that namespace.</span></span> <span data-ttu-id="3a14d-180">Esto garantiza que los datos se cifren a medida que atraviesan la red.</span><span class="sxs-lookup"><span data-stu-id="3a14d-180">This ensures that data is encrypted as it crosses the network.</span></span> <span data-ttu-id="3a14d-181">Si intenta establecer un nivel de autenticación inferior, recibirá un mensaje de acceso denegado.</span><span class="sxs-lookup"><span data-stu-id="3a14d-181">If you try to set a lower authentication level, you will get an access denied message.</span></span> <span data-ttu-id="3a14d-182">Para obtener más información, vea [requerir una conexión cifrada a un espacio de nombres](requiring-an-encrypted-connection-to-a-namespace.md).</span><span class="sxs-lookup"><span data-stu-id="3a14d-182">For more information, see [Requiring an Encrypted Connection to a Namespace](requiring-an-encrypted-connection-to-a-namespace.md).</span></span>

<span data-ttu-id="3a14d-183">En el ejemplo de código de VBScript siguiente se muestra cómo conectarse a un espacio de nombres cifrado mediante "pktPrivacy".</span><span class="sxs-lookup"><span data-stu-id="3a14d-183">The following VBScript code example shows how to connect to an encrypted namespace using "pktPrivacy".</span></span>


```VB
strComputer = "RemoteComputer"
Set objWMIService = GetObject("winmgmts:{impersonationLevel=impersonate,authenticationLevel=pktPrivacy}!\\" _
                              & strComputer & "\root\EncryptedNamespace")
```



## <a name="related-topics"></a><span data-ttu-id="3a14d-184">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="3a14d-184">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="3a14d-185">Delegación con WMI</span><span class="sxs-lookup"><span data-stu-id="3a14d-185">Delegating with WMI</span></span>](connecting-to-a-3rd-computer-delegation.md)
</dt> <dt>

[<span data-ttu-id="3a14d-186">Crear procesos de forma remota con WMI</span><span class="sxs-lookup"><span data-stu-id="3a14d-186">Creating Processes Remotely with WMI</span></span>](creating-processes-remotely.md)
</dt> <dt>

[<span data-ttu-id="3a14d-187">Protección de clientes y proveedores de C++</span><span class="sxs-lookup"><span data-stu-id="3a14d-187">Securing C++ Clients and Providers</span></span>](securing-c---clients-and-providers.md)
</dt> <dt>

[<span data-ttu-id="3a14d-188">Protección de los clientes de scripting</span><span class="sxs-lookup"><span data-stu-id="3a14d-188">Securing Scripting Clients</span></span>](securing-scripting-clients.md)
</dt> </dl>

 

 
