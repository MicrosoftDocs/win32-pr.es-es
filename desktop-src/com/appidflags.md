---
title: AppIDFlags
description: Un conjunto de marcas que controlan el comportamiento de activación de un servidor COM.
ms.assetid: ab98e7d3-85c6-4328-84c4-1d4583df69ce
keywords:
- Valor del registro AppIDFlags COM
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cdad2b80625d6a60460d43f242d7897e0ae7eb40
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/21/2020
ms.locfileid: "105714481"
---
# <a name="appidflags"></a><span data-ttu-id="d3ff4-104">AppIDFlags</span><span class="sxs-lookup"><span data-stu-id="d3ff4-104">AppIDFlags</span></span>

<span data-ttu-id="d3ff4-105">Un conjunto de marcas que controlan el comportamiento de activación de un servidor COM.</span><span class="sxs-lookup"><span data-stu-id="d3ff4-105">A set of flags that control the activation behavior of a COM server.</span></span>

## <a name="registry-entry"></a><span data-ttu-id="d3ff4-106">Entrada del Registro</span><span class="sxs-lookup"><span data-stu-id="d3ff4-106">Registry Entry</span></span>

```
HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AppID
   {AppID_GUID}
      AppIDFlags = flags
```

## <a name="remarks"></a><span data-ttu-id="d3ff4-107">Observaciones</span><span class="sxs-lookup"><span data-stu-id="d3ff4-107">Remarks</span></span>

<span data-ttu-id="d3ff4-108">Se trata de un valor de **Registro \_ DWORD** .</span><span class="sxs-lookup"><span data-stu-id="d3ff4-108">This is a **REG\_DWORD** value.</span></span>



| <span data-ttu-id="d3ff4-109">Valor de marca</span><span class="sxs-lookup"><span data-stu-id="d3ff4-109">Flag Value</span></span> | <span data-ttu-id="d3ff4-110">Constante</span><span class="sxs-lookup"><span data-stu-id="d3ff4-110">Constant</span></span>                                              |
|------------|-------------------------------------------------------|
| <span data-ttu-id="d3ff4-111">0x1</span><span class="sxs-lookup"><span data-stu-id="d3ff4-111">0x1</span></span>        | <span data-ttu-id="d3ff4-112">APPIDREGFLAGS \_ activar \_ IUSERVER \_ indesktop</span><span class="sxs-lookup"><span data-stu-id="d3ff4-112">APPIDREGFLAGS\_ACTIVATE\_IUSERVER\_INDESKTOP</span></span>          |
| <span data-ttu-id="d3ff4-113">0x2</span><span class="sxs-lookup"><span data-stu-id="d3ff4-113">0x2</span></span>        | <span data-ttu-id="d3ff4-114">APPIDREGFLAGS \_ \_ \_ de proceso de servidor seguro \_ SD \_ y \_ BIND</span><span class="sxs-lookup"><span data-stu-id="d3ff4-114">APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND</span></span> |
| <span data-ttu-id="d3ff4-115">0x4</span><span class="sxs-lookup"><span data-stu-id="d3ff4-115">0x4</span></span>        | <span data-ttu-id="d3ff4-116">APPIDREGFLAGS \_ emitir \_ \_ RPC \_ de activación a la \_ identificación</span><span class="sxs-lookup"><span data-stu-id="d3ff4-116">APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY</span></span>   |



 

### <a name="appidregflags_activate_iuserver_indesktop-description"></a><span data-ttu-id="d3ff4-117">APPIDREGFLAGS \_ activar \_ la \_ Descripción de indesktop de IUSERVER</span><span class="sxs-lookup"><span data-stu-id="d3ff4-117">APPIDREGFLAGS\_ACTIVATE\_IUSERVER\_INDESKTOP Description</span></span>

<span data-ttu-id="d3ff4-118">Si la marca **APPIDREGFLAGS \_ Activar IUSERVER de \_ \_ escritorio** está desactivada en **AppIDFlags** o si **AppIDFlags** no está presente, el cliente de una sesión de Terminal Server que realiza una solicitud de activación para un servidor com de [usuario interactivo](interactive-user.md) enlazará o iniciará el servidor com en el escritorio "predeterminado" de la [estación de ventana](/windows/desktop/winstation/window-stations) "winsta0" de la sesión en la solicitud de activación.</span><span class="sxs-lookup"><span data-stu-id="d3ff4-118">If the **APPIDREGFLAGS\_ACTIVATE\_IUSERVER\_INDESKTOP** flag is cleared in **AppIDFlags** or if **AppIDFlags** is not present, the client in a terminal server session making an activation request for an [Interactive User](interactive-user.md) COM server, will either bind to, or launch and bind to, the COM server in the "default" desktop of the "winsta0" [window station](/windows/desktop/winstation/window-stations) of the session in the activation request.</span></span> <span data-ttu-id="d3ff4-119">Por ejemplo, si el cliente ejecuta "winsta0 \\ desktop1" de la sesión 3, la solicitud de activación de la sesión 3 enlazará o iniciará el servidor com en "winsta0 \\ default" de la sesión 3, aunque ya se esté ejecutando una instancia del servidor com en "winsta0 \\ desktop1" de la sesión 3.</span><span class="sxs-lookup"><span data-stu-id="d3ff4-119">For example, if the client is running "winsta0\\desktop1" of session 3, the activation request for session 3 will either bind to, or launch and bind to, the COM server in "winsta0\\default" of session 3, even if an instance of the COM server is already running in "winsta0\\desktop1" of session 3.</span></span>

<span data-ttu-id="d3ff4-120">Si la marca **APPIDREGFLAGS \_ Activar IUSERVER de \_ \_ escritorio** está establecida en el valor **AppIDFlags** , com se enlazará con el proceso de servidor que se ejecuta en el escritorio del cliente, o se iniciará y enlazará con él, y la sesión en la solicitud de activación.</span><span class="sxs-lookup"><span data-stu-id="d3ff4-120">If the **APPIDREGFLAGS\_ACTIVATE\_IUSERVER\_INDESKTOP** flag is set in the **AppIDFlags** value, COM will either bind to, or launch and bind to, the server process running in the client's desktop and the session in the activation request.</span></span> <span data-ttu-id="d3ff4-121">Por ejemplo, si el cliente ejecuta "winsta0 \\ desktop1" en la sesión 3, la solicitud de activación de la sesión 3 enlazará o iniciará el servidor com en "winsta0 \\ desktop1" en la sesión 3, incluso si ya se está ejecutando una instancia del servidor com en "winsta0 \\ default" en la sesión 3.</span><span class="sxs-lookup"><span data-stu-id="d3ff4-121">For example, if the client is running "winsta0\\desktop1" in session 3, the activation request for session 3 will either bind to, or launch and bind to, the COM server in "winsta0\\desktop1" in session 3, even if an instance of the COM server is already running in "winsta0\\default" in session 3.</span></span>

<span data-ttu-id="d3ff4-122">El cliente puede utilizar el [moniker](/windows/desktop/TermServ/session-monikers) de la sesión para especificar una sesión diferente a la sesión del cliente cuando realiza la solicitud de activación.</span><span class="sxs-lookup"><span data-stu-id="d3ff4-122">The client can use the [session moniker](/windows/desktop/TermServ/session-monikers) to specify a session different than the client's session when it makes the activation request.</span></span>

<span data-ttu-id="d3ff4-123">La marca **APPIDREGFLAGS \_ Activar IUSERVER de \_ \_ escritorio** solo se aplica a los servidores com que están configurados para runas "[usuario interactivo](interactive-user.md)".</span><span class="sxs-lookup"><span data-stu-id="d3ff4-123">The **APPIDREGFLAGS\_ACTIVATE\_IUSERVER\_INDESKTOP** flag applies only to COM servers that are configured to RunAs "[Interactive User](interactive-user.md)".</span></span>

### <a name="appidregflags_secure_server_process_sd_and_bind-description"></a><span data-ttu-id="d3ff4-124">\_ \_ \_ \_ \_ Descripción de enlace y SD de APPIDREGFLAGS Secure Server Process \_</span><span class="sxs-lookup"><span data-stu-id="d3ff4-124">APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND Description</span></span>

<span data-ttu-id="d3ff4-125">Si se establece la marca de **\_ \_ \_ \_ \_ \_ enlace y SD de APPIDREGFLAGS Secure Server Process** en **AppIDFlags**, los servidores com que estén configurados para runas "Activator" se iniciarán con un descriptor de seguridad de proceso que permita [procesar \_ todo el \_ acceso](/windows/desktop/ProcThread/process-security-and-access-rights) al SID de LogonID del token de proceso.</span><span class="sxs-lookup"><span data-stu-id="d3ff4-125">If the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is set in **AppIDFlags**, COM servers that are configured to RunAs "Activator" will be launched with a process security descriptor that allows [PROCESS\_ALL\_ACCESS](/windows/desktop/ProcThread/process-security-and-access-rights) to the LogonID SID of the process token.</span></span> <span data-ttu-id="d3ff4-126">Además, el propietario del descriptor de seguridad se establecerá en el SID de LogonID del token de proceso.</span><span class="sxs-lookup"><span data-stu-id="d3ff4-126">In addition, the owner of the security descriptor will be set to the LogonID SID of the process token.</span></span>

<span data-ttu-id="d3ff4-127">Si la marca de **\_ \_ \_ \_ \_ enlace SD and \_ BIND del proceso de servidor seguro APPIDREGFLAGS** se establece en **AppIDFlags**, los servidores com configurados para runas "este usuario" se iniciarán con un descriptor de seguridad de proceso que permita [procesar todo el \_ \_ acceso](/windows/desktop/ProcThread/process-security-and-access-rights) en el SID de LogonID del token de proceso.</span><span class="sxs-lookup"><span data-stu-id="d3ff4-127">If the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is set in **AppIDFlags**, COM servers that are configured to RunAs "This User" will be launched with a process security descriptor that allows [PROCESS\_ALL\_ACCESS](/windows/desktop/ProcThread/process-security-and-access-rights) in the LogonID SID of the process token.</span></span> <span data-ttu-id="d3ff4-128">Además, el propietario del descriptor de seguridad se establecerá en el SID de LogonID del token de proceso.</span><span class="sxs-lookup"><span data-stu-id="d3ff4-128">In addition, the owner of the security descriptor will be set to the LogonID SID of the process token.</span></span> <span data-ttu-id="d3ff4-129">Además, el administrador de control de servicios (SCM) COM modifica el token del proceso de servidor COM de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="d3ff4-129">Further, the COM Service Control Manager (SCM) modifies the token of the COM server process as follows:</span></span>

-   <span data-ttu-id="d3ff4-130">Agrega un SID de APPID al token.</span><span class="sxs-lookup"><span data-stu-id="d3ff4-130">It adds an APPID SID to the token.</span></span> <span data-ttu-id="d3ff4-131">Concede el acceso completo del SID de APPID en la lista de control de acceso discrecional (DACL) predeterminada del token.</span><span class="sxs-lookup"><span data-stu-id="d3ff4-131">It grants the APPID SID full access in the token default discretionary access control list (DACL).</span></span> <span data-ttu-id="d3ff4-132">En Windows Vista y versiones posteriores de Windows, concede el permiso OwnerRights SID READ \_ control en la DACL predeterminada del token.</span><span class="sxs-lookup"><span data-stu-id="d3ff4-132">In Windows Vista and later versions of Windows, it grants the OwnerRights SID READ\_CONTROL permission in the token default DACL.</span></span> <span data-ttu-id="d3ff4-133">En versiones anteriores a Windows Vista de Windows, establece el propietario del token en el SID de APPID.</span><span class="sxs-lookup"><span data-stu-id="d3ff4-133">In pre-Windows Vista versions of Windows, it sets the token owner to the APPID SID.</span></span>

<span data-ttu-id="d3ff4-134">Se deben tener en cuenta las siguientes consideraciones de seguridad al usar la marca de **\_ \_ \_ \_ \_ \_ enlace y SD de proceso de servidor seguro APPIDREGFLAGS** :</span><span class="sxs-lookup"><span data-stu-id="d3ff4-134">The following security considerations must be taken into account when using the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag:</span></span>

-   <span data-ttu-id="d3ff4-135">La marca de **\_ \_ \_ \_ \_ \_ enlace y SD de proceso de servidor seguro APPIDREGFLAGS** está pensada para que la establezcan los servidores com que se inician en uno de los contextos de seguridad de servicio integrados; las cuentas NetworkService o LocalService.</span><span class="sxs-lookup"><span data-stu-id="d3ff4-135">The **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is meant to be set by COM servers that are launched under one of the built-in service security contexts; either the NetworkService or the LocalService accounts.</span></span> <span data-ttu-id="d3ff4-136">Si los servidores suplantan a los clientes con privilegios y si no se establece la marca de **\_ \_ \_ \_ \_ \_ enlace y el procesamiento de servidor seguro APPIDREGFLAGS** , el código malintencionado que se ejecuta en otros procesos con el mismo contexto de seguridad puede elevar el privilegio mediante la apropiación de los tokens de suplantación de los clientes con privilegios del proceso de servidor com.</span><span class="sxs-lookup"><span data-stu-id="d3ff4-136">If the servers impersonate privileged clients and if the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is not set, malicious code running in other processes with the same security context can elevate privilege by hijacking the impersonation tokens of the privileged clients from the COM server process.</span></span>
-   <span data-ttu-id="d3ff4-137">Cuando se establece la marca de **\_ \_ \_ \_ \_ enlace SD and \_ BIND del proceso de servidor seguro APPIDREGFLAGS** , com protege el descriptor de seguridad del objeto de proceso en el caso de los servidores com "Activator" de runas.</span><span class="sxs-lookup"><span data-stu-id="d3ff4-137">When the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is set, COM hardens the security descriptor of the process object in the case of RunAs "Activator" COM servers.</span></span> <span data-ttu-id="d3ff4-138">Para estos servidores, se espera que el cliente COM proteja el token que usa para la activación COM.</span><span class="sxs-lookup"><span data-stu-id="d3ff4-138">For such servers, the COM client is expected to harden the token that it uses for the COM activation.</span></span>
-   <span data-ttu-id="d3ff4-139">Cuando se establece la marca de **\_ \_ \_ \_ \_ enlace SD and \_ BIND del proceso de servidor seguro APPIDREGFLAGS** , com protege el descriptor de seguridad del objeto de proceso en el caso de los servidores com "este usuario" de runas.</span><span class="sxs-lookup"><span data-stu-id="d3ff4-139">When the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is set, COM hardens the security descriptor of the process object in the case of RunAs "This User" COM servers.</span></span> <span data-ttu-id="d3ff4-140">También dificulta el token de proceso del servidor COM, ya que el SCM de COM es la entidad que crea el token.</span><span class="sxs-lookup"><span data-stu-id="d3ff4-140">It also hardens the process token of the COM server since the COM SCM is the entity that creates the token.</span></span>

<span data-ttu-id="d3ff4-141">La marca de **\_ \_ \_ \_ \_ \_ enlace y SD de proceso de servidor seguro APPIDREGFLAGS** se admite en Windows XP, Windows server 2003, Windows Vista y Windows Server 2008 solo cuando se aplica la revisión MSRC8322 ([boletín de seguridad MS09-012](https://support.microsoft.com/kb/959454)).</span><span class="sxs-lookup"><span data-stu-id="d3ff4-141">The **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is supported in Windows XP, Windows Server 2003, Windows Vista, and Windows Server 2008 only when the MSRC8322 patch ([security bulletin MS09-012](https://support.microsoft.com/kb/959454)) is applied.</span></span> <span data-ttu-id="d3ff4-142">Se admite de forma nativa en Windows 7 y versiones posteriores de Windows.</span><span class="sxs-lookup"><span data-stu-id="d3ff4-142">It is natively supported in Windows 7 and later versions of Windows.</span></span>

<span data-ttu-id="d3ff4-143">La marca **APPIDREGFLAGS \_ Secure \_ Server \_ Process \_ SD \_ and \_ BIND** solo se aplica a los servidores com que están configurados para runas "Activator" o "este usuario".</span><span class="sxs-lookup"><span data-stu-id="d3ff4-143">The **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag applies only to COM servers that are configured to RunAs "Activator" or "This User".</span></span> <span data-ttu-id="d3ff4-144">No se aplica a los servidores COM que son servicios NT.</span><span class="sxs-lookup"><span data-stu-id="d3ff4-144">It does not apply to COM servers that are NT services.</span></span>

### <a name="appidregflags_issue_activation_rpc_at_identify-description"></a><span data-ttu-id="d3ff4-145">APPIDREGFLAGS \_ problema \_ \_ de activación RPC \_ en la descripción de la \_ identificación</span><span class="sxs-lookup"><span data-stu-id="d3ff4-145">APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY Description</span></span>

<span data-ttu-id="d3ff4-146">Si la marca **APPIDREGFLAGS \_ Issue \_ Activation \_ RPC \_ at \_ Identify** está establecida en **AppIDFlags**, el SCM de com emitirá solicitudes de activación de objetos al proceso de servidor com mediante un nivel de suplantación de la [ \_ \_ \_ \_ identidad de nivel Imp de RPC C](impersonation-levels.md).</span><span class="sxs-lookup"><span data-stu-id="d3ff4-146">If the **APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY** flag is set in **AppIDFlags**, the COM SCM will issue object activation requests to the COM server process using an impersonation level of [RPC\_C\_IMP\_LEVEL\_IDENTIFY](impersonation-levels.md).</span></span>

<span data-ttu-id="d3ff4-147">Si no se establece la marca **APPIDREGFLAGS \_ Issue \_ Activation \_ RPC \_ at \_ Identify** , el SCM de com emitirá solicitudes de activación de objetos a los procesos de servidor com mediante un nivel de suplantación de la [ \_ \_ \_ \_ suplantación del nivel Imp de RPC C](impersonation-levels.md).</span><span class="sxs-lookup"><span data-stu-id="d3ff4-147">If the **APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY** flag is not set, the COM SCM will issue object activation requests to the COM server processes using an impersonation level of [RPC\_C\_IMP\_LEVEL\_IMPERSONATE](impersonation-levels.md).</span></span>

<span data-ttu-id="d3ff4-148">Se deben tener en cuenta las siguientes consideraciones de seguridad al usar el **RPC de activación de APPIDREGFLAGS issue en la marca \_ \_ \_ \_ de \_ identificación** :</span><span class="sxs-lookup"><span data-stu-id="d3ff4-148">The following security considerations must be taken into account when using the **APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY** flag:</span></span>

-   <span data-ttu-id="d3ff4-149">La **marca \_ \_ RPC de activación de APPIDREGFLAGS Issue \_ en la \_ \_ identificación** está pensada para que la usen los servidores com que no realizan el trabajo en nombre de los clientes en solicitudes de activación de objetos.</span><span class="sxs-lookup"><span data-stu-id="d3ff4-149">The **APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY** flag is meant to be used by COM servers that do not perform work on behalf of clients in object activation requests.</span></span> <span data-ttu-id="d3ff4-150">En el caso de estos servidores, tener el problema de COM SCM solicitudes de activación de objeto en el [ \_ nivel Imp de RPC C \_ \_ \_ identifica](impersonation-levels.md) las posibilidades de que los tokens con privilegios con el nivel de [**\_ suplantación \_ de se**](/windows/desktop/SecAuthZ/privilege-constants) muestren en el proceso.</span><span class="sxs-lookup"><span data-stu-id="d3ff4-150">For such servers, having the COM SCM issue object activation requests at [RPC\_C\_IMP\_LEVEL\_IDENTIFY](impersonation-levels.md) minimizes the chances of privileged tokens with [**SE\_IMPERSONATE\_NAME**](/windows/desktop/SecAuthZ/privilege-constants) level appearing in the process.</span></span>

<span data-ttu-id="d3ff4-151">Windows 7 y versiones posteriores de Windows admiten la marca **RPC de activación de APPIDREGFLAGS issue en la \_ \_ \_ \_ \_ identificación** .</span><span class="sxs-lookup"><span data-stu-id="d3ff4-151">The **APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY** flag is supported in Windows 7 and later versions of Windows.</span></span>

## <a name="related-topics"></a><span data-ttu-id="d3ff4-152">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="d3ff4-152">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d3ff4-153">Escritorios</span><span class="sxs-lookup"><span data-stu-id="d3ff4-153">Desktops</span></span>](/windows/desktop/winstation/desktops)
</dt> <dt>

[<span data-ttu-id="d3ff4-154">Niveles de suplantación</span><span class="sxs-lookup"><span data-stu-id="d3ff4-154">Impersonation Levels</span></span>](impersonation-levels.md)
</dt> <dt>

[<span data-ttu-id="d3ff4-155">Usuario interactivo</span><span class="sxs-lookup"><span data-stu-id="d3ff4-155">Interactive User</span></span>](interactive-user.md)
</dt> <dt>

[<span data-ttu-id="d3ff4-156">Monikers de sesión</span><span class="sxs-lookup"><span data-stu-id="d3ff4-156">Session Monikers</span></span>](/windows/desktop/TermServ/session-monikers)
</dt> <dt>

[<span data-ttu-id="d3ff4-157">Estaciones de ventana</span><span class="sxs-lookup"><span data-stu-id="d3ff4-157">Window Stations</span></span>](/windows/desktop/winstation/window-stations)
</dt> </dl>

 

 