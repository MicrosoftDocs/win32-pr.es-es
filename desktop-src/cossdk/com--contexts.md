---
description: En el caso de los componentes configurados que se ejecutan en aplicaciones COM+, los contextos son la base sobre la que se proporcionan los servicios COM+.
ms.assetid: 62a0bef2-c3c2-4a60-a5d1-6c038958e13e
title: Contextos COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5f0ae1228f89797f9124e817db07f11a23dbec12
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104423448"
---
# <a name="com-contexts"></a><span data-ttu-id="90e1f-103">Contextos COM+</span><span class="sxs-lookup"><span data-stu-id="90e1f-103">COM+ Contexts</span></span>

<span data-ttu-id="90e1f-104">En el caso de los componentes configurados que se ejecutan en aplicaciones COM+, los *contextos* son la base sobre la que se proporcionan los servicios com+.</span><span class="sxs-lookup"><span data-stu-id="90e1f-104">For configured components running within COM+ applications, *contexts* are the foundation on which COM+ services are provided.</span></span> <span data-ttu-id="90e1f-105">En COM+, un contexto se define como un conjunto de propiedades en tiempo de ejecución asociadas a uno o varios objetos COM que se usan para proporcionar servicios para esos objetos.</span><span class="sxs-lookup"><span data-stu-id="90e1f-105">In COM+, a context is defined as set of run-time properties associated with one or more COM objects that are used to provide services for those objects.</span></span>

<span data-ttu-id="90e1f-106">En COM+, cada objeto COM se asocia exactamente a un contexto mientras se ejecuta (es decir, entre su activación y desactivación) y todos los contextos residen exactamente en un apartamento COM.</span><span class="sxs-lookup"><span data-stu-id="90e1f-106">In COM+, every COM object is associated with precisely one context as it runs (that is, between its activation and deactivation), and every context resides within precisely one COM apartment.</span></span> <span data-ttu-id="90e1f-107">Se pueden ejecutar varios objetos en el mismo contexto y varios contextos pueden residir en el mismo apartamento.</span><span class="sxs-lookup"><span data-stu-id="90e1f-107">Multiple objects can run within the same context, and multiple contexts can reside within the same apartment.</span></span> <span data-ttu-id="90e1f-108">Se inicializa cuando se activa un objeto, las propiedades de contexto, como las propiedades de contexto de seguridad, representan las necesidades de tiempo de ejecución de un objeto.</span><span class="sxs-lookup"><span data-stu-id="90e1f-108">Initialized when an object is activated, context properties, such as security context properties, represent the run-time needs of an object.</span></span>

> [!Note]  
> <span data-ttu-id="90e1f-109">En el caso de los componentes no configurados que no usan servicios COM+, el contexto es, en la mayoría de los demás, omitido.</span><span class="sxs-lookup"><span data-stu-id="90e1f-109">For unconfigured components that do not use COM+ services, the context is, for the most part, ignored.</span></span>

 

<span data-ttu-id="90e1f-110">COM+ utiliza las propiedades de contexto como base para proporcionar servicios en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="90e1f-110">COM+ uses context properties as the basis for providing run-time services.</span></span> <span data-ttu-id="90e1f-111">Estas propiedades contienen el estado que determina cómo el entorno de ejecución realiza los servicios para los objetos dentro del contexto.</span><span class="sxs-lookup"><span data-stu-id="90e1f-111">These properties hold state that determines how the execution environment performs services for objects within the context.</span></span> <span data-ttu-id="90e1f-112">En algunos casos, puede interactuar directamente con las propiedades de contexto de un objeto para indicar algún estado relevante para un servicio que se proporciona para el objeto.</span><span class="sxs-lookup"><span data-stu-id="90e1f-112">In some cases, you can interact directly with an object's context properties to indicate some state relevant to a service being provided for the object.</span></span> <span data-ttu-id="90e1f-113">Por ejemplo, esto se haría cuando un objeto que participa en una transacción automática vota sobre el resultado de la transacción.</span><span class="sxs-lookup"><span data-stu-id="90e1f-113">For example, you would do this when an object that is participating in an automatic transaction votes on the outcome of the transaction.</span></span>

<span data-ttu-id="90e1f-114">Para obtener una explicación detallada de la base COM de estos conceptos, consulte [procesos, subprocesos y apartamentos](/windows/desktop/com/processes--threads--and-apartments).</span><span class="sxs-lookup"><span data-stu-id="90e1f-114">For a detailed discussion of the COM foundation of these concepts, see [Processes, Threads, and Apartments](/windows/desktop/com/processes--threads--and-apartments).</span></span>

## <a name="programmatic-interaction-with-context-properties"></a><span data-ttu-id="90e1f-115">Interacción mediante programación con propiedades de contexto</span><span class="sxs-lookup"><span data-stu-id="90e1f-115">Programmatic Interaction with Context Properties</span></span>

<span data-ttu-id="90e1f-116">Cada contexto tiene un objeto [**ObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-objectcontext) asociado que realiza un seguimiento de sus propiedades.</span><span class="sxs-lookup"><span data-stu-id="90e1f-116">Each context has an associated [**ObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-objectcontext) object that keeps track of its properties.</span></span> <span data-ttu-id="90e1f-117">Puede acceder a **ObjectContext** mediante una llamada a la función [**GetObjectContext**](/windows/desktop/api/ComSvcs/nf-comsvcs-getobjectcontext) .</span><span class="sxs-lookup"><span data-stu-id="90e1f-117">You can access **ObjectContext** by calling the [**GetObjectContext**](/windows/desktop/api/ComSvcs/nf-comsvcs-getobjectcontext) function.</span></span> <span data-ttu-id="90e1f-118">Una vez que haya tenido acceso a **ObjectContext**, puede llamar a los métodos de la interfaz [**IObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext) que expone para manipular las propiedades de contexto.</span><span class="sxs-lookup"><span data-stu-id="90e1f-118">After you have accessed **ObjectContext**, you can call methods on the [**IObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext) interface it exposes to manipulate context properties.</span></span>

<span data-ttu-id="90e1f-119">Por ejemplo, la llamada a [**IObjectContext:: SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) tiene el efecto de establecer el bit de coherencia de la transacción en "coherente" y el bit [de activación JIT](com--just-in-time-activation.md) realizado en "Done" en el contexto asociado al objeto.</span><span class="sxs-lookup"><span data-stu-id="90e1f-119">For example, calling [**IObjectContext::SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) has the effect of setting the transaction consistency bit to "consistent" and the [JIT-activation](com--just-in-time-activation.md) done bit to "done" on the context associated with the object.</span></span> <span data-ttu-id="90e1f-120">Las señales "coherentes" a COM+ que vota para confirmar la transacción y "Done" indican que el objeto está listo para desactivarse cuando el método vuelve.</span><span class="sxs-lookup"><span data-stu-id="90e1f-120">"Consistent" signals to COM+ that you vote to commit the transaction, and "done" indicates that your object is ready to be deactivated when the method returns.</span></span>

<span data-ttu-id="90e1f-121">Además de [**IObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext), otras interfaces especializadas que proporcionan acceso a las propiedades de contexto son [**IObjectContextInfo**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontextinfo), [**IContextState**](/windows/desktop/api/ComSvcs/nn-comsvcs-icontextstate)y [**IObjectContextActivity**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontextactivity).</span><span class="sxs-lookup"><span data-stu-id="90e1f-121">In addition to [**IObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext), other specialized interfaces providing access to context properties are [**IObjectContextInfo**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontextinfo), [**IContextState**](/windows/desktop/api/ComSvcs/nn-comsvcs-icontextstate), and [**IObjectContextActivity**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontextactivity).</span></span> <span data-ttu-id="90e1f-122">En cierta medida, [**ISecurityCallContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-isecuritycallcontext) también tiene acceso a las propiedades de contexto.</span><span class="sxs-lookup"><span data-stu-id="90e1f-122">To a certain extent, [**ISecurityCallContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-isecuritycallcontext) also accesses context properties.</span></span> <span data-ttu-id="90e1f-123">Puede usar [**IGetSecurityCallContext:: GetSecurityCallContext**](/windows/desktop/api/ComSvcs/nf-comsvcs-igetsecuritycallcontext-getsecuritycallcontext) para obtener **ISecurityCallContext**.</span><span class="sxs-lookup"><span data-stu-id="90e1f-123">You can use [**IGetSecurityCallContext::GetSecurityCallContext**](/windows/desktop/api/ComSvcs/nf-comsvcs-igetsecuritycallcontext-getsecuritycallcontext) to obtain **ISecurityCallContext**.</span></span>

## <a name="understanding-activation-and-interception"></a><span data-ttu-id="90e1f-124">Descripción de la activación y la interceptación</span><span class="sxs-lookup"><span data-stu-id="90e1f-124">Understanding Activation and Interception</span></span>

<span data-ttu-id="90e1f-125">Por lo general, solo tiene que pensar en el contexto en la medida en que representa una serie de propiedades, algunas de las cuales puede establecer u obtener, que se usan para proporcionar servicios COM+ para los componentes.</span><span class="sxs-lookup"><span data-stu-id="90e1f-125">Generally, you need to think about context only to the extent that it represents a number of properties, some of which you can set or get, that are used to provide COM+ services for your components.</span></span> <span data-ttu-id="90e1f-126">Sin embargo, en algunas circunstancias, es posible que tenga que tener en cuenta las siguientes dos caras interrelacionadas de los contextos con mayor detalle:</span><span class="sxs-lookup"><span data-stu-id="90e1f-126">In some circumstances, however, you might need to consider the following two interrelated facets of contexts in greater detail:</span></span>

-   <span data-ttu-id="90e1f-127">La [activación de contexto](context-activation.md)o la inicialización de un objeto en un contexto adecuado.</span><span class="sxs-lookup"><span data-stu-id="90e1f-127">[Context activation](context-activation.md), or the initialization of an object in an appropriate context.</span></span>
-   <span data-ttu-id="90e1f-128">[Interceptación](interception-of-cross-context-calls.md)o lo que hace com+ en las llamadas a través de un límite de contexto.</span><span class="sxs-lookup"><span data-stu-id="90e1f-128">[Interception](interception-of-cross-context-calls.md), or what COM+ does on calls across a context boundary.</span></span>

## <a name="relation-to-mts-context-wrappers"></a><span data-ttu-id="90e1f-129">Relación con los contenedores de contexto MTS</span><span class="sxs-lookup"><span data-stu-id="90e1f-129">Relation to MTS Context Wrappers</span></span>

<span data-ttu-id="90e1f-130">Los contextos reemplazan de forma eficaz los contenedores de contexto de MTS.</span><span class="sxs-lookup"><span data-stu-id="90e1f-130">Contexts effectively replace the MTS context wrappers.</span></span> <span data-ttu-id="90e1f-131">El propósito en que se encontraban: proporcionar servicios automáticos mediante la captura de solicitudes de creación, es ahora una característica integrada de COM+.</span><span class="sxs-lookup"><span data-stu-id="90e1f-131">The purpose they served—providing automatic services by trapping creation requests—is now an integrated feature of COM+.</span></span> <span data-ttu-id="90e1f-132">Como resultado, ya no necesita usar la función [**SafeRef**](/windows/desktop/api/ComSvcs/nf-comsvcs-saferef) .</span><span class="sxs-lookup"><span data-stu-id="90e1f-132">As a result, you no longer need to use the [**SafeRef**](/windows/desktop/api/ComSvcs/nf-comsvcs-saferef) function.</span></span> <span data-ttu-id="90e1f-133">En MTS, **SafeRef** se usaba para obtener una referencia al objeto que se podría pasar fuera de su contenedor de contexto.</span><span class="sxs-lookup"><span data-stu-id="90e1f-133">In MTS, **SafeRef** was used to obtain a reference to your object which could be passed outside of its context wrapper.</span></span> <span data-ttu-id="90e1f-134">En COM+, esto no es necesario; las referencias de objeto normales (**este** punteros) funcionan.</span><span class="sxs-lookup"><span data-stu-id="90e1f-134">In COM+, this is unnecessary; normal object references (**this** pointers) work.</span></span>

 

 
