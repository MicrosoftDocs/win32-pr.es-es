---
description: Al preparar una restauración, un solicitante usa los documentos de metadatos del escritor almacenados junto con su propio documento de componentes de copia de seguridad recuperados para determinar lo que se va a restaurar y cómo.
ms.assetid: 36cf188f-fce6-467c-a200-cbd9dc8f31a6
title: Información general de la preparación para la restauración
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d8b1bc3e429da5be9872e8345fe6da32a5340005
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "105696989"
---
# <a name="overview-of-preparing-for-restore"></a><span data-ttu-id="89cc2-103">Información general de la preparación para la restauración</span><span class="sxs-lookup"><span data-stu-id="89cc2-103">Overview of Preparing for Restore</span></span>

<span data-ttu-id="89cc2-104">Al preparar una restauración, un solicitante usa los documentos de metadatos del escritor almacenados junto con su propio documento de componentes de copia de seguridad recuperados para determinar lo que se va a restaurar y cómo.</span><span class="sxs-lookup"><span data-stu-id="89cc2-104">In preparing for a restore, a requester uses the stored Writer Metadata Documents in conjunction with its own retrieved Backup Components Document to determine what is to be restored and how.</span></span> <span data-ttu-id="89cc2-105">Para obtener más información, vea [información general sobre el procesamiento de una restauración en VSS](overview-of-processing-a-restore-under-vss.md).</span><span class="sxs-lookup"><span data-stu-id="89cc2-105">For more information, see [Overview of Processing a Restore Under VSS](overview-of-processing-a-restore-under-vss.md).</span></span>

<span data-ttu-id="89cc2-106">Después de la selección de componentes de candidato de restauración, los escritores que se ejecutan actualmente en el sistema acceden al documento de componentes de copia de seguridad del solicitante.</span><span class="sxs-lookup"><span data-stu-id="89cc2-106">Following the selection of restore candidate components, writers currently running on the system access the requester's Backup Components Document.</span></span> <span data-ttu-id="89cc2-107">Los escritores utilizan este acceso para indicar cómo se debe producir la dificultad mínima para ejecutar servicios debido a la restauración.</span><span class="sxs-lookup"><span data-stu-id="89cc2-107">Writers use this access to indicate how to cause minimum difficulty for running services due to the restore.</span></span>

<span data-ttu-id="89cc2-108">Una vez completado, el solicitante tiene información suficiente para determinar qué archivos se deben restaurar, así como dónde y cómo se deben restaurar.</span><span class="sxs-lookup"><span data-stu-id="89cc2-108">After this is completed, the requester has enough information to determine which files will need to be restored, as well as where and how they should be restored.</span></span> <span data-ttu-id="89cc2-109">(Para obtener más información, vea [generar un conjunto de restauración](generating-a-restore-set.md)).</span><span class="sxs-lookup"><span data-stu-id="89cc2-109">(For more information, see [Generating a Restore Set](generating-a-restore-set.md).)</span></span>

<span data-ttu-id="89cc2-110">En la tabla siguiente se muestra la secuencia de acciones y eventos necesarios para preparar una operación de restauración.</span><span class="sxs-lookup"><span data-stu-id="89cc2-110">The following table shows the sequence of actions and events that are required to prepare for a restore operation.</span></span>



| <span data-ttu-id="89cc2-111">Acción del solicitante</span><span class="sxs-lookup"><span data-stu-id="89cc2-111">Requester action</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | <span data-ttu-id="89cc2-112">Evento</span><span class="sxs-lookup"><span data-stu-id="89cc2-112">Event</span></span>                                                         | <span data-ttu-id="89cc2-113">Acción del escritor</span><span class="sxs-lookup"><span data-stu-id="89cc2-113">Writer action</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="89cc2-114">Recupere información del documento de componentes de copia de seguridad sobre los componentes [*incluidos explícitamente*](vssgloss-e.md) en la operación de copia de seguridad (vea [**IVssBackupComponents:: GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents)) examinar los documentos de metadatos del escritor recuperados para obtener detalles sobre esos componentes incluidos explícitamente en la copia de seguridad, así como cualquier subcomponente [*incluido implícitamente*](vssgloss-i.md) .</span><span class="sxs-lookup"><span data-stu-id="89cc2-114">Retrieve information from the Backup Components Document about the components [*explicitly included*](vssgloss-e.md) in the backup operation (see [**IVssBackupComponents::GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents)) Examine retrieved Writer Metadata Documents to get details about those components explicitly included in the backup, and any find [*implicitly included*](vssgloss-i.md) subcomponents.</span></span> <span data-ttu-id="89cc2-115">(Consulte [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata), [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent)).</span><span class="sxs-lookup"><span data-stu-id="89cc2-115">(See [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata), [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent).)</span></span><br/> | <span data-ttu-id="89cc2-116">None</span><span class="sxs-lookup"><span data-stu-id="89cc2-116">None</span></span>                                                          | <span data-ttu-id="89cc2-117">None</span><span class="sxs-lookup"><span data-stu-id="89cc2-117">None</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="89cc2-118">Seleccione los componentes y los conjuntos de componentes que se van a restaurar (consulte [**IVssBackupComponents:: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) y [**IVssBackupComponents:: AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent)).</span><span class="sxs-lookup"><span data-stu-id="89cc2-118">Select components and component sets to be restored (see [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) and [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).)</span></span>                                                                                                                                                                                                                                                                                                                                                                                          | <span data-ttu-id="89cc2-119">None</span><span class="sxs-lookup"><span data-stu-id="89cc2-119">None</span></span>                                                          | <span data-ttu-id="89cc2-120">None</span><span class="sxs-lookup"><span data-stu-id="89cc2-120">None</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="89cc2-121">El solicitante permite al escritor actualizar el documento de componentes de copia de seguridad y, opcionalmente, puede comunicar las opciones de restauración especiales al escritor.</span><span class="sxs-lookup"><span data-stu-id="89cc2-121">The requester allows the writer to update the Backup Components Document and may optionally communicate any special restore options to the writer.</span></span> <span data-ttu-id="89cc2-122">(Consulte [**IVssBackupComponents:: SetRestoreOptions**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestoreoptions), [**IVssBackupComponents:: AddNewTarget**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget)y [**IVssBackupComponents::P rerestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore)).</span><span class="sxs-lookup"><span data-stu-id="89cc2-122">(See [**IVssBackupComponents::SetRestoreOptions**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestoreoptions), [**IVssBackupComponents::AddNewTarget**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget), and [**IVssBackupComponents::PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore).)</span></span>                                                                                                                                                                                                                                         | [<span data-ttu-id="89cc2-123">*Prerestauración*</span><span class="sxs-lookup"><span data-stu-id="89cc2-123">*PreRestore*</span></span>](vssgloss-p.md) | <span data-ttu-id="89cc2-124">El escritor determina la participación en la restauración, prepara los archivos que se van a restaurar y, opcionalmente, modifica el documento de componentes de copia de seguridad si es necesario.</span><span class="sxs-lookup"><span data-stu-id="89cc2-124">The writer determines participation in the restore, prepares files to restore, and optionally modifies Backup Components Document if necessary.</span></span> <span data-ttu-id="89cc2-125">(Vea [**CVssWriter:: OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore), [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent), [**IVssComponent:: IsSelectedForRestore**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-isselectedforrestore), [**IVssComponent:: GetRestoreOptions**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoreoptions), [**IVssComponent:: SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget), [**IVssComponent:: SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata), [**IVssComponent:: AddDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget)).</span><span class="sxs-lookup"><span data-stu-id="89cc2-125">(See [**CVssWriter::OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore), [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent), [**IVssComponent::IsSelectedForRestore**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-isselectedforrestore), [**IVssComponent::GetRestoreOptions**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoreoptions), [**IVssComponent::SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget), [**IVssComponent::SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata), [**IVssComponent::AddDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget).)</span></span> |
| <span data-ttu-id="89cc2-126">El solicitante espera en los escritores para controlar el evento de [**prerestauración**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) con [**IVssAsync**](/windows/desktop/api/Vss/nn-vss-ivssasync).</span><span class="sxs-lookup"><span data-stu-id="89cc2-126">The requester waits on writers to handle the [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) event with [**IVssAsync**](/windows/desktop/api/Vss/nn-vss-ivssasync).</span></span> <span data-ttu-id="89cc2-127">También debe comprobar el estado del escritor.</span><span class="sxs-lookup"><span data-stu-id="89cc2-127">It should also verify writer status.</span></span> <span data-ttu-id="89cc2-128">(Consulte [**ivssbackupcomponents:: GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus), [**IVssBackupComponents:: GetWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwriterstatus)).</span><span class="sxs-lookup"><span data-stu-id="89cc2-128">(See [**IVssBackupComponents::GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus), [**IVssBackupComponents::GetWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwriterstatus).)</span></span>                                                                                                                                                                                                                                                                                  | <span data-ttu-id="89cc2-129">None</span><span class="sxs-lookup"><span data-stu-id="89cc2-129">None</span></span>                                                          | <span data-ttu-id="89cc2-130">None</span><span class="sxs-lookup"><span data-stu-id="89cc2-130">None</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |



 

## <a name="requester-actions-during-restore-preparations"></a><span data-ttu-id="89cc2-131">Acciones del solicitante durante los preparativos de restauración</span><span class="sxs-lookup"><span data-stu-id="89cc2-131">Requester Actions during Restore Preparations</span></span>

<span data-ttu-id="89cc2-132">Para determinar qué componentes son candidatos para la restauración, el solicitante debe hacer lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="89cc2-132">To determine which components are candidates for restore, the requester must do the following:</span></span>

-   <span data-ttu-id="89cc2-133">Establezca el componente y la estructura del [*conjunto de componentes*](vssgloss-c.md) que se usa para realizar la copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="89cc2-133">Establish the component and the [*component set*](vssgloss-c.md) structure used to make the backup.</span></span>
-   <span data-ttu-id="89cc2-134">Examine la [*selección de*](vssgloss-s.md)los componentes para la restauración.</span><span class="sxs-lookup"><span data-stu-id="89cc2-134">Examine the components' [*selectability for restore*](vssgloss-s.md).</span></span>
-   <span data-ttu-id="89cc2-135">Utilice las instrucciones de selección ([trabajar con la selección para restaurar y subcomponentes](working-with-selectability-for-restore-and-subcomponents.md)) para elegir los componentes que se van a incluir.</span><span class="sxs-lookup"><span data-stu-id="89cc2-135">Use selectability guidelines ([Working with Selectability for Restore and Subcomponents](working-with-selectability-for-restore-and-subcomponents.md)) to choose components to include.</span></span>
-   <span data-ttu-id="89cc2-136">Use la información del [*conjunto de archivos*](vssgloss-f.md) de componentes para determinar qué archivos del medio de copia de seguridad deben restaurarse.</span><span class="sxs-lookup"><span data-stu-id="89cc2-136">Use component [*file set*](vssgloss-f.md) information to determine which files on the backup media must be restored.</span></span>

<span data-ttu-id="89cc2-137">Para ello, el solicitante debe examinar los componentes [*incluidos explícitamente*](vssgloss-e.md) en el documento componentes de copia de seguridad almacenados.</span><span class="sxs-lookup"><span data-stu-id="89cc2-137">To do this, the requester needs to examine [*explicitly included*](vssgloss-e.md) components in the stored Backup Components Document.</span></span> <span data-ttu-id="89cc2-138">Esta información de componente está disponible en un escritor por escritor mediante [**IVssBackupComponents:: GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents), que devuelve instancias de la interfaz [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) , desde la que se pueden recuperar la información del escritor y las instancias de la interfaz [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) .</span><span class="sxs-lookup"><span data-stu-id="89cc2-138">This component information is available on a writer-by-writer basis using [**IVssBackupComponents::GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents), which returns instances of the [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) interface, from which both writer information and instances of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface can be retrieved.</span></span>

<span data-ttu-id="89cc2-139">Como se indicó en otra parte (el [uso de los componentes por parte del solicitante](use-of-components-by-the-requestor.md)), el documento componentes de copia de seguridad y la interfaz **IVssComponent** no contienen información suficiente para admitir la copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="89cc2-139">As noted elsewhere ([Use of Components by the Requester](use-of-components-by-the-requestor.md)), the Backup Components Document and the **IVssComponent** interface do not contain enough information to support the backup.</span></span> <span data-ttu-id="89cc2-140">Por lo tanto, el solicitante debe examinar el documento de metadatos del escritor almacenado correspondiente mediante [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) (consulte la [información de identificación del escritor](writer-metadata-document-contents.md)).</span><span class="sxs-lookup"><span data-stu-id="89cc2-140">Therefore, the requester must examine the corresponding stored Writer Metadata Document by using [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) (see [Writer Identification Information](writer-metadata-document-contents.md)).</span></span>

<span data-ttu-id="89cc2-141">[**IVssExamineWriterMetadata:: GetFileCounts**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getfilecounts)devuelve el número de componentes que administra cada escritor.</span><span class="sxs-lookup"><span data-stu-id="89cc2-141">The number of components each writer manages is returned by [**IVssExamineWriterMetadata::GetFileCounts**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getfilecounts).</span></span> <span data-ttu-id="89cc2-142">Después, el solicitante puede usar [**IVssExamineWriterMetadata:: getComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getcomponent) para obtener una interfaz [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) para cada componente que un escritor administra.</span><span class="sxs-lookup"><span data-stu-id="89cc2-142">The requester can then use [**IVssExamineWriterMetadata::GetComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getcomponent) to get an [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) interface for each component a writer manages.</span></span>

<span data-ttu-id="89cc2-143">Mediante el examen de la capacidad de selección de los componentes para las rutas de acceso [*lógicas*](vssgloss-l.md) y [*de copia de seguridad*](vssgloss-s.md) (vea [trabajar con las rutas de acceso lógicas y de selección](working-with-selectability-and-logical-paths.md)), un solicitante puede identificar los componentes que definieron conjuntos de componentes de tiempo de copia de seguridad (componentes incluidos explícitamente) y los miembros de subcomponentes de esos conjuntos (componentes incluidos implícitamente).</span><span class="sxs-lookup"><span data-stu-id="89cc2-143">By examining the components' [*selectability for backup*](vssgloss-s.md) and [*logical paths*](vssgloss-l.md) (see [Working with Selectability and Logical Paths](working-with-selectability-and-logical-paths.md)), a requester is able to identify the components that defined backup-time component sets (explicitly included components), and the subcomponents members of those sets (implicitly included components).</span></span>

<span data-ttu-id="89cc2-144">Los solicitantes indican a través del documento componentes de copia de seguridad si un componente se va a restaurar explícitamente, mediante [**IVssBackupComponents:: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) o [**Ivssbackupcomponents:: AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span><span class="sxs-lookup"><span data-stu-id="89cc2-144">Requesters indicate through the Backup Components Document if a component is to be explicitly restored, using either [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) or [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span></span> <span data-ttu-id="89cc2-145">La elección del método dependerá de cómo se haya realizado originalmente la copia de seguridad del componente y su posibilidad [*de seleccionar la restauración*](vssgloss-s.md).</span><span class="sxs-lookup"><span data-stu-id="89cc2-145">The choice of method will depend on how the component was originally backed up and its [*selectability for restore*](vssgloss-s.md).</span></span> <span data-ttu-id="89cc2-146">Estos componentes incluidos explícitamente para la restauración designan otros componentes que se incluyen de forma implícita (vea [trabajar con la selección para restaurar y subcomponentes](working-with-selectability-for-restore-and-subcomponents.md) para obtener más detalles).</span><span class="sxs-lookup"><span data-stu-id="89cc2-146">These components explicitly included for restore designate other components which are implicitly included (see [Working with Selectability for Restore and Subcomponents](working-with-selectability-for-restore-and-subcomponents.md) for details).</span></span>

<span data-ttu-id="89cc2-147">Un solicitante puede incluir explícitamente ninguno de los componentes de un escritor que se está ejecutando actualmente para la restauración mediante [**ivssbackupcomponents:: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) o [**IVssBackupComponents:: AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span><span class="sxs-lookup"><span data-stu-id="89cc2-147">A requester may explicitly include none of a currently executing writer's components for restore using [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) or [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span></span> <span data-ttu-id="89cc2-148">En este caso, ese escritor no recibirá ningún evento VSS para el resto de la operación de restauración.</span><span class="sxs-lookup"><span data-stu-id="89cc2-148">In this case, that writer will not receive any VSS events for the remainder of the restore operation.</span></span>

<span data-ttu-id="89cc2-149">Mediante el uso de [**ivssbackupcomponents:: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) o [**Ivssbackupcomponents:: AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent) para seleccionar un componente de un escritor que no se está ejecutando actualmente, se devuelve un \_ error de \_ objeto E \_ no \_ encontrado de VSS.</span><span class="sxs-lookup"><span data-stu-id="89cc2-149">Explicitly using either [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) or [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent) to select a component of a writer that is not currently running returns a VSS\_E\_OBJECT\_NOT\_FOUND error.</span></span> <span data-ttu-id="89cc2-150">Consulte [restauraciones sin participación del escritor](restores-without-writer-participation.md) para obtener información sobre cómo restaurar los datos de escritores que faltan.</span><span class="sxs-lookup"><span data-stu-id="89cc2-150">See [Restores without Writer Participation](restores-without-writer-participation.md) for information on restoring the data of missing writers.</span></span>

<span data-ttu-id="89cc2-151">Para permitir que un escritor tenga información completa sobre la que actuar, las opciones de restauración específicas del escritor y la indicación de una restauración incremental se pueden enviar a los escritores mediante llamadas de solicitante a [**ivssbackupcomponents:: SetRestoreOptions**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestoreoptions) y [**IVssBackupComponents:: SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores), respectivamente.</span><span class="sxs-lookup"><span data-stu-id="89cc2-151">To enable a writer to have complete information upon which to act, writer-specific restore options and indication of an incremental restore can be sent to the writers by requester calls to [**IVssBackupComponents::SetRestoreOptions**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestoreoptions) and [**IVssBackupComponents::SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores), respectively.</span></span>

<span data-ttu-id="89cc2-152">En este momento, un solicitante ha finalizado su preparación y genera un evento de **prerestauración** mediante una llamada a [**IVssBackupComponents::P**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore)volver a restaurar, lo que permite a los escritores prepararse para la restauración real.</span><span class="sxs-lookup"><span data-stu-id="89cc2-152">At this point, a requester has finished its preparation, and it generates a **PreRestore** event by calling [**IVssBackupComponents::PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore), allowing writers to prepare for the actual restore.</span></span>

## <a name="writer-actions-during-restore-preparations"></a><span data-ttu-id="89cc2-153">Acciones del escritor durante la preparación de la restauración</span><span class="sxs-lookup"><span data-stu-id="89cc2-153">Writer Actions during Restore Preparations</span></span>

<span data-ttu-id="89cc2-154">La preparación del escritor para la operación de restauración se produce al controlar el evento [**Prerestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) con el método virtual [**CVssWriter:: OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore).</span><span class="sxs-lookup"><span data-stu-id="89cc2-154">Writer preparation for the restore operation occurs when handling the [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) event with the virtual method [**CVssWriter::OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore).</span></span> <span data-ttu-id="89cc2-155">La implementación predeterminada simplemente devuelve sin realizar ninguna acción.</span><span class="sxs-lookup"><span data-stu-id="89cc2-155">The default implementation simply returns without taking any action.</span></span> <span data-ttu-id="89cc2-156">Los escritores pueden optar por invalidar la implementación predeterminada para ejercer más control:</span><span class="sxs-lookup"><span data-stu-id="89cc2-156">Writers may choose to override the default implementation to exercise more control by:</span></span>

-   <span data-ttu-id="89cc2-157">Reemplazar [*métodos de restauración*](vssgloss-r.md) con [*destinos de restauración*](vssgloss-r.md)</span><span class="sxs-lookup"><span data-stu-id="89cc2-157">Overriding [*restore methods*](vssgloss-r.md) with [*restore targets*](vssgloss-r.md)</span></span>
-   <span data-ttu-id="89cc2-158">Definición de [ *destinos dirigidos*](vssgloss-d.md)</span><span class="sxs-lookup"><span data-stu-id="89cc2-158">Defining [*directed targets*](vssgloss-d.md)</span></span>
-   <span data-ttu-id="89cc2-159">Crear mensajes de error y datos adicionales</span><span class="sxs-lookup"><span data-stu-id="89cc2-159">Creating error messages and additional data</span></span>
-   <span data-ttu-id="89cc2-160">Proporcionar información de marca de copia de seguridad</span><span class="sxs-lookup"><span data-stu-id="89cc2-160">Supplying backup stamp information</span></span>

<span data-ttu-id="89cc2-161">El controlador de eventos [**CVssWriter:: OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore) recibe una instancia de [**IVssWriterComponents**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswritercomponents), de la que puede obtener interfaces [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) para los componentes de sus componentes incluidos explícitamente en el documento componentes de copia de seguridad durante la copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="89cc2-161">The event handler [**CVssWriter::OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore) receives an instance of the [**IVssWriterComponents**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswritercomponents), from which it can obtain [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interfaces for those of its components explicitly included in the Backup Components Document during backup.</span></span>

<span data-ttu-id="89cc2-162">Información sobre los subcomponentes incluidos implícitamente en las operaciones de copia de seguridad y que se incluyen explícitamente en las restauraciones mediante una instancia de **IVssComponent** correspondiente al componente que definió su [*conjunto de componentes*](vssgloss-c.md)de copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="89cc2-162">Information about subcomponents implicitly included in backup operations and explicitly included in restores by using an instance of the **IVssComponent** corresponding to the component that defined its backup [*component set*](vssgloss-c.md).</span></span>

<span data-ttu-id="89cc2-163">El método [**IVssComponent:: IsSelectedForRestore**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-isselectedforrestore) se usa para determinar si se va a restaurar un componente de copia de seguridad incluido explícitamente.</span><span class="sxs-lookup"><span data-stu-id="89cc2-163">The [**IVssComponent::IsSelectedForRestore**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-isselectedforrestore) method is used to determine whether an explicitly included for backup component is to be restored.</span></span>

<span data-ttu-id="89cc2-164">Para determinar si un subcomponente de copia de seguridad se incluyó explícitamente en la restauración, los escritores usan [**IVssComponent:: GetRestoreSubcomponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponent).</span><span class="sxs-lookup"><span data-stu-id="89cc2-164">To determine if a backup subcomponent was explicitly included in the restore, writers use [**IVssComponent::GetRestoreSubcomponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponent).</span></span>

<span data-ttu-id="89cc2-165">El escritor debe examinar el [*conjunto de archivos*](vssgloss-f.md) de cada componente y determinar si es necesario realizar acciones para admitir la restauración.</span><span class="sxs-lookup"><span data-stu-id="89cc2-165">The writer should examine the [*file set*](vssgloss-f.md) in each component and determine if it needs to take actions to support the restore.</span></span> <span data-ttu-id="89cc2-166">El escritor tendrá que evaluar si desea sobrescribir los archivos actuales, o bien, si necesita restauración en nuevas ubicaciones.</span><span class="sxs-lookup"><span data-stu-id="89cc2-166">The writer will need to evaluate if it wants its current files overwritten, or if it will require restoration to new locations.</span></span> <span data-ttu-id="89cc2-167">Las acciones pueden incluir lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="89cc2-167">Actions can include the following:</span></span>

-   <span data-ttu-id="89cc2-168">Obtener y actuar sobre las opciones específicas del escritor o del solicitante que rigen las operaciones de restauración (vea [**IVssComponent:: GetRestoreOptions**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoreoptions))</span><span class="sxs-lookup"><span data-stu-id="89cc2-168">Getting and acting on any writer- or requester-specific options governing restore operations (see [**IVssComponent::GetRestoreOptions**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoreoptions))</span></span>
-   <span data-ttu-id="89cc2-169">Cerrar y permitir la escritura en todos los archivos abiertos actualmente</span><span class="sxs-lookup"><span data-stu-id="89cc2-169">Closing and making writable any currently open files</span></span>
-   <span data-ttu-id="89cc2-170">Actualizar el destino de restauración (por ejemplo, para forzar la restauración en una asignación de ubicación alternativa).</span><span class="sxs-lookup"><span data-stu-id="89cc2-170">Updating the restore target (for instance, to force restoration to an alternate location mapping).</span></span> <span data-ttu-id="89cc2-171">Vea [**IVssComponent:: SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget).</span><span class="sxs-lookup"><span data-stu-id="89cc2-171">See [**IVssComponent::SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget).</span></span>
-   <span data-ttu-id="89cc2-172">Comunicación con el solicitante a través de metadatos privados (consulte [**IVssComponent:: SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata))</span><span class="sxs-lookup"><span data-stu-id="89cc2-172">Communicating with the requester via private metadata (see [**IVssComponent::SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata))</span></span>
-   <span data-ttu-id="89cc2-173">Que indica que se debe restaurar un archivo reasignando a través de la definición de [*destinos dirigidos*](vssgloss-d.md) (vea [**IVssComponent:: AddDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget))</span><span class="sxs-lookup"><span data-stu-id="89cc2-173">Indicating that a file should be restored by remapping through the definition of [*directed targets*](vssgloss-d.md) (see [**IVssComponent::AddDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget))</span></span>

<span data-ttu-id="89cc2-174">La instancia de [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) utilizada será la que creará la inclusión explícita del componente en el documento componentes de copia de seguridad durante la copia de seguridad, o en el componente que define el conjunto de componentes de copia de seguridad del que era miembro (vea [trabajar con la selección para restaurar y subcomponentes](working-with-selectability-for-restore-and-subcomponents.md)).</span><span class="sxs-lookup"><span data-stu-id="89cc2-174">The instance of [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) used will either be that created by the component's explicit inclusion in the Backup Components Document during backup, or that of the component defining the backup component set of which it was a member (see [Working with Selectability For Restore and Subcomponents](working-with-selectability-for-restore-and-subcomponents.md)).</span></span>

 

 
