---
description: El servicio de eventos COM+ utiliza un objeto de clase de eventos para administrar la conexión entre el publicador y el suscriptor.
ms.assetid: 877c5890-588d-4978-8fb2-b4ecf4134068
title: Objeto de la clase de eventos COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aae397f647354ac24395fa073365160829a687a2
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104000566"
---
# <a name="the-com-event-class-object"></a><span data-ttu-id="123ed-103">Objeto de la clase de eventos COM+</span><span class="sxs-lookup"><span data-stu-id="123ed-103">The COM+ Event Class Object</span></span>

<span data-ttu-id="123ed-104">El servicio de eventos COM+ utiliza un *objeto de clase de eventos* para administrar la conexión entre el publicador y el suscriptor.</span><span class="sxs-lookup"><span data-stu-id="123ed-104">The COM+ Events service uses an *event class object* to manage the connection between publisher and subscriber.</span></span> <span data-ttu-id="123ed-105">El objeto de clase de eventos es un componente COM+ administrado y almacenado por el sistema de eventos COM+ y contiene las interfaces y los métodos utilizados por un publicador para activar eventos.</span><span class="sxs-lookup"><span data-stu-id="123ed-105">The event class object is a COM+ component that is managed and stored by the COM+ Events system and contains the interfaces and methods used by a publisher to fire events.</span></span> <span data-ttu-id="123ed-106">Es un objeto persistente que indica los eventos que pueden producirse y, opcionalmente, identifica al publicador.</span><span class="sxs-lookup"><span data-stu-id="123ed-106">It is a persistent object that indicates the events that can occur and, optionally, identifies the publisher.</span></span> <span data-ttu-id="123ed-107">Especifique las interfaces y los métodos que desea que contenga una clase de eventos proporcionando una biblioteca de tipos.</span><span class="sxs-lookup"><span data-stu-id="123ed-107">You specify the interfaces and methods you want an event class to contain by providing a type library.</span></span>

<span data-ttu-id="123ed-108">Para desencadenar un evento, el publicador crea instancias del objeto de la clase de evento llamando a [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) o el método **CreateObject** de Microsoft Visual Basic y solicitando la interfaz de eventos que se va a devolver.</span><span class="sxs-lookup"><span data-stu-id="123ed-108">To fire an event, the publisher instantiates the event class object by calling [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) or the Microsoft Visual Basic **CreateObject** method and requesting the event interface be returned.</span></span> <span data-ttu-id="123ed-109">El objeto de clase de eventos con instancias contiene la implementación del sistema de eventos de la interfaz solicitada.</span><span class="sxs-lookup"><span data-stu-id="123ed-109">The instantiated event class object contains the event system's implementation of the requested interface.</span></span> <span data-ttu-id="123ed-110">Un suscriptor interesado también debe implementar la interfaz de clase de eventos para recibir eventos de un publicador determinado.</span><span class="sxs-lookup"><span data-stu-id="123ed-110">An interested subscriber must also implement the event class interface to receive events from a given publisher.</span></span> <span data-ttu-id="123ed-111">Cuando se crea una instancia del objeto de la clase de evento, el sistema de eventos lo asocia a los suscriptores correspondientes.</span><span class="sxs-lookup"><span data-stu-id="123ed-111">When the event class object is instantiated, the event system associates it with the appropriate subscribers.</span></span> <span data-ttu-id="123ed-112">La lista de suscriptores se mantiene durante la vigencia del objeto de la clase de evento.</span><span class="sxs-lookup"><span data-stu-id="123ed-112">The list of subscribers is maintained for the lifetime of the event class object.</span></span> <span data-ttu-id="123ed-113">Un evento se puede entregar a varios suscriptores, ya sea en serie o en paralelo.</span><span class="sxs-lookup"><span data-stu-id="123ed-113">An event can be delivered to multiple subscribers either serially or in parallel.</span></span>

<span data-ttu-id="123ed-114">Al implementar un objeto de clase de eventos, debe proporcionar un archivo DLL de registro automático que exporte las funciones [**DllRegisterServer**](/windows/desktop/api/olectl/nf-olectl-dllregisterserver) y [**DllUnregisterServer**](/windows/desktop/api/olectl/nf-olectl-dllunregisterserver) .</span><span class="sxs-lookup"><span data-stu-id="123ed-114">When you implement an event class object, you should provide a self-registering DLL that exports the [**DllRegisterServer**](/windows/desktop/api/olectl/nf-olectl-dllregisterserver) and [**DllUnregisterServer**](/windows/desktop/api/olectl/nf-olectl-dllunregisterserver) functions.</span></span> <span data-ttu-id="123ed-115">La función **DllRegisterServer** registra una clase com y la función **DllUnregisterServer** anula el registro del componente.</span><span class="sxs-lookup"><span data-stu-id="123ed-115">The **DllRegisterServer** function registers a COM class, and the **DllUnregisterServer** function unregisters the component.</span></span> <span data-ttu-id="123ed-116">Los objetos de la clase de eventos se almacenan en el catálogo de COM+, ya sea mediante la herramienta de administración de servicios de componentes o mediante programación con los métodos de las interfaces [**ICOMAdminCatalog:: InstallEventClass**](/windows/desktop/api/ComAdmin/nf-comadmin-icomadmincatalog-installeventclass) o [**ICOMAdminCatalog:: InstallMultipleEventClasses**](/windows/desktop/api/ComAdmin/nf-comadmin-icomadmincatalog-installmultipleeventclasses) .</span><span class="sxs-lookup"><span data-stu-id="123ed-116">Event class objects are stored in the COM+ catalog, either by using the Component Services administration tool or programmatically by using the methods of the [**ICOMAdminCatalog::InstallEventClass**](/windows/desktop/api/ComAdmin/nf-comadmin-icomadmincatalog-installeventclass) or [**ICOMAdminCatalog::InstallMultipleEventClasses**](/windows/desktop/api/ComAdmin/nf-comadmin-icomadmincatalog-installmultipleeventclasses) interfaces.</span></span> <span data-ttu-id="123ed-117">Para obtener información detallada sobre el registro de objetos de clase de eventos, vea [registrar una clase de eventos](registering-an-event-class.md).</span><span class="sxs-lookup"><span data-stu-id="123ed-117">For detailed information about registering event class objects, see [Registering an Event Class](registering-an-event-class.md).</span></span>

<span data-ttu-id="123ed-118">Dado que los objetos de la clase de eventos son componentes configurados, otros atributos, como la puesta en cola, las transacciones, la seguridad, etc., se pueden configurar para ellos mediante la herramienta de administración de servicios de componentes o las funciones del SDK administrativo de COM+.</span><span class="sxs-lookup"><span data-stu-id="123ed-118">Because event class objects are configured components, other attributes, such as queuing, transactions, security, and so on, can be configured for them by using either the Component Services administration tool or the COM+ Administrative SDK functions.</span></span>

> [!Note]  
> <span data-ttu-id="123ed-119">El servicio de eventos COM+ utiliza el cálculo de referencias de la biblioteca de tipos.</span><span class="sxs-lookup"><span data-stu-id="123ed-119">The COM+ Events service uses type library marshaling.</span></span> <span data-ttu-id="123ed-120">Esto coloca algunas restricciones en las interfaces de clase de eventos.</span><span class="sxs-lookup"><span data-stu-id="123ed-120">This places some restrictions on event class interfaces.</span></span> <span data-ttu-id="123ed-121">Por ejemplo, el contador de referencias de la biblioteca de tipos no admite el tamaño de los atributos MIDL y la [**longitud \_ es**](/windows/desktop/Midl/length-is). [**\_**](/windows/desktop/Midl/size-is)</span><span class="sxs-lookup"><span data-stu-id="123ed-121">For example, the type library marshaler does not support the MIDL attributes [**size\_is**](/windows/desktop/Midl/size-is) and [**length\_is**](/windows/desktop/Midl/length-is).</span></span>

 

<span data-ttu-id="123ed-122">Un objeto de clase de eventos posee atributos de publicación que determinan la manera en que se publican los eventos, así como las propiedades siguientes:</span><span class="sxs-lookup"><span data-stu-id="123ed-122">An event class object possesses publication attributes that determine the way events are published, as well as the following properties:</span></span>

-   <span data-ttu-id="123ed-123">**EventCLSID**.</span><span class="sxs-lookup"><span data-stu-id="123ed-123">**EventCLSID**.</span></span> <span data-ttu-id="123ed-124">Identificador único que especifica el CLSID del componente.</span><span class="sxs-lookup"><span data-stu-id="123ed-124">A unique identifier that specifies the CLSID of the component.</span></span>
-   <span data-ttu-id="123ed-125">**EventClassName**.</span><span class="sxs-lookup"><span data-stu-id="123ed-125">**EventClassName**.</span></span> <span data-ttu-id="123ed-126">Identificador único que especifica el PROGID del componente.</span><span class="sxs-lookup"><span data-stu-id="123ed-126">A unique identifier that specifies the PROGID of the component.</span></span>
-   <span data-ttu-id="123ed-127">**Biblioteca**.</span><span class="sxs-lookup"><span data-stu-id="123ed-127">**TypeLibrary**.</span></span> <span data-ttu-id="123ed-128">Proporciona una lista de interfaces ofrecidas por el objeto de la clase de evento.</span><span class="sxs-lookup"><span data-stu-id="123ed-128">Provides a list of interfaces offered by the event class object.</span></span> <span data-ttu-id="123ed-129">No es necesario implementar las interfaces de activación especificadas en la biblioteca de tipos.</span><span class="sxs-lookup"><span data-stu-id="123ed-129">There is no need to implement the firing interfaces specified in the type library.</span></span>

## <a name="related-topics"></a><span data-ttu-id="123ed-130">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="123ed-130">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="123ed-131">Consideraciones de seguridad de eventos COM+</span><span class="sxs-lookup"><span data-stu-id="123ed-131">COM+ Events Security Considerations</span></span>](com--events-security-considerations.md)
</dt> <dt>

[<span data-ttu-id="123ed-132">Filtrado de eventos en COM+</span><span class="sxs-lookup"><span data-stu-id="123ed-132">Filtering Events in COM+</span></span>](filtering-events-in-com-.md)
</dt> <dt>

[<span data-ttu-id="123ed-133">Publicar y entregar eventos en COM+</span><span class="sxs-lookup"><span data-stu-id="123ed-133">Publishing and Delivering Events in COM+</span></span>](publishing-and-delivering-events-in-com-.md)
</dt> <dt>

[<span data-ttu-id="123ed-134">Suscripciones</span><span class="sxs-lookup"><span data-stu-id="123ed-134">Subscriptions</span></span>](subscriptions.md)
</dt> <dt>

[<span data-ttu-id="123ed-135">Usar eventos COM+ con componentes en cola de COM+</span><span class="sxs-lookup"><span data-stu-id="123ed-135">Using COM+ Events with COM+ Queued Components</span></span>](using-com--events-with-com--queued-components.md)
</dt> </dl>

 

 
