---
description: 'El modelo de transición de estado en un proveedor de instantáneas se simplifica mediante la serialización de la creación de instantáneas desde el momento en que se llama a IVssBackupComponents:: StartSnapshotSet hasta que la llamada a IVssBackupComponents::D oSnapshotSet devuelve.'
ms.assetid: 5dbf0fb3-53cb-4532-9a8f-bd955afe16c4
title: Transiciones de estado en proveedores de instantáneas
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0d628d11419158f947225b2e4cabd7f93975f421
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "105697160"
---
# <a name="state-transitions-in-shadow-copy-providers"></a><span data-ttu-id="52df1-103">Transiciones de estado en proveedores de instantáneas</span><span class="sxs-lookup"><span data-stu-id="52df1-103">State Transitions in Shadow Copy Providers</span></span>

<span data-ttu-id="52df1-104">El modelo de transición de estado en un proveedor de instantáneas se simplifica mediante la serialización de la creación de instantáneas desde el momento en que se llama a [**ivssbackupcomponents:: StartSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-startsnapshotset) hasta que la llamada a [**IVssBackupComponents::D osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) devuelve.</span><span class="sxs-lookup"><span data-stu-id="52df1-104">The state transition model in a shadow copy provider is simplified by the serialization of shadow copy creation from the time that [**IVssBackupComponents::StartSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-startsnapshotset) is called until the call to [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) returns.</span></span> <span data-ttu-id="52df1-105">Si otro solicitante intenta crear una instantánea durante este tiempo, se producirá un error en la llamada a **StartSnapshotSet** con **el \_ \_ conjunto de instantáneas de VSS e \_ \_ en \_ curso**, lo que indica que el segundo solicitante debe esperar e intentarlo de nuevo.</span><span class="sxs-lookup"><span data-stu-id="52df1-105">If another requester tries to create a shadow copy during this time, the call to **StartSnapshotSet** will fail with error **VSS\_E\_SNAPSHOT\_SET\_IN\_PROGRESS**, indicating that the second requester should wait and try again.</span></span>

<span data-ttu-id="52df1-106">VSS solo llamará a [**IVssProviderCreateSnapshotSet:: AbortSnapshots**](/windows/desktop/api/VsProv/nf-vsprov-ivssprovidercreatesnapshotset-abortsnapshots) después de que el solicitante haya llamado a [**DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), incluso si se produce un error en la instantánea o se anula antes de este punto.</span><span class="sxs-lookup"><span data-stu-id="52df1-106">VSS will only call [**IVssProviderCreateSnapshotSet::AbortSnapshots**](/windows/desktop/api/VsProv/nf-vsprov-ivssprovidercreatesnapshotset-abortsnapshots) after the requester has called [**DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), even if the shadow copy fails or is aborted before this point.</span></span> <span data-ttu-id="52df1-107">Esto significa que un proveedor no recibirá una llamada a **AbortSnapshots** hasta que no se haya llamado a [**IVssProviderCreateSnapshotSet:: EndPrepareSnapshots**](/windows/desktop/api/VsProv/nf-vsprov-ivssprovidercreatesnapshotset-endpreparesnapshots) .</span><span class="sxs-lookup"><span data-stu-id="52df1-107">This means that a provider will not receive a call to **AbortSnapshots** until after [**IVssProviderCreateSnapshotSet::EndPrepareSnapshots**](/windows/desktop/api/VsProv/nf-vsprov-ivssprovidercreatesnapshotset-endpreparesnapshots) has been called.</span></span> <span data-ttu-id="52df1-108">Si se anula una instantánea o se produce un error antes de este punto, el proveedor no recibirá ninguna indicación hasta que se inicie una nueva instantánea.</span><span class="sxs-lookup"><span data-stu-id="52df1-108">If a shadow copy is aborted or fails before this point, the provider is not given any indication until a new shadow copy is started.</span></span> <span data-ttu-id="52df1-109">Por esta razón, el proveedor debe estar preparado para controlar una llamada fuera de secuencia a [**IVssHardwareSnapshotProvider:: BeginPrepareSnapshot**](/windows/desktop/api/VsProv/nf-vsprov-ivsshardwaresnapshotprovider-beginpreparesnapshot) en cualquier momento.</span><span class="sxs-lookup"><span data-stu-id="52df1-109">For this reason, the provider must be prepared to handle an out-of-sequence call to [**IVssHardwareSnapshotProvider::BeginPrepareSnapshot**](/windows/desktop/api/VsProv/nf-vsprov-ivsshardwaresnapshotprovider-beginpreparesnapshot) at any point.</span></span> <span data-ttu-id="52df1-110">Esta llamada fuera de secuencia representa el inicio de una nueva secuencia de instantáneas y tendrá un nuevo identificador de conjunto de instantáneas.</span><span class="sxs-lookup"><span data-stu-id="52df1-110">This out-of-sequence call represents the start of a new shadow copy sequence and will have a new shadow copy set ID.</span></span>

 

 



