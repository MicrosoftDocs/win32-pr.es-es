---
title: IStorage-Compound la implementación de archivos
description: La implementación de archivo compuesto de IStorage le permite crear y administrar subalmacenamientos y secuencias en un objeto de almacenamiento que reside en un objeto de archivo compuesto.
ms.assetid: 2a2253f6-d3d3-403e-a9ba-53a541c7a31e
keywords:
- IStorage Strctd STG, implementación de archivo compuesto
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8bf37b24a7c68bbe357d99f94e666bfcb613c472
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "105665835"
---
# <a name="istorage-compound-file-implementation"></a><span data-ttu-id="7d2bc-104">IStorage-Compound la implementación de archivos</span><span class="sxs-lookup"><span data-stu-id="7d2bc-104">IStorage-Compound File Implementation</span></span>

<span data-ttu-id="7d2bc-105">La implementación de archivo compuesto de [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) le permite crear y administrar subalmacenamientos y secuencias en un objeto de almacenamiento que reside en un objeto de archivo compuesto.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-105">The compound file implementation of [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) allows you to create and manage substorages and streams within a storage object residing in a compound file object.</span></span> <span data-ttu-id="7d2bc-106">Para crear un objeto de archivo compuesto y obtener un puntero **IStorage** , llame a la función de API [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex).</span><span class="sxs-lookup"><span data-stu-id="7d2bc-106">To create a compound file object and get an **IStorage** pointer, call the API function [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex).</span></span> <span data-ttu-id="7d2bc-107">Para abrir un objeto de archivo compuesto existente y obtener su puntero de **IStorage** raíz, llame a [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex).</span><span class="sxs-lookup"><span data-stu-id="7d2bc-107">To open an existing compound file object and get its root **IStorage** pointer, call [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex).</span></span>

<span data-ttu-id="7d2bc-108">Las aplicaciones que usan almacenamiento compuesto deben registrarse en \_ las clases HKEY \_ raíz \\ SystemFileAssociations y deben proporcionar sus propios controladores de propiedades.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-108">Applications that use compound storage should be registered in HKEY\_CLASSES\_ROOT\\SystemFileAssociations and should provide their own property handlers.</span></span> <span data-ttu-id="7d2bc-109">Para obtener más información, vea la sección "registrar verbos y otros datos de Asociación de archivos" del [registro de aplicaciones](/windows/desktop/shell/app-registration).</span><span class="sxs-lookup"><span data-stu-id="7d2bc-109">For more information, see the "Registering Verbs and Other File Association Information" section of [Application Registration](/windows/desktop/shell/app-registration).</span></span>

## <a name="when-to-use"></a><span data-ttu-id="7d2bc-110">Cuándo usar</span><span class="sxs-lookup"><span data-stu-id="7d2bc-110">When to Use</span></span>

<span data-ttu-id="7d2bc-111">La mayoría de las aplicaciones usan esta implementación para crear y administrar almacenamientos y secuencias.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-111">Most applications use this implementation to create and manage storages and streams.</span></span>

## <a name="methods"></a><span data-ttu-id="7d2bc-112">Métodos</span><span class="sxs-lookup"><span data-stu-id="7d2bc-112">Methods</span></span>

<dl> <dt>

<span data-ttu-id="7d2bc-113"><span id="IStorage__CreateStream"></span><span id="istorage__createstream"></span><span id="ISTORAGE__CREATESTREAM"></span>[**IStorage:: CreateStream (**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstream)</span><span class="sxs-lookup"><span data-stu-id="7d2bc-113"><span id="IStorage__CreateStream"></span><span id="istorage__createstream"></span><span id="ISTORAGE__CREATESTREAM"></span>[**IStorage::CreateStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstream)</span></span>
</dt> <dd>

<span data-ttu-id="7d2bc-114">Crea y abre un objeto de flujo con el nombre especificado que contiene este objeto de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-114">Creates and opens a stream object with the specified name contained in this storage object.</span></span> <span data-ttu-id="7d2bc-115">El nombre no debe superar los 31 caracteres de longitud (sin incluir el terminador de cadena).</span><span class="sxs-lookup"><span data-stu-id="7d2bc-115">The name must not exceed 31 characters in length (not including the string terminator).</span></span> <span data-ttu-id="7d2bc-116">Los caracteres 000 a 01f, que actúan como el primer carácter del nombre de la secuencia/almacenamiento, se reservan para uso de OLE.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-116">The 000 through 01f characters, serving as the first character of the stream/storage name, are reserved for use by OLE.</span></span> <span data-ttu-id="7d2bc-117">Es una restricción de archivo compuesto, no una restricción de almacenamiento estructurado.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-117">This is a compound file restriction, not a structured storage restriction.</span></span> <span data-ttu-id="7d2bc-118">La implementación de archivo compuesto proporcionado por COM del método [**IStorage:: CreateStream (**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstream) no admite los siguientes comportamientos:</span><span class="sxs-lookup"><span data-stu-id="7d2bc-118">The COM-provided compound file implementation of the [**IStorage::CreateStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstream) method does not support the following behaviors:</span></span>

-   <span data-ttu-id="7d2bc-119">\_No se admite la marca DELETEONRELEASE de STGM.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-119">The STGM\_DELETEONRELEASE flag is not supported.</span></span>
-   <span data-ttu-id="7d2bc-120">El modo de transacción (STGM \_ ) no se admite para los objetos de secuencia.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-120">Transacted mode (STGM\_TRANSACTED) is not supported for stream objects.</span></span>
-   <span data-ttu-id="7d2bc-121">No se admite la apertura de la misma secuencia más de una vez desde el mismo almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-121">Opening the same stream more than once from the same storage is not supported.</span></span> <span data-ttu-id="7d2bc-122">La \_ marca de modo de uso compartido exclusivo del recurso compartido STGM \_ debe especificarse en el parámetro *grfMode* .</span><span class="sxs-lookup"><span data-stu-id="7d2bc-122">The STGM\_SHARE\_EXCLUSIVE sharing-mode flag must be specified in the *grfMode* parameter.</span></span>

</dd> <dt>

<span data-ttu-id="7d2bc-123"><span id="IStorage__OpenStream"></span><span id="istorage__openstream"></span><span id="ISTORAGE__OPENSTREAM"></span>[**IStorage:: OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream)</span><span class="sxs-lookup"><span data-stu-id="7d2bc-123"><span id="IStorage__OpenStream"></span><span id="istorage__openstream"></span><span id="ISTORAGE__OPENSTREAM"></span>[**IStorage::OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream)</span></span>
</dt> <dd>

<span data-ttu-id="7d2bc-124">Abre un objeto de flujo existente dentro de este objeto de almacenamiento mediante los modos de acceso especificados en el parámetro *grfMode* .</span><span class="sxs-lookup"><span data-stu-id="7d2bc-124">Opens an existing stream object within this storage object using the access modes specified in the *grfMode* parameter.</span></span> <span data-ttu-id="7d2bc-125">Los caracteres 000 a 01f, que actúan como el primer carácter del nombre de la secuencia/almacenamiento, se reservan para uso de OLE.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-125">The 000 through 01f characters, serving as the first character of the stream/storage name, are reserved for use by OLE.</span></span> <span data-ttu-id="7d2bc-126">Es una restricción de archivo compuesto, no una restricción de almacenamiento estructurado.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-126">This is a compound file restriction, not a structured storage restriction.</span></span> <span data-ttu-id="7d2bc-127">La implementación del archivo compuesto proporcionado por COM del método [**IStorage:: OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) no admite el comportamiento siguiente:</span><span class="sxs-lookup"><span data-stu-id="7d2bc-127">The COM-provided compound file implementation of the [**IStorage::OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) method does not support the following behavior:</span></span>

-   <span data-ttu-id="7d2bc-128">\_Marca DELETEONRELEASE de STGM.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-128">The STGM\_DELETEONRELEASE flag.</span></span>
-   <span data-ttu-id="7d2bc-129">Modo de transacción (STGM \_ TRANSaccional) para objetos de secuencia.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-129">Transacted mode (STGM\_TRANSACTED) for stream objects.</span></span>
-   <span data-ttu-id="7d2bc-130">Abrir el mismo flujo más de una vez desde el mismo almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-130">Opening the same stream more than once from the same storage.</span></span> <span data-ttu-id="7d2bc-131">\_Se debe especificar la marca de uso compartido STGM \_ .</span><span class="sxs-lookup"><span data-stu-id="7d2bc-131">The STGM\_SHARE\_EXCLUSIVE flag must be specified.</span></span>

</dd> <dt>

<span data-ttu-id="7d2bc-132"><span id="IStorage__CreateStorage"></span><span id="istorage__createstorage"></span><span id="ISTORAGE__CREATESTORAGE"></span>[**IStorage:: CreateStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstorage)</span><span class="sxs-lookup"><span data-stu-id="7d2bc-132"><span id="IStorage__CreateStorage"></span><span id="istorage__createstorage"></span><span id="ISTORAGE__CREATESTORAGE"></span>[**IStorage::CreateStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstorage)</span></span>
</dt> <dd>

<span data-ttu-id="7d2bc-133">Crea y abre un nuevo objeto de almacenamiento con el nombre especificado en el modo de acceso especificado.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-133">Creates and opens a new storage object with the specified name in the specified access mode.</span></span> <span data-ttu-id="7d2bc-134">El nombre no debe superar los 31 caracteres de longitud (sin incluir el terminador de cadena).</span><span class="sxs-lookup"><span data-stu-id="7d2bc-134">The name must not exceed 31 characters in length (not including the string terminator).</span></span> <span data-ttu-id="7d2bc-135">Los caracteres 000 a 01f, que actúan como el primer carácter del nombre de la secuencia/almacenamiento, se reservan para uso de OLE.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-135">The 000 through 01f characters, serving as the first character of the stream/storage name, are reserved for use by OLE.</span></span> <span data-ttu-id="7d2bc-136">Es una restricción de archivo compuesto, no una restricción de almacenamiento estructurado.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-136">This is a compound file restriction, not a structured storage restriction.</span></span> <span data-ttu-id="7d2bc-137">La implementación del archivo compuesto proporcionado por COM del método [**IStorage:: CreateStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstorage) no admite el comportamiento siguiente:</span><span class="sxs-lookup"><span data-stu-id="7d2bc-137">The COM-provided compound file implementation of the [**IStorage::CreateStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstorage) method does not support the following behavior:</span></span>

-   <span data-ttu-id="7d2bc-138">\_Marca de prioridad de STGM para los almacenamientos no raíz.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-138">The STGM\_PRIORITY flag for nonroot storages.</span></span>
-   <span data-ttu-id="7d2bc-139">Abrir el mismo objeto de almacenamiento más de una vez desde el mismo almacenamiento primario.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-139">Opening the same storage object more than once from the same parent storage.</span></span> <span data-ttu-id="7d2bc-140">\_Se debe especificar la marca de uso compartido STGM \_ .</span><span class="sxs-lookup"><span data-stu-id="7d2bc-140">The STGM\_SHARE\_EXCLUSIVE flag must be specified.</span></span>
-   <span data-ttu-id="7d2bc-141">\_Marca DELETEONRELEASE de STGM.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-141">The STGM\_DELETEONRELEASE flag.</span></span> <span data-ttu-id="7d2bc-142">Si se especifica esta marca, la función devuelve STG \_ E \_ INVALIDFLAG.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-142">If this flag is specified, the function returns STG\_E\_INVALIDFLAG.</span></span>

</dd> <dt>

<span data-ttu-id="7d2bc-143"><span id="IStorage__OpenStorage"></span><span id="istorage__openstorage"></span><span id="ISTORAGE__OPENSTORAGE"></span>[**IStorage:: OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage)</span><span class="sxs-lookup"><span data-stu-id="7d2bc-143"><span id="IStorage__OpenStorage"></span><span id="istorage__openstorage"></span><span id="ISTORAGE__OPENSTORAGE"></span>[**IStorage::OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage)</span></span>
</dt> <dd>

<span data-ttu-id="7d2bc-144">Abre un objeto de almacenamiento existente con el nombre especificado en el modo de acceso especificado.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-144">Opens an existing storage object with the specified name in the specified access mode.</span></span> <span data-ttu-id="7d2bc-145">Los caracteres 000 a 01f, que actúan como el primer carácter del nombre de la secuencia/almacenamiento, se reservan para uso de OLE.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-145">The 000 through 01f characters, serving as the first character of the stream/storage name, are reserved for use by OLE.</span></span> <span data-ttu-id="7d2bc-146">Es una restricción de archivo compuesto, no una restricción de almacenamiento estructurado.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-146">This is a compound file restriction, not a structured storage restriction.</span></span> <span data-ttu-id="7d2bc-147">La implementación del archivo compuesto proporcionado por COM del método [**IStorage:: OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) no admite el comportamiento siguiente:</span><span class="sxs-lookup"><span data-stu-id="7d2bc-147">The COM-provided compound file implementation of the [**IStorage::OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) method does not support the following behavior:</span></span>

-   <span data-ttu-id="7d2bc-148">\_Marca de prioridad de STGM para los almacenamientos no raíz.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-148">The STGM\_PRIORITY flag for nonroot storages.</span></span>
-   <span data-ttu-id="7d2bc-149">Abrir el mismo objeto de almacenamiento más de una vez desde el mismo almacenamiento primario.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-149">Opening the same storage object more than once from the same parent storage.</span></span> <span data-ttu-id="7d2bc-150">\_Se debe especificar la marca de uso compartido STGM \_ .</span><span class="sxs-lookup"><span data-stu-id="7d2bc-150">The STGM\_SHARE\_EXCLUSIVE flag must be specified.</span></span>
-   <span data-ttu-id="7d2bc-151">\_Marca DELETEONRELEASE de STGM.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-151">The STGM\_DELETEONRELEASE flag.</span></span> <span data-ttu-id="7d2bc-152">Si se especifica esta marca, la función devuelve STG \_ E \_ INVALIDFUNCTION.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-152">If this flag is specified, the function returns STG\_E\_INVALIDFUNCTION.</span></span>

</dd> <dt>

<span data-ttu-id="7d2bc-153"><span id="IStorage__CopyTo"></span><span id="istorage__copyto"></span><span id="ISTORAGE__COPYTO"></span>[**IStorage:: CopyTo**](/windows/desktop/api/Objidl/nf-objidl-istorage-copyto)</span><span class="sxs-lookup"><span data-stu-id="7d2bc-153"><span id="IStorage__CopyTo"></span><span id="istorage__copyto"></span><span id="ISTORAGE__COPYTO"></span>[**IStorage::CopyTo**](/windows/desktop/api/Objidl/nf-objidl-istorage-copyto)</span></span>
</dt> <dd>

<span data-ttu-id="7d2bc-154">Copia solo los subalmacénes y las secuencias de este objeto de almacenamiento abierto en otro objeto de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-154">Copies only the substorages and streams of this open storage object into another storage object.</span></span> <span data-ttu-id="7d2bc-155">El parámetro *rgiidExclude* se puede establecer en IID \_ IStream para copiar solo los subalmacenamientos o en IID \_ IStorage para copiar solo flujos.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-155">The *rgiidExclude* parameter can be set to IID\_IStream to copy only substorages, or to IID\_IStorage to copy only streams.</span></span>

</dd> <dt>

<span data-ttu-id="7d2bc-156"><span id="IStorage__MoveElementTo"></span><span id="istorage__moveelementto"></span><span id="ISTORAGE__MOVEELEMENTTO"></span>[**IStorage:: MoveElementTo**](/windows/desktop/api/Objidl/nf-objidl-istorage-moveelementto)</span><span class="sxs-lookup"><span data-stu-id="7d2bc-156"><span id="IStorage__MoveElementTo"></span><span id="istorage__moveelementto"></span><span id="ISTORAGE__MOVEELEMENTTO"></span>[**IStorage::MoveElementTo**](/windows/desktop/api/Objidl/nf-objidl-istorage-moveelementto)</span></span>
</dt> <dd>

<span data-ttu-id="7d2bc-157">Copia o mueve un subalmacenamiento o secuencia de este objeto de almacenamiento a otro objeto de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-157">Copies or moves a substorage or stream from this storage object to another storage object.</span></span>

</dd> <dt>

<span data-ttu-id="7d2bc-158"><span id="IStorage__Commit"></span><span id="istorage__commit"></span><span id="ISTORAGE__COMMIT"></span>[**IStorage:: commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit)</span><span class="sxs-lookup"><span data-stu-id="7d2bc-158"><span id="IStorage__Commit"></span><span id="istorage__commit"></span><span id="ISTORAGE__COMMIT"></span>[**IStorage::Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit)</span></span>
</dt> <dd>

<span data-ttu-id="7d2bc-159">Garantiza que los cambios realizados en un objeto de almacenamiento abierto en modo de transacción se reflejan en el almacenamiento principal. para un almacenamiento raíz, refleja los cambios en el dispositivo real; por ejemplo, un archivo en disco.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-159">Ensures that any changes made to a storage object open in transacted mode are reflected in the parent storage; for a root storage, reflects the changes in the actual device; for example, a file on disk.</span></span> <span data-ttu-id="7d2bc-160">Para un objeto de almacenamiento raíz abierto en modo directo, este método no tiene ningún efecto excepto para vaciar todos los búferes de memoria en el disco.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-160">For a root storage object opened in direct mode, this method has no effect except to flush all memory buffers to the disk.</span></span> <span data-ttu-id="7d2bc-161">En el caso de los objetos de almacenamiento no raíz en modo directo, este método no tiene ningún efecto.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-161">For nonroot storage objects in direct mode, this method has no effect.</span></span>

<span data-ttu-id="7d2bc-162">La implementación de archivos compuestos proporcionados por COM usa un proceso de confirmación en dos fases, a menos que \_ se especifique STGC overwrite en el parámetro *grfCommitFlags* .</span><span class="sxs-lookup"><span data-stu-id="7d2bc-162">The COM-provided compound files implementation uses a two-phase commit process unless STGC\_OVERWRITE is specified in the *grfCommitFlags* parameter.</span></span> <span data-ttu-id="7d2bc-163">Este proceso en dos fases garantiza la solidez de los datos, en caso de que se produzca un error en la operación de confirmación.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-163">This two-phase process ensures the robustness of data, in case the commit operation fails.</span></span> <span data-ttu-id="7d2bc-164">En primer lugar, todos los datos nuevos se escriben en el espacio no utilizado del archivo subyacente.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-164">First, all new data is written to unused space in the underlying file.</span></span> <span data-ttu-id="7d2bc-165">Si es necesario, se asigna un nuevo espacio al archivo.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-165">If necessary, new space is allocated to the file.</span></span> <span data-ttu-id="7d2bc-166">Una vez completado este paso, se actualiza una tabla del archivo mediante una operación de escritura de un solo sector para indicar que los nuevos datos se van a utilizar en lugar del antiguo.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-166">After this step has been completed, a table in the file is updated using a single-sector write operation to indicate that the new data is to be used in place of the old.</span></span> <span data-ttu-id="7d2bc-167">Los datos antiguos se convierten en el espacio libre que se va a usar en la siguiente operación de confirmación.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-167">The old data becomes free space to be used at the next commit operation.</span></span> <span data-ttu-id="7d2bc-168">Por lo tanto, los datos antiguos están disponibles y se pueden restaurar si se produce un error al confirmar los cambios.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-168">Thus, the old data is available and can be restored if an error occurs when committing changes.</span></span> <span data-ttu-id="7d2bc-169">Si \_ se especifica STGC overwrite, se usa una operación de confirmación de fase única.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-169">If STGC\_OVERWRITE is specified, a single phase commit operation is used.</span></span> <span data-ttu-id="7d2bc-170">Para obtener más información sobre las marcas del modo de transacción, consulte enumeración [**STGC**](/windows/win32/api/wtypes/ne-wtypes-stgc) .</span><span class="sxs-lookup"><span data-stu-id="7d2bc-170">For more information about transacted mode flags, see [**STGC**](/windows/win32/api/wtypes/ne-wtypes-stgc) enumeration.</span></span>

</dd> <dt>

<span data-ttu-id="7d2bc-171"><span id="IStorage__Revert"></span><span id="istorage__revert"></span><span id="ISTORAGE__REVERT"></span>[**IStorage:: revert**](/windows/desktop/api/Objidl/nf-objidl-istorage-revert)</span><span class="sxs-lookup"><span data-stu-id="7d2bc-171"><span id="IStorage__Revert"></span><span id="istorage__revert"></span><span id="ISTORAGE__REVERT"></span>[**IStorage::Revert**](/windows/desktop/api/Objidl/nf-objidl-istorage-revert)</span></span>
</dt> <dd>

<span data-ttu-id="7d2bc-172">Descarta todos los cambios realizados en el objeto de almacenamiento desde la última operación de confirmación.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-172">Discards all changes that have been made to the storage object since the last commit operation.</span></span>

</dd> <dt>

<span data-ttu-id="7d2bc-173"><span id="IStorage__EnumElements"></span><span id="istorage__enumelements"></span><span id="ISTORAGE__ENUMELEMENTS"></span>[**IStorage:: EnumElements**](/windows/desktop/api/Objidl/nf-objidl-istorage-enumelements)</span><span class="sxs-lookup"><span data-stu-id="7d2bc-173"><span id="IStorage__EnumElements"></span><span id="istorage__enumelements"></span><span id="ISTORAGE__ENUMELEMENTS"></span>[**IStorage::EnumElements**](/windows/desktop/api/Objidl/nf-objidl-istorage-enumelements)</span></span>
</dt> <dd>

<span data-ttu-id="7d2bc-174">Crea y recupera un puntero a un objeto de enumerador que se puede utilizar para enumerar los objetos de almacenamiento y de secuencia contenidos en este objeto de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-174">Creates and retrieves a pointer to an enumerator object that can be used to enumerate the storage and stream objects contained within this storage object.</span></span> <span data-ttu-id="7d2bc-175">La implementación de archivo compuesto proporcionado por COM toma una instantánea de esa información.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-175">The COM-provided compound file implementation takes a snapshot of that information.</span></span> <span data-ttu-id="7d2bc-176">Por lo tanto, los cambios en las secuencias y los almacenamientos no se reflejan en el enumerador hasta que se obtiene un nuevo enumerador.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-176">Therefore, changes to the streams and storages are not reflected in the enumerator until a new enumerator is obtained.</span></span>

</dd> <dt>

<span data-ttu-id="7d2bc-177"><span id="IStorage__DestroyElement"></span><span id="istorage__destroyelement"></span><span id="ISTORAGE__DESTROYELEMENT"></span>[**IStorage::D estroyElement**](/windows/desktop/api/Objidl/nf-objidl-istorage-destroyelement)</span><span class="sxs-lookup"><span data-stu-id="7d2bc-177"><span id="IStorage__DestroyElement"></span><span id="istorage__destroyelement"></span><span id="ISTORAGE__DESTROYELEMENT"></span>[**IStorage::DestroyElement**](/windows/desktop/api/Objidl/nf-objidl-istorage-destroyelement)</span></span>
</dt> <dd>

<span data-ttu-id="7d2bc-178">Quita el elemento especificado (substorage o Stream) de este objeto de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-178">Removes the specified element (substorage or stream) from this storage object.</span></span>

</dd> <dt>

<span data-ttu-id="7d2bc-179"><span id="IStorage__RenameElement"></span><span id="istorage__renameelement"></span><span id="ISTORAGE__RENAMEELEMENT"></span>[**IStorage:: RenameElement**](/windows/desktop/api/Objidl/nf-objidl-istorage-renameelement)</span><span class="sxs-lookup"><span data-stu-id="7d2bc-179"><span id="IStorage__RenameElement"></span><span id="istorage__renameelement"></span><span id="ISTORAGE__RENAMEELEMENT"></span>[**IStorage::RenameElement**](/windows/desktop/api/Objidl/nf-objidl-istorage-renameelement)</span></span>
</dt> <dd>

<span data-ttu-id="7d2bc-180">Cambia el nombre de la secuencia o el subalmacenamiento especificado en este objeto de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-180">Renames the specified substorage or stream in this storage object.</span></span> <span data-ttu-id="7d2bc-181">Los caracteres 000 a 01f, que actúan como el primer carácter del nombre de la secuencia/almacenamiento, se reservan para uso de OLE.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-181">The 000 through 01f characters, serving as the first character of the stream/storage name, are reserved for use by OLE.</span></span> <span data-ttu-id="7d2bc-182">Es una restricción de archivo compuesto, no una restricción de almacenamiento estructurado.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-182">This is a compound file restriction, not a structured storage restriction.</span></span>

</dd> <dt>

<span data-ttu-id="7d2bc-183"><span id="IStorage__SetElementTimes"></span><span id="istorage__setelementtimes"></span><span id="ISTORAGE__SETELEMENTTIMES"></span>[**IStorage:: SetElementTimes**](/windows/desktop/api/Objidl/nf-objidl-istorage-setelementtimes)</span><span class="sxs-lookup"><span data-stu-id="7d2bc-183"><span id="IStorage__SetElementTimes"></span><span id="istorage__setelementtimes"></span><span id="ISTORAGE__SETELEMENTTIMES"></span>[**IStorage::SetElementTimes**](/windows/desktop/api/Objidl/nf-objidl-istorage-setelementtimes)</span></span>
</dt> <dd>

<span data-ttu-id="7d2bc-184">Establece las horas de modificación, acceso y creación del elemento de almacenamiento especificado.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-184">Sets the modification, access, and creation times of the specified storage element.</span></span> <span data-ttu-id="7d2bc-185">La implementación de archivo compuesto proporcionado por COM mantiene las horas de modificación y cambio de los objetos de almacenamiento interno.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-185">The COM-provided compound-file implementation maintains modification and change times for internal storage objects.</span></span> <span data-ttu-id="7d2bc-186">Los objetos de almacenamiento raíz admiten lo que admita el sistema de archivos subyacente (o por [**ILockBytes**](/windows/desktop/api/Objidl/nn-objidl-ilockbytes)).</span><span class="sxs-lookup"><span data-stu-id="7d2bc-186">Root storage objects support whatever is supported by the underlying file system (or by [**ILockBytes**](/windows/desktop/api/Objidl/nn-objidl-ilockbytes)).</span></span> <span data-ttu-id="7d2bc-187">La implementación de archivo compuesto no mantiene ninguna marca de tiempo para las secuencias internas.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-187">The compound file implementation does not maintain any time stamps for internal streams.</span></span> <span data-ttu-id="7d2bc-188">Las marcas de tiempo no admitidas se muestran como cero, lo que permite al autor de la llamada probar la compatibilidad.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-188">Unsupported time stamps are reported as zero, which allows the caller to test for support.</span></span>

</dd> <dt>

<span data-ttu-id="7d2bc-189"><span id="IStorage__SetClass"></span><span id="istorage__setclass"></span><span id="ISTORAGE__SETCLASS"></span>[**IStorage:: SetClass**](/windows/desktop/api/Objidl/nf-objidl-istorage-setclass)</span><span class="sxs-lookup"><span data-stu-id="7d2bc-189"><span id="IStorage__SetClass"></span><span id="istorage__setclass"></span><span id="ISTORAGE__SETCLASS"></span>[**IStorage::SetClass**](/windows/desktop/api/Objidl/nf-objidl-istorage-setclass)</span></span>
</dt> <dd>

<span data-ttu-id="7d2bc-190">Asigna el CLSID especificado a este objeto de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-190">Assigns the specified CLSID to this storage object.</span></span>

</dd> <dt>

<span data-ttu-id="7d2bc-191"><span id="IStorage__SetStateBits"></span><span id="istorage__setstatebits"></span><span id="ISTORAGE__SETSTATEBITS"></span>[**IStorage:: SetStateBits**](/windows/desktop/api/Objidl/nf-objidl-istorage-setstatebits)</span><span class="sxs-lookup"><span data-stu-id="7d2bc-191"><span id="IStorage__SetStateBits"></span><span id="istorage__setstatebits"></span><span id="ISTORAGE__SETSTATEBITS"></span>[**IStorage::SetStateBits**](/windows/desktop/api/Objidl/nf-objidl-istorage-setstatebits)</span></span>
</dt> <dd>

<span data-ttu-id="7d2bc-192">Almacena hasta 32 bits de información de estado en este objeto de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-192">Stores up to 32 bits of state information in this storage object.</span></span> <span data-ttu-id="7d2bc-193">El estado establecido por este método es solo para uso externo.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-193">The state set by this method is for external use only.</span></span> <span data-ttu-id="7d2bc-194">La implementación del archivo compuesto proporcionado por COM no realiza ninguna acción basada en el estado.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-194">The COM-provided compound file implementation does not perform any action based on the state.</span></span>

</dd> <dt>

<span data-ttu-id="7d2bc-195"><span id="IStorage__Stat"></span><span id="istorage__stat"></span><span id="ISTORAGE__STAT"></span>[**IStorage:: Stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat)</span><span class="sxs-lookup"><span data-stu-id="7d2bc-195"><span id="IStorage__Stat"></span><span id="istorage__stat"></span><span id="ISTORAGE__STAT"></span>[**IStorage::Stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat)</span></span>
</dt> <dd>

<span data-ttu-id="7d2bc-196">Recupera la estructura [**STATSTG**](/windows/win32/api/objidl/ns-objidl-statstg) para este objeto de almacenamiento abierto.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-196">Retrieves the [**STATSTG**](/windows/win32/api/objidl/ns-objidl-statstg) structure for this open storage object.</span></span>

</dd> </dl>

## <a name="remarks"></a><span data-ttu-id="7d2bc-197">Observaciones</span><span class="sxs-lookup"><span data-stu-id="7d2bc-197">Remarks</span></span>

<span data-ttu-id="7d2bc-198">Si el objeto de almacenamiento se abre en modo simple, el uso de los métodos anteriores está restringido.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-198">If the storage object is opened in simple mode, use of the above methods is restricted.</span></span> <span data-ttu-id="7d2bc-199">Un almacenamiento está en modo simple si se abre con el \_ elemento simple STGM especificado en el parámetro *grfMode* de la función [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) o [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) .</span><span class="sxs-lookup"><span data-stu-id="7d2bc-199">A storage is in simple mode if it is opened with the STGM\_SIMPLE element specified in the *grfMode* parameter of the [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) function.</span></span> <span data-ttu-id="7d2bc-200">Para obtener más información acerca de los almacenamientos de modo simple, vea [**constantes STGM**](stgm-constants.md).</span><span class="sxs-lookup"><span data-stu-id="7d2bc-200">For more information about simple-mode storages, see [**STGM Constants**](stgm-constants.md).</span></span> <span data-ttu-id="7d2bc-201">Si el objeto de almacenamiento de modo simple se obtuvo de la función **StgCreateStorageEx** , se puede llamar al método [**CreateStream (**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstream) , pero el método [**OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) no.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-201">If the simple-mode storage object was obtained from the **StgCreateStorageEx** function, then the [**CreateStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstream) method can be called but the [**OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) method cannot.</span></span> <span data-ttu-id="7d2bc-202">Si se obtuvo el objeto de almacenamiento en modo simple de la función **StgOpenStorageEx** , se puede llamar al método **OpenStream** , pero el método **CreateStream (** no.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-202">If the simple mode storage object was obtained from the **StgOpenStorageEx** function, then the **OpenStream** method can be called but the **CreateStream** method cannot.</span></span>

<span data-ttu-id="7d2bc-203">Cuando se usa un objeto de almacenamiento de modo simple para crear una secuencia, el tamaño mínimo de la secuencia suele ser de 4096 bytes.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-203">When a simple-mode storage object is used to create a stream, the minimum size of that stream typically is 4096 bytes.</span></span> <span data-ttu-id="7d2bc-204">Si se escriben menos datos en la secuencia, el tamaño se redondea hasta 4096 bytes.</span><span class="sxs-lookup"><span data-stu-id="7d2bc-204">If less data is written to the stream, the size is rounded up to 4096 bytes.</span></span>

## <a name="related-topics"></a><span data-ttu-id="7d2bc-205">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="7d2bc-205">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="7d2bc-206">Límites de implementación de archivos compuestos</span><span class="sxs-lookup"><span data-stu-id="7d2bc-206">Compound File Implementation Limits</span></span>](structured-storage-interfaces.md)
</dt> <dt>

[<span data-ttu-id="7d2bc-207">**IFillLockBytes**</span><span class="sxs-lookup"><span data-stu-id="7d2bc-207">**IFillLockBytes**</span></span>](/windows/desktop/api/Objidl/nn-objidl-ifilllockbytes)
</dt> <dt>

[<span data-ttu-id="7d2bc-208">**ILockBytes**</span><span class="sxs-lookup"><span data-stu-id="7d2bc-208">**ILockBytes**</span></span>](/windows/desktop/api/Objidl/nn-objidl-ilockbytes)
</dt> <dt>

[<span data-ttu-id="7d2bc-209">**IRootStorage**</span><span class="sxs-lookup"><span data-stu-id="7d2bc-209">**IRootStorage**</span></span>](/windows/desktop/api/Objidl/nn-objidl-irootstorage)
</dt> <dt>

[<span data-ttu-id="7d2bc-210">**IStorage**</span><span class="sxs-lookup"><span data-stu-id="7d2bc-210">**IStorage**</span></span>](/windows/desktop/api/Objidl/nn-objidl-istorage)
</dt> <dt>

[<span data-ttu-id="7d2bc-211">**IStream**</span><span class="sxs-lookup"><span data-stu-id="7d2bc-211">**IStream**</span></span>](/windows/desktop/api/Objidl/nn-objidl-istream)
</dt> <dt>

[<span data-ttu-id="7d2bc-212">**StgCreateDocfile**</span><span class="sxs-lookup"><span data-stu-id="7d2bc-212">**StgCreateDocfile**</span></span>](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile)
</dt> <dt>

[<span data-ttu-id="7d2bc-213">**StgCreateStorageEx**</span><span class="sxs-lookup"><span data-stu-id="7d2bc-213">**StgCreateStorageEx**</span></span>](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex)
</dt> <dt>

[<span data-ttu-id="7d2bc-214">**StgOpenStorage**</span><span class="sxs-lookup"><span data-stu-id="7d2bc-214">**StgOpenStorage**</span></span>](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage)
</dt> <dt>

[<span data-ttu-id="7d2bc-215">**StgOpenStorageEx**</span><span class="sxs-lookup"><span data-stu-id="7d2bc-215">**StgOpenStorageEx**</span></span>](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex)
</dt> </dl>

 

 