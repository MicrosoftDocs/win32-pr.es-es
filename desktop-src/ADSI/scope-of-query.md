---
title: Ámbito de la consulta
description: El ámbito de una consulta viene determinado por el objeto al que se enlaza.
ms.assetid: 7ece8599-8a4b-45a1-95f4-a4180052f245
ms.tgt_platform: multiple
keywords:
- ámbito de la consulta ADSI
- consultas ADSI, ámbito
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dac51fc261cb418db0018acd996c248766896a25
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/16/2019
ms.locfileid: "103772924"
---
# <a name="scope-of-query"></a><span data-ttu-id="68874-105">Ámbito de la consulta</span><span class="sxs-lookup"><span data-stu-id="68874-105">Scope of Query</span></span>

<span data-ttu-id="68874-106">El ámbito de una consulta viene determinado por el objeto al que se enlaza.</span><span class="sxs-lookup"><span data-stu-id="68874-106">The scope of a query is determined by the object to which you bind.</span></span> <span data-ttu-id="68874-107">Si no está seguro de dónde se encuentra el objeto dentro de la empresa, tendrá que hacer una búsqueda tan ancha como sea posible.</span><span class="sxs-lookup"><span data-stu-id="68874-107">If you are unsure where the object is located within the enterprise then you will need to do as wide a search as possible.</span></span> <span data-ttu-id="68874-108">Sin embargo, si sabe que el objeto se incluirá en un dominio específico, como el dominio al que está conectado el usuario o dentro de un grupo específico, como el grupo administradores, debe establecer el ámbito de la búsqueda para reflejar la circunstancia.</span><span class="sxs-lookup"><span data-stu-id="68874-108">However, if you know that the object will be contained within a specific domain, such as the domain that the user is connected to, or within a specific group, such as the Managers group, then you should set the scope of the search to reflect the circumstance.</span></span> <span data-ttu-id="68874-109">Para obtener el mejor rendimiento, debe intentar establecer como destino el ámbito para buscar el número más pequeño posible de objetos.</span><span class="sxs-lookup"><span data-stu-id="68874-109">For the best performance, you should try to target the scope to search the smallest number of objects possible.</span></span>

<span data-ttu-id="68874-110">Si no está seguro de dónde se ubicará un objeto en la empresa, puede enlazar con el servicio de catálogo global.</span><span class="sxs-lookup"><span data-stu-id="68874-110">When you are not sure where an object will be located in the enterprise, you can bind to the global catalog service.</span></span> <span data-ttu-id="68874-111">El servicio de catálogo global contiene una lista de todos los objetos del directorio y un pequeño subconjunto de los atributos de cada objeto.</span><span class="sxs-lookup"><span data-stu-id="68874-111">The global catalog service contains a list of every object in the directory and a small subset of each object's attributes.</span></span> <span data-ttu-id="68874-112">Después de encontrar el objeto en el catálogo global, puede recuperar su nombre distintivo del catálogo global y usarlo para enlazar con el objeto para realizar otras operaciones.</span><span class="sxs-lookup"><span data-stu-id="68874-112">After you find the object in the global catalog, you can retrieve its distinguished name from the global catalog and use it to bind to the object to perform other operations.</span></span>

<span data-ttu-id="68874-113">Después de decidir el objeto al que se va a enlazar, puede restringir aún más la consulta a uno de los siguientes ámbitos: una consulta base, una consulta de un solo nivel o una búsqueda de subárbol, tal como se muestra en la siguiente ilustración.</span><span class="sxs-lookup"><span data-stu-id="68874-113">After you decide which object to bind to, you can further restrict the query to one of the following scopes: a base query, a one-level query, or a subtree search, as shown in the following illustration.</span></span>

![objetos en la raíz de una búsqueda de una búsqueda de base, un nivel o un subárbol](images/netds6.png)

## <a name="base"></a><span data-ttu-id="68874-115">Base</span><span class="sxs-lookup"><span data-stu-id="68874-115">Base</span></span>

<span data-ttu-id="68874-116">Una consulta base limita la búsqueda solo al objeto base.</span><span class="sxs-lookup"><span data-stu-id="68874-116">A base query limits the search to only the base object.</span></span> <span data-ttu-id="68874-117">El número máximo de objetos devueltos es siempre uno.</span><span class="sxs-lookup"><span data-stu-id="68874-117">The maximum number of objects returned is always one.</span></span> <span data-ttu-id="68874-118">Esta búsqueda se puede usar para comprobar la existencia de un objeto.</span><span class="sxs-lookup"><span data-stu-id="68874-118">This search can be used to verify the existence of an object.</span></span> <span data-ttu-id="68874-119">Por ejemplo, si tiene el nombre distintivo de un objeto y debe comprobar la existencia del objeto en función de la ruta de acceso, puede usar una búsqueda de un solo nivel.</span><span class="sxs-lookup"><span data-stu-id="68874-119">For example, if you have an object's distinguished name and you must verify the object's existence based on the path, you can use a one-level search.</span></span> <span data-ttu-id="68874-120">Si se produce un error en la búsqueda, puede suponer que es posible que el objeto se haya cambiado de nombre o se haya pasado a una ubicación diferente, o que se le hayan proporcionado datos incorrectos sobre el objeto.</span><span class="sxs-lookup"><span data-stu-id="68874-120">If the search fails, you can assume that the object may have been renamed or moved to a different location, or that you were given incorrect data about the object.</span></span> <span data-ttu-id="68874-121">Tenga en cuenta que debe almacenar el GUID en lugar del nombre distintivo si desea volver a visitar un objeto.</span><span class="sxs-lookup"><span data-stu-id="68874-121">Be aware that you should store the GUID instead of the distinguished name if you want to revisit an object.</span></span> <span data-ttu-id="68874-122">Esto permite que el objeto se cambie de nombre o se mueva en la jerarquía de directorios sin interrumpir el vínculo almacenado.</span><span class="sxs-lookup"><span data-stu-id="68874-122">This allows the object to be renamed or moved in the directory hierarchy without breaking the persisted link.</span></span>

## <a name="one-level"></a><span data-ttu-id="68874-123">Un nivel</span><span class="sxs-lookup"><span data-stu-id="68874-123">One Level</span></span>

<span data-ttu-id="68874-124">Una búsqueda de un nivel está restringida a los elementos secundarios inmediatos de un objeto base, pero excluye el propio objeto base.</span><span class="sxs-lookup"><span data-stu-id="68874-124">A one-level search is restricted to the immediate children of a base object, but excludes the base object itself.</span></span> <span data-ttu-id="68874-125">Esta configuración puede realizar una búsqueda de destino para los objetos secundarios inmediatos de un objeto primario.</span><span class="sxs-lookup"><span data-stu-id="68874-125">This setting can perform a targeted search for immediate child objects of a parent object.</span></span> <span data-ttu-id="68874-126">Por ejemplo, si tiene un objeto primario denominado P1 y sus elementos secundarios inmediatos son: C1, C2, C3, en una búsqueda de un nivel, se debe incluir C1, C2 y C3 al evaluar los criterios, pero P1 no formará parte de la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="68874-126">For example, if you have a parent object called P1, and its immediate children are: C1, C2, C3, then in a one-level search, C1, C2, and C3 should be included when evaluating the criteria, but P1 would not be part of the search.</span></span> <span data-ttu-id="68874-127">Se puede utilizar una búsqueda de un solo nivel para enumerar todos los elementos secundarios de un objeto.</span><span class="sxs-lookup"><span data-stu-id="68874-127">A one-level search can be used to enumerate all children of an object.</span></span> <span data-ttu-id="68874-128">De hecho, en algunos proveedores ADSI, la enumeración [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) se traduce en una búsqueda de un solo nivel.</span><span class="sxs-lookup"><span data-stu-id="68874-128">In fact, in some ADSI providers, [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) enumeration translates to a one-level search.</span></span>

## <a name="subtree"></a><span data-ttu-id="68874-129">Subárbol</span><span class="sxs-lookup"><span data-stu-id="68874-129">Subtree</span></span>

<span data-ttu-id="68874-130">Una búsqueda de subárbol, también conocida como búsqueda en profundidad, incluye todos los objetos debajo del objeto base, excluido el propio objeto base.</span><span class="sxs-lookup"><span data-stu-id="68874-130">A subtree search, also known as a deep search, includes all the objects beneath the base object, excluding the base object itself.</span></span> <span data-ttu-id="68874-131">Esta búsqueda puede generar referencias a otros servidores.</span><span class="sxs-lookup"><span data-stu-id="68874-131">This search may generate referrals to other servers.</span></span> <span data-ttu-id="68874-132">Esta búsqueda tiene el ámbito más alto y puede devolver un conjunto de resultados grande.</span><span class="sxs-lookup"><span data-stu-id="68874-132">This search has the greatest scope and may return a large result set.</span></span> <span data-ttu-id="68874-133">Si es posible, busque al menos un atributo indexado y establezca la configuración de referencias (para obtener más información, consulte [rendimiento y control de grandes conjuntos de resultados](performance-and-handling-large-result-sets.md)) para que coincida con los requisitos de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="68874-133">If possible, search on at least one indexed attribute and set the referrals settings (for more information, see [Performance and Handling Large Result Sets](performance-and-handling-large-result-sets.md)) to match your search requirements.</span></span> <span data-ttu-id="68874-134">También se sugiere que los resultados de una búsqueda de subárbol se realicen de forma asincrónica y se paginan para reducir la sobrecarga del servidor y la eficacia de la red.</span><span class="sxs-lookup"><span data-stu-id="68874-134">It is also suggested that the results of a subtree search be performed asynchronously and paged to reduce the server overhead and network effectiveness.</span></span> <span data-ttu-id="68874-135">Una búsqueda de subárbol se usa normalmente para buscar objetos en un ámbito determinado.</span><span class="sxs-lookup"><span data-stu-id="68874-135">A subtree search is normally used to search objects for a given scope.</span></span> <span data-ttu-id="68874-136">Por ejemplo, busque todos los usuarios con cuentas que expirarán en 30 días o menos.</span><span class="sxs-lookup"><span data-stu-id="68874-136">For example, search for all users with accounts that will expire in 30 days or less.</span></span>

 

 




