---
description: Usar la reserva de fuentes
ms.assetid: 952f33b6-ca52-40a2-b914-52c1c62ae0e0
title: Usar la reserva de fuentes
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9afb073a01cc1c5b90d4a4861a973846d3ae9ae1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "103819003"
---
# <a name="using-font-fallback"></a><span data-ttu-id="ae0af-103">Usar la reserva de fuentes</span><span class="sxs-lookup"><span data-stu-id="ae0af-103">Using Font Fallback</span></span>

> [!Note]  
> <span data-ttu-id="ae0af-104">En este tema, todos los comentarios sobre [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) se aplican por igual a [**ScriptShapeOpenType**](/windows/desktop/api/Usp10/nf-usp10-scriptshapeopentype).</span><span class="sxs-lookup"><span data-stu-id="ae0af-104">In this topic, all remarks about [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) apply equally to [**ScriptShapeOpenType**](/windows/desktop/api/Usp10/nf-usp10-scriptshapeopentype).</span></span>

 

<span data-ttu-id="ae0af-105">La aplicación debe utilizar la reserva de fuentes durante la presentación de texto si no se admiten algunos caracteres de una cadena en la fuente, o si la aplicación usa un [script complejo](uniscribe-glossary.md) no compatible con la fuente.</span><span class="sxs-lookup"><span data-stu-id="ae0af-105">Your application must use font fallback during text display if some characters in a string are not supported in the font, or if the application uses a [complex script](uniscribe-glossary.md) not supported by the font.</span></span> <span data-ttu-id="ae0af-106">El requisito de reserva de fuentes se detecta durante el proceso de diseño del texto, cuando la aplicación llama a la función [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) .</span><span class="sxs-lookup"><span data-stu-id="ae0af-106">The requirement for font fallback is detected during the layout process for text, when the application calls the [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) function.</span></span> <span data-ttu-id="ae0af-107">Para obtener información acerca de la presentación de texto, consulte [Mostrar texto con Uniscribe](displaying-text-with-uniscribe.md).</span><span class="sxs-lookup"><span data-stu-id="ae0af-107">For information about text display, see [Displaying Text with Uniscribe](displaying-text-with-uniscribe.md).</span></span>

## <a name="determine-the-need-for-font-fallback-for-unsupported-characters"></a><span data-ttu-id="ae0af-108">Determinar la necesidad de reserva de fuentes para los caracteres no admitidos</span><span class="sxs-lookup"><span data-stu-id="ae0af-108">Determine the Need for Font Fallback for Unsupported Characters</span></span>

<span data-ttu-id="ae0af-109">Si algunos de los caracteres de una cadena no se admiten en una fuente solicitada, la llamada de la aplicación a [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) se realizará correctamente.</span><span class="sxs-lookup"><span data-stu-id="ae0af-109">If some of the characters in a string are not supported in a requested font, an application call to [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) succeeds.</span></span> <span data-ttu-id="ae0af-110">Sin embargo, la aplicación debe examinar el búfer de salida del glifo para detectar la presencia de glifos que faltan.</span><span class="sxs-lookup"><span data-stu-id="ae0af-110">However, the application must scan the glyph output buffer for the presence of missing glyphs.</span></span> <span data-ttu-id="ae0af-111">El índice del glifo del glifo que falta se puede determinar para una fuente concreta llamando a [**ScriptGetFontProperties**](/windows/desktop/api/Usp10/nf-usp10-scriptgetfontproperties).</span><span class="sxs-lookup"><span data-stu-id="ae0af-111">The glyph index of the missing glyph can be determined for a specific font by calling [**ScriptGetFontProperties**](/windows/desktop/api/Usp10/nf-usp10-scriptgetfontproperties).</span></span> <span data-ttu-id="ae0af-112">Si un glifo determinado no está disponible, la aplicación debe revertir a una fuente diferente para un glifo o representar un símbolo gráfico que indica que no hay ningún glifo disponible.</span><span class="sxs-lookup"><span data-stu-id="ae0af-112">If a particular glyph is unavailable, the application must either fall back to a different font for a glyph or render a graphic symbol that indicates that no glyph is available.</span></span>

## <a name="determine-the-need-for-font-fallback-for-unsupported-complex-scripts"></a><span data-ttu-id="ae0af-113">Determinar la necesidad de reserva de fuentes para scripts complejos no admitidos</span><span class="sxs-lookup"><span data-stu-id="ae0af-113">Determine the Need for Font Fallback for Unsupported Complex Scripts</span></span>

<span data-ttu-id="ae0af-114">Es posible que la fuente que una aplicación prefiera para su presentación no admita un script complejo requerido por el texto.</span><span class="sxs-lookup"><span data-stu-id="ae0af-114">The font that an application prefers for display might not support a complex script that is required by the text.</span></span> <span data-ttu-id="ae0af-115">En este caso, la llamada de la aplicación a [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) produce un error con el código de error E el \_ script \_ no está en la \_ \_ fuente.</span><span class="sxs-lookup"><span data-stu-id="ae0af-115">In this case, the application call to [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) fails with the error code E\_SCRIPT\_NOT\_IN\_FONT.</span></span>

## <a name="assign-a-fallback-font"></a><span data-ttu-id="ae0af-116">Asignar una fuente de reserva</span><span class="sxs-lookup"><span data-stu-id="ae0af-116">Assign a Fallback Font</span></span>

<span data-ttu-id="ae0af-117">Una vez que haya determinado que se requiere la reserva de fuentes, la aplicación debe asignar una fuente de reserva.</span><span class="sxs-lookup"><span data-stu-id="ae0af-117">Once it has determined that font fallback is required, the application must assign a fallback font.</span></span> <span data-ttu-id="ae0af-118">La aplicación puede probar las técnicas siguientes:</span><span class="sxs-lookup"><span data-stu-id="ae0af-118">The application can try the following techniques:</span></span>

-   <span data-ttu-id="ae0af-119">Llame a [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) para cada fuente de una lista de fuentes hasta que una llamada tenga un valor devuelto aceptable.</span><span class="sxs-lookup"><span data-stu-id="ae0af-119">Call [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) for each font in a font list until one call has an acceptable return.</span></span>
-   <span data-ttu-id="ae0af-120">Llame a [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) con cada fuente de una lista hasta que se pueda determinar que ninguna fuente se realizará correctamente.</span><span class="sxs-lookup"><span data-stu-id="ae0af-120">Call [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) with each font in a list until it can be determined that no font will succeed.</span></span> <span data-ttu-id="ae0af-121">Si el código de error siempre es el \_ script E \_ no está \_ en \_ la fuente, las fuentes no admiten un script complejo.</span><span class="sxs-lookup"><span data-stu-id="ae0af-121">If the error code is always E\_SCRIPT\_NOT\_IN\_FONT, a complex script is not supported by the fonts.</span></span> <span data-ttu-id="ae0af-122">Puede representar un símbolo gráfico que indica que no hay glifo disponible o volver a especificar el script como no definido (sin procesamiento de scripts) y volver a iniciarlo.</span><span class="sxs-lookup"><span data-stu-id="ae0af-122">Either render a graphic symbol that indicates that no glyph is available, or re-specify the script as undefined (no script processing) and start again.</span></span> <span data-ttu-id="ae0af-123">Para establecer el script como sin definir, establezca el miembro **eScript** de la estructura de [**\_ análisis de script**](/windows/win32/api/usp10/ns-usp10-script_analysis) en script \_ sin definir.</span><span class="sxs-lookup"><span data-stu-id="ae0af-123">To set the script as undefined, set the **eScript** member of the [**SCRIPT\_ANALYSIS**](/windows/win32/api/usp10/ns-usp10-script_analysis) structure to SCRIPT\_UNDEFINED.</span></span>
-   <span data-ttu-id="ae0af-124">Llame a [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) con cada fuente de una lista hasta que se pueda determinar que ninguna fuente se realizará correctamente.</span><span class="sxs-lookup"><span data-stu-id="ae0af-124">Call [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) with each font in a list until it can be determined that no font will succeed.</span></span> <span data-ttu-id="ae0af-125">Si el código de error indica que algunos de los caracteres están asignando a los glifos que faltan, divida la cadena en intervalos más pequeños.</span><span class="sxs-lookup"><span data-stu-id="ae0af-125">If the error code indicates that some of the characters are mapping to missing glyphs, break up the string into smaller ranges.</span></span> <span data-ttu-id="ae0af-126">Se pueden asignar fuentes diferentes a los subintervalos para que se puedan representar más caracteres.</span><span class="sxs-lookup"><span data-stu-id="ae0af-126">Different fonts can be assigned to subranges so that more of the characters can be rendered.</span></span>

## <a name="generate-glyph-information"></a><span data-ttu-id="ae0af-127">Generar información de glifo</span><span class="sxs-lookup"><span data-stu-id="ae0af-127">Generate Glyph Information</span></span>

<span data-ttu-id="ae0af-128">Una vez que la aplicación ha asignado una fuente que se ejecuta correctamente en las llamadas a [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape), puede realizar llamadas a [**ScriptPlace**](/windows/desktop/api/Usp10/nf-usp10-scriptplace) para generar el ancho de avance del glifo y la información de desplazamiento bidimensional a partir de la salida de **ScriptShape**.</span><span class="sxs-lookup"><span data-stu-id="ae0af-128">Once the application has assigned a font that succeeds in calls to [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape), it can make calls to [**ScriptPlace**](/windows/desktop/api/Usp10/nf-usp10-scriptplace) to generate glyph advance width and two-dimensional offset information from the output of **ScriptShape**.</span></span> <span data-ttu-id="ae0af-129">La fuente debe realizarse correctamente en estas llamadas.</span><span class="sxs-lookup"><span data-stu-id="ae0af-129">The font should succeed in these calls.</span></span> <span data-ttu-id="ae0af-130">Un error de fuente en una llamada a **ScriptPlace** después de que se realiza correctamente en una llamada a **ScriptShape** indica una fuente rota.</span><span class="sxs-lookup"><span data-stu-id="ae0af-130">A font failure in a call to **ScriptPlace** after success in a **ScriptShape** call indicates a broken font.</span></span>

## <a name="related-topics"></a><span data-ttu-id="ae0af-131">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="ae0af-131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ae0af-132">Usar Uniscribe</span><span class="sxs-lookup"><span data-stu-id="ae0af-132">Using Uniscribe</span></span>](using-uniscribe.md)
</dt> </dl>

 

 



