---
description: En esta sección se describen los archivos. cab en las instalaciones de. Para obtener más información, consulte uso de archivadores y orígenes comprimidos.
ms.assetid: 17ea7f76-90b2-48fb-8187-64dc6d294443
title: Incluir un archivo. cab en una instalación
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 098e660de3f7ec7097ab02613d75219ac0a0d624
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "105652585"
---
# <a name="including-a-cabinet-file-in-an-installation"></a><span data-ttu-id="def3b-104">Incluir un archivo. cab en una instalación</span><span class="sxs-lookup"><span data-stu-id="def3b-104">Including a Cabinet File in an Installation</span></span>

<span data-ttu-id="def3b-105">En esta sección se describen los archivos. cab en las instalaciones de.</span><span class="sxs-lookup"><span data-stu-id="def3b-105">This section describes including cabinet files in installations.</span></span> <span data-ttu-id="def3b-106">Para obtener más información, consulte [uso de archivadores y orígenes comprimidos](using-cabinets-and-compressed-sources.md).</span><span class="sxs-lookup"><span data-stu-id="def3b-106">For more information, see [Using Cabinets and Compressed Sources](using-cabinets-and-compressed-sources.md).</span></span>

<span data-ttu-id="def3b-107">**Para incluir un archivo. cab en un paquete de instalación**</span><span class="sxs-lookup"><span data-stu-id="def3b-107">**To include a cabinet file in a installation package**</span></span>

1.  <span data-ttu-id="def3b-108">Use una herramienta de creación de contenedores para comprimir los archivos de origen en un archivo. cab.</span><span class="sxs-lookup"><span data-stu-id="def3b-108">Use a cabinet creation tool to compress the source files into a cabinet file.</span></span> <span data-ttu-id="def3b-109">Consulte [archivos. cab](cabinet-files.md).</span><span class="sxs-lookup"><span data-stu-id="def3b-109">See [Cabinet Files](cabinet-files.md).</span></span>
2.  <span data-ttu-id="def3b-110">El archivo. cab debe estar ubicado en un flujo de datos dentro del archivo. msi o en un archivo. cab independiente ubicado en la raíz del árbol de origen especificado por la [tabla de directorio](directory-table.md).</span><span class="sxs-lookup"><span data-stu-id="def3b-110">The cabinet file must either be located in a data stream inside the .msi file or in a separate cabinet file located at the root of the source tree specified by the [Directory Table](directory-table.md).</span></span>
3.  <span data-ttu-id="def3b-111">Determine si el origen va a ser un tipo comprimido o un tipo mixto que tiene archivos sin comprimir y comprimidos.</span><span class="sxs-lookup"><span data-stu-id="def3b-111">Determine whether the source is to be a compressed type or a mixed type that has both uncompressed and compressed files.</span></span> <span data-ttu-id="def3b-112">Vea [orígenes comprimidos y sin comprimir](compressed-and-uncompressed-sources.md).</span><span class="sxs-lookup"><span data-stu-id="def3b-112">See [Compressed and Uncompressed Sources](compressed-and-uncompressed-sources.md).</span></span> <span data-ttu-id="def3b-113">Dependiendo del tipo de imagen de origen, establezca los bits de marca comprimido o sin comprimir de la propiedad de [**Resumen de recuento de palabras**](word-count-summary.md) .</span><span class="sxs-lookup"><span data-stu-id="def3b-113">Depending on the type of source image, set the compressed or uncompressed flag bits of the [**Word Count Summary**](word-count-summary.md) Property.</span></span>
4.  <span data-ttu-id="def3b-114">Agregue un registro a la [tabla de archivos](file-table.md) para cada uno de los archivos del archivo. cab.</span><span class="sxs-lookup"><span data-stu-id="def3b-114">Add a record to the [File table](file-table.md) for each of the files in the cabinet.</span></span> <span data-ttu-id="def3b-115">Escriba una clave de archivo en la columna de archivo que coincida exactamente con la clave de archivo del archivo en el archivo. cab.</span><span class="sxs-lookup"><span data-stu-id="def3b-115">Enter a file key in the File column that exactly matches the file key of the file in the cabinet.</span></span> <span data-ttu-id="def3b-116">Las claves de archivo distinguen mayúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="def3b-116">The file keys are case-sensitive.</span></span> <span data-ttu-id="def3b-117">La secuencia de instalación de archivos en la tabla de archivos y el archivo. cab también debe ser la misma.</span><span class="sxs-lookup"><span data-stu-id="def3b-117">The file installation sequence in the File table and the cabinet must also be the same.</span></span> <span data-ttu-id="def3b-118">La secuencia de archivos se especifica mediante el número de secuencia de la columna de secuencia.</span><span class="sxs-lookup"><span data-stu-id="def3b-118">The file sequence is specified by the sequence number in the Sequence column.</span></span> <span data-ttu-id="def3b-119">Para llegar al número de secuencia del primer archivo del archivo. cab, haga lo siguiente.</span><span class="sxs-lookup"><span data-stu-id="def3b-119">To arrive at the sequence number for the first file in the cabinet, do the following.</span></span> <span data-ttu-id="def3b-120">Busque el registro existente en la [tabla de medios](media-table.md) que tenga el valor más alto en la columna de despatín.</span><span class="sxs-lookup"><span data-stu-id="def3b-120">Find the existing record in the [Media table](media-table.md) having the greatest value in the DiskID column.</span></span> <span data-ttu-id="def3b-121">El campo LastSequence de este registro proporciona el último número de secuencia de archivo usado en el medio.</span><span class="sxs-lookup"><span data-stu-id="def3b-121">The LastSequence field of this record gives the last file sequence number used on the media.</span></span> <span data-ttu-id="def3b-122">En la tabla archivo, asigne al primer archivo del nuevo contenedor un número de secuencia que sea mayor que este.</span><span class="sxs-lookup"><span data-stu-id="def3b-122">In the File table, assign the first file of the new cabinet a sequence number that is greater than this.</span></span> <span data-ttu-id="def3b-123">Asigne números de secuencia a todos los archivos restantes en el mismo orden que en el archivo. cab.</span><span class="sxs-lookup"><span data-stu-id="def3b-123">Assign sequence numbers to all of the remaining files in the same order as in the cabinet file.</span></span> <span data-ttu-id="def3b-124">Para obtener una descripción de los campos de registro restantes, vea [File Table](file-table.md).</span><span class="sxs-lookup"><span data-stu-id="def3b-124">For a description of the remaining record fields, see [File table](file-table.md).</span></span>
5.  <span data-ttu-id="def3b-125">Agregue un registro a la [tabla de medios](media-table.md) del archivo. cab.</span><span class="sxs-lookup"><span data-stu-id="def3b-125">Add a record to the [Media table](media-table.md) for the cabinet.</span></span> <span data-ttu-id="def3b-126">Especifique un valor en el campo de patina de este nuevo registro que sea mayor que el valor de dipatine más grande ya existente en la tabla.</span><span class="sxs-lookup"><span data-stu-id="def3b-126">Specify a value in the DiskID field of this new record that is greater than the largest DiskID value already existing in the table.</span></span> <span data-ttu-id="def3b-127">Coloque el nombre del archivo. cab en el campo del archivo. cab.</span><span class="sxs-lookup"><span data-stu-id="def3b-127">Put the name of the cabinet into the Cabinet field.</span></span> <span data-ttu-id="def3b-128">Este nombre debe tener la forma de un tipo de datos de [archivo. cab](cabinet.md) .</span><span class="sxs-lookup"><span data-stu-id="def3b-128">This name must be in the form of a [Cabinet](cabinet.md) data type.</span></span> <span data-ttu-id="def3b-129">Anteponga al nombre un signo de número " \# " si el contenedor es un flujo de datos almacenado en el archivo. msi.</span><span class="sxs-lookup"><span data-stu-id="def3b-129">Prefix the name with a number sign "\#" if the cabinet is a data stream stored in the .msi file.</span></span> <span data-ttu-id="def3b-130">Tenga en cuenta que si el archivo. cab es un flujo de datos, el nombre del contenedor distingue mayúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="def3b-130">Note that if the cabinet is a data stream, the name of the cabinet is case-sensitive.</span></span> <span data-ttu-id="def3b-131">Si el contenedor es un archivo independiente, el nombre del archivo no distingue entre mayúsculas y minúsculas.</span><span class="sxs-lookup"><span data-stu-id="def3b-131">If the cabinet is a separate file, the name of the file is not case-sensitive.</span></span>
6.  <span data-ttu-id="def3b-132">Determine el número de secuencia de archivo más grande en el nuevo archivo. para ello, Compruebe la columna Sequence de la tabla de archivos actualizada.</span><span class="sxs-lookup"><span data-stu-id="def3b-132">Determine the greatest file sequence number in the new cabinet by checking the Sequence column of the updated File table.</span></span> <span data-ttu-id="def3b-133">Escriba un valor que sea mayor que este en el campo LastSequence del nuevo registro de la tabla de medios.</span><span class="sxs-lookup"><span data-stu-id="def3b-133">Enter a value that is greater than this into the LastSequence field of the new record of the Media table.</span></span> <span data-ttu-id="def3b-134">Para obtener una descripción de los campos de registro restantes, consulte [tabla de medios](media-table.md).</span><span class="sxs-lookup"><span data-stu-id="def3b-134">For a description of the remaining record fields, see [Media table](media-table.md).</span></span>
7.  <span data-ttu-id="def3b-135">Puede almacenar el archivo. cab en el paquete de instalación mediante una herramienta como Msidb.exe o mediante las [funciones de base de datos](database-functions.md)del instalador.</span><span class="sxs-lookup"><span data-stu-id="def3b-135">You can store the cabinet file in the installation package either by using a tool such as Msidb.exe or by using the installer's [Database Functions](database-functions.md).</span></span> <span data-ttu-id="def3b-136">En los cuatro pasos siguientes se explica cómo agregar el archivo. cab desde un programa mediante las funciones de base de datos.</span><span class="sxs-lookup"><span data-stu-id="def3b-136">The following four steps explain how to add the cabinet from a program by using the database functions.</span></span>
8.  <span data-ttu-id="def3b-137">Para agregar el archivo. cab al paquete de instalación desde un programa, abra una vista en la [ \_ tabla streams](-streams-table.md) de la base de datos mediante [**MsiDatabaseOpenView**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseopenviewa).</span><span class="sxs-lookup"><span data-stu-id="def3b-137">To add the cabinet to the installation package from a program open a view on the [\_Streams table](-streams-table.md) of the database using [**MsiDatabaseOpenView**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseopenviewa).</span></span>
9.  <span data-ttu-id="def3b-138">Use [**MsiRecordSetString**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstringa) para establecer la columna de nombre de la \_ tabla streams en el nombre que aparece en la columna Cabinet de la [tabla de medios](media-table.md).</span><span class="sxs-lookup"><span data-stu-id="def3b-138">Use [**MsiRecordSetString**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstringa) to set the Name column of the \_Streams table to the name appearing in the Cabinet column of the [Media table](media-table.md).</span></span> <span data-ttu-id="def3b-139">Omita el signo de número: \# .</span><span class="sxs-lookup"><span data-stu-id="def3b-139">Omit the number sign: \#.</span></span>
10. <span data-ttu-id="def3b-140">Use [**MsiRecordSetStream**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstreama) para establecer la columna de datos de la \_ tabla streams en los datos del archivo. cab.</span><span class="sxs-lookup"><span data-stu-id="def3b-140">Use [**MsiRecordSetStream**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstreama) to set the Data column of the \_Streams table to the cabinet's data.</span></span>
11. <span data-ttu-id="def3b-141">Use [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) para actualizar el registro en la \_ tabla streams.</span><span class="sxs-lookup"><span data-stu-id="def3b-141">Use [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) to update the record in the \_Streams table.</span></span>
12. <span data-ttu-id="def3b-142">Para usar Msidb.exe para agregar el archivo. cab Mycab.cab al paquete de instalación denominado Mydatabase.msi, use la siguiente línea de comandos: Msidb.exe-d mydatabase.msi-a mycab.cab.</span><span class="sxs-lookup"><span data-stu-id="def3b-142">To use Msidb.exe to add the cabinet file Mycab.cab to the installation package named Mydatabase.msi, use the following command line: Msidb.exe -d mydatabase.msi -a mycab.cab.</span></span> <span data-ttu-id="def3b-143">En este caso, la columna Cabinet de la tabla de medios debe contener la cadena: \#mycab.cab.</span><span class="sxs-lookup"><span data-stu-id="def3b-143">In this case, the Cabinet column of the Media table should contain the string: \#mycab.cab.</span></span>

 

 



