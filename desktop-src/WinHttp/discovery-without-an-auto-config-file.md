---
description: Si no se ha implementado un archivo de configuración automática de proxy en la red local, WinHttpGetProxyForUrl no puede encontrar un servidor proxy.
ms.assetid: a170e63a-8586-47df-af5e-4ee3621795b2
title: Detección sin un archivo de configuración automática
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b6a5ec281c2ef74e2a377cecbd30f16cbc49bd79
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "105717296"
---
# <a name="discovery-without-an-auto-config-file"></a><span data-ttu-id="8a0d3-103">Detección sin un archivo de configuración automática</span><span class="sxs-lookup"><span data-stu-id="8a0d3-103">Discovery Without an Auto-Config File</span></span>

<span data-ttu-id="8a0d3-104">Si no se ha implementado un archivo de configuración automática de proxy en la red local, [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) no puede encontrar un servidor proxy.</span><span class="sxs-lookup"><span data-stu-id="8a0d3-104">If a proxy auto-configuration file has not been deployed on the local network, [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) cannot find a proxy server.</span></span> <span data-ttu-id="8a0d3-105">Si se produce un error en **WinHttpGetProxyForUrl** , hay varias estrategias de reversión posibles para obtener una configuración de proxy viable, en función de su entorno de tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="8a0d3-105">If **WinHttpGetProxyForUrl** fails, there are several possible fall-back strategies for obtaining a viable proxy configuration, depending on its runtime environment.</span></span> <span data-ttu-id="8a0d3-106">Se incluye la solicitud de la configuración de proxy a través de una interfaz de usuario, que requiere que alguien almacene la configuración del proxy en el registro mediante la utilidad WinHTTP "ProxyCfg.exe" o el uso de [**WinHttpGetIEProxyConfigForCurrentUser**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetieproxyconfigforcurrentuser) para comprobar si un servidor proxy aparece en la configuración de Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="8a0d3-106">These include prompting for the proxy setting through a user interface, requiring someone to store the proxy configuration in the registry using the WinHTTP "ProxyCfg.exe" utility, or using [**WinHttpGetIEProxyConfigForCurrentUser**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetieproxyconfigforcurrentuser) to check whether a proxy server is listed in Internet Explorer's settings.</span></span>

<span data-ttu-id="8a0d3-107">Es posible que no haya ningún archivo de configuración automática de proxy porque el cliente tiene una conexión directa a Internet, como a través de un ISP, y no necesita un servidor proxy.</span><span class="sxs-lookup"><span data-stu-id="8a0d3-107">It is possible that there is no proxy auto-configuration file because the client has a direct Internet connection, such as through an ISP, and does not need a proxy server.</span></span>

<span data-ttu-id="8a0d3-108">Por otro lado, es posible que se requiera un servidor proxy, pero es posible que la red local no admita WPAD.</span><span class="sxs-lookup"><span data-stu-id="8a0d3-108">A proxy server may be required, on the other hand, but the local network may not support WPAD.</span></span> <span data-ttu-id="8a0d3-109">En este caso, la configuración de proxy debe obtenerse del usuario o encontrarse en algún lugar del equipo cliente.</span><span class="sxs-lookup"><span data-stu-id="8a0d3-109">In this case, the proxy configuration must be obtained from the user or found somewhere on the client machine.</span></span>

<span data-ttu-id="8a0d3-110">Una aplicación basada en WinHTTP que se ejecuta en un entorno de servidor de nivel intermedio, como una aplicación COM+ o ASP, debe depender de que un administrador del servidor establezca una configuración de proxy predeterminada en el registro mediante la utilidad "ProxyCfg.exe".</span><span class="sxs-lookup"><span data-stu-id="8a0d3-110">A WinHTTP-based application running in a middle-tier server environment, such as a COM+ or ASP application, should rely on a server administrator setting a default proxy configuration in the registry using the "ProxyCfg.exe" utility.</span></span> <span data-ttu-id="8a0d3-111">Esta información de configuración predeterminada se puede recuperar mediante la función [**WinHttpGetDefaultProxyConfiguration**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetdefaultproxyconfiguration) o simplemente especificando la marca de **\_ \_ \_ preconfiguración de tipo de acceso de WinHTTP** en la llamada a [**WinHttpOpen**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopen) .</span><span class="sxs-lookup"><span data-stu-id="8a0d3-111">This default configuration information can then be retrieved either by using the [**WinHttpGetDefaultProxyConfiguration**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetdefaultproxyconfiguration) function, or simply by specifying the **WINHTTP\_ACCESS\_TYPE\_PRECONFIG** flag in the [**WinHttpOpen**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopen) call.</span></span>

<span data-ttu-id="8a0d3-112">Por otro lado, una aplicación WinHTTP que se ejecuta en un equipo de escritorio cliente puede intentar examinar la configuración de proxy de Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="8a0d3-112">On the other hand, a WinHTTP application running on a client desktop machine can attempt to examine Internet Explorer's proxy settings.</span></span> <span data-ttu-id="8a0d3-113">[**WinHttpGetIEProxyConfigForCurrentUser**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetieproxyconfigforcurrentuser) rellena una estructura de configuración del proxy de [**\_ IE del \_ usuario \_ \_ \_ actual de WinHTTP**](/windows/win32/api/winhttp/ns-winhttp-winhttp_current_user_ie_proxy_config) proporcionada por el llamador con la configuración de proxy de Internet Explorer del usuario actual para la conexión activa actual (acceso telefónico, VPN o LAN).</span><span class="sxs-lookup"><span data-stu-id="8a0d3-113">[**WinHttpGetIEProxyConfigForCurrentUser**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetieproxyconfigforcurrentuser) fills in a caller-supplied [**WINHTTP\_CURRENT\_USER\_IE\_PROXY\_CONFIG**](/windows/win32/api/winhttp/ns-winhttp-winhttp_current_user_ie_proxy_config) structure with the current user's Internet Explorer proxy settings for the current active connection (dial-up, VPN or LAN).</span></span> <span data-ttu-id="8a0d3-114">Esta configuración puede indicar que se usa la detección automática, o puede especificar una dirección URL para un archivo de configuración automática de proxy, o puede especificar un servidor proxy real para su uso, o puede especificar una combinación de los tres.</span><span class="sxs-lookup"><span data-stu-id="8a0d3-114">This configuration may indicate that auto-detection is used, or it may specify a URL for a proxy auto-configuration file, or it may specify an actual proxy server to use, or it may specify a combination of the three.</span></span> <span data-ttu-id="8a0d3-115">Si esta información incluye una dirección URL de PAC o un servidor proxy, la aplicación WinHTTP puede intentar utilizarlos.</span><span class="sxs-lookup"><span data-stu-id="8a0d3-115">If this information includes a PAC URL or a proxy server, the WinHTTP application can try using those.</span></span>

<span data-ttu-id="8a0d3-116">Un ejemplo que usa las funciones [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) y [**WinHttpGetIEProxyConfigForCurrentUser**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetieproxyconfigforcurrentuser) se puede encontrar en los ejemplos de WinHTTP del kit de desarrollo de software (SDK) de la plataforma.</span><span class="sxs-lookup"><span data-stu-id="8a0d3-116">A sample that uses the [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) and [**WinHttpGetIEProxyConfigForCurrentUser**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetieproxyconfigforcurrentuser) functions can be found in the Platform Software Development Kit (SDK) WinHTTP samples.</span></span>

 

 



