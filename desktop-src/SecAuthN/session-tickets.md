---
description: En lugar de enviar las claves de sesión cifrada a ambas entidades de seguridad, el KDC envía las copias del cliente y del servidor de la clave de sesión al cliente.
ms.assetid: 6b20ab30-2cd9-4f2e-a26b-316980c4bc78
title: Vales de sesión
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 762223311dd71f8bded5e021372d3a281f711eda
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "105667110"
---
# <a name="session-tickets"></a><span data-ttu-id="750a6-103">Vales de sesión</span><span class="sxs-lookup"><span data-stu-id="750a6-103">Session Tickets</span></span>

<span data-ttu-id="750a6-104">En lugar de enviar las claves de sesión cifrada a ambas entidades de seguridad, el [KDC](key-distribution-center.md) envía las copias del cliente y del servidor de la [*clave de sesión*](../secgloss/s-gly.md) al cliente.</span><span class="sxs-lookup"><span data-stu-id="750a6-104">Instead of sending the encrypted session keys to both of the principals, the [KDC](key-distribution-center.md) sends both the client's and the server's copies of the [*session key*](../secgloss/s-gly.md) to the client.</span></span> <span data-ttu-id="750a6-105">La copia del cliente de la clave de sesión se cifra con la [*clave maestra*](../secgloss/m-gly.md) del cliente y, por tanto, no se puede descifrar con ninguna otra entidad.</span><span class="sxs-lookup"><span data-stu-id="750a6-105">The client's copy of the session key is encrypted with the client's [*master key*](../secgloss/m-gly.md) and therefore cannot be decrypted by any other entity.</span></span> <span data-ttu-id="750a6-106">La copia del servidor de la clave de sesión está incrustada, junto con los datos de autorización sobre el cliente, en una estructura de datos denominada vale.</span><span class="sxs-lookup"><span data-stu-id="750a6-106">The server's copy of the session key is embedded, along with authorization data about the client, in a data structure called a ticket.</span></span> <span data-ttu-id="750a6-107">El vale se cifra por completo con la clave maestra del servidor y, por lo tanto, el cliente no puede leer ni cambiar, ni tampoco otra entidad que no tenga acceso a la clave maestra del servidor.</span><span class="sxs-lookup"><span data-stu-id="750a6-107">The ticket is entirely encrypted with the server's master key and therefore cannot be read or changed by the client or any other entity that does not have access to the server's master key.</span></span> <span data-ttu-id="750a6-108">Es responsabilidad del cliente almacenar el vale de forma segura hasta que se ponga en contacto con el servidor.</span><span class="sxs-lookup"><span data-stu-id="750a6-108">It is the responsibility of the client to store the ticket safely until contact with the server.</span></span>

> [!Note]  
> <span data-ttu-id="750a6-109">El KDC solo proporciona un servicio de concesión de vales.</span><span class="sxs-lookup"><span data-stu-id="750a6-109">The KDC only provides a ticket-granting service.</span></span> <span data-ttu-id="750a6-110">El cliente y el servidor son responsables de mantener seguros sus claves maestras respectivas.</span><span class="sxs-lookup"><span data-stu-id="750a6-110">The client and server are responsible for keeping their respective master keys secure.</span></span>

 

<span data-ttu-id="750a6-111">Cuando el cliente recibe la respuesta del KDC, extrae el vale y su propia copia de la clave de sesión y coloca ambos en una caché segura.</span><span class="sxs-lookup"><span data-stu-id="750a6-111">When the client receives the KDC's response, it extracts the ticket and its own copy of the session key, putting both aside in a secure cache.</span></span> <span data-ttu-id="750a6-112">Para establecer una sesión segura con el servidor, envía al servidor un mensaje que consta del vale, todavía cifrado con la clave maestra del servidor y un mensaje de [autenticador](authenticator-messages.md) cifrado con la clave de sesión.</span><span class="sxs-lookup"><span data-stu-id="750a6-112">To establish a secure session with the server, it sends the server a message consisting of the ticket, still encrypted with the server's master key, and an [authenticator message](authenticator-messages.md) encrypted with the session key.</span></span> <span data-ttu-id="750a6-113">Juntos, el vale y el mensaje del autenticador son las [*credenciales*](../secgloss/c-gly.md) del cliente para el servidor.</span><span class="sxs-lookup"><span data-stu-id="750a6-113">Together, the ticket and authenticator message are the client's [*credentials*](../secgloss/c-gly.md) to the server.</span></span>

<span data-ttu-id="750a6-114">Cuando el servidor recibe las credenciales de un cliente, descifra el vale con su [*clave maestra*](../secgloss/m-gly.md), extrae la [*clave de sesión*](../secgloss/s-gly.md)y usa la clave de sesión para descifrar el mensaje del autenticador del cliente.</span><span class="sxs-lookup"><span data-stu-id="750a6-114">When the server receives credentials from a client, it decrypts the ticket with its [*master key*](../secgloss/m-gly.md), extracts the [*session key*](../secgloss/s-gly.md), and uses the session key to decrypt the client's authenticator message.</span></span> <span data-ttu-id="750a6-115">Si todo se desprotege, el servidor sabe que las credenciales del cliente fueron emitidas por el KDC, una entidad de confianza.</span><span class="sxs-lookup"><span data-stu-id="750a6-115">If everything checks out, the server knows that the client's credentials were issued by the KDC, a trusted authority.</span></span> <span data-ttu-id="750a6-116">Para la autenticación mutua, el servidor responde mediante el cifrado de la marca de tiempo del mensaje del autenticador del cliente mediante la clave de sesión.</span><span class="sxs-lookup"><span data-stu-id="750a6-116">For mutual authentication, the server responds by encrypting the time stamp from the client's authenticator message using the session key.</span></span> <span data-ttu-id="750a6-117">Este mensaje cifrado se envía al cliente.</span><span class="sxs-lookup"><span data-stu-id="750a6-117">This encrypted message is sent to the client.</span></span> <span data-ttu-id="750a6-118">A continuación, el cliente descifra el mensaje.</span><span class="sxs-lookup"><span data-stu-id="750a6-118">The client then decrypts the message.</span></span> <span data-ttu-id="750a6-119">Si el mensaje devuelto es el mismo que el de la marca de tiempo en el mensaje del autenticador original, el servidor se autentica.</span><span class="sxs-lookup"><span data-stu-id="750a6-119">If the returned message is the same as the time stamp in the original authenticator message, the server is authenticated.</span></span>

<span data-ttu-id="750a6-120">Como ventaja adicional, el servidor no necesita almacenar las claves de sesión que usa con sus clientes.</span><span class="sxs-lookup"><span data-stu-id="750a6-120">As an added benefit, the server does not need to store the session keys it uses with its clients.</span></span> <span data-ttu-id="750a6-121">Es responsabilidad de cada cliente administrar el vale para el servidor en su caché de vales y presentar ese vale cada vez que tenga acceso al servidor.</span><span class="sxs-lookup"><span data-stu-id="750a6-121">It is each client's responsibility to manage the ticket for the server in its ticket cache and to present that ticket each time it accesses the server.</span></span> <span data-ttu-id="750a6-122">Cada vez que el servidor recibe un vale de un cliente, usa su clave maestra para descifrar el vale y extraer la clave de sesión.</span><span class="sxs-lookup"><span data-stu-id="750a6-122">Whenever the server receives a ticket from a client, it uses its master key to decrypt the ticket and extract the session key.</span></span> <span data-ttu-id="750a6-123">Cuando el servidor ya no necesita la clave de sesión, se elimina la clave.</span><span class="sxs-lookup"><span data-stu-id="750a6-123">When the server no longer needs the session key, the key is deleted.</span></span>

<span data-ttu-id="750a6-124">El cliente no necesita tener acceso al KDC cada vez que desea tener acceso a este servidor en particular.</span><span class="sxs-lookup"><span data-stu-id="750a6-124">The client does not need to access the KDC each time it wants access to this particular server.</span></span> <span data-ttu-id="750a6-125">Los vales se pueden volver a usar.</span><span class="sxs-lookup"><span data-stu-id="750a6-125">Tickets can be reused.</span></span> <span data-ttu-id="750a6-126">Como medida de precaución contra la posibilidad de robo de vales, los vales tienen una hora de expiración, especificada por el KDC en la estructura del vale.</span><span class="sxs-lookup"><span data-stu-id="750a6-126">As a precaution against the possibility of ticket theft, tickets have an expiration time, specified by the KDC in the ticket structure.</span></span> <span data-ttu-id="750a6-127">El período de validez de un vale depende de la Directiva de Kerberos para el dominio Kerberos.</span><span class="sxs-lookup"><span data-stu-id="750a6-127">How long a ticket is valid depends on Kerberos policy for the realm.</span></span> <span data-ttu-id="750a6-128">Normalmente, los vales son buenos para no tener más de ocho horas, acerca de la duración de una [*sesión de inicio*](../secgloss/l-gly.md)de sesión normal.</span><span class="sxs-lookup"><span data-stu-id="750a6-128">Typically, tickets are good for no longer than eight hours, about the length of a normal [*logon session*](../secgloss/l-gly.md).</span></span> <span data-ttu-id="750a6-129">Cuando el usuario de una estación de trabajo cliente cierra la sesión, se vacía la caché de vales de cliente y se destruyen todos los vales y las claves de sesión de cliente.</span><span class="sxs-lookup"><span data-stu-id="750a6-129">When the user at a client workstation logs off, the client ticket cache is flushed and all tickets and client session keys are destroyed.</span></span>

 

 
