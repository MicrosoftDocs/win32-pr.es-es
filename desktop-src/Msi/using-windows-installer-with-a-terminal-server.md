---
description: Lo siguiente puede afectar a las instalaciones de Windows Installer cuando se usa un servidor de Terminal Server. Los desarrolladores de instalación siempre deben probar que el paquete de Windows Installer se instala según lo esperado cuando los usuarios también utilizan un servidor de Terminal Server.
ms.assetid: deda9efa-a0fc-4b4e-a531-650ac201fd84
title: Usar Windows Installer con un Terminal Server
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d471fa19b4588a01a2730af44fa5e9d978d18859
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104497248"
---
# <a name="using-windows-installer-with-a-terminal-server"></a><span data-ttu-id="69b02-104">Usar Windows Installer con un Terminal Server</span><span class="sxs-lookup"><span data-stu-id="69b02-104">Using Windows Installer with a Terminal Server</span></span>

<span data-ttu-id="69b02-105">Lo siguiente puede afectar a las instalaciones de Windows Installer cuando se usa un servidor de Terminal Server.</span><span class="sxs-lookup"><span data-stu-id="69b02-105">The following may affect Windows Installer installations when using a terminal server.</span></span> <span data-ttu-id="69b02-106">Los desarrolladores de instalación siempre deben probar que el paquete de Windows Installer se instala según lo esperado cuando los usuarios también utilizan un servidor de Terminal Server.</span><span class="sxs-lookup"><span data-stu-id="69b02-106">Setup developers should always test that their Windows Installer package installs as expected when users are also using a terminal server.</span></span>

-   <span data-ttu-id="69b02-107">En sistemas operativos anteriores a Windows Server 2008 y Windows Vista, se debe establecer la Directiva del sistema [EnableAdminTSRemote](enableadmintsremote.md) para permitir que los administradores realicen instalaciones en la sesión del cliente.</span><span class="sxs-lookup"><span data-stu-id="69b02-107">On operating systems earlier than Windows Server 2008 and Windows Vista, the [EnableAdminTSRemote](enableadmintsremote.md) system policy must be set to enable administrators to perform installations in the client session.</span></span> <span data-ttu-id="69b02-108">A partir de Windows Server 2008 y Windows Vista, la Directiva EnableAdminTSRemote ya no tiene ningún efecto.</span><span class="sxs-lookup"><span data-stu-id="69b02-108">Beginning with Windows Server 2008 and Windows Vista, the EnableAdminTSRemote policy no longer has any effect.</span></span> <span data-ttu-id="69b02-109">Independientemente de su configuración, los administradores y los usuarios que no son administradores pueden realizar una instalación en la sesión de cliente o en la sesión de consola.</span><span class="sxs-lookup"><span data-stu-id="69b02-109">Regardless of its setting, administrators and non-administrators can perform an installation in the client session or the console session.</span></span> <span data-ttu-id="69b02-110">Los administradores y los usuarios que no son administradores siempre pueden realizar instalaciones Windows Installer en la sesión de la consola.</span><span class="sxs-lookup"><span data-stu-id="69b02-110">Administrators and non-administrators can always perform Windows Installer installations in the console session.</span></span>
-   <span data-ttu-id="69b02-111">El Windows Installer evita la instalación en el contexto de [instalación](installation-context.md) por usuario si la[Directiva del sistema](system-policy.md) [DisableUserInstalls](disableuserinstalls.md)está establecida en 1.</span><span class="sxs-lookup"><span data-stu-id="69b02-111">The Windows Installer prevents installation in the per-user [installation context](installation-context.md) if the [DisableUserInstalls](disableuserinstalls.md)[system policy](system-policy.md) is set to 1.</span></span> <span data-ttu-id="69b02-112">En este caso, el instalador omite todas las aplicaciones registradas como por usuario y busca solo las aplicaciones registradas como por equipo.</span><span class="sxs-lookup"><span data-stu-id="69b02-112">In this case, the installer ignores all applications registered as per-user and searches only for applications registered as per-machine.</span></span>
-   <span data-ttu-id="69b02-113">Cuando un administrador realiza una instalación en una sesión de cliente de un servidor de Terminal Server que se hospeda en Windows 2000, la instalación debe utilizar una ruta de acceso UNC y no una letra de unidad asignada.</span><span class="sxs-lookup"><span data-stu-id="69b02-113">When an administrator performs an installation in a client session of a terminal server that is hosted in Windows 2000, the installation must use a UNC path and not a mapped drive letter.</span></span>

<span data-ttu-id="69b02-114">Los desarrolladores deben cumplir las siguientes directrices al desarrollar un componente de Windows Installer que se pueda usar con un servidor de Terminal Server.</span><span class="sxs-lookup"><span data-stu-id="69b02-114">Developers should adhere to the following guidelines when developing a Windows Installer component that may be used with a terminal server.</span></span>

-   <span data-ttu-id="69b02-115">Escriba toda la información del registro **HKCU** en la  \\ parte del **software** HKCU del registro.</span><span class="sxs-lookup"><span data-stu-id="69b02-115">Write all **HKCU** registry information in the **HKCU**\\**Software** part of the registry.</span></span>
-   <span data-ttu-id="69b02-116">No se recomienda almacenar la información de configuración en archivos INI.</span><span class="sxs-lookup"><span data-stu-id="69b02-116">Storing configuration information in INI files is not recommended.</span></span>
-   <span data-ttu-id="69b02-117">Escriba la información por usuario en el registro cuando la aplicación se ejecute por primera vez y no durante la instalación.</span><span class="sxs-lookup"><span data-stu-id="69b02-117">Write per-user information to the registry when the application is run for the first time and not at installation time.</span></span> <span data-ttu-id="69b02-118">Si debe escribir información por usuario en el registro durante la instalación, separe la información por usuario y por equipo en diferentes componentes de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="69b02-118">If you must write per-user information to the registry at installation time, separate the per-user and per-machine information into different Windows Installer components.</span></span> <span data-ttu-id="69b02-119">Cree el paquete de modo que el instalador no intente validar y reparar los componentes que contienen información de cada usuario cuando se instala la aplicación.</span><span class="sxs-lookup"><span data-stu-id="69b02-119">Author the package such that the installer does not attempt to validate and repair the components containing per-user information when the application is installed.</span></span>
-   <span data-ttu-id="69b02-120">Un paquete que se usa solo para instalaciones por equipo debe escribir variables de entorno en el entorno del equipo mediante \* la inclusión de en la columna Nombre de la [tabla de entorno](environment-table.md).</span><span class="sxs-lookup"><span data-stu-id="69b02-120">A package used for only per-machine installations should write environment variables to the computer's environment by including \* in the Name column of the [Environment Table](environment-table.md).</span></span> <span data-ttu-id="69b02-121">Si el paquete se puede usar para instalaciones por usuario o para instalaciones por máquina, use dos componentes.</span><span class="sxs-lookup"><span data-stu-id="69b02-121">If the package can be used for per-user installations or per-machine installations, use two components.</span></span> <span data-ttu-id="69b02-122">Incluya el componente por usuario en la [tabla de componentes](condition-table.md) y escriba la configuración de usuario en la tabla de entorno.</span><span class="sxs-lookup"><span data-stu-id="69b02-122">Include the per-user component in the [Component Table](condition-table.md) and enter the user settings in the Environment Table.</span></span> <span data-ttu-id="69b02-123">Incluya el componente por equipo en la tabla de componentes y escriba la configuración del equipo en la tabla de entorno.</span><span class="sxs-lookup"><span data-stu-id="69b02-123">Include the per-machine component in the Component Table and enter the computer settings in the Environment Table.</span></span> <span data-ttu-id="69b02-124">Controlar qué componente se instala mediante instrucciones condicionales basadas en la propiedad [**AllUsers**](allusers.md) en el campo condición de la tabla componente.</span><span class="sxs-lookup"><span data-stu-id="69b02-124">Control which component gets installed by using conditional statements based upon the [**ALLUSERS**](allusers.md) property in the Condition field of the Component Table.</span></span>
-   <span data-ttu-id="69b02-125">Al realizar instalaciones por equipo desde un servidor de Terminal Server, el instalador escribe variables de entorno por usuario en **HKCU** \\ **.** \\ **Entorno** predeterminado.</span><span class="sxs-lookup"><span data-stu-id="69b02-125">When performing per-machine installations from a terminal server, the installer writes per-user environment variables to **HKCU**\\ **.Default**\\**Environment**.</span></span> <span data-ttu-id="69b02-126">Dado que el servidor de Terminal Server no Replica esta sección del registro, la instalación no establece las variables de entorno por usuario.</span><span class="sxs-lookup"><span data-stu-id="69b02-126">Because the terminal server does not replicate this section of the registry, the installation does not set the per-user environment variables.</span></span>
-   <span data-ttu-id="69b02-127">Dado que un servidor se puede configurar para impedir que los usuarios reparen aplicaciones, la aplicación debe controlar el caso de que falten claves del registro correctamente.</span><span class="sxs-lookup"><span data-stu-id="69b02-127">Because a server may be configured to prevent users from repairing applications, your application should handle the case of missing registry keys gracefully.</span></span>

<span data-ttu-id="69b02-128">Lo siguiente se aplica cuando un paquete de Windows Installer que utiliza [acciones personalizadas](custom-actions.md) de dll, exe o script se instala en el contexto de instalación por equipo en un servidor de Terminal Server.</span><span class="sxs-lookup"><span data-stu-id="69b02-128">The following applies when a Windows Installer package that uses DLL, EXE, or Script [custom actions](custom-actions.md) is installed in the per-machine installation context on a terminal server.</span></span> <span data-ttu-id="69b02-129">En este caso, el instalador establece la propiedad [**TerminalServer**](terminalserver.md) .</span><span class="sxs-lookup"><span data-stu-id="69b02-129">In this case, the installer sets the [**TerminalServer**](terminalserver.md) property.</span></span>

-   <span data-ttu-id="69b02-130">Las acciones personalizadas diferidas se ejecutan en el contexto del sistema local, a menos que la acción tenga el atributo **msidbCustomActionTypeTSAware** .</span><span class="sxs-lookup"><span data-stu-id="69b02-130">Deferred custom actions run in the context of the local system unless the action has the **msidbCustomActionTypeTSAware** attribute.</span></span> <span data-ttu-id="69b02-131">Esto es así incluso si la acción personalizada suplanta al usuario en un sistema que no es un servidor de Terminal Server.</span><span class="sxs-lookup"><span data-stu-id="69b02-131">This is true even if the custom action impersonates the user on a system that is not a terminal server.</span></span> <span data-ttu-id="69b02-132">Tenga en cuenta que si una acción personalizada que tiene el atributo **msidbCustomActionTypeTSAware** cambia el registro del usuario, el instalador no garantiza automáticamente que esos cambios también se realicen en el registro de todos los usuarios del equipo.</span><span class="sxs-lookup"><span data-stu-id="69b02-132">Note that if a custom action having the **msidbCustomActionTypeTSAware** attribute changes the user's registry, the installer does not automatically ensure that those changes are also made in the registry of every user on the computer.</span></span>
-   <span data-ttu-id="69b02-133">Cualquier operación del registro en una acción personalizada diferida que se lea desde el subárbol del registro **HKCU** verá el subárbol del registro predeterminado del sistema y no el subárbol del registro del usuario actual.</span><span class="sxs-lookup"><span data-stu-id="69b02-133">Any registry operations in a deferred custom action that read from the **HKCU** registry hive sees the system's default registry hive and not the current user's registry hive.</span></span>
-   <span data-ttu-id="69b02-134">El instalador detecta todas las operaciones del registro en una acción personalizada diferida que escriben en el \\ **software** HKCU y se copian en todos los usuarios del equipo en el siguiente inicio de sesión del usuario.</span><span class="sxs-lookup"><span data-stu-id="69b02-134">Any registry operations in a deferred custom action that write to **HKCU**\\**Software** are detected by the installer and copied to every user of the computer at the next logon of the user.</span></span>
-   <span data-ttu-id="69b02-135">Las operaciones del registro en una acción personalizada diferida que escriben en **HKCU**, pero no en la \\ clave del registro HKCU **software** , no las detecta el instalador ni se copian.</span><span class="sxs-lookup"><span data-stu-id="69b02-135">Any registry operations in a deferred custom action that write to **HKCU**, but are not under the **HKCU**\\**Software** registry key, are not detected by the installer or copied.</span></span>

<span data-ttu-id="69b02-136">Para obtener más información, vea [Terminal Services](../termserv/terminal-services-portal.md) en el kit de desarrollo de software (SDK) de Microsoft Windows.</span><span class="sxs-lookup"><span data-stu-id="69b02-136">For more information, see [Terminal Services](../termserv/terminal-services-portal.md) in the Microsoft Windows Software Development Kit (SDK).</span></span>

## <a name="related-topics"></a><span data-ttu-id="69b02-137">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="69b02-137">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="69b02-138">EnableAdminTSRemote</span><span class="sxs-lookup"><span data-stu-id="69b02-138">EnableAdminTSRemote</span></span>](enableadmintsremote.md)
</dt> <dt>

[<span data-ttu-id="69b02-139">**Propiedad TerminalServer**</span><span class="sxs-lookup"><span data-stu-id="69b02-139">**TerminalServer property**</span></span>](terminalserver.md)
</dt> <dt>

[<span data-ttu-id="69b02-140">**Propiedad RemoteAdminTS**</span><span class="sxs-lookup"><span data-stu-id="69b02-140">**RemoteAdminTS property**</span></span>](remoteadmints.md)
</dt> <dt>

[<span data-ttu-id="69b02-141">Terminal Services</span><span class="sxs-lookup"><span data-stu-id="69b02-141">Terminal Services</span></span>](../termserv/terminal-services-portal.md)
</dt> </dl>

 

 
