---
title: Sondear los cambios mediante el control DirSync
description: Active Directory control de sincronización de directorios (DirSync) es una extensión de servidor LDAP que permite que una aplicación busque en una partición de directorio objetos que han cambiado desde un estado anterior.
ms.assetid: f77caeb3-bfc9-4ae6-8d1d-73f4ee554336
ms.tgt_platform: multiple
keywords:
- Sondear los cambios mediante el control DirSync AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8c3d105757d39bc25bd10df21ab68c4d1d1202be
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/17/2020
ms.locfileid: "103789502"
---
# <a name="polling-for-changes-using-the-dirsync-control"></a><span data-ttu-id="b59d9-104">Sondear los cambios mediante el control DirSync</span><span class="sxs-lookup"><span data-stu-id="b59d9-104">Polling for Changes Using the DirSync Control</span></span>

<span data-ttu-id="b59d9-105">Active Directory control de sincronización de directorios (DirSync) es una extensión de servidor LDAP que permite que una aplicación busque en una partición de directorio objetos que han cambiado desde un estado anterior.</span><span class="sxs-lookup"><span data-stu-id="b59d9-105">Active Directory directory synchronization (DirSync) control is an LDAP server extension that enables an application to search an directory partition for objects that have changed since a previous state.</span></span>

<span data-ttu-id="b59d9-106">Use el control DirSync a través de ADSI especificando la preferencia de búsqueda de **\_ \_ DirSync de ADS SEARCHPREF** al usar [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch).</span><span class="sxs-lookup"><span data-stu-id="b59d9-106">Use the DirSync control through ADSI by specifying the **ADS\_SEARCHPREF\_DIRSYNC** search preference when using [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch).</span></span> <span data-ttu-id="b59d9-107">Para obtener más información y un ejemplo de código, vea [código de ejemplo con ADS \_ SEARCHPREF \_ DirSync](example-code-using-ads-searchpref-dirsync.md).</span><span class="sxs-lookup"><span data-stu-id="b59d9-107">For more information and a code example, see [Example Code Using ADS\_SEARCHPREF\_DIRSYNC](example-code-using-ads-searchpref-dirsync.md).</span></span> <span data-ttu-id="b59d9-108">También puede realizar una búsqueda de DirSync mediante la API de LDAP.</span><span class="sxs-lookup"><span data-stu-id="b59d9-108">You can also perform a DirSync search using the LDAP API.</span></span> <span data-ttu-id="b59d9-109">A continuación se describe la implementación de ADSI, la mayoría de las cuales también se aplica al uso de LDAP directamente, excepto como se describe al final de este tema.</span><span class="sxs-lookup"><span data-stu-id="b59d9-109">The following describes the ADSI implementation, most of which also applies to using LDAP directly, except as discussed at the end of this topic.</span></span>

<span data-ttu-id="b59d9-110">Al realizar una búsqueda de DirSync, se pasa un elemento de datos específico del proveedor (cookie) que identifica el estado del directorio en el momento de la búsqueda de DirSync anterior.</span><span class="sxs-lookup"><span data-stu-id="b59d9-110">When you perform a DirSync search, you pass in a provider-specific data element (cookie) that identifies the directory state at the time of the previous DirSync search.</span></span> <span data-ttu-id="b59d9-111">En la primera búsqueda, se pasa una cookie NULL y la búsqueda devuelve todos los objetos que coinciden con el filtro.</span><span class="sxs-lookup"><span data-stu-id="b59d9-111">For the first search, you pass in a null cookie, and the search returns all objects that match the filter.</span></span> <span data-ttu-id="b59d9-112">La búsqueda también devuelve una cookie válida.</span><span class="sxs-lookup"><span data-stu-id="b59d9-112">The search also returns a valid cookie.</span></span> <span data-ttu-id="b59d9-113">Almacene la cookie en el mismo almacenamiento que está sincronizando con el servidor de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="b59d9-113">Store the cookie in the same storage that you are synchronizing with the Active Directory server.</span></span> <span data-ttu-id="b59d9-114">En las búsquedas posteriores, obtenga la cookie del almacenamiento y pásela con la solicitud de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b59d9-114">On subsequent searches, get the cookie from storage and pass it with the search request.</span></span> <span data-ttu-id="b59d9-115">Los resultados de la búsqueda ahora incluyen solo los objetos y atributos que han cambiado desde el estado anterior identificado por la cookie.</span><span class="sxs-lookup"><span data-stu-id="b59d9-115">The search results now include only the objects and attributes that have changed since the previous state identified by the cookie.</span></span> <span data-ttu-id="b59d9-116">La búsqueda también devuelve una cookie nueva que se va a almacenar para la siguiente búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b59d9-116">The search also returns a new cookie to store for the next search.</span></span>

<span data-ttu-id="b59d9-117">En la tabla siguiente se enumeran los parámetros de búsqueda que la solicitud de búsqueda de cliente puede especificar.</span><span class="sxs-lookup"><span data-stu-id="b59d9-117">The following table lists search parameters that the client search request can specify.</span></span>



| <span data-ttu-id="b59d9-118">Parámetro</span><span class="sxs-lookup"><span data-stu-id="b59d9-118">Parameter</span></span>          | <span data-ttu-id="b59d9-119">Descripción</span><span class="sxs-lookup"><span data-stu-id="b59d9-119">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|--------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="b59d9-120">Base de la búsqueda</span><span class="sxs-lookup"><span data-stu-id="b59d9-120">Base of the search</span></span> | <span data-ttu-id="b59d9-121">La base de una búsqueda de DirSync debe ser la raíz de una partición de directorio, que puede ser una partición de dominio, la partición de configuración o la partición de esquema.</span><span class="sxs-lookup"><span data-stu-id="b59d9-121">The base of a DirSync search must be the root of a directory partition, which can be a domain partition, the configuration partition, or the schema partition.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="b59d9-122">Ámbito</span><span class="sxs-lookup"><span data-stu-id="b59d9-122">Scope</span></span>              | <span data-ttu-id="b59d9-123">El ámbito de una búsqueda de DirSync debe **ser \_ \_ subárbol de ámbito de ADS**, es decir, todo el subárbol de la partición.</span><span class="sxs-lookup"><span data-stu-id="b59d9-123">The scope of a DirSync search must be **ADS\_SCOPE\_SUBTREE**, that is, the entire subtree of the partition.</span></span> <span data-ttu-id="b59d9-124">Tenga en cuenta que para una búsqueda de una partición de dominio, el subárbol incluye los cabezales, pero no el contenido, de las particiones de esquema y de configuración.</span><span class="sxs-lookup"><span data-stu-id="b59d9-124">Be aware that for a search of a domain partition, the subtree includes the heads, but not the contents, of the configuration and schema partitions.</span></span> <span data-ttu-id="b59d9-125">Para sondear los cambios en un ámbito más pequeño, use la técnica de **USNChanged** en lugar de DirSync.</span><span class="sxs-lookup"><span data-stu-id="b59d9-125">To poll for changes in a smaller scope, use the **USNChanged** technique instead of DirSync.</span></span>                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="b59d9-126">Filter</span><span class="sxs-lookup"><span data-stu-id="b59d9-126">Filter</span></span>             | <span data-ttu-id="b59d9-127">Puede especificar cualquier filtro de búsqueda válido.</span><span class="sxs-lookup"><span data-stu-id="b59d9-127">You can specify any valid search filter.</span></span> <span data-ttu-id="b59d9-128">En el caso de una búsqueda inicial con una cookie null, los resultados incluyen todos los objetos que coinciden con el filtro.</span><span class="sxs-lookup"><span data-stu-id="b59d9-128">For an initial search with a null cookie, the results include all objects that match the filter.</span></span> <span data-ttu-id="b59d9-129">En las búsquedas posteriores con una cookie válida, los resultados de la búsqueda incluyen datos solo de los objetos que coinciden con el filtro y que han cambiado desde el estado indicado por la cookie.</span><span class="sxs-lookup"><span data-stu-id="b59d9-129">For subsequent searches with a valid cookie, the search results include data only for objects that match the filter and have changed since the state indicated by the cookie.</span></span> <span data-ttu-id="b59d9-130">Para obtener más información acerca de los filtros de búsqueda, consulte [crear un filtro de consulta](creating-a-query-filter.md).</span><span class="sxs-lookup"><span data-stu-id="b59d9-130">For more information about search filters, see [Creating a Query Filter](creating-a-query-filter.md).</span></span>                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="b59d9-131">Atributos</span><span class="sxs-lookup"><span data-stu-id="b59d9-131">Attributes</span></span>         | <span data-ttu-id="b59d9-132">Puede especificar una lista de atributos que se devolverán cuando se produzca un cambio.</span><span class="sxs-lookup"><span data-stu-id="b59d9-132">You can specify a list of attributes to be returned when a change occurs.</span></span> <span data-ttu-id="b59d9-133">Para cada objeto, los resultados iniciales incluyen todos los atributos solicitados establecidos en el objeto.</span><span class="sxs-lookup"><span data-stu-id="b59d9-133">For each object, the initial results include all the requested attributes set on the object.</span></span> <span data-ttu-id="b59d9-134">Los resultados de búsqueda posteriores incluyen solo los atributos especificados que han cambiado.</span><span class="sxs-lookup"><span data-stu-id="b59d9-134">Subsequent search results include only the specified attributes that have changed.</span></span> <span data-ttu-id="b59d9-135">Los atributos sin modificar no se incluyen en los resultados de la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b59d9-135">Unchanged attributes are not included in the search results.</span></span> <span data-ttu-id="b59d9-136">En la implementación de ADSI, los resultados de la búsqueda siempre incluyen **objectGUID** y **instanceType** de cada objeto.</span><span class="sxs-lookup"><span data-stu-id="b59d9-136">In the ADSI implementation, the search results always include the **objectGUID** and **instanceType** of each object.</span></span> <span data-ttu-id="b59d9-137">Además, la lista de atributos especificada actúa como filtro adicional: los resultados de la búsqueda inicial incluyen solo los objetos que tienen al menos uno de los atributos especificados. las búsquedas posteriores incluyen solo los objetos en los que han cambiado uno o varios de los atributos (valores agregados o eliminados).</span><span class="sxs-lookup"><span data-stu-id="b59d9-137">Also, the specified attribute list acts as an additional filter: the initial search results include only objects that have at least one of the specified attributes set; subsequent searches include only objects on which one or more of the attributes have changed (values added or deleted).</span></span> |



 

<span data-ttu-id="b59d9-138">Además, tenga en cuenta lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="b59d9-138">Also, be aware that:</span></span>

-   <span data-ttu-id="b59d9-139">En las búsquedas incrementales, el procedimiento recomendado es enlazar al mismo controlador de dominio (DC) usado en la búsqueda anterior, es decir, el controlador de dominio que generó la cookie.</span><span class="sxs-lookup"><span data-stu-id="b59d9-139">For incremental searches, the best practice is to bind to the same domain controller (DC) used in the previous search, that is, the DC that generated the cookie.</span></span> <span data-ttu-id="b59d9-140">Si el mismo controlador de dominio no está disponible, espere hasta que sea o enlace a un nuevo controlador de dominio y realice una sincronización completa.</span><span class="sxs-lookup"><span data-stu-id="b59d9-140">If the same DC is unavailable, either wait until it is, or bind to a new DC and perform a full synchronization.</span></span> <span data-ttu-id="b59d9-141">Almacene el nombre DNS del controlador de dominio en el almacenamiento secundario con la cookie.</span><span class="sxs-lookup"><span data-stu-id="b59d9-141">Store the DNS name of the DC in the secondary storage with the cookie.</span></span>

    <span data-ttu-id="b59d9-142">Puede pasar una cookie generada por un controlador de dominio a otro controlador de dominio que hospede una réplica de la misma partición de directorio.</span><span class="sxs-lookup"><span data-stu-id="b59d9-142">You can pass a cookie generated by one DC to a different DC hosting a replica of the same directory partition.</span></span> <span data-ttu-id="b59d9-143">No existe la posibilidad de que un cliente no se pierda los cambios mediante una cookie de un controlador de dominio en otro controlador de dominio.</span><span class="sxs-lookup"><span data-stu-id="b59d9-143">There is no chance that a client will miss changes by using a cookie from one DC on another DC.</span></span> <span data-ttu-id="b59d9-144">Sin embargo, es posible que los resultados de la búsqueda del nuevo controlador de dominio incluyan cambios detectados por el controlador de dominio antiguo. en algunos casos, el nuevo controlador de dominio puede devolver todos los objetos y atributos, como con una sincronización completa.</span><span class="sxs-lookup"><span data-stu-id="b59d9-144">However, it is possible that the search results from the new DC may include reported changes by the old DC; in some cases, the new DC may return all objects and attributes, as with a full synchronization.</span></span> <span data-ttu-id="b59d9-145">El cliente solo debe hacer que su base de datos sea coherente con los resultados de la búsqueda detectada para cualquier llamada de DirSync determinada, es decir, controlar todos los resultados incrementales como si fueran el estado más reciente.</span><span class="sxs-lookup"><span data-stu-id="b59d9-145">The client should just make its database consistent with reported search results for any given DirSync call, that is, handle all incremental results as if they were the latest state.</span></span> <span data-ttu-id="b59d9-146">No importa si ha detectado el cambio antes o incluso si vuelve a un estado anterior, ya que las sincronizaciones incrementales repetidas convergerán en la coherencia.</span><span class="sxs-lookup"><span data-stu-id="b59d9-146">It does not matter whether you have seen the change before or are even going back to a previous state because repeated incremental synchronizations will converge on consistency.</span></span>

-   <span data-ttu-id="b59d9-147">Cuando se cambia el nombre de un objeto o se mueve, sus objetos secundarios, si los hay, no se incluyen en los resultados de la búsqueda, aunque los nombres distintivos de los objetos secundarios hayan cambiado.</span><span class="sxs-lookup"><span data-stu-id="b59d9-147">When an object is renamed or moved, its child objects, if any, are not included in the search results, even though the distinguished names of the child objects have changed.</span></span> <span data-ttu-id="b59d9-148">Del mismo modo, cuando se modifica una ACE heredable en un descriptor de seguridad de objeto, los objetos secundarios del objeto no se incluyen en los resultados de la búsqueda, aunque los descriptores de seguridad de los objetos secundarios hayan cambiado.</span><span class="sxs-lookup"><span data-stu-id="b59d9-148">Similarly, when an inheritable ACE is modified in an object security-descriptor, the child objects of the object are not included in the search results, even though the security-descriptors of the child objects have changed.</span></span>
-   <span data-ttu-id="b59d9-149">Use el atributo **objectGUID** para identificar los objetos sometidos a seguimiento.</span><span class="sxs-lookup"><span data-stu-id="b59d9-149">Use the **objectGUID** attribute to identify the tracked objects.</span></span> <span data-ttu-id="b59d9-150">El **objectGUID** de cada objeto permanece sin modificar, independientemente de dónde se mueva el objeto dentro del bosque.</span><span class="sxs-lookup"><span data-stu-id="b59d9-150">The **objectGUID** of each object remains unchanged regardless of where the object is moved within the forest.</span></span>
-   <span data-ttu-id="b59d9-151">Tenga en cuenta que los resultados de la búsqueda de una búsqueda de DirSync indican el estado de los objetos en una réplica de la partición de directorio en el momento de la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b59d9-151">Be aware that the search results of a DirSync search indicate the state of the objects on a replica of the directory partition at the time of the search.</span></span> <span data-ttu-id="b59d9-152">Esto significa que los cambios realizados en otros controladores de dominio no se incluirán si no se han replicado en el controlador de dominio de destino.</span><span class="sxs-lookup"><span data-stu-id="b59d9-152">This means that changes made on other DCs will not be included if they have not been replicated to the target DC.</span></span> <span data-ttu-id="b59d9-153">También significa que los atributos de un objeto pueden haber cambiado varias veces desde la búsqueda de DirSync anterior, pero la búsqueda solo mostrará el estado final, no la secuencia de cambios.</span><span class="sxs-lookup"><span data-stu-id="b59d9-153">It also means that an object's attributes may have changed several times since the previous DirSync search, but the search will show only the final state, not the sequence of changes.</span></span>
-   <span data-ttu-id="b59d9-154">En la implementación de ADSI, la aplicación debe controlar la cookie como opaca y no hacer ninguna suposición sobre su valor o organización interna.</span><span class="sxs-lookup"><span data-stu-id="b59d9-154">In the ADSI implementation, the application must handle the cookie as opaque and not make any assumptions about its internal organization or value.</span></span>
-   <span data-ttu-id="b59d9-155">Tenga en cuenta que el cliente almacena la cookie, la longitud de la cookie y el nombre DNS del controlador de dominio en el mismo almacenamiento que contiene los datos del objeto sincronizado.</span><span class="sxs-lookup"><span data-stu-id="b59d9-155">Be aware that the client stores the cookie, cookie length, and DNS name of the DC in the same storage that contains the synchronized object data.</span></span> <span data-ttu-id="b59d9-156">Esto garantiza que la cookie y otros parámetros permanecen sincronizados con los datos del objeto si el almacenamiento se restaura a partir de una copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="b59d9-156">This ensures that the cookie and other parameters remain in sync with the object data if the storage is ever restored from a backup.</span></span>
-   <span data-ttu-id="b59d9-157">Para recuperar el atributo [**parentGUID**](/windows/desktop/ADSchema/a-parentguid) , que se construye para el control DirSync, también es necesario solicitar el atributo [**Name**](/windows/desktop/ADSchema/a-name) .</span><span class="sxs-lookup"><span data-stu-id="b59d9-157">To retrieve the [**parentGUID**](/windows/desktop/ADSchema/a-parentguid) attribute, which is constructed for the DirSync control, it is also necessary to request the [**name**](/windows/desktop/ADSchema/a-name) attribute.</span></span>

<span data-ttu-id="b59d9-158">Para usar el control DirSync, el autor de la llamada debe tener el derecho "obtener cambios de directorio" asignado en la raíz de la partición que se está supervisando.</span><span class="sxs-lookup"><span data-stu-id="b59d9-158">To use the DirSync control, caller must have the "directory get changes" right assigned on the root of the partition being monitored.</span></span> <span data-ttu-id="b59d9-159">De forma predeterminada, este derecho se asigna a las cuentas de administrador y LocalSystem en los controladores de dominio.</span><span class="sxs-lookup"><span data-stu-id="b59d9-159">By default, this right is assigned to the Administrator and LocalSystem accounts on domain controllers.</span></span> <span data-ttu-id="b59d9-160">El autor de la llamada también debe tener el derecho de acceso de control extendido [**DS-Replication-Get-Changes**](/windows/desktop/ADSchema/r-ds-replication-get-changes) .</span><span class="sxs-lookup"><span data-stu-id="b59d9-160">The caller must also have the [**DS-Replication-Get-Changes**](/windows/desktop/ADSchema/r-ds-replication-get-changes) extended control access right.</span></span> <span data-ttu-id="b59d9-161">Para obtener más información acerca de la implementación de un mecanismo de seguimiento de cambios para las aplicaciones que se deben ejecutar en una cuenta que no tiene este derecho, consulte [sondear los cambios con USNChanged](polling-for-changes-using-usnchanged.md).</span><span class="sxs-lookup"><span data-stu-id="b59d9-161">For more information about implementing a change-tracking mechanism for applications that must run under an account that does not have this right, see [Polling for Changes Using USNChanged](polling-for-changes-using-usnchanged.md).</span></span> <span data-ttu-id="b59d9-162">Para obtener más información sobre los privilegios, vea [privilegios](/windows/desktop/SecAuthZ/privileges).</span><span class="sxs-lookup"><span data-stu-id="b59d9-162">For more information about privileges, see [Privileges](/windows/desktop/SecAuthZ/privileges).</span></span>

## <a name="retrieving-deleted-objects-with-a-dirsync-search"></a><span data-ttu-id="b59d9-163">Recuperar objetos eliminados con una búsqueda de DirSync</span><span class="sxs-lookup"><span data-stu-id="b59d9-163">Retrieving Deleted Objects With a DirSync Search</span></span>

<span data-ttu-id="b59d9-164">Los resultados de búsqueda de **\_ SEARCHPREF de \_ DirSync de ADS** incluyen automáticamente los objetos eliminados (marcadores de exclusión) que coinciden con el filtro de búsqueda especificado.</span><span class="sxs-lookup"><span data-stu-id="b59d9-164">The **ADS\_SEARCHPREF\_DIRSYNC** search results automatically include deleted objects (tombstones) that match the specified search filter.</span></span> <span data-ttu-id="b59d9-165">Sin embargo, un filtro de búsqueda que coincida con un objeto cuando esté activo puede no coincidir con el objeto después de eliminarlo.</span><span class="sxs-lookup"><span data-stu-id="b59d9-165">However, a search filter that will match an object when it is live may not match the object after it is deleted.</span></span> <span data-ttu-id="b59d9-166">Esto se debe a que los marcadores de exclusión conservan solo un subconjunto de los atributos presentes en el objeto original.</span><span class="sxs-lookup"><span data-stu-id="b59d9-166">This is because tombstones retain only a subset of the attributes present on the original object.</span></span> <span data-ttu-id="b59d9-167">Por ejemplo, normalmente usaría el siguiente filtro para objetos de usuario.</span><span class="sxs-lookup"><span data-stu-id="b59d9-167">For example, you would typically use the following filter for user objects.</span></span>


```C++
(&(objectClass=user)(objectCategory=person))
```



<span data-ttu-id="b59d9-168">El atributo **objectCategory** se quita cuando se elimina un objeto, por lo que el filtro anterior no coincidiría con ninguno de los objetos de desecho.</span><span class="sxs-lookup"><span data-stu-id="b59d9-168">The **objectCategory** attribute is removed when an object is deleted, so the filter above would not match any tombstone objects.</span></span> <span data-ttu-id="b59d9-169">Por el contrario, el atributo **objectClass** se conserva en los objetos de desecho, por lo que un filtro de "(objectClass = User)" coincidiría con los objetos de usuario eliminados.</span><span class="sxs-lookup"><span data-stu-id="b59d9-169">Conversely, the **objectClass** attribute is retained on tombstone objects, so a filter of "(objectClass=user)" would match deleted user objects.</span></span>

<span data-ttu-id="b59d9-170">La lista de atributos que se especifica con una búsqueda de DirSync también actúa como filtro; los resultados de la búsqueda incluyen solo los objetos en los que uno o varios de los atributos especificados han cambiado desde la última búsqueda de DirSync.</span><span class="sxs-lookup"><span data-stu-id="b59d9-170">The attribute list that you specify with a DirSync search also acts as a filter; search results include only objects on which one or more of the specified attributes have changed since the previous DirSync search.</span></span> <span data-ttu-id="b59d9-171">Si la lista de atributos no incluye ningún atributo que se retenga en los marcadores de exclusión, los resultados de la búsqueda no incluirán marcadores de exclusión.</span><span class="sxs-lookup"><span data-stu-id="b59d9-171">If the attribute list does not include any attributes that are retained on tombstones, the search results will not include tombstones.</span></span> <span data-ttu-id="b59d9-172">Para controlar esto, solicite todos los atributos especificando una lista de atributos null. o bien, puede solicitar el atributo **IsDeleted** , establecido en **true** en todos los marcadores de exclusión.</span><span class="sxs-lookup"><span data-stu-id="b59d9-172">To handle this, request all attributes by specifying a null attribute list; or you can request the **isDeleted** attribute, set to **TRUE** on all tombstones.</span></span> <span data-ttu-id="b59d9-173">Los atributos de desecho tienen el bit 0x8 establecido en el atributo **searchFlags** de la definición de **attributeSchema** .</span><span class="sxs-lookup"><span data-stu-id="b59d9-173">Tombstone attributes have the 0x8 bit set in the **searchFlags** attribute of the **attributeSchema** definition.</span></span>

<span data-ttu-id="b59d9-174">Para obtener más información, vea [recuperar objetos eliminados](retrieving-deleted-objects.md).</span><span class="sxs-lookup"><span data-stu-id="b59d9-174">For more information, see [Retrieving Deleted Objects](retrieving-deleted-objects.md).</span></span>

## <a name="ldap-implementation-of-the-dirsync-control"></a><span data-ttu-id="b59d9-175">Implementación LDAP del control DirSync</span><span class="sxs-lookup"><span data-stu-id="b59d9-175">LDAP Implementation of the DirSync Control</span></span>

<span data-ttu-id="b59d9-176">También puede realizar una búsqueda de DirSync mediante la API LDAP con el control [ \_ OID de \_ DirSync \_ del servidor LDAP](/previous-versions/windows/desktop/ldap/ldap-server-dirsync-oid) .</span><span class="sxs-lookup"><span data-stu-id="b59d9-176">You can also perform a DirSync search by using the LDAP API with the [LDAP\_SERVER\_DIRSYNC\_OID](/previous-versions/windows/desktop/ldap/ldap-server-dirsync-oid) control.</span></span> <span data-ttu-id="b59d9-177">Si usa la API de LDAP, especifique también el [ \_ \_ \_ \_ OID DN extendido del servidor LDAP](/previous-versions/windows/desktop/ldap/ldap-server-extended-dn-oid) y el [ \_ servidor LDAP Mostrar controles \_ \_ \_ OID eliminados](/previous-versions/windows/desktop/ldap/ldap-server-show-deleted-oid) .</span><span class="sxs-lookup"><span data-stu-id="b59d9-177">If you use the LDAP API, also specify the [LDAP\_SERVER\_EXTENDED\_DN\_OID](/previous-versions/windows/desktop/ldap/ldap-server-extended-dn-oid) and [LDAP\_SERVER\_SHOW\_DELETED\_OID](/previous-versions/windows/desktop/ldap/ldap-server-show-deleted-oid) controls.</span></span> <span data-ttu-id="b59d9-178">El \_ \_ control OID DN extendido del servidor LDAP \_ hace que \_ una búsqueda LDAP devuelva una forma extendida del nombre distintivo que incluye **objectGUID** y **objectSid** para objetos de entidad de seguridad, como usuarios, grupos y equipos.</span><span class="sxs-lookup"><span data-stu-id="b59d9-178">The LDAP\_SERVER\_EXTENDED\_DN\_OID control causes an LDAP search to return an extended form of the distinguished name that includes the **objectGUID** and **objectSID** for security principal objects such as users, groups, and computers.</span></span> <span data-ttu-id="b59d9-179">El \_ servidor LDAP \_ Mostrar \_ \_ control de OID eliminado hace que los resultados de la búsqueda incluyan los datos de los objetos eliminados.</span><span class="sxs-lookup"><span data-stu-id="b59d9-179">The LDAP\_SERVER\_SHOW\_DELETED\_OID control causes the search results to include data for deleted objects.</span></span> <span data-ttu-id="b59d9-180">Tenga en cuenta que estos controles se incluyen automáticamente en la implementación de ADSI.</span><span class="sxs-lookup"><span data-stu-id="b59d9-180">Be aware that these controls are automatically included in the ADSI implementation.</span></span>

 

 