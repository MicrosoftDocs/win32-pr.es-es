---
title: DLL de cliente de canal virtual
description: El cliente de una aplicación de canales virtuales es un archivo DLL que se carga durante la inicialización del Servicios de Escritorio remoto en el equipo cliente. El archivo DLL debe estar registrado en el equipo cliente.
ms.assetid: fca0505c-c4a9-4230-aeaa-ff3dfa62f581
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cfd7ffccda8b1da7dfc3920b0a47a12e97840e0a
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/16/2019
ms.locfileid: "104075783"
---
# <a name="virtual-channel-client-dll"></a><span data-ttu-id="3588b-104">DLL de cliente de canal virtual</span><span class="sxs-lookup"><span data-stu-id="3588b-104">Virtual Channel Client DLL</span></span>

<span data-ttu-id="3588b-105">El cliente de una aplicación de canales virtuales es un archivo DLL que se carga durante la inicialización del Servicios de Escritorio remoto en el equipo cliente.</span><span class="sxs-lookup"><span data-stu-id="3588b-105">The client of a virtual channels application is a DLL that is loaded during the Remote Desktop Services initialization on the client computer.</span></span> <span data-ttu-id="3588b-106">El archivo DLL debe estar registrado en el equipo cliente.</span><span class="sxs-lookup"><span data-stu-id="3588b-106">The DLL must be registered on the client computer.</span></span> <span data-ttu-id="3588b-107">Para obtener más información, consulte [registro de cliente de canal virtual](virtual-channel-client-registration.md).</span><span class="sxs-lookup"><span data-stu-id="3588b-107">For more information, see [Virtual Channel Client Registration](virtual-channel-client-registration.md).</span></span>

<span data-ttu-id="3588b-108">El archivo DLL de cliente debe exportar una función [**VirtualChannelEntry**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelentry) , que servicios de escritorio remoto llama durante la inicialización.</span><span class="sxs-lookup"><span data-stu-id="3588b-108">The client DLL must export a [**VirtualChannelEntry**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelentry) function, which Remote Desktop Services calls during initialization.</span></span> <span data-ttu-id="3588b-109">El punto de entrada **VirtualChannelEntry** recibe un puntero a una estructura de [**puntos de \_ entrada \_ de canal**](/windows/win32/api/cchannel/ns-cchannel-channel_entry_points) .</span><span class="sxs-lookup"><span data-stu-id="3588b-109">The **VirtualChannelEntry** entry point receives a pointer to a [**CHANNEL\_ENTRY\_POINTS**](/windows/win32/api/cchannel/ns-cchannel-channel_entry_points) structure.</span></span> <span data-ttu-id="3588b-110">Esta estructura contiene punteros a las funciones a las que el archivo DLL de cliente llama para tener acceso a los canales virtuales.</span><span class="sxs-lookup"><span data-stu-id="3588b-110">This structure contains pointers to the functions that the client DLL calls to access virtual channels.</span></span>



| <span data-ttu-id="3588b-111">Función</span><span class="sxs-lookup"><span data-stu-id="3588b-111">Function</span></span>                                                      | <span data-ttu-id="3588b-112">Descripción</span><span class="sxs-lookup"><span data-stu-id="3588b-112">Description</span></span>                                                                                                                                                                                                                                                                           |
|---------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="3588b-113">**VirtualChannelInit**</span><span class="sxs-lookup"><span data-stu-id="3588b-113">**VirtualChannelInit**</span></span>](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelinit)<br/>   | <span data-ttu-id="3588b-114">Registra los nombres de los canales virtuales que va a utilizar el cliente y proporciona una función de devolución de llamada [**VirtualChannelInitEvent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_init_event_fn) a través de la cual servicios de escritorio remoto notifica al cliente los eventos que afectan a la conexión del cliente.</span><span class="sxs-lookup"><span data-stu-id="3588b-114">Registers the names of the virtual channels to be used by the client and provides a [**VirtualChannelInitEvent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_init_event_fn) callback function through which Remote Desktop Services notifies the client about events that affect the client connection.</span></span><br/> |
| [<span data-ttu-id="3588b-115">**VirtualChannelOpen**</span><span class="sxs-lookup"><span data-stu-id="3588b-115">**VirtualChannelOpen**</span></span>](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelopen)<br/>   | <span data-ttu-id="3588b-116">Abre el cliente final de un canal virtual especificado y proporciona una función de devolución de llamada [**VirtualChannelOpenEvent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_open_event_fn) a través de la cual servicios de escritorio remoto notifica al cliente los eventos que afectan al canal virtual.</span><span class="sxs-lookup"><span data-stu-id="3588b-116">Opens the client end of a specified virtual channel and provides a [**VirtualChannelOpenEvent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_open_event_fn) callback function through which Remote Desktop Services notifies the client about events that affect the virtual channel.</span></span><br/>                    |
| [<span data-ttu-id="3588b-117">**VirtualChannelWrite**</span><span class="sxs-lookup"><span data-stu-id="3588b-117">**VirtualChannelWrite**</span></span>](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelwrite)<br/> | <span data-ttu-id="3588b-118">Escribe datos en un canal virtual.</span><span class="sxs-lookup"><span data-stu-id="3588b-118">Writes data to a virtual channel.</span></span> <span data-ttu-id="3588b-119">Servicios de Escritorio remoto envía estos datos al final del servidor del canal virtual.</span><span class="sxs-lookup"><span data-stu-id="3588b-119">Remote Desktop Services sends this data to the server end of the virtual channel.</span></span> <span data-ttu-id="3588b-120">El extremo del servidor llama a la función [**WTSVirtualChannelRead**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelread) para leer los datos.</span><span class="sxs-lookup"><span data-stu-id="3588b-120">The server end calls the [**WTSVirtualChannelRead**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelread) function to read the data.</span></span><br/>                                             |
| [<span data-ttu-id="3588b-121">**VirtualChannelClose**</span><span class="sxs-lookup"><span data-stu-id="3588b-121">**VirtualChannelClose**</span></span>](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelclose)<br/> | <span data-ttu-id="3588b-122">Cierra un canal virtual.</span><span class="sxs-lookup"><span data-stu-id="3588b-122">Closes a virtual channel.</span></span><br/>                                                                                                                                                                                                                                                  |



 

<span data-ttu-id="3588b-123">La función [**VirtualChannelEntry**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelentry) de la dll debe llamar a la función [**VirtualChannelInit**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelinit) para inicializar el acceso a los canales virtuales.</span><span class="sxs-lookup"><span data-stu-id="3588b-123">Your DLL's [**VirtualChannelEntry**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelentry) function must call the [**VirtualChannelInit**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelinit) function to initialize access to virtual channels.</span></span> <span data-ttu-id="3588b-124">Al llamar a **VirtualChannelInit**, debe pasar un puntero a la función de devolución de llamada [**VirtualChannelInitEvent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_init_event_fn) .</span><span class="sxs-lookup"><span data-stu-id="3588b-124">When you call **VirtualChannelInit**, you must pass a pointer to the [**VirtualChannelInitEvent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_init_event_fn) callback function.</span></span> <span data-ttu-id="3588b-125">Servicios de Escritorio remoto llama a esta función de devolución de llamada cuando se completa la inicialización y de nuevo cuando se ha establecido una conexión con un servidor de host Escritorio remoto de sesión de escritorio remoto (host de sesión de RD).</span><span class="sxs-lookup"><span data-stu-id="3588b-125">Remote Desktop Services calls this callback function when initialization is complete and again when a connection has been established with a Remote Desktop Session Host (RD Session Host) server.</span></span>

<span data-ttu-id="3588b-126">Una vez establecida la conexión, puede llamar a la función [**VirtualChannelOpen**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelopen) para abrir los canales virtuales registrados por la llamada a [**VirtualChannelInit**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelinit) .</span><span class="sxs-lookup"><span data-stu-id="3588b-126">After the connection is established, you can call the [**VirtualChannelOpen**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelopen) function to open the virtual channels registered by the [**VirtualChannelInit**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelinit) call.</span></span> <span data-ttu-id="3588b-127">La llamada a **VirtualChannelOpen** especifica un puntero a la función de devolución de llamada [**VirtualChannelOpenEvent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_open_event_fn) .</span><span class="sxs-lookup"><span data-stu-id="3588b-127">The **VirtualChannelOpen** call specifies a pointer to your [**VirtualChannelOpenEvent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_open_event_fn) callback function.</span></span>

<span data-ttu-id="3588b-128">Después de que se devuelva la llamada [**VirtualChannelOpen**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelopen) , puede llamar a la función [**VirtualChannelWrite**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelwrite) para escribir en el canal virtual.</span><span class="sxs-lookup"><span data-stu-id="3588b-128">After the [**VirtualChannelOpen**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelopen) call returns, you can call the [**VirtualChannelWrite**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelwrite) function to write to the virtual channel.</span></span> <span data-ttu-id="3588b-129">La operación de escritura es asincrónica, por lo que no debe liberar ni volver a usar el búfer que se pasa a **VirtualChannelWrite** hasta que servicios de escritorio remoto llama a la función [**VirtualChannelOpenEvent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_open_event_fn) para indicar que se ha completado la operación de escritura.</span><span class="sxs-lookup"><span data-stu-id="3588b-129">The write operation is asynchronous, so you must not free or reuse the buffer passed to **VirtualChannelWrite** until Remote Desktop Services calls your [**VirtualChannelOpenEvent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_open_event_fn) function to indicate that the write operation has been completed.</span></span> <span data-ttu-id="3588b-130">Cuando se llama a **VirtualChannelWrite**, se puede pasar una parte de los datos de usuario que identifica la operación de escritura.</span><span class="sxs-lookup"><span data-stu-id="3588b-130">When you call **VirtualChannelWrite**, you can pass a piece of user data that identifies the write operation.</span></span> <span data-ttu-id="3588b-131">Servicios de Escritorio remoto pasa de nuevo estos datos de usuario cuando llama a **VirtualChannelOpenEvent** para notificarle que la operación se ha completado.</span><span class="sxs-lookup"><span data-stu-id="3588b-131">Remote Desktop Services passes this user data back when it calls **VirtualChannelOpenEvent** to notify you that the operation has completed.</span></span> <span data-ttu-id="3588b-132">En el extremo del servidor del canal virtual, el complemento del servidor llama a la función [**WTSVirtualChannelRead**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelread) para leer los datos.</span><span class="sxs-lookup"><span data-stu-id="3588b-132">At the server end of the virtual channel, the server add-in calls the [**WTSVirtualChannelRead**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelread) function to read the data.</span></span>

<span data-ttu-id="3588b-133">Servicios de Escritorio remoto también llama a la función [**VirtualChannelOpenEvent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_open_event_fn) cuando el módulo de servidor escribe los datos en el canal virtual.</span><span class="sxs-lookup"><span data-stu-id="3588b-133">Remote Desktop Services also calls your [**VirtualChannelOpenEvent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_open_event_fn) function when data is written to the virtual channel by the server module.</span></span> <span data-ttu-id="3588b-134">El módulo de servidor llama a la función [**WTSVirtualChannelWrite**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelwrite) para escribir datos en el extremo de servidor del canal virtual.</span><span class="sxs-lookup"><span data-stu-id="3588b-134">The server module calls the [**WTSVirtualChannelWrite**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsvirtualchannelwrite) function to write data to the server end of the virtual channel.</span></span>

<span data-ttu-id="3588b-135">Los módulos de cliente y servidor pueden escribir bloques de datos de cualquier tamaño en el canal virtual.</span><span class="sxs-lookup"><span data-stu-id="3588b-135">The client and server modules can write data blocks of any size to the virtual channel.</span></span> <span data-ttu-id="3588b-136">Sin embargo, antes de enviar los datos, Servicios de Escritorio remoto segmenta los datos en fragmentos de \_ bytes de longitud de fragmentos de canal \_ .</span><span class="sxs-lookup"><span data-stu-id="3588b-136">Before sending the data, however, Remote Desktop Services segments the data into chunks of CHANNEL\_CHUNK\_LENGTH bytes.</span></span> <span data-ttu-id="3588b-137">Servicios de Escritorio remoto llama a la función [**VirtualChannelOpenEvent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_open_event_fn) una vez por cada fragmento de datos, en lugar de volver a generar los datos en un bloque del tamaño original.</span><span class="sxs-lookup"><span data-stu-id="3588b-137">Remote Desktop Services calls your [**VirtualChannelOpenEvent**](/windows/desktop/api/Cchannel/nc-cchannel-channel_open_event_fn) function once for each chunk of data, rather than rebuilding the data into a block of the original size.</span></span> <span data-ttu-id="3588b-138">Cada llamada a **VirtualChannelOpenEvent** indica el tamaño del fragmento, el tamaño total escrito por el servidor y si los datos constituyen el inicio, el medio o el final de un bloque escrito por el servidor.</span><span class="sxs-lookup"><span data-stu-id="3588b-138">Each call to **VirtualChannelOpenEvent** indicates the size of the chunk, the total size written by the server, and whether the data constitutes the beginning, middle, or end of a block written by the server.</span></span>

<span data-ttu-id="3588b-139">Puede llamar a la función [**VirtualChannelClose**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelclose) para cerrar un canal.</span><span class="sxs-lookup"><span data-stu-id="3588b-139">You can call the [**VirtualChannelClose**](/windows/desktop/api/Cchannel/nc-cchannel-virtualchannelclose) function to close a channel.</span></span> <span data-ttu-id="3588b-140">Sin embargo, no es necesario llamarlo porque Servicios de Escritorio remoto cierra todos los canales automáticamente cuando el cliente se desconecta del servidor.</span><span class="sxs-lookup"><span data-stu-id="3588b-140">However, it is not necessary to call it because Remote Desktop Services closes all channels automatically when the client disconnects from the server.</span></span>

 

 





