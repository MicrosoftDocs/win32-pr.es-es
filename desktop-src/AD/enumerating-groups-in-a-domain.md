---
title: Enumerar grupos en un dominio
description: Los grupos se pueden colocar en cualquier contenedor o unidad organizativa (OU) de un dominio, así como en la raíz del dominio.
ms.assetid: 7f9d3c90-b6f4-4bfa-960f-58f380aa487c
ms.tgt_platform: multiple
keywords:
- Enumerar grupos en un dominio AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3586b8c6d261c769cabe56def2aa9396a58fa3a5
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/17/2020
ms.locfileid: "103789573"
---
# <a name="enumerating-groups-in-a-domain"></a><span data-ttu-id="14ea4-104">Enumerar grupos en un dominio</span><span class="sxs-lookup"><span data-stu-id="14ea4-104">Enumerating Groups in a Domain</span></span>

<span data-ttu-id="14ea4-105">Los grupos se pueden colocar en cualquier contenedor o unidad organizativa (OU) de un dominio, así como en la raíz del dominio.</span><span class="sxs-lookup"><span data-stu-id="14ea4-105">Groups can be placed in any container or organizational unit (OU) in a domain as well as the root of the domain.</span></span> <span data-ttu-id="14ea4-106">Esto significa que los grupos pueden estar en varias ubicaciones en la jerarquía de directorios.</span><span class="sxs-lookup"><span data-stu-id="14ea4-106">This means that groups can be in numerous locations in the directory hierarchy.</span></span> <span data-ttu-id="14ea4-107">Por lo tanto, tiene dos opciones para enumerar los grupos:</span><span class="sxs-lookup"><span data-stu-id="14ea4-107">Therefore, you have two choices for enumerating groups:</span></span>

1.  <span data-ttu-id="14ea4-108">Enumerar los grupos contenidos directamente en un contenedor, una unidad organizativa o en la raíz del dominio.</span><span class="sxs-lookup"><span data-stu-id="14ea4-108">Enumerate the groups directly contained in a container, OU, or at the root of the domain.</span></span>

    <span data-ttu-id="14ea4-109">Enlace explícitamente al objeto contenedor que contiene los grupos que se van a enumerar, establezca un filtro que contenga "groups" como la clase mediante la propiedad [**IADsContainer. Filter**](/windows/desktop/api/iads/nn-iads-iadscontainer) y use el método [**IADsContainer:: get \_ \_ NewEnum**](/windows/desktop/api/iads/nf-iads-iadscontainer-get__newenum) para enumerar los objetos de grupo.</span><span class="sxs-lookup"><span data-stu-id="14ea4-109">Explicitly bind to the container object that contains the groups to enumerate, set a filter that contains "groups" as the class using the [**IADsContainer.Filter**](/windows/desktop/api/iads/nn-iads-iadscontainer) property, and use the [**IADsContainer::get\_\_NewEnum**](/windows/desktop/api/iads/nf-iads-iadscontainer-get__newenum) method to enumerate the group objects.</span></span>

    <span data-ttu-id="14ea4-110">Esta técnica enumera los grupos contenidos directamente en un contenedor o un objeto de unidad organizativa.</span><span class="sxs-lookup"><span data-stu-id="14ea4-110">This technique enumerates groups contained directly in a container or OU object.</span></span> <span data-ttu-id="14ea4-111">Si el contenedor contiene otros contenedores que pueden contener otros grupos, debe enlazar a esos contenedores y enumerar de forma recursiva los grupos en esos contenedores.</span><span class="sxs-lookup"><span data-stu-id="14ea4-111">If the container contains other containers that can potentially contain other groups, you must bind to those containers and recursively enumerate the groups on those containers.</span></span> <span data-ttu-id="14ea4-112">Para manipular los objetos de grupo y leer solo las propiedades específicas, use la búsqueda en profundidad que se describe en la opción 2.</span><span class="sxs-lookup"><span data-stu-id="14ea4-112">To manipulate the group objects and read only specific properties, use the deep search described in Option 2.</span></span>

    <span data-ttu-id="14ea4-113">Dado que la enumeración devuelve punteros a objetos COM ADSI que representan cada objeto de grupo, puede llamar a [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) para obtener punteros de interfaz [**IADs**](/windows/desktop/api/iads/nn-iads-iads), [**IADsGroup**](/windows/desktop/api/iads/nn-iads-iadsgroup)y [**IADsPropertyList**](/windows/desktop/api/iads/nn-iads-iadspropertylist) al objeto de grupo; es decir, puede obtener punteros de interfaz a cada objeto de grupo enumerado en un contenedor sin tener que enlazar explícitamente a cada objeto de grupo.</span><span class="sxs-lookup"><span data-stu-id="14ea4-113">Because enumeration returns pointers to ADSI COM objects representing each group object, you can call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) to get [**IADs**](/windows/desktop/api/iads/nn-iads-iads), [**IADsGroup**](/windows/desktop/api/iads/nn-iads-iadsgroup), and [**IADsPropertyList**](/windows/desktop/api/iads/nn-iads-iadspropertylist) interface pointers to the group object; that is, you can get interface pointers to each enumerated group object in a container without having to explicitly bind to each group object.</span></span> <span data-ttu-id="14ea4-114">Para realizar operaciones en todos los grupos directamente dentro de un contenedor, la enumeración no requiere un enlace a cada grupo para llamar a métodos **IADs** o **IADsGroup** .</span><span class="sxs-lookup"><span data-stu-id="14ea4-114">To perform operations on all the groups directly within a container, enumeration does not require binding to each group in order to call **IADs** or **IADsGroup** methods.</span></span> <span data-ttu-id="14ea4-115">Para recuperar propiedades específicas de los grupos, use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) tal y como se describe en la segunda opción.</span><span class="sxs-lookup"><span data-stu-id="14ea4-115">To retrieve specific properties from groups, use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) as described in the second option.</span></span>

    <span data-ttu-id="14ea4-116">Se produce una excepción cuando se intenta enumerar un grupo que contiene miembros que son entidades de seguridad conocida, como todos, usuarios autenticados, lote, etc.</span><span class="sxs-lookup"><span data-stu-id="14ea4-116">An exception to this occurs when you attempt to enumerate a group that contains members that are wellKnown security principals, such as Everyone, Authenticated users, BATCH, and so on.</span></span> <span data-ttu-id="14ea4-117">Dado que no se puede enlazar a estos tipos de objetos, no se enumeran al enumerar los grupos en el ámbito de WinNT, aunque puede parecer que se enlazan, porque ciertos métodos de IADs, como class, ADsPath y Name, devuelven resultados correctos cuando se invocan en miembros enumerados.</span><span class="sxs-lookup"><span data-stu-id="14ea4-117">Because you cannot bind to these types of objects, they are not listed when you enumerate groups in the WinNT scope, even though it may appear to bind, because certain IADs methods such as Class, ADsPath, and Name return correct results when invoked on enumerated members.</span></span>

2.  <span data-ttu-id="14ea4-118">Realice una búsqueda en profundidad de "objectCategory = grupo" para buscar todos los grupos de un árbol.</span><span class="sxs-lookup"><span data-stu-id="14ea4-118">Perform a deep search for "objectCategory=group" to find all groups in a tree.</span></span>

    <span data-ttu-id="14ea4-119">En primer lugar, enlace al objeto contenedor en el que va a comenzar la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="14ea4-119">First, bind to the container object where to begin the search.</span></span> <span data-ttu-id="14ea4-120">Por ejemplo, para buscar todos los grupos de un dominio, enlace a la raíz del dominio; para buscar todos los grupos del bosque, enlace al catálogo global y busque desde la raíz del GC.</span><span class="sxs-lookup"><span data-stu-id="14ea4-120">For example, to find all groups in a domain, bind to root of the domain; to find all groups in the forest, bind to global catalog and search from the root of the GC.</span></span>

    <span data-ttu-id="14ea4-121">A continuación, use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) para consultar mediante un filtro de búsqueda que contenga (objectCategory = grupo) y la preferencia de búsqueda del **\_ \_ subárbol del ámbito de ADS**.</span><span class="sxs-lookup"><span data-stu-id="14ea4-121">Then use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) to query using a search filter that contains (objectCategory=group) and search preference of **ADS\_SCOPE\_SUBTREE**.</span></span>

    > [!Note]  
    > <span data-ttu-id="14ea4-122">Puede realizar una búsqueda con una preferencia de búsqueda del **ámbito de ADS \_ \_ onelevel** para limitar la búsqueda al contenido directo del objeto contenedor al que se ha enlazado.</span><span class="sxs-lookup"><span data-stu-id="14ea4-122">You can perform a search with a search preference of **ADS\_SCOPE\_ONELEVEL** to limit the search to the direct contents of the container object that you bound to.</span></span>

     

    <span data-ttu-id="14ea4-123">[**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) solo recupera los valores de propiedades específicas de los grupos.</span><span class="sxs-lookup"><span data-stu-id="14ea4-123">[**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) retrieves only the values of specific properties from groups.</span></span> <span data-ttu-id="14ea4-124">Para recuperar valores, use **IDirectorySearch**.</span><span class="sxs-lookup"><span data-stu-id="14ea4-124">To retrieve values, use **IDirectorySearch**.</span></span> <span data-ttu-id="14ea4-125">Para manipular los objetos de grupo devueltos por una búsqueda, es decir, para usar métodos [**IADs**](/windows/desktop/api/iads/nn-iads-iads) o [**IADsGroup**](/windows/desktop/api/iads/nn-iads-iadsgroup) , enlace explícitamente a ellos.</span><span class="sxs-lookup"><span data-stu-id="14ea4-125">To manipulate the group objects returned from a search, that is, to use [**IADs**](/windows/desktop/api/iads/nn-iads-iads) or [**IADsGroup**](/windows/desktop/api/iads/nn-iads-iadsgroup) methods, explicitly bind to them.</span></span> <span data-ttu-id="14ea4-126">Para ello, especifique **distinguishedName** como una de las propiedades que se van a devolver de la búsqueda y use los nombres distintivos devueltos para enlazar con cada grupo devuelto en la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="14ea4-126">To do this, specify **distinguishedName** as one of the properties to return from the search and use the returned distinguished names to bind to each group returned in the search.</span></span>

    <span data-ttu-id="14ea4-127">Solo se recuperan las propiedades específicas.</span><span class="sxs-lookup"><span data-stu-id="14ea4-127">Only specific properties are retrieved.</span></span> <span data-ttu-id="14ea4-128">No se pueden recuperar todos los atributos sin especificar explícitamente cada atributo posible de la clase de grupo.</span><span class="sxs-lookup"><span data-stu-id="14ea4-128">You cannot retrieve all attributes without explicitly specifying every possible attribute of the group class.</span></span>

 

 