---
description: Implementa la interfaz IX509Enrollment.
ms.assetid: bcf5c2f0-b99f-4de5-83f4-44f17dc31cd4
title: Funciones de respuesta de certificado
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 15eec71d0493fa4961988b86db0397d0fd516508
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "105687928"
---
# <a name="certificate-response-functions"></a><span data-ttu-id="eb3ce-103">Funciones de respuesta de certificado</span><span class="sxs-lookup"><span data-stu-id="eb3ce-103">Certificate Response Functions</span></span>

<span data-ttu-id="eb3ce-104">CertEnroll.dll implementa la interfaz [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) para enviar una solicitud de certificado de cliente e instalar la respuesta de una [*entidad de certificación*](/windows/desktop/SecGloss/c-gly) (CA).</span><span class="sxs-lookup"><span data-stu-id="eb3ce-104">CertEnroll.dll implements the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) interface to submit a client certificate request and install the response from a [*certification authority*](/windows/desktop/SecGloss/c-gly) (CA).</span></span>

<span data-ttu-id="eb3ce-105">El proceso de inscripción puede dar cabida a los tres escenarios siguientes:</span><span class="sxs-lookup"><span data-stu-id="eb3ce-105">The enrollment process can accommodate the following three scenarios:</span></span>

<dl> <span data-ttu-id="eb3ce-106">Inscripción fuera de banda</span><span class="sxs-lookup"><span data-stu-id="eb3ce-106">Out-of-band enrollment</span></span>

1.  <span data-ttu-id="eb3ce-107">Llame a cualquier método de inicialización implementado por el objeto [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) .</span><span class="sxs-lookup"><span data-stu-id="eb3ce-107">Call any initialization method implemented by the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="eb3ce-108">Llame al método [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) para recuperar la solicitud.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-108">Call the [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) method to retrieve the request.</span></span>
3.  <span data-ttu-id="eb3ce-109">Envíe la solicitud fuera de banda (manualmente o mediante otro proceso).</span><span class="sxs-lookup"><span data-stu-id="eb3ce-109">Submit the request out of band (manually or by using some other process).</span></span>
4.  <span data-ttu-id="eb3ce-110">Reciba la respuesta de una CA.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-110">Receive the response from a CA.</span></span>
5.  <span data-ttu-id="eb3ce-111">Llame al método [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) .</span><span class="sxs-lookup"><span data-stu-id="eb3ce-111">Call the [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method.</span></span>

  
<span data-ttu-id="eb3ce-112">Inscripción automática</span><span class="sxs-lookup"><span data-stu-id="eb3ce-112">Automatic enrollment</span></span>

1.  <span data-ttu-id="eb3ce-113">Llame a cualquier método de inicialización implementado por el objeto [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) .</span><span class="sxs-lookup"><span data-stu-id="eb3ce-113">Call any initialization method implemented by the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="eb3ce-114">Llame al método [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) .</span><span class="sxs-lookup"><span data-stu-id="eb3ce-114">Call the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) method.</span></span>

  
<span data-ttu-id="eb3ce-115">Inscripción retrasada</span><span class="sxs-lookup"><span data-stu-id="eb3ce-115">Delayed enrollment</span></span>

1.  <span data-ttu-id="eb3ce-116">Llame a cualquier método de inicialización implementado por el objeto [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) .</span><span class="sxs-lookup"><span data-stu-id="eb3ce-116">Call any initialization method implemented by the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="eb3ce-117">Llame al método [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) para recuperar la solicitud.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-117">Call the [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) method to retrieve the request.</span></span>
3.  <span data-ttu-id="eb3ce-118">Almacene la solicitud hasta que esté listo para enviarla.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-118">Store the request until you are ready to submit it.</span></span>
4.  <span data-ttu-id="eb3ce-119">Cuando esté listo para inscribirse, llame al método [**Initialize**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-initialize) para reinicializar el objeto de inscripción.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-119">When you are ready to enroll, call the [**Initialize**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-initialize) method to reinitialize the enrollment object.</span></span>
5.  <span data-ttu-id="eb3ce-120">Llame al método [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) cuando la entidad de certificación devuelva un certificado.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-120">Call the [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method when the CA returns a certificate.</span></span>

  
</dl>

<span data-ttu-id="eb3ce-121">Durante el proceso de inscripción, puede llamar a la propiedad [**status**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_status) en el objeto [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) para recuperar un valor de enumeración [**EnrollmentEnrollStatus**](/windows/desktop/api/CertEnroll/ne-certenroll-enrollmentenrollstatus) que identifica si la inscripción se ha realizado correctamente, está pendiente, se ha omitido, ha generado un error o se ha denegado.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-121">During the enrollment process, you can call the [**Status**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_status) property on the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object to retrieve an [**EnrollmentEnrollStatus**](/windows/desktop/api/CertEnroll/ne-certenroll-enrollmentenrollstatus) enumeration value that identifies whether enrollment succeeded, is pending, was skipped, generated an error, or was denied.</span></span>

<span data-ttu-id="eb3ce-122">En cada una de las secciones siguientes se identifica una función exportada por Xenroll.dll para instalar una respuesta de certificado de una CA.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-122">Each of the following sections identifies a function exported by Xenroll.dll to install a certificate response from a CA.</span></span> <span data-ttu-id="eb3ce-123">En cada sección también se describe cómo usar CertEnroll.dll para reemplazar la función o se indica que no existe ninguna asignación entre las dos bibliotecas:</span><span class="sxs-lookup"><span data-stu-id="eb3ce-123">Each section also discusses how to use CertEnroll.dll to replace the function or indicates that no mapping between the two libraries exists:</span></span>

-   [<span data-ttu-id="eb3ce-124">acceptFilePKCS7WStr</span><span class="sxs-lookup"><span data-stu-id="eb3ce-124">acceptFilePKCS7WStr</span></span>](#acceptfilepkcs7wstr)
-   [<span data-ttu-id="eb3ce-125">acceptFileResponseWStr</span><span class="sxs-lookup"><span data-stu-id="eb3ce-125">acceptFileResponseWStr</span></span>](#acceptfileresponsewstr)
-   [<span data-ttu-id="eb3ce-126">acceptPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="eb3ce-126">acceptPKCS7Blob</span></span>](#acceptpkcs7blob)
-   [<span data-ttu-id="eb3ce-127">acceptResponseBlob</span><span class="sxs-lookup"><span data-stu-id="eb3ce-127">acceptResponseBlob</span></span>](#acceptresponseblob)
-   [<span data-ttu-id="eb3ce-128">getCertContextFromFileResponseWStr</span><span class="sxs-lookup"><span data-stu-id="eb3ce-128">getCertContextFromFileResponseWStr</span></span>](#getcertcontextfromfileresponsewstr)
-   [<span data-ttu-id="eb3ce-129">getCertContextFromPKCS7</span><span class="sxs-lookup"><span data-stu-id="eb3ce-129">getCertContextFromPKCS7</span></span>](#getcertcontextfrompkcs7)
-   [<span data-ttu-id="eb3ce-130">getCertContextFromResponseBlob</span><span class="sxs-lookup"><span data-stu-id="eb3ce-130">getCertContextFromResponseBlob</span></span>](#getcertcontextfromresponseblob)
-   [<span data-ttu-id="eb3ce-131">InstallPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="eb3ce-131">InstallPKCS7Blob</span></span>](#installpkcs7blobex)
-   [<span data-ttu-id="eb3ce-132">InstallPKCS7BlobEx</span><span class="sxs-lookup"><span data-stu-id="eb3ce-132">InstallPKCS7BlobEx</span></span>](#installpkcs7blobex)
-   [<span data-ttu-id="eb3ce-133">SPCFileNameWStr</span><span class="sxs-lookup"><span data-stu-id="eb3ce-133">SPCFileNameWStr</span></span>](#spcfilenamewstr)
-   [<span data-ttu-id="eb3ce-134">WriteCertToCSP</span><span class="sxs-lookup"><span data-stu-id="eb3ce-134">WriteCertToCSP</span></span>](#writecerttocsp)
-   [<span data-ttu-id="eb3ce-135">WriteCertToUserDS</span><span class="sxs-lookup"><span data-stu-id="eb3ce-135">WriteCertToUserDS</span></span>](#writecerttouserds)
-   [<span data-ttu-id="eb3ce-136">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="eb3ce-136">Related topics</span></span>](#related-topics)

## <a name="acceptfilepkcs7wstr"></a><span data-ttu-id="eb3ce-137">acceptFilePKCS7WStr</span><span class="sxs-lookup"><span data-stu-id="eb3ce-137">acceptFilePKCS7WStr</span></span>

<span data-ttu-id="eb3ce-138">La función [**acceptFilePKCS7WStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptfilepkcs7wstr) de Xenroll.dll instala una respuesta [*PKCS \# 7*](/windows/desktop/SecGloss/p-gly) desde un archivo.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-138">The [**acceptFilePKCS7WStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptfilepkcs7wstr) function in Xenroll.dll installs a [*PKCS \#7*](/windows/desktop/SecGloss/p-gly) response from a file.</span></span>

<span data-ttu-id="eb3ce-139">La biblioteca CertEnroll.dll no implementa directamente la funcionalidad para instalar una \# respuesta de certificado PKCS 7 desde un archivo.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-139">The CertEnroll.dll library does not directly implement functionality to install a PKCS \#7 certificate response from a file.</span></span> <span data-ttu-id="eb3ce-140">Sin embargo, puede crear una función personalizada para leer los datos de archivo en una matriz de bytes y llamar a [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) para instalar la respuesta.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-140">You can, however, create a custom function to read the file data into a byte array and call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install the response.</span></span>

<span data-ttu-id="eb3ce-141">Si especifica el valor **AllowNoOutstandingRequest** de la enumeración [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) para el primer parámetro de [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), no es necesario un certificado ficticio, lo que le permite instalar un certificado sin llamar primero a [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) o [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="eb3ce-141">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install a certificate without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="eb3ce-142">Sin embargo, si va a instalar un certificado mediante un script Web, debe existir un certificado ficticio en el almacén de solicitudes.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-142">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="eb3ce-143">Por lo tanto, debe especificar **AllowNone** para el primer parámetro.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-143">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="acceptfileresponsewstr"></a><span data-ttu-id="eb3ce-144">acceptFileResponseWStr</span><span class="sxs-lookup"><span data-stu-id="eb3ce-144">acceptFileResponseWStr</span></span>

<span data-ttu-id="eb3ce-145">La función [**acceptFileResponseWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptfileresponsewstr) de Xenroll.dll instala una \# respuesta de certificado PKCS 7 o CMC desde un archivo.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-145">The [**acceptFileResponseWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptfileresponsewstr) function in Xenroll.dll installs a PKCS \#7 or CMC certificate response from a file.</span></span>

<span data-ttu-id="eb3ce-146">La biblioteca CertEnroll.dll no implementa directamente la funcionalidad para instalar una respuesta de certificado desde un archivo.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-146">The CertEnroll.dll library does not directly implement functionality to install a certificate response from a file.</span></span> <span data-ttu-id="eb3ce-147">Sin embargo, puede crear una función personalizada para leer los datos de archivo en una matriz de bytes y llamar a [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) para instalar la \# respuesta PKCS 7 o CMC.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-147">You can, however, create a custom function to read the file data into a byte array and call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install the PKCS \#7 or CMC response.</span></span>

<span data-ttu-id="eb3ce-148">Si especifica el valor **AllowNoOutstandingRequest** de la enumeración [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) para el primer parámetro de [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), no es necesario un certificado ficticio, lo que le permite instalar un certificado sin llamar primero a [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) o [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="eb3ce-148">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install a certificate without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="eb3ce-149">Sin embargo, si va a instalar un certificado mediante un script Web, debe existir un certificado ficticio en el almacén de solicitudes.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-149">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="eb3ce-150">Por lo tanto, debe especificar **AllowNone** para el primer parámetro.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-150">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="acceptpkcs7blob"></a><span data-ttu-id="eb3ce-151">acceptPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="eb3ce-151">acceptPKCS7Blob</span></span>

<span data-ttu-id="eb3ce-152">La función [**acceptPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptpkcs7blob) de Xenroll.dll instala una respuesta PKCS \# 7 contenida en una matriz de bytes.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-152">The [**acceptPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptpkcs7blob) function in Xenroll.dll installs a PKCS \#7 response contained in a byte array.</span></span>

<span data-ttu-id="eb3ce-153">Puede llamar a [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) para instalar un \# mensaje PKCS 7.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-153">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 message.</span></span> <span data-ttu-id="eb3ce-154">Si especifica el valor **AllowNoOutstandingRequest** de la enumeración [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) para el primer parámetro de [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), no es necesario un certificado ficticio, lo que le permite instalar la \# respuesta PKCS 7 sin llamar primero a [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) o [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="eb3ce-154">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the PKCS \#7 response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="eb3ce-155">Sin embargo, si va a instalar un certificado mediante un script Web, debe existir un certificado ficticio en el almacén de solicitudes.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-155">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="eb3ce-156">Por lo tanto, debe especificar **AllowNone** para el primer parámetro.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-156">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="acceptresponseblob"></a><span data-ttu-id="eb3ce-157">acceptResponseBlob</span><span class="sxs-lookup"><span data-stu-id="eb3ce-157">acceptResponseBlob</span></span>

<span data-ttu-id="eb3ce-158">La función [**acceptResponseBlob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptresponseblob) de Xenroll.dll instala una respuesta de \# certificado PKCS 7 o CMC incluida en una matriz de bytes.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-158">The [**acceptResponseBlob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptresponseblob) function in Xenroll.dll installs a PKCS \#7 or CMC certificate response contained in a byte array.</span></span>

<span data-ttu-id="eb3ce-159">Puede llamar a [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) para instalar una \# respuesta PKCS 7 o CMC.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-159">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 or CMC response.</span></span> <span data-ttu-id="eb3ce-160">Si especifica el valor **AllowNoOutstandingRequest** de la enumeración [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) para el primer parámetro de [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), no es necesario un certificado ficticio, lo que le permite instalar la respuesta sin llamar primero a [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) o [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="eb3ce-160">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="eb3ce-161">Sin embargo, si va a instalar un certificado mediante un script Web, debe existir un certificado ficticio en el almacén de solicitudes.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-161">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="eb3ce-162">Por lo tanto, debe especificar **AllowNone** para el primer parámetro.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-162">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="getcertcontextfromfileresponsewstr"></a><span data-ttu-id="eb3ce-163">getCertContextFromFileResponseWStr</span><span class="sxs-lookup"><span data-stu-id="eb3ce-163">getCertContextFromFileResponseWStr</span></span>

<span data-ttu-id="eb3ce-164">La función [**getCertContextFromFileResponseWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromfileresponsewstr) de Xenroll.dll recupera el certificado de cliente de un archivo.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-164">The [**getCertContextFromFileResponseWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromfileresponsewstr) function in Xenroll.dll retrieves the client certificate from a file.</span></span>

<span data-ttu-id="eb3ce-165">La biblioteca CertEnroll.dll no implementa directamente la funcionalidad para recuperar un certificado de una respuesta de CA guardada en un archivo.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-165">The CertEnroll.dll library does not directly implement functionality to retrieve a certificate from a CA response saved in a file.</span></span> <span data-ttu-id="eb3ce-166">Sin embargo, puede crear una función personalizada para leer los datos de archivo en una matriz de bytes y llamar a [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) para instalar la \# respuesta PKCS 7 o CMC y llamar a la propiedad de [**certificado**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) para recuperar el certificado.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-166">You can, however, create a custom function to read the file data into a byte array and call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install the PKCS \#7 or CMC response, and call the [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) property to retrieve the certificate.</span></span>

<span data-ttu-id="eb3ce-167">Si especifica el valor **AllowNoOutstandingRequest** de la enumeración [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) para el primer parámetro de [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), no es necesario un certificado ficticio, lo que le permite instalar un certificado sin llamar primero a [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) o [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="eb3ce-167">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install a certificate without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="eb3ce-168">Sin embargo, si va a instalar un certificado mediante un script Web, debe existir un certificado ficticio en el almacén de solicitudes.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-168">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="eb3ce-169">Por lo tanto, debe especificar **AllowNone** para el primer parámetro.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-169">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="getcertcontextfrompkcs7"></a><span data-ttu-id="eb3ce-170">getCertContextFromPKCS7</span><span class="sxs-lookup"><span data-stu-id="eb3ce-170">getCertContextFromPKCS7</span></span>

<span data-ttu-id="eb3ce-171">La función [**getCertContextFromPKCS7**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-getcertcontextfrompkcs7) de Xenroll.dll recupera el certificado de cliente de una \# respuesta PKCS 7.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-171">The [**getCertContextFromPKCS7**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-getcertcontextfrompkcs7) function in Xenroll.dll retrieves the client certificate from a PKCS \#7 response.</span></span>

<span data-ttu-id="eb3ce-172">Puede llamar a la propiedad [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) en el objeto [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) para recuperar un certificado después de llamar al método [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) o [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) .</span><span class="sxs-lookup"><span data-stu-id="eb3ce-172">You can call the [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) property on the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object to retrieve a certificate after calling the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method.</span></span>

## <a name="getcertcontextfromresponseblob"></a><span data-ttu-id="eb3ce-173">getCertContextFromResponseBlob</span><span class="sxs-lookup"><span data-stu-id="eb3ce-173">getCertContextFromResponseBlob</span></span>

<span data-ttu-id="eb3ce-174">La función [**getCertContextFromResponseBlob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromresponseblob) de Xenroll.dll recupera un certificado de cliente a partir de una \# respuesta PKCS 7 o CMC.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-174">The [**getCertContextFromResponseBlob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromresponseblob) function in Xenroll.dll retrieves a client certificate from a PKCS \#7 or CMC response.</span></span>

<span data-ttu-id="eb3ce-175">Puede llamar a la propiedad [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) en el objeto [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) para recuperar un certificado después de llamar al método [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) o [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) .</span><span class="sxs-lookup"><span data-stu-id="eb3ce-175">You can call the [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) property on the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object to retrieve a certificate after calling the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method.</span></span>

## <a name="installpkcs7blob"></a><span data-ttu-id="eb3ce-176">InstallPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="eb3ce-176">InstallPKCS7Blob</span></span>

<span data-ttu-id="eb3ce-177">La función [**InstallPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-installpkcs7blob) de Xenroll.dll instala una respuesta PKCS \# 7.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-177">The [**InstallPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-installpkcs7blob) function in Xenroll.dll installs a PKCS \#7 response.</span></span>

<span data-ttu-id="eb3ce-178">Puede llamar a [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) para instalar una \# respuesta PKCS 7 o CMC.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-178">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 or CMC response.</span></span> <span data-ttu-id="eb3ce-179">Si especifica el valor **AllowNoOutstandingRequest** de la enumeración [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) para el primer parámetro de [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), no es necesario un certificado ficticio, lo que le permite instalar la respuesta sin llamar primero a [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) o [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="eb3ce-179">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="eb3ce-180">Sin embargo, si va a instalar un certificado mediante un script Web, debe existir un certificado ficticio en el almacén de solicitudes.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-180">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="eb3ce-181">Por lo tanto, debe especificar **AllowNone** para el primer parámetro.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-181">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="installpkcs7blobex"></a><span data-ttu-id="eb3ce-182">InstallPKCS7BlobEx</span><span class="sxs-lookup"><span data-stu-id="eb3ce-182">InstallPKCS7BlobEx</span></span>

<span data-ttu-id="eb3ce-183">La función [**InstallPKCS7BlobEx**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-installpkcs7blobex) de Xenroll.dll instala una respuesta PKCS \# 7 y devuelve el número de certificados instalados.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-183">The [**InstallPKCS7BlobEx**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-installpkcs7blobex) function in Xenroll.dll installs a PKCS \#7 response and returns the number of certificates installed.</span></span>

<span data-ttu-id="eb3ce-184">Puede llamar a [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) para instalar una \# respuesta PKCS 7 o CMC.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-184">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 or CMC response.</span></span> <span data-ttu-id="eb3ce-185">Si especifica el valor **AllowNoOutstandingRequest** de la enumeración [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) para el primer parámetro de [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), no es necesario un certificado ficticio, lo que le permite instalar la respuesta sin llamar primero a [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) o [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="eb3ce-185">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="eb3ce-186">Sin embargo, si va a instalar un certificado mediante un script Web, debe existir un certificado ficticio en el almacén de solicitudes.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-186">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="eb3ce-187">Por lo tanto, debe especificar **AllowNone** para el primer parámetro.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-187">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="spcfilenamewstr"></a><span data-ttu-id="eb3ce-188">SPCFileNameWStr</span><span class="sxs-lookup"><span data-stu-id="eb3ce-188">SPCFileNameWStr</span></span>

<span data-ttu-id="eb3ce-189">La función [**SPCFileNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_spcfilenamewstr) de Xenroll.dll especifica o recupera el nombre del archivo en el que se va a guardar la respuesta del certificado.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-189">The [**SPCFileNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_spcfilenamewstr) function in Xenroll.dll specifies or retrieves the name of the file in which to save the certificate response.</span></span> <span data-ttu-id="eb3ce-190">La biblioteca CertEnroll.dll no implementa la funcionalidad que permite copiar un certificado en un archivo específico.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-190">The CertEnroll.dll library does not implement functionality that enables you to copy a certificate to a specific file.</span></span> <span data-ttu-id="eb3ce-191">El proceso de inscripción instala automáticamente la cadena de certificados en los archivos de los almacenes adecuados.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-191">The enrollment process automatically installs the certificate chain into files in the appropriate stores.</span></span>

## <a name="writecerttocsp"></a><span data-ttu-id="eb3ce-192">WriteCertToCSP</span><span class="sxs-lookup"><span data-stu-id="eb3ce-192">WriteCertToCSP</span></span>

<span data-ttu-id="eb3ce-193">La función [**WriteCertToCSP**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttocsp) de Xenroll.dll especifica o recupera un valor booleano que indica si un certificado se debe escribir en un [*proveedor de servicios criptográficos*](/windows/desktop/SecGloss/c-gly) (CSP).</span><span class="sxs-lookup"><span data-stu-id="eb3ce-193">The [**WriteCertToCSP**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttocsp) function in Xenroll.dll specifies or retrieves a Boolean value that indicates whether a certificate should be written to a [*cryptographic service provider*](/windows/desktop/SecGloss/c-gly) (CSP).</span></span> <span data-ttu-id="eb3ce-194">Normalmente, si se llama a esta función, el proveedor es una [*tarjeta inteligente*](/windows/desktop/SecGloss/s-gly).</span><span class="sxs-lookup"><span data-stu-id="eb3ce-194">Typically, if this function is called, the provider is a [*smart card*](/windows/desktop/SecGloss/s-gly).</span></span>

<span data-ttu-id="eb3ce-195">En CertEnroll.dll, cuando un cliente llama al método [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) para enviar una solicitud de un certificado de tarjeta inteligente y se emite un certificado, [**ENROLL**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) instala automáticamente el certificado en la tarjeta inteligente, suponiendo que la tarjeta está instalada en el lector.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-195">In CertEnroll.dll, when a client calls the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) method to submit a request for a smart card certificate and a certificate is issued, [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) automatically installs the certificate on the smart card, assuming that the card is installed in the reader.</span></span> <span data-ttu-id="eb3ce-196">El método [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) también escribe automáticamente el certificado en la tarjeta inteligente.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-196">The [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method also automatically writes the certificate to the smart card.</span></span>

## <a name="writecerttouserds"></a><span data-ttu-id="eb3ce-197">WriteCertToUserDS</span><span class="sxs-lookup"><span data-stu-id="eb3ce-197">WriteCertToUserDS</span></span>

<span data-ttu-id="eb3ce-198">La función [**WriteCertToUserDS**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttouserds) de Xenroll.dll especifica o recupera un valor booleano que indica si un certificado se debe guardar en el almacén de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-198">The [**WriteCertToUserDS**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttouserds) function in Xenroll.dll specifies or retrieves a Boolean value that indicates whether a certificate should be saved in the Active Directory store.</span></span> <span data-ttu-id="eb3ce-199">La biblioteca CertEnroll.dll no implementa la funcionalidad que le permite especificar un almacén en el que copiar un certificado.</span><span class="sxs-lookup"><span data-stu-id="eb3ce-199">The CertEnroll.dll library does not implement functionality that enables you to specify a store to copy a certificate to.</span></span>

## <a name="related-topics"></a><span data-ttu-id="eb3ce-200">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="eb3ce-200">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="eb3ce-201">Asignación Xenroll.dll a CertEnroll.dll</span><span class="sxs-lookup"><span data-stu-id="eb3ce-201">Mapping Xenroll.dll to CertEnroll.dll</span></span>](mapping-xenroll-dll-to-certenroll-dll.md)
</dt> <dt>

[<span data-ttu-id="eb3ce-202">**IX509Enrollment**</span><span class="sxs-lookup"><span data-stu-id="eb3ce-202">**IX509Enrollment**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment)
</dt> </dl>

 

 
