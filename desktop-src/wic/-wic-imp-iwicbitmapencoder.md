---
description: Implementación de IWICBitmapEncoder
ms.assetid: b671e941-ded6-4bde-bc4d-461f13feade0
title: Implementación de IWICBitmapEncoder
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 590dffcf762d22155a89a8143994d9a4d8bcab02
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "103911953"
---
# <a name="implementing-iwicbitmapencoder"></a><span data-ttu-id="6b336-103">Implementación de IWICBitmapEncoder</span><span class="sxs-lookup"><span data-stu-id="6b336-103">Implementing IWICBitmapEncoder</span></span>

-   [<span data-ttu-id="6b336-104">IWICBitmapEncoder</span><span class="sxs-lookup"><span data-stu-id="6b336-104">IWICBitmapEncoder</span></span>](#implementing-iwicbitmapencoder)
    -   [<span data-ttu-id="6b336-105">Inicialización</span><span class="sxs-lookup"><span data-stu-id="6b336-105">Initialize</span></span>](#initialize)
    -   [<span data-ttu-id="6b336-106">GetContainerFormat</span><span class="sxs-lookup"><span data-stu-id="6b336-106">GetContainerFormat</span></span>](#getcontainerformat)
    -   [<span data-ttu-id="6b336-107">GetEncoderInfo</span><span class="sxs-lookup"><span data-stu-id="6b336-107">GetEncoderInfo</span></span>](#getencoderinfo)
    -   [<span data-ttu-id="6b336-108">CreateNewFrame</span><span class="sxs-lookup"><span data-stu-id="6b336-108">CreateNewFrame</span></span>](#createnewframe)
    -   [<span data-ttu-id="6b336-109">Confirmar</span><span class="sxs-lookup"><span data-stu-id="6b336-109">Commit</span></span>](#commit)
    -   [<span data-ttu-id="6b336-110">SetPreview</span><span class="sxs-lookup"><span data-stu-id="6b336-110">SetPreview</span></span>](#setpreview)
-   [<span data-ttu-id="6b336-111">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="6b336-111">Related topics</span></span>](#related-topics)

## <a name="iwicbitmapencoder"></a><span data-ttu-id="6b336-112">IWICBitmapEncoder</span><span class="sxs-lookup"><span data-stu-id="6b336-112">IWICBitmapEncoder</span></span>

-   [<span data-ttu-id="6b336-113">Inicialización</span><span class="sxs-lookup"><span data-stu-id="6b336-113">Initialize</span></span>](#initialize)
-   [<span data-ttu-id="6b336-114">GetContainerFormat</span><span class="sxs-lookup"><span data-stu-id="6b336-114">GetContainerFormat</span></span>](#getcontainerformat)
-   [<span data-ttu-id="6b336-115">GetEncoderInfo</span><span class="sxs-lookup"><span data-stu-id="6b336-115">GetEncoderInfo</span></span>](#getencoderinfo)
-   [<span data-ttu-id="6b336-116">CreateNewFrame</span><span class="sxs-lookup"><span data-stu-id="6b336-116">CreateNewFrame</span></span>](#createnewframe)
-   [<span data-ttu-id="6b336-117">Confirmar</span><span class="sxs-lookup"><span data-stu-id="6b336-117">Commit</span></span>](#commit)
-   [<span data-ttu-id="6b336-118">SetPreview</span><span class="sxs-lookup"><span data-stu-id="6b336-118">SetPreview</span></span>](#setpreview)

<span data-ttu-id="6b336-119">Esta interfaz es el homólogo de la interfaz [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder) y es el punto de partida para codificar un archivo de imagen.</span><span class="sxs-lookup"><span data-stu-id="6b336-119">This interface is the counterpart to the [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder) interface and is the starting point for encoding an image file.</span></span> <span data-ttu-id="6b336-120">Al igual que **IWICBitmapDecoder** se usa para recuperar las propiedades de nivel de contenedor y los marcos individuales del contenedor de imágenes, [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder) se usa para establecer las propiedades de nivel de contenedor y serializar los fotogramas de imagen individuales en el contenedor.</span><span class="sxs-lookup"><span data-stu-id="6b336-120">Just as **IWICBitmapDecoder** is used for retrieving container-level properties and individual frames from the image container, [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder) is used for setting container-level properties and serializing individual image frames into the container.</span></span> <span data-ttu-id="6b336-121">Esta interfaz se implementa en la clase de codificador de nivel de contenedor.</span><span class="sxs-lookup"><span data-stu-id="6b336-121">You implement this interface on your container-level encoder class.</span></span>

``` syntax
interface IWICBitmapEncoder : public IUnknown
{
   // Required methods
   HRESULT Initialize ( IStream *pIStream,
              WICBitmapEncoderCacheOption cacheOption );
   HRESULT GetContainerFormat ( GUID *pguidContainerFormat );
   HRESULT GetEncoderInfo ( IWICBitmapEncoderInfo **pIEncoderInfo );
   HRESULT CreateNewFrame ( IWICBitmapFrameEncode **ppIFrameEncode,
              IPropertyBag2 **ppIEncoderOptions );
   HRESULT Commit ( void );

   // Optional methods
   HRESULT SetPreview ( IWICBitmapSource *pIPreview );
   HRESULT SetThumbnail ( IWICBitmapSource *pIThumbnail );
   HRESULT SetColorContexts ( UINT cCount,
              IWICColorContext **ppIColorContext );
   HRESULT GetMetadataQueryWriter ( IWICMetadataQueryWriter 
              **ppIMetadataQueryWriter );
   HRESULT SetPalette ( IWICPalette *pIPalette);
};
```

<span data-ttu-id="6b336-122">Como se explicó en [implementación de IWICBitmapDecoder](-wic-imp-iwicbitmapdecoder.md), algunos formatos de imagen tienen miniaturas globales, contextos de color o metadatos, mientras que muchos formatos de imagen solo los proporcionan en cada fotograma.</span><span class="sxs-lookup"><span data-stu-id="6b336-122">As discussed in [Implementing IWICBitmapDecoder](-wic-imp-iwicbitmapdecoder.md), some image formats have global thumbnails, color contexts, or metadata, while many image formats provide these only on a per-frame basis.</span></span> <span data-ttu-id="6b336-123">Por lo tanto, los métodos para establecer estos valores son opcionales en [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder), pero son necesarios en [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode).</span><span class="sxs-lookup"><span data-stu-id="6b336-123">Therefore, the methods for setting these are optional on [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder), but are required on [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode).</span></span> <span data-ttu-id="6b336-124">Hablaremos sobre los métodos opcionales en **IWICBitmapEncoder** en la sección de **IWICBitmapFrameEncode**, donde se implementan con mayor frecuencia.</span><span class="sxs-lookup"><span data-stu-id="6b336-124">We’ll discuss the methods that are optional on **IWICBitmapEncoder** in the section on **IWICBitmapFrameEncode**, where they’re most commonly implemented.</span></span>

<span data-ttu-id="6b336-125">Si no admite miniaturas globales, devuelva WINCODEC \_ Err \_ CODECNOTHUMBNAIL desde el método SetThumbnail en [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder).</span><span class="sxs-lookup"><span data-stu-id="6b336-125">If you don’t support global thumbnails, return WINCODEC\_ERR\_CODECNOTHUMBNAIL from the SetThumbnail method on [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder).</span></span> <span data-ttu-id="6b336-126">Si no admite una paleta de nivel de contenedor, o si la imagen que está codificando no tiene un formato indexado, devuelva WINCODEC \_ Err \_ PALETTEUNAVAILABLE desde el método SetPalette.</span><span class="sxs-lookup"><span data-stu-id="6b336-126">If you don’t support a container-level palette, or if the image you are encoding doesn’t have an indexed format, return WINCODEC\_ERR\_PALETTEUNAVAILABLE from the SetPalette method.</span></span> <span data-ttu-id="6b336-127">Para cualquier otro método no admitido, devuelve WINCODEC \_ Err \_ UNSUPPORTEDOPERATION.</span><span class="sxs-lookup"><span data-stu-id="6b336-127">For any other unsupported methods, return WINCODEC\_ERR\_UNSUPPORTEDOPERATION.</span></span>

### <a name="initialize"></a><span data-ttu-id="6b336-128">Inicialización</span><span class="sxs-lookup"><span data-stu-id="6b336-128">Initialize</span></span>

<span data-ttu-id="6b336-129">[**Initialize**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-initialize) es el primer método invocado en un [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder) una vez que se ha creado una instancia.</span><span class="sxs-lookup"><span data-stu-id="6b336-129">[**Initialize**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-initialize) is the first method invoked on an [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder) after it has been instantiated.</span></span> <span data-ttu-id="6b336-130">Se pasa una secuencia de imágenes al codificador y, opcionalmente, un llamador puede especificar una opción de caché.</span><span class="sxs-lookup"><span data-stu-id="6b336-130">An image stream is passed to the encoder, and a caller may optionally specify a cache option.</span></span> <span data-ttu-id="6b336-131">En el caso del descodificador, el flujo es de solo lectura, pero el flujo que se pasa a un codificador es una secuencia grabable, en la que el codificador serializará todos los datos y metadatos de la imagen.</span><span class="sxs-lookup"><span data-stu-id="6b336-131">In the case of the decoder, the stream is read-only, but the stream passed to an encoder is a writeable stream, into which the encoder will serialize all of the image data and metadata.</span></span> <span data-ttu-id="6b336-132">Las opciones de caché del codificador también son diferentes.</span><span class="sxs-lookup"><span data-stu-id="6b336-132">The cache options on the encoder are different as well.</span></span>

``` syntax
enum WICBitmapEncoderCacheOption
{
   WICBitmapEncoderCacheInMemory,
   WICBitmapEncoderCacheTempFile,
   WICBitmapEncoderNoCache
}
```

<span data-ttu-id="6b336-133">La aplicación tiene la opción de solicitar al codificador que almacene en memoria caché los datos de la imagen, los almacene en memoria caché en un archivo temporal o que los escriba directamente en el archivo de disco sin almacenamiento en caché.</span><span class="sxs-lookup"><span data-stu-id="6b336-133">The application has a choice of requesting the encoder to cache the image data in memory, cache it in a temporary file, or to write it directly into the disk file with no caching.</span></span> <span data-ttu-id="6b336-134">Cuando se le pide almacenar en caché los datos en un archivo temporal, el codificador debe crear un archivo temporal en el disco y escribir directamente en ese archivo sin almacenar en caché en memoria.</span><span class="sxs-lookup"><span data-stu-id="6b336-134">When asked to cache the data in a temporary file, the encoder should create a temporary file on disk and write directly to that file without caching in memory.</span></span> <span data-ttu-id="6b336-135">Cuando el autor de la llamada selecciona la opción sin caché, cada fotograma se debe confirmar en orden antes de que se pueda crear el fotograma siguiente.</span><span class="sxs-lookup"><span data-stu-id="6b336-135">When the caller selects the no cache option, each frame must be committed in order before the next frame can be created.</span></span>

### <a name="getcontainerformat"></a><span data-ttu-id="6b336-136">GetContainerFormat</span><span class="sxs-lookup"><span data-stu-id="6b336-136">GetContainerFormat</span></span>

<span data-ttu-id="6b336-137">[**GetContainerFormat**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-getcontainerformat) se implementa de la misma manera que el método [GetContainerFormat](-wic-imp-iwicbitmapdecoder.md) en la [implementación de IWICBitmapDecoder](-wic-imp-iwicbitmapdecoder.md).</span><span class="sxs-lookup"><span data-stu-id="6b336-137">[**GetContainerFormat**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-getcontainerformat) is implemented the same way as the [GetContainerFormat](-wic-imp-iwicbitmapdecoder.md) method in [Implementing IWICBitmapDecoder](-wic-imp-iwicbitmapdecoder.md).</span></span>

### <a name="getencoderinfo"></a><span data-ttu-id="6b336-138">GetEncoderInfo</span><span class="sxs-lookup"><span data-stu-id="6b336-138">GetEncoderInfo</span></span>

<span data-ttu-id="6b336-139">[**GetEncoderInfo**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-getencoderinfo) devuelve un objeto [**IWICBitmapEncoderInfo**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapencoderinfo) .</span><span class="sxs-lookup"><span data-stu-id="6b336-139">[**GetEncoderInfo**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-getencoderinfo) returns an [**IWICBitmapEncoderInfo**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapencoderinfo) object.</span></span> <span data-ttu-id="6b336-140">Para obtener el objeto **IWICBitmapEncoderInfo** , solo tiene que pasar el GUID del codificador al método [**CreateComponentInfo**](/windows/desktop/api/Wincodec/nf-wincodec-iwicimagingfactory-createcomponentinfo) en [**IWICImagingFactory**](/windows/desktop/api/Wincodec/nn-wincodec-iwicimagingfactory)y, a continuación, solicitar la interfaz **IWICBitmapEncoderInfo** en él.</span><span class="sxs-lookup"><span data-stu-id="6b336-140">To get the **IWICBitmapEncoderInfo** object, just pass the GUID of your encoder to the [**CreateComponentInfo**](/windows/desktop/api/Wincodec/nf-wincodec-iwicimagingfactory-createcomponentinfo) method on [**IWICImagingFactory**](/windows/desktop/api/Wincodec/nn-wincodec-iwicimagingfactory), and then request the **IWICBitmapEncoderInfo** interface on it.</span></span>

<span data-ttu-id="6b336-141">Vea el ejemplo de [implementación de IWICBitmapDecoder](-wic-imp-iwicbitmapdecoder.md) en [GetDecoderInfo](-wic-imp-iwicbitmapdecoder.md).</span><span class="sxs-lookup"><span data-stu-id="6b336-141">See the example in [Implementing IWICBitmapDecoder](-wic-imp-iwicbitmapdecoder.md) under [GetDecoderInfo](-wic-imp-iwicbitmapdecoder.md).</span></span>

### <a name="createnewframe"></a><span data-ttu-id="6b336-142">CreateNewFrame</span><span class="sxs-lookup"><span data-stu-id="6b336-142">CreateNewFrame</span></span>

<span data-ttu-id="6b336-143">[**CreateNewFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-createnewframe) es el homólogo del codificador de [**GetFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapdecoder-getframe) en [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder).</span><span class="sxs-lookup"><span data-stu-id="6b336-143">[**CreateNewFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-createnewframe) is the encoder counterpart of [**GetFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapdecoder-getframe) on [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder).</span></span> <span data-ttu-id="6b336-144">Este método devuelve un objeto [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode) , que es el objeto que serializa realmente los datos de imagen para un marco específico dentro del contenedor.</span><span class="sxs-lookup"><span data-stu-id="6b336-144">This method returns an [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode) object, which is the object that actually serializes the image data for a specific frame within the container.</span></span>

<span data-ttu-id="6b336-145">Una de las ventajas de Windows Imaging Component (WIC) es que proporciona una capa de abstracción para aplicaciones que les permite trabajar con todos los formatos de imagen de la misma manera.</span><span class="sxs-lookup"><span data-stu-id="6b336-145">One of the benefits of Windows Imaging Component (WIC) is that it provides a layer of abstraction for applications that enables them to work with all image formats in the same way.</span></span> <span data-ttu-id="6b336-146">Sin embargo, no todos los formatos de imagen son exactamente iguales.</span><span class="sxs-lookup"><span data-stu-id="6b336-146">However, not all image formats are exactly the same.</span></span> <span data-ttu-id="6b336-147">Algunos formatos de imagen tienen funcionalidades que otros no tienen.</span><span class="sxs-lookup"><span data-stu-id="6b336-147">Some image formats have capabilities that others don’t have.</span></span> <span data-ttu-id="6b336-148">Para que las aplicaciones puedan aprovechar estas capacidades únicas, es necesario proporcionar una manera de que el códec las exponga.</span><span class="sxs-lookup"><span data-stu-id="6b336-148">For applications to be able to take advantage of those unique capabilities, it’s necessary to provide a way for the codec to expose them.</span></span> <span data-ttu-id="6b336-149">Este es el propósito de las opciones del codificador.</span><span class="sxs-lookup"><span data-stu-id="6b336-149">This is the purpose of encoder options.</span></span> <span data-ttu-id="6b336-150">Si el códec es compatible con las opciones del codificador, debe crear un objeto [IPropertyBag2](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768192(v=vs.85)) que exponga las opciones del codificador que admita y devolverlo en el parámetro *ppIEncoderOptions* de este método.</span><span class="sxs-lookup"><span data-stu-id="6b336-150">If your codec supports any encoder options, you should create an [IPropertyBag2](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768192(v=vs.85)) object that exposes the encoder options you support, and return it in the *ppIEncoderOptions* parameter of this method.</span></span> <span data-ttu-id="6b336-151">A continuación, el autor de la llamada puede usar este objeto IPropertyBag2 para determinar qué opciones del codificador admite el códec.</span><span class="sxs-lookup"><span data-stu-id="6b336-151">The caller can then use this IPropertyBag2 object to determine what encoder options your codec supports.</span></span> <span data-ttu-id="6b336-152">Si el llamador desea especificar valores para cualquiera de las opciones admitidas del codificador, asignará el valor a la propiedad correspondiente en el objeto IPropertyBag2 y lo pasará al objeto [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode) recién creado en el método Initialize.</span><span class="sxs-lookup"><span data-stu-id="6b336-152">If the caller wants to specify values for any of the supported encoder options, they will assign the value to the relevant property in the IPropertyBag2 object and pass it to the newly created [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode) object in its Initialize method.</span></span>

<span data-ttu-id="6b336-153">Para crear una instancia de un objeto [IPropertyBag2](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768192(v=vs.85)) , primero debe crear un struct PROPBAG2 para especificar cada opción de codificador que admita su codificador y su tipo de datos para cada propiedad.</span><span class="sxs-lookup"><span data-stu-id="6b336-153">To instantiate an [IPropertyBag2](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768192(v=vs.85)) object, you first need to create a PROPBAG2 struct to specify each encoder option your encoder supports and its data type for each property.</span></span> <span data-ttu-id="6b336-154">A continuación, debe implementar un objeto IPropertyBag2 que aplique los intervalos de valores para cada propiedad en la escritura y reconcilie los valores en conflicto o superpuestos.</span><span class="sxs-lookup"><span data-stu-id="6b336-154">Then you must implement an IPropertyBag2 object that enforces the value ranges for each property on write, and reconciles any conflicting or overlapping values.</span></span> <span data-ttu-id="6b336-155">En el caso de los conjuntos simples de opciones de codificador no conflictivas, puede invocar el método [**CreateEncoderPropertyBag**](/windows/desktop/api/Wincodecsdk/nf-wincodecsdk-iwiccomponentfactory-createencoderpropertybag) , que creará un objeto IPropertyBag2 simple mediante las propiedades que especifique en el struct PROPBAG2.</span><span class="sxs-lookup"><span data-stu-id="6b336-155">For simple sets of non-conflicting encoder options, you can invoke the [**CreateEncoderPropertyBag**](/windows/desktop/api/Wincodecsdk/nf-wincodecsdk-iwiccomponentfactory-createencoderpropertybag) method, which will create a simple IPropertyBag2 object using the properties you specify in your PROPBAG2 struct.</span></span> <span data-ttu-id="6b336-156">Todavía debe aplicar los intervalos de valores.</span><span class="sxs-lookup"><span data-stu-id="6b336-156">You must still enforce the value ranges.</span></span> <span data-ttu-id="6b336-157">En el caso de las opciones más avanzadas del codificador, o si necesita conciliar los valores en conflicto, debe escribir su propia implementación de IPropertyBag2.</span><span class="sxs-lookup"><span data-stu-id="6b336-157">For more advanced encoder options, or if you need to reconcile conflicting values, you should write your own IPropertyBag2 implementation.</span></span>


```C++
UINT cuiPropertyCount = 0;
IPropertyBag2* pPropertyBag = NULL;
PROPBAG2* pPropBagOptions;
HRESULT hr;

// Insert code here to initialize piPropertyBag with the 
// supported options for your encoder, and to initialize 
// cuiPropertyCount to the number of encoder option properties
// you are exposing.
...

hr = pComponentFactory->CreateEncoderPropertyBag( 
   pPropBagOptions, cuiPropertyCount, &pPropertyBag);
```



<span data-ttu-id="6b336-158">WIC proporciona un pequeño conjunto de opciones de codificador canónicos que usan algunos de los formatos de imagen comunes.</span><span class="sxs-lookup"><span data-stu-id="6b336-158">WIC provides a small set of canonical encoder options that are used by some of the common image formats.</span></span> <span data-ttu-id="6b336-159">Todas las opciones canónicas del codificador son opcionales y los códecs no son necesarios para admitir ninguno de ellos.</span><span class="sxs-lookup"><span data-stu-id="6b336-159">All of the canonical encoder options are optional, and codecs are not required to support any of them.</span></span> <span data-ttu-id="6b336-160">La razón por la que se proporcionan como opciones canónicas es que muchas aplicaciones exponen la interfaz de usuario para que los usuarios especifiquen estas opciones al guardar un archivo de imagen en un formato que los admita.</span><span class="sxs-lookup"><span data-stu-id="6b336-160">The reason they are provided as canonical options is because many applications expose the user interface for users to specify these options when saving an image file in a format that supports them.</span></span> <span data-ttu-id="6b336-161">Proporcionar una manera canónica de especificar estas opciones facilita a las aplicaciones la comunicación con los codificadores de una manera coherente.</span><span class="sxs-lookup"><span data-stu-id="6b336-161">Providing a canonical way to specify these options makes it easy for applications to communicate them to encoders in a consistent way.</span></span> <span data-ttu-id="6b336-162">En la tabla siguiente se enumeran las opciones de codificador canónicas.</span><span class="sxs-lookup"><span data-stu-id="6b336-162">The canonical encoder options are listed in the following table.</span></span>



| <span data-ttu-id="6b336-163">Opción de codificador</span><span class="sxs-lookup"><span data-stu-id="6b336-163">Encoder Option</span></span>     | <span data-ttu-id="6b336-164">VARTYPE</span><span class="sxs-lookup"><span data-stu-id="6b336-164">VARTYPE</span></span>  | <span data-ttu-id="6b336-165">Intervalo de valores</span><span class="sxs-lookup"><span data-stu-id="6b336-165">Value Range</span></span>               |
|--------------------|----------|---------------------------|
| <span data-ttu-id="6b336-166">Lossless</span><span class="sxs-lookup"><span data-stu-id="6b336-166">Lossless</span></span>           | <span data-ttu-id="6b336-167">VT \_ bool</span><span class="sxs-lookup"><span data-stu-id="6b336-167">VT\_BOOL</span></span> | <span data-ttu-id="6b336-168">Verdadero/Falso</span><span class="sxs-lookup"><span data-stu-id="6b336-168">True/False</span></span>                |
| <span data-ttu-id="6b336-169">ImageQuality</span><span class="sxs-lookup"><span data-stu-id="6b336-169">ImageQuality</span></span>       | <span data-ttu-id="6b336-170">VT \_ R4</span><span class="sxs-lookup"><span data-stu-id="6b336-170">VT\_R4</span></span>   | <span data-ttu-id="6b336-171">0.0-1.0</span><span class="sxs-lookup"><span data-stu-id="6b336-171">0.0-1.0</span></span>                   |
| <span data-ttu-id="6b336-172">CompressionQuality</span><span class="sxs-lookup"><span data-stu-id="6b336-172">CompressionQuality</span></span> | <span data-ttu-id="6b336-173">VT \_ R4</span><span class="sxs-lookup"><span data-stu-id="6b336-173">VT\_R4</span></span>   | <span data-ttu-id="6b336-174">0.0-1.0</span><span class="sxs-lookup"><span data-stu-id="6b336-174">0.0-1.0</span></span>                   |
| <span data-ttu-id="6b336-175">BitmapTransform</span><span class="sxs-lookup"><span data-stu-id="6b336-175">BitmapTransform</span></span>    | <span data-ttu-id="6b336-176">VT \_ UI1</span><span class="sxs-lookup"><span data-stu-id="6b336-176">VT\_UI1</span></span>  | <span data-ttu-id="6b336-177">WICBitmapTransformOptions</span><span class="sxs-lookup"><span data-stu-id="6b336-177">WICBitmapTransformOptions</span></span> |



 

<span data-ttu-id="6b336-178">Si el códec admite la codificación sin pérdida, debe exponer la opción de codificador sin pérdida como una manera de que las aplicaciones soliciten que una imagen se codifique sin pérdida.</span><span class="sxs-lookup"><span data-stu-id="6b336-178">If your codec supports lossless encoding, you should expose the Lossless encoder option as a way for applications to request that an image be losslessly encoded.</span></span> <span data-ttu-id="6b336-179">Si un autor de llamada establece esta propiedad en true, debe omitir la opción ImageQuality y codificar la imagen sin pérdida.</span><span class="sxs-lookup"><span data-stu-id="6b336-179">If a caller sets this property to True, you should ignore the ImageQuality option and encode the image losslessly.</span></span>

<span data-ttu-id="6b336-180">La opción ImageQuality permite a una aplicación especificar el grado de fidelidad con el que codificar la imagen.</span><span class="sxs-lookup"><span data-stu-id="6b336-180">The ImageQuality option allows an application to specify the degree of fidelity with which to encode the image.</span></span> <span data-ttu-id="6b336-181">Esta opción permite a un usuario establecer un equilibrio entre la calidad de la imagen y el tamaño del archivo o la velocidad.</span><span class="sxs-lookup"><span data-stu-id="6b336-181">This option lets a user make a tradeoff between image quality versus speed and/or file size.</span></span> <span data-ttu-id="6b336-182">JPEG es un ejemplo de un formato de imagen que admite este equilibrio.</span><span class="sxs-lookup"><span data-stu-id="6b336-182">JPEG is an example of an image format that supports this tradeoff.</span></span> <span data-ttu-id="6b336-183">Un valor de 0,0 indica que la fidelidad es de baja importancia y el codificador debe usar su algoritmo más perdido.</span><span class="sxs-lookup"><span data-stu-id="6b336-183">A value of 0.0 indicates that fidelity is of low importance and the encoder should use its most lossy algorithm.</span></span> <span data-ttu-id="6b336-184">Un valor de 1,0 indica que la fidelidad es la más importante y el codificador debe conservar la mayor fidelidad posible.</span><span class="sxs-lookup"><span data-stu-id="6b336-184">A value of 1.0 indicates that fidelity is the most important and the encoder should preserve the highest fidelity possible.</span></span> <span data-ttu-id="6b336-185">(Dependiendo del códec, esto puede ser sinónimo de la opción Lossless.</span><span class="sxs-lookup"><span data-stu-id="6b336-185">(Depending on your codec, this may be synonymous with the Lossless option.</span></span> <span data-ttu-id="6b336-186">Sin embargo, si el códec admite la codificación sin pérdida y la opción Lossless está establecida en true, se debe pasar por alto la opción ImageQuality).</span><span class="sxs-lookup"><span data-stu-id="6b336-186">However, if your codec supports lossless encoding, and if the Lossless option is set to True, the ImageQuality option should be ignored.)</span></span>

<span data-ttu-id="6b336-187">La opción CompressionQuality permite a una aplicación especificar la eficacia de la compresión que se va a usar al codificar la imagen.</span><span class="sxs-lookup"><span data-stu-id="6b336-187">The CompressionQuality option allows an application to specify the efficiency of compression to use when encoding the image.</span></span> <span data-ttu-id="6b336-188">Un algoritmo muy eficaz puede generar un archivo de imagen más pequeño con la misma calidad que un algoritmo de compresión menos eficaz, pero puede tardar más tiempo en codificarse.</span><span class="sxs-lookup"><span data-stu-id="6b336-188">A very efficient algorithm may produce a smaller image file with the same quality as a less efficient compression algorithm, but may take longer to encode.</span></span> <span data-ttu-id="6b336-189">Esta opción permite que un usuario especifique un equilibrio entre el tamaño del archivo y la velocidad de la codificación, a la vez que conserva el mismo nivel de calidad.</span><span class="sxs-lookup"><span data-stu-id="6b336-189">This option lets a user specify a tradeoff between file size versus speed of encoding, while preserving the same level of quality.</span></span> <span data-ttu-id="6b336-190">TIFF es un ejemplo de un formato de imagen que admite este equilibrio.</span><span class="sxs-lookup"><span data-stu-id="6b336-190">TIFF is an example of an image format that supports this tradeoff.</span></span> <span data-ttu-id="6b336-191">(Tenga en cuenta que un formato como JPEG admite distintos niveles de compresión, pero una mayor tasa de compresión resulta en una calidad de imagen inferior.</span><span class="sxs-lookup"><span data-stu-id="6b336-191">(Note that a format such as JPEG supports different levels of compression, but a higher rate of compression results in lower image quality.</span></span> <span data-ttu-id="6b336-192">Por lo tanto, un formato de imagen JPEG expondría la opción ImageQuality en lugar de la opción CompressionQuality). Un valor de 0,0 para esta opción indica que debe comprimir la imagen lo más rápidamente posible, sin reducir la fidelidad, a costa de un tamaño de archivo mayor.</span><span class="sxs-lookup"><span data-stu-id="6b336-192">Therefore, a JPEG image format would expose the ImageQuality option rather than the CompressionQuality option.) A value of 0.0 for this option indicates that you should compress the image as quickly as possible, without reducing fidelity, at the expense of a larger file size.</span></span> <span data-ttu-id="6b336-193">Un valor de 1,0 indica que debe crear el tamaño de archivo más pequeño posible (en el mismo nivel de calidad), independientemente del tiempo que pueda tardar en codificarlo.</span><span class="sxs-lookup"><span data-stu-id="6b336-193">A value of 1.0 indicates that you should create the smallest possible file size (at the same level of quality), regardless of how long it may take to encode it.</span></span> <span data-ttu-id="6b336-194">Un códec puede admitir tanto la opción ImageQuality como la opción CompressionQuality, donde la opción ImageQuality especifica el grado de pérdida aceptable y la opción CompressionQuality ofrece un equilibrio entre el tamaño y la velocidad en el nivel de calidad especificado.</span><span class="sxs-lookup"><span data-stu-id="6b336-194">A codec can support both the ImageQuality option and the CompressionQuality option, where the ImageQuality option specifies the acceptable degree of lossiness, and the CompressionQuality option offers a size/speed tradeoff at the specified quality level.</span></span>

<span data-ttu-id="6b336-195">La opción BitmapTransform proporciona una manera para que el llamador especifique un ángulo de giro o una orientación horizontal vertical u horizontal al codificar.</span><span class="sxs-lookup"><span data-stu-id="6b336-195">The BitmapTransform option provides a way for the caller to specify a rotation angle or vertical or horizontal flip orientation when encoding.</span></span> <span data-ttu-id="6b336-196">La enumeración WICBitmapTransformOptions que se usa para especificar la transformación solicitada es la misma enumeración usada al solicitar una transformación durante la descodificación a través de la interfaz IWICBitmapSourceTransform.</span><span class="sxs-lookup"><span data-stu-id="6b336-196">The WICBitmapTransformOptions enum used to specify the requested transform is the same enum used when requesting a transform during decoding through the IWICBitmapSourceTransform interface.</span></span>

<span data-ttu-id="6b336-197">Tenga en cuenta que los codificadores no se limitan a las opciones de codificador canónicos.</span><span class="sxs-lookup"><span data-stu-id="6b336-197">Note that encoders are not limited to the canonical encoder options.</span></span> <span data-ttu-id="6b336-198">El propósito de las opciones del codificador es permitir que los codificadores expongan sus capacidades y no hay ningún límite en cuanto a los tipos de funcionalidades que puede exponer.</span><span class="sxs-lookup"><span data-stu-id="6b336-198">The purpose of encoder options is to enable encoders to expose their capabilities, and there is no limit to the types of capabilities you can expose.</span></span> <span data-ttu-id="6b336-199">Asegúrese de que las opciones del codificador están bien documentadas.</span><span class="sxs-lookup"><span data-stu-id="6b336-199">Make sure your encoder options are well-documented.</span></span> <span data-ttu-id="6b336-200">Aunque una aplicación puede usar el contenedor de propiedades que se devuelve de este método para detectar los nombres, tipos y rangos de valores de las opciones admitidas, la única forma de averiguar su significado o de exponerlos en la interfaz de usuario es desde la documentación.</span><span class="sxs-lookup"><span data-stu-id="6b336-200">Even though an application can use the property bag you return from this method to discover the names, types, and value ranges for the options you support, the only way for them to find out their meanings, or how to expose them in the user interface, is from your documentation.</span></span>

### <a name="commit"></a><span data-ttu-id="6b336-201">Commit</span><span class="sxs-lookup"><span data-stu-id="6b336-201">Commit</span></span>

<span data-ttu-id="6b336-202">[**Commit**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-commit) es el método al que se llama después de que todos los datos y metadatos de la imagen se hayan serializado en la secuencia.</span><span class="sxs-lookup"><span data-stu-id="6b336-202">[**Commit**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-commit) is the method you call after all the image data and metadata have been serialized into the stream.</span></span> <span data-ttu-id="6b336-203">Debe utilizar este método para serializar los datos de la imagen de vista previa en el flujo y cualquier miniatura global, metadatos, paleta u otros elementos, si procede.</span><span class="sxs-lookup"><span data-stu-id="6b336-203">You should use this method to serialize the Preview image data into the stream, and any global thumbnails, metadata, palette, or other items, if applicable.</span></span> <span data-ttu-id="6b336-204">Este método no debe cerrar el flujo de archivo, porque se espera que la aplicación que abrió la secuencia lo cierre.</span><span class="sxs-lookup"><span data-stu-id="6b336-204">This method should not close the file stream, because the application that opened the stream is expected to close it.</span></span>

<span data-ttu-id="6b336-205">La sección sobre el método IWICBitmapFrameEncode: commit tiene detalles sobre cómo el IWICBitmapEncoderCacheOptions afecta al comportamiento de este método.</span><span class="sxs-lookup"><span data-stu-id="6b336-205">The section on the IWICBitmapFrameEncode:Commit method has details on how the IWICBitmapEncoderCacheOptions affect the behavior of this method.</span></span>

### <a name="setpreview"></a><span data-ttu-id="6b336-206">SetPreview</span><span class="sxs-lookup"><span data-stu-id="6b336-206">SetPreview</span></span>

<span data-ttu-id="6b336-207">[**SetPreview**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-setpreview) se usa para crear una vista previa de la imagen.</span><span class="sxs-lookup"><span data-stu-id="6b336-207">[**SetPreview**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-setpreview) is used to create a preview of the image.</span></span> <span data-ttu-id="6b336-208">Aunque no es estrictamente necesario que todas las imágenes tengan una vista previa, es muy recomendable.</span><span class="sxs-lookup"><span data-stu-id="6b336-208">While it is not strictly required that every image have a preview, it is highly recommended.</span></span> <span data-ttu-id="6b336-209">Las cámaras digitales y los escáneres modernos generan imágenes de alta resolución, que suelen ser muy grandes y, por consiguiente, tardan mucho tiempo en descodificarse.</span><span class="sxs-lookup"><span data-stu-id="6b336-209">Modern digital cameras and scanners generate very high resolution images, which tend to be very large and, consequently, take significant processing time to decode.</span></span> <span data-ttu-id="6b336-210">Las imágenes de la próxima generación de cámaras serán incluso mayores.</span><span class="sxs-lookup"><span data-stu-id="6b336-210">Images from the next generation of cameras will be even larger.</span></span> <span data-ttu-id="6b336-211">Es una buena idea proporcionar una versión más pequeña y de menor resolución de una imagen, normalmente en formato JPEG, que se puede descodificar rápidamente y mostrar "al instante" cuando un usuario lo solicita.</span><span class="sxs-lookup"><span data-stu-id="6b336-211">It’s a good idea to provide a smaller, lower resolution version of an image, typically in JPEG format, that can be quickly decoded and displayed “instantly” when a user requests it.</span></span> <span data-ttu-id="6b336-212">Una aplicación puede solicitar una vista previa antes de solicitar la descodificación de la imagen real para proporcionar una mejor experiencia a los usuarios y mostrarles una representación de tamaño de pantalla de la imagen mientras theyare esperando descodificar la imagen real.</span><span class="sxs-lookup"><span data-stu-id="6b336-212">An application may request a preview before requesting the actual image to be decoded to provide a better experience for users, and show them a screen-size representation of the image while theyare waiting to decode the actual image.</span></span> <span data-ttu-id="6b336-213">Aunque los códecs deben proporcionar versiones preliminares, los códecs que no son compatibles con [**IWICBitmapSourceTransform**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapsourcetransform) deben hacerlo.</span><span class="sxs-lookup"><span data-stu-id="6b336-213">Although codecs should provide previews, codecs that do not support [**IWICBitmapSourceTransform**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapsourcetransform) should definitely do so.</span></span>

<span data-ttu-id="6b336-214">Si proporciona una vista previa JPEG, no tiene que escribir un codificador JPEG para codificarla.</span><span class="sxs-lookup"><span data-stu-id="6b336-214">If you provide a JPEG preview, you don’t have to write a JPEG encoder to encode it.</span></span> <span data-ttu-id="6b336-215">Debe delegar al codificador JPEG que se suministra con la plataforma WIC para codificar vistas previas y vistas en miniatura.</span><span class="sxs-lookup"><span data-stu-id="6b336-215">You should delegate to the JPEG encoder that ships with the WIC platform for encoding both previews and thumbnails.</span></span>

## <a name="related-topics"></a><span data-ttu-id="6b336-216">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="6b336-216">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="6b336-217">**Referencia**</span><span class="sxs-lookup"><span data-stu-id="6b336-217">**Reference**</span></span>
</dt> <dt>

[<span data-ttu-id="6b336-218">**IWICBitmapEncoder**</span><span class="sxs-lookup"><span data-stu-id="6b336-218">**IWICBitmapEncoder**</span></span>](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)
</dt> <dt>

[<span data-ttu-id="6b336-219">**IWICBitmapFrameEncode**</span><span class="sxs-lookup"><span data-stu-id="6b336-219">**IWICBitmapFrameEncode**</span></span>](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)
</dt> <dt>

<span data-ttu-id="6b336-220">**Vista**</span><span class="sxs-lookup"><span data-stu-id="6b336-220">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="6b336-221">Interfaces del codificador</span><span class="sxs-lookup"><span data-stu-id="6b336-221">Encoder Interfaces</span></span>](-wic-encoderinterfaces.md)
</dt> <dt>

[<span data-ttu-id="6b336-222">Implementación de IWICBitmapCodecProgressNotification (encoder)</span><span class="sxs-lookup"><span data-stu-id="6b336-222">Implementing IWICBitmapCodecProgressNotification (Encoder)</span></span>](-wic-imp-iwicbitmapcodecprogressnotification-encoder.md)
</dt> <dt>

[<span data-ttu-id="6b336-223">Cómo escribir un códec de WIC-Enabled</span><span class="sxs-lookup"><span data-stu-id="6b336-223">How to Write a WIC-Enabled CODEC</span></span>](-wic-howtowriteacodec.md)
</dt> <dt>

[<span data-ttu-id="6b336-224">Información general sobre componentes de Windows Imaging</span><span class="sxs-lookup"><span data-stu-id="6b336-224">Windows Imaging Component Overview</span></span>](-wic-about-windows-imaging-codec.md)
</dt> </dl>

 

 
