---
description: El protocolo de enlace de seguridad de la capa de transporte (TLS) es responsable de la autenticación y el intercambio de claves necesarios para establecer o reanudar las sesiones seguras.
ms.assetid: 65fb4db3-e505-457a-9159-dba0b506ea0b
title: Protocolo de enlace TLS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e0c7cfa9e9db54a6035abe147ce00bbde59bcc86
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "105668248"
---
# <a name="tls-handshake-protocol"></a><span data-ttu-id="fb279-103">Protocolo de enlace TLS</span><span class="sxs-lookup"><span data-stu-id="fb279-103">TLS Handshake Protocol</span></span>

<span data-ttu-id="fb279-104">El protocolo de enlace de seguridad de la [*capa de transporte*](../secgloss/t-gly.md) (TLS) es responsable de la autenticación y el intercambio de claves necesarios para establecer o reanudar las sesiones seguras.</span><span class="sxs-lookup"><span data-stu-id="fb279-104">The [*Transport Layer Security*](../secgloss/t-gly.md) (TLS) Handshake Protocol is responsible for the authentication and key exchange necessary to establish or resume secure sessions.</span></span> <span data-ttu-id="fb279-105">Al establecer una [*sesión*](../secgloss/s-gly.md)segura, el protocolo de enlace administra lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="fb279-105">When establishing a secure [*session*](../secgloss/s-gly.md), the Handshake Protocol manages the following:</span></span>

-   <span data-ttu-id="fb279-106">Negociación de conjunto de cifrado</span><span class="sxs-lookup"><span data-stu-id="fb279-106">Cipher suite negotiation</span></span>
-   <span data-ttu-id="fb279-107">Autenticación del servidor y, opcionalmente, el cliente</span><span class="sxs-lookup"><span data-stu-id="fb279-107">Authentication of the server and optionally, the client</span></span>
-   <span data-ttu-id="fb279-108">Intercambio de información de claves de sesión.</span><span class="sxs-lookup"><span data-stu-id="fb279-108">Session key information exchange.</span></span>

## <a name="cipher-suite-negotiation"></a><span data-ttu-id="fb279-109">Negociación de conjunto de cifrado</span><span class="sxs-lookup"><span data-stu-id="fb279-109">Cipher Suite Negotiation</span></span>

<span data-ttu-id="fb279-110">El cliente y el servidor hacen contacto y eligen el conjunto de cifrado que se usará en el intercambio de mensajes.</span><span class="sxs-lookup"><span data-stu-id="fb279-110">The client and server make contact and choose the cipher suite that will be used throughout their message exchange.</span></span>

## <a name="authentication"></a><span data-ttu-id="fb279-111">Autenticación</span><span class="sxs-lookup"><span data-stu-id="fb279-111">Authentication</span></span>

<span data-ttu-id="fb279-112">En TLS, un servidor demuestra su identidad al cliente.</span><span class="sxs-lookup"><span data-stu-id="fb279-112">In TLS, a server proves its identity to the client.</span></span> <span data-ttu-id="fb279-113">Es posible que el cliente también tenga que demostrar su identidad en el servidor.</span><span class="sxs-lookup"><span data-stu-id="fb279-113">The client might also need to prove its identity to the server.</span></span> <span data-ttu-id="fb279-114">La PKI, el uso de [*pares de claves pública y privada*](../secgloss/p-gly.md), es la base de esta autenticación.</span><span class="sxs-lookup"><span data-stu-id="fb279-114">PKI, the use of [*public/private key pairs*](../secgloss/p-gly.md), is the basis of this authentication.</span></span> <span data-ttu-id="fb279-115">El método exacto que se usa para la autenticación viene determinado por el conjunto de cifrado negociado.</span><span class="sxs-lookup"><span data-stu-id="fb279-115">The exact method used for authentication is determined by the cipher suite negotiated.</span></span>

## <a name="key-exchange"></a><span data-ttu-id="fb279-116">Intercambio de claves</span><span class="sxs-lookup"><span data-stu-id="fb279-116">Key Exchange</span></span>

<span data-ttu-id="fb279-117">El cliente y el servidor intercambian los números aleatorios y un número especial denominado secreto anterior al patrón.</span><span class="sxs-lookup"><span data-stu-id="fb279-117">The client and server exchange random numbers and a special number called the Pre-Master Secret.</span></span> <span data-ttu-id="fb279-118">Estos números se combinan con datos adicionales que permiten al cliente y al servidor crear su secreto compartido, denominado secreto principal.</span><span class="sxs-lookup"><span data-stu-id="fb279-118">These numbers are combined with additional data permitting client and server to create their shared secret, called the Master Secret.</span></span> <span data-ttu-id="fb279-119">El cliente y el servidor usan el secreto principal para generar el secreto de MAC de escritura, que es la clave de sesión que se usa para el [*hash*](../secgloss/h-gly.md)y la clave de escritura, que es la [*clave de sesión*](../secgloss/s-gly.md) que se usa para el cifrado.</span><span class="sxs-lookup"><span data-stu-id="fb279-119">The Master Secret is used by client and server to generate the write MAC secret, which is the session key used for [*hashing*](../secgloss/h-gly.md), and the write key, which is the [*session key*](../secgloss/s-gly.md) used for encryption.</span></span>

## <a name="establishing-a-secure-session-by-using-tls"></a><span data-ttu-id="fb279-120">Establecer una sesión segura mediante TLS</span><span class="sxs-lookup"><span data-stu-id="fb279-120">Establishing a Secure Session by Using TLS</span></span>

<span data-ttu-id="fb279-121">El protocolo de enlace TLS implica los siguientes pasos:</span><span class="sxs-lookup"><span data-stu-id="fb279-121">The TLS Handshake Protocol involves the following steps:</span></span>

1.  <span data-ttu-id="fb279-122">El cliente envía un mensaje "Hello Client" al servidor, junto con el valor aleatorio del cliente y los conjuntos de cifrado admitidos.</span><span class="sxs-lookup"><span data-stu-id="fb279-122">The client sends a "Client hello" message to the server, along with the client's random value and supported cipher suites.</span></span>
2.  <span data-ttu-id="fb279-123">El servidor responde mediante el envío de un mensaje "Hello Server" al cliente, junto con el valor aleatorio del servidor.</span><span class="sxs-lookup"><span data-stu-id="fb279-123">The server responds by sending a "Server hello" message to the client, along with the server's random value.</span></span>
3.  <span data-ttu-id="fb279-124">El servidor envía su certificado al cliente para la autenticación y puede solicitar un certificado del cliente.</span><span class="sxs-lookup"><span data-stu-id="fb279-124">The server sends its certificate to the client for authentication and may request a certificate from the client.</span></span> <span data-ttu-id="fb279-125">El servidor envía el mensaje "Server Hello Done".</span><span class="sxs-lookup"><span data-stu-id="fb279-125">The server sends the "Server hello done" message.</span></span>
4.  <span data-ttu-id="fb279-126">Si el servidor ha solicitado un certificado del cliente, el cliente lo envía.</span><span class="sxs-lookup"><span data-stu-id="fb279-126">If the server has requested a certificate from the client, the client sends it.</span></span>
5.  <span data-ttu-id="fb279-127">El cliente crea un secreto de maestro previo aleatorio y lo cifra con la [*clave pública*](../secgloss/p-gly.md) del certificado del servidor y envía el secreto del maestro previo cifrado al servidor.</span><span class="sxs-lookup"><span data-stu-id="fb279-127">The client creates a random Pre-Master Secret and encrypts it with the [*public key*](../secgloss/p-gly.md) from the server's certificate, sending the encrypted Pre-Master Secret to the server.</span></span>
6.  <span data-ttu-id="fb279-128">El servidor recibe el secreto del patrón previo.</span><span class="sxs-lookup"><span data-stu-id="fb279-128">The server receives the Pre-Master Secret.</span></span> <span data-ttu-id="fb279-129">Cada servidor y cliente generan el secreto principal y [*las claves de sesión*](../secgloss/s-gly.md) basadas en el secreto del patrón previo.</span><span class="sxs-lookup"><span data-stu-id="fb279-129">The server and client each generate the Master Secret and [*session keys*](../secgloss/s-gly.md) based on the Pre-Master Secret.</span></span>
7.  <span data-ttu-id="fb279-130">El cliente envía una notificación de "cambiar especificación de cifrado" al servidor para indicar que el cliente comenzará a usar las nuevas [*claves de sesión*](../secgloss/s-gly.md) para el [*hash*](../secgloss/h-gly.md) y el cifrado de mensajes.</span><span class="sxs-lookup"><span data-stu-id="fb279-130">The client sends "Change cipher spec" notification to server to indicate that the client will start using the new [*session keys*](../secgloss/s-gly.md) for [*hashing*](../secgloss/h-gly.md) and encrypting messages.</span></span> <span data-ttu-id="fb279-131">El cliente también envía el mensaje "cliente finalizado".</span><span class="sxs-lookup"><span data-stu-id="fb279-131">Client also sends "Client finished" message.</span></span>
8.  <span data-ttu-id="fb279-132">El servidor recibe "cambiar especificación de cifrado" y cambia el estado de seguridad de la capa de registro al [*cifrado simétrico*](../secgloss/s-gly.md) mediante las [*claves de sesión*](../secgloss/s-gly.md).</span><span class="sxs-lookup"><span data-stu-id="fb279-132">Server receives "Change cipher spec" and switches its record layer security state to [*symmetric encryption*](../secgloss/s-gly.md) using the [*session keys*](../secgloss/s-gly.md).</span></span> <span data-ttu-id="fb279-133">El servidor envía el mensaje "servidor finalizado" al cliente.</span><span class="sxs-lookup"><span data-stu-id="fb279-133">Server sends "Server finished" message to the client.</span></span>
9.  <span data-ttu-id="fb279-134">El cliente y el servidor ahora pueden intercambiar datos de aplicación a través del canal seguro que han establecido.</span><span class="sxs-lookup"><span data-stu-id="fb279-134">Client and server can now exchange application data over the secured channel they have established.</span></span> <span data-ttu-id="fb279-135">Todos los mensajes enviados del cliente al servidor y del servidor al cliente se cifran mediante la clave de sesión.</span><span class="sxs-lookup"><span data-stu-id="fb279-135">All messages sent from client to server and from server to client are encrypted using session key.</span></span>

## <a name="resuming-a-secure-session-by-using-tls"></a><span data-ttu-id="fb279-136">Reanudación de una sesión segura mediante TLS</span><span class="sxs-lookup"><span data-stu-id="fb279-136">Resuming a Secure Session by Using TLS</span></span>

1.  <span data-ttu-id="fb279-137">El cliente envía un mensaje "Hello de cliente" con el identificador de sesión de la sesión que se va a reanudar.</span><span class="sxs-lookup"><span data-stu-id="fb279-137">The client sends a "Client hello" message using the Session ID of the session to be resumed.</span></span>
2.  <span data-ttu-id="fb279-138">El servidor comprueba si hay un identificador de sesión coincidente en la memoria caché de la sesión.</span><span class="sxs-lookup"><span data-stu-id="fb279-138">The server checks its session cache for a matching Session ID.</span></span> <span data-ttu-id="fb279-139">Si se encuentra una coincidencia y el servidor puede reanudar la sesión, envía un mensaje "Hello Server" con el identificador de sesión.</span><span class="sxs-lookup"><span data-stu-id="fb279-139">If a match is found, and the server is able to resume the session, it sends a "Server hello" message with the Session ID.</span></span>
    > [!Note]  
    > <span data-ttu-id="fb279-140">Si no se encuentra una coincidencia con el identificador de sesión, el servidor genera un nuevo identificador de sesión y el cliente y el servidor de TLS realizan un protocolo de enlace completo.</span><span class="sxs-lookup"><span data-stu-id="fb279-140">If a session ID match is not found, the server generates a new session ID and the TLS client and server perform a full handshake.</span></span>

     

3.  <span data-ttu-id="fb279-141">El cliente y el servidor deben intercambiar los mensajes de "cambiar especificación de cifrado" y enviar mensajes de "cliente finalizado" y "servidor finalizado".</span><span class="sxs-lookup"><span data-stu-id="fb279-141">Client and server must exchange "Change cipher spec" messages and send "Client finished" and "Server finished" messages.</span></span>
4.  <span data-ttu-id="fb279-142">El cliente y el servidor ahora pueden reanudar el intercambio de datos de la aplicación a través del canal seguro.</span><span class="sxs-lookup"><span data-stu-id="fb279-142">Client and server can now resume application data exchange over the secure channel.</span></span>

 

 
