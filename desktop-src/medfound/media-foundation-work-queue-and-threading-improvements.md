---
description: En este tema se describen las mejoras de Windows 8 para las colas de trabajo y los subprocesos en la plataforma Microsoft Media Foundation.
ms.assetid: 9E2A1D94-BF82-488E-8297-D524683ABE17
title: Mejoras en la cola de trabajo y subprocesos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 07b307cb00316696e075e9e9cc2a138e98e149be
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/03/2021
ms.locfileid: "104083584"
---
# <a name="work-queue-and-threading-improvements"></a><span data-ttu-id="f5448-103">Mejoras en la cola de trabajo y subprocesos</span><span class="sxs-lookup"><span data-stu-id="f5448-103">Work Queue and Threading Improvements</span></span>

<span data-ttu-id="f5448-104">En este tema se describen las mejoras de Windows 8 para las colas de trabajo y los subprocesos en la plataforma Microsoft Media Foundation.</span><span class="sxs-lookup"><span data-stu-id="f5448-104">This topic describes improvements in Windows 8 for work queues and threading in the Microsoft Media Foundation platform.</span></span>

-   [<span data-ttu-id="f5448-105">Comportamiento de Windows 7</span><span class="sxs-lookup"><span data-stu-id="f5448-105">Windows 7 Behavior</span></span>](#windows-7-behavior)
    -   [<span data-ttu-id="f5448-106">Colas de trabajo</span><span class="sxs-lookup"><span data-stu-id="f5448-106">Work Queues</span></span>](#work-queues)
    -   [<span data-ttu-id="f5448-107">Compatibilidad con MMCSS</span><span class="sxs-lookup"><span data-stu-id="f5448-107">MMCSS Support</span></span>](#mmcss-support)
    -   [<span data-ttu-id="f5448-108">IMFRealTimeClient</span><span class="sxs-lookup"><span data-stu-id="f5448-108">IMFRealTimeClient</span></span>](#imfrealtimeclientex)
-   [<span data-ttu-id="f5448-109">Mejoras en Windows 8</span><span class="sxs-lookup"><span data-stu-id="f5448-109">Windows 8 Improvements</span></span>](#windows-8-improvements)
    -   [<span data-ttu-id="f5448-110">Colas de trabajos multiproceso</span><span class="sxs-lookup"><span data-stu-id="f5448-110">Multithreaded Work Queues</span></span>](#multithreaded-work-queues)
    -   [<span data-ttu-id="f5448-111">Colas de trabajo de tareas compartidas</span><span class="sxs-lookup"><span data-stu-id="f5448-111">Shared Task Work Queues</span></span>](#shared-task-work-queues)
    -   [<span data-ttu-id="f5448-112">Cola de espera</span><span class="sxs-lookup"><span data-stu-id="f5448-112">Wait Queue</span></span>](#wait-queue)
    -   [<span data-ttu-id="f5448-113">Mejoras en la compatibilidad con MMCSS</span><span class="sxs-lookup"><span data-stu-id="f5448-113">Enhancements to MMCSS Support</span></span>](#enhancements-to-mmcss-support)
    -   [<span data-ttu-id="f5448-114">IMFRealTimeClientEx</span><span class="sxs-lookup"><span data-stu-id="f5448-114">IMFRealTimeClientEx</span></span>](#imfrealtimeclientex)
    -   [<span data-ttu-id="f5448-115">Ramas de topología</span><span class="sxs-lookup"><span data-stu-id="f5448-115">Topology Branches</span></span>](#topology-branches)
-   [<span data-ttu-id="f5448-116">Recomendaciones</span><span class="sxs-lookup"><span data-stu-id="f5448-116">Recommendations</span></span>](#recommendations)
-   [<span data-ttu-id="f5448-117">Resumen</span><span class="sxs-lookup"><span data-stu-id="f5448-117">Summary</span></span>](#summary)
-   [<span data-ttu-id="f5448-118">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="f5448-118">Related topics</span></span>](#related-topics)

## <a name="windows-7-behavior"></a><span data-ttu-id="f5448-119">Comportamiento de Windows 7</span><span class="sxs-lookup"><span data-stu-id="f5448-119">Windows 7 Behavior</span></span>

<span data-ttu-id="f5448-120">En esta sección se resume el comportamiento de Media Foundation colas de trabajo en Windows 7.</span><span class="sxs-lookup"><span data-stu-id="f5448-120">This section summarizes the behavior of Media Foundation work queues in Windows 7.</span></span>

### <a name="work-queues"></a><span data-ttu-id="f5448-121">Colas de trabajo</span><span class="sxs-lookup"><span data-stu-id="f5448-121">Work Queues</span></span>

<span data-ttu-id="f5448-122">La plataforma Media Foundation crea varias colas de trabajo estándar.</span><span class="sxs-lookup"><span data-stu-id="f5448-122">The Media Foundation platform creates several standard work queues.</span></span> <span data-ttu-id="f5448-123">Solo dos están documentados para el uso general de la aplicación:</span><span class="sxs-lookup"><span data-stu-id="f5448-123">Only two are documented as being for general application use:</span></span>

-   <span data-ttu-id="f5448-124">**estándar de cola de devolución de \_ llamada MFASYNC \_ \_**</span><span class="sxs-lookup"><span data-stu-id="f5448-124">**MFASYNC\_CALLBACK\_QUEUE\_STANDARD**</span></span>
-   <span data-ttu-id="f5448-125">**MFASYNC \_ \_ función Long de cola de devolución de llamada \_ \_**</span><span class="sxs-lookup"><span data-stu-id="f5448-125">**MFASYNC\_CALLBACK\_QUEUE\_LONG\_FUNCTION**</span></span>

<span data-ttu-id="f5448-126">Una aplicación o componente puede asignar nuevas colas de trabajo mediante una llamada a [**MFAllocateWorkQueue**](/windows/desktop/api/mfapi/nf-mfapi-mfallocateworkqueue) o [**MFAllocateWorkQueueEx**](/windows/desktop/api/mfapi/nf-mfapi-mfallocateworkqueueex).</span><span class="sxs-lookup"><span data-stu-id="f5448-126">An application or component can allocate new work queues by calling [**MFAllocateWorkQueue**](/windows/desktop/api/mfapi/nf-mfapi-mfallocateworkqueue) or [**MFAllocateWorkQueueEx**](/windows/desktop/api/mfapi/nf-mfapi-mfallocateworkqueueex).</span></span> <span data-ttu-id="f5448-127">La función **MFAllocateWorkQueueEx** define dos tipos de cola de trabajo:</span><span class="sxs-lookup"><span data-stu-id="f5448-127">The **MFAllocateWorkQueueEx** function defines two types of work queue:</span></span>

-   <span data-ttu-id="f5448-128">**MF \_ STANDARD \_ WORKQUEUE** crea una cola de trabajo sin un bucle de mensajes.</span><span class="sxs-lookup"><span data-stu-id="f5448-128">**MF\_STANDARD\_WORKQUEUE** creates a work queue without a message loop.</span></span>
-   <span data-ttu-id="f5448-129">**MF \_ WINDOW \_ WORKQUEUE** crea una cola de trabajo con un bucle de mensajes.</span><span class="sxs-lookup"><span data-stu-id="f5448-129">**MF\_WINDOW\_WORKQUEUE** creates a work queue with a message loop.</span></span>

<span data-ttu-id="f5448-130">Para poner en cola un elemento de trabajo, llame a [**MFPutWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitem) o [**MFPutWorkItemEx**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitemex).</span><span class="sxs-lookup"><span data-stu-id="f5448-130">To queue a work item, call [**MFPutWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitem) or [**MFPutWorkItemEx**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitemex).</span></span> <span data-ttu-id="f5448-131">La plataforma ejecuta el elemento de trabajo invocando la implementación proporcionada por el llamador de [**IMFAsyncCallback**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasynccallback).</span><span class="sxs-lookup"><span data-stu-id="f5448-131">The platform executes the work item by invoking the caller-provided implementation of [**IMFAsyncCallback**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasynccallback).</span></span> <span data-ttu-id="f5448-132">En Windows 7 y versiones anteriores, la plataforma crea un subproceso por cada cola de trabajo.</span><span class="sxs-lookup"><span data-stu-id="f5448-132">In Windows 7 and earlier, the platform creates one thread per work queue.</span></span>

### <a name="mmcss-support"></a><span data-ttu-id="f5448-133">Compatibilidad con MMCSS</span><span class="sxs-lookup"><span data-stu-id="f5448-133">MMCSS Support</span></span>

<span data-ttu-id="f5448-134">El [servicio Programador de clases multimedia](../procthread/multimedia-class-scheduler-service.md) (MMCSS) administra las prioridades de los subprocesos para que las aplicaciones multimedia obtengan intervalos regulares de tiempo de CPU, sin denegar recursos de CPU a aplicaciones de menor prioridad.</span><span class="sxs-lookup"><span data-stu-id="f5448-134">The [Multimedia Class Scheduler Service](../procthread/multimedia-class-scheduler-service.md) (MMCSS) manages thread priorities so that multimedia applications get regular slices of CPU time, without denying CPU resources to lower-priority applications.</span></span> <span data-ttu-id="f5448-135">MMCSS define un conjunto de *tareas* que tienen distintos perfiles de uso de CPU.</span><span class="sxs-lookup"><span data-stu-id="f5448-135">MMCSS defines a set of *tasks* that have different CPU utilization profiles.</span></span> <span data-ttu-id="f5448-136">Cuando un subproceso se une a una tarea MMCSS, MMCSS establece la prioridad del subproceso en función de varios factores:</span><span class="sxs-lookup"><span data-stu-id="f5448-136">When a thread joins an MMCSS task, MMCSS sets the priority of the thread based on several factors:</span></span>

-   <span data-ttu-id="f5448-137">La prioridad base de la tarea, que se establece en el registro.</span><span class="sxs-lookup"><span data-stu-id="f5448-137">The base priority of the task, which is set in the registry.</span></span>
-   <span data-ttu-id="f5448-138">La prioridad relativa del subproceso, que se establece en tiempo de ejecución mediante una llamada a [**AvSetMmThreadPriority**](/windows/win32/api/avrt/nf-avrt-avsetmmthreadpriority).</span><span class="sxs-lookup"><span data-stu-id="f5448-138">The relative thread priority, which is set at run time by calling [**AvSetMmThreadPriority**](/windows/win32/api/avrt/nf-avrt-avsetmmthreadpriority).</span></span>
-   <span data-ttu-id="f5448-139">Varias características en tiempo de ejecución, como si la aplicación está en primer plano, y cuánto tiempo de CPU se consumen los subprocesos en cada clase MMCSS.</span><span class="sxs-lookup"><span data-stu-id="f5448-139">Various run-time characteristics, such as whether the application is in the foreground, and how much CPU time is being consumed by the threads in each MMCSS class.</span></span>

<span data-ttu-id="f5448-140">Una aplicación puede registrar una cola de trabajo con MMCSS llamando a [**MFBeginRegisterWorkQueueWithMMCSS**](/windows/desktop/api/mfapi/nf-mfapi-mfbeginregisterworkqueuewithmmcss).</span><span class="sxs-lookup"><span data-stu-id="f5448-140">An application can register a work queue with MMCSS by calling [**MFBeginRegisterWorkQueueWithMMCSS**](/windows/desktop/api/mfapi/nf-mfapi-mfbeginregisterworkqueuewithmmcss).</span></span> <span data-ttu-id="f5448-141">Esta función toma un identificador de cola de trabajo, una clase MMCSS (nombre de tarea) y el identificador de la tarea MMCSS.</span><span class="sxs-lookup"><span data-stu-id="f5448-141">This function takes a work queue ID, an MMCSS class (task name), and the MMCSS task identifier.</span></span> <span data-ttu-id="f5448-142">Internamente, llama a [**AvSetMmThreadCharacteristics**](/windows/win32/api/avrt/nf-avrt-avsetmmthreadcharacteristicsa) con el nombre de tarea y el identificador de tarea.</span><span class="sxs-lookup"><span data-stu-id="f5448-142">Internally, it calls [**AvSetMmThreadCharacteristics**](/windows/win32/api/avrt/nf-avrt-avsetmmthreadcharacteristicsa) with the task name and task ID.</span></span> <span data-ttu-id="f5448-143">Después de registrar una cola de trabajo con MMCSS, puede obtener el identificador de la clase y de la tarea mediante una llamada a [**MFGetWorkQueueMMCSSClass**](/windows/desktop/api/mfapi/nf-mfapi-mfgetworkqueuemmcssclass) y [**MFGetWorkQueueMMCSSTaskId**](/windows/desktop/api/mfapi/nf-mfapi-mfgetworkqueuemmcsstaskid).</span><span class="sxs-lookup"><span data-stu-id="f5448-143">After a work queue is registered with MMCSS, you can get the class and task ID by calling [**MFGetWorkQueueMMCSSClass**](/windows/desktop/api/mfapi/nf-mfapi-mfgetworkqueuemmcssclass) and [**MFGetWorkQueueMMCSSTaskId**](/windows/desktop/api/mfapi/nf-mfapi-mfgetworkqueuemmcsstaskid).</span></span>

<span data-ttu-id="f5448-144">La [sesión multimedia](media-session.md) proporciona acceso de nivel más alto a estas API a través de la interfaz [**IMFWorkQueueServices**](/windows/desktop/api/mfidl/nn-mfidl-imfworkqueueservices) .</span><span class="sxs-lookup"><span data-stu-id="f5448-144">The [Media Session](media-session.md) provides somewhat higher-level access to these APIs, through the [**IMFWorkQueueServices**](/windows/desktop/api/mfidl/nn-mfidl-imfworkqueueservices) interface.</span></span> <span data-ttu-id="f5448-145">Esta interfaz proporciona dos métodos principales:</span><span class="sxs-lookup"><span data-stu-id="f5448-145">This interface provides two primary methods:</span></span>

| <span data-ttu-id="f5448-146">Método</span><span class="sxs-lookup"><span data-stu-id="f5448-146">Method</span></span>                                                                                                            | <span data-ttu-id="f5448-147">Descripción</span><span class="sxs-lookup"><span data-stu-id="f5448-147">Description</span></span>                                                                                                                                                                                                                                                                                   |
|-------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="f5448-148">**BeginRegisterPlatformWorkQueueWithMMCSS**</span><span class="sxs-lookup"><span data-stu-id="f5448-148">**BeginRegisterPlatformWorkQueueWithMMCSS**</span></span>](/windows/desktop/api/mfidl/nf-mfidl-imfworkqueueservices-beginregisterplatformworkqueuewithmmcss)   | <span data-ttu-id="f5448-149">Registra una cola de trabajo con una tarea MMCSS.</span><span class="sxs-lookup"><span data-stu-id="f5448-149">Registers a work queue with an MMCSS task.</span></span> <span data-ttu-id="f5448-150">Este método es esencialmente un contenedor fino en torno a [**MFBeginRegisterWorkQueueWithMMCSS**](/windows/desktop/api/mfapi/nf-mfapi-mfbeginregisterworkqueuewithmmcss), pero puede pasar el valor **MFASYNC cola de devolución de \_ llamada \_ \_ All** para registrar todas las colas de trabajo de la plataforma a la vez.</span><span class="sxs-lookup"><span data-stu-id="f5448-150">This method is essentially a thin wrapper around [**MFBeginRegisterWorkQueueWithMMCSS**](/windows/desktop/api/mfapi/nf-mfapi-mfbeginregisterworkqueuewithmmcss), but you can pass the value **MFASYNC\_CALLBACK\_QUEUE\_ALL** to register all of the platform work queues at once.</span></span> |
| [<span data-ttu-id="f5448-151">**BeginRegisterTopologyWorkQueuesWithMMCSS**</span><span class="sxs-lookup"><span data-stu-id="f5448-151">**BeginRegisterTopologyWorkQueuesWithMMCSS**</span></span>](/windows/desktop/api/mfidl/nf-mfidl-imfworkqueueservices-beginregistertopologyworkqueueswithmmcss) | <span data-ttu-id="f5448-152">Registra una rama de la topología con una cola de trabajo.</span><span class="sxs-lookup"><span data-stu-id="f5448-152">Registers a branch of the topology with a work queue.</span></span>                                                                                                                                                                                                                                         |



 

<span data-ttu-id="f5448-153">Para registrar una rama de topología, haga lo siguiente.</span><span class="sxs-lookup"><span data-stu-id="f5448-153">To register a topology branch, do the following.</span></span>

1.  <span data-ttu-id="f5448-154">Establezca el atributo [MF \_ TOPONODE \_ WORKQUEUE \_ ID](mf-toponode-workqueue-id-attribute.md) en el nodo de origen de la rama.</span><span class="sxs-lookup"><span data-stu-id="f5448-154">Set the [MF\_TOPONODE\_WORKQUEUE\_ID](mf-toponode-workqueue-id-attribute.md) attribute on the source node for the branch.</span></span> <span data-ttu-id="f5448-155">Use cualquier valor definido por la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f5448-155">Use any application-defined value.</span></span>
2.  <span data-ttu-id="f5448-156">Opcionalmente, establezca la **\_ clase MF \_ TOPONODE \_ WORKQUEUE \_ MMCSS** para unir la cola de trabajo a una tarea MMCSS.</span><span class="sxs-lookup"><span data-stu-id="f5448-156">Optionally, set the **MF\_TOPONODE\_WORKQUEUE\_MMCSS\_CLASS** to join the work queue to an MMCSS task.</span></span>
3.  <span data-ttu-id="f5448-157">Llame a [**BeginRegisterTopologyWorkQueuesWithMMCSS**](/windows/desktop/api/mfidl/nf-mfidl-imfworkqueueservices-beginregistertopologyworkqueueswithmmcss) en la topología resuelta.</span><span class="sxs-lookup"><span data-stu-id="f5448-157">Call [**BeginRegisterTopologyWorkQueuesWithMMCSS**](/windows/desktop/api/mfidl/nf-mfidl-imfworkqueueservices-beginregistertopologyworkqueueswithmmcss) on the resolved topology.</span></span>

<span data-ttu-id="f5448-158">La sesión multimedia asigna una nueva cola de trabajo para cada valor único de [MF \_ TOPONODE \_ WORKQUEUE \_ ID](mf-toponode-workqueue-id-attribute.md).</span><span class="sxs-lookup"><span data-stu-id="f5448-158">The Media Session allocates a new work queue for each unique value of [MF\_TOPONODE\_WORKQUEUE\_ID](mf-toponode-workqueue-id-attribute.md).</span></span> <span data-ttu-id="f5448-159">Para cada bifurcación de topología, las operaciones asincrónicas de canalización se realizan en la cola de trabajo asignada a la rama.</span><span class="sxs-lookup"><span data-stu-id="f5448-159">For each topology branch, asynchronous pipeline operations are performed on the work queue that is assigned to the branch.</span></span>

### <a name="imfrealtimeclient"></a><span data-ttu-id="f5448-160">IMFRealTimeClient</span><span class="sxs-lookup"><span data-stu-id="f5448-160">IMFRealTimeClient</span></span>

<span data-ttu-id="f5448-161">La interfaz [**IMFRealTimeClient**](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclient) está pensada para los componentes de canalización que crean sus propios subprocesos o utilizan colas de trabajo para operaciones asincrónicas.</span><span class="sxs-lookup"><span data-stu-id="f5448-161">The [**IMFRealTimeClient**](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclient) interface is intended for pipeline components that either create their own threads or use work queues for asynchronous operations.</span></span> <span data-ttu-id="f5448-162">La sesión multimedia utiliza esta interfaz para notificar al componente de canalización el comportamiento correcto, como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="f5448-162">The Media Session uses this interface to notify the pipeline component of the correct behavior, as follows:</span></span>

-   <span data-ttu-id="f5448-163">Si el componente de canalización crea un subproceso de trabajo, el método [**IMFRealTimeClient:: RegisterThreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-registerthreads) notifica al componente en el que se va a unir la clase MMCSS.</span><span class="sxs-lookup"><span data-stu-id="f5448-163">If the pipeline component creates a worker thread, the [**IMFRealTimeClient::RegisterThreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-registerthreads) method notifies the component which MMCSS class to join.</span></span>
-   <span data-ttu-id="f5448-164">Si el componente de canalización usa una cola de trabajo, el método [**IMFRealTimeClient:: SetWorkQueue**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-setworkqueue) indica al componente la cola de trabajo que se va a utilizar.</span><span class="sxs-lookup"><span data-stu-id="f5448-164">If the pipeline component uses a work queue, the [**IMFRealTimeClient::SetWorkQueue**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-setworkqueue) method tells the component which work queue to use.</span></span>

<span data-ttu-id="f5448-165">Normalmente, un componente de canalización utiliza un subproceso o una cola de trabajo para realizar tareas asincrónicas, pero no ambos.</span><span class="sxs-lookup"><span data-stu-id="f5448-165">Typically, a pipeline component uses either a thread or a work queue to perform asynchronous tasks, but not both.</span></span>

## <a name="windows-8-improvements"></a><span data-ttu-id="f5448-166">Mejoras en Windows 8</span><span class="sxs-lookup"><span data-stu-id="f5448-166">Windows 8 Improvements</span></span>

### <a name="multithreaded-work-queues"></a><span data-ttu-id="f5448-167">Colas de trabajos multiproceso</span><span class="sxs-lookup"><span data-stu-id="f5448-167">Multithreaded Work Queues</span></span>

<span data-ttu-id="f5448-168">En Windows 8, Media Foundation admite un nuevo tipo de cola de trabajo denominada *cola multiproceso*.</span><span class="sxs-lookup"><span data-stu-id="f5448-168">In Windows 8, Media Foundation supports a new type of work queue called the *multithreaded queue*.</span></span> <span data-ttu-id="f5448-169">Una cola multiproceso utiliza un grupo de subprocesos del sistema para distribuir los elementos de trabajo.</span><span class="sxs-lookup"><span data-stu-id="f5448-169">A multithreaded queue uses a system thread pool to dispatch work items.</span></span> <span data-ttu-id="f5448-170">La cola multiproceso escala mejor que las anteriores colas de un solo subproceso.</span><span class="sxs-lookup"><span data-stu-id="f5448-170">The multithreaded queue scales better than the previous single-threaded queues.</span></span> <span data-ttu-id="f5448-171">Por ejemplo,</span><span class="sxs-lookup"><span data-stu-id="f5448-171">For example,</span></span>

-   <span data-ttu-id="f5448-172">Varios componentes pueden compartir una cola multiproceso sin bloquearse entre sí, lo que requiere la creación de menos subprocesos.</span><span class="sxs-lookup"><span data-stu-id="f5448-172">Several components can share a multithreaded queue without blocking one another, requiring the creation of fewer threads.</span></span>

-   <span data-ttu-id="f5448-173">Los elementos de trabajo están optimizados para evitar los cambios de contexto si ya se ha establecido un evento.</span><span class="sxs-lookup"><span data-stu-id="f5448-173">Work items are optimized to avoid context switches if an event is already set.</span></span> <span data-ttu-id="f5448-174">Esto es más eficaz que crear sus propios subprocesos para esperar en los eventos.</span><span class="sxs-lookup"><span data-stu-id="f5448-174">This is more efficient than creating your own threads to wait on events.</span></span>

<span data-ttu-id="f5448-175">Al usar [**IMFRealTimeClientEx**](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclientex), las aplicaciones deben evitar la rotación de subprocesos y, en su lugar, deben usar las colas de trabajo.</span><span class="sxs-lookup"><span data-stu-id="f5448-175">When using [**IMFRealTimeClientEx**](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclientex), applications should avoid spinning up threads and instead should use the work queues.</span></span> <span data-ttu-id="f5448-176">Para ello, las aplicaciones deben implementar [**SetWorkQueueEx**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-setworkqueueex) y no usar [**RegisterThreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-registerthreadsex) y [**UnregisterThreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-unregisterthreads).</span><span class="sxs-lookup"><span data-stu-id="f5448-176">To accomplish this, applications should implement [**SetWorkQueueEx**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-setworkqueueex) and not use [**RegisterThreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-registerthreadsex) and [**UnregisterThreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-unregisterthreads).</span></span>

<span data-ttu-id="f5448-177">Cuando se inicializa la plataforma de Media Foundation, se crea una cola multiproceso con el identificador MFASYNC de **la \_ cola de devolución de llamada \_ \_ multiproceso**.</span><span class="sxs-lookup"><span data-stu-id="f5448-177">When the Media Foundation platform is initialized, it creates a multithreaded queue with the identifier **MFASYNC\_CALLBACK\_QUEUE\_MULTITHREADED**.</span></span>

<span data-ttu-id="f5448-178">Una cola multiproceso no serializa los elementos de trabajo.</span><span class="sxs-lookup"><span data-stu-id="f5448-178">A multithreaded queue does not serialize work items.</span></span> <span data-ttu-id="f5448-179">Cada vez que un subproceso del grupo de subprocesos está disponible, se envía el siguiente elemento de trabajo de la cola.</span><span class="sxs-lookup"><span data-stu-id="f5448-179">Whenever a thread from the thread pool becomes available, the next work item on the queue is dispatched.</span></span> <span data-ttu-id="f5448-180">El llamador debe asegurarse de que el trabajo se serialice correctamente.</span><span class="sxs-lookup"><span data-stu-id="f5448-180">The caller must ensure that work is serialized correctly.</span></span> <span data-ttu-id="f5448-181">Para facilitar esta tarea, Media Foundation define una *cola de trabajo en serie*.</span><span class="sxs-lookup"><span data-stu-id="f5448-181">To make this easier, Media Foundation defines a *serial work queue*.</span></span> <span data-ttu-id="f5448-182">Una cola de serie ajusta otra cola de trabajo, pero garantiza una ejecución totalmente serializada.</span><span class="sxs-lookup"><span data-stu-id="f5448-182">A serial queue wraps another work queue but guarantees fully serialized execution.</span></span> <span data-ttu-id="f5448-183">El siguiente elemento de la cola no se envía hasta que se completa el elemento anterior.</span><span class="sxs-lookup"><span data-stu-id="f5448-183">The next item on the queue is not dispatched until the previous item completes.</span></span>

<span data-ttu-id="f5448-184">En el código siguiente se crea una cola de serializador a través de la cola multiproceso de plataforma.</span><span class="sxs-lookup"><span data-stu-id="f5448-184">The following code creates a serializer queue over the platform multithreaded queue.</span></span>


```C++
DWORD workQueueID;
hr = MFAllocateSerialWorkQueue(MFASYNC_CALLBACK_QUEUE_MULTITHREADED, &workQueueID); 
```



<span data-ttu-id="f5448-185">Varias colas de serie pueden contener la misma cola multiproceso.</span><span class="sxs-lookup"><span data-stu-id="f5448-185">More than one serial queue can wrap the same multithreaded queue.</span></span> <span data-ttu-id="f5448-186">A continuación, las colas en serie comparten el mismo grupo de subprocesos y la ejecución serializada se aplica dentro de cada cola.</span><span class="sxs-lookup"><span data-stu-id="f5448-186">The serial queues then share the same thread pool, and serialized execution is enforced within each queue.</span></span>

<span data-ttu-id="f5448-187">Las colas de trabajo estándar que existían antes de Windows 8 se implementan ahora como colas de trabajo en serie que encapsulan la cola multiproceso de la plataforma.</span><span class="sxs-lookup"><span data-stu-id="f5448-187">The standard work queues that existed prior to Windows 8 are now implemented as serial work queues that wrap the platform multithreaded queue.</span></span> <span data-ttu-id="f5448-188">Este cambio conserva la compatibilidad con versiones anteriores.</span><span class="sxs-lookup"><span data-stu-id="f5448-188">This change preserves backward compatibility.</span></span>

### <a name="shared-task-work-queues"></a><span data-ttu-id="f5448-189">Colas de trabajo de tareas compartidas</span><span class="sxs-lookup"><span data-stu-id="f5448-189">Shared Task Work Queues</span></span>

<span data-ttu-id="f5448-190">Para que funcione correctamente con el programador del kernel, debe haber una cola de trabajo multiproceso para cada tarea de MMCSS que use.</span><span class="sxs-lookup"><span data-stu-id="f5448-190">To work correctly with the kernel scheduler, there should be one multithreaded work queue for each MMCSS task that you use.</span></span> <span data-ttu-id="f5448-191">La plataforma Media Foundation las asigna según sea necesario, hasta una por cada tarea de MMCSS, por proceso.</span><span class="sxs-lookup"><span data-stu-id="f5448-191">The Media Foundation platform allocates these as needed, up to one per MMCSS task, per process.</span></span> <span data-ttu-id="f5448-192">Para obtener la cola de trabajo compartida para una tarea de MMCSS determinada, llame a [**MFLockSharedWorkQueue**](/windows/desktop/api/mfapi/nf-mfapi-mflocksharedworkqueue) y especifique el nombre de la tarea.</span><span class="sxs-lookup"><span data-stu-id="f5448-192">To get the shared work queue for a particular MMCSS task, call [**MFLockSharedWorkQueue**](/windows/desktop/api/mfapi/nf-mfapi-mflocksharedworkqueue) and specify the task name.</span></span> <span data-ttu-id="f5448-193">La función busca el nombre de la tarea en una tabla.</span><span class="sxs-lookup"><span data-stu-id="f5448-193">The function looks up the task name in a table.</span></span> <span data-ttu-id="f5448-194">Si aún no existe una cola de trabajo para esta tarea, la función asigna una nueva cola de trabajo de MT y la une inmediatamente a la tarea MMCSS.</span><span class="sxs-lookup"><span data-stu-id="f5448-194">If a work queue does not already exist for this task, the function allocates a new MT work queue and immediately joins it to the MMCSS task.</span></span> <span data-ttu-id="f5448-195">Si ya existe una cola de trabajo para esa tarea, la función devuelve el identificador de la cola de trabajo existente.</span><span class="sxs-lookup"><span data-stu-id="f5448-195">If a work queue already exists for that task, the function returns the identifier of the existing work queue.</span></span>

### <a name="wait-queue"></a><span data-ttu-id="f5448-196">Cola de espera</span><span class="sxs-lookup"><span data-stu-id="f5448-196">Wait Queue</span></span>

<span data-ttu-id="f5448-197">La *cola de espera* es una cola de trabajo de plataforma especial que espera a que se señalen los eventos.</span><span class="sxs-lookup"><span data-stu-id="f5448-197">The *wait queue* is a special platform work queue that waits on events to be signaled.</span></span> <span data-ttu-id="f5448-198">Si un componente necesita esperar a que se señalice un evento, puede utilizar la cola de espera en lugar de crear un subproceso de trabajo para esperar en el evento.</span><span class="sxs-lookup"><span data-stu-id="f5448-198">If a component needs to wait for an event to be signaled, it can use the wait queue instead of creating a worker thread to wait on the event.</span></span>

<span data-ttu-id="f5448-199">Para usar la cola de espera, llame a [**MFPutWaitingWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfputwaitingworkitem).</span><span class="sxs-lookup"><span data-stu-id="f5448-199">To use the wait queue, call [**MFPutWaitingWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfputwaitingworkitem).</span></span> <span data-ttu-id="f5448-200">Los parámetros incluyen el identificador de eventos y un puntero [**IMFAsyncResult**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasyncresult) .</span><span class="sxs-lookup"><span data-stu-id="f5448-200">The parameters include the event handle and an [**IMFAsyncResult**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasyncresult) pointer.</span></span> <span data-ttu-id="f5448-201">Cuando se señala el evento, la cola de espera invoca la devolución de llamada.</span><span class="sxs-lookup"><span data-stu-id="f5448-201">When the event is signaled, the wait queue invokes your callback.</span></span> <span data-ttu-id="f5448-202">Hay una única cola de espera de plataforma; las aplicaciones no pueden crear sus propias colas de espera.</span><span class="sxs-lookup"><span data-stu-id="f5448-202">There is a single platform wait queue; applications cannot create their own wait queues.</span></span>

### <a name="enhancements-to-mmcss-support"></a><span data-ttu-id="f5448-203">Mejoras en la compatibilidad con MMCSS</span><span class="sxs-lookup"><span data-stu-id="f5448-203">Enhancements to MMCSS Support</span></span>

<span data-ttu-id="f5448-204">Las siguientes funciones nuevas de la plataforma Media Foundation se relacionan con MMCSS.</span><span class="sxs-lookup"><span data-stu-id="f5448-204">The following new Media Foundation platform functions relate to MMCSS.</span></span>



| <span data-ttu-id="f5448-205">Función</span><span class="sxs-lookup"><span data-stu-id="f5448-205">Function</span></span>                                                                           | <span data-ttu-id="f5448-206">Descripción</span><span class="sxs-lookup"><span data-stu-id="f5448-206">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                           |
|------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="f5448-207">**MFBeginRegisterWorkQueueWithMMCSSEx**</span><span class="sxs-lookup"><span data-stu-id="f5448-207">**MFBeginRegisterWorkQueueWithMMCSSEx**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfbeginregisterworkqueuewithmmcssex) | <span data-ttu-id="f5448-208">Registra una cola de trabajo con MMCSS.</span><span class="sxs-lookup"><span data-stu-id="f5448-208">Registers a work queue with MMCSS.</span></span> <span data-ttu-id="f5448-209">Esta función incluye un parámetro para especificar la prioridad relativa del subproceso.</span><span class="sxs-lookup"><span data-stu-id="f5448-209">This function includes a parameter to specify relative thread priority.</span></span> <span data-ttu-id="f5448-210">Internamente, este valor se convierte en una llamada a [**AvSetMmThreadPriority**](/windows/win32/api/avrt/nf-avrt-avsetmmthreadpriority).</span><span class="sxs-lookup"><span data-stu-id="f5448-210">Internally, this value is translated into a call to [**AvSetMmThreadPriority**](/windows/win32/api/avrt/nf-avrt-avsetmmthreadpriority).</span></span>                                                                                                                                                                               |
| [<span data-ttu-id="f5448-211">**MFGetWorkQueueMMCSSPriority**</span><span class="sxs-lookup"><span data-stu-id="f5448-211">**MFGetWorkQueueMMCSSPriority**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfgetworkqueuemmcsspriority)                 | <span data-ttu-id="f5448-212">Consulta la prioridad de una cola de trabajo.</span><span class="sxs-lookup"><span data-stu-id="f5448-212">Queries the priority of a work queue.</span></span>                                                                                                                                                                                                                                                                                                                                                                 |
| [<span data-ttu-id="f5448-213">**MFRegisterPlatformWithMMCSS**</span><span class="sxs-lookup"><span data-stu-id="f5448-213">**MFRegisterPlatformWithMMCSS**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfregisterplatformwithmmcss)                 | <span data-ttu-id="f5448-214">Registra todas las colas de trabajo de la plataforma con una tarea MMCSS.</span><span class="sxs-lookup"><span data-stu-id="f5448-214">Registers all of the platform work queues with an MMCSS task.</span></span> <span data-ttu-id="f5448-215">Esta función es similar al método [**IMFWorkQueueServices:: BeginRegisterPlatformWorkQueueWithMMCSS**](/windows/desktop/api/mfidl/nf-mfidl-imfworkqueueservices-beginregisterplatformworkqueuewithmmcss) , pero se puede usar sin crear una instancia de la sesión multimedia.</span><span class="sxs-lookup"><span data-stu-id="f5448-215">This function is similar to the [**IMFWorkQueueServices::BeginRegisterPlatformWorkQueueWithMMCSS**](/windows/desktop/api/mfidl/nf-mfidl-imfworkqueueservices-beginregisterplatformworkqueuewithmmcss) method, but it can be used without creating an instance of the Media Session.</span></span> <span data-ttu-id="f5448-216">Además, la función incluye un parámetro para especificar la prioridad base del subproceso.</span><span class="sxs-lookup"><span data-stu-id="f5448-216">In addition, the function includes a parameter to specify the base thread priority.</span></span> |



 

<span data-ttu-id="f5448-217">Las aplicaciones que usan la sesión multimedia deben establecer el atributo de [ \_ clase MF TOPONODE \_ WORKQUEUE \_ MMCSS \_ ](mf-toponode-workqueue-mmcss-class-attribute.md) en "audio" para la rama de representación de audio.</span><span class="sxs-lookup"><span data-stu-id="f5448-217">Applications that use the Media Session should set the [MF\_TOPONODE\_WORKQUEUE\_MMCSS\_CLASS](mf-toponode-workqueue-mmcss-class-attribute.md) attribute to "Audio" for the audio rendering branch.</span></span> <span data-ttu-id="f5448-218">Establezca el atributo en "reproducción" para la rama de representación de vídeo.</span><span class="sxs-lookup"><span data-stu-id="f5448-218">Set the attribute to "Playback" for the video rendering branch.</span></span>

### <a name="imfrealtimeclientex"></a><span data-ttu-id="f5448-219">IMFRealTimeClientEx</span><span class="sxs-lookup"><span data-stu-id="f5448-219">IMFRealTimeClientEx</span></span>

<span data-ttu-id="f5448-220">La interfaz [**IMFRealTimeClientEx**](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclientex) para reemplazar IMFRealTimeClient, para los componentes de canalización que realizan operaciones asincrónicas.</span><span class="sxs-lookup"><span data-stu-id="f5448-220">The [**IMFRealTimeClientEx**](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclientex) interface to replaces IMFRealTimeClient, for pipeline components that perform asynchronous operations.</span></span>



| <span data-ttu-id="f5448-221">Método</span><span class="sxs-lookup"><span data-stu-id="f5448-221">Method</span></span>                                                             | <span data-ttu-id="f5448-222">Descripción</span><span class="sxs-lookup"><span data-stu-id="f5448-222">Description</span></span>                                                                                                                                                                                                                    |
|--------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="f5448-223">**RegisterThreadsEx**</span><span class="sxs-lookup"><span data-stu-id="f5448-223">**RegisterThreadsEx**</span></span>](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-registerthreadsex) | <span data-ttu-id="f5448-224">Notifica al componente que registre sus subprocesos con MMCSS.</span><span class="sxs-lookup"><span data-stu-id="f5448-224">Notifies the component to register its threads with MMCSS.</span></span> <span data-ttu-id="f5448-225">Este método es equivalente a [**IMFRealTimeClient:: RegisterThreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-registerthreads), pero agrega un parámetro para la prioridad base del subproceso.</span><span class="sxs-lookup"><span data-stu-id="f5448-225">This method is equivalent to [**IMFRealTimeClient::RegisterThreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-registerthreads), but it adds a parameter for the base thread priority.</span></span> |
| [<span data-ttu-id="f5448-226">**SetWorkQueueEx**</span><span class="sxs-lookup"><span data-stu-id="f5448-226">**SetWorkQueueEx**</span></span>](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-setworkqueueex)       | <span data-ttu-id="f5448-227">Notifica al componente que use una cola de trabajo específica.</span><span class="sxs-lookup"><span data-stu-id="f5448-227">Notifies the component to use a specific work queue.</span></span> <span data-ttu-id="f5448-228">Este método es equivalente a [**IMFReadTimeClient:: SetWorkQueue**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-setworkqueue), pero agrega un parámetro para la prioridad del elemento de trabajo.</span><span class="sxs-lookup"><span data-stu-id="f5448-228">This method is equivalent to [**IMFReadTimeClient::SetWorkQueue**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-setworkqueue), but it adds a parameter for the work item priority.</span></span>               |
| [<span data-ttu-id="f5448-229">**UnregisterThreads**</span><span class="sxs-lookup"><span data-stu-id="f5448-229">**UnregisterThreads**</span></span>](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-unregisterthreads) | <span data-ttu-id="f5448-230">Notifica al componente que debe anular el registro de sus subprocesos de MMCSS.</span><span class="sxs-lookup"><span data-stu-id="f5448-230">Notifies the component to unregister its threads from MMCSS.</span></span> <span data-ttu-id="f5448-231">Este método es idéntico al método [**IMFRealTimeClient:: UnregisterThreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-unregisterthreads) .</span><span class="sxs-lookup"><span data-stu-id="f5448-231">This method is identical to the [**IMFRealTimeClient::UnregisterThreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-unregisterthreads) method.</span></span>                                       |



 

<span data-ttu-id="f5448-232">Los componentes de canalización deben usar colas de trabajo y no deben crear subprocesos de trabajo, por las razones siguientes:</span><span class="sxs-lookup"><span data-stu-id="f5448-232">Pipeline components should use work queues, and should not create worker threads, for the following reasons:</span></span>

-   <span data-ttu-id="f5448-233">Las colas de trabajos se escalan mejor, porque usan los grupos de subprocesos del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="f5448-233">Work queues scale better, because they use the OS thread pools.</span></span>
-   <span data-ttu-id="f5448-234">La plataforma controla los detalles del registro de colas de trabajo con MMCSS.</span><span class="sxs-lookup"><span data-stu-id="f5448-234">The platform handles the details of registering work queues with MMCSS.</span></span>
-   <span data-ttu-id="f5448-235">Un subproceso de trabajo puede producir fácilmente un interbloqueo que es difícil de depurar.</span><span class="sxs-lookup"><span data-stu-id="f5448-235">A worker thread can easily cause a deadlock that is hard to debug.</span></span>

<span data-ttu-id="f5448-236">Además, considere la posibilidad de usar la cola de trabajo del serializador si necesita serializar las operaciones asincrónicas.</span><span class="sxs-lookup"><span data-stu-id="f5448-236">Also, consider using the serializer work queue if you need to serialize your asynchronous operations.</span></span>

### <a name="topology-branches"></a><span data-ttu-id="f5448-237">Ramas de topología</span><span class="sxs-lookup"><span data-stu-id="f5448-237">Topology Branches</span></span>

<span data-ttu-id="f5448-238">Si el atributo de [ \_ clase MF TOPONODE \_ WORKQUEUE \_ MMCSS \_ ](mf-toponode-workqueue-mmcss-class-attribute.md) registra una rama de topología con MMCSS, en Windows 8 la sesión multimedia utiliza las colas de trabajo de MT compartidas.</span><span class="sxs-lookup"><span data-stu-id="f5448-238">If the [MF\_TOPONODE\_WORKQUEUE\_MMCSS\_CLASS](mf-toponode-workqueue-mmcss-class-attribute.md) attribute registers a topology branch with MMCSS, in Windows 8 the Media Session uses the shared MT work queues.</span></span> <span data-ttu-id="f5448-239">En versiones anteriores de Windows, la sesión multimedia asignaba una nueva cola de trabajo.</span><span class="sxs-lookup"><span data-stu-id="f5448-239">In earlier versions of Windows, the Media Session allocated a new work queue.</span></span>

<span data-ttu-id="f5448-240">Se definen dos nuevos atributos para registrar una rama de topología con MMCSS.</span><span class="sxs-lookup"><span data-stu-id="f5448-240">Two new attributes are defined for registering a topology branch with MMCSS.</span></span>



| <span data-ttu-id="f5448-241">Atributo</span><span class="sxs-lookup"><span data-stu-id="f5448-241">Attribute</span></span>                                                                            | <span data-ttu-id="f5448-242">Descripción</span><span class="sxs-lookup"><span data-stu-id="f5448-242">Description</span></span>                         |
|--------------------------------------------------------------------------------------|-------------------------------------|
| [<span data-ttu-id="f5448-243">MF \_ TOPONODE \_ WORKQUEUE \_ MMCSS \_ prioridad</span><span class="sxs-lookup"><span data-stu-id="f5448-243">MF\_TOPONODE\_WORKQUEUE\_MMCSS\_PRIORITY</span></span>](mf-toponode-workqueue-mmcss-priority.md) | <span data-ttu-id="f5448-244">Especifica la prioridad de subproceso base.</span><span class="sxs-lookup"><span data-stu-id="f5448-244">Specifies the base thread priority.</span></span> |
| [<span data-ttu-id="f5448-245">\_TOPONODE MF \_ WORKQUEUE \_ prioridad del elemento \_</span><span class="sxs-lookup"><span data-stu-id="f5448-245">MF\_TOPONODE\_WORKQUEUE\_ITEM\_PRIORITY</span></span>](mf-toponode-workqueue-item-priority.md)   | <span data-ttu-id="f5448-246">Especifica la prioridad del elemento de trabajo.</span><span class="sxs-lookup"><span data-stu-id="f5448-246">Specifies the work item priority.</span></span>   |



 

## <a name="recommendations"></a><span data-ttu-id="f5448-247">Recomendaciones</span><span class="sxs-lookup"><span data-stu-id="f5448-247">Recommendations</span></span>

-   <span data-ttu-id="f5448-248">Las aplicaciones que usan la sesión multimedia deben establecer la [ \_ clase MF TOPONODE \_ WORKQUEUE \_ MMCSS \_ ](mf-toponode-workqueue-mmcss-class-attribute.md) en "audio" para la rama de representación de audio y la "reproducción" de la rama de representación de vídeo.</span><span class="sxs-lookup"><span data-stu-id="f5448-248">Applications that use the Media Session should set [MF\_TOPONODE\_WORKQUEUE\_MMCSS\_CLASS](mf-toponode-workqueue-mmcss-class-attribute.md) to "Audio" for the audio rendering branch and "Playback" for the video rendering branch.</span></span>
-   <span data-ttu-id="f5448-249">Las aplicaciones que usan la sesión multimedia deben llamar a [**IMFWorkQueueServices:: BeginRegisterTopologyWorkQueuesWithMMCSS**](/windows/desktop/api/mfidl/nf-mfidl-imfworkqueueservices-beginregistertopologyworkqueueswithmmcss) en la topología.</span><span class="sxs-lookup"><span data-stu-id="f5448-249">Applications that use the Media Session should call [**IMFWorkQueueServices::BeginRegisterTopologyWorkQueuesWithMMCSS**](/windows/desktop/api/mfidl/nf-mfidl-imfworkqueueservices-beginregistertopologyworkqueueswithmmcss) on the topology.</span></span>
-   <span data-ttu-id="f5448-250">En el caso de los componentes de canalización, se recomienda usar colas de trabajo en lugar de subprocesos de trabajo.</span><span class="sxs-lookup"><span data-stu-id="f5448-250">For pipeline components, work queues are recommended instead of worker threads.</span></span> <span data-ttu-id="f5448-251">Si el componente usa colas de trabajo o subprocesos de trabajo, implemente [**IMFRealTimeClientEx**](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclientex).</span><span class="sxs-lookup"><span data-stu-id="f5448-251">If the component uses either work queues or worker threads, implement [**IMFRealTimeClientEx**](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclientex).</span></span>
-   <span data-ttu-id="f5448-252">No cree colas de trabajo privadas, ya que esto impide el propósito de las colas de trabajo de la plataforma.</span><span class="sxs-lookup"><span data-stu-id="f5448-252">Do not create private work queues, as this defeats the purpose of the platform work queues.</span></span> <span data-ttu-id="f5448-253">Use la cola multiproceso de la plataforma o una cola en serie que incluya la cola multiproceso de la plataforma.</span><span class="sxs-lookup"><span data-stu-id="f5448-253">Use either the platform multithreaded queue or a serial queue that wraps the platform multithreaded queue.</span></span>
-   <span data-ttu-id="f5448-254">Si necesita serializar operaciones asincrónicas, utilice una cola en serie.</span><span class="sxs-lookup"><span data-stu-id="f5448-254">If you need to serialize asynchronous operations, use a serial queue.</span></span>

## <a name="summary"></a><span data-ttu-id="f5448-255">Resumen</span><span class="sxs-lookup"><span data-stu-id="f5448-255">Summary</span></span>

<span data-ttu-id="f5448-256">Las siguientes API de la plataforma Media Foundation que se relacionan con los subprocesos y las colas de trabajos son nuevas en Windows 8.</span><span class="sxs-lookup"><span data-stu-id="f5448-256">The following Media Foundation platform APIs that relate to threads and work queues are new for Windows 8.</span></span>

-   [<span data-ttu-id="f5448-257">\_TOPONODE MF \_ WORKQUEUE \_ prioridad del elemento \_</span><span class="sxs-lookup"><span data-stu-id="f5448-257">MF\_TOPONODE\_WORKQUEUE\_ITEM\_PRIORITY</span></span>](mf-toponode-workqueue-item-priority.md)
-   [<span data-ttu-id="f5448-258">MF \_ TOPONODE \_ WORKQUEUE \_ MMCSS \_ prioridad</span><span class="sxs-lookup"><span data-stu-id="f5448-258">MF\_TOPONODE\_WORKQUEUE\_MMCSS\_PRIORITY</span></span>](mf-toponode-workqueue-mmcss-priority.md)
-   [<span data-ttu-id="f5448-259">**MFAllocateSerialWorkQueue**</span><span class="sxs-lookup"><span data-stu-id="f5448-259">**MFAllocateSerialWorkQueue**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfallocateserialworkqueue)
-   [<span data-ttu-id="f5448-260">**MFBeginRegisterWorkQueueWithMMCSSEx**</span><span class="sxs-lookup"><span data-stu-id="f5448-260">**MFBeginRegisterWorkQueueWithMMCSSEx**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfbeginregisterworkqueuewithmmcssex)
-   [<span data-ttu-id="f5448-261">**MFGetWorkQueueMMCSSPriority**</span><span class="sxs-lookup"><span data-stu-id="f5448-261">**MFGetWorkQueueMMCSSPriority**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfgetworkqueuemmcsspriority)
-   [<span data-ttu-id="f5448-262">**MFPutWaitingWorkItem**</span><span class="sxs-lookup"><span data-stu-id="f5448-262">**MFPutWaitingWorkItem**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfputwaitingworkitem)
-   [<span data-ttu-id="f5448-263">**MFPutWorkItem2**</span><span class="sxs-lookup"><span data-stu-id="f5448-263">**MFPutWorkItem2**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitem2)
-   [<span data-ttu-id="f5448-264">**MFPutWorkItemEx2**</span><span class="sxs-lookup"><span data-stu-id="f5448-264">**MFPutWorkItemEx2**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitemex2)
-   [<span data-ttu-id="f5448-265">**MFRegisterPlatformWithMMCSS**</span><span class="sxs-lookup"><span data-stu-id="f5448-265">**MFRegisterPlatformWithMMCSS**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfregisterplatformwithmmcss)
-   [<span data-ttu-id="f5448-266">**MFUnregisterPlatformFromMMCSS**</span><span class="sxs-lookup"><span data-stu-id="f5448-266">**MFUnregisterPlatformFromMMCSS**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfunregisterplatformfrommmcss)
-   [<span data-ttu-id="f5448-267">**MFLockSharedWorkQueue**</span><span class="sxs-lookup"><span data-stu-id="f5448-267">**MFLockSharedWorkQueue**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mflocksharedworkqueue)
-   [<span data-ttu-id="f5448-268">**IMFRealTimeClientEx**</span><span class="sxs-lookup"><span data-stu-id="f5448-268">**IMFRealTimeClientEx**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclientex)

## <a name="related-topics"></a><span data-ttu-id="f5448-269">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="f5448-269">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f5448-270">Colas de trabajo</span><span class="sxs-lookup"><span data-stu-id="f5448-270">Work Queues</span></span>](work-queues.md)
</dt> </dl>

 

 
