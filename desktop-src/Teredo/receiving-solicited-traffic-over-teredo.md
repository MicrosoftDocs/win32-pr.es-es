---
title: Recibir tráfico solicitado a través de Teredo
description: Muchas aplicaciones, como Microsoft Internet Explorer y Microsoft Outlook, solo inician conexiones a Internet.
ms.assetid: bff5d65e-050d-4b09-9982-8024612ffa6e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 035d067afeb9c62795efb5acd0bb28adc3afcb16
ms.sourcegitcommit: 773fa6257ead6c74154ad3cf46d21e49adc900aa
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/09/2020
ms.locfileid: "104533562"
---
# <a name="receiving-solicited-traffic-over-teredo"></a><span data-ttu-id="fe37a-103">Recibir tráfico solicitado a través de Teredo</span><span class="sxs-lookup"><span data-stu-id="fe37a-103">Receiving Solicited Traffic Over Teredo</span></span>

<span data-ttu-id="fe37a-104">Muchas aplicaciones, como Microsoft Internet Explorer y Microsoft Outlook, solo inician conexiones a Internet.</span><span class="sxs-lookup"><span data-stu-id="fe37a-104">Many applications such as Microsoft Internet Explorer and Microsoft Outlook only initiate connections to the Internet.</span></span> <span data-ttu-id="fe37a-105">Para estas aplicaciones, [Teredo](about-teredo.md) puede proporcionar conectividad fluida a través de IPv6 en ausencia de otras interfaces IPv6.</span><span class="sxs-lookup"><span data-stu-id="fe37a-105">For these applications, [Teredo](about-teredo.md) can provide seamless connectivity over IPv6 in the absence of other IPv6 interfaces.</span></span> <span data-ttu-id="fe37a-106">Además, se puede recibir tráfico solicitado a través de la interfaz Teredo en las plataformas anteriores de Microsoft Windows XP con Service Pack 2 (SP2) y Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="fe37a-106">Additionally, solicited traffic can be received over the Teredo Interface on the earlier Microsoft Windows XP with Service Pack 2 (SP2) and Windows Server 2003 platforms.</span></span>

<span data-ttu-id="fe37a-107">En la siguiente documentación se explica cómo estas aplicaciones consiguen la conectividad y las circunstancias en las que se utiliza Teredo.</span><span class="sxs-lookup"><span data-stu-id="fe37a-107">The following documentation explains how these applications achieve connectivity, and the circumstances under which Teredo is used.</span></span>

## <a name="obtaining-a-destination-address"></a><span data-ttu-id="fe37a-108">Obtención de una dirección de destino</span><span class="sxs-lookup"><span data-stu-id="fe37a-108">Obtaining a Destination Address</span></span>

<span data-ttu-id="fe37a-109">Una aplicación intenta obtener la dirección de destino mediante varios métodos como el sistema de nombres de dominio (DNS) o el protocolo de resolución de nombres de mismo nivel (PNRP).</span><span class="sxs-lookup"><span data-stu-id="fe37a-109">An application attempts to obtain the destination address using various methods such as Domain Name System (DNS) or Peer Name Resolution Protocol (PNRP).</span></span> <span data-ttu-id="fe37a-110">Es posible que la aplicación obtenga varias direcciones IP IPv4 e IPv6 mediante estos métodos.</span><span class="sxs-lookup"><span data-stu-id="fe37a-110">It is possible for the application to obtain multiple IPv4 and IPv6 IP addresses using these methods.</span></span> <span data-ttu-id="fe37a-111">Las API típicas que se usan para obtener direcciones IP incluyen la API de Windows XP [**gethostbyname**](/windows/desktop/api/wsipv6ok/nf-wsipv6ok-gethostbyname) y la nueva API de Windows Vista [**función getaddrinfo**](/windows/desktop/api/ws2tcpip/nf-ws2tcpip-getaddrinfo).</span><span class="sxs-lookup"><span data-stu-id="fe37a-111">The typical APIs used to obtain IP addresses include the Windows XP API [**GetHostByName**](/windows/desktop/api/wsipv6ok/nf-wsipv6ok-gethostbyname) and the new Windows Vista API [**GetAddrInfo**](/windows/desktop/api/ws2tcpip/nf-ws2tcpip-getaddrinfo).</span></span> <span data-ttu-id="fe37a-112">Por ejemplo, si se usa la API función getaddrinfo con el parámetro de la *\_ familia AI* establecido en AF \_ inet6 como la sugerencia addrinfo/Protocol, el usuario puede consultar los servidores DNS para las direcciones IPv6 específicamente.</span><span class="sxs-lookup"><span data-stu-id="fe37a-112">For example, using the GetAddrInfo API with the *ai\_family* parameter set to AF\_INET6 as the addrinfo/protocol hint allows the user to query DNS servers for IPv6 addresses specifically.</span></span> <span data-ttu-id="fe37a-113">La API de [**DnsQuery**](/windows/desktop/api/windns/nf-windns-dnsquery_a) con el tipo DNS \_ Type \_ AAAA también puede usarse para consultar los registros AAAA en los servidores DNS.</span><span class="sxs-lookup"><span data-stu-id="fe37a-113">The [**DnsQuery**](/windows/desktop/api/windns/nf-windns-dnsquery_a) API with the type DNS\_TYPE\_AAAA can also be used to query the DNS servers for AAAA records.</span></span>

## <a name="establishing-a-connection"></a><span data-ttu-id="fe37a-114">Establecer una conexión</span><span class="sxs-lookup"><span data-stu-id="fe37a-114">Establishing a Connection</span></span>

<span data-ttu-id="fe37a-115">Una conexión establecida con Teredo se describe como "fluida" porque se trata como cualquier otra conexión IPv6.</span><span class="sxs-lookup"><span data-stu-id="fe37a-115">A connection established with Teredo is described as 'seamless' because it is handled like any other IPv6 connection.</span></span> <span data-ttu-id="fe37a-116">La programación de una aplicación no requiere una consideración especial para poder usar la interfaz Teredo.</span><span class="sxs-lookup"><span data-stu-id="fe37a-116">The programming of an application does not require special consideration to be capable of utilizing the Teredo interface.</span></span> <span data-ttu-id="fe37a-117">Cuando se establece una conexión entre las interfaces de Teredo, no es necesario un enrutador de retransmisión, típico de 6to4 y otras interfaces nativas.</span><span class="sxs-lookup"><span data-stu-id="fe37a-117">When a connection is established between Teredo interfaces, a relay router, typical of 6to4 and other native interfaces, is not required.</span></span> <span data-ttu-id="fe37a-118">Sin embargo, Teredo está diseñado como tecnología de transición de último recurso para la conectividad IPv6.</span><span class="sxs-lookup"><span data-stu-id="fe37a-118">However, Teredo is designed as a last resort transition technology for IPv6 connectivity.</span></span>

> [!Note]  
> <span data-ttu-id="fe37a-119">Teredo no se usará si el nombre de host proporcionado se resuelve solo en direcciones IPv4.</span><span class="sxs-lookup"><span data-stu-id="fe37a-119">Teredo is not utilized if the supplied hostname resolves to IPv4 addresses only.</span></span>

 

<span data-ttu-id="fe37a-120">Cuando una aplicación intenta conectarse a un destino mediante direcciones IPv6, ocurrirá lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="fe37a-120">When an application attempts to connect to a destination using IPv6 addresses, the following will occur:</span></span>

-   <span data-ttu-id="fe37a-121">La aplicación obtiene una lista de direcciones IPv6 mediante una llamada a la API [**GetAdaptersAddresses**](/windows/desktop/api/iphlpapi/nf-iphlpapi-getadaptersaddresses) .</span><span class="sxs-lookup"><span data-stu-id="fe37a-121">The application obtains a list of IPv6 addresses by calling the [**GetAdaptersAddresses**](/windows/desktop/api/iphlpapi/nf-iphlpapi-getadaptersaddresses) API.</span></span> <span data-ttu-id="fe37a-122">La pila de Windows Vista devuelve una lista de todas las interfaces según el criterio de ordenación especificado en [RFC 3484](https://www.irt.org/rfc/rfc3484.htm).</span><span class="sxs-lookup"><span data-stu-id="fe37a-122">The Windows Vista stack returns a list of all interfaces based on the sorting order specified in [RFC 3484](https://www.irt.org/rfc/rfc3484.htm).</span></span> <span data-ttu-id="fe37a-123">Como resultado, las interfaces IPv6 e IPv6 6to4 se enumerarán antes que la interfaz Teredo.</span><span class="sxs-lookup"><span data-stu-id="fe37a-123">As a result, IPv6 and 6to4 IPv6 interfaces will be listed before Teredo interface.</span></span> <span data-ttu-id="fe37a-124">Sin embargo, cuando la conectividad IPv6 o 6to4 nativa no está disponible, Teredo será la única interfaz compatible con IPv6 que se muestra.</span><span class="sxs-lookup"><span data-stu-id="fe37a-124">However, when native IPv6 or 6to4 connectivity is not available, Teredo will be the only IPv6 capable interface listed.</span></span>

    <span data-ttu-id="fe37a-125">Es importante recordar que una aplicación puede usar cualquier interfaz proporcionada por la pila de Windows Vista; sin embargo, la ordenación de la lista de interfaces devuelta normalmente hará que se intente usar Teredo en último lugar.</span><span class="sxs-lookup"><span data-stu-id="fe37a-125">It is important to remember that an application can use any interface provided by the Windows Vista stack, however the ordering of the interface list returned will most often result in Teredo being attempted last.</span></span>

-   <span data-ttu-id="fe37a-126">Antes de que Windows Vista intente una conexión a través de la interfaz Teredo, el sistema operativo garantiza que la dirección IPv6 esté estabilizada.</span><span class="sxs-lookup"><span data-stu-id="fe37a-126">Before Windows Vista attempts a connection over the Teredo interface, the operating system ensures that the IPv6 address has stabilized.</span></span> <span data-ttu-id="fe37a-127">Esto se hace automáticamente para las conexiones salientes y no es una consideración fundamental para una aplicación.</span><span class="sxs-lookup"><span data-stu-id="fe37a-127">This is done automatically for outgoing connections and is not a crucial consideration for an application.</span></span> <span data-ttu-id="fe37a-128">En el caso de que la aplicación sea necesaria para garantizar la estabilidad de la dirección, se puede llamar a la API [**NotifyStableUnicastIpAddressTable**](/windows/desktop/api/netioapi/nf-netioapi-notifystableunicastipaddresstable) para asegurarse de que la dirección Teredo es estable.</span><span class="sxs-lookup"><span data-stu-id="fe37a-128">In the event the application is required to guarantee address stability, the [**NotifyStableUnicastIpAddressTable**](/windows/desktop/api/netioapi/nf-netioapi-notifystableunicastipaddresstable) API can be called to ensure that the Teredo address is stable.</span></span>

-   <span data-ttu-id="fe37a-129">Una interfaz Teredo intentará conectarse a otra interfaz Teredo en el destino.</span><span class="sxs-lookup"><span data-stu-id="fe37a-129">A Teredo interface will attempt to connect to another Teredo interface at the destination.</span></span> <span data-ttu-id="fe37a-130">Si no hay una interfaz Teredo, se establece una conexión con una dirección de destino nativa o 6to4 a través de una retransmisión específica del host.</span><span class="sxs-lookup"><span data-stu-id="fe37a-130">If a Teredo interface is not present, a connection is established with a native or 6to4 destination address through a host-specific relay.</span></span>

<span data-ttu-id="fe37a-131">También es posible que las aplicaciones que inician conexiones a Internet reciban tráfico no solicitado.</span><span class="sxs-lookup"><span data-stu-id="fe37a-131">It is also possible for applications that initiate connections to the Internet to receive unsolicited traffic.</span></span> <span data-ttu-id="fe37a-132">Para obtener más información, consulte [recibir tráfico no solicitado a través de Teredo](receiving-unsolicited-traffic-over-teredo.md).</span><span class="sxs-lookup"><span data-stu-id="fe37a-132">For more details see [Receiving Unsolicited Traffic Over Teredo](receiving-unsolicited-traffic-over-teredo.md).</span></span>

## <a name="using-the-wsaconnectbyname-api"></a><span data-ttu-id="fe37a-133">Uso de la API de WSAConnectByName</span><span class="sxs-lookup"><span data-stu-id="fe37a-133">Using the WSAConnectByName API</span></span>

<span data-ttu-id="fe37a-134">Al llamar a la API WSAConnectByName, es posible que una aplicación se conecte a un nombre de destino en lugar de especificar la dirección IP exacta.</span><span class="sxs-lookup"><span data-stu-id="fe37a-134">By calling the WSAConnectByName API, it is possible for an application to connect to a destination name instead of specifying the exact IP address.</span></span> <span data-ttu-id="fe37a-135">La pila de Windows Vista prefiere IPv6 a través de IPv4 y, como resultado, los intentos de conexión se realizarán primero en las direcciones IPv6.</span><span class="sxs-lookup"><span data-stu-id="fe37a-135">The Windows Vista stack prefers IPv6 over IPv4, and as a result any connection attempts will be made to IPv6 addresses first.</span></span>

<span data-ttu-id="fe37a-136">Al llamar a la API WSAConnectByName se ordenarán todas las direcciones IP de destino obtenidas en el siguiente orden:</span><span class="sxs-lookup"><span data-stu-id="fe37a-136">Calling the WSAConnectByName API will sort all destination IP addresses obtained in the following order:</span></span>

-   <span data-ttu-id="fe37a-137">Dirección IPv6 nativa</span><span class="sxs-lookup"><span data-stu-id="fe37a-137">Native IPv6 address</span></span>
-   <span data-ttu-id="fe37a-138">Dirección IP 6to4</span><span class="sxs-lookup"><span data-stu-id="fe37a-138">6to4 IP address</span></span>
-   <span data-ttu-id="fe37a-139">Dirección IPv4</span><span class="sxs-lookup"><span data-stu-id="fe37a-139">IPv4 address</span></span>
-   <span data-ttu-id="fe37a-140">Dirección Teredo</span><span class="sxs-lookup"><span data-stu-id="fe37a-140">Teredo address</span></span>

<span data-ttu-id="fe37a-141">Una vez que las direcciones de destino se ordenan internamente, se intenta establecer una conexión con el destino en función de la mejor ruta disponible en el host local para la dirección de destino.</span><span class="sxs-lookup"><span data-stu-id="fe37a-141">After the destination addresses are sorted internally, a connection to the destination is attempted based on the best route available on the local host for the destination address.</span></span> <span data-ttu-id="fe37a-142">Como se indica en el orden de las direcciones ordenadas, si el nombre de destino se resuelve en una dirección IPv4 y Teredo, se usará la dirección IPv4 para establecer la conexión.</span><span class="sxs-lookup"><span data-stu-id="fe37a-142">As indicated by the order of the sorted addresses, if the destination name resolves to a IPv4 and Teredo address, the IPv4 address will be used to establish the connection.</span></span>

<span data-ttu-id="fe37a-143">La API de WSAConnectByName funciona internamente para encontrar la mejor coincidencia entre las direcciones.</span><span class="sxs-lookup"><span data-stu-id="fe37a-143">The WSAConnectByName API works internally to find the best match between addresses.</span></span> <span data-ttu-id="fe37a-144">Este intento se basa en las rutas disponibles en el host local y en las direcciones de destino.</span><span class="sxs-lookup"><span data-stu-id="fe37a-144">This attempt is based on the routes available on the local host and the destination addresses.</span></span>

<span data-ttu-id="fe37a-145">Debido a la ausencia actual de retransmisiones Teredo en Internet, es poco probable que las conexiones a direcciones IPv6 nativas se realicen correctamente a través de la interfaz Teredo.</span><span class="sxs-lookup"><span data-stu-id="fe37a-145">Due to current absence of Teredo relays on the Internet, connections to native IPv6 addresses are unlikely to succeed over the Teredo interface.</span></span> <span data-ttu-id="fe37a-146">Si se llama a WSAConnectByName, Windows Vista no emitirá consultas AAAA cuando Teredo sea la única interfaz compatible con IPv6 disponible.</span><span class="sxs-lookup"><span data-stu-id="fe37a-146">If WSAConnectByName is called, Windows Vista will not issue AAAA queries when Teredo is the only IPv6 capable interface available.</span></span> <span data-ttu-id="fe37a-147">Esto garantiza que las direcciones IPv6 nativas no se obtienen como destino y que se intentan las conexiones a través de IPv4, lo que tiene la mayor probabilidad de éxito.</span><span class="sxs-lookup"><span data-stu-id="fe37a-147">This ensures that native IPv6 addresses are not obtained as a destination and that connections are attempted over IPv4, which has the highest chance of success.</span></span> <span data-ttu-id="fe37a-148">Con el fin de obtener direcciones IPv6 cuando Teredo es la única interfaz compatible con IPv6, una aplicación debe usar explícitamente la API DnsQuery para registros AAAA.</span><span class="sxs-lookup"><span data-stu-id="fe37a-148">In order to obtain IPv6 addresses when Teredo is the only IPv6 capable interface, an application must explicitly use the DnsQuery API for AAAA records.</span></span>

 

 