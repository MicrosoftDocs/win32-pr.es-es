---
title: Implementación del mecanismo LEAP de EAPHost
description: Describe el mecanismo de EAPHost que permite a terceros escribir módulos de protocolo de autenticación extensible ligero (LEAP) para Windows.
ms.assetid: d17a99cb-4a43-4719-984e-b742c9518f52
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dc50cda8d32cc26dd81af5733345deebb579c792
ms.sourcegitcommit: 773fa6257ead6c74154ad3cf46d21e49adc900aa
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/09/2020
ms.locfileid: "104149707"
---
# <a name="implementing-the-eaphost-leap-mechanism"></a><span data-ttu-id="8160c-103">Implementación del mecanismo LEAP de EAPHost</span><span class="sxs-lookup"><span data-stu-id="8160c-103">Implementing the EAPHost LEAP Mechanism</span></span>

<span data-ttu-id="8160c-104">En este tema se describe el mecanismo de EAPHost que permite a terceros escribir módulos de protocolo de autenticación extensible ligero (LEAP) para Windows.</span><span class="sxs-lookup"><span data-stu-id="8160c-104">This topic describes the EAPHost mechanism that allows third parties to write Lightweight Extensible Authentication Protocol (LEAP) modules for Windows.</span></span> <span data-ttu-id="8160c-105">LEAP es un método de autenticación heredado, creado por Cisco, según [RFC 3748](https://go.microsoft.com/fwlink/p/?linkid=84016).</span><span class="sxs-lookup"><span data-stu-id="8160c-105">LEAP is a legacy authentication method, created by Cisco, as per [RFC 3748](https://go.microsoft.com/fwlink/p/?linkid=84016).</span></span> <span data-ttu-id="8160c-106">Para obtener más información sobre LEAP, consulte [Cisco Leap Q&A](https://go.microsoft.com/fwlink/p/?linkid=84018).</span><span class="sxs-lookup"><span data-stu-id="8160c-106">For more information about LEAP, see [Cisco LEAP Q&A](https://go.microsoft.com/fwlink/p/?linkid=84018).</span></span>

## <a name="eaphost-authentication-process"></a><span data-ttu-id="8160c-107">Proceso de autenticación de EAPHost</span><span class="sxs-lookup"><span data-stu-id="8160c-107">EAPHost Authentication Process</span></span>

<span data-ttu-id="8160c-108">El proceso de autenticación de EAPHost normal se produce de la manera siguiente:</span><span class="sxs-lookup"><span data-stu-id="8160c-108">The regular EAPHost authentication process occurs as follows:</span></span>

-   <span data-ttu-id="8160c-109">El autenticador envía una solicitud para autenticar el elemento del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="8160c-109">The authenticator sends a Request to authenticate the peer.</span></span> <span data-ttu-id="8160c-110">Por ejemplo, la aplicación llama a [**EapHostPeerBeginSession**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeerbeginsession) con los datos de usuario y la configuración de EAPHost.</span><span class="sxs-lookup"><span data-stu-id="8160c-110">For example, the application calls [**EapHostPeerBeginSession**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeerbeginsession) with EAPHost configuration and user data.</span></span>
-   <span data-ttu-id="8160c-111">El elemento del mismo nivel envía un paquete de respuesta en respuesta a una solicitud válida.</span><span class="sxs-lookup"><span data-stu-id="8160c-111">The peer sends a Response packet in reply to a valid Request.</span></span> <span data-ttu-id="8160c-112">Por ejemplo, una llamada correcta devuelve un identificador de sesión de **\_ \_ identificador de sesión EAP** .</span><span class="sxs-lookup"><span data-stu-id="8160c-112">For example, a successful call returns an **EAP\_SESSION\_HANDLE** session handle.</span></span>
-   <span data-ttu-id="8160c-113">El autenticador envía un paquete de solicitud adicional y el elemento del mismo nivel responde con una respuesta.</span><span class="sxs-lookup"><span data-stu-id="8160c-113">The authenticator sends an additional Request packet, and the peer replies with a Response.</span></span> <span data-ttu-id="8160c-114">Por ejemplo, la aplicación llama a [**EapHostPeerGetSendPacket**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeergetsendpacket) para obtener paquetes EAP recibidos por EAPHost a lo largo de la sesión.</span><span class="sxs-lookup"><span data-stu-id="8160c-114">For example, the application calls [**EapHostPeerGetSendPacket**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeergetsendpacket) to obtain EAP packets received by EAPHost throughout the session.</span></span> <span data-ttu-id="8160c-115">Cada paquete se procesa mediante una llamada a [**EapHostPeerProcessReceivedPacket**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeerprocessreceivedpacket).</span><span class="sxs-lookup"><span data-stu-id="8160c-115">Each packet is processed by a call to [**EapHostPeerProcessReceivedPacket**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeerprocessreceivedpacket).</span></span>
-   <span data-ttu-id="8160c-116">[**EapHostPeerProcessReceivedPacket**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeerprocessreceivedpacket) siempre devolverá un código de acción.</span><span class="sxs-lookup"><span data-stu-id="8160c-116">[**EapHostPeerProcessReceivedPacket**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeerprocessreceivedpacket) will always return an action code.</span></span> <span data-ttu-id="8160c-117">A continuación, el suplicante debe llamar a la función correspondiente al código de acción.</span><span class="sxs-lookup"><span data-stu-id="8160c-117">The supplicant must then call the function corresponding to the action code.</span></span>
-   <span data-ttu-id="8160c-118">La secuencia de solicitudes y respuestas continúa siempre y cuando sea necesario.</span><span class="sxs-lookup"><span data-stu-id="8160c-118">The sequence of Requests and Responses continues as long as needed.</span></span> <span data-ttu-id="8160c-119">Por ejemplo, la aplicación puede llamar a [**EapHostPeerGetResponseAttributes**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeergetresponseattributes) para solicitar los atributos EAP disponibles y el elemento del mismo nivel responde con [**EapHostPeerSetResponseAttributes**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeersetresponseattributes) para devolverlos.</span><span class="sxs-lookup"><span data-stu-id="8160c-119">For example, the application can call [**EapHostPeerGetResponseAttributes**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeergetresponseattributes) to request available EAP attributes, and the peer responds with [**EapHostPeerSetResponseAttributes**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeersetresponseattributes) to return them.</span></span>
-   <span data-ttu-id="8160c-120">Después de una solicitud inicial, no se puede enviar una nueva solicitud hasta que se reciba una respuesta válida.</span><span class="sxs-lookup"><span data-stu-id="8160c-120">After an initial Request, a new Request cannot be sent until a valid Response is received.</span></span>
-   <span data-ttu-id="8160c-121">La conversación continúa hasta que el autenticador no puede autenticar al mismo nivel, en cuyo caso la implementación del autenticador debe transmitir un error de EAP.</span><span class="sxs-lookup"><span data-stu-id="8160c-121">The conversation continues until the authenticator cannot authenticate the peer, in which case the authenticator implementation must transmit an EAP Failure.</span></span> <span data-ttu-id="8160c-122">Por ejemplo, las respuestas inaceptables a una o más solicitudes harían que el autenticador transmitiera un error de EAP de código 4.</span><span class="sxs-lookup"><span data-stu-id="8160c-122">For example, unacceptable Responses to one or more Requests would cause the authenticator to transmit a Code 4 EAP Failure.</span></span>
-   <span data-ttu-id="8160c-123">Como alternativa, la conversación de autenticación puede continuar hasta que el autenticador determine que se ha producido la autenticación correcta, en cuyo caso el autenticador debe transmitir un EAP correcto (código 3).</span><span class="sxs-lookup"><span data-stu-id="8160c-123">Alternatively, the authentication conversation can continue until the authenticator determines that successful authentication has occurred, in which case the authenticator must transmit an EAP Success (Code 3).</span></span>
-   <span data-ttu-id="8160c-124">Si el resultado indica éxito o error, la aplicación llama a [**EapHostPeerEndSession**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeerendsession) para finalizar la sesión.</span><span class="sxs-lookup"><span data-stu-id="8160c-124">Whether the result indicates success or failure, the application calls [**EapHostPeerEndSession**](/previous-versions/windows/desktop/api/eappapis/nf-eappapis-eaphostpeerendsession) to terminate the session.</span></span> <span data-ttu-id="8160c-125">En caso de error, se puede intentar volver a realizar la autenticación abriendo otra sesión con EAPHost y proporcionando la misma identidad o una nueva.</span><span class="sxs-lookup"><span data-stu-id="8160c-125">In the case of failure, re-authentication can be attempted by opening another session with EAPHost and providing either the same or a new identity.</span></span>

### <a name="leap-authentication-process"></a><span data-ttu-id="8160c-126">Proceso de autenticación LEAP</span><span class="sxs-lookup"><span data-stu-id="8160c-126">LEAP Authentication Process</span></span>

<span data-ttu-id="8160c-127">El proceso de autenticación LEAP difiere del proceso de autenticación de EAPhost normal de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="8160c-127">The LEAP authentication process differs from the regular EAPhost authentication process as follows:</span></span>

-   <span data-ttu-id="8160c-128">El servidor inicia la autenticación EAP (autenticador).</span><span class="sxs-lookup"><span data-stu-id="8160c-128">EAP authentication is initiated by the server (authenticator).</span></span> <span data-ttu-id="8160c-129">Por el contrario, el cliente (del mismo nivel) inicia LEAP.</span><span class="sxs-lookup"><span data-stu-id="8160c-129">LEAP, in contrast, is initiated by the client (peer).</span></span>
    -   <span data-ttu-id="8160c-130">Por lo tanto, al escribir un módulo LEAP, siempre debe asegurarse de que el paquete de solicitud de desafío desde el método del mismo nivel y la respuesta EAP desde el servidor EAP siempre deben tener el mismo identificador de paquete que el paquete de EAP correcto del servidor.</span><span class="sxs-lookup"><span data-stu-id="8160c-130">Therefore, when writing a LEAP module you must always ensure that the Challenge Request packet from the peer method and the EAP Response from the EAP server must always have the same packet ID as that of the EAP Success packet from the server.</span></span>

    <!-- -->

    -   <span data-ttu-id="8160c-131">Por el contrario, los paquetes de solicitud y respuesta y correctos de EAPHost suelen tener identificadores diferentes.</span><span class="sxs-lookup"><span data-stu-id="8160c-131">In contrast, EAPHost Request and Response and Success packets typically all have different IDs.</span></span>
        > [!Note]  
        > <span data-ttu-id="8160c-132">Cada solicitud EAP tiene un campo de tipo para indicar lo que se solicita.</span><span class="sxs-lookup"><span data-stu-id="8160c-132">Every EAP Request has a Type field to indicate what is being requested.</span></span> <span data-ttu-id="8160c-133">Al igual que con el paquete de solicitud, cada paquete de respuesta EAP contiene un campo de tipo, que se corresponde con el campo de tipo de la solicitud.</span><span class="sxs-lookup"><span data-stu-id="8160c-133">As with the Request packet, every EAP Response packet contains a Type field, which corresponds to the Type field of the Request.</span></span> <span data-ttu-id="8160c-134">Algunos ejemplos son los paquetes de solicitud de identidad y de solicitud de desafío.</span><span class="sxs-lookup"><span data-stu-id="8160c-134">Examples include Identity Request and Challenge Request packets.</span></span>

         

-   <span data-ttu-id="8160c-135">En el caso de que se produzca un error con EAPHost, se puede intentar la reautenticación abriendo otra sesión con EAPHost y proporcionando la misma identidad o una nueva identidad.</span><span class="sxs-lookup"><span data-stu-id="8160c-135">In the case of failure with EAPHost, re-authentication can be attempted by opening another session with EAPHost and providing either the same identity or a new identity.</span></span>

### <a name="leap-authenticator-method-implementation"></a><span data-ttu-id="8160c-136">Implementación del método de autenticador LEAP</span><span class="sxs-lookup"><span data-stu-id="8160c-136">LEAP Authenticator Method Implementation</span></span>

<span data-ttu-id="8160c-137">Al desarrollar un método de autenticador LEAP, asegúrese de lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="8160c-137">When developing a LEAP authenticator method, please ensure the following:</span></span>

-   <span data-ttu-id="8160c-138">Los métodos de autenticación LEAP deben devolver el código de acción de [**\_ envío de \_ \_ respuesta \_ del autenticador del método EAP**](/windows/desktop/api/EapAuthenticatorActionDefine/ne-eapauthenticatoractiondefine-eap_method_authenticator_response_action) después de la primera fase de autenticación (autenticación del mismo nivel) se realiza correctamente.</span><span class="sxs-lookup"><span data-stu-id="8160c-138">LEAP authenticator methods must return the [**EAP\_METHOD\_AUTHENTICATOR\_RESPONSE\_SEND**](/windows/desktop/api/EapAuthenticatorActionDefine/ne-eapauthenticatoractiondefine-eap_method_authenticator_response_action) action code after the 1st phase of authentication (peer authentication) is successful.</span></span> <span data-ttu-id="8160c-139">Después, cuando se llama a [**EapMethodAuthenticatorSendPacket**](/previous-versions/windows/desktop/api/eapmethodauthenticatorapis/nf-eapmethodauthenticatorapis-eapmethodauthenticatorsendpacket) , debe devolver un [**EapPacket**](/windows/win32/api/eapmethodtypes/ns-eapmethodtypes-eappacket) válido con un código EAP de [**EapCodeSuccess**](/windows/win32/api/eapmethodtypes/ne-eapmethodtypes-eapcode).</span><span class="sxs-lookup"><span data-stu-id="8160c-139">Then when [**EapMethodAuthenticatorSendPacket**](/previous-versions/windows/desktop/api/eapmethodauthenticatorapis/nf-eapmethodauthenticatorapis-eapmethodauthenticatorsendpacket) is called, it should return a valid [**EapPacket**](/windows/win32/api/eapmethodtypes/ns-eapmethodtypes-eappacket) with an EAP code of [**EapCodeSuccess**](/windows/win32/api/eapmethodtypes/ne-eapmethodtypes-eapcode).</span></span>
-   <span data-ttu-id="8160c-140">Los métodos de autenticación LEAP deben devolver el código de acción de [**\_ resultado de \_ \_ respuesta \_ del autenticador del método EAP**](/windows/desktop/api/EapAuthenticatorActionDefine/ne-eapauthenticatoractiondefine-eap_method_authenticator_response_action) si la primera fase de la autenticación del mismo nivel no se realiza correctamente.</span><span class="sxs-lookup"><span data-stu-id="8160c-140">LEAP authenticator methods should return the [**EAP\_METHOD\_AUTHENTICATOR\_RESPONSE\_RESULT**](/windows/desktop/api/EapAuthenticatorActionDefine/ne-eapauthenticatoractiondefine-eap_method_authenticator_response_action) action code if the 1st phase of peer authentication is unsuccessful.</span></span>
-   <span data-ttu-id="8160c-141">Los métodos de autenticador LEAP deben devolver el paquete de respuesta de autenticación final con el código de acción de [**resultado de \_ \_ \_ respuesta \_ del autenticador del método EAP**](/windows/desktop/api/EapAuthenticatorActionDefine/ne-eapauthenticatoractiondefine-eap_method_authenticator_response_action) cuando se llama a [**EapMethodAuthenticatorSendPacket**](/previous-versions/windows/desktop/api/eapmethodauthenticatorapis/nf-eapmethodauthenticatorapis-eapmethodauthenticatorsendpacket) .</span><span class="sxs-lookup"><span data-stu-id="8160c-141">LEAP authenticator methods must return the final authentication response packet with the [**EAP\_METHOD\_AUTHENTICATOR\_RESPONSE\_RESULT**](/windows/desktop/api/EapAuthenticatorActionDefine/ne-eapauthenticatoractiondefine-eap_method_authenticator_response_action) action code when [**EapMethodAuthenticatorSendPacket**](/previous-versions/windows/desktop/api/eapmethodauthenticatorapis/nf-eapmethodauthenticatorapis-eapmethodauthenticatorsendpacket) is called.</span></span> <span data-ttu-id="8160c-142">A continuación, en las llamadas posteriores a [**EapMethodAuthenticatorGetResult**](/previous-versions/windows/desktop/api/eapmethodauthenticatorapis/nf-eapmethodauthenticatorapis-eapmethodauthenticatorgetresult) , se debe devolver el **\_ \_ identificador de sesión EAP** para identificar la sesión autenticada.</span><span class="sxs-lookup"><span data-stu-id="8160c-142">Then in subsequent calls to [**EapMethodAuthenticatorGetResult**](/previous-versions/windows/desktop/api/eapmethodauthenticatorapis/nf-eapmethodauthenticatorapis-eapmethodauthenticatorgetresult) the **EAP\_SESSION\_HANDLE** must be returned to identify the authenticated session.</span></span>
-   

### <a name="leap-peer-method-implementation"></a><span data-ttu-id="8160c-143">Implementación del método del mismo nivel LEAP</span><span class="sxs-lookup"><span data-stu-id="8160c-143">LEAP Peer Method Implementation</span></span>

<span data-ttu-id="8160c-144">Al desarrollar un método del mismo nivel LEAP, asegúrese de lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="8160c-144">When developing a LEAP peer method, please ensure the following</span></span>

-   <span data-ttu-id="8160c-145">Los métodos del mismo nivel LEAP deben devolver el código de acción [**EapPeerMethodResponseActionSend**](/windows/win32/api/eapauthenticatoractiondefine/ne-eapauthenticatoractiondefine-eappeermethodresponseaction) después de la primera fase de autenticación (autenticación del mismo nivel) se realiza correctamente.</span><span class="sxs-lookup"><span data-stu-id="8160c-145">LEAP peer methods should return the [**EapPeerMethodResponseActionSend**](/windows/win32/api/eapauthenticatoractiondefine/ne-eapauthenticatoractiondefine-eappeermethodresponseaction) action code after the 1st phase of authentication (peer authentication) is successful.</span></span>
-   <span data-ttu-id="8160c-146">Los métodos del mismo nivel LEAP deben devolver el código de acción [**EapPeerMethodResponseActionResult**](/windows/win32/api/eapauthenticatoractiondefine/ne-eapauthenticatoractiondefine-eappeermethodresponseaction) después de que la segunda fase de autenticación se realice correctamente.</span><span class="sxs-lookup"><span data-stu-id="8160c-146">LEAP peer methods should return the [**EapPeerMethodResponseActionResult**](/windows/win32/api/eapauthenticatoractiondefine/ne-eapauthenticatoractiondefine-eappeermethodresponseaction) action code after the 2nd phase of authentication is successful.</span></span>

## <a name="related-topics"></a><span data-ttu-id="8160c-147">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="8160c-147">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8160c-148">Secuencia de llamadas de EAPHost</span><span class="sxs-lookup"><span data-stu-id="8160c-148">EAPHost Call Sequence</span></span>](about-eaphost-call-sequences.md)
</dt> <dt>

[<span data-ttu-id="8160c-149">Uso de EAPHost</span><span class="sxs-lookup"><span data-stu-id="8160c-149">Using EAPHost</span></span>](using-eap-host.md)
</dt> </dl>

 

 




