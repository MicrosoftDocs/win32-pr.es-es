---
title: Usar las interfaces IADs
description: ADSI, cada elemento de un servicio de directorio se representa mediante un objeto ADSI, que es un objeto de modelo de objetos componentes (COM) que admite la interfaz IUnknown COM estándar, así como las interfaces IDispatch e IADs.
ms.assetid: bdbf2012-6863-4611-8173-6a3cd9c4960f
ms.tgt_platform: multiple
keywords:
- ADSI de IADs, usar
- ADSI ADSI, usar, usar las interfaces de IADs
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 878afa9350a45f18238bebb69df1a96eba52715e
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/21/2020
ms.locfileid: "104421418"
---
# <a name="using-the-iads-interfaces"></a><span data-ttu-id="a0e13-105">Usar las interfaces IADs</span><span class="sxs-lookup"><span data-stu-id="a0e13-105">Using the IADs Interfaces</span></span>

<span data-ttu-id="a0e13-106">ADSI, cada elemento de un servicio de directorio se representa mediante un objeto ADSI, que es un objeto de modelo de objetos componentes (COM) que admite la interfaz [**IUNKNOWN**](/windows/win32/api/unknwn/nn-unknwn-iunknown) com estándar, así como las interfaces [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) e [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) .</span><span class="sxs-lookup"><span data-stu-id="a0e13-106">ADSI, each element of a directory service is represented by an ADSI object, which is a Component Object Model (COM) object that supports the standard COM [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface as well as the [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) and [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) interfaces.</span></span> <span data-ttu-id="a0e13-107">**IADs** proporciona las funciones de mantenimiento básicas para los objetos ADSI.</span><span class="sxs-lookup"><span data-stu-id="a0e13-107">**IADs** supplies the basic maintenance functions for ADSI objects.</span></span>

<span data-ttu-id="a0e13-108">Cada objeto ADSI debe admitir esta interfaz, que sirve para:</span><span class="sxs-lookup"><span data-stu-id="a0e13-108">Each ADSI object must support this interface, which serves to:</span></span>

-   <span data-ttu-id="a0e13-109">Proporcione la identificación del objeto por nombre, clase o ADsPath.</span><span class="sxs-lookup"><span data-stu-id="a0e13-109">Provide object identification by name, class, or ADsPath.</span></span>
-   <span data-ttu-id="a0e13-110">Identifique el contenedor de objetos que administra la creación y eliminación de objetos.</span><span class="sxs-lookup"><span data-stu-id="a0e13-110">Identify the object container that manages creating and deleting objects.</span></span>
-   <span data-ttu-id="a0e13-111">Obtener la definición del esquema de objeto.</span><span class="sxs-lookup"><span data-stu-id="a0e13-111">Obtain the object schema definition.</span></span>
-   <span data-ttu-id="a0e13-112">Cargue los atributos del objeto en la caché de propiedades y confirme los cambios en el almacén de directorios persistente.</span><span class="sxs-lookup"><span data-stu-id="a0e13-112">Load the object attributes to the property cache and commit changes to the persistent directory store.</span></span>
-   <span data-ttu-id="a0e13-113">Obtener acceso y modificar los valores de atributo del objeto en la memoria caché de propiedades.</span><span class="sxs-lookup"><span data-stu-id="a0e13-113">Access and modify the object attribute values in the property cache.</span></span>

<span data-ttu-id="a0e13-114">La interfaz [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) está diseñada para garantizar que los objetos ADSI proporcionan a los administradores de red y proveedores de servicios de directorio una representación eficaz y coherente de varios servicios de directorio subyacentes.</span><span class="sxs-lookup"><span data-stu-id="a0e13-114">The [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) interface is designed to ensure that ADSI objects provide network administrators and directory service providers with an efficient and consistent representation of various underlying directory services.</span></span>

![objeto ADSI compatible con la interfaz iAds](images/ds2iads.png)

<span data-ttu-id="a0e13-116">En la ilustración anterior se muestra un objeto ADSI genérico que admite las interfaces básicas [**IADs**](/windows/desktop/api/Iads/nn-iads-iads), [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist), [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject)y [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch).</span><span class="sxs-lookup"><span data-stu-id="a0e13-116">The preceding figure shows a generic ADSI object that support the fundamental interfaces [**IADs**](/windows/desktop/api/Iads/nn-iads-iads), [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist), [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject), and [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch).</span></span> <span data-ttu-id="a0e13-117">Un objeto ADSI como este administra los datos del almacén de datos del servicio de directorio subyacente a través de las interfaces que admite.</span><span class="sxs-lookup"><span data-stu-id="a0e13-117">An ADSI object such as this manages data from the data store of the underlying directory service through the interfaces it supports.</span></span> <span data-ttu-id="a0e13-118">Estos datos se conocen como las propiedades del objeto y las rutinas que obtienen y establecen estas propiedades se conocen como métodos de propiedad.</span><span class="sxs-lookup"><span data-stu-id="a0e13-118">This data is known as the properties of the object, and the routines that obtain and set these properties are known as property methods.</span></span> <span data-ttu-id="a0e13-119">Las propiedades de solo lectura tienen un método de propiedad que obtiene el valor de propiedad.</span><span class="sxs-lookup"><span data-stu-id="a0e13-119">Read-only properties have one property method that obtains the property value.</span></span> <span data-ttu-id="a0e13-120">Las propiedades de lectura y escritura tienen dos métodos: un método que establece el valor y otro que obtiene el valor.</span><span class="sxs-lookup"><span data-stu-id="a0e13-120">Read/write properties have two methods; a method that sets the value and one that obtains the value.</span></span> <span data-ttu-id="a0e13-121">Las propiedades se implementan en cada objeto ADSI mediante una [caché de propiedades](the-adsi-attribute-cache.md).</span><span class="sxs-lookup"><span data-stu-id="a0e13-121">Properties are implemented on each ADSI object using a [property cache](the-adsi-attribute-cache.md).</span></span> <span data-ttu-id="a0e13-122">[**IADs:: get \_ ADsPath**](iads-property-methods.md) y **IADs::p el \_ ADsPath de UT** son ejemplos de métodos de propiedad.</span><span class="sxs-lookup"><span data-stu-id="a0e13-122">[**IADs::get\_ADsPath**](iads-property-methods.md) and **IADs::put\_ADsPath** are examples of property methods.</span></span> <span data-ttu-id="a0e13-123">Los métodos de propiedad no son aparentes para Visual Basic y otros clientes de automatización que habilitan las referencias directas a la propiedad.</span><span class="sxs-lookup"><span data-stu-id="a0e13-123">Property methods are not apparent to Visual Basic and other Automation clients that enable direct references to the property.</span></span> <span data-ttu-id="a0e13-124">Por ejemplo, Visual Basic hace referencia a **IADs:: ADsPath** directamente mediante la sintaxis **Object. ADsPath** .</span><span class="sxs-lookup"><span data-stu-id="a0e13-124">For example, Visual Basic refers to **IADs::ADsPath** directly using the **Object.ADsPath** syntax.</span></span> <span data-ttu-id="a0e13-125">Para obtener más información, vea [métodos de propiedad de interfaz](interface-property-methods.md).</span><span class="sxs-lookup"><span data-stu-id="a0e13-125">For more information, see [Interface Property Methods](interface-property-methods.md).</span></span>

<span data-ttu-id="a0e13-126">Además, un objeto ADSI interactúa con otros objetos ADSI y directamente con un espacio de nombres a través de métodos.</span><span class="sxs-lookup"><span data-stu-id="a0e13-126">In addition, an ADSI object interacts with other ADSI objects and directly to a namespace through methods.</span></span> <span data-ttu-id="a0e13-127">Los métodos se ejecutan inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="a0e13-127">Methods execute immediately.</span></span> <span data-ttu-id="a0e13-128">Algunos ejemplos de métodos son [**IADs:: SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) y [**IADs:: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo).</span><span class="sxs-lookup"><span data-stu-id="a0e13-128">Examples of methods include [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) and [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo).</span></span>

<span data-ttu-id="a0e13-129">Se tiene acceso a las propiedades, métodos de propiedad y métodos a través de interfaces COM estándar.</span><span class="sxs-lookup"><span data-stu-id="a0e13-129">Properties, property methods, and methods are all accessed through standard COM interfaces.</span></span>

<span data-ttu-id="a0e13-130">Un objeto ADSI se identifica de forma única mediante su ADsPath.</span><span class="sxs-lookup"><span data-stu-id="a0e13-130">An ADSI object is uniquely identified by its ADsPath.</span></span> <span data-ttu-id="a0e13-131">Por ejemplo, un ADsPath para el espacio de nombres LDAP es "LDAP://MyServer/DC=Fabrikam,DC=COM".</span><span class="sxs-lookup"><span data-stu-id="a0e13-131">For example, an ADsPath for the LDAP namespace is "LDAP://MyServer/DC=Fabrikam,DC=COM".</span></span> <span data-ttu-id="a0e13-132">Para obtener más información sobre ADsPaths, consulte el [enlace de ADSI](binding-to-an-adsi-object.md).</span><span class="sxs-lookup"><span data-stu-id="a0e13-132">For more information about ADsPaths, see [ADSI Binding](binding-to-an-adsi-object.md).</span></span> <span data-ttu-id="a0e13-133">En el caso de los programadores familiarizados con monikers COM, es conceptualmente similar al nombre para mostrar del moniker COM.</span><span class="sxs-lookup"><span data-stu-id="a0e13-133">For programmers familiar with COM monikers, this is conceptually similar to the COM moniker display name.</span></span>

<span data-ttu-id="a0e13-134">Cualquier objeto ADSI que contenga otros objetos ADSI, denominado un objeto contenedor ADSI, también admite la interfaz [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) , que proporciona métodos y propiedades que administran la creación, eliminación y enumeración de objetos ADSI contenidos en el objeto.</span><span class="sxs-lookup"><span data-stu-id="a0e13-134">Any ADSI object that contains other ADSI objects, called an ADSI container object, also supports the [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) interface, which provides methods and properties that manage the creation, deletion, and enumeration of ADSI objects contained by the object.</span></span> <span data-ttu-id="a0e13-135">En la siguiente ilustración se muestra un objeto de contenedor ADSI.</span><span class="sxs-lookup"><span data-stu-id="a0e13-135">The following figure shows an ADSI container object.</span></span>

![objeto de contenedor ADSI](images/dsiadsc.png)

<span data-ttu-id="a0e13-137&quot;>La mayoría de los objetos ADSI están incluidos en otros objetos.</span><span class=&quot;sxs-lookup&quot;><span data-stu-id=&quot;a0e13-137&quot;>Most ADSI objects are contained by other objects.</span></span> <span data-ttu-id=&quot;a0e13-138&quot;>El único objeto ADSI sin contenedor primario es el objeto de los espacios de **nombres** ADSI de nivel superior (&quot;ADS:").</span><span class="sxs-lookup"><span data-stu-id="a0e13-138">The only ADSI object with no parent container is the top-level ADSI **Namespaces** object ("ADS:").</span></span>

<span data-ttu-id="a0e13-139">El método [**IADs:: SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) de un objeto contenedor almacena de forma persistente las propiedades almacenadas en caché del objeto de contenedor ADSI en el almacenamiento, además de los objetos creados con el método [**IADsContainer:: Create**](/windows/desktop/api/Iads/nf-iads-iadscontainer-create) .</span><span class="sxs-lookup"><span data-stu-id="a0e13-139">The [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) method on a container object persistently stores the cached properties of the ADSI container object to storage in addition to any objects created with the [**IADsContainer::Create**](/windows/desktop/api/Iads/nf-iads-iadscontainer-create) method.</span></span> <span data-ttu-id="a0e13-140">[**IADsContainer::D iminar**](/windows/desktop/api/Iads/nf-iads-iadscontainer-delete) no afecta a la memoria caché de propiedades, pero elimina el elemento de directorio de espacio de nombres subyacente representado por este objeto.</span><span class="sxs-lookup"><span data-stu-id="a0e13-140">[**IADsContainer::Delete**](/windows/desktop/api/Iads/nf-iads-iadscontainer-delete) does not affect the property cache but deletes the underlying namespace directory element represented by this object.</span></span>

 

 