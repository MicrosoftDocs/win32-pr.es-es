---
description: En el procedimiento de este tema se identifica cómo crear un paquete de Windows Installer para instalar un ensamblado Win32.
ms.assetid: 2d4bc2be-cce6-45e6-b6a7-7ff96d28eb96
title: Instalar ensamblados Win32 para el uso privado de una aplicación en Windows XP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e807e22c9c5dea67ece5ead0ded95f06ab203689
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "105686884"
---
# <a name="installing-win32-assemblies-for-the-private-use-of-an-application-on-windows-xp"></a><span data-ttu-id="d5fa5-103">Instalar ensamblados Win32 para el uso privado de una aplicación en Windows XP</span><span class="sxs-lookup"><span data-stu-id="d5fa5-103">Installing Win32 Assemblies for the Private Use of an Application on Windows XP</span></span>

<span data-ttu-id="d5fa5-104">En el procedimiento de este tema se identifica cómo crear un paquete de Windows Installer para instalar un ensamblado Win32.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-104">The procedure in this topic identifies how to create a Windows Installer package to install a Win32 assembly.</span></span> <span data-ttu-id="d5fa5-105">El paquete instala el ensamblado y un archivo de manifiesto de aplicación en una carpeta creada que utiliza la aplicación.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-105">The package installs the assembly and an application manifest file into an authored folder that the application uses.</span></span> <span data-ttu-id="d5fa5-106">El manifiesto de aplicación especifica la dependencia de la aplicación en el ensamblado privado.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-106">The application manifest specifies the dependence of the application on the private assembly.</span></span> <span data-ttu-id="d5fa5-107">Después de instalar el paquete, el ensamblado privado está disponible para el uso exclusivo de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-107">After installing the package, the private assembly is available for the exclusive use of the application.</span></span> <span data-ttu-id="d5fa5-108">La dependencia del ensamblado que se especifica en el manifiesto de aplicación invalida (para esta aplicación) cualquier otra dependencia global de ensamblados que se especifica en los archivos de manifiesto del ensamblado.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-108">The assembly dependence that is specified in the application manifest overrides (for this application) any other global assembly dependencies that are specified in assembly manifest files.</span></span>

<span data-ttu-id="d5fa5-109">Antes de continuar, es una buena idea comprender cómo crear un paquete de Windows Installer sin ensamblados.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-109">Before you continue, it is a good idea to understand how to author a Windows Installer package without assemblies.</span></span> <span data-ttu-id="d5fa5-110">Para obtener más información, vea [un ejemplo de instalación](an-installation-example.md).</span><span class="sxs-lookup"><span data-stu-id="d5fa5-110">For more information, see [An Installation Example](an-installation-example.md).</span></span>

<span data-ttu-id="d5fa5-111">**Para instalar un ensamblado privado en Windows XP**</span><span class="sxs-lookup"><span data-stu-id="d5fa5-111">**To install a private assembly on Windows XP**</span></span>

1.  <span data-ttu-id="d5fa5-112">Defina un componente de Windows Installer que incluya el ensamblado Win32 y el archivo de manifiesto de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-112">Define a Windows Installer component that includes the Win32 assembly and the application manifest file.</span></span> <span data-ttu-id="d5fa5-113">Este componente puede contener otros recursos que se deben instalar o quitar siempre con el ensamblado.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-113">This component can contain other resources that should always be installed or removed with the assembly.</span></span> <span data-ttu-id="d5fa5-114">En los pasos restantes de este procedimiento se describe cómo crear la base de datos de instalación para instalar este componente.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-114">The remaining steps of this procedure describe how to author the installation database to install this component.</span></span>
2.  <span data-ttu-id="d5fa5-115">Agregue una fila a la [tabla de componentes](component-table.md) del componente que contiene el ensamblado de Win32 y el archivo de manifiesto de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-115">Add a row to the [Component table](component-table.md) for the component that contains the Win32 assembly and application manifest file.</span></span> <span data-ttu-id="d5fa5-116">Escriba un [GUID](guid.md) de Windows Installer válido para este código de componente.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-116">Enter a valid Windows Installer [GUID](guid.md) for this component code.</span></span> <span data-ttu-id="d5fa5-117">Para obtener más información, vea [cambiar el código de componente](changing-the-component-code.md) y [lo que sucede si se interrumpen las reglas de componentes](what-happens-if-the-component-rules-are-broken.md) .</span><span class="sxs-lookup"><span data-stu-id="d5fa5-117">For more information, see [Changing the Component Code](changing-the-component-code.md) and [What happens if the component rules are broken?](what-happens-if-the-component-rules-are-broken.md)</span></span>
3.  <span data-ttu-id="d5fa5-118">El instalador copia el archivo de manifiesto del ensamblado en la carpeta que contiene el archivo especificado en el \_ campo de la aplicación de archivo de la [tabla MsiAssembly](msiassembly-table.md).</span><span class="sxs-lookup"><span data-stu-id="d5fa5-118">The installer copies the assembly manifest file into the folder that contains the file specified in the File\_Application field of the [MsiAssembly table](msiassembly-table.md).</span></span>
4.  <span data-ttu-id="d5fa5-119">Agregue una fila a la [tabla FeatureComponents](featurecomponents-table.md) que asocia el componente a una característica Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-119">Add a row to the [FeatureComponents table](featurecomponents-table.md) tying the component to a Windows Installer feature.</span></span> <span data-ttu-id="d5fa5-120">Para obtener más información, vea [componentes y características](components-and-features.md).</span><span class="sxs-lookup"><span data-stu-id="d5fa5-120">For more information, see [Components and Features](components-and-features.md).</span></span> <span data-ttu-id="d5fa5-121">Una característica Windows Installer debe ser una parte de la funcionalidad de la aplicación que un usuario pueda reconocer.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-121">A Windows Installer feature should be a piece of the application functionality that a user can recognize.</span></span> <span data-ttu-id="d5fa5-122">El ensamblado se activa cuando el usuario selecciona esta característica o la aplicación produce un error.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-122">The assembly is activated when this feature is selected by a user or faulted in by an application.</span></span> <span data-ttu-id="d5fa5-123">Si el ensamblado define una característica adicional, agregue una fila adicional a la [tabla de características](feature-table.md) para los atributos de la característica.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-123">If the assembly defines an additional feature, then add an additional row to the [Feature table](feature-table.md) for the feature attributes.</span></span> <span data-ttu-id="d5fa5-124">Este paso no es necesario si se crea un módulo de combinación.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-124">This step is not required if authoring a merge module.</span></span>
5.  <span data-ttu-id="d5fa5-125">En el caso de los ensamblados en paralelo, la información de enlace y activación, por ejemplo, las clases COM, las interfaces y las bibliotecas de tipos, se almacena en archivos de manifiesto en lugar de en el registro.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-125">For side-by-side assemblies, binding and activation information, for example, COM classes, interfaces, and type libraries, is stored in manifest files rather than the registry.</span></span> <span data-ttu-id="d5fa5-126">Los ensamblados privados almacenan esta información en un manifiesto del ensamblado.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-126">Private assemblies store this information in an assembly manifest.</span></span> <span data-ttu-id="d5fa5-127">En los sistemas que admiten ensamblados en paralelo, el instalador omite el procesamiento de toda la información sobre el componente que se especifica en la [tabla de extensión](extension-table.md), la [tabla de verbos](verb-table.md), la [tabla typelib](typelib-table.md), la [tabla MIME](mime-table.md), la tabla de [clases](class-table.md), la [tabla ProgID](progid-table.md)y la [tabla AppID](appid-table.md).</span><span class="sxs-lookup"><span data-stu-id="d5fa5-127">On systems that support side-by-side assemblies, the installer skips processing any information about the component that is entered in the [Extension table](extension-table.md), [Verb table](verb-table.md), [TypeLib table](typelib-table.md), [MIME table](mime-table.md), [Class table](class-table.md), [ProgId table](progid-table.md), and [AppId table](appid-table.md).</span></span> <span data-ttu-id="d5fa5-128">La información de enlace y activación se puede incluir en las tablas para que las usen los sistemas que no admiten el uso compartido de ensamblados en paralelo.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-128">Binding and activation information can be entered into the tables for use by systems that do not support side-by-side assembly sharing.</span></span>
6.  <span data-ttu-id="d5fa5-129">La instalación en paralelo no registra el ensamblado globalmente.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-129">Side-by-side installation does not register the assembly globally.</span></span> <span data-ttu-id="d5fa5-130">El instalador omite el registro automático del componente si se especifica cualquier información de registro automático en la [tabla SelfReg](selfreg-table.md).</span><span class="sxs-lookup"><span data-stu-id="d5fa5-130">The installer skips self-registering the component if any self-registration information is entered in the [SelfReg table](selfreg-table.md).</span></span> <span data-ttu-id="d5fa5-131">La información de registro automático se puede escribir en la tabla SelfReg para el registro automático del componente en sistemas que no admiten el uso compartido de ensamblados en paralelo.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-131">Self-registration information can be entered into the SelfReg table for self-registration of the component on systems that do not support side-by-side assembly sharing.</span></span>
7.  <span data-ttu-id="d5fa5-132">Agregue cualquier otra información del registro, exclusiva del enlace y activación o el registro automático del componente, a la tabla [del registro](registry-table.md), la [tabla RemoveRegistry](removeregistry-table.md)y la [tabla de entorno](environment-table.md).</span><span class="sxs-lookup"><span data-stu-id="d5fa5-132">Add any other registry information, exclusive of binding and activation or self-registration of the component, to the [Registry table](registry-table.md), [RemoveRegistry table](removeregistry-table.md), and [Environment table](environment-table.md).</span></span>
8.  <span data-ttu-id="d5fa5-133">El instalador omite la [tabla IsolatedComponent](isolatedcomponent-table.md) para este componente en los sistemas operativos que admiten el uso compartido en paralelo.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-133">The installer skips the [IsolatedComponent table](isolatedcomponent-table.md) for this component on operating systems that support side-by-side sharing.</span></span> <span data-ttu-id="d5fa5-134">Escriba información en esta tabla si desea que el ensamblado sea privado en sistemas que admitan archivos locales.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-134">Enter information into this table if you want the assembly to be private on systems that support local files.</span></span>
9.  <span data-ttu-id="d5fa5-135">Agregue una fila a la [tabla MsiAssembly](msiassembly-table.md) para el componente que contiene el ensamblado Win32.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-135">Add a row to the [MsiAssembly table](msiassembly-table.md) for the component that contains the Win32 assembly.</span></span> <span data-ttu-id="d5fa5-136">Escriba un valor de 1 en el campo atributos de la tabla MsiAssembly para especificar que se trata de un ensamblado Win32.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-136">Enter a value of 1 in the Attributes field of the MsiAssembly table to specify that this is a Win32 assembly.</span></span> <span data-ttu-id="d5fa5-137">Escriba la clave de archivo del ensamblado privado en el \_ campo aplicación de archivo de la [tabla MsiAssembly](msiassembly-table.md).</span><span class="sxs-lookup"><span data-stu-id="d5fa5-137">Enter the file key of the private assembly in the File\_Application field of the [MsiAssembly table](msiassembly-table.md).</span></span> <span data-ttu-id="d5fa5-138">Agregue la [acción MsiPublishAssemblies](msipublishassemblies-action.md) a la [tabla InstallExecuteSequence](installexecutesequence-table.md) o a la [tabla AdvtExecuteSequence](advtexecutesequence-table.md).</span><span class="sxs-lookup"><span data-stu-id="d5fa5-138">Add the [MsiPublishAssemblies action](msipublishassemblies-action.md) to the [InstallExecuteSequence table](installexecutesequence-table.md) or [AdvtExecuteSequence table](advtexecutesequence-table.md).</span></span> <span data-ttu-id="d5fa5-139">Agregue la [acción MsiUnpublishAssemblies](msiunpublishassemblies-action.md) a la tabla InstallExecuteSequence.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-139">Add the [MsiUnpublishAssemblies action](msiunpublishassemblies-action.md) to the InstallExecuteSequence table.</span></span> <span data-ttu-id="d5fa5-140">Cree una carpeta para el archivo de ensamblado y de manifiesto en la [tabla de directorio](directory-table.md).</span><span class="sxs-lookup"><span data-stu-id="d5fa5-140">Author a folder for the assembly and manifest file into the [Directory table](directory-table.md).</span></span> <span data-ttu-id="d5fa5-141">Esta carpeta debe estar en el directorio raíz de la aplicación y contener el archivo especificado en el \_ campo aplicación de archivo de la [tabla MsiAssembly](msiassembly-table.md).</span><span class="sxs-lookup"><span data-stu-id="d5fa5-141">This folder should be in the application's root directory and contain the file specified in the File\_Application field of the [MsiAssembly table](msiassembly-table.md).</span></span> <span data-ttu-id="d5fa5-142">Durante la instalación de la aplicación, el instalador resuelve la tabla de [directorio](directory-table.md) de la ruta de acceso a esta carpeta.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-142">During the installation of the application, the installer resolves the [Directory table](directory-table.md) for the path to this folder.</span></span> <span data-ttu-id="d5fa5-143">Para obtener más información, consulte [uso de la tabla de directorios](using-the-directory-table.md).</span><span class="sxs-lookup"><span data-stu-id="d5fa5-143">For more information, see [Using the Directory Table](using-the-directory-table.md).</span></span>
10. <span data-ttu-id="d5fa5-144">Agregue filas a la [tabla MsiAssemblyName](msiassemblyname-table.md) para el componente.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-144">Add rows to the [MsiAssemblyName table](msiassemblyname-table.md) for the component.</span></span> <span data-ttu-id="d5fa5-145">Agregue una fila para cada par de nombre y valor especificado en la sección assemblyIdentity del manifiesto.</span><span class="sxs-lookup"><span data-stu-id="d5fa5-145">Add one row for each name and value pair specified in the assemblyIdentity section of the manifest.</span></span> <span data-ttu-id="d5fa5-146">Para obtener más información, consulte [tabla MsiAssemblyName](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="d5fa5-146">For more information, see [MsiAssemblyName table](msiassemblyname-table.md).</span></span>

 

 



