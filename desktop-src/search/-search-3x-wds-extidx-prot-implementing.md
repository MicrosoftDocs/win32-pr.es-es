---
description: Algunas aplicaciones almacenan sus elementos en bases de datos o tipos de archivo personalizados.
ms.assetid: 0e2b7b4b-ae87-4092-b924-6191cdf42c9b
title: Descripción de los controladores de protocolo
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 28c171c5790e47bbf624d9107a5ca5b3dc0b9fd4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "105705500"
---
# <a name="understanding-protocol-handlers"></a><span data-ttu-id="16333-103">Descripción de los controladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="16333-103">Understanding Protocol Handlers</span></span>

<span data-ttu-id="16333-104">Algunas aplicaciones almacenan sus elementos en bases de datos o tipos de archivo personalizados.</span><span class="sxs-lookup"><span data-stu-id="16333-104">Some applications store their items in databases or custom file types.</span></span> <span data-ttu-id="16333-105">Aunque Windows Search puede indizar el nombre y las propiedades del archivo, Windows no tiene ningún conocimiento del contenido del archivo.</span><span class="sxs-lookup"><span data-stu-id="16333-105">While Windows Search can index the name and properties of the file, Windows has no knowledge of the content of the file.</span></span> <span data-ttu-id="16333-106">Como resultado, estos elementos no se pueden indizar ni exponer en el shell de Windows.</span><span class="sxs-lookup"><span data-stu-id="16333-106">As a result, such items cannot be indexed or exposed in the Windows Shell.</span></span> <span data-ttu-id="16333-107">Al crear un controlador de protocolo, puede hacer que estos elementos estén disponibles para la indexación.</span><span class="sxs-lookup"><span data-stu-id="16333-107">By creating a protocol handler you can make these items available for indexing.</span></span> <span data-ttu-id="16333-108">También puede indexar un formato de archivo compuesto como un archivo. zip.</span><span class="sxs-lookup"><span data-stu-id="16333-108">You can also index a compound file format such as a .zip file.</span></span>

<span data-ttu-id="16333-109">Este tema se organiza de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="16333-109">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="16333-110">Indexación de almacenes de datos con controladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="16333-110">Indexing Data Stores with Protocol Handlers</span></span>](#indexing-data-stores-with-protocol-handlers)
    -   [<span data-ttu-id="16333-111">Almacenes de datos de Shell</span><span class="sxs-lookup"><span data-stu-id="16333-111">Shell Data Stores</span></span>](#shell-data-stores)
    -   [<span data-ttu-id="16333-112">Controladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="16333-112">Protocol Handlers</span></span>](#protocol-handlers)
    -   [<span data-ttu-id="16333-113">Filtros y controladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="16333-113">Filters and Protocol Handlers</span></span>](#filters-and-protocol-handlers)
-   [<span data-ttu-id="16333-114">Indexación de un formato de archivo compuesto</span><span class="sxs-lookup"><span data-stu-id="16333-114">Indexing a Compound File Format</span></span>](#indexing-a-compound-file-format)
-   [<span data-ttu-id="16333-115">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="16333-115">Related topics</span></span>](#related-topics)

## <a name="indexing-data-stores-with-protocol-handlers"></a><span data-ttu-id="16333-116">Indexación de almacenes de datos con controladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="16333-116">Indexing Data Stores with Protocol Handlers</span></span>

<span data-ttu-id="16333-117">Cuando los usuarios necesitan buscar bases de datos heredadas, almacenes de correo electrónico u otras estructuras de datos que no son compatibles con Windows Search, debe determinar primero si ya existe un controlador de protocolo para ese almacén de datos, quizás para su uso con otra aplicación como SharePoint Server.</span><span class="sxs-lookup"><span data-stu-id="16333-117">When users need to search legacy databases, email stores or other data structures that are not supported by Windows Search, you should first determine whether a protocol handler already exists for that data store, perhaps for use with another application such as SharePoint Server.</span></span> <span data-ttu-id="16333-118">Si es así, puede instalar el controlador de protocolo en el sistema.</span><span class="sxs-lookup"><span data-stu-id="16333-118">If so, you can install that protocol handler on the system.</span></span> <span data-ttu-id="16333-119">Los controladores de protocolo de Windows Search usan especificaciones de diseño similares a las de SharePoint Server y, a menudo, se pueden usar indistintamente.</span><span class="sxs-lookup"><span data-stu-id="16333-119">Windows Search protocol handlers use design specifications similar to SharePoint Server, and they can often be used interchangeably.</span></span>

<span data-ttu-id="16333-120">Para obtener más información acerca de la implementación de Search Server 2008 con Office SharePoint Server 2007, consulte servidor de búsqueda de búsqueda [federada \[ 2008 \] ](/previous-versions/office/bb931109(v=office.14)).</span><span class="sxs-lookup"><span data-stu-id="16333-120">For more information about Search Server 2008 deployment with Office SharePoint Server 2007, see [Federated Search \[Search Server 2008\]](/previous-versions/office/bb931109(v=office.14)).</span></span>

### <a name="shell-data-stores"></a><span data-ttu-id="16333-121">Almacenes de datos de Shell</span><span class="sxs-lookup"><span data-stu-id="16333-121">Shell Data Stores</span></span>

<span data-ttu-id="16333-122">Antes de que un desarrollador de terceros con nuevos formatos de archivo y almacenes de datos pueda obtener esos formatos y almacenes para que aparezcan en los resultados de la consulta en el explorador de Windows, el desarrollador debe implementar un origen de datos de Shell.</span><span class="sxs-lookup"><span data-stu-id="16333-122">Before a third-party developer of new file formats and data stores can get those formats and stores to appear in query results in Windows Explorer, the developer must implement a Shell data source.</span></span> <span data-ttu-id="16333-123">Un origen de datos de Shell es un componente que se utiliza para extender el espacio de nombres del shell y exponer los elementos de un almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="16333-123">A Shell data source is a component that is used to extend the Shell namespace and expose items in a data store.</span></span> <span data-ttu-id="16333-124">Un almacén de datos es un repositorio de datos.</span><span class="sxs-lookup"><span data-stu-id="16333-124">A data store is a repository of data.</span></span> <span data-ttu-id="16333-125">Un almacén de datos se puede exponer en el modelo de programación de shell como un contenedor que usa un origen de datos de Shell.</span><span class="sxs-lookup"><span data-stu-id="16333-125">A data store can be exposed to the Shell programming model as a container that uses a Shell data source.</span></span> <span data-ttu-id="16333-126">El sistema de Windows Search puede indizar los elementos de un almacén de datos mediante un controlador de protocolo.</span><span class="sxs-lookup"><span data-stu-id="16333-126">The items in a data store can be indexed by the Windows Search system using a protocol handler.</span></span> <span data-ttu-id="16333-127">El controlador de protocolo implementa el protocolo para tener acceso a un origen de contenido en su formato nativo.</span><span class="sxs-lookup"><span data-stu-id="16333-127">The protocol handler implements the protocol for accessing a content source in its native format.</span></span> <span data-ttu-id="16333-128">Las interfaces [**ISearchProtocol**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol) y [**ISearchProtocol2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol2) se usan para implementar un controlador de protocolo personalizado para expandir los orígenes de datos que se pueden indizar.</span><span class="sxs-lookup"><span data-stu-id="16333-128">The [**ISearchProtocol**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol) and [**ISearchProtocol2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol2) interfaces are used to implement a custom protocol handler to expand the data sources that can be indexed.</span></span>

<span data-ttu-id="16333-129">Si desea que los resultados de la consulta aparezcan en el explorador de Windows, debe implementar un origen de datos de Shell antes de poder crear un controlador de protocolo para extender el índice.</span><span class="sxs-lookup"><span data-stu-id="16333-129">If you want the query results to appear in Windows Explorer, you must implement a Shell data source before you can create a protocol handler to extend the index.</span></span> <span data-ttu-id="16333-130">Sin embargo, si todas las consultas se realizarán mediante programación (a través de OLE DB por ejemplo) e interpretadas por el código de la aplicación en lugar del shell, no es estrictamente necesario un espacio de nombres de Shell que se prefiera todavía.</span><span class="sxs-lookup"><span data-stu-id="16333-130">However, if all queries will be programmatic (through OLE DB for example) and interpreted by the application's code rather than the Shell, a Shell namespace while still preferred is not strictly required.</span></span>

> [!Note]  
> <span data-ttu-id="16333-131">Un origen de datos de Shell a veces se conoce como una extensión de espacio de nombres de Shell.</span><span class="sxs-lookup"><span data-stu-id="16333-131">A Shell data source is sometimes known as a Shell namespace extension.</span></span> <span data-ttu-id="16333-132">Un controlador a veces se conoce como una extensión de shell o un controlador de extensión de Shell.</span><span class="sxs-lookup"><span data-stu-id="16333-132">A handler is sometimes known as a Shell extension or a Shell extension handler.</span></span>

 

<span data-ttu-id="16333-133">Si desea que los usuarios vean los resultados de la búsqueda desde el explorador de Windows, debe crear un controlador de protocolo y uno o varios de los siguientes complementos:</span><span class="sxs-lookup"><span data-stu-id="16333-133">If you want users to view their search results from within Windows Explorer, then you must create a protocol handler and one or more of the following add-ins:</span></span>

-   <span data-ttu-id="16333-134">Controlador del menú contextual</span><span class="sxs-lookup"><span data-stu-id="16333-134">Shortcut menu handler</span></span>
-   <span data-ttu-id="16333-135">Controlador de iconos</span><span class="sxs-lookup"><span data-stu-id="16333-135">Icon handler</span></span>
-   <span data-ttu-id="16333-136">Otro tipo de controlador de archivos</span><span class="sxs-lookup"><span data-stu-id="16333-136">Some other type of file handler</span></span>

<span data-ttu-id="16333-137">Para obtener una lista de los controladores identificados por el escenario de desarrollador que está intentando conseguir, vea "información general de los controladores" en [Windows Search como plataforma de desarrollo](-search-3x-wds-development-ovr.md).</span><span class="sxs-lookup"><span data-stu-id="16333-137">For a list of handlers identified by the developer scenario you are trying to achieve, see "Overview of Handlers" in [Windows Search as a Development Platform](-search-3x-wds-development-ovr.md).</span></span> <span data-ttu-id="16333-138">Para obtener información sobre cómo crear controladores, vea [registrar extensiones de Shell](../shell/reg-shell-exts.md), [menú contextual](/previous-versions/windows/desktop/legacy/cc144169(v=vs.85))y [controladores de tipo de archivo](../shell/fa-file-extensions.md).</span><span class="sxs-lookup"><span data-stu-id="16333-138">For information on creating handlers, see [Registering Shell Extensions](../shell/reg-shell-exts.md), [Context Menu](/previous-versions/windows/desktop/legacy/cc144169(v=vs.85)), and [File Type Handlers](../shell/fa-file-extensions.md).</span></span>

### <a name="protocol-handlers"></a><span data-ttu-id="16333-139">Controladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="16333-139">Protocol Handlers</span></span>

<span data-ttu-id="16333-140">Si el almacén de datos también es un contenedor (por ejemplo, una carpeta del sistema de archivos), debe implementar un filtro para enumerar las direcciones URL del contenedor.</span><span class="sxs-lookup"><span data-stu-id="16333-140">If the data store is also a container (such as a file system folder), you must implement a filter to enumerate the URLs in the container.</span></span> <span data-ttu-id="16333-141">Si el almacén de datos contiene datos o tipos de archivo distintos de uno de los tipos de archivo 200 que admite Windows Search, debe implementar un filtro para obtener acceso al contenido de los elementos del almacén e indexarlo.</span><span class="sxs-lookup"><span data-stu-id="16333-141">If the data store contains data or file types other than one of the 200 file types supported by Windows Search, you must implement a filter to access and index the contents of items in the store.</span></span> <span data-ttu-id="16333-142">Windows Search usa el controlador de protocolo y la tecnología de [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) similar a la usada por SharePoint Server.</span><span class="sxs-lookup"><span data-stu-id="16333-142">Windows Search uses protocol handler and [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) technology similar to that used by SharePoint Server.</span></span> <span data-ttu-id="16333-143">Si ya tiene filtros para un almacén específico y un tipo de archivo instalados en el sistema que se está indizando, es posible que Windows Search pueda usar las interfaces existentes para indizar estos datos.</span><span class="sxs-lookup"><span data-stu-id="16333-143">If you already have filters for a specific store and file type installed on the system being indexed, Windows Search may be able to use the existing interfaces to index this data.</span></span>

<span data-ttu-id="16333-144">Para obtener información general sobre el proceso de indización, vea [el proceso de indización](-search-indexing-process-overview.md).</span><span class="sxs-lookup"><span data-stu-id="16333-144">For an overview of the indexing process, see [The Indexing Process](-search-indexing-process-overview.md).</span></span> <span data-ttu-id="16333-145">Para obtener información conceptual sobre los controladores de filtro, vea [desarrollar controladores de filtro](-search-ifilter-conceptual.md).</span><span class="sxs-lookup"><span data-stu-id="16333-145">For conceptual information on filter handlers, see [Developing Filter Handlers](-search-ifilter-conceptual.md).</span></span>

### <a name="filters-and-protocol-handlers"></a><span data-ttu-id="16333-146">Filtros y controladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="16333-146">Filters and Protocol Handlers</span></span>

<span data-ttu-id="16333-147">Los controladores de protocolo proporcionan al indizador de Windows Search acceso a los almacenes de datos, lo que permite que el indexador Rastree los nodos de un almacén de datos y extraiga información relevante para el índice.</span><span class="sxs-lookup"><span data-stu-id="16333-147">Protocol handlers give the Windows Search indexer access to data stores, enabling the indexer to crawl the nodes of a data store and extract relevant information to index.</span></span> <span data-ttu-id="16333-148">Windows Search, por ejemplo, se suministra con controladores de protocolo para almacenes del sistema de archivos y para algunas versiones de ambos almacenes de datos de Microsoft Outlook.</span><span class="sxs-lookup"><span data-stu-id="16333-148">Windows Search, for example, ships with protocol handlers for file system stores and for some versions of both Microsoft Outlook data stores.</span></span> <span data-ttu-id="16333-149">Al indizar el correo electrónico de Outlook, el controlador de protocolo rastrea todos los mensajes de un conjunto de carpetas de Outlook y extrae información de cada mensaje y datos adjuntos.</span><span class="sxs-lookup"><span data-stu-id="16333-149">When indexing Outlook email, the protocol handler crawls all messages in a set of Outlook folders and extracts information from each message and attachment.</span></span> <span data-ttu-id="16333-150">Esta información se pasa al indexador para su inclusión en el catálogo de Windows Search.</span><span class="sxs-lookup"><span data-stu-id="16333-150">This information is passed to the indexer for inclusion in the Windows Search catalog.</span></span>

<span data-ttu-id="16333-151">Para obtener información general sobre el administrador de catálogos y el administrador de ámbito de rastreo (CSM), consulte [usar el administrador de catálogos](-search-3x-wds-mngidx-catalog-manager.md) y [el administrador de ámbito de rastreo](-search-3x-wds-extidx-csm.md).</span><span class="sxs-lookup"><span data-stu-id="16333-151">For overviews of the Catalog Manager and Crawl Scope Manager (CSM), see [Using the Catalog Manager](-search-3x-wds-mngidx-catalog-manager.md) and [Using the Crawl Scope Manager](-search-3x-wds-extidx-csm.md).</span></span>

## <a name="indexing-a-compound-file-format"></a><span data-ttu-id="16333-152">Indexación de un formato de archivo compuesto</span><span class="sxs-lookup"><span data-stu-id="16333-152">Indexing a Compound File Format</span></span>

<span data-ttu-id="16333-153">Un formato de archivo compuesto se puede indizar para que los elementos individuales del archivo puedan devolverse como resultados individuales.</span><span class="sxs-lookup"><span data-stu-id="16333-153">A compound file format can be indexed so that individual items in the file can can be returned as individual results.</span></span> <span data-ttu-id="16333-154">Un formato de archivo compuesto, como un archivo comprimido con la extensión de nombre de archivo. zip, es esencialmente un almacén de datos y se puede tratar como tal para fines de indexación.</span><span class="sxs-lookup"><span data-stu-id="16333-154">A compound file format such as a compressed file with a .zip file name extension is essentially a data store and can be treated as such for indexing purposes.</span></span> <span data-ttu-id="16333-155">En el ejemplo siguiente se muestra un archivo. zip en el espacio de nombres del sistema de archivos (FILE://c:/test/test.zip) en el que hay subcarpetas y elementos individuales.</span><span class="sxs-lookup"><span data-stu-id="16333-155">The following example displays a .zip file in the file system namespace (FILE://c:/test/test.zip) in which there are both subfolders and individual items.</span></span>

``` syntax
Test.zip 

    |-folder1 

    |    |-folder2 

    |           |- FileX.txt 

    |- FileY.doc
```

<span data-ttu-id="16333-156">El controlador de protocolo de archivo detecta cuándo FILE://c:/test/test.zip los cambios mediante la supervisión de los registros de cambios del sistema de archivos e invocará un [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) registrado para los archivos. zip en ese archivo cuando cambie el archivo, pero no tiene conocimiento de la estructura interna del archivo. zip.</span><span class="sxs-lookup"><span data-stu-id="16333-156">The FILE protocol handler discovers when FILE://c:/test/test.zip changes by monitoring file system change logs, and it will invoke an [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) registered for .zip files on that file when the file changes, but it has no knowledge of the internal structure of the .zip file itself.</span></span>

<span data-ttu-id="16333-157">Debe informar al indexador de que el formato de archivo compuesto es un almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="16333-157">You must inform the indexer that the compound file format is a data store.</span></span> <span data-ttu-id="16333-158">Es necesario hacerlo para los elementos individuales que se van a indizar y recuperar como entidades únicas.</span><span class="sxs-lookup"><span data-stu-id="16333-158">It is necessary to do so for individual items to be indexed and retrieved as unique entities.</span></span> <span data-ttu-id="16333-159">Después de haber implementado un origen de datos de Shell y realizado los pasos siguientes, tendrá un controlador de protocolo que puede procesar y exponer los datos de un formato de archivo compuesto (archivo. zip) como elementos individuales.</span><span class="sxs-lookup"><span data-stu-id="16333-159">After you have implemented a Shell data source and performed the following steps, you will have a protocol handler that can process and expose the data from a compound file format (a .zip file) as individual items.</span></span>

<span data-ttu-id="16333-160">**Para informar al indizador de que un archivo compuesto es un almacén de datos:**</span><span class="sxs-lookup"><span data-stu-id="16333-160">**To inform the indexer that a compound file is a data store:**</span></span>

1.  <span data-ttu-id="16333-161">Cree un controlador de protocolo (mediante [**ISearchProtocol**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol) o [**ISearchProtocol2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol2)) para los archivos. zip que tienen la capacidad de enlazar con el archivo de código fuente.</span><span class="sxs-lookup"><span data-stu-id="16333-161">Create a protocol handler (using [**ISearchProtocol**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol) or [**ISearchProtocol2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol2)) for .zip files that has the ability bind to the source file.</span></span> <span data-ttu-id="16333-162">Para obtener más información, vea [instalar y registrar controladores de protocolo](-search-3x-wds-ph-install-registration.md).</span><span class="sxs-lookup"><span data-stu-id="16333-162">For more information, see [Installing and Registering Protocol Handlers](-search-3x-wds-ph-install-registration.md).</span></span>

    <span data-ttu-id="16333-163">Por ejemplo, puede usar una ruta de acceso con escape al archivo. zip como el nombre de la carpeta raíz y, a continuación, usar una sintaxis de jerarquía como cualquier otro formato de archivo.</span><span class="sxs-lookup"><span data-stu-id="16333-163">For example, you could use an escaped path to the .zip file as the root folder name and then use a hierarchy syntax like any other file format.</span></span>

    ``` syntax
    .zip:///escapedPathTo.zipFile/.zipfolder/.../.zipfile
    ```

    <span data-ttu-id="16333-164">Con los datos de ejemplo anteriores de c: \\ test \\test.zip, las direcciones URL únicas serían las siguientes.</span><span class="sxs-lookup"><span data-stu-id="16333-164">Using the above sample data for c:\\test\\test.zip, the unique URLs would be as follows.</span></span> <span data-ttu-id="16333-165">Con estas direcciones URL, el controlador de protocolo tiene la información necesaria para enlazar con el archivo. zip y enumerar las direcciones URL secundarias, incluidos los archivos internos, para que se puedan enlazar y indexar mediante los filtros. doc y. txt.</span><span class="sxs-lookup"><span data-stu-id="16333-165">With these URLs the protocol handler has the information necessary to bind to the .zip file and enumerate the child URLs including the inner files so that they can be bound to and indexed by the .doc and .txt filters.</span></span>

    ``` syntax
      

    .zip:///FILE:%2f%2f%2fc:%2ftest%2ftest.zip/ 

    .zip:///FILE:%2f%2f%2fc:%2ftest%2ftest.zip/FileY.Doc 

    .zip:///FILE:%2f%2f%2fc:%2ftest%2ftest.zip/folder1 

    .zip:///FILE:%2f%2f%2fc:%2ftest%2ftest.zip/folder1/folder2 

    .zip:///FILE:%2f%2f%2fc:%2ftest%2ftest.zip/folder1/folder2/FileX.txt
    ```

2.  <span data-ttu-id="16333-166">Asegúrese de que el controlador de protocolo cumple las dos condiciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="16333-166">Ensure that your protocol handler meets the following two conditions:</span></span>
    -   <span data-ttu-id="16333-167">Las direcciones URL raíz de un archivo. zip deben emitir PKEY \_ Search \_ IsClosedDirectory ([System. Search. IsClosedDirectory](../properties/props-system-search-iscloseddirectory.md)) en las direcciones URL que son las direcciones URL del archivo. zip raíz.</span><span class="sxs-lookup"><span data-stu-id="16333-167">The root URLs for a .zip file should emit PKEY\_Search\_IsClosedDirectory ([System.Search.IsClosedDirectory](../properties/props-system-search-iscloseddirectory.md)) on the URLs that are the root .zip file URLs.</span></span> <span data-ttu-id="16333-168">Por ejemplo,. zip:///FILE:%2f%2f%2fc:%2ftest% 2ftest.zip/debe emitir IsClosedDirectory = **true**.</span><span class="sxs-lookup"><span data-stu-id="16333-168">For example, .zip:///FILE:%2f%2f%2fc:%2ftest%2ftest.zip/ should emit IsClosedDirectory = **TRUE**.</span></span> <span data-ttu-id="16333-169">Esto indica al indizador que, si la fecha de esta dirección URL no ha cambiado, no necesita procesar ninguna de las direcciones URL secundarias.</span><span class="sxs-lookup"><span data-stu-id="16333-169">This tells the indexer that if the date on this URL has not changed, it does not need to process any of the child URLs.</span></span>
    -   <span data-ttu-id="16333-170">Cada dirección URL secundaria de esa dirección URL debe emitir PKEY \_ Search \_ IsFullyContained ([System. Search. IsFullyContained](../properties/props-system-search-isfullycontained.md)) en las direcciones URL secundarias de la dirección URL raíz. zip.</span><span class="sxs-lookup"><span data-stu-id="16333-170">Every child URL for that URL should emit PKEY\_Search\_IsFullyContained ([System.Search.IsFullyContained](../properties/props-system-search-isfullycontained.md)) on the child URLs of the root .zip URL.</span></span> <span data-ttu-id="16333-171">Normalmente, al final de un rastreo incremental, el indexador trata todas las direcciones URL no visitadas como elementos que deben eliminarse.</span><span class="sxs-lookup"><span data-stu-id="16333-171">Normally at the end of an incremental crawl, the indexer treats all unvisited URLs as items that should be deleted.</span></span> <span data-ttu-id="16333-172">Pero el archivo. zip raíz no debe procesar las direcciones URL raíz porque no ha cambiado nada.</span><span class="sxs-lookup"><span data-stu-id="16333-172">But the root .zip file should not process root URLs because nothing has changed.</span></span> <span data-ttu-id="16333-173">Al emitir esta propiedad como **true** , se indica al indizador que si esta dirección URL no se ha procesado al final de un rastreo incremental, no se debe eliminar.</span><span class="sxs-lookup"><span data-stu-id="16333-173">Emitting this property as **TRUE** tells the indexer that if this URL has not been processed at the end of an incremental crawl, it should not be deleted.</span></span> <span data-ttu-id="16333-174">Solo se eliminará si el elemento raíz ha cambiado y no se ha visitado.</span><span class="sxs-lookup"><span data-stu-id="16333-174">It will only be deleted if the root item has changed and it is not visited.</span></span>

<span data-ttu-id="16333-175">Windows Search requiere una página de inicio para un protocolo con el fin de saber qué direcciones URL rastrearán de forma incremental y qué direcciones URL se deben omitir cuando se encuentren.</span><span class="sxs-lookup"><span data-stu-id="16333-175">Windows Search requires a start page for a protocol in order to know what URLs to crawl incrementally and which URLs should be ignored when they are found.</span></span> <span data-ttu-id="16333-176">Pero no podemos empezar con una dirección URL para cada archivo. zip, porque no sabemos dónde está cada archivo. zip.</span><span class="sxs-lookup"><span data-stu-id="16333-176">But we can't start with a URL for each .zip file, because we don't know where each .zip file is.</span></span> <span data-ttu-id="16333-177">Por lo tanto, la dirección URL de la página de inicio del controlador del protocolo. zip debe ser capaz de enumerar todo en la raíz de las rutas de acceso de escape de todos los archivos. zip.</span><span class="sxs-lookup"><span data-stu-id="16333-177">Hence, the .zip protocol handler's start page URL must be able to enumerate everything at the root of the escaped paths of all of the .zip files.</span></span> <span data-ttu-id="16333-178">Estos archivos. zip no tienen por qué estar en el espacio de nombres FILE: y podrían ser una dirección URL de tipo MAPI que apunte a un archivo. zip como datos adjuntos, por ejemplo.</span><span class="sxs-lookup"><span data-stu-id="16333-178">Those .zip files are not necessarily in the FILE: namespace and could be a MAPI type URL that points to a .zip file as an attachment, for example.</span></span>

<span data-ttu-id="16333-179">**Para registrar una raíz como página de Inicio:**</span><span class="sxs-lookup"><span data-stu-id="16333-179">**To register a root as a start page:**</span></span>

1.  <span data-ttu-id="16333-180">Registre una raíz como. zip:///como página de inicio para que todos los archivos. zip se inicien allí, en efecto.</span><span class="sxs-lookup"><span data-stu-id="16333-180">Register a root such as .zip:/// as a start page so that all .zip files start there, in effect.</span></span> <span data-ttu-id="16333-181">Al procesar el archivo root. zip: URL, el controlador de protocolo debe generar la lista de direcciones URL secundarias que se van a emitir consultando en Windows Search todas las direcciones URL con System. FileExtension = ". zip".</span><span class="sxs-lookup"><span data-stu-id="16333-181">When processing the root .zip: URL, your protocol handler should generate the list of child URLs to emit by querying Windows Search for all of the URLs with System.FileExtension = ".zip".</span></span>
2.  <span data-ttu-id="16333-182">Escapa a esas direcciones URL para quitar las barras diagonales y devolverlas como direcciones URL secundarias.</span><span class="sxs-lookup"><span data-stu-id="16333-182">Escape those URLs to remove the slashes and return them as child URLs.</span></span> <span data-ttu-id="16333-183">Una consulta de ejemplo para recuperar los tipos que desea podría tener el aspecto siguiente.</span><span class="sxs-lookup"><span data-stu-id="16333-183">An example query to retrieve the types you want might look as follows.</span></span>

    ``` syntax
    SELECT system.itemurl, System.DateModified FROM SystemIndex 
    WHERE System.FileExtension='.zip' OR System.MimeType='mimetypefor.zip'
    ```

3.  <span data-ttu-id="16333-184">Cuando Windows Search realiza periódicamente un rastreo incremental en la dirección URL raíz de. zip:///, debe reflejar la lista de direcciones URL que la búsqueda de Windows ya está manteniendo y que son direcciones URL. zip.</span><span class="sxs-lookup"><span data-stu-id="16333-184">When Windows Search periodically does an incremental crawl on your .zip:/// root URL, you must reflect back the list of URLs that Windows Search is already maintaining that are .zip URLs.</span></span> <span data-ttu-id="16333-185">Si se detecta una eliminación en el almacén nativo donde se almacena el archivo. zip, no aparece en la enumeración y se quita esa rama del árbol del archivo. zip.</span><span class="sxs-lookup"><span data-stu-id="16333-185">If a deletion is discovered in the native store where the .zip file is stored, it does not appear in your enumeration, and that branch of the tree in the .zip is removed.</span></span>
4.  <span data-ttu-id="16333-186">Para enlazar con los datos. zip de otro controlador de protocolo, lo ideal es pasar por el [IShellFolder](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) de esa dirección URL para enlazar con el almacenamiento del objeto y no suponer que siempre es un archivo.</span><span class="sxs-lookup"><span data-stu-id="16333-186">To bind to the .zip data for another protocol handler, you should ideally go through the [IShellFolder](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) for that URL to bind to the storage of the object, and not assume it is always a file.</span></span> <span data-ttu-id="16333-187">Esto le ofrece la flexibilidad de trabajar con datos adjuntos en almacenes de correo electrónico, por ejemplo.</span><span class="sxs-lookup"><span data-stu-id="16333-187">Doing so affords you the flexibility to work with attachments in mail stores, for example.</span></span>
5.  <span data-ttu-id="16333-188">Cuando se emiten direcciones URL secundarias para cada archivo. zip, se debe usar PKEY \_ Search \_ UrlToIndexWithModificationTime ([System. Search. UrlToIndexWithModificationTime](../properties/props-system-search-urltoindexwithmodificationtime.md)) para pasar PKEY \_ DateModified ([System. DateModified](../properties/props-system-datemodified.md)) del archivo. zip real para que el indexador rastree el archivo. zip solo si ha cambiado.</span><span class="sxs-lookup"><span data-stu-id="16333-188">When emitting child URLs for each .zip file, you should use PKEY\_Search\_UrlToIndexWithModificationTime ([System.Search.UrlToIndexWithModificationTime](../properties/props-system-search-urltoindexwithmodificationtime.md)) to pass PKEY\_DateModified ([System.DateModified](../properties/props-system-datemodified.md)) of the actual .zip file so that the indexer crawls the .zip file only if it has changed.</span></span>

<span data-ttu-id="16333-189">Para que las direcciones URL. zip se indexen inmediatamente después de que se creen o modifiquen, y no tengan que esperar un rastreo incremental para detectar su nuevo estado, podría supervisar el sistema de archivos por sí mismo para los cambios en el archivo. zip.</span><span class="sxs-lookup"><span data-stu-id="16333-189">To have your .zip URLs indexed immediately after they are created or modified, and not have to wait for an incremental crawl to discover their new state, you could conceivably monitor the file system yourself for .zip file changes.</span></span> <span data-ttu-id="16333-190">Sin embargo, este enfoque no funcionaría en otros almacenes de datos como MAPI.</span><span class="sxs-lookup"><span data-stu-id="16333-190">However, such an approach would not work for other data stores such as MAPI.</span></span>

<span data-ttu-id="16333-191">**Para que las direcciones URL de. zip se indexen cuando se crean o modifican:**</span><span class="sxs-lookup"><span data-stu-id="16333-191">**To have your .zip urls indexed when they are created or modified:**</span></span>

1.  <span data-ttu-id="16333-192">Cree un filtro (y la implementación de la interfaz de [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) ) para el tipo de archivo. zip.</span><span class="sxs-lookup"><span data-stu-id="16333-192">Create a filter (and implementation of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface) for the .zip file type.</span></span> <span data-ttu-id="16333-193">Para obtener más información, vea [desarrollar controladores de propiedades para Windows Search](-search-3x-wds-extidx-propertyhandlers.md).</span><span class="sxs-lookup"><span data-stu-id="16333-193">For more information, see [Developing Property Handlers for Windows Search](-search-3x-wds-extidx-propertyhandlers.md).</span></span>
2.  <span data-ttu-id="16333-194">Cada vez que se llama a la implementación de [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) , se debe a que se ha detectado o modificado esa dirección URL.</span><span class="sxs-lookup"><span data-stu-id="16333-194">Whenever your [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) implementation is called, it is because that URL has been discovered or changed.</span></span> <span data-ttu-id="16333-195">A continuación, genere un evento para la dirección URL. zip correspondiente a la dirección URL de origen, a través de la interfaz [**IGatherNotifyInline**](/previous-versions/windows/desktop/legacy/bb231470(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="16333-195">Then, generate an event for the .zip URL appropriate for the source URL, through the [**IGatherNotifyInline**](/previous-versions/windows/desktop/legacy/bb231470(v=vs.85)) interface.</span></span> <span data-ttu-id="16333-196">Esto le ofrece la posibilidad de indicar inmediatamente al indexador que hay nuevos datos que se van a indizar sin tener que esperar al rastreo incremental.</span><span class="sxs-lookup"><span data-stu-id="16333-196">Doing so gives you the ability to immediately tell the indexer that there is new data to be indexed without having to wait for the incremental crawl.</span></span>

## <a name="related-topics"></a><span data-ttu-id="16333-197">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="16333-197">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="16333-198">Desarrollar controladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="16333-198">Developing Protocol Handlers</span></span>](-search-3x-wds-phaddins.md)
</dt> <dt>

[<span data-ttu-id="16333-199">Instalar y registrar controladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="16333-199">Installing and Registering Protocol Handlers</span></span>](-search-3x-wds-ph-install-registration.md)
</dt> <dt>

[<span data-ttu-id="16333-200">Notificar el índice de cambios</span><span class="sxs-lookup"><span data-stu-id="16333-200">Notifying the Index of Changes</span></span>](-search-3x-wds-notifyingofchanges.md)
</dt> <dt>

[<span data-ttu-id="16333-201">Agregar iconos y menús contextuales</span><span class="sxs-lookup"><span data-stu-id="16333-201">Adding Icons and Context Menus</span></span>](-search-3x-wds-ph-ui-extensions.md)
</dt> <dt>

[<span data-ttu-id="16333-202">Código de ejemplo: extensiones de Shell para controladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="16333-202">Code Sample: Shell Extensions for Protocol Handlers</span></span>](-search-3x-wds-ph-ui-samplecode.md)
</dt> <dt>

[<span data-ttu-id="16333-203">Instalar y registrar controladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="16333-203">Installing and Registering Protocol Handlers</span></span>](-search-3x-wds-ph-install-registration.md)
</dt> <dt>

[<span data-ttu-id="16333-204">Crear un conector de búsqueda para un controlador de protocolo</span><span class="sxs-lookup"><span data-stu-id="16333-204">Creating a Search Connector for a Protocol Handler</span></span>](-search-3x-wds-ph-search-connector.md)
</dt> <dt>

[<span data-ttu-id="16333-205">Controladores de protocolo de depuración</span><span class="sxs-lookup"><span data-stu-id="16333-205">Debugging Protocol Handlers</span></span>](-search-ws-protocolhandlertesting.md)
</dt> </dl>

 

 
