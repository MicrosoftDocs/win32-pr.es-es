---
description: La interfaz IXpsOMPackageWriter crea un archivo de documento XPS en el que las aplicaciones pueden escribir el contenido de las interfaces IXpsOMPage de un OM XPS.
ms.assetid: eff1ab1e-2205-4f5c-9e32-199e073f5dbf
title: Uso de la interfaz IXpsOMPackageWriter
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f1e8a34a0538ff09cc050ac287d5314be93f0da8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "105707007"
---
# <a name="using-the-ixpsompackagewriter-interface"></a><span data-ttu-id="ea544-103">Uso de la interfaz IXpsOMPackageWriter</span><span class="sxs-lookup"><span data-stu-id="ea544-103">Using the IXpsOMPackageWriter Interface</span></span>

<span data-ttu-id="ea544-104">La interfaz [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) crea un archivo de documento XPS en el que las aplicaciones pueden escribir el contenido de las interfaces [**IXPSOMPAGE**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) de un OM XPS.</span><span class="sxs-lookup"><span data-stu-id="ea544-104">The [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface creates an XPS document file into which applications can write the contents of the [**IXpsOMPage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) interfaces of an XPS OM.</span></span> <span data-ttu-id="ea544-105">La interfaz [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) es muy útil cuando el contenido del documento se está procesando o creando secuencialmente.</span><span class="sxs-lookup"><span data-stu-id="ea544-105">The [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface is most useful when document contents are being processed or created sequentially.</span></span> <span data-ttu-id="ea544-106">A diferencia de los métodos [**WriteToFile**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackage-writetofile) y [**WriteToStream**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackage-writetostream) de la interfaz [**IXpsOMPackage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackage) , para que se use la interfaz **IXpsOMPackageWriter** no se debe finalizar el FixedDocument completo ni la FixedDocumentSequence.</span><span class="sxs-lookup"><span data-stu-id="ea544-106">Unlike the [**WriteToFile**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackage-writetofile) and [**WriteToStream**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackage-writetostream) methods of the [**IXpsOMPackage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackage) interface, for the **IXpsOMPackageWriter** interface to be used neither the entire FixedDocument nor the FixedDocumentSequence has to be finished.</span></span>

## <a name="overview"></a><span data-ttu-id="ea544-107">Información general</span><span class="sxs-lookup"><span data-stu-id="ea544-107">Overview</span></span>

<span data-ttu-id="ea544-108">La interfaz [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) escribe una página a la vez, desde la primera página de un documento XPS hasta el último.</span><span class="sxs-lookup"><span data-stu-id="ea544-108">The [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface writes one page at a time, from the first page of an XPS document to the last.</span></span> <span data-ttu-id="ea544-109">La interfaz se puede utilizar para crear archivos de documento XPS sencillos y también archivos de documento XPS complejos que contienen más de un FixedDocument en la FixedDocumentSequence.</span><span class="sxs-lookup"><span data-stu-id="ea544-109">The interface can be used to create simple XPS document files and also complex XPS document files that contain more than one FixedDocument in the FixedDocumentSequence.</span></span> <span data-ttu-id="ea544-110">En los archivos de documento XPS complejos, los FixedDocuments también se crean secuencialmente, empezando por el primer FixedDocument de la FixedDocumentSequence.</span><span class="sxs-lookup"><span data-stu-id="ea544-110">In complex XPS document files, the FixedDocuments are also created in sequence, starting with the first FixedDocument in the FixedDocumentSequence.</span></span> <span data-ttu-id="ea544-111">La interfaz **IXpsOMPackageWriter** no admite la creación de contenido de documento en orden aleatorio.</span><span class="sxs-lookup"><span data-stu-id="ea544-111">The **IXpsOMPackageWriter** interface does not support the creation of document contents in random order.</span></span> <span data-ttu-id="ea544-112">Úselo, por ejemplo, para crear un informe secuencial o para realizar el procesamiento en un filtro de controlador de dispositivo en el que el contenido del documento se introduce en la secuencia.</span><span class="sxs-lookup"><span data-stu-id="ea544-112">Use it, for example, to create a sequential report or to perform processing in a device driver filter where the document contents are fed to the driver in sequence.</span></span>

## <a name="terminology-review"></a><span data-ttu-id="ea544-113">Revisión de la terminología</span><span class="sxs-lookup"><span data-stu-id="ea544-113">Terminology Review</span></span>

<span data-ttu-id="ea544-114">Un *archivo de documento XPS* es un paquete de convenciones de empaquetado abierto (OPC) que se ajusta a la especificación de papel XML.</span><span class="sxs-lookup"><span data-stu-id="ea544-114">An *XPS document file* is an Open Packaging Conventions (OPC) package that conforms to the XML Paper Specification.</span></span> <span data-ttu-id="ea544-115">Por lo tanto, técnicamente, la interfaz [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) crea un *paquete OPC*, pero es un paquete OPC que se ajusta a la especificación de papel XML.</span><span class="sxs-lookup"><span data-stu-id="ea544-115">So, technically, the [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface creates an *OPC package*, but it is an OPC package that conforms to the XML Paper Specification.</span></span> <span data-ttu-id="ea544-116">Por esta razón, en las discusiones sobre los documentos XPS, los términos documento y *Paquete* de *XPS* suelen usarse indistintamente.</span><span class="sxs-lookup"><span data-stu-id="ea544-116">For this reason, in discussions about XPS documents, the terms *XPS document* and *package* are often used interchangeably.</span></span>

<span data-ttu-id="ea544-117">El *paquete* creado por la interfaz [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) contendrá los componentes de documento XPS necesarios: una FixedDocumentSequence, al menos un FixedDocument, y al menos un FixedPage.</span><span class="sxs-lookup"><span data-stu-id="ea544-117">The *package* created by the [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface will contain the required XPS document components: a FixedDocumentSequence, at least one FixedDocument, and at least one FixedPage.</span></span> <span data-ttu-id="ea544-118">La FixedDocumentSequence se crea cuando se crea una instancia de la interfaz **IXpsOMPackageWriter** .</span><span class="sxs-lookup"><span data-stu-id="ea544-118">The FixedDocumentSequence is created when the **IXpsOMPackageWriter** interface is instantiated.</span></span> <span data-ttu-id="ea544-119">Se crea un FixedDocument cada vez que se llama a [**IXpsOMPackageWriter:: StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument) y se crea un FixedPage cada vez que se llama a [**IXpsOMPackageWriter:: AddPage**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-addpage) .</span><span class="sxs-lookup"><span data-stu-id="ea544-119">A FixedDocument is created every time [**IXpsOMPackageWriter::StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument) is called, and a FixedPage is created every time [**IXpsOMPackageWriter::AddPage**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-addpage) is called.</span></span> <span data-ttu-id="ea544-120">Dado que la interfaz escribe el contenido del documento secuencialmente, el método **addPage** agrega la página al FixedDocument creado más recientemente.</span><span class="sxs-lookup"><span data-stu-id="ea544-120">Because the interface writes the document contents sequentially, the **AddPage** method adds the page to the most recently created FixedDocument.</span></span>

## <a name="using-the-ixpsompackagewriter-interface"></a><span data-ttu-id="ea544-121">Uso de la interfaz IXpsOMPackageWriter</span><span class="sxs-lookup"><span data-stu-id="ea544-121">Using the IXpsOMPackageWriter Interface</span></span>

<span data-ttu-id="ea544-122">En el procedimiento siguiente se describe cómo crear un archivo de documento XPS mediante la interfaz [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) .</span><span class="sxs-lookup"><span data-stu-id="ea544-122">The following procedure describes how to create an XPS document file by using the [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface.</span></span> <span data-ttu-id="ea544-123">En el procedimiento no se describe cómo crear una instancia de una interfaz [**IXpsOMPage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) y su contenido.</span><span class="sxs-lookup"><span data-stu-id="ea544-123">The procedure does not describe how to instantiate an [**IXpsOMPage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) interface and its contents.</span></span> <span data-ttu-id="ea544-124">Para obtener más información sobre **IXpsOMPage** y la adición de contenido a una página, vea [interfaces de página de XPS OM](xps-object-model-page-interfaces.md) y los temas que se enumeran en la sección Vea también.</span><span class="sxs-lookup"><span data-stu-id="ea544-124">For more information about **IXpsOMPage** and adding content to a page, see [XPS OM Page Interfaces](xps-object-model-page-interfaces.md) and the topics listed in the See Also section.</span></span>

 <span data-ttu-id="ea544-125">**Crear un documento**</span><span class="sxs-lookup"><span data-stu-id="ea544-125">**Creating a document**</span></span>

1.  <span data-ttu-id="ea544-126">Cree una instancia de una interfaz [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) .</span><span class="sxs-lookup"><span data-stu-id="ea544-126">Instantiate an [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface.</span></span>

    <span data-ttu-id="ea544-127">Esto crea una FixedDocumentSequence vacía en el paquete.</span><span class="sxs-lookup"><span data-stu-id="ea544-127">This creates an empty FixedDocumentSequence in the package.</span></span>

    -   <span data-ttu-id="ea544-128">Para crear un documento XPS en un archivo, llame a [**IXpsOMObjectFactory:: CreatePackageWriterOnFile**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomobjectfactory-createpackagewriteronfile).</span><span class="sxs-lookup"><span data-stu-id="ea544-128">To create an XPS document in a file, call [**IXpsOMObjectFactory::CreatePackageWriterOnFile**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomobjectfactory-createpackagewriteronfile).</span></span>
    -   <span data-ttu-id="ea544-129">Para crear un documento XPS en una secuencia, llame a [**IXpsOMObjectFactory:: CreatePackageWriterOnStream**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomobjectfactory-createpackagewriteronstream).</span><span class="sxs-lookup"><span data-stu-id="ea544-129">To create an XPS document in a stream, call [**IXpsOMObjectFactory::CreatePackageWriterOnStream**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsomobjectfactory-createpackagewriteronstream).</span></span>

2.  <span data-ttu-id="ea544-130">Inicie un nuevo documento en el paquete mediante una llamada a [**IXpsOMPackageWriter:: StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument).</span><span class="sxs-lookup"><span data-stu-id="ea544-130">Start a new document in the package by calling [**IXpsOMPackageWriter::StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument).</span></span>

    <span data-ttu-id="ea544-131">Antes de agregar una página, llame a [**IXpsOMPackageWriter:: StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument) para agregar un FixedDocument a la FixedDocumentSequence que se creó en el paso 1.</span><span class="sxs-lookup"><span data-stu-id="ea544-131">Before adding a page, call [**IXpsOMPackageWriter::StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument) to add a FixedDocument to the FixedDocumentSequence that was created in step 1.</span></span>

3.  <span data-ttu-id="ea544-132">Agregar contenido.</span><span class="sxs-lookup"><span data-stu-id="ea544-132">Add content.</span></span>
    -   <span data-ttu-id="ea544-133">Para agregar un nuevo FixedPage al documento, llame a [**IXpsOMPackageWriter:: AddPage**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-addpage), pasándole un puntero a la interfaz [**IXpsOMPage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) que tenga el contenido de la FixedPage que desea agregar.</span><span class="sxs-lookup"><span data-stu-id="ea544-133">To add a new FixedPage to the document, call [**IXpsOMPackageWriter::AddPage**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-addpage), passing it a pointer to the [**IXpsOMPage**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompage) interface that has the contents of the FixedPage that you want to add.</span></span>
    -   <span data-ttu-id="ea544-134">Para crear un nuevo FixedDocument en la FixedDocumentSequence, llame a [**IXpsOMPackageWriter:: StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument).</span><span class="sxs-lookup"><span data-stu-id="ea544-134">To create a new FixedDocument in the FixedDocumentSequence, call [**IXpsOMPackageWriter::StartNewDocument**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-startnewdocument).</span></span>
4.  <span data-ttu-id="ea544-135">Cierre el paquete y su contenido mediante una llamada a [**IXpsOMPackageWriter:: Close**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-close).</span><span class="sxs-lookup"><span data-stu-id="ea544-135">Close the package and its contents by calling [**IXpsOMPackageWriter::Close**](/windows/desktop/api/xpsobjectmodel/nf-xpsobjectmodel-ixpsompackagewriter-close).</span></span>

## <a name="advanced-features"></a><span data-ttu-id="ea544-136">Características avanzadas</span><span class="sxs-lookup"><span data-stu-id="ea544-136">Advanced Features</span></span>

<span data-ttu-id="ea544-137">Los métodos de la interfaz [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) también admiten la adición de recursos, miniaturas e impresión de incidencias.</span><span class="sxs-lookup"><span data-stu-id="ea544-137">The methods of the [**IXpsOMPackageWriter**](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsompackagewriter) interface also support the adding of resources, thumbnails, and print tickets.</span></span> <span data-ttu-id="ea544-138">Estos componentes de documento se pueden agregar en los niveles package, FixedDocumentSequence, FixedDocument y FixedPage.</span><span class="sxs-lookup"><span data-stu-id="ea544-138">These document components can be added at the package, FixedDocumentSequence, FixedDocument, and FixedPage levels.</span></span> <span data-ttu-id="ea544-139">Para obtener más información acerca del uso de esta interfaz para imprimir, consulte [imprimir un OM de XPS](print-an-xps-om.md).</span><span class="sxs-lookup"><span data-stu-id="ea544-139">For more information about using this interface for printing, see [Print an XPS OM](print-an-xps-om.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="ea544-140">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="ea544-140">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ea544-141">Uso de la API de firma digital XPS</span><span class="sxs-lookup"><span data-stu-id="ea544-141">Using XPS Digital Signature API</span></span>](using-digital-signatures-in-xps-documents.md)
</dt> <dt>

[<span data-ttu-id="ea544-142">Interfaces de página de XPS OM</span><span class="sxs-lookup"><span data-stu-id="ea544-142">XPS OM Page Interfaces</span></span>](xps-object-model-page-interfaces.md)
</dt> <dt>

[<span data-ttu-id="ea544-143">Navegar por el OM de XPS</span><span class="sxs-lookup"><span data-stu-id="ea544-143">Navigate the XPS OM</span></span>](navigate-the-xps-om.md)
</dt> <dt>

[<span data-ttu-id="ea544-144">Trabajar con las interfaces visual y canvas de XPS OM</span><span class="sxs-lookup"><span data-stu-id="ea544-144">Working with XPS OM Canvas and Visual Interfaces</span></span>](working-with-xpsomcanvas-interfaces.md)
</dt> <dt>

[<span data-ttu-id="ea544-145">Trabajar con las interfaces de ruta de acceso XPS OM</span><span class="sxs-lookup"><span data-stu-id="ea544-145">Working with XPS OM Path Interfaces</span></span>](working-with-xps-object-model-path-interfaces.md)
</dt> <dt>

[<span data-ttu-id="ea544-146">Trabajar con interfaces de texto, gráficos e imágenes de XPS OM</span><span class="sxs-lookup"><span data-stu-id="ea544-146">Working with XPS OM Text, Graphics, and Image Interfaces</span></span>](working-with-xps-object-model-text-and-image-interfaces.md)
</dt> <dt>

[<span data-ttu-id="ea544-147">Interfaces de vales de impresión de XPS OM</span><span class="sxs-lookup"><span data-stu-id="ea544-147">XPS OM Print Ticket Interfaces</span></span>](xps-object-model-print-ticket-interfaces.md)
</dt> <dt>

[<span data-ttu-id="ea544-148">**IXpsOMThumbnailGenerator**</span><span class="sxs-lookup"><span data-stu-id="ea544-148">**IXpsOMThumbnailGenerator**</span></span>](/windows/desktop/api/xpsobjectmodel/nn-xpsobjectmodel-ixpsomthumbnailgenerator)
</dt> <dt>

[<span data-ttu-id="ea544-149">Referencia de la API de documentos XPS</span><span class="sxs-lookup"><span data-stu-id="ea544-149">XPS Document API Reference</span></span>](xps-programming-reference.md)
</dt> <dt>

[<span data-ttu-id="ea544-150">XML Paper Specification</span><span class="sxs-lookup"><span data-stu-id="ea544-150">XML Paper Specification</span></span>](https://www.ecma-international.org/activities/XML%20Paper%20Specification/XPS%20Standard%20WD%201.6.pdf)
</dt> </dl>

 

 



