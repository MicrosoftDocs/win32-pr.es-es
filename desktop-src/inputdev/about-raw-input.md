---
title: Acerca de la entrada sin formato
description: En este tema se describe la entrada del usuario desde dispositivos como joysticks, pantallas táctiles y micrófonos.
ms.assetid: 013ed309-f667-47ed-ade0-5e7ca5a0997a
keywords:
- entrada de usuario, entrada sin formato
- captura de entradas de usuario, entrada sin formato
- entrada sin formato
- registrar entradas sin formato
- lectura de entrada sin formato
- entrada sin formato de joystick
- entrada sin formato de pantalla táctil
- entrada sin formato de micrófono
- Dispositivo de interfaz humana (HID)
- HID (Dispositivo de interfaz humana)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b3535e5601ec63a254c76060611999a1a2f08aeb
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/19/2020
ms.locfileid: "104077745"
---
# <a name="about-raw-input"></a><span data-ttu-id="8719c-113">Acerca de la entrada sin formato</span><span class="sxs-lookup"><span data-stu-id="8719c-113">About Raw Input</span></span>

<span data-ttu-id="8719c-114">Hay muchos dispositivos de entrada de usuario junto con el teclado y el mouse tradicionales.</span><span class="sxs-lookup"><span data-stu-id="8719c-114">There are many user-input devices beside the traditional keyboard and mouse.</span></span> <span data-ttu-id="8719c-115">Por ejemplo, los datos proporcionados por el usuario pueden provienen de un joystick, una pantalla táctil, un micrófono u otros dispositivos que permiten una gran flexibilidad en los datos proporcionados por el usuario.</span><span class="sxs-lookup"><span data-stu-id="8719c-115">For example, user input can come from a joystick, a touch screen, a microphone, or other devices that allow great flexibility in user input.</span></span> <span data-ttu-id="8719c-116">Estos dispositivos se conocen colectivamente como dispositivos de interfaz humana (oculta).</span><span class="sxs-lookup"><span data-stu-id="8719c-116">These devices are collectively known as Human Interface Devices (HIDs).</span></span> <span data-ttu-id="8719c-117">La API de entrada sin formato proporciona una forma estable y robusta para que las aplicaciones acepten entradas sin procesar de cualquier HID, incluido el teclado y el mouse.</span><span class="sxs-lookup"><span data-stu-id="8719c-117">The raw input API provides a stable and robust way for applications to accept raw input from any HID, including the keyboard and mouse.</span></span>

<span data-ttu-id="8719c-118">En esta sección se describen los temas siguientes:</span><span class="sxs-lookup"><span data-stu-id="8719c-118">This section covers the following topics:</span></span>

-   [<span data-ttu-id="8719c-119">Modelo de entrada sin formato</span><span class="sxs-lookup"><span data-stu-id="8719c-119">Raw Input Model</span></span>](#raw-input-model)
-   [<span data-ttu-id="8719c-120">Registro para entradas sin procesar</span><span class="sxs-lookup"><span data-stu-id="8719c-120">Registration for Raw Input</span></span>](#registration-for-raw-input)
-   [<span data-ttu-id="8719c-121">Lectura de entrada sin formato</span><span class="sxs-lookup"><span data-stu-id="8719c-121">Reading Raw Input</span></span>](#reading-raw-input)

## <a name="raw-input-model"></a><span data-ttu-id="8719c-122">Modelo de entrada sin formato</span><span class="sxs-lookup"><span data-stu-id="8719c-122">Raw Input Model</span></span>

<span data-ttu-id="8719c-123">Anteriormente, el teclado y el mouse normalmente generaban datos de entrada.</span><span class="sxs-lookup"><span data-stu-id="8719c-123">Previously, the keyboard and mouse typically generated input data.</span></span> <span data-ttu-id="8719c-124">El sistema interpreta los datos procedentes de estos dispositivos de forma que se eliminen los detalles específicos del dispositivo de la información sin procesar.</span><span class="sxs-lookup"><span data-stu-id="8719c-124">The system interpreted the data coming from these devices in a way that eliminated the device-specific details of the raw information.</span></span> <span data-ttu-id="8719c-125">Por ejemplo, el teclado genera el código de análisis específico del dispositivo, pero el sistema proporciona una aplicación con el código de tecla virtual.</span><span class="sxs-lookup"><span data-stu-id="8719c-125">For example, the keyboard generates the device-specific scan code but the system provides an application with the virtual key code.</span></span> <span data-ttu-id="8719c-126">Además de ocultar los detalles de la entrada sin formato, el administrador de ventanas no admitía todas las nuevas oculta.</span><span class="sxs-lookup"><span data-stu-id="8719c-126">Besides hiding the details of the raw input, the window manager did not support all the new HIDs.</span></span> <span data-ttu-id="8719c-127">Para obtener información de los oculta no admitidos, una aplicación tenía que hacer muchas cosas: abrir el dispositivo, administrar el modo compartido, leer periódicamente el dispositivo o configurar el puerto de finalización de e/s, etc.</span><span class="sxs-lookup"><span data-stu-id="8719c-127">To get input from the unsupported HIDs, an application had to do many things: open the device, manage the shared mode, periodically read the device or set up the I/O completion port, and so forth.</span></span> <span data-ttu-id="8719c-128">El modelo de entrada sin formato y las API asociadas se desarrollaron para permitir el acceso sencillo a la entrada sin formato de todos los dispositivos de entrada, incluidos el teclado y el mouse.</span><span class="sxs-lookup"><span data-stu-id="8719c-128">The raw input model and the associated APIs were developed to allow simple access to raw input from all input devices, including the keyboard and mouse.</span></span>

<span data-ttu-id="8719c-129">El modelo de entrada sin formato es diferente del modelo de entrada de Windows original para el teclado y el mouse.</span><span class="sxs-lookup"><span data-stu-id="8719c-129">The raw input model is different from the original Windows input model for the keyboard and mouse.</span></span> <span data-ttu-id="8719c-130">En el modelo de entrada original, una aplicación recibe entradas independientes del dispositivo en forma de mensajes que se envían o se publican en sus ventanas, como [**WM \_ Char**](wm-char.md), [**WM \_ MOUSEMOVE**](wm-mousemove.md)y [**WM \_ APPCOMMAND**](wm-appcommand.md).</span><span class="sxs-lookup"><span data-stu-id="8719c-130">In the original input model, an application receives device-independent input in the form of messages that are sent or posted to its windows, such as [**WM\_CHAR**](wm-char.md), [**WM\_MOUSEMOVE**](wm-mousemove.md), and [**WM\_APPCOMMAND**](wm-appcommand.md).</span></span> <span data-ttu-id="8719c-131">Por el contrario, para las entradas sin procesar, una aplicación debe registrar los dispositivos de los que desea obtener datos.</span><span class="sxs-lookup"><span data-stu-id="8719c-131">In contrast, for raw input an application must register the devices it wants to get data from.</span></span> <span data-ttu-id="8719c-132">Además, la aplicación obtiene la entrada sin formato a través del mensaje de [**\_ entrada de WM**](wm-input.md) .</span><span class="sxs-lookup"><span data-stu-id="8719c-132">Also, the application gets the raw input through the [**WM\_INPUT**](wm-input.md) message.</span></span>

<span data-ttu-id="8719c-133">El modelo de entrada sin formato tiene varias ventajas:</span><span class="sxs-lookup"><span data-stu-id="8719c-133">There are several advantages to the raw input model:</span></span>

-   <span data-ttu-id="8719c-134">Una aplicación no tiene que detectar ni abrir el dispositivo de entrada.</span><span class="sxs-lookup"><span data-stu-id="8719c-134">An application does not have to detect or open the input device.</span></span>
-   <span data-ttu-id="8719c-135">Una aplicación obtiene los datos directamente del dispositivo y procesa los datos para sus necesidades.</span><span class="sxs-lookup"><span data-stu-id="8719c-135">An application gets the data directly from the device, and processes the data for its needs.</span></span>
-   <span data-ttu-id="8719c-136">Una aplicación puede distinguir el origen de la entrada aunque sea del mismo tipo de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8719c-136">An application can distinguish the source of the input even if it is from the same type of device.</span></span> <span data-ttu-id="8719c-137">Por ejemplo, dos dispositivos de mouse.</span><span class="sxs-lookup"><span data-stu-id="8719c-137">For example, two mouse devices.</span></span>
-   <span data-ttu-id="8719c-138">Una aplicación administra el tráfico de datos especificando datos de una colección de dispositivos o solo tipos de dispositivo específicos.</span><span class="sxs-lookup"><span data-stu-id="8719c-138">An application manages the data traffic by specifying data from a collection of devices or only specific device types.</span></span>
-   <span data-ttu-id="8719c-139">Los dispositivos HID se pueden usar a medida que están disponibles en Marketplace, sin tener que esperar a que los nuevos tipos de mensajes o un SO actualizado tengan nuevos comandos en [**WM \_ APPCOMMAND**](wm-appcommand.md).</span><span class="sxs-lookup"><span data-stu-id="8719c-139">HID devices can be used as they become available in the marketplace, without waiting for new message types or an updated OS to have new commands in [**WM\_APPCOMMAND**](wm-appcommand.md).</span></span>

<span data-ttu-id="8719c-140">Tenga en cuenta que [**WM \_ APPCOMMAND**](wm-appcommand.md) proporciona para algunos dispositivos HID.</span><span class="sxs-lookup"><span data-stu-id="8719c-140">Note that [**WM\_APPCOMMAND**](wm-appcommand.md) does provide for some HID devices.</span></span> <span data-ttu-id="8719c-141">Sin embargo, **WM \_ APPCOMMAND** es un evento de entrada independiente del dispositivo de nivel superior, mientras que la [**\_ entrada de WM**](wm-input.md) envía datos sin procesar y de bajo nivel que son específicos de un dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8719c-141">However, **WM\_APPCOMMAND** is a higher level device-independent input event, while [**WM\_INPUT**](wm-input.md) sends raw, low level data that is specific to a device.</span></span>

## <a name="registration-for-raw-input"></a><span data-ttu-id="8719c-142">Registro para entradas sin procesar</span><span class="sxs-lookup"><span data-stu-id="8719c-142">Registration for Raw Input</span></span>

<span data-ttu-id="8719c-143">De forma predeterminada, ninguna aplicación recibe entradas sin formato.</span><span class="sxs-lookup"><span data-stu-id="8719c-143">By default, no application receives raw input.</span></span> <span data-ttu-id="8719c-144">Para recibir entradas sin procesar de un dispositivo, una aplicación debe registrar el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8719c-144">To receive raw input from a device, an application must register the device.</span></span>

<span data-ttu-id="8719c-145">Para registrar dispositivos, una aplicación crea primero una matriz de estructuras [**RAWINPUTDEVICE**](/windows/win32/api/winuser/ns-winuser-rawinputdevice) que especifican la [colección de nivel superior](/windows-hardware/drivers/hid/top-level-collections) (TLC) para los dispositivos que desea.</span><span class="sxs-lookup"><span data-stu-id="8719c-145">To register devices, an application first creates an array of [**RAWINPUTDEVICE**](/windows/win32/api/winuser/ns-winuser-rawinputdevice) structures that specify the [top level collection](/windows-hardware/drivers/hid/top-level-collections) (TLC) for the devices it wants.</span></span> <span data-ttu-id="8719c-146">La TLC se define mediante una [Página de uso](/windows-hardware/drivers/hid/hid-usages#usage-page) (la clase del dispositivo) y un [identificador de uso](/windows-hardware/drivers/hid/hid-usages#usage-id) (el dispositivo dentro de la clase).</span><span class="sxs-lookup"><span data-stu-id="8719c-146">The TLC is defined by a [Usage Page](/windows-hardware/drivers/hid/hid-usages#usage-page) (the class of the device) and a [Usage ID](/windows-hardware/drivers/hid/hid-usages#usage-id) (the device within the class).</span></span> <span data-ttu-id="8719c-147">Por ejemplo, para obtener el TLC de teclado, establezca UsagePage = 0x01 y UsageID = 0x06.</span><span class="sxs-lookup"><span data-stu-id="8719c-147">For example, to get the keyboard TLC, set UsagePage = 0x01 and UsageID = 0x06.</span></span> <span data-ttu-id="8719c-148">La aplicación llama a [**RegisterRawInputDevices**](/windows/win32/api/winuser/nf-winuser-registerrawinputdevices) para registrar los dispositivos.</span><span class="sxs-lookup"><span data-stu-id="8719c-148">The application calls [**RegisterRawInputDevices**](/windows/win32/api/winuser/nf-winuser-registerrawinputdevices) to register the devices.</span></span>

<span data-ttu-id="8719c-149">Tenga en cuenta que una aplicación puede registrar un dispositivo que no está conectado actualmente al sistema.</span><span class="sxs-lookup"><span data-stu-id="8719c-149">Note that an application can register a device that is not currently attached to the system.</span></span> <span data-ttu-id="8719c-150">Cuando este dispositivo está conectado, el administrador de Windows enviará automáticamente la entrada sin formato a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8719c-150">When this device is attached, the Windows Manager will automatically send the raw input to the application.</span></span> <span data-ttu-id="8719c-151">Para obtener la lista de dispositivos de entrada sin formato en el sistema, una aplicación llama a [**GetRawInputDeviceList**](/windows/win32/api/winuser/nf-winuser-getrawinputdevicelist).</span><span class="sxs-lookup"><span data-stu-id="8719c-151">To get the list of raw input devices on the system, an application calls [**GetRawInputDeviceList**](/windows/win32/api/winuser/nf-winuser-getrawinputdevicelist).</span></span> <span data-ttu-id="8719c-152">Mediante *hDevice* desde esta llamada, una aplicación llama a [**GetRawInputDeviceInfo**](/windows/win32/api/winuser/nf-winuser-getrawinputdeviceinfoa) para obtener la información del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8719c-152">Using the *hDevice* from this call, an application calls [**GetRawInputDeviceInfo**](/windows/win32/api/winuser/nf-winuser-getrawinputdeviceinfoa) to get the device information.</span></span>

<span data-ttu-id="8719c-153">A través del miembro **dwFlags** de [**RAWINPUTDEVICE**](/windows/win32/api/winuser/ns-winuser-rawinputdevice), una aplicación puede seleccionar los dispositivos que se van a escuchar y también aquellos que desea omitir.</span><span class="sxs-lookup"><span data-stu-id="8719c-153">Through the **dwFlags** member of [**RAWINPUTDEVICE**](/windows/win32/api/winuser/ns-winuser-rawinputdevice), an application can select the devices to listen to and also those it wants to ignore.</span></span> <span data-ttu-id="8719c-154">Por ejemplo, una aplicación puede solicitar información de todos los dispositivos de telefonía, excepto para responder a las máquinas.</span><span class="sxs-lookup"><span data-stu-id="8719c-154">For example, an application can ask for input from all telephony devices except for answering machines.</span></span> <span data-ttu-id="8719c-155">Para ver el código de ejemplo, consulte [registro para entradas sin procesar](using-raw-input.md).</span><span class="sxs-lookup"><span data-stu-id="8719c-155">For sample code, see [Registering for Raw Input](using-raw-input.md).</span></span>

<span data-ttu-id="8719c-156">Tenga en cuenta que el mouse y el teclado también se oculta, por lo que los datos de ellos pueden pasar por la [**\_ entrada de WM**](wm-input.md) de mensajes de HID y desde mensajes tradicionales.</span><span class="sxs-lookup"><span data-stu-id="8719c-156">Note that the mouse and the keyboard are also HIDs, so data from them can come through both the HID message [**WM\_INPUT**](wm-input.md) and from traditional messages.</span></span> <span data-ttu-id="8719c-157">Una aplicación puede seleccionar cualquier método mediante la selección adecuada de marcas en [**RAWINPUTDEVICE**](/windows/win32/api/winuser/ns-winuser-rawinputdevice).</span><span class="sxs-lookup"><span data-stu-id="8719c-157">An application can select either method by the proper selection of flags in [**RAWINPUTDEVICE**](/windows/win32/api/winuser/ns-winuser-rawinputdevice).</span></span>

<span data-ttu-id="8719c-158">Para obtener el estado de registro de una aplicación, llame a [**GetRegisteredRawInputDevices**](/windows/win32/api/winuser/nf-winuser-getregisteredrawinputdevices) en cualquier momento.</span><span class="sxs-lookup"><span data-stu-id="8719c-158">To get an application's registration status, call [**GetRegisteredRawInputDevices**](/windows/win32/api/winuser/nf-winuser-getregisteredrawinputdevices) at any time.</span></span>

## <a name="reading-raw-input"></a><span data-ttu-id="8719c-159">Lectura de entrada sin formato</span><span class="sxs-lookup"><span data-stu-id="8719c-159">Reading Raw Input</span></span>

<span data-ttu-id="8719c-160">Una aplicación recibe una entrada sin formato de cualquier HID cuya [colección de nivel superior](/windows-hardware/drivers/hid/top-level-collections) (TLC) coincide con un TLC del registro.</span><span class="sxs-lookup"><span data-stu-id="8719c-160">An application receives raw input from any HID whose [top level collection](/windows-hardware/drivers/hid/top-level-collections) (TLC) matches a TLC from the registration.</span></span> <span data-ttu-id="8719c-161">Cuando una aplicación recibe una entrada sin procesar, su cola de mensajes obtiene un mensaje de [**\_ entrada de WM**](wm-input.md) y se establece la marca de estado de la **cola, \_** **\_ RAWINPUT**</span><span class="sxs-lookup"><span data-stu-id="8719c-161">When an application receives raw input, its message queue gets a [**WM\_INPUT**](wm-input.md) message and the queue status flag **QS\_RAWINPUT** is set (**QS\_INPUT** also includes this flag).</span></span> <span data-ttu-id="8719c-162">Una aplicación puede recibir datos cuando está en primer plano y cuando está en segundo plano.</span><span class="sxs-lookup"><span data-stu-id="8719c-162">An application can receive data when it is in the foreground and when it is in the background.</span></span>

<span data-ttu-id="8719c-163">Hay dos maneras de leer los datos sin procesar: el método no almacenado en búfer (o estándar) y el método almacenado en búfer.</span><span class="sxs-lookup"><span data-stu-id="8719c-163">There are two ways to read the raw data: the unbuffered (or standard) method and the buffered method.</span></span> <span data-ttu-id="8719c-164">El método no almacenado en búfer obtiene los datos sin procesar de una estructura [**RAWINPUT**](/windows/win32/api/winuser/ns-winuser-rawinput) cada vez y es adecuado para muchas oculta.</span><span class="sxs-lookup"><span data-stu-id="8719c-164">The unbuffered method gets the raw data one [**RAWINPUT**](/windows/win32/api/winuser/ns-winuser-rawinput) structure at a time and is adequate for many HIDs.</span></span> <span data-ttu-id="8719c-165">Aquí, la aplicación llama a [**GetMessage**](/windows/desktop/api/winuser/nf-winuser-getmessage) para obtener el mensaje de [**\_ entrada de WM**](wm-input.md) .</span><span class="sxs-lookup"><span data-stu-id="8719c-165">Here, the application calls [**GetMessage**](/windows/desktop/api/winuser/nf-winuser-getmessage) to get the [**WM\_INPUT**](wm-input.md) message.</span></span> <span data-ttu-id="8719c-166">A continuación, la aplicación llama a [**GetRawInputData**](/windows/win32/api/winuser/nf-winuser-getrawinputdata) con el identificador **RAWINPUT** incluido en la **\_ entrada de WM**.</span><span class="sxs-lookup"><span data-stu-id="8719c-166">Then the application calls [**GetRawInputData**](/windows/win32/api/winuser/nf-winuser-getrawinputdata) using the **RAWINPUT** handle contained in **WM\_INPUT**.</span></span> <span data-ttu-id="8719c-167">Para obtener un ejemplo, vea [realizar una lectura estándar de entrada sin formato](using-raw-input.md).</span><span class="sxs-lookup"><span data-stu-id="8719c-167">For an example, see [Doing a Standard Read of Raw Input](using-raw-input.md).</span></span>

<span data-ttu-id="8719c-168">En cambio, el método almacenado en búfer obtiene una matriz de estructuras [**RAWINPUT**](/windows/win32/api/winuser/ns-winuser-rawinput) a la vez.</span><span class="sxs-lookup"><span data-stu-id="8719c-168">In contrast, the buffered method gets an array of [**RAWINPUT**](/windows/win32/api/winuser/ns-winuser-rawinput) structures at a time.</span></span> <span data-ttu-id="8719c-169">Esto se proporciona para los dispositivos que pueden generar grandes cantidades de entradas sin procesar.</span><span class="sxs-lookup"><span data-stu-id="8719c-169">This is provided for devices that can produce large amounts of raw input.</span></span> <span data-ttu-id="8719c-170">En este método, la aplicación llama a [**GetRawInputBuffer**](/windows/win32/api/winuser/nf-winuser-getrawinputbuffer) para obtener una matriz de estructuras **RAWINPUT** .</span><span class="sxs-lookup"><span data-stu-id="8719c-170">In this method, the application calls [**GetRawInputBuffer**](/windows/win32/api/winuser/nf-winuser-getrawinputbuffer) to get an array of **RAWINPUT** structures.</span></span> <span data-ttu-id="8719c-171">Tenga en cuenta que la macro [**NEXTRAWINPUTBLOCK**](/windows/win32/api/winuser/nf-winuser-nextrawinputblock) se usa para recorrer una matriz de estructuras **RAWINPUT** .</span><span class="sxs-lookup"><span data-stu-id="8719c-171">Note that the [**NEXTRAWINPUTBLOCK**](/windows/win32/api/winuser/nf-winuser-nextrawinputblock) macro is used to traverse an array of **RAWINPUT** structures.</span></span> <span data-ttu-id="8719c-172">Para obtener un ejemplo, vea [realizar una lectura almacenada en búfer de entrada sin formato](using-raw-input.md).</span><span class="sxs-lookup"><span data-stu-id="8719c-172">For an example, see [Doing a Buffered Read of Raw Input](using-raw-input.md).</span></span>

<span data-ttu-id="8719c-173">Para interpretar la entrada sin formato, se requiere información detallada sobre oculta.</span><span class="sxs-lookup"><span data-stu-id="8719c-173">To interpret the raw input, detailed information about the HIDs is required.</span></span> <span data-ttu-id="8719c-174">Una aplicación obtiene la información del dispositivo llamando a [**GetRawInputDeviceInfo**](/windows/win32/api/winuser/nf-winuser-getrawinputdeviceinfoa) con el identificador del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8719c-174">An application gets the device information by calling [**GetRawInputDeviceInfo**](/windows/win32/api/winuser/nf-winuser-getrawinputdeviceinfoa) with the device handle.</span></span> <span data-ttu-id="8719c-175">Este identificador puede proviene de [**una \_ entrada de WM**](wm-input.md) o del miembro **hDevice** de [**RAWINPUTHEADER**](/windows/win32/api/winuser/ns-winuser-rawinputheader).</span><span class="sxs-lookup"><span data-stu-id="8719c-175">This handle can come either from [**WM\_INPUT**](wm-input.md) or from the **hDevice** member of [**RAWINPUTHEADER**](/windows/win32/api/winuser/ns-winuser-rawinputheader).</span></span>