---
title: Controladores de notificaciones administrativas
description: El complemento MMC de usuarios y equipos de Microsoft Active Directory proporciona un mecanismo para permitir que los componentes reciban notificaciones cuando el usuario elimina, cambia de nombre, mueve o cambia las propiedades de un objeto mediante el complemento.
ms.assetid: 49dbb995-c760-4fac-a72f-d5d94afb63c7
ms.tgt_platform: multiple
keywords:
- Controladores de notificación administrativa AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: baa6f48f8b56ab8e4a1d64d0fe15543bfee6c09e
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/17/2020
ms.locfileid: "103904509"
---
# <a name="administrative-notification-handlers"></a><span data-ttu-id="64187-104">Controladores de notificaciones administrativas</span><span class="sxs-lookup"><span data-stu-id="64187-104">Administrative Notification Handlers</span></span>

<span data-ttu-id="64187-105">El complemento MMC de usuarios y equipos de Microsoft Active Directory proporciona un mecanismo para permitir que los componentes reciban notificaciones cuando el usuario elimina, cambia de nombre, mueve o cambia las propiedades de un objeto mediante el complemento.</span><span class="sxs-lookup"><span data-stu-id="64187-105">The Microsoft Active Directory Users and Computers MMC snap-in provides a mechanism to enable components to receive notifications when the user deletes, renames, moves, or changes the properties of an object using the snap-in.</span></span> <span data-ttu-id="64187-106">El componente que recibe las notificaciones se conoce como "controlador de notificación".</span><span class="sxs-lookup"><span data-stu-id="64187-106">The component that receives the notifications is known as a "notification handler".</span></span>

<span data-ttu-id="64187-107">Esto resulta útil cuando se vinculan varios objetos y deben existir en el mismo contenedor.</span><span class="sxs-lookup"><span data-stu-id="64187-107">This is useful when multiple objects are linked together and must exist within the same container.</span></span> <span data-ttu-id="64187-108">Si se mueve uno de los objetos vinculados, se proporciona una notificación al controlador de notificaciones y el controlador de notificación puede trasladar los demás objetos vinculados a la misma carpeta.</span><span class="sxs-lookup"><span data-stu-id="64187-108">If one of the linked objects is moved, a notification is supplied to the notification handler and the notification handler can move the other linked objects to the same folder.</span></span>

<span data-ttu-id="64187-109">Cuando se realiza una de las operaciones y se instalan uno o varios controladores de notificación, el complemento usuarios y equipos mostrará un cuadro de diálogo de confirmación en el que se muestran los controladores de notificación y una casilla para cada controlador.</span><span class="sxs-lookup"><span data-stu-id="64187-109">When one of the operations is performed and one or more notification handlers is installed, the Users and Computers snap-in will display a confirmation dialog box that lists the notification handlers and a check box for each handler.</span></span> <span data-ttu-id="64187-110">Si se selecciona la casilla de un controlador, se notifica al controlador.</span><span class="sxs-lookup"><span data-stu-id="64187-110">If the check box for a handler is selected, the handler is notified.</span></span> <span data-ttu-id="64187-111">Si la casilla no está activada, no se notifica al controlador.</span><span class="sxs-lookup"><span data-stu-id="64187-111">If the check box is not selected, the handler is not notified.</span></span>

## <a name="implementing-a-notification-handler"></a><span data-ttu-id="64187-112">Implementar un controlador de notificación</span><span class="sxs-lookup"><span data-stu-id="64187-112">Implementing a Notification Handler</span></span>

<span data-ttu-id="64187-113">Un controlador de notificación es un objeto COM implementado como un servidor en proceso.</span><span class="sxs-lookup"><span data-stu-id="64187-113">A notification handler is a COM object implemented as an in-proc server.</span></span> <span data-ttu-id="64187-114">El controlador de notificación debe implementar la interfaz [**IDsAdminNotifyHandler**](/windows/desktop/api/DSAdmin/nn-dsadmin-idsadminnotifyhandler) .</span><span class="sxs-lookup"><span data-stu-id="64187-114">The notification handler must implement the [**IDsAdminNotifyHandler**](/windows/desktop/api/DSAdmin/nn-dsadmin-idsadminnotifyhandler) interface.</span></span>

<span data-ttu-id="64187-115">Cuando se produce un evento que producirá una notificación, el complemento usuarios y equipos enumera los controladores de notificaciones registrados y crea cada uno con el CLSID para el controlador.</span><span class="sxs-lookup"><span data-stu-id="64187-115">When an event occurs that will cause a notification, the Users and Computers snap-in enumerates the registered notification handlers and creates each one using the CLSID for the handler.</span></span> <span data-ttu-id="64187-116">Una vez creado el controlador, el complemento llama al método [**IDsAdminNotifyHandler:: Initialize**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-initialize) .</span><span class="sxs-lookup"><span data-stu-id="64187-116">After the handler is created, the snap-in calls the [**IDsAdminNotifyHandler::Initialize**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-initialize) method.</span></span> <span data-ttu-id="64187-117">El método **Initialize** proporciona el complemento con los eventos que el controlador debe recibir.</span><span class="sxs-lookup"><span data-stu-id="64187-117">The **Initialize** method supplies the snap-in with the events the handler should receive.</span></span>

<span data-ttu-id="64187-118">Si el evento es uno que se debe enviar al controlador de notificación, el complemento llama al método [**IDsAdminNotifyHandler:: Begin**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-begin) .</span><span class="sxs-lookup"><span data-stu-id="64187-118">If the event is one that should be sent to the notification handler, the snap-in calls the [**IDsAdminNotifyHandler::Begin**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-begin) method.</span></span> <span data-ttu-id="64187-119">El método **Begin** proporciona el controlador con el evento que se está produciendo, los datos sobre el objeto en el que se está produciendo el evento y, dependiendo del evento, los datos sobre el objeto que se va a convertir.</span><span class="sxs-lookup"><span data-stu-id="64187-119">The **Begin** method provides the handler with the event occurring, data about the object that the event is occurring on and, depending on the event, data about what the object will become.</span></span> <span data-ttu-id="64187-120">El método **Begin** también proporciona el complemento con el texto que se debe mostrar para el controlador en el cuadro de diálogo de confirmación.</span><span class="sxs-lookup"><span data-stu-id="64187-120">The **Begin** method also provides the snap-in with the text that should be displayed for the handler in the confirmation dialog box.</span></span>

<span data-ttu-id="64187-121">Cuando se llama al método [**Begin**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-begin) para cada controlador, el complemento muestra el cuadro de diálogo de confirmación.</span><span class="sxs-lookup"><span data-stu-id="64187-121">When the [**Begin**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-begin) method for each handler has been called, the snap-in displays the confirmation dialog box.</span></span> <span data-ttu-id="64187-122">El cuadro de diálogo de confirmación solicita al usuario que seleccione los controladores que recibirán la notificación.</span><span class="sxs-lookup"><span data-stu-id="64187-122">The confirmation dialog box prompts the user to select which handlers will receive the notification.</span></span> <span data-ttu-id="64187-123">Si el usuario presiona el botón no introducir en el cuadro de diálogo de confirmación, **no** se notificará a ninguno de los controladores.</span><span class="sxs-lookup"><span data-stu-id="64187-123">If the user presses the **No** push button in the confirmation dialog, none of the handlers are notified.</span></span> <span data-ttu-id="64187-124">Si el usuario presiona el botón **sí** , cada uno de los controladores seleccionados en el cuadro de diálogo de confirmación recibirá la notificación.</span><span class="sxs-lookup"><span data-stu-id="64187-124">If the user presses the **Yes** push button, each of the handlers selected in the confirmation dialog box receive the notification.</span></span> <span data-ttu-id="64187-125">El complemento envía la notificación al controlador mediante una llamada al método [**IDsAdminNotifyHandler:: Notify**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-notify) .</span><span class="sxs-lookup"><span data-stu-id="64187-125">The snap-in sends the notification to the handler by calling the [**IDsAdminNotifyHandler::Notify**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-notify) method.</span></span>

<span data-ttu-id="64187-126">Una vez que se ha notificado a todos los controladores, el complemento llama al método [**IDsAdminNotifyHandler:: end**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-end) .</span><span class="sxs-lookup"><span data-stu-id="64187-126">After all of the handlers have been notified, the snap-in calls the [**IDsAdminNotifyHandler::End**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-end) method.</span></span> <span data-ttu-id="64187-127">Siempre se llama al método **End** , incluso si no se llama al método [**Notify**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-notify) .</span><span class="sxs-lookup"><span data-stu-id="64187-127">The **End** method is always called, even if the [**Notify**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-notify) method is not called.</span></span>

## <a name="registering-a-notification-handler-in-the-windows-registry"></a><span data-ttu-id="64187-128">Registrar un controlador de notificación en el registro de Windows</span><span class="sxs-lookup"><span data-stu-id="64187-128">Registering a Notification Handler in the Windows Registry</span></span>

<span data-ttu-id="64187-129">Al igual que todos los servidores COM, se debe registrar un controlador de notificación en el registro de Windows.</span><span class="sxs-lookup"><span data-stu-id="64187-129">Like all COM servers, a notification handler must be registered in the Windows registry.</span></span> <span data-ttu-id="64187-130">El controlador se registra con la clave siguiente:</span><span class="sxs-lookup"><span data-stu-id="64187-130">The handler is registered under the following key:</span></span>


```C++
HKEY_CLASSES_ROOT - CLSID - <CLSID>
```



<span data-ttu-id="64187-131">**<CLSID>** es la representación de cadena del CLSID tal y como la produce la función [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) .</span><span class="sxs-lookup"><span data-stu-id="64187-131">**<CLSID>** is the string representation of the CLSID as produced by the [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) function.</span></span> <span data-ttu-id="64187-132">En la **<CLSID>** clave, hay una clave **InProcServer32** que identifica el objeto como servidor de 32 bits en proceso.</span><span class="sxs-lookup"><span data-stu-id="64187-132">Under the **<CLSID>** key, there is an **InProcServer32** key that identifies the object as a 32-bit in-proc server.</span></span> <span data-ttu-id="64187-133">En la clave **InProcServer32** , la ubicación del archivo dll se especifica en el valor predeterminado y el modelo de subprocesos se especifica en el valor **ThreadingModel** .</span><span class="sxs-lookup"><span data-stu-id="64187-133">Under the **InProcServer32** key, the location of the DLL is specified in the default value and the threading model is specified in the **ThreadingModel** value.</span></span> <span data-ttu-id="64187-134">Todos los controladores de notificación deben usar el modelo de subprocesos de **Apartamento** .</span><span class="sxs-lookup"><span data-stu-id="64187-134">All notification handlers must use the **Apartment** threading model.</span></span>

## <a name="registering-a-notification-handler-with-an-active-directory-server"></a><span data-ttu-id="64187-135">Registrar un controlador de notificación con un servidor de Active Directory</span><span class="sxs-lookup"><span data-stu-id="64187-135">Registering a Notification Handler with an Active Directory Server</span></span>

<span data-ttu-id="64187-136">Dentro de Active Directory Domain Services, el registro del controlador de notificaciones es específico de una configuración regional.</span><span class="sxs-lookup"><span data-stu-id="64187-136">Within Active Directory Domain Services, notification handler registration is specific to one locale.</span></span> <span data-ttu-id="64187-137">Si el controlador de notificación se aplica a todas las configuraciones regionales, debe registrarse en el objeto **displaySpecifier** en todos los subcontenedores de la configuración regional del contenedor DisplaySpecifiers.</span><span class="sxs-lookup"><span data-stu-id="64187-137">If the notification handler applies to all locales, it must be registered in the **displaySpecifier** object in all of the locale subcontainers in the DisplaySpecifiers container.</span></span> <span data-ttu-id="64187-138">Si el controlador de notificación está localizado para una configuración regional determinada, se registra en el objeto **displaySpecifier** en el subcontenedor de la configuración regional.</span><span class="sxs-lookup"><span data-stu-id="64187-138">If the notification handler is localized for a certain locale, it is registered in the **displaySpecifier** object in that locale's subcontainer.</span></span> <span data-ttu-id="64187-139">Para obtener más información sobre el contenedor DisplaySpecifiers y las configuraciones regionales, consulte [especificadores de pantalla](display-specifiers.md) y [contenedor de DisplaySpecifiers](displayspecifiers-container.md).</span><span class="sxs-lookup"><span data-stu-id="64187-139">For more information about the DisplaySpecifiers container and locales, see [Display Specifiers](display-specifiers.md) and [DisplaySpecifiers Container](displayspecifiers-container.md).</span></span>

<span data-ttu-id="64187-140">Los controladores de notificación se registran en el atributo **dsUIAdminNotification** del contenedor **DS-UI-default-Settings** .</span><span class="sxs-lookup"><span data-stu-id="64187-140">Notification handlers are registered under the **dsUIAdminNotification** attribute in the **DS-UI-Default-Settings** container.</span></span> <span data-ttu-id="64187-141">Este es un valor de cadena Unicode de varios valores, donde cada valor requiere el formato siguiente:</span><span class="sxs-lookup"><span data-stu-id="64187-141">This a multi-valued Unicode string value where each value requires the following format:</span></span>


```C++
<order number>,<CLSID>
```



<span data-ttu-id="64187-142">El " &lt; número de pedido &gt; " es un número sin signo que representa la posición del controlador en el cuadro de diálogo de confirmación.</span><span class="sxs-lookup"><span data-stu-id="64187-142">The "&lt;order number&gt;" is an unsigned number that represents the position of the handler in the confirmation dialog.</span></span> <span data-ttu-id="64187-143">Cuando se muestra el cuadro de diálogo de confirmación, los valores se ordenan mediante una comparación de " &lt; número de pedido" de cada valor &gt; .</span><span class="sxs-lookup"><span data-stu-id="64187-143">When the confirmation dialog is displayed, the values are sorted using a comparison of each value's "&lt;order number&gt;".</span></span> <span data-ttu-id="64187-144">Si hay más de un valor con el mismo " &lt; número de orden &gt; ", esos controladores se muestran en el orden en que se leen en el servidor de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="64187-144">If more than one value has the same "&lt;order number&gt;", those handlers are displayed in the order they are read from the Active Directory server.</span></span> <span data-ttu-id="64187-145">Un valor no existente, es decir, uno no utilizado por otros valores de la propiedad, &lt; se debe usar "número de pedido &gt; " si es posible.</span><span class="sxs-lookup"><span data-stu-id="64187-145">A non-existing, that is, one not used by other values in the property, "&lt;order number&gt;" should be used if possible.</span></span> <span data-ttu-id="64187-146">No hay ninguna posición de inicio prescrita y los huecos pueden aparecer en la &lt; secuencia "número de pedido &gt; ".</span><span class="sxs-lookup"><span data-stu-id="64187-146">There is no prescribed starting position, and gaps can appear in the "&lt;order number&gt;" sequence.</span></span>

<span data-ttu-id="64187-147">" &lt; CLSID &gt; " es la representación de cadena del CLSID tal y como la produce la función [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) .</span><span class="sxs-lookup"><span data-stu-id="64187-147">The "&lt;CLSID&gt;" is the string representation of the CLSID as produced by the [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) function.</span></span>

 

 