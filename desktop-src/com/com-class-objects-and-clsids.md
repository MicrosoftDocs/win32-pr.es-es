---
title: Objetos de clase COM y CLSID
description: Un servidor COM se implementa como una clase COM.
ms.assetid: 0073acdf-38a8-4f1a-aa26-379456a95fca
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1bbfde2f379c4c7589db4cde283c8c67d720b21d
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/21/2020
ms.locfileid: "105714483"
---
# <a name="com-class-objects-and-clsids"></a><span data-ttu-id="52a1f-103">Objetos de clase COM y CLSID</span><span class="sxs-lookup"><span data-stu-id="52a1f-103">COM Class Objects and CLSIDs</span></span>

<span data-ttu-id="52a1f-104">Un servidor COM se implementa como una clase COM.</span><span class="sxs-lookup"><span data-stu-id="52a1f-104">A COM server is implemented as a COM class.</span></span> <span data-ttu-id="52a1f-105">Una *clase com* es una implementación de un grupo de interfaces en el código que se ejecuta cada vez que interactúa con un objeto determinado.</span><span class="sxs-lookup"><span data-stu-id="52a1f-105">A *COM class* is an implementation of a group of interfaces in code executed whenever you interact with a given object.</span></span> <span data-ttu-id="52a1f-106">Hay una diferencia importante entre una clase de C++ y una clase COM: en C++, una clase es un tipo, mientras que una clase COM simplemente es una definición del objeto y no incluye ningún tipo, aunque un programador de C++ podría implementarla mediante una clase de C++.</span><span class="sxs-lookup"><span data-stu-id="52a1f-106">There is an important distinction between a C++ class and a COM class: In C++, a class is a type, while a COM class is simply a definition of the object and carries no type, although a C++ programmer might implement it by using a C++ class.</span></span> <span data-ttu-id="52a1f-107">COM está diseñado para permitir el uso de una clase por parte de aplicaciones diferentes, incluidas las aplicaciones escritas sin conocimiento de la existencia de esa clase concreta.</span><span class="sxs-lookup"><span data-stu-id="52a1f-107">COM is designed to allow a class to be used by different applications, including applications written without knowledge of that particular class's existence.</span></span> <span data-ttu-id="52a1f-108">Por lo tanto, el código de clase para un tipo de objeto determinado existe en una biblioteca dinámica vinculada (DLL) o en otra aplicación ejecutable (EXE).</span><span class="sxs-lookup"><span data-stu-id="52a1f-108">Therefore, class code for a given type of object exists either in a dynamic linked library (DLL) or in another executable application (EXE).</span></span>

<span data-ttu-id="52a1f-109">Cada clase COM se identifica mediante un *CLSID*, un GUID único de 128 bits, que el servidor debe registrar.</span><span class="sxs-lookup"><span data-stu-id="52a1f-109">Each COM class is identified by a *CLSID*, a unique 128-bit GUID, which the server must register.</span></span> <span data-ttu-id="52a1f-110">COM utiliza este CLSID, en la solicitud de un cliente, para asociar datos específicos con el archivo DLL o EXE que contiene el código que implementa la clase, lo que crea una instancia del objeto.</span><span class="sxs-lookup"><span data-stu-id="52a1f-110">COM uses this CLSID, at the request of a client, to associate specific data with the DLL or EXE containing the code that implements the class, thus creating an instance of the object.</span></span>

<span data-ttu-id="52a1f-111">En el caso de los clientes y servidores del mismo equipo, el CLSID del servidor es todo lo que necesita el cliente.</span><span class="sxs-lookup"><span data-stu-id="52a1f-111">For clients and servers on the same computer, the CLSID of the server is all the client ever needs.</span></span> <span data-ttu-id="52a1f-112">En cada equipo, COM mantiene una base de datos (hace uso del registro del sistema en las plataformas de Microsoft Windows y Macintosh) de todos los CLSID de los servidores instalados en el sistema.</span><span class="sxs-lookup"><span data-stu-id="52a1f-112">On each computer, COM maintains a database (it makes use of the system registry on Microsoft Windows and Macintosh platforms) of all the CLSIDs for the servers installed on the system.</span></span> <span data-ttu-id="52a1f-113">Se trata de una asignación entre cada CLSID y la ubicación del archivo DLL o EXE que hospeda el código para ese CLSID.</span><span class="sxs-lookup"><span data-stu-id="52a1f-113">This is a mapping between each CLSID and the location of the DLL or EXE that houses the code for that CLSID.</span></span> <span data-ttu-id="52a1f-114">COM consulta esta base de datos cada vez que un cliente desea crear una instancia de una clase COM y usar sus servicios, por lo que el cliente nunca necesita conocer la ubicación absoluta del código en el equipo.</span><span class="sxs-lookup"><span data-stu-id="52a1f-114">COM consults this database whenever a client wants to create an instance of a COM class and use its services, so the client never needs to know the absolute location of the code on the computer.</span></span>

<span data-ttu-id="52a1f-115">En el caso de los sistemas distribuidos, COM proporciona entradas del registro que permiten que un servidor remoto se registre para su uso por parte de un cliente.</span><span class="sxs-lookup"><span data-stu-id="52a1f-115">For distributed systems, COM provides registry entries that allow a remote server to register itself for use by a client.</span></span> <span data-ttu-id="52a1f-116">Mientras que las aplicaciones solo necesitan conocer el CLSID de un servidor, ya que pueden basarse en el registro para encontrar el servidor, COM permite a los clientes invalidar las entradas del registro y especificar las ubicaciones del servidor para sacar el máximo partido de la red.</span><span class="sxs-lookup"><span data-stu-id="52a1f-116">While applications need know only a server's CLSID, because they can rely on the registry to locate the server, COM allows clients to override registry entries and to specify server locations, to take full advantage of the network.</span></span> <span data-ttu-id="52a1f-117">(Vea [localizar un objeto remoto](locating-a-remote-object.md)).</span><span class="sxs-lookup"><span data-stu-id="52a1f-117">(See [Locating a Remote Object](locating-a-remote-object.md).)</span></span>

<span data-ttu-id="52a1f-118">La manera básica de crear una instancia de una clase es a través de un *objeto de clase* com.</span><span class="sxs-lookup"><span data-stu-id="52a1f-118">The basic way to create an instance of a class is through a COM *class object*.</span></span> <span data-ttu-id="52a1f-119">Esto es simplemente un objeto intermedio que admite funciones comunes a la creación de nuevas instancias de una clase determinada.</span><span class="sxs-lookup"><span data-stu-id="52a1f-119">This is simply an intermediate object that supports functions common to creating new instances of a given class.</span></span> <span data-ttu-id="52a1f-120">La mayoría de los objetos de clase usados para crear objetos a partir de un CLSID admiten la interfaz [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) , una interfaz que incluye el método [**CreateInstance**](/windows/desktop/api/Unknwn/nf-unknwn-iclassfactory-createinstance) importante.</span><span class="sxs-lookup"><span data-stu-id="52a1f-120">Most class objects used to create objects from a CLSID support the [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) interface, an interface that includes the important [**CreateInstance**](/windows/desktop/api/Unknwn/nf-unknwn-iclassfactory-createinstance) method.</span></span> <span data-ttu-id="52a1f-121">Se implementa una interfaz **IClassFactory** para cada clase de objeto del que se va a crear una instancia.</span><span class="sxs-lookup"><span data-stu-id="52a1f-121">You implement an **IClassFactory** interface for each class of object that you offer to be instantiated.</span></span> <span data-ttu-id="52a1f-122">(Para obtener más información acerca de la implementación de **IClassFactory**, vea [implementar IClassFactory](implementing-iclassfactory.md)).</span><span class="sxs-lookup"><span data-stu-id="52a1f-122">(For more information about implementing **IClassFactory**, see [Implementing IClassFactory](implementing-iclassfactory.md).)</span></span>

> [!Note]  
> <span data-ttu-id="52a1f-123">No es necesario que los servidores que admiten otras interfaces de generador de clases personalizadas admitan [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) específicamente.</span><span class="sxs-lookup"><span data-stu-id="52a1f-123">Servers that support some other custom class factory interface are not required to support [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) specifically.</span></span> <span data-ttu-id="52a1f-124">Sin embargo, las llamadas a funciones de activación que no sean [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) (como [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex)) requieren que el servidor admita **IClassFactory**.</span><span class="sxs-lookup"><span data-stu-id="52a1f-124">However, calls to activation functions other than [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) (such as [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex)) require that the server support **IClassFactory**.</span></span>

 

<span data-ttu-id="52a1f-125">Cuando un cliente desea crear una instancia del objeto del servidor, usa el CLSID del objeto deseado en una llamada a [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject).</span><span class="sxs-lookup"><span data-stu-id="52a1f-125">When a client wants to create an instance of the server's object, it uses the desired object's CLSID in a call to [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject).</span></span> <span data-ttu-id="52a1f-126">(Esta llamada puede ser directa o implícita, a través de una de las funciones auxiliares de creación de objetos). Esta función busca el código asociado al CLSID y crea un objeto de clase, y proporciona un puntero a la interfaz solicitada.</span><span class="sxs-lookup"><span data-stu-id="52a1f-126">(This call can be either direct or implicit, through one of the object creation helper functions.) This function locates the code associated with the CLSID, and creates a class object, and supplies a pointer to the interface requested.</span></span> <span data-ttu-id="52a1f-127">(**CoGetClassObject** toma un parámetro *riid* que especifica el puntero de interfaz deseado del cliente).</span><span class="sxs-lookup"><span data-stu-id="52a1f-127">(**CoGetClassObject** takes a *riid* param that specifies the client's desired interface pointer.)</span></span>

> [!Note]  
> <span data-ttu-id="52a1f-128">COM tiene solo algunas funciones en las que se han creado muchos de los demás.</span><span class="sxs-lookup"><span data-stu-id="52a1f-128">COM has just a few functions upon which many of the others are built.</span></span> <span data-ttu-id="52a1f-129">El más importante es probablemente [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject), que subyace a todas las funciones de creación de instancias.</span><span class="sxs-lookup"><span data-stu-id="52a1f-129">The most important of these is probably [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject), which underlies all of the instance creation functions.</span></span>

 

<span data-ttu-id="52a1f-130">Con este puntero, el autor de la llamada puede crear una instancia del objeto y recuperar un puntero a una interfaz solicitada en el objeto.</span><span class="sxs-lookup"><span data-stu-id="52a1f-130">With this pointer, the caller can create an instance of the object and retrieve a pointer to a requested interface on the object.</span></span> <span data-ttu-id="52a1f-131">Normalmente, se trata de una interfaz de inicialización que se usa para activar el objeto (ponerlo en el estado de ejecución) de modo que el cliente pueda realizar cualquier trabajo con el objeto que desee.</span><span class="sxs-lookup"><span data-stu-id="52a1f-131">This is usually an initialization interface, used to activate the object (put it in the running state) so that the client can do whatever work with the object that it wants to.</span></span> <span data-ttu-id="52a1f-132">Con las funciones básicas de COM, el cliente también debe tener cuidado de liberar todos los punteros de objeto.</span><span class="sxs-lookup"><span data-stu-id="52a1f-132">Using COM's basic functions, the client must also take care to release all object pointers.</span></span>

<span data-ttu-id="52a1f-133">Otro mecanismo para activar instancias de objeto es a través del moniker de clase.</span><span class="sxs-lookup"><span data-stu-id="52a1f-133">Another mechanism for activating object instances is through the class moniker.</span></span> <span data-ttu-id="52a1f-134">Los monikers de clase se enlazan al objeto de clase de la clase para la que se crean.</span><span class="sxs-lookup"><span data-stu-id="52a1f-134">Class monikers bind to the class object of the class for which they are created.</span></span> <span data-ttu-id="52a1f-135">Para obtener más información, vea [monikers de clase](class-monikers.md).</span><span class="sxs-lookup"><span data-stu-id="52a1f-135">For more information, see [Class Monikers](class-monikers.md).</span></span>

<span data-ttu-id="52a1f-136">COM proporciona varias funciones auxiliares que reducen el trabajo de creación de instancias de objeto.</span><span class="sxs-lookup"><span data-stu-id="52a1f-136">COM provides several helper functions that reduce the work of creating object instances.</span></span> <span data-ttu-id="52a1f-137">Se describen en [funciones auxiliares](instance-creation-helper-functions.md)para la creación de instancias.</span><span class="sxs-lookup"><span data-stu-id="52a1f-137">These are described in [Instance Creation Helper Functions](instance-creation-helper-functions.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="52a1f-138">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="52a1f-138">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="52a1f-139">Crear un objeto a través de un objeto de clase</span><span class="sxs-lookup"><span data-stu-id="52a1f-139">Creating an Object Through a Class Object</span></span>](creating-an-object-through-a-class-object.md)
</dt> </dl>

 

 