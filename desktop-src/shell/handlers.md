---
description: Las capacidades del shell se pueden extender con las entradas del registro y los archivos. ini.
ms.assetid: 74a81e4f-7357-4901-a118-ba44e8892f25
title: Creación de controladores de extensiones de shell
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 991f3c1684b7491e2ad29fae29f48164ffdd47cb
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104997717"
---
# <a name="creating-shell-extension-handlers"></a><span data-ttu-id="8eed1-103">Creación de controladores de extensiones de shell</span><span class="sxs-lookup"><span data-stu-id="8eed1-103">Creating Shell Extension Handlers</span></span>

<span data-ttu-id="8eed1-104">Las capacidades del shell se pueden extender con las entradas del registro y los archivos. ini.</span><span class="sxs-lookup"><span data-stu-id="8eed1-104">The capabilities of the Shell can be extended with registry entries and .ini files.</span></span> <span data-ttu-id="8eed1-105">Aunque este enfoque para extender el Shell es sencillo y adecuado para muchos propósitos, es limitado.</span><span class="sxs-lookup"><span data-stu-id="8eed1-105">While this approach to extending the Shell is simple, and adequate for many purposes, it is limited.</span></span> <span data-ttu-id="8eed1-106">Por ejemplo, si usa el registro para especificar un icono personalizado para un tipo de archivo, aparecerá el mismo icono para cada archivo de ese tipo.</span><span class="sxs-lookup"><span data-stu-id="8eed1-106">For example, if you use the registry to specify a custom icon for a file type, the same icon will appear for every file of that type.</span></span> <span data-ttu-id="8eed1-107">La extensión del shell con el registro no le permite modificar el icono de los distintos archivos del mismo tipo.</span><span class="sxs-lookup"><span data-stu-id="8eed1-107">Extending the Shell with the registry does not allow you to vary the icon for different files of the same type.</span></span> <span data-ttu-id="8eed1-108">Otros aspectos del shell, como la hoja de propiedades **propiedades** que se pueden mostrar cuando se hace clic con el botón derecho en un archivo, no se pueden modificar en absoluto con el registro.</span><span class="sxs-lookup"><span data-stu-id="8eed1-108">Other aspects of the Shell, such as the **Properties** property sheet that can be displayed when a file is right-clicked, cannot be modified at all with the registry.</span></span>

<span data-ttu-id="8eed1-109">Un enfoque más eficaz y flexible para extender el Shell es implementar *controladores de extensión de Shell*.</span><span class="sxs-lookup"><span data-stu-id="8eed1-109">A more powerful and flexible approach to extending the Shell is to implement *shell extension handlers*.</span></span> <span data-ttu-id="8eed1-110">Estos controladores se pueden implementar para diversas acciones que puede realizar el shell.</span><span class="sxs-lookup"><span data-stu-id="8eed1-110">These handlers can be implemented for a variety of actions that the Shell can perform.</span></span> <span data-ttu-id="8eed1-111">Antes de realizar la acción, el shell consulta el controlador de extensión, lo que le otorga la oportunidad de modificar la acción.</span><span class="sxs-lookup"><span data-stu-id="8eed1-111">Before taking the action, the Shell queries the extension handler, giving it the opportunity to modify the action.</span></span> <span data-ttu-id="8eed1-112">Un ejemplo común es un controlador de extensión de menú contextual.</span><span class="sxs-lookup"><span data-stu-id="8eed1-112">A common example is a shortcut menu extension handler.</span></span> <span data-ttu-id="8eed1-113">Si se implementa una para un tipo de archivo, se consultará cada vez que se haga clic con el botón derecho en uno de los archivos.</span><span class="sxs-lookup"><span data-stu-id="8eed1-113">If one is implemented for a file type, it will be queried every time one of the files is right-clicked.</span></span> <span data-ttu-id="8eed1-114">A continuación, el controlador puede especificar elementos de menú adicionales cada archivo, en lugar de tener el mismo conjunto para todo el tipo de archivo.</span><span class="sxs-lookup"><span data-stu-id="8eed1-114">The handler can then specify additional menu items on a file-by-file basis, rather than having the same set for the entire file type.</span></span>

<span data-ttu-id="8eed1-115">En este documento se explica cómo implementar los controladores de extensión que permiten modificar diversas acciones de Shell.</span><span class="sxs-lookup"><span data-stu-id="8eed1-115">This document discusses how to implement the extension handlers that allow you to modify a variety of Shell actions.</span></span> <span data-ttu-id="8eed1-116">Los siguientes controladores están asociados a un tipo de archivo determinado y le permiten especificar uno por archivo:</span><span class="sxs-lookup"><span data-stu-id="8eed1-116">The following handlers are associated with a particular file type and allow you to specify on a file-by-file basis:</span></span>



| <span data-ttu-id="8eed1-117">Controlador</span><span class="sxs-lookup"><span data-stu-id="8eed1-117">Handler</span></span>                                               | <span data-ttu-id="8eed1-118">Descripción</span><span class="sxs-lookup"><span data-stu-id="8eed1-118">Description</span></span>                                                                                                                                                                |
|-------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8eed1-119">Controlador del menú contextual</span><span class="sxs-lookup"><span data-stu-id="8eed1-119">Shortcut menu handler</span></span>](context-menu-handlers.md)    | <span data-ttu-id="8eed1-120">Se llama antes de que se muestre el menú contextual de un archivo.</span><span class="sxs-lookup"><span data-stu-id="8eed1-120">Called before a file's shortcut menu is displayed.</span></span> <span data-ttu-id="8eed1-121">Permite agregar elementos al menú contextual de forma individual para cada archivo.</span><span class="sxs-lookup"><span data-stu-id="8eed1-121">It enables you to add items to the shortcut menu on a file-by-file basis.</span></span>                                               |
| [<span data-ttu-id="8eed1-122">Controlador de datos</span><span class="sxs-lookup"><span data-stu-id="8eed1-122">Data handler</span></span>](how-to-create-data-handlers.md)       | <span data-ttu-id="8eed1-123">Se llama cuando se realiza una operación de arrastrar y colocar en objetos dragShell.</span><span class="sxs-lookup"><span data-stu-id="8eed1-123">Called when a drag-and-drop operation is performed on dragShell objects.</span></span> <span data-ttu-id="8eed1-124">Permite proporcionar formatos de Portapapeles adicionales al destino de colocación.</span><span class="sxs-lookup"><span data-stu-id="8eed1-124">It enables you to provide additional clipboard formats to the drop target.</span></span>                        |
| [<span data-ttu-id="8eed1-125">Quitar controlador</span><span class="sxs-lookup"><span data-stu-id="8eed1-125">Drop handler</span></span>](how-to-create-drop-handlers.md)       | <span data-ttu-id="8eed1-126">Se llama cuando se arrastra un objeto de datos o se coloca en un archivo.</span><span class="sxs-lookup"><span data-stu-id="8eed1-126">Called when a data object is dragged over or dropped on a file.</span></span> <span data-ttu-id="8eed1-127">Permite crear un archivo en un destino de colocación.</span><span class="sxs-lookup"><span data-stu-id="8eed1-127">It enables you to make a file into a drop target.</span></span>                                                          |
| [<span data-ttu-id="8eed1-128">Controlador de iconos</span><span class="sxs-lookup"><span data-stu-id="8eed1-128">Icon handler</span></span>](how-to-create-icon-handlers.md)       | <span data-ttu-id="8eed1-129">Se llama antes de que se muestre el icono de un archivo.</span><span class="sxs-lookup"><span data-stu-id="8eed1-129">Called before a file's icon is displayed.</span></span> <span data-ttu-id="8eed1-130">Permite reemplazar el icono predeterminado del archivo con un icono personalizado en función de cada archivo.</span><span class="sxs-lookup"><span data-stu-id="8eed1-130">It enables you to replace the file's default icon with a custom icon on a file-by-file basis.</span></span>                                    |
| [<span data-ttu-id="8eed1-131">Controlador de la hoja de propiedades</span><span class="sxs-lookup"><span data-stu-id="8eed1-131">Property sheet handler</span></span>](propsheet-handlers.md)      | <span data-ttu-id="8eed1-132">Se llama antes de que se muestre la hoja de propiedades de **propiedades** de un objeto.</span><span class="sxs-lookup"><span data-stu-id="8eed1-132">Called before an object's **Properties** property sheet is displayed.</span></span> <span data-ttu-id="8eed1-133">Permite agregar o reemplazar páginas.</span><span class="sxs-lookup"><span data-stu-id="8eed1-133">It enables you to add or replace pages.</span></span>                                                              |
| [<span data-ttu-id="8eed1-134">**Controlador de imagen en miniatura**</span><span class="sxs-lookup"><span data-stu-id="8eed1-134">**Thumbnail Image handler**</span></span>](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) | <span data-ttu-id="8eed1-135">Proporciona una imagen para representar el elemento.</span><span class="sxs-lookup"><span data-stu-id="8eed1-135">Provides an image to represent the item.</span></span>                                                                                                                                   |
| [<span data-ttu-id="8eed1-136">**Controlador de recuadro informativo**</span><span class="sxs-lookup"><span data-stu-id="8eed1-136">**Infotip handler**</span></span>](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo)                 | <span data-ttu-id="8eed1-137">Proporciona texto emergente cuando el usuario mantiene el puntero del mouse sobre el objeto.</span><span class="sxs-lookup"><span data-stu-id="8eed1-137">Provides pop-up text when the user hovers the mouse pointer over the object.</span></span>                                                                                               |
| [<span data-ttu-id="8eed1-138">**Controlador de metadatos**</span><span class="sxs-lookup"><span data-stu-id="8eed1-138">**Metadata handler**</span></span>](/windows/win32/api/propsys/nn-propsys-ipropertystore)     | <span data-ttu-id="8eed1-139">Proporciona acceso de lectura y escritura a los metadatos (propiedades) almacenados en un archivo.</span><span class="sxs-lookup"><span data-stu-id="8eed1-139">Provides read and write access to metadata (properties) stored in a file.</span></span> <span data-ttu-id="8eed1-140">Se puede usar para ampliar la vista de detalles, recuadros informativos, la página de propiedades y las características de agrupación.</span><span class="sxs-lookup"><span data-stu-id="8eed1-140">This can be used to extend the Details view, infotips, the property page, and grouping features.</span></span> |



 

<span data-ttu-id="8eed1-141">Otros controladores no están asociados a un tipo de archivo determinado, pero se les llama antes que algunas operaciones de Shell:</span><span class="sxs-lookup"><span data-stu-id="8eed1-141">Other handlers are not associated with a particular file type but are called before some Shell operations:</span></span>



| <span data-ttu-id="8eed1-142">Controlador</span><span class="sxs-lookup"><span data-stu-id="8eed1-142">Handler</span></span>                                                            | <span data-ttu-id="8eed1-143">Descripción</span><span class="sxs-lookup"><span data-stu-id="8eed1-143">Description</span></span>                                                                                                                                  |
|--------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8eed1-144">Controlador de columnas</span><span class="sxs-lookup"><span data-stu-id="8eed1-144">Column handler</span></span>](../lwef/column-handlers.md)                             | <span data-ttu-id="8eed1-145">Lo llama el explorador de Windows antes de mostrar la vista de detalles de una carpeta.</span><span class="sxs-lookup"><span data-stu-id="8eed1-145">Called by Windows Explorer before it displays the Details view of a folder.</span></span> <span data-ttu-id="8eed1-146">Permite agregar columnas personalizadas a la vista de detalles.</span><span class="sxs-lookup"><span data-stu-id="8eed1-146">It enables you to add custom columns to the Details view.</span></span>        |
| [<span data-ttu-id="8eed1-147">Copiar controlador de enlace</span><span class="sxs-lookup"><span data-stu-id="8eed1-147">Copy hook handler</span></span>](how-to-create-copy-hook-handlers.md)          | <span data-ttu-id="8eed1-148">Se llama cuando una carpeta o un objeto de impresora está a punto de moverse, copiarse, eliminarse o cambiarse de nombre.</span><span class="sxs-lookup"><span data-stu-id="8eed1-148">Called when a folder or printer object is about to be moved, copied, deleted, or renamed.</span></span> <span data-ttu-id="8eed1-149">Permite aprobar o vetar la operación.</span><span class="sxs-lookup"><span data-stu-id="8eed1-149">It enables you to approve or veto the operation.</span></span>   |
| [<span data-ttu-id="8eed1-150">Controlador de arrastrar y colocar</span><span class="sxs-lookup"><span data-stu-id="8eed1-150">Drag-and-drop handler</span></span>](context-menu-handlers.md)                 | <span data-ttu-id="8eed1-151">Se le llama cuando se arrastra un archivo con el botón secundario del mouse.</span><span class="sxs-lookup"><span data-stu-id="8eed1-151">Called when a file is dragged with the right mouse button.</span></span> <span data-ttu-id="8eed1-152">Permite modificar el menú contextual que se muestra.</span><span class="sxs-lookup"><span data-stu-id="8eed1-152">It enables you to modify the shortcut menu that is displayed.</span></span>                     |
| [<span data-ttu-id="8eed1-153">Controlador de superposición de iconos</span><span class="sxs-lookup"><span data-stu-id="8eed1-153">Icon Overlay handler</span></span>](how-to-implement-icon-overlay-handlers.md) | <span data-ttu-id="8eed1-154">Se llama antes de que se muestre el icono de un archivo.</span><span class="sxs-lookup"><span data-stu-id="8eed1-154">Called before a file's icon is displayed.</span></span> <span data-ttu-id="8eed1-155">Permite especificar una superposición para el icono del archivo.</span><span class="sxs-lookup"><span data-stu-id="8eed1-155">It enables you to specify an overlay for the file's icon.</span></span>                                          |
| [<span data-ttu-id="8eed1-156">Controlador de búsqueda</span><span class="sxs-lookup"><span data-stu-id="8eed1-156">Search handler</span></span>](../lwef/search-handlers.md)                             | <span data-ttu-id="8eed1-157">Se llama para iniciar un motor de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="8eed1-157">Called to launch a search engine.</span></span> <span data-ttu-id="8eed1-158">Permite implementar un motor de búsqueda personalizado accesible desde el menú **Inicio** o el explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="8eed1-158">It enables you to implement a custom search engine accessible from the **Start** menu or Windows Explorer.</span></span> |



 

<span data-ttu-id="8eed1-159">Los detalles sobre cómo implementar controladores de extensión específicos se tratan en las secciones anteriores.</span><span class="sxs-lookup"><span data-stu-id="8eed1-159">The details of how to implement specific extension handlers are covered in the sections listed above.</span></span> <span data-ttu-id="8eed1-160">En el resto de este documento se tratan algunos problemas de implementación comunes a todos los controladores de extensión de Shell.</span><span class="sxs-lookup"><span data-stu-id="8eed1-160">The remainder of this document covers some implementation issues that are common to all Shell extension handlers.</span></span>

-   [<span data-ttu-id="8eed1-161">Implementar controladores de extensión de Shell</span><span class="sxs-lookup"><span data-stu-id="8eed1-161">Implementing Shell Extension Handlers</span></span>](#implementing-shell-extension-handlers)
    -   [<span data-ttu-id="8eed1-162">Implementar IPersistFile</span><span class="sxs-lookup"><span data-stu-id="8eed1-162">Implementing IPersistFile</span></span>](#implementing-ipersistfile)
    -   [<span data-ttu-id="8eed1-163">Implementación de IShellExtInit</span><span class="sxs-lookup"><span data-stu-id="8eed1-163">Implementing IShellExtInit</span></span>](#implementing-ishellextinit)
    -   [<span data-ttu-id="8eed1-164">Personalización de recuadro informativo</span><span class="sxs-lookup"><span data-stu-id="8eed1-164">Infotip Customization</span></span>](#infotip-customization)
-   [<span data-ttu-id="8eed1-165">Mejorar Windows Search con controladores de extensión de Shell</span><span class="sxs-lookup"><span data-stu-id="8eed1-165">Enhancing Windows Search with Shell Extension Handlers</span></span>](#enhancing-windows-search-with-shell-extension-handlers)
-   [<span data-ttu-id="8eed1-166">Registrando controladores de extensión de Shell</span><span class="sxs-lookup"><span data-stu-id="8eed1-166">Registering Shell Extension Handlers</span></span>](#registering-shell-extension-handlers)
    -   [<span data-ttu-id="8eed1-167">Nombres de controlador</span><span class="sxs-lookup"><span data-stu-id="8eed1-167">Handler Names</span></span>](#handler-names)
    -   [<span data-ttu-id="8eed1-168">Objetos de Shell predefinidos</span><span class="sxs-lookup"><span data-stu-id="8eed1-168">Predefined Shell Objects</span></span>](#predefined-shell-objects)
    -   [<span data-ttu-id="8eed1-169">Ejemplo de registro de un controlador de extensión</span><span class="sxs-lookup"><span data-stu-id="8eed1-169">Example of an Extension Handler Registration</span></span>](#example-of-an-extension-handler-registration)
-   [<span data-ttu-id="8eed1-170">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="8eed1-170">Related topics</span></span>](#related-topics)

## <a name="implementing-shell-extension-handlers"></a><span data-ttu-id="8eed1-171">Implementar controladores de extensión de Shell</span><span class="sxs-lookup"><span data-stu-id="8eed1-171">Implementing Shell Extension Handlers</span></span>

<span data-ttu-id="8eed1-172">Gran parte de la implementación de un objeto de controlador de extensión de Shell depende de su tipo.</span><span class="sxs-lookup"><span data-stu-id="8eed1-172">Much of the implementation of a Shell extension handler object depends on its type.</span></span> <span data-ttu-id="8eed1-173">Sin embargo, hay algunos elementos comunes.</span><span class="sxs-lookup"><span data-stu-id="8eed1-173">There are, however, some common elements.</span></span> <span data-ttu-id="8eed1-174">En esta sección se describen los aspectos de la implementación que comparten todos los controladores de extensión de Shell.</span><span class="sxs-lookup"><span data-stu-id="8eed1-174">This section discusses those aspects of implementation that are shared by all Shell extension handlers.</span></span>

<span data-ttu-id="8eed1-175">Muchos controladores de extensión de Shell son objetos de modelo de objetos componentes (COM) en proceso.</span><span class="sxs-lookup"><span data-stu-id="8eed1-175">Many Shell extension handlers are in-process Component Object Model (COM) objects.</span></span> <span data-ttu-id="8eed1-176">Se les debe asignar un GUID y registrarse como se describe en registrar controladores de extensión de Shell.</span><span class="sxs-lookup"><span data-stu-id="8eed1-176">They must be assigned a GUID and registered as described in Registering Shell Extension Handlers.</span></span> <span data-ttu-id="8eed1-177">Se implementan como archivos dll y deben exportar las siguientes funciones estándar:</span><span class="sxs-lookup"><span data-stu-id="8eed1-177">They are implemented as DLLs and must export the following standard functions:</span></span>

-   <span data-ttu-id="8eed1-178">[**DllMain**](../dlls/dllmain.md).</span><span class="sxs-lookup"><span data-stu-id="8eed1-178">[**DllMain**](../dlls/dllmain.md).</span></span> <span data-ttu-id="8eed1-179">Punto de entrada estándar al archivo DLL.</span><span class="sxs-lookup"><span data-stu-id="8eed1-179">The standard entry point to the DLL.</span></span>
-   <span data-ttu-id="8eed1-180">[**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject).</span><span class="sxs-lookup"><span data-stu-id="8eed1-180">[**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject).</span></span> <span data-ttu-id="8eed1-181">Expone el generador de clases del objeto.</span><span class="sxs-lookup"><span data-stu-id="8eed1-181">Exposes the object's class factory.</span></span>
-   <span data-ttu-id="8eed1-182">[**DllCanUnloadNow**](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow).</span><span class="sxs-lookup"><span data-stu-id="8eed1-182">[**DllCanUnloadNow**](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow).</span></span> <span data-ttu-id="8eed1-183">COM llama a esta función para determinar si el objeto atiende a los clientes.</span><span class="sxs-lookup"><span data-stu-id="8eed1-183">COM calls this function to determine whether the object is serving any clients.</span></span> <span data-ttu-id="8eed1-184">De lo contrario, el sistema puede descargar el archivo DLL y liberar la memoria asociada.</span><span class="sxs-lookup"><span data-stu-id="8eed1-184">If not, the system can unload the DLL and free the associated memory.</span></span>

<span data-ttu-id="8eed1-185">Al igual que todos los objetos COM, los controladores de la extensión de Shell deben implementar una interfaz [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) y un [generador de clases](../com/implementing-iclassfactory.md).</span><span class="sxs-lookup"><span data-stu-id="8eed1-185">Like all COM objects, Shell extension handlers must implement an [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface and a [class factory](../com/implementing-iclassfactory.md).</span></span> <span data-ttu-id="8eed1-186">La mayoría de los controladores de extensión también deben implementar una interfaz [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) o [**ISHELLEXTINIT**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) en Windows XP o versiones anteriores.</span><span class="sxs-lookup"><span data-stu-id="8eed1-186">Most extension handlers must also implement either an [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) or [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface in Windows XP or earlier.</span></span> <span data-ttu-id="8eed1-187">Se reemplazaron por [**IInitializeWithStream**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithstream), [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem) y [**IInitializeWithFile**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithfile) en Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="8eed1-187">These were replaced by [**IInitializeWithStream**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithstream), [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem) and [**IInitializeWithFile**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithfile) in Windows Vista.</span></span> <span data-ttu-id="8eed1-188">El shell usa estas interfaces para inicializar el controlador.</span><span class="sxs-lookup"><span data-stu-id="8eed1-188">The Shell uses these interfaces to initialize the handler.</span></span>

<span data-ttu-id="8eed1-189">La interfaz [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) debe implementarse de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="8eed1-189">The [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface must be implemented by the following:</span></span>

-   <span data-ttu-id="8eed1-190">Controladores de datos</span><span class="sxs-lookup"><span data-stu-id="8eed1-190">Data handlers</span></span>
-   <span data-ttu-id="8eed1-191">Quitar controladores</span><span class="sxs-lookup"><span data-stu-id="8eed1-191">Drop handlers</span></span>

<span data-ttu-id="8eed1-192">En el pasado, los controladores de iconos también eran necesarios para implementar [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile), pero esto ya no es así.</span><span class="sxs-lookup"><span data-stu-id="8eed1-192">In the past, icon handlers were also required to implement [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile), but this is no longer true.</span></span> <span data-ttu-id="8eed1-193">En el caso de los controladores de iconos, **IPersistFile** es opcional y se prefieren otras interfaces como [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem) .</span><span class="sxs-lookup"><span data-stu-id="8eed1-193">For icon handlers, **IPersistFile** is now optional and other interfaces such as [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem) are preferred.</span></span>

<span data-ttu-id="8eed1-194">La interfaz [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) debe implementarse de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="8eed1-194">The [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface must be implemented by the following:</span></span>

-   <span data-ttu-id="8eed1-195">Controladores de menú contextual</span><span class="sxs-lookup"><span data-stu-id="8eed1-195">Shortcut menu handlers</span></span>
-   <span data-ttu-id="8eed1-196">Controladores de arrastrar y colocar</span><span class="sxs-lookup"><span data-stu-id="8eed1-196">Drag-and-drop handlers</span></span>
-   <span data-ttu-id="8eed1-197">Controladores de hoja de propiedades</span><span class="sxs-lookup"><span data-stu-id="8eed1-197">Property sheet handlers</span></span>

### <a name="implementing-ipersistfile"></a><span data-ttu-id="8eed1-198">Implementar IPersistFile</span><span class="sxs-lookup"><span data-stu-id="8eed1-198">Implementing IPersistFile</span></span>

<span data-ttu-id="8eed1-199">La interfaz [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) está pensada para permitir que un objeto se cargue desde un archivo de disco o se guarde en él.</span><span class="sxs-lookup"><span data-stu-id="8eed1-199">The [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface is intended to permit an object to be loaded from or saved to a disk file.</span></span> <span data-ttu-id="8eed1-200">Tiene seis métodos además de [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), cinco de los suyos propios y el método [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) que hereda de [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist).</span><span class="sxs-lookup"><span data-stu-id="8eed1-200">It has six methods in addition to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), five of its own, and the [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) method that it inherits from [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist).</span></span> <span data-ttu-id="8eed1-201">Con las extensiones de Shell, **IPersist** solo se usa para inicializar un objeto de controlador de extensión de Shell.</span><span class="sxs-lookup"><span data-stu-id="8eed1-201">With Shell extensions, **IPersist** is used only to initialize a Shell extension handler object.</span></span> <span data-ttu-id="8eed1-202">Dado que normalmente no es necesario leer o escribir en el disco, solo los métodos **GetClassID** y [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) requieren una implementación sin token.</span><span class="sxs-lookup"><span data-stu-id="8eed1-202">Because there is typically no need to read from or write to the disk, only the **GetClassID** and [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) methods require a nontoken implementation.</span></span>

<span data-ttu-id="8eed1-203">El shell llama primero a [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) y la función devuelve el identificador de clase (CLSID) del objeto de controlador de extensión.</span><span class="sxs-lookup"><span data-stu-id="8eed1-203">The Shell calls [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) first, and the function returns the class identifier (CLSID) of the extension handler object.</span></span> <span data-ttu-id="8eed1-204">Después, el shell llama a [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) y pasa dos valores.</span><span class="sxs-lookup"><span data-stu-id="8eed1-204">The Shell then calls [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) and passes in two values.</span></span> <span data-ttu-id="8eed1-205">La primera, *pszFileName*, es una cadena Unicode con el nombre del archivo o carpeta en el que está a punto de trabajar el shell.</span><span class="sxs-lookup"><span data-stu-id="8eed1-205">The first, *pszFileName*, is a Unicode string with the name of the file or folder that Shell is about to operate on.</span></span> <span data-ttu-id="8eed1-206">La segunda es *dwMode*, que indica el modo de acceso a archivos.</span><span class="sxs-lookup"><span data-stu-id="8eed1-206">The second is *dwMode*, which indicates the file access mode.</span></span> <span data-ttu-id="8eed1-207">Dado que normalmente no es necesario tener acceso a los archivos, *dwMode* suele ser cero.</span><span class="sxs-lookup"><span data-stu-id="8eed1-207">Because there is typically no need to access files, *dwMode* is usually zero.</span></span> <span data-ttu-id="8eed1-208">El método almacena estos valores según sea necesario para su posterior referencia.</span><span class="sxs-lookup"><span data-stu-id="8eed1-208">The method stores these values as needed for later reference.</span></span>

<span data-ttu-id="8eed1-209">En el fragmento de código siguiente se muestra cómo un controlador de extensión de Shell típico implementa los métodos [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) y [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) .</span><span class="sxs-lookup"><span data-stu-id="8eed1-209">The following code fragment illustrates how a typical Shell extension handler implements the [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) and [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) methods.</span></span> <span data-ttu-id="8eed1-210">Está diseñado para controlar ANSI o Unicode.</span><span class="sxs-lookup"><span data-stu-id="8eed1-210">It is designed to handle either ANSI or Unicode.</span></span> <span data-ttu-id="8eed1-211">CLSID \_ SampleExtHandler es el GUID del objeto del controlador de extensión y CSampleExtHandler es el nombre de la clase que se usa para implementar la interfaz.</span><span class="sxs-lookup"><span data-stu-id="8eed1-211">CLSID\_SampleExtHandler is the extension handler object's GUID, and CSampleExtHandler is the name of the class used to implement the interface.</span></span> <span data-ttu-id="8eed1-212">Las variables **m \_ szFileName** y **m \_ dwMode** son variables privadas que se usan para almacenar el nombre y las marcas de acceso del archivo.</span><span class="sxs-lookup"><span data-stu-id="8eed1-212">The **m\_szFileName** and **m\_dwMode** variables are private variables that are used to store the file's name and access flags.</span></span>


```C++
wchar_t m_szFileName[MAX_PATH];    // The file name
DWORD m_dwMode;                  // The file access mode

CSampleExtHandler::GetClassID(CLSID *pCLSID)
{
    *pCLSID = CLSID_SampleExtHandler;
}

CSampleExtHandler::Load(PCWSTR pszFile, DWORD dwMode)
{
    m_dwMode = dwMode;
    return StringCchCopy(_szFileName, ARRAYSIZE(m_szFileName), pszFile);
}
```

### <a name="implementing-ishellextinit"></a><span data-ttu-id="8eed1-213">Implementación de IShellExtInit</span><span class="sxs-lookup"><span data-stu-id="8eed1-213">Implementing IShellExtInit</span></span>

<span data-ttu-id="8eed1-214">La interfaz [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) tiene solo un método, [**IShellExtInit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize), además de [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span><span class="sxs-lookup"><span data-stu-id="8eed1-214">The [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface has only one method, [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize), in addition to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span></span> <span data-ttu-id="8eed1-215">El método tiene tres parámetros que el shell puede usar para pasar varios tipos de información.</span><span class="sxs-lookup"><span data-stu-id="8eed1-215">The method has three parameters that the Shell can use to pass in various types of information.</span></span> <span data-ttu-id="8eed1-216">Los valores pasados dependen del tipo de controlador y otros pueden establecerse en **null**.</span><span class="sxs-lookup"><span data-stu-id="8eed1-216">The values passed in depend on the type of handler, and some can be set to **NULL**.</span></span>

-   <span data-ttu-id="8eed1-217">*pIDFolder* contiene el puntero de una carpeta a una lista de identificadores de elementos (PIDL).</span><span class="sxs-lookup"><span data-stu-id="8eed1-217">*pIDFolder* holds a folder's pointer to an item identifier list (PIDL).</span></span> <span data-ttu-id="8eed1-218">En el caso de las extensiones de la hoja de propiedades, es **null**.</span><span class="sxs-lookup"><span data-stu-id="8eed1-218">For property sheet extensions, it is **NULL**.</span></span> <span data-ttu-id="8eed1-219">En el caso de las extensiones de menú contextual, es el PIDL de la carpeta que contiene el elemento cuyo menú contextual se muestra.</span><span class="sxs-lookup"><span data-stu-id="8eed1-219">For shortcut menu extensions, it is the PIDL of the folder that contains the item whose shortcut menu is being displayed.</span></span> <span data-ttu-id="8eed1-220">En el caso de los controladores no predeterminados de arrastrar y colocar, es el PIDL de la carpeta de destino.</span><span class="sxs-lookup"><span data-stu-id="8eed1-220">For nondefault drag-and-drop handlers, it is the PIDL of the target folder.</span></span>
-   <span data-ttu-id="8eed1-221">*pDataObject* contiene un puntero a la interfaz [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) de un objeto de datos.</span><span class="sxs-lookup"><span data-stu-id="8eed1-221">*pDataObject* holds a pointer to a data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span> <span data-ttu-id="8eed1-222">El objeto de datos contiene uno o varios nombres de archivo en formato [ \_ HDROP de CF](dragdrop.md) .</span><span class="sxs-lookup"><span data-stu-id="8eed1-222">The data object holds one or more file names in [CF\_HDROP](dragdrop.md) format.</span></span>
-   <span data-ttu-id="8eed1-223">*hRegKey* contiene una clave del registro para el tipo de carpeta o objeto de archivo.</span><span class="sxs-lookup"><span data-stu-id="8eed1-223">*hRegKey* holds a registry key for the file object or folder type.</span></span>

<span data-ttu-id="8eed1-224">El método [**IShellExtInit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) almacena el nombre de archivo, el puntero [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) y la clave del registro según sea necesario para su uso posterior.</span><span class="sxs-lookup"><span data-stu-id="8eed1-224">The [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) method stores the file name, [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) pointer, and registry key as needed for later use.</span></span> <span data-ttu-id="8eed1-225">En el fragmento de código siguiente se muestra una implementación de **IShellExtInit:: Initialize**.</span><span class="sxs-lookup"><span data-stu-id="8eed1-225">The following code fragment illustrates an implementation of **IShellExtInit::Initialize**.</span></span> <span data-ttu-id="8eed1-226">Para simplificar, en este ejemplo se da por supuesto que el objeto de datos contiene un solo archivo.</span><span class="sxs-lookup"><span data-stu-id="8eed1-226">For simplicity, this example assumes that the data object contains only a single file.</span></span> <span data-ttu-id="8eed1-227">En general, puede que contenga varios archivos que deberán extraerse cada uno.</span><span class="sxs-lookup"><span data-stu-id="8eed1-227">In general, it might contain multiple files that will each need to be extracted.</span></span>


```C++
LPCITEMIDLIST  m_pIDFolder;           //The folder's PIDL
wchar_t        m_szFile[MAX_PATH];    //The file name
IDataObject   *m_pDataObj;            //The IDataObject pointer
HKEY           m_hRegKey;             //The file or folder's registry key

STDMETHODIMP CShellExt::Initialize(LPCITEMIDLIST pIDFolder, 
                                   IDataObject *pDataObj, 
                                   HKEY hRegKey) 
{ 
    // If Initialize has already been called, release the old PIDL
    ILFree(m_pIDFolder);
    m_pIDFolder = nullptr;

    // Store the new PIDL.
    if (pIDFolder)
    {
        m_pIDFolder = ILClone(pIDFolder);
    }
    
    // If Initialize has already been called, release the old
    // IDataObject pointer.
    if (m_pDataObj)
    { 
        m_pDataObj->Release(); 
    }
     
    // If a data object pointer was passed in, save it and
    // extract the file name. 
    if (pDataObj) 
    { 
        m_pDataObj = pDataObj; 
        pDataObj->AddRef(); 
      
        STGMEDIUM   medium;
        FORMATETC   fe = {CF_HDROP, NULL, DVASPECT_CONTENT, -1, TYMED_HGLOBAL};
        UINT        uCount;

        if (SUCCEEDED(m_pDataObj->GetData(&fe, &medium)))
        {
            // Get the count of files dropped.
            uCount = DragQueryFile((HDROP)medium.hGlobal, (UINT)-1, NULL, 0);

            // Get the first file name from the CF_HDROP.
            if (uCount)
                DragQueryFile((HDROP)medium.hGlobal, 0, m_szFile, 
                              sizeof(m_szFile)/sizeof(TCHAR));

            ReleaseStgMedium(&medium);
        }
    }

    // Duplicate the registry handle. 
    if (hRegKey) 
        RegOpenKeyEx(hRegKey, nullptr, 0L, MAXIMUM_ALLOWED, &m_hRegKey); 
    return S_OK; 
}
```

<span data-ttu-id="8eed1-228">CSampleExtHandler es el nombre de la clase que se usa para implementar la interfaz.</span><span class="sxs-lookup"><span data-stu-id="8eed1-228">CSampleExtHandler is the name of the class used to implement the interface.</span></span> <span data-ttu-id="8eed1-229">Las **variables \_ m pIDFolder**, **m \_ pDataObject**, **m \_ szFileName** y **m \_ hRegKey** son variables privadas que se usan para almacenar la información que se pasa.</span><span class="sxs-lookup"><span data-stu-id="8eed1-229">The **m\_pIDFolder**, **m\_pDataObject**, **m\_szFileName**, and **m\_hRegKey** variables are private variables used to store the information that is passed in.</span></span> <span data-ttu-id="8eed1-230">Para simplificar, en este ejemplo se da por supuesto que solo el objeto de datos conservará un nombre de archivo.</span><span class="sxs-lookup"><span data-stu-id="8eed1-230">For simplicity, this example assumes that only one file name will be held by the data object.</span></span> <span data-ttu-id="8eed1-231">Una vez recuperada la estructura [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) del objeto de datos, se usa [**DragQueryFile**](/windows/desktop/api/Shellapi/nf-shellapi-dragqueryfilea) para extraer el nombre de archivo del miembro **Medium. hGlobal** de la estructura **FORMATETC** .</span><span class="sxs-lookup"><span data-stu-id="8eed1-231">After the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure is retrieved from the data object, [**DragQueryFile**](/windows/desktop/api/Shellapi/nf-shellapi-dragqueryfilea) is used to extract the file name from the **FORMATETC** structure's **medium.hGlobal** member.</span></span> <span data-ttu-id="8eed1-232">Si se pasa una clave del registro, el método usa [**RegOpenKeyEx**](/windows/win32/api/winreg/nf-winreg-regopenkeyexa) para abrir la clave y asigna el identificador a **m \_ hRegKey**.</span><span class="sxs-lookup"><span data-stu-id="8eed1-232">If a registry key is passed in, the method uses [**RegOpenKeyEx**](/windows/win32/api/winreg/nf-winreg-regopenkeyexa) to open the key and assigns the handle to **m\_hRegKey**.</span></span>

### <a name="infotip-customization"></a><span data-ttu-id="8eed1-233">Personalización de recuadro informativo</span><span class="sxs-lookup"><span data-stu-id="8eed1-233">Infotip Customization</span></span>

<span data-ttu-id="8eed1-234">Hay dos maneras de personalizar recuadros informativos:</span><span class="sxs-lookup"><span data-stu-id="8eed1-234">There are two ways to customize infotips:</span></span>

-   <span data-ttu-id="8eed1-235">Implemente un objeto que admita [**IQueryInfo**](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo) y, a continuación, registre ese objeto en la subclave adecuada del registro (consulte [registro de controladores de extensión de Shell](#registering-shell-extension-handlers) a continuación).</span><span class="sxs-lookup"><span data-stu-id="8eed1-235">Implement an object that supports [**IQueryInfo**](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo) and then register that object under the proper subkey in the registry (see [Registering Shell Extension Handlers](#registering-shell-extension-handlers) below).</span></span>
-   <span data-ttu-id="8eed1-236">Especifique una cadena fija o una lista de propiedades de archivo específicas que se van a mostrar.</span><span class="sxs-lookup"><span data-stu-id="8eed1-236">Specify a fixed string or a list of specific file properties to be displayed.</span></span>

<span data-ttu-id="8eed1-237">Para mostrar una cadena fija para una extensión de espacio de nombres, cree una entrada llamada `InfoTip` en la clave *{CLSID}* de la extensión de espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="8eed1-237">To display a fixed string for a namespace extension, create an entry called `InfoTip` in the *{CLSID}* key of your namespace extension.</span></span> <span data-ttu-id="8eed1-238">Establezca el valor de la entrada para que sea la cadena literal que desea mostrar, como se muestra en este ejemplo, o una cadena indirecta que especifique un recurso y un índice dentro de ese recurso (con fines de localización).</span><span class="sxs-lookup"><span data-stu-id="8eed1-238">Set the value of that entry to be either the literal string you want to display, as shown in this example, or an indirect string that specifies a resource and index within that resource (for localization purposes).</span></span>

```
HKEY_CLASSES_ROOT
   CLSID
      {CLSID}
         InfoTip = InfoTip string for your namespace extension
```

<span data-ttu-id="8eed1-239">Para mostrar una cadena fija para un tipo de archivo, cree una entrada llamada `InfoTip` en la clave *ProgID* de ese tipo de archivo.</span><span class="sxs-lookup"><span data-stu-id="8eed1-239">To display a fixed string for a file type, create an entry called `InfoTip` in the *ProgID* key of that file type.</span></span> <span data-ttu-id="8eed1-240">Establezca el valor de la entrada para que sea la cadena literal que desea mostrar o una cadena indirecta que especifique un recurso y un índice dentro de ese recurso (para la localización), tal como se muestra en este ejemplo.</span><span class="sxs-lookup"><span data-stu-id="8eed1-240">Set the value of that entry to be either the literal string you want to display or an indirect string that specifies a resource and index within that resource (for localization purposes), as shown in this example.</span></span>

```
HKEY_CLASSES_ROOT
   ProgID
      InfoTip = Resource.dll, 3
```

<span data-ttu-id="8eed1-241">Si desea que el shell muestre propiedades de archivo específicas en el recuadro informativo para un tipo de archivo específico, cree una entrada llamada `InfoTip` en la clave *ProgID* para ese tipo de archivo.</span><span class="sxs-lookup"><span data-stu-id="8eed1-241">If you want the Shell to display specific file properties in the infotip for a specific file type, create an entry called `InfoTip` in the *ProgID* key for that file type.</span></span> <span data-ttu-id="8eed1-242">Establezca el valor de esa entrada en una lista delimitada por punto y coma de nombres de propiedad canónicos, pares de identificador de formato (FMTID) (PID) o ambos.</span><span class="sxs-lookup"><span data-stu-id="8eed1-242">Set the value of that entry to be a semicolon-delineated list of canonical property names, format identifier (FMTID)/property identifier (PID) pairs, or both.</span></span> <span data-ttu-id="8eed1-243">Este valor debe comenzar por "prop:" para identificarlo como una cadena de lista de propiedades.</span><span class="sxs-lookup"><span data-stu-id="8eed1-243">This value must begin with "prop:" to identify it as a property list string.</span></span> <span data-ttu-id="8eed1-244">Si se omite "prop:", el valor se considera una cadena literal y se muestra como tal.</span><span class="sxs-lookup"><span data-stu-id="8eed1-244">If you omit "prop:", the value is seen as a literal string and displayed as such.</span></span>

<span data-ttu-id="8eed1-245">En el ejemplo siguiente, *propName* es un nombre de propiedad canónico (como System. Date) y *{fmtid}, el PID* es un par [**fmtid/PID**](./objects.md) .</span><span class="sxs-lookup"><span data-stu-id="8eed1-245">In the following example, *propname* is a canonical property name (such as System.Date) and *{fmtid},pid* is an [**FMTID/PID**](./objects.md) pair.</span></span>

```
HKEY_CLASSES_ROOT
   ProgID
      InfoTip = prop:propname;propname;{fmtid},pid;{fmtid},pid
```

<span data-ttu-id="8eed1-246">Se pueden usar los siguientes nombres de propiedad:</span><span class="sxs-lookup"><span data-stu-id="8eed1-246">The following property names can be used:</span></span>



| <span data-ttu-id="8eed1-247">Nombre de la propiedad</span><span class="sxs-lookup"><span data-stu-id="8eed1-247">Property Name</span></span>    | <span data-ttu-id="8eed1-248">Descripción</span><span class="sxs-lookup"><span data-stu-id="8eed1-248">Description</span></span>                   | <span data-ttu-id="8eed1-249">Recuperado de</span><span class="sxs-lookup"><span data-stu-id="8eed1-249">Retrieved From</span></span>                                                                             |
|------------------|-------------------------------|--------------------------------------------------------------------------------------------|
| <span data-ttu-id="8eed1-250">Autor</span><span class="sxs-lookup"><span data-stu-id="8eed1-250">Author</span></span>           | <span data-ttu-id="8eed1-251">Autor del documento</span><span class="sxs-lookup"><span data-stu-id="8eed1-251">Author of the document</span></span>        | [<span data-ttu-id="8eed1-252">**autor de PIDSI \_**</span><span class="sxs-lookup"><span data-stu-id="8eed1-252">**PIDSI\_AUTHOR**</span></span>](../stg/the-summary-information-property-set.md)                              |
| <span data-ttu-id="8eed1-253">Title</span><span class="sxs-lookup"><span data-stu-id="8eed1-253">Title</span></span>            | <span data-ttu-id="8eed1-254">Título del documento</span><span class="sxs-lookup"><span data-stu-id="8eed1-254">Title of the document</span></span>         | [<span data-ttu-id="8eed1-255">**título de PIDSI \_**</span><span class="sxs-lookup"><span data-stu-id="8eed1-255">**PIDSI\_TITLE**</span></span>](../stg/the-summary-information-property-set.md)                               |
| <span data-ttu-id="8eed1-256">Asunto</span><span class="sxs-lookup"><span data-stu-id="8eed1-256">Subject</span></span>          | <span data-ttu-id="8eed1-257">Resumen de asunto</span><span class="sxs-lookup"><span data-stu-id="8eed1-257">Subject summary</span></span>               | [<span data-ttu-id="8eed1-258">**\_asunto PIDSI**</span><span class="sxs-lookup"><span data-stu-id="8eed1-258">**PIDSI\_SUBJECT**</span></span>](../stg/the-summary-information-property-set.md)                             |
| <span data-ttu-id="8eed1-259">Comentario</span><span class="sxs-lookup"><span data-stu-id="8eed1-259">Comment</span></span>          | <span data-ttu-id="8eed1-260">Comentarios del documento</span><span class="sxs-lookup"><span data-stu-id="8eed1-260">Document comments</span></span>             | <span data-ttu-id="8eed1-261">[**PIDSI \_**](../stg/the-summary-information-property-set.md) Propiedades de comentario o carpeta/controlador</span><span class="sxs-lookup"><span data-stu-id="8eed1-261">[**PIDSI\_COMMENT**](../stg/the-summary-information-property-set.md) or folder/driver properties</span></span> |
| <span data-ttu-id="8eed1-262">PageCount</span><span class="sxs-lookup"><span data-stu-id="8eed1-262">PageCount</span></span>        | <span data-ttu-id="8eed1-263">Número de páginas</span><span class="sxs-lookup"><span data-stu-id="8eed1-263">Number of pages</span></span>               | [<span data-ttu-id="8eed1-264">**PIDSI \_ PAGECOUNT**</span><span class="sxs-lookup"><span data-stu-id="8eed1-264">**PIDSI\_PAGECOUNT**</span></span>](../stg/the-summary-information-property-set.md)                           |
| <span data-ttu-id="8eed1-265">Nombre</span><span class="sxs-lookup"><span data-stu-id="8eed1-265">Name</span></span>             | <span data-ttu-id="8eed1-266">Nombre descriptivo</span><span class="sxs-lookup"><span data-stu-id="8eed1-266">Friendly name</span></span>                 | <span data-ttu-id="8eed1-267">Vista de carpetas estándar</span><span class="sxs-lookup"><span data-stu-id="8eed1-267">Standard folder view</span></span>                                                                       |
| <span data-ttu-id="8eed1-268">OriginalLocation</span><span class="sxs-lookup"><span data-stu-id="8eed1-268">OriginalLocation</span></span> | <span data-ttu-id="8eed1-269">Ubicación del archivo original</span><span class="sxs-lookup"><span data-stu-id="8eed1-269">Location of original file</span></span>     | <span data-ttu-id="8eed1-270">Carpeta de mi maletín y carpeta de la papelera de reciclaje</span><span class="sxs-lookup"><span data-stu-id="8eed1-270">Briefcase folder and Recycle Bin folder</span></span>                                                    |
| <span data-ttu-id="8eed1-271">DateDeleted</span><span class="sxs-lookup"><span data-stu-id="8eed1-271">DateDeleted</span></span>      | <span data-ttu-id="8eed1-272">Se eliminó el archivo de fecha</span><span class="sxs-lookup"><span data-stu-id="8eed1-272">Date file was deleted</span></span>         | <span data-ttu-id="8eed1-273">Carpeta de la papelera de reciclaje</span><span class="sxs-lookup"><span data-stu-id="8eed1-273">Recycle Bin folder</span></span>                                                                         |
| <span data-ttu-id="8eed1-274">Tipo</span><span class="sxs-lookup"><span data-stu-id="8eed1-274">Type</span></span>             | <span data-ttu-id="8eed1-275">Tipo de archivo</span><span class="sxs-lookup"><span data-stu-id="8eed1-275">Type of file</span></span>                  | <span data-ttu-id="8eed1-276">Vista de detalles de carpetas estándar</span><span class="sxs-lookup"><span data-stu-id="8eed1-276">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="8eed1-277">Tamaño</span><span class="sxs-lookup"><span data-stu-id="8eed1-277">Size</span></span>             | <span data-ttu-id="8eed1-278">Tamaño del archivo</span><span class="sxs-lookup"><span data-stu-id="8eed1-278">Size of file</span></span>                  | <span data-ttu-id="8eed1-279">Vista de detalles de carpetas estándar</span><span class="sxs-lookup"><span data-stu-id="8eed1-279">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="8eed1-280">SyncCopyIn</span><span class="sxs-lookup"><span data-stu-id="8eed1-280">SyncCopyIn</span></span>       | <span data-ttu-id="8eed1-281">Igual que OriginalLocation</span><span class="sxs-lookup"><span data-stu-id="8eed1-281">Same as OriginalLocation</span></span>      | <span data-ttu-id="8eed1-282">Igual que OriginalLocation</span><span class="sxs-lookup"><span data-stu-id="8eed1-282">Same as OriginalLocation</span></span>                                                                   |
| <span data-ttu-id="8eed1-283">Modificado</span><span class="sxs-lookup"><span data-stu-id="8eed1-283">Modified</span></span>         | <span data-ttu-id="8eed1-284">Fecha de última modificación</span><span class="sxs-lookup"><span data-stu-id="8eed1-284">Date last modified</span></span>            | <span data-ttu-id="8eed1-285">Vista de detalles de carpetas estándar</span><span class="sxs-lookup"><span data-stu-id="8eed1-285">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="8eed1-286">Creado</span><span class="sxs-lookup"><span data-stu-id="8eed1-286">Created</span></span>          | <span data-ttu-id="8eed1-287">Fecha de creación</span><span class="sxs-lookup"><span data-stu-id="8eed1-287">Date created</span></span>                  | <span data-ttu-id="8eed1-288">Vista de detalles de carpetas estándar</span><span class="sxs-lookup"><span data-stu-id="8eed1-288">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="8eed1-289">Acceso</span><span class="sxs-lookup"><span data-stu-id="8eed1-289">Accessed</span></span>         | <span data-ttu-id="8eed1-290">Fecha de último acceso</span><span class="sxs-lookup"><span data-stu-id="8eed1-290">Date last accessed</span></span>            | <span data-ttu-id="8eed1-291">Vista de detalles de carpetas estándar</span><span class="sxs-lookup"><span data-stu-id="8eed1-291">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="8eed1-292">InFolder</span><span class="sxs-lookup"><span data-stu-id="8eed1-292">InFolder</span></span>         | <span data-ttu-id="8eed1-293">Directorio que contiene el archivo</span><span class="sxs-lookup"><span data-stu-id="8eed1-293">Directory containing the file</span></span> | <span data-ttu-id="8eed1-294">Resultados de búsqueda de documentos</span><span class="sxs-lookup"><span data-stu-id="8eed1-294">Document search results</span></span>                                                                    |
| <span data-ttu-id="8eed1-295">Rango</span><span class="sxs-lookup"><span data-stu-id="8eed1-295">Rank</span></span>             | <span data-ttu-id="8eed1-296">Calidad de coincidencia de búsqueda</span><span class="sxs-lookup"><span data-stu-id="8eed1-296">Quality of search match</span></span>       | <span data-ttu-id="8eed1-297">Resultados de búsqueda de documentos</span><span class="sxs-lookup"><span data-stu-id="8eed1-297">Document search results</span></span>                                                                    |
| <span data-ttu-id="8eed1-298">FreeSpace</span><span class="sxs-lookup"><span data-stu-id="8eed1-298">FreeSpace</span></span>        | <span data-ttu-id="8eed1-299">Espacio de almacenamiento disponible</span><span class="sxs-lookup"><span data-stu-id="8eed1-299">Available storage space</span></span>       | <span data-ttu-id="8eed1-300">Unidades de disco</span><span class="sxs-lookup"><span data-stu-id="8eed1-300">Disk drives</span></span>                                                                                |
| <span data-ttu-id="8eed1-301">NumberOfVisits</span><span class="sxs-lookup"><span data-stu-id="8eed1-301">NumberOfVisits</span></span>   | <span data-ttu-id="8eed1-302">Número de visitas</span><span class="sxs-lookup"><span data-stu-id="8eed1-302">Number of visits</span></span>              | <span data-ttu-id="8eed1-303">carpeta Favoritos</span><span class="sxs-lookup"><span data-stu-id="8eed1-303">Favorites folder</span></span>                                                                           |
| <span data-ttu-id="8eed1-304">Atributos</span><span class="sxs-lookup"><span data-stu-id="8eed1-304">Attributes</span></span>       | <span data-ttu-id="8eed1-305">Atributos de archivo</span><span class="sxs-lookup"><span data-stu-id="8eed1-305">File Attributes</span></span>               | <span data-ttu-id="8eed1-306">Vista de detalles de carpetas estándar</span><span class="sxs-lookup"><span data-stu-id="8eed1-306">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="8eed1-307">Compañía</span><span class="sxs-lookup"><span data-stu-id="8eed1-307">Company</span></span>          | <span data-ttu-id="8eed1-308">Nombre de la compañía</span><span class="sxs-lookup"><span data-stu-id="8eed1-308">Company name</span></span>                  | [<span data-ttu-id="8eed1-309">**\_empresa PIDDSI**</span><span class="sxs-lookup"><span data-stu-id="8eed1-309">**PIDDSI\_COMPANY**</span></span>](../stg/the-documentsummaryinformation-and-userdefined-property-sets.md)    |
| <span data-ttu-id="8eed1-310">Category</span><span class="sxs-lookup"><span data-stu-id="8eed1-310">Category</span></span>         | <span data-ttu-id="8eed1-311">Categoría del documento</span><span class="sxs-lookup"><span data-stu-id="8eed1-311">Document category</span></span>             | [<span data-ttu-id="8eed1-312">**\_categoría PIDDSI**</span><span class="sxs-lookup"><span data-stu-id="8eed1-312">**PIDDSI\_CATEGORY**</span></span>](../stg/the-documentsummaryinformation-and-userdefined-property-sets.md)   |
| <span data-ttu-id="8eed1-313">Copyright</span><span class="sxs-lookup"><span data-stu-id="8eed1-313">Copyright</span></span>        | <span data-ttu-id="8eed1-314">Copyright de los medios</span><span class="sxs-lookup"><span data-stu-id="8eed1-314">Media copyright</span></span>               | [<span data-ttu-id="8eed1-315">**COPYRIGHT de PIDMSI \_**</span><span class="sxs-lookup"><span data-stu-id="8eed1-315">**PIDMSI\_COPYRIGHT**</span></span>](../stg/the-documentsummaryinformation-and-userdefined-property-sets.md)  |
| <span data-ttu-id="8eed1-316">HTMLInfoTipFile</span><span class="sxs-lookup"><span data-stu-id="8eed1-316">HTMLInfoTipFile</span></span>  | <span data-ttu-id="8eed1-317">Archivo recuadro informativo HTML</span><span class="sxs-lookup"><span data-stu-id="8eed1-317">HTML InfoTip file</span></span>             | <span data-ttu-id="8eed1-318">Desktop.ini archivo para la carpeta</span><span class="sxs-lookup"><span data-stu-id="8eed1-318">Desktop.ini file for folder</span></span>                                                                |



 

## <a name="enhancing-windows-search-with-shell-extension-handlers"></a><span data-ttu-id="8eed1-319">Mejorar Windows Search con controladores de extensión de Shell</span><span class="sxs-lookup"><span data-stu-id="8eed1-319">Enhancing Windows Search with Shell Extension Handlers</span></span>

<span data-ttu-id="8eed1-320">Los controladores de extensión de Shell se pueden usar para mejorar la experiencia del usuario que proporciona un controlador de protocolo de Windows Search.</span><span class="sxs-lookup"><span data-stu-id="8eed1-320">Shell extension handlers may be used to enhance the user experience provided by a Windows Search protocol handler.</span></span> <span data-ttu-id="8eed1-321">Para habilitar dichas mejoras, el controlador de extensión de Shell auxiliar debe estar diseñado para integrarse con el controlador de protocolo de búsqueda como origen de datos.</span><span class="sxs-lookup"><span data-stu-id="8eed1-321">To enable such enhancements, the supporting Shell extension handler must be designed to integrate with the search protocol handler as a data source.</span></span> <span data-ttu-id="8eed1-322">Para obtener información sobre cómo mejorar un controlador de protocolo de Windows Search mediante la integración con un controlador de extensión de Shell, vea [Agregar iconos, vistas previas y menús contextuales](../search/-search-3x-wds-ph-ui-extensions.md).</span><span class="sxs-lookup"><span data-stu-id="8eed1-322">For information about how to enhance a Windows Search protocol handler through integration with a Shell extension handler, see [Adding Icons, Previews and Shortcut Menus](../search/-search-3x-wds-ph-ui-extensions.md).</span></span> <span data-ttu-id="8eed1-323">Para obtener más información acerca de los controladores de protocolo de Windows Search, consulte [desarrollar controladores de protocolo](../search/-search-3x-wds-phaddins.md).</span><span class="sxs-lookup"><span data-stu-id="8eed1-323">For more information about Windows Search protocol handlers, see [Developing Protocol Handlers](../search/-search-3x-wds-phaddins.md).</span></span>

## <a name="registering-shell-extension-handlers"></a><span data-ttu-id="8eed1-324">Registrando controladores de extensión de Shell</span><span class="sxs-lookup"><span data-stu-id="8eed1-324">Registering Shell Extension Handlers</span></span>

<span data-ttu-id="8eed1-325">Un objeto de controlador de extensión de Shell debe registrarse antes de que el shell pueda usarlo.</span><span class="sxs-lookup"><span data-stu-id="8eed1-325">A Shell extension handler object must be registered before the Shell can use it.</span></span> <span data-ttu-id="8eed1-326">Esta sección es una discusión general sobre cómo registrar un controlador de extensión de Shell.</span><span class="sxs-lookup"><span data-stu-id="8eed1-326">This section is a general discussion of how to register a Shell extension handler.</span></span>

<span data-ttu-id="8eed1-327">Cada vez que crea o cambia un controlador de extensión de Shell, es importante notificar al sistema que ha realizado un cambio con [**SHChangeNotify**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify), especificando el **evento \_ ASSOCCHANGED de SHCNE** .</span><span class="sxs-lookup"><span data-stu-id="8eed1-327">Any time you create or change a Shell extension handler, it is important to notify the system that you have made a change with [**SHChangeNotify**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify), specifying the **SHCNE\_ASSOCCHANGED** event.</span></span> <span data-ttu-id="8eed1-328">Si no llama a **SHChangeNotify**, es posible que no se reconozca el cambio hasta que se reinicie el sistema.</span><span class="sxs-lookup"><span data-stu-id="8eed1-328">If you do not call **SHChangeNotify**, the change might not be recognized until the system is rebooted.</span></span>

<span data-ttu-id="8eed1-329">Al igual que con todos los objetos COM, debe crear un GUID para el controlador mediante una herramienta como UUIDGEN.exe.</span><span class="sxs-lookup"><span data-stu-id="8eed1-329">As with all COM objects, you must create a GUID for the handler using a tool such as UUIDGEN.exe.</span></span> <span data-ttu-id="8eed1-330">Cree una clave en **\_ las clases HKEY \_ raíz** \\ **CLSID** cuyo nombre es la forma de cadena del GUID.</span><span class="sxs-lookup"><span data-stu-id="8eed1-330">Create a key under **HKEY\_CLASSES\_ROOT**\\**CLSID** whose name is the string form of the GUID.</span></span> <span data-ttu-id="8eed1-331">Dado que los controladores de la extensión de Shell son servidores en proceso, debe crear una clave **InProcServer32** en la clave GUID con el valor predeterminado establecido en la ruta de acceso de la dll del controlador.</span><span class="sxs-lookup"><span data-stu-id="8eed1-331">Because Shell extension handlers are in-process servers, you must create an **InProcServer32** key under the GUID key with the default value set to the path of the handler's DLL.</span></span> <span data-ttu-id="8eed1-332">Use el modelo de subprocesos de apartamento.</span><span class="sxs-lookup"><span data-stu-id="8eed1-332">Use the Apartment threading model.</span></span>

<span data-ttu-id="8eed1-333">Cada vez que el shell realiza una acción que puede incluir un controlador de extensión de Shell, comprueba la clave del registro adecuada.</span><span class="sxs-lookup"><span data-stu-id="8eed1-333">Any time the Shell takes an action that can involve a Shell extension handler, it checks the appropriate registry key.</span></span> <span data-ttu-id="8eed1-334">La clave bajo la que se registra un controlador de extensión, por lo que controla cuándo se llamará.</span><span class="sxs-lookup"><span data-stu-id="8eed1-334">The key under which an extension handler is registered thus controls when it will be called.</span></span> <span data-ttu-id="8eed1-335">Por ejemplo, es una práctica común tener un controlador de menú contextual llamado cuando el shell muestra un menú contextual para un miembro de un [tipo de archivo](fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="8eed1-335">For instance, it is a common practice to have a shortcut menu handler called when the Shell displays a shortcut menu for a member of a [file type](fa-file-types.md).</span></span> <span data-ttu-id="8eed1-336">En este caso, el controlador debe estar registrado en la clave **ProgID** del tipo de archivo.</span><span class="sxs-lookup"><span data-stu-id="8eed1-336">In this case, the handler must be registered under the file type's **ProgID** key.</span></span>

### <a name="handler-names"></a><span data-ttu-id="8eed1-337">Nombres de controlador</span><span class="sxs-lookup"><span data-stu-id="8eed1-337">Handler Names</span></span>

<span data-ttu-id="8eed1-338">Para habilitar un controlador de extensión de Shell, cree una subclave con el nombre de la subclave del controlador (consulte a continuación) en la subclave **ShellEx** del **ProgID** (para tipos de archivo) o el nombre del tipo de objeto de Shell (para [objetos de Shell predefinidos](#predefined-shell-objects)).</span><span class="sxs-lookup"><span data-stu-id="8eed1-338">To enable a Shell extension handler, create a subkey with the handler subkey name (see below) under the **ShellEx** subkey of either the **ProgID** (for file types) or the Shell object type name (for [Predefined Shell Objects](#predefined-shell-objects)).</span></span>

<span data-ttu-id="8eed1-339">Por ejemplo, si desea registrar un controlador de extensión de menú contextual para el programa. 1, comenzaría con la creación de la siguiente subclave:</span><span class="sxs-lookup"><span data-stu-id="8eed1-339">For example, if you wanted to register a shortcut menu extension handler for MyProgram.1, you would begin by creating the following subkey:</span></span>

```
HKEY_CLASSES_ROOT
   MyProgram.1
      ShellEx
         ContextMenuHandlers
```

<span data-ttu-id="8eed1-340">En el caso de los siguientes controladores, cree una subclave debajo de la clave "controlador nombre de la subclave" cuyo nombre es la versión de cadena del CLSID de la extensión de Shell.</span><span class="sxs-lookup"><span data-stu-id="8eed1-340">For the following handlers, create a subkey underneath the "Handler Subkey name" key whose name is the string version of the CLSID of the Shell extension.</span></span> <span data-ttu-id="8eed1-341">Se pueden registrar varias extensiones en la clave de nombre de la subclave del controlador mediante la creación de varias subclaves.</span><span class="sxs-lookup"><span data-stu-id="8eed1-341">Multiple extensions can be registered under the handler subkey name key by creating multiple subkeys.</span></span>



| <span data-ttu-id="8eed1-342">Controlador</span><span class="sxs-lookup"><span data-stu-id="8eed1-342">Handler</span></span>                                               | <span data-ttu-id="8eed1-343">Interfaz</span><span class="sxs-lookup"><span data-stu-id="8eed1-343">Interface</span></span>          | <span data-ttu-id="8eed1-344">Nombre de la subclave del controlador</span><span class="sxs-lookup"><span data-stu-id="8eed1-344">Handler Subkey Name</span></span>       |
|-------------------------------------------------------|--------------------|---------------------------|
| <span data-ttu-id="8eed1-345">Controlador del menú contextual</span><span class="sxs-lookup"><span data-stu-id="8eed1-345">Shortcut menu handler</span></span>                                 | <span data-ttu-id="8eed1-346">IContextMenu</span><span class="sxs-lookup"><span data-stu-id="8eed1-346">IContextMenu</span></span>       | <span data-ttu-id="8eed1-347">**ContextMenuHandlers**</span><span class="sxs-lookup"><span data-stu-id="8eed1-347">**ContextMenuHandlers**</span></span>   |
| <span data-ttu-id="8eed1-348">Controlador Copyhook</span><span class="sxs-lookup"><span data-stu-id="8eed1-348">Copyhook handler</span></span>                                      | <span data-ttu-id="8eed1-349">ICopyHook</span><span class="sxs-lookup"><span data-stu-id="8eed1-349">ICopyHook</span></span>          | <span data-ttu-id="8eed1-350">**CopyHookHandlers**</span><span class="sxs-lookup"><span data-stu-id="8eed1-350">**CopyHookHandlers**</span></span>      |
| <span data-ttu-id="8eed1-351">Controlador de arrastrar y colocar</span><span class="sxs-lookup"><span data-stu-id="8eed1-351">Drag-and-drop handler</span></span>                                 | <span data-ttu-id="8eed1-352">IContextMenu</span><span class="sxs-lookup"><span data-stu-id="8eed1-352">IContextMenu</span></span>       | <span data-ttu-id="8eed1-353">**DragDropHandlers**</span><span class="sxs-lookup"><span data-stu-id="8eed1-353">**DragDropHandlers**</span></span>      |
| <span data-ttu-id="8eed1-354">Controlador de la hoja de propiedades</span><span class="sxs-lookup"><span data-stu-id="8eed1-354">Property sheet handler</span></span>                                | <span data-ttu-id="8eed1-355">IShellPropSheetExt</span><span class="sxs-lookup"><span data-stu-id="8eed1-355">IShellPropSheetExt</span></span> | <span data-ttu-id="8eed1-356">**PropertySheetHandlers**</span><span class="sxs-lookup"><span data-stu-id="8eed1-356">**PropertySheetHandlers**</span></span> |
| <span data-ttu-id="8eed1-357">Controlador de proveedor de columnas (desusado en Windows Vista)</span><span class="sxs-lookup"><span data-stu-id="8eed1-357">Column provider handler (deprecated in Windows Vista)</span></span> | <span data-ttu-id="8eed1-358">IColumnProvider</span><span class="sxs-lookup"><span data-stu-id="8eed1-358">IColumnProvider</span></span>    | <span data-ttu-id="8eed1-359">**ColumnHandlers**</span><span class="sxs-lookup"><span data-stu-id="8eed1-359">**ColumnHandlers**</span></span>        |



 

<span data-ttu-id="8eed1-360">En el caso de los siguientes controladores, el valor predeterminado de la clave "nombre de subclave de controlador" es la versión de cadena del CLSID de la extensión de Shell.</span><span class="sxs-lookup"><span data-stu-id="8eed1-360">For the following handlers, the default value of the "Handler Subkey Name" key is the string version of the CLSID of the Shell extension.</span></span> <span data-ttu-id="8eed1-361">Solo se puede registrar una extensión para estos controladores.</span><span class="sxs-lookup"><span data-stu-id="8eed1-361">Only one extension can be registered for these handlers.</span></span>



| <span data-ttu-id="8eed1-362">Controlador</span><span class="sxs-lookup"><span data-stu-id="8eed1-362">Handler</span></span>                 | <span data-ttu-id="8eed1-363">Interfaz</span><span class="sxs-lookup"><span data-stu-id="8eed1-363">Interface</span></span>                                         | <span data-ttu-id="8eed1-364">Nombre de la subclave del controlador</span><span class="sxs-lookup"><span data-stu-id="8eed1-364">Handler Subkey Name</span></span>                        |
|-------------------------|---------------------------------------------------|--------------------------------------------|
| <span data-ttu-id="8eed1-365">Controlador de datos</span><span class="sxs-lookup"><span data-stu-id="8eed1-365">Data handler</span></span>            | <span data-ttu-id="8eed1-366">IDataObject</span><span class="sxs-lookup"><span data-stu-id="8eed1-366">IDataObject</span></span>                                       | <span data-ttu-id="8eed1-367">**DataHandler**</span><span class="sxs-lookup"><span data-stu-id="8eed1-367">**DataHandler**</span></span>                            |
| <span data-ttu-id="8eed1-368">Quitar controlador</span><span class="sxs-lookup"><span data-stu-id="8eed1-368">Drop handler</span></span>            | <span data-ttu-id="8eed1-369">IDropTarget</span><span class="sxs-lookup"><span data-stu-id="8eed1-369">IDropTarget</span></span>                                       | <span data-ttu-id="8eed1-370">**DropHandler**</span><span class="sxs-lookup"><span data-stu-id="8eed1-370">**DropHandler**</span></span>                            |
| <span data-ttu-id="8eed1-371">Controlador de iconos</span><span class="sxs-lookup"><span data-stu-id="8eed1-371">Icon handler</span></span>            | <span data-ttu-id="8eed1-372">IExtractIconA/W</span><span class="sxs-lookup"><span data-stu-id="8eed1-372">IExtractIconA/W</span></span>                                   | <span data-ttu-id="8eed1-373">**IconHandler**</span><span class="sxs-lookup"><span data-stu-id="8eed1-373">**IconHandler**</span></span>                            |
| <span data-ttu-id="8eed1-374">Controlador de imagen</span><span class="sxs-lookup"><span data-stu-id="8eed1-374">Image handler</span></span>           | <span data-ttu-id="8eed1-375">IExtractImage</span><span class="sxs-lookup"><span data-stu-id="8eed1-375">IExtractImage</span></span>                                     | <span data-ttu-id="8eed1-376">**{BB2E617C-0920-11d1-9A0B-00C04FC2D6C1}**</span><span class="sxs-lookup"><span data-stu-id="8eed1-376">**{BB2E617C-0920-11d1-9A0B-00C04FC2D6C1}**</span></span> |
| <span data-ttu-id="8eed1-377">Controlador de imagen en miniatura</span><span class="sxs-lookup"><span data-stu-id="8eed1-377">Thumbnail image handler</span></span> | <span data-ttu-id="8eed1-378">IThumbnailProvider</span><span class="sxs-lookup"><span data-stu-id="8eed1-378">IThumbnailProvider</span></span>                                | <span data-ttu-id="8eed1-379">**{E357FCCD-A995-4576-B01F-234630154E96}**</span><span class="sxs-lookup"><span data-stu-id="8eed1-379">**{E357FCCD-A995-4576-B01F-234630154E96}**</span></span> |
| <span data-ttu-id="8eed1-380">Controlador de recuadro informativo</span><span class="sxs-lookup"><span data-stu-id="8eed1-380">Infotip handler</span></span>         | <span data-ttu-id="8eed1-381">IQueryInfo</span><span class="sxs-lookup"><span data-stu-id="8eed1-381">IQueryInfo</span></span>                                        | <span data-ttu-id="8eed1-382">**{00021500-0000-0000-C000-000000000046}**</span><span class="sxs-lookup"><span data-stu-id="8eed1-382">**{00021500-0000-0000-C000-000000000046}**</span></span> |
| <span data-ttu-id="8eed1-383">Vínculo de Shell (ANSI)</span><span class="sxs-lookup"><span data-stu-id="8eed1-383">Shell link (ANSI )</span></span>      | <span data-ttu-id="8eed1-384">IShellLinkA</span><span class="sxs-lookup"><span data-stu-id="8eed1-384">IShellLinkA</span></span>                                       | <span data-ttu-id="8eed1-385">**{000214EE-0000-0000-C000-000000000046}**</span><span class="sxs-lookup"><span data-stu-id="8eed1-385">**{000214EE-0000-0000-C000-000000000046}**</span></span> |
| <span data-ttu-id="8eed1-386">Vínculo de Shell (Unicode)</span><span class="sxs-lookup"><span data-stu-id="8eed1-386">Shell link (UNICODE)</span></span>    | <span data-ttu-id="8eed1-387">IShellLinkW</span><span class="sxs-lookup"><span data-stu-id="8eed1-387">IShellLinkW</span></span>                                       | <span data-ttu-id="8eed1-388">**{000214F9-0000-0000-C000-000000000046}**</span><span class="sxs-lookup"><span data-stu-id="8eed1-388">**{000214F9-0000-0000-C000-000000000046}**</span></span> |
| <span data-ttu-id="8eed1-389">Almacenamiento estructurado</span><span class="sxs-lookup"><span data-stu-id="8eed1-389">Structured storage</span></span>      | <span data-ttu-id="8eed1-390">IStorage</span><span class="sxs-lookup"><span data-stu-id="8eed1-390">IStorage</span></span>                                          | <span data-ttu-id="8eed1-391">**{0000000B-0000-0000-C000-000000000046}**</span><span class="sxs-lookup"><span data-stu-id="8eed1-391">**{0000000B-0000-0000-C000-000000000046}**</span></span> |
| <span data-ttu-id="8eed1-392">Metadatos</span><span class="sxs-lookup"><span data-stu-id="8eed1-392">Metadata</span></span>                | <span data-ttu-id="8eed1-393">IPropertyStore</span><span class="sxs-lookup"><span data-stu-id="8eed1-393">IPropertyStore</span></span>                                    | <span data-ttu-id="8eed1-394">**PropertyHandler**</span><span class="sxs-lookup"><span data-stu-id="8eed1-394">**PropertyHandler**</span></span>                        |
| <span data-ttu-id="8eed1-395">Metadatos</span><span class="sxs-lookup"><span data-stu-id="8eed1-395">Metadata</span></span>                | <span data-ttu-id="8eed1-396">IPropertySetStorage (en desuso en Windows Vista)</span><span class="sxs-lookup"><span data-stu-id="8eed1-396">IPropertySetStorage (deprecated in Windows Vista)</span></span> | <span data-ttu-id="8eed1-397">**PropertyHandler**</span><span class="sxs-lookup"><span data-stu-id="8eed1-397">**PropertyHandler**</span></span>                        |
| <span data-ttu-id="8eed1-398">Anclar al menú Inicio</span><span class="sxs-lookup"><span data-stu-id="8eed1-398">Pin to Start Menu</span></span>       | <span data-ttu-id="8eed1-399">IStartMenuPinnedList</span><span class="sxs-lookup"><span data-stu-id="8eed1-399">IStartMenuPinnedList</span></span>                              | <span data-ttu-id="8eed1-400">**{a2a9545d-a0c2-42b4-9708-a0b2badd77c8}**</span><span class="sxs-lookup"><span data-stu-id="8eed1-400">**{a2a9545d-a0c2-42b4-9708-a0b2badd77c8}**</span></span> |
| <span data-ttu-id="8eed1-401">Anclar a la barra de tareas</span><span class="sxs-lookup"><span data-stu-id="8eed1-401">Pin to Taskbar</span></span>          |                                                   | <span data-ttu-id="8eed1-402">**{90AA3A4E-1CBA-4233-B8BB-535773D48449}**</span><span class="sxs-lookup"><span data-stu-id="8eed1-402">**{90AA3A4E-1CBA-4233-B8BB-535773D48449}**</span></span> |



 

<span data-ttu-id="8eed1-403">Las subclaves especificadas para agregar **anclar al menú Inicio** y **anclar a la barra de tareas** al menú contextual de un elemento solo son necesarias para los tipos de archivo que incluyen la entrada [IsShortCut](./links.md) .</span><span class="sxs-lookup"><span data-stu-id="8eed1-403">The subkeys specified to add **Pin to Start Menu** and **Pin to Taskbar** to an item's shortcut menu are only required for file types that include the [IsShortCut](./links.md) entry.</span></span>

<span data-ttu-id="8eed1-404">Se ha quitado la compatibilidad con controladores de proveedor de columnas en Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="8eed1-404">Support for column provider handlers was removed in Windows Vista.</span></span> <span data-ttu-id="8eed1-405">Además, a partir de Windows Vista, [**IPropertySetStorage**](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage) está en desuso en favor de [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span><span class="sxs-lookup"><span data-stu-id="8eed1-405">Also, as of Windows Vista, [**IPropertySetStorage**](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage) has been deprecated in favor of [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span></span>

<span data-ttu-id="8eed1-406">Aunque [**IExtractImage**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iextractimage) sigue siendo compatible, se prefiere [**IThumbnailProvider**](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) para Windows Vista y versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="8eed1-406">While [**IExtractImage**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iextractimage) remains supported, [**IThumbnailProvider**](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) is preferred for Windows Vista and later.</span></span>

### <a name="predefined-shell-objects"></a><span data-ttu-id="8eed1-407">Objetos de Shell predefinidos</span><span class="sxs-lookup"><span data-stu-id="8eed1-407">Predefined Shell Objects</span></span>

<span data-ttu-id="8eed1-408">El shell define objetos adicionales en **la \_ \_ raíz de las clases HKEY** que se pueden extender de la misma manera que los tipos de archivo.</span><span class="sxs-lookup"><span data-stu-id="8eed1-408">The Shell defines additional objects under **HKEY\_CLASSES\_ROOT** which can be extended in the same way as file types.</span></span> <span data-ttu-id="8eed1-409">Por ejemplo, para agregar un controlador de hoja de propiedades para todos los archivos, puede registrarse en la clave **PropertySheetHandlers** .</span><span class="sxs-lookup"><span data-stu-id="8eed1-409">For example, to add a property sheet handler for all files, you can register under the **PropertySheetHandlers** key.</span></span>

```
HKEY_CLASSES_ROOT
   *
      shellex
         PropertySheetHandlers
```

<span data-ttu-id="8eed1-410">En la tabla siguiente se proporcionan las diversas subclaves de **\_ las clases HKEY \_ raíz** en las que se pueden registrar controladores de extensión.</span><span class="sxs-lookup"><span data-stu-id="8eed1-410">The following table gives the various subkeys of **HKEY\_CLASSES\_ROOT** under which extension handlers can be registered.</span></span> <span data-ttu-id="8eed1-411">Tenga en cuenta que muchos controladores de extensión no se pueden registrar en todas las subclaves de la lista.</span><span class="sxs-lookup"><span data-stu-id="8eed1-411">Note that many extension handlers cannot be registered under all of the listed subkeys.</span></span> <span data-ttu-id="8eed1-412">Para obtener más información, vea la documentación del controlador específico.</span><span class="sxs-lookup"><span data-stu-id="8eed1-412">For further details, see the specific handler's documentation.</span></span>



| <span data-ttu-id="8eed1-413">Subclave</span><span class="sxs-lookup"><span data-stu-id="8eed1-413">Subkey</span></span>                    | <span data-ttu-id="8eed1-414">Descripción</span><span class="sxs-lookup"><span data-stu-id="8eed1-414">Description</span></span>                                                          | <span data-ttu-id="8eed1-415">Controladores posibles</span><span class="sxs-lookup"><span data-stu-id="8eed1-415">Possible Handlers</span></span>                                | <span data-ttu-id="8eed1-416">Versión</span><span class="sxs-lookup"><span data-stu-id="8eed1-416">Version</span></span> |
|---------------------------|----------------------------------------------------------------------|--------------------------------------------------|---------|
| <span data-ttu-id="8eed1-417">\**\** _</span><span class="sxs-lookup"><span data-stu-id="8eed1-417">\**\** _</span></span>                    | <span data-ttu-id="8eed1-418">Todos los archivos</span><span class="sxs-lookup"><span data-stu-id="8eed1-418">All files</span></span>                                                            | <span data-ttu-id="8eed1-419">Menú contextual, hoja de propiedades, verbos (ver más abajo)</span><span class="sxs-lookup"><span data-stu-id="8eed1-419">Shortcut Menu, Property Sheet, Verbs (see below)</span></span> | <span data-ttu-id="8eed1-420">All</span><span class="sxs-lookup"><span data-stu-id="8eed1-420">All</span></span>     |
| <span data-ttu-id="8eed1-421">_ *AllFileSystemObjects*\*</span><span class="sxs-lookup"><span data-stu-id="8eed1-421">_ *AllFileSystemObjects*\*</span></span>  | <span data-ttu-id="8eed1-422">Todos los archivos y carpetas de archivos</span><span class="sxs-lookup"><span data-stu-id="8eed1-422">All files and file folders</span></span>                                           | <span data-ttu-id="8eed1-423">Menú contextual, hoja de propiedades, verbos</span><span class="sxs-lookup"><span data-stu-id="8eed1-423">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="8eed1-424">4.71</span><span class="sxs-lookup"><span data-stu-id="8eed1-424">4.71</span></span>    |
| <span data-ttu-id="8eed1-425">**Carpeta**</span><span class="sxs-lookup"><span data-stu-id="8eed1-425">**Folder**</span></span>                | <span data-ttu-id="8eed1-426">Todas las carpetas</span><span class="sxs-lookup"><span data-stu-id="8eed1-426">All folders</span></span>                                                          | <span data-ttu-id="8eed1-427">Menú contextual, hoja de propiedades, verbos</span><span class="sxs-lookup"><span data-stu-id="8eed1-427">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="8eed1-428">All</span><span class="sxs-lookup"><span data-stu-id="8eed1-428">All</span></span>     |
| <span data-ttu-id="8eed1-429">**Directorio**</span><span class="sxs-lookup"><span data-stu-id="8eed1-429">**Directory**</span></span>             | <span data-ttu-id="8eed1-430">Carpetas de archivos</span><span class="sxs-lookup"><span data-stu-id="8eed1-430">File folders</span></span>                                                         | <span data-ttu-id="8eed1-431">Menú contextual, hoja de propiedades, verbos</span><span class="sxs-lookup"><span data-stu-id="8eed1-431">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="8eed1-432">All</span><span class="sxs-lookup"><span data-stu-id="8eed1-432">All</span></span>     |
| <span data-ttu-id="8eed1-433">**Fondo de directorio \\**</span><span class="sxs-lookup"><span data-stu-id="8eed1-433">**Directory\\Background**</span></span> | <span data-ttu-id="8eed1-434">Fondo de carpeta de archivos</span><span class="sxs-lookup"><span data-stu-id="8eed1-434">File folder background</span></span>                                               | <span data-ttu-id="8eed1-435">Solo el menú contextual</span><span class="sxs-lookup"><span data-stu-id="8eed1-435">Shortcut Menu only</span></span>                               | <span data-ttu-id="8eed1-436">4.71</span><span class="sxs-lookup"><span data-stu-id="8eed1-436">4.71</span></span>    |
| <span data-ttu-id="8eed1-437">**Unidad**</span><span class="sxs-lookup"><span data-stu-id="8eed1-437">**Drive**</span></span>                 | <span data-ttu-id="8eed1-438">Todas las unidades de mi PC, como "C: \\ "</span><span class="sxs-lookup"><span data-stu-id="8eed1-438">All drives in MyComputer, such as "C:\\"</span></span>                             | <span data-ttu-id="8eed1-439">Menú contextual, hoja de propiedades, verbos</span><span class="sxs-lookup"><span data-stu-id="8eed1-439">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="8eed1-440">All</span><span class="sxs-lookup"><span data-stu-id="8eed1-440">All</span></span>     |
| <span data-ttu-id="8eed1-441">**Network**</span><span class="sxs-lookup"><span data-stu-id="8eed1-441">**Network**</span></span>               | <span data-ttu-id="8eed1-442">Red completa (en mis sitios de red)</span><span class="sxs-lookup"><span data-stu-id="8eed1-442">Entire network (under My Network Places)</span></span>                             | <span data-ttu-id="8eed1-443">Menú contextual, hoja de propiedades, verbos</span><span class="sxs-lookup"><span data-stu-id="8eed1-443">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="8eed1-444">All</span><span class="sxs-lookup"><span data-stu-id="8eed1-444">All</span></span>     |
| <span data-ttu-id="8eed1-445">**Tipo de red \\\\\#**</span><span class="sxs-lookup"><span data-stu-id="8eed1-445">**Network\\Type\\\#**</span></span>     | <span data-ttu-id="8eed1-446">Todos los objetos de tipo \# (ver más abajo)</span><span class="sxs-lookup"><span data-stu-id="8eed1-446">All objects of type \# (see below)</span></span>                                   | <span data-ttu-id="8eed1-447">Menú contextual, hoja de propiedades, verbos</span><span class="sxs-lookup"><span data-stu-id="8eed1-447">Shortcut menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="8eed1-448">4.71</span><span class="sxs-lookup"><span data-stu-id="8eed1-448">4.71</span></span>    |
| <span data-ttu-id="8eed1-449">**NetShare**</span><span class="sxs-lookup"><span data-stu-id="8eed1-449">**NetShare**</span></span>              | <span data-ttu-id="8eed1-450">Todos los recursos compartidos de red</span><span class="sxs-lookup"><span data-stu-id="8eed1-450">All network shares</span></span>                                                   | <span data-ttu-id="8eed1-451">Menú contextual, hoja de propiedades, verbos</span><span class="sxs-lookup"><span data-stu-id="8eed1-451">Shortcut menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="8eed1-452">4.71</span><span class="sxs-lookup"><span data-stu-id="8eed1-452">4.71</span></span>    |
| <span data-ttu-id="8eed1-453">**NetServer**</span><span class="sxs-lookup"><span data-stu-id="8eed1-453">**NetServer**</span></span>             | <span data-ttu-id="8eed1-454">Todos los servidores de red</span><span class="sxs-lookup"><span data-stu-id="8eed1-454">All network servers</span></span>                                                  | <span data-ttu-id="8eed1-455">Menú contextual, hoja de propiedades, verbos</span><span class="sxs-lookup"><span data-stu-id="8eed1-455">Shortcut menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="8eed1-456">4.71</span><span class="sxs-lookup"><span data-stu-id="8eed1-456">4.71</span></span>    |
| <span data-ttu-id="8eed1-457">*\_nombre del proveedor de red \_*</span><span class="sxs-lookup"><span data-stu-id="8eed1-457">*network\_provider\_name*</span></span> | <span data-ttu-id="8eed1-458">Todos los objetos proporcionados por el proveedor de red "*\_ \_ nombre de proveedor de red*"</span><span class="sxs-lookup"><span data-stu-id="8eed1-458">All objects provided by network provider "*network\_provider\_name*"</span></span> | <span data-ttu-id="8eed1-459">Menú contextual, hoja de propiedades, verbos</span><span class="sxs-lookup"><span data-stu-id="8eed1-459">Shortcut menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="8eed1-460">All</span><span class="sxs-lookup"><span data-stu-id="8eed1-460">All</span></span>     |
| <span data-ttu-id="8eed1-461">**Impresoras**</span><span class="sxs-lookup"><span data-stu-id="8eed1-461">**Printers**</span></span>              | <span data-ttu-id="8eed1-462">Todas las impresoras</span><span class="sxs-lookup"><span data-stu-id="8eed1-462">All printers</span></span>                                                         | <span data-ttu-id="8eed1-463">Menú contextual, hoja de propiedades</span><span class="sxs-lookup"><span data-stu-id="8eed1-463">Shortcut Menu, Property Sheet</span></span>                    | <span data-ttu-id="8eed1-464">All</span><span class="sxs-lookup"><span data-stu-id="8eed1-464">All</span></span>     |
| <span data-ttu-id="8eed1-465">**Audio**</span><span class="sxs-lookup"><span data-stu-id="8eed1-465">**AudioCD**</span></span>               | <span data-ttu-id="8eed1-466">CD de audio en la unidad de CD</span><span class="sxs-lookup"><span data-stu-id="8eed1-466">Audio CD in CD drive</span></span>                                                 | <span data-ttu-id="8eed1-467">Solo verbos</span><span class="sxs-lookup"><span data-stu-id="8eed1-467">Verbs only</span></span>                                       | <span data-ttu-id="8eed1-468">All</span><span class="sxs-lookup"><span data-stu-id="8eed1-468">All</span></span>     |
| <span data-ttu-id="8eed1-469">**DISCOS**</span><span class="sxs-lookup"><span data-stu-id="8eed1-469">**DVD**</span></span>                   | <span data-ttu-id="8eed1-470">Unidad de DVD (Windows 2000)</span><span class="sxs-lookup"><span data-stu-id="8eed1-470">DVD drive (Windows 2000)</span></span>                                             | <span data-ttu-id="8eed1-471">Menú contextual, hoja de propiedades, verbos</span><span class="sxs-lookup"><span data-stu-id="8eed1-471">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="8eed1-472">4.71</span><span class="sxs-lookup"><span data-stu-id="8eed1-472">4.71</span></span>    |



 

<span data-ttu-id="8eed1-473">Notas:</span><span class="sxs-lookup"><span data-stu-id="8eed1-473">Notes:</span></span>

-   <span data-ttu-id="8eed1-474">Para acceder al menú contextual de fondo de la carpeta de archivos, haga clic con el botón secundario en una carpeta de archivos, pero no en el contenido de la carpeta.</span><span class="sxs-lookup"><span data-stu-id="8eed1-474">The file folder background shortcut menu is accessed by right-clicking within a file folder, but not over any of the folder's contents.</span></span>
-   <span data-ttu-id="8eed1-475">Los "verbos" son comandos especiales registrados en el verbo de Shell de la subclave **\_ \_ raíz de las clases HKEY** \\  \\  \\  .</span><span class="sxs-lookup"><span data-stu-id="8eed1-475">"Verbs" are special commands registered under **HKEY\_CLASSES\_ROOT**\\*Subkey*\\**Shell**\\**Verb** .</span></span>
-   <span data-ttu-id="8eed1-476">Para el tipo de **red** \\  \\ **\#** , " \# " es un código de tipo de proveedor de red en formato decimal.</span><span class="sxs-lookup"><span data-stu-id="8eed1-476">For **Network**\\**Type**\\**\#** , "\#" is a network provider type code in decimal.</span></span> <span data-ttu-id="8eed1-477">El código de tipo de proveedor de red es la palabra alta de un tipo de red.</span><span class="sxs-lookup"><span data-stu-id="8eed1-477">The network provider type code is the high word of a network type.</span></span> <span data-ttu-id="8eed1-478">La lista de tipos de red se proporciona en el archivo de encabezado Winnetwk. h ( \_ valores de net WNNC \_ \* ).</span><span class="sxs-lookup"><span data-stu-id="8eed1-478">The list of network types is given in the Winnetwk.h header file (WNNC\_NET\_\* values).</span></span> <span data-ttu-id="8eed1-479">Por ejemplo, WNNC \_ net \_ Shiva es 0x00330000, por lo que la clave de tipo correspondiente sería **HKEY \_ classes \_ raíz** \\ **Network** \\ **Type** \\ **51** .</span><span class="sxs-lookup"><span data-stu-id="8eed1-479">For example, WNNC\_NET\_SHIVA is 0x00330000, so the corresponding type key would be **HKEY\_CLASSES\_ROOT**\\**Network**\\**Type**\\**51** .</span></span>
-   <span data-ttu-id="8eed1-480">"*\_ \_ nombre de proveedor de red*" es un nombre de proveedor de red tal y como lo especifica [**WNetGetProviderName**](/windows/win32/api/winnetwk/nf-winnetwk-wnetgetprovidernamea), con los espacios convertidos en guiones bajos.</span><span class="sxs-lookup"><span data-stu-id="8eed1-480">"*network\_provider\_name*" is a network provider name as specified by [**WNetGetProviderName**](/windows/win32/api/winnetwk/nf-winnetwk-wnetgetprovidernamea), with the spaces converted into underscores.</span></span> <span data-ttu-id="8eed1-481">Por ejemplo, si se instala el proveedor de red de redes de Microsoft, su nombre de proveedor es "red de Microsoft Windows" y el *\_ \_ nombre de proveedor de red* correspondiente es **\_ \_ red de Microsoft Windows**.</span><span class="sxs-lookup"><span data-stu-id="8eed1-481">For example, if the Microsoft Networking network provider is installed, its provider name is "Microsoft Windows Network", and the corresponding *network\_provider\_name* is **Microsoft\_Windows\_Network**.</span></span>

### <a name="example-of-an-extension-handler-registration"></a><span data-ttu-id="8eed1-482">Ejemplo de registro de un controlador de extensión</span><span class="sxs-lookup"><span data-stu-id="8eed1-482">Example of an Extension Handler Registration</span></span>

<span data-ttu-id="8eed1-483">Para habilitar un controlador determinado, cree una subclave en la clave del tipo de controlador de extensión con el nombre del controlador.</span><span class="sxs-lookup"><span data-stu-id="8eed1-483">To enable a particular handler, create a subkey under the extension handler type key with the name of the handler.</span></span> <span data-ttu-id="8eed1-484">El shell no utiliza el nombre del controlador, pero debe ser diferente de todos los demás nombres bajo esa subclave de tipo.</span><span class="sxs-lookup"><span data-stu-id="8eed1-484">The Shell does not use the handler's name, but it must be different from all other names under that type subkey.</span></span> <span data-ttu-id="8eed1-485">Establezca el valor predeterminado de la subclave Name en la forma de cadena del GUID del controlador.</span><span class="sxs-lookup"><span data-stu-id="8eed1-485">Set the default value of the name subkey to the string form of the handler's GUID.</span></span>

<span data-ttu-id="8eed1-486">En el ejemplo siguiente se muestran las entradas del registro que habilitan los controladores de extensiones de menús contextuales y hojas de propiedades mediante un tipo de archivo. MYP de ejemplo:</span><span class="sxs-lookup"><span data-stu-id="8eed1-486">The following example illustrates registry entries that enable shortcut menu and property sheet extension handlers, using an example .myp file type:</span></span>

```
HKEY_CLASSES_ROOT
   .myp
      (Default) = MyProgram.1
   CLSID
      {00000000-1111-2222-3333-444444444444}
         InProcServer32
            (Default) = C:\MyDir\MyCommand.dll
            ThreadingModel = Apartment
      {11111111-2222-3333-4444-555555555555}
         InProcServer32
            (Default) = C:\MyDir\MyPropSheet.dll
            ThreadingModel = Apartment
   MyProgram.1
      (Default) = MyProgram Application
      Shellex
         ContextMenuHandler
            MyCommand
               (Default) = {00000000-1111-2222-3333-444444444444}
         PropertySheetHandlers
            MyPropSheet
               (Default) = {11111111-2222-3333-4444-555555555555}
```

<span data-ttu-id="8eed1-487">El procedimiento de registro descrito en esta sección debe seguirse para todos los sistemas de Windows.</span><span class="sxs-lookup"><span data-stu-id="8eed1-487">The registration procedure discussed in this section must be followed for all Windows systems.</span></span>

## <a name="related-topics"></a><span data-ttu-id="8eed1-488">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="8eed1-488">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8eed1-489">Instrucciones para implementar extensiones de In-Process</span><span class="sxs-lookup"><span data-stu-id="8eed1-489">Guidance for Implementing In-Process Extensions</span></span>](shell-and-managed-code.md)
</dt> </dl>

 

 
