---
description: 'Las siguientes consideraciones de seguridad se aplican a las aplicaciones que usan WinHTTP: los certificados de servidor solo se comprueban una vez por sesión.'
ms.assetid: 287e85ed-a324-4785-872a-26e4ab37986d
title: Consideraciones de seguridad de WinHTTP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dc06725ba03631eb4d5e5c29f8cfa0aae69b5022
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104497488"
---
# <a name="winhttp-security-considerations"></a>Consideraciones de seguridad de WinHTTP

Las siguientes consideraciones de seguridad se aplican a las aplicaciones que usan WinHTTP:

-   **Los certificados de servidor solo se comprueban una vez por sesión.** Una vez comprobado un certificado, sigue siendo válido mientras dure la sesión actual. Siempre y cuando la huella digital del certificado coincida, lo que indica que el certificado no ha cambiado, el certificado se seguirá validando. Como resultado, cualquier cambio en los criterios de validación, a través del Protocolo, la comprobación de revocación o las marcas de certificado-error-omitir, no surte efecto una vez comprobado el certificado. Para forzar que este cambio surta efecto inmediatamente, se debe finalizar la sesión actual y se puede iniciar una nueva. Del mismo modo, solo se puede detectar la expiración de un certificado durante el transcurso de una sesión si la propia aplicación comprueba el servidor de certificados periódicamente para recuperar los datos de expiración.
-   **El proxy automático implica la descarga y ejecución de scripts.** La compatibilidad con la detección automática del proxy implica detectar a través de DHCP o DNS, descargar y ejecutar scripts de proxy como scripts de Java. Para lograr un mayor grado de seguridad, una aplicación debe evitar pasar la marca de **\_ \_ \_ InProcess de ejecución de AutoProxy WinHTTP** , de modo que la detección de proxy automático se inicie fuera de proceso. Incluso después, WinHTTP intenta ejecutar de forma predeterminada un script de proxy automático en proceso si el script no se ejecuta correctamente fuera de proceso. Si cree que este comportamiento de reserva supone un riesgo inaceptable, deshabilite el comportamiento de reserva con la marca de **\_ \_ \_ \_ solo outprocess de la ejecución de AutoProxy WinHTTP** .
-   **\_Las funciones de devolución de llamada de estado de WinHTTP \_ deben volver rápidamente.** Al escribir una de estas funciones de devolución de llamada, tenga cuidado de que no se bloquee. Por ejemplo, ni la devolución de llamada ni ninguna función a la que llama deberían mostrar un cuadro de diálogo de usuario o esperar un evento. Si una función de [*\_ devolución de \_ llamada de estado de WinHTTP*](/windows/win32/api/winhttp/nc-winhttp-winhttp_status_callback) está bloqueada, afecta a la programación interna de WinHTTP y hace que se deniegue el servicio a otras solicitudes dentro del mismo proceso.
-   **\_Las funciones de devolución de llamada de estado de WinHTTP \_ deben ser reentrantes.** Al escribir una devolución de llamada, evite las variables estáticas u otras construcciones que no sean seguras en la reentrada y evite llamar a otras funciones que no sean reentrantes.
-   **Si la operación asincrónica es posible, pase valores NULL para los parámetros OUT.** Si ha habilitado la operación asincrónica mediante el registro de una función de devolución de llamada, pase siempre los valores **null** para dichos parámetros como *lpdwDataAvailable* para [**WinHttpQueryDataAvailable**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpquerydataavailable), *lpdwBytesRead* para [**WinHttpReadData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpreaddata)o *lpdwBytesWritten* para [**WinHttpWriteData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpwritedata). En algunas circunstancias, el subproceso que realiza la llamada se termina antes de que se complete la operación y, si los parámetros OUT no son **null**, la función puede acabar escribiendo en la memoria que ya se ha liberado.
-   **La autenticación de Passport no es infalible.** Cualquier esquema de autenticación basada en cookies es vulnerable a los ataques. La versión 1,4 de Passport está basada en cookies y, por tanto, está sujeta a las vulnerabilidades asociadas a cualquier cookie o esquema de autenticación basada en formularios. La compatibilidad con Passport está deshabilitada de forma predeterminada en WinHTTP; se puede habilitar mediante [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption).
-   **La autenticación básica solo se debe usar a través de una conexión segura.** La autenticación básica, que envía el nombre de usuario y la contraseña en texto no cifrado (consulte [RFC 2617](https://www.ietf.org/rfc/rfc2617.txt)), debe usarse solo en conexiones SSL o TLS cifradas.
-   **La configuración de la Directiva de inicio de sesión automático en "Low" puede suponer un riesgo.** Cuando la Directiva de inicio de sesión automático se establece en baja, se puede usar una credencial de inicio de sesión de usuario para autenticarse en cualquier sitio. Sin embargo, no es una buena práctica de seguridad autenticarse en sitios en los que no confíe.
-   **No se usan conexiones SSL 2,0 a menos que se habiliten explícitamente.** Los protocolos de seguridad TLS 1,0 y SSL 3,0 se consideran más seguros que SSL 2,0. De forma predeterminada, WinHTTP solicita TLS 1,0 o SSL 3,0 al negociar una conexión SSL, no SSL 2,0. La compatibilidad con SSL 2,0 en WinHTTP solo se puede habilitar llamando a [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption).
-   **La comprobación de la revocación de certificados se debe solicitar explícitamente.** De forma predeterminada, al realizar la autenticación de certificados, WinHTTP no comprueba si se ha revocado el certificado del servidor. La comprobación de la revocación de certificados se puede habilitar mediante [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption).
-   **Las aplicaciones deben asegurarse de que una sesión se asigna a una única identidad.** Una sesión de WinHTTP se debe asignar a una sola identidad; es decir, una sesión de WinHTTP se utiliza para administrar la actividad de Internet de un solo usuario autenticado o un grupo de usuarios anónimos. Sin embargo, dado que WinHTTP no aplica esta asignación automáticamente, la aplicación debe tomar medidas para asegurarse de que solo interviene una identidad.
-   **Se deben sincronizar las operaciones en un identificador de solicitud de WinHTTP.** Por ejemplo, una aplicación debe evitar cerrar un identificador de solicitud en un subproceso mientras otro subproceso está enviando o recibiendo una solicitud. Para finalizar una solicitud asincrónica, cierre el identificador de solicitud durante una notificación de devolución de llamada. Para finalizar una solicitud sincrónica, cierre el identificador cuando se devuelva la llamada de WinHTTP anterior.
-   **Los archivos de seguimiento contienen información confidencial.** Los archivos de seguimiento están protegidos mediante listas de Access-Controls (ACL) para que solo se pueda tener acceso a ellos mediante el administrador local o la cuenta de usuario que lo creó. Evite poner en peligro los archivos de seguimiento por cualquier acceso no autorizado.
-   **Evite pasar datos confidenciales a través** de [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption). No suministre un nombre de usuario, una contraseña o cualquier otra credencial a **WinHttpSetOption** porque no tiene ningún control sobre el esquema de autenticación que se utiliza, y los datos confidenciales se pueden enviar de forma inesperada en texto no cifrado. Use [**WinHttpQueryAuthSchemes**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryauthschemes) y **WinHttpSetCredentials** en lugar de **WinHttpSetOption** para establecer las credenciales.
-   **La redirección automática puede suponer un riesgo para la seguridad.** De forma predeterminada, el redireccionamiento (un mensaje 302) se sigue automáticamente incluso para una publicación. Para evitar la posibilidad de redireccionamientos falsos, las aplicaciones deben deshabilitar la redirección automática o supervisar el redireccionamiento en las devoluciones de llamada al publicar información confidencial.
-   **Los encabezados definidos por el usuario se transfieren entre redirecciones sin cambios.** Los encabezados definidos por el usuario, como las cookies agregadas con **WinHTTPAddRequestHeaders**, se transfieren entre redirecciones sin modificaciones, mientras que los encabezados generados por WinHTTP se actualizan automáticamente. Si la transferencia de un encabezado definido por el usuario entre redirecciones supone un riesgo de seguridad, use la devolución de llamada de [*\_ devolución de \_ llamada de estado de WinHTTP*](/windows/win32/api/winhttp/nc-winhttp-winhttp_status_callback) con la FINALización de **\_ \_ \_ redireccionamiento del estado de devolución de llamada de WinHTTP** para modificar el encabezado en cuestión siempre que se produzca una redirección.
-   **WinHTTP no es reentrante en modo sincrónico.** Dado que WinHTTP no es reentrante en modo sincrónico, no programe llamadas a procedimientos asincrónicos (APC) que puedan llamar a WinHTTP en un subproceso de aplicación que se ejecute dentro de una función WinHTTP. En el modo sincrónico, WinHTTP realiza una "espera de alerta" y, si el subproceso en espera es anterior a la ejecución de una APC y después vuelve a entrar en WinHTTP de nuevo, el estado interno de WinHTTP puede resultar dañado.

 

 
