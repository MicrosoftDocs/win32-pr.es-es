---
description: La agrupación de objetos es un servicio automático proporcionado por COM+ que le permite configurar un componente para que las instancias de se mantengan activas en un grupo, listas para ser utilizadas por cualquier cliente que solicite el componente.
ms.assetid: 74a45220-449a-4d89-a979-a206e5e3d3ad
title: Conceptos de agrupación de objetos COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4fb2aa6481b2493371801d0d274420d356b0a32e
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104423283"
---
# <a name="com-object-pooling-concepts"></a><span data-ttu-id="08a60-103">Conceptos de agrupación de objetos COM+</span><span class="sxs-lookup"><span data-stu-id="08a60-103">COM+ Object Pooling Concepts</span></span>

<span data-ttu-id="08a60-104">La agrupación de objetos es un servicio automático proporcionado por COM+ que le permite configurar un componente para que las instancias de se mantengan activas en un grupo, listas para ser utilizadas por cualquier cliente que solicite el componente.</span><span class="sxs-lookup"><span data-stu-id="08a60-104">Object pooling is an automatic service provided by COM+ that enables you to configure a component to have instances of itself kept active in a pool, ready to be used by any client that requests the component.</span></span> <span data-ttu-id="08a60-105">Puede configurar y supervisar de forma administrativa el grupo mantenido para un componente determinado, especificando características como el tamaño del grupo y los valores de tiempo de espera de la solicitud de creación.</span><span class="sxs-lookup"><span data-stu-id="08a60-105">You can administratively configure and monitor the pool maintained for a given component, specifying characteristics such as pool size and creation request time-out values.</span></span> <span data-ttu-id="08a60-106">Cuando la aplicación se está ejecutando, COM+ administra el grupo y controla los detalles de la activación y reutilización de objetos de acuerdo con los criterios especificados.</span><span class="sxs-lookup"><span data-stu-id="08a60-106">When the application is running, COM+ manages the pool for you, handling the details of object activation and reuse according to the criteria you have specified.</span></span>

<span data-ttu-id="08a60-107">Puede lograr ventajas muy significativas en el rendimiento y el escalado mediante la reutilización de objetos de esta manera, especialmente cuando se escriben para sacar el máximo partido de la reutilización.</span><span class="sxs-lookup"><span data-stu-id="08a60-107">You can achieve very significant performance and scaling benefits by reusing objects in this manner, particularly when they are written to take full advantage of reuse.</span></span> <span data-ttu-id="08a60-108">Con la agrupación de objetos, obtendrá las siguientes ventajas:</span><span class="sxs-lookup"><span data-stu-id="08a60-108">With object pooling, you gain the following benefits:</span></span>

-   <span data-ttu-id="08a60-109">Puede acelerar el tiempo de uso de los objetos para cada cliente, Factorizando la inicialización de recursos y la inicialización lenta del trabajo real que el objeto realiza para los clientes.</span><span class="sxs-lookup"><span data-stu-id="08a60-109">You can speed object use time for each client, factoring out time-consuming initialization and resource acquisition from the actual work that the object performs for clients.</span></span>
-   <span data-ttu-id="08a60-110">Puede compartir el costo de adquirir recursos caros en todos los clientes.</span><span class="sxs-lookup"><span data-stu-id="08a60-110">You can share the cost of acquiring expensive resources across all clients.</span></span>
-   <span data-ttu-id="08a60-111">Puede preasignar objetos cuando se inicia la aplicación, antes de que entren las solicitudes de cliente.</span><span class="sxs-lookup"><span data-stu-id="08a60-111">You can pre-allocate objects when the application starts, before any client requests come in.</span></span>
-   <span data-ttu-id="08a60-112">Puede controlar el uso de recursos con la administración de grupos administrativos; por ejemplo, si establece un nivel de grupo máximo adecuado, puede mantener abierto solo todas las conexiones de base de datos para las que tiene una licencia.</span><span class="sxs-lookup"><span data-stu-id="08a60-112">You can govern resource use with administrative pool management for example, by setting an appropriate maximum pool level, you can keep open only as many database connections as you have a license for.</span></span>
-   <span data-ttu-id="08a60-113">Puede configurar la agrupación de forma administrativa para aprovechar las ventajas de los recursos de hardware disponibles, lo que le permite ajustar fácilmente la configuración del grupo cuando cambien los recursos de hardware disponibles.</span><span class="sxs-lookup"><span data-stu-id="08a60-113">You can administratively configure pooling to take best advantage of available hardware resources you can easily adjust the pool configuration as available hardware resources change.</span></span>
-   <span data-ttu-id="08a60-114">Puede acelerar el tiempo de reactivación de los objetos que usan la [activación Just-in-Time (JIT)](com--just-in-time-activation.md), y controlar deliberadamente cómo se dedican los recursos a los clientes.</span><span class="sxs-lookup"><span data-stu-id="08a60-114">You can speed reactivation time for objects that use [just-in-time (JIT) activation](com--just-in-time-activation.md), while deliberately controlling how resources are dedicated to clients.</span></span>

## <a name="writing-poolable-objects"></a><span data-ttu-id="08a60-115">Escribir objetos agrupables</span><span class="sxs-lookup"><span data-stu-id="08a60-115">Writing Poolable Objects</span></span>

<span data-ttu-id="08a60-116">Los objetos agrupables deben cumplir ciertos requisitos para permitir que varios clientes puedan usar una única instancia de objeto.</span><span class="sxs-lookup"><span data-stu-id="08a60-116">Poolable objects must meet certain requirements to enable a single object instance to be used by multiple clients.</span></span> <span data-ttu-id="08a60-117">Por ejemplo, no pueden mantener el estado del cliente ni tener ninguna afinidad de subprocesos.</span><span class="sxs-lookup"><span data-stu-id="08a60-117">For example, they can't hold client state or have any thread affinity.</span></span> <span data-ttu-id="08a60-118">Los objetos transaccionales también tienen requisitos concretos, en los que los recursos administrados mantenidos por un objeto agrupado se deben dar de alta manualmente en una transacción.</span><span class="sxs-lookup"><span data-stu-id="08a60-118">Transactional objects also have particular requirements, in that managed resources held by a pooled object must be manually enlisted in a transaction.</span></span>

<span data-ttu-id="08a60-119">Los objetos agrupados pueden implementar [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol) para controlar cómo se reutilizan.</span><span class="sxs-lookup"><span data-stu-id="08a60-119">Pooled objects can implement [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol) to control how they are reused.</span></span> <span data-ttu-id="08a60-120">Esto les permite realizar la inicialización cuando se activa en un contexto determinado, limpiar cualquier estado de cliente durante la desactivación e indicar cuándo se encuentran en un estado no reutilizable.</span><span class="sxs-lookup"><span data-stu-id="08a60-120">This enables them to perform initialization when activated in a given context, to clean up any client state on deactivation, and to indicate when they are in a non-reusable state.</span></span>

<span data-ttu-id="08a60-121">A menudo, resulta útil escribir objetos agrupables de una manera bastante genérica para que se puedan personalizar administrativamente con una cadena de constructor.</span><span class="sxs-lookup"><span data-stu-id="08a60-121">Often, it useful to write poolable objects in a somewhat generic fashion so that they can be administratively customized with a constructor string.</span></span> <span data-ttu-id="08a60-122">Por ejemplo, se puede escribir un objeto para que contenga una conexión ODBC genérica, con un determinado DSN especificado administrativamente en una cadena de constructor.</span><span class="sxs-lookup"><span data-stu-id="08a60-122">For example, an object might be written to hold a generic ODBC connection, with a particular DSN administratively specified in a constructor string.</span></span>

<span data-ttu-id="08a60-123">En los temas de esta sección, que se describen en la tabla siguiente, se proporciona información sobre cómo funciona la agrupación de objetos en COM+, así como información sobre cómo escribir, configurar e implementar objetos agrupables.</span><span class="sxs-lookup"><span data-stu-id="08a60-123">The topics in this section, described in the following table, provide information about how object pooling works in COM+, as well as information about how to write, configure, and implement poolable objects.</span></span>



| <span data-ttu-id="08a60-124">Tema</span><span class="sxs-lookup"><span data-stu-id="08a60-124">Topic</span></span>                                                                                                 | <span data-ttu-id="08a60-125">Descripción</span><span class="sxs-lookup"><span data-stu-id="08a60-125">Description</span></span>                                                                                              |
|-------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="08a60-126">Cómo funciona la agrupación de objetos</span><span class="sxs-lookup"><span data-stu-id="08a60-126">How Object Pooling Works</span></span>](how-object-pooling-works.md)<br/>                                   | <span data-ttu-id="08a60-127">Presenta los conceptos básicos.</span><span class="sxs-lookup"><span data-stu-id="08a60-127">Presents basic concepts.</span></span><br/>                                                                      |
| [<span data-ttu-id="08a60-128">Mejorar el rendimiento con la agrupación de objetos</span><span class="sxs-lookup"><span data-stu-id="08a60-128">Improving Performance with Object Pooling</span></span>](improving-performance-with-object-pooling.md)<br/> | <span data-ttu-id="08a60-129">Proporciona detalles específicos sobre cómo se puede usar la agrupación de objetos de forma más eficaz.</span><span class="sxs-lookup"><span data-stu-id="08a60-129">Provides specific details on how you can use object pooling most effectively.</span></span><br/>                 |
| [<span data-ttu-id="08a60-130">Requisitos para objetos agrupables</span><span class="sxs-lookup"><span data-stu-id="08a60-130">Requirements for Poolable Objects</span></span>](requirements-for-poolable-objects.md)<br/>                 | <span data-ttu-id="08a60-131">Proporciona detalles sobre cómo escribir un objeto que se va a agrupar.</span><span class="sxs-lookup"><span data-stu-id="08a60-131">Provides details on how to write an object that is to be pooled.</span></span><br/>                              |
| [<span data-ttu-id="08a60-132">Agrupar objetos transaccionales</span><span class="sxs-lookup"><span data-stu-id="08a60-132">Pooling Transactional Objects</span></span>](pooling-transactional-objects.md)<br/>                         | <span data-ttu-id="08a60-133">Proporciona detalles sobre los requisitos especiales que se aplican a los objetos transaccionales agrupables.</span><span class="sxs-lookup"><span data-stu-id="08a60-133">Provides details about the special requirements that apply to poolable transactional objects.</span></span><br/> |
| [<span data-ttu-id="08a60-134">Controlar la duración y el estado de los objetos</span><span class="sxs-lookup"><span data-stu-id="08a60-134">Controlling Object Lifetime and State</span></span>](controlling-object-lifetime-and-state.md)<br/>         | <span data-ttu-id="08a60-135">Describe cómo se pueden implementar objetos agrupados para controlar cómo se reutilizan.</span><span class="sxs-lookup"><span data-stu-id="08a60-135">Describes how pooled objects can be implemented to control how they are reused.</span></span><br/>               |



 

## <a name="related-topics"></a><span data-ttu-id="08a60-136">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="08a60-136">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="08a60-137">Tareas de agrupación de objetos COM+</span><span class="sxs-lookup"><span data-stu-id="08a60-137">COM+ Object Pooling Tasks</span></span>](com--object-pooling-tasks.md)
</dt> </dl>

 

 




