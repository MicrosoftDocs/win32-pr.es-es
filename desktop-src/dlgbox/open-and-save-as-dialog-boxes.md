---
title: Cuadros de diálogo abrir y guardar como
description: El cuadro de diálogo Abrir permite al usuario especificar la unidad, el directorio y el nombre de un archivo o un conjunto de archivos que se van a abrir.
ms.assetid: 5676ca9d-daca-40bf-8881-def2ff841c58
keywords:
- Biblioteca de cuadros de diálogo comunes
- cuadros de diálogo comunes
- Cuadro de diálogo Abrir
- Guardar como, cuadro de diálogo
- personalizar el cuadro de diálogo abrir
- personalizar el cuadro de diálogo Guardar como
- cuadros de diálogo, abrir
- cuadros de diálogo, guardar como
ms.topic: article
ms.date: 05/31/2018
ms.custom: project-verbatim
ms.openlocfilehash: bc2977a5f91abde32a78c722a7a7c7b6b4a23ffd
ms.sourcegitcommit: af120ad5c30da2fc5eb717ca2a1c4c45878efd71
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/20/2021
ms.locfileid: "105698467"
---
# <a name="open-and-save-as-dialog-boxes"></a><span data-ttu-id="8044e-111">Cuadros de diálogo abrir y guardar como</span><span class="sxs-lookup"><span data-stu-id="8044e-111">Open and Save As Dialog Boxes</span></span>

> [!NOTE]
> <span data-ttu-id="8044e-112">La función [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) se muestra en el [ejemplo el archivo está en uso](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/shell/appplatform/fileisinuse).</span><span class="sxs-lookup"><span data-stu-id="8044e-112">The [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) function is demonstrated in the [File is in use sample](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/shell/appplatform/fileisinuse).</span></span>

<span data-ttu-id="8044e-113">\[A partir de Windows Vista, los cuadros de diálogo **abrir** y **Guardar como** común se han sustituido por el [cuadro de diálogo de elementos comunes](/previous-versions/windows/desktop/legacy/bb776913(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="8044e-113">\[Starting with Windows Vista, the **Open** and **Save As** common dialog boxes have been superseded by the [Common Item Dialog](/previous-versions/windows/desktop/legacy/bb776913(v=vs.85)).</span></span> <span data-ttu-id="8044e-114">Se recomienda usar la API de cuadros de diálogo de elementos comunes en lugar de estos cuadros de diálogo de la biblioteca de cuadros de diálogo comunes.\]</span><span class="sxs-lookup"><span data-stu-id="8044e-114">We recommended that you use the Common Item Dialog API instead of these dialog boxes from the Common Dialog Box Library.\]</span></span>

<span data-ttu-id="8044e-115">El cuadro de diálogo **abrir** permite al usuario especificar la unidad, el directorio y el nombre de un archivo o un conjunto de archivos que se van a abrir.</span><span class="sxs-lookup"><span data-stu-id="8044e-115">The **Open** dialog box lets the user specify the drive, directory, and the name of a file or set of files to open.</span></span> <span data-ttu-id="8044e-116">Puede crear y mostrar un cuadro de diálogo **abierto** inicializando una estructura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) y pasando la estructura a la función [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) .</span><span class="sxs-lookup"><span data-stu-id="8044e-116">You create and display an **Open** dialog box by initializing an [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure and passing the structure to the [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) function.</span></span>

<span data-ttu-id="8044e-117">El cuadro de diálogo **Guardar como** permite al usuario especificar la unidad, el directorio y el nombre de un archivo que se va a guardar.</span><span class="sxs-lookup"><span data-stu-id="8044e-117">The **Save As** dialog box lets the user specify the drive, directory, and name of a file to save.</span></span> <span data-ttu-id="8044e-118">Puede crear y mostrar un cuadro de diálogo **Guardar como** inicializando una estructura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) y pasando la estructura a la función [**getSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) .</span><span class="sxs-lookup"><span data-stu-id="8044e-118">You create and display a **Save As** dialog box by initializing an [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure and passing the structure to the [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) function.</span></span>

<span data-ttu-id="8044e-119">Los cuadros de diálogo **abrir** y **Guardar como** del explorador proporcionan características de la interfaz de usuario similares al explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="8044e-119">Explorer-style **Open** and **Save As** dialog boxes provide user-interface features that are similar to the Windows Explorer.</span></span> <span data-ttu-id="8044e-120">Sin embargo, el sistema sigue siendo compatible con los cuadros de diálogo **abrir** y **Guardar como** de estilo antiguo para las aplicaciones que deben ser coherentes con la interfaz de usuario de estilo antiguo.</span><span class="sxs-lookup"><span data-stu-id="8044e-120">However, the system continues to support old-style **Open** and **Save As** dialog boxes for applications that must be consistent with the old-style user interface.</span></span>

<span data-ttu-id="8044e-121">Además de la diferencia en la apariencia, los cuadros de diálogo estilo del explorador y estilo antiguo difieren en el uso de plantillas personalizadas y procedimientos de enlace para personalizar los cuadros de diálogo.</span><span class="sxs-lookup"><span data-stu-id="8044e-121">In addition to the difference in appearance, the Explorer-style and old-style dialog boxes differ in their use of custom templates and hook procedures for customizing the dialog boxes.</span></span> <span data-ttu-id="8044e-122">Sin embargo, los cuadros de diálogo estilo del explorador y estilo antiguo tienen el mismo comportamiento para la mayoría de las operaciones básicas, como la especificación de un filtro de nombre de archivo, la validación de la entrada del usuario y la obtención del nombre de archivo especificado por el usuario.</span><span class="sxs-lookup"><span data-stu-id="8044e-122">However, the Explorer-style and old-style dialog boxes have the same behavior for most basic operations, such as specifying a file name filter, validating the user's input, and getting the file name specified by the user.</span></span> <span data-ttu-id="8044e-123">Para obtener más información acerca de los cuadros de diálogo estilo del explorador y estilo antiguo, vea el apartado sobre la [Personalización del cuadro de diálogo abrir y guardar como](#open-and-save-as-dialog-box-customization).</span><span class="sxs-lookup"><span data-stu-id="8044e-123">For more information about the Explorer-style and old-style dialog boxes, see [Open and Save As Dialog Box Customization](#open-and-save-as-dialog-box-customization).</span></span>

<span data-ttu-id="8044e-124">En la ilustración siguiente se muestra un cuadro de diálogo de **apertura** de estilo de explorador típico.</span><span class="sxs-lookup"><span data-stu-id="8044e-124">The following illustration shows a typical Explorer-style **Open** dialog box.</span></span>

![Abrir archivo (cuadro de diálogo)](images/opendialogboxxp.png)

<span data-ttu-id="8044e-126">En la ilustración siguiente se muestra un cuadro de diálogo **Guardar como** de estilo de explorador típico.</span><span class="sxs-lookup"><span data-stu-id="8044e-126">The following illustration shows a typical Explorer-style **Save As** dialog box.</span></span>

![cuadro de diálogo Guardar archivo](images/saveasdialogboxxp.png)

<span data-ttu-id="8044e-128">Si el usuario especifica un nombre de archivo y hace clic en el botón **Aceptar** , [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) o [**getSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) devuelve **true**.</span><span class="sxs-lookup"><span data-stu-id="8044e-128">If the user specifies a file name and clicks the **OK** button, [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) or [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) returns **TRUE**.</span></span> <span data-ttu-id="8044e-129">El búfer señalado por el miembro **lpstrFile** de la estructura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) contiene la ruta de acceso completa y el nombre de archivo especificado por el usuario.</span><span class="sxs-lookup"><span data-stu-id="8044e-129">The buffer pointed to by the **lpstrFile** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure contains the full path and file name specified by the user.</span></span>

<span data-ttu-id="8044e-130">Si el usuario cancela el cuadro de diálogo **abrir** o **Guardar como** o se produce un error, la función devuelve **false**.</span><span class="sxs-lookup"><span data-stu-id="8044e-130">If the user cancels the **Open** or **Save As** dialog box or an error occurs, the function returns **FALSE**.</span></span> <span data-ttu-id="8044e-131">Para determinar la causa del error, llame a la función [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) para recuperar el valor de error extendido.</span><span class="sxs-lookup"><span data-stu-id="8044e-131">To determine the cause of the error, call the [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) function to retrieve the extended error value.</span></span> <span data-ttu-id="8044e-132">Si el búfer de **lpstrFile** es demasiado pequeño para recibir el nombre completo, **CommDlgExtendedError** devuelve **FNERR \_ BUFFERTOOSMALL** y los primeros 2 bytes del búfer al que apunta el miembro **lpstrFile** se establecen en un valor entero que especifica el tamaño necesario para recibir el nombre completo.</span><span class="sxs-lookup"><span data-stu-id="8044e-132">If the **lpstrFile** buffer is too small to receive the full name, **CommDlgExtendedError** returns **FNERR\_BUFFERTOOSMALL** and the first 2 bytes of the buffer pointed to by the **lpstrFile** member are set to an integer value specifying the size required to receive the full name.</span></span>

<span data-ttu-id="8044e-133">Los temas siguientes se describen en esta sección.</span><span class="sxs-lookup"><span data-stu-id="8044e-133">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="8044e-134">Nombres de archivo y directorios</span><span class="sxs-lookup"><span data-stu-id="8044e-134">File Names and Directories</span></span>](#file-names-and-directories)
-   [<span data-ttu-id="8044e-135">Filtros</span><span class="sxs-lookup"><span data-stu-id="8044e-135">Filters</span></span>](#filters)
-   [<span data-ttu-id="8044e-136">Validación de archivos y directorios</span><span class="sxs-lookup"><span data-stu-id="8044e-136">File and Directory Validation</span></span>](#file-and-directory-validation)
-   [<span data-ttu-id="8044e-137">Abrir y guardar como personalización del cuadro de diálogo</span><span class="sxs-lookup"><span data-stu-id="8044e-137">Open and Save As Dialog Box Customization</span></span>](#open-and-save-as-dialog-box-customization)
-   [<span data-ttu-id="8044e-138">Procedimientos de enlace de estilo del explorador</span><span class="sxs-lookup"><span data-stu-id="8044e-138">Explorer-Style Hook Procedures</span></span>](#explorer-style-hook-procedures)
-   [<span data-ttu-id="8044e-139">Plantillas personalizadas de estilo Explorador</span><span class="sxs-lookup"><span data-stu-id="8044e-139">Explorer-Style Custom Templates</span></span>](#explorer-style-custom-templates)
-   [<span data-ttu-id="8044e-140">Identificadores de control de estilo del explorador</span><span class="sxs-lookup"><span data-stu-id="8044e-140">Explorer-Style Control Identifiers</span></span>](#explorer-style-control-identifiers)
-   [<span data-ttu-id="8044e-141">Personalización de Old-Style cuadros de diálogo</span><span class="sxs-lookup"><span data-stu-id="8044e-141">Customizing Old-Style Dialog Boxes</span></span>](#customizing-old-style-dialog-boxes)

## <a name="file-names-and-directories"></a><span data-ttu-id="8044e-142">Nombres de archivo y directorios</span><span class="sxs-lookup"><span data-stu-id="8044e-142">File Names and Directories</span></span>

<span data-ttu-id="8044e-143">La información de esta sección se aplica a los cuadros de diálogo de estilo de explorador y de estilo antiguo **abrir** y **Guardar como** .</span><span class="sxs-lookup"><span data-stu-id="8044e-143">The information in this section applies to both Explorer-style and old-style **Open** and **Save As** dialog boxes.</span></span>

<span data-ttu-id="8044e-144">Antes de llamar a las funciones [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) o [**getSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) , el miembro **lpstrFile** de la estructura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) debe apuntar al búfer para recibir el nombre de archivo.</span><span class="sxs-lookup"><span data-stu-id="8044e-144">Before calling the [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) or [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) functions, the **lpstrFile** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure must point to the buffer to receive the file name.</span></span> <span data-ttu-id="8044e-145">El miembro **nMaxFile** debe especificar el tamaño, en caracteres, del búfer **lpstrFile** .</span><span class="sxs-lookup"><span data-stu-id="8044e-145">The **nMaxFile** member must specify the size, in characters, of the **lpstrFile** buffer.</span></span> <span data-ttu-id="8044e-146">Para una función ANSI, es el número de bytes, pero para una función Unicode es el número de caracteres.</span><span class="sxs-lookup"><span data-stu-id="8044e-146">For an ANSI function this is the number of bytes, but for a Unicode function this is the number of characters.</span></span>

<span data-ttu-id="8044e-147">Si el usuario especifica un nombre de archivo y hace clic en el botón **Aceptar** , el cuadro de diálogo copia la unidad, el directorio y el nombre de archivo seleccionados en el búfer de **lpstrFile** .</span><span class="sxs-lookup"><span data-stu-id="8044e-147">If the user specifies a file name and clicks the **OK** button, the dialog box copies the selected drive, directory, and file name to the **lpstrFile** buffer.</span></span> <span data-ttu-id="8044e-148">La función también establece los miembros **nFileOffset** y **nFileExtension** en los desplazamientos, en caracteres, desde el inicio del búfer hasta el nombre de archivo y la extensión de nombre de archivo, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="8044e-148">The function also sets the **nFileOffset** and **nFileExtension** members to the offsets, in characters, from the start of the buffer to the file name and to the file name extension, respectively.</span></span>

<span data-ttu-id="8044e-149">Para recuperar solo el nombre de archivo y la extensión, establezca el miembro **lpstrFileTitle** para que apunte a un búfer y establezca el miembro **nMaxFileTitle** en el tamaño, en caracteres, del búfer.</span><span class="sxs-lookup"><span data-stu-id="8044e-149">To retrieve just the file name and extension, set the **lpstrFileTitle** member to point to a buffer and set the **nMaxFileTitle** member to the size, in characters, of the buffer.</span></span> <span data-ttu-id="8044e-150">Como alternativa, puede pasar el búfer de **lpstrFile** en una llamada a la función [**GetFileTitle**](/windows/desktop/api/Commdlg/nf-commdlg-getfiletitlea) para obtener el nombre para mostrar del archivo seleccionado.</span><span class="sxs-lookup"><span data-stu-id="8044e-150">Alternatively, you can pass the **lpstrFile** buffer in a call to the [**GetFileTitle**](/windows/desktop/api/Commdlg/nf-commdlg-getfiletitlea) function to get the display name of the selected file.</span></span> <span data-ttu-id="8044e-151">Sin embargo, tenga en cuenta que el nombre de archivo que devuelve **GetFileTitle** solo incluye una extensión si es la preferencia del usuario para mostrar los nombres de archivo.</span><span class="sxs-lookup"><span data-stu-id="8044e-151">Note, however, that the file name that **GetFileTitle** returns includes an extension only if that is the user's preference for displaying file names.</span></span>

<span data-ttu-id="8044e-152">El cuadro de diálogo utiliza el directorio actual para el proceso de llamada como directorio inicial desde el que se muestran los archivos y directorios.</span><span class="sxs-lookup"><span data-stu-id="8044e-152">The dialog box uses the current directory for the calling process as the initial directory from which to display files and directories.</span></span> <span data-ttu-id="8044e-153">Use las funciones [**GetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-getcurrentdirectory) y [**SetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-setcurrentdirectory) para obtener y cambiar el directorio actual de un proceso.</span><span class="sxs-lookup"><span data-stu-id="8044e-153">Use the [**GetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-getcurrentdirectory) and [**SetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-setcurrentdirectory) functions to get and change the current directory of a process.</span></span> <span data-ttu-id="8044e-154">Para especificar un directorio inicial diferente sin cambiar el directorio actual, use el miembro **lpstrInitialDir** para especificar el nombre de un directorio.</span><span class="sxs-lookup"><span data-stu-id="8044e-154">To specify a different initial directory without changing your current directory, use the **lpstrInitialDir** member to specify the name of a directory.</span></span> <span data-ttu-id="8044e-155">El cuadro de diálogo cambia automáticamente el directorio actual cuando el usuario selecciona una unidad o un directorio diferente.</span><span class="sxs-lookup"><span data-stu-id="8044e-155">The dialog box automatically changes your current directory when the user selects a different drive or directory.</span></span> <span data-ttu-id="8044e-156">Para evitar que el cuadro de diálogo cambie el directorio actual, establezca la marca **OFN \_ NOCHANGEDIR** .</span><span class="sxs-lookup"><span data-stu-id="8044e-156">To prevent the dialog box from changing your current directory, set the **OFN\_NOCHANGEDIR** flag.</span></span> <span data-ttu-id="8044e-157">Esta marca no impide que el usuario cambie los directorios para buscar un archivo.</span><span class="sxs-lookup"><span data-stu-id="8044e-157">This flag does not prevent the user from changing directories to find a file.</span></span>

<span data-ttu-id="8044e-158">Para especificar una extensión de nombre de archivo predeterminada, use el miembro **lpstrDefExt** .</span><span class="sxs-lookup"><span data-stu-id="8044e-158">To specify a default file name extension, use the **lpstrDefExt** member.</span></span> <span data-ttu-id="8044e-159">Si el usuario especifica un nombre de archivo que no tiene una extensión, el cuadro de diálogo agrega la extensión predeterminada.</span><span class="sxs-lookup"><span data-stu-id="8044e-159">If the user specifies a file name that does not have an extension, the dialog box adds your default extension.</span></span> <span data-ttu-id="8044e-160">Si especifica una extensión predeterminada y el usuario especifica un nombre de archivo con una extensión diferente, el cuadro de diálogo establece la marca **\_ EXTENSIONDIFFERENT de OFN** .</span><span class="sxs-lookup"><span data-stu-id="8044e-160">If you specify a default extension and the user specifies a file name with a different extension, the dialog box sets the **OFN\_EXTENSIONDIFFERENT** flag.</span></span>

<span data-ttu-id="8044e-161">Para permitir al usuario seleccionar más de un archivo de un directorio, establezca la marca **OFN \_ ALLOWMULTISELECT** .</span><span class="sxs-lookup"><span data-stu-id="8044e-161">To let the user select more than one file from a directory, set the **OFN\_ALLOWMULTISELECT** flag.</span></span> <span data-ttu-id="8044e-162">Por compatibilidad con las aplicaciones anteriores, el cuadro de diálogo selección múltiple predeterminada utiliza la interfaz de usuario de estilo antiguo.</span><span class="sxs-lookup"><span data-stu-id="8044e-162">For compatibility with older applications, the default multiple selection dialog box uses the old-style user interface.</span></span> <span data-ttu-id="8044e-163">Para mostrar un cuadro de diálogo de selección múltiple de estilo del explorador, también debe establecer la marca **OFN \_ Explorer** .</span><span class="sxs-lookup"><span data-stu-id="8044e-163">To display an Explorer-style multiple selection dialog box, you must also set the **OFN\_EXPLORER** flag.</span></span>

<span data-ttu-id="8044e-164">Si el usuario selecciona más de un archivo, el búfer señalado por el miembro **lpstrFile** devuelve la ruta de acceso al directorio actual seguido de los nombres de archivo de los archivos seleccionados.</span><span class="sxs-lookup"><span data-stu-id="8044e-164">If the user selects more than one file, the buffer pointed to by the **lpstrFile** member returns the path to the current directory followed by the file names of the selected files.</span></span> <span data-ttu-id="8044e-165">El miembro **nFileOffset** es el desplazamiento del primer nombre de archivo y no se utiliza el miembro **nFileExtension** .</span><span class="sxs-lookup"><span data-stu-id="8044e-165">The **nFileOffset** member is the offset to the first file name, and the **nFileExtension** member is not used.</span></span> <span data-ttu-id="8044e-166">En la tabla siguiente se describe la diferencia entre los cuadros de diálogo de estilo de explorador y de estilo antiguo al devolver varios nombres de archivo.</span><span class="sxs-lookup"><span data-stu-id="8044e-166">The following table describes the difference between Explorer-style and old-style dialog boxes in returning multiple file names.</span></span>



| <span data-ttu-id="8044e-167">Estilo de cuadro de diálogo</span><span class="sxs-lookup"><span data-stu-id="8044e-167">Dialog box style</span></span>            | <span data-ttu-id="8044e-168">Descripción</span><span class="sxs-lookup"><span data-stu-id="8044e-168">Description</span></span>                                                                                                                                                                                                               |
|-----------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="8044e-169">Cuadros de diálogo de estilo del explorador</span><span class="sxs-lookup"><span data-stu-id="8044e-169">Explorer-style dialog boxes</span></span> | <span data-ttu-id="8044e-170">Las cadenas de nombre de archivo y directorio se separan con **valores NULL** , con un carácter **nulo** adicional después del último nombre de archivo.</span><span class="sxs-lookup"><span data-stu-id="8044e-170">The directory and file name strings are **NULL** separated, with an extra **NULL** character after the last file name.</span></span> <span data-ttu-id="8044e-171">Este formato permite a los cuadros de diálogo de estilo del explorador devolver nombres de archivo largos que incluyen espacios.</span><span class="sxs-lookup"><span data-stu-id="8044e-171">This format enables the Explorer-style dialog boxes to return long file names that include spaces.</span></span> |
| <span data-ttu-id="8044e-172">Cuadros de diálogo de estilo antiguo</span><span class="sxs-lookup"><span data-stu-id="8044e-172">Old-style dialog boxes</span></span>      | <span data-ttu-id="8044e-173">Las cadenas de nombre de archivo y directorio se separan mediante espacios.</span><span class="sxs-lookup"><span data-stu-id="8044e-173">The directory and file name strings are separated by spaces.</span></span> <span data-ttu-id="8044e-174">En el caso de los nombres de archivo con espacios, la función usa nombres de archivo cortos.</span><span class="sxs-lookup"><span data-stu-id="8044e-174">For file names with spaces, the function uses short file names.</span></span>                                                                                              |



 

<span data-ttu-id="8044e-175">Puede utilizar la función [**FindFirstFile**](/windows/desktop/api/fileapi/nf-fileapi-findfirstfilea) para realizar la conversión entre nombres de archivo largos y cortos.</span><span class="sxs-lookup"><span data-stu-id="8044e-175">You can use the [**FindFirstFile**](/windows/desktop/api/fileapi/nf-fileapi-findfirstfilea) function to convert between long and short file names.</span></span>

<span data-ttu-id="8044e-176">Si especifica **OFN \_ ALLOWMULTISELECT** y el usuario selecciona un solo archivo, la cadena **lpstrFile** no tiene un separador entre la ruta de acceso y el nombre de archivo.</span><span class="sxs-lookup"><span data-stu-id="8044e-176">If you specify **OFN\_ALLOWMULTISELECT** and the user selects only one file, the **lpstrFile** string does not have a separator between the path and file name.</span></span>

## <a name="filters"></a><span data-ttu-id="8044e-177">Filtros</span><span class="sxs-lookup"><span data-stu-id="8044e-177">Filters</span></span>

<span data-ttu-id="8044e-178">La información de esta sección se aplica a los cuadros de diálogo de estilo de explorador y antiguo **abrir** y **Guardar como** .</span><span class="sxs-lookup"><span data-stu-id="8044e-178">The information in this section applies to both Explorer-style and old style **Open** and **Save As** dialog boxes.</span></span>

<span data-ttu-id="8044e-179">Puede proporcionar filtros de nombre de archivo para ayudar al usuario a limitar los nombres de archivo que muestra el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="8044e-179">You can provide file name filters to assist the user in limiting the file names that the dialog box displays.</span></span> <span data-ttu-id="8044e-180">Un filtro de nombre de archivo consta de un par de cadenas terminadas en null, una descripción y un patrón, una concatenada con la otra.</span><span class="sxs-lookup"><span data-stu-id="8044e-180">A file name filter consists of a pair of null-terminated strings, a description and a pattern, one concatenated to the other.</span></span> <span data-ttu-id="8044e-181">El cuadro de diálogo muestra la descripción para permitir que el usuario elija el filtro que se va a usar. y usa el patrón para seleccionar los archivos que se van a mostrar.</span><span class="sxs-lookup"><span data-stu-id="8044e-181">The dialog box displays the description to let the user pick which filter to use; and it uses the pattern to select the files to display.</span></span>

<span data-ttu-id="8044e-182">Para especificar los filtros, establezca el miembro **lpstrFilter** de la estructura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) para que apunte a un búfer que contenga una matriz de pares de cadenas de filtro.</span><span class="sxs-lookup"><span data-stu-id="8044e-182">To specify the filters, set the **lpstrFilter** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure to point to a buffer that contains an array of filter string pairs.</span></span> <span data-ttu-id="8044e-183">La última cadena de la matriz debe ir seguida de un carácter nulo adicional.</span><span class="sxs-lookup"><span data-stu-id="8044e-183">The last string in the array must be followed by an extra null character.</span></span>

<span data-ttu-id="8044e-184">Una cadena de patrón puede ser una combinación de caracteres de nombre de archivo válidos y el asterisco ( \* ).</span><span class="sxs-lookup"><span data-stu-id="8044e-184">A pattern string can be a combination of valid file name characters and the asterisk (\*).</span></span> <span data-ttu-id="8044e-185">El asterisco es un carácter comodín que representa cualquier combinación de caracteres de nombre de archivo válidos.</span><span class="sxs-lookup"><span data-stu-id="8044e-185">The asterisk is a wildcard that represents any combination of valid file name characters.</span></span> <span data-ttu-id="8044e-186">En el cuadro de diálogo solo se muestran los archivos que coinciden con el patrón.</span><span class="sxs-lookup"><span data-stu-id="8044e-186">The dialog box displays only those files that match the pattern.</span></span> <span data-ttu-id="8044e-187">Para especificar varios patrones para la misma descripción, debe usar un punto y coma (;) para separar los patrones.</span><span class="sxs-lookup"><span data-stu-id="8044e-187">To specify multiple patterns for the same description, you must use a semicolon (;) to separate the patterns.</span></span> <span data-ttu-id="8044e-188">Tenga en cuenta que los caracteres de espacio de la cadena de patrón pueden producir resultados inesperados.</span><span class="sxs-lookup"><span data-stu-id="8044e-188">Note that space characters in the pattern string can produce unexpected results.</span></span>

<span data-ttu-id="8044e-189">En el fragmento de código siguiente se especifican dos filtros.</span><span class="sxs-lookup"><span data-stu-id="8044e-189">The following code fragment specifies two filters.</span></span> <span data-ttu-id="8044e-190">El filtro con la descripción "origen" tiene dos patrones.</span><span class="sxs-lookup"><span data-stu-id="8044e-190">The filter with the "Source" description has two patterns.</span></span> <span data-ttu-id="8044e-191">Si el usuario selecciona este filtro, el cuadro de diálogo muestra solo los archivos que tienen el. C y. Extensiones de CXX.</span><span class="sxs-lookup"><span data-stu-id="8044e-191">If the user selects this filter, the dialog box displays only files that have the .C and .CXX extensions.</span></span> <span data-ttu-id="8044e-192">Tenga en cuenta que, en el lenguaje de programación C, una cadena entre comillas dobles está terminada en NULL.</span><span class="sxs-lookup"><span data-stu-id="8044e-192">Note, in the C programming language, a string enclosed in double quotes is null-terminated.</span></span>


```
OPENFILENAME ofn;       // common dialog box structure

ofn.lpstrFilter = "Source\0*.C;*.CXX\0All\0*.*\0"
ofn.nFilterIndex = 1;
```



<span data-ttu-id="8044e-193">El miembro **nFilterIndex** de la estructura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) especifica un índice que indica qué filtro utiliza inicialmente el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="8044e-193">The **nFilterIndex** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure specifies an index that indicates which filter the dialog box initially uses.</span></span> <span data-ttu-id="8044e-194">El primer filtro del búfer tiene el índice 1, el segundo 2, y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="8044e-194">The first filter in the buffer has index 1, the second 2, and so on.</span></span> <span data-ttu-id="8044e-195">Si el usuario cambia el filtro mientras se usa el cuadro de diálogo, el miembro **nFilterIndex** se establece en el índice del filtro seleccionado al devolverse.</span><span class="sxs-lookup"><span data-stu-id="8044e-195">If the user changes the filter while using the dialog box, the **nFilterIndex** member is set to the index of the selected filter on return.</span></span>

<span data-ttu-id="8044e-196">Puede crear un filtro personalizado estableciendo el miembro **lpstrCustomFilter** en la dirección de un búfer que contenga un filtro único y estableciendo el miembro **nMaxCustFilter** en el tamaño del búfer, en caracteres o bytes.</span><span class="sxs-lookup"><span data-stu-id="8044e-196">You can create a custom filter by setting the **lpstrCustomFilter** member to the address of a buffer that contains a single filter, and by setting the **nMaxCustFilter** member to the size of the buffer, in characters or bytes.</span></span> <span data-ttu-id="8044e-197">El cuadro de diálogo siempre coloca el filtro personalizado al principio de la lista de filtros y, en la devolución, siempre actualiza la parte del patrón del filtro con el patrón del filtro seleccionado por el usuario.</span><span class="sxs-lookup"><span data-stu-id="8044e-197">The dialog box always places the custom filter at the beginning of the list of filters and, on return, always updates the pattern part of the filter with the pattern from the filter selected by the user.</span></span>

<span data-ttu-id="8044e-198">En los cuadros de diálogo de estilo del explorador, la extensión predeterminada puede cambiar si el usuario selecciona un filtro diferente.</span><span class="sxs-lookup"><span data-stu-id="8044e-198">For Explorer-style dialog boxes, the default extension may change if the user selects a different filter.</span></span> <span data-ttu-id="8044e-199">Si el usuario selecciona un filtro cuyo primer patrón tiene el formato \* .*XXX* (es decir, la extensión no incluye un carácter comodín), el cuadro de diálogo utiliza *XXX* como extensión predeterminada.</span><span class="sxs-lookup"><span data-stu-id="8044e-199">If the user selects a filter whose first pattern is of the form \*.*xxx* (that is, the extension does not include a wildcard character), the dialog box uses *xxx* as the default extension.</span></span> <span data-ttu-id="8044e-200">Esto solo ocurre si especificó una extensión predeterminada en el miembro **lpstrDefExt** de la estructura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) .</span><span class="sxs-lookup"><span data-stu-id="8044e-200">This occurs only if you specified a default extension in the **lpstrDefExt** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure.</span></span> <span data-ttu-id="8044e-201">Por ejemplo, si el usuario selecciona "origen \\ 0" \* . C; \* . CXX \\ 0 ", la extensión predeterminada cambia a" C ".</span><span class="sxs-lookup"><span data-stu-id="8044e-201">For example, if the user selects the "Source\\0\*.C;\*.CXX\\0" filter, the default extension changes to "C".</span></span> <span data-ttu-id="8044e-202">Sin embargo, si ha definido el filtro como "origen \\ 0" \* . C \* \\ 0 ", la extensión predeterminada no cambiaría porque la extensión incluye un carácter comodín.</span><span class="sxs-lookup"><span data-stu-id="8044e-202">However, if you had defined the filter as "Source\\0\*.C\*\\0", the default extension would not change because the extension includes a wildcard.</span></span>

<span data-ttu-id="8044e-203">El mensaje de notificación [**\_ INCLUDEITEM de CDN**](cdn-includeitem.md) proporciona otra manera de filtrar los nombres que muestra el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="8044e-203">The [**CDN\_INCLUDEITEM**](cdn-includeitem.md) notification message provides another way to filter the names that the dialog box displays.</span></span> <span data-ttu-id="8044e-204">Para usar este mensaje, proporcione un procedimiento de enlace [**OFNHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc) y especifique la marca **\_ ENABLEINCLUDENOTIFY de OFN** en la estructura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) al crear el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="8044e-204">To use this message, provide an [**OFNHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc) hook procedure and specify the **OFN\_ENABLEINCLUDENOTIFY** flag in the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure when you create the dialog box.</span></span> <span data-ttu-id="8044e-205">Cada vez que el usuario abre una carpeta, el cuadro de diálogo envía una notificación **\_ INCLUDEITEM de CDN** al procedimiento de enlace para cada elemento de la carpeta que se acaba de abrir.</span><span class="sxs-lookup"><span data-stu-id="8044e-205">Each time the user opens a folder, the dialog box sends a **CDN\_INCLUDEITEM** notification to your hook procedure for each item in the newly opened folder.</span></span> <span data-ttu-id="8044e-206">El valor devuelto del procedimiento de enlace indica si el cuadro de diálogo debe mostrar el elemento en la lista de elementos de la carpeta.</span><span class="sxs-lookup"><span data-stu-id="8044e-206">The return value of the hook procedure indicates whether the dialog box should display the item in the folder's item list.</span></span>

## <a name="file-and-directory-validation"></a><span data-ttu-id="8044e-207">Validación de archivos y directorios</span><span class="sxs-lookup"><span data-stu-id="8044e-207">File and Directory Validation</span></span>

<span data-ttu-id="8044e-208">A menos que se indique lo contrario, la información de esta sección se aplica a los cuadros de diálogo de estilo de explorador y de estilo antiguo **abrir** y **Guardar como** .</span><span class="sxs-lookup"><span data-stu-id="8044e-208">Except as noted, the information in this section applies to both Explorer-style and old-style **Open** and **Save As** dialog boxes.</span></span>

<span data-ttu-id="8044e-209">El cuadro de diálogo valida automáticamente los nombres de archivo especificados por el usuario para asegurarse de que los nombres solo contienen caracteres válidos.</span><span class="sxs-lookup"><span data-stu-id="8044e-209">The dialog box automatically validates file names typed by the user to ensure that the names contain only valid characters.</span></span> <span data-ttu-id="8044e-210">Para invalidar la validación de caracteres de nombre de archivo, establezca la marca **OFN \_ novalidate** .</span><span class="sxs-lookup"><span data-stu-id="8044e-210">To override the file name character validation, set the **OFN\_NOVALIDATE** flag.</span></span>

<span data-ttu-id="8044e-211">Para forzar que el cuadro de diálogo Compruebe que el usuario especificó el nombre de un archivo existente, establezca la marca **OFN \_ FILEMUSTEXIST** .</span><span class="sxs-lookup"><span data-stu-id="8044e-211">To force the dialog box to verify that the user specified the name of an existing file, set the **OFN\_FILEMUSTEXIST** flag.</span></span> <span data-ttu-id="8044e-212">Para forzar la comprobación de que existe la ruta de acceso especificada, establezca la marca **OFN \_ PATHMUSTEXIST** .</span><span class="sxs-lookup"><span data-stu-id="8044e-212">To force verification that the specified path exists, set the **OFN\_PATHMUSTEXIST** flag.</span></span> <span data-ttu-id="8044e-213">Si establece la marca **OFN \_ CREATEPROMPT** , el cuadro de diálogo le pedirá permiso al usuario para crear un archivo inexistente.</span><span class="sxs-lookup"><span data-stu-id="8044e-213">If you set the **OFN\_CREATEPROMPT** flag, the dialog box prompts the user for permission to create a nonexistent file.</span></span> <span data-ttu-id="8044e-214">Si se establece esta marca y el usuario elige crear un nuevo archivo, el cuadro de diálogo se cierra y la función devuelve el nombre especificado.</span><span class="sxs-lookup"><span data-stu-id="8044e-214">If this flag is set and the user chooses to create a new file, the dialog box closes, and the function returns the specified name.</span></span> <span data-ttu-id="8044e-215">De lo contrario, el cuadro de diálogo permanece abierto.</span><span class="sxs-lookup"><span data-stu-id="8044e-215">Otherwise, the dialog box remains open.</span></span>

<span data-ttu-id="8044e-216">Al usar el cuadro de diálogo **Guardar como** , puede dirigir el cuadro de diálogo para pedir permiso al usuario para sobrescribir un archivo existente estableciendo la marca **\_ OVERWRITEPROMPT de OFN** .</span><span class="sxs-lookup"><span data-stu-id="8044e-216">When using the **Save As** dialog box, you can direct the dialog box to prompt the user for permission to overwrite an existing file by setting the **OFN\_OVERWRITEPROMPT** flag.</span></span>

<span data-ttu-id="8044e-217">De forma predeterminada, el cuadro de diálogo crea un archivo de prueba de longitud cero para determinar si se puede crear un nuevo archivo en el directorio seleccionado.</span><span class="sxs-lookup"><span data-stu-id="8044e-217">By default, the dialog box creates a zero-length test file to determine whether a new file can be created in the selected directory.</span></span> <span data-ttu-id="8044e-218">Para evitar la creación de este archivo de prueba, establezca la marca **OFN \_ NOTESTFILECREATE** .</span><span class="sxs-lookup"><span data-stu-id="8044e-218">To prevent the creation of this test file, set the **OFN\_NOTESTFILECREATE** flag.</span></span>

<span data-ttu-id="8044e-219">Si habilita un procedimiento de enlace, el cuadro de diálogo notifica al procedimiento de enlace cuando se produce una infracción de uso compartido de red para el nombre de archivo especificado por el usuario.</span><span class="sxs-lookup"><span data-stu-id="8044e-219">If you enable a hook procedure, the dialog box notifies your hook procedure when a network sharing violation occurs for the file name specified by the user.</span></span> <span data-ttu-id="8044e-220">Si establece la marca **del \_ Explorador de OFN** , el cuadro de diálogo envía el mensaje [**\_ SHAREVIOLATION de la red CDN**](cdn-shareviolation.md) al procedimiento de enlace.</span><span class="sxs-lookup"><span data-stu-id="8044e-220">If you set the **OFN\_EXPLORER** flag, the dialog box sends the [**CDN\_SHAREVIOLATION**](cdn-shareviolation.md) message to the hook procedure.</span></span> <span data-ttu-id="8044e-221">Si no establece **OFN \_ Explorer**, el cuadro de diálogo envía el mensaje [**SHAREVISTRING**](sharevistring.md) registrado al procedimiento de enlace.</span><span class="sxs-lookup"><span data-stu-id="8044e-221">If you do not set **OFN\_EXPLORER**, the dialog box sends the [**SHAREVISTRING**](sharevistring.md) registered message to the hook procedure.</span></span> <span data-ttu-id="8044e-222">Para evitar que el cuadro de diálogo envíe notificaciones de infracciones de uso compartido, establezca la marca **OFN \_ SHAREAWARE** .</span><span class="sxs-lookup"><span data-stu-id="8044e-222">To prevent the dialog box from sending any notifications for sharing violations, set the **OFN\_SHAREAWARE** flag.</span></span>

<span data-ttu-id="8044e-223">Si el usuario selecciona la casilla de solo lectura, el cuadro de diálogo establece la **marca \_ ReadOnly de OFN** en la devolución.</span><span class="sxs-lookup"><span data-stu-id="8044e-223">If the user selects the read-only check box, the dialog box sets the **OFN\_READONLY** flag on return.</span></span> <span data-ttu-id="8044e-224">Para ocultar la casilla **Abrir como solo lectura** , establezca la marca **OFN \_ HIDEREADONLY** .</span><span class="sxs-lookup"><span data-stu-id="8044e-224">To hide the **Open As Read Only** check box, set the **OFN\_HIDEREADONLY** flag.</span></span> <span data-ttu-id="8044e-225">Para evitar que el cuadro de diálogo devuelva nombres de archivos existentes que tengan el atributo de solo lectura, establezca la marca **OFN \_ NOREADONLYRETURN** .</span><span class="sxs-lookup"><span data-stu-id="8044e-225">To prevent the dialog box from returning names of existing files that have the read-only attribute, set the **OFN\_NOREADONLYRETURN** flag.</span></span>

<span data-ttu-id="8044e-226">Para evitar que el cuadro de diálogo desreferencia los archivos de vínculo, establezca el valor de **\_ NODEREFERENCELINKS de OFN** .</span><span class="sxs-lookup"><span data-stu-id="8044e-226">To prevent the dialog box from dereferencing link files, set the **OFN\_NODEREFERENCELINKS** value.</span></span> <span data-ttu-id="8044e-227">En este caso, el cuadro de diálogo devuelve el nombre del archivo de vínculo en lugar del nombre del archivo al que hace referencia el archivo de vínculo.</span><span class="sxs-lookup"><span data-stu-id="8044e-227">In this case, the dialog box returns the name of the link file rather than the name of the file referenced by the link file.</span></span>

## <a name="open-and-save-as-dialog-box-customization"></a><span data-ttu-id="8044e-228">Abrir y guardar como personalización del cuadro de diálogo</span><span class="sxs-lookup"><span data-stu-id="8044e-228">Open and Save As Dialog Box Customization</span></span>

<span data-ttu-id="8044e-229">Puede personalizar un cuadro de diálogo **abrir** o **Guardar como** si proporciona un procedimiento de enlace, una plantilla personalizada o ambos.</span><span class="sxs-lookup"><span data-stu-id="8044e-229">You can customize an **Open** or **Save As** dialog box by providing a hook procedure, a custom template, or both.</span></span> <span data-ttu-id="8044e-230">Sin embargo, las versiones de estilo de explorador y de estilo anterior de los cuadros de diálogo difieren en el uso de plantillas personalizadas y procedimientos de enlace.</span><span class="sxs-lookup"><span data-stu-id="8044e-230">However, the Explorer-style and old-style versions of the dialog boxes differ in their use of custom templates and hook procedures.</span></span>

<span data-ttu-id="8044e-231">Para obtener información sobre cómo personalizar un cuadro de diálogo de estilo del explorador, vea [procedimientos de enlace de estilo](#explorer-style-hook-procedures)del explorador, [plantillas personalizadas de estilo del](#explorer-style-custom-templates)explorador y [identificadores de controles de estilo del explorador](#explorer-style-control-identifiers).</span><span class="sxs-lookup"><span data-stu-id="8044e-231">For information about customizing an Explorer-style dialog box, see [Explorer-Style Hook Procedures](#explorer-style-hook-procedures), [Explorer-Style Custom Templates](#explorer-style-custom-templates), and [Explorer-Style Control Identifiers](#explorer-style-control-identifiers).</span></span> <span data-ttu-id="8044e-232">Para obtener información sobre cómo personalizar un cuadro de diálogo de estilo antiguo, vea [personalizar Old-Style cuadros de diálogo](#customizing-old-style-dialog-boxes).</span><span class="sxs-lookup"><span data-stu-id="8044e-232">For information about customizing an old-style dialog box, see [Customizing Old-Style Dialog Boxes](#customizing-old-style-dialog-boxes).</span></span>

<span data-ttu-id="8044e-233">En la tabla siguiente se resumen las diferencias entre los dos estilos.</span><span class="sxs-lookup"><span data-stu-id="8044e-233">The following table summarizes the differences between the two styles.</span></span>



| <span data-ttu-id="8044e-234">Personalización</span><span class="sxs-lookup"><span data-stu-id="8044e-234">Customization</span></span>                  | <span data-ttu-id="8044e-235">Descripción</span><span class="sxs-lookup"><span data-stu-id="8044e-235">Description</span></span>                                                                                                                                                                                                                                                                          |
|--------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="8044e-236">Procedimiento de enlace de estilo del explorador</span><span class="sxs-lookup"><span data-stu-id="8044e-236">Explorer-style Hook procedure</span></span>  | <span data-ttu-id="8044e-237">El procedimiento de enlace recibe mensajes de notificación enviados desde el cuadro de diálogo común y mensajes para cualquier control adicional que haya definido especificando una plantilla de diálogo secundaria.</span><span class="sxs-lookup"><span data-stu-id="8044e-237">The hook procedure receives notification messages sent from the common dialog box and messages for any additional controls that you defined by specifying a child dialog template.</span></span> <span data-ttu-id="8044e-238">El procedimiento de enlace no recibe mensajes para los controles estándar del cuadro de diálogo predeterminado.</span><span class="sxs-lookup"><span data-stu-id="8044e-238">The hook procedure does not receive messages for the standard controls of the default dialog box.</span></span> |
| <span data-ttu-id="8044e-239">Plantilla personalizada de estilo de explorador</span><span class="sxs-lookup"><span data-stu-id="8044e-239">Explorer-style Custom template</span></span> | <span data-ttu-id="8044e-240">El sistema utiliza la plantilla personalizada para crear un cuadro de diálogo secundario.</span><span class="sxs-lookup"><span data-stu-id="8044e-240">The system uses the custom template to create a child dialog box.</span></span> <span data-ttu-id="8044e-241">La plantilla puede definir controles adicionales y puede especificar la ubicación del clúster de controles estándar.</span><span class="sxs-lookup"><span data-stu-id="8044e-241">The template can define additional controls, and can specify the location of the cluster of standard controls.</span></span> <span data-ttu-id="8044e-242">La plantilla personalizada no reemplaza la plantilla predeterminada.</span><span class="sxs-lookup"><span data-stu-id="8044e-242">The custom template does not replace the default template.</span></span>                                          |
| <span data-ttu-id="8044e-243">Procedimiento de enlace de estilo antiguo</span><span class="sxs-lookup"><span data-stu-id="8044e-243">Old-style Hook procedure</span></span>       | <span data-ttu-id="8044e-244">El procedimiento de enlace recibe todos los mensajes enviados al cuadro de diálogo, incluidos los mensajes de los controles estándar y los controles personalizados.</span><span class="sxs-lookup"><span data-stu-id="8044e-244">The hook procedure receives all messages sent to the dialog box, including messages for the standard controls and any custom controls.</span></span> <span data-ttu-id="8044e-245">El procedimiento de enlace recibe también mensajes registrados enviados desde el cuadro de diálogo común.</span><span class="sxs-lookup"><span data-stu-id="8044e-245">The hook procedure also receives registered messages sent from the common dialog box.</span></span>                                                         |
| <span data-ttu-id="8044e-246">Plantilla personalizada de estilo antiguo</span><span class="sxs-lookup"><span data-stu-id="8044e-246">Old-style Custom template</span></span>      | <span data-ttu-id="8044e-247">La plantilla personalizada reemplaza la plantilla predeterminada.</span><span class="sxs-lookup"><span data-stu-id="8044e-247">The custom template replaces the default template.</span></span> <span data-ttu-id="8044e-248">Cree la plantilla personalizada modificando la plantilla predeterminada especificada en el archivo FileOpen. Dlg.</span><span class="sxs-lookup"><span data-stu-id="8044e-248">Create the custom template by modifying the default template specified in the Fileopen.dlg file.</span></span>                                                                                                                                  |



 

<span data-ttu-id="8044e-249">El título predeterminado para los cuadros de diálogo estilo del explorador y estilo antiguo es "**abrir**" o "**Guardar como**".</span><span class="sxs-lookup"><span data-stu-id="8044e-249">The default title for both Explorer-style and old-style dialog boxes is either "**Open**" or "**Save As**."</span></span> <span data-ttu-id="8044e-250">Para cambiar el título, especifique el nuevo título en el miembro **lpstrTitle** de la estructura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) .</span><span class="sxs-lookup"><span data-stu-id="8044e-250">To change the title, specify the new title in the **lpstrTitle** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure.</span></span>

<span data-ttu-id="8044e-251">El subárbol del registro de **\_ \_ usuario actual de HKEY** puede contener valores que personalicen el contenido de los cuadros de diálogo **abrir** y **Guardar como** del explorador.</span><span class="sxs-lookup"><span data-stu-id="8044e-251">A user's **HKEY\_CURRENT\_USER** registry hive can contain values that customize the contents of the Explorer-style **Open** and **Save As** dialog boxes.</span></span> <span data-ttu-id="8044e-252">Estas entradas del registro solo afectan a los cuadros de diálogo que se muestran para el usuario asociado al subárbol del registro.</span><span class="sxs-lookup"><span data-stu-id="8044e-252">These registry entries affect only the dialog boxes displayed for the user associated with the registry hive.</span></span>

<span data-ttu-id="8044e-253">Para ocultar características de los cuadros de diálogo **abrir** y **Guardar como** del explorador, un administrador puede establecer los valores de la tabla siguiente bajo esta subclave:</span><span class="sxs-lookup"><span data-stu-id="8044e-253">To hide features of Explorer-style **Open** and **Save As** dialog boxes, an administrator can set the values in the following table under this subkey:</span></span>

```
HKEY_CURRENT_USER
   Software
      Microsoft
         Windows
            CurrentVersion
               Policies
                  Comdlg32
```



| <span data-ttu-id="8044e-254">Nombre del valor</span><span class="sxs-lookup"><span data-stu-id="8044e-254">Value name</span></span>       | <span data-ttu-id="8044e-255">Valor</span><span class="sxs-lookup"><span data-stu-id="8044e-255">Value</span></span> | <span data-ttu-id="8044e-256">Significado</span><span class="sxs-lookup"><span data-stu-id="8044e-256">Meaning</span></span>                                  |
|------------------|-------|------------------------------------------|
| <span data-ttu-id="8044e-257">**NoPlacesBar**</span><span class="sxs-lookup"><span data-stu-id="8044e-257">**NoPlacesBar**</span></span>  | <span data-ttu-id="8044e-258">1</span><span class="sxs-lookup"><span data-stu-id="8044e-258">1</span></span>     | <span data-ttu-id="8044e-259">Oculta la barra de ubicaciones.</span><span class="sxs-lookup"><span data-stu-id="8044e-259">Hides the places bar.</span></span>                    |
| <span data-ttu-id="8044e-260">**NoFileMRU**</span><span class="sxs-lookup"><span data-stu-id="8044e-260">**NoFileMRU**</span></span>    | <span data-ttu-id="8044e-261">1</span><span class="sxs-lookup"><span data-stu-id="8044e-261">1</span></span>     | <span data-ttu-id="8044e-262">Oculta la lista de elementos usados más recientemente (MRU).</span><span class="sxs-lookup"><span data-stu-id="8044e-262">Hides the Most Recently Used (MRU) list.</span></span> |
| <span data-ttu-id="8044e-263">**NoBackButton**</span><span class="sxs-lookup"><span data-stu-id="8044e-263">**NoBackButton**</span></span> | <span data-ttu-id="8044e-264">1</span><span class="sxs-lookup"><span data-stu-id="8044e-264">1</span></span>     | <span data-ttu-id="8044e-265">Oculta el botón **atrás** .</span><span class="sxs-lookup"><span data-stu-id="8044e-265">Hides the **Back** button.</span></span>               |



 

<span data-ttu-id="8044e-266">El contenido de la barra de **ubicaciones** viene determinado por el contenido de la siguiente subclave:</span><span class="sxs-lookup"><span data-stu-id="8044e-266">The contents of the **Places** bar are determined by the contents of the following subkey:</span></span>

```
HKEY_CURRENT_USER
   Software
      Microsoft
         Windows
            CurrentVersion
               Policies
                  Comdlg32
                     Placesbar
```

<span data-ttu-id="8044e-267">Actualmente, solo puede haber cinco entradas bajo esta clave y el índice de valor/nombre está basado en cero.</span><span class="sxs-lookup"><span data-stu-id="8044e-267">Currently, there can only be five entries under this key, and the value/name index is zero-based.</span></span> <span data-ttu-id="8044e-268">Los nombres de las entradas deben ser Place0, Place1, Place2, Place3 y Place4.</span><span class="sxs-lookup"><span data-stu-id="8044e-268">The names for the entries should be Place0, Place1, Place2,Place3, and Place4.</span></span> <span data-ttu-id="8044e-269">Los valores de las entradas pueden ser los valores **reg \_ DWORD**, **reg \_ SZ** o **reg \_ Expand \_ SZ** que identifiquen las ubicaciones que se van a incluir en la barra de ubicaciones.</span><span class="sxs-lookup"><span data-stu-id="8044e-269">The values of the entries can be **REG\_DWORD**, **REG\_SZ**, or **REG\_EXPAND\_SZ** values that identify locations to include in the places bar.</span></span>



| <span data-ttu-id="8044e-270">Tipo de valor</span><span class="sxs-lookup"><span data-stu-id="8044e-270">Value type</span></span>                         | <span data-ttu-id="8044e-271">Significado</span><span class="sxs-lookup"><span data-stu-id="8044e-271">Meaning</span></span>                                                                                                   |
|------------------------------------|-----------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="8044e-272">**\_valor DWORD reg**</span><span class="sxs-lookup"><span data-stu-id="8044e-272">**REG\_DWORD**</span></span>                     | <span data-ttu-id="8044e-273">Valor CSIDL que identifica una carpeta.</span><span class="sxs-lookup"><span data-stu-id="8044e-273">A CSIDL value that identifies a folder.</span></span> <span data-ttu-id="8044e-274">Para obtener una lista de valores de CSIDL, consulte [**valores de CSIDL**](../shell/csidl.md).</span><span class="sxs-lookup"><span data-stu-id="8044e-274">For a list of CSIDL values, see [**CSIDL values**](../shell/csidl.md).</span></span> |
| <span data-ttu-id="8044e-275">**Reg \_ . SZ** o **reg \_ Expand \_ SZ**</span><span class="sxs-lookup"><span data-stu-id="8044e-275">**REG\_SZ** or **REG\_EXPAND\_SZ**</span></span> | <span data-ttu-id="8044e-276">Una cadena terminada en null que especifica una ruta de acceso válida.</span><span class="sxs-lookup"><span data-stu-id="8044e-276">A null-terminated string that specifies a valid path.</span></span>                                                     |



 

## <a name="explorer-style-hook-procedures"></a><span data-ttu-id="8044e-277">Explorer-Style procedimientos de enlace</span><span class="sxs-lookup"><span data-stu-id="8044e-277">Explorer-Style Hook Procedures</span></span>

<span data-ttu-id="8044e-278">Puede personalizar un cuadro de diálogo para **abrir** o **Guardar como** estilo del explorador proporcionando un procedimiento de enlace, una plantilla personalizada o ambos.</span><span class="sxs-lookup"><span data-stu-id="8044e-278">You can customize an Explorer-style **Open** or **Save As** dialog box by providing a hook procedure, a custom template, or both.</span></span> <span data-ttu-id="8044e-279">Si proporciona un procedimiento de enlace para un cuadro de diálogo de estilo Explorador, el sistema crea un cuadro de diálogo que es un elemento secundario del cuadro de diálogo predeterminado.</span><span class="sxs-lookup"><span data-stu-id="8044e-279">If you provide a hook procedure for an Explorer-style dialog box, the system creates a dialog box that is a child of the default dialog box.</span></span> <span data-ttu-id="8044e-280">El procedimiento de enlace actúa como el procedimiento de diálogo para el cuadro de diálogo secundario.</span><span class="sxs-lookup"><span data-stu-id="8044e-280">The hook procedure acts as the dialog procedure for the child dialog box.</span></span> <span data-ttu-id="8044e-281">Este cuadro de diálogo secundario se basa en la plantilla personalizada o en una plantilla predeterminada si no se proporciona ninguno.</span><span class="sxs-lookup"><span data-stu-id="8044e-281">This child dialog box is based on the custom template, or on a default template if none is provided.</span></span> <span data-ttu-id="8044e-282">Para obtener más información, vea [plantillas personalizadas de estilo de explorador](#explorer-style-custom-templates).</span><span class="sxs-lookup"><span data-stu-id="8044e-282">For more information, see [Explorer-Style Custom Templates](#explorer-style-custom-templates).</span></span>

<span data-ttu-id="8044e-283">Para habilitar un procedimiento de enlace para un cuadro de diálogo para **abrir** o **Guardar como** estilo del explorador, use la estructura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) al crear el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="8044e-283">To enable a hook procedure for an Explorer-style **Open** or **Save As** dialog box, use the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure when you create the dialog box.</span></span> <span data-ttu-id="8044e-284">Establezca las **marcas OFN \_ ENABLEHOOK** y **OFN \_ Explorer** en el miembro **Flags** y especifique la dirección de un procedimiento de enlace [**OFNHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc) en el miembro **lpfnHook** .</span><span class="sxs-lookup"><span data-stu-id="8044e-284">Set the **OFN\_ENABLEHOOK** and **OFN\_EXPLORER** flags in the **Flags** member and specify the address of an [**OFNHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc) hook procedure in the **lpfnHook** member.</span></span> <span data-ttu-id="8044e-285">Si proporciona un procedimiento de enlace y omite la marca del **\_ Explorador de OFN** , debe usar un procedimiento de enlace de [**OFNHookProcOldStyle**](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) y obtendrá la interfaz de usuario de estilo antiguo.</span><span class="sxs-lookup"><span data-stu-id="8044e-285">If you provide a hook procedure and omit the **OFN\_EXPLORER** flag, you must use an [**OFNHookProcOldStyle**](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) hook procedure and you will get the old-style user-interface.</span></span> <span data-ttu-id="8044e-286">Para obtener más información, vea [personalizar Old-Style cuadros de diálogo](#customizing-old-style-dialog-boxes).</span><span class="sxs-lookup"><span data-stu-id="8044e-286">For more information, see [Customizing Old-Style Dialog Boxes](#customizing-old-style-dialog-boxes).</span></span>

<span data-ttu-id="8044e-287">Un procedimiento de enlace de estilo del explorador recibe una variedad de mensajes mientras el cuadro de diálogo está abierto.</span><span class="sxs-lookup"><span data-stu-id="8044e-287">An Explorer-style hook procedure receives a variety of messages while the dialog box is open.</span></span> <span data-ttu-id="8044e-288">Entre ellas, figuran:</span><span class="sxs-lookup"><span data-stu-id="8044e-288">These include the following:</span></span>

-   <span data-ttu-id="8044e-289">Mensaje [**de \_ INITDIALOG de WM**](wm-initdialog.md) y otros mensajes del cuadro de diálogo estándar, como el mensaje de color de control de [**\_ CTLCOLORDLG de WM**](wm-ctlcolordlg.md) .</span><span class="sxs-lookup"><span data-stu-id="8044e-289">The [**WM\_INITDIALOG**](wm-initdialog.md) message and other standard dialog box messages such as the [**WM\_CTLCOLORDLG**](wm-ctlcolordlg.md) control color message.</span></span>
-   <span data-ttu-id="8044e-290">Un conjunto de mensajes de notificación de [**\_ notificaciones de WM**](../controls/wm-notify.md) que indican las acciones realizadas por el usuario u otros eventos del cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="8044e-290">A set of [**WM\_NOTIFY**](../controls/wm-notify.md) notification messages indicating actions taken by the user or other dialog box events.</span></span>
-   <span data-ttu-id="8044e-291">Mensajes para cualquier control adicional que haya definido especificando una plantilla de cuadro de diálogo secundaria.</span><span class="sxs-lookup"><span data-stu-id="8044e-291">Messages for any additional controls that you defined by specifying a child dialog template.</span></span>

<span data-ttu-id="8044e-292">Además, hay un conjunto de mensajes que se pueden enviar a un cuadro de diálogo de estilo Explorador para obtener información o para controlar el comportamiento y la apariencia del cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="8044e-292">In addition, there is a set of messages that you can send to an Explorer-style dialog box to get information or to control the behavior and appearance of the dialog box.</span></span>

<span data-ttu-id="8044e-293">Si proporciona un procedimiento de enlace para un cuadro de diálogo de estilo Explorador, el procedimiento de cuadro de diálogo predeterminado crea un cuadro de diálogo secundario cuando el procedimiento de diálogo predeterminado está procesando su mensaje de [**WM \_ INITDIALOG**](wm-initdialog.md) .</span><span class="sxs-lookup"><span data-stu-id="8044e-293">If you provide a hook procedure for an Explorer-style dialog box, the default dialog box procedure creates a child dialog box when the default dialog procedure is processing its [**WM\_INITDIALOG**](wm-initdialog.md) message.</span></span> <span data-ttu-id="8044e-294">El procedimiento de enlace actúa como el procedimiento de diálogo para el cuadro de diálogo secundario.</span><span class="sxs-lookup"><span data-stu-id="8044e-294">The hook procedure acts as the dialog procedure for the child dialog box.</span></span> <span data-ttu-id="8044e-295">En este momento, el procedimiento de enlace recibe su propio mensaje de **WM \_ INITDIALOG** con el parámetro *lParam* establecido en la dirección de la estructura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) usada para inicializar el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="8044e-295">At this time, the hook procedure receives its own **WM\_INITDIALOG** message with the *lParam* parameter set to the address of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure used to initialize the dialog box.</span></span> <span data-ttu-id="8044e-296">Después de que el cuadro de diálogo secundario finaliza el procesamiento de su propio mensaje de **\_ INITDIALOG de WM** , el procedimiento de cuadro de diálogo predeterminado mueve los controles estándar, si es necesario, para dejar espacio a los controles adicionales del cuadro de diálogo secundario.</span><span class="sxs-lookup"><span data-stu-id="8044e-296">After the child dialog finishes processing its own **WM\_INITDIALOG** message, the default dialog procedure moves the standard controls, if necessary, to make room for any additional controls of the child dialog box.</span></span> <span data-ttu-id="8044e-297">Después, el procedimiento de cuadro de diálogo predeterminado envía el mensaje de notificación [**\_ INITDONE de la red CDN**](cdn-initdone.md) al procedimiento de enlace.</span><span class="sxs-lookup"><span data-stu-id="8044e-297">The default dialog procedure then sends the [**CDN\_INITDONE**](cdn-initdone.md) notification message to the hook procedure.</span></span>

<span data-ttu-id="8044e-298">El procedimiento de enlace recibe mensajes de notificación de [**\_ notificaciones de WM**](../controls/wm-notify.md) que indican las acciones realizadas por el usuario en el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="8044e-298">The hook procedure receives [**WM\_NOTIFY**](../controls/wm-notify.md) notification messages indicating actions taken by the user in the dialog box.</span></span> <span data-ttu-id="8044e-299">Puede usar algunos de estos mensajes para controlar el comportamiento del cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="8044e-299">You can use some of these messages to control the behavior of the dialog box.</span></span> <span data-ttu-id="8044e-300">Por ejemplo, el procedimiento de enlace recibe el mensaje [**\_ FILEOK de la red CDN**](cdn-fileok.md) cuando el usuario elige un nombre de archivo y hace clic en el botón **Aceptar** .</span><span class="sxs-lookup"><span data-stu-id="8044e-300">For example, the hook procedure receives the [**CDN\_FILEOK**](cdn-fileok.md) message when the user chooses a file name and clicks the **OK** button.</span></span> <span data-ttu-id="8044e-301">En respuesta a este mensaje, el procedimiento de enlace puede utilizar la función [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) para rechazar el nombre seleccionado y forzar que el cuadro de diálogo permanezca abierto.</span><span class="sxs-lookup"><span data-stu-id="8044e-301">In response to this message, the hook procedure can use the [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) function to reject the selected name and force the dialog box to remain open.</span></span>

<span data-ttu-id="8044e-302">El parámetro *lParam* de cada mensaje de [**\_ notificación de WM**](../controls/wm-notify.md) es un puntero a una estructura de [**Notify**](/windows/desktop/api/Commdlg/ns-commdlg-ofnotifya) o [**OFNOTIFYEX**](/windows/desktop/api/Commdlg/ns-commdlg-ofnotifyexa) que define la acción.</span><span class="sxs-lookup"><span data-stu-id="8044e-302">The *lParam* parameter for each [**WM\_NOTIFY**](../controls/wm-notify.md) message is a pointer to an [**OFNOTIFY**](/windows/desktop/api/Commdlg/ns-commdlg-ofnotifya) or [**OFNOTIFYEX**](/windows/desktop/api/Commdlg/ns-commdlg-ofnotifyexa) structure that defines the action.</span></span> <span data-ttu-id="8044e-303">El miembro de **código** en el encabezado de esta estructura contiene uno de los siguientes mensajes de notificación.</span><span class="sxs-lookup"><span data-stu-id="8044e-303">The **code** member in the header of this structure contains one of the following notification messages.</span></span>



| <span data-ttu-id="8044e-304">Mensaje</span><span class="sxs-lookup"><span data-stu-id="8044e-304">Message</span></span>                                           | <span data-ttu-id="8044e-305">Significado</span><span class="sxs-lookup"><span data-stu-id="8044e-305">Meaning</span></span>                                                                                                                                                                                                                                                                                        |
|---------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8044e-306">**FILEOK de CDN \_**</span><span class="sxs-lookup"><span data-stu-id="8044e-306">**CDN\_FILEOK**</span></span>](cdn-fileok.md)                 | <span data-ttu-id="8044e-307">El usuario hizo clic en el botón **Aceptar** ; el cuadro de diálogo está a punto de cerrarse.</span><span class="sxs-lookup"><span data-stu-id="8044e-307">The user clicked the **OK** button; the dialog box is about to close.</span></span>                                                                                                                                                                                                                          |
| [<span data-ttu-id="8044e-308">**FOLDERCHANGE de CDN \_**</span><span class="sxs-lookup"><span data-stu-id="8044e-308">**CDN\_FOLDERCHANGE**</span></span>](cdn-folderchange.md)     | <span data-ttu-id="8044e-309">El usuario ha abierto una nueva carpeta o directorio.</span><span class="sxs-lookup"><span data-stu-id="8044e-309">The user opened a new folder or directory.</span></span>                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="8044e-310">**ayuda de CDN \_**</span><span class="sxs-lookup"><span data-stu-id="8044e-310">**CDN\_HELP**</span></span>](cdn-help.md)                     | <span data-ttu-id="8044e-311">El usuario hizo clic en el botón **ayuda** .</span><span class="sxs-lookup"><span data-stu-id="8044e-311">The user clicked the **Help** button.</span></span>                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="8044e-312">**INCLUDEITEM de CDN \_**</span><span class="sxs-lookup"><span data-stu-id="8044e-312">**CDN\_INCLUDEITEM**</span></span>](cdn-includeitem.md)       | <span data-ttu-id="8044e-313">Determina si se debe mostrar un elemento.</span><span class="sxs-lookup"><span data-stu-id="8044e-313">Determines whether an item should be displayed.</span></span> <span data-ttu-id="8044e-314">Cuando el usuario abre una nueva carpeta o directorio, el sistema envía esta notificación para cada elemento de la carpeta o directorio.</span><span class="sxs-lookup"><span data-stu-id="8044e-314">When the user opens a new folder or directory, the system sends this notification for each item in the folder or directory.</span></span> <span data-ttu-id="8044e-315">El sistema envía esta notificación solo si se estableció la marca **OFN \_ ENABLEINCLUDENOTIFY** .</span><span class="sxs-lookup"><span data-stu-id="8044e-315">The system sends this notification only if the **OFN\_ENABLEINCLUDENOTIFY** flag was set.</span></span>                          |
| [<span data-ttu-id="8044e-316">**INITDONE de CDN \_**</span><span class="sxs-lookup"><span data-stu-id="8044e-316">**CDN\_INITDONE**</span></span>](cdn-initdone.md)             | <span data-ttu-id="8044e-317">El sistema ha terminado de inicializar el cuadro de diálogo y el cuadro de diálogo ha terminado de procesar el mensaje de [**\_ INITDIALOG de WM**](wm-initdialog.md) .</span><span class="sxs-lookup"><span data-stu-id="8044e-317">The system has finished initializing the dialog box, and the dialog box has finished processing the [**WM\_INITDIALOG**](wm-initdialog.md) message.</span></span> <span data-ttu-id="8044e-318">Además, el sistema ha terminado de organizar los controles en el cuadro de diálogo común para dejar espacio a los controles del cuadro de diálogo secundario (si hay alguno).</span><span class="sxs-lookup"><span data-stu-id="8044e-318">Also, the system has finished arranging controls in the common dialog box to make room for the controls of the child dialog box (if any).</span></span> |
| [<span data-ttu-id="8044e-319">**SELCHANGE de CDN \_**</span><span class="sxs-lookup"><span data-stu-id="8044e-319">**CDN\_SELCHANGE**</span></span>](cdn-selchange.md)           | <span data-ttu-id="8044e-320">El usuario seleccionó un nuevo archivo o carpeta en la lista de archivos.</span><span class="sxs-lookup"><span data-stu-id="8044e-320">The user selected a new file or folder from the file list.</span></span>                                                                                                                                                                                                                                     |
| [<span data-ttu-id="8044e-321">**SHAREVIOLATION de CDN \_**</span><span class="sxs-lookup"><span data-stu-id="8044e-321">**CDN\_SHAREVIOLATION**</span></span>](cdn-shareviolation.md) | <span data-ttu-id="8044e-322">El cuadro de diálogo común encontró una infracción de uso compartido en el archivo que se va a devolver.</span><span class="sxs-lookup"><span data-stu-id="8044e-322">The common dialog box encountered a sharing violation on the file about to be returned.</span></span>                                                                                                                                                                                                        |
| [<span data-ttu-id="8044e-323">**TYPECHANGE de CDN \_**</span><span class="sxs-lookup"><span data-stu-id="8044e-323">**CDN\_TYPECHANGE**</span></span>](cdn-typechange.md)         | <span data-ttu-id="8044e-324">El usuario seleccionó un nuevo tipo de archivo en la lista de tipos de archivo.</span><span class="sxs-lookup"><span data-stu-id="8044e-324">The user selected a new file type from the list of file types.</span></span>                                                                                                                                                                                                                                 |



 

<span data-ttu-id="8044e-325">Estos mensajes de [**\_ notificación de WM**](../controls/wm-notify.md) sustituyen a los mensajes registrados [**FILEOKSTRING**](fileokstring.md), [**LBSELCHSTRING**](lbselchstring.md), [**SHAREVISTRING**](sharevistring.md)y [**HELPMSGSTRING**](helpmsgstring.md) utilizados por versiones anteriores de los cuadros de diálogo **abrir** y **Guardar como** .</span><span class="sxs-lookup"><span data-stu-id="8044e-325">These [**WM\_NOTIFY**](../controls/wm-notify.md) messages supersede the [**FILEOKSTRING**](fileokstring.md), [**LBSELCHSTRING**](lbselchstring.md), [**SHAREVISTRING**](sharevistring.md), and [**HELPMSGSTRING**](helpmsgstring.md) registered messages used by previous versions of the **Open** and **Save As** dialog boxes.</span></span> <span data-ttu-id="8044e-326">Sin embargo, el procedimiento de enlace recibe también el mensaje reemplazado después del mensaje de **\_ notificación de WM** si el procesamiento de **\_ notificaciones de WM** no usa [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) para establecer un valor **\_ MSGRESULT de DWL** distinto de cero.</span><span class="sxs-lookup"><span data-stu-id="8044e-326">However, the hook procedure also receives the superseded message after the **WM\_NOTIFY** message if the **WM\_NOTIFY** processing does not use [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) to set a nonzero **DWL\_MSGRESULT** value.</span></span>

<span data-ttu-id="8044e-327">Para recuperar información sobre el estado del cuadro de diálogo o para controlar el comportamiento y la apariencia del cuadro de diálogo, el procedimiento de enlace puede enviar los siguientes mensajes al cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="8044e-327">To retrieve information about the status of the dialog box or to control the behavior and appearance of the dialog box, the hook procedure can send the following messages to the dialog box.</span></span>



| <span data-ttu-id="8044e-328">Mensaje</span><span class="sxs-lookup"><span data-stu-id="8044e-328">Message</span></span>                                             | <span data-ttu-id="8044e-329">Significado</span><span class="sxs-lookup"><span data-stu-id="8044e-329">Meaning</span></span>                                                                                                                                                                                                                  |
|-----------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="8044e-330">**CDM \_ GETFILEPATH**</span><span class="sxs-lookup"><span data-stu-id="8044e-330">**CDM\_GETFILEPATH**</span></span>](cdm-getfilepath.md)         | <span data-ttu-id="8044e-331">Recupera la ruta de acceso y el nombre de archivo del archivo seleccionado.</span><span class="sxs-lookup"><span data-stu-id="8044e-331">Retrieves the path and file name of the selected file.</span></span>                                                                                                                                                                   |
| [<span data-ttu-id="8044e-332">**CDM \_ GETFOLDERIDLIST**</span><span class="sxs-lookup"><span data-stu-id="8044e-332">**CDM\_GETFOLDERIDLIST**</span></span>](cdm-getfolderidlist.md) | <span data-ttu-id="8044e-333">Recupera la lista de identificadores de elemento correspondiente a la carpeta actual que el cuadro de diálogo tiene abierto.</span><span class="sxs-lookup"><span data-stu-id="8044e-333">Retrieves the item identifier list corresponding to the current folder that the dialog box has open.</span></span> <span data-ttu-id="8044e-334">Para obtener más información sobre las listas de identificadores de elementos, vea [Introducción al espacio de nombres del shell](/windows/desktop/shell/namespace-intro).</span><span class="sxs-lookup"><span data-stu-id="8044e-334">For more information about item identifier lists, see [Introduction to the Shell Namespace](/windows/desktop/shell/namespace-intro).</span></span> |
| [<span data-ttu-id="8044e-335">**GETFOLDERPATH de CDM \_**</span><span class="sxs-lookup"><span data-stu-id="8044e-335">**CDM\_GETFOLDERPATH**</span></span>](cdm-getfolderpath.md)     | <span data-ttu-id="8044e-336">Recupera la ruta de acceso de la carpeta o directorio actual para el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="8044e-336">Retrieves the path of the current folder or directory for the dialog box.</span></span>                                                                                                                                                |
| [<span data-ttu-id="8044e-337">**CDM \_ GETSPEC**</span><span class="sxs-lookup"><span data-stu-id="8044e-337">**CDM\_GETSPEC**</span></span>](cdm-getspec.md)                 | <span data-ttu-id="8044e-338">Recupera el nombre de archivo (sin incluir la ruta de acceso) del archivo seleccionado actualmente en el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="8044e-338">Retrieves the file name (not including the path) of the file currently selected in the dialog box.</span></span>                                                                                                                       |
| [<span data-ttu-id="8044e-339">**CDM \_ HIDECONTROL**</span><span class="sxs-lookup"><span data-stu-id="8044e-339">**CDM\_HIDECONTROL**</span></span>](cdm-hidecontrol.md)         | <span data-ttu-id="8044e-340">Oculta el control especificado.</span><span class="sxs-lookup"><span data-stu-id="8044e-340">Hides the specified control.</span></span>                                                                                                                                                                                             |
| [<span data-ttu-id="8044e-341">**CDM \_ SETCONTROLTEXT**</span><span class="sxs-lookup"><span data-stu-id="8044e-341">**CDM\_SETCONTROLTEXT**</span></span>](cdm-setcontroltext.md)   | <span data-ttu-id="8044e-342">Establece el texto en el control especificado.</span><span class="sxs-lookup"><span data-stu-id="8044e-342">Sets the text in the specified control.</span></span>                                                                                                                                                                                  |
| [<span data-ttu-id="8044e-343">**CDM \_ SETDEFEXT**</span><span class="sxs-lookup"><span data-stu-id="8044e-343">**CDM\_SETDEFEXT**</span></span>](cdm-setdefext.md)             | <span data-ttu-id="8044e-344">Establece la extensión de nombre de archivo predeterminada para el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="8044e-344">Sets the default file name extension for the dialog box.</span></span>                                                                                                                                                                 |



 

## <a name="explorer-style-custom-templates"></a><span data-ttu-id="8044e-345">Explorer-Style plantillas personalizadas</span><span class="sxs-lookup"><span data-stu-id="8044e-345">Explorer-Style Custom Templates</span></span>

<span data-ttu-id="8044e-346">Para definir controles adicionales para un cuadro de diálogo para **abrir** o **Guardar como** estilo del explorador, use la estructura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) para especificar una plantilla para un cuadro de diálogo secundario que contenga los controles adicionales.</span><span class="sxs-lookup"><span data-stu-id="8044e-346">To define additional controls for an Explorer-style **Open** or **Save As** dialog box, use the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure to specify a template for a child dialog box that contains the additional controls.</span></span> <span data-ttu-id="8044e-347">Si la plantilla de cuadro de diálogo secundaria es un recurso de una biblioteca de vínculos dinámicos o de aplicación, establezca la marca **OFN \_ ENABLETEMPLATE** en el miembro **Flags** y use los miembros **hInstance** y **lpTemplateName** de la estructura para identificar el nombre del módulo y del recurso.</span><span class="sxs-lookup"><span data-stu-id="8044e-347">If your child dialog template is a resource in an application or dynamic-link library, set the **OFN\_ENABLETEMPLATE** flag in the **Flags** member and use the **hInstance** and **lpTemplateName** members of the structure to identify the module and resource name.</span></span> <span data-ttu-id="8044e-348">Si la plantilla ya está en memoria, establezca la marca **OFN \_ ENABLETEMPLATEHANDLE** y use el miembro **hInstance** para identificar el objeto de memoria que contiene la plantilla.</span><span class="sxs-lookup"><span data-stu-id="8044e-348">If the template is already in memory, set the **OFN\_ENABLETEMPLATEHANDLE** flag and use the **hInstance** member to identify the memory object that contains the template.</span></span> <span data-ttu-id="8044e-349">Al proporcionar una plantilla de diálogo secundaria para un cuadro de diálogo de estilo Explorador, también debe establecer la marca **OFN \_ Explorer** ; de lo contrario, el sistema supone que está proporcionando una plantilla de reemplazo para un cuadro de diálogo de estilo antiguo.</span><span class="sxs-lookup"><span data-stu-id="8044e-349">When providing a child dialog template for an Explorer-style dialog box, you must also set the **OFN\_EXPLORER** flag; otherwise, the system assumes you are providing a replacement template for an old-style dialog box.</span></span> <span data-ttu-id="8044e-350">Normalmente, si proporciona controles adicionales, también debe proporcionar un procedimiento de [enlace de estilo del explorador](#explorer-style-hook-procedures) para procesar los mensajes para los nuevos controles.</span><span class="sxs-lookup"><span data-stu-id="8044e-350">Typically, if you provide additional controls, you must also provide an [Explorer-style hook procedure](#explorer-style-hook-procedures) to process messages for the new controls.</span></span>

<span data-ttu-id="8044e-351">Puede crear la plantilla del cuadro de diálogo secundario como lo haría con cualquier otra plantilla, salvo que debe especificar los estilos **WS \_ secundario** y **WS \_ CLIPSIBLINGS** y debe especificar los estilos de **\_ control** DS **\_ 3DLOOK** y DS.</span><span class="sxs-lookup"><span data-stu-id="8044e-351">You can create your child dialog box template as you do any other template, except that you must specify the **WS\_CHILD** and **WS\_CLIPSIBLINGS** styles and should specify the **DS\_3DLOOK** and **DS\_CONTROL** styles.</span></span> <span data-ttu-id="8044e-352">El sistema requiere el **estilo \_ secundario WS** porque la plantilla define un cuadro de diálogo secundario del cuadro de diálogo **abrir** o **Guardar como** predeterminado.</span><span class="sxs-lookup"><span data-stu-id="8044e-352">The system requires the **WS\_CHILD** style because your template defines a child dialog of the default **Open** or **Save As** dialog box.</span></span> <span data-ttu-id="8044e-353">El estilo **WS \_ CLIPSIBLINGS** garantiza que el cuadro de diálogo secundario no pinte los controles del cuadro de diálogo predeterminado.</span><span class="sxs-lookup"><span data-stu-id="8044e-353">The **WS\_CLIPSIBLINGS** style ensures that the child dialog box does not paint over any of the controls in the default dialog box.</span></span> <span data-ttu-id="8044e-354">El **estilo \_ 3DLOOK de DS** garantiza que la apariencia de los controles del cuadro de diálogo secundario es coherente con los controles del cuadro de diálogo predeterminado.</span><span class="sxs-lookup"><span data-stu-id="8044e-354">The **DS\_3DLOOK** style makes sure that the appearance of the controls in the child dialog box is consistent with the controls in the default dialog box.</span></span> <span data-ttu-id="8044e-355">El estilo de **\_ control DS** se asegura de que el usuario puede usar la pestaña y otras teclas de navegación para desplazarse entre todos los controles, predeterminado o personalizado, en el cuadro de diálogo personalizado.</span><span class="sxs-lookup"><span data-stu-id="8044e-355">The **DS\_CONTROL** style makes sure that the user can use the TAB and other navigation keys to move between all controls, default or custom, in the customized dialog box.</span></span>

<span data-ttu-id="8044e-356">Para dejar espacio a los nuevos controles, el sistema expande el cuadro de diálogo predeterminado en el ancho y el alto del cuadro de diálogo personalizado.</span><span class="sxs-lookup"><span data-stu-id="8044e-356">To make room for the new controls, the system expands the default dialog box by the width and height of the custom dialog box.</span></span> <span data-ttu-id="8044e-357">De forma predeterminada, todos los controles del cuadro de diálogo personalizado se colocan debajo de los controles del cuadro de diálogo predeterminado.</span><span class="sxs-lookup"><span data-stu-id="8044e-357">By default, all controls from the custom dialog box are positioned below the controls in the default dialog box.</span></span> <span data-ttu-id="8044e-358">Sin embargo, puede invalidar esta posición predeterminada si incluye un control de texto estático en la plantilla de cuadro de diálogo personalizado y le asigna el valor de identificador de control de **stc32**.</span><span class="sxs-lookup"><span data-stu-id="8044e-358">However, you can override this default positioning by including a static text control in your custom dialog box template and assigning it the control identifier value of **stc32**.</span></span> <span data-ttu-id="8044e-359">(Este valor se define en el archivo de encabezado Dlgs. h). En este caso, el sistema utiliza el control como punto de referencia para determinar dónde colocar los nuevos controles.</span><span class="sxs-lookup"><span data-stu-id="8044e-359">(This value is defined in the Dlgs.h header file.) In this case, the system uses the control as the point of reference for determining where to position the new controls.</span></span> <span data-ttu-id="8044e-360">Todos los controles nuevos situados encima y a la izquierda del control **stc32** se colocan en la misma cantidad anterior y a la izquierda de los controles del cuadro de diálogo predeterminado.</span><span class="sxs-lookup"><span data-stu-id="8044e-360">All new controls above and to the left of the **stc32** control are positioned the same amount above and to the left of the controls in the default dialog box.</span></span> <span data-ttu-id="8044e-361">Los nuevos controles situados debajo y a la derecha del control **stc32** se colocan debajo y a la derecha de los controles predeterminados.</span><span class="sxs-lookup"><span data-stu-id="8044e-361">New controls below and to the right of the **stc32** control are positioned below and to the right of the default controls.</span></span> <span data-ttu-id="8044e-362">En general, cada nuevo control se coloca para que tenga la misma posición con respecto a los controles predeterminados que tenía en el control **stc32** .</span><span class="sxs-lookup"><span data-stu-id="8044e-362">In general, each new control is positioned so that it has the same position relative to the default controls as it had to the **stc32** control.</span></span> <span data-ttu-id="8044e-363">Para dejar espacio a estos nuevos controles, el sistema agrega espacio a la izquierda, derecha, inferior y superior del cuadro de diálogo predeterminado según sea necesario.</span><span class="sxs-lookup"><span data-stu-id="8044e-363">To make room for these new controls, the system adds space to the left, right, bottom, and top of the default dialog box as needed.</span></span>

<span data-ttu-id="8044e-364">El sistema requiere que el procedimiento de enlace procese todos los mensajes destinados al cuadro de diálogo personalizado y, por tanto, envía los mismos mensajes de ventana al procedimiento de enlace que a cualquier otro procedimiento de cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="8044e-364">The system requires the hook procedure to process all messages intended for the custom dialog box and therefore sends the same window messages to the hook procedure as to any other dialog box procedure.</span></span> <span data-ttu-id="8044e-365">Por ejemplo, el procedimiento de enlace recibe mensajes de [**\_ comandos de WM**](/windows/desktop/menurc/wm-command) cuando el usuario hace clic en los controles de botón en el cuadro de diálogo personalizado.</span><span class="sxs-lookup"><span data-stu-id="8044e-365">For example, the hook procedure receives [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) messages when the user clicks on button controls in the custom dialog box.</span></span> <span data-ttu-id="8044e-366">El procedimiento de enlace es responsable de inicializar estos controles y recuperar los valores de los controles cuando se cierra el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="8044e-366">The hook procedure is responsible for initializing these controls and retrieving values from the controls when the dialog box is closed.</span></span> <span data-ttu-id="8044e-367">Tenga en cuenta que cuando el procedimiento de enlace recibe el mensaje de [**\_ INITDIALOG de WM**](wm-initdialog.md) , el sistema aún no ha pasado los controles a sus posiciones finales.</span><span class="sxs-lookup"><span data-stu-id="8044e-367">Note that when the hook procedure receives the [**WM\_INITDIALOG**](wm-initdialog.md) message, the system has not yet moved the controls to their final positions.</span></span>

<span data-ttu-id="8044e-368">El procedimiento de cuadro de diálogo predeterminado controla los mensajes de todos los controles del cuadro de diálogo predeterminado, pero el procedimiento de enlace recibe los mensajes de notificación para las acciones del usuario en estos controles, tal y como se describe en [procedimientos de enlace de estilo del explorador](#explorer-style-hook-procedures).</span><span class="sxs-lookup"><span data-stu-id="8044e-368">The default dialog box procedure handles messages for all the controls in the default dialog box, but the hook procedure receives the notification messages for user actions on these controls as described in [Explorer-Style Hook Procedures](#explorer-style-hook-procedures).</span></span>

## <a name="explorer-style-control-identifiers"></a><span data-ttu-id="8044e-369">Identificadores de control de Explorer-Style</span><span class="sxs-lookup"><span data-stu-id="8044e-369">Explorer-Style Control Identifiers</span></span>

<span data-ttu-id="8044e-370">El kit de desarrollo de software (SDK) de Windows proporciona la plantilla de cuadro de diálogo predeterminada para los cuadros de diálogo de estilo antiguo, pero no incluye la plantilla predeterminada para los cuadros de diálogo de estilo del explorador.</span><span class="sxs-lookup"><span data-stu-id="8044e-370">The Windows Software Development Kit (SDK) provides the default dialog box template for the old-style dialog boxes, but does not include the default template for the Explorer-style dialog boxes.</span></span> <span data-ttu-id="8044e-371">Esto se debe a que los cuadros de diálogo del estilo del explorador permiten agregar sus propios controles pero no admiten la modificación de la plantilla para los controles estándar.</span><span class="sxs-lookup"><span data-stu-id="8044e-371">This is because the Explorer-style dialog boxes allow you to add your own controls but do not support modifying the template for the standard controls.</span></span> <span data-ttu-id="8044e-372">Sin embargo, en algunos casos, puede que necesite conocer los identificadores de control que se usan en las plantillas predeterminadas.</span><span class="sxs-lookup"><span data-stu-id="8044e-372">However, in some cases, you may need to know the control identifiers used in the default templates.</span></span> <span data-ttu-id="8044e-373">Por ejemplo, los mensajes [**CDM \_ HIDECONTROL**](cdm-hidecontrol.md) y [**CDM \_ SETCONTROLTEXT**](cdm-setcontroltext.md) requieren un identificador de control.</span><span class="sxs-lookup"><span data-stu-id="8044e-373">For example, the [**CDM\_HIDECONTROL**](cdm-hidecontrol.md) and [**CDM\_SETCONTROLTEXT**](cdm-setcontroltext.md) messages require a control identifier.</span></span>

<span data-ttu-id="8044e-374">En la tabla siguiente se muestran los identificadores de los controles estándar en los cuadros de diálogo **abrir** y **Guardar como** del estilo del explorador.</span><span class="sxs-lookup"><span data-stu-id="8044e-374">The following table shows the identifiers of the standard controls in the Explorer-style **Open** and **Save As** dialog boxes.</span></span> <span data-ttu-id="8044e-375">Los identificadores son constantes que se definen en Dlgs. h y Winuser. h.</span><span class="sxs-lookup"><span data-stu-id="8044e-375">The identifiers are constants defined in Dlgs.h and Winuser.h.</span></span>



| <span data-ttu-id="8044e-376">Identificador de control</span><span class="sxs-lookup"><span data-stu-id="8044e-376">Control identifier</span></span> | <span data-ttu-id="8044e-377">Descripción del control</span><span class="sxs-lookup"><span data-stu-id="8044e-377">Control description</span></span>                                                                                                                                                                                                                                                                        |
|--------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="8044e-378">**chx1**</span><span class="sxs-lookup"><span data-stu-id="8044e-378">**chx1**</span></span>           | <span data-ttu-id="8044e-379">Casilla de solo lectura</span><span class="sxs-lookup"><span data-stu-id="8044e-379">The read-only check box</span></span>                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="8044e-380">**cmb1**</span><span class="sxs-lookup"><span data-stu-id="8044e-380">**cmb1**</span></span>           | <span data-ttu-id="8044e-381">Cuadro combinado desplegable que muestra la lista de filtros de tipo de archivo</span><span class="sxs-lookup"><span data-stu-id="8044e-381">Drop-down combo box that displays the list of file type filters</span></span>                                                                                                                                                                                                                            |
| <span data-ttu-id="8044e-382">**stc2**</span><span class="sxs-lookup"><span data-stu-id="8044e-382">**stc2**</span></span>           | <span data-ttu-id="8044e-383">Etiqueta para el cuadro combinado **cmb1**</span><span class="sxs-lookup"><span data-stu-id="8044e-383">Label for the **cmb1** combo box</span></span>                                                                                                                                                                                                                                                           |
| <span data-ttu-id="8044e-384">**cmb2**</span><span class="sxs-lookup"><span data-stu-id="8044e-384">**cmb2**</span></span>           | <span data-ttu-id="8044e-385">Cuadro combinado desplegable que muestra la unidad o carpeta actual, y que permite al usuario seleccionar una unidad o carpeta para abrir</span><span class="sxs-lookup"><span data-stu-id="8044e-385">Drop-down combo box that displays the current drive or folder, and that allows the user to select a drive or folder to open</span></span>                                                                                                                                                                |
| <span data-ttu-id="8044e-386">**stc4**</span><span class="sxs-lookup"><span data-stu-id="8044e-386">**stc4**</span></span>           | <span data-ttu-id="8044e-387">Etiqueta para el cuadro combinado **CMB2**</span><span class="sxs-lookup"><span data-stu-id="8044e-387">Label for the **cmb2** combo box</span></span>                                                                                                                                                                                                                                                           |
| <span data-ttu-id="8044e-388">**cmb13**</span><span class="sxs-lookup"><span data-stu-id="8044e-388">**cmb13**</span></span>          | <span data-ttu-id="8044e-389">Cuadro combinado desplegable que muestra el nombre del archivo actual, permite al usuario escribir el nombre de un archivo que se va a abrir y seleccionar un archivo que se ha abierto o guardado recientemente.</span><span class="sxs-lookup"><span data-stu-id="8044e-389">Drop-down combo box that displays the name of the current file, allows the user to type the name of a file to open, and select a file that has been opened or saved recently.</span></span> <span data-ttu-id="8044e-390">Se trata de aplicaciones compatibles con el explorador anteriores sin enlazar o plantilla de cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="8044e-390">This is for earlier Explorer-compatible applications without hook or dialog template.</span></span> <span data-ttu-id="8044e-391">Comparar con **edt1**.</span><span class="sxs-lookup"><span data-stu-id="8044e-391">Compare with **edt1**.</span></span> |
| <span data-ttu-id="8044e-392">**edt1**</span><span class="sxs-lookup"><span data-stu-id="8044e-392">**edt1**</span></span>           | <span data-ttu-id="8044e-393">Control de edición que muestra el nombre del archivo actual o permite al usuario escribir el nombre del archivo que se va a abrir.</span><span class="sxs-lookup"><span data-stu-id="8044e-393">Edit control that displays the name of the current file, or allows the user to type the name of the file to open.</span></span> <span data-ttu-id="8044e-394">Comparar con **cmb13**.</span><span class="sxs-lookup"><span data-stu-id="8044e-394">Compare with **cmb13**.</span></span>                                                                                                                                                  |
| <span data-ttu-id="8044e-395">**stc3**</span><span class="sxs-lookup"><span data-stu-id="8044e-395">**stc3**</span></span>           | <span data-ttu-id="8044e-396">Etiqueta para el cuadro combinado **cmb13** y el control de edición edt1</span><span class="sxs-lookup"><span data-stu-id="8044e-396">Label for the **cmb13** combo box and the edt1 edit control</span></span>                                                                                                                                                                                                                                |
| <span data-ttu-id="8044e-397">**lst1**</span><span class="sxs-lookup"><span data-stu-id="8044e-397">**lst1**</span></span>           | <span data-ttu-id="8044e-398">Cuadro de lista que muestra el contenido de la unidad o carpeta actual</span><span class="sxs-lookup"><span data-stu-id="8044e-398">List box that displays the contents of the current drive or folder</span></span>                                                                                                                                                                                                                         |
| <span data-ttu-id="8044e-399">**stc1**</span><span class="sxs-lookup"><span data-stu-id="8044e-399">**stc1**</span></span>           | <span data-ttu-id="8044e-400">Etiqueta del cuadro de lista **lst1**</span><span class="sxs-lookup"><span data-stu-id="8044e-400">Label for the **lst1** list box</span></span>                                                                                                                                                                                                                                                            |
| <span data-ttu-id="8044e-401">**IDOK**</span><span class="sxs-lookup"><span data-stu-id="8044e-401">**IDOK**</span></span>           | <span data-ttu-id="8044e-402">Botón de comando **Aceptar** (botón de comando)</span><span class="sxs-lookup"><span data-stu-id="8044e-402">The **OK** command button (push button)</span></span>                                                                                                                                                                                                                                                    |
| <span data-ttu-id="8044e-403">**IDCANCEL**</span><span class="sxs-lookup"><span data-stu-id="8044e-403">**IDCANCEL**</span></span>       | <span data-ttu-id="8044e-404">Botón **Cancelar** (botón de comando)</span><span class="sxs-lookup"><span data-stu-id="8044e-404">The **Cancel** command button (push button)</span></span>                                                                                                                                                                                                                                                |
| <span data-ttu-id="8044e-405">**pshHelp**</span><span class="sxs-lookup"><span data-stu-id="8044e-405">**pshHelp**</span></span>        | <span data-ttu-id="8044e-406">Botón de comando **ayuda** (botón de comando)</span><span class="sxs-lookup"><span data-stu-id="8044e-406">The **Help** command button (push button)</span></span>                                                                                                                                                                                                                                                  |



 

## <a name="customizing-old-style-dialog-boxes"></a><span data-ttu-id="8044e-407">Personalización de Old-Style cuadros de diálogo</span><span class="sxs-lookup"><span data-stu-id="8044e-407">Customizing Old-Style Dialog Boxes</span></span>

<span data-ttu-id="8044e-408">Puede personalizar un cuadro de diálogo **abrir** o **Guardar como** de estilo antiguo si proporciona un procedimiento de enlace [*OFNHookProcOldStyle*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) que recibe mensajes o notificaciones destinados al procedimiento de cuadro de diálogo predeterminado.</span><span class="sxs-lookup"><span data-stu-id="8044e-408">You can customize an old-style **Open** or **Save As** dialog box by providing an [*OFNHookProcOldStyle*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) hook procedure that receives messages or notifications intended for the default dialog box procedure.</span></span> <span data-ttu-id="8044e-409">También puede proporcionar una plantilla personalizada que se usará en lugar de la plantilla predeterminada.</span><span class="sxs-lookup"><span data-stu-id="8044e-409">You can also provide a custom template to use in place of the default template.</span></span> <span data-ttu-id="8044e-410">Los procedimientos de enlace y las plantillas utilizados con los cuadros de diálogo de estilo antiguo son similares a los que se usan con los otros cuadros de diálogo comunes.</span><span class="sxs-lookup"><span data-stu-id="8044e-410">The hook procedures and templates used with the old-style dialog boxes are similar to those used with the other common dialog boxes.</span></span> <span data-ttu-id="8044e-411">Para obtener más información, vea [procedimientos de enlace para cuadros de diálogo comunes](customizing-common-dialog-boxes.md) y [plantillas personalizadas](customizing-common-dialog-boxes.md).</span><span class="sxs-lookup"><span data-stu-id="8044e-411">For more information, see [Hook Procedures for Common Dialog Boxes](customizing-common-dialog-boxes.md) and [Custom Templates](customizing-common-dialog-boxes.md).</span></span>

<span data-ttu-id="8044e-412">Para habilitar un procedimiento de enlace para un cuadro de diálogo **abrir** o **Guardar como** de estilo antiguo, use la estructura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) al crear el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="8044e-412">To enable a hook procedure for an old-style **Open** or **Save As** dialog box, use the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure when you create the dialog box.</span></span> <span data-ttu-id="8044e-413">Establezca la **marca OFN \_ ENABLEHOOK** en el miembro **Flags** y especifique la dirección de un procedimiento de enlace [*OFNHookProcOldStyle*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) en el miembro **lpfnHook** .</span><span class="sxs-lookup"><span data-stu-id="8044e-413">Set the **OFN\_ENABLEHOOK** flag in the **Flags** member and specify the address of an [*OFNHookProcOldStyle*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) hook procedure in the **lpfnHook** member.</span></span> <span data-ttu-id="8044e-414">El procedimiento de cuadro de diálogo envía un mensaje de [**WM \_ INITDIALOG**](wm-initdialog.md) al procedimiento de enlace con el parámetro *param* establecido en la dirección de la estructura **OPENFILENAME** usada para inicializar el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="8044e-414">The dialog box procedure sends a [**WM\_INITDIALOG**](wm-initdialog.md) message to the hook procedure with the *Param* parameter set to the address of the **OPENFILENAME** structure used to initialize the dialog box.</span></span>

<span data-ttu-id="8044e-415">Puede usar la estructura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) para especificar una plantilla personalizada para el cuadro de diálogo **abrir** o **Guardar como** que se usará en lugar de la plantilla predeterminada.</span><span class="sxs-lookup"><span data-stu-id="8044e-415">You can use the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure to specify a custom template for the **Open** or **Save As** dialog box to use in place of the default template.</span></span> <span data-ttu-id="8044e-416">Si la plantilla personalizada es un recurso de una aplicación o biblioteca de vínculos dinámicos, establezca la marca **OFN \_ ENABLETEMPLATE** en el miembro **Flags** y use los miembros **hInstance** y **lpTemplateName** de la estructura para identificar el módulo y el nombre del recurso.</span><span class="sxs-lookup"><span data-stu-id="8044e-416">If your custom template is a resource in an application or dynamic-link library, set the **OFN\_ENABLETEMPLATE** flag in the **Flags** member and use the **hInstance** and **lpTemplateName** members of the structure to identify the module and resource name.</span></span> <span data-ttu-id="8044e-417">Si la plantilla personalizada ya está en la memoria, establezca la marca **OFN \_ ENABLETEMPLATEHANDLE** y use el miembro **hInstance** para identificar el objeto de memoria que contiene la plantilla.</span><span class="sxs-lookup"><span data-stu-id="8044e-417">If your custom template is already in memory, set the **OFN\_ENABLETEMPLATEHANDLE** flag and use the **hInstance** member to identify the memory object that contains the template.</span></span> <span data-ttu-id="8044e-418">Cree la plantilla personalizada modificando la plantilla predeterminada especificada en el archivo FileOpen. Dlg.</span><span class="sxs-lookup"><span data-stu-id="8044e-418">Create the custom template by modifying the default template specified in the Fileopen.dlg file.</span></span> <span data-ttu-id="8044e-419">Los identificadores de control que se usan en las plantillas de cuadro de diálogo Buscar y reemplazar predeterminados se definen en el archivo Dlgs. h.</span><span class="sxs-lookup"><span data-stu-id="8044e-419">The control identifiers used in the default Find and Replace dialog templates are defined in the Dlgs.h file.</span></span>

<span data-ttu-id="8044e-420">De forma predeterminada, las funciones [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) y [**getSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) muestran los cuadros de diálogo de estilo del explorador.</span><span class="sxs-lookup"><span data-stu-id="8044e-420">By default, the [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) and [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) functions display the Explorer-style dialog boxes.</span></span> <span data-ttu-id="8044e-421">Si desea mostrar un cuadro de diálogo de estilo anterior, debe proporcionar un procedimiento de enlace [**OFNHookProcOldStyle**](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) y asegurarse de que la marca del **\_ Explorador OFN** no esté establecida en el miembro **Flags** de la estructura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) .</span><span class="sxs-lookup"><span data-stu-id="8044e-421">If you want to display an old-style dialog box, you must provide an [**OFNHookProcOldStyle**](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) hook procedure and ensure that the **OFN\_EXPLORER** flag is not set in the **Flags** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure.</span></span>

<span data-ttu-id="8044e-422">Si establece la marca **del \_ Explorador de OFN** , el sistema trata un procedimiento de enlace o una plantilla personalizada como una personalización de estilo del explorador.</span><span class="sxs-lookup"><span data-stu-id="8044e-422">If you set the **OFN\_EXPLORER** flag, the system treats a hook procedure or custom template as an Explorer-style customization.</span></span> <span data-ttu-id="8044e-423">Para obtener información sobre cómo personalizar un cuadro de diálogo de estilo Explorador, consulte [plantillas personalizadas de estilo de explorador](#explorer-style-custom-templates).</span><span class="sxs-lookup"><span data-stu-id="8044e-423">For information about customizing an Explorer-style dialog box, see [Explorer-Style Custom Templates](#explorer-style-custom-templates).</span></span>

## <a name="see-also"></a><span data-ttu-id="8044e-424">Vea también</span><span class="sxs-lookup"><span data-stu-id="8044e-424">See also</span></span>

* [<span data-ttu-id="8044e-425">El archivo está en uso en el ejemplo</span><span class="sxs-lookup"><span data-stu-id="8044e-425">File is in use sample</span></span>](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/shell/appplatform/fileisinuse)
