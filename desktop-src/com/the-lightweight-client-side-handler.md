---
title: Controlador de Client-Side ligero
description: Los controladores de cliente ligeros le permiten crear controladores del lado cliente generales de cualquier tamaño, para ayudarle a realizar cualquier tipo de tarea estándar.
ms.assetid: b712237c-55d7-4f52-9cf6-19c6e5fb3182
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5f1e8df5be24e8773a660a4d0208b27a2f585e32
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/21/2020
ms.locfileid: "103794055"
---
# <a name="the-lightweight-client-side-handler"></a><span data-ttu-id="33567-103">Controlador de Client-Side ligero</span><span class="sxs-lookup"><span data-stu-id="33567-103">The Lightweight Client-Side Handler</span></span>

<span data-ttu-id="33567-104">Los controladores de cliente ligeros le permiten crear controladores del lado cliente generales de cualquier tamaño, para ayudarle a realizar cualquier tipo de tarea estándar.</span><span class="sxs-lookup"><span data-stu-id="33567-104">Lightweight client-side handlers allow you to create general client-side handlers of any size, to help you do any kind of standard task.</span></span> <span data-ttu-id="33567-105">Como controladores, se pueden usar en más de un cliente.</span><span class="sxs-lookup"><span data-stu-id="33567-105">As handlers, these are usable by more than one client.</span></span> <span data-ttu-id="33567-106">Se diferencian de los controladores OLE en que no se pueden crear antes de que se inicie el servidor, y su duración está ligada a la del administrador de proxy, lo que impide una posible condición de carrera en la que el controlador podría ser liberado prematuramente.</span><span class="sxs-lookup"><span data-stu-id="33567-106">They differ from OLE handlers in that they cannot be created before the server is launched, and their lifetime is tied to that of the proxy manager, preventing a possible race condition in which the handler could otherwise be prematurely released.</span></span>

<span data-ttu-id="33567-107">El administrador proxy es el objeto creado por el sistema que implementa la interfaz [**IMarshal**](/windows/win32/api/objidlbase/nn-objidlbase-imarshal) .</span><span class="sxs-lookup"><span data-stu-id="33567-107">The proxy manager is the system-created object that implements the [**IMarshal**](/windows/win32/api/objidlbase/nn-objidlbase-imarshal) interface.</span></span> <span data-ttu-id="33567-108">Si usa el cálculo de referencias estándar, el sistema lo crea automáticamente al llamar a [**CoGetStandardMarshal**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetstandardmarshal) (o [**CoGetStdMarshalEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetstdmarshalex), para crear un contador de referencias agregado para controladores ligeros) y también implementa las interfaces [**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) y [**IMultiQI**](/windows/win32/api/objidlbase/nn-objidlbase-imultiqi) en el objeto.</span><span class="sxs-lookup"><span data-stu-id="33567-108">If you use standard marshaling, the system creates it for you when you call [**CoGetStandardMarshal**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetstandardmarshal) (or [**CoGetStdMarshalEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetstdmarshalex), for creating an aggregated marshaler for lightweight handlers) and also implements the [**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) and [**IMultiQI**](/windows/win32/api/objidlbase/nn-objidlbase-imultiqi) interfaces on the object.</span></span> <span data-ttu-id="33567-109">En el lado del servidor, hay un objeto del sistema correspondiente que también implementa **IMarshal**.</span><span class="sxs-lookup"><span data-stu-id="33567-109">On the server side, there is a corresponding system object that also implements **IMarshal**.</span></span> <span data-ttu-id="33567-110">Estos objetos controlan el cálculo de referencias de forma transparente.</span><span class="sxs-lookup"><span data-stu-id="33567-110">These objects handle marshaling for you transparently.</span></span>

<span data-ttu-id="33567-111">Hay dos tipos generales de estos controladores que puede desear implementar:</span><span class="sxs-lookup"><span data-stu-id="33567-111">There are two general types of these handlers that you may want to implement:</span></span>

-   <span data-ttu-id="33567-112">Un controlador que realiza un servicio que no requiere datos adicionales del servidor.</span><span class="sxs-lookup"><span data-stu-id="33567-112">A handler that performs a service that requires no extra data from the server</span></span>
-   <span data-ttu-id="33567-113">Un controlador que utiliza datos adicionales del servidor</span><span class="sxs-lookup"><span data-stu-id="33567-113">A handler that uses extra data from the server</span></span>

<span data-ttu-id="33567-114">Algunos de los usos posibles de los datos adicionales en la secuencia proporcionada por el servidor son los siguientes:</span><span class="sxs-lookup"><span data-stu-id="33567-114">Some potential uses of the extra data in the stream supplied by the server are as follows:</span></span>

-   <span data-ttu-id="33567-115">Datos estáticos del servidor.</span><span class="sxs-lookup"><span data-stu-id="33567-115">Static data from server.</span></span> <span data-ttu-id="33567-116">Independientemente de la interfaz concreta en la que se calculan las referencias, el servidor escribe los mismos datos en la secuencia.</span><span class="sxs-lookup"><span data-stu-id="33567-116">Regardless of the particular interface being marshaled, the server writes the same data into the stream.</span></span>
-   <span data-ttu-id="33567-117">Datos por interfaz del servidor.</span><span class="sxs-lookup"><span data-stu-id="33567-117">Per-interface data from server.</span></span> <span data-ttu-id="33567-118">Dependiendo de la interfaz concreta en la que se calculan las referencias, el servidor puede escribir datos diferentes en la secuencia.</span><span class="sxs-lookup"><span data-stu-id="33567-118">Depending on which particular interface is being marshaled, the server may write different data into the stream.</span></span>
-   <span data-ttu-id="33567-119">Aplicaciones auxiliares por interfaz.</span><span class="sxs-lookup"><span data-stu-id="33567-119">Per-interface helpers.</span></span> <span data-ttu-id="33567-120">Componentes COM por interfaz agregados al controlador de cliente y delegando en el proxy estándar.</span><span class="sxs-lookup"><span data-stu-id="33567-120">Per-interface COM components aggregated into the client handler and delegating to the standard proxy.</span></span> <span data-ttu-id="33567-121">Por ejemplo, para mejorar el rendimiento de la red, un componente COM de [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) podría hacer el almacenamiento en caché del lado cliente de los datos, la lectura previa, la escritura retrasada, el bloqueo de operaciones, etc.</span><span class="sxs-lookup"><span data-stu-id="33567-121">For example, to improve network performance, a COM component for [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) could do client-side caching of data, read-ahead, write-behind, op-locking, and so forth.</span></span>
-   <span data-ttu-id="33567-122">Versión de red de una interfaz.</span><span class="sxs-lookup"><span data-stu-id="33567-122">Network version of an interface.</span></span> <span data-ttu-id="33567-123">La versión de red de la interfaz es diferente de la interfaz expuesta por el código de aplicación de cliente y servidor.</span><span class="sxs-lookup"><span data-stu-id="33567-123">The network version of the interface is different from the interface exposed by the client and server application code.</span></span> <span data-ttu-id="33567-124">Por ejemplo, es posible multiplexar las interfaces expuestas IA y IB sobre la misma interfaz de red INetAB, el modo en que lo hace el controlador de servidor de inserción.</span><span class="sxs-lookup"><span data-stu-id="33567-124">It is possible, for example, to multiplex exposed interfaces IA and IB over the same network interface INetAB, the way the embedding server handler does.</span></span> <span data-ttu-id="33567-125">Por ejemplo, puede convertir una interfaz de transferencia de datos en una interfaz de red que utiliza canalizaciones para una transferencia de datos eficaz.</span><span class="sxs-lookup"><span data-stu-id="33567-125">For example, one could convert a data transfer interface into a network interface that uses pipes for efficient data transfer.</span></span>

<span data-ttu-id="33567-126">Es posible que los clientes de nivel inferior no dispongan de la capacidad de calcular las referencias de las interfaces que tienen controladores personalizados, por dos motivos: en primer lugar, es posible que no conozcan el CLSID utilizado en el paquete de cálculo de referencias personalizado cuando se agrega el controlador de servidor y el objeto desea un controlador.</span><span class="sxs-lookup"><span data-stu-id="33567-126">Down-level clients may not have the capability of unmarshaling interfaces that have custom handlers, for two reasons: First, they may not understand the CLSID used in the custom marshaled packet when the server handler is aggregated and the object wants a handler.</span></span> <span data-ttu-id="33567-127">En segundo lugar, es posible que el código del controlador no se ejecute incluso en el lado cliente si requiere una nueva funcionalidad de COM para crear el serializador estándar agregado y para realizar llamadas [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) remotas.</span><span class="sxs-lookup"><span data-stu-id="33567-127">Second, the handler code may not even run on the client side if it requires new functionality from COM to create the aggregated standard marshaler and to do remote [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) calls.</span></span>

## <a name="related-topics"></a><span data-ttu-id="33567-128">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="33567-128">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="33567-129">El controlador OLE</span><span class="sxs-lookup"><span data-stu-id="33567-129">The OLE Handler</span></span>](the-ole-handler.md)
</dt> </dl>

 

 