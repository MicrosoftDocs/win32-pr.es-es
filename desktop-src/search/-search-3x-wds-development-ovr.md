---
description: Para indizar el contenido y las propiedades de los nuevos formatos de archivo y almacenes de datos, Microsoft Windows Search debe extenderse con complementos.
ms.assetid: 04ddcd97-c358-44d2-9092-a035436c50c9
title: Windows Search como plataforma de desarrollo
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 19041ac23c90006cc2f1b2f6146cb20a6b972fc2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "103808983"
---
# <a name="windows-search-as-a-development-platform"></a><span data-ttu-id="b723e-103">Windows Search como plataforma de desarrollo</span><span class="sxs-lookup"><span data-stu-id="b723e-103">Windows Search as a Development Platform</span></span>

<span data-ttu-id="b723e-104">Para indizar el contenido y las propiedades de los nuevos formatos de archivo y almacenes de datos, Microsoft Windows Search debe extenderse con complementos.</span><span class="sxs-lookup"><span data-stu-id="b723e-104">To index the contents and properties of new file formats and data stores, Microsoft Windows Search must be extended with add-ins.</span></span>

<span data-ttu-id="b723e-105">Antes de que un desarrollador de terceros con nuevos formatos de archivo y almacenes de datos pueda obtener esos formatos y almacenes para que aparezcan en los resultados de la consulta en el explorador de Windows, el desarrollador debe hacer lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="b723e-105">Before a third-party developer of new file formats and data stores can get those formats and stores to appear in query results in Windows Explorer, the developer must do the following three things:</span></span>

-   <span data-ttu-id="b723e-106">Implemente un origen de datos de Shell para extender el espacio de nombres del shell.</span><span class="sxs-lookup"><span data-stu-id="b723e-106">Implement a Shell data source to extend the Shell namespace.</span></span>
-   <span data-ttu-id="b723e-107">Exponga los elementos de un almacén de datos (si están agregando un nuevo almacén de datos, ya que es necesario indizar).</span><span class="sxs-lookup"><span data-stu-id="b723e-107">Expose items in a data store (if they are adding a new data store, because it would need to be indexed).</span></span>
-   <span data-ttu-id="b723e-108">Desarrolle un controlador de protocolo para que Windows Search pueda acceder a los datos para la indexación.</span><span class="sxs-lookup"><span data-stu-id="b723e-108">Develop a protocol handler so that Windows Search can access the data for indexing.</span></span>

<span data-ttu-id="b723e-109">Este tema se organiza de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="b723e-109">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="b723e-110">Introducción</span><span class="sxs-lookup"><span data-stu-id="b723e-110">Getting Started</span></span>](#getting-started)
-   [<span data-ttu-id="b723e-111">Información general sobre los escenarios de desarrollo de búsqueda</span><span class="sxs-lookup"><span data-stu-id="b723e-111">Overview of Search Development Scenarios</span></span>](#overview-of-search-development-scenarios)
    -   [<span data-ttu-id="b723e-112">Adición de un nuevo almacén de datos</span><span class="sxs-lookup"><span data-stu-id="b723e-112">Adding a New Data Store</span></span>](#adding-a-new-data-store)
    -   [<span data-ttu-id="b723e-113">Agregar un nuevo formato de archivo</span><span class="sxs-lookup"><span data-stu-id="b723e-113">Adding a New File Format</span></span>](#adding-a-new-file-format)
    -   [<span data-ttu-id="b723e-114">Consumir resultados de Windows Search</span><span class="sxs-lookup"><span data-stu-id="b723e-114">Consuming Windows Search Results</span></span>](#consuming-windows-search-results)
-   [<span data-ttu-id="b723e-115">Información general de los controladores</span><span class="sxs-lookup"><span data-stu-id="b723e-115">Overview of Handlers</span></span>](#overview-of-handlers)
-   [<span data-ttu-id="b723e-116">Instrucciones del instalador de complementos</span><span class="sxs-lookup"><span data-stu-id="b723e-116">Add-in Installer Guidelines</span></span>](#add-in-installer-guidelines)
-   [<span data-ttu-id="b723e-117">Nota para los implementadores</span><span class="sxs-lookup"><span data-stu-id="b723e-117">Note to Implementers</span></span>](#note-to-implementers)
-   [<span data-ttu-id="b723e-118">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="b723e-118">Additional Resources</span></span>](#additional-resources)
-   [<span data-ttu-id="b723e-119">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="b723e-119">Related topics</span></span>](#related-topics)

## <a name="getting-started"></a><span data-ttu-id="b723e-120">Introducción</span><span class="sxs-lookup"><span data-stu-id="b723e-120">Getting Started</span></span>

<span data-ttu-id="b723e-121">Antes de empezar a crear una aplicación de Windows Search, recuerde que la mejor manera de hacerlo es a través de un origen de datos de Shell.</span><span class="sxs-lookup"><span data-stu-id="b723e-121">Before you start creating a Windows Search application, remember that the preferred way to do it is through a Shell data source.</span></span> <span data-ttu-id="b723e-122">Un origen de datos de Shell extiende el espacio de nombres del shell y expone los elementos de un almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="b723e-122">A Shell data source extends the Shell namespace and exposes the items in a data store.</span></span> <span data-ttu-id="b723e-123">Después, el sistema de Windows Search puede indizar los elementos del almacén de datos mediante un controlador de protocolo.</span><span class="sxs-lookup"><span data-stu-id="b723e-123">The items in the data store can then be indexed by the Windows Search system by using a protocol handler.</span></span> <span data-ttu-id="b723e-124">Se prefiere este enfoque indirecto para tener acceso a la búsqueda de Windows mediante la implementación de un origen de datos de Shell, ya que proporciona acceso a toda la funcionalidad del shell.</span><span class="sxs-lookup"><span data-stu-id="b723e-124">This indirect approach for accessing Windows Search by implementing a Shell data source is preferred because it provides access to full Shell functionality.</span></span> <span data-ttu-id="b723e-125">De este modo, se garantiza una experiencia de usuario razonable.</span><span class="sxs-lookup"><span data-stu-id="b723e-125">Doing it this way ensures a reasonable user experience.</span></span>

<span data-ttu-id="b723e-126">Si desea que los resultados de la consulta aparezcan en el explorador de Windows, debe implementar un origen de datos de Shell antes de poder crear un controlador de protocolo para extender el índice.</span><span class="sxs-lookup"><span data-stu-id="b723e-126">If you want the query results to appear in Windows Explorer, you must implement a Shell data source before you can create a protocol handler to extend the index.</span></span> <span data-ttu-id="b723e-127">Sin embargo, si todas las consultas se realizarán mediante programación (a través de OLE DB por ejemplo) e interpretadas por el código de la aplicación en lugar del shell, el espacio de nombres del shell sigue siendo preferible, pero no es necesario.</span><span class="sxs-lookup"><span data-stu-id="b723e-127">However, if all queries will be programmatic (through OLE DB for example) and interpreted by the application's code rather than the Shell, a Shell namespace is still preferred but not required.</span></span>

<span data-ttu-id="b723e-128">Se requiere un controlador de protocolo para que Windows obtenga conocimiento del contenido del archivo, como los elementos de las bases de datos o los tipos de archivo personalizados.</span><span class="sxs-lookup"><span data-stu-id="b723e-128">A protocol handler is required for Windows to obtain knowledge of file contents, such as items in databases or custom file types.</span></span> <span data-ttu-id="b723e-129">Aunque Windows Search puede indizar el nombre y las propiedades del archivo, Windows no tiene ningún conocimiento del contenido del archivo.</span><span class="sxs-lookup"><span data-stu-id="b723e-129">While Windows Search can index the name and properties of the file, Windows has no knowledge of the content of the file.</span></span> <span data-ttu-id="b723e-130">Como resultado, estos elementos no se pueden indizar ni exponer en el shell de Windows.</span><span class="sxs-lookup"><span data-stu-id="b723e-130">As a result, such items cannot be indexed or exposed in the Windows Shell.</span></span> <span data-ttu-id="b723e-131">Al implementar un controlador de protocolo personalizado, puede exponer estos elementos.</span><span class="sxs-lookup"><span data-stu-id="b723e-131">By implementing a custom protocol handler, you can expose these items.</span></span> <span data-ttu-id="b723e-132">Para obtener una lista de los controladores identificados por el escenario de desarrollador que está intentando conseguir, consulte [información general de los controladores](#overview-of-handlers).</span><span class="sxs-lookup"><span data-stu-id="b723e-132">For a list of handlers identified by the developer scenario you are trying to achieve, see [Overview of Handlers](#overview-of-handlers).</span></span>

## <a name="overview-of-search-development-scenarios"></a><span data-ttu-id="b723e-133">Información general sobre los escenarios de desarrollo de búsqueda</span><span class="sxs-lookup"><span data-stu-id="b723e-133">Overview of Search Development Scenarios</span></span>

<span data-ttu-id="b723e-134">Los escenarios de desarrollo más comunes en la búsqueda de Windows son:</span><span class="sxs-lookup"><span data-stu-id="b723e-134">The most common development scenarios in Windows Search are:</span></span>

-   [<span data-ttu-id="b723e-135">Adición de un nuevo almacén de datos</span><span class="sxs-lookup"><span data-stu-id="b723e-135">Adding a new data store</span></span>](#adding-a-new-data-store)
-   [<span data-ttu-id="b723e-136">Agregar un nuevo formato de archivo</span><span class="sxs-lookup"><span data-stu-id="b723e-136">Adding a new file format</span></span>](#adding-a-new-file-format)
-   [<span data-ttu-id="b723e-137">Consumir resultados de Windows Search</span><span class="sxs-lookup"><span data-stu-id="b723e-137">Consuming Windows Search results</span></span>](#consuming-windows-search-results)

### <a name="adding-a-new-data-store"></a><span data-ttu-id="b723e-138">Adición de un nuevo almacén de datos</span><span class="sxs-lookup"><span data-stu-id="b723e-138">Adding a New Data Store</span></span>

<span data-ttu-id="b723e-139">Solo necesita un almacén de datos de Shell para Windows Search si va a agregar un nuevo almacén de datos que se va a indexar.</span><span class="sxs-lookup"><span data-stu-id="b723e-139">You need a Shell data store for Windows Search only if you are adding a new data store to be indexed.</span></span> <span data-ttu-id="b723e-140">Un almacén de datos es un repositorio de datos que se puede exponer en el modelo de programación de shell como un contenedor mediante un origen de datos de Shell.</span><span class="sxs-lookup"><span data-stu-id="b723e-140">A data store is a repository of data that can be exposed to the Shell programming model as a container by using a Shell data source.</span></span> <span data-ttu-id="b723e-141">Después, el sistema de Windows Search puede indizar los elementos de un almacén de datos mediante un controlador de protocolo.</span><span class="sxs-lookup"><span data-stu-id="b723e-141">The items in a data store can then be indexed by the Windows Search system using a protocol handler.</span></span> <span data-ttu-id="b723e-142">El controlador de protocolo implementa el protocolo para tener acceso a un origen de contenido en su formato nativo.</span><span class="sxs-lookup"><span data-stu-id="b723e-142">The protocol handler implements the protocol for accessing a content source in its native format.</span></span> <span data-ttu-id="b723e-143">Las interfaces [**ISearchProtocol**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol) y [**ISearchProtocol2**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol2) se usan para implementar un controlador de protocolo personalizado para expandir los orígenes de datos que se pueden indizar.</span><span class="sxs-lookup"><span data-stu-id="b723e-143">The [**ISearchProtocol**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol) and [**ISearchProtocol2**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol2) interfaces are used to implement a custom protocol handler to expand the data sources that can be indexed.</span></span> <span data-ttu-id="b723e-144">Para obtener información sobre la creación de un origen de datos de Shell, vea [implementar las interfaces de objeto de carpeta básicas](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="b723e-144">For information about creating a Shell data source, see [Implementing the Basic Folder Object Interfaces](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85)).</span></span>

### <a name="adding-a-new-file-format"></a><span data-ttu-id="b723e-145">Agregar un nuevo formato de archivo</span><span class="sxs-lookup"><span data-stu-id="b723e-145">Adding a New File Format</span></span>

<span data-ttu-id="b723e-146">Si agrega un nuevo formato de archivo personalizado, debe desarrollar un controlador de filtro o un controlador de propiedades, pero no ambos.</span><span class="sxs-lookup"><span data-stu-id="b723e-146">If you add a new custom file format, you need to develop either a filter handler or a property handler, but not both.</span></span> <span data-ttu-id="b723e-147">Un filtro es una implementación de la interfaz [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="b723e-147">A filter is an implementation of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span> <span data-ttu-id="b723e-148">Abre los archivos de un tipo de archivo determinado y filtra las propiedades y fragmentos de texto del indexador.</span><span class="sxs-lookup"><span data-stu-id="b723e-148">It opens files of a particular file type, and filters properties and chunks of text for the indexer.</span></span> <span data-ttu-id="b723e-149">Los filtros se asocian a los tipos de archivo, como se indica en extensiones de nombre de archivo, tipos MIME o identificadores de clase (CLSID).</span><span class="sxs-lookup"><span data-stu-id="b723e-149">Filters are associated with file types, as denoted by file name extensions, MIME types, or class identifiers (CLSIDs).</span></span> <span data-ttu-id="b723e-150">Aunque un filtro puede controlar varios tipos de archivo, cada tipo de archivo funciona con un solo filtro.</span><span class="sxs-lookup"><span data-stu-id="b723e-150">Although one filter can handle multiple file types, each file type works with only one filter.</span></span>

<span data-ttu-id="b723e-151">Un controlador de propiedades traduce los datos almacenados en un archivo en un esquema estructurado reconocido por y al que puede tener acceso el explorador de Windows, Windows Search y otras aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="b723e-151">A property handler translates data stored in a file into a structured schema that is recognized by and can be accessed by Windows Explorer, Windows Search, and other applications.</span></span> <span data-ttu-id="b723e-152">Después, estos sistemas pueden interactuar con el controlador de propiedades para escribir y leer propiedades en un archivo.</span><span class="sxs-lookup"><span data-stu-id="b723e-152">These systems can then interact with the property handler to write and read properties to and from a file.</span></span> <span data-ttu-id="b723e-153">Los datos traducidos incluyen vista de detalles, recuadros informativos, panel de detalles, páginas de propiedades, etc.</span><span class="sxs-lookup"><span data-stu-id="b723e-153">The translated data includes details view, infotips, details pane, property pages, and so forth.</span></span> <span data-ttu-id="b723e-154">Cada controlador de propiedad está asociado a un tipo de archivo determinado, identificado por la extensión de nombre de archivo.</span><span class="sxs-lookup"><span data-stu-id="b723e-154">Each property handler is associated with a particular file type, identified by the file name extension.</span></span> <span data-ttu-id="b723e-155">Necesita un controlador de propiedad para hacer lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="b723e-155">You need a property handler to do the following:</span></span>

-   <span data-ttu-id="b723e-156">Muestra las propiedades de los elementos no indexados en la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="b723e-156">Show non-indexed item properties in the UI.</span></span>
-   <span data-ttu-id="b723e-157">Permite escribir propiedades.</span><span class="sxs-lookup"><span data-stu-id="b723e-157">Support writing properties.</span></span>

### <a name="consuming-windows-search-results"></a><span data-ttu-id="b723e-158">Consumir resultados de Windows Search</span><span class="sxs-lookup"><span data-stu-id="b723e-158">Consuming Windows Search Results</span></span>

<span data-ttu-id="b723e-159">En las secciones siguientes se describen varias formas de utilizar los resultados de la búsqueda de Windows:</span><span class="sxs-lookup"><span data-stu-id="b723e-159">The following sections describe several ways of consuming Windows Search results:</span></span>

-   [<span data-ttu-id="b723e-160">Consultar datos</span><span class="sxs-lookup"><span data-stu-id="b723e-160">Querying data</span></span>](#querying-data)
-   [<span data-ttu-id="b723e-161">Consultar almacenes de datos remotos (búsqueda federada)</span><span class="sxs-lookup"><span data-stu-id="b723e-161">Querying remote data stores (Federated Search)</span></span>](#querying-remote-data-stores-federated-search)
-   [<span data-ttu-id="b723e-162">Indexación de archivos y elementos</span><span class="sxs-lookup"><span data-stu-id="b723e-162">Indexing files and items</span></span>](#indexing-files-and-items)
-   [<span data-ttu-id="b723e-163">Indexación de un almacén de datos</span><span class="sxs-lookup"><span data-stu-id="b723e-163">Indexing a data store</span></span>](#indexing-a-data-store)
-   [<span data-ttu-id="b723e-164">Administrar el proceso de indexación</span><span class="sxs-lookup"><span data-stu-id="b723e-164">Managing the indexing process</span></span>](#managing-the-indexing-process)
-   [<span data-ttu-id="b723e-165">Integración del sistema de propiedades de Windows con las aplicaciones de Windows Search</span><span class="sxs-lookup"><span data-stu-id="b723e-165">Integrating the Windows Property System with Windows Search applications</span></span>](#integrating-the-windows-property-system-with-windows-search-applications)

### <a name="querying-data"></a><span data-ttu-id="b723e-166">Consulta de datos</span><span class="sxs-lookup"><span data-stu-id="b723e-166">Querying Data</span></span>

<span data-ttu-id="b723e-167">Los desarrolladores que escriben aplicaciones sobre la combinación de Windows Search y el sistema de propiedades de Windows pueden tener acceso a archivos y elementos independientemente de la aplicación o el tipo de archivo.</span><span class="sxs-lookup"><span data-stu-id="b723e-167">Developers writing applications on top of the combined Windows Search and Windows property system can access files and items regardless of application or file type.</span></span> <span data-ttu-id="b723e-168">Hay dos maneras de que las aplicaciones tengan acceso a los datos del indexador:</span><span class="sxs-lookup"><span data-stu-id="b723e-168">There are two ways for applications to access the indexer data:</span></span>

-   <span data-ttu-id="b723e-169">Las aplicaciones se comunican directamente con OLE DB mediante el envío de consultas de Windows Search Lenguaje de consulta estructurado (SQL) al proveedor de OLE DB de Windows Search para recuperar los resultados.</span><span class="sxs-lookup"><span data-stu-id="b723e-169">Applications communicate directly with OLE DB by sending Windows Search Structured Query Language (SQL) queries to the Windows Search OLE DB provider to retrieve results.</span></span> <span data-ttu-id="b723e-170">Las consultas se pueden construir manualmente o mediante la interfaz [**ISearchQueryHelper**](/windows/win32/api/Searchapi/nn-searchapi-isearchqueryhelper) para generar el SQL a partir de palabras clave de búsqueda y la sintaxis de consulta avanzada (AQS).</span><span class="sxs-lookup"><span data-stu-id="b723e-170">Queries can be constructed manually or by using the [**ISearchQueryHelper**](/windows/win32/api/Searchapi/nn-searchapi-isearchqueryhelper) interface to generate the SQL from search keywords, and Advanced Query Syntax (AQS).</span></span>
-   <span data-ttu-id="b723e-171">Las aplicaciones funcionan a través de la capa de Shell.</span><span class="sxs-lookup"><span data-stu-id="b723e-171">Applications work through the Shell layer.</span></span> <span data-ttu-id="b723e-172">La ventaja de la capa de Shell es que también admite otros orígenes como grep.</span><span class="sxs-lookup"><span data-stu-id="b723e-172">The advantage of the Shell layer is that it also supports other sources like grep.</span></span> <span data-ttu-id="b723e-173">Sin embargo, el inconveniente es que no todas las características del indexador están disponibles.</span><span class="sxs-lookup"><span data-stu-id="b723e-173">However, the disadvantage is that not all indexer features are available.</span></span>

<span data-ttu-id="b723e-174">Otra opción es usar los protocolos Search-MS://y search://, que ejecutan las búsquedas basadas en URL que se representan a través del explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="b723e-174">Another option is using the search-ms:// and search:// protocols, which execute URL-based searches rendered through Windows Explorer.</span></span> <span data-ttu-id="b723e-175">Esta opción habilita el desarrollo más ligero pero no devuelve resultados ni selecciones de usuario de la vista de resultados a la aplicación que realiza la llamada.</span><span class="sxs-lookup"><span data-stu-id="b723e-175">This option enables the lightest-weight development but does not return results or user selections from the results view to the calling application.</span></span> <span data-ttu-id="b723e-176">Además, al igual que otros protocolos, las aplicaciones de búsqueda de terceros pueden asumir los protocolos Search-MS://y search://si las aplicaciones se ajustan al conjunto de características necesario.</span><span class="sxs-lookup"><span data-stu-id="b723e-176">Also, like other protocols, third-party search applications can take over the search-ms:// and search:// protocols if the applications conform to the required feature set.</span></span> <span data-ttu-id="b723e-177">Para obtener más información acerca de las consultas, vea [consultar el proceso en Windows Search](querying-process--windows-search-.md) y [consultar el índice mediante programación](-search-3x-wds-qryidx-overview.md).</span><span class="sxs-lookup"><span data-stu-id="b723e-177">For more information on querying, see [Querying Process in Windows Search](querying-process--windows-search-.md) and [Querying the Index Programmatically](-search-3x-wds-qryidx-overview.md).</span></span>

### <a name="querying-remote-data-stores-federated-search"></a><span data-ttu-id="b723e-178">Consultar almacenes de datos remotos (búsqueda federada)</span><span class="sxs-lookup"><span data-stu-id="b723e-178">Querying Remote Data Stores (Federated Search)</span></span>

<span data-ttu-id="b723e-179">En Windows 7 y versiones posteriores, la búsqueda federada ofrece un nuevo proveedor de búsquedas que consulta los almacenes de datos remotos a través de servidores Web, a través del protocolo [OpenSearch](https://github.com/dewitt/opensearch) , y enumera los resultados como fuentes XML de Atom o RSS.</span><span class="sxs-lookup"><span data-stu-id="b723e-179">In Windows 7 and later, federated search offers a new search provider that queries remote data stores through web servers, through the [OpenSearch](https://github.com/dewitt/opensearch) protocol, and enumerates the results as RSS or Atom XML feeds.</span></span> <span data-ttu-id="b723e-180">Los conectores de búsqueda son uniones de espacios de nombres que simulan el comportamiento de carpetas mediante un proveedor de búsquedas.</span><span class="sxs-lookup"><span data-stu-id="b723e-180">Search Connectors are namespace junctions that simulate folder behavior by using a search provider.</span></span> <span data-ttu-id="b723e-181">Para obtener más información acerca de la Federación de búsqueda en almacenes de datos remotos en Windows 7, consulte [búsqueda federada en Windows](-search-federated-search-overview.md).</span><span class="sxs-lookup"><span data-stu-id="b723e-181">For more information about search federation to remote data stores in Windows 7, see [Federated Search in Windows](-search-federated-search-overview.md).</span></span>

### <a name="indexing-files-and-items"></a><span data-ttu-id="b723e-182">Indexación de archivos y elementos</span><span class="sxs-lookup"><span data-stu-id="b723e-182">Indexing Files and Items</span></span>

<span data-ttu-id="b723e-183">El contenido que se indexa se basa en el archivo y los tipos de datos admitidos a través de complementos incluidos con Windows Search y las reglas de inclusión y exclusión predeterminadas para las carpetas del sistema de archivos.</span><span class="sxs-lookup"><span data-stu-id="b723e-183">The content that is indexed is based on the file and data types supported through add-ins included with Windows Search and the default inclusion and exclusion rules for folders in the file system.</span></span> <span data-ttu-id="b723e-184">Por ejemplo, los filtros incluidos en la búsqueda de Windows admiten más de 200 tipos comunes de datos, como documentos de Microsoft Office, correo electrónico de Microsoft Outlook (junto con el controlador de protocolo MAPI), archivos de texto sin formato, HTML y muchos más.</span><span class="sxs-lookup"><span data-stu-id="b723e-184">For example, the filters included in Window Search support over 200 common types of data, including Microsoft Office documents, Microsoft Outlook email (in conjunction with the MAPI protocol handler), plain-text files, HTML, and many more.</span></span> <span data-ttu-id="b723e-185">Para obtener una lista completa de los tipos de archivo admitidos de forma nativa, vea [qué se incluye en el índice](-search-3x-wds-included-in-index.md).</span><span class="sxs-lookup"><span data-stu-id="b723e-185">For a full list of file types natively supported, see [What Is Included in the Index](-search-3x-wds-included-in-index.md).</span></span>

<span data-ttu-id="b723e-186">El índice se puede extender con controladores de propiedades y filtros para exponer el contenido y las propiedades de los nuevos formatos de archivo en el índice y el explorador de Windows.</span><span class="sxs-lookup"><span data-stu-id="b723e-186">The index can be extended with property handlers and filters to expose the content and properties of new file formats to the index and Windows Explorer.</span></span> <span data-ttu-id="b723e-187">Los filtros son una implementación de la interfaz de [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="b723e-187">Filters are an implementation of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span> <span data-ttu-id="b723e-188">Hay dos tipos de filtros: uno que interactúa con elementos individuales, como archivos y otro que interactúa con contenedores como carpetas.</span><span class="sxs-lookup"><span data-stu-id="b723e-188">There are two kinds of filters: one that interacts with individual items such as files and one that interacts with containers such as folders.</span></span> <span data-ttu-id="b723e-189">Los filtros tienen varios propósitos, ya que admiten la fragmentación de datos, el contenido de texto, algunas propiedades y varios lenguajes.</span><span class="sxs-lookup"><span data-stu-id="b723e-189">Filters are multi-purpose in that they support chunking data, text content, some properties, and multiple languages.</span></span>

<span data-ttu-id="b723e-190">En cambio, los controladores de propiedades tienen un propósito más específico: para exponer las propiedades de tipos de archivo específicos que se identifican mediante las extensiones de nombre de archivo.</span><span class="sxs-lookup"><span data-stu-id="b723e-190">In contrast, property handlers have a more specific purpose: to expose the properties of specific file types that are identified by file name extensions.</span></span> <span data-ttu-id="b723e-191">Un controlador de propiedades para un tipo de archivo puede habilitar las propiedades get y Set, y puede enumerar las propiedades asociadas a ese tipo de archivo.</span><span class="sxs-lookup"><span data-stu-id="b723e-191">A property handler for a file type can enable get and set properties, and can enumerate the properties associated with that file type.</span></span> <span data-ttu-id="b723e-192">A diferencia de los filtros, los controladores de propiedades no admiten datos o contenido de texto de Chuck, y los controladores de propiedades no tienen forma de indicar en qué idioma se encuentra una propiedad de texto a menos que admitan la escritura de propiedades.</span><span class="sxs-lookup"><span data-stu-id="b723e-192">Unlike filters, property handlers do not support chucking data or text content, and property handlers have no way of indicating what language a text property is in unless they support writing properties.</span></span>

### <a name="indexing-a-data-store"></a><span data-ttu-id="b723e-193">Indexación de un almacén de datos</span><span class="sxs-lookup"><span data-stu-id="b723e-193">Indexing a Data Store</span></span>

<span data-ttu-id="b723e-194">El índice se puede extender con controladores de protocolo para proporcionar acceso a almacenes de datos de propiedad.</span><span class="sxs-lookup"><span data-stu-id="b723e-194">The index can be extended with protocol handlers to provide access to proprietary data stores.</span></span> <span data-ttu-id="b723e-195">Por ejemplo, los archivos y elementos contenidos en los almacenes de datos que no son del sistema de archivos (como las bases de datos y los almacenes de correo electrónico) requieren un controlador de protocolo para asignar desde una dirección URL a una secuencia.</span><span class="sxs-lookup"><span data-stu-id="b723e-195">For example, files and items contained in non-file-system data stores (such as databases and email stores) require a protocol handler to map from a URL to a stream.</span></span> <span data-ttu-id="b723e-196">Los controladores de protocolo también pueden determinar opcionalmente los filtros correctos que se usarán para extraer información de una secuencia.</span><span class="sxs-lookup"><span data-stu-id="b723e-196">Protocol handlers can also optionally determine the correct filters to use for extracting information from a stream.</span></span> <span data-ttu-id="b723e-197">Los filtros enumeran las direcciones URL del almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="b723e-197">Filters enumerate the data store URLs.</span></span> <span data-ttu-id="b723e-198">Los elementos se indexan individualmente mediante el filtro o el controlador de propiedad adecuados.</span><span class="sxs-lookup"><span data-stu-id="b723e-198">The items are then individually indexed using the proper filter and/or property handler.</span></span> <span data-ttu-id="b723e-199">Para obtener más información, vea [extender el índice](-search-3x-wds-extidx-overview.md).</span><span class="sxs-lookup"><span data-stu-id="b723e-199">For more information, see [Extending the Index](-search-3x-wds-extidx-overview.md).</span></span>

### <a name="managing-the-indexing-process"></a><span data-ttu-id="b723e-200">Administrar el proceso de indexación</span><span class="sxs-lookup"><span data-stu-id="b723e-200">Managing the Indexing Process</span></span>

<span data-ttu-id="b723e-201">Los desarrolladores de aplicaciones pueden controlar el ámbito y la frecuencia de la indización de Windows Search mediante el uso de varias interfaces de administración.</span><span class="sxs-lookup"><span data-stu-id="b723e-201">Application developers can control the scope and frequency of Windows Search indexing by using various management interfaces.</span></span> <span data-ttu-id="b723e-202">Estas interfaces incluyen funcionalidad para agregar y quitar los directorios en los que el indexador busca cambios, notificar manualmente el índice de los cambios a los datos, comprobar el estado del indexador y forzar la reindización de algunos o todos los datos.</span><span class="sxs-lookup"><span data-stu-id="b723e-202">These interfaces include functionality to add and remove the directories that the indexer scans for changes, manually notify the index of changes to data, check the status of the indexer, and force re-indexing of some or all data.</span></span> <span data-ttu-id="b723e-203">Para obtener más información, vea [administrar el índice](-search-3x-wds-mngidx-overview.md).</span><span class="sxs-lookup"><span data-stu-id="b723e-203">For more information, see [Managing the Index](-search-3x-wds-mngidx-overview.md).</span></span>

### <a name="integrating-the-windows-property-system-with-windows-search-applications"></a><span data-ttu-id="b723e-204">Integración del sistema de propiedades de Windows con las aplicaciones de Windows Search</span><span class="sxs-lookup"><span data-stu-id="b723e-204">Integrating the Windows Property System with Windows Search Applications</span></span>

<span data-ttu-id="b723e-205">El sistema de propiedades de Windows es un sistema de lectura y escritura extensible de definiciones de datos que proporciona una manera uniforme de expresar metadatos sobre los elementos de Shell.</span><span class="sxs-lookup"><span data-stu-id="b723e-205">The Windows Property System is an extensible read/write system of data definitions that provides a uniform way of expressing metadata about Shell items.</span></span> <span data-ttu-id="b723e-206">El sistema de propiedades de Windows en Windows Vista y versiones posteriores le permite almacenar y recuperar metadatos para elementos de Shell.</span><span class="sxs-lookup"><span data-stu-id="b723e-206">The Windows Property system in Windows Vista and later enables you to store and retrieve metadata for Shell items.</span></span> <span data-ttu-id="b723e-207">Un elemento de Shell es cualquier parte única de contenido, como un archivo, una carpeta, un correo electrónico o un contacto.</span><span class="sxs-lookup"><span data-stu-id="b723e-207">A Shell item is any single piece of content, such as a file, folder, email or contact.</span></span> <span data-ttu-id="b723e-208">Una propiedad es una parte individual de los metadatos asociados a un elemento de Shell.</span><span class="sxs-lookup"><span data-stu-id="b723e-208">A property is an individual piece of metadata associated with a Shell item.</span></span> <span data-ttu-id="b723e-209">Los valores de propiedad se expresan como una estructura [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="b723e-209">Property values are expressed as a [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

<span data-ttu-id="b723e-210">Se incluye una amplia lista de propiedades comunes para varios tipos de elementos comunes, como fotos, música, documentos, mensajes, contactos y archivos.</span><span class="sxs-lookup"><span data-stu-id="b723e-210">An extensive list of common properties is included for a number of common item types such as photos, music, documents, messages, contacts, and files.</span></span> <span data-ttu-id="b723e-211">Los desarrolladores también pueden introducir sus propias propiedades en la plataforma si ninguna propiedad existente satisface sus necesidades.</span><span class="sxs-lookup"><span data-stu-id="b723e-211">Developers can also introduce their own properties to the platform if no existing property meets their needs.</span></span> <span data-ttu-id="b723e-212">Para obtener más información sobre la integración de aplicaciones con el sistema de propiedades de Windows, vea [desarrollar controladores de propiedades](-search-3x-wds-extidx-propertyhandlers.md).</span><span class="sxs-lookup"><span data-stu-id="b723e-212">For more information on integrating applications with the Windows property system, see [Developing Property Handlers](-search-3x-wds-extidx-propertyhandlers.md).</span></span>

## <a name="overview-of-handlers"></a><span data-ttu-id="b723e-213">Información general de los controladores</span><span class="sxs-lookup"><span data-stu-id="b723e-213">Overview of Handlers</span></span>

<span data-ttu-id="b723e-214">Un controlador es un objeto COM (modelo de objetos componentes) que proporciona funcionalidad para un elemento de Shell.</span><span class="sxs-lookup"><span data-stu-id="b723e-214">A handler is a Component Object Model (COM) object that provides functionality for a Shell item.</span></span> <span data-ttu-id="b723e-215">La mayoría de los orígenes de datos de Shell ofrecen un sistema extensible para enlazar controladores a elementos.</span><span class="sxs-lookup"><span data-stu-id="b723e-215">Most Shell data sources offer an extensible system for binding handlers to items.</span></span> <span data-ttu-id="b723e-216">Por ejemplo, la carpeta sistema de archivos utiliza el sistema de Asociación para buscar los controladores de un tipo de archivo determinado.</span><span class="sxs-lookup"><span data-stu-id="b723e-216">For example, the file system folder uses the association system to look up the handlers for a particular file type.</span></span> <span data-ttu-id="b723e-217">Se requiere un controlador específico para cada tipo de archivo.</span><span class="sxs-lookup"><span data-stu-id="b723e-217">A specific handler is required for every file type.</span></span> <span data-ttu-id="b723e-218">Se requiere un controlador de filtro para el tipo de archivo Adobe Acrobat. pdf, por ejemplo, se requiere otro controlador de filtro para el formato de archivo. doc, etc.</span><span class="sxs-lookup"><span data-stu-id="b723e-218">One filter handler is required for the Adobe Acrobat .pdf file type, for example, another filter handler is required for the .doc file format, and so forth.</span></span>

<span data-ttu-id="b723e-219">Los diferentes controladores tienen algunas similitudes.</span><span class="sxs-lookup"><span data-stu-id="b723e-219">Different handlers have some commonality.</span></span> <span data-ttu-id="b723e-220">En Windows Vista y versiones posteriores, todos los controladores deben usar una de las interfaces siguientes para inicializar el controlador: [**IInitializeWithStream**](/windows/win32/api/propsys/nn-propsys-iinitializewithstream), [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem)o [**IItinitializeWithFile**](/windows/win32/api/propsys/nn-propsys-iinitializewithfile).</span><span class="sxs-lookup"><span data-stu-id="b723e-220">In Windows Vista and later, all handlers must use one of the following interfaces to initialize the handler: [**IInitializeWithStream**](/windows/win32/api/propsys/nn-propsys-iinitializewithstream), [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem), or [**IItinitializeWithFile**](/windows/win32/api/propsys/nn-propsys-iinitializewithfile).</span></span>

<span data-ttu-id="b723e-221">En la tabla siguiente se enumeran las tareas de desarrollador de alto nivel, el tipo de controlador necesario para cada tarea, y se proporciona un vínculo a información conceptual acerca de cómo realizar cada tarea.</span><span class="sxs-lookup"><span data-stu-id="b723e-221">The following table lists high-level developer tasks, the type of handler needed for each task, and provides a link to conceptual information about how to perform each task.</span></span>



| <span data-ttu-id="b723e-222">Tarea</span><span class="sxs-lookup"><span data-stu-id="b723e-222">Task</span></span>                                                                                                                                                            | <span data-ttu-id="b723e-223">Controlador</span><span class="sxs-lookup"><span data-stu-id="b723e-223">Handler</span></span>                          | <span data-ttu-id="b723e-224">Información conceptual</span><span class="sxs-lookup"><span data-stu-id="b723e-224">Conceptual information</span></span>                                                                                                                                                                                 |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="b723e-225">Obtener acceso a las propiedades de un archivo para la indexación</span><span class="sxs-lookup"><span data-stu-id="b723e-225">Accessing the properties of a file for indexing</span></span>                                                                                                                 | <span data-ttu-id="b723e-226">Controlador de propiedades</span><span class="sxs-lookup"><span data-stu-id="b723e-226">Property handler</span></span>                 | [<span data-ttu-id="b723e-227">Desarrollar controladores de propiedades</span><span class="sxs-lookup"><span data-stu-id="b723e-227">Developing Property Handlers</span></span>](-search-3x-wds-extidx-propertyhandlers.md)<br/> [<span data-ttu-id="b723e-228">Propiedades definidas por el sistema para formatos de archivo personalizados</span><span class="sxs-lookup"><span data-stu-id="b723e-228">System-Defined Properties for Custom File Formats</span></span>](-shell-systemdefinedpropertiesforfileformats.md)<br/> |
| <span data-ttu-id="b723e-229">Agregar formatos del portapapeles para el objeto de datos ([**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject)) de un elemento (los objetos de datos se utilizan en escenarios de arrastrar y colocar, y copiar y pegar).</span><span class="sxs-lookup"><span data-stu-id="b723e-229">Adding clipboard formats for the data object ([**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject)) of an item (Data objects are used in drag-and-drop and copy/paste scenarios.)</span></span> | <span data-ttu-id="b723e-230">Controlador de objeto de datos</span><span class="sxs-lookup"><span data-stu-id="b723e-230">Data object handler</span></span>              | <span data-ttu-id="b723e-231">[Crear controladores de datos](/previous-versions/windows/desktop/legacy/cc144163(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="b723e-231">[Creating Data Handlers](/previous-versions/windows/desktop/legacy/cc144163(v=vs.85))</span></span>                                                                                                                                                          |
| <span data-ttu-id="b723e-232">Agregar verbos para un elemento que se muestran normalmente en un menú contextual</span><span class="sxs-lookup"><span data-stu-id="b723e-232">Adding verbs for an item that are commonly displayed in a shortcut menu</span></span>                                                                                         | <span data-ttu-id="b723e-233">Controlador del menú contextual</span><span class="sxs-lookup"><span data-stu-id="b723e-233">Shortcut menu handler</span></span>            | [<span data-ttu-id="b723e-234">Crear controladores de menú contextual</span><span class="sxs-lookup"><span data-stu-id="b723e-234">Creating Context Menu Handlers</span></span>](../shell/context-menu-handlers.md)<br/> [<span data-ttu-id="b723e-235">Personalización de un menú contextual mediante verbos dinámicos</span><span class="sxs-lookup"><span data-stu-id="b723e-235">Customizing a Shortcut Menu Using Dynamic Verbs</span></span>](../shell/shortcut-menu-using-dynamic-verbs.md)<br/>                         |
| <span data-ttu-id="b723e-236">Asociar un tipo de archivo a un icono específico</span><span class="sxs-lookup"><span data-stu-id="b723e-236">Associating a file type with a specific icon</span></span>                                                                                                                    | <span data-ttu-id="b723e-237">Controlador de iconos</span><span class="sxs-lookup"><span data-stu-id="b723e-237">Icon handler</span></span>                     | [<span data-ttu-id="b723e-238">Crear controladores de iconos</span><span class="sxs-lookup"><span data-stu-id="b723e-238">Creating Icon Handlers</span></span>](../shell/how-to-create-icon-handlers.md)                                                                                                                                                          |
| <span data-ttu-id="b723e-239">Crear hojas de propiedades con imágenes y controles de interfaz de usuario que permiten la interacción personalizada con un tipo de archivo</span><span class="sxs-lookup"><span data-stu-id="b723e-239">Creating property sheets with UI pictures and controls that permit custom interaction with a file type</span></span>                                                          | <span data-ttu-id="b723e-240">Controlador de la hoja de propiedades</span><span class="sxs-lookup"><span data-stu-id="b723e-240">Property sheet handler</span></span>           | <span data-ttu-id="b723e-241">[Controladores de hoja de propiedades](/previous-versions/windows/desktop/legacy/cc144106(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="b723e-241">[Property Sheet Handlers](/previous-versions/windows/desktop/legacy/cc144106(v=vs.85))</span></span>                                                                                                                                                    |
| <span data-ttu-id="b723e-242">Habilitar un tipo de elemento para admitir escenarios de arrastrar y colocar, y copiar y pegar</span><span class="sxs-lookup"><span data-stu-id="b723e-242">Enabling an item type to support drag-and-drop and copy/paste scenarios</span></span>                                                                                         | <span data-ttu-id="b723e-243">Quitar controlador</span><span class="sxs-lookup"><span data-stu-id="b723e-243">Drop handler</span></span>                     | <span data-ttu-id="b723e-244">[Transferir objetos de Shell con arrastrar y colocar y el portapapeles](/previous-versions/windows/desktop/legacy/bb776905(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="b723e-244">[Transferring Shell Objects with Drag-and-Drop and the Clipboard](/previous-versions/windows/desktop/legacy/bb776905(v=vs.85))</span></span>                                                                                                                      |
| <span data-ttu-id="b723e-245">Extraer fragmentos de texto y propiedades de documento para la indexación</span><span class="sxs-lookup"><span data-stu-id="b723e-245">Extracting chunks of text and document properties for indexing</span></span>                                                                                                  | <span data-ttu-id="b723e-246">Controlador de filtro</span><span class="sxs-lookup"><span data-stu-id="b723e-246">Filter handler</span></span>                   | [<span data-ttu-id="b723e-247">Desarrollar controladores de filtro</span><span class="sxs-lookup"><span data-stu-id="b723e-247">Developing Filter Handlers</span></span>](-search-ifilter-conceptual.md)                                                                                                                                           |
| <span data-ttu-id="b723e-248">Indexación de un nuevo tipo de archivo</span><span class="sxs-lookup"><span data-stu-id="b723e-248">Indexing a new file type</span></span>                                                                                                                                        | <span data-ttu-id="b723e-249">Controlador de filtro, controlador de propiedades</span><span class="sxs-lookup"><span data-stu-id="b723e-249">Filter handler, property handler</span></span> | [<span data-ttu-id="b723e-250">Desarrollar controladores de filtro</span><span class="sxs-lookup"><span data-stu-id="b723e-250">Developing Filter Handlers</span></span>](-search-ifilter-conceptual.md)<br/> [<span data-ttu-id="b723e-251">Desarrollar controladores de propiedades</span><span class="sxs-lookup"><span data-stu-id="b723e-251">Developing Property Handlers</span></span>](-search-3x-wds-extidx-propertyhandlers.md)<br/>                                          |
| <span data-ttu-id="b723e-252">Indizar el contenido de un almacén de datos</span><span class="sxs-lookup"><span data-stu-id="b723e-252">Indexing the contents of a data store</span></span>                                                                                                                           | <span data-ttu-id="b723e-253">Controlador de protocolo</span><span class="sxs-lookup"><span data-stu-id="b723e-253">Protocol handler</span></span>                 | [<span data-ttu-id="b723e-254">Desarrollar controladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="b723e-254">Developing Protocol Handlers</span></span>](-search-3x-wds-phaddins.md)                                                                                                                                            |
| <span data-ttu-id="b723e-255">Vista previa de una vista simplificada del elemento de Shell en el panel de vista previa del explorador de Windows</span><span class="sxs-lookup"><span data-stu-id="b723e-255">Previewing a simplified view of the Shell item in the Windows Explorer preview pane</span></span>                                                                             | <span data-ttu-id="b723e-256">Controlador de vista previa</span><span class="sxs-lookup"><span data-stu-id="b723e-256">Preview handler</span></span>                  | [<span data-ttu-id="b723e-257">Controladores de vista previa</span><span class="sxs-lookup"><span data-stu-id="b723e-257">Preview Handlers</span></span>](../shell/preview-handlers.md)                                                                                                                                                             |
| <span data-ttu-id="b723e-258">Proporcionar texto emergente cuando se mantiene el mouse sobre un objeto de interfaz de usuario</span><span class="sxs-lookup"><span data-stu-id="b723e-258">Supplying pop-up text when a mouse hovers over a UI object</span></span>                                                                                                      | <span data-ttu-id="b723e-259">Controlador de recuadro informativo</span><span class="sxs-lookup"><span data-stu-id="b723e-259">Infotip handler</span></span>                  | <span data-ttu-id="b723e-260">[Crear controladores de extensión de Shell](../shell/handlers.md) (personalización de recuadro)</span><span class="sxs-lookup"><span data-stu-id="b723e-260">[Creating Shell Extension Handlers](../shell/handlers.md) (Infotip Customization)</span></span>                                                                                                                            |
| <span data-ttu-id="b723e-261">Proporcionar una imagen estática para representar un elemento de Shell</span><span class="sxs-lookup"><span data-stu-id="b723e-261">Supplying a static image to represent a Shell item</span></span>                                                                                                              | <span data-ttu-id="b723e-262">Controlador de miniaturas</span><span class="sxs-lookup"><span data-stu-id="b723e-262">Thumbnail handler</span></span>                | <span data-ttu-id="b723e-263">[Controladores en miniatura](/previous-versions/windows/desktop/legacy/cc144118(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="b723e-263">[Thumbnail Handlers](/previous-versions/windows/desktop/legacy/cc144118(v=vs.85))</span></span>                                                                                                                                                        |



 

<span data-ttu-id="b723e-264">En la tabla siguiente se enumeran los controladores y las interfaces para implementar cada tipo de controlador.</span><span class="sxs-lookup"><span data-stu-id="b723e-264">The following table lists handlers and the interfaces for implementing each type of handler.</span></span>



| <span data-ttu-id="b723e-265">Controlador</span><span class="sxs-lookup"><span data-stu-id="b723e-265">Handler</span></span>                | <span data-ttu-id="b723e-266">Interfaces</span><span class="sxs-lookup"><span data-stu-id="b723e-266">Interfaces</span></span>                                                                                                                                                                                                                                                                                                                                                                |
|------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="b723e-267">Quitar controlador</span><span class="sxs-lookup"><span data-stu-id="b723e-267">Drop handler</span></span>           | <span data-ttu-id="b723e-268">[**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget), [**IDropTargetHelper**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-idroptargethelper), [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile), [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit)</span><span class="sxs-lookup"><span data-stu-id="b723e-268">[**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget), [**IDropTargetHelper**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-idroptargethelper), [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile), [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit)</span></span>                                                                                                                                                                                                      |
| <span data-ttu-id="b723e-269">Controlador de objeto de datos</span><span class="sxs-lookup"><span data-stu-id="b723e-269">Data object handler</span></span>    | <span data-ttu-id="b723e-270">[**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject), [ **IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile)</span><span class="sxs-lookup"><span data-stu-id="b723e-270">[**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject), [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile)</span></span>                                                                                                                                                                                                                                                                                                  |
| <span data-ttu-id="b723e-271">Controlador de filtro</span><span class="sxs-lookup"><span data-stu-id="b723e-271">Filter handler</span></span>         | [<span data-ttu-id="b723e-272">**Imaging**</span><span class="sxs-lookup"><span data-stu-id="b723e-272">**IFilter**</span></span>](/windows/win32/api/filter/nn-filter-ifilter)<br/>                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="b723e-273">Controlador de iconos</span><span class="sxs-lookup"><span data-stu-id="b723e-273">Icon handler</span></span>           | [<span data-ttu-id="b723e-274">**IExtractIcon**</span><span class="sxs-lookup"><span data-stu-id="b723e-274">**IExtractIcon**</span></span>](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona)<br/> <span data-ttu-id="b723e-275">Opcional: [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist), [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile)</span><span class="sxs-lookup"><span data-stu-id="b723e-275">Optional: [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist), [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile)</span></span><br/>                                                                                                                                                                                                                                 |
| <span data-ttu-id="b723e-276">Controlador de recuadro informativo</span><span class="sxs-lookup"><span data-stu-id="b723e-276">Infotip handler</span></span>        | [<span data-ttu-id="b723e-277">**IQueryInfo**</span><span class="sxs-lookup"><span data-stu-id="b723e-277">**IQueryInfo**</span></span>](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo)                                                                                                                                                                                                                                                                                                                                        |
| <span data-ttu-id="b723e-278">Controlador de vista previa</span><span class="sxs-lookup"><span data-stu-id="b723e-278">Preview handler</span></span>        | [<span data-ttu-id="b723e-279">**IPreviewHandler**</span><span class="sxs-lookup"><span data-stu-id="b723e-279">**IPreviewHandler**</span></span>](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipreviewhandler)                                                                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="b723e-280">Controlador de propiedades</span><span class="sxs-lookup"><span data-stu-id="b723e-280">Property handler</span></span>       | [<span data-ttu-id="b723e-281">**IPropertyStore**</span><span class="sxs-lookup"><span data-stu-id="b723e-281">**IPropertyStore**</span></span>](/windows/win32/api/propsys/nn-propsys-ipropertystore)                                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="b723e-282">Controlador de protocolo</span><span class="sxs-lookup"><span data-stu-id="b723e-282">Protocol handler</span></span>       | <span data-ttu-id="b723e-283">[**IFilter**](/windows/win32/api/filter/nn-filter-ifilter), [**ISearchProtocol**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol), [**IUrlAccessor**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor)</span><span class="sxs-lookup"><span data-stu-id="b723e-283">[**IFilter**](/windows/win32/api/filter/nn-filter-ifilter), [**ISearchProtocol**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol), [**IUrlAccessor**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor)</span></span><br/> <span data-ttu-id="b723e-284">Opcional: [**ISearchProtocol2**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol2), [**IUrlAccessor2**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor2), [**IUrlAccessor3**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor3), [**IUrlAccessor4**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor4)</span><span class="sxs-lookup"><span data-stu-id="b723e-284">Optional: [**ISearchProtocol2**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol2), [**IUrlAccessor2**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor2), [**IUrlAccessor3**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor3), [**IUrlAccessor4**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor4)</span></span><br/> |
| <span data-ttu-id="b723e-285">Controlador de la hoja de propiedades</span><span class="sxs-lookup"><span data-stu-id="b723e-285">Property sheet handler</span></span> | <span data-ttu-id="b723e-286">[**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit), [ **IShellPropSheetExt**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext)</span><span class="sxs-lookup"><span data-stu-id="b723e-286">[**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit), [**IShellPropSheetExt**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext)</span></span>                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="b723e-287">Controlador del menú contextual</span><span class="sxs-lookup"><span data-stu-id="b723e-287">Shortcut menu handler</span></span>  | <span data-ttu-id="b723e-288">[**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu), [**IExplorerCommand**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iexplorercommand), [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit)</span><span class="sxs-lookup"><span data-stu-id="b723e-288">[**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu), [**IExplorerCommand**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iexplorercommand), [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit)</span></span>                                                                                                                                                                                                                                          |
| <span data-ttu-id="b723e-289">Controlador de miniaturas</span><span class="sxs-lookup"><span data-stu-id="b723e-289">Thumbnail handler</span></span>      | [<span data-ttu-id="b723e-290">**IThumbnailProvider**</span><span class="sxs-lookup"><span data-stu-id="b723e-290">**IThumbnailProvider**</span></span>](/windows/win32/api/thumbcache/nn-thumbcache-ithumbnailprovider)                                                                                                                                                                                                                                                                                                                        |



 

> [!Note]  
> <span data-ttu-id="b723e-291">A veces, un controlador de propiedades se kown como un controlador de metadatos.</span><span class="sxs-lookup"><span data-stu-id="b723e-291">A property handler is sometimes kown as a metadata handler.</span></span> <span data-ttu-id="b723e-292">Un origen de datos de Shell a veces se conoce como una extensión de espacio de nombres de Shell.</span><span class="sxs-lookup"><span data-stu-id="b723e-292">A Shell data source is sometimes known as a Shell namespace extension.</span></span> <span data-ttu-id="b723e-293">Un controlador de tipo de archivo a veces se conoce como controlador de extensión de shell o extensión de Shell.</span><span class="sxs-lookup"><span data-stu-id="b723e-293">A file type handler is sometimes known as a Shell extension handler or a Shell extension.</span></span>

 

<span data-ttu-id="b723e-294">Para obtener más información sobre la creación de controladores, vea [crear controladores de extensión de Shell](../shell/handlers.md).</span><span class="sxs-lookup"><span data-stu-id="b723e-294">For more information about creating handlers, see [Creating Shell Extension Handlers](../shell/handlers.md).</span></span> <span data-ttu-id="b723e-295">Para obtener más información sobre las propiedades, vea [sistema de propiedades de Windows](../properties/windows-properties-system.md).</span><span class="sxs-lookup"><span data-stu-id="b723e-295">For more information about properties, see [Windows Property System](../properties/windows-properties-system.md).</span></span>

## <a name="add-in-installer-guidelines"></a><span data-ttu-id="b723e-296">Instrucciones del instalador de complementos</span><span class="sxs-lookup"><span data-stu-id="b723e-296">Add-in Installer Guidelines</span></span>

<span data-ttu-id="b723e-297">Siga estas instrucciones al crear un instalador de complementos:</span><span class="sxs-lookup"><span data-stu-id="b723e-297">Use the following guidelines when creating an Add-in installer:</span></span>

-   <span data-ttu-id="b723e-298">El instalador debe utilizar el instalador EXE o MSI.</span><span class="sxs-lookup"><span data-stu-id="b723e-298">The installer must use either the EXE or MSI installer.</span></span>
-   <span data-ttu-id="b723e-299">Se deben proporcionar las notas de la versión.</span><span class="sxs-lookup"><span data-stu-id="b723e-299">Release notes must be provided.</span></span>
-   <span data-ttu-id="b723e-300">Se debe crear una entrada **Agregar o quitar programas** para cada complemento instalado.</span><span class="sxs-lookup"><span data-stu-id="b723e-300">An **Add/Remove Programs** entry must be created for each add-in installed.</span></span>
-   <span data-ttu-id="b723e-301">El instalador debe asumir toda la configuración del registro para el tipo de archivo o almacén concreto que el complemento actual entienda.</span><span class="sxs-lookup"><span data-stu-id="b723e-301">The installer must take over all registry settings for the particular file type or store that the current add-in understands.</span></span>
-   <span data-ttu-id="b723e-302">Si se está sobrescribiendo un complemento anterior, el instalador debe notificar al usuario.</span><span class="sxs-lookup"><span data-stu-id="b723e-302">If a previous add-in is being overwritten, the installer should notify the user.</span></span>
-   <span data-ttu-id="b723e-303">Si un complemento más reciente ha sobrescrito un complemento anterior, el usuario debe ser capaz de restaurar la funcionalidad del complemento anterior y volver a convertirlo en el complemento predeterminado para ese tipo de archivo o almacén.</span><span class="sxs-lookup"><span data-stu-id="b723e-303">If a newer add-in has overwritten a previous add-in, the user should be able to restore the previous add-in's functionality and make it the default add-in again for that file type or store.</span></span>

## <a name="note-to-implementers"></a><span data-ttu-id="b723e-304">Nota para los implementadores</span><span class="sxs-lookup"><span data-stu-id="b723e-304">Note to Implementers</span></span>

<span data-ttu-id="b723e-305">Antes de crear un filtro o un controlador de propiedades, los desarrolladores deben tener en cuenta lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="b723e-305">Before creating a filter or property handler, developers should consider the following:</span></span>

-   <span data-ttu-id="b723e-306">Estos controladores son extensiones en proceso que se cargan en procesos que no controla, como el proceso de demonio de filtro, el explorador de Windows (búsqueda de grep) y los hosts de terceros como Windows Mail).</span><span class="sxs-lookup"><span data-stu-id="b723e-306">These handlers are in-process extensions that are loaded into processes that you do not control, such as the filter daemon process, Windows Explorer (grep search), and third-party hosts like Windows Mail).</span></span>
-   <span data-ttu-id="b723e-307">Debe escribir código seguro que sea lo suficientemente eficaz como para controlar los formatos de archivo dañados arbitrariamente que se crearon para atacar el sistema.</span><span class="sxs-lookup"><span data-stu-id="b723e-307">You must write secure code that is robust enough to handle arbitrarily corrupt forms of your file format that were created to attack the system.</span></span>
-   <span data-ttu-id="b723e-308">El complemento no debe perder los recursos que producirán problemas en los procesos de host.</span><span class="sxs-lookup"><span data-stu-id="b723e-308">Your add-in must not leak resources that will produce problems for the host processes.</span></span>
-   <span data-ttu-id="b723e-309">El complemento no debe bloquearse, ya que esto también bloqueará los procesos de host y ralentizará el proceso de filtrado.</span><span class="sxs-lookup"><span data-stu-id="b723e-309">Your add-in must not crash as this will also crash the host processes and slow down the filtering process.</span></span>
-   <span data-ttu-id="b723e-310">Dado que estos controladores se ejecutan en un proceso del sistema en segundo plano, deben ejecutarse rápidamente con un mínimo de CPU y e/s consumidos para cumplir los requisitos de rendimiento del sistema.</span><span class="sxs-lookup"><span data-stu-id="b723e-310">Because these handlers are run in a background system process, they must perform quickly with a minimum of CPU and I/O consumed in order to meet the performance requirements of the system.</span></span>

<span data-ttu-id="b723e-311">Por lo tanto, los desarrolladores deben escribir estos complementos con experiencia en la creación de código de nivel de sistema.</span><span class="sxs-lookup"><span data-stu-id="b723e-311">Thus, these add-ins should be written by developers with expertise in creating system-level code.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="b723e-312">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="b723e-312">Additional Resources</span></span>

-   <span data-ttu-id="b723e-313">Para obtener información sobre la creación de un origen de datos de Shell, vea [implementar las interfaces de objeto de carpeta básicas](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="b723e-313">For information about creating a Shell data source, see [Implementing the Basic Folder Object Interfaces](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85)).</span></span>
-   <span data-ttu-id="b723e-314">En el caso de los orígenes de datos que necesitan usar el objeto de vista de carpeta del sistema predeterminado del shell (DefView), vea [implementar una vista de carpeta, una](../lwef/nse-folderview.md)función de [**SHCreateShellFolderView**](/windows/win32/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview) y [**SFV \_ crear**](/windows/win32/api/shlobj_core/ns-shlobj_core-sfv_create) la estructura.</span><span class="sxs-lookup"><span data-stu-id="b723e-314">For data sources that need to use the Shell Default System Folder View Object (DefView), see [Implementing a Folder View](../lwef/nse-folderview.md), [**SHCreateShellFolderView**](/windows/win32/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview) function, and [**SFV\_CREATE**](/windows/win32/api/shlobj_core/ns-shlobj_core-sfv_create) structure.</span></span> <span data-ttu-id="b723e-315">Los orígenes de datos que utilizan el objeto de vista de carpeta del sistema predeterminado del shell (DefView) deben implementar el siguiente conjunto de interfaces: [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder), [**IShellFolder2**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder2), [**IPersistFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder), [**IPersistFolder2**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder2)y (opcionalmente) [**IPersistFolder3**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder3).</span><span class="sxs-lookup"><span data-stu-id="b723e-315">Data sources that use the Shell Default System Folder View Object (DefView) must implement the following set of interfaces: [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder), [**IShellFolder2**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder2), [**IPersistFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder), [**IPersistFolder2**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder2), and (optionally) [**IPersistFolder3**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder3).</span></span> <span data-ttu-id="b723e-316">Si la implementación de **IShellFolder** no usa **SHCreateShellFolderView** para crear el DefView, el objeto de vista de Shell puede necesitar [**IFolderView**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifolderview).</span><span class="sxs-lookup"><span data-stu-id="b723e-316">If your **IShellFolder** implementation does not use **SHCreateShellFolderView** to create the DefView, the Shell view object may need [**IFolderView**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifolderview).</span></span>
-   <span data-ttu-id="b723e-317">[**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) es la interfaz principal para los consumidores del origen de datos de Shell conocido como DBFolder.</span><span class="sxs-lookup"><span data-stu-id="b723e-317">[**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) is the primary interface for consumers of the Shell data source known as DBFolder.</span></span> <span data-ttu-id="b723e-318">Para obtener más información sobre DBFolder, vea la descripción de la \_ constante Str Parse \_ with \_ Properties en [**BIND context String Keys**](../shell/str-constants.md).</span><span class="sxs-lookup"><span data-stu-id="b723e-318">For more information about DBFolder, see the description of the STR\_PARSE\_WITH\_PROPERTIES constant in [**Bind Context String Keys**](../shell/str-constants.md).</span></span> <span data-ttu-id="b723e-319">Vea también [matrices de asociación](/previous-versions/windows/desktop/legacy/ee872122(v=vs.85)) y [**IPropertySystem:: GetPropertyDescriptionListFromString**](/windows/win32/api/propsys/nf-propsys-ipropertysystem-getpropertydescriptionlistfromstring).</span><span class="sxs-lookup"><span data-stu-id="b723e-319">See also [Association Arrays](/previous-versions/windows/desktop/legacy/ee872122(v=vs.85)) and [**IPropertySystem::GetPropertyDescriptionListFromString**](/windows/win32/api/propsys/nf-propsys-ipropertysystem-getpropertydescriptionlistfromstring).</span></span>
-   <span data-ttu-id="b723e-320">Para obtener información sobre OLE DB, consulte [información general sobre la programación de OLE DB](https://msdn.microsoft.com/library/5d8sd9we(VS.71).aspx).</span><span class="sxs-lookup"><span data-stu-id="b723e-320">For information on OLE DB, see [OLE DB Programming Overview](https://msdn.microsoft.com/library/5d8sd9we(VS.71).aspx).</span></span> <span data-ttu-id="b723e-321">Para obtener información sobre el proveedor de datos de .NET Framework para OLE DB, consulte la documentación del [espacio de nombres System. Data. OleDb](/dotnet/api/system.data.oledb?view=dotnet-plat-ext-3.1) .</span><span class="sxs-lookup"><span data-stu-id="b723e-321">For information on the .NET Framework Data Provider for OLE DB, see the [System.Data.OleDb Namespace](/dotnet/api/system.data.oledb?view=dotnet-plat-ext-3.1) documentation.</span></span>
-   <span data-ttu-id="b723e-322">En el caso de los paneles de mensajes compatibles con la comunidad en tecnologías de búsqueda, vea [Windows: Search forums](https://social.msdn.microsoft.com/Forums/windowsdesktopsearchdevelopment/threads) en MSDN.</span><span class="sxs-lookup"><span data-stu-id="b723e-322">For community-supported message boards on Search technologies, see [Windows: Search Forums](https://social.msdn.microsoft.com/Forums/windowsdesktopsearchdevelopment/threads) on MSDN.</span></span>
-   <span data-ttu-id="b723e-323">Para ver ejemplos de código relacionados, consulte [ejemplos de código de Windows Search](-search-samples-ovw.md).</span><span class="sxs-lookup"><span data-stu-id="b723e-323">For related code samples, see [Windows Search Code Samples](-search-samples-ovw.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="b723e-324">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="b723e-324">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b723e-325">Información general sobre Windows Search</span><span class="sxs-lookup"><span data-stu-id="b723e-325">Windows Search Overview</span></span>](-search-3x-wds-overview.md)
</dt> <dt>

[<span data-ttu-id="b723e-326">Idiomas admitidos por búsqueda de Windows</span><span class="sxs-lookup"><span data-stu-id="b723e-326">Languages Supported by Windows Search</span></span>](-search-3x-wds-language-support.md)
</dt> <dt>

[<span data-ttu-id="b723e-327">Uso de código administrado con datos de shell y Windows Search</span><span class="sxs-lookup"><span data-stu-id="b723e-327">Using Managed Code with Shell Data and Windows Search</span></span>](-search-3x-wds-managed-code.md)
</dt> <dt>

[<span data-ttu-id="b723e-328">Guía del desarrollador de Windows Search</span><span class="sxs-lookup"><span data-stu-id="b723e-328">Windows Search Developer's Guide</span></span>](-search-developers-guide-entry-page.md)
</dt> </dl>

 

 
