---
title: object (atributo)
description: El atributo \ Object \ interface identifica una interfaz COM.
ms.assetid: 51e34ef3-eea7-45f4-b961-a9f742700fe5
keywords:
- atributo de objeto MIDL
topic_type:
- apiref
api_name:
- object
api_type:
- NA
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: cb2c21246282646dcf6ae488411316e07ab62b2f
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/19/2020
ms.locfileid: "103790900"
---
# <a name="object-attribute"></a><span data-ttu-id="5a3eb-104">object (atributo)</span><span class="sxs-lookup"><span data-stu-id="5a3eb-104">object attribute</span></span>

<span data-ttu-id="5a3eb-105">El atributo de interfaz de **\[ objeto \]** identifica una interfaz com.</span><span class="sxs-lookup"><span data-stu-id="5a3eb-105">The **\[object\]** interface attribute identifies a COM interface.</span></span> <span data-ttu-id="5a3eb-106">(Una lista de atributos de interfaz que no incluye el atributo de **\[ objeto \]** indica una interfaz RPC de DCE).</span><span class="sxs-lookup"><span data-stu-id="5a3eb-106">(An interface attribute list that does not include the **\[object\]** attribute indicates a DCE RPC interface.)</span></span>

``` syntax
[ 
    object, 
    uuid(string-uuid)
    [ , interface-attribute-list] 
] 
interface interface-name : base-interface
{
...    
}
```

## <a name="parameters"></a><span data-ttu-id="5a3eb-107">Parámetros</span><span class="sxs-lookup"><span data-stu-id="5a3eb-107">Parameters</span></span>

<dl> <dt>

<span data-ttu-id="5a3eb-108">*cadena: UUID*</span><span class="sxs-lookup"><span data-stu-id="5a3eb-108">*string-uuid*</span></span> 
</dt> <dd>

<span data-ttu-id="5a3eb-109">Cadena UUID generada por la utilidad Uuidgen.</span><span class="sxs-lookup"><span data-stu-id="5a3eb-109">A UUID string generated by the Uuidgen utility.</span></span> <span data-ttu-id="5a3eb-110">Puede incluir la cadena UUID entre comillas.</span><span class="sxs-lookup"><span data-stu-id="5a3eb-110">You can enclose the UUID string in quotes.</span></span>

</dd> <dt>

<span data-ttu-id="5a3eb-111">*interfaz-atributo-lista*</span><span class="sxs-lookup"><span data-stu-id="5a3eb-111">*interface-attribute-list*</span></span> 
</dt> <dd>

<span data-ttu-id="5a3eb-112">Otros atributos que se aplican a la interfaz en conjunto.</span><span class="sxs-lookup"><span data-stu-id="5a3eb-112">Other attributes that apply to the interface as a whole.</span></span>

</dd> <dt>

<span data-ttu-id="5a3eb-113">*nombre de interfaz*</span><span class="sxs-lookup"><span data-stu-id="5a3eb-113">*interface-name*</span></span> 
</dt> <dd>

<span data-ttu-id="5a3eb-114">Nombre de la interfaz.</span><span class="sxs-lookup"><span data-stu-id="5a3eb-114">The name of the interface.</span></span>

</dd> <dt>

<span data-ttu-id="5a3eb-115">*interfaz base*</span><span class="sxs-lookup"><span data-stu-id="5a3eb-115">*base-interface*</span></span> 
</dt> <dd>

<span data-ttu-id="5a3eb-116">La interfaz COM de la que se deriva esta interfaz.</span><span class="sxs-lookup"><span data-stu-id="5a3eb-116">The COM interface from which this interface derives.</span></span> <span data-ttu-id="5a3eb-117">La interfaz base debe ser [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch)u otra interfaz com que deriva, ya sea directa o indirectamente, de **IUnknown** o **IDispatch**.</span><span class="sxs-lookup"><span data-stu-id="5a3eb-117">The base interface must be [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch), or another COM interface that derives, either directly or indirectly, from **IUnknown** or **IDispatch**.</span></span>

</dd> </dl>

## <a name="remarks"></a><span data-ttu-id="5a3eb-118">Observaciones</span><span class="sxs-lookup"><span data-stu-id="5a3eb-118">Remarks</span></span>

<span data-ttu-id="5a3eb-119">Una lista de atributos de interfaz para una interfaz COM debe incluir el **\[** atributo [**UUID**](uuid.md) **\]** , pero no puede incluir el **\[** [](version.md) **\]** atributo version.</span><span class="sxs-lookup"><span data-stu-id="5a3eb-119">An interface attribute list for a COM interface must include the **\[**[**uuid**](uuid.md)**\]** attribute, but it cannot include the **\[**[**version**](version.md)**\]** attribute.</span></span>

<span data-ttu-id="5a3eb-120">De forma predeterminada, al compilar una interfaz COM con el compilador MIDL se generan los archivos necesarios para compilar un archivo DLL de proxy.</span><span class="sxs-lookup"><span data-stu-id="5a3eb-120">By default, compiling a COM interface with the MIDL compiler generates the files needed to build a proxy DLL.</span></span> <span data-ttu-id="5a3eb-121">Este archivo DLL contiene el código para admitir el uso de la interfaz COM personalizada por parte de las aplicaciones cliente y los servidores de objetos.</span><span class="sxs-lookup"><span data-stu-id="5a3eb-121">This DLL contains the code to support the use of the custom COM interface by both client applications and object servers.</span></span> <span data-ttu-id="5a3eb-122">Sin embargo, si la lista de atributos de interfaz para una interfaz COM especifica el **\[** [](local.md) **\]** atributo local, el compilador MIDL solo genera el archivo de encabezado de interfaz.</span><span class="sxs-lookup"><span data-stu-id="5a3eb-122">However, if the interface attribute list for a COM interface specifies the **\[**[**local**](local.md)**\]** attribute, the MIDL compiler generates only the interface header file.</span></span>

<span data-ttu-id="5a3eb-123">El compilador MIDL genera automáticamente un tipo de datos de interfaz para una interfaz COM.</span><span class="sxs-lookup"><span data-stu-id="5a3eb-123">The MIDL compiler automatically generates an interface data type for a COM interface.</span></span> <span data-ttu-id="5a3eb-124">Como alternativa, puede usar [**typedef**](typedef.md) con la palabra clave [**interface**](interface.md) para definir explícitamente un tipo de datos de interfaz.</span><span class="sxs-lookup"><span data-stu-id="5a3eb-124">As an alternative, you can use [**typedef**](typedef.md) with the [**interface**](interface.md) keyword to explicitly define an interface data type.</span></span> <span data-ttu-id="5a3eb-125">La especificación de la interfaz puede usar el tipo de datos de la interfaz en los parámetros de función y los valores devueltos, los miembros de [**estructura**](struct.md) y [**Unión**](union.md) y otras declaraciones de tipos.</span><span class="sxs-lookup"><span data-stu-id="5a3eb-125">The interface specification can then use the interface data type in function parameters and return values, [**struct**](struct.md) and [**union**](union.md) members, and other type declarations.</span></span> <span data-ttu-id="5a3eb-126">En el ejemplo siguiente se muestra el uso de un tipo de datos [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) generado automáticamente:</span><span class="sxs-lookup"><span data-stu-id="5a3eb-126">The following example illustrates the use of an automatically generated [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) data type:</span></span>

``` syntax
[
    object, 
    uuid (ABCDEFOO-1234-1234-5678-ABCDEF123456)
] 
interface IStream : IUnknown
{ 
    typedef IStream * LPSTREAM; 
    // Other interface definition statements.
}
```

<span data-ttu-id="5a3eb-127">En una interfaz COM, se supone que todas las funciones miembro de interfaz son funciones virtuales.</span><span class="sxs-lookup"><span data-stu-id="5a3eb-127">In a COM interface, all the interface member functions are assumed to be virtual functions.</span></span> <span data-ttu-id="5a3eb-128">Una función virtual tiene un puntero **this** implícito como primer parámetro.</span><span class="sxs-lookup"><span data-stu-id="5a3eb-128">A virtual function has an implicit **this** pointer as the first parameter.</span></span> <span data-ttu-id="5a3eb-129">La tabla de función Virtual contiene una entrada para cada función miembro de interfaz.</span><span class="sxs-lookup"><span data-stu-id="5a3eb-129">The virtual function table contains an entry for each interface member function.</span></span>

<span data-ttu-id="5a3eb-130">**\[**[](local.md) **\]** Las funciones miembro de la interfaz de objeto no local deben tener un valor devuelto de HRESULT o SCODE.</span><span class="sxs-lookup"><span data-stu-id="5a3eb-130">Non-**\[**[**local**](local.md)**\]** object interface member functions must have a return value of HRESULT or SCODE.</span></span> <span data-ttu-id="5a3eb-131">(Tenga en cuenta que las versiones anteriores de MIDL permitían que las funciones miembro devuelvan [**void**](void.md).</span><span class="sxs-lookup"><span data-stu-id="5a3eb-131">(Note that earlier versions of MIDL allowed member functions to return [**void**](void.md).</span></span> <span data-ttu-id="5a3eb-132">Sin embargo, a partir de la versión 3,0 de MIDL, si se devuelve **void** , se genera un error del compilador. Tener un valor devuelto de HRESULT o SCODE significa que si se genera una excepción durante una llamada remota, los proxies generados detectan la excepción y devuelven el código de excepción en el valor devuelto.</span><span class="sxs-lookup"><span data-stu-id="5a3eb-132">However, beginning with MIDL version 3.0, returning **void** generates a compiler error.) Having a return value of HRESULT or SCODE means that if an exception is generated during a remote call, the generated proxies catch the exception and return the exception code in the return value.</span></span> <span data-ttu-id="5a3eb-133">Si la aplicación puede permitirse omitir los errores que se producen durante una llamada a procedimiento remoto, puede especificar HRESULT como el tipo de valor devuelto sin comprobar el valor devuelto después de la llamada.</span><span class="sxs-lookup"><span data-stu-id="5a3eb-133">If your application can afford to ignore errors that occur during a remote procedure call, you can specify HRESULT as the return type without checking the return value after the call.</span></span>

<span data-ttu-id="5a3eb-134">Si va a volver a compilar una aplicación antigua, el cambio de los tipos de valor devueltos puede presentar problemas de compatibilidad con versiones anteriores cuando el servidor envía el resultado recién introducido al cliente.</span><span class="sxs-lookup"><span data-stu-id="5a3eb-134">If you are recompiling an old application, changing the return types can introduce backward compatibility problems when the server sends the newly introduced result to the client.</span></span> <span data-ttu-id="5a3eb-135">Como alternativa al cambio del tipo de valor devuelto, puede etiquetar la función que devuelve [**void**](void.md) con el **\[** atributo [**Call \_ as**](call-as.md) , lo que lo **\]** convierte en una función local.</span><span class="sxs-lookup"><span data-stu-id="5a3eb-135">As an alternative to changing the return type, you can label the function that returns [**void**](void.md) with the **\[**[**call\_as**](call-as.md)**\]** attribute, thus making it a local function.</span></span> <span data-ttu-id="5a3eb-136">A continuación, defina una función remota relacionada con los mismos parámetros pero con el tipo de valor devuelto HRESULT.</span><span class="sxs-lookup"><span data-stu-id="5a3eb-136">Then define a related remote function with the same parameters but with the return type of HRESULT.</span></span> <span data-ttu-id="5a3eb-137">La función local puede producir una excepción basada en ese valor HRESULT, si es necesario.</span><span class="sxs-lookup"><span data-stu-id="5a3eb-137">The local function can raise an exception based on that HRESULT value, if necessary.</span></span>

<span data-ttu-id="5a3eb-138">El atributo de **\[ \] objeto** no está disponible al compilar mediante el modificador [**/OSF**](-osf.md) del compilador MIDL.</span><span class="sxs-lookup"><span data-stu-id="5a3eb-138">The **\[object\]** attribute is not available when you compile using the MIDL compiler [**/osf**](-osf.md) switch.</span></span>

## <a name="examples"></a><span data-ttu-id="5a3eb-139">Ejemplos</span><span class="sxs-lookup"><span data-stu-id="5a3eb-139">Examples</span></span>

``` syntax
[
    uuid(12345678-1234-1234-1234-123456789ABC), 
    object
] 
interface IMyInterface : IUnknown
{
    // Interface definition statements.
}

[
    uuid(87654321-1234-1234-1234-123456789ABC), 
    object, 
    local
] 
interface ILocalInterface : ISomeOldCOMInterface
{
    // Interface definition statements.
}
```

## <a name="see-also"></a><span data-ttu-id="5a3eb-140">Vea también</span><span class="sxs-lookup"><span data-stu-id="5a3eb-140">See also</span></span>

<dl> <dt>

[<span data-ttu-id="5a3eb-141">**llamar a \_ como**</span><span class="sxs-lookup"><span data-stu-id="5a3eb-141">**call\_as**</span></span>](call-as.md)
</dt> <dt>

[<span data-ttu-id="5a3eb-142">Archivo de definición de interfaz (IDL)</span><span class="sxs-lookup"><span data-stu-id="5a3eb-142">Interface Definition (IDL) File</span></span>](interface-definition-idl-file.md)
</dt> <dt>

[<span data-ttu-id="5a3eb-143">**IID \_ es**</span><span class="sxs-lookup"><span data-stu-id="5a3eb-143">**iid\_is**</span></span>](iid-is.md)
</dt> <dt>

[<span data-ttu-id="5a3eb-144">**interfaz**</span><span class="sxs-lookup"><span data-stu-id="5a3eb-144">**interface**</span></span>](interface.md)
</dt> <dt>

[<span data-ttu-id="5a3eb-145">**localizar**</span><span class="sxs-lookup"><span data-stu-id="5a3eb-145">**local**</span></span>](local.md)
</dt> <dt>

[<span data-ttu-id="5a3eb-146">**/osf**</span><span class="sxs-lookup"><span data-stu-id="5a3eb-146">**/osf**</span></span>](-osf.md)
</dt> <dt>

[<span data-ttu-id="5a3eb-147">**typedef**</span><span class="sxs-lookup"><span data-stu-id="5a3eb-147">**typedef**</span></span>](typedef.md)
</dt> <dt>

[<span data-ttu-id="5a3eb-148">**uuid**</span><span class="sxs-lookup"><span data-stu-id="5a3eb-148">**uuid**</span></span>](uuid.md)
</dt> <dt>

[<span data-ttu-id="5a3eb-149">**Versión**</span><span class="sxs-lookup"><span data-stu-id="5a3eb-149">**version**</span></span>](version.md)
</dt> </dl>

 

 