---
description: En este tema se describen las interfaces y los métodos específicos necesarios para crear un controlador de vista previa.
ms.assetid: 6c240a63-c184-4b65-9483-794f5de4d695
title: Crear controladores de vista previa
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a309873cf082071d5f426ce0ba6d039107c59665
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104360169"
---
# <a name="building-preview-handlers"></a><span data-ttu-id="a2007-103">Crear controladores de vista previa</span><span class="sxs-lookup"><span data-stu-id="a2007-103">Building Preview Handlers</span></span>

<span data-ttu-id="a2007-104">En este tema se describen las interfaces y los métodos específicos necesarios para crear un controlador de vista previa.</span><span class="sxs-lookup"><span data-stu-id="a2007-104">This topic discusses the specific interfaces and methods required to create a preview handler.</span></span>

<span data-ttu-id="a2007-105">Un controlador de vista previa debe implementar las interfaces siguientes:</span><span class="sxs-lookup"><span data-stu-id="a2007-105">A preview handler must implement the following interfaces:</span></span>

-   <span data-ttu-id="a2007-106">[IInitializeWithStream:: Initialize](#iinitializewithstreaminitialize) (muy recomendable), [**IInitializeWithFile**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithfile)o [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem)</span><span class="sxs-lookup"><span data-stu-id="a2007-106">[IInitializeWithStream::Initialize](#iinitializewithstreaminitialize) (strongly preferred), [**IInitializeWithFile**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithfile), or [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem)</span></span>
-   [<span data-ttu-id="a2007-107">IObjectWithSite</span><span class="sxs-lookup"><span data-stu-id="a2007-107">IObjectWithSite</span></span>](#iobjectwithsite)
-   [<span data-ttu-id="a2007-108">IOleWindow</span><span class="sxs-lookup"><span data-stu-id="a2007-108">IOleWindow</span></span>](#iolewindow)
-   [<span data-ttu-id="a2007-109">IPreviewHandler</span><span class="sxs-lookup"><span data-stu-id="a2007-109">IPreviewHandler</span></span>](#ipreviewhandler)

<span data-ttu-id="a2007-110">Si el controlador de vista previa admite la configuración visual proporcionada por el host, como el color de fondo y la fuente, también debe implementar la siguiente interfaz:</span><span class="sxs-lookup"><span data-stu-id="a2007-110">If your preview handler supports visual settings provided by the host such as background color and font, it must also implement the following interface:</span></span>

-   [<span data-ttu-id="a2007-111">IPreviewHandlerVisuals</span><span class="sxs-lookup"><span data-stu-id="a2007-111">IPreviewHandlerVisuals</span></span>](#ipreviewhandlervisuals)

<span data-ttu-id="a2007-112">En este tema se supone que el controlador de vista previa se inicializa con una secuencia y está registrado para una extensión de nombre de archivo determinada.</span><span class="sxs-lookup"><span data-stu-id="a2007-112">This topic assumes that the preview handler is initialized with a stream and is registered for a particular file name extension.</span></span>

## <a name="iinitializewithstreaminitialize"></a><span data-ttu-id="a2007-113">IInitializeWithStream:: Initialize</span><span class="sxs-lookup"><span data-stu-id="a2007-113">IInitializeWithStream::Initialize</span></span>

<span data-ttu-id="a2007-114">Almacene los parámetros de modo [**IStream**](/windows/win32/api/objidl/nn-objidl-istream) y para poder leer los datos del elemento cuando esté listo para obtener una vista previa del elemento.</span><span class="sxs-lookup"><span data-stu-id="a2007-114">Store the [**IStream**](/windows/win32/api/objidl/nn-objidl-istream) and mode parameters so that you can read the item's data when you are ready to preview the item.</span></span> <span data-ttu-id="a2007-115">No cargue los datos en [**Initialize**](/windows/desktop/api/Propsys/nf-propsys-iinitializewithstream-initialize).</span><span class="sxs-lookup"><span data-stu-id="a2007-115">Do not load the data in [**Initialize**](/windows/desktop/api/Propsys/nf-propsys-iinitializewithstream-initialize).</span></span> <span data-ttu-id="a2007-116">Cargue los datos en [**IPreviewHandler::D opreview**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-dopreview) justo antes de representarlo.</span><span class="sxs-lookup"><span data-stu-id="a2007-116">Load the data in [**IPreviewHandler::DoPreview**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-dopreview) just before you render.</span></span>

## <a name="iobjectwithsite"></a><span data-ttu-id="a2007-117">IObjectWithSite</span><span class="sxs-lookup"><span data-stu-id="a2007-117">IObjectWithSite</span></span>

-   [<span data-ttu-id="a2007-118">IObjectWithSite:: SetSite</span><span class="sxs-lookup"><span data-stu-id="a2007-118">IObjectWithSite::SetSite</span></span>](#iobjectwithsitesetsite)
-   [<span data-ttu-id="a2007-119">IObjectWithSite:: GetSite</span><span class="sxs-lookup"><span data-stu-id="a2007-119">IObjectWithSite::GetSite</span></span>](#iobjectwithsitegetsite)

### <a name="iobjectwithsitesetsite"></a><span data-ttu-id="a2007-120">IObjectWithSite:: SetSite</span><span class="sxs-lookup"><span data-stu-id="a2007-120">IObjectWithSite::SetSite</span></span>

<span data-ttu-id="a2007-121">Almacene el puntero [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) para el acceso posterior.</span><span class="sxs-lookup"><span data-stu-id="a2007-121">Store the [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) pointer for later access.</span></span>

<span data-ttu-id="a2007-122">Si actualmente tiene una referencia a un objeto [**IPreviewHandlerFrame**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipreviewhandlerframe) , suéltelo.</span><span class="sxs-lookup"><span data-stu-id="a2007-122">If you currently have a reference to an [**IPreviewHandlerFrame**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipreviewhandlerframe) object, release it.</span></span> <span data-ttu-id="a2007-123">Use el puntero [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) almacenado para llamar a [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) en el sitio para obtener una nueva referencia de **IPreviewHandlerFrame** .</span><span class="sxs-lookup"><span data-stu-id="a2007-123">Use the stored [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) pointer to call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) on the site for a new **IPreviewHandlerFrame** reference.</span></span>

<span data-ttu-id="a2007-124">Si actualmente tiene una tabla de aceleradores, destruyala.</span><span class="sxs-lookup"><span data-stu-id="a2007-124">If you currently have an accelerator table, destroy it.</span></span> <span data-ttu-id="a2007-125">Llame a [**IPreviewHandlerFrame:: GetWindowContext**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandlerframe-getwindowcontext) para obtener una nueva tabla de aceleradores.</span><span class="sxs-lookup"><span data-stu-id="a2007-125">Call [**IPreviewHandlerFrame::GetWindowContext**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandlerframe-getwindowcontext) to get a new accelerator table.</span></span> <span data-ttu-id="a2007-126">Almacene esta tabla.</span><span class="sxs-lookup"><span data-stu-id="a2007-126">Store this table.</span></span> <span data-ttu-id="a2007-127">Tenga en cuenta que solo se utiliza como una lista de teclas de aceleración que admite el marco.</span><span class="sxs-lookup"><span data-stu-id="a2007-127">Note that it is used only as a list of accelerator keys that the frame supports.</span></span> <span data-ttu-id="a2007-128">Los comandos de las entradas de acelerador se omiten.</span><span class="sxs-lookup"><span data-stu-id="a2007-128">Commands in the accelerator entries are ignored.</span></span>

### <a name="iobjectwithsitegetsite"></a><span data-ttu-id="a2007-129">IObjectWithSite:: GetSite</span><span class="sxs-lookup"><span data-stu-id="a2007-129">IObjectWithSite::GetSite</span></span>

<span data-ttu-id="a2007-130">Devuelve el puntero del sitio, sea cual sea su valor.</span><span class="sxs-lookup"><span data-stu-id="a2007-130">Return the site pointer, whatever it is.</span></span>

## <a name="iolewindow"></a><span data-ttu-id="a2007-131">IOleWindow</span><span class="sxs-lookup"><span data-stu-id="a2007-131">IOleWindow</span></span>

-   [<span data-ttu-id="a2007-132">IOleWindow::ContextSensitiveHelp</span><span class="sxs-lookup"><span data-stu-id="a2007-132">IOleWindow::ContextSensitiveHelp</span></span>](#iolewindowcontextsensitivehelp)
-   [<span data-ttu-id="a2007-133">IOleWindow::GetWindow</span><span class="sxs-lookup"><span data-stu-id="a2007-133">IOleWindow::GetWindow</span></span>](#iolewindowgetwindow)

### <a name="iolewindowcontextsensitivehelp"></a><span data-ttu-id="a2007-134">IOleWindow::ContextSensitiveHelp</span><span class="sxs-lookup"><span data-stu-id="a2007-134">IOleWindow::ContextSensitiveHelp</span></span>

<span data-ttu-id="a2007-135">Devuelve E \_ NOTIMPL para este método.</span><span class="sxs-lookup"><span data-stu-id="a2007-135">Return E\_NOTIMPL for this method.</span></span>

### <a name="iolewindowgetwindow"></a><span data-ttu-id="a2007-136">IOleWindow::GetWindow</span><span class="sxs-lookup"><span data-stu-id="a2007-136">IOleWindow::GetWindow</span></span>

<span data-ttu-id="a2007-137">Si la ventana del controlador de vista previa existe actualmente, devuelva el **hWnd** de esa ventana y el valor \_ correcto.</span><span class="sxs-lookup"><span data-stu-id="a2007-137">If the preview handler's window currently exists, return the **HWND** of that window and S\_OK.</span></span> <span data-ttu-id="a2007-138">Si la ventana no existe, se devuelve E \_ produce un error.</span><span class="sxs-lookup"><span data-stu-id="a2007-138">If the window does not exist, return E\_FAIL.</span></span>

## <a name="ipreviewhandler"></a><span data-ttu-id="a2007-139">IPreviewHandler</span><span class="sxs-lookup"><span data-stu-id="a2007-139">IPreviewHandler</span></span>

-   [<span data-ttu-id="a2007-140">IPreviewHandler:: SetWindow</span><span class="sxs-lookup"><span data-stu-id="a2007-140">IPreviewHandler::SetWindow</span></span>](#ipreviewhandlersetwindow)
-   [<span data-ttu-id="a2007-141">IPreviewHandler::SetRect</span><span class="sxs-lookup"><span data-stu-id="a2007-141">IPreviewHandler::SetRect</span></span>](#ipreviewhandlersetrect)
-   [<span data-ttu-id="a2007-142">IPreviewHandler::D oPreview</span><span class="sxs-lookup"><span data-stu-id="a2007-142">IPreviewHandler::DoPreview</span></span>](#ipreviewhandlerdopreview)
-   [<span data-ttu-id="a2007-143">IPreviewHandler:: SetFocus</span><span class="sxs-lookup"><span data-stu-id="a2007-143">IPreviewHandler::SetFocus</span></span>](#ipreviewhandlersetfocus)
-   [<span data-ttu-id="a2007-144">IPreviewHandler::QueryFocus</span><span class="sxs-lookup"><span data-stu-id="a2007-144">IPreviewHandler::QueryFocus</span></span>](#ipreviewhandlerqueryfocus)
-   [<span data-ttu-id="a2007-145">IPreviewHandler:: TranslateAccelerator</span><span class="sxs-lookup"><span data-stu-id="a2007-145">IPreviewHandler::TranslateAccelerator</span></span>](#ipreviewhandlertranslateaccelerator)
-   [<span data-ttu-id="a2007-146">IPreviewHandler:: Unload</span><span class="sxs-lookup"><span data-stu-id="a2007-146">IPreviewHandler::Unload</span></span>](#ipreviewhandlerunload)

### <a name="ipreviewhandlersetwindow"></a><span data-ttu-id="a2007-147">IPreviewHandler:: SetWindow</span><span class="sxs-lookup"><span data-stu-id="a2007-147">IPreviewHandler::SetWindow</span></span>

<span data-ttu-id="a2007-148">Establezca el parámetro *hWnd* de este método en el elemento primario del **hWnd** del controlador de vista previa.</span><span class="sxs-lookup"><span data-stu-id="a2007-148">Set the *hwnd* parameter of this method to the parent of your preview handler's **HWND**.</span></span> <span data-ttu-id="a2007-149">Se puede llamar a este método varias veces.</span><span class="sxs-lookup"><span data-stu-id="a2007-149">This method can be called multiple times.</span></span> <span data-ttu-id="a2007-150">Cambie el tamaño de la vista previa para que se represente solo en el área descrita por el parámetro *PRC* .</span><span class="sxs-lookup"><span data-stu-id="a2007-150">Resize your preview so that it renders only in the area described by the *prc* parameter.</span></span>

<span data-ttu-id="a2007-151">Si el objeto de vista previa está en proceso de representación, utilice el método [**IPreviewHandler:: SetWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-setwindow) para cambiar el elemento primario del control de vista previa.</span><span class="sxs-lookup"><span data-stu-id="a2007-151">If the previewer is in the process of rendering, use the [**IPreviewHandler::SetWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-setwindow) method to change the parent of the previewer.</span></span> <span data-ttu-id="a2007-152">Cambie también el área en la que se representa la vista previa.</span><span class="sxs-lookup"><span data-stu-id="a2007-152">Also change the area in which the previewer is rendering.</span></span>

### <a name="ipreviewhandlersetrect"></a><span data-ttu-id="a2007-153">IPreviewHandler::SetRect</span><span class="sxs-lookup"><span data-stu-id="a2007-153">IPreviewHandler::SetRect</span></span>

<span data-ttu-id="a2007-154">Cambie el tamaño de la vista previa para que solo se represente en el área descrita por la *RPC* de este método.</span><span class="sxs-lookup"><span data-stu-id="a2007-154">Resize your preview so that it only renders in the area described by this method's *prc*.</span></span>

<span data-ttu-id="a2007-155">Si el previsor está en proceso de representación, cambie el área en la que se representa el previsualizador.</span><span class="sxs-lookup"><span data-stu-id="a2007-155">If the previewer is in the process of rendering, change the area in which your previewer renders.</span></span>

### <a name="ipreviewhandlerdopreview"></a><span data-ttu-id="a2007-156">IPreviewHandler::D oPreview</span><span class="sxs-lookup"><span data-stu-id="a2007-156">IPreviewHandler::DoPreview</span></span>

<span data-ttu-id="a2007-157">Aquí es donde se realiza el trabajo real.</span><span class="sxs-lookup"><span data-stu-id="a2007-157">This is where the real work is done.</span></span> <span data-ttu-id="a2007-158">Puesto que una vista previa es dinámica, el contenido de la vista previa solo debe cargarse cuando sea necesario.</span><span class="sxs-lookup"><span data-stu-id="a2007-158">Since a preview is dynamic, the preview content should only be loaded when it is needed.</span></span> <span data-ttu-id="a2007-159">No cargue el contenido en la inicialización.</span><span class="sxs-lookup"><span data-stu-id="a2007-159">Do not load content in the initialization.</span></span>

<span data-ttu-id="a2007-160">Si la ventana controlador de vista previa no existe, créela.</span><span class="sxs-lookup"><span data-stu-id="a2007-160">If the preview handler window does not exist, create it.</span></span> <span data-ttu-id="a2007-161">Las ventanas del controlador de vista previa deben ser elementos secundarios de la ventana proporcionada por [**IPreviewHandler:: SetWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-setwindow).</span><span class="sxs-lookup"><span data-stu-id="a2007-161">Your preview handler's windows should be children of the window provided by [**IPreviewHandler::SetWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-setwindow).</span></span> <span data-ttu-id="a2007-162">Deben ser el tamaño proporcionado por **IPreviewHandler:: SetWindow** y [**IPreviewHandler:: SetRect**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-setrect) (lo que se llamó más recientemente).</span><span class="sxs-lookup"><span data-stu-id="a2007-162">They should be the size provided by **IPreviewHandler::SetWindow** and [**IPreviewHandler::SetRect**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-setrect) (whichever was called most recently).</span></span>

<span data-ttu-id="a2007-163">Una vez que tenga una ventana, cargue los datos de la [**IStream**](/windows/win32/api/objidl/nn-objidl-istream) en la que se ha inicializado el controlador de vista previa y represente los datos en la ventana del controlador de vista previa.</span><span class="sxs-lookup"><span data-stu-id="a2007-163">Once you have a window, load the data from the [**IStream**](/windows/win32/api/objidl/nn-objidl-istream) that the preview handler was initialized with, and render that data to your preview handler's window.</span></span>

### <a name="ipreviewhandlersetfocus"></a><span data-ttu-id="a2007-164">IPreviewHandler:: SetFocus</span><span class="sxs-lookup"><span data-stu-id="a2007-164">IPreviewHandler::SetFocus</span></span>

<span data-ttu-id="a2007-165">Se llama a este método cuando el foco entra en el panel de lectura a través de una acción de tabulación.</span><span class="sxs-lookup"><span data-stu-id="a2007-165">This method is called when the focus enters the reading pane through a tab action.</span></span> <span data-ttu-id="a2007-166">Dado que se puede escribir como una pestaña de avance o una pestaña inversa, use el estado actual de la tecla Mayús para decidir si la primera o última posición de tabulación en el panel de lectura debe recibir el foco.</span><span class="sxs-lookup"><span data-stu-id="a2007-166">Since it can be entered as a forward tab or reverse tab, use the current state of the SHIFT key to decide whether the first or last tab stop in the reading pane should receive the focus.</span></span>

### <a name="ipreviewhandlerqueryfocus"></a><span data-ttu-id="a2007-167">IPreviewHandler::QueryFocus</span><span class="sxs-lookup"><span data-stu-id="a2007-167">IPreviewHandler::QueryFocus</span></span>

<span data-ttu-id="a2007-168">Este método debe llamar a la función [**GetFocus**](/windows/win32/api/winuser/nf-winuser-getfocus) y devolver el resultado de esa llamada en el parámetro *phwnd* .</span><span class="sxs-lookup"><span data-stu-id="a2007-168">This method should call the [**GetFocus**](/windows/win32/api/winuser/nf-winuser-getfocus) function and return the result of that call in the *phwnd* parameter.</span></span>

### <a name="ipreviewhandlertranslateaccelerator"></a><span data-ttu-id="a2007-169">IPreviewHandler:: TranslateAccelerator</span><span class="sxs-lookup"><span data-stu-id="a2007-169">IPreviewHandler::TranslateAccelerator</span></span>

<span data-ttu-id="a2007-170">Este método es invocado por el bombeo de mensajes del proceso del controlador de vista previa (ya sea prevhost.exe o un servidor local personalizado) en respuesta a las pulsaciones de teclas del usuario.</span><span class="sxs-lookup"><span data-stu-id="a2007-170">This method is called by the message pump of the preview handler's process (whether prevhost.exe or a custom local server) in response to user keystrokes.</span></span> <span data-ttu-id="a2007-171">Los controladores de vista previa deben controlar estas pulsaciones de teclas o reenviarlas a su host según el algoritmo que se detalla a continuación.</span><span class="sxs-lookup"><span data-stu-id="a2007-171">Preview handlers should handle these keystrokes or forward them to their host according to the algorithm detailed below.</span></span>

<span data-ttu-id="a2007-172">Sin embargo, dado que las vistas previas son de solo lectura, la entrada de teclado debe ser mínima y las optimizaciones como esta no se necesitan en muchos casos.</span><span class="sxs-lookup"><span data-stu-id="a2007-172">However, because previews are read-only, keyboard input should be minimal and optimizations such as this are not needed in many cases.</span></span>

<span data-ttu-id="a2007-173">Si el acelerador de teclado que se pasa a este método a través del bombeo de mensajes es un acelerador que el controlador de vista previa acepta, procese y devuelva los elementos \_ correctos.</span><span class="sxs-lookup"><span data-stu-id="a2007-173">If the keyboard accelerator passed to this method through the message pump is an accelerator that your preview handler accepts, then process it and return S\_OK.</span></span> <span data-ttu-id="a2007-174">Si el controlador no acepta ese acelerador, el mensaje del acelerador se puede devolver hasta el fotograma que se va a controlar.</span><span class="sxs-lookup"><span data-stu-id="a2007-174">If your handler does not accept that accelerator, the accelerator message can be sent back as far as the frame to be handled.</span></span>

<span data-ttu-id="a2007-175">Hay dos opciones para reenviar aceleradores de teclado al fotograma:</span><span class="sxs-lookup"><span data-stu-id="a2007-175">There are two options for forwarding keyboard accelerators back to the frame:</span></span>

<span data-ttu-id="a2007-176">El modelo más sencillo es reenviar todas las pulsaciones de tecla al host mediante [**IPreviewHandlerFrame:: TranslateAccelerator**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandlerframe-translateaccelerator).</span><span class="sxs-lookup"><span data-stu-id="a2007-176">The simplest model is to forward all keystrokes to the host using [**IPreviewHandlerFrame::TranslateAccelerator**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandlerframe-translateaccelerator).</span></span> <span data-ttu-id="a2007-177">Esto se hace en el ejemplo de controlador de vista previa proporcionado con el kit de desarrollo de software (SDK) de Windows.</span><span class="sxs-lookup"><span data-stu-id="a2007-177">This is done in the preview handler sample provided with the Windows Software Development Kit (SDK).</span></span> <span data-ttu-id="a2007-178">Todos los controladores de vista previa de baja integridad deben usar este modelo.</span><span class="sxs-lookup"><span data-stu-id="a2007-178">All low-integrity preview handlers must use this model.</span></span> <span data-ttu-id="a2007-179">Si el controlador de vista previa no controla el acelerador, llame a **IPreviewHandlerFrame:: TranslateAccelerator** y devuelva su resultado.</span><span class="sxs-lookup"><span data-stu-id="a2007-179">If the accelerator is not handled by your preview handler, call **IPreviewHandlerFrame::TranslateAccelerator** and return its result.</span></span>

<span data-ttu-id="a2007-180">El otro modelo es usar una tabla de aceleradores como una optimización para evitar el envío de demasiadas pulsaciones de tecla en los límites del proceso:</span><span class="sxs-lookup"><span data-stu-id="a2007-180">The other model is to use an accelerator table as an optimization to avoid sending too many keystrokes across process boundaries:</span></span>

1.  <span data-ttu-id="a2007-181">Cuando se llama a [**IObjectWithSite:: SetSite**](/windows/win32/api/ocidl/nf-ocidl-iobjectwithsite-setsite) en el controlador de vista previa, adquiera la tabla de aceleradores a través de [**IPreviewHandlerFrame:: GetWindowContext**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandlerframe-getwindowcontext).</span><span class="sxs-lookup"><span data-stu-id="a2007-181">When [**IObjectWithSite::SetSite**](/windows/win32/api/ocidl/nf-ocidl-iobjectwithsite-setsite) is called on your preview handler, acquire the accelerator table through [**IPreviewHandlerFrame::GetWindowContext**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandlerframe-getwindowcontext).</span></span> <span data-ttu-id="a2007-182">(Asegúrese de liberar el identificador de la tabla de aceleradores cuando se destruya el controlador de vista previa).</span><span class="sxs-lookup"><span data-stu-id="a2007-182">(Be sure to free the handle to the accelerator table when your previewer is destroyed.)</span></span>
2.  <span data-ttu-id="a2007-183">Si el controlador de vista previa controla el acelerador, debe controlarlo y devolver S \_ correcto.</span><span class="sxs-lookup"><span data-stu-id="a2007-183">If the accelerator is handled by your preview handler, handle it and return S\_OK.</span></span>
3.  <span data-ttu-id="a2007-184">Si el controlador de vista previa no controla el acelerador, compare el mensaje con [**IsAccelerator**](/windows/win32/api/ole2/nf-ole2-isaccelerator) en la tabla de aceleradores adquirida.</span><span class="sxs-lookup"><span data-stu-id="a2007-184">If the accelerator is not handled by your preview handler, compare the message using [**IsAccelerator**](/windows/win32/api/ole2/nf-ole2-isaccelerator) against the accelerator table acquired.</span></span>
4.  <span data-ttu-id="a2007-185">Si el acelerador coincide con una entrada de esa tabla de aceleradores, llame a [**IPreviewHandlerFrame:: TranslateAccelerator**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandlerframe-translateaccelerator) y devuelva su resultado.</span><span class="sxs-lookup"><span data-stu-id="a2007-185">If the accelerator matches an entry in that accelerator table, call [**IPreviewHandlerFrame::TranslateAccelerator**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandlerframe-translateaccelerator) and return its result.</span></span>
5.  <span data-ttu-id="a2007-186">Si el acelerador no coincide con ninguna entrada de la tabla de aceleradores, devuelve S \_ false.</span><span class="sxs-lookup"><span data-stu-id="a2007-186">If the accelerator does not match any entry in the accelerator table, return S\_FALSE.</span></span>

### <a name="ipreviewhandlerunload"></a><span data-ttu-id="a2007-187">IPreviewHandler:: Unload</span><span class="sxs-lookup"><span data-stu-id="a2007-187">IPreviewHandler::Unload</span></span>

<span data-ttu-id="a2007-188">Cuando se llama a este método, se detiene cualquier representación, se liberan los recursos asignados mediante la lectura de los datos de la secuencia y se libera la propia [**IStream**](/windows/win32/api/objidl/nn-objidl-istream) .</span><span class="sxs-lookup"><span data-stu-id="a2007-188">When this method is called, stop any rendering, release any resources allocated by reading data from the stream, and release the [**IStream**](/windows/win32/api/objidl/nn-objidl-istream) itself.</span></span>

<span data-ttu-id="a2007-189">Una vez que se llama a este método, se debe reinicializar el controlador antes de cualquier intento de llamar a [**IPreviewHandler::D opreview**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-dopreview) de nuevo.</span><span class="sxs-lookup"><span data-stu-id="a2007-189">Once this method is called, the handler must be reinitialized before any attempt to call [**IPreviewHandler::DoPreview**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-dopreview) again.</span></span>

## <a name="ipreviewhandlervisuals"></a><span data-ttu-id="a2007-190">IPreviewHandlerVisuals</span><span class="sxs-lookup"><span data-stu-id="a2007-190">IPreviewHandlerVisuals</span></span>

-   [<span data-ttu-id="a2007-191">IPreviewHandlerVisuals::SetBackgroundColor</span><span class="sxs-lookup"><span data-stu-id="a2007-191">IPreviewHandlerVisuals::SetBackgroundColor</span></span>](#ipreviewhandlervisualssetbackgroundcolor)
-   [<span data-ttu-id="a2007-192">IPreviewHandlerVisuals:: SetFont</span><span class="sxs-lookup"><span data-stu-id="a2007-192">IPreviewHandlerVisuals::SetFont</span></span>](#ipreviewhandlervisualssetfont)
-   [<span data-ttu-id="a2007-193">IPreviewHandlerVisuals::SetTextColor</span><span class="sxs-lookup"><span data-stu-id="a2007-193">IPreviewHandlerVisuals::SetTextColor</span></span>](#ipreviewhandlervisualssettextcolor)

<span data-ttu-id="a2007-194">Estos métodos deben implementarse al dirigir el controlador de vista previa para responder a los esquemas de fuente y color del host.</span><span class="sxs-lookup"><span data-stu-id="a2007-194">These methods should be implemented when directing the preview handler to respond to the host's color and font schemes.</span></span> <span data-ttu-id="a2007-195">El host consulta el controlador de [**IPreviewHandlerVisuals**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipreviewhandlervisuals).</span><span class="sxs-lookup"><span data-stu-id="a2007-195">The host queries the handler for [**IPreviewHandlerVisuals**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipreviewhandlervisuals).</span></span> <span data-ttu-id="a2007-196">Si se detecta que es compatible, el host le proporciona color, fuente y color de texto.</span><span class="sxs-lookup"><span data-stu-id="a2007-196">If found to be supported, the host provides it with color, font, and text color.</span></span>

### <a name="ipreviewhandlervisualssetbackgroundcolor"></a><span data-ttu-id="a2007-197">IPreviewHandlerVisuals::SetBackgroundColor</span><span class="sxs-lookup"><span data-stu-id="a2007-197">IPreviewHandlerVisuals::SetBackgroundColor</span></span>

<span data-ttu-id="a2007-198">Almacene este color y úselo durante la representación cuando desee proporcionar un color de fondo.</span><span class="sxs-lookup"><span data-stu-id="a2007-198">Store this color and use it during rendering when you want to provide a background color.</span></span> <span data-ttu-id="a2007-199">Por ejemplo, para rellenar la ventana cuando el controlador se representa en un área menor que el área proporcionada por [**IPreviewHandler:: SetWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-setwindow) y [**IPreviewHandler:: SetRect**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-setrect).</span><span class="sxs-lookup"><span data-stu-id="a2007-199">For instance, to fill the window when the handler renders to an area smaller than the area provided by [**IPreviewHandler::SetWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-setwindow) and [**IPreviewHandler::SetRect**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipreviewhandler-setrect).</span></span> <span data-ttu-id="a2007-200">Sin embargo, tenga en cuenta que no debe dibujar fuera del área proporcionada por esos métodos.</span><span class="sxs-lookup"><span data-stu-id="a2007-200">Note, however, that you should not draw outside the area provided by those methods.</span></span>

<span data-ttu-id="a2007-201">Si se llama a este método mientras ya se está representando la vista previa, la representación debe reiniciarse con este color de fondo.</span><span class="sxs-lookup"><span data-stu-id="a2007-201">If this method is called while the preview is already being rendered, the rendering should be restarted using this background color.</span></span>

### <a name="ipreviewhandlervisualssetfont"></a><span data-ttu-id="a2007-202">IPreviewHandlerVisuals:: SetFont</span><span class="sxs-lookup"><span data-stu-id="a2007-202">IPreviewHandlerVisuals::SetFont</span></span>

<span data-ttu-id="a2007-203">Almacene esta información de fuente y úsela durante la representación cuando desee mostrar texto coherente con la configuración actual de Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="a2007-203">Store this font information and use it during rendering when you want to display text consistent with the current Windows Vista settings.</span></span>

### <a name="ipreviewhandlervisualssettextcolor"></a><span data-ttu-id="a2007-204">IPreviewHandlerVisuals::SetTextColor</span><span class="sxs-lookup"><span data-stu-id="a2007-204">IPreviewHandlerVisuals::SetTextColor</span></span>

<span data-ttu-id="a2007-205">Almacene esta información de color del texto y úsela durante la representación cuando desee mostrar texto coherente con la configuración actual de Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="a2007-205">Store this text color information and use it during rendering when you want to display text consistent with the current Windows Vista settings.</span></span>

## <a name="related-topics"></a><span data-ttu-id="a2007-206">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="a2007-206">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a2007-207">Controladores de vista previa y host de vista previa de Shell</span><span class="sxs-lookup"><span data-stu-id="a2007-207">Preview Handlers and Shell Preview Host</span></span>](preview-handlers.md)
</dt> <dt>

[<span data-ttu-id="a2007-208">Cómo registrar un controlador de vista previa</span><span class="sxs-lookup"><span data-stu-id="a2007-208">How to Register a Preview Handler</span></span>](how-to-register-a-preview-handler.md)
</dt> <dt>

[<span data-ttu-id="a2007-209">Instrucciones de controlador de vista previa</span><span class="sxs-lookup"><span data-stu-id="a2007-209">Preview Handler Guidelines</span></span>](preview-handler-guidelines.md)
</dt> </dl>

 

 
