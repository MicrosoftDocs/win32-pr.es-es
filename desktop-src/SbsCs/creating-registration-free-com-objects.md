---
description: Los contextos de activación permiten usar objetos COM sin necesidad de que se registren.
ms.assetid: e6ec7b8b-8032-4dff-8f96-07ae3ffc286d
title: Crear Registration-Free objetos COM
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 70e377a04f44e6624294116b8274a8dcc1e82b8e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "105648469"
---
# <a name="creating-registration-free-com-objects"></a><span data-ttu-id="cf79d-103">Crear Registration-Free objetos COM</span><span class="sxs-lookup"><span data-stu-id="cf79d-103">Creating Registration-Free COM Objects</span></span>

<span data-ttu-id="cf79d-104">Los contextos de activación permiten usar objetos COM sin necesidad de que se registren.</span><span class="sxs-lookup"><span data-stu-id="cf79d-104">Activation contexts enable COM objects to be used without requiring that they be registered.</span></span> <span data-ttu-id="cf79d-105">Esto permite que la aplicación tenga varios componentes con funcionalidad diferente en función de su versión en lugar de la información del registro.</span><span class="sxs-lookup"><span data-stu-id="cf79d-105">This enables your application to have multiple components with different functionality based upon their version rather than their registry information.</span></span> <span data-ttu-id="cf79d-106">Varios componentes pueden exponer el mismo objeto COM con el mismo GUID, pero tienen una funcionalidad diferente en función de la versión.</span><span class="sxs-lookup"><span data-stu-id="cf79d-106">Multiple components can expose the same COM object with the same GUID but have different functionality based on the version.</span></span>

<span data-ttu-id="cf79d-107">Cuando una aplicación solicita un GUID de [**CLSIDFromProgID**](/windows/win32/api/combaseapi/nf-combaseapi-clsidfromprogid), com busca primero la asignación desde ProgID a CLSID en el contexto de activación activo.</span><span class="sxs-lookup"><span data-stu-id="cf79d-107">When an application requests a GUID from [**CLSIDFromProgID**](/windows/win32/api/combaseapi/nf-combaseapi-clsidfromprogid), COM first searches for the mapping from progid to CLSID in the active activation context.</span></span> <span data-ttu-id="cf79d-108">Cuando una aplicación usa [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) para obtener un puntero de interfaz de instancia, com busca en el contexto de activación activo para encontrar qué dll hospedará el CLSID.</span><span class="sxs-lookup"><span data-stu-id="cf79d-108">When an application uses [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) to obtain an instance interface pointer, COM searches in the active activation context to find which DLL will host the CLSID.</span></span> <span data-ttu-id="cf79d-109">Si el contexto de activación no contiene la información necesaria, COM busca la información en el registro con el método habitual.</span><span class="sxs-lookup"><span data-stu-id="cf79d-109">If the activation context does not contain the required information, COM then searches for the information in the registry using the usual method.</span></span>

<span data-ttu-id="cf79d-110">Tenga en cuenta que, dado que los contextos de activación son por subproceso, COM calcula las referencias del contexto de activación del subproceso de creación en el subproceso de host y lo activa antes de llamar a [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) o [**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) en el subproceso de host.</span><span class="sxs-lookup"><span data-stu-id="cf79d-110">Note that because activation contexts are per-thread, COM marshals the activation context of the creating thread over to the host thread and activates it before calling [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) or [**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) on the host thread.</span></span> <span data-ttu-id="cf79d-111">Esta funcionalidad ya está presente en Windows, no es necesario que el código de cliente haga nada para implementar esto.</span><span class="sxs-lookup"><span data-stu-id="cf79d-111">This functionality is already present in Windows, client code is not required to do anything to implement this.</span></span>

<span data-ttu-id="cf79d-112">Los componentes hospedados pueden exportar las clases COM sin pasar por el registro.</span><span class="sxs-lookup"><span data-stu-id="cf79d-112">COM classes can be exported by hosted components without going through the registry.</span></span> <span data-ttu-id="cf79d-113">Varios componentes pueden exponer el mismo ProgID para objetos COM diferentes y la aplicación de hospedaje solo debe encontrar el contexto de activación adecuado y, a continuación, usar [**CLSIDFromProgID**](/windows/win32/api/combaseapi/nf-combaseapi-clsidfromprogid) e [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) para obtener los punteros de interfaz del objeto hospedado.</span><span class="sxs-lookup"><span data-stu-id="cf79d-113">Multiple components can expose the same ProgID for different COM objects, and your hosting application should only find the proper activation context and then use [**CLSIDFromProgID**](/windows/win32/api/combaseapi/nf-combaseapi-clsidfromprogid) and [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) to get the hosted object's interface pointers.</span></span>

 

 
