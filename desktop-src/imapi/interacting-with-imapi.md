---
title: Interactuar con IMAPi
description: En los pasos siguientes se describe una interacción típica entre una aplicación y IMAPi.
ms.assetid: e57a86c4-7e27-40cf-a9c1-081b3f20d9d9
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3e68bee24cfe0724ed14d439b0789f5023338853
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/16/2019
ms.locfileid: "103994299"
---
# <a name="interacting-with-imapi"></a><span data-ttu-id="8062a-103">Interactuar con IMAPi</span><span class="sxs-lookup"><span data-stu-id="8062a-103">Interacting with IMAPI</span></span>

<span data-ttu-id="8062a-104">En los pasos siguientes se describe una interacción típica entre una aplicación y IMAPi.</span><span class="sxs-lookup"><span data-stu-id="8062a-104">The following steps describe a typical interaction between an application and IMAPI.</span></span>

1.  <span data-ttu-id="8062a-105">Cree una instancia de **MSDiscMasterObj** (mediante **CoCreateInstance**, punteros inteligentes a partir de una importación, etc.) y solicite la interfaz [**IDiscMaster**](/windows/desktop/api/Imapi/nn-imapi-idiscmaster) .</span><span class="sxs-lookup"><span data-stu-id="8062a-105">Create an instance of the **MSDiscMasterObj** (using **CoCreateInstance**, smart pointers from an import, and so on) and request the [**IDiscMaster**](/windows/desktop/api/Imapi/nn-imapi-idiscmaster) interface.</span></span>
2.  <span data-ttu-id="8062a-106">Obtenga acceso a IMAPi llamando a [**IDiscMaster:: Open**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-open).</span><span class="sxs-lookup"><span data-stu-id="8062a-106">Acquire access to IMAPI by calling [**IDiscMaster::Open**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-open).</span></span> <span data-ttu-id="8062a-107">Si esta llamada se realiza correctamente, la aplicación tiene acceso completo a todas las interfaces y métodos implementados en **MSDiscMasterObj**.</span><span class="sxs-lookup"><span data-stu-id="8062a-107">If this call succeeds, the application has full access to all the interfaces and methods implemented in **MSDiscMasterObj**.</span></span>
3.  <span data-ttu-id="8062a-108">Recupere el enumerador de formato del maestro de disco mediante [**EnumDiscMasterFormats**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-enumdiscmasterformats).</span><span class="sxs-lookup"><span data-stu-id="8062a-108">Retrieve the disc master format enumerator using [**EnumDiscMasterFormats**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-enumdiscmasterformats).</span></span> <span data-ttu-id="8062a-109">Enumere el conjunto de formatos que admite el objeto de maestro de disco y, a continuación, seleccione el formato activo.</span><span class="sxs-lookup"><span data-stu-id="8062a-109">Enumerate the set of formats that the disc master object supports, then select the active format.</span></span> <span data-ttu-id="8062a-110">Los formatos devueltos por el enumerador son los IID de las interfaces para [**IJolietDiscMaster**](/windows/desktop/api/Imapi/nn-imapi-ijolietdiscmaster) y [**IRedbookDiscMaster**](/windows/desktop/api/Imapi/nn-imapi-iredbookdiscmaster).</span><span class="sxs-lookup"><span data-stu-id="8062a-110">The formats returned from the enumerator are the IIDs of the interfaces for [**IJolietDiscMaster**](/windows/desktop/api/Imapi/nn-imapi-ijolietdiscmaster) and [**IRedbookDiscMaster**](/windows/desktop/api/Imapi/nn-imapi-iredbookdiscmaster).</span></span>
4.  <span data-ttu-id="8062a-111">Recupere el enumerador de grabadora de CD mediante [**EnumDiscRecorders**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-enumdiscrecorders).</span><span class="sxs-lookup"><span data-stu-id="8062a-111">Retrieve the disc recorder enumerator using [**EnumDiscRecorders**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-enumdiscrecorders).</span></span> <span data-ttu-id="8062a-112">Enumerar la lista de grabadores de disco compatibles (específicos del formato activo) y, a continuación, seleccione la grabadora activa.</span><span class="sxs-lookup"><span data-stu-id="8062a-112">Enumerate the list of supported disc recorders (specific to the active format), then select the active recorder.</span></span> <span data-ttu-id="8062a-113">La interfaz [**IDiscRecorder**](/windows/desktop/api/Imapi/nn-imapi-idiscrecorder) representa un dispositivo físico.</span><span class="sxs-lookup"><span data-stu-id="8062a-113">The [**IDiscRecorder**](/windows/desktop/api/Imapi/nn-imapi-idiscrecorder) interface represents a physical device.</span></span>
5.  <span data-ttu-id="8062a-114">Use [**IDiscMaster::P rogressadvise**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-progressadvise) para registrar las devoluciones de llamada de progreso.</span><span class="sxs-lookup"><span data-stu-id="8062a-114">Use [**IDiscMaster::ProgressAdvise**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-progressadvise) to register for progress callbacks.</span></span>
6.  <span data-ttu-id="8062a-115">Use la interfaz para el formato seleccionado para crear contenido.</span><span class="sxs-lookup"><span data-stu-id="8062a-115">Use the interface for the selected format to build up content.</span></span> <span data-ttu-id="8062a-116">El contenido se compila de forma incremental, por lo que las pistas o el contenido de la carpeta se pueden agregar a un disco por pieza.</span><span class="sxs-lookup"><span data-stu-id="8062a-116">Content builds incrementally, so tracks or folder contents can be added to a disc piece by piece.</span></span> <span data-ttu-id="8062a-117">La creación de este contenido se denomina *almacenamiento provisional de una imagen*.</span><span class="sxs-lookup"><span data-stu-id="8062a-117">Building up this content is called *staging an image*.</span></span> <span data-ttu-id="8062a-118">El contenido de la imagen almacenada provisionalmente no se puede eliminar de forma incremental (no se puede quitar una pista agregada), pero es posible borrar el contenido de una imagen almacenada provisionalmente para que se pueda volver a iniciar.</span><span class="sxs-lookup"><span data-stu-id="8062a-118">The contents of the staged image cannot be incrementally deleted (you cannot remove a track that has been added), but it is possible to clear the contents of a staged image so that staging can start again.</span></span> <span data-ttu-id="8062a-119">Use [**IDiscMaster:: ClearFormatContent**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-clearformatcontent) para reiniciar el almacenamiento provisional.</span><span class="sxs-lookup"><span data-stu-id="8062a-119">Use [**IDiscMaster::ClearFormatContent**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-clearformatcontent) to restart staging.</span></span>

<span data-ttu-id="8062a-120">**Para audio:  **</span><span class="sxs-lookup"><span data-stu-id="8062a-120">**For Audio:  **</span></span>

1.  <span data-ttu-id="8062a-121">Use [**IRedbookDiscMaster:: CreateAudioTrack**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-createaudiotrack) para indicar que se está iniciando una nueva pista de audio en el disco.</span><span class="sxs-lookup"><span data-stu-id="8062a-121">Use [**IRedbookDiscMaster::CreateAudioTrack**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-createaudiotrack) to indicate a new audio track is being started on the disc.</span></span>
2.  <span data-ttu-id="8062a-122">Use [**IRedbookDiscMaster:: AddAudioTrackBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-addaudiotrackblocks) para agregar datos de audio sin procesar a una pista. La aplicación puede usar [**GetAvailableAudioTrackBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-getavailableaudiotrackblocks), [**GetTotalAudioBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-gettotalaudioblocks)y [**GetUsedAudioBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-getusedaudioblocks) para recuperar información estadística.</span><span class="sxs-lookup"><span data-stu-id="8062a-122">Use [**IRedbookDiscMaster::AddAudioTrackBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-addaudiotrackblocks) to add raw audio data to a track. The application can use [**GetAvailableAudioTrackBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-getavailableaudiotrackblocks), [**GetTotalAudioBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-gettotalaudioblocks), and [**GetUsedAudioBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-getusedaudioblocks) to retrieve statistical information.</span></span>
3.  <span data-ttu-id="8062a-123">Use [**IRedbookDiscMaster:: CloseAudioTrack**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-closeaudiotrack) para cerrar una pista de audio.</span><span class="sxs-lookup"><span data-stu-id="8062a-123">Use [**IRedbookDiscMaster::CloseAudioTrack**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-closeaudiotrack) to close an audio track.</span></span>
4.  <span data-ttu-id="8062a-124">Repita los pasos del 1-3 hasta quedarse sin espacio o se hayan escrito todas las pistas de audio.</span><span class="sxs-lookup"><span data-stu-id="8062a-124">Repeat steps 1-3 until out of space or all audio tracks have been written.</span></span>

<span data-ttu-id="8062a-125">**Para datos:  **</span><span class="sxs-lookup"><span data-stu-id="8062a-125">**For Data:  **</span></span>

1.  <span data-ttu-id="8062a-126">Use [**IJolietDiscMaster:: AddData**](/windows/desktop/api/Imapi/nf-imapi-ijolietdiscmaster-adddata) para agregar el contenido de una carpeta a la imagen.</span><span class="sxs-lookup"><span data-stu-id="8062a-126">Use [**IJolietDiscMaster::AddData**](/windows/desktop/api/Imapi/nf-imapi-ijolietdiscmaster-adddata) to add the contents of a folder to the image.</span></span> <span data-ttu-id="8062a-127">Los elementos de una carpeta se colocan en la raíz del archivo de imagen.</span><span class="sxs-lookup"><span data-stu-id="8062a-127">The items within a folder are placed in the root of the image file.</span></span> <span data-ttu-id="8062a-128">Use [**GetTotalDataBlocks**](/windows/desktop/api/Imapi/nf-imapi-ijolietdiscmaster-gettotaldatablocks) y [**GetUsedDataBlocks**](/windows/desktop/api/Imapi/nf-imapi-ijolietdiscmaster-getuseddatablocks) para recuperar información estadística.</span><span class="sxs-lookup"><span data-stu-id="8062a-128">Use [**GetTotalDataBlocks**](/windows/desktop/api/Imapi/nf-imapi-ijolietdiscmaster-gettotaldatablocks) and [**GetUsedDataBlocks**](/windows/desktop/api/Imapi/nf-imapi-ijolietdiscmaster-getuseddatablocks) to retrieve statistical information.</span></span>
2.  <span data-ttu-id="8062a-129">Repita el paso anterior hasta que quede espacio insuficiente o se hayan agregado todos los datos.</span><span class="sxs-lookup"><span data-stu-id="8062a-129">Repeat the above step until out of space or all data has been added.</span></span>

<span data-ttu-id="8062a-130">**Para todos los discos:  **</span><span class="sxs-lookup"><span data-stu-id="8062a-130">**For All Discs:  **</span></span>

1.  <span data-ttu-id="8062a-131">Use [**IDiscMaster:: RecordDisc**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-recorddisc) para grabar el disco.</span><span class="sxs-lookup"><span data-stu-id="8062a-131">Use [**IDiscMaster::RecordDisc**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-recorddisc) to record the disc.</span></span>
2.  <span data-ttu-id="8062a-132">Cierre la sesión de IMAPi mediante [**IDiscMaster:: Close**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-close).</span><span class="sxs-lookup"><span data-stu-id="8062a-132">Close the IMAPI session using [**IDiscMaster::Close**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-close).</span></span> <span data-ttu-id="8062a-133">Al cerrar la sesión, se borra el contenido del espacio provisional del disco.</span><span class="sxs-lookup"><span data-stu-id="8062a-133">Closing the session clears the contents of the disc stash.</span></span>

 

 




