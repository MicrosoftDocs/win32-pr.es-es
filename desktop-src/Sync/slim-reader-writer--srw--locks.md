---
description: Los bloqueos finos de lector/escritor (SRW) permiten a los subprocesos de un único proceso tener acceso a recursos compartidos. están optimizadas para acelerar y ocupan muy poca memoria.
ms.assetid: 2d439b21-291f-4ff0-910a-c1c27e800019
title: Bloqueos SRW (bloqueos finos de lector/escritor)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fe7d76d956e1425531eae43b0daa6817002a92bc
ms.sourcegitcommit: 663239b4560bfd5314e86901c65805c9bbcab07d
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/15/2021
ms.locfileid: "105670041"
---
# <a name="slim-readerwriter-srw-locks"></a><span data-ttu-id="29524-103">Bloqueos SRW (bloqueos finos de lector/escritor)</span><span class="sxs-lookup"><span data-stu-id="29524-103">Slim Reader/Writer (SRW) Locks</span></span>

<span data-ttu-id="29524-104">Los bloqueos finos de lector/escritor (SRW) permiten a los subprocesos de un único proceso tener acceso a recursos compartidos. están optimizadas para acelerar y ocupan muy poca memoria.</span><span class="sxs-lookup"><span data-stu-id="29524-104">Slim reader/writer (SRW) locks enable the threads of a single process to access shared resources; they are optimized for speed and occupy very little memory.</span></span> <span data-ttu-id="29524-105">Los bloqueos ligeros de lectura y escritura no se pueden compartir entre los procesos.</span><span class="sxs-lookup"><span data-stu-id="29524-105">Slim reader-writer locks cannot be shared across processes.</span></span>

<span data-ttu-id="29524-106">Los subprocesos de lectura leen los datos de un recurso compartido, mientras que los subprocesos de escritura escriben datos en un recurso compartido.</span><span class="sxs-lookup"><span data-stu-id="29524-106">Reader threads read data from a shared resource whereas writer threads write data to a shared resource.</span></span> <span data-ttu-id="29524-107">Cuando varios subprocesos leen y escriben con un recurso compartido, los bloqueos exclusivos, como una sección crítica o una exclusión mutua, pueden convertirse en un cuello de botella si los subprocesos de lectura se ejecutan de forma continua pero las operaciones de escritura son poco frecuentes.</span><span class="sxs-lookup"><span data-stu-id="29524-107">When multiple threads are reading and writing using a shared resource, exclusive locks such as a critical section or mutex can become a bottleneck if the reader threads run continuously but write operations are rare.</span></span>

<span data-ttu-id="29524-108">Los bloqueos SRW proporcionan dos modos en los que los subprocesos pueden tener acceso a un recurso compartido:</span><span class="sxs-lookup"><span data-stu-id="29524-108">SRW locks provide two modes in which threads can access a shared resource:</span></span>

-   <span data-ttu-id="29524-109">**Modo compartido**, que concede acceso compartido de solo lectura a varios subprocesos de lectura, lo que les permite leer datos del recurso compartido simultáneamente.</span><span class="sxs-lookup"><span data-stu-id="29524-109">**Shared mode**, which grants shared read-only access to multiple reader threads, which enables them to read data from the shared resource concurrently.</span></span> <span data-ttu-id="29524-110">Si las operaciones de lectura superan las operaciones de escritura, esta simultaneidad aumenta el rendimiento y el rendimiento en comparación con las secciones críticas.</span><span class="sxs-lookup"><span data-stu-id="29524-110">If read operations exceed write operations, this concurrency increases performance and throughput compared to critical sections.</span></span>
    > [!NOTE]
    > <span data-ttu-id="29524-111">No se deben adquirir bloqueos SRW de modo compartido de forma recursiva, ya que esto puede provocar interbloqueos cuando se combinan con la adquisición exclusiva.</span><span class="sxs-lookup"><span data-stu-id="29524-111">Shared mode SRW locks should not be acquired recursively as this can lead to deadlocks when combined with exclusive acquisition.</span></span>

-   <span data-ttu-id="29524-112">**Modo exclusivo**, que concede acceso de lectura y escritura a un subproceso de escritura a la vez.</span><span class="sxs-lookup"><span data-stu-id="29524-112">**Exclusive mode**, which grants read/write access to one writer thread at a time.</span></span> <span data-ttu-id="29524-113">Cuando el bloqueo se ha adquirido en modo exclusivo, ningún otro subproceso puede tener acceso al recurso compartido hasta que el escritor libera el bloqueo.</span><span class="sxs-lookup"><span data-stu-id="29524-113">When the lock has been acquired in exclusive mode, no other thread can access the shared resource until the writer releases the lock.</span></span>
    > [!NOTE]
    > <span data-ttu-id="29524-114">No se pueden adquirir bloqueos SRW de modo exclusivo de forma recursiva.</span><span class="sxs-lookup"><span data-stu-id="29524-114">Exclusive mode SRW locks cannot be acquired recursively.</span></span> <span data-ttu-id="29524-115">Si un subproceso intenta adquirir un bloqueo que ya contiene, se producirá un error en el intento (por [**TryAcquireSRWLockExclusive**](/windows/win32/api/synchapi/nf-synchapi-tryacquiresrwlockexclusive)) o en el interbloqueo (para [**AcquireSRWLockExclusive**](/windows/win32/api/synchapi/nf-synchapi-acquiresrwlockexclusive)).</span><span class="sxs-lookup"><span data-stu-id="29524-115">If a thread tries to acquire a lock that it already holds, that attempt will fail (for [**TryAcquireSRWLockExclusive**](/windows/win32/api/synchapi/nf-synchapi-tryacquiresrwlockexclusive)) or deadlock (for [**AcquireSRWLockExclusive**](/windows/win32/api/synchapi/nf-synchapi-acquiresrwlockexclusive))</span></span>

<span data-ttu-id="29524-116">Se puede adquirir un bloqueo SRW único en cualquier modo; los subprocesos de lector pueden adquirirlo en modo compartido, mientras que los subprocesos de escritura pueden adquirirlo en modo exclusivo.</span><span class="sxs-lookup"><span data-stu-id="29524-116">A single SRW lock can be acquired in either mode; reader threads can acquire it in shared mode whereas writer threads can acquire it in exclusive mode.</span></span> <span data-ttu-id="29524-117">No hay ninguna garantía sobre el orden en el que los subprocesos que solicitan la propiedad se les concederá propiedad; Los bloqueos SRW no son equitativos ni FIFO.</span><span class="sxs-lookup"><span data-stu-id="29524-117">There is no guarantee about the order in which threads that request ownership will be granted ownership; SRW locks are neither fair nor FIFO.</span></span>

<span data-ttu-id="29524-118">Un bloqueo SRW es el tamaño de un puntero.</span><span class="sxs-lookup"><span data-stu-id="29524-118">An SRW lock is the size of a pointer.</span></span> <span data-ttu-id="29524-119">La ventaja es que es rápido actualizar el estado de bloqueo.</span><span class="sxs-lookup"><span data-stu-id="29524-119">The advantage is that it is fast to update the lock state.</span></span> <span data-ttu-id="29524-120">La desventaja es que se puede almacenar muy poca información de estado, de modo que los bloqueos SRW no detectan un uso recursivo incorrecto en el modo compartido.</span><span class="sxs-lookup"><span data-stu-id="29524-120">The disadvantage is that very little state information can be stored, so SRW locks do not detect incorrect recursive use in shared mode.</span></span> <span data-ttu-id="29524-121">Además, un subproceso que posee un bloqueo SRW en modo compartido no puede actualizar su propiedad del bloqueo al modo exclusivo.</span><span class="sxs-lookup"><span data-stu-id="29524-121">In addition, a thread that owns an SRW lock in shared mode cannot upgrade its ownership of the lock to exclusive mode.</span></span>

<span data-ttu-id="29524-122">El autor de la llamada debe asignar una estructura SRWLOCK e inicializarla mediante una llamada a [**InitializeSRWLock**](/windows/win32/api/synchapi/nf-synchapi-initializesrwlock) (para inicializar la estructura dinámicamente) o asignar la constante **SRWLOCK \_ init** a la variable de estructura (para inicializar la estructura estáticamente).</span><span class="sxs-lookup"><span data-stu-id="29524-122">The caller must allocate an SRWLOCK structure and initialize it by either calling [**InitializeSRWLock**](/windows/win32/api/synchapi/nf-synchapi-initializesrwlock) (to initialize the structure dynamically) or assign the constant **SRWLOCK\_INIT** to the structure variable (to initialize the structure statically).</span></span>

<span data-ttu-id="29524-123">Puede usar [Comprobador de aplicaciones](/windows-hardware/drivers/devtest/application-verifier) para buscar el uso recursivo (reentrante) de bloqueos SRW.</span><span class="sxs-lookup"><span data-stu-id="29524-123">You can use [Application Verifier](/windows-hardware/drivers/devtest/application-verifier) to find recursive (reentrant) use of SRW locks.</span></span>

<span data-ttu-id="29524-124">A continuación se indican las funciones de bloqueo SRW.</span><span class="sxs-lookup"><span data-stu-id="29524-124">The following are the SRW lock functions.</span></span>

| <span data-ttu-id="29524-125">SRW Lock (función)</span><span class="sxs-lookup"><span data-stu-id="29524-125">SRW lock function</span></span>                                                | <span data-ttu-id="29524-126">Descripción</span><span class="sxs-lookup"><span data-stu-id="29524-126">Description</span></span>                                                                                                                                       |
|------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="29524-127">**AcquireSRWLockExclusive**</span><span class="sxs-lookup"><span data-stu-id="29524-127">**AcquireSRWLockExclusive**</span></span>](/windows/win32/api/synchapi/nf-synchapi-acquiresrwlockexclusive)       | <span data-ttu-id="29524-128">Adquiere un bloqueo SRW en modo exclusivo.</span><span class="sxs-lookup"><span data-stu-id="29524-128">Acquires an SRW lock in exclusive mode.</span></span>                                                                                                           |
| [<span data-ttu-id="29524-129">**AcquireSRWLockShared**</span><span class="sxs-lookup"><span data-stu-id="29524-129">**AcquireSRWLockShared**</span></span>](/windows/win32/api/synchapi/nf-synchapi-acquiresrwlockshared)             | <span data-ttu-id="29524-130">Adquiere un bloqueo SRW en modo compartido.</span><span class="sxs-lookup"><span data-stu-id="29524-130">Acquires an SRW lock in shared mode.</span></span>                                                                                                              |
| [<span data-ttu-id="29524-131">**InitializeSRWLock**</span><span class="sxs-lookup"><span data-stu-id="29524-131">**InitializeSRWLock**</span></span>](/windows/win32/api/synchapi/nf-synchapi-initializesrwlock)                   | <span data-ttu-id="29524-132">Inicializa un bloqueo SRW.</span><span class="sxs-lookup"><span data-stu-id="29524-132">Initialize an SRW lock.</span></span>                                                                                                                           |
| [<span data-ttu-id="29524-133">**ReleaseSRWLockExclusive**</span><span class="sxs-lookup"><span data-stu-id="29524-133">**ReleaseSRWLockExclusive**</span></span>](/windows/win32/api/synchapi/nf-synchapi-releasesrwlockexclusive)       | <span data-ttu-id="29524-134">Libera un bloqueo SRW que se abrió en modo exclusivo.</span><span class="sxs-lookup"><span data-stu-id="29524-134">Releases an SRW lock that was opened in exclusive mode.</span></span>                                                                                           |
| [<span data-ttu-id="29524-135">**ReleaseSRWLockShared**</span><span class="sxs-lookup"><span data-stu-id="29524-135">**ReleaseSRWLockShared**</span></span>](/windows/win32/api/synchapi/nf-synchapi-releasesrwlockshared)             | <span data-ttu-id="29524-136">Libera un bloqueo SRW que se abrió en modo compartido.</span><span class="sxs-lookup"><span data-stu-id="29524-136">Releases an SRW lock that was opened in shared mode.</span></span>                                                                                              |
| [<span data-ttu-id="29524-137">**SleepConditionVariableSRW**</span><span class="sxs-lookup"><span data-stu-id="29524-137">**SleepConditionVariableSRW**</span></span>](/windows/win32/api/synchapi/nf-synchapi-sleepconditionvariablesrw)   | <span data-ttu-id="29524-138">Suspende en la variable de condición especificada y libera el bloqueo especificado como una operación atómica.</span><span class="sxs-lookup"><span data-stu-id="29524-138">Sleeps on the specified condition variable and releases the specified lock as an atomic operation.</span></span>                                                |
| [<span data-ttu-id="29524-139">**TryAcquireSRWLockExclusive**</span><span class="sxs-lookup"><span data-stu-id="29524-139">**TryAcquireSRWLockExclusive**</span></span>](/windows/win32/api/synchapi/nf-synchapi-tryacquiresrwlockexclusive) | <span data-ttu-id="29524-140">Intenta adquirir un bloqueo delgado de lector/escritor (SRW) en modo exclusivo.</span><span class="sxs-lookup"><span data-stu-id="29524-140">Attempts to acquire a slim reader/writer (SRW) lock in exclusive mode.</span></span> <span data-ttu-id="29524-141">Si la llamada se realiza correctamente, el subproceso que realiza la llamada toma la propiedad del bloqueo.</span><span class="sxs-lookup"><span data-stu-id="29524-141">If the call is successful, the calling thread takes ownership of the lock.</span></span> |
| [<span data-ttu-id="29524-142">**TryAcquireSRWLockShared**</span><span class="sxs-lookup"><span data-stu-id="29524-142">**TryAcquireSRWLockShared**</span></span>](/windows/win32/api/synchapi/nf-synchapi-tryacquiresrwlockshared)       | <span data-ttu-id="29524-143">Intenta adquirir un bloqueo delgado de lector/escritor (SRW) en modo compartido.</span><span class="sxs-lookup"><span data-stu-id="29524-143">Attempts to acquire a slim reader/writer (SRW) lock in shared mode.</span></span> <span data-ttu-id="29524-144">Si la llamada se realiza correctamente, el subproceso que realiza la llamada toma la propiedad del bloqueo.</span><span class="sxs-lookup"><span data-stu-id="29524-144">If the call is successful, the calling thread takes ownership of the lock.</span></span>    |

 
