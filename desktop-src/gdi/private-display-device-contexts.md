---
description: Un contexto de dispositivo privado permite a una aplicación evitar la recuperación y la inicialización de un contexto de dispositivo de pantalla cada vez que la aplicación debe dibujarse en una ventana.
ms.assetid: 8de5a14b-a8b3-42a5-81f3-bf3c357052cb
title: Contextos de dispositivo de pantalla privada
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 451dbd3c0a232610026740d0ea0fa817ea2034b8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104544406"
---
# <a name="private-display-device-contexts"></a><span data-ttu-id="b44a5-103">Contextos de dispositivo de pantalla privada</span><span class="sxs-lookup"><span data-stu-id="b44a5-103">Private Display Device Contexts</span></span>

<span data-ttu-id="b44a5-104">Un *contexto de dispositivo privado* permite a una aplicación evitar la recuperación y la inicialización de un contexto de dispositivo de pantalla cada vez que la aplicación debe dibujarse en una ventana.</span><span class="sxs-lookup"><span data-stu-id="b44a5-104">A *private device context* enables an application to avoid retrieving and initializing a display device context each time the application must draw in a window.</span></span> <span data-ttu-id="b44a5-105">Los contextos de dispositivo privados son útiles para las ventanas que requieren muchos cambios en los valores de los atributos del contexto del dispositivo para prepararlos para el dibujo.</span><span class="sxs-lookup"><span data-stu-id="b44a5-105">Private device contexts are useful for windows that require many changes to the values of the attributes of the device context to prepare it for drawing.</span></span> <span data-ttu-id="b44a5-106">Los contextos de dispositivo privados reducen el tiempo necesario para preparar el contexto del dispositivo y, por lo tanto, el tiempo necesario para realizar el dibujo en la ventana.</span><span class="sxs-lookup"><span data-stu-id="b44a5-106">Private device contexts reduce the time required to prepare the device context and therefore the time needed to carry out drawing in the window.</span></span>

<span data-ttu-id="b44a5-107">Una aplicación dirige el sistema para crear un contexto de dispositivo privado para una ventana especificando el estilo CS \_ OWNDC en la clase Window.</span><span class="sxs-lookup"><span data-stu-id="b44a5-107">An application directs the system to create a private device context for a window by specifying the CS\_OWNDC style in the window class.</span></span> <span data-ttu-id="b44a5-108">El sistema crea un contexto de dispositivo privado único cada vez que crea una nueva ventana que pertenece a la clase.</span><span class="sxs-lookup"><span data-stu-id="b44a5-108">The system creates a unique private device context each time it creates a new window belonging to the class.</span></span> <span data-ttu-id="b44a5-109">Inicialmente, el contexto de dispositivo privado tiene los mismos valores predeterminados para los atributos que un contexto de dispositivo común, pero la aplicación puede modificarlos en cualquier momento.</span><span class="sxs-lookup"><span data-stu-id="b44a5-109">Initially, the private device context has the same default values for attributes as a common device context, but the application can modify these at any time.</span></span> <span data-ttu-id="b44a5-110">El sistema conserva los cambios en el contexto de dispositivo durante la vida de la ventana o hasta que la aplicación realiza cambios adicionales.</span><span class="sxs-lookup"><span data-stu-id="b44a5-110">The system preserves changes to the device context for the life of the window or until the application makes additional changes.</span></span>

<span data-ttu-id="b44a5-111">Una aplicación puede recuperar un identificador para el contexto de dispositivo privado mediante la función [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) en cualquier momento después de crear la ventana.</span><span class="sxs-lookup"><span data-stu-id="b44a5-111">An application can retrieve a handle to the private device context by using the [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) function any time after the window is created.</span></span> <span data-ttu-id="b44a5-112">La aplicación debe recuperar el identificador una sola vez.</span><span class="sxs-lookup"><span data-stu-id="b44a5-112">The application must retrieve the handle only once.</span></span> <span data-ttu-id="b44a5-113">A partir de ese momento, puede mantener y usar el identificador cualquier número de veces.</span><span class="sxs-lookup"><span data-stu-id="b44a5-113">Thereafter, it can keep and use the handle any number of times.</span></span> <span data-ttu-id="b44a5-114">Dado que un contexto de dispositivo privado no forma parte de la memoria caché de contexto de dispositivo de pantalla, una aplicación no necesita liberar nunca el contexto de dispositivo mediante la función [**ReleaseDC**](/windows/desktop/api/Winuser/nf-winuser-releasedc) .</span><span class="sxs-lookup"><span data-stu-id="b44a5-114">Because a private device context is not part of the display device context cache, an application need never release the device context by using the [**ReleaseDC**](/windows/desktop/api/Winuser/nf-winuser-releasedc) function.</span></span>

<span data-ttu-id="b44a5-115">El sistema ajusta automáticamente el contexto de dispositivo para reflejar los cambios en la ventana, como mover o cambiar el tamaño.</span><span class="sxs-lookup"><span data-stu-id="b44a5-115">The system automatically adjusts the device context to reflect changes to the window, such as moving or sizing.</span></span> <span data-ttu-id="b44a5-116">Esto garantiza que todas las ventanas superpuestas siempre se recortan correctamente; es decir, la aplicación no requiere ninguna acción para garantizar el recorte.</span><span class="sxs-lookup"><span data-stu-id="b44a5-116">This ensures that any overlapping windows are always properly clipped; that is, no action is required by the application to ensure clipping.</span></span> <span data-ttu-id="b44a5-117">Sin embargo, el sistema no revisa el contexto del dispositivo para incluir la región de actualización.</span><span class="sxs-lookup"><span data-stu-id="b44a5-117">However, the system does not revise the device context to include the update region.</span></span> <span data-ttu-id="b44a5-118">Por lo tanto, al procesar un mensaje de [**\_ dibujo de WM**](wm-paint.md) , la aplicación debe incorporar la región de actualización mediante una llamada a [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) o mediante la recuperación de la región de actualización y la intersección con la región de recorte actual.</span><span class="sxs-lookup"><span data-stu-id="b44a5-118">Therefore, when processing a [**WM\_PAINT**](wm-paint.md) message, the application must incorporate the update region either by calling [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) or by retrieving the update region and intersecting it with the current clipping region.</span></span> <span data-ttu-id="b44a5-119">Si la aplicación no llama a **BeginPaint**, debe validar explícitamente la región de actualización mediante el uso de la función [**ValidateRect**](/windows/desktop/api/Winuser/nf-winuser-validaterect) o [**ValidateRgn**](/windows/desktop/api/Winuser/nf-winuser-validatergn) .</span><span class="sxs-lookup"><span data-stu-id="b44a5-119">If the application does not call **BeginPaint**, it must explicitly validate the update region by using the [**ValidateRect**](/windows/desktop/api/Winuser/nf-winuser-validaterect) or [**ValidateRgn**](/windows/desktop/api/Winuser/nf-winuser-validatergn) function.</span></span> <span data-ttu-id="b44a5-120">Si la aplicación no valida la región de actualización, la ventana recibe una serie infinita de mensajes de **\_ dibujo de WM** .</span><span class="sxs-lookup"><span data-stu-id="b44a5-120">If the application does not validate the update region, the window receives an endless series of **WM\_PAINT** messages.</span></span>

<span data-ttu-id="b44a5-121">Dado que [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) oculta el símbolo de intercalación si se muestra una ventana, una aplicación que llama a **BeginPaint** también debe llamar a la función [**EndPaint**](/windows/desktop/api/Winuser/nf-winuser-endpaint) para restaurar el símbolo de intercalación.</span><span class="sxs-lookup"><span data-stu-id="b44a5-121">Because [**BeginPaint**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) hides the caret if a window is showing it, an application that calls **BeginPaint** should also call the [**EndPaint**](/windows/desktop/api/Winuser/nf-winuser-endpaint) function to restore the caret.</span></span> <span data-ttu-id="b44a5-122">**EndPaint** no tiene ningún efecto en un contexto de dispositivo privado.</span><span class="sxs-lookup"><span data-stu-id="b44a5-122">**EndPaint** has no other effect on a private device context.</span></span>

<span data-ttu-id="b44a5-123">Aunque es conveniente usar un contexto de dispositivo privado, el uso de memoria es intensivo en cuanto a recursos del sistema, lo que requiere que se almacenen 800 o más bytes.</span><span class="sxs-lookup"><span data-stu-id="b44a5-123">Although a private device context is convenient to use, it is memory-intensive in terms of system resources, requiring 800 or more bytes to store.</span></span> <span data-ttu-id="b44a5-124">Los contextos de dispositivo privados se recomiendan cuando las consideraciones de rendimiento superan los costos de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="b44a5-124">Private device contexts are recommended when performance considerations outweigh storage costs.</span></span>

<span data-ttu-id="b44a5-125">El sistema incluye el contexto de dispositivo privado al enviar el mensaje de [**\_ ERASEBKGND de WM**](../winmsg/wm-erasebkgnd.md) a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b44a5-125">The system includes the private device context when sending the [**WM\_ERASEBKGND**](../winmsg/wm-erasebkgnd.md) message to the application.</span></span> <span data-ttu-id="b44a5-126">Las selecciones actuales del contexto de dispositivo privado, incluido el modo de asignación, están en vigor cuando la aplicación o el sistema procesa estos mensajes.</span><span class="sxs-lookup"><span data-stu-id="b44a5-126">The current selections of the private device context, including mapping mode, are in effect when the application or the system processes these messages.</span></span> <span data-ttu-id="b44a5-127">Para evitar efectos no deseados, el sistema utiliza coordenadas lógicas al borrar el fondo; por ejemplo, usa la función [**GetClipBox**](/windows/desktop/api/Wingdi/nf-wingdi-getclipbox) para recuperar las coordenadas lógicas del área que se va a borrar y pasa estas coordenadas a la función [**FillRect**](/windows/desktop/api/Winuser/nf-winuser-fillrect) .</span><span class="sxs-lookup"><span data-stu-id="b44a5-127">To avoid undesirable effects, the system uses logical coordinates when erasing the background; for example, it uses the [**GetClipBox**](/windows/desktop/api/Wingdi/nf-wingdi-getclipbox) function to retrieve the logical coordinates of the area to erase and passes these coordinates to the [**FillRect**](/windows/desktop/api/Winuser/nf-winuser-fillrect) function.</span></span> <span data-ttu-id="b44a5-128">Las aplicaciones que procesan estos mensajes pueden utilizar técnicas similares.</span><span class="sxs-lookup"><span data-stu-id="b44a5-128">Applications that process these messages can use similar techniques.</span></span>

<span data-ttu-id="b44a5-129">Una aplicación puede usar la función [**GetDCEx**](/windows/desktop/api/Winuser/nf-winuser-getdcex) para obligar al sistema a devolver un contexto de dispositivo común para la ventana que tiene un contexto de dispositivo privado.</span><span class="sxs-lookup"><span data-stu-id="b44a5-129">An application can use the [**GetDCEx**](/windows/desktop/api/Winuser/nf-winuser-getdcex) function to force the system to return a common device context for the window that has a private device context.</span></span> <span data-ttu-id="b44a5-130">Esto resulta útil para llevar a cabo un toque rápido en una ventana sin cambiar los valores actuales de los atributos del contexto de dispositivo privado.</span><span class="sxs-lookup"><span data-stu-id="b44a5-130">This is useful for carrying out quick touch-ups to a window without changing the current values of the attributes of the private device context.</span></span>

 

 
