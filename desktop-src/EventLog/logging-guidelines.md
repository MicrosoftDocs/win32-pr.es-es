---
description: Los registros de eventos almacenan registros de eventos importantes en nombre del sistema y de las aplicaciones que se ejecutan en el sistema.
ms.assetid: 58a6569a-2775-4687-bf99-579fa4153191
title: Instrucciones de registro
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c1210757a7961d82d13d4887e40fbd3837b86138
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104156161"
---
# <a name="logging-guidelines"></a><span data-ttu-id="53ca8-103">Instrucciones de registro</span><span class="sxs-lookup"><span data-stu-id="53ca8-103">Logging Guidelines</span></span>

<span data-ttu-id="53ca8-104">Los registros de eventos almacenan registros de eventos importantes en nombre del sistema y de las aplicaciones que se ejecutan en el sistema.</span><span class="sxs-lookup"><span data-stu-id="53ca8-104">Event logs store records of significant events on behalf of the system and applications running on the system.</span></span> <span data-ttu-id="53ca8-105">Dado que las funciones de registro son de uso general, debe decidir qué información es adecuada para el registro.</span><span class="sxs-lookup"><span data-stu-id="53ca8-105">Because the logging functions are general purpose, you must decide what information is appropriate to log.</span></span> <span data-ttu-id="53ca8-106">Por lo general, solo debe registrar información que pueda ser útil para diagnosticar un problema de hardware o software.</span><span class="sxs-lookup"><span data-stu-id="53ca8-106">Generally, you should log only information that could be useful in diagnosing a hardware or software problem.</span></span> <span data-ttu-id="53ca8-107">El registro de eventos no está diseñado para usarse como herramienta de seguimiento.</span><span class="sxs-lookup"><span data-stu-id="53ca8-107">Event logging is not intended to be used as a tracing tool.</span></span>

## <a name="choosing-events-to-log"></a><span data-ttu-id="53ca8-108">Elegir eventos para registrar</span><span class="sxs-lookup"><span data-stu-id="53ca8-108">Choosing Events to Log</span></span>

<span data-ttu-id="53ca8-109">A continuación se muestran ejemplos de casos en los que el registro de eventos puede ser útil:</span><span class="sxs-lookup"><span data-stu-id="53ca8-109">The following are examples of cases in which event logging can be helpful:</span></span>

-   <span data-ttu-id="53ca8-110">Problemas de recursos.</span><span class="sxs-lookup"><span data-stu-id="53ca8-110">Resource problems.</span></span> <span data-ttu-id="53ca8-111">El registro de un evento de advertencia cuando se produce un error en la asignación de memoria puede ayudar a indicar la causa de una situación de memoria insuficiente.</span><span class="sxs-lookup"><span data-stu-id="53ca8-111">Logging a Warning event when memory allocation fails can help indicate the cause of a low-memory situation.</span></span>
-   <span data-ttu-id="53ca8-112">Problemas de hardware.</span><span class="sxs-lookup"><span data-stu-id="53ca8-112">Hardware problems.</span></span> <span data-ttu-id="53ca8-113">Si un controlador de dispositivo detecta un tiempo de espera de controlador de disco, un error de alimentación en un puerto paralelo o un error de datos de una tarjeta de red o serie, el controlador de dispositivo puede registrar información acerca de estos eventos para ayudar al administrador del sistema a diagnosticar problemas de hardware.</span><span class="sxs-lookup"><span data-stu-id="53ca8-113">If a device driver encounters a disk controller time-out, a power failure in a parallel port, or a data error from a network or serial card, the device driver can log information about these events to help the system administrator diagnose hardware problems.</span></span>
-   <span data-ttu-id="53ca8-114">Sectores dañados.</span><span class="sxs-lookup"><span data-stu-id="53ca8-114">Bad sectors.</span></span> <span data-ttu-id="53ca8-115">Si un controlador de disco detecta un sector no válido, es posible que pueda leer o escribir en el sector después de volver a intentar la operación, pero el sector dejará de ser correcto.</span><span class="sxs-lookup"><span data-stu-id="53ca8-115">If a disk driver encounters a bad sector, it may be able to read from or write to the sector after retrying the operation, but the sector will go bad eventually.</span></span> <span data-ttu-id="53ca8-116">Si el controlador de disco puede continuar, debe registrar un evento de advertencia. de lo contrario, debe registrar un evento de error.</span><span class="sxs-lookup"><span data-stu-id="53ca8-116">If the disk driver can proceed, it should log a Warning event; otherwise, it should log an Error event.</span></span> <span data-ttu-id="53ca8-117">Si un controlador del sistema de archivos encuentra un gran número de sectores dañados y los corrige, el registro de eventos de advertencia puede ayudar a que un Administrador determine que el disco puede estar a punto de producir un error.</span><span class="sxs-lookup"><span data-stu-id="53ca8-117">If a file system driver finds a large number of bad sectors and fixes them, logging Warning events might help an administrator determine that the disk may be about to fail.</span></span>
-   <span data-ttu-id="53ca8-118">Eventos de información.</span><span class="sxs-lookup"><span data-stu-id="53ca8-118">Information events.</span></span> <span data-ttu-id="53ca8-119">Una aplicación de servidor (por ejemplo, un servidor de base de datos) registra un usuario que inicia sesión, abre una base de datos o inicia una transferencia de archivos.</span><span class="sxs-lookup"><span data-stu-id="53ca8-119">A server application (such as a database server) records a user logging on, opening a database, or starting a file transfer.</span></span> <span data-ttu-id="53ca8-120">El servidor también puede registrar otros eventos, como errores (no puede tener acceso al archivo, el proceso de host está desconectado, etc.), daños en la base de datos o si una transferencia de archivos se realizó correctamente.</span><span class="sxs-lookup"><span data-stu-id="53ca8-120">The server can also log other events such as errors (cannot access file, host process disconnected, and so on), database corruption, or whether a file transfer was successful.</span></span>

## <a name="writing-messages"></a><span data-ttu-id="53ca8-121">Escribir los mensajes</span><span class="sxs-lookup"><span data-stu-id="53ca8-121">Writing Messages</span></span>

<span data-ttu-id="53ca8-122">Los mensajes deben tener sentido para los administradores y los usuarios que intentan solucionar un problema.</span><span class="sxs-lookup"><span data-stu-id="53ca8-122">Messages should make sense to administrators and users who are trying to troubleshoot a problem.</span></span> <span data-ttu-id="53ca8-123">Un mensaje debe contener toda la información necesaria para comprender la causa del problema y cómo corregirlo.</span><span class="sxs-lookup"><span data-stu-id="53ca8-123">A message should contain all the information needed to understand what caused the problem and how to correct it.</span></span>

<span data-ttu-id="53ca8-124">Evite escribir un mensaje críptico como "un paquete de controladores recibido del subsistema de e/s no era válido.</span><span class="sxs-lookup"><span data-stu-id="53ca8-124">Avoid writing a cryptic message such as "A driver packet received from the I/O subsystem was invalid.</span></span> <span data-ttu-id="53ca8-125">Los datos son el paquete. " Un mensaje mejor indicaría que el controlador en cuestión funciona correctamente, pero está registrando paquetes con formato incorrecto.</span><span class="sxs-lookup"><span data-stu-id="53ca8-125">The data is the packet."A better message would indicate that the driver in question is functioning properly, but is logging incorrectly formatted packets.</span></span> <span data-ttu-id="53ca8-126">Podría indicar que se necesita una versión Unicode del controlador para corregir el problema.</span><span class="sxs-lookup"><span data-stu-id="53ca8-126">It could go on to say that a Unicode version of the driver is needed to correct the problem.</span></span> <span data-ttu-id="53ca8-127">Para obtener más información sobre la escritura de mensajes de error correctos, vea instrucciones sobre los [mensajes de error](/windows/desktop/Debug/error-message-guidelines).</span><span class="sxs-lookup"><span data-stu-id="53ca8-127">For more information about writing good error messages, see [Error Message Guidelines](/windows/desktop/Debug/error-message-guidelines).</span></span>

<span data-ttu-id="53ca8-128">No use tabulaciones ni comas en el texto del mensaje, ya que los registros de eventos se pueden guardar como archivos de texto separados por comas o por tabulaciones.</span><span class="sxs-lookup"><span data-stu-id="53ca8-128">Do not use tabs or commas in the message text, because event logs can be saved as comma or tab-separated text files.</span></span> <span data-ttu-id="53ca8-129">Muchas organizaciones importan estos archivos en las bases de datos y los caracteres de formato adicionales requerirán manipulación manual.</span><span class="sxs-lookup"><span data-stu-id="53ca8-129">Many organizations import these files into databases, and the extra formatting characters will require manual manipulation.</span></span>

<span data-ttu-id="53ca8-130">Al utilizar nombres UNC u otros vínculos que contengan espacios, incluya el nombre entre corchetes angulares.</span><span class="sxs-lookup"><span data-stu-id="53ca8-130">When using UNC names, or other links that contain spaces, enclose the name in angle brackets.</span></span> <span data-ttu-id="53ca8-131">Por ejemplo, <\\ \\ *ShareName* \\ *ServerName*>.</span><span class="sxs-lookup"><span data-stu-id="53ca8-131">For example, <\\\\*sharename*\\*servername*>.</span></span> <span data-ttu-id="53ca8-132">Puede escribir una dirección URL al final del mensaje que dirige al usuario al material de ayuda relacionado.</span><span class="sxs-lookup"><span data-stu-id="53ca8-132">You can write a URL to the end of the message that points the user to related help material.</span></span> <span data-ttu-id="53ca8-133">La dirección URL debe ser un nombre de host DNS completo.</span><span class="sxs-lookup"><span data-stu-id="53ca8-133">The URL must be a fully qualified DNS host name.</span></span> <span data-ttu-id="53ca8-134">Por ejemplo, puede anexar el siguiente texto a los mensajes: "para obtener información adicional sobre este mensaje, visite el sitio de soporte técnico en https://www.microsoft.com/Support/ProdRedirect/ContentSearch.asp ".</span><span class="sxs-lookup"><span data-stu-id="53ca8-134">For example, you could append the following text to your messages: "For additional information on this message, please visit our support site at https://www.microsoft.com/Support/ProdRedirect/ContentSearch.asp."</span></span> <span data-ttu-id="53ca8-135">El vínculo conduce a una página ASP que redirige al usuario al contenido relacionado con el mensaje de error.</span><span class="sxs-lookup"><span data-stu-id="53ca8-135">The link would lead to an ASP page that redirects the user to content relating to the error message.</span></span> <span data-ttu-id="53ca8-136">Analizaría parámetros adicionales (que se pasaron al hacer clic en la dirección URL) para determinar dónde redirigir al usuario.</span><span class="sxs-lookup"><span data-stu-id="53ca8-136">It would parse additional parameters (passed when the URL is clicked) to determine where to redirect the user.</span></span>

<span data-ttu-id="53ca8-137">Los argumentos que se pasan a la función [**ReportEvent**](/windows/desktop/api/Winbase/nf-winbase-reporteventa) se anexan a la dirección URL de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="53ca8-137">The arguments passed to the [**ReportEvent**](/windows/desktop/api/Winbase/nf-winbase-reporteventa) function are appended to the URL as follows:</span></span>

``` syntax
strHTTPQuery += L"?EvtSrc=" + _strEscapedSource;
strHTTPQuery += L"&EvtCat=" + _strEscapedCategory;
strHTTPQuery += L"&EvtID=" + _strEscapedEventID;
strHTTPQuery += L"&EvtCatID=" + _strEscapedCategoryID;
strHTTPQuery += L"&EvtType=" + _strEscapedType;
strHTTPQuery += L"&EvtTypeID=" + _strEscapedTypeID;
strHTTPQuery += L"&EvtRptTime=" + _strEscapedDateAndTime;
strHTTPQuery += L"&EvtTZBias=" + _strEscapedTimeZoneBias;
```

<span data-ttu-id="53ca8-138">Si el nombre de la compañía, el nombre del producto, la versión del producto, el nombre de archivo y la versión del archivo del encabezado DLL del mensaje son válidos, también se anexan a la dirección URL:</span><span class="sxs-lookup"><span data-stu-id="53ca8-138">If the company name, product name, product version, file name, and file version from the message DLL header for the event source are valid, they are also appended to the URL:</span></span>

``` syntax
ADD_VER_STR(L"CoName",   _strEscapedCompanyName);
ADD_VER_STR(L"ProdName", _strEscapedProductName);
ADD_VER_STR(L"ProdVer",  _strEscapedProductVersion);
ADD_VER_STR(L"FileName", _strEscapedFileName);
ADD_VER_STR(L"FileVer",  _strEscapedFileVersion);
```

## <a name="reducing-overhead"></a><span data-ttu-id="53ca8-139">Reducción de la sobrecarga</span><span class="sxs-lookup"><span data-stu-id="53ca8-139">Reducing Overhead</span></span>

<span data-ttu-id="53ca8-140">El registro de eventos consume recursos como el espacio en disco y el tiempo de procesador.</span><span class="sxs-lookup"><span data-stu-id="53ca8-140">Event logging consumes resources such as disk space and processor time.</span></span> <span data-ttu-id="53ca8-141">La cantidad de espacio en disco que requiere un registro de eventos y la sobrecarga de una aplicación que registra eventos dependen de la cantidad de información que decida registrar.</span><span class="sxs-lookup"><span data-stu-id="53ca8-141">The amount of disk space that an event log requires and the overhead for an application that logs events depend on how much information you choose to log.</span></span> <span data-ttu-id="53ca8-142">Esta es la razón por la que es importante registrar solo la información esencial.</span><span class="sxs-lookup"><span data-stu-id="53ca8-142">This is why it is important to log only essential information.</span></span> <span data-ttu-id="53ca8-143">También es conveniente colocar las llamadas de registro de eventos en una ruta de acceso de error en el código en lugar de en la ruta de acceso del código principal, lo que reduciría el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="53ca8-143">It is also good to place event logging calls in an error path in the code rather than in the main code path, which would reduce performance.</span></span>

<span data-ttu-id="53ca8-144">La cantidad de espacio en disco necesario para cada entrada del registro de eventos incluye los miembros de la estructura [**EVENTLOGRECORD**](/windows/desktop/api/Winnt/ns-winnt-eventlogrecord) .</span><span class="sxs-lookup"><span data-stu-id="53ca8-144">The amount of disk space required for each event log record includes the members of the [**EVENTLOGRECORD**](/windows/desktop/api/Winnt/ns-winnt-eventlogrecord) structure.</span></span> <span data-ttu-id="53ca8-145">Se trata de una estructura de longitud variable; las cadenas y los datos binarios se almacenan después de la estructura.</span><span class="sxs-lookup"><span data-stu-id="53ca8-145">This is a variable length structure; strings and binary data are stored following the structure.</span></span>

 

 
