---
description: Sesión multimedia de PMP
ms.assetid: CF3A427D-31D2-45FF-BE87-F192B758204E
title: Sesión multimedia de PMP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: abf2cb1ff173d6fd085f6e98dd4608c84ff40200
ms.sourcegitcommit: 95685061d5b0333bbf9e6ebd208dde8190f97005
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/28/2021
ms.locfileid: "108092723"
---
# <a name="pmp-media-session"></a><span data-ttu-id="5dafe-103">Sesión multimedia de PMP</span><span class="sxs-lookup"><span data-stu-id="5dafe-103">PMP Media Session</span></span>

<span data-ttu-id="5dafe-104">Una aplicación puede crear la [sesión multimedia en](media-session.md) un proceso independiente denominado proceso de ruta [de](protected-media-path.md) acceso multimedia protegida (PMP).</span><span class="sxs-lookup"><span data-stu-id="5dafe-104">An application can create the [Media Session](media-session.md) in a separate process called the [Protected Media Path](protected-media-path.md) (PMP) process.</span></span> <span data-ttu-id="5dafe-105">El propósito principal del proceso de PMP es habilitar la reproducción de contenido protegido mediante la administración de derechos digitales (DRM).</span><span class="sxs-lookup"><span data-stu-id="5dafe-105">The main purpose of the PMP process is to enable playback of protected content using digital rights management (DRM).</span></span> <span data-ttu-id="5dafe-106">De forma predeterminada, el proceso PMP se crea dentro de un entorno protegido (PE).</span><span class="sxs-lookup"><span data-stu-id="5dafe-106">By default, the PMP process is created inside a Protected Environment (PE).</span></span> <span data-ttu-id="5dafe-107">Solo se pueden cargar componentes firmados de confianza dentro de un PE.</span><span class="sxs-lookup"><span data-stu-id="5dafe-107">Only trusted, signed components can be loaded inside a PE.</span></span> <span data-ttu-id="5dafe-108">Una ventaja secundaria del proceso de PMP es que aísla el proceso de aplicación de la canalización multimedia.</span><span class="sxs-lookup"><span data-stu-id="5dafe-108">A secondary benefit of the PMP process is that it isolates the application process from the media pipeline.</span></span> <span data-ttu-id="5dafe-109">Para obtener más información sobre el proceso de PMP, vea [Protected Media Path](protected-media-path.md).</span><span class="sxs-lookup"><span data-stu-id="5dafe-109">For more information about the PMP process, see [Protected Media Path](protected-media-path.md).</span></span>

<span data-ttu-id="5dafe-110">Para crear la sesión multimedia dentro del proceso PMP, llame a la [**función MFCreatePMPMediaSession.**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession)</span><span class="sxs-lookup"><span data-stu-id="5dafe-110">To create the Media Session inside the PMP process, call the [**MFCreatePMPMediaSession**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession) function.</span></span> <span data-ttu-id="5dafe-111">Opcionalmente, puede pasar la marca **MFPMPSESSION \_ UNPROTECTED \_ PROCESS.**</span><span class="sxs-lookup"><span data-stu-id="5dafe-111">Optionally, you can pass in the **MFPMPSESSION\_UNPROTECTED\_PROCESS** flag.</span></span> <span data-ttu-id="5dafe-112">Si se establece esta marca, el proceso PMP se crea dentro de un proceso no protegido y no en un proceso PE.</span><span class="sxs-lookup"><span data-stu-id="5dafe-112">If this flag is set, the PMP process is created inside an unprotected process, and not a PE process.</span></span> <span data-ttu-id="5dafe-113">El proceso no protegido no se puede usar para la reproducción drm, pero proporciona las ventajas del aislamiento de procesos.</span><span class="sxs-lookup"><span data-stu-id="5dafe-113">The unprotected process cannot be used for DRM playback, but does give you the benefits of process isolation.</span></span>

<span data-ttu-id="5dafe-114">La [**función MFCreatePMPMediaSession**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession) devuelve un puntero a un objeto proxy para la sesión multimedia.</span><span class="sxs-lookup"><span data-stu-id="5dafe-114">The [**MFCreatePMPMediaSession**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession) function returns a pointer to a proxy object for the Media Session.</span></span> <span data-ttu-id="5dafe-115">La aplicación se comunica con la sesión multimedia a través del proxy.</span><span class="sxs-lookup"><span data-stu-id="5dafe-115">The application communicates with the Media Session through the proxy.</span></span>

![ilustración de la sesión multimedia dentro del proceso pmp](images/pmp01.png)

<span data-ttu-id="5dafe-117">De forma predeterminada, cuando la aplicación crea una topología, el origen multimedia se crea dentro del proceso de aplicación.</span><span class="sxs-lookup"><span data-stu-id="5dafe-117">By default, when the application creates a topology, the media source is created inside the application process.</span></span> <span data-ttu-id="5dafe-118">Se crea un proxy para el origen de medios dentro del proceso PMP.</span><span class="sxs-lookup"><span data-stu-id="5dafe-118">A proxy to the media source is created inside the PMP process.</span></span> <span data-ttu-id="5dafe-119">El origen multimedia puede crear objetos dentro del proceso PMP mediante la interfaz [**DEFMPHost.**](/windows/desktop/api/mfidl/nf-mfidl-imfpmphost-createobjectbyclsid)</span><span class="sxs-lookup"><span data-stu-id="5dafe-119">The media source can create objects inside the PMP process by using the [**IMFPMPHost**](/windows/desktop/api/mfidl/nf-mfidl-imfpmphost-createobjectbyclsid) interface.</span></span> <span data-ttu-id="5dafe-120">Por ejemplo, para admitir DRM, un origen multimedia crea un objeto denominado autoridad *de confianza de entrada* (ITA).</span><span class="sxs-lookup"><span data-stu-id="5dafe-120">For example, to support DRM, a media source creates an object called an *input trust authority* (ITA).</span></span> <span data-ttu-id="5dafe-121">El ITA debe crearse dentro del proceso de PMP.</span><span class="sxs-lookup"><span data-stu-id="5dafe-121">The ITA must be created inside the PMP process.</span></span> <span data-ttu-id="5dafe-122">(Para obtener más información sobre las ITA, vea [Ruta de acceso de medios protegidos).](protected-media-path.md) Para usar la [**interfaz IMFPMPHost,**](/windows/desktop/api/mfidl/nn-mfidl-imfpmphost) haga lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="5dafe-122">(For more information about ITAs, see [Protected Media Path](protected-media-path.md).) To use the [**IMFPMPHost**](/windows/desktop/api/mfidl/nn-mfidl-imfpmphost) interface, do the following:</span></span>

1.  <span data-ttu-id="5dafe-123">El origen de medios debe implementar la [**interfaz IMFPMPClient.**](/windows/desktop/api/mfidl/nn-mfidl-imfpmpclient)</span><span class="sxs-lookup"><span data-stu-id="5dafe-123">The media source must implement the [**IMFPMPClient**](/windows/desktop/api/mfidl/nn-mfidl-imfpmpclient) interface.</span></span>
2.  <span data-ttu-id="5dafe-124">Durante la resolución de la topología, el proxy de sesión multimedia llama al método [**IMFPMPClient::SetPMPHost**](/windows/desktop/api/mfidl/nf-mfidl-imfpmpclient-setpmphost) en el origen multimedia.</span><span class="sxs-lookup"><span data-stu-id="5dafe-124">During topology resolution, the Media Session proxy calls the [**IMFPMPClient::SetPMPHost**](/windows/desktop/api/mfidl/nf-mfidl-imfpmpclient-setpmphost) method on the media source.</span></span>
3.  <span data-ttu-id="5dafe-125">El origen de medios llama [**a IMFPMPHost::CreateObjectByCLSID**](/windows/desktop/api/mfidl/nf-mfidl-imfpmphost-createobjectbyclsid) para crear el objeto dentro del proceso PMP.</span><span class="sxs-lookup"><span data-stu-id="5dafe-125">The media source calls [**IMFPMPHost::CreateObjectByCLSID**](/windows/desktop/api/mfidl/nf-mfidl-imfpmphost-createobjectbyclsid) to create the object inside the PMP process.</span></span> <span data-ttu-id="5dafe-126">El objeto debe tener un CLSID registrado.</span><span class="sxs-lookup"><span data-stu-id="5dafe-126">The object must have a registered CLSID.</span></span> <span data-ttu-id="5dafe-127">Además, para cargar dentro del PE, el objeto debe ser de confianza y estar firmado digitalmente.</span><span class="sxs-lookup"><span data-stu-id="5dafe-127">Also, to load inside the PE, the object must be trusted and digitally signed.</span></span> <span data-ttu-id="5dafe-128">Para obtener información sobre la firma de código de componentes multimedia protegidos, consulte las white paper Code Signing for Protected Media Components in Windows Vista (Firma de código para componentes multimedia [protegidos en Windows Vista).](/windows-hardware/test/hlk/)</span><span class="sxs-lookup"><span data-stu-id="5dafe-128">For information about code signing protected media components, see the white paper [Code Signing for Protected Media Components in Windows Vista](/windows-hardware/test/hlk/)</span></span>

<span data-ttu-id="5dafe-129">En la ilustración siguiente se muestra el origen multimedia creado en el proceso de aplicación.</span><span class="sxs-lookup"><span data-stu-id="5dafe-129">The following illustration shows the media source created in the application process.</span></span>

![ilustración de un origen multimedia en el proceso de aplicación.](images/pmp02.png)

<span data-ttu-id="5dafe-131">Otra alternativa es crear el origen multimedia dentro de la sesión PMP.</span><span class="sxs-lookup"><span data-stu-id="5dafe-131">Another alternative is to create the media source inside the PMP session.</span></span>

1.  <span data-ttu-id="5dafe-132">Establezca el [**atributo MF SESSION REMOTE SOURCE \_ \_ \_ \_ MODE**](mf-session-remote-source-mode-attribute.md) al crear la sesión multimedia.</span><span class="sxs-lookup"><span data-stu-id="5dafe-132">Set the [**MF\_SESSION\_REMOTE\_SOURCE\_MODE**](mf-session-remote-source-mode-attribute.md) attribute when you create the Media Session.</span></span> <span data-ttu-id="5dafe-133">Los atributos de configuración se especifican en el *parámetro pConfiguration* de la [**función MFCreatePMPMediaSession.**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession)</span><span class="sxs-lookup"><span data-stu-id="5dafe-133">Configuration attributes are specified in the *pConfiguration* parameter of the [**MFCreatePMPMediaSession**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession) function.</span></span>
2.  <span data-ttu-id="5dafe-134">Llame [**a MFGetService**](/windows/desktop/api/mfidl/nf-mfidl-mfgetservice) en la sesión multimedia para obtener un puntero a la interfaz [**DEFMPHost.**](/windows/desktop/api/mfidl/nn-mfidl-imfpmphost)</span><span class="sxs-lookup"><span data-stu-id="5dafe-134">Call [**MFGetService**](/windows/desktop/api/mfidl/nf-mfidl-mfgetservice) on the Media Session to get a pointer to the [**IMFPMPHost**](/windows/desktop/api/mfidl/nn-mfidl-imfpmphost) interface.</span></span> <span data-ttu-id="5dafe-135">El identificador de servicio es **MF \_ PMP \_ SERVICE.**</span><span class="sxs-lookup"><span data-stu-id="5dafe-135">The service identifier is **MF\_PMP\_SERVICE**.</span></span>
3.  <span data-ttu-id="5dafe-136">Llame [**a MFPMPHost::CreateObjectByCLSID**](/windows/desktop/api/mfidl/nf-mfidl-imfpmphost-createobjectbyclsid) con el identificador de clase **CLSID \_ MFSourceResolver** para crear la resolución de origen dentro del proceso PMP.</span><span class="sxs-lookup"><span data-stu-id="5dafe-136">Call [**IMFPMPHost::CreateObjectByCLSID**](/windows/desktop/api/mfidl/nf-mfidl-imfpmphost-createobjectbyclsid) with the class identifier **CLSID\_MFSourceResolver** to create the source resolver inside the PMP process.</span></span> <span data-ttu-id="5dafe-137">El método devuelve un puntero a un proxy para la resolución de origen.</span><span class="sxs-lookup"><span data-stu-id="5dafe-137">The method returns a pointer to a proxy for the source resolver.</span></span>
4.  <span data-ttu-id="5dafe-138">Llame [**a IMFSourceResolver::BeginCreateObjectFromURL**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-begincreateobjectfromurl) o [**a IMFSourceResolver::BeginCreateObjectFromByteStream**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-begincreateobjectfrombytestream) para crear el origen multimedia.</span><span class="sxs-lookup"><span data-stu-id="5dafe-138">Call [**IMFSourceResolver::BeginCreateObjectFromURL**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-begincreateobjectfromurl) or [**IMFSourceResolver::BeginCreateObjectFromByteStream**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-begincreateobjectfrombytestream) to create the media source.</span></span>
    > [!Note]  
    > <span data-ttu-id="5dafe-139">En este caso, debe usar las versiones asincrónicas de estos métodos, porque las versiones sincrónicas no son remotables.</span><span class="sxs-lookup"><span data-stu-id="5dafe-139">In this case, you must use the asynchronous versions of these methods, because the synchronous versions are not remotable.</span></span>

     

<span data-ttu-id="5dafe-140">En la ilustración siguiente se muestra el origen multimedia creado en el proceso PMP.</span><span class="sxs-lookup"><span data-stu-id="5dafe-140">The following illustration shows the media source created in the PMP process.</span></span>

![ilustración de un origen multimedia en el proceso pmp.](images/pmp03.png)

## <a name="related-topics"></a><span data-ttu-id="5dafe-142">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="5dafe-142">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="5dafe-143">Cómo reproducir archivos multimedia protegidos</span><span class="sxs-lookup"><span data-stu-id="5dafe-143">How to Play Protected Media Files</span></span>](how-to-play-protected-media-files.md)
</dt> <dt>

[<span data-ttu-id="5dafe-144">Sesión multimedia</span><span class="sxs-lookup"><span data-stu-id="5dafe-144">Media Session</span></span>](media-session.md)
</dt> <dt>

[<span data-ttu-id="5dafe-145">Ruta de acceso multimedia protegida</span><span class="sxs-lookup"><span data-stu-id="5dafe-145">Protected Media Path</span></span>](protected-media-path.md)
</dt> </dl>

 

 
