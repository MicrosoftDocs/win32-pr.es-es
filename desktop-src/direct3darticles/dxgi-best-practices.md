---
title: Procedimientos recomendados de la infraestructura de gráficos de DirectX (DXGI)
description: En este artículo se describen los problemas de portabilidad de claves.
ms.assetid: 2df92ffe-1bfc-d682-2770-20cf0c831c9b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f576368674d05af74e3161d4251301ebc066a489
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104421170"
---
# <a name="directx-graphics-infrastructure-dxgi-best-practices"></a><span data-ttu-id="f97d8-103">Infraestructura de gráficos de DirectX (DXGI): procedimientos recomendados</span><span class="sxs-lookup"><span data-stu-id="f97d8-103">DirectX Graphics Infrastructure (DXGI): Best Practices</span></span>

<span data-ttu-id="f97d8-104">Microsoft DirectX Graphics Infrastructure (DXGI) es un nuevo subsistema que se presentó con Windows Vista que encapsula algunas de las tareas de bajo nivel que son necesarias en Direct3D 10, 10,1, 11 y 11,1.</span><span class="sxs-lookup"><span data-stu-id="f97d8-104">Microsoft DirectX Graphics Infrastructure (DXGI) is a new subsystem that was introduced with Windows Vista that encapsulates some of the low-level tasks that are needed by Direct3D 10, 10.1, 11, and 11.1.</span></span> <span data-ttu-id="f97d8-105">Desde el punto de vista de un programador de Direct3D 9, DXGI abarca la mayor parte del código para la enumeración, la creación de la cadena de intercambio y la presentación que anteriormente se empaquetaba en las API de Direct3D 9.</span><span class="sxs-lookup"><span data-stu-id="f97d8-105">From the perspective of a Direct3D 9 programmer, DXGI encompasses most of the code for enumeration, swap-chain creation, and presentation that previously was packed into the Direct3D 9 APIs.</span></span> <span data-ttu-id="f97d8-106">Al migrar una aplicación a DXGI y Direct3D 10. x y Direct3D 11. x, debe tener en cuenta algunas consideraciones para asegurarse de que el proceso se ejecuta sin problemas.</span><span class="sxs-lookup"><span data-stu-id="f97d8-106">When you port an app to DXGI and Direct3D 10.x and Direct3D 11.x, you need to take some considerations into account to ensure that the process runs smoothly.</span></span>

<span data-ttu-id="f97d8-107">En este artículo se describen los problemas de portabilidad de claves.</span><span class="sxs-lookup"><span data-stu-id="f97d8-107">This article discusses key porting issues.</span></span>

-   [<span data-ttu-id="f97d8-108">Problemas de pantalla completa</span><span class="sxs-lookup"><span data-stu-id="f97d8-108">Full-Screen Issues</span></span>](#full-screen-issues)
-   [<span data-ttu-id="f97d8-109">Varios monitores</span><span class="sxs-lookup"><span data-stu-id="f97d8-109">Multiple Monitors</span></span>](#multiple-monitors)
-   [<span data-ttu-id="f97d8-110">Estilos de ventana y DXGI</span><span class="sxs-lookup"><span data-stu-id="f97d8-110">Window Styles and DXGI</span></span>](#window-styles-and-dxgi)
-   [<span data-ttu-id="f97d8-111">Multithreading y DXGI</span><span class="sxs-lookup"><span data-stu-id="f97d8-111">Multithreading and DXGI</span></span>](#multithreading-and-dxgi)
-   [<span data-ttu-id="f97d8-112">Gamma y DXGI</span><span class="sxs-lookup"><span data-stu-id="f97d8-112">Gamma and DXGI</span></span>](#gamma-and-dxgi)
-   [<span data-ttu-id="f97d8-113">DXGI 1,1</span><span class="sxs-lookup"><span data-stu-id="f97d8-113">DXGI 1.1</span></span>](#dxgi-11)
-   [<span data-ttu-id="f97d8-114">DXGI 1,2</span><span class="sxs-lookup"><span data-stu-id="f97d8-114">DXGI 1.2</span></span>](#dxgi-12)

## <a name="full-screen-issues"></a><span data-ttu-id="f97d8-115">Problemas de Full-Screen</span><span class="sxs-lookup"><span data-stu-id="f97d8-115">Full-Screen Issues</span></span>

<span data-ttu-id="f97d8-116">En la migración de Direct3D 9 a DXGI y a Direct3D 10. x o Direct3D 11. x, los problemas asociados con el cambio de ventanas al modo de pantalla completa pueden provocar problemas de los desarrolladores.</span><span class="sxs-lookup"><span data-stu-id="f97d8-116">In porting from Direct3D 9 to DXGI and to Direct3D 10.x or Direct3D 11.x, issues associated with moving from windowing to full-screen mode often may cause headaches for developers.</span></span> <span data-ttu-id="f97d8-117">Los principales problemas surgen porque las aplicaciones de Direct3D 9, a diferencia de las aplicaciones de DXGI, requieren un enfoque más práctico para el seguimiento de los estilos de ventana y los Estados de las ventanas.</span><span class="sxs-lookup"><span data-stu-id="f97d8-117">The main problems arise because Direct3D 9 applications, unlike DXGI applications, require a more hands-on approach to tracking window styles and window states.</span></span> <span data-ttu-id="f97d8-118">Cuando el código que cambia el modo se traslada para ejecutarse en DXGI, a menudo provoca un comportamiento inesperado.</span><span class="sxs-lookup"><span data-stu-id="f97d8-118">When the mode-changing code is ported to run on DXGI, it often causes unexpected behavior.</span></span>

<span data-ttu-id="f97d8-119">A menudo, las aplicaciones de Direct3D 9 controlaban la transición al modo de pantalla completa mediante la configuración de la resolución del búfer frontal, forzando el dispositivo al modo exclusivo de pantalla completa y, después, estableciendo las resoluciones del búfer de reserva para que coincidan.</span><span class="sxs-lookup"><span data-stu-id="f97d8-119">Often, Direct3D 9 applications handled the transition into full-screen mode by setting the resolution of the front buffer, forcing the device into full-screen exclusive mode, and then setting the back buffer resolutions to match.</span></span> <span data-ttu-id="f97d8-120">Se usó una ruta de acceso independiente para los cambios en el tamaño de la ventana porque tenían que administrarse desde el proceso de la ventana cada vez que la aplicación recibía un mensaje de tamaño de WM \_ .</span><span class="sxs-lookup"><span data-stu-id="f97d8-120">A separate path was used for changes to window size because they had to be managed from the window process whenever the application received a WM\_SIZE message.</span></span>

<span data-ttu-id="f97d8-121">DXGI intenta simplificar este enfoque mediante la combinación de los dos casos.</span><span class="sxs-lookup"><span data-stu-id="f97d8-121">DXGI attempts to simplify this approach by combining the two cases.</span></span> <span data-ttu-id="f97d8-122">Por ejemplo, cuando el borde de la ventana se arrastra en modo de ventana, la aplicación recibe un \_ mensaje de tamaño de WM.</span><span class="sxs-lookup"><span data-stu-id="f97d8-122">For example, when the window border is dragged in windowed mode, the application receives a WM\_SIZE message.</span></span> <span data-ttu-id="f97d8-123">DXGI intercepta este mensaje y cambia automáticamente el tamaño del búfer frontal.</span><span class="sxs-lookup"><span data-stu-id="f97d8-123">DXGI intercepts this message and automatically resizes the front buffer.</span></span> <span data-ttu-id="f97d8-124">Todo lo que la aplicación tiene que hacer es llamar a [**IDXGISwapChain:: ResizeBuffers**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizebuffers) para cambiar el tamaño del búfer de reserva al tamaño que se pasó como parámetro en \_ el tamaño de WM.</span><span class="sxs-lookup"><span data-stu-id="f97d8-124">All that the application needs to do is call [**IDXGISwapChain::ResizeBuffers**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizebuffers) to resize the back buffer to the size that was passed as parameters in WM\_SIZE.</span></span> <span data-ttu-id="f97d8-125">De forma similar, cuando la aplicación necesita cambiar entre el modo de pantalla completa y el de ventanas, la aplicación simplemente puede llamar a [**IDXGISwapChain:: SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate).</span><span class="sxs-lookup"><span data-stu-id="f97d8-125">Similarly, when the application needs to switch between full-screen and windowed mode, the application can simply call [**IDXGISwapChain::SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate).</span></span> <span data-ttu-id="f97d8-126">DXGI cambia el tamaño del búfer frontal para que coincida con el modo de pantalla completa recién seleccionado y envía un mensaje de tamaño de WM \_ a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f97d8-126">DXGI resizes the front buffer to match the newly selected full-screen mode, and it sends a WM\_SIZE message to the application.</span></span> <span data-ttu-id="f97d8-127">De nuevo, la aplicación llama a **ResizeBuffers**, tal como lo haría si se arrastrase el borde de la ventana.</span><span class="sxs-lookup"><span data-stu-id="f97d8-127">The application again calls **ResizeBuffers**, just as it would if the window border was dragged.</span></span>

<span data-ttu-id="f97d8-128">La metodología de la explicación anterior sigue una ruta de acceso muy determinada.</span><span class="sxs-lookup"><span data-stu-id="f97d8-128">The methodology of the preceding explanation follows a very particular path.</span></span> <span data-ttu-id="f97d8-129">DXGI establezca la resolución de pantalla completa en la resolución del escritorio de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="f97d8-129">DXGI set the full-screen resolution to the desktop resolution by default.</span></span> <span data-ttu-id="f97d8-130">Sin embargo, muchas aplicaciones cambian a una resolución de pantalla completa preferida.</span><span class="sxs-lookup"><span data-stu-id="f97d8-130">Many applications, however, switch to a preferred full-screen resolution.</span></span> <span data-ttu-id="f97d8-131">En tal caso, DXGI proporciona [**IDXGISwapChain:: ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget).</span><span class="sxs-lookup"><span data-stu-id="f97d8-131">In such a case, DXGI provides [**IDXGISwapChain::ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget).</span></span> <span data-ttu-id="f97d8-132">Se debe llamar a este método antes de llamar a [**SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate).</span><span class="sxs-lookup"><span data-stu-id="f97d8-132">This should be called before calling [**SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate).</span></span> <span data-ttu-id="f97d8-133">Aunque se puede llamar a estos métodos en el orden opuesto (**SetFullscreenState** en primer lugar, seguido de **ResizeTarget**), hacerlo hace que se envíe un mensaje de tamaño de WM adicional \_ a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f97d8-133">Although these methods can be called in the opposite order (**SetFullscreenState** first, followed by **ResizeTarget**), doing so causes an extra WM\_SIZE message to be sent to the application.</span></span> <span data-ttu-id="f97d8-134">(Si lo hace, también puede provocar parpadeos, ya que DXGI podría verse obligado a realizar dos cambios en el modo). Después de llamar a **SetFullscreenState**, es aconsejable llamar de nuevo a **ResizeTarget** **con el miembro** de la frecuencia del [**modo de DXGI \_ \_**](/previous-versions/windows/desktop/legacy/bb173064(v=vs.85)) en cero. Esto se remonta en una instrucción de no operación en DXGI, pero puede evitar problemas con la frecuencia de actualización, que se explican a continuación.</span><span class="sxs-lookup"><span data-stu-id="f97d8-134">(Doing so can also cause flickering, since DXGI could be forced to perform two mode changes.) After calling **SetFullscreenState**, it is advisable to call **ResizeTarget** again with the **RefreshRate** member of [**DXGI\_MODE\_DESC**](/previous-versions/windows/desktop/legacy/bb173064(v=vs.85)) zeroed out. This amounts to a no-operation instruction in DXGI, but it can avoid issues with the refresh rate, which are discussed next.</span></span>

<span data-ttu-id="f97d8-135">En el modo de pantalla completa, el Administrador de ventanas de escritorio (DWM) está deshabilitado.</span><span class="sxs-lookup"><span data-stu-id="f97d8-135">When in full-screen mode, the Desktop Window Manager (DWM) is disabled.</span></span> <span data-ttu-id="f97d8-136">DXGI puede realizar una operación Flip para presentar el contenido del búfer de retroceso en lugar de realizar una operación blit, lo que haría en el modo de ventana.</span><span class="sxs-lookup"><span data-stu-id="f97d8-136">DXGI can perform a flip to present the back buffer contents instead of doing a blit, which it would do in windowed mode.</span></span> <span data-ttu-id="f97d8-137">Este aumento de rendimiento se puede deshacer, sin embargo, si no se cumplen determinados requisitos.</span><span class="sxs-lookup"><span data-stu-id="f97d8-137">This performance gain can be undone, however, if certain requirements are not met.</span></span> <span data-ttu-id="f97d8-138">Para asegurarse de que DXGI realiza una volteo en lugar de una blit, el búfer frontal y el búfer de reserva deben tener un tamaño idéntico.</span><span class="sxs-lookup"><span data-stu-id="f97d8-138">To ensure that DXGI does a flip instead of a blit, the front buffer and back buffer must be sized identically.</span></span> <span data-ttu-id="f97d8-139">Si la aplicación controla correctamente \_ los mensajes de tamaño de WM, esto no debería ser un problema.</span><span class="sxs-lookup"><span data-stu-id="f97d8-139">If the application correctly handles its WM\_SIZE messages, this should not be a problem.</span></span> <span data-ttu-id="f97d8-140">Además, los formatos deben ser idénticos.</span><span class="sxs-lookup"><span data-stu-id="f97d8-140">Also, the formats must be identical.</span></span>

<span data-ttu-id="f97d8-141">El problema de la mayoría de las aplicaciones es la frecuencia de actualización.</span><span class="sxs-lookup"><span data-stu-id="f97d8-141">The problem for most applications is the refresh rate.</span></span> <span data-ttu-id="f97d8-142">La frecuencia de actualización que se especifica en la llamada a [**ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget) debe ser una frecuencia de actualización enumerada por el objeto [**IDXGIOutput**](/windows/desktop/api/dxgi/nn-dxgi-idxgioutput) que usa la cadena de intercambio.</span><span class="sxs-lookup"><span data-stu-id="f97d8-142">The refresh rate that is specified in the call to [**ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget) must be a refresh rate that is enumerated by the [**IDXGIOutput**](/windows/desktop/api/dxgi/nn-dxgi-idxgioutput) object that the swap chain is using.</span></span> <span data-ttu-id="f97d8-143">DXGI puede calcular automáticamente este valor si la aplicación pone en cero el **miembro de** frecuencia de la [**\_ \_ Descripción del modo DXGI**](/previous-versions/windows/desktop/legacy/bb173064(v=vs.85)) que se pasa a **ResizeTarget**.</span><span class="sxs-lookup"><span data-stu-id="f97d8-143">DXGI can automatically calculate this value if the application zeroes out the **RefreshRate** member of [**DXGI\_MODE\_DESC**](/previous-versions/windows/desktop/legacy/bb173064(v=vs.85)) that is passed into **ResizeTarget**.</span></span> <span data-ttu-id="f97d8-144">Es importante no asumir que ciertas frecuencias de actualización se admitirán siempre y simplemente codificar un valor.</span><span class="sxs-lookup"><span data-stu-id="f97d8-144">It is important not to assume that certain refresh rates will always be supported and to simply hard-code a value.</span></span> <span data-ttu-id="f97d8-145">A menudo, los desarrolladores eligen 60 Hz como la frecuencia de actualización, sin saber que la frecuencia de actualización enumerada desde el monitor es de aproximadamente 60.000/1.001 Hz en el monitor.</span><span class="sxs-lookup"><span data-stu-id="f97d8-145">Often, developers choose 60 Hz as the refresh rate, not knowing that the enumerated refresh rate from the monitor is approximately 60,000 / 1,001 Hz from the monitor.</span></span> <span data-ttu-id="f97d8-146">Si la frecuencia de actualización no coincide con la frecuencia de actualización esperada de 60, se fuerza a DXGI a que realice una blit en el modo de pantalla completa en lugar de un volteo.</span><span class="sxs-lookup"><span data-stu-id="f97d8-146">If the refresh rate does not match the expected refresh rate of 60, DXGI is forced to perform a blit in full-screen mode instead of a flip.</span></span>

<span data-ttu-id="f97d8-147">El último problema al que suelen encontrarse los desarrolladores es cómo cambiar las resoluciones de pantalla completa mientras permanecen en el modo de pantalla completa.</span><span class="sxs-lookup"><span data-stu-id="f97d8-147">The last issue that developers often face is how to change full-screen resolutions while remaining in full-screen mode.</span></span> <span data-ttu-id="f97d8-148">La llamada a [**ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget) y [**SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate) a veces se realiza correctamente, pero la resolución de pantalla completa sigue siendo la resolución del escritorio.</span><span class="sxs-lookup"><span data-stu-id="f97d8-148">Calling [**ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget) and [**SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate) sometimes succeeds, but the full-screen resolution remains the desktop resolution.</span></span> <span data-ttu-id="f97d8-149">Además, los desarrolladores pueden crear una cadena de intercambio de pantalla completa y proporcionar una resolución específica, solo para buscar que DXGI tenga como valor predeterminado la resolución del escritorio, independientemente de los números que se hayan pasado.</span><span class="sxs-lookup"><span data-stu-id="f97d8-149">Also, developers may create a full-screen swap chain and give a specific resolution, only to find that DXGI defaults to the desktop resolution regardless of the numbers passed in.</span></span> <span data-ttu-id="f97d8-150">A menos que se indique lo contrario, DXGI tiene como valor predeterminado la resolución del escritorio para las cadenas de intercambio de pantalla completa.</span><span class="sxs-lookup"><span data-stu-id="f97d8-150">Unless otherwise instructed, DXGI defaults to the desktop resolution for full-screen swap chains.</span></span> <span data-ttu-id="f97d8-151">Al crear una cadena de intercambio de pantalla completa, el miembro **Flags** de la estructura de DESC de la cadena de intercambio de dxgi debe establecerse en el [**\_ \_ \_**](/windows/desktop/api/dxgi/ns-dxgi-dxgi_swap_chain_desc) [**\_ \_ \_ \_ \_ \_ modificador de modo permitir**](/windows/desktop/api/dxgi/ne-dxgi-dxgi_swap_chain_flag) de la cadena de intercambio de dxgi para invalidar el comportamiento predeterminado de dxgi.</span><span class="sxs-lookup"><span data-stu-id="f97d8-151">When creating a full-screen swap chain, the **Flags** member of the [**DXGI\_SWAP\_CHAIN\_DESC**](/windows/desktop/api/dxgi/ns-dxgi-dxgi_swap_chain_desc) structure must be set to [**DXGI\_SWAP\_CHAIN\_FLAG\_ALLOW\_MODE\_SWITCH**](/windows/desktop/api/dxgi/ne-dxgi-dxgi_swap_chain_flag) to override DXGI's default behavior.</span></span> <span data-ttu-id="f97d8-152">Esta marca también se puede pasar a **ResizeTarget** para habilitar o deshabilitar esta funcionalidad de forma dinámica.</span><span class="sxs-lookup"><span data-stu-id="f97d8-152">This flag also can be passed to **ResizeTarget** to enable or disable this functionality dynamically.</span></span>

## <a name="multiple-monitors"></a><span data-ttu-id="f97d8-153">Varios monitores</span><span class="sxs-lookup"><span data-stu-id="f97d8-153">Multiple Monitors</span></span>

<span data-ttu-id="f97d8-154">Al usar DXGI con varios monitores, hay dos reglas que deben seguirse.</span><span class="sxs-lookup"><span data-stu-id="f97d8-154">When using DXGI with multiple monitors, there are two rules to follow.</span></span>

<span data-ttu-id="f97d8-155">La primera regla se aplica a la creación de dos o más cadenas de intercambio de pantalla completa en varios monitores.</span><span class="sxs-lookup"><span data-stu-id="f97d8-155">The first rule applies to the creation of two or more full-screen swap chains on multiple monitors.</span></span> <span data-ttu-id="f97d8-156">Al crear tales cadenas de intercambio, es mejor crear todas las cadenas de intercambio como ventana y, a continuación, establecerlas en pantalla completa.</span><span class="sxs-lookup"><span data-stu-id="f97d8-156">When creating such swap chains, it is best to create all swap chains as windowed, and then to set them to full-screen.</span></span> <span data-ttu-id="f97d8-157">Si las cadenas de intercambio se crean en el modo de pantalla completa, la creación de una segunda cadena de intercambio hace que se envíe un cambio de modo a la primera cadena de intercambio, lo que podría provocar la terminación del modo de pantalla completa.</span><span class="sxs-lookup"><span data-stu-id="f97d8-157">If swap chains are created in full-screen mode, the creation of a second swap chain causes a mode change to be sent to the first swap chain, which could cause termination of full-screen mode.</span></span>

<span data-ttu-id="f97d8-158">La segunda regla se aplica a las salidas.</span><span class="sxs-lookup"><span data-stu-id="f97d8-158">The second rule applies to outputs.</span></span> <span data-ttu-id="f97d8-159">Esté atento a las salidas utilizadas al crear cadenas de intercambio.</span><span class="sxs-lookup"><span data-stu-id="f97d8-159">Be watchful of outputs used when creating swap chains.</span></span> <span data-ttu-id="f97d8-160">Con DXGI, el objeto [**IDXGIOutput**](/windows/desktop/api/dxgi/nn-dxgi-idxgioutput) controla qué monitor usa la cadena de intercambio cuando se convierte en pantalla completa.</span><span class="sxs-lookup"><span data-stu-id="f97d8-160">With DXGI, the [**IDXGIOutput**](/windows/desktop/api/dxgi/nn-dxgi-idxgioutput) object controls which monitor the swap chain uses when becoming full-screen.</span></span> <span data-ttu-id="f97d8-161">A diferencia de DXGI, Direct3D 9 no tenía ningún concepto de salidas.</span><span class="sxs-lookup"><span data-stu-id="f97d8-161">Unlike DXGI, Direct3D 9 had no concept of outputs.</span></span>

## <a name="window-styles-and-dxgi"></a><span data-ttu-id="f97d8-162">Estilos de ventana y DXGI</span><span class="sxs-lookup"><span data-stu-id="f97d8-162">Window Styles and DXGI</span></span>

<span data-ttu-id="f97d8-163">Las aplicaciones de Direct3D 9 tenían mucho trabajo para cambiar entre los modos de pantalla completa y de ventana.</span><span class="sxs-lookup"><span data-stu-id="f97d8-163">Direct3D 9 applications had a lot of work to do when switching between full-screen and windowed modes.</span></span> <span data-ttu-id="f97d8-164">Gran parte de este trabajo implica cambiar los estilos de ventana para agregar y quitar bordes, agregar barras de desplazamiento, etc.</span><span class="sxs-lookup"><span data-stu-id="f97d8-164">Much of this work involved changing window styles to add and remove borders, to add scrollbars, and so on.</span></span> <span data-ttu-id="f97d8-165">Cuando las aplicaciones se trasladan a DXGI y Direct3D 10. x o Direct3D 11. x, este código se deja en su lugar.</span><span class="sxs-lookup"><span data-stu-id="f97d8-165">When applications are ported to DXGI and Direct3D 10.x or Direct3D 11.x, this code often is left in place.</span></span> <span data-ttu-id="f97d8-166">Dependiendo de los cambios que se realicen, el cambio entre modos puede producir un comportamiento inesperado.</span><span class="sxs-lookup"><span data-stu-id="f97d8-166">Depending on the changes being made, switching between modes can cause unexpected behavior.</span></span> <span data-ttu-id="f97d8-167">Por ejemplo, al cambiar al modo de ventana, es posible que la aplicación deje de tener un marco de ventana o un borde de ventana a pesar de tener código que establezca específicamente estos estilos.</span><span class="sxs-lookup"><span data-stu-id="f97d8-167">For example, when switching to windowed mode, the application might no longer have a window frame or window border despite having code that specifically sets these styles.</span></span> <span data-ttu-id="f97d8-168">Esto se debe a que DXGI ahora controla gran parte de este estilo cambiando por sí mismo.</span><span class="sxs-lookup"><span data-stu-id="f97d8-168">This occurs because DXGI now handles much of this style changing on its own.</span></span> <span data-ttu-id="f97d8-169">La configuración manual de los estilos de ventana puede interferir con DXGI y esto puede provocar un comportamiento inesperado.</span><span class="sxs-lookup"><span data-stu-id="f97d8-169">Manual setting of window styles can interfere with DXGI, and this can cause unexpected behavior.</span></span>

<span data-ttu-id="f97d8-170">El comportamiento recomendado es realizar el menor trabajo posible y permitir que DXGI controle la mayor parte de la interacción con las ventanas.</span><span class="sxs-lookup"><span data-stu-id="f97d8-170">The recommended behavior is to do as little work as possible, and to let DXGI handle most of the interaction with the windows.</span></span> <span data-ttu-id="f97d8-171">Sin embargo, si la aplicación necesita controlar su propio comportamiento de ventana, se puede usar [**IDXGIFactory:: MakeWindowAssociation**](/windows/desktop/api/dxgi/nf-dxgi-idxgifactory-makewindowassociation) para indicar a DXGI que deshabilite parte de su control automático de ventanas.</span><span class="sxs-lookup"><span data-stu-id="f97d8-171">However, if the application needs to handle its own windowing behavior, [**IDXGIFactory::MakeWindowAssociation**](/windows/desktop/api/dxgi/nf-dxgi-idxgifactory-makewindowassociation) can be used to tell DXGI to disable some of its automatic window handling.</span></span>

## <a name="multithreading-and-dxgi"></a><span data-ttu-id="f97d8-172">Multithreading y DXGI</span><span class="sxs-lookup"><span data-stu-id="f97d8-172">Multithreading and DXGI</span></span>

<span data-ttu-id="f97d8-173">Se debe tener especial cuidado al usar DXGI en una aplicación multiproceso para garantizar que no se produzcan interbloqueos.</span><span class="sxs-lookup"><span data-stu-id="f97d8-173">Special care must be taken when using DXGI in a multithreaded application to ensure that deadlocks do not occur.</span></span> <span data-ttu-id="f97d8-174">Debido a la interacción estrecha de DXGI con las ventanas, en ocasiones envía mensajes de ventana a la ventana de la aplicación asociada.</span><span class="sxs-lookup"><span data-stu-id="f97d8-174">Because of DXGI's close interaction with windowing, it occasionally sends window messages to the associated application window.</span></span> <span data-ttu-id="f97d8-175">DXGI necesita que los cambios en las ventanas se realicen antes de poder continuar, por lo que usará [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage), que es una llamada sincrónica.</span><span class="sxs-lookup"><span data-stu-id="f97d8-175">DXGI needs the windowing changes to occur before it can continue, so it will use [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage), which is a synchronous call.</span></span> <span data-ttu-id="f97d8-176">La aplicación debe procesar el mensaje de ventana antes de que se devuelva **SendMessage** .</span><span class="sxs-lookup"><span data-stu-id="f97d8-176">The application must process the window message before **SendMessage** returns.</span></span>

<span data-ttu-id="f97d8-177">En una aplicación en la que las llamadas de DXGI y el bombeo de mensajes se encuentran en el mismo subproceso (o en una aplicación de un solo subproceso), es necesario hacer poco.</span><span class="sxs-lookup"><span data-stu-id="f97d8-177">In an application where DXGI calls and the message pump are on the same thread (or a single-threaded application), little needs to be done.</span></span> <span data-ttu-id="f97d8-178">Cuando la llamada de DXGI está en el mismo subproceso que el bombeo de mensajes, [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) llama a la [*WindowProc*](/previous-versions/windows/desktop/legacy/ms633573(v=vs.85))de la ventana.</span><span class="sxs-lookup"><span data-stu-id="f97d8-178">When the DXGI call is on the same thread as the message pump, [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) calls the window's [*WindowProc*](/previous-versions/windows/desktop/legacy/ms633573(v=vs.85)).</span></span> <span data-ttu-id="f97d8-179">Esto omite el bombeo de mensajes y permite que continúe la ejecución después de la llamada a **SendMessage**.</span><span class="sxs-lookup"><span data-stu-id="f97d8-179">This bypasses the message pump, and allows execution to continue after the call to **SendMessage**.</span></span> <span data-ttu-id="f97d8-180">Recuerde que las llamadas a [**IDXGISwapChain**](/windows/desktop/api/dxgi/nn-dxgi-idxgiswapchain) , como [**IDXGISwapChain::P reenviados**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-present), también se consideran llamadas de DXGI; DXGI puede diferir el trabajo de [**ResizeBuffers**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizebuffers) o [**ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget) hasta que se llama a **present** .</span><span class="sxs-lookup"><span data-stu-id="f97d8-180">Remember that [**IDXGISwapChain**](/windows/desktop/api/dxgi/nn-dxgi-idxgiswapchain) calls, such as [**IDXGISwapChain::Present**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-present), are also considered DXGI calls; DXGI may defer work from [**ResizeBuffers**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizebuffers) or [**ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget) until **Present** is called.</span></span>

<span data-ttu-id="f97d8-181">Si la llamada de DXGI y el bombeo de mensajes están en distintos subprocesos, debe tener cuidado para evitar los interbloqueos.</span><span class="sxs-lookup"><span data-stu-id="f97d8-181">If the DXGI call and message pump are on different threads, care must be taken to avoid deadlocks.</span></span> <span data-ttu-id="f97d8-182">Cuando el bombeo de mensajes y SendMessage están en subprocesos diferentes, [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) agrega un mensaje a la cola de mensajes de la ventana y espera a que la ventana procese ese mensaje.</span><span class="sxs-lookup"><span data-stu-id="f97d8-182">When the message pump and SendMessage are on different threads, [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) adds a message to the window's message queue, and waits for the window to process that message.</span></span> <span data-ttu-id="f97d8-183">Si el procedimiento de ventana está ocupado o no lo llama el bombeo de mensajes, es posible que el mensaje no se procese nunca y DXGI espere indefinidamente.</span><span class="sxs-lookup"><span data-stu-id="f97d8-183">If the window procedure is busy or is not called by the message pump, the message may never get processed and DXGI will wait indefinitely.</span></span>

<span data-ttu-id="f97d8-184">Por ejemplo, si una aplicación tiene su bombeo de mensajes en un subproceso y su representación en otro, puede que desee cambiar los modos.</span><span class="sxs-lookup"><span data-stu-id="f97d8-184">For example, if an application that has its message pump on one thread and its rendering on another, it may want to change modes.</span></span> <span data-ttu-id="f97d8-185">El subproceso de bombeo de mensajes indica al subproceso de representación que cambie los modos y espera hasta que se complete el cambio de modo.</span><span class="sxs-lookup"><span data-stu-id="f97d8-185">The message pump thread tells the rendering thread to change modes, and waits until the mode change is complete.</span></span> <span data-ttu-id="f97d8-186">Sin embargo, el subproceso de representación llama a las funciones de DXGI, que a su vez llaman a [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage), que se bloquea hasta que el bombeo de mensajes procesa el mensaje.</span><span class="sxs-lookup"><span data-stu-id="f97d8-186">However, the rendering thread calls DXGI functions, which in turn call [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage), which blocks until the message pump processes the message.</span></span> <span data-ttu-id="f97d8-187">Se produce un interbloqueo porque los dos subprocesos ahora están bloqueados y están esperando entre sí.</span><span class="sxs-lookup"><span data-stu-id="f97d8-187">A deadlock occurs because both threads now are blocked, and are waiting on each other.</span></span> <span data-ttu-id="f97d8-188">Para evitar esto, no bloquee nunca el bombeo de mensajes.</span><span class="sxs-lookup"><span data-stu-id="f97d8-188">To avoid this, never block the message pump.</span></span> <span data-ttu-id="f97d8-189">Si un bloque es inevitable, todas las interacciones de DXGI deben realizarse en el mismo subproceso que el bombeo de mensajes.</span><span class="sxs-lookup"><span data-stu-id="f97d8-189">If a block is unavoidable, then all DXGI interaction should occur on the same thread as the message pump.</span></span>

## <a name="gamma-and-dxgi"></a><span data-ttu-id="f97d8-190">Gamma y DXGI</span><span class="sxs-lookup"><span data-stu-id="f97d8-190">Gamma and DXGI</span></span>

<span data-ttu-id="f97d8-191">Aunque el valor de gamma puede controlarse mejor en Direct3D 10. x o Direct3D 11. x mediante el uso de texturas SRGB, la rampa de gamma todavía puede ser útil para los desarrolladores que quieren un valor gamma diferente que 2,2 o que usan un formato de destino de representación que no admite SRGB.</span><span class="sxs-lookup"><span data-stu-id="f97d8-191">Although gamma may be best handled in Direct3D 10.x or Direct3D 11.x by using SRGB textures, the gamma ramp still can be useful to developers who want a different gamma value than 2.2 or who are using a render target format that does not support SRGB.</span></span> <span data-ttu-id="f97d8-192">Tenga en cuenta dos problemas al establecer la rampa de gamma a través de DXGI.</span><span class="sxs-lookup"><span data-stu-id="f97d8-192">Be aware of two issues when setting the gamma ramp through DXGI.</span></span> <span data-ttu-id="f97d8-193">El primer problema es que los valores de rampa pasados en [**IDXGIOutput:: SetGammaControl**](/windows/desktop/api/dxgi/nf-dxgi-idxgioutput-setgammacontrol) son valores Float, no valores de **palabra** .</span><span class="sxs-lookup"><span data-stu-id="f97d8-193">The first issue is that the ramp values passed into [**IDXGIOutput::SetGammaControl**](/windows/desktop/api/dxgi/nf-dxgi-idxgioutput-setgammacontrol) are float values, not **WORD** values.</span></span> <span data-ttu-id="f97d8-194">Además, asegúrese de que el código que se portó desde Direct3D 9 no intente convertir a valores de **Word** antes de pasarlos a **SetGammaControl**.</span><span class="sxs-lookup"><span data-stu-id="f97d8-194">Also, ensure that code ported from Direct3D 9 does not try to convert to **WORD** values before passing these to **SetGammaControl**.</span></span>

<span data-ttu-id="f97d8-195">El segundo problema es que, después de cambiar al modo de pantalla completa, puede que [**SetGammaControl**](/windows/desktop/api/dxgi/nf-dxgi-idxgioutput-setgammacontrol) no funcione, dependiendo del objeto [**IDXGIOutput**](/windows/desktop/api/dxgi/nn-dxgi-idxgioutput) que se está usando.</span><span class="sxs-lookup"><span data-stu-id="f97d8-195">The second issue is that, after changing to full-screen mode, [**SetGammaControl**](/windows/desktop/api/dxgi/nf-dxgi-idxgioutput-setgammacontrol) may not appear to work, dependent on the [**IDXGIOutput**](/windows/desktop/api/dxgi/nn-dxgi-idxgioutput) object being used.</span></span> <span data-ttu-id="f97d8-196">Al cambiar al modo de pantalla completa, DXGI crea un nuevo objeto de salida y usa el objeto para todas las operaciones posteriores en la salida.</span><span class="sxs-lookup"><span data-stu-id="f97d8-196">When changing to full-screen mode, DXGI creates a new output object, and uses the object for all subsequent operations on the output.</span></span> <span data-ttu-id="f97d8-197">Si se llama a **SetGammaControl** en una salida que se enumera antes que un modificador en modo de pantalla completa, la llamada no se dirige hacia la salida que DXGI está usando actualmente.</span><span class="sxs-lookup"><span data-stu-id="f97d8-197">If calling **SetGammaControl** on an output that is enumerated before a full-screen mode switch, the call is not directed toward the output that DXGI is using currently.</span></span> <span data-ttu-id="f97d8-198">Para evitar esto, llame a [**IDXGISwapChain:: GetContainingOutput**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-getcontainingoutput) para obtener la salida actual y, a continuación, llame a **SetGammaControl** fuera de esta salida para obtener el comportamiento correcto.</span><span class="sxs-lookup"><span data-stu-id="f97d8-198">To avoid this, call [**IDXGISwapChain::GetContainingOutput**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-getcontainingoutput) to get the current output, and then call **SetGammaControl** off this output to get the correct behavior.</span></span>

<span data-ttu-id="f97d8-199">Para obtener información sobre el uso de la corrección gamma, vea [usar corrección Gamma](/windows/desktop/direct3ddxgi/using-gamma-correction).</span><span class="sxs-lookup"><span data-stu-id="f97d8-199">For info about using gamma correction, see [Using gamma correction](/windows/desktop/direct3ddxgi/using-gamma-correction).</span></span>

## <a name="dxgi-11"></a><span data-ttu-id="f97d8-200">DXGI 1,1</span><span class="sxs-lookup"><span data-stu-id="f97d8-200">DXGI 1.1</span></span>

<span data-ttu-id="f97d8-201">El tiempo de ejecución de Direct3D 11 incluido en Windows 7 e instalado en Windows Vista (vea [KB971644](https://support.microsoft.com/kb/971644)) incluye la versión 1,1 de DXGI.</span><span class="sxs-lookup"><span data-stu-id="f97d8-201">The Direct3D 11 runtime included in Windows 7 and installed onto Windows Vista (see [KB971644](https://support.microsoft.com/kb/971644)) includes version 1.1 of DXGI.</span></span> <span data-ttu-id="f97d8-202">Esta actualización agrega definiciones para varios formatos nuevos (en particular, BGRA, la diferencia x2 de 10 bits y la compresión de textura BC6H y BC7 de Direct3D 11), así como una nueva versión de las interfaces de adaptador y adaptador de DXGI ([**CreateDXGIFactory1**](/windows/desktop/api/dxgi/nf-dxgi-createdxgifactory1), [**IDXGIFactory1**](/windows/desktop/api/dxgi/nn-dxgi-idxgifactory1), [**IDXGIAdapter1**](/windows/desktop/api/dxgi/nn-dxgi-idxgiadapter1)) para enumerar las conexiones de escritorio remoto.</span><span class="sxs-lookup"><span data-stu-id="f97d8-202">This update adds definitions for a number of new formats (particularly BGRA, 10-bit X2 bias, and Direct3D 11's BC6H and BC7 texture compression), as well as a new version of the DXGI factory and adapter interfaces ([**CreateDXGIFactory1**](/windows/desktop/api/dxgi/nf-dxgi-createdxgifactory1), [**IDXGIFactory1**](/windows/desktop/api/dxgi/nn-dxgi-idxgifactory1), [**IDXGIAdapter1**](/windows/desktop/api/dxgi/nn-dxgi-idxgiadapter1)) for enumerating remote desktop connections.</span></span>

<span data-ttu-id="f97d8-203">Cuando se usa Direct3D 11, el Runtime usará DXGI 1,1 de forma predeterminada al llamar a [**D3D11CreateDevice**](/windows/desktop/api/d3d11/nf-d3d11-d3d11createdevice) o [**D3D11CreateDeviceAndSwapChain**](/windows/desktop/api/d3d11/nf-d3d11-d3d11createdeviceandswapchain) con un puntero [**IDXGIAdapter**](/windows/desktop/api/dxgi/nn-dxgi-idxgiadapter) nulo.</span><span class="sxs-lookup"><span data-stu-id="f97d8-203">When you use Direct3D 11, the runtime will use DXGI 1.1 by default when calling [**D3D11CreateDevice**](/windows/desktop/api/d3d11/nf-d3d11-d3d11createdevice) or [**D3D11CreateDeviceAndSwapChain**](/windows/desktop/api/d3d11/nf-d3d11-d3d11createdeviceandswapchain) with a NULL [**IDXGIAdapter**](/windows/desktop/api/dxgi/nn-dxgi-idxgiadapter) pointer.</span></span> <span data-ttu-id="f97d8-204">No se admite la combinación del uso de DXGI 1,0 y DXGI 1,1 en el mismo proceso.</span><span class="sxs-lookup"><span data-stu-id="f97d8-204">Mixing use of DXGI 1.0 and DXGI 1.1 in the same process is not supported.</span></span> <span data-ttu-id="f97d8-205">Tampoco se admite la combinación de instancias de objeto de DXGI desde diferentes fábricas en el mismo proceso.</span><span class="sxs-lookup"><span data-stu-id="f97d8-205">Mixing DXGI object instances from different factories in the same process also is not supported.</span></span> <span data-ttu-id="f97d8-206">Por lo tanto, cuando se usa DirectX 11, cualquier uso explícito de las interfaces de DXGI usa un [**IDXGIFactory1**](/windows/desktop/api/dxgi/nn-dxgi-idxgifactory1) creado por el punto de entrada de [**CreateDXGIFactory1**](/windows/desktop/api/dxgi/nf-dxgi-createdxgifactory1) en "DXGI.DLL" para asegurarse de que la aplicación siempre usa DXGI 1,1.</span><span class="sxs-lookup"><span data-stu-id="f97d8-206">Therefore, when you use DirectX 11, any explicit use of the DXGI interfaces uses a [**IDXGIFactory1**](/windows/desktop/api/dxgi/nn-dxgi-idxgifactory1) created by the [**CreateDXGIFactory1**](/windows/desktop/api/dxgi/nf-dxgi-createdxgifactory1) entry-point in “DXGI.DLL” to ensure the application is always using DXGI 1.1.</span></span>

## <a name="dxgi-12"></a><span data-ttu-id="f97d8-207">DXGI 1,2</span><span class="sxs-lookup"><span data-stu-id="f97d8-207">DXGI 1.2</span></span>

<span data-ttu-id="f97d8-208">El tiempo de ejecución de Direct3D 11,1 que se incluye en Windows 8 también incluye la versión 1,2 de DXGI.</span><span class="sxs-lookup"><span data-stu-id="f97d8-208">The Direct3D 11.1 runtime that is included in Windows 8 also includes version 1.2 of DXGI.</span></span>

<span data-ttu-id="f97d8-209">DXGI 1,2 habilita estas características:</span><span class="sxs-lookup"><span data-stu-id="f97d8-209">DXGI 1.2 enables these features:</span></span>

-   <span data-ttu-id="f97d8-210">representación de estéreo</span><span class="sxs-lookup"><span data-stu-id="f97d8-210">stereo rendering</span></span>
-   <span data-ttu-id="f97d8-211">formatos de 16 bits por píxel</span><span class="sxs-lookup"><span data-stu-id="f97d8-211">16 bit-per-pixel formats</span></span>

    -   <span data-ttu-id="f97d8-212">El \_ formato \_ de dxgi B5G6R5 \_ UNORM y el formato de dxgi \_ \_ B5G5R5A1 \_ UNORM ahora son totalmente compatibles</span><span class="sxs-lookup"><span data-stu-id="f97d8-212">DXGI\_FORMAT\_B5G6R5\_UNORM and DXGI\_FORMAT\_B5G5R5A1\_UNORM are now fully supported</span></span>
    -   <span data-ttu-id="f97d8-213">se ha agregado un nuevo formato de \_ \_ B5G5R5A1 \_ UNORM formato de DXGI</span><span class="sxs-lookup"><span data-stu-id="f97d8-213">a new DXGI\_FORMAT\_B5G5R5A1\_UNORM format was added</span></span>

-   <span data-ttu-id="f97d8-214">formatos de vídeo</span><span class="sxs-lookup"><span data-stu-id="f97d8-214">video formats</span></span>
-   <span data-ttu-id="f97d8-215">nuevas interfaces de DXGI</span><span class="sxs-lookup"><span data-stu-id="f97d8-215">new DXGI interfaces</span></span>

<span data-ttu-id="f97d8-216">Para obtener más información sobre las características de DXGI 1,2, consulte [mejoras de dxgi 1,2](/windows/desktop/direct3ddxgi/dxgi-1-2-improvements).</span><span class="sxs-lookup"><span data-stu-id="f97d8-216">For more info about DXGI 1.2 features, see [DXGI 1.2 Improvements](/windows/desktop/direct3ddxgi/dxgi-1-2-improvements).</span></span>

 

 