---
title: Leer un conjunto derecho de control de acceso en la ACL de un objeto
description: Las propiedades de la interfaz IADsAccessControlEntry se usan para conceder o denegar derechos de acceso de control.
ms.assetid: 2c6fef91-990e-4954-9aff-c9ec72d13972
ms.tgt_platform: multiple
keywords:
- Leer un conjunto de derechos de acceso de control en la ACL de un objeto Active Directory
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4877c96a95fc94095c79ad129e8a07b1c786abe1
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/17/2020
ms.locfileid: "104077503"
---
# <a name="reading-a-control-access-right-set-in-an-objects-acl"></a><span data-ttu-id="ac181-104">Leer un conjunto derecho de control de acceso en la ACL de un objeto</span><span class="sxs-lookup"><span data-stu-id="ac181-104">Reading a Control Access Right Set in an Object's ACL</span></span>

<span data-ttu-id="ac181-105">Con ADSI, se lee una ACE de derechos de control de acceso igual que cualquier otra ACE de una ACL.</span><span class="sxs-lookup"><span data-stu-id="ac181-105">Using ADSI, you read a control access right ACE just as you would any other ACE in an ACL.</span></span> <span data-ttu-id="ac181-106">Tenga en cuenta que también puede usar las API de seguridad de Win32 para leer ACL en objetos de directorio.</span><span class="sxs-lookup"><span data-stu-id="ac181-106">Be aware that you can also use the Win32 security APIs to read ACLs on directory objects.</span></span> <span data-ttu-id="ac181-107">Sin embargo, los derechos de acceso de control utilizan las propiedades de la interfaz [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) de una manera específica para conceder y denegar derechos de acceso de control:</span><span class="sxs-lookup"><span data-stu-id="ac181-107">However, control access rights use the properties of the [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) interface in a manner that is specific to granting and denying control access rights:</span></span>

-   <span data-ttu-id="ac181-108">[**AccessMask**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) debe contener **\_ el \_ acceso de \_ control \_ DS adecuado de ADS**.</span><span class="sxs-lookup"><span data-stu-id="ac181-108">[**AccessMask**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) must contain **ADS\_RIGHT\_DS\_CONTROL\_ACCESS**.</span></span>
-   <span data-ttu-id="ac181-109">El valor de [**Flags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) es el **tipo de objeto de \_ marca ADS \_ \_ \_ presente**.</span><span class="sxs-lookup"><span data-stu-id="ac181-109">[**Flags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) value is **ADS\_FLAG\_OBJECT\_TYPE\_PRESENT**.</span></span>
-   <span data-ttu-id="ac181-110">[**Objecttype**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) es la forma de cadena del atributo **rightsGUID** del derecho de acceso de control.</span><span class="sxs-lookup"><span data-stu-id="ac181-110">[**ObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) is the string form of the **rightsGUID** attribute of the control access right.</span></span> <span data-ttu-id="ac181-111">El formato de cadena del GUID es el mismo que el de la función de biblioteca com [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) .</span><span class="sxs-lookup"><span data-stu-id="ac181-111">The string format of the GUID is the same string format as the [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) COM Library function.</span></span>
-   <span data-ttu-id="ac181-112">[**AceType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) es el **objeto de ADS \_ AceType \_ Access \_ \_ allowed** , para conceder al administrador de confianza el derecho de acceso de control o **ADS \_ AceType \_ acceso \_ denegado \_** para denegar al administrador de confianza el derecho de acceso de control.</span><span class="sxs-lookup"><span data-stu-id="ac181-112">[**AceType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) is either **ADS\_ACETYPE\_ACCESS\_ALLOWED\_OBJECT** to grant the trustee the control access right or **ADS\_ACETYPE\_ACCESS\_DENIED\_OBJECT** to deny the trustee the control access right.</span></span>
-   <span data-ttu-id="ac181-113">[**Trustee**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) es la entidad de seguridad; es el usuario, el grupo, el equipo, etc., al que se aplica la ACE.</span><span class="sxs-lookup"><span data-stu-id="ac181-113">[**Trustee**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) is the security principal; that is the user, group, computer, and so on, to which the ACE applies.</span></span>

<span data-ttu-id="ac181-114">Utilice el procedimiento siguiente para leer una ACE para un objeto ADSI.</span><span class="sxs-lookup"><span data-stu-id="ac181-114">Use the following procedure to read an ACE for an ADSI object.</span></span> <span data-ttu-id="ac181-115">El siguiente procedimiento se aplica a las aplicaciones de C y C++.</span><span class="sxs-lookup"><span data-stu-id="ac181-115">The following procedure applies to C and C++ applications.</span></span>

<span data-ttu-id="ac181-116">**Para leer una ACE para un objeto ADSI**</span><span class="sxs-lookup"><span data-stu-id="ac181-116">**To read an ACE for an ADSI object**</span></span>

1.  <span data-ttu-id="ac181-117">Obtiene un puntero de interfaz [**IADs**](/windows/desktop/api/iads/nn-iads-iads) al objeto.</span><span class="sxs-lookup"><span data-stu-id="ac181-117">Get an [**IADs**](/windows/desktop/api/iads/nn-iads-iads) interface pointer to the object.</span></span>
2.  <span data-ttu-id="ac181-118">Use el método [**IADs:: get**](/windows/desktop/api/iads/nf-iads-iads-get) para obtener el descriptor de seguridad del objeto.</span><span class="sxs-lookup"><span data-stu-id="ac181-118">Use the [**IADs::Get**](/windows/desktop/api/iads/nf-iads-iads-get) method to get the security descriptor of the object.</span></span> <span data-ttu-id="ac181-119">El nombre de la propiedad que contiene el descriptor de seguridad es "nTSecurityDescriptor".</span><span class="sxs-lookup"><span data-stu-id="ac181-119">The name of the property that contains the security descriptor is "nTSecurityDescriptor".</span></span> <span data-ttu-id="ac181-120">La propiedad se devolverá como una **variante** que contiene un puntero [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) .</span><span class="sxs-lookup"><span data-stu-id="ac181-120">The property will be returned as a **VARIANT** that contains an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) pointer.</span></span> <span data-ttu-id="ac181-121">Tenga en cuenta que el miembro de **VT** es el **\_ envío de VT**.</span><span class="sxs-lookup"><span data-stu-id="ac181-121">Be aware that the **vt** member is **VT\_DISPATCH**.</span></span> <span data-ttu-id="ac181-122">Llame a **QueryInterface** en ese puntero **IDispatch** para obtener una interfaz [**IADsSecurityDescriptor**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor) para usar los métodos de esa interfaz para tener acceso a la ACL del descriptor de seguridad.</span><span class="sxs-lookup"><span data-stu-id="ac181-122">Call **QueryInterface** on that **IDispatch** pointer to get an [**IADsSecurityDescriptor**](/windows/desktop/api/iads/nn-iads-iadssecuritydescriptor) interface to use the methods on that interface to access the security descriptor ACL.</span></span>
3.  <span data-ttu-id="ac181-123">Use el método [**IADsSecurityDescriptor:: get \_ DiscretionaryAcl**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) para obtener la ACL.</span><span class="sxs-lookup"><span data-stu-id="ac181-123">Use the [**IADsSecurityDescriptor::get\_DiscretionaryAcl**](/windows/desktop/ADSI/iadssecuritydescriptor-property-methods) method to get the ACL.</span></span> <span data-ttu-id="ac181-124">El método devuelve un puntero [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) .</span><span class="sxs-lookup"><span data-stu-id="ac181-124">The method returns an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) pointer.</span></span> <span data-ttu-id="ac181-125">Llame a **QueryInterface** en ese puntero **IDispatch** para obtener una interfaz [**IADsAccessControlList**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist) para usar los métodos de esa interfaz para tener acceso a las ACE individuales de la ACL.</span><span class="sxs-lookup"><span data-stu-id="ac181-125">Call **QueryInterface** on that **IDispatch** pointer to get an [**IADsAccessControlList**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrollist) interface to use the methods on that interface to access the individual ACEs in the ACL.</span></span>
4.  <span data-ttu-id="ac181-126">Use el método [**IADsAccessControlList:: get \_ \_ NewEnum**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-get__newenum) para enumerar las ACE.</span><span class="sxs-lookup"><span data-stu-id="ac181-126">Use the [**IADsAccessControlList::get\_\_NewEnum**](/windows/desktop/api/iads/nf-iads-iadsaccesscontrollist-get__newenum) method to enumerate the ACEs.</span></span> <span data-ttu-id="ac181-127">El método devuelve un puntero [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) .</span><span class="sxs-lookup"><span data-stu-id="ac181-127">The method returns an [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) pointer.</span></span> <span data-ttu-id="ac181-128">Llame a **QueryInterface** en ese puntero **IUnknown** para obtener una interfaz [**IEnumVARIANT**](/windows/win32/api/oaidl/nn-oaidl-ienumvariant) .</span><span class="sxs-lookup"><span data-stu-id="ac181-128">Call **QueryInterface** on that **IUnknown** pointer to get an [**IEnumVARIANT**](/windows/win32/api/oaidl/nn-oaidl-ienumvariant) interface.</span></span>
5.  <span data-ttu-id="ac181-129">Use el método [**IEnumVARIANT:: Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) para enumerar las ACE de la ACL.</span><span class="sxs-lookup"><span data-stu-id="ac181-129">Use the [**IEnumVARIANT::Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) method to enumerate the ACEs in the ACL.</span></span> <span data-ttu-id="ac181-130">La propiedad se devuelve como un **valor de tipo Variant** que contiene un puntero [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) .</span><span class="sxs-lookup"><span data-stu-id="ac181-130">The property is returned as a **VARIANT** that contains an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) pointer.</span></span> <span data-ttu-id="ac181-131">Tenga en cuenta que el miembro de **VT** es el **\_ envío de VT**.</span><span class="sxs-lookup"><span data-stu-id="ac181-131">Be aware that the **vt** member is **VT\_DISPATCH**.</span></span> <span data-ttu-id="ac181-132">Llame a **QueryInterface** en ese puntero **IDispatch** para obtener una interfaz [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) para leer la ACE.</span><span class="sxs-lookup"><span data-stu-id="ac181-132">Call **QueryInterface** on that **IDispatch** pointer to get an [**IADsAccessControlEntry**](/windows/desktop/api/iads/nn-iads-iadsaccesscontrolentry) interface to read the ACE.</span></span>
6.  <span data-ttu-id="ac181-133">Llame al [**método IADsAccessControlEntry:: \_ Get AccessMask**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) para obtener la **AccessMask** y compruebe que el valor de **AccessMask** para la marca de **\_ \_ \_ \_ acceso de control DS** de ad derecho de ADS.</span><span class="sxs-lookup"><span data-stu-id="ac181-133">Call the [**IADsAccessControlEntry::get\_AccessMask**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) method to get the **AccessMask** and verify that the **AccessMask** value for the **ADS\_RIGHT\_DS\_CONTROL\_ACCESS** flag.</span></span> <span data-ttu-id="ac181-134">Si tiene esta marca, la ACE contiene un derecho de acceso de control.</span><span class="sxs-lookup"><span data-stu-id="ac181-134">If it has this flag, the ACE contains a control access right.</span></span>
7.  <span data-ttu-id="ac181-135">Llame al método [**IADsAccessControlEntry:: get \_ Flags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) para obtener la marca para el tipo de objeto.</span><span class="sxs-lookup"><span data-stu-id="ac181-135">Call the [**IADsAccessControlEntry::get\_Flags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) method to get the flag for the object type.</span></span>
8.  <span data-ttu-id="ac181-136">Valor de [**marcas**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) check para la marca present del **tipo de \_ \_ objeto de \_ \_ marca ADS** .</span><span class="sxs-lookup"><span data-stu-id="ac181-136">Check [**Flags**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) value for **ADS\_FLAG\_OBJECT\_TYPE\_PRESENT** flag.</span></span> <span data-ttu-id="ac181-137">Si **Flags** se establece en **ADS \_ Flag Type (tipo de \_ objeto \_ \_**), llame al método **IADsAccessControlEntry:: get \_ objecttype** para obtener una cadena que contenga el rightsGUID del derecho de acceso de control al que se aplica la ACE.</span><span class="sxs-lookup"><span data-stu-id="ac181-137">If **Flags** is set to **ADS\_FLAG\_OBJECT\_TYPE\_PRESENT**, call the **IADsAccessControlEntry::get\_ObjectType** method to get a string that contains the rightsGUID of the control access right that the ACE applies to.</span></span>
9.  <span data-ttu-id="ac181-138">Llame al método [**IADsAccessControlEntry:: get \_ AceType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) para obtener el tipo de ACE.</span><span class="sxs-lookup"><span data-stu-id="ac181-138">Call the [**IADsAccessControlEntry::get\_AceType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) method to get the ACE type.</span></span> <span data-ttu-id="ac181-139">El tipo será un **\_ \_ \_ \_ objeto permitido de ADS ACETYPE** para conceder al administrador de confianza el derecho de acceso de control o **ADS \_ ACETYPE \_ acceso \_ denegado \_** para denegar el derecho de acceso de control.</span><span class="sxs-lookup"><span data-stu-id="ac181-139">The type will be an **ADS\_ACETYPE\_ACCESS\_ALLOWED\_OBJECT** to grant the trustee the control access right or **ADS\_ACETYPE\_ACCESS\_DENIED\_OBJECT** to deny the control access right.</span></span>
10. <span data-ttu-id="ac181-140">Llame al método [**IADsAccessControlEntry:: get \_ Trustee**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) para obtener la entidad de seguridad; es decir, usuario, grupo, equipo y así sucesivamente al que se aplica la ACE.</span><span class="sxs-lookup"><span data-stu-id="ac181-140">Call the [**IADsAccessControlEntry::get\_Trustee**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) method to get the security principal; that is user, group, computer, and so on to which the ACE applies.</span></span>
11. <span data-ttu-id="ac181-141">Cuando termine con las cadenas [**objecttype**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) y **Trustee** , utilice [**SysFreeString**](/windows/win32/api/oleauto/nf-oleauto-sysfreestring) para liberar la memoria de esas cadenas.</span><span class="sxs-lookup"><span data-stu-id="ac181-141">When finished with the [**ObjectType**](/windows/desktop/ADSI/iadsaccesscontrolentry-property-methods) and **Trustee** strings, use [**SysFreeString**](/windows/win32/api/oleauto/nf-oleauto-sysfreestring) to free the memory for those strings.</span></span>
12. <span data-ttu-id="ac181-142">Cuando termine con las interfaces, llame a **Release** para disminuir o liberar todas las referencias de interfaz.</span><span class="sxs-lookup"><span data-stu-id="ac181-142">When finished with the interfaces, call **Release** to decrement or release all the interface references.</span></span>

 

 