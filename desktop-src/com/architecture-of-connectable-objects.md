---
title: Arquitectura de objetos conectables
description: Arquitectura de objetos conectables
ms.assetid: 69949a3b-3ab8-4054-84d8-9256fbf39c7b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1e9d8d2909942d1c04aed972e7891a6f4ae3f730
ms.sourcegitcommit: d39e82e232f6510f843fdb8d55d25b4e9e02e880
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 02/03/2021
ms.locfileid: "105717318"
---
# <a name="architecture-of-connectable-objects"></a><span data-ttu-id="c25e6-103">Arquitectura de objetos conectables</span><span class="sxs-lookup"><span data-stu-id="c25e6-103">Architecture of Connectable Objects</span></span>

<span data-ttu-id="c25e6-104">El objeto conectable es solo una parte de la arquitectura general de los objetos conectables.</span><span class="sxs-lookup"><span data-stu-id="c25e6-104">The connectable object is only one piece of the overall architecture of connectable objects.</span></span> <span data-ttu-id="c25e6-105">Esta tecnología incluye los siguientes elementos:</span><span class="sxs-lookup"><span data-stu-id="c25e6-105">This technology includes the following elements:</span></span>

-   <span data-ttu-id="c25e6-106">**Objeto conectable.**</span><span class="sxs-lookup"><span data-stu-id="c25e6-106">**Connectable object.**</span></span> <span data-ttu-id="c25e6-107">Implementa la interfaz [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) ; crea al menos un objeto de punto de conexión; define una interfaz de salida para el cliente.</span><span class="sxs-lookup"><span data-stu-id="c25e6-107">Implements the [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) interface; creates at least one connection point object; defines an outgoing interface for the client.</span></span>
-   <span data-ttu-id="c25e6-108">**Nº.**</span><span class="sxs-lookup"><span data-stu-id="c25e6-108">**Client.**</span></span> <span data-ttu-id="c25e6-109">Consulta el objeto para que [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) determine si el objeto es conectable; crea un objeto de receptor para implementar la interfaz de salida definida por el objeto conectable.</span><span class="sxs-lookup"><span data-stu-id="c25e6-109">Queries the object for [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) to determine whether the object is connectable; creates a sink object to implement the outgoing interface defined by the connectable object.</span></span>
-   <span data-ttu-id="c25e6-110">**Objeto receptor.**</span><span class="sxs-lookup"><span data-stu-id="c25e6-110">**Sink object.**</span></span> <span data-ttu-id="c25e6-111">Implementa la interfaz de salida; se utiliza para establecer una conexión con el objeto conectable.</span><span class="sxs-lookup"><span data-stu-id="c25e6-111">Implements the outgoing interface; used to establish a connection to the connectable object.</span></span>
-   <span data-ttu-id="c25e6-112">**Objeto de punto de conexión.**</span><span class="sxs-lookup"><span data-stu-id="c25e6-112">**Connection point object.**</span></span> <span data-ttu-id="c25e6-113">Implementa la interfaz [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) y administra la conexión con el receptor del cliente.</span><span class="sxs-lookup"><span data-stu-id="c25e6-113">Implements the [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) interface and manages connection with the client's sink.</span></span>

<span data-ttu-id="c25e6-114">En el diagrama siguiente se muestran las relaciones entre el cliente, el objeto conectable, un punto de conexión y un receptor:</span><span class="sxs-lookup"><span data-stu-id="c25e6-114">The relationships between client, connectable object, a connection point, and a sink are illustrated in the following diagram:</span></span>

![Diagrama que muestra los puntos de conexión entre el cliente y el objeto conectable.](images/1cd44fec-5d2c-4427-846b-ccab7ec0b08a.png)

<span data-ttu-id="c25e6-116">Antes de que el objeto de punto de conexión llame a los métodos de la interfaz de receptor en el paso 3 del diagrama anterior, debe ejecutar [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) para la interfaz específica necesaria, incluso si el puntero ya se pasó en la llamada de paso 2 al método [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) .</span><span class="sxs-lookup"><span data-stu-id="c25e6-116">Before the connection point object calls methods in the sink interface in step 3 in the preceding diagram, it must [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) for the specific interface required, even if the pointer was already passed in the step 2 call to the [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) method.</span></span>

<span data-ttu-id="c25e6-117">Aunque no se muestra en la ilustración, también hay dos objetos de enumerador implicados en esta arquitectura.</span><span class="sxs-lookup"><span data-stu-id="c25e6-117">Two enumerator objects are also involved in this architecture though not shown in the illustration.</span></span> <span data-ttu-id="c25e6-118">Uno se crea mediante un método en [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) para enumerar los puntos de conexión dentro del objeto conectable.</span><span class="sxs-lookup"><span data-stu-id="c25e6-118">One is created by a method in [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) to enumerate the connection points within the connectable object.</span></span> <span data-ttu-id="c25e6-119">El otro se crea mediante un método en [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) para enumerar las conexiones establecidas actualmente a ese punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="c25e6-119">The other is created by a method in [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) to enumerate the connections currently established to that connection point.</span></span> <span data-ttu-id="c25e6-120">Un punto de conexión puede admitir varias interfaces de receptor conectadas y debe recorrer en iteración la lista de conexiones cada vez que realiza una llamada al método en esa interfaz.</span><span class="sxs-lookup"><span data-stu-id="c25e6-120">One connection point can support multiple connected sink interfaces, and it should iterate through the list of connections each time it makes a method call on that interface.</span></span> <span data-ttu-id="c25e6-121">Este proceso se conoce como multidifusión.</span><span class="sxs-lookup"><span data-stu-id="c25e6-121">This process is known as multicasting.</span></span>

<span data-ttu-id="c25e6-122">Al trabajar con objetos conectables, es importante comprender que el objeto conectable, cada punto de conexión, cada receptor y todos los enumeradores son objetos independientes con implementaciones [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) independientes, recuentos de referencias independientes y duraciones independientes.</span><span class="sxs-lookup"><span data-stu-id="c25e6-122">When working with connectable objects, it is important to understand that the connectable object, each connection point, each sink, and all enumerators are separate objects with separate [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) implementations, separate reference counts, and separate lifetimes.</span></span> <span data-ttu-id="c25e6-123">Un cliente que utiliza estos objetos siempre es responsable de liberar todos los recuentos de referencias que posee.</span><span class="sxs-lookup"><span data-stu-id="c25e6-123">A client using these objects is always responsible for releasing all reference counts it owns.</span></span>

> [!Note]  
> <span data-ttu-id="c25e6-124">Un objeto conectable puede admitir más de un cliente y puede admitir varios receptores dentro de un cliente.</span><span class="sxs-lookup"><span data-stu-id="c25e6-124">A connectable object can support more than one client and can support multiple sinks within a client.</span></span> <span data-ttu-id="c25e6-125">Del mismo modo, un receptor puede estar conectado a más de un objeto conectable.</span><span class="sxs-lookup"><span data-stu-id="c25e6-125">Likewise, a sink can be connected to more than one connectable object.</span></span>

 

<span data-ttu-id="c25e6-126">Los pasos para establecer una conexión entre un cliente y un objeto conectable son los siguientes:</span><span class="sxs-lookup"><span data-stu-id="c25e6-126">The steps for establishing a connection between a client and a connectable object are as follows:</span></span>

1.  <span data-ttu-id="c25e6-127">El cliente consulta [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) en el objeto para determinar si el objeto es conectable.</span><span class="sxs-lookup"><span data-stu-id="c25e6-127">The client queries for [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) on the object to determine whether the object is connectable.</span></span> <span data-ttu-id="c25e6-128">Si esta llamada es correcta, el cliente mantiene un puntero a la interfaz **IConnectionPointContainer** en el objeto conectable y se ha incrementado el contador de referencias de objetos conectables.</span><span class="sxs-lookup"><span data-stu-id="c25e6-128">If this call is successful, the client holds a pointer to the **IConnectionPointContainer** interface on the connectable object and the connectable object reference counter has been incremented.</span></span> <span data-ttu-id="c25e6-129">De lo contrario, el objeto no es conectable y no admite interfaces de salida.</span><span class="sxs-lookup"><span data-stu-id="c25e6-129">Otherwise, the object is not connectable and does not support outgoing interfaces.</span></span>
2.  <span data-ttu-id="c25e6-130">Si el objeto es conectable, el cliente siguiente intenta obtener un puntero a la interfaz [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) en un punto de conexión dentro del objeto conectable.</span><span class="sxs-lookup"><span data-stu-id="c25e6-130">If the object is connectable, the client next tries to obtain a pointer to the [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) interface on a connection point within the connectable object.</span></span> <span data-ttu-id="c25e6-131">Hay dos métodos para obtener este puntero, tanto en [**IConnectionPointContainer:: FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint) como en [**IConnectionPointContainer:: EnumConnectionPoints**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints).</span><span class="sxs-lookup"><span data-stu-id="c25e6-131">There are two methods for obtaining this pointer, both in [**IConnectionPointContainer::FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint) and in [**IConnectionPointContainer::EnumConnectionPoints**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints).</span></span> <span data-ttu-id="c25e6-132">Se necesitan algunos pasos adicionales si se usa **EnumConnectionPoints** .</span><span class="sxs-lookup"><span data-stu-id="c25e6-132">There are a few additional steps needed if **EnumConnectionPoints** is used.</span></span> <span data-ttu-id="c25e6-133">(Consulte [usar IConnectionPointContainer](using-iconnectionpointcontainer.md) para obtener más información). Si es correcto, el objeto conectable y el cliente admiten la misma interfaz de salida.</span><span class="sxs-lookup"><span data-stu-id="c25e6-133">(See [Using IConnectionPointContainer](using-iconnectionpointcontainer.md) for more information.) If successful, the connectable object and the client both support the same outgoing interface.</span></span> <span data-ttu-id="c25e6-134">El objeto conectable lo define y lo llama, y el cliente lo implementa.</span><span class="sxs-lookup"><span data-stu-id="c25e6-134">The connectable object defines it and calls it, and the client implements it.</span></span> <span data-ttu-id="c25e6-135">A continuación, el cliente puede comunicarse a través del punto de conexión dentro del objeto conectable.</span><span class="sxs-lookup"><span data-stu-id="c25e6-135">The client can then communicate through the connection point within the connectable object.</span></span>
3.  <span data-ttu-id="c25e6-136">Después, el cliente llama a [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) en el punto de conexión para establecer una conexión entre su interfaz receptora y el punto de conexión del objeto.</span><span class="sxs-lookup"><span data-stu-id="c25e6-136">The client then calls [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) on the connection point to establish a connection between its sink interface and the object's connection point.</span></span> <span data-ttu-id="c25e6-137">Después de esta llamada, el punto de conexión del objeto contiene un puntero a la interfaz de salida en el receptor.</span><span class="sxs-lookup"><span data-stu-id="c25e6-137">After this call, the object's connection point holds a pointer to the outgoing interface on the sink.</span></span>
4.  <span data-ttu-id="c25e6-138">El código incluido en [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) llama a [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) en el puntero de interfaz que se pasa, solicitando el identificador de interfaz específico al que se conecta.</span><span class="sxs-lookup"><span data-stu-id="c25e6-138">The code inside [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) calls [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) on the interface pointer that is passed in, asking for the specific interface identifier to which it connects.</span></span>
5.  <span data-ttu-id="c25e6-139">El objeto llama a los métodos en la interfaz del receptor según sea necesario, mediante el puntero mantenido por su punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="c25e6-139">The object calls methods on the sink's interface as needed, using the pointer held by its connection point.</span></span>
6.  <span data-ttu-id="c25e6-140">El cliente llama a [**unaconsej**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-unadvise) para finalizar la conexión.</span><span class="sxs-lookup"><span data-stu-id="c25e6-140">The client calls [**Unadvise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-unadvise) to terminate the connection.</span></span> <span data-ttu-id="c25e6-141">Después, el cliente llama a **IConnectionPoint:: Release** para liberar su retención en el punto de conexión y, por lo tanto, también el objeto connectable principal.</span><span class="sxs-lookup"><span data-stu-id="c25e6-141">Then the client calls **IConnectionPoint::Release** to free its hold on the connection point and, therefore, the main connectable object also.</span></span> <span data-ttu-id="c25e6-142">El cliente también debe llamar a **IConnectionPointContainer:: Release** para liberar su suspensión en el objeto connectable principal.</span><span class="sxs-lookup"><span data-stu-id="c25e6-142">The client must also call **IConnectionPointContainer::Release** to free its hold on the main connectable object.</span></span>

## <a name="related-topics"></a><span data-ttu-id="c25e6-143">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="c25e6-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c25e6-144">Interfaces de objeto conectables</span><span class="sxs-lookup"><span data-stu-id="c25e6-144">Connectable Object Interfaces</span></span>](connectable-object-interfaces.md)
</dt> </dl>

 

 




