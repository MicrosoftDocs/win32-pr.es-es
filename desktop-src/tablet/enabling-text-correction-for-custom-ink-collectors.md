---
description: El panel de entrada de Tablet PC de Microsoft es una herramienta eficaz para escribir texto manuscrito con un lápiz y corregir texto sin usar un teclado.
ms.assetid: c45ac1b5-7713-4bcb-a130-4692cff99aa2
title: Habilitar la corrección de texto para los recopiladores de tinta personalizados
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb4dee4c7dfee1489cd002848c496be41f73d953
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "104557082"
---
# <a name="enabling-text-correction-for-custom-ink-collectors"></a>Habilitar la corrección de texto para los recopiladores de tinta personalizados

El panel de entrada de Tablet PC de Microsoft es una herramienta eficaz para escribir texto manuscrito con un lápiz y corregir texto sin usar un teclado. Al usar el panel de entrada, un usuario escribe texto por escritura a mano en las superficies de entrada manuscrita del panel de entrada, lo que hace que el panel de entrada reconozca la escritura a mano del usuario como texto. Una vez reconocido el texto, el usuario puntea insertar en el panel de entrada para insertar el texto en una aplicación o en un documento. Antes de insertar el texto, un usuario tiene acceso a un conjunto de herramientas de corrección del panel de entrada. Entre ellas se incluye la selección de un resultado de reconocimiento alternativo, la capacidad de reescribir un solo carácter o incluso de tachar toda la palabra y volver a escribir. Estas herramientas de corrección permiten a los usuarios corregir los errores de reconocimiento y los errores humanos.

Una vez que el texto escrito con el panel de entrada está en el documento, los usuarios tienen acceso a la misma funcionalidad de corrección que está disponible antes de la inserción en aplicaciones basadas en el [marco de trabajo de servicios de texto](/windows/desktop/TSF/text-services-framework)de Windows y en aplicaciones habilitadas para servicios de texto. A partir de Microsoft Windows XP Service Pack 2 Tablet PC Edition, todas las aplicaciones de edición enriquecidas son servicios de texto habilitados de forma predeterminada y, a partir de Windows Vista, las aplicaciones HTML están habilitadas para servicios de texto de forma predeterminada. La corrección en el documento solo está disponible en aplicaciones basadas en servicios de texto y habilitadas; Esto se debe a que el panel de entrada depende de la capacidad del servicio de texto de almacenar las propiedades de texto asociadas, incluidos los objetos de lápiz y las alternativas de reconocimiento, con el fin de proporcionar una corrección en el documento.

![panel de entrada de Tablet PC con corrección de texto](images/a0dced5e-16de-410b-965f-5d97d297cee5.jpg)

Sin embargo, hay muchos escenarios, entre los que se incluye la corrección del reconocimiento de voz o la corrección de texto escrito en la marcha, que no comienzan con la entrada de texto mediante el panel de entrada, pero en los que la corrección en el documento puede ser muy útil para los usuarios de Tablet PC. Un ejemplo primo es en las aplicaciones que proporcionan superficies de entrada manuscrita personalizadas para escribir texto mediante un lápiz. Las superficies de entradas manuscritas personalizadas son una excelente manera de que las aplicaciones proporcionen una funcionalidad personalizada de forma exclusiva específica para las tareas de entrada de texto de cada aplicación. Además, las superficies de entrada manuscrita personalizadas proporcionan una experiencia de usuario de Tablet PC totalmente integrada, lo que lo hace evidente. el lápiz es un dispositivo de entrada de primera clase en las aplicaciones que los contienen. Sin embargo, es posible que las aplicaciones que proporcionan superficies de entrada manuscrita personalizadas no admitan o no puedan proporcionar el mismo nivel de compatibilidad de corrección disponible en la corrección en el documento del panel de entrada.

![Recopilador de entradas de lápiz personalizado](images/b6797b12-dda6-44c4-87f4-570fe0c23f3a.jpg)

Las aplicaciones basadas en servicios de texto o habilitadas en las que la corrección en el documento es útil para la corrección de texto no especificado mediante el panel de entrada puede usar la API de [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) del panel de entrada (clase [Microsoft. TextInput. HandwrittenTextInsertion](/previous-versions/ms573516(v=vs.100)) en código administrado) para habilitar la corrección en el documento para texto escrito por otros medios. De esta manera, las aplicaciones pueden agregar de forma económica una gran compatibilidad de corrección a sus superficies de entrada manuscritas personalizadas u otros escenarios de entradas de texto, y redondean su historia de entrada de texto de Tablet PC. La API de IHandWrittenTextInsertion del panel de entrada se incluye como parte del sistema operativo Windows Vista y como parte de la versión 1,9 o posterior del SDK de Tablet Platform. Se incluyen una versión basada en .NET y en COM de la API. La habilitación de la corrección en el documento para el texto no especificado mediante el panel de entrada es compatible con Windows Vista y versiones más recientes. La corrección en el documento solo está disponible para idiomas latinos y no puede mostrar ningún carácter fuera del juego de caracteres latinos.

## <a name="how-to-use-the-handwrittentextinsertion-api-in-an-application"></a>Cómo usar la API de HandwrittenTextInsertion en una aplicación

Los cambios necesarios en una aplicación con el fin de integrar la corrección del panel de entrada en el documento para el texto no escrito mediante el panel de entrada y el uso de la API de [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) son sencillos. Todo el código de entrada de texto personalizado de la aplicación permanece sin modificar, excepto en el último paso. En el punto en el que el texto que se escribe con una superficie de entrada manuscrita personalizada, el reconocimiento de voz u otros medios deben mostrarse en un campo de texto servicios de texto habilitado, la aplicación envía el texto a la interfaz **IHandWrittenTextInsertion** en lugar de enviarlo directamente al campo de texto. A continuación, el componente de programación del panel de entrada controla la inserción del texto en el campo de texto y en el almacén de respaldo de servicios de texto. Al agregar el texto al almacén de copia de seguridad de servicios de texto, el componente de programación del panel de entrada controla el establecimiento de las propiedades de texto que requiere el panel de entrada para que se habilite la corrección en el documento para ese texto.

En la siguiente sección se describe detalladamente este proceso para una aplicación de C++ que usa la versión COM de la API de [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) . Hay notas en cualquier lugar en que los pasos para usar la versión de .NET Framework de la API en C \# difieren en el uso de la versión com en C++. La API administrada de **HandwrittenTextInsertion** incluye una única interfaz com, **IHandwrittenTextInsertion**. La definición de esta interfaz se encuentra en PenInputPanel. h y PenInputPanel \_ i.c.

En primer lugar, la aplicación debe usar la función [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) para generar una instancia de [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) con ID. de clase **CLSID \_ HandwrittenTextInsertion**. Tenga en cuenta que la creación de un objeto **\_ HandwrittenTextInsertion de CLSID** solo se realizará correctamente después de que se cree una ventana y tenga el foco, porque hasta entonces no se activa el almacenamiento de copia de seguridad de servicios de texto. Además, si tiptsf.dll no está presente en el sistema, se produce un error en la función **CoCreateInstance** y se devuelve **REGDB \_ e \_ CLASSNOTREG**, lo que indica que no se admite la corrección en el documento del panel de entrada en el sistema. En este momento, la aplicación debe continuar sin intentar habilitar la corrección en el documento del panel de entrada. La instancia de **HandwrittenTextInsertion** debe ser accesible desde el código de la aplicación que controla la inserción de texto en un campo de texto.

> [!Note]  
> Al trabajar con la versión .NET Framework de la API, la aplicación debe agregar una instrucción using para permitir el acceso al espacio de nombres [Microsoft. Ink. TextInput](/previous-versions/dotnet/netframework-3.5/ms581554(v=vs.90)) y, a continuación, crear el objeto directamente.

 

En segundo lugar, el código de la aplicación responsable de insertar texto en un campo de texto debe modificarse para que ya no inserte texto en un campo de texto directamente, sino que llama a uno de los dos métodos de inserción de [**IHandwrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion)en su lugar. El hecho de que las aplicaciones decidan llamar a [**InsertRecognitionResultsArray**](/windows/desktop/api/peninputpanel/nf-peninputpanel-ihandwrittentextinsertion-insertrecognitionresultsarray) o [**InsertRecognitionResults**](/windows/desktop/api/peninputpanel/nf-peninputpanel-ihandwrittentextinsertion-insertinkrecognitionresult) depende de si la aplicación tiene las alternativas de reconocimiento para el texto almacenado como una matriz o como un objeto [**IInkRecognitionResult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult) .

> [!Note]  
> Cuando se trabaja en código administrado, el objeto de reconocimiento correspondiente utilizado por InsertRecognitionResultsArray es [RecognitionResult](/previous-versions/ms552537(v=vs.100)). Ambos métodos consumen los tres parámetros siguientes:

 

-   *alternativas* Es una colección bidimensional de cadenas, almacenada como una matriz de matrices o como un objeto [**IInkRecognitionResult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult) (o [RecognitionResult](/previous-versions/ms552537(v=vs.100))). Si los alternativos se almacenan como una matriz de matrices, se debe pasar como un puntero de matriz segura. Cada entrada de la matriz de nivel superior es una lista de alternativas para una sola palabra en la inserción. La entrada que se encuentra en la posición cero en las submatrices de alternativas es el texto que se inserta en el campo de texto. Las alternativas adicionales (índices del 1 al n en cada submatriz) se almacenan en el almacenamiento de copia de seguridad de servicios de texto y se ofrecen al usuario como opciones como parte de la corrección en el documento. Si no se incluyen alternativas, el usuario verá ' sin sugerencias ' en lugar de la lista de alternativas. Si una inserción contiene varias palabras con espacios entre ellas, cada espacio debe incluirse como una entrada en la matriz de nivel superior.
-   *idioma* de [LCID](/previous-versions/ms221397(v=vs.71)) del idioma de entrada que corresponde al texto contenido en el parámetro de *alternativas* . En el caso en el que el contenido de los *alternativos* fue generado por un reconocedor de escritura a mano o voz, también es la propiedad [**Languages**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizer-get_languages) asociada al reconocedor que se usa.
-   *fLatticeContainsAutoSpacingInformation* Marca que indica si el texto contenido en el parámetro *alternativo* fue generado por un reconocedor con el espaciado automático habilitado. Si se ha habilitado el espaciado automático, la marca debe establecerse en **true**. Si el espaciado automático estaba deshabilitado, la marca debe establecerse en **false**. En el caso en el que el contenido de los *alternativos* fue generado por un reconocedor que no admite el espaciado automático o que no haya generado ningún reconocedor, la marca debe establecerse en **false**.

El modelo de programación del panel de entrada puede insertar el texto en el documento o la aplicación desde la posición del símbolo de intercalación del sistema.

Ambos métodos devuelven **S \_ correcto** si la inserción se realiza correctamente. Devuelven **e \_ nointerface** si la aplicación no está basada en servicios de texto o están habilitadas, e **\_ INVALIDARG** si las *alternativas* no tienen el formato correcto o son inaccesibles. También pueden devolver **e \_ OUTOFMEMORY** si no hay suficiente memoria disponible en el sistema, o se **produce un \_ error en e** después de un error catastrófico, como el marco de trabajo de servicios de texto que no se está habilitando.

### <a name="conclusion"></a>Conclusión

La habilitación de la corrección en el documento del panel de entrada para el texto no especificado mediante el panel de entrada es una manera económica y sencilla de que una aplicación basada en servicios de texto o habilitada complemente un método de entrada o de entrada personalizado con una eficaz funcionalidad de corrección basada en el lápiz. En Windows Vista, todas las aplicaciones enriquecidas de edición y Trident son servicios de texto habilitados. Aunque las superficies de tinta integradas son una opción excelente para agregar una experiencia de usuario de Tablet PC personalizada a una aplicación, solo admiten la mitad de la entrada de texto si no incluyen funcionalidades de corrección. La corrección en el documento proporciona a los usuarios la otra mitad del caso agregando la capacidad de intercambiar una selección para una alternativa de reconocimiento o volver a escribir parte o toda la selección.

## <a name="related-topics"></a>Temas relacionados

<dl> <dt>

[Programar el panel de entrada de texto](programming-the-text-input-panel.md)
</dt> </dl>

 

 
