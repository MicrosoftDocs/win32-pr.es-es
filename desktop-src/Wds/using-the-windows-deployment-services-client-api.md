---
title: Uso de la API de cliente de Servicios de implementación de Windows
description: En entornos donde no se puede usar una solución estándar de servicios de implementación de Windows (WDS) para instalar Windows, la API del cliente de WDS permite a los desarrolladores escribir aplicaciones de implementación personalizadas.
ms.assetid: abe2a7c7-989a-456e-80df-90d5b816db38
keywords:
- Servicios de implementación de Windows servicios de implementación de Windows, uso de la API de cliente
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 872422a5c84bf1d8ea7c3688b122ba2389c1e968
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104077897"
---
# <a name="using-the-windows-deployment-services-client-api"></a><span data-ttu-id="36d89-104">Uso de la API de cliente de Servicios de implementación de Windows</span><span class="sxs-lookup"><span data-stu-id="36d89-104">Using the Windows Deployment Services Client API</span></span>

<span data-ttu-id="36d89-105">En entornos donde no se puede usar una solución estándar de servicios de implementación de Windows (WDS) para instalar Windows, la API del cliente de WDS permite a los desarrolladores escribir aplicaciones de implementación personalizadas.</span><span class="sxs-lookup"><span data-stu-id="36d89-105">In environments where a standard Windows Deployment Services (WDS) solution cannot be used to install Windows, the API of the WDS client enables developers to write custom deployment applications.</span></span> <span data-ttu-id="36d89-106">Las aplicaciones pueden usar esta API para comunicarse con el servidor WDS y obtener información acerca de las imágenes del sistema disponibles en el servidor.</span><span class="sxs-lookup"><span data-stu-id="36d89-106">Applications can use this API to communicate with the WDS server to get information about system images available from the server.</span></span> <span data-ttu-id="36d89-107">Las aplicaciones cliente de WDS personalizadas deben cumplir las siguientes directrices.</span><span class="sxs-lookup"><span data-stu-id="36d89-107">Custom WDS client applications should adhere to the following guidelines.</span></span>

## <a name="install-the-wds-role-on-the-server"></a><span data-ttu-id="36d89-108">Instalación del rol de WDS en el servidor</span><span class="sxs-lookup"><span data-stu-id="36d89-108">Install the WDS Role on the Server</span></span>

-   <span data-ttu-id="36d89-109">Servicios de implementación de Windows (WDS) es la versión revisada de los servicios de instalación remota (RIS). necesitará el rol de servidor de WDS en el servidor para implementar soluciones de cliente de WDS personalizadas.</span><span class="sxs-lookup"><span data-stu-id="36d89-109">Windows Deployment Services (WDS) is the revised version of Remote Installation Services (RIS), you will need the WDS server role on the server to implement custom WDS client solutions.</span></span>
-   <span data-ttu-id="36d89-110">WDS reemplaza a RIS como componente estándar a partir de Windows Server 2008 y Windows Server 2003 con Service Pack 2 (SP2).</span><span class="sxs-lookup"><span data-stu-id="36d89-110">WDS replaces RIS as the standard component starting with Windows Server 2008 and Windows Server 2003 with Service Pack 2 (SP2).</span></span>
-   <span data-ttu-id="36d89-111">Debe actualizar el servidor de RIS a WDS en Windows Server 2003 con Service Pack 1 (SP1).</span><span class="sxs-lookup"><span data-stu-id="36d89-111">You must update the RIS server to WDS on Windows Server 2003 with Service Pack 1 (SP1).</span></span> <span data-ttu-id="36d89-112">Puede instalar el rol de servidor de WDS con el [Kit de instalación automatizada de Windows (WAIK)](https://www.microsoft.com/download/details.aspx?id=10333).</span><span class="sxs-lookup"><span data-stu-id="36d89-112">You can install the WDS server role with the [Windows Automated Installation Kit (WAIK)](https://www.microsoft.com/download/details.aspx?id=10333).</span></span>

## <a name="start-windows-pe-20"></a><span data-ttu-id="36d89-113">Iniciar Windows PE 2,0</span><span class="sxs-lookup"><span data-stu-id="36d89-113">Start Windows PE 2.0</span></span>

<span data-ttu-id="36d89-114">Se debe iniciar Windows PE 2,0, si aún no se ha iniciado.</span><span class="sxs-lookup"><span data-stu-id="36d89-114">Windows PE 2.0 must be started, if not already started.</span></span> <span data-ttu-id="36d89-115">El cliente WDS y los archivos dll auxiliares solo se cargan mediante setup.exe cuando está en la fase de Microsoft Entorno de preinstalación de Windows (Windows PE 2,0) del proceso de instalación.</span><span class="sxs-lookup"><span data-stu-id="36d89-115">The WDS client and supporting DLLs are only loaded by setup.exe when it is in the Microsoft Windows Preinstallation Environment (Windows PE 2.0) phase of setup processing.</span></span>

-   <span data-ttu-id="36d89-116">Cuando un nuevo equipo se conecta a la red, se puede usar la tecnología de entorno de ejecución previo al arranque (PXE) integrada para descargar el programa de arranque de red.</span><span class="sxs-lookup"><span data-stu-id="36d89-116">When a new computer is connected to the network, the built-in preboot execution environment (PXE) technology can be used to download the Network Boot Program.</span></span> <span data-ttu-id="36d89-117">Para obtener más información acerca del arranque con PXE en un equipo para instalar Windows, consulte [la guía paso a paso de actualización de servicios de implementación de Windows](/previous-versions/windows/it-pro/windows-vista/cc766320(v=ws.10)).</span><span class="sxs-lookup"><span data-stu-id="36d89-117">For more information about PXE-booting a computer to install Windows, see [The Windows Deployment Services Update Step-by-Step Guide](/previous-versions/windows/it-pro/windows-vista/cc766320(v=ws.10)).</span></span>
-   <span data-ttu-id="36d89-118">Una imagen de arranque de RAMDISK de Windows PE 2,0 puede almacenarse en. Formato WIM y descargado como parte del proceso de arranque de red.</span><span class="sxs-lookup"><span data-stu-id="36d89-118">A RAMDISK bootable image of Windows PE 2.0 can be stored in the .WIM format and downloaded as part of the network boot process.</span></span> <span data-ttu-id="36d89-119">Windows PE se puede cargar y ejecutar directamente desde ese medio.</span><span class="sxs-lookup"><span data-stu-id="36d89-119">Windows PE can then be loaded and run directly from that media.</span></span>

## <a name="open-a-session-with-the-wds-server"></a><span data-ttu-id="36d89-120">Abrir una sesión con el servidor WDS</span><span class="sxs-lookup"><span data-stu-id="36d89-120">Open a session with the WDS server</span></span>

<span data-ttu-id="36d89-121">El cliente WDS debe abrir una sesión con un servidor WDS.</span><span class="sxs-lookup"><span data-stu-id="36d89-121">The WDS client must open a session with a WDS server.</span></span>

-   <span data-ttu-id="36d89-122">Use la función [**WdsCliCreateSession**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclicreatesession) para abrir una sesión con un servidor WDS.</span><span class="sxs-lookup"><span data-stu-id="36d89-122">Use the [**WdsCliCreateSession**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclicreatesession) function to open a session with a WDS server.</span></span> <span data-ttu-id="36d89-123">Esta función toma el nombre o la dirección IP del servidor y recibe la dirección del identificador de la sesión de cliente de WDS.</span><span class="sxs-lookup"><span data-stu-id="36d89-123">This function takes the name or IP address of the server and receives the address of the handle for the WDS client session.</span></span>
-   <span data-ttu-id="36d89-124">Si al abrir la sesión con el servidor se requiere la autenticación del cliente WDS, la aplicación debe proporcionar la dirección de una estructura [**\_ \_ CRED**](/windows/win32/api/wdsclientapi/ns-wdsclientapi-wds_cli_cred) de la CLI de WDS que contenga las credenciales del cliente al llamar a la función [**WdsCliCreateSession**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclicreatesession) .</span><span class="sxs-lookup"><span data-stu-id="36d89-124">If opening the session with the server will require authenticating the WDS client, the application should provide the address of a [**WDS\_CLI\_CRED**](/windows/win32/api/wdsclientapi/ns-wdsclientapi-wds_cli_cred) structure containing the client credentials when calling the [**WdsCliCreateSession**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclicreatesession) function.</span></span> <span data-ttu-id="36d89-125">La aplicación puede usar la función [**WdsCliAuthorizeSession**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscliauthorizesession) para convertir una sesión anónima en una sesión autenticada.</span><span class="sxs-lookup"><span data-stu-id="36d89-125">The application can use the [**WdsCliAuthorizeSession**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscliauthorizesession) function to convert an anonymous session into an authenticated session.</span></span>
-   <span data-ttu-id="36d89-126">Cuando la sesión abierta con la función [**WdsCliCreateSession**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclicreatesession) ya no es necesaria, la aplicación debe usar la función [**WdsCliClose**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscliclose) para cerrar el identificador y los recursos de liberación que mantiene la sesión.</span><span class="sxs-lookup"><span data-stu-id="36d89-126">When the session opened with the [**WdsCliCreateSession**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclicreatesession) function is no longer needed, the application should use the [**WdsCliClose**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscliclose) function to close the handle and release resources held by the session.</span></span>

## <a name="enumerate-system-images-on-the-wds-server"></a><span data-ttu-id="36d89-127">Enumerar imágenes del sistema en el servidor WDS</span><span class="sxs-lookup"><span data-stu-id="36d89-127">Enumerate system images on the WDS server</span></span>

<span data-ttu-id="36d89-128">El cliente WDS puede usar la API para enumerar las imágenes del sistema en el servidor WDS.</span><span class="sxs-lookup"><span data-stu-id="36d89-128">The WDS client can use the API to enumerate the system images on the WDS server.</span></span>

-   <span data-ttu-id="36d89-129">Use la función [**WdsCliFindFirstImage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclifindfirstimage) para obtener un identificador de la primera imagen e inicializar la enumeración de imágenes en el servidor WDS.</span><span class="sxs-lookup"><span data-stu-id="36d89-129">Use the [**WdsCliFindFirstImage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclifindfirstimage) function to obtain a handle to the first image and to initialize the enumeration of images on the WDS server.</span></span>
-   <span data-ttu-id="36d89-130">Use la función [**WdsCliFindNextImage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclifindnextimage) para incrementar la enumeración iniciada por la función [**WdsCliFindFirstImage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclifindfirstimage) .</span><span class="sxs-lookup"><span data-stu-id="36d89-130">Use the [**WdsCliFindNextImage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclifindnextimage) function to increment the enumeration started by the [**WdsCliFindFirstImage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclifindfirstimage) function.</span></span> <span data-ttu-id="36d89-131">La función **WdsCliFindNextImage** obtiene el identificador de la imagen siguiente.</span><span class="sxs-lookup"><span data-stu-id="36d89-131">The **WdsCliFindNextImage** function gets the handle for the next image.</span></span>
-   <span data-ttu-id="36d89-132">Utilice la función [**WdsCliGetImageIndex**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimageindex) para obtener el índice de imagen de la imagen actual.</span><span class="sxs-lookup"><span data-stu-id="36d89-132">Use the [**WdsCliGetImageIndex**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimageindex) function to obtain the image index for the current image.</span></span> <span data-ttu-id="36d89-133">Este valor solo es válido hasta que se vuelvan a usar las funciones [**WdsCliFindNextImage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclifindnextimage) o [**WdsCliClose**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscliclose) .</span><span class="sxs-lookup"><span data-stu-id="36d89-133">This value is valid only until the [**WdsCliFindNextImage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclifindnextimage) or [**WdsCliClose**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscliclose) functions are used again.</span></span>
-   <span data-ttu-id="36d89-134">Utilice la función [**WdsCliGetEnumerationFlags**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetenumerationflags) para obtener marcas de información sobre el filtrado de imágenes.</span><span class="sxs-lookup"><span data-stu-id="36d89-134">Use the [**WdsCliGetEnumerationFlags**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetenumerationflags) function to get informational flags about image filtering.</span></span>

## <a name="get-information-about-images"></a><span data-ttu-id="36d89-135">Obtener información acerca de las imágenes</span><span class="sxs-lookup"><span data-stu-id="36d89-135">Get information about images</span></span>

<span data-ttu-id="36d89-136">El cliente WDS puede usar la API para obtener información sobre las imágenes en un servidor WDS.</span><span class="sxs-lookup"><span data-stu-id="36d89-136">The WDS client can use the API to get information about the images on a WDS server.</span></span> <span data-ttu-id="36d89-137">Las siguientes funciones obtienen información acerca de la imagen actual.</span><span class="sxs-lookup"><span data-stu-id="36d89-137">The following functions get information about the current image.</span></span> <span data-ttu-id="36d89-138">Dado que las funciones [**WdsCliFindFirstImage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclifindfirstimage) y [**WdsCliFindNextImage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclifindnextimage) cambian el valor de identificador de imagen actual, la aplicación debe almacenar cualquier información que obtenga y necesitará en el futuro antes de volver a llamar a las funciones **WdsCliFindFirstImage** o **WdsCliFindNextImage** .</span><span class="sxs-lookup"><span data-stu-id="36d89-138">Because the [**WdsCliFindFirstImage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclifindfirstimage) and [**WdsCliFindNextImage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclifindnextimage) functions change the current image handle value, the application should store any information it gets and will need in the future before calling the **WdsCliFindFirstImage** or **WdsCliFindNextImage** functions again.</span></span>

-   <span data-ttu-id="36d89-139">Utilice la función [**WdsCliGetImageArchitecture**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagearchitecture) para obtener la arquitectura de procesador de la imagen actual.</span><span class="sxs-lookup"><span data-stu-id="36d89-139">Use the [**WdsCliGetImageArchitecture**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagearchitecture) function to get the processor architecture of the current image.</span></span>
-   <span data-ttu-id="36d89-140">Utilice la función [**WdsCliGetImagePath**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagepath) para obtener la ruta de acceso relativa al archivo de imagen que contiene la imagen actual.</span><span class="sxs-lookup"><span data-stu-id="36d89-140">Use the [**WdsCliGetImagePath**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagepath) function to get the relative path to the image file that contains the current image.</span></span>
-   <span data-ttu-id="36d89-141">Use la función [**WdsCliGetImageSize**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagesize) para obtener el tamaño de la imagen.</span><span class="sxs-lookup"><span data-stu-id="36d89-141">Use the [**WdsCliGetImageSize**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagesize) function to get the image size.</span></span>
-   <span data-ttu-id="36d89-142">Use la función [**WdsCliGetImageVersion**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimageversion) para obtener la versión de la imagen.</span><span class="sxs-lookup"><span data-stu-id="36d89-142">Use the [**WdsCliGetImageVersion**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimageversion) function to get the image version.</span></span>
-   <span data-ttu-id="36d89-143">Utilice la función [**WdsCliGetImageLanguage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagelanguage) para obtener el idioma predeterminado de la imagen actual.</span><span class="sxs-lookup"><span data-stu-id="36d89-143">Use the [**WdsCliGetImageLanguage**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagelanguage) function to get the default language of the current image.</span></span>
-   <span data-ttu-id="36d89-144">Utilice la función [**WdsCliGetImageLanguages**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagelanguages) para obtener una matriz de lenguajes admitidos por la imagen actual.</span><span class="sxs-lookup"><span data-stu-id="36d89-144">Use the [**WdsCliGetImageLanguages**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagelanguages) function to get an array of languages supported by the current image.</span></span>
-   <span data-ttu-id="36d89-145">Use [**WdsCliGetImageLastModifiedTime**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagelastmodifiedtime) devuelve la hora de la última modificación de la imagen actual.</span><span class="sxs-lookup"><span data-stu-id="36d89-145">Use the [**WdsCliGetImageLastModifiedTime**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagelastmodifiedtime) returns the last-modified time for the current image.</span></span>
-   <span data-ttu-id="36d89-146">Utilice la función [**WdsCliGetImageName**](/windows/win32/api/WdsClientApi/nf-wdsclientapi-wdscligetimagename) para obtener el nombre de la imagen actual.</span><span class="sxs-lookup"><span data-stu-id="36d89-146">Use the [**WdsCliGetImageName**](/windows/win32/api/WdsClientApi/nf-wdsclientapi-wdscligetimagename) function to get the name of the current image.</span></span>
-   <span data-ttu-id="36d89-147">Utilice la función [**WdsCliGetImageDescription**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagedescription) para obtener la descripción de la imagen actual.</span><span class="sxs-lookup"><span data-stu-id="36d89-147">Use the [**WdsCliGetImageDescription**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagedescription) function to get the description of the current image.</span></span>
-   <span data-ttu-id="36d89-148">Utilice la función [**WdsCliGetImageGroup**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagegroup) para obtener el nombre del grupo de imágenes de la imagen actual.</span><span class="sxs-lookup"><span data-stu-id="36d89-148">Use the [**WdsCliGetImageGroup**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagegroup) function to get the image group name for the current image.</span></span>
-   <span data-ttu-id="36d89-149">Utilice la función [**WdsCliGetImageHalName**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagehalname) para obtener el nombre de la capa de abstracción de hardware (HAL) de la imagen actual.</span><span class="sxs-lookup"><span data-stu-id="36d89-149">Use the [**WdsCliGetImageHalName**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscligetimagehalname) function to get the Hardware Abstraction Layer (HAL) name for the current image.</span></span>

## <a name="log-wds-client-events"></a><span data-ttu-id="36d89-150">Registrar eventos de cliente de WDS</span><span class="sxs-lookup"><span data-stu-id="36d89-150">Log WDS Client Events</span></span>

<span data-ttu-id="36d89-151">La funcionalidad de registro de la biblioteca de cliente de WDS permite enviar eventos de progreso de la instalación desde el cliente al servidor WDS.</span><span class="sxs-lookup"><span data-stu-id="36d89-151">The logging functionality of the WDS client library enables installation progress events to be sent from the client to the WDS server.</span></span>

-   <span data-ttu-id="36d89-152">Use la función [**WdsCliInitializeLog**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscliinitializelog) para inicializar el registro para la sesión de cliente de WDS.</span><span class="sxs-lookup"><span data-stu-id="36d89-152">Use the [**WdsCliInitializeLog**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdscliinitializelog) function to initialize the log for the WDS client session.</span></span>
-   <span data-ttu-id="36d89-153">Utilice la función [**WdsCliLog**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclilog) para escribir mensajes de eventos en el registro del servidor WDS.</span><span class="sxs-lookup"><span data-stu-id="36d89-153">Use the [**WdsCliLog**](/windows/win32/api/WdsClientAPI/nf-wdsclientapi-wdsclilog) function to write event messages to the WDS server log.</span></span>
-   <span data-ttu-id="36d89-154">En Windows Server 2008, el servidor WDS escribe eventos de cliente en un registro de eventos específico de la aplicación que se pueden ver a través de eventvwr.exe, así como el registro de seguimiento de depuración.</span><span class="sxs-lookup"><span data-stu-id="36d89-154">On Windows Server 2008, the WDS server writes client events to an application specific event log that is viewable through eventvwr.exe as well as the debug trace log.</span></span> <span data-ttu-id="36d89-155">En Windows Server 2003 con el registro de depuración habilitado, el servidor WDS escribirá eventos de cliente en el archivo de registro que se encuentra en% WINDIR% \\ Tracing \\ WDSServer. log.</span><span class="sxs-lookup"><span data-stu-id="36d89-155">On Windows Server 2003 with debug logging enabled, the WDS server will write client events to the log file located at %windir%\\tracing\\wdsserver.log.</span></span> <span data-ttu-id="36d89-156">El registro de cliente de WDS debe estar habilitado en el servidor para capturar estos eventos.</span><span class="sxs-lookup"><span data-stu-id="36d89-156">WDS Client logging must be enabled on the server to capture these events.</span></span>

## <a name="related-topics"></a><span data-ttu-id="36d89-157">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="36d89-157">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="36d89-158">Acerca de la API de servicios de implementación de Windows</span><span class="sxs-lookup"><span data-stu-id="36d89-158">About the Windows Deployment Services API</span></span>](about-the-windows-deployment-services-api.md)
</dt> <dt>

[<span data-ttu-id="36d89-159">Uso de la API de servidor de Servicios de implementación de Windows</span><span class="sxs-lookup"><span data-stu-id="36d89-159">Using the Windows Deployment Services Server API</span></span>](using-the-windows-deployment-services-server-api.md)
</dt> </dl>

 

 