---
description: Control de almacenamiento en caché en NTFS transaccional.
ms.assetid: 0fd272ee-cf5f-4ba9-b8aa-ff0016f51d4b
title: Implementar NTFS transaccional
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bd7c44e0ad3b83854e56d18171072a7cb4615d5c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104001569"
---
# <a name="deploying-transactional-ntfs"></a><span data-ttu-id="e72a5-103">Implementar NTFS transaccional</span><span class="sxs-lookup"><span data-stu-id="e72a5-103">Deploying Transactional NTFS</span></span>

<span data-ttu-id="e72a5-104">NTFS transaccional (TxF), al igual que la mayoría de los mecanismos de transacciones, depende del orden correcto de las escrituras de datos.</span><span class="sxs-lookup"><span data-stu-id="e72a5-104">Transactional NTFS (TxF), like most transaction mechanisms, depends upon correct ordering of data writes.</span></span> <span data-ttu-id="e72a5-105">Garantizar el orden correcto de escritura requiere un control explícito del almacenamiento en caché de los datos.</span><span class="sxs-lookup"><span data-stu-id="e72a5-105">Ensuring proper write ordering requires explicit control of data caching.</span></span> <span data-ttu-id="e72a5-106">Para cumplir este requisito, TxF requiere que las unidades de disco implementen los mecanismos de control de almacenamiento en caché que forman parte de interfaces de unidad normalizadas como SCSI, SATA y ATA.</span><span class="sxs-lookup"><span data-stu-id="e72a5-106">To meet this requirement, TxF requires that disk drives implement the caching control mechanisms that are part of standardized drive interfaces such as SCSI, SATA, and ATA.</span></span>

<span data-ttu-id="e72a5-107">El mecanismo de control de almacenamiento en caché que usa TxF es una marca conocida como la función Force Unit Access (FUA).</span><span class="sxs-lookup"><span data-stu-id="e72a5-107">The caching control mechanism used by TxF is a flag known as the Force Unit Access (FUA) function.</span></span> <span data-ttu-id="e72a5-108">Esta marca especifica que la unidad debe escribir los datos en el almacenamiento de medios estable antes de que se complete la señalización.</span><span class="sxs-lookup"><span data-stu-id="e72a5-108">This flag specifies that the drive should write the data to stable media storage before signaling complete.</span></span> <span data-ttu-id="e72a5-109">En determinados puntos críticos de una transacción, TxF debe emitir un FUA para asegurarse de que algunos datos de control necesarios para revertir correctamente una transacción no se pierdan si se produce un error de alimentación.</span><span class="sxs-lookup"><span data-stu-id="e72a5-109">At certain critical points within a transaction, TxF needs to issue an FUA to ensure that some control data necessary to successfully rollback a transaction is not lost if a power failure occurs.</span></span>

<span data-ttu-id="e72a5-110">Las unidades de disco de clase de servidor (canal SCSI y Fiber) suelen admitir la marca FUA.</span><span class="sxs-lookup"><span data-stu-id="e72a5-110">Server-class disk drives (SCSI and Fiber Channel) generally support the FUA flag.</span></span> <span data-ttu-id="e72a5-111">A partir de vista, Windows admite la marca FUA solo para discos SCSI y de canal de fibra.</span><span class="sxs-lookup"><span data-stu-id="e72a5-111">Starting in Vista, Windows supports the FUA flag only for SCSI and Fiber Channel disks.</span></span>

<span data-ttu-id="e72a5-112">En las unidades de disco (ATA/SATA/USB), TxF tiene períodos de vulnerabilidades durante los cuales un error de alimentación de la unidad puede dar lugar a que TxF no pueda revertir correctamente la transacción, lo que evita que los datos tengan un estado incoherente a menos que la memoria caché de escritura de la unidad esté deshabilitada.</span><span class="sxs-lookup"><span data-stu-id="e72a5-112">On commodity drives (ATA/SATA/USB), TxF has periods of vulnerability during which a drive power failure can result in TxF being unable to correctly rollback the transaction, thus leaving data in an inconsistent state unless the drive's write cache is disabled.</span></span>

<span data-ttu-id="e72a5-113">Algunos adaptadores de bus host (HBA) y controladores de almacenamiento (por ejemplo, sistemas RAID) tienen memorias caché integradas con respaldo de batería.</span><span class="sxs-lookup"><span data-stu-id="e72a5-113">Some Host Bus Adapters (HBAs) and storage controllers (for example, RAID systems) have built-in battery-backed caches.</span></span> <span data-ttu-id="e72a5-114">Dado que estos dispositivos conservan los datos en caché si se produce un error de alimentación, no es necesario que todos los discos conectados a ellos cumplan la marca FUA.</span><span class="sxs-lookup"><span data-stu-id="e72a5-114">Because these devices preserve cached data if a power fault occurs, any disks connected to them are not required to honor the FUA flag.</span></span> <span data-ttu-id="e72a5-115">Además, un disco cuya fuente de alimentación esté protegida por un sistema de alimentación ininterrumpida (SAI) no necesita cumplir la marca FUA.</span><span class="sxs-lookup"><span data-stu-id="e72a5-115">Further, a disk whose power supply is protected by an uninterruptable power supply (UPS) does not need to honor the FUA flag.</span></span> <span data-ttu-id="e72a5-116">Esto se debe a que el SAI mantendrá el tiempo suficiente para que el disco vacíe su memoria caché al medio.</span><span class="sxs-lookup"><span data-stu-id="e72a5-116">This is because the UPS will maintain power long enough for the disk to flush its cache to the media.</span></span>

<span data-ttu-id="e72a5-117">Al deshabilitar la caché de escritura de una unidad, se elimina el requisito de que la unidad respete la marca FUA.</span><span class="sxs-lookup"><span data-stu-id="e72a5-117">Disabling a drive's write cache eliminates the requirement for the drive to honor the FUA flag.</span></span> <span data-ttu-id="e72a5-118">Puede deshabilitar el almacenamiento en caché de escritura de un disco emitiendo el código de control de la [**\_ \_ \_ memoria caché \_ del conjunto de discos ioctl**](/windows/desktop/api/WinIoCtl/ni-winioctl-ioctl_disk_set_cache_information) en el disco.</span><span class="sxs-lookup"><span data-stu-id="e72a5-118">You can disable a disk's write caching by issuing the [**IOCTL\_DISK\_SET\_CACHE\_INFORMATION**](/windows/desktop/api/WinIoCtl/ni-winioctl-ioctl_disk_set_cache_information) control code to the disk.</span></span> <span data-ttu-id="e72a5-119">El estado de la memoria caché de escritura (activada/desactivada) se conservará entre los reinicios del sistema.</span><span class="sxs-lookup"><span data-stu-id="e72a5-119">The state of the write cache (on/off) will be preserved across system reboots.</span></span> <span data-ttu-id="e72a5-120">La emisión de este código de control tendrá consecuencias de rendimiento muy significativas para todas las operaciones de e/s emitidas en ese disco, lo que probablemente supondrá una degradación notable del rendimiento.</span><span class="sxs-lookup"><span data-stu-id="e72a5-120">Issuing this control code will have very significant performance consequences for all I/O issued to that disk, which will most likely be a noticeable performance degradation.</span></span> <span data-ttu-id="e72a5-121">El uso de este código de control debe considerarse detenidamente antes de la implementación.</span><span class="sxs-lookup"><span data-stu-id="e72a5-121">Use of this control code should be carefully considered prior to deployment.</span></span>

> [!Note]  
> <span data-ttu-id="e72a5-122">Para que TxF sea capaz de proteger sistemáticamente la integridad de los datos a través de errores de energía, el sistema debe cumplir al menos uno de los siguientes criterios:</span><span class="sxs-lookup"><span data-stu-id="e72a5-122">For TxF to be capable of consistently protecting your data's integrity through power faults, the system must satisfy at least one of the following criteria:</span></span>
>
> -   <span data-ttu-id="e72a5-123">Usar discos de clase de servidor (SCSI, canal de fibra).</span><span class="sxs-lookup"><span data-stu-id="e72a5-123">Use server-class disks (SCSI, Fiber Channel).</span></span>
> -   <span data-ttu-id="e72a5-124">Asegúrese de que los discos estén conectados a un HBA de almacenamiento en caché con respaldo de batería.</span><span class="sxs-lookup"><span data-stu-id="e72a5-124">Make sure the disks are connected to a battery-backed caching HBA.</span></span>
> -   <span data-ttu-id="e72a5-125">Use un controlador de almacenamiento (por ejemplo, sistema RAID) como dispositivo de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="e72a5-125">Use a storage controller (for example, RAID system) as the storage device.</span></span>
> -   <span data-ttu-id="e72a5-126">Asegúrese de que el disco está protegido por un SAI.</span><span class="sxs-lookup"><span data-stu-id="e72a5-126">Ensure power to the disk is protected by a UPS.</span></span>
> -   <span data-ttu-id="e72a5-127">Asegúrese de que la característica de almacenamiento en caché de escritura del disco está deshabilitada.</span><span class="sxs-lookup"><span data-stu-id="e72a5-127">Ensure that the disk's write caching feature is disabled.</span></span>

 

 

 



