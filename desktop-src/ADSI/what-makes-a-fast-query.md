---
title: Cómo realiza una consulta rápida
description: En este tema se enumeran los métodos de programación preferidos que se usan al consultar un directorio.
ms.assetid: d96f330f-3c57-4edc-9fd2-970f908b54c2
ms.tgt_platform: multiple
keywords:
- Qué hace una consulta rápida ADSI
- consultas ADSI, qué hace una consulta rápida
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 883db1e9de7b7b7a1179c814d6f66f774685083e
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/21/2020
ms.locfileid: "103904823"
---
# <a name="what-makes-a-fast-query"></a><span data-ttu-id="bb9d8-105">¿Qué hace una consulta rápida?</span><span class="sxs-lookup"><span data-stu-id="bb9d8-105">What Makes a Fast Query?</span></span>

<span data-ttu-id="bb9d8-106">Tenga en cuenta los siguientes conceptos de mejora del rendimiento al ejecutar una consulta:</span><span class="sxs-lookup"><span data-stu-id="bb9d8-106">Consider the following performance enhancement concepts when executing a query:</span></span>

-   <span data-ttu-id="bb9d8-107">Si es posible, filtre solo por atributos indexados.</span><span class="sxs-lookup"><span data-stu-id="bb9d8-107">If possible, filter on indexed attributes only.</span></span> <span data-ttu-id="bb9d8-108">Use los atributos de índice que espera que generen el menor número de aciertos.</span><span class="sxs-lookup"><span data-stu-id="bb9d8-108">Use index attributes that you expect will generate the fewest number of hits.</span></span> <span data-ttu-id="bb9d8-109">Para obtener más información y una lista completa de los atributos indexados para Windows, vea [Active Directory esquema](/windows/desktop/ADSchema/active-directory-schema).</span><span class="sxs-lookup"><span data-stu-id="bb9d8-109">For more information and a comprehensive list of indexed attributes for Windows, see [Active Directory Schema](/windows/desktop/ADSchema/active-directory-schema).</span></span>
-   <span data-ttu-id="bb9d8-110">Busque en **objectCategory** en lugar de **objectClass** porque **objectClass** no es una propiedad indizada.</span><span class="sxs-lookup"><span data-stu-id="bb9d8-110">Search on **objectCategory** instead of **objectClass** because **objectClass** is not an indexed property.</span></span>
-   <span data-ttu-id="bb9d8-111">Tenga en cuenta las referencias.</span><span class="sxs-lookup"><span data-stu-id="bb9d8-111">Be aware of referrals.</span></span> <span data-ttu-id="bb9d8-112">Considere la posibilidad de buscar en el catálogo global si los atributos se muestran como GC replicados.</span><span class="sxs-lookup"><span data-stu-id="bb9d8-112">Consider searching the global catalog if your attributes are listed as GC replicated.</span></span>
-   <span data-ttu-id="bb9d8-113">Evite buscar texto en el centro y al final de una cadena.</span><span class="sxs-lookup"><span data-stu-id="bb9d8-113">Avoid searching for text in the middle and at the end of a string.</span></span> <span data-ttu-id="bb9d8-114">Por ejemplo, "CN = \* Hille \* " o "CN = \* Larouse".</span><span class="sxs-lookup"><span data-stu-id="bb9d8-114">For example, "cn=\*hille\*" or "cn=\*larouse".</span></span>
-   <span data-ttu-id="bb9d8-115">Supongamos que una búsqueda de subárbol devolverá un conjunto de resultados grande.</span><span class="sxs-lookup"><span data-stu-id="bb9d8-115">Assume that a subtree search will return a large result set.</span></span> <span data-ttu-id="bb9d8-116">Use la paginación al realizar búsquedas de subárbol.</span><span class="sxs-lookup"><span data-stu-id="bb9d8-116">Use paging when performing subtree searches.</span></span> <span data-ttu-id="bb9d8-117">A continuación, el servidor podrá transmitir un conjunto de resultados grande en fragmentos, lo que reduce los recursos de memoria del servidor.</span><span class="sxs-lookup"><span data-stu-id="bb9d8-117">The server will then be able to stream a large result set in chunks reducing the server-side memory resources.</span></span> <span data-ttu-id="bb9d8-118">Esto simplifica el uso de la red y reduce la necesidad de enviar fragmentos de datos extremadamente grandes a través de la red.</span><span class="sxs-lookup"><span data-stu-id="bb9d8-118">This effectively flattens out network usage and reduces the need for sending extremely large chunks of data over the network.</span></span>
-   <span data-ttu-id="bb9d8-119">Considere correctamente el ámbito de las búsquedas para que no recupere más de lo necesario.</span><span class="sxs-lookup"><span data-stu-id="bb9d8-119">Properly scope your searches so as to not retrieve more than is necessary.</span></span>
-   <span data-ttu-id="bb9d8-120">Realice una búsqueda compleja en varios atributos, ya que el rendimiento es menor que si se realizan varias búsquedas.</span><span class="sxs-lookup"><span data-stu-id="bb9d8-120">Perform a complex search on multiple attributes, because it is less performance intensive than performing multiple searches.</span></span> <span data-ttu-id="bb9d8-121">Una búsqueda de un objeto que lee dos atributos es más eficaz que dos búsquedas para el mismo objeto, cada uno de los cuales devuelve un atributo.</span><span class="sxs-lookup"><span data-stu-id="bb9d8-121">One search for an object that reads two attributes is more efficient than two searches for the same object, each returning one attribute.</span></span>
-   <span data-ttu-id="bb9d8-122">Para leer el atributo con un gran número de valores, use límites de intervalo para minimizar el tamaño de búsqueda, de modo que pueda leer algunos miles de miembros a la vez.</span><span class="sxs-lookup"><span data-stu-id="bb9d8-122">For reading attribute with a large number of values, use range limits to minimize the search size so that you can read a few thousand members at a time.</span></span> <span data-ttu-id="bb9d8-123">Para obtener más información sobre cómo especificar los límites de los intervalos de atributo, consulte [recuperación de intervalos de atributos](attribute-range-retrieval.md).</span><span class="sxs-lookup"><span data-stu-id="bb9d8-123">For more information about specifying attribute range limits, see [Attribute Range Retrieval](attribute-range-retrieval.md).</span></span>
-   <span data-ttu-id="bb9d8-124">Enlazar a un objeto que contiene el identificador de enlace para el resto de la sesión.</span><span class="sxs-lookup"><span data-stu-id="bb9d8-124">Bind to an object hold the binding handle for the remainder of your session.</span></span> <span data-ttu-id="bb9d8-125">No enlace y desenlace para cada llamada.</span><span class="sxs-lookup"><span data-stu-id="bb9d8-125">Do not bind and unbind for each call.</span></span> <span data-ttu-id="bb9d8-126">Si usa ADO o OLE DB, no cree muchos objetos de conexión.</span><span class="sxs-lookup"><span data-stu-id="bb9d8-126">If you are using ADO or OLE DB, do not create many connection objects.</span></span>
-   <span data-ttu-id="bb9d8-127">Lea el rootDSE una vez y recuerde su contenido durante el resto de la sesión.</span><span class="sxs-lookup"><span data-stu-id="bb9d8-127">Read the rootDSE once and remember its contents for the remainder of your session.</span></span>

 

 