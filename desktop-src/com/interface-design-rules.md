---
title: Reglas de diseño de interfaz
description: En esta sección se proporciona un breve resumen de las reglas y las instrucciones de diseño de la interfaz.
ms.assetid: c43fc385-bcd6-45fc-91b2-ad9827fdb15c
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5c1cde73527ac79a2e4442910e3053ed96748337
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/21/2020
ms.locfileid: "104149645"
---
# <a name="interface-design-rules"></a><span data-ttu-id="81a58-103">Reglas de diseño de interfaz</span><span class="sxs-lookup"><span data-stu-id="81a58-103">Interface Design Rules</span></span>

<span data-ttu-id="81a58-104">En esta sección se proporciona un breve resumen de las reglas y las instrucciones de diseño de la interfaz.</span><span class="sxs-lookup"><span data-stu-id="81a58-104">This section provides a short summary of interface design rules and guidelines.</span></span> <span data-ttu-id="81a58-105">Algunas de estas reglas son específicas de la arquitectura COM, mientras que otras son restricciones impuestas por el lenguaje de diseño de la interfaz, MIDL.</span><span class="sxs-lookup"><span data-stu-id="81a58-105">Some of these rules are specific to the COM architecture, while others are restrictions imposed by the interface design language, MIDL.</span></span> <span data-ttu-id="81a58-106">Para obtener información detallada sobre el diseño de la interfaz COM, vea [anatomía de un archivo IDL](anatomy-of-an-idl-file.md).</span><span class="sxs-lookup"><span data-stu-id="81a58-106">For details of COM interface design, see [Anatomy of an IDL File](anatomy-of-an-idl-file.md).</span></span>

<span data-ttu-id="81a58-107">Por definición, un objeto no es un objeto COM a menos que implemente la interfaz [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) o una interfaz que se deriva de **IUnknown**.</span><span class="sxs-lookup"><span data-stu-id="81a58-107">By definition, an object is not a COM object unless it implements either the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface or an interface that is derived from **IUnknown**.</span></span> <span data-ttu-id="81a58-108">Además, las siguientes reglas se aplican a todas las interfaces implementadas en un objeto COM:</span><span class="sxs-lookup"><span data-stu-id="81a58-108">In addition, the following rules apply to all interfaces implemented on a COM object:</span></span>

-   <span data-ttu-id="81a58-109">Deben tener un identificador de interfaz único (IID).</span><span class="sxs-lookup"><span data-stu-id="81a58-109">They must have a unique interface identifier (IID).</span></span>
-   <span data-ttu-id="81a58-110">Deben ser inmutables.</span><span class="sxs-lookup"><span data-stu-id="81a58-110">They must be immutable.</span></span> <span data-ttu-id="81a58-111">Una vez que se crean y publican, ninguna parte de la definición puede cambiar.</span><span class="sxs-lookup"><span data-stu-id="81a58-111">Once they are created and published, no part of their definition may change.</span></span>
-   <span data-ttu-id="81a58-112">Todos los métodos de interfaz deben devolver un valor **HRESULT** para que las partes del sistema que controlan el procesamiento remoto puedan notificar errores de RPC.</span><span class="sxs-lookup"><span data-stu-id="81a58-112">All interface methods must return an **HRESULT** value so that the portions of the system that handle remote processing can report RPC errors.</span></span>
-   <span data-ttu-id="81a58-113">Todos los parámetros de cadena de los métodos de interfaz deben ser Unicode.</span><span class="sxs-lookup"><span data-stu-id="81a58-113">All string parameters in interface methods must be Unicode.</span></span>
-   <span data-ttu-id="81a58-114">Los tipos de datos deben ser remotos.</span><span class="sxs-lookup"><span data-stu-id="81a58-114">Your data types must be remotable.</span></span> <span data-ttu-id="81a58-115">Si no puede convertir un tipo de datos en un tipo utilizable de forma remota, tendrá que crear sus propias rutinas de serialización y desserialización.</span><span class="sxs-lookup"><span data-stu-id="81a58-115">If you cannot convert a data type to a remotable type, you will have to create your own marshaling and unmarshaling routines.</span></span> <span data-ttu-id="81a58-116">También, **LPVOID** o **void \***, no tiene ningún significado en un equipo remoto.</span><span class="sxs-lookup"><span data-stu-id="81a58-116">Also, **LPVOID**, or **void \***, has no meaning on a remote computer.</span></span> <span data-ttu-id="81a58-117">Use un puntero a [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown), si es necesario.</span><span class="sxs-lookup"><span data-stu-id="81a58-117">Use a pointer to [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown), if necessary.</span></span>

> [!Note]  
> <span data-ttu-id="81a58-118">La implementación actual de MIDL no controla la sobrecarga de funciones o la herencia múltiple.</span><span class="sxs-lookup"><span data-stu-id="81a58-118">The current implementation of MIDL does not handle function overloading or multiple inheritance.</span></span>

 

## <a name="other-interface-design-considerations"></a><span data-ttu-id="81a58-119">Otras consideraciones de diseño de la interfaz</span><span class="sxs-lookup"><span data-stu-id="81a58-119">Other Interface Design Considerations</span></span>

<span data-ttu-id="81a58-120">Use punteros a datos con sumo cuidado.</span><span class="sxs-lookup"><span data-stu-id="81a58-120">Use pointers to data very carefully.</span></span> <span data-ttu-id="81a58-121">Para volver a crear los datos en el espacio de direcciones del proceso al que se llama, el tiempo de ejecución de RPC debe conocer el tamaño exacto de los datos.</span><span class="sxs-lookup"><span data-stu-id="81a58-121">To re-create the data in the address space of the process that is called, the RPC run time must know the exact size of the data.</span></span> <span data-ttu-id="81a58-122">Si, por ejemplo, un **parámetro \* Char** apunta a un búfer de caracteres en lugar de a un solo carácter, no se pueden volver a crear correctamente los datos.</span><span class="sxs-lookup"><span data-stu-id="81a58-122">If, for example, a **CHAR \*** parameter points to a buffer of characters rather than to a single character, the data cannot be correctly re-created.</span></span> <span data-ttu-id="81a58-123">Use la sintaxis disponible con MIDL para describir con precisión las estructuras de datos representadas por las definiciones de tipo.</span><span class="sxs-lookup"><span data-stu-id="81a58-123">Use the syntax available with MIDL to accurately describe the data structures represented by your type definitions.</span></span>

<span data-ttu-id="81a58-124">La inicialización es esencial para los punteros que se incrustan en matrices y estructuras y se pasan a través de los límites del proceso.</span><span class="sxs-lookup"><span data-stu-id="81a58-124">Initialization is essential for pointers that are embedded in arrays and structures and passed across process boundaries.</span></span> <span data-ttu-id="81a58-125">Los punteros no inicializados pueden funcionar cuando se pasan a un programa en el mismo espacio de proceso, pero los servidores proxy y los códigos auxiliares suponen que todos los punteros se inicializan con direcciones válidas o son NULL.</span><span class="sxs-lookup"><span data-stu-id="81a58-125">Uninitialized pointers may work when passed to a program in the same process space, but proxies and stubs assume that all pointers are initialized with valid addresses or are null.</span></span>

<span data-ttu-id="81a58-126">Tenga cuidado al aplicar alias a los punteros (permitiendo que los punteros señalen a la misma parte de la memoria).</span><span class="sxs-lookup"><span data-stu-id="81a58-126">Be careful when aliasing pointers (allowing pointers to point to the same piece of memory).</span></span> <span data-ttu-id="81a58-127">Si el alias es intencionado, estos punteros se deben declarar con alias en el archivo IDL.</span><span class="sxs-lookup"><span data-stu-id="81a58-127">If the aliasing is intentional, these pointers should be declared aliased in the IDL file.</span></span> <span data-ttu-id="81a58-128">Los punteros declarados como sin alias no deben tener el alias nunca.</span><span class="sxs-lookup"><span data-stu-id="81a58-128">Pointers declared as nonaliased should never alias each other.</span></span>

<span data-ttu-id="81a58-129">Preste atención a la asignación y liberación de memoria.</span><span class="sxs-lookup"><span data-stu-id="81a58-129">Pay attention to how you allocate and free memory.</span></span> <span data-ttu-id="81a58-130">Recuerde que, a menos que indique explícitamente que un objeto COM (mediante el atributo [**allocate**](/windows/desktop/Midl/allocate) ) no libere una estructura de datos que se creó durante una llamada fuera de proceso, esa estructura se destruirá cuando se complete la llamada.</span><span class="sxs-lookup"><span data-stu-id="81a58-130">Remember that, unless you explicitly tell a COM object (by using the [**allocate**](/windows/desktop/Midl/allocate) attribute) not to free a data structure that was created during an out-of-process call, that structure will be destroyed when the call completes.</span></span> <span data-ttu-id="81a58-131">Además, tenga en cuenta la sobrecarga potencialmente destructiva creada por una asignación ineficaz de estructuras de datos en las que se deben calcular las referencias y cuyas referencias no se han calculado.</span><span class="sxs-lookup"><span data-stu-id="81a58-131">Also, consider the potentially destructive overhead created by inefficient allocation of data structures that now need to be marshaled and unmarshaled.</span></span>

<span data-ttu-id="81a58-132">Por último, tenga cuidado al definir los valores devueltos **HRESULT** para no crear códigos de error que entren en conflicto con los códigos ITF de la instalación definida por com \_ (los valores entre 0x0000 y 0x01FF están reservados) o que entren en conflicto con otros valores **HRESULT** con el mismo valor.</span><span class="sxs-lookup"><span data-stu-id="81a58-132">Finally, be careful when defining your **HRESULT** return values so that you don't create error codes that conflict with COM-defined FACILITY\_ITF codes (values between 0x0000 and 0x01FF are reserved) or that conflict with other **HRESULT** values with the same value.</span></span> <span data-ttu-id="81a58-133">Siempre que sea posible, use los valores devueltos de correcto y error de COM universal y use un parámetro de [**salida**](/windows/desktop/Midl/out-idl) , en lugar de un **valor HRESULT**, para devolver información específica de la llamada de función.</span><span class="sxs-lookup"><span data-stu-id="81a58-133">Whenever possible, use the universal COM success and failure return values, and use an [**out**](/windows/desktop/Midl/out-idl) parameter, rather than an **HRESULT**, to return information specific to the function call.</span></span>

<span data-ttu-id="81a58-134">Para obtener más información, vea los temas siguientes:</span><span class="sxs-lookup"><span data-stu-id="81a58-134">For more information, see the following topics:</span></span>

-   [<span data-ttu-id="81a58-135">Diseño de interfaces remotas</span><span class="sxs-lookup"><span data-stu-id="81a58-135">Designing Remotable Interfaces</span></span>](designing-remotable-interfaces.md)
-   [<span data-ttu-id="81a58-136">Usar una interfaz COM</span><span class="sxs-lookup"><span data-stu-id="81a58-136">Using a COM Interface</span></span>](using-a-com-interface.md)

## <a name="related-topics"></a><span data-ttu-id="81a58-137">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="81a58-137">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="81a58-138">Definiciones de interfaz y bibliotecas de tipos</span><span class="sxs-lookup"><span data-stu-id="81a58-138">Interface Definitions and Type Libraries</span></span>](/windows/desktop/Midl/interface-definitions-and-type-libraries)
</dt> </dl>

 

 