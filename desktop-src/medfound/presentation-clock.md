---
description: Reloj de presentación
ms.assetid: cb8bb62a-ef80-4de0-9a44-3bb77edc9dd5
title: Reloj de presentación
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5f61ad02537a2591c681db78721376651f7854ec
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104155336"
---
# <a name="presentation-clock"></a><span data-ttu-id="4968d-103">Reloj de presentación</span><span class="sxs-lookup"><span data-stu-id="4968d-103">Presentation Clock</span></span>

<span data-ttu-id="4968d-104">El *reloj* de la presentación es un objeto que genera la hora de reloj de una presentación.</span><span class="sxs-lookup"><span data-stu-id="4968d-104">The *presentation clock* is an object that generates the clock time for a presentation.</span></span> <span data-ttu-id="4968d-105">El tiempo indicado por el reloj de la presentación se denomina *tiempo de presentación*.</span><span class="sxs-lookup"><span data-stu-id="4968d-105">The time reported by the presentation clock is called the *presentation time*.</span></span> <span data-ttu-id="4968d-106">Todas las secuencias de una presentación se sincronizan con el tiempo de presentación.</span><span class="sxs-lookup"><span data-stu-id="4968d-106">All streams in a presentation are synchronized to the presentation time.</span></span> <span data-ttu-id="4968d-107">El reloj de la presentación expone las siguientes interfaces.</span><span class="sxs-lookup"><span data-stu-id="4968d-107">The presentation clock exposes the following interfaces.</span></span>



| <span data-ttu-id="4968d-108">Interfaz</span><span class="sxs-lookup"><span data-stu-id="4968d-108">Interface</span></span>                                            | <span data-ttu-id="4968d-109">Descripción</span><span class="sxs-lookup"><span data-stu-id="4968d-109">Description</span></span>                                         |
|------------------------------------------------------|-----------------------------------------------------|
| [<span data-ttu-id="4968d-110">**IMFPresentationClock**</span><span class="sxs-lookup"><span data-stu-id="4968d-110">**IMFPresentationClock**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfpresentationclock) | <span data-ttu-id="4968d-111">Interfaz principal para usar el reloj de presentación.</span><span class="sxs-lookup"><span data-stu-id="4968d-111">Primary interface for using the presentation clock.</span></span> |
| [<span data-ttu-id="4968d-112">**IMFRateControl**</span><span class="sxs-lookup"><span data-stu-id="4968d-112">**IMFRateControl**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfratecontrol)             | <span data-ttu-id="4968d-113">Controla la velocidad del reloj.</span><span class="sxs-lookup"><span data-stu-id="4968d-113">Controls the clock rate.</span></span>                            |
| [<span data-ttu-id="4968d-114">**IMFTimer**</span><span class="sxs-lookup"><span data-stu-id="4968d-114">**IMFTimer**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imftimer)                         | <span data-ttu-id="4968d-115">Proporciona una devolución de llamada del temporizador.</span><span class="sxs-lookup"><span data-stu-id="4968d-115">Provides a timer callback.</span></span>                          |
| [<span data-ttu-id="4968d-116">**IMFShutdown**</span><span class="sxs-lookup"><span data-stu-id="4968d-116">**IMFShutdown**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfshutdown)                   | <span data-ttu-id="4968d-117">Apaga el reloj de la presentación.</span><span class="sxs-lookup"><span data-stu-id="4968d-117">Shuts down the presentation clock.</span></span>                  |



 

<span data-ttu-id="4968d-118">Los receptores de medios usan el tiempo de presentación para programar el momento de representación de los ejemplos.</span><span class="sxs-lookup"><span data-stu-id="4968d-118">Media sinks use the presentation time to schedule when to render samples.</span></span> <span data-ttu-id="4968d-119">Cada vez que un receptor de medios recibe un nuevo ejemplo, obtiene la marca de tiempo del ejemplo y representa el ejemplo en el momento indicado o lo más cerca posible de ese tiempo.</span><span class="sxs-lookup"><span data-stu-id="4968d-119">Whenever a media sink receives a new sample, it gets the time stamp from the sample and renders the sample at the indicated time, or as close to that time as possible.</span></span> <span data-ttu-id="4968d-120">Dado que todos los receptores de medios de una topología comparten el mismo reloj de presentación, se sincronizan varias secuencias (como audio y vídeo).</span><span class="sxs-lookup"><span data-stu-id="4968d-120">Because all of the media sinks in a topology share the same presentation clock, multiple streams (such as audio and video) are synchronized.</span></span> <span data-ttu-id="4968d-121">Los orígenes y las transformaciones multimedia no usan el reloj de la presentación, ya que no se programan cuando se entregan ejemplos.</span><span class="sxs-lookup"><span data-stu-id="4968d-121">Media sources and transforms do not use the presentation clock, because they do not schedule when to deliver samples.</span></span> <span data-ttu-id="4968d-122">En su lugar, generan ejemplos cada vez que la canalización solicita un nuevo ejemplo.</span><span class="sxs-lookup"><span data-stu-id="4968d-122">Instead, they produce samples whenever the pipeline requests a new sample.</span></span>

<span data-ttu-id="4968d-123">Si usa la sesión multimedia para la reproducción, la sesión multimedia controla todos los detalles de la creación del reloj de la presentación, la selección de un origen de hora y la notificación de los receptores de medios.</span><span class="sxs-lookup"><span data-stu-id="4968d-123">If you are using the Media Session for playback, the Media Session handles all of the details of creating the presentation clock, selecting a time source, and notifying the media sinks.</span></span> <span data-ttu-id="4968d-124">La aplicación podría usar el reloj de la presentación para obtener el tiempo de presentación actual durante la reproducción, pero de lo contrario no llamará a ningún método en el reloj de la presentación.</span><span class="sxs-lookup"><span data-stu-id="4968d-124">Your application might use the presentation clock to get the current presentation time during playback, but otherwise will not call any methods on the presentation clock.</span></span>

## <a name="clock-time-and-clock-states"></a><span data-ttu-id="4968d-125">Hora del reloj y Estados del reloj</span><span class="sxs-lookup"><span data-stu-id="4968d-125">Clock Time and Clock States</span></span>

<span data-ttu-id="4968d-126">Para obtener la hora del reloj más reciente desde el reloj de la presentación, llame a [**IMFPresentationClock:: getTime**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-gettime).</span><span class="sxs-lookup"><span data-stu-id="4968d-126">To get the latest clock time from the presentation clock, call [**IMFPresentationClock::GetTime**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-gettime).</span></span> <span data-ttu-id="4968d-127">Los tiempos de reloj siempre están en unidades de 100-nanosegundos, por lo que un segundo es 10 millones (10 ^ 7) TICs.</span><span class="sxs-lookup"><span data-stu-id="4968d-127">Clock times are always in 100-nanosecond units, so one second is 10,000,000 (10^7) ticks.</span></span> <span data-ttu-id="4968d-128">Esto corresponde a una frecuencia de 10 MHz.</span><span class="sxs-lookup"><span data-stu-id="4968d-128">This corresponds to a frequency of 10 MHz.</span></span>

<span data-ttu-id="4968d-129">El reloj de la presentación tiene tres Estados: en ejecución, en pausa y detenido.</span><span class="sxs-lookup"><span data-stu-id="4968d-129">The presentation clock has three states: Running, paused, and stopped.</span></span>

-   <span data-ttu-id="4968d-130">Para ejecutar el reloj, llame a [**IMFPresentationClock:: Start**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-start).</span><span class="sxs-lookup"><span data-stu-id="4968d-130">To run the clock, call [**IMFPresentationClock::Start**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-start).</span></span> <span data-ttu-id="4968d-131">El método **Start** especifica la hora de inicio del reloj.</span><span class="sxs-lookup"><span data-stu-id="4968d-131">The **Start** method specifies the clock's starting time.</span></span> <span data-ttu-id="4968d-132">Mientras se ejecuta el reloj, la hora del reloj se incrementa desde la hora de inicio, a la velocidad de reloj actual.</span><span class="sxs-lookup"><span data-stu-id="4968d-132">While the clock is running, the clock time increments from the starting time, at the current clock rate.</span></span>
-   <span data-ttu-id="4968d-133">Para pausar el reloj, llame a [**IMFPresentationClock::P ause**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-pause).</span><span class="sxs-lookup"><span data-stu-id="4968d-133">To pause the clock, call [**IMFPresentationClock::Pause**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-pause).</span></span> <span data-ttu-id="4968d-134">Mientras el reloj está en pausa, la hora del reloj no avanza y [**getTime**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-gettime) devuelve la hora a la que se pausó el reloj.</span><span class="sxs-lookup"><span data-stu-id="4968d-134">While the clock is paused, the clock time does not advance, and [**GetTime**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-gettime) returns the time at which the clock was paused.</span></span>
-   <span data-ttu-id="4968d-135">Para detener el reloj, llame a [**IMFPresentationClock:: Stop**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-stop).</span><span class="sxs-lookup"><span data-stu-id="4968d-135">To stop the clock, call [**IMFPresentationClock::Stop**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-stop).</span></span> <span data-ttu-id="4968d-136">Cuando se detiene el reloj, la hora del reloj no avanza y [**getTime**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-gettime) devuelve cero.</span><span class="sxs-lookup"><span data-stu-id="4968d-136">When the clock is stopped, the clock time does not advance, and [**GetTime**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-gettime) returns zero.</span></span>

<span data-ttu-id="4968d-137">De forma predeterminada, el reloj avanza a una velocidad de 1,0, lo que significa 1 TIC por 100 nanosegundos.</span><span class="sxs-lookup"><span data-stu-id="4968d-137">By default, the clock advances at a rate of 1.0, meaning 1 tick per 100 nanoseconds.</span></span> <span data-ttu-id="4968d-138">Para cambiar la velocidad a la que avanza el reloj, consulte el reloj de presentación de la interfaz [**IMFRateControl**](/windows/desktop/api/mfidl/nn-mfidl-imfratecontrol) y llame a [**IMFRateControl:: SetRate**](/windows/desktop/api/mfidl/nf-mfidl-imfratecontrol-setrate).</span><span class="sxs-lookup"><span data-stu-id="4968d-138">To change the rate at which the clock advances, query the presentation clock for the [**IMFRateControl**](/windows/desktop/api/mfidl/nn-mfidl-imfratecontrol) interface and call [**IMFRateControl::SetRate**](/windows/desktop/api/mfidl/nf-mfidl-imfratecontrol-setrate).</span></span>

<span data-ttu-id="4968d-139">Los objetos pueden recibir notificaciones de cambios de estado (incluidos los cambios de velocidad) del reloj de presentación.</span><span class="sxs-lookup"><span data-stu-id="4968d-139">Objects can receive notifications of state changes (including rate changes) from the presentation clock.</span></span> <span data-ttu-id="4968d-140">Para recibir notificaciones, implemente la interfaz [**IMFClockStateSink**](/windows/desktop/api/mfidl/nn-mfidl-imfclockstatesink) y llame a [**IMFPresentationClock:: AddClockStateSink**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-addclockstatesink) en el reloj de la presentación.</span><span class="sxs-lookup"><span data-stu-id="4968d-140">To receive notifications, implement the [**IMFClockStateSink**](/windows/desktop/api/mfidl/nn-mfidl-imfclockstatesink) interface and call [**IMFPresentationClock::AddClockStateSink**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-addclockstatesink) on the presentation clock.</span></span> <span data-ttu-id="4968d-141">Antes de apagar, llame a [**IMFPresentationClock:: RemoveClockStateSink**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-removeclockstatesink) para anular el registro del objeto.</span><span class="sxs-lookup"><span data-stu-id="4968d-141">Before shutting down, call [**IMFPresentationClock::RemoveClockStateSink**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-removeclockstatesink) to unregister the object.</span></span> <span data-ttu-id="4968d-142">Los receptores de medios usan este mecanismo para recibir notificaciones del reloj.</span><span class="sxs-lookup"><span data-stu-id="4968d-142">Media sinks use this mechanism to receive notifications from the clock.</span></span>

## <a name="presentation-times"></a><span data-ttu-id="4968d-143">Tiempos de presentación</span><span class="sxs-lookup"><span data-stu-id="4968d-143">Presentation Times</span></span>

<span data-ttu-id="4968d-144">Un receptor de medios intenta programar cada ejemplo para que el ejemplo se represente en el momento correcto o lo más cerca posible de la hora correcta.</span><span class="sxs-lookup"><span data-stu-id="4968d-144">A media sink tries to schedule each sample so that the sample is rendered at the correct time, or as close to the correct time as possible.</span></span> <span data-ttu-id="4968d-145">Se aplican las siguientes definiciones:</span><span class="sxs-lookup"><span data-stu-id="4968d-145">The following definitions apply:</span></span>

-   <span data-ttu-id="4968d-146">*Tiempo de presentación.*</span><span class="sxs-lookup"><span data-stu-id="4968d-146">*Presentation time.*</span></span> <span data-ttu-id="4968d-147">La hora a la que se debe representar una muestra.</span><span class="sxs-lookup"><span data-stu-id="4968d-147">The time when a sample should be rendered.</span></span> <span data-ttu-id="4968d-148">El tiempo se expresa en unidades de 100 nanosegundos.</span><span class="sxs-lookup"><span data-stu-id="4968d-148">Time is given in units of 100 nanoseconds.</span></span>
-   <span data-ttu-id="4968d-149">*Tiempo medio.*</span><span class="sxs-lookup"><span data-stu-id="4968d-149">*Media time.*</span></span> <span data-ttu-id="4968d-150">Hora relativa al inicio del contenido.</span><span class="sxs-lookup"><span data-stu-id="4968d-150">Time relative to the start of the content.</span></span> <span data-ttu-id="4968d-151">Por ejemplo, si un archivo de vídeo tiene una longitud de 10 segundos, la mitad del punto a través del archivo tiene un tiempo medio de 5 segundos.</span><span class="sxs-lookup"><span data-stu-id="4968d-151">For example, if a video file is 10 seconds long, the point half way through the file has a media time of 5 seconds.</span></span>
-   <span data-ttu-id="4968d-152">*Marca de tiempo.*</span><span class="sxs-lookup"><span data-stu-id="4968d-152">*Time stamp.*</span></span> <span data-ttu-id="4968d-153">La hora marcada en un ejemplo multimedia.</span><span class="sxs-lookup"><span data-stu-id="4968d-153">The time marked on a media sample.</span></span> <span data-ttu-id="4968d-154">Para obtener la marca de tiempo, llame a [**IMFSample:: GetSampleTime**](/windows/desktop/api/mfobjects/nf-mfobjects-imfsample-getsampletime).</span><span class="sxs-lookup"><span data-stu-id="4968d-154">To get the time stamp, call [**IMFSample::GetSampleTime**](/windows/desktop/api/mfobjects/nf-mfobjects-imfsample-getsampletime).</span></span> <span data-ttu-id="4968d-155">Cuando un origen de medios produce un ejemplo, establece la marca de tiempo igual a la hora del medio.</span><span class="sxs-lookup"><span data-stu-id="4968d-155">When a media source produces a sample, it sets the time stamp equal to the media time.</span></span> <span data-ttu-id="4968d-156">La sesión multimedia traduce la marca de tiempo en tiempo de presentación.</span><span class="sxs-lookup"><span data-stu-id="4968d-156">The Media Session translates the time stamp into presentation time.</span></span>

<span data-ttu-id="4968d-157">De forma predeterminada, la hora del medio y el tiempo de presentación son los mismos, por ejemplo, si aparece un fotograma de vídeo de 5 segundos en el archivo de origen, la hora del medio y el tiempo de presentación son 5 segundos.</span><span class="sxs-lookup"><span data-stu-id="4968d-157">By default, media time and presentation time are the same, For example, if a video frame appears 5 seconds into the source file, the media time and the presentation time are both 5 seconds.</span></span> <span data-ttu-id="4968d-158">Si usa el origen del [secuenciador](sequencer-source.md), el modelo de control de tiempo es algo más complicado, para permitir transiciones suaves entre segmentos.</span><span class="sxs-lookup"><span data-stu-id="4968d-158">If you are using the [Sequencer Source](sequencer-source.md), the timing model is somewhat more complicated, to enable smooth transitions between segments.</span></span> <span data-ttu-id="4968d-159">Para obtener más información sobre el modelo de control de tiempo del origen del secuenciador, vea [tiempos de presentación de secuencias](sequence-presentation-times.md).</span><span class="sxs-lookup"><span data-stu-id="4968d-159">For more information about the sequencer source's timing model, see [Sequence Presentation Times](sequence-presentation-times.md).</span></span>

<span data-ttu-id="4968d-160">El origen multimedia siempre establece la marca de tiempo igual a la hora del medio.</span><span class="sxs-lookup"><span data-stu-id="4968d-160">The media source always sets the time stamp equal to the media time.</span></span> <span data-ttu-id="4968d-161">Si el tiempo de presentación no está alineado con la hora del medio, la sesión multimedia convierte las marcas de tiempo en los ejemplos de medios.</span><span class="sxs-lookup"><span data-stu-id="4968d-161">If presentation time is not aligned with media time, the Media Session converts the time stamps on the media samples.</span></span> <span data-ttu-id="4968d-162">En el momento en que el receptor recibe un ejemplo, la marca de tiempo del ejemplo se ha convertido en el tiempo de presentación.</span><span class="sxs-lookup"><span data-stu-id="4968d-162">By the time the sink receives a sample, the sample's time stamp has been converted to presentation time.</span></span> <span data-ttu-id="4968d-163">El receptor programa el ejemplo con la hora actual del reloj de presentación.</span><span class="sxs-lookup"><span data-stu-id="4968d-163">The sink schedules the sample against the presentation clock's current time.</span></span> <span data-ttu-id="4968d-164">(Los receptores sin velocidad son una excepción, ya que omiten el reloj de la presentación).</span><span class="sxs-lookup"><span data-stu-id="4968d-164">(Rateless sinks are an exception, because they ignore the presentation clock.)</span></span>

<span data-ttu-id="4968d-165">Si la aplicación busca una nueva posición, la sesión multimedia reinicia el reloj de la presentación en el tiempo de búsqueda especificado.</span><span class="sxs-lookup"><span data-stu-id="4968d-165">If the application seeks to a new position, the Media Session restarts the presentation clock at the specified seek time.</span></span> <span data-ttu-id="4968d-166">Por ejemplo, si la aplicación busca la posición de 5 segundos en el archivo, la sesión multimedia inicia el reloj en 5 segundos.</span><span class="sxs-lookup"><span data-stu-id="4968d-166">For example, if the application seeks to the 5-second position in the file, the Media Session starts the clock at 5 seconds.</span></span> <span data-ttu-id="4968d-167">El origen multimedia podría proporcionar muestras con una marca de tiempo ligeramente anterior si el tiempo de búsqueda no se encuentra en un límite de fotogramas clave.</span><span class="sxs-lookup"><span data-stu-id="4968d-167">The media source might deliver samples with a slightly earlier time stamp if the seek time does not fall on a key-frame boundary.</span></span> <span data-ttu-id="4968d-168">Esto es necesario para que los descodificadores puedan descodificar todos los marcos.</span><span class="sxs-lookup"><span data-stu-id="4968d-168">This is required so that the decoders can decode all of the frames.</span></span> <span data-ttu-id="4968d-169">La sesión multimedia quita o recorta muestras antes de que lleguen a los receptores de medios, con el fin de que coincidan con el tiempo de búsqueda solicitado.</span><span class="sxs-lookup"><span data-stu-id="4968d-169">The Media Session drops or trims samples before they reach the media sinks, in order to match the requested seek time.</span></span> <span data-ttu-id="4968d-170">Por ejemplo, si el tiempo de búsqueda es de 5 segundos, la primera muestra de audio podría comenzar en 4,5 segundos.</span><span class="sxs-lookup"><span data-stu-id="4968d-170">For example, if the seek time is 5 seconds, the first audio sample might start at 4.5 seconds.</span></span> <span data-ttu-id="4968d-171">La sesión multimedia recortará los primeros 0,5 segundos del primer ejemplo de audio descodificado.</span><span class="sxs-lookup"><span data-stu-id="4968d-171">The Media Session will trim the first 0.5 seconds from the first decoded audio sample.</span></span>

## <a name="creating-the-presentation-clock"></a><span data-ttu-id="4968d-172">Crear el reloj de la presentación</span><span class="sxs-lookup"><span data-stu-id="4968d-172">Creating the Presentation Clock</span></span>

<span data-ttu-id="4968d-173">Para crear el reloj de la presentación, llame a [**MFCreatePresentationClock**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepresentationclock).</span><span class="sxs-lookup"><span data-stu-id="4968d-173">To create the presentation clock, call [**MFCreatePresentationClock**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepresentationclock).</span></span> <span data-ttu-id="4968d-174">Para apagar el reloj, consulte la interfaz [**IMFShutdown**](/windows/desktop/api/mfidl/nn-mfidl-imfshutdown) y llame a [**IMFShutdown:: Shutdown**](/windows/desktop/api/mfidl/nf-mfidl-imfshutdown-shutdown).</span><span class="sxs-lookup"><span data-stu-id="4968d-174">To shut down the clock, query for the [**IMFShutdown**](/windows/desktop/api/mfidl/nn-mfidl-imfshutdown) interface and call [**IMFShutdown::Shutdown**](/windows/desktop/api/mfidl/nf-mfidl-imfshutdown-shutdown).</span></span> <span data-ttu-id="4968d-175">El autor de la llamada de **MFCreatePresentationClock** es responsable de llamar a **Shutdown**; en la mayoría de los casos, se trata de la sesión multimedia en lugar de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4968d-175">The caller of **MFCreatePresentationClock** is responsible for calling **Shutdown**; in most cases, this is the Media Session rather than the application.</span></span>

## <a name="presentation-time-sources"></a><span data-ttu-id="4968d-176">Orígenes de tiempo de presentación</span><span class="sxs-lookup"><span data-stu-id="4968d-176">Presentation Time Sources</span></span>

<span data-ttu-id="4968d-177">A pesar de su nombre, el reloj de la presentación no implementa realmente un reloj.</span><span class="sxs-lookup"><span data-stu-id="4968d-177">Despite its name, the presentation clock does not actually implement a clock.</span></span> <span data-ttu-id="4968d-178">En su lugar, obtiene las horas de reloj de otro objeto, denominado *origen de tiempo de presentación*.</span><span class="sxs-lookup"><span data-stu-id="4968d-178">Instead, it gets the clock times from another object, called a *presentation time source*.</span></span> <span data-ttu-id="4968d-179">El origen de la hora puede ser cualquier objeto que genere TICs de reloj precisos y exponga la interfaz [**IMFPresentationTimeSource**](/windows/desktop/api/mfidl/nn-mfidl-imfpresentationtimesource) .</span><span class="sxs-lookup"><span data-stu-id="4968d-179">The time source can be any object that generates accurate clock ticks and exposes the [**IMFPresentationTimeSource**](/windows/desktop/api/mfidl/nn-mfidl-imfpresentationtimesource) interface.</span></span> <span data-ttu-id="4968d-180">En la siguiente ilustración se muestra este proceso.</span><span class="sxs-lookup"><span data-stu-id="4968d-180">The following illustration shows this process.</span></span>

![diagrama que muestra la relación entre el reloj de presentación y el origen de tiempo de presentación](images/dedc255c-eb6d-49fc-8892-7b6076ed4488.gif)

<span data-ttu-id="4968d-182">Cuando el reloj de la presentación se crea por primera vez, no tiene un origen de hora.</span><span class="sxs-lookup"><span data-stu-id="4968d-182">When the presentation clock is first created, it does not have a time source.</span></span> <span data-ttu-id="4968d-183">Para establecer el origen de la hora, llame a [**IMFPresentationClock:: SetTimeSource**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-settimesource) con un puntero a la interfaz [**IMFPresentationTimeSource**](/windows/desktop/api/mfidl/nn-mfidl-imfpresentationtimesource) del origen de la hora.</span><span class="sxs-lookup"><span data-stu-id="4968d-183">To set the time source, call [**IMFPresentationClock::SetTimeSource**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-settimesource) with a pointer to the time source's [**IMFPresentationTimeSource**](/windows/desktop/api/mfidl/nn-mfidl-imfpresentationtimesource) interface.</span></span> <span data-ttu-id="4968d-184">Un origen de hora admite los mismos Estados que el reloj de presentación (en ejecución, en pausa y detenerse) y debe implementar la interfaz [**IMFClockStateSink**](/windows/desktop/api/mfidl/nn-mfidl-imfclockstatesink) .</span><span class="sxs-lookup"><span data-stu-id="4968d-184">A time source supports the same states as the presentation clock (running, paused, and stop), and must implement the [**IMFClockStateSink**](/windows/desktop/api/mfidl/nn-mfidl-imfclockstatesink) interface.</span></span> <span data-ttu-id="4968d-185">El reloj de la presentación usa esta interfaz para notificar al origen de la hora Cuándo cambiar el estado.</span><span class="sxs-lookup"><span data-stu-id="4968d-185">The presentation clock uses this interface to notify the time source when to change state.</span></span> <span data-ttu-id="4968d-186">De esta manera, el origen de la hora proporciona los tics del reloj, pero el reloj de la presentación inicia los cambios de estado en el reloj.</span><span class="sxs-lookup"><span data-stu-id="4968d-186">In this way, the time source provides the clock ticks, but the presentation clock initiates state changes in the clock.</span></span>

<span data-ttu-id="4968d-187">Algunos receptores de medios tienen acceso a un reloj preciso y, por lo tanto, exponen la interfaz [**IMFPresentationTimeSource**](/windows/desktop/api/mfidl/nn-mfidl-imfpresentationtimesource) .</span><span class="sxs-lookup"><span data-stu-id="4968d-187">Some media sinks have access to an accurate clock, and therefore expose the [**IMFPresentationTimeSource**](/windows/desktop/api/mfidl/nn-mfidl-imfpresentationtimesource) interface.</span></span> <span data-ttu-id="4968d-188">En concreto, el representador de audio puede usar la frecuencia de la tarjeta de sonido como reloj.</span><span class="sxs-lookup"><span data-stu-id="4968d-188">In particular, the audio renderer can use the frequency of the sound card as a clock.</span></span> <span data-ttu-id="4968d-189">En la reproducción de audio, es útil que el procesador de audio actúe como el origen de la hora, de modo que el vídeo se sincronice con la velocidad de reproducción de audio.</span><span class="sxs-lookup"><span data-stu-id="4968d-189">In audio playback, it is useful for the audio renderer to act as the time source, so that video is synchronized to the audio playback rate.</span></span> <span data-ttu-id="4968d-190">Por lo general, esto genera mejores resultados que intentar hacer coincidir el audio con un reloj externo.</span><span class="sxs-lookup"><span data-stu-id="4968d-190">This generally produces better results than attempting to match the audio to an external clock.</span></span>

<span data-ttu-id="4968d-191">Media Foundation también proporciona un origen de tiempo de presentación basado en el reloj del sistema.</span><span class="sxs-lookup"><span data-stu-id="4968d-191">Media Foundation also provides a presentation time source based on the system clock.</span></span> <span data-ttu-id="4968d-192">Para crear este objeto, llame a [**MFCreateSystemTimeSource**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatesystemtimesource).</span><span class="sxs-lookup"><span data-stu-id="4968d-192">To create this object, call [**MFCreateSystemTimeSource**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatesystemtimesource).</span></span> <span data-ttu-id="4968d-193">El origen de la hora del sistema se puede usar cuando ningún receptor de medios proporciona un origen de hora.</span><span class="sxs-lookup"><span data-stu-id="4968d-193">The system time source can be used when no media sinks provide a time source.</span></span>

<span data-ttu-id="4968d-194">En general, un receptor de medios debe usar el reloj de presentación que se le proporcionó, independientemente de la hora en la que se use el reloj de presentación.</span><span class="sxs-lookup"><span data-stu-id="4968d-194">In general, a media sink must use the presentation clock provided to it, regardless of which time source the presentation clock uses.</span></span> <span data-ttu-id="4968d-195">Esta regla se aplica incluso cuando un receptor de medios implementa [**IMFPresentationTimeSource**](/windows/desktop/api/mfidl/nn-mfidl-imfpresentationtimesource).</span><span class="sxs-lookup"><span data-stu-id="4968d-195">This rule applies even when a media sink implements [**IMFPresentationTimeSource**](/windows/desktop/api/mfidl/nn-mfidl-imfpresentationtimesource).</span></span> <span data-ttu-id="4968d-196">Si el reloj de la presentación utiliza algún otro origen de hora, el receptor de medios debe seguir ese origen de hora, no su propio reloj interno.</span><span class="sxs-lookup"><span data-stu-id="4968d-196">If the presentation clock uses some other time source, the media sink must follow that time source, not its own internal clock.</span></span>

<span data-ttu-id="4968d-197">Hay dos situaciones en las que un receptor de medios no seguirá el reloj de la presentación:</span><span class="sxs-lookup"><span data-stu-id="4968d-197">There are two situations when a media sink will not follow the presentation clock:</span></span>

-   <span data-ttu-id="4968d-198">Algunos receptores de medios tienen *tasas*.</span><span class="sxs-lookup"><span data-stu-id="4968d-198">Some media sinks are *rateless*.</span></span> <span data-ttu-id="4968d-199">Si un receptor de medios tiene una limitación, consume ejemplos lo más rápido posible, sin programarlos según el reloj de la presentación.</span><span class="sxs-lookup"><span data-stu-id="4968d-199">If a media sink is rateless, it consumes samples as quickly as possible, without scheduling them according to the presentation clock.</span></span> <span data-ttu-id="4968d-200">Normalmente, los receptores sin velocidad escriben datos en un archivo, por lo que es conveniente completar la operación lo más rápido posible.</span><span class="sxs-lookup"><span data-stu-id="4968d-200">Typically, rateless sinks write data to a file, so it is desirable to complete the operation as quickly as possible.</span></span> <span data-ttu-id="4968d-201">Un receptor sin velocidad devuelve la \_ marca sin velocidad MEDIASINK en su [**método IMFMediaSink:: GetCharacteristics**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasink-getcharacteristics) .</span><span class="sxs-lookup"><span data-stu-id="4968d-201">A rateless sink returns the MEDIASINK\_RATELESS flag in its [**IMFMediaSink::GetCharacteristics**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasink-getcharacteristics) method.</span></span> <span data-ttu-id="4968d-202">Cuando todos los receptores de una topología no tienen una frecuencia, la sesión multimedia inserta los datos a través de la canalización lo más rápido posible.</span><span class="sxs-lookup"><span data-stu-id="4968d-202">When all the sinks in a topology are rateless, the Media Session pushes data through the pipeline as quickly as possible.</span></span>

-   <span data-ttu-id="4968d-203">Algunos receptores de medios no pueden coincidir con tasas con un origen de hora distinto de ellos mismos.</span><span class="sxs-lookup"><span data-stu-id="4968d-203">Some media sinks cannot match rates with a time source other than themselves.</span></span> <span data-ttu-id="4968d-204">Si es así, el receptor devuelve el MEDIASINK \_ no puede \_ coincidir con la \_ marca del reloj en su método [**GetCharacteristics**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasink-getcharacteristics) .</span><span class="sxs-lookup"><span data-stu-id="4968d-204">If so, the sink returns the MEDIASINK\_CANNOT\_MATCH\_CLOCK flag in its [**GetCharacteristics**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasink-getcharacteristics) method.</span></span> <span data-ttu-id="4968d-205">La canalización puede seguir usando otro origen de hora, pero los resultados serán inferiores a los óptimos.</span><span class="sxs-lookup"><span data-stu-id="4968d-205">The pipeline can still use another time source, but the results will be less than optimal.</span></span> <span data-ttu-id="4968d-206">El receptor probablemente se retrasará y provocará problemas durante la reproducción.</span><span class="sxs-lookup"><span data-stu-id="4968d-206">The sink will likely fall behind and cause glitches during playback.</span></span>

## <a name="related-topics"></a><span data-ttu-id="4968d-207">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="4968d-207">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4968d-208">API de Media Foundation Platform</span><span class="sxs-lookup"><span data-stu-id="4968d-208">Media Foundation Platform APIs</span></span>](media-foundation-platform-apis.md)
</dt> </dl>

 

 



