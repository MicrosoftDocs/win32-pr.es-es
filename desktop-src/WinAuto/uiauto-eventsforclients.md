---
title: Suscribirse a eventos de UI Automation
description: La automatización de la interfaz de usuario de Microsoft permite a los clientes suscribirse a eventos de interés. Esta funcionalidad mejora el rendimiento al eliminar la necesidad de sondear continuamente los elementos de la interfaz de usuario del sistema para ver si ha cambiado la información, la estructura o el estado.
ms.assetid: 7019ecb8-6123-4e00-926c-6725d7e71385
keywords:
- clientes, eventos de UI Automation
- clientes, eventos para la automatización de la interfaz de usuario
- Automatización de la interfaz de usuario, eventos para clientes
- Automatización de la interfaz de usuario, eventos de cliente
- Automatización de la interfaz de usuario, suscribirse a eventos
- Automatización de la interfaz de usuario, métodos de suscripción
- Automatización de la interfaz de usuario, ejemplos de código
- Automatización de la interfaz de usuario, ejemplos
- Automatización de la interfaz de usuario, ejemplos
- suscribirse a eventos de automatización de la interfaz de usuario
- eventos, suscripción de UI Automation
- Ejemplos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5d9a89df1b9d2afc401e07b6cd77d1307d912f11
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/16/2019
ms.locfileid: "104357193"
---
# <a name="subscribing-to-ui-automation-events"></a><span data-ttu-id="9a5d5-116">Suscribirse a eventos de UI Automation</span><span class="sxs-lookup"><span data-stu-id="9a5d5-116">Subscribing to UI Automation Events</span></span>

<span data-ttu-id="9a5d5-117">La automatización de la interfaz de usuario de Microsoft permite a los clientes suscribirse a eventos de interés.</span><span class="sxs-lookup"><span data-stu-id="9a5d5-117">Microsoft UI Automation allows clients to subscribe to events of interest.</span></span> <span data-ttu-id="9a5d5-118">Esta funcionalidad mejora el rendimiento al eliminar la necesidad de sondear continuamente los elementos de la interfaz de usuario del sistema para ver si ha cambiado la información, la estructura o el estado.</span><span class="sxs-lookup"><span data-stu-id="9a5d5-118">This capability improves performance by eliminating the need to continually poll the UI elements in the system to see if any information, structure, or state has changed.</span></span>

<span data-ttu-id="9a5d5-119">La eficacia también mejora gracias a la capacidad para realizar escuchas de eventos que solo se encuentran dentro de un ámbito definido.</span><span class="sxs-lookup"><span data-stu-id="9a5d5-119">Efficiency is also improved by the ability to listen for events only within a defined scope.</span></span> <span data-ttu-id="9a5d5-120">Por ejemplo, un cliente puede escuchar los cambios de selección en un elemento de una lista, en la propia lista o en todo un cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="9a5d5-120">For example, a client can listen for selection changes on an item in a list, on the list itself, or on an entire dialog box.</span></span>

> [!Note]  
> <span data-ttu-id="9a5d5-121">No asuma que un proveedor de automatización de la interfaz de usuario genera todos los posibles eventos.</span><span class="sxs-lookup"><span data-stu-id="9a5d5-121">Do not assume that all possible events are raised by a UI Automation provider.</span></span> <span data-ttu-id="9a5d5-122">Por ejemplo, no todos los cambios de propiedad hacen que los proveedores de proxy estándar generen eventos para los controles de Windows Forms y Microsoft Win32.</span><span class="sxs-lookup"><span data-stu-id="9a5d5-122">For example, not all property changes cause events to be raised by the standard proxy providers for Windows Forms and Microsoft Win32 controls.</span></span>

 

<span data-ttu-id="9a5d5-123">Para obtener una vista más amplia de los eventos de automatización de la interfaz de usuario, consulte [UI Automation Events Overview](uiauto-eventsoverview.md).</span><span class="sxs-lookup"><span data-stu-id="9a5d5-123">For a broader view of UI Automation events, see [UI Automation Events Overview](uiauto-eventsoverview.md).</span></span>

> [!Note]  
> <span data-ttu-id="9a5d5-124">Antes de implementar un controlador de eventos, debe estar familiarizado con los problemas de subprocesamiento descritos en Descripción de los [problemas de subprocesos](uiauto-threading.md).</span><span class="sxs-lookup"><span data-stu-id="9a5d5-124">Before implementing an event handler, you should be familiar with the threading issues described in [Understanding Threading Issues](uiauto-threading.md).</span></span>

 

<span data-ttu-id="9a5d5-125">En este tema se incluyen las siguientes secciones.</span><span class="sxs-lookup"><span data-stu-id="9a5d5-125">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="9a5d5-126">Registrar controladores de eventos</span><span class="sxs-lookup"><span data-stu-id="9a5d5-126">Registering Event Handlers</span></span>](#registering-event-handlers)
-   [<span data-ttu-id="9a5d5-127">Ejemplos</span><span class="sxs-lookup"><span data-stu-id="9a5d5-127">Examples</span></span>](#examples)
-   [<span data-ttu-id="9a5d5-128">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="9a5d5-128">Related topics</span></span>](#related-topics)

## <a name="registering-event-handlers"></a><span data-ttu-id="9a5d5-129">Registrar controladores de eventos</span><span class="sxs-lookup"><span data-stu-id="9a5d5-129">Registering Event Handlers</span></span>

<span data-ttu-id="9a5d5-130">Las aplicaciones cliente se suscriben a eventos de un tipo determinado mediante el registro de un controlador de eventos, mediante uno de los siguientes métodos [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) .</span><span class="sxs-lookup"><span data-stu-id="9a5d5-130">Client applications subscribe to events of a particular kind by registering an event handler, using one of the following [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) methods.</span></span>



| <span data-ttu-id="9a5d5-131">Método de suscripción</span><span class="sxs-lookup"><span data-stu-id="9a5d5-131">Subscription Method</span></span>                                                                                                                                                                                                | <span data-ttu-id="9a5d5-132">Tipo de evento</span><span class="sxs-lookup"><span data-stu-id="9a5d5-132">Event Type</span></span>       | <span data-ttu-id="9a5d5-133">Interfaz de devolución de llamada</span><span class="sxs-lookup"><span data-stu-id="9a5d5-133">Callback Interface</span></span>                                                                                    |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------|-------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="9a5d5-134">**AddFocusChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9a5d5-134">**AddFocusChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addfocuschangedeventhandler)                                                                                                                            | <span data-ttu-id="9a5d5-135">Cambio de foco</span><span class="sxs-lookup"><span data-stu-id="9a5d5-135">Focus change</span></span>     | [<span data-ttu-id="9a5d5-136">**IUIAutomationFocusChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9a5d5-136">**IUIAutomationFocusChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationfocuschangedeventhandler)         |
| <span data-ttu-id="9a5d5-137">[**AddPropertyChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandler), [ **AddPropertyChangedEventHandlerNativeArray**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandlernativearray)</span><span class="sxs-lookup"><span data-stu-id="9a5d5-137">[**AddPropertyChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandler), [**AddPropertyChangedEventHandlerNativeArray**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandlernativearray)</span></span> | <span data-ttu-id="9a5d5-138">Cambio de propiedad</span><span class="sxs-lookup"><span data-stu-id="9a5d5-138">Property change</span></span>  | [<span data-ttu-id="9a5d5-139">**IUIAutomationPropertyChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9a5d5-139">**IUIAutomationPropertyChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationpropertychangedeventhandler)   |
| [<span data-ttu-id="9a5d5-140">**AddStructureChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9a5d5-140">**AddStructureChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addstructurechangedeventhandler)                                                                                                                    | <span data-ttu-id="9a5d5-141">Cambio de estructura</span><span class="sxs-lookup"><span data-stu-id="9a5d5-141">Structure change</span></span> | [<span data-ttu-id="9a5d5-142">**IUIAutomationStructureChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9a5d5-142">**IUIAutomationStructureChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationstructurechangedeventhandler) |
| [<span data-ttu-id="9a5d5-143">**AddNotificationEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9a5d5-143">**AddNotificationEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation5-addnotificationeventhandler)                                                                                                                           | <span data-ttu-id="9a5d5-144">notificación</span><span class="sxs-lookup"><span data-stu-id="9a5d5-144">Notification</span></span>     | [<span data-ttu-id="9a5d5-145">**IUIAutomationNotificationEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9a5d5-145">**IUIAutomationNotificationEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationnotificationeventhandler)         |
| [<span data-ttu-id="9a5d5-146">**AddAutomationEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9a5d5-146">**AddAutomationEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addautomationeventhandler)                                                                                                                                | <span data-ttu-id="9a5d5-147">Otros eventos</span><span class="sxs-lookup"><span data-stu-id="9a5d5-147">Other events</span></span>     | [<span data-ttu-id="9a5d5-148">**IUIAutomationEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9a5d5-148">**IUIAutomationEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationeventhandler)                                 |



 

<span data-ttu-id="9a5d5-149">Cuando un cliente agrega un controlador de eventos para todos los descendientes ([**\_ descendientes de TreeScope**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope)), la automatización de la interfaz de usuario solo agrega un controlador para la raíz del subárbol y el controlador realiza escuchas en todos los descendientes.</span><span class="sxs-lookup"><span data-stu-id="9a5d5-149">When a client adds an event handler for all descendants ([**TreeScope\_Descendants**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope)), UI Automation adds only one handler for the root of sub-tree, and the handler listens across all descendents.</span></span> <span data-ttu-id="9a5d5-150">La automatización de la interfaz de usuario no agrega controladores de eventos de forma recursiva.</span><span class="sxs-lookup"><span data-stu-id="9a5d5-150">UI Automation does not add event handlers recursively.</span></span>

<span data-ttu-id="9a5d5-151">Cuando un cliente llama al método [**IUIAutomation:: RemoveAllEventHandlers**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removealleventhandlers) , la automatización de la interfaz de usuario quita todos los controladores de eventos del proceso del cliente.</span><span class="sxs-lookup"><span data-stu-id="9a5d5-151">When a client calls the [**IUIAutomation::RemoveAllEventHandlers**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removealleventhandlers) method, UI Automation removes all event handlers from the client process.</span></span>

<span data-ttu-id="9a5d5-152">Para recibir y controlar eventos, implemente un objeto de control de eventos que exponga una interfaz de devolución de llamada y debe registrar el objeto llamando a un método de registro de eventos como [**IUIAutomation:: AddPropertyChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandler).</span><span class="sxs-lookup"><span data-stu-id="9a5d5-152">To receive and handle events, you implement an event-handling object that exposes a callback interface, and you must register the object by calling an event registration method such as [**IUIAutomation::AddPropertyChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandler).</span></span> <span data-ttu-id="9a5d5-153">La interfaz de devolución de llamada tiene un único método; La automatización de la interfaz de usuario llama a este método cuando se procesa el evento.</span><span class="sxs-lookup"><span data-stu-id="9a5d5-153">The callback interface has a single method; UI Automation calls this method when the event is processed.</span></span>

<span data-ttu-id="9a5d5-154">Al apagar o cuando los eventos de UI Automation ya no son de interés para la aplicación, los clientes de automatización de la interfaz de usuario deben llamar a uno o varios de los siguientes métodos de [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) .</span><span class="sxs-lookup"><span data-stu-id="9a5d5-154">On shutdown, or when UI Automation events are no longer of interest to the application, UI Automation clients should call one or more of the following [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) methods.</span></span>

> [!Note]  
> <span data-ttu-id="9a5d5-155">Un cliente de UI Automation no debe utilizar varios subprocesos para agregar o quitar controladores de eventos.</span><span class="sxs-lookup"><span data-stu-id="9a5d5-155">A UI Automation client should not use multiple threads to add or remove event handlers.</span></span> <span data-ttu-id="9a5d5-156">Un comportamiento inesperado puede producirse si se agrega o se quita un controlador de eventos mientras se agrega o quita otro en el mismo proceso de cliente.</span><span class="sxs-lookup"><span data-stu-id="9a5d5-156">Unexpected behavior can result if one event handler is being added or removed while another is being added or removed in the same client process.</span></span>

 



| <span data-ttu-id="9a5d5-157">Método</span><span class="sxs-lookup"><span data-stu-id="9a5d5-157">Method</span></span>                                                                                                | <span data-ttu-id="9a5d5-158">Descripción</span><span class="sxs-lookup"><span data-stu-id="9a5d5-158">Description</span></span>                                                                                                                                                                                                                                                                     |
|-------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="9a5d5-159">**RemoveAutomationEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9a5d5-159">**RemoveAutomationEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removeautomationeventhandler)             | <span data-ttu-id="9a5d5-160">Anula el registro de un controlador de eventos que se registró mediante [**AddAutomationEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addautomationeventhandler).</span><span class="sxs-lookup"><span data-stu-id="9a5d5-160">Unregisters an event handler that was registered by using [**AddAutomationEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addautomationeventhandler).</span></span>                                                                                                                                  |
| [<span data-ttu-id="9a5d5-161">**RemoveFocusChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9a5d5-161">**RemoveFocusChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removefocuschangedeventhandler)         | <span data-ttu-id="9a5d5-162">Anula el registro de un controlador de eventos que se registró mediante [**AddFocusChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addfocuschangedeventhandler).</span><span class="sxs-lookup"><span data-stu-id="9a5d5-162">Unregisters an event handler that was registered by using [**AddFocusChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addfocuschangedeventhandler).</span></span>                                                                                                                              |
| [<span data-ttu-id="9a5d5-163">**RemovePropertyChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9a5d5-163">**RemovePropertyChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removepropertychangedeventhandler)   | <span data-ttu-id="9a5d5-164">Anula el registro de un controlador de eventos que se registró mediante [**AddPropertyChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandler) o [**AddPropertyChangedEventHandlerNativeArray**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandlernativearray).</span><span class="sxs-lookup"><span data-stu-id="9a5d5-164">Unregisters an event handler that was registered by using [**AddPropertyChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandler) or [**AddPropertyChangedEventHandlerNativeArray**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandlernativearray).</span></span> |
| [<span data-ttu-id="9a5d5-165">**RemoveStructureChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9a5d5-165">**RemoveStructureChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removestructurechangedeventhandler) | <span data-ttu-id="9a5d5-166">Anula el registro de un controlador de eventos que se registró mediante [**AddStructureChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addstructurechangedeventhandler).</span><span class="sxs-lookup"><span data-stu-id="9a5d5-166">Unregisters an event handler that was registered by using [**AddStructureChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addstructurechangedeventhandler).</span></span>                                                                                                                      |
| [<span data-ttu-id="9a5d5-167">**RemoveNotificationEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9a5d5-167">**RemoveNotificationEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation5-removenotificationeventhandler)        | <span data-ttu-id="9a5d5-168">Anula el registro de un controlador de eventos que Weas registrado con [**AddNotificationEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation5-addnotificationeventhandler).</span><span class="sxs-lookup"><span data-stu-id="9a5d5-168">Unregisters an event handler that weas registered by using [**AddNotificationEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation5-addnotificationeventhandler).</span></span>                                                                                                                            |
| [<span data-ttu-id="9a5d5-169">**RemoveAllEventHandlers**</span><span class="sxs-lookup"><span data-stu-id="9a5d5-169">**RemoveAllEventHandlers**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removealleventhandlers)                         | <span data-ttu-id="9a5d5-170">Anula el registro de todos los controladores de eventos registrados.</span><span class="sxs-lookup"><span data-stu-id="9a5d5-170">Unregisters all registered event handlers.</span></span>                                                                                                                                                                                                                                      |



 

<span data-ttu-id="9a5d5-171">Es posible que se entregue un evento en un controlador de eventos después de que se haya anulado la suscripción del controlador, si el evento se recibe simultáneamente con la solicitud para cancelar la suscripción al evento.</span><span class="sxs-lookup"><span data-stu-id="9a5d5-171">It is possible for an event to be delivered to an event handler after the handler has been unsubscribed, if the event is received simultaneously with the request to unsubscribe the event.</span></span> <span data-ttu-id="9a5d5-172">El procedimiento recomendado es seguir el estándar del modelo de objetos componentes (COM) y evitar destruir el objeto del controlador de eventos hasta que su recuento de referencias llegue a cero.</span><span class="sxs-lookup"><span data-stu-id="9a5d5-172">The best practice is to follow the Component Object Model (COM) standard and avoid destroying the event handler object until its reference count has reached zero.</span></span> <span data-ttu-id="9a5d5-173">La destrucción de un controlador de eventos inmediatamente después de cancelar la suscripción de los eventos puede producir una infracción de acceso si se entrega un evento tarde.</span><span class="sxs-lookup"><span data-stu-id="9a5d5-173">Destroying an event handler immediately after unsubscribing for events may result in an access violation if an event is delivered late.</span></span>

## <a name="examples"></a><span data-ttu-id="9a5d5-174">Ejemplos</span><span class="sxs-lookup"><span data-stu-id="9a5d5-174">Examples</span></span>

<span data-ttu-id="9a5d5-175">Para ver ejemplos de código que muestran cómo controlar eventos de automatización de la interfaz de usuario, consulte [cómo implementar controladores de eventos](uiauto-howto-implement-event-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="9a5d5-175">For code examples that show how to handle UI Automation events, see [How to Implement Event Handlers](uiauto-howto-implement-event-handlers.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="9a5d5-176">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="9a5d5-176">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="9a5d5-177">**Vista**</span><span class="sxs-lookup"><span data-stu-id="9a5d5-177">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="9a5d5-178">Información general sobre eventos de UI Automation</span><span class="sxs-lookup"><span data-stu-id="9a5d5-178">UI Automation Events Overview</span></span>](uiauto-eventsoverview.md)
</dt> <dt>

[<span data-ttu-id="9a5d5-179">Descripción de los problemas de subprocesos</span><span class="sxs-lookup"><span data-stu-id="9a5d5-179">Understanding Threading Issues</span></span>](uiauto-threading.md)
</dt> </dl>

 

 




