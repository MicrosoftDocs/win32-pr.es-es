---
description: Las aplicaciones que usan objetos CAPICOM deben crearse mediante CAPICOM.dll. CAPICOM.dll también debe estar presente y registrado en tiempo de ejecución para usar CAPICOM Objects.
ms.assetid: 69de5232-e2f9-4aed-935d-5fbcd7998cc9
title: Preparación para usar CAPICOM
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f6fc1ad0dbfe3d4f8c4dae3286eb3ffa5e1ae03d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "105668224"
---
# <a name="getting-ready-to-use-capicom"></a><span data-ttu-id="967f6-104">Preparación para usar CAPICOM</span><span class="sxs-lookup"><span data-stu-id="967f6-104">Getting Ready to Use CAPICOM</span></span>

<span data-ttu-id="967f6-105">\[CAPICOM es un componente de solo bits de 32 que está disponible para su uso en los siguientes sistemas operativos: Windows Server 2008, Windows Vista y Windows XP.</span><span class="sxs-lookup"><span data-stu-id="967f6-105">\[CAPICOM is a 32-bit only component that is available for use in the following operating systems: Windows Server 2008, Windows Vista, and Windows XP.</span></span> <span data-ttu-id="967f6-106">En su lugar, use la .NET Framework para implementar características de seguridad.</span><span class="sxs-lookup"><span data-stu-id="967f6-106">Instead, use the .NET Framework to implement security features.</span></span> <span data-ttu-id="967f6-107">Para obtener más información, vea [alternativas al uso de CAPICOM](alternatives-to-using-capicom.md).\]</span><span class="sxs-lookup"><span data-stu-id="967f6-107">For more information, see [Alternatives to Using CAPICOM](alternatives-to-using-capicom.md).\]</span></span>

<span data-ttu-id="967f6-108">Las aplicaciones que usan objetos CAPICOM deben crearse mediante CAPICOM.dll.</span><span class="sxs-lookup"><span data-stu-id="967f6-108">Applications that use CAPICOM objects must be created by using CAPICOM.dll.</span></span> <span data-ttu-id="967f6-109">CAPICOM.dll también debe estar presente y registrado en tiempo de ejecución para usar CAPICOM Objects.</span><span class="sxs-lookup"><span data-stu-id="967f6-109">CAPICOM.dll must also be present and registered at run time to use CAPICOM objects.</span></span> <span data-ttu-id="967f6-110">CAPICOM.dll debe agregarse a Visual Basic referencias de proyectos para usar objetos de CAPICOM.</span><span class="sxs-lookup"><span data-stu-id="967f6-110">CAPICOM.dll should be added to Visual Basic projects references to use CAPICOM objects.</span></span>

<span data-ttu-id="967f6-111">CAPICOM está disponible como archivo redistribuible que se puede descargar desde [Platform SDK Redistributable: CAPICOM](https://www.microsoft.com/download/details.aspx?id=25281).</span><span class="sxs-lookup"><span data-stu-id="967f6-111">CAPICOM is available as a redistributable file that can be downloaded from [Platform SDK Redistributable: CAPICOM](https://www.microsoft.com/download/details.aspx?id=25281).</span></span> <span data-ttu-id="967f6-112">Para obtener información acerca de las versiones de CAPICOM, consulte [versiones de CAPICOM](capicom-versions.md).</span><span class="sxs-lookup"><span data-stu-id="967f6-112">For information about CAPICOM versions, see [CAPICOM Versions](capicom-versions.md).</span></span>

<span data-ttu-id="967f6-113">**Para registrar CAPICOM.dll**</span><span class="sxs-lookup"><span data-stu-id="967f6-113">**To register CAPICOM.dll**</span></span>

-   <span data-ttu-id="967f6-114">En un símbolo del sistema, cambie el directorio al directorio donde se almacena CAPICOM.dll y, a continuación, escriba el siguiente comando:</span><span class="sxs-lookup"><span data-stu-id="967f6-114">At a command prompt, change the directory to the directory where CAPICOM.dll is stored, and then enter the following command:</span></span>

    <span data-ttu-id="967f6-115">**regsvr32 CAPICOM.dll**</span><span class="sxs-lookup"><span data-stu-id="967f6-115">**regsvr32 CAPICOM.dll**</span></span>

## <a name="example-code-limitations"></a><span data-ttu-id="967f6-116">Limitaciones de código de ejemplo</span><span class="sxs-lookup"><span data-stu-id="967f6-116">Example Code Limitations</span></span>

<span data-ttu-id="967f6-117">Para proporcionar un código más conciso y más legible, los principios de prácticas recomendadas de programación no siempre se siguen en estos ejemplos.</span><span class="sxs-lookup"><span data-stu-id="967f6-117">To provide more concise, more readable code, principles of good programming practice are not always followed in these examples.</span></span> <span data-ttu-id="967f6-118">En concreto, solo se muestran las respuestas de error limitadas.</span><span class="sxs-lookup"><span data-stu-id="967f6-118">In particular, only limited error responses are shown.</span></span> <span data-ttu-id="967f6-119">Las aplicaciones de trabajo siempre deben comprobar los códigos de error devueltos y realizar las acciones adecuadas cuando se produce un error.</span><span class="sxs-lookup"><span data-stu-id="967f6-119">Working applications should always check returned error codes and perform appropriate actions when an error is encountered.</span></span>

## <a name="necessary-key-containers-keys-and-certificates-in-capicom"></a><span data-ttu-id="967f6-120">Contenedores de claves, claves y certificados necesarios en CAPICOM</span><span class="sxs-lookup"><span data-stu-id="967f6-120">Necessary Key Containers, Keys, and Certificates in CAPICOM</span></span>

<span data-ttu-id="967f6-121">Aunque cualquier usuario puede realizar algunas operaciones con objetos CAPICOM en cualquier equipo, crear [*firmas digitales*](../secgloss/d-gly.md) y recuperar el contenido de texto sin formato de un mensaje con doble cifrado mediante CAPICOM objetos son operaciones basadas en certificados.</span><span class="sxs-lookup"><span data-stu-id="967f6-121">While some operations with CAPICOM objects can be done on any computer by any user, creating [*digital signatures*](../secgloss/d-gly.md) and retrieving the plaintext content of an enveloped message using CAPICOM objects are certificate-based operations.</span></span> <span data-ttu-id="967f6-122">El usuario que crea una firma digital y el usuario que recupera el contenido cifrado de un mensaje con envoltorio debe tener un certificado digital con una clave privada asociada disponible.</span><span class="sxs-lookup"><span data-stu-id="967f6-122">The user who creates a digital signature and the user who retrieves the encrypted contents of an enveloped message must have a digital certificate with an available associated private key.</span></span> <span data-ttu-id="967f6-123">Si no hay un certificado con una clave privada asociada, se producirá un error en la operación criptográfica.</span><span class="sxs-lookup"><span data-stu-id="967f6-123">If a certificate with an associated private key is not present, the cryptographic operation will fail.</span></span> <span data-ttu-id="967f6-124">Los usuarios de aplicaciones de CAPICOM deben asegurarse de que tienen el certificado adecuado y la clave privada disponible cuando se ejecutan las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="967f6-124">Users of CAPICOM applications must ensure that they have the appropriate certificate and available private key when the applications are running.</span></span>

<span data-ttu-id="967f6-125">En algunos ejemplos de las secciones siguientes se realizan operaciones que requieren un [*par de claves pública y privada*](../secgloss/p-gly.md) para cifrar y descifrar archivos, mensajes y firmas.</span><span class="sxs-lookup"><span data-stu-id="967f6-125">Some examples in the following sections perform operations that require an available [*public/private key pair*](../secgloss/p-gly.md) for encrypting and decrypting files, messages, and signatures.</span></span> <span data-ttu-id="967f6-126">Muchos de estos programas se compilarán y ejecutarán pero producirán errores en tiempo de ejecución sin la existencia de [*contenedores de claves*](../secgloss/k-gly.md), claves, almacenes de certificados y [*certificados*](../secgloss/c-gly.md) adecuados en esos almacenes.</span><span class="sxs-lookup"><span data-stu-id="967f6-126">Many of these programs will compile and run but fail at run time without the existence of proper [*key containers*](../secgloss/k-gly.md), keys, certificate stores, and [*certificates*](../secgloss/c-gly.md) in those stores.</span></span>

<span data-ttu-id="967f6-127">**Para crear un certificado autofirmado**</span><span class="sxs-lookup"><span data-stu-id="967f6-127">**To create a self-signed certificate**</span></span>

1.  <span data-ttu-id="967f6-128">Instale las herramientas de firma.</span><span class="sxs-lookup"><span data-stu-id="967f6-128">Install the signing tools.</span></span> <span data-ttu-id="967f6-129">Se instalan como parte del kit de desarrollo de software (SDK) de Microsoft Windows, el kit de desarrollo de software (SDK) de la plataforma o el SDK de .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="967f6-129">These are installed as part of the Microsoft Windows Software Development Kit (SDK), the Platform Software Development Kit (SDK), or the .NET Framework SDK.</span></span>
2.  <span data-ttu-id="967f6-130">Una vez descargado Makecert.exe, ejecute el siguiente comando en un símbolo del sistema, sustituyendo un nombre de *usuario por nombre* de usuario, un nombre de organización para *NombreDeOrganización* y un nombre de compañía para *CompanyName*:</span><span class="sxs-lookup"><span data-stu-id="967f6-130">After Makecert.exe is downloaded, run the following command at a command prompt, substituting a user name for *UserName*, an organization name for *OrganizationName*, and a company name for *CompanyName*:</span></span>

    <span data-ttu-id="967f6-131">**Makecert-r-n "CN =**_username_*_, ou =_*_NombreDeOrganización_*_, o =_*_CompanyName_*_"-SS My_*</span><span class="sxs-lookup"><span data-stu-id="967f6-131">**makecert -r -n "cn=**_UserName_*_, ou=_*_OrganizationName_*_, o=_*_CompanyName_*_" -ss my_*</span></span>

3.  <span data-ttu-id="967f6-132">El certificado se puede colocar en el almacén My del usuario actual.</span><span class="sxs-lookup"><span data-stu-id="967f6-132">The certificate can be placed in the My store of the current user.</span></span> <span data-ttu-id="967f6-133">Importe el certificado creado en el almacén raíz para que sea de confianza.</span><span class="sxs-lookup"><span data-stu-id="967f6-133">Import the certificate created into the root store so that it is trusted.</span></span>

 

 
