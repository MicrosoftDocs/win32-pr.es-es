---
title: Enlace de datos a través de IPropertyNotifySink
description: Enlace de datos a través de IPropertyNotifySink
ms.assetid: 275a84b3-65d8-43de-bfba-72e3e5ee59fe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5d39c7277d27f0df6c185fc35a926aa98b77b91a
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/16/2019
ms.locfileid: "103779800"
---
# <a name="data-binding-through-ipropertynotifysink"></a><span data-ttu-id="d408b-103">Enlace de datos a través de IPropertyNotifySink</span><span class="sxs-lookup"><span data-stu-id="d408b-103">Data Binding through IPropertyNotifySink</span></span>

<span data-ttu-id="d408b-104">Los objetos que admiten propiedades, por ejemplo, a través de la automatización OLE y la interfaz **IDispatch** , pueden querer permitir a los clientes recibir una notificación cuando ciertas propiedades cambian de valor.</span><span class="sxs-lookup"><span data-stu-id="d408b-104">Objects that support properties, for example, through OLE Automation and the **IDispatch** interface, may want to allow clients to be notified when certain properties change value.</span></span> <span data-ttu-id="d408b-105">Este tipo de propiedad se denomina propiedad enlazable porque las notificaciones permiten a un cliente sincronizar su propia presentación de los valores de propiedad actuales del objeto.</span><span class="sxs-lookup"><span data-stu-id="d408b-105">Such a property is called a bindable property because the notifications allow a client to synchronize its own display of the object's current property values.</span></span> <span data-ttu-id="d408b-106">Además, es posible que los mismos objetos deseen permitir que un cliente controle cuándo se permite cambiar determinadas propiedades.</span><span class="sxs-lookup"><span data-stu-id="d408b-106">In addition, the same objects may wish to allow a client to control when certain properties are allowed to change.</span></span> <span data-ttu-id="d408b-107">Tales propiedades se denominan propiedades de edición de solicitud.</span><span class="sxs-lookup"><span data-stu-id="d408b-107">Such properties are called request edit properties.</span></span>

<span data-ttu-id="d408b-108">[**IPropertyNotifySink**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) es una interfaz de notificación estándar que admite propiedades enlazables y de solicitud-modificación.</span><span class="sxs-lookup"><span data-stu-id="d408b-108">The [**IPropertyNotifySink**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) is a standard notification interface that supports bindable and request-edit properties.</span></span> <span data-ttu-id="d408b-109">**IPropertyNotifySink** se admite desde un objeto con propiedades como una interfaz de salida.</span><span class="sxs-lookup"><span data-stu-id="d408b-109">**IPropertyNotifySink** is supported from an object with properties as an outgoing interface.</span></span> <span data-ttu-id="d408b-110">Es decir, la propia interfaz se implementa mediante el objeto de receptor del cliente y el cliente conecta el receptor al objeto auxiliar a través del mecanismo de punto de conexión descrito anteriormente.</span><span class="sxs-lookup"><span data-stu-id="d408b-110">That is, the interface itself is implemented by a client's sink object, and the client connects the sink to the supporting object through the connection point mechanism described earlier.</span></span> <span data-ttu-id="d408b-111">**IPropertyNotifySink** se define de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="d408b-111">The **IPropertyNotifySink** is defined as follows:</span></span>

``` syntax
interface IPropertyNotifySink : IUnknown 
  { 
    HRESULT OnChanged([in] DISPID dispID); 
    HRESULT OnRequestEdit([in] DISPID dispID); 
  } 
 
```

<span data-ttu-id="d408b-112">Cuando un objeto desea notificar a sus receptores conectados que se ha cambiado una propiedad enlazable identificada con un DISPID determinado, llama a en el [**cambio**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged).</span><span class="sxs-lookup"><span data-stu-id="d408b-112">When an object wishes to notify its connected sinks that a bindable property identified with a given DISPID has changed, it calls [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged).</span></span> <span data-ttu-id="d408b-113">Si un objeto cambia varias propiedades a la vez, puede pasar DISPID \_ Unknown a **onchange** , en cuyo caso un cliente actualiza su caché de todos los valores de propiedad de interés.</span><span class="sxs-lookup"><span data-stu-id="d408b-113">If an object changes multiple properties at once, it can pass DISPID\_UNKNOWN to **OnChanged** in which case a client refreshes its cache of all property values of interest.</span></span>

<span data-ttu-id="d408b-114">Cuando una propiedad de edición de solicitud está a punto de cambiar, un objeto puede preguntar al cliente si permite que se produzca ese cambio.</span><span class="sxs-lookup"><span data-stu-id="d408b-114">When a request edit property is about to change, an object can ask the client whether it will allow that change to occur.</span></span> <span data-ttu-id="d408b-115">El objeto llama a [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) pasando el DISPID de la propiedad en cuestión (o DISPID \_ Unknown para identificar todas las propiedades).</span><span class="sxs-lookup"><span data-stu-id="d408b-115">The object calls [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) passing the DISPID of the property in question (or DISPID\_UNKNOWN to identify all properties).</span></span> <span data-ttu-id="d408b-116">El receptor del cliente devuelve S \_ OK para indicar que el cambio se permite o s \_ false (o un error) para indicar que no se permite el cambio.</span><span class="sxs-lookup"><span data-stu-id="d408b-116">The client's sink returns S\_OK to indicate that the change is allowed, or S\_FALSE (or an error) to indicate that change is not allowed.</span></span> <span data-ttu-id="d408b-117">Cuando un objeto llama a **OnRequestEdit**, es necesario obedecer los deseos del cliente mediante la semántica exacta de \_ \_ los valores devueltos de s OK y s false.</span><span class="sxs-lookup"><span data-stu-id="d408b-117">When an object calls **OnRequestEdit**, it is required to obey the client's wishes by following the exact semantics of S\_OK and S\_FALSE return values.</span></span>

<span data-ttu-id="d408b-118">Tenga en cuenta que [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) no se puede usar para la validación de datos porque en el momento de la llamada, el nuevo valor de la propiedad todavía no está disponible.</span><span class="sxs-lookup"><span data-stu-id="d408b-118">Note that [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) cannot be used for data validation because at the time of the call, the new value of the property is not yet available.</span></span> <span data-ttu-id="d408b-119">La notificación solo se puede usar para controlar un estado de solo lectura para una propiedad.</span><span class="sxs-lookup"><span data-stu-id="d408b-119">The notification can only be used to control a read-only state for a property.</span></span>

<span data-ttu-id="d408b-120">Los objetos controlan las propiedades que se pueden enlazar y la edición de solicitud y marcan estas propiedades en la información de tipo del objeto.</span><span class="sxs-lookup"><span data-stu-id="d408b-120">Objects control which properties are bindable and request edit and mark such properties in the object's type information.</span></span> <span data-ttu-id="d408b-121">En la información de tipo, el atributo enlazable marca una propiedad como compatible con el [**modificador**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged).</span><span class="sxs-lookup"><span data-stu-id="d408b-121">In the type information, the attribute bindable marks a property as supporting [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged).</span></span> <span data-ttu-id="d408b-122">El atributo requestedit marca una propiedad como compatible con [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit).</span><span class="sxs-lookup"><span data-stu-id="d408b-122">The attribute requestedit marks a property as supporting [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit).</span></span>

<span data-ttu-id="d408b-123">Una propiedad puede admitir ambos comportamientos, en cuyo caso se llama primero a [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) , y solo si se permite cambiar, se llama a la propiedad [**onchange**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged) .</span><span class="sxs-lookup"><span data-stu-id="d408b-123">One property can support both behaviors in which case [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) is called first, and only if change is allowed is [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged) called.</span></span>

<span data-ttu-id="d408b-124">La única excepción al comportamiento de estas propiedades es que no se envía ninguna notificación como resultado de los procedimientos de inicialización o carga de un objeto.</span><span class="sxs-lookup"><span data-stu-id="d408b-124">The one exception to the behavior of such properties is that no notifications are sent as a result of an object's initialization or loading procedures.</span></span> <span data-ttu-id="d408b-125">En ese momento, se supone que todas las propiedades cambian y que todas deben tener permiso para cambiar.</span><span class="sxs-lookup"><span data-stu-id="d408b-125">At such times, it is assumed that all properties change and that all must be allowed to change.</span></span> <span data-ttu-id="d408b-126">Por lo tanto, las notificaciones a esta interfaz son solo significativas en el contexto de un objeto completamente inicializado o cargado.</span><span class="sxs-lookup"><span data-stu-id="d408b-126">Notifications to this interface are therefore only meaningful in the context of a fully initialized/loaded object.</span></span>

<span data-ttu-id="d408b-127">Se pueden aplicar otros dos atributos a las propiedades de la información de tipo de un objeto.</span><span class="sxs-lookup"><span data-stu-id="d408b-127">Two other attributes can be applied to properties in an object's type information.</span></span> <span data-ttu-id="d408b-128">El atributo defaultbind marca una propiedad enlazable como la que mejor representa el estado del objeto en su totalidad.</span><span class="sxs-lookup"><span data-stu-id="d408b-128">The defaultbind attribute marks a bindable property as being the one that best represents the state of the object as a whole.</span></span> <span data-ttu-id="d408b-129">El atributo displaybind marca una propiedad enlazable como adecuada para su presentación en la propia interfaz de usuario de un cliente.</span><span class="sxs-lookup"><span data-stu-id="d408b-129">The displaybind attribute marks a bindable property as suitable for display in a client's own user interface.</span></span>

## <a name="related-topics"></a><span data-ttu-id="d408b-130">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="d408b-130">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d408b-131">Páginas de propiedades y hojas de propiedades</span><span class="sxs-lookup"><span data-stu-id="d408b-131">Property Pages and Property Sheets</span></span>](property-pages-and-property-sheets.md)
</dt> </dl>

 

 




