---
description: Asignación de coordenadas en VMR
ms.assetid: f0821b90-51d1-4e77-8aed-04337a3dd623
title: Asignación de coordenadas en VMR
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c18b38249471e6e68e36f1b9051f51e920f62b31
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/06/2021
ms.locfileid: "103906462"
---
# <a name="coordinate-mapping-in-the-vmr"></a><span data-ttu-id="f66b5-103">Asignación de coordenadas en VMR</span><span class="sxs-lookup"><span data-stu-id="f66b5-103">Coordinate Mapping in the VMR</span></span>

<span data-ttu-id="f66b5-104">En esta sección se describen las cinco transformaciones que se aplican a una imagen de origen antes de que la VMR la asigne a la imagen de salida final.</span><span class="sxs-lookup"><span data-stu-id="f66b5-104">This section describes the five transformations that are applied to a source image before it is mapped by the VMR onto the final output image.</span></span>

1.  <span data-ttu-id="f66b5-105">La transformación *T (src)* asigna el rectángulo de origen al rectángulo de destino.</span><span class="sxs-lookup"><span data-stu-id="f66b5-105">The transformation *T(Src)* maps the source rectangle to the destination rectangle.</span></span> <span data-ttu-id="f66b5-106">Se especifican mediante los miembros **rcSource** y **rcTarget** de la estructura [**VIDEOINFOHEADER**](/previous-versions/windows/desktop/api/amvideo/ns-amvideo-videoinfoheader) o [**VIDEOINFOHEADER2**](/previous-versions/windows/desktop/api/dvdmedia/ns-dvdmedia-videoinfoheader2) en el tipo de medio.</span><span class="sxs-lookup"><span data-stu-id="f66b5-106">These are specified by the **rcSource** and **rcTarget** members of the [**VIDEOINFOHEADER**](/previous-versions/windows/desktop/api/amvideo/ns-amvideo-videoinfoheader) or [**VIDEOINFOHEADER2**](/previous-versions/windows/desktop/api/dvdmedia/ns-dvdmedia-videoinfoheader2) structure in the media type.</span></span> <span data-ttu-id="f66b5-107">Esta asignación preprocesa la imagen de origen a medida que se pasa a la VMR.</span><span class="sxs-lookup"><span data-stu-id="f66b5-107">This mapping preprocesses the source image as it passes to the VMR.</span></span>
2.  <span data-ttu-id="f66b5-108">La transformación *T (marca)* realiza las manipulaciones de imagen especificadas por marcas en el ejemplo multimedia.</span><span class="sxs-lookup"><span data-stu-id="f66b5-108">The transformation *T(Flag)* performs any image manipulations specified by flags in the media sample.</span></span> <span data-ttu-id="f66b5-109">Estas transformaciones incluyen, por ejemplo, la traslación vertical y la escala para dar cabida a las marcas de entrelazado Bob.</span><span class="sxs-lookup"><span data-stu-id="f66b5-109">These included transformations such as the vertical translation and scale to accommodate the bob interlace flags.</span></span> <span data-ttu-id="f66b5-110">La transformación entrelazada duplica el alto de la imagen y posiblemente traduce la imagen en la mitad de una línea de vídeo si está en el campo impar.</span><span class="sxs-lookup"><span data-stu-id="f66b5-110">The interlace transformation doubles the image height and possibly translates the image by half of a video line if it is in the odd field.</span></span>
3.  <span data-ttu-id="f66b5-111">La transformación *T (ar)* ajusta la imagen a píxeles cuadrados, en función de la relación de aspecto de la imagen.</span><span class="sxs-lookup"><span data-stu-id="f66b5-111">The transformation *T(AR)* adjusts the image to square pixels, based on the image aspect ratio.</span></span> <span data-ttu-id="f66b5-112">En el caso de los tipos de medios **VIDEOINFOHEADER** , la relación de aspecto viene determinada por el tamaño de la imagen.</span><span class="sxs-lookup"><span data-stu-id="f66b5-112">For **VIDEOINFOHEADER** media types, the aspect ratio is determined by the image size.</span></span> <span data-ttu-id="f66b5-113">En el caso de los tipos **VIDEOINFOHEADER2** , la relación de aspecto viene determinada por los campos **dwPictAspectRatioX** y **dwPictAspectRatioY** , a menos que \_ se establezca el panel AMCONTROL \_ en \_ 16x9 o el \_ Panel AMCONTROL \_ en \_ marcas 4x3.</span><span class="sxs-lookup"><span data-stu-id="f66b5-113">For **VIDEOINFOHEADER2** types, the aspect ratio is determined by the **dwPictAspectRatioX** and **dwPictAspectRatioY** fields, unless the AMCONTROL\_PAD\_TO\_16x9 or AMCONTROL\_PAD\_TO\_4x3 flags are set.</span></span> <span data-ttu-id="f66b5-114">Esta transformación supone que la configuración de pantalla del monitor coincide con la relación de aspecto física del monitor.</span><span class="sxs-lookup"><span data-stu-id="f66b5-114">This transformation assumes that the monitor display setting matches the physical aspect ratio of the monitor.</span></span> <span data-ttu-id="f66b5-115">Por ejemplo, si el usuario tiene un monitor con una relación de aspecto de 4 x 3, pero establece la presentación en 1280 x 768 píxeles (5 x 3), la imagen no tendrá la relación de aspecto correcta.</span><span class="sxs-lookup"><span data-stu-id="f66b5-115">For example, if the user has a monitor with 4 x 3 aspect ratio, but sets the display to 1280 x 768 pixels (5 x 3), the image will not have the correct aspect ratio.</span></span>
4.  <span data-ttu-id="f66b5-116">Las transformaciones *T (Mix)* de transformación sitúan la imagen dentro de la imagen de destino, utilizando los rectángulos normalizados especificados en los métodos [**IVMRMixerControl**](/windows/desktop/api/Strmif/nn-strmif-ivmrmixercontrol) .</span><span class="sxs-lookup"><span data-stu-id="f66b5-116">The transformation *T(Mix)* transforms positions the image within the destination image, using the normalized rectangles specified in the [**IVMRMixerControl**](/windows/desktop/api/Strmif/nn-strmif-ivmrmixercontrol) methods.</span></span> <span data-ttu-id="f66b5-117">Los rectángulos normalizados permiten que la aplicación organice el modo en que los flujos de origen se colocan y escalan entre sí.</span><span class="sxs-lookup"><span data-stu-id="f66b5-117">The normalized rectangles enable the application to organize how the source streams are positioned and scaled relative to each other.</span></span> <span data-ttu-id="f66b5-118">VMR calcula la imagen de destino al calcular las dimensiones máximas de todas las imágenes de origen y centrar cada una dentro de un rectángulo delimitador global.</span><span class="sxs-lookup"><span data-stu-id="f66b5-118">The VMR computes the destination image by computing the maximum dimensions of all the source images and centering each inside an overall bounding rectangle.</span></span> <span data-ttu-id="f66b5-119">A las esquinas del rectángulo delimitador se les asigna el intervalo (0,0) a (1,1).</span><span class="sxs-lookup"><span data-stu-id="f66b5-119">The corners of the bounding rectangle are assigned the range (0,0) to (1,1).</span></span> <span data-ttu-id="f66b5-120">El rectángulo delimitador se fija antes de que se ejecute el gráfico y permanece constante incluso si se agregan o eliminan secuencias.</span><span class="sxs-lookup"><span data-stu-id="f66b5-120">The bounding rectangle is fixed before the graph runs and remains constant even if streams are added or deleted.</span></span> <span data-ttu-id="f66b5-121">Los rectángulos de destino para cada flujo pueden estar fuera del intervalo (0,0) a (1,1) y seguir siendo válidos.</span><span class="sxs-lookup"><span data-stu-id="f66b5-121">Destination rectangles for each stream can lie outside of the range (0,0) to (1,1) and still be valid.</span></span>
5.  <span data-ttu-id="f66b5-122">Por último, una parte de la imagen mixta se puede transformar mediante la asignación *T (DST)*, especificada por los rectángulos de origen y de destino en la interfaz [**IBasicVideo**](/windows/desktop/api/Control/nn-control-ibasicvideo) de VMR.</span><span class="sxs-lookup"><span data-stu-id="f66b5-122">Finally, a portion of the mixed image can be transformed by the mapping *T(Dst)*, specified by the source and destination rectangles in the [**IBasicVideo**](/windows/desktop/api/Control/nn-control-ibasicvideo) interface on the VMR.</span></span> <span data-ttu-id="f66b5-123">Si se reemplaza el Allocator-Presenter y no se utiliza la interfaz **IBasicVideo** , la aplicación debe implementar la interfaz [**IVMRWindowlessControl**](/windows/desktop/api/Strmif/nn-strmif-ivmrwindowlesscontrol) y volver a asignar las coordenadas a un espacio lineal 2D.</span><span class="sxs-lookup"><span data-stu-id="f66b5-123">If the Allocator-Presenter is replaced and the **IBasicVideo** interface is not used, the application must implement the [**IVMRWindowlessControl**](/windows/desktop/api/Strmif/nn-strmif-ivmrwindowlesscontrol) interface and map the coordinates back into a 2D linear space.</span></span> <span data-ttu-id="f66b5-124">Las coordenadas del mouse que se devuelven al navegador de DVD también deben estar en este espacio.</span><span class="sxs-lookup"><span data-stu-id="f66b5-124">The mouse coordinates returned to the DVD navigator must also be in this space.</span></span> <span data-ttu-id="f66b5-125">Por ejemplo, si una aplicación representa el vídeo en un cubo giratorio, notificaría toda la presentación del control sin ventana y devolverá las coordenadas del mouse con respecto a la pantalla.</span><span class="sxs-lookup"><span data-stu-id="f66b5-125">For example, if an application renders video onto a spinning cube, they would report back the entire display for the windowless control and return mouse coordinates relative to the display.</span></span>

<span data-ttu-id="f66b5-126">La transformación de imagen general de los datos de origen al representador final es:</span><span class="sxs-lookup"><span data-stu-id="f66b5-126">The overall image transformation from the source data to the final renderer is:</span></span>

<span data-ttu-id="f66b5-127">T = T (src) t (marca) t (ar) t (Mix) t ( \* \* horario de verano)\*</span><span class="sxs-lookup"><span data-stu-id="f66b5-127">T = T(Src)\* T(Flag)T(Ar)T(Mix)\* T(Dst)\*</span></span>

<span data-ttu-id="f66b5-128">donde \* indica que la imagen se podría recortar en la imagen de destino en esa fase.</span><span class="sxs-lookup"><span data-stu-id="f66b5-128">where \* indicates that the image could be clipped to the destination image at that stage.</span></span> <span data-ttu-id="f66b5-129">Tenga en cuenta que se trata de todas las transformaciones afines, por lo que la VMR puede combinarlas en una única transformación.</span><span class="sxs-lookup"><span data-stu-id="f66b5-129">Note that these are all affine transformations, so the VMR can combine them into a single transformation.</span></span>

<span data-ttu-id="f66b5-130">El inverso de la transformación es:</span><span class="sxs-lookup"><span data-stu-id="f66b5-130">The inverse of the transformation is:</span></span>

![transformación inversa](images/vmrmapping-t-1.png)

<span data-ttu-id="f66b5-132">El factor T (src) T (marca) t (ar) es relativo a la resolución del origen.</span><span class="sxs-lookup"><span data-stu-id="f66b5-132">The factor T(Src) T(Flag) T(Ar) is relative to the source resolution.</span></span> <span data-ttu-id="f66b5-133">En el factor T (Mix), el rectángulo de origen normalizado es relativo a la imagen con corrección de aspecto.</span><span class="sxs-lookup"><span data-stu-id="f66b5-133">In the factor T(Mix), the normalized source rectangle is relative to the aspect-corrected image.</span></span> <span data-ttu-id="f66b5-134">El rectángulo de destino normalizado es relativo a la resolución de salida.</span><span class="sxs-lookup"><span data-stu-id="f66b5-134">The normalized destination rectangle is relative to the output resolution.</span></span> <span data-ttu-id="f66b5-135">En el diagrama siguiente se muestran estas relaciones.</span><span class="sxs-lookup"><span data-stu-id="f66b5-135">The following diagram shows these relationships.</span></span>

![pasos de la transformación de imagen](images/vmrmapping-transform-steps.png)

## <a name="related-topics"></a><span data-ttu-id="f66b5-137">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="f66b5-137">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f66b5-138">Usar la VMR para desarrolladores de filtros de DirectShow</span><span class="sxs-lookup"><span data-stu-id="f66b5-138">Using the VMR for DirectShow Filter Developers</span></span>](using-the-vmr-for-directshow-filter-developers.md)
</dt> </dl>

 

 



