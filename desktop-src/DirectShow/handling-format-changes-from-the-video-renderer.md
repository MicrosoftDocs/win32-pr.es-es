---
description: Control de los cambios de formato del representador de vídeo
ms.assetid: ac7d7b1c-3c9a-4693-87ea-0a10a8ab915c
title: Control de los cambios de formato del representador de vídeo
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d731ac4b9d6985cf5ad92f642b6d8262209fa91d
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/06/2021
ms.locfileid: "105652313"
---
# <a name="handling-format-changes-from-the-video-renderer"></a><span data-ttu-id="5a92d-103">Control de los cambios de formato del representador de vídeo</span><span class="sxs-lookup"><span data-stu-id="5a92d-103">Handling Format Changes from the Video Renderer</span></span>

<span data-ttu-id="5a92d-104">En esta sección se describe cómo un filtro de descodificador o de transformación debe controlar los cambios de formato del representador de vídeo.</span><span class="sxs-lookup"><span data-stu-id="5a92d-104">This section describes how a decoder filter or transform filter should handle format changes from the video renderer.</span></span>

<span data-ttu-id="5a92d-105">**Filtro de representador de vídeo**</span><span class="sxs-lookup"><span data-stu-id="5a92d-105">**Video Renderer Filter**</span></span>

<span data-ttu-id="5a92d-106">Cuando se conecta el filtro de [representador de vídeo](video-renderer-filter.md) anterior, se requiere un formato RGB que coincida con el formato de presentación del monitor principal.</span><span class="sxs-lookup"><span data-stu-id="5a92d-106">When the old [Video Renderer](video-renderer-filter.md) filter connects, it requires an RGB format that matches the display format of the primary monitor.</span></span> <span data-ttu-id="5a92d-107">Esto le permite usar GDI para la representación si DirectDraw no está disponible.</span><span class="sxs-lookup"><span data-stu-id="5a92d-107">This enables it to use GDI for rendering if DirectDraw is not available.</span></span> <span data-ttu-id="5a92d-108">Cuando se inicia la reproducción, el representador de vídeo puede cambiar a un formato compatible con DirectDraw.</span><span class="sxs-lookup"><span data-stu-id="5a92d-108">When playback starts, the Video Renderer may switch to a DirectDraw-compatible format.</span></span> <span data-ttu-id="5a92d-109">Para verfify si el filtro de nivel superior puede admitir el nuevo formato, el representador de vídeo llama a [**IPin:: QueryAccept**](/windows/desktop/api/Strmif/nf-strmif-ipin-queryaccept) en el PIN de salida del filtro de nivel superior.</span><span class="sxs-lookup"><span data-stu-id="5a92d-109">To verfify whether the upstream filter can support the new format, the Video Renderer calls [**IPin::QueryAccept**](/windows/desktop/api/Strmif/nf-strmif-ipin-queryaccept) on the upstream filter's output pin.</span></span> <span data-ttu-id="5a92d-110">Si el filtro de nivel superior acepta el nuevo formato, el método **QueryAccept** devuelve S \_ correcto.</span><span class="sxs-lookup"><span data-stu-id="5a92d-110">If the upstream filter accepts the new format, the **QueryAccept** method returns S\_OK.</span></span> <span data-ttu-id="5a92d-111">El representador de vídeo cambia de formato adjuntando un tipo de medio con el nuevo formato al siguiente ejemplo multimedia devuelto por su asignador.</span><span class="sxs-lookup"><span data-stu-id="5a92d-111">The Video Renderer switches formats by attaching a media type with the new format to the next media sample returned by its allocator.</span></span> <span data-ttu-id="5a92d-112">El filtro de nivel superior debe comprobar los cambios de formato llamando a [**IMediaSample:: GetMediaType**](/windows/desktop/api/Strmif/nf-strmif-imediasample-getmediatype) en cada ejemplo.</span><span class="sxs-lookup"><span data-stu-id="5a92d-112">The upstream filter should check for format changes by calling [**IMediaSample::GetMediaType**](/windows/desktop/api/Strmif/nf-strmif-imediasample-getmediatype) on each sample.</span></span> <span data-ttu-id="5a92d-113">El representador de vídeo puede alternar entre el formato original y el nuevo formato en cualquier momento durante el streaming.</span><span class="sxs-lookup"><span data-stu-id="5a92d-113">The Video Renderer may switch back and forth between the original format and new format at any time during streaming.</span></span> <span data-ttu-id="5a92d-114">No llama a **QueryAccept** después del primer cambio de formato.</span><span class="sxs-lookup"><span data-stu-id="5a92d-114">It does not call **QueryAccept** after the first format change.</span></span> <span data-ttu-id="5a92d-115">Una vez que el filtro de nivel superior ha aceptado el nuevo formato, debe ser capaz de cambiar de un y otro.</span><span class="sxs-lookup"><span data-stu-id="5a92d-115">Once the upstream filter has accepted the new format, it must be able to switch back and forth.</span></span>

<span data-ttu-id="5a92d-116">El filtro de nivel superior puede rechazar el cambio de formato devolviendo S \_ false desde **QueryAccept**.</span><span class="sxs-lookup"><span data-stu-id="5a92d-116">The upstream filter can reject the format change by returning S\_FALSE from **QueryAccept**.</span></span> <span data-ttu-id="5a92d-117">En ese caso, el representador de vídeo sigue usando GDI con el formato original.</span><span class="sxs-lookup"><span data-stu-id="5a92d-117">In that case, the Video Renderer continues to use GDI with the original format.</span></span>

<span data-ttu-id="5a92d-118">**Filtro de representador de combinación de vídeo**</span><span class="sxs-lookup"><span data-stu-id="5a92d-118">**Video Mixing Renderer Filter**</span></span>

<span data-ttu-id="5a92d-119">El filtro de representador de combinación de vídeo (VMR-7 y VMR-9) se conectará con cualquier formato compatible con el hardware de gráficos del sistema.</span><span class="sxs-lookup"><span data-stu-id="5a92d-119">The Video Mixing Renderer filter (VMR-7 and VMR-9) will connect with any format that is supported by the graphics hardware on the system.</span></span> <span data-ttu-id="5a92d-120">VMR-7 siempre usa DirectDraw para la representación y asigna las superficies de DirectDraw subyacentes cuando se conecta el filtro de nivel superior.</span><span class="sxs-lookup"><span data-stu-id="5a92d-120">The VMR-7 always uses DirectDraw for rendering, and allocates the underlying DirectDraw surfaces when the upstream filter connects.</span></span> <span data-ttu-id="5a92d-121">VMR-9 siempre usa Direct3D para la representación y asigna las superficies de Direct3D subyacentes cuando se conecta el filtro de nivel superior.</span><span class="sxs-lookup"><span data-stu-id="5a92d-121">The VMR-9 always uses Direct3D for rendering, and allocates the underlying Direct3D surfaces when the upstream filter connects.</span></span>

<span data-ttu-id="5a92d-122">El hardware gráfico puede requerir un intervalo mayor de superficie que el ancho de la imagen.</span><span class="sxs-lookup"><span data-stu-id="5a92d-122">The graphics hardware may require a larger surface stride than the image width.</span></span> <span data-ttu-id="5a92d-123">En ese caso, la VMR solicita un nuevo formato mediante una llamada a **QueryAccept**.</span><span class="sxs-lookup"><span data-stu-id="5a92d-123">In that case, the VMR requests a new format by calling **QueryAccept**.</span></span> <span data-ttu-id="5a92d-124">Notifica el intervalo de la superficie en el miembro **biwidth** del [**BITMAPINFOHEADER**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfoheader) en el formato de vídeo.</span><span class="sxs-lookup"><span data-stu-id="5a92d-124">It reports the surface stride in the **biWidth** member of the [**BITMAPINFOHEADER**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfoheader) in the video format.</span></span> <span data-ttu-id="5a92d-125">Si el filtro de nivel superior no devuelve S \_ correctos de **QueryAccept**, la VMR rechaza el formato e intenta conectarse con el siguiente formato anunciado por el filtro de nivel superior.</span><span class="sxs-lookup"><span data-stu-id="5a92d-125">If the upstream filter does not return S\_OK from **QueryAccept**, the VMR rejects the format and tries to connect using the next format advertised by the upstream filter.</span></span> <span data-ttu-id="5a92d-126">VMR asocia el tipo de medio con el nuevo formato al primer ejemplo multimedia.</span><span class="sxs-lookup"><span data-stu-id="5a92d-126">The VMR attaches the media type with the new format to the first media sample.</span></span> <span data-ttu-id="5a92d-127">Después del primer ejemplo, el formato permanece constante. VMR no cambiará de formato mientras el gráfico se esté ejecutando.</span><span class="sxs-lookup"><span data-stu-id="5a92d-127">After the first sample, the format remains constant; the VMR will not switch formats while the graph is running.</span></span>

<span data-ttu-id="5a92d-128">**Representación de vídeo mejorada (EVR)**</span><span class="sxs-lookup"><span data-stu-id="5a92d-128">**Enhanced Video Render (EVR)**</span></span>

<span data-ttu-id="5a92d-129">EVR siempre usa Direct3D para la representación.</span><span class="sxs-lookup"><span data-stu-id="5a92d-129">The EVR always uses Direct3D for rendering.</span></span> <span data-ttu-id="5a92d-130">Si se necesita un paso de superficie mayor, el EVR usa el mismo mecanismo de **QueryAccept** que la VMR.</span><span class="sxs-lookup"><span data-stu-id="5a92d-130">If a larger surface stride is needed, the EVR uses the same **QueryAccept** mechanism as the VMR.</span></span>

## <a name="related-topics"></a><span data-ttu-id="5a92d-131">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="5a92d-131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="5a92d-132">QueryAccept (ascendente)</span><span class="sxs-lookup"><span data-stu-id="5a92d-132">QueryAccept (Upstream)</span></span>](queryaccept--upstream.md)
</dt> </dl>

 

 



