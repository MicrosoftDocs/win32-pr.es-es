---
description: WMI hace que los datos sobre los objetos administrables de Windows estén disponibles a través de los proveedores de WMI.
ms.assetid: 74558c6e-28b6-479f-9de6-2fbad793ae26
ms.tgt_platform: multiple
title: Proporcionar datos a WMI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 60df0384bd6f512b931870775067d9d9e6d4077d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "103811413"
---
# <a name="providing-data-to-wmi"></a><span data-ttu-id="3c9f6-103">Proporcionar datos a WMI</span><span class="sxs-lookup"><span data-stu-id="3c9f6-103">Providing Data to WMI</span></span>

<span data-ttu-id="3c9f6-104">WMI hace que los datos sobre los objetos administrables de Windows estén disponibles a través de los [*proveedores*](gloss-p.md)de WMI.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-104">WMI makes data about Windows manageable objects available through WMI [*providers*](gloss-p.md).</span></span> <span data-ttu-id="3c9f6-105">Un proveedor recupera los datos de un componente del sistema, como un proceso, o una aplicación instrumentada, como SNMP o IIS, y pasa los datos a través de WMI a una aplicación de administración.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-105">A provider retrieves data from a system component, such as a process, or an instrumented application, such as SNMP or IIS, and passes that data through WMI to a management application.</span></span> <span data-ttu-id="3c9f6-106">Por ejemplo, cuando una aplicación o un script solicitan información del proceso mediante la clase de [**\_ proceso**](/windows/desktop/CIMWin32Prov/win32-process) de WMI Win32, los datos se obtienen dinámicamente a través de un proveedor preinstalado.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-106">For example, when an application or script requests process information using the WMI [**Win32\_Process**](/windows/desktop/CIMWin32Prov/win32-process) class, the data is obtained dynamically through a preinstalled provider.</span></span>

<span data-ttu-id="3c9f6-107">En este tema se describen las siguientes secciones:</span><span class="sxs-lookup"><span data-stu-id="3c9f6-107">The following sections are discussed in this topic:</span></span>

-   [<span data-ttu-id="3c9f6-108">Crear un modelo para un objeto administrable</span><span class="sxs-lookup"><span data-stu-id="3c9f6-108">Creating a Model for a Manageable Object</span></span>](#creating-a-model-for-a-manageable-object)
-   [<span data-ttu-id="3c9f6-109">Implementar un modelo para un objeto administrable</span><span class="sxs-lookup"><span data-stu-id="3c9f6-109">Implementing a Model for a Manageable Object</span></span>](#implementing-a-model-for-a-manageable-object)
-   [<span data-ttu-id="3c9f6-110">Determinar el tipo de proveedor que se va a implementar</span><span class="sxs-lookup"><span data-stu-id="3c9f6-110">Determining a Provider Type to Implement</span></span>](#determining-a-provider-type-to-implement)
-   [<span data-ttu-id="3c9f6-111">Determinar un modelo de hospedaje (implementación) para un proveedor</span><span class="sxs-lookup"><span data-stu-id="3c9f6-111">Determining a Hosting (Implementation) Model for a Provider</span></span>](#determining-a-hosting-implementation-model-for-a-provider)
-   [<span data-ttu-id="3c9f6-112">Implementar un proveedor</span><span class="sxs-lookup"><span data-stu-id="3c9f6-112">Implementing a Provider</span></span>](#implementing-a-provider)
-   [<span data-ttu-id="3c9f6-113">Registro de un proveedor con WMI y el sistema</span><span class="sxs-lookup"><span data-stu-id="3c9f6-113">Registering a Provider with WMI and the System</span></span>](#registering-a-provider-with-wmi-and-the-system)
-   [<span data-ttu-id="3c9f6-114">Probar un proveedor</span><span class="sxs-lookup"><span data-stu-id="3c9f6-114">Testing a Provider</span></span>](#testing-a-provider)
-   [<span data-ttu-id="3c9f6-115">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="3c9f6-115">Related topics</span></span>](#related-topics)

## <a name="creating-a-model-for-a-manageable-object"></a><span data-ttu-id="3c9f6-116">Crear un modelo para un objeto administrable</span><span class="sxs-lookup"><span data-stu-id="3c9f6-116">Creating a Model for a Manageable Object</span></span>

<span data-ttu-id="3c9f6-117">Antes de desarrollar un proveedor, cree un modelo de datos para representar el objeto administrable que se va a exponer a través de WMI.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-117">Before developing a provider, create a data model to represent the manageable object to be exposed through WMI.</span></span> <span data-ttu-id="3c9f6-118">Planea qué objetos de datos expondrá el proveedor.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-118">You plan which data objects your provider will expose.</span></span> <span data-ttu-id="3c9f6-119">Por ejemplo, si planea administrar la resolución de pantalla del fondo de escritorio, debe decidir cómo modelar el escritorio en un archivo [*Managed Object Format (MOF)*](gloss-m.md) .</span><span class="sxs-lookup"><span data-stu-id="3c9f6-119">For example, if you plan to manage the screen resolution of the desktop background, you must decide how to model the Desktop in a [*Managed Object Format (MOF)*](gloss-m.md) file.</span></span>

<span data-ttu-id="3c9f6-120">Para crear un modelo útil:</span><span class="sxs-lookup"><span data-stu-id="3c9f6-120">To create a useful model:</span></span>

-   <span data-ttu-id="3c9f6-121">Determinar escenarios reales y modelar la información que un cliente puede querer leer y actualizar (por ejemplo, cambiar la imagen de fondo) de cada objeto administrable.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-121">Determine real world scenarios and model the information a customer may want to read and update (for example, changing the background image) for each manageable object.</span></span> <span data-ttu-id="3c9f6-122">Estas son las propiedades de clase.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-122">These are your class properties.</span></span>
-   <span data-ttu-id="3c9f6-123">Determine qué tipo de acciones puede realizar un cliente con cada objeto administrable.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-123">Determine which kind of actions a customer may want to perform with each manageable object.</span></span> <span data-ttu-id="3c9f6-124">Estos son los métodos.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-124">These are your methods.</span></span>

## <a name="implementing-a-model-for-a-manageable-object"></a><span data-ttu-id="3c9f6-125">Implementar un modelo para un objeto administrable</span><span class="sxs-lookup"><span data-stu-id="3c9f6-125">Implementing a Model for a Manageable Object</span></span>

<span data-ttu-id="3c9f6-126">Para implementar un modelo para objetos administrables, cree un archivo MOF que contenga una clase WMI que represente cada objeto.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-126">To implement a model for manageable objects, create a MOF file containing a WMI class that represents each object.</span></span> <span data-ttu-id="3c9f6-127">Para obtener más información acerca de la creación de un archivo MOF para definir clases WMI, vea [diseñar clases Managed Object Format (MOF)](designing-managed-object-format--mof--classes.md).</span><span class="sxs-lookup"><span data-stu-id="3c9f6-127">For more information about creating a MOF file to define WMI classes, see [Designing Managed Object Format (MOF) Classes](designing-managed-object-format--mof--classes.md).</span></span> <span data-ttu-id="3c9f6-128">El registro del proveedor y sus clases normalmente se incluyen en el archivo MOF, aunque es posible usar la [API com](com-api-for-wmi.md) para crear clases y métodos.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-128">The registration of the provider and its classes are usually included in the MOF file, although it is possible to use the [COM API](com-api-for-wmi.md) to create classes and methods.</span></span> <span data-ttu-id="3c9f6-129">Para obtener más información, vea [desarrollar un proveedor WMI](developing-a-wmi-provider.md).</span><span class="sxs-lookup"><span data-stu-id="3c9f6-129">For more information, see [Developing a WMI Provider](developing-a-wmi-provider.md).</span></span>

> [!Note]  
> <span data-ttu-id="3c9f6-130">Para asegurarse de que todas las definiciones de clase WMI para objetos administrados se restauran en el [*repositorio WMI*](gloss-w.md) si WMI tiene un error y se reinician, use la instrucción de preprocesador [**\# pragma autocover**](pragma-autorecover.md) en el archivo [*Managed Object Format (MOF)*](gloss-m.md) .</span><span class="sxs-lookup"><span data-stu-id="3c9f6-130">To ensure that all your WMI class definitions for managed objects are restored to the [*WMI repository*](gloss-w.md) if WMI has a failure and restarts, use the [**\#pragma autorecover**](pragma-autorecover.md) preprocessor instruction in your [*Managed Object Format (MOF)*](gloss-m.md) file.</span></span>

 

<span data-ttu-id="3c9f6-131">Después de crear el archivo MOF, compílelo con la herramienta [**Mofcomp.exe**](mofcomp.md) .</span><span class="sxs-lookup"><span data-stu-id="3c9f6-131">After you create the MOF file, compile it using the [**Mofcomp.exe**](mofcomp.md) tool.</span></span> <span data-ttu-id="3c9f6-132">De esta forma, se le notifican los errores en el archivo MOF y se agrega la clase WMI definida en el archivo MOF al [*repositorio WMI*](gloss-w.md) para que un proveedor pueda utilizar la clase.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-132">This notifies you of errors in your MOF file, and adds the WMI class defined in the MOF file to the [*WMI repository*](gloss-w.md) so that the class can be used by a provider.</span></span>

## <a name="determining-a-provider-type-to-implement"></a><span data-ttu-id="3c9f6-133">Determinar el tipo de proveedor que se va a implementar</span><span class="sxs-lookup"><span data-stu-id="3c9f6-133">Determining a Provider Type to Implement</span></span>

<span data-ttu-id="3c9f6-134">WMI admite cierto número de tipos de proveedor, que determina la naturaleza de la información entregada y las operaciones admitidas por los proveedores.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-134">WMI supports a certain number of provider types, which determines the nature of the information delivered and operations supported by the providers.</span></span>

<span data-ttu-id="3c9f6-135">Los tipos de proveedor son:</span><span class="sxs-lookup"><span data-stu-id="3c9f6-135">The provider types are:</span></span>

-   [<span data-ttu-id="3c9f6-136">*Proveedor de instancias*</span><span class="sxs-lookup"><span data-stu-id="3c9f6-136">*Instance provider*</span></span>](gloss-i.md)
-   [<span data-ttu-id="3c9f6-137">*Proveedor de método*</span><span class="sxs-lookup"><span data-stu-id="3c9f6-137">*Method provider*</span></span>](gloss-m.md)
-   [<span data-ttu-id="3c9f6-138">*Proveedor de propiedades*</span><span class="sxs-lookup"><span data-stu-id="3c9f6-138">*Property provider*</span></span>](gloss-p.md)
-   <span data-ttu-id="3c9f6-139">Proveedor de clases</span><span class="sxs-lookup"><span data-stu-id="3c9f6-139">Class provider</span></span>
-   [<span data-ttu-id="3c9f6-140">*Proveedor de eventos*</span><span class="sxs-lookup"><span data-stu-id="3c9f6-140">*Event provider*</span></span>](gloss-e.md)
-   [<span data-ttu-id="3c9f6-141">*Proveedor de consumidor de eventos*</span><span class="sxs-lookup"><span data-stu-id="3c9f6-141">*Event consumer provider*</span></span>](gloss-e.md)
-   [<span data-ttu-id="3c9f6-142">*Proveedor de asociación*</span><span class="sxs-lookup"><span data-stu-id="3c9f6-142">*Association provider*</span></span>](gloss-a.md)

<span data-ttu-id="3c9f6-143">La gran mayoría de los proveedores son proveedores de instancias y proveedores de métodos.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-143">The vast majority of providers are instance providers and method providers.</span></span> <span data-ttu-id="3c9f6-144">Un proveedor de instancias es el proveedor más común y proporciona las instancias de una clase determinada.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-144">An instance provider is the most common provider, and it supplies the instances of a given class.</span></span> <span data-ttu-id="3c9f6-145">Un proveedor de métodos implementa los métodos de una o más clases.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-145">A method provider implements the methods of one or more classes.</span></span> <span data-ttu-id="3c9f6-146">Para obtener más información sobre los tipos de proveedores, vea [desarrollar un proveedor WMI](developing-a-wmi-provider.md).</span><span class="sxs-lookup"><span data-stu-id="3c9f6-146">For more information about the types of providers, see [Developing a WMI Provider](developing-a-wmi-provider.md).</span></span>

## <a name="determining-a-hosting-implementation-model-for-a-provider"></a><span data-ttu-id="3c9f6-147">Determinar un modelo de hospedaje (implementación) para un proveedor</span><span class="sxs-lookup"><span data-stu-id="3c9f6-147">Determining a Hosting (Implementation) Model for a Provider</span></span>

<span data-ttu-id="3c9f6-148">Los proveedores WMI son archivos binarios que se implementan como objetos COM.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-148">WMI providers are binaries implemented as COM objects.</span></span> <span data-ttu-id="3c9f6-149">Esto significa que cada proveedor tiene un archivo DLL que se puede ejecutar en un proceso específico y en un contexto de seguridad.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-149">This means that each provider has a DLL file which can be executed within a specific process and security context.</span></span> <span data-ttu-id="3c9f6-150">Esto es lo que WMI hace referencia como [*modelo de hospedaje*](gloss-h.md).</span><span class="sxs-lookup"><span data-stu-id="3c9f6-150">This is what WMI refers to as the [*hosting model*](gloss-h.md).</span></span> <span data-ttu-id="3c9f6-151">WMI ofrece varias maneras de hospedar proveedores, pero el enfoque más común consiste en usar el modelo de proveedor acoplado (que se ejecuta en el proceso WMI) en el contexto de seguridad NetworkServiceHost.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-151">WMI offers various ways to host providers, but the most common approach is to use the coupled provider model (running under the WMI process) in the NetworkServiceHost security context.</span></span> <span data-ttu-id="3c9f6-152">Un proveedor WMI se puede clasificar como acoplado o [*desacoplado*](gloss-d.md).</span><span class="sxs-lookup"><span data-stu-id="3c9f6-152">A WMI provider can be classified as either coupled or [*decoupled*](gloss-d.md).</span></span>

<span data-ttu-id="3c9f6-153">El término acoplado o el proveedor desacoplado determina en qué proceso de host se ejecuta el proveedor con respecto al proceso de WMIPRVSE.EXE proporcionado por WMI.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-153">The term coupled or decoupled provider determines under which host process the provider is running with respect to the WMI provided WMIPRVSE.EXE process.</span></span> <span data-ttu-id="3c9f6-154">Un procedimiento recomendado es determinar si los datos de administración que expone el proveedor y la API o la aplicación en la que se basa están siempre disponibles en el sistema o no.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-154">A best practice is to determine if the management data that the provider exposes and the API or application it relies on are always available in the system or not.</span></span> <span data-ttu-id="3c9f6-155">Si la API o la aplicación en la que se basa el proveedor siempre están disponibles (en ejecución en el sistema), el proveedor debe ser un proveedor acoplado, de lo contrario, debe ser un proveedor desacoplado.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-155">If the API or application the provider relies on is always available (running on the system), then the provider should be a coupled provider, if not, it must be a decoupled provider.</span></span> <span data-ttu-id="3c9f6-156">Para obtener más información sobre los modelos de hospedaje, vea [hospedaje y seguridad de proveedores](provider-hosting-and-security.md).</span><span class="sxs-lookup"><span data-stu-id="3c9f6-156">For more information about hosting models, see [Provider Hosting and Security](provider-hosting-and-security.md).</span></span>

<span data-ttu-id="3c9f6-157">Para obtener más información acerca de cómo crear un proveedor acoplado, consulte [proporcionar datos a WMI escribiendo un proveedor](supplying-data-to-wmi-by-writing-a-provider.md)y para obtener información sobre cómo incorporar un proveedor desacoplado en una aplicación, consulte [incorporación de un proveedor en una aplicación](incorporating-a-provider-in-an-application.md).</span><span class="sxs-lookup"><span data-stu-id="3c9f6-157">For more information about creating a coupled provider, see [Supplying Data to WMI by Writing a Provider](supplying-data-to-wmi-by-writing-a-provider.md), and for information about incorporating a decoupled provider in an application, see [Incorporating a Provider in an Application](incorporating-a-provider-in-an-application.md).</span></span>

<span data-ttu-id="3c9f6-158">Los proveedores acoplados se pueden describir como in-Process (en proceso) o fuera de proceso (fuera de proceso).</span><span class="sxs-lookup"><span data-stu-id="3c9f6-158">Coupled providers can be described as in-process (in-proc) or out-of-process (out-of-proc).</span></span> <span data-ttu-id="3c9f6-159">Cuando un proveedor acoplado es un proveedor en proceso, se ejecuta bajo un proceso de hospedaje de WMI WMIPRVSE.EXE compartido y se implementa como un servidor en proceso COM (. dll).</span><span class="sxs-lookup"><span data-stu-id="3c9f6-159">When a coupled provider is an in-proc provider, it runs under a shared WMIPRVSE.EXE WMI hosting process and is implemented as a COM in-proc server (.dll).</span></span> <span data-ttu-id="3c9f6-160">Cuando un proveedor es un proveedor fuera de proceso, WMI lo inicia a petición de un cliente o evento, pero se ejecuta como un proceso separado y se implementa como un archivo ejecutable (. exe).</span><span class="sxs-lookup"><span data-stu-id="3c9f6-160">When a provider is an out-of-proc provider, it is started by WMI on request of a client or event, but it runs as a separated process and is implemented as an executable (.exe).</span></span>

## <a name="implementing-a-provider"></a><span data-ttu-id="3c9f6-161">Implementar un proveedor</span><span class="sxs-lookup"><span data-stu-id="3c9f6-161">Implementing a Provider</span></span>

<span data-ttu-id="3c9f6-162">Un proveedor se puede implementar de las siguientes maneras:</span><span class="sxs-lookup"><span data-stu-id="3c9f6-162">A provider can be implemented in the following ways:</span></span>

-   <span data-ttu-id="3c9f6-163">Usar el Asistente para ATL en Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-163">Using the ATL Wizard in Visual Studio.</span></span>

    <span data-ttu-id="3c9f6-164">El Asistente para ATL genera código de proveedor que implementa un proveedor acoplado.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-164">The ATL Wizard generates provider code that implements a coupled provider.</span></span> <span data-ttu-id="3c9f6-165">Al utilizar el Asistente para ATL, puede especificar que desea crear un modelo en tiempo de ejecución del proveedor (. dll) o fuera de proceso (. exe).</span><span class="sxs-lookup"><span data-stu-id="3c9f6-165">While using the ATL Wizard, you can specify that you want to create an in-proc (.dll) or out-of-proc (.exe) provider run-time model.</span></span>

-   <span data-ttu-id="3c9f6-166">Definir un objeto COM que contenga el proveedor.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-166">Defining a COM object to contain your provider.</span></span>

    <span data-ttu-id="3c9f6-167">El código del proveedor está escrito en C++.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-167">The provider code is written in C++.</span></span> <span data-ttu-id="3c9f6-168">Para obtener más información, consulte [proporcionar datos a WMI escribiendo un proveedor](supplying-data-to-wmi-by-writing-a-provider.md).</span><span class="sxs-lookup"><span data-stu-id="3c9f6-168">For more information, see [Supplying Data to WMI by Writing a Provider](supplying-data-to-wmi-by-writing-a-provider.md).</span></span>

-   <span data-ttu-id="3c9f6-169">Usar las clases del espacio de nombres [**Microsoft. Management. Infrastructure**](/previous-versions//hh872326(v=vs.85)) en el .NET Framework para crear un proveedor mediante código administrado.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-169">Using the classes in the [**Microsoft.Management.Infrastructure**](/previous-versions//hh872326(v=vs.85)) namespace in the .NET Framework to create a provider using managed code.</span></span> <span data-ttu-id="3c9f6-170">(Ya no se admite el espacio de nombres **System. Management. Instrumentation** ).</span><span class="sxs-lookup"><span data-stu-id="3c9f6-170">(The **System.Management.Instrumentation** namespace is no longer supported.)</span></span>

    <span data-ttu-id="3c9f6-171">Este proceso crea un proveedor desacoplado.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-171">This process creates a decoupled provider.</span></span>

## <a name="registering-a-provider-with-wmi-and-the-system"></a><span data-ttu-id="3c9f6-172">Registro de un proveedor con WMI y el sistema</span><span class="sxs-lookup"><span data-stu-id="3c9f6-172">Registering a Provider with WMI and the System</span></span>

<span data-ttu-id="3c9f6-173">Antes de utilizar el proveedor de un consumidor, es importante registrarlo con el sistema WMI y el subsistema COM de Windows.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-173">Before using the provider from a consumer, it is important to register it with the WMI system and the Windows COM subsystem.</span></span>

<span data-ttu-id="3c9f6-174">Un archivo MOF puede contener varios tipos de proveedores para las mismas clases.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-174">A MOF file can contain multiple types of providers for the same classes.</span></span> <span data-ttu-id="3c9f6-175">El mismo nombre de proveedor se registra como, por ejemplo, una instancia de o un proveedor de métodos.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-175">The same provider name is registered as, for example, an instance or a method provider.</span></span> <span data-ttu-id="3c9f6-176">Para obtener más información, vea [registrar un proveedor](registering-a-provider.md).</span><span class="sxs-lookup"><span data-stu-id="3c9f6-176">For more information, see [Registering a Provider](registering-a-provider.md).</span></span>

## <a name="testing-a-provider"></a><span data-ttu-id="3c9f6-177">Probar un proveedor</span><span class="sxs-lookup"><span data-stu-id="3c9f6-177">Testing a Provider</span></span>

<span data-ttu-id="3c9f6-178">Cuando se registra el código del proveedor, es importante probar correctamente el proveedor mediante el proveedor de distintos consumidores (por ejemplo, scripts, código administrado de .NET y consumidores de C++).</span><span class="sxs-lookup"><span data-stu-id="3c9f6-178">When the provider code is registered, it is important to properly test the provider by using the provider from different consumers (for example, scripts, .NET managed code, and C++ consumers).</span></span>

<span data-ttu-id="3c9f6-179">Realice las tareas siguientes para probar el proveedor:</span><span class="sxs-lookup"><span data-stu-id="3c9f6-179">Perform the following tasks to test your provider:</span></span>

-   <span data-ttu-id="3c9f6-180">Asegúrese de que el proveedor se carga correctamente mediante el seguimiento de las notificaciones de eventos de [**msft \_ WmiProvider \_ OperationEvent**](/previous-versions/windows/desktop/wmisystemprov/msft-wmiprovider-operationevent) .</span><span class="sxs-lookup"><span data-stu-id="3c9f6-180">Ensure that your provider is loading properly by tracking the [**MSFT\_WmiProvider\_OperationEvent**](/previous-versions/windows/desktop/wmisystemprov/msft-wmiprovider-operationevent) event notifications.</span></span> <span data-ttu-id="3c9f6-181">Estos eventos le informarán sobre cualquier error de carga del proveedor.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-181">These events will inform you about any provider load failures.</span></span> <span data-ttu-id="3c9f6-182">Otras clases de solución de problemas que pueden resultar útiles son [**Win32 \_ ProcessStartTrace**](/previous-versions/windows/desktop/krnlprov/win32-processstarttrace) y [**Win32 \_ ProcessStopTrace**](/previous-versions/windows/desktop/krnlprov/win32-processstoptrace).</span><span class="sxs-lookup"><span data-stu-id="3c9f6-182">Other troubleshooting classes that may be helpful are [**Win32\_ProcessStartTrace**](/previous-versions/windows/desktop/krnlprov/win32-processstarttrace) and [**Win32\_ProcessStopTrace**](/previous-versions/windows/desktop/krnlprov/win32-processstoptrace).</span></span> <span data-ttu-id="3c9f6-183">Para obtener más información sobre los proveedores de solución de problemas, vea [depuración de proveedores](debugging-providers.md) y [clases de solución de problemas](provider-configuration-and-troubleshooting-classes.md).</span><span class="sxs-lookup"><span data-stu-id="3c9f6-183">For more information about troubleshooting providers, see [Debugging Providers](debugging-providers.md) and [Provider Configuration and Troubleshooting Classes](provider-configuration-and-troubleshooting-classes.md).</span></span>
-   <span data-ttu-id="3c9f6-184">Si el proveedor es un proveedor de instancia o método, asegúrese de probar cada funcionalidad del proveedor una por una para evitar confusiones al seguir la lógica del código.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-184">If the provider is an instance or method provider, ensure you test each provider capability one-by-one to avoid confusion in following your code logic.</span></span>
-   <span data-ttu-id="3c9f6-185">Para un proveedor de instancias, cree una aplicación cliente o un script que invoque cada interfaz del proveedor (enumeración, get, Put y Delete).</span><span class="sxs-lookup"><span data-stu-id="3c9f6-185">For an instance provider, create a client application or script that invokes every interface of the provider (enumeration, get, put, and delete).</span></span> <span data-ttu-id="3c9f6-186">Incluso si no se supone que el proveedor implemente nada, debe devolver un mensaje "no compatible".</span><span class="sxs-lookup"><span data-stu-id="3c9f6-186">Even if the provider is not supposed to implement anything, it should return a "not supported" message.</span></span> <span data-ttu-id="3c9f6-187">Puede encontrar los valores devueltos que ya se han definido en los [códigos de retorno de WMI](wmi-return-codes.md).</span><span class="sxs-lookup"><span data-stu-id="3c9f6-187">You can find the return values already defined in [WMI Return Codes](wmi-return-codes.md).</span></span>
-   <span data-ttu-id="3c9f6-188">Para asegurarse de que el contexto de seguridad deseado funciona según lo previsto, invoque las operaciones admitidas por el proveedor desde un contexto de seguridad que no sea de administrador.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-188">To ensure that the desired security context is working as planned, invoke the provider supported operations from a nonadministrator security context.</span></span> <span data-ttu-id="3c9f6-189">El proveedor debe admitir la suplantación.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-189">The provider must support impersonation.</span></span> <span data-ttu-id="3c9f6-190">Si un usuario que carece de las credenciales de seguridad correctas intenta actualizar los datos o realizar una operación que ejecuta un método, el proveedor debe denegar el acceso con el mensaje de error correspondiente.</span><span class="sxs-lookup"><span data-stu-id="3c9f6-190">If a user lacking the correct security credentials tries to update data or perform an operation that executes a method, your provider should deny access with the appropriate error message.</span></span>
-   <span data-ttu-id="3c9f6-191">Para obtener más información sobre la seguridad del proveedor, consulte [protección del proveedor](securing-your-provider.md).</span><span class="sxs-lookup"><span data-stu-id="3c9f6-191">For more information about provider security, see [Securing Your Provider](securing-your-provider.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="3c9f6-192">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="3c9f6-192">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="3c9f6-193">Desarrollar un proveedor WMI</span><span class="sxs-lookup"><span data-stu-id="3c9f6-193">Developing a WMI Provider</span></span>](developing-a-wmi-provider.md)
</dt> <dt>

[<span data-ttu-id="3c9f6-194">Hospedaje y seguridad de proveedores</span><span class="sxs-lookup"><span data-stu-id="3c9f6-194">Provider Hosting and Security</span></span>](provider-hosting-and-security.md)
</dt> <dt>

[<span data-ttu-id="3c9f6-195">Proporcionar datos a WMI escribiendo un proveedor</span><span class="sxs-lookup"><span data-stu-id="3c9f6-195">Supplying Data to WMI by Writing a Provider</span></span>](supplying-data-to-wmi-by-writing-a-provider.md)
</dt> <dt>

[<span data-ttu-id="3c9f6-196">Incorporación de un proveedor en una aplicación</span><span class="sxs-lookup"><span data-stu-id="3c9f6-196">Incorporating a Provider in an Application</span></span>](incorporating-a-provider-in-an-application.md)
</dt> <dt>

[<span data-ttu-id="3c9f6-197">Registrar un proveedor</span><span class="sxs-lookup"><span data-stu-id="3c9f6-197">Registering a Provider</span></span>](registering-a-provider.md)
</dt> <dt>

[<span data-ttu-id="3c9f6-198">Solución de problemas de aplicaciones cliente WMI</span><span class="sxs-lookup"><span data-stu-id="3c9f6-198">Troubleshooting WMI Client Applications</span></span>](troubleshooting-wmi-client-applications.md)
</dt> <dt>

[<span data-ttu-id="3c9f6-199">Protección del proveedor</span><span class="sxs-lookup"><span data-stu-id="3c9f6-199">Securing Your Provider</span></span>](securing-your-provider.md)
</dt> <dt>

[<span data-ttu-id="3c9f6-200">Obtener y proporcionar datos en una plataforma de 64 bits</span><span class="sxs-lookup"><span data-stu-id="3c9f6-200">Getting and Providing Data on a 64-bit Platform</span></span>](getting-and-providing-data-on-a-64-bit-computer.md)
</dt> </dl>

 

 
