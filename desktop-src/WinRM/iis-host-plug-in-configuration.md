---
title: Configuración del complemento de host de IIS
description: La configuración del complemento de host de Administración remota de Windows (WinRM) Internet Information Services (IIS) proporciona un mecanismo de hospedaje que permite a los complementos de WinRM de terceros exponer los datos de administración dentro de la infraestructura de WinRM.
ms.assetid: 234e6f7b-310f-499a-83e4-699ecf3816f0
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 714139c25836f5929ca6cfa3fe6797a90e80dde8
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "103995288"
---
# <a name="iis-host-plug-in-configuration"></a>Configuración del complemento de host de IIS

La configuración del complemento de host de Administración remota de Windows (WinRM) Internet Information Services (IIS) proporciona un mecanismo de hospedaje que permite a los complementos de WinRM de terceros exponer los datos de administración dentro de la infraestructura de WinRM.

En las secciones siguientes se describe la configuración del complemento de host de IIS:

-   [Detalles de hospedaje de IIS](#iis-hosting-details)
-   [Modelo de configuración de host de IIS](#iis-host-configuration-model)
-   [Configuración y detalles de la configuración de host de IIS (WinRM)](/windows)
-   [Leyendo la configuración del host de IIS](#reading-iis-host-configuration)
-   [Enumerar complementos en el servicio WinRM](#enumerating-plug-ins-on-the-winrm-service)

## <a name="iis-hosting-details"></a>Detalles de hospedaje de IIS

Una aplicación que configura e inicializa el procesador de SOAP de WinRM en IIS recibirá las solicitudes directamente de un cliente WinRM en otro equipo mediante el protocolo WS-Management. La aplicación también debe configurar un punto de conexión HTTP que identifique la aplicación para asegurarse de que todas las solicitudes se enruten directamente a los complementos específicos de la aplicación. La aplicación también debe configurar los complementos que se van a cargar en el host de IIS y los mecanismos de autorización y autenticación necesarios. Al usar el servicio WinRM en IIS, deben tenerse en cuenta los siguientes factores:

-   IIS no admite la autenticación Kerberos de forma predeterminada. Sin embargo, se puede crear un módulo de IIS para admitir la autenticación Kerberos.
-   El servicio IIS no aceptará las solicitudes de servicio WinRM cifradas a través de HTTP.
-   Después de configurar un punto de conexión de IIS, se producirá un error en la primera solicitud que envíe con credenciales implícitas. sin embargo, todas las solicitudes posteriores se realizarán correctamente. Se trata de un problema conocido con un sitio de IIS configurado con la autenticación de modo kernel predeterminada. Si se trata de un problema de bloqueo, se recomienda desactivar la autenticación de modo kernel.

## <a name="iis-host-configuration-model"></a>Modelo de configuración de host de IIS

Todas las aplicaciones que hospedan un procesador de Protocolo simple de acceso a objetos (SOAP) de WinRM en IIS requieren configuración antes de que funcionen.

Cada configuración de aplicación es independiente de la de otras aplicaciones. Los siguientes conjuntos de configuraciones son necesarios, aunque es posible que no todas las configuraciones deban cambiarse, y se realizan a través del servicio WinRM principal:

-   Configuración general de la aplicación, incluidos los tiempos de espera de la operación.
-   Un complemento de autorización para autorizar solicitudes de LiveID o asignar la cuenta de usuario de Windows a una cuenta de servicio más genérica.
-   Complementos de operación que el procesador de SOAP de WinRM va a hospedar y usar para realizar las solicitudes reales.

Es posible que sea necesario configurar las siguientes configuraciones en IIS:

-   Información del punto de conexión del [*agente de escucha*](windows-remote-management-glossary.md) que define qué puertos y direcciones están escuchando solicitudes junto con cualquier certificado capa de sockets seguros (SSL).
-   Asignación de certificados de cliente para asignar certificados de cliente a cuentas de usuario.
-   Configuración de autorización para limitar quién tiene acceso al sitio virtual.

De forma predeterminada, el servicio WinRM registra el puerto 5985 con el prefijo "wsman". Si la escucha HTTP de compatibilidad está habilitada, el servicio WinRM registra el puerto 80 con el prefijo "wsman" de forma predeterminada. Dado que IIS también escucha en el puerto 80 de forma predeterminada, se recomienda que los servicios de host de IIS creen [*agentes de escucha*](windows-remote-management-glossary.md) en un puerto diferente.

Si el servicio IIS y WinRM comparten el puerto 80, se necesita la siguiente configuración para compartir el puerto:

-   El servicio de host de IIS debe habilitar WinRM en una aplicación en el sitio.
-   El nombre de la aplicación debe agregarse al URI. Por ejemplo: https://servername/myapplication.

Cada aplicación host de IIS se almacena en la configuración de IIS como un archivo web.config que reside en el directorio físico correspondiente al directorio virtual configurado. En la siguiente sección se describe cómo funciona el sistema de configuración de IIS y cómo se puede extender para admitir la configuración del host de IIS WinRM.

### <a name="how-iis-configuration-works"></a>Cómo funciona la configuración de IIS

La infraestructura de configuración de IIS se compone de un conjunto de archivos XML que se usan para almacenar los datos de configuración y un conjunto de archivos de esquema que se usan para validar los datos escritos o leídos mediante las API de administración de IIS. En el nivel raíz, hay un archivo ApplicationHost.config en el mismo directorio que IIS (normalmente,% WINDIR% \\ system32 \\ InetSrv \\ config). Este es el archivo de configuración principal de IIS, donde se almacena la lista de sitios, aplicaciones, directorios virtuales, configuración general, registro, almacenamiento en caché, etc. Los datos de configuración se dividen en y se accede a ellos como entidades independientes denominadas **secciones**.

Por ejemplo, hay **secciones** independientes para los sitios, el registro, el almacenamiento en caché, etc. Los datos de configuración contenidos en ApplicationHost.config se aplican a todos los sitios, aplicaciones y directorios virtuales configurados en IIS. En el nivel de directorio virtual, un archivo web.config define datos de configuración específicos de la aplicación, posiblemente invalidando otros datos ya definidos en ApplicationHost.config. Los archivos de Web.config se almacenan en la raíz (directorio físico) correspondiente al sitio, la aplicación o el directorio virtual al que se aplica la configuración.

Para obtener más información acerca de la configuración de IIS, consulte lo siguiente:

-   [Esquema de configuración de IIS 7,0](/previous-versions/iis/settings-schema/aa347559(v=vs.90))
-   [/archive/blogs/carlosag/](/archive/blogs/carlosag/)
-   [https://www.iis.net/articles/view.aspx/IIS7/Use-IIS7-Administration-Tools/Using-XML-Configuration/Deep-Dive-into-IIS7](https://www.iis.net/learn/get-started/planning-your-iis-architecture/deep-dive-into-iis-configuration-with-iis-7-and-iis-8)

El esquema de configuración de IIS que se usa para validar los datos de configuración de IIS es un archivo XML almacenado en el directorio de esquema de IIS (normalmente,% WINDIR% \\ system32 \\ InetSrv \\ config \\ Schema). El esquema de configuración de IIS no es XSD. La configuración de IIS admite la extensibilidad. Las nuevas secciones de configuración se pueden integrar directamente en el sistema de configuración de IIS y la configuración del sistema de configuración de IIS se puede manipular con las API de administración existentes.

Estos son los pasos principales implicados:

-   Defina una nueva sección de configuración en un archivo de esquema XML.
-   Coloque el archivo en el directorio de esquema de IIS 7 (% WINDIR% \\ system32 \\ InetSrv \\ config \\ Schema).
-   Registre la nueva sección en el archivo de configuración global de IIS (ApplicationHost.config).

## <a name="iis-host-winrm-configuration-setup-and-details"></a>Configuración y detalles de la configuración de host de IIS (WinRM)

En esta sección se describen los pasos que se deben llevar a cabo durante la instalación para integrar e inicializar la configuración del host de IIS. Aquí, la configuración del host de IIS hace referencia a los datos de configuración necesarios para ejecutar el servicio WinRM en IIS. El módulo de extensión WinRM IIS es un componente opcional que se instala mediante el **Administrador del servidor**.

La sección de configuración de IIS que define la configuración necesaria se denomina **system.management.wsmanagement.config**. Normalmente, la configuración del host de IIS se define durante la instalación. Esto se puede hacer creando un archivo de web.config y agregando el XML adecuado. Cualquier cambio en el archivo web.config requiere reiniciar el sitio que hospeda el servicio WinRM.

En el procedimiento siguiente se describe con detalle la configuración de la extensión WinRM de IIS.

**Para instalar la extensión WinRM de IIS**

1.  En la sección **Resumen de características** del **Administrador del servidor**, haga clic en **Agregar características**.
2.  En el Asistente para agregar características, seleccione extensión IIS de WinRM.
3.  Siga las instrucciones del asistente, incluida la instalación del software necesario, si se indica alguno. Para obtener más información acerca del uso del Asistente para agregar características, consulte la ayuda en pantalla de **Administrador del servidor** .

### <a name="initializing-winrm-configuration-for-the-hosted-application"></a>Inicializando la configuración de WinRM para la aplicación hospedada

Este paso implica definir el XML de configuración de host de IIS en el archivo de web.config. Este archivo reside en el directorio físico correspondiente al directorio virtual en el que está configurada la aplicación hospedada. El contenido XML de la sección **system.management.wsmanagement.config** debe ajustarse al esquema definido en el \_schema.xml de Wsmanconfig; de lo contrario, las API de administración de IIS no podrán procesarla. A continuación se incluye un ejemplo de contenido XML que podría incluirse en el archivo web.config:


```XML
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
 <system.webServer>
  <system.management.wsmanagement.config>
   <OperationsConfiguration MaxEnvelopeSizeKB="150" 
                            MaxOperationTimeoutSeconds="60"  
                            MaxEnumerateIdleTimeoutSeconds="60"  
                            MaxSubscribeIdleTimeoutSeconds="60"  
                            MaxShellIdleTimeoutMinutes="15"
                            QuotaRefreshIntervalSeconds="900"
                            QuotaSystemWindowSeconds="2"
                            QuotaSystemWindowOperations-"1000"/>
    <PluginModules>
     <AuthorizationPlugin Name="Auth1" Filename="Auth.dll" SDKVersion="1" SupportsQuota="true"/>
     <OperationsPlugins>
      <Plugin Name="PL1" Filename="PL1.dll" SDKVersion="1" XmlRenderingType="text">
       <InitializationParameters>
        <Param name="myParam1" value="myValue1"/>
       </InitializationParameters>
       <Resources>
        <Resource ResourceUri="myUri1">
        <Capability Type="Shell"/>
        </Resource>
       </Resources>
      </Plugin>
      <Plugin Name="PL2" Filename="PL2.dll" SDKVersion="1" XmlRenderingType="text">
       <InitializationParameters/>
       <Resources>
        <Resource ResourceUri="myUri1">
         <Capability Type="Get"/>
         <Capability Type="Put"/>
         <Capability Type="Delete"/>
        </Resource>
       </Resources>
      </Plugin>
     </OperationsPlugins>
    </PluginModules>
   </OperationsConfiguration>
  </system.management.wsmanagement.config>
 </system.webServer>
</configuration>
```



En la lista siguiente se describen los elementos XML con más detalle y a continuación se muestra un ejemplo de un archivo deschema.xml de wsmanconfig \_ .



| Elemento                                                        | Descripción                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|----------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| OperationsConfiguration/MaxEnvelopeSizeKB                      | El tamaño máximo de los paquetes SOAP que el servicio WinRM va a procesar. El valor predeterminado es 150 KB.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| OperationsConfiguration/MaxOperationTimeoutSeconds             | El intervalo máximo de tiempo de espera para todas las operaciones. Este valor invalida cualquier valor que se reciba en un paquete SOAP. Si un proveedor supera este valor, se envía un tiempo de espera al cliente y se cancela la operación. (Algunas operaciones, como las enumeraciones, pueden mantener una enumeración abierta después de un tiempo de espera). El valor predeterminado es 60 segundos.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| OperationsConfiguration/MaxEnumerationIdleTimeoutSeconds       | El intervalo de tiempo de espera máximo para las enumeraciones. Si el tiempo entre las solicitudes de enumeración es mayor que este valor, la enumeración se cancela y el contexto de enumeración emitido previamente ya no es válido. El valor predeterminado es 60 segundos.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| OperationsConfiguration/MaxSubscribeIdleTimeoutSeconds         | El intervalo máximo de tiempo de espera para las operaciones de suscripción. El valor predeterminado es 60 segundos.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| OperationsConfiguration/MaxShellIdleTimeoutMinutes             | El tiempo máximo en minutos antes de que se elimine un shell remoto inactivo. El valor predeterminado es 15 minutos.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| OperationsConfiguration/QuotaRefreshIntervalSeconds            | El intervalo antes de que se actualice la información de cuota de un usuario. Las solicitudes pendientes para el usuario especificado continúan ejecutándose en el contexto de cuota y autorización anterior hasta que se complete la actualización. El valor predeterminado es 900 segundos.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| OperationsConfiguration/QuotaSystemWindowSeconds               | La duración de la ventana deslizante del acelerador del sistema. El valor predeterminado es 2 segundos.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| OperationsConfiguration/QuotaSystemWindowOperations            | El número de operaciones que se admiten a través de la limitación del sistema durante la ventana deslizante. El valor predeterminado es 1000 operaciones.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| PlugInModules/AuthorizationPlugin                              | Este nodo es opcional. Un complemento de autorización permite la aceptación o el rechazo de un usuario entrante basado en esquemas de autenticación diferentes mediante programación.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| PlugInModules/AuthorizationPlugin/Name                         | Especifica el nombre para mostrar que se va a utilizar para el complemento. Si el complemento devuelve un error, este nombre se colocará en el XML de error que se devuelve a la aplicación cliente. El nombre no es específico de la configuración regional.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| PlugInModules/AuthorizationPlugin/FILENAME                     | Especifica el nombre de archivo del complemento de autorización. Las variables de entorno que se colocan en esta entrada se expandirán en función de la identidad en la que se ejecuta el host de IIS, como servicio de red. El valor predeterminado de esta entrada está vacío, lo que significa que no se utiliza ningún complemento de autorización.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| PlugInModules/AuthorizationPlugin/SDKVersion                   | Especifica la versión del kit de desarrollo de software (SDK) para el que se escribió un complemento determinado. Este elemento debe establecerse en 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| PlugInModules/AuthorizationPlugin/SupportsQuota                | Especifica si el complemento de autorización admite cuotas.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| PlugInModules/OperationsPlugins/Name                           | Especifica el nombre para mostrar que se va a utilizar para el complemento. Si el complemento devuelve un error, este nombre se colocará en el XML de error que se devuelve a la aplicación cliente. El nombre no es específico de la configuración regional.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| PlugInModules/OperationsPlugins/FileName                       | Especifica el nombre de archivo del complemento de la operación. Las variables de entorno que se colocan en esta entrada se expandirán en el contexto del usuario cuando llegue una solicitud. Cada usuario puede tener una versión diferente de la misma variable de entorno, por lo que cada usuario podría acabar con otro complemento. Esta entrada no puede estar en blanco y debe apuntar a un complemento válido.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| PlugInModules/OperationsPlugins/SDKVersion                     | Especifica la versión del SDK para el que se escribió un complemento determinado. Este elemento debe establecerse en 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| PlugInModules/OperationsPlugins/XmlRenderingType               | Configura el formato en el que se pasa el XML a los complementos a través del objeto de [**\_ datos WSMAN**](/windows/desktop/api/Wsman/ns-wsman-wsman_data) . **XmlRenderingType** se establece en texto. Los datos XML entrantes se encuentran en una \_ estructura de texto de tipo de datos WSMAN \_ \_ , que representa el XML como un búfer de memoria **PCWSTR** .                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| PlugInModules/OperationsPlugins/InitializationParameters       | Este nodo es opcional y permite a un complemento configurar XML adicional que se pasará al método [**WSManPluginStartup**](/windows/desktop/api/Wsman/nc-wsman-wsman_plugin_startup) . La mayoría de los complementos no necesitarán esta información adicional, pero si es necesario usar un complemento en más de un escenario que requiera una semántica diferente en tiempo de ejecución, este XML proporcionará al complemento la flexibilidad.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| PlugInModules/OperationsPlugins/Resources                      | Especifica una lista de [*URI de recurso*](windows-remote-management-glossary.md) que este complemento admite. Se debe especificar al menos una entrada **ResourceUri** ; de lo contrario, se rechazará el XML.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| PlugInModules/OperationsPlugins/recursos/recurso             | Representa una configuración de [*URI de recurso*](windows-remote-management-glossary.md) único.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| PlugInModules/OperationsPlugins/Resources/Resource/ResourceUri | Especifica un [*URI de recurso*](windows-remote-management-glossary.md) único en su totalidad o como una cadena de coincidencia parcial basada en el atributo **ExactMatch** . Si **ExactMatch** no está presente, el valor predeterminado es **false**, lo que significa que el procesador SOAP de WinRM realizará una coincidencia parcial con el inicio del *URI del recurso* y, si hay una coincidencia, la pasará al complemento. El atributo **SupportsOptions** se puede especificar si se permite que se pasen opciones a este *URI de recurso* . De forma predeterminada, no se admiten opciones y, si hay alguna presente en la solicitud de cliente, se devolverá un error. Si el complemento admite las opciones, es importante que el complemento devuelva el error correcto si hay una opción que indica que el complemento no entiende si la marca **MustUnderstand** está establecida en **true**...                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| PlugInModules/OperationsPlugins/recurso/capacidad            | Especifica una funcionalidad que está disponible en este [*URI de recurso*](windows-remote-management-glossary.md). Habrá una entrada para cada tipo de operación que admita. Están disponibles las siguientes opciones:<br/> <dl> <dt><span id="Get"></span><span id="get"></span><span id="GET"></span>Obtener</dt> <dd> Las operaciones GET se admiten en el [*URI de recurso*](windows-remote-management-glossary.md). El atributo **SupportFragment** se usa si la operación Get admite el concepto. El atributo **SupportFiltering** no es válido y debe establecerse en **false**. Esta funcionalidad no es válida para un *URI de recurso* si también se admiten las operaciones de Shell.<br/> </dd> <dt><span id="Put"></span><span id="put"></span><span id="PUT"></span>Pondrán</dt> <dd> Las operaciones put se admiten en el [*URI de recurso*](windows-remote-management-glossary.md). El atributo **SupportFragment** se usa si la operación PUT es compatible con el concepto. El atributo **SupportFiltering** no es válido y debe establecerse en **false**. Esta funcionalidad no es válida para un *URI de recurso* si también se admiten las operaciones de Shell.<br/> </dd> <dt><span id="Create"></span><span id="create"></span><span id="CREATE"></span>A</dt> <dd> Las operaciones de creación se admiten en el [*URI de recurso*](windows-remote-management-glossary.md). El atributo **SupportFragment** se usa si la operación de creación es compatible con el concepto. El atributo **SupportFiltering** no es válido y debe establecerse en **false**. Esta funcionalidad no es válida para un *URI de recurso* si también se admiten las operaciones de Shell.<br/> </dd> <dt><span id="Delete"></span><span id="delete"></span><span id="DELETE"></span>Elimínelos</dt> <dd> Las operaciones de eliminación se admiten en el [*URI de recurso*](windows-remote-management-glossary.md). El atributo **SupportFragment** se usa si la operación de eliminación admite el concepto. El atributo **SupportFiltering** no es válido y debe establecerse en **false**. Esta funcionalidad no es válida para un *URI de recurso* si también se admiten las operaciones de Shell.<br/> </dd> <dt><span id="Invoke"></span><span id="invoke"></span><span id="INVOKE"></span>Invocar</dt> <dd> Las operaciones de invocación se admiten en el [*URI de recurso*](windows-remote-management-glossary.md). El atributo **SupportFragment** no se admite para las operaciones de invocación y debe establecerse en **false**. El atributo **SupportFiltering** no es válido y debe establecerse en **false**. Esta funcionalidad no es válida para un *URI de recurso* si también se admiten las operaciones de Shell.<br/> </dd> <dt><span id="Enumerate"></span><span id="enumerate"></span><span id="ENUMERATE"></span>Enumerar</dt> <dd> Las operaciones de enumeración se admiten en el [*URI de recurso*](windows-remote-management-glossary.md). El atributo **SupportFragment** no se admite para las operaciones de enumeración y debe establecerse en **false**. El atributo **SupportFiltering** es válido y, si el complemento admite el filtrado, este atributo debe establecerse en **true**. Esta funcionalidad no es válida para un *URI de recurso* si también se admiten las operaciones de Shell.<br/> </dd> <dt><span id="Subscribe"></span><span id="subscribe"></span><span id="SUBSCRIBE"></span>Suscribirse</dt> <dd> Se admiten las operaciones subscribe en el [*URI de recurso*](windows-remote-management-glossary.md). El atributo **SupportFragment** no se admite para las operaciones subscribe y debe establecerse en **false**. El atributo **SupportFiltering** no es válido y debe establecerse en **false**. Esta funcionalidad no es válida para un *URI de recurso* si también se admiten las operaciones de Shell.<br/> </dd> <dt><span id="Shell"></span><span id="shell"></span><span id="SHELL"></span>Shell</dt> <dd> Las operaciones de Shell se admiten en el [*URI de recurso*](windows-remote-management-glossary.md). El atributo **SupportFragment** no se admite para las operaciones de Shell y debe establecerse en **false**. El atributo **SupportFiltering** no es válido y debe establecerse en **false**. Esta funcionalidad no es válida para un *URI de recurso* si también se admite cualquier otra funcionalidad de operación. Si se configura una funcionalidad de operación de Shell para un *URI de recurso*, las operaciones GET, Put, Create, Delete, Invoke y Enumerate se procesan internamente dentro del servicio WinRM para administrar los shells. Como resultado, el complemento no puede tratar con las propias operaciones.<br/> </dd> </dl> |



 

### <a name="example-wsmanconfig_schemaxml-file"></a>Archivo deschema.xml de wsmanconfig de ejemplo \_

Durante la instalación, se coloca un archivo XML denominado wsmanconfig \_schema.xml que contiene el siguiente contenido en el directorio de esquemas de IIS:


```XML
<configSchema>
 <sectionSchema name="system.webServer/system.management.wsmanagement.config">
  <element name="OperationsConfiguration">
   <attribute name="MaxEnvelopeSizeKB" 
              type="uint" 
              defaultValue="150" 
              validationType="integerRange" 
              validationParameter="32,4294967295"/>
   <attribute name="MaxOperationTimeoutSeconds" 
              type="uint" 
              defaultValue="60" 
              validationType="integerRange" 
              validationParameter="1,4294967295"/>
   <attribute name="MaxEnumerateIdleTimeoutSeconds" 
              type="uint" 
              defaultValue="60" 
              validationType="integerRange" 
              validationParameter="1,4294967295"/>
   <attribute name="MaxSubscribeIdleTimeoutSeconds" 
              type="uint" 
              defaultValue="60" 
              validationType="integerRange" 
              validationParameter="1,4294967295"/>
   <attribute name="MaxShellIdleTimeoutMinutes" 
              type="uint" 
              defaultValue="15" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
   <attribute name="QuotaRefreshIntervalSeconds" 
              type="uint" 
              defaultValue="900" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
   <attribute name="QuotaSystemWindowSeconds" 
              type="uint" 
              defaultValue="2" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
   <attribute name="QuotaSystemWindowOperations" 
              type="uint" 
              defaultValue="1000" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
  </element>
  <element name="PluginModules">
   <collection addElement="AuthorizationPlugin">
    <attribute name="Name" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
    <attribute name="Filename" type="string" required="true" validationType="nonEmptyString"/>
    <attribute name="SDKVersion" type="uint" required="true"/>
    <attribute name="SupportsQuota" type="bool" defaultValue="false"/>
   </collection>
   <element name="OperationsPlugins">
    <collection addElement="Plugin">
     <attribute name="Name" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
     <attribute name="Filename" type="string" required="true" validationType="nonEmptyString"/>
     <attribute name="SDKVersion" type="uint" required="true"/>
     <attribute name="XmlRenderingType" type="enum" defaultValue="text">
      <enum name="text" value="1"/>
      <enum name="XmlReader" value="2"/>
     </attribute>
     <attribute name="Enabled" type="bool" defaultValue="true"/>
     <element name="InitializationParameters">
      <collection addElement="Param">
       <attribute name="Name" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
       <attribute name="Value" type="string" required="true" validationType="nonEmptyString"/>
      </collection>
     </element>
     <element name="Resources">
      <collection addElement="Resource">
       <attribute name="ResourceUri" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
       <attribute name="SupportsOptions" type="bool" defaultValue="false"/>
       <attribute name="ExactMatch" type="bool" defaultValue="false"/>
       <collection addElement="Capability">
        <attribute name="Type" type="enum" isUniqueKey="true" required="true">
         <enum name="Get" value="1"/>
         <enum name="Put" value="2"/>
         <enum name="Create" value="3"/>
         <enum name="Delete" value="4"/>
         <enum name="Invoke" value="5"/>
         <enum name="Enumerate" value="6"/>
         <enum name="Subscribe" value="7"/>
         <enum name="Shell" value="8"/>
        </attribute>
        <attribute name="SupportsFragment" type="bool" default="false"/>
        <attribute name="SupportsFiltering" type="bool" default="false"/>
       </collection>
      </collection>
     </element>
    </collection>
   </element>
  </element>
 </sectionSchema>
</configSchema>
```



## <a name="reading-iis-host-configuration"></a>Leyendo la configuración del host de IIS

La configuración del host de IIS se lee durante el proceso de inicio del procesador de SOAP en la aplicación hospedada. Dado que web.config archivos se pueden editar manualmente y, por lo tanto, son propensos a errores de validación de esquemas, puede haber problemas al leer una configuración. Durante un error de lectura o de validación de la configuración, la aplicación hospedada no se iniciará y devolverá un mensaje de error adecuado al cliente. Se registrará un evento que contiene una descripción detallada de la causa del error.

Entre los errores comunes se incluyen los siguientes:

-   Acceso denegado
-   XML de configuración no válido
-   No se configuró ningún complemento (se requiere al menos uno)

Los complementos estándar no están configurados de forma predeterminada. Deben configurarse explícitamente en el archivo web.config antes de que empiecen a recibir solicitudes.

## <a name="enumerating-plug-ins-on-the-winrm-service"></a>Enumerar complementos en el servicio WinRM

El siguiente comando muestra cómo usar la utilidad WinRM para determinar qué complementos están disponibles en el servicio WinRM: **WinRM Enumerate WinRM/config/plugin-Format: Pretty**.

 

