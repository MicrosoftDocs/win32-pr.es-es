---
title: Habilitar la aceleración de vídeo de DirectX
description: Habilitar la aceleración de vídeo de DirectX
ms.assetid: 5cb2f564-88e3-4b60-bde3-6ccf69c97c48
keywords:
- SDK de Windows Media Format, habilitar DXVA
- Windows Media Format SDK, DirectX video Acceleration (DXVA)
- SDK de Windows Media Format, aceleración de vídeo
- Advanced Systems Format (ASF), habilitar DXVA
- ASF (formato de sistemas avanzados), habilitar DXVA
- Advanced Systems Format (ASF), DirectX video Acceleration (DXVA)
- ASF (formato de sistemas avanzados), aceleración de vídeo de DirectX (DXVA)
- Advanced Systems Format (ASF), aceleración de vídeo
- ASF (formato de sistemas avanzados), aceleración de vídeo
- Aceleración de vídeo de DirectX (DXVA), habilitar
- DXVA (aceleración de vídeo de DirectX), habilitar
- Aceleración de vídeo DirectX (DXVA), orden de operaciones
- DXVA (aceleración de vídeo DirectX), orden de operaciones
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 896147fe11b4b7f5fb91d8dc288e616b643bd5ce
ms.sourcegitcommit: 48d1c892045445bcbd0f22bafa2fd3861ffaa6e7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 02/19/2020
ms.locfileid: "104420239"
---
# <a name="enabling-directx-video-acceleration"></a><span data-ttu-id="14fe1-116">Habilitar la aceleración de vídeo de DirectX</span><span class="sxs-lookup"><span data-stu-id="14fe1-116">Enabling DirectX Video Acceleration</span></span>

<span data-ttu-id="14fe1-117">En esta sección se describe cómo habilitar la aceleración de vídeo de Microsoft® DirectX® al reproducir contenido transmitido en un reproductor personalizado.</span><span class="sxs-lookup"><span data-stu-id="14fe1-117">This section describes how to enable Microsoft® DirectX® Video Acceleration when playing streamed content in a custom player.</span></span>

## <a name="background"></a><span data-ttu-id="14fe1-118">Información previa</span><span class="sxs-lookup"><span data-stu-id="14fe1-118">Background</span></span>

<span data-ttu-id="14fe1-119">DirectX video Acceleration (DirectX VA) es una especificación de API para la aceleración de hardware de las operaciones de descodificación 2D.</span><span class="sxs-lookup"><span data-stu-id="14fe1-119">DirectX Video Acceleration (DirectX VA) is an API specification for hardware acceleration of 2-D decoding operations.</span></span> <span data-ttu-id="14fe1-120">Permite a los descodificadores de software descargar ciertas operaciones de uso intensivo de la CPU en la tarjeta gráfica para su procesamiento.</span><span class="sxs-lookup"><span data-stu-id="14fe1-120">It enables software decoders to offload certain CPU-intensive operations to the graphics card for processing.</span></span> <span data-ttu-id="14fe1-121">En el caso de los usuarios finales, esto hace posible vídeo de alta velocidad, como la reproducción de DVD a pantalla completa, en equipos más antiguos equipados con tarjetas gráficas compatibles con DirectX VA.</span><span class="sxs-lookup"><span data-stu-id="14fe1-121">For end users, this makes possible high-bit-rate video such as full-screen DVD playback on older computers equipped with DirectX VA-compatible graphics cards.</span></span>

<span data-ttu-id="14fe1-122">A partir del SDK de Windows Media Format 9 series, el filtro de contenedor de DMO es compatible con DirectX VA.</span><span class="sxs-lookup"><span data-stu-id="14fe1-122">Beginning with the Windows Media Format 9 Series SDK, the DMO Wrapper filter supports DirectX VA.</span></span> <span data-ttu-id="14fe1-123">Esto significa que, para la reproducción local, las aplicaciones pueden usar el filtro de lector ASF de WM para reproducir contenido basado en Windows Media y la aceleración de hardware de DirectX VA se invocará automáticamente si la tarjeta gráfica lo admite.</span><span class="sxs-lookup"><span data-stu-id="14fe1-123">This means that, for local playback, applications can use the WM ASF Reader filter to play Windows Media-based content and DirectX VA hardware acceleration will be invoked automatically if the graphics card supports it.</span></span> <span data-ttu-id="14fe1-124">Sin embargo, el filtro de lector ASF de WM no admite la reproducción de contenido transmitido por secuencias.</span><span class="sxs-lookup"><span data-stu-id="14fe1-124">However, the WM ASF Reader filter does not support playback of streamed content.</span></span> <span data-ttu-id="14fe1-125">Por lo tanto, si desea admitir DirectX VA al reproducir contenido transmitido en un reproductor personalizado, debe usar un mecanismo alternativo, que es el que usa Windows Media Player a partir de la serie Windows Media 9.</span><span class="sxs-lookup"><span data-stu-id="14fe1-125">Therefore, if you want to support DirectX VA when playing streamed content in a custom player, you must use an alternate mechanism, which is the one used by Windows Media Player beginning with the Windows Media 9 Series.</span></span>

<span data-ttu-id="14fe1-126">Dado que Windows Media Player se diseñó antes de que se hubiesen desarrollado los filtros de QASF, Windows Media Player tiene su propio filtro de origen, basado en el SDK de Windows Media Format, para reproducir contenido basado en Windows Media.</span><span class="sxs-lookup"><span data-stu-id="14fe1-126">Because Windows Media Player was designed before the QASF filters had been developed, Windows Media Player has its own source filter, based on the Windows Media Format SDK, for playing Windows Media-based content.</span></span> <span data-ttu-id="14fe1-127">El filtro de origen de Windows Media de WMP proporciona datos descomprimidos de nivel inferior directamente a los representadores de audio y vídeo.</span><span class="sxs-lookup"><span data-stu-id="14fe1-127">The WMP Windows Media Source Filter delivers decompressed data downstream directly to the audio and video renderers.</span></span> <span data-ttu-id="14fe1-128">Por el contrario, el lector ASF de WM entrega el contenido comprimido de nivel inferior a los objetos multimedia DirectX de Windows Media descodificador (DMOs), que se hospedan en el contenedor de DMO.</span><span class="sxs-lookup"><span data-stu-id="14fe1-128">By contrast, the WM ASF Reader delivers compressed content downstream to the Windows Media Decoder DirectX Media Objects (DMOs), which are hosted inside the DMO Wrapper.</span></span> <span data-ttu-id="14fe1-129">En los diagramas siguientes se muestran las diferencias entre el lector ASF de WM y el filtro de origen de Windows Media de WMP.</span><span class="sxs-lookup"><span data-stu-id="14fe1-129">The following diagrams illustrate the differences between the WM ASF Reader and the WMP Windows Media Source Filter.</span></span>

![el filtro de origen personalizado genera muestras sin comprimir](images/wmp-dxva-graph.png)

![el filtro de origen qasf muestra ejemplos comprimidos](images/qasf-dxva-graph.png)

<span data-ttu-id="14fe1-132">Para habilitar DirectX VA para el contenido transmitido por secuencias, debe crear un filtro de origen personalizado como el del diagrama superior.</span><span class="sxs-lookup"><span data-stu-id="14fe1-132">To enable DirectX VA for streamed content, you must create a custom source filter like the one in the top diagram.</span></span> <span data-ttu-id="14fe1-133">Básicamente, este filtro usará el SDK de Windows Media Format para crear una instancia de un objeto de lector de WM, descomprimir los ejemplos y enviarlos en orden descendente en sus clavijas de salida.</span><span class="sxs-lookup"><span data-stu-id="14fe1-133">Basically, this filter will use the Windows Media Format SDK to instantiate a WM Reader object, decompress the samples, and send them downstream on its output pins.</span></span> <span data-ttu-id="14fe1-134">En este debate se supone que ya ha creado el filtro de origen y ahora está listo para implementar la compatibilidad con DirectX VA.</span><span class="sxs-lookup"><span data-stu-id="14fe1-134">This discussion assumes that you have created the source filter already and are now ready to implement the DirectX VA support.</span></span>

<span data-ttu-id="14fe1-135">Para habilitar DirectX VA, la tarea básica del filtro de origen es proporcionar el representador de vídeo y el descodificador WMV DMO con las interfaces que deberán negociar la conexión de DirectX VA.</span><span class="sxs-lookup"><span data-stu-id="14fe1-135">To enable DirectX VA, the basic task of the source filter is to provide the Video Renderer and the WMV Decoder DMO with the interfaces they will need to negotiate the DirectX VA connection.</span></span> <span data-ttu-id="14fe1-136">El filtro de origen no participa en esas negociaciones.</span><span class="sxs-lookup"><span data-stu-id="14fe1-136">The source filter does not participate in those negotiations.</span></span> <span data-ttu-id="14fe1-137">Una vez que se inicia el streaming, la única tarea relacionada con DirectX VA que puede realizar el filtro de origen es modificar las marcas de tiempo de las muestras de vídeo antes de que el descodificador WMV las entregue al representador de vídeo.</span><span class="sxs-lookup"><span data-stu-id="14fe1-137">After streaming starts, the only DirectX VA-related task that the source filter can perform is to modify the time stamps on the video samples before the WMV decoder delivers them to the Video Renderer.</span></span> <span data-ttu-id="14fe1-138">La razón principal para hacerlo es proporcionar un control de escala de tiempo personalizado más allá de lo que habilitan las interfaces estándar de DirectShow®.</span><span class="sxs-lookup"><span data-stu-id="14fe1-138">The primary reason for doing this is to provide custom timeline control beyond what the standard DirectShow® interfaces enable.</span></span>

<span data-ttu-id="14fe1-139">Se definen tres interfaces para habilitar las comunicaciones necesarias entre el SDK de Windows Media Format, el filtro de origen del reproductor, el Windows Media Video descodificador DMO y el mezclador de superposición o el representador de mezcla de vídeo.</span><span class="sxs-lookup"><span data-stu-id="14fe1-139">Three interfaces are defined to enable the necessary communications between the Windows Media Format SDK, the player's source filter, the Windows Media Video decoder DMO, and the Overlay Mixer or Video Mixing Renderer.</span></span> <span data-ttu-id="14fe1-140">Estas interfaces se describen en la tabla siguiente.</span><span class="sxs-lookup"><span data-stu-id="14fe1-140">These interfaces are described in the following table.</span></span>



| <span data-ttu-id="14fe1-141">Interfaz</span><span class="sxs-lookup"><span data-stu-id="14fe1-141">Interface</span></span>                                                        | <span data-ttu-id="14fe1-142">Descripción</span><span class="sxs-lookup"><span data-stu-id="14fe1-142">Description</span></span>                                                                                                                                                                                        |
|------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="14fe1-143">**IWMCodecAMVideoAccelerator**</span><span class="sxs-lookup"><span data-stu-id="14fe1-143">**IWMCodecAMVideoAccelerator**</span></span>](/previous-versions/windows/desktop/api/wmdxva/nn-wmdxva-iwmcodecamvideoaccelerator) | <span data-ttu-id="14fe1-144">Expuesto por el descodificador de Windows Media DMO y llamado por el filtro de origen de un reproductor multimedia para configurar las distintas conexiones necesarias para habilitar DirectX VA para la descodificación del contenido de Windows Media Video.</span><span class="sxs-lookup"><span data-stu-id="14fe1-144">Exposed by the Windows Media Decoder DMO and called by a media player's source filter to set up the various connections required to enable DirectX VA for decoding of Windows Media Video content.</span></span> |
| [<span data-ttu-id="14fe1-145">**IWMPlayerTimestampHook**</span><span class="sxs-lookup"><span data-stu-id="14fe1-145">**IWMPlayerTimestampHook**</span></span>](/previous-versions/windows/desktop/api/wmdxva/nn-wmdxva-iwmplayertimestamphook)         | <span data-ttu-id="14fe1-146">Implementado en el filtro de origen del reproductor.</span><span class="sxs-lookup"><span data-stu-id="14fe1-146">Implemented on the player's source filter.</span></span> <span data-ttu-id="14fe1-147">Permite que el filtro modifique las marcas de tiempo en las muestras de vídeo antes de entregarlas en orden descendente.</span><span class="sxs-lookup"><span data-stu-id="14fe1-147">It enables the filter to modify the time stamps on the video samples before delivering them downstream.</span></span>                                                 |
| [<span data-ttu-id="14fe1-148">**IWMReaderAccelerator**</span><span class="sxs-lookup"><span data-stu-id="14fe1-148">**IWMReaderAccelerator**</span></span>](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmreaderaccelerator)             | <span data-ttu-id="14fe1-149">Implementado en el objeto lector de WM.</span><span class="sxs-lookup"><span data-stu-id="14fe1-149">Implemented on the WM Reader object.</span></span> <span data-ttu-id="14fe1-150">Lo llama un filtro de origen del reproductor para obtener interfaces del descodificador DMO.</span><span class="sxs-lookup"><span data-stu-id="14fe1-150">It is called by a player source filter to obtain interfaces from the decoder DMO.</span></span>                                                                             |



 

## <a name="order-of-operations-in-directx-vaenabled-playback"></a><span data-ttu-id="14fe1-151">Orden de operaciones en DirectX: reproducción habilitada</span><span class="sxs-lookup"><span data-stu-id="14fe1-151">Order of Operations in DirectX VA–enabled Playback</span></span>

<span data-ttu-id="14fe1-152">En esta sección se describe el orden general de las operaciones en tiempo de ejecución para un reproductor habilitado para DirectX y su filtro de origen.</span><span class="sxs-lookup"><span data-stu-id="14fe1-152">This section describes the general order of operations at run time for a DirectX VA-enabled player and its source filter.</span></span> <span data-ttu-id="14fe1-153">Los componentes a los que se hace referencia en esta sección son:</span><span class="sxs-lookup"><span data-stu-id="14fe1-153">The components referred to in this section are:</span></span>

-   <span data-ttu-id="14fe1-154">Un reproductor multimedia de terceros, denominado reproductor.</span><span class="sxs-lookup"><span data-stu-id="14fe1-154">A third-party media player, referred to as the player.</span></span>
-   <span data-ttu-id="14fe1-155">Un filtro de origen personalizado, al que se ha creado una instancia del reproductor, que usa el SDK de Windows Media Format para descomprimir el contenido basado en Windows Media.</span><span class="sxs-lookup"><span data-stu-id="14fe1-155">A custom source filter, instantiated by the player, that uses the Windows Media Format SDK to decompress Windows Media-based content.</span></span>
-   <span data-ttu-id="14fe1-156">La clavija de salida de vídeo del filtro de origen del reproductor, que se conoce como el PIN de salida.</span><span class="sxs-lookup"><span data-stu-id="14fe1-156">The video output pin of the player's source filter, referred to as the output pin.</span></span>
-   <span data-ttu-id="14fe1-157">Gráfico de filtro de reproducción de vídeo de DirectShow, denominado gráfico.</span><span class="sxs-lookup"><span data-stu-id="14fe1-157">The DirectShow video playback filter graph, referred to as the graph.</span></span>
-   <span data-ttu-id="14fe1-158">El representador de mezcla de vídeo, denominado VMR.</span><span class="sxs-lookup"><span data-stu-id="14fe1-158">The Video Mixing Renderer, referred to as the VMR.</span></span>
-   <span data-ttu-id="14fe1-159">Objeto lector asincrónico del SDK de formato de Windows Media, al que se hace referencia como lector.</span><span class="sxs-lookup"><span data-stu-id="14fe1-159">The Windows Media Format SDK Asynchronous Reader object, referred to as the reader.</span></span>
-   <span data-ttu-id="14fe1-160">El objeto multimedia de DirectX del descodificador de Windows Media Video, conocido como descodificador DMO.</span><span class="sxs-lookup"><span data-stu-id="14fe1-160">The Windows Media Video Decoder DirectX Media Object, referred to as the decoder DMO.</span></span>

<span data-ttu-id="14fe1-161">El orden de las operaciones es el siguiente:</span><span class="sxs-lookup"><span data-stu-id="14fe1-161">The order of operations is as follows:</span></span>

1.  <span data-ttu-id="14fe1-162">El reproductor crea instancias de su filtro de origen y un objeto de lector.</span><span class="sxs-lookup"><span data-stu-id="14fe1-162">The player instantiates its source filter and a reader object.</span></span> <span data-ttu-id="14fe1-163">El lector crea un descodificador de vídeo DMO y establece el tipo de entrada (comprimido) en él.</span><span class="sxs-lookup"><span data-stu-id="14fe1-163">The reader creates a video decoder DMO and sets the (compressed) input type on it.</span></span> <span data-ttu-id="14fe1-164">Esto debe ocurrir antes de que el reproductor intente configurar el gráfico de reproducción de vídeo porque el SDK y el descodificador DMO deben estar implicados en el proceso de negociación con el gráfico, y el DMO debe conocer el formato de entrada durante el paso 9.</span><span class="sxs-lookup"><span data-stu-id="14fe1-164">This must happen before the player attempts to configure its video playback graph because the SDK and the decoder DMO must be involved in the negotiation process with the graph, and the DMO must know the input format during step 9.</span></span>
2.  <span data-ttu-id="14fe1-165">El reproductor llama a **IGraphBuilder:: Render**, proporcionándole el PIN de salida del filtro de origen de vídeo.</span><span class="sxs-lookup"><span data-stu-id="14fe1-165">The player calls **IGraphBuilder::Render**, providing it the video source filter's output pin.</span></span> <span data-ttu-id="14fe1-166">En este momento, el administrador de gráficos de filtros de DirectShow intenta conectar el VMR al filtro de origen de vídeo del reproductor.</span><span class="sxs-lookup"><span data-stu-id="14fe1-166">At this point, the DirectShow filter graph manager tries to connect the VMR to the player's video source filter.</span></span>
3.  <span data-ttu-id="14fe1-167">El administrador de gráficos de filtro llama a **IPin:: Connect** en el PIN de salida del filtro de origen de vídeo del reproductor.</span><span class="sxs-lookup"><span data-stu-id="14fe1-167">The filter graph manager calls **IPin::Connect** on the output pin of the player's video source filter.</span></span>

<span data-ttu-id="14fe1-168">Los pasos 4 a 10 se producen dentro de **IPin:: Connect**.</span><span class="sxs-lookup"><span data-stu-id="14fe1-168">Steps 4 through 10 occur inside of **IPin::Connect**.</span></span>

1.  <span data-ttu-id="14fe1-169">El filtro de origen obtiene la interfaz **IWMCodecAMVideoAccelerator** del método **IWMReaderAccelerator:: GetCodecInterface** del lector.</span><span class="sxs-lookup"><span data-stu-id="14fe1-169">The source filter obtains the **IWMCodecAMVideoAccelerator** interface from the reader's **IWMReaderAccelerator::GetCodecInterface** method.</span></span> <span data-ttu-id="14fe1-170">Si el códec no es compatible con DirectX VA, puede producirse un error en la llamada a **GetCodecInterface** .</span><span class="sxs-lookup"><span data-stu-id="14fe1-170">If the codec does not support DirectX VA, the call to **GetCodecInterface** may fail.</span></span> <span data-ttu-id="14fe1-171">En este caso, la negociación continúa de la forma habitual, sin compatibilidad con DirectX.</span><span class="sxs-lookup"><span data-stu-id="14fe1-171">In this case, negotiation proceeds as usual, without DirectX VA support.</span></span>
2.  <span data-ttu-id="14fe1-172">El filtro de origen pasa el puntero **IAMVideoAccelerator** del PIN pasado en **Connect** al descodificador DMO a través de **IWMCodecAMVideoAccelerator:: SetAcceleratorInterface**.</span><span class="sxs-lookup"><span data-stu-id="14fe1-172">The source filter passes the **IAMVideoAccelerator** pointer from the pin passed into **Connect** to the decoder DMO through **IWMCodecAMVideoAccelerator::SetAcceleratorInterface**.</span></span>
3.  <span data-ttu-id="14fe1-173">A continuación, el filtro de origen delega el resto de la operación **IPin:: Connect** en el método **CBaseOutputPin:: Connect** .</span><span class="sxs-lookup"><span data-stu-id="14fe1-173">The source filter then delegates the remainder of the **IPin::Connect** operation to the **CBaseOutputPin::Connect** method.</span></span> <span data-ttu-id="14fe1-174">La enumeración de formato con el SDK continúa como hace hoy.</span><span class="sxs-lookup"><span data-stu-id="14fe1-174">The format enumeration with the SDK proceeds as it does today.</span></span> <span data-ttu-id="14fe1-175">Si el códec es compatible con DirectX VA para el contenido que se está conectando, el códec DMO presenta los subtipos de DirectX VA en primer lugar, antes de que se admitan los tipos YUV y RGB.</span><span class="sxs-lookup"><span data-stu-id="14fe1-175">If the codec supports DirectX VA for the content being connected, the codec DMO presents those DirectX VA subtypes first, prior to the YUV and RGB types supported.</span></span> <span data-ttu-id="14fe1-176">Si está disponible la compatibilidad con DirectX VA, se intentan los pasos 7 a 11 en el contexto de un subtipo de DirectX VA.</span><span class="sxs-lookup"><span data-stu-id="14fe1-176">If DirectX VA support is available, steps 7 through 11 are attempted in the context of a DirectX VA subtype.</span></span> <span data-ttu-id="14fe1-177">En el fragmento de código siguiente se muestra cómo identificar un subtipo de medios de DirectX VA.</span><span class="sxs-lookup"><span data-stu-id="14fe1-177">The following code snippet shows how to identify a DirectX VA media subtype.</span></span>
    ```C++
    bool IsDXVASubtype( AM_MEDIA_TYPE * pmt )
    {
        // All DXVA types have the same last 3 DWORDs.
        // guidDXVA is the base GUID for all DXVA subtypes.

        GUID guidDXVA = { 0x00000000, 0xa0c7, 0x11d3, { 0xb9,0x84,0x00,0xc0,0x4f,0x2e,0x73,0xc5 } };

        unsigned long const * plguid;
        unsigned long const * plguidDXVA;
        plguid = (unsigned long const *)&pmt->subtype;
        plguidDXVA = (unsigned long *)&guidDXVA;

        if( ( plguid[1] == plguidDXVA[1] ) &&
            ( plguid[2] == plguidDXVA[2] ) &&
            ( plguid[3] == plguidDXVA[3] ) )
        {
            return true;
        }

        return false;
    }
    
    ```

    

4.  <span data-ttu-id="14fe1-178">La implementación de **CBaseOutputPin:: Connect** llama a **IPin:: CompleteConnect** durante el paso 3.</span><span class="sxs-lookup"><span data-stu-id="14fe1-178">The **CBaseOutputPin::Connect** implementation calls **IPin::CompleteConnect** during step 3.</span></span> <span data-ttu-id="14fe1-179">Si se está considerando un subtipo de DirectX VA, se intenta la negociación de DirectX VA.</span><span class="sxs-lookup"><span data-stu-id="14fe1-179">If a DirectX VA subtype is being considered, the DirectX VA negotiation is attempted.</span></span> <span data-ttu-id="14fe1-180">El PIN de salida llama a **IWMCodecAMVideoAccelerator:: NegotiateConnection**, pasándole el tipo de medio de salida actual.</span><span class="sxs-lookup"><span data-stu-id="14fe1-180">The output pin calls **IWMCodecAMVideoAccelerator::NegotiateConnection**, passing it the current output media type.</span></span>
5.  <span data-ttu-id="14fe1-181">El descodificador DMO realiza la negociación necesaria con la VMR a través de la interfaz **IAMVideoAccelerator** y devuelve el GUID del subtipo de vídeo que han acordado los dos.</span><span class="sxs-lookup"><span data-stu-id="14fe1-181">The decoder DMO performs the required negotiation with the VMR through the **IAMVideoAccelerator** interface, and returns the video subtype GUID that the two have agreed on.</span></span> <span data-ttu-id="14fe1-182">El PIN de salida delega todas las llamadas de **IAMVideoAcceleratorNotify** recibidas durante este proceso a la interfaz **IAMVideoAcceleratorNotify** del descodificador DMO, que también se puede obtener a través del método **IWMReaderAccelerator:: GetCodecInterface** .</span><span class="sxs-lookup"><span data-stu-id="14fe1-182">The output pin delegates all **IAMVideoAcceleratorNotify** calls received during this process to the decoder DMO's **IAMVideoAcceleratorNotify** interface, which can also be obtained through the **IWMReaderAccelerator::GetCodecInterface** method.</span></span>
6.  <span data-ttu-id="14fe1-183">Si **NegotiateConnection** se ejecuta correctamente, el PIN de salida llama a **IWMCodecAMVideoAccelerator:: SetPlayerNotify** con una interfaz **IWMPlayerTimestampHook** .</span><span class="sxs-lookup"><span data-stu-id="14fe1-183">If **NegotiateConnection** succeeds, the output pin calls **IWMCodecAMVideoAccelerator::SetPlayerNotify** with an **IWMPlayerTimestampHook** interface.</span></span> <span data-ttu-id="14fe1-184">Este enlace permite que el filtro de origen actualice las marcas de tiempo de los ejemplos antes de que se entreguen al representador.</span><span class="sxs-lookup"><span data-stu-id="14fe1-184">This hook allows the source filter to update the time stamps on the samples before they are handed to the renderer.</span></span>
7.  <span data-ttu-id="14fe1-185">El filtro de origen llama a **IWMReaderAccelerator:: Notify** con el tipo de medio negociado.</span><span class="sxs-lookup"><span data-stu-id="14fe1-185">The source filter calls **IWMReaderAccelerator::Notify** with the negotiated media type.</span></span> <span data-ttu-id="14fe1-186">Esto permite al lector actualizar sus variables internas y confirmar a DirectX VA.</span><span class="sxs-lookup"><span data-stu-id="14fe1-186">This allows the reader to update its internal variables and commit to DirectX VA.</span></span> <span data-ttu-id="14fe1-187">Este es el último lugar en el que se puede producir un error en el lector o el lector.</span><span class="sxs-lookup"><span data-stu-id="14fe1-187">This is the last place the codec or reader can fail.</span></span> <span data-ttu-id="14fe1-188">Si se produce un error en cualquiera de los pasos anteriores, el filtro de origen debe volver al paso 3 y probar el siguiente tipo enumerado por el lector.</span><span class="sxs-lookup"><span data-stu-id="14fe1-188">If any of the above steps fail, the source filter should return to step 3 and try the next type enumerated by the reader.</span></span>
8.  <span data-ttu-id="14fe1-189">Se inicia la reproducción.</span><span class="sxs-lookup"><span data-stu-id="14fe1-189">Playback starts.</span></span> <span data-ttu-id="14fe1-190">El lector omite los búferes de salida del descodificador DMO si el tipo de salida de la conexión es DirectX.</span><span class="sxs-lookup"><span data-stu-id="14fe1-190">The reader ignores output buffers from the decoder DMO if the connection output type is DirectX VA.</span></span>
9.  <span data-ttu-id="14fe1-191">Cuando se produce **IPin::D Ulta** , el filtro de origen llama a **IWMCodecAMVideoAccelerator:: SetAcceleratorInterface** con un **valor null**.</span><span class="sxs-lookup"><span data-stu-id="14fe1-191">When **IPin::Disconnect** occurs, the source filter calls **IWMCodecAMVideoAccelerator::SetAcceleratorInterface** with a **NULL**.</span></span> <span data-ttu-id="14fe1-192">Esto interrumpe la conexión de DirectX VA entre el códec y el representador.</span><span class="sxs-lookup"><span data-stu-id="14fe1-192">This breaks the DirectX VA connection between the codec and the renderer.</span></span>

## <a name="related-topics"></a><span data-ttu-id="14fe1-193">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="14fe1-193">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="14fe1-194">**Leer archivos ASF**</span><span class="sxs-lookup"><span data-stu-id="14fe1-194">**Reading ASF Files**</span></span>](reading-asf-files.md)
</dt> </dl>

 

 




