---
description: La infraestructura del mismo nivel usa eventos para notificar a las aplicaciones de los cambios que se han producido en una red del mismo nivel, por ejemplo, un nodo que se agrega o se quita de un gráfico.
ms.assetid: a056da1c-b8f9-4dad-8df9-df24c6b359b7
title: Infraestructura de eventos del mismo nivel
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6347ad6a7dd0cf2fae4a0aa623bfda48ab0aa9f8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "105667403"
---
# <a name="peer-events-infrastructure"></a><span data-ttu-id="df9d2-103">Infraestructura de eventos del mismo nivel</span><span class="sxs-lookup"><span data-stu-id="df9d2-103">Peer Events Infrastructure</span></span>

<span data-ttu-id="df9d2-104">La infraestructura del mismo nivel usa eventos para notificar a las aplicaciones de los cambios que se han producido en una red del mismo nivel, por ejemplo, un nodo que se agrega o se quita de un gráfico.</span><span class="sxs-lookup"><span data-stu-id="df9d2-104">The Peer Infrastructure uses events to notify applications of changes that have occurred within a peer network, for example, a node that is added or removed from a graph.</span></span> <span data-ttu-id="df9d2-105">Las infraestructuras de gráficos del mismo nivel y de agrupación del mismo nivel usan la infraestructura de eventos del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="df9d2-105">The Peer Graphing and Peer Grouping Infrastructures use the peer events infrastructure.</span></span>

## <a name="receiving-peer-event-notification"></a><span data-ttu-id="df9d2-106">Recepción de la notificación de eventos del mismo nivel</span><span class="sxs-lookup"><span data-stu-id="df9d2-106">Receiving Peer Event Notification</span></span>

<span data-ttu-id="df9d2-107">Un elemento del mismo nivel puede registrarse para recibir notificaciones cuando cambia un atributo de un gráfico o un grupo, o cuando se produce un evento del mismo nivel específico.</span><span class="sxs-lookup"><span data-stu-id="df9d2-107">A peer can register to receive notification when an attribute of a graph or group changes, or a specific peer event occurs.</span></span> <span data-ttu-id="df9d2-108">Una aplicación del mismo nivel llama a la función [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent) o [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent) y pasa un identificador de evento a la infraestructura del mismo nivel, que se crea antes mediante una llamada a [**CreateEvent**](graphing-reference-links.md).</span><span class="sxs-lookup"><span data-stu-id="df9d2-108">A peer application calls the [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent) or [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent) function, and passes an event handle to the Peer Infrastructure, which is created previously by a call to [**CreateEvent**](graphing-reference-links.md).</span></span> <span data-ttu-id="df9d2-109">La infraestructura del mismo nivel usa el identificador para indicar a una aplicación que se ha producido un evento del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="df9d2-109">The Peer Infrastructure uses the handle to signal an application that a peer event has occurred.</span></span>

<span data-ttu-id="df9d2-110">La aplicación también pasa una serie de estructuras de registro de [**\_ eventos de grafos del mismo \_ \_ nivel**](/windows/desktop/api/P2P/ns-p2p-peer_graph_event_registration) o de [**\_ registro de \_ eventos \_ de grupo del mismo**](/windows/desktop/api/P2P/ns-p2p-peer_group_event_registration) nivel que indican a la infraestructura del mismo nivel los eventos específicos del mismo nivel para los que la aplicación solicita la notificación.</span><span class="sxs-lookup"><span data-stu-id="df9d2-110">The application also passes a series of [**PEER\_GRAPH\_EVENT\_REGISTRATION**](/windows/desktop/api/P2P/ns-p2p-peer_graph_event_registration) or [**PEER\_GROUP\_EVENT\_REGISTRATION**](/windows/desktop/api/P2P/ns-p2p-peer_group_event_registration) structures that indicate to the Peer Infrastructure the specific peer events for which the application is requesting notification.</span></span> <span data-ttu-id="df9d2-111">La aplicación también debe especificar exactamente el número de estructuras que se pasan.</span><span class="sxs-lookup"><span data-stu-id="df9d2-111">The application must also specify exactly how many structures are being passed.</span></span>

## <a name="peer-graphing-events"></a><span data-ttu-id="df9d2-112">Eventos de gráficos del mismo nivel</span><span class="sxs-lookup"><span data-stu-id="df9d2-112">Peer Graphing Events</span></span>

<span data-ttu-id="df9d2-113">Una aplicación de gráficos del mismo nivel puede registrarse para recibir notificaciones de 9 eventos de grafos del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="df9d2-113">A Peer Graphing application can register to receive notification for 9 peer graph events.</span></span> <span data-ttu-id="df9d2-114">Cada nombre de evento está precedido por **un \_ \_ \_ evento de grafo del mismo nivel**, por ejemplo, el **Estado del grafo del mismo nivel \_ \_ \_ ha cambiado**.</span><span class="sxs-lookup"><span data-stu-id="df9d2-114">Each event name is prefaced with **PEER\_GRAPH\_EVENT\_**, for example, **PEER\_GRAPH\_STATUS\_CHANGED**.</span></span> <span data-ttu-id="df9d2-115">A menos que se indique lo contrario, la información sobre un cambio se recupera mediante [**PeerGraphGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergraphgeteventdata).</span><span class="sxs-lookup"><span data-stu-id="df9d2-115">Unless otherwise noted, information about a change is retrieved by using [**PeerGraphGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergraphgeteventdata).</span></span>

-   <span data-ttu-id="df9d2-116">**Del mismo nivel \_ El \_ Estado del evento de gráfico \_ \_ cambiado** indica que se ha cambiado el estado de un gráfico; por ejemplo, un nodo se ha sincronizado con un grafo.</span><span class="sxs-lookup"><span data-stu-id="df9d2-116">**PEER\_GRAPH\_EVENT\_STATUS\_CHANGED** indicates that the status of a graph is changed, for example, a node has synchronized with a graph.</span></span>
-   <span data-ttu-id="df9d2-117">**Del mismo nivel \_ \_ \_ \_ Cambiar propiedad de evento de gráfico** indica que se ha cambiado una propiedad de un gráfico o un grupo; por ejemplo, el nombre descriptivo de un gráfico ha cambiado.</span><span class="sxs-lookup"><span data-stu-id="df9d2-117">**PEER\_GRAPH\_EVENT\_PROPERTY\_CHANGED** indicates that a property of a graph or group is changed, for example, the friendly name of a graph has changed.</span></span>
    > [!Note]  
    > <span data-ttu-id="df9d2-118">La aplicación debe llamar a [**PeerGraphGetProperties**](/windows/desktop/api/P2P/nf-p2p-peergraphgetproperties) para obtener la información modificada.</span><span class="sxs-lookup"><span data-stu-id="df9d2-118">The application must call [**PeerGraphGetProperties**](/windows/desktop/api/P2P/nf-p2p-peergraphgetproperties) to obtain the changed information.</span></span>

     

-   <span data-ttu-id="df9d2-119">**Del mismo nivel \_ El \_ registro de eventos de gráfico \_ \_ cambiado** indica que se ha cambiado un registro, por ejemplo, se elimina un registro.</span><span class="sxs-lookup"><span data-stu-id="df9d2-119">**PEER\_GRAPH\_EVENT\_RECORD\_CHANGED** indicates that a record is changed, for example, a record is deleted.</span></span>
-   <span data-ttu-id="df9d2-120">**Del mismo nivel \_ La \_ \_ \_ conexión directa de eventos de gráfico** indica que se ha cambiado una conexión directa; por ejemplo, un nodo se ha conectado.</span><span class="sxs-lookup"><span data-stu-id="df9d2-120">**PEER\_GRAPH\_EVENT\_DIRECT\_CONNECTION** indicates that a direct connection is changed, for example, a node has connected.</span></span>
-   <span data-ttu-id="df9d2-121">**Del mismo nivel \_ La \_ \_ \_ conexión de vecino del evento de gráfico** indica que se ha cambiado una conexión a un nodo vecino; por ejemplo, un nodo se ha conectado.</span><span class="sxs-lookup"><span data-stu-id="df9d2-121">**PEER\_GRAPH\_EVENT\_NEIGHBOR\_CONNECTION** indicates that a connection to a neighbor node is changed, for example, a node has connected.</span></span>
-   <span data-ttu-id="df9d2-122">**Del mismo nivel \_ Los \_ \_ \_ datos entrantes del evento de gráfico** indican que los datos se han recibido de una conexión directa o de vecino.</span><span class="sxs-lookup"><span data-stu-id="df9d2-122">**PEER\_GRAPH\_EVENT\_INCOMING\_DATA** indicates that data has been received from a direct or neighbor connection.</span></span>
-   <span data-ttu-id="df9d2-123">**Del mismo nivel \_ La \_ conexión de eventos de gráfico \_ \_ requerida** indica que la infraestructura de gráficos requiere una nueva conexión.</span><span class="sxs-lookup"><span data-stu-id="df9d2-123">**PEER\_GRAPH\_EVENT\_CONNECTION\_REQUIRED** indicates that the Graphing Infrastructure requires a new connection.</span></span>
    > [!Note]  
    > <span data-ttu-id="df9d2-124">Una llamada a [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect) se conecta a un nuevo nodo.</span><span class="sxs-lookup"><span data-stu-id="df9d2-124">A call to [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect) connects to a new node.</span></span> <span data-ttu-id="df9d2-125">Una llamada a [**PeerGraphGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergraphgeteventdata) no devuelve datos.</span><span class="sxs-lookup"><span data-stu-id="df9d2-125">A call to [**PeerGraphGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergraphgeteventdata) does not return data.</span></span>

     

-   <span data-ttu-id="df9d2-126">**Del mismo nivel \_ El \_ nodo de eventos de gráfico \_ \_ cambiado** indica que se ha cambiado la información de presencia del nodo, por ejemplo, una dirección IP ha cambiado.</span><span class="sxs-lookup"><span data-stu-id="df9d2-126">**PEER\_GRAPH\_EVENT\_NODE\_CHANGED** indicates that node presence information is changed, for example, an IP address has changed.</span></span>
-   <span data-ttu-id="df9d2-127">**Del mismo nivel \_ El \_ evento de gráfico \_ sincronizado** indica que un tipo de registro específico está sincronizado.</span><span class="sxs-lookup"><span data-stu-id="df9d2-127">**PEER\_GRAPH\_EVENT\_SYNCHRONIZED** indicates that a specific record type is synchronized.</span></span>

<span data-ttu-id="df9d2-128">Una vez que una aplicación recibe la notificación de que se ha producido un evento del mismo nivel, la aplicación llama a [**PeerGraphGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergraphgeteventdata)y pasa el identificador de evento del mismo nivel devuelto por [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent).</span><span class="sxs-lookup"><span data-stu-id="df9d2-128">After an application receives notification that a peer event has occurred, the application calls [**PeerGraphGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergraphgeteventdata), and passes the peer event handle returned by [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent).</span></span> <span data-ttu-id="df9d2-129">La infraestructura del mismo nivel devuelve un puntero a una estructura de [**\_ datos de \_ evento \_ de grafo del mismo nivel**](/windows/desktop/api/P2P/ns-p2p-peer_graph_event_data) que contiene los datos solicitados.</span><span class="sxs-lookup"><span data-stu-id="df9d2-129">The Peer Infrastructure returns a pointer to a [**PEER\_GRAPH\_EVENT\_DATA**](/windows/desktop/api/P2P/ns-p2p-peer_graph_event_data) structure that contains the requested data.</span></span> <span data-ttu-id="df9d2-130">Se debe llamar a esta función hasta que no se devuelvan **\_ \_ \_ \_ datos del evento** .</span><span class="sxs-lookup"><span data-stu-id="df9d2-130">This function should be called until **PEER\_S\_NO\_EVENT\_DATA** is returned.</span></span>

<span data-ttu-id="df9d2-131">Después de que una aplicación no requiera una notificación de eventos del mismo nivel, la aplicación llama a [**PeerGraphUnregisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphunregisterevent)y pasa el identificador de evento del mismo nivel devuelto por [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent) cuando se registra la aplicación.</span><span class="sxs-lookup"><span data-stu-id="df9d2-131">After an application does not require a peer event notification, the application calls either [**PeerGraphUnregisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphunregisterevent), and passes the peer event handle returned by [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent) when the application registered.</span></span>

## <a name="handling-graph-connection-referrals"></a><span data-ttu-id="df9d2-132">Control de referencias de conexión de grafos</span><span class="sxs-lookup"><span data-stu-id="df9d2-132">Handling Graph Connection Referrals</span></span>

<span data-ttu-id="df9d2-133">Cuando se llama a [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect) , se notifica al elemento del mismo nivel de conexión que se ha realizado correctamente o se ha producido un error a través del evento de **conexión de \_ \_ \_ vecino \_ del evento del elemento del mismo nivel** asincrónico</span><span class="sxs-lookup"><span data-stu-id="df9d2-133">When [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect) is called, the connecting peer is notified of success or failure through the asynchronous **PEER\_GRAPH\_EVENT\_NEIGHBOR\_CONNECTION** event.</span></span> <span data-ttu-id="df9d2-134">Si se produjo un error en la conexión debido a un problema de red específico (por ejemplo, un firewall mal configurado), se genera el evento de **conexión de vecino del evento del grafo del mismo nivel \_ \_ \_ \_** , con el estado de conexión establecido en **\_ conexión \_ del mismo nivel**.</span><span class="sxs-lookup"><span data-stu-id="df9d2-134">If the connection failed due to a specific networking issues (such as a misconfigured firewall), the **PEER\_GRAPH\_EVENT\_NEIGHBOR\_CONNECTION** event is raised, with the connection status set to **PEER\_CONNECTION\_FAILED**.</span></span>

<span data-ttu-id="df9d2-135">Sin embargo, cuando un elemento del mismo nivel recibe una referencia cuando intenta conectarse a un nodo ocupado, **la \_ \_ conexión del \_ vecino \_ del evento del grafo del mismo nivel** se genera en el elemento del mismo nivel que se conecta, con el estado de conexión establecido en **conexión del mismo nivel \_ \_**.</span><span class="sxs-lookup"><span data-stu-id="df9d2-135">However, when a peer receives a referral when it attempts to connect to a busy node, the **PEER\_GRAPH\_EVENT\_NEIGHBOR\_CONNECTION** is raised on the connecting peer, with the connection status set to **PEER\_CONNECTION\_FAILED**.</span></span> <span data-ttu-id="df9d2-136">Se puede hacer referencia al elemento de conexión del mismo nivel a otro nodo que se encuentra ocupado y puede enviar una referencia, y el mismo evento y estado se generan en el elemento del mismo nivel de conexión.</span><span class="sxs-lookup"><span data-stu-id="df9d2-136">The connecting peer may be referred to another node which itself is busy and may send a referral, and the same event and status are raised on the connecting peer.</span></span> <span data-ttu-id="df9d2-137">Esta cadena de referencias que provocan **\_ \_ errores de conexión del mismo nivel** puede continuar hasta que se agote el número máximo de intentos de conexión.</span><span class="sxs-lookup"><span data-stu-id="df9d2-137">This chain of referrals that result in **PEER\_CONNECTION\_FAILED** event statuses can continue until the maximum number of connection attempts has been exhausted.</span></span> <span data-ttu-id="df9d2-138">El elemento del mismo nivel no tiene un mecanismo para determinar la diferencia entre un intento de conexión completa y la referencia de la conexión.</span><span class="sxs-lookup"><span data-stu-id="df9d2-138">The peer does not have a mechanism to determine the difference between a full connection attempt and the connection referral.</span></span>

<span data-ttu-id="df9d2-139">Para solucionar este problema, los desarrolladores deben considerar el uso de los eventos de cambio de estado del grafo del mismo nivel para determinar si el intento de conexión correcta.</span><span class="sxs-lookup"><span data-stu-id="df9d2-139">To address this issue, developers should consider using the peer graph status change events to determine if the connection attempt suceeded.</span></span> <span data-ttu-id="df9d2-140">Si el evento no se recibe en un período de tiempo determinado, la aplicación puede suponer que se está haciendo referencia al mismo nivel de conexión y que la aplicación del mismo nivel debe considerar el intento de conexión.</span><span class="sxs-lookup"><span data-stu-id="df9d2-140">If the event is not received within a specific amount of time, the application can assume that the connecting peer is being referred and that the peer application should consider the connection attempt a failure.</span></span>

## <a name="peer-grouping-events"></a><span data-ttu-id="df9d2-141">Eventos de agrupación del mismo nivel</span><span class="sxs-lookup"><span data-stu-id="df9d2-141">Peer Grouping Events</span></span>

<span data-ttu-id="df9d2-142">Una aplicación de agrupación del mismo nivel puede registrarse para recibir notificaciones de 8 eventos del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="df9d2-142">A Peer Grouping application can register to receive notification for 8 peer events.</span></span> <span data-ttu-id="df9d2-143">Cada nombre de evento está precedido por **un \_ \_ \_ evento de grupo del mismo nivel**; por ejemplo, el **Estado del evento de grupo del mismo nivel \_ \_ \_ \_ ha cambiado**.</span><span class="sxs-lookup"><span data-stu-id="df9d2-143">Each event name is prefaced with **PEER\_GROUP\_EVENT\_**; for example, **PEER\_GROUP\_EVENT\_STATUS\_CHANGED**.</span></span> <span data-ttu-id="df9d2-144">A menos que se indique lo contrario, la información sobre un cambio se recupera mediante [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata).</span><span class="sxs-lookup"><span data-stu-id="df9d2-144">Unless otherwise noted, information about a change is retrieved by using [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata).</span></span>

-   <span data-ttu-id="df9d2-145">**Del mismo nivel \_ El \_ Estado del evento de grupo \_ \_ cambiado** indica que el estado del grupo ha cambiado.</span><span class="sxs-lookup"><span data-stu-id="df9d2-145">**PEER\_GROUP\_EVENT\_STATUS\_CHANGED** indicates that the group status has changed.</span></span> <span data-ttu-id="df9d2-146">Hay dos valores de estado posibles: **\_ escuchando el \_ estado \_ del grupo del mismo nivel**, lo que indica que el grupo no tiene ninguna conexión y está esperando nuevos miembros, y el estado del **Grupo del mismo nivel \_ \_ \_ tiene conexiones**, lo que indica que el grupo tiene al menos una conexión.</span><span class="sxs-lookup"><span data-stu-id="df9d2-146">There are two status values possible: **PEER\_GROUP\_STATUS\_LISTENING**, which indicates that the group has no connections and is waiting for new members; and **PEER\_GROUP\_STATUS\_HAS CONNECTIONS**, which indicates that the group has at least one connection.</span></span> <span data-ttu-id="df9d2-147">Este valor de estado se puede obtener llamando a [**PeerGroupGetStatus**](/windows/desktop/api/P2P/nf-p2p-peergroupgetstatus) después de que se genere este evento.</span><span class="sxs-lookup"><span data-stu-id="df9d2-147">This status value can be obtained by calling [**PeerGroupGetStatus**](/windows/desktop/api/P2P/nf-p2p-peergroupgetstatus) after this event is raised.</span></span>
-   <span data-ttu-id="df9d2-148">**Del mismo nivel \_ Propiedad de evento de grupo \_ \_ \_ cambiada** indica que el creador del grupo ha cambiado o actualizado las propiedades del grupo.</span><span class="sxs-lookup"><span data-stu-id="df9d2-148">**PEER\_GROUP\_EVENT\_PROPERTY\_CHANGED** indicates that the group properties have been changed or updated by the group creator.</span></span>
-   <span data-ttu-id="df9d2-149">**Del mismo nivel \_ El \_ registro de eventos de grupo \_ \_ cambiado** indica que se ha realizado una operación de registro.</span><span class="sxs-lookup"><span data-stu-id="df9d2-149">**PEER\_GROUP\_EVENT\_RECORD\_CHANGED** indicates that a record operation has been performed.</span></span> <span data-ttu-id="df9d2-150">Este evento se desencadena cuando un elemento del mismo nivel que participa en el grupo publica, actualiza o elimina un registro.</span><span class="sxs-lookup"><span data-stu-id="df9d2-150">This event is raised when a peer participating in the group publishes, updates, or deletes a record.</span></span> <span data-ttu-id="df9d2-151">Por ejemplo, este evento se genera cuando una aplicación de chat envía un mensaje de chat.</span><span class="sxs-lookup"><span data-stu-id="df9d2-151">For example, this event is raised when a chat application sends a chat message.</span></span>
-   <span data-ttu-id="df9d2-152">**Del mismo nivel \_ Miembro de evento de grupo \_ \_ \_ cambiado** indica que ha cambiado el estado de un miembro dentro del grupo.</span><span class="sxs-lookup"><span data-stu-id="df9d2-152">**PEER\_GROUP\_EVENT\_MEMBER\_CHANGED** indicates that a member's status within the group has changed.</span></span> <span data-ttu-id="df9d2-153">Los cambios de estado incluyen:</span><span class="sxs-lookup"><span data-stu-id="df9d2-153">Status changes include:</span></span>
    -   <span data-ttu-id="df9d2-154">**Del mismo nivel \_ MIEMBRO \_ conectado**.</span><span class="sxs-lookup"><span data-stu-id="df9d2-154">**PEER\_MEMBER\_CONNECTED**.</span></span> <span data-ttu-id="df9d2-155">Un elemento del mismo nivel se ha conectado al grupo.</span><span class="sxs-lookup"><span data-stu-id="df9d2-155">A peer has connected to the group.</span></span>
    -   <span data-ttu-id="df9d2-156">**Del mismo nivel \_ MIEMBRO \_ desconectado**.</span><span class="sxs-lookup"><span data-stu-id="df9d2-156">**PEER\_MEMBER\_DISCONNECTED**.</span></span> <span data-ttu-id="df9d2-157">Un elemento del mismo nivel se ha desconectado del grupo.</span><span class="sxs-lookup"><span data-stu-id="df9d2-157">A peer has disconnected from the group.</span></span>
    -   <span data-ttu-id="df9d2-158">**Del mismo nivel \_ MIEMBRO \_ Unido**.</span><span class="sxs-lookup"><span data-stu-id="df9d2-158">**PEER\_MEMBER\_JOINED**.</span></span> <span data-ttu-id="df9d2-159">Se ha publicado una nueva información de pertenencia para un elemento del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="df9d2-159">New membership information has been published for a peer.</span></span>
    -   <span data-ttu-id="df9d2-160">**Del mismo nivel \_ MIEMBRO \_ actualizado**.</span><span class="sxs-lookup"><span data-stu-id="df9d2-160">**PEER\_MEMBER\_UPDATED**.</span></span> <span data-ttu-id="df9d2-161">Un elemento del mismo nivel se ha actualizado con información nueva, como una nueva dirección IP.</span><span class="sxs-lookup"><span data-stu-id="df9d2-161">A peer has updated with new information, such as a new IP address.</span></span>
-   <span data-ttu-id="df9d2-162">**Del mismo nivel \_ \_conexión de \_ vecino \_ del evento de grupo**.</span><span class="sxs-lookup"><span data-stu-id="df9d2-162">**PEER\_GROUP\_EVENT\_NEIGHBOR\_CONNECTION**.</span></span> <span data-ttu-id="df9d2-163">Los pares que participarán en las conexiones de vecinos dentro del grupo deben registrarse para este evento.</span><span class="sxs-lookup"><span data-stu-id="df9d2-163">Peers who will participate in neighbor connections within the group must register for this event.</span></span> <span data-ttu-id="df9d2-164">Tenga en cuenta que el registro para este evento no permite que el elemento del mismo nivel reciba datos; el registro de este evento solo garantiza la notificación cuando se recibe una solicitud de conexión de vecino.</span><span class="sxs-lookup"><span data-stu-id="df9d2-164">Note that registering for this event does not enable the peer to receive data; registration for this event only ensures notification when a request for a neighbor connection is received.</span></span>
-   <span data-ttu-id="df9d2-165">**Del mismo nivel \_ \_ \_ \_ conexión directa de eventos de grupo**.</span><span class="sxs-lookup"><span data-stu-id="df9d2-165">**PEER\_GROUP\_EVENT\_DIRECT\_CONNECTION**.</span></span> <span data-ttu-id="df9d2-166">Los pares que participarán en las conexiones directas dentro del grupo deben registrarse para este evento.</span><span class="sxs-lookup"><span data-stu-id="df9d2-166">Peers who will participate in direct connections within the group must register for this event.</span></span> <span data-ttu-id="df9d2-167">Tenga en cuenta que el registro para este evento no permite que el elemento del mismo nivel reciba datos; el registro de este evento solo garantiza la notificación cuando se recibe una solicitud de conexión directa.</span><span class="sxs-lookup"><span data-stu-id="df9d2-167">Note that registering for this event does not enable the peer to receive data; registration for this event only ensures notification when a request for a direct connection is received.</span></span>
-   <span data-ttu-id="df9d2-168">**Del mismo nivel \_ \_datos de \_ entrada \_ de eventos de grupo**.</span><span class="sxs-lookup"><span data-stu-id="df9d2-168">**PEER\_GROUP\_EVENT\_INCOMING\_DATA**.</span></span> <span data-ttu-id="df9d2-169">Los equipos del mismo nivel que recibirán datos a través de un vecino o conexión directa deben registrarse para este evento.</span><span class="sxs-lookup"><span data-stu-id="df9d2-169">Peers who will receive data over a neighbor or direct connection must register for this event.</span></span> <span data-ttu-id="df9d2-170">Cuando se genera este evento, los datos opacos transmitidos por el otro elemento del mismo nivel de participación se pueden obtener llamando a [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata).</span><span class="sxs-lookup"><span data-stu-id="df9d2-170">When this event is raised, the opaque data transmitted by the other participating peer can be obtained by calling [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata).</span></span> <span data-ttu-id="df9d2-171">Tenga en cuenta que para recibir este evento, el elemento del mismo nivel debe haberse registrado previamente para la conexión **directa de eventos de grupo del mismo \_ \_ \_ \_ nivel** o la **conexión de vecino del evento de \_ Grupo del \_ \_ \_ mismo** nivel.</span><span class="sxs-lookup"><span data-stu-id="df9d2-171">Note that to receive this event, the peer must have previously registered for **PEER\_GROUP\_EVENT\_DIRECT\_CONNECTION** or **PEER\_GROUP\_EVENT\_NEIGHBOR\_CONNECTION**.</span></span>
-   <span data-ttu-id="df9d2-172">**Del mismo nivel \_ \_error de \_ conexión \_ de eventos de grupo**.</span><span class="sxs-lookup"><span data-stu-id="df9d2-172">**PEER\_GROUP\_EVENT\_CONNECTION\_FAILED**.</span></span> <span data-ttu-id="df9d2-173">Se produjo un error en la conexión por algún motivo.</span><span class="sxs-lookup"><span data-stu-id="df9d2-173">A connection failed for some reason.</span></span> <span data-ttu-id="df9d2-174">No se proporcionan datos cuando se genera este evento y no se debe llamar a [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata) .</span><span class="sxs-lookup"><span data-stu-id="df9d2-174">No data is provided when this event is raised, and [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata) should not be called.</span></span>

<span data-ttu-id="df9d2-175">Una vez que una aplicación recibe la notificación de que se ha producido un evento del mismo nivel (con excepción del **error de conexión de eventos de grupo del mismo nivel \_ \_ \_ \_**), la aplicación llama a [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata)y pasa el identificador de evento del mismo nivel devuelto por [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent).</span><span class="sxs-lookup"><span data-stu-id="df9d2-175">After an application receives notification that a peer event has occurred (excluding **PEER\_GROUP\_EVENT\_CONNECTION\_FAILED**), the application calls [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata), and passes the peer event handle returned by [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent).</span></span> <span data-ttu-id="df9d2-176">La infraestructura del mismo nivel devuelve un puntero a una estructura de [**\_ datos de \_ eventos \_ de grupo del mismo nivel**](/windows/win32/api/p2p/ns-p2p-peer_group_event_data-r1) que contiene los datos solicitados.</span><span class="sxs-lookup"><span data-stu-id="df9d2-176">The Peer Infrastructure returns a pointer to a [**PEER\_GROUP\_EVENT\_DATA**](/windows/win32/api/p2p/ns-p2p-peer_group_event_data-r1) structure that contains the requested data.</span></span> <span data-ttu-id="df9d2-177">Se debe llamar a esta función hasta que no se devuelvan **\_ \_ \_ \_ datos del evento** .</span><span class="sxs-lookup"><span data-stu-id="df9d2-177">This function must be called until **PEER\_S\_NO\_EVENT\_DATA** is returned.</span></span> <span data-ttu-id="df9d2-178">Cuando una aplicación ya no requiere notificación para un evento del mismo nivel, se debe realizar una llamada a [**PeerGroupUnregisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupunregisterevent), pasando el identificador de evento del mismo nivel devuelto por **PeerGroupRegisterEvent** cuando la aplicación se registra para el evento determinado.</span><span class="sxs-lookup"><span data-stu-id="df9d2-178">When an application no longer requires notification for a peer event, a call must be made to [**PeerGroupUnregisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupunregisterevent), passing the peer event handle returned by **PeerGroupRegisterEvent** when the application registered for the particular event.</span></span>

## <a name="example-of-registering-for-peer-graphing-events"></a><span data-ttu-id="df9d2-179">Ejemplo de registro de eventos de gráficos del mismo nivel</span><span class="sxs-lookup"><span data-stu-id="df9d2-179">Example of Registering for Peer Graphing Events</span></span>

<span data-ttu-id="df9d2-180">En el ejemplo de código siguiente se muestra cómo registrar con los eventos de gráficos del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="df9d2-180">The following code sample shows you how to register with the Peer Graphing events.</span></span>


```C++
//-----------------------------------------------------------------------------
// Function: RegisterForEvents
//
// Purpose:  Registers the EventCallback function so it can be called for only
//           the events that are specified.
//
// Returns:  HRESULT
//
HRESULT RegisterForEvents()
{
    HPEEREVENT  g_hPeerEvent = NULL;        // The one PeerEvent handle
    HANDLE      g_hEvent = NULL;            // Handle signaled by Graphing when we have an event
    HRESULT hr = S_OK;
    PEER_GRAPH_EVENT_REGISTRATION regs[] = {
        { PEER_GRAPH_EVENT_RECORD_CHANGED, 0 },
        { PEER_GRAPH_EVENT_NODE_CHANGED,   0 },
        { PEER_GRAPH_EVENT_STATUS_CHANGED, 0 },
        { PEER_GRAPH_EVENT_DIRECT_CONNECTION, 0 },
        { PEER_GRAPH_EVENT_INCOMING_DATA, 0 },
    };

    g_hEvent = CreateEvent(NULL, FALSE, FALSE, NULL);
    if (g_hEvent == NULL)
    {
        wprintf(L"CreateEvent call failed.\n");
        hr = E_OUTOFMEMORY;
    }
    else
    {
        hr = PeerGraphRegisterEvent(g_hGraph, g_hEvent, celems(regs), regs,  &g_hPeerEvent);
        if (FAILED(hr))
        {
           wprintf(L"PeerGraphRegisterEvent call failed.\n");
            CloseHandle(g_hEvent);
            g_hEvent = NULL;
        }
    }

    if (SUCCEEDED(hr))
    {
        if (!RegisterWaitForSingleObject(&g_hWait, g_hEvent, EventCallback, NULL, INFINITE, WT_EXECUTEDEFAULT))
        {
            hr = HRESULT_FROM_WIN32(GetLastError());
            wprintf(L"Could not set up event callback.\n");
            CloseHandle(g_hEvent);
            g_hEvent = NULL;
        }
    }

    return hr;
}
```



 

 



