---
title: Nombres principales
description: Para que un cliente cree una sesión autenticada mutuamente con un programa de servidor, debe proporcionar el nombre de la entidad de seguridad esperada del servidor.
ms.assetid: 4d9977f8-0efb-4559-977e-3eba4e277bc0
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 554ffecff6eb019b4712e6b2d9f5c6319db492e7
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/16/2019
ms.locfileid: "104486987"
---
# <a name="principal-names"></a><span data-ttu-id="83bae-103">Nombres principales</span><span class="sxs-lookup"><span data-stu-id="83bae-103">Principal Names</span></span>

<span data-ttu-id="83bae-104">Para que un cliente cree una sesión autenticada mutuamente con un programa de servidor, debe proporcionar el nombre de la entidad de seguridad esperada del servidor.</span><span class="sxs-lookup"><span data-stu-id="83bae-104">For a client to create a mutually authenticated session with a server program, it must provide the server's expected principal name.</span></span> <span data-ttu-id="83bae-105">Algunos protocolos, como Kerberos, requieren un nombre de entidad de seguridad de servidor correcto para cualquier sesión autenticada.</span><span class="sxs-lookup"><span data-stu-id="83bae-105">Some protocols, such as Kerberos, require a correct server principal name for any authenticated session.</span></span> <span data-ttu-id="83bae-106">Una entidad de seguridad es una entidad que el sistema de seguridad reconoce.</span><span class="sxs-lookup"><span data-stu-id="83bae-106">A principal is an entity that the security system recognizes.</span></span> <span data-ttu-id="83bae-107">Esto incluye a los usuarios humanos, así como a los servicios del sistema.</span><span class="sxs-lookup"><span data-stu-id="83bae-107">This includes human users as well as system services.</span></span> <span data-ttu-id="83bae-108">Todos los nombres principales tienen un formato similar para un proveedor de compatibilidad de seguridad (SSP) determinado.</span><span class="sxs-lookup"><span data-stu-id="83bae-108">All principal names take similar format for a given security support provider (SSP).</span></span> <span data-ttu-id="83bae-109">Un SSP es un módulo de software que realiza la validación de seguridad.</span><span class="sxs-lookup"><span data-stu-id="83bae-109">An SSP is a software module that performs security validation.</span></span> <span data-ttu-id="83bae-110">Para obtener más información, vea [información general sobre la arquitectura de SSPI](sspi-architectural-overview.md).</span><span class="sxs-lookup"><span data-stu-id="83bae-110">For more information, see [SSPI Architectural Overview](sspi-architectural-overview.md).</span></span> <span data-ttu-id="83bae-111">Para mantener la uniformidad, un proveedor de seguridad suele proporcionar nombres similares a los servicios del sistema como usuarios.</span><span class="sxs-lookup"><span data-stu-id="83bae-111">To maintain uniformity, a security provider usually gives system services similar names as users.</span></span> <span data-ttu-id="83bae-112">En algunos proveedores de seguridad, es posible que los servicios del sistema no tengan un nombre principal.</span><span class="sxs-lookup"><span data-stu-id="83bae-112">Under some security providers, system services may not have a principal name.</span></span>

<span data-ttu-id="83bae-113">El servidor registra su nombre principal para el proveedor de seguridad mediante la función [**RpcServerRegisterAuthInfo**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterauthinfo) .</span><span class="sxs-lookup"><span data-stu-id="83bae-113">The server registers its principal name for the security provider using the [**RpcServerRegisterAuthInfo**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverregisterauthinfo) function.</span></span> <span data-ttu-id="83bae-114">Solo se puede usar un nombre principal de servidor para cada proveedor de seguridad.</span><span class="sxs-lookup"><span data-stu-id="83bae-114">Only one server principal name can be used for each security provider.</span></span> <span data-ttu-id="83bae-115">Si se registra más de un nombre, se elige y se utiliza un nombre de forma aleatoria.</span><span class="sxs-lookup"><span data-stu-id="83bae-115">If more than one name is registered, one name is randomly chosen and used.</span></span> <span data-ttu-id="83bae-116">El SSP dicta el formato del nombre de la entidad de seguridad.</span><span class="sxs-lookup"><span data-stu-id="83bae-116">The SSP dictates the format of the principal name.</span></span> <span data-ttu-id="83bae-117">Por ejemplo, el SSP de Kerberos/Negotiate para un servicio de sistema de tiene una apariencia similar a la siguiente: nombre del equipo \_ $ @childdomain.parentdomain1.parentdomain2.COM .</span><span class="sxs-lookup"><span data-stu-id="83bae-117">For example, the Kerberos/Negotiate SSPs for a system service look approximately like the following: machine\_name$@childdomain.parentdomain1.parentdomain2.COM.</span></span>

<span data-ttu-id="83bae-118">El procedimiento recomendado para generar nombres principales es usar API documentadas (como la función **DsMakeSpn** ), en lugar de juntar juntas el nombre principal de las cadenas.</span><span class="sxs-lookup"><span data-stu-id="83bae-118">The recommended procedure for generating principal names is to use documented APIs (such as the **DsMakeSpn** function), rather than piecing together the principal name from strings.</span></span> <span data-ttu-id="83bae-119">El uso de API documentadas aumenta la portabilidad entre distintos entornos de implementación y elimina la posibilidad de que se produzcan errores.</span><span class="sxs-lookup"><span data-stu-id="83bae-119">Using documented APIs increases portability between different deployment environments and eliminates the possibility for errors.</span></span>

<span data-ttu-id="83bae-120">Si se especifica un nombre de entidad de seguridad incorrecto, puede impedir que el cliente y el servidor establezcan una sesión autenticada.</span><span class="sxs-lookup"><span data-stu-id="83bae-120">Specifying an incorrect principal name may prevent the client and server from establishing an authenticated session.</span></span> <span data-ttu-id="83bae-121">SCHANNEL SSP toma los nombres principales en cualquiera de las dos formas siguientes:</span><span class="sxs-lookup"><span data-stu-id="83bae-121">The SCHANNEL SSP takes principal names in either of two forms:</span></span>

-   <span data-ttu-id="83bae-122">El primer formulario de nombre principal de SCHANNEL es el formulario [*msstd*](m-glos.md) .</span><span class="sxs-lookup"><span data-stu-id="83bae-122">The first SCHANNEL principal name form is the [*msstd*](m-glos.md) form.</span></span> <span data-ttu-id="83bae-123">Los nombres en forma de msstd suelen seguir el patrón msstd:servername@serverdomain.com .</span><span class="sxs-lookup"><span data-stu-id="83bae-123">Names in msstd form generally follow the pattern msstd:servername@serverdomain.com.</span></span> <span data-ttu-id="83bae-124">Esto se conoce como una propiedad de nombre de correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="83bae-124">This is referred to as an email name property.</span></span> <span data-ttu-id="83bae-125">Si el certificado contiene una propiedad de nombre de correo electrónico y contiene el signo (@), el nombre de la entidad de seguridad es msstd: nombre de correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="83bae-125">If the certificate contains an email name property, and it contains the at sign (@), the principal name is msstd:email name.</span></span> <span data-ttu-id="83bae-126">En caso contrario, debe contener la propiedad common name.</span><span class="sxs-lookup"><span data-stu-id="83bae-126">Otherwise it must contain the common name property.</span></span> <span data-ttu-id="83bae-127">Las barras diagonales inversas internas se duplican, al igual que en los enlaces de cadena.</span><span class="sxs-lookup"><span data-stu-id="83bae-127">Internal backslashes are doubled, just as in string bindings.</span></span>
-   <span data-ttu-id="83bae-128">El segundo formulario de nombre principal de SCHANNEL es el formulario [*fullsic*](f-glos.md) .</span><span class="sxs-lookup"><span data-stu-id="83bae-128">The second SCHANNEL principal name form is the [*fullsic*](f-glos.md) form.</span></span> <span data-ttu-id="83bae-129">Se trata de una serie de nombres compatibles con RFC1779 delimitados por corchetes angulares y separados por barras diagonales inversas.</span><span class="sxs-lookup"><span data-stu-id="83bae-129">This is a series of RFC1779-compliant names bounded by angle brackets and separated by backslashes.</span></span> <span data-ttu-id="83bae-130">Normalmente sigue el patrón fullsic: \\ < \\ entidad de \\ subautor \\ .. \\ .. Person> o fullsic: \\ < \\ entidad de \\ subautor \\ .. \\ ..> ServerProgram.</span><span class="sxs-lookup"><span data-stu-id="83bae-130">It typically follows the pattern fullsic:\\<\\Authority\\SubAuthority\\.....\\Person> or fullsic:\\<\\Authority\\SubAuthority\\.....\\ServerProgram>.</span></span>

<span data-ttu-id="83bae-131">Si el nombre no coincide con el certificado, \_ se devuelve el error acceso \_ denegado.</span><span class="sxs-lookup"><span data-stu-id="83bae-131">If the name does not match the certificate, ERROR\_ACCESS\_DENIED is returned.</span></span> <span data-ttu-id="83bae-132">Si el formato de nombre no es válido, SCHANNEL SSP devuelve el parámetro de ERROR de código \_ no válido \_ .</span><span class="sxs-lookup"><span data-stu-id="83bae-132">If the name format is invalid, SCHANNEL SSP returns the code ERROR\_INVALID\_PARAMETER.</span></span>

<span data-ttu-id="83bae-133">Para consultar el nombre de la entidad de seguridad del servidor, las aplicaciones pueden llamar a [**RpcMgmtInqServerPrincName**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcmgmtinqserverprincname).</span><span class="sxs-lookup"><span data-stu-id="83bae-133">To query for the server's principal name, applications can call [**RpcMgmtInqServerPrincName**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcmgmtinqserverprincname).</span></span> <span data-ttu-id="83bae-134">Esto asigna una cadena terminada en null para contener el nombre de la entidad de seguridad.</span><span class="sxs-lookup"><span data-stu-id="83bae-134">This allocates a null-terminated string to hold the principal name.</span></span> <span data-ttu-id="83bae-135">Antes de que finalice, la aplicación debe invocar [**RpcStringFree**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcstringfree) para liberar la memoria que ocupa esta cadena.</span><span class="sxs-lookup"><span data-stu-id="83bae-135">Before it terminates, your application must invoke [**RpcStringFree**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcstringfree) to release the memory this string occupies.</span></span>

<span data-ttu-id="83bae-136">La consulta del nombre del servidor de esta manera no es segura y debe evitarse.</span><span class="sxs-lookup"><span data-stu-id="83bae-136">Querying for the server name in this manner is not secure and should be avoided.</span></span> <span data-ttu-id="83bae-137">Para la autenticación de servidor, el programa cliente debe saber a qué servidor se está conectando y debe crear el nombre de la entidad de seguridad del servidor desde el principio.</span><span class="sxs-lookup"><span data-stu-id="83bae-137">For server authentication, the client program should know which server it is connecting to and should create the server principal name from scratch.</span></span>

 

 




