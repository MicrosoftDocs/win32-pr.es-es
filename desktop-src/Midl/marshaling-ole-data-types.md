---
title: Serialización de tipos de datos OLE
description: Serialización de tipos de datos OLE y Automation.
ms.assetid: 0cab4208-d40d-40a1-88f2-4933b52c0c29
keywords:
- MIDL y COM MIDL, serialización de tipos de datos OLE
- calcular las referencias de MIDL
- OLE Data MIDL
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5970c6e0fef9d0fc88b8a0a11a087fa4396d7a7c
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/19/2020
ms.locfileid: "103790017"
---
# <a name="marshaling-ole-data-types"></a><span data-ttu-id="8d26e-106">Serialización de tipos de datos OLE</span><span class="sxs-lookup"><span data-stu-id="8d26e-106">Marshaling OLE Data Types</span></span>

<span data-ttu-id="8d26e-107">Para facilitar el uso de determinados tipos de datos OLE y de automatización, así como algunos de los identificadores del sistema que se usan con frecuencia en COM, las definiciones de tipo de estos tipos de datos y sus funciones auxiliares relacionadas están disponibles mediante la importación de archivos IDL de Windows y la vinculación a los archivos DLL de OLE y Automation.</span><span class="sxs-lookup"><span data-stu-id="8d26e-107">To make it easier to use certain Automation and OLE data types, as well as some system handles frequently used in COM, typedefs for these data types and their related helper functions are available by importing Windows IDL files and linking to the OLE and Automation DLL files.</span></span> <span data-ttu-id="8d26e-108">Estos archivos se instalan automáticamente en el sistema.</span><span class="sxs-lookup"><span data-stu-id="8d26e-108">These files are automatically installed on your system.</span></span>

-   <span data-ttu-id="8d26e-109">Para usar el tipo de datos [**BSTR**](/previous-versions/windows/desktop/automat/bstr) en llamadas a procedimientos remotos, importe el archivo Wtypes. idl en el archivo de definición de interfaz (IDL) y vincúlelo a oleaut32. lib al compilar la aplicación distribuida.</span><span class="sxs-lookup"><span data-stu-id="8d26e-109">To use the [**BSTR**](/previous-versions/windows/desktop/automat/bstr) data type in remote procedure calls, import the wtypes.idl file into your interface definition (IDL) file and link to Oleaut32.lib when building your distributed application.</span></span> <span data-ttu-id="8d26e-110">Esto permitirá que el código auxiliar use las funciones auxiliares preparadas **de \_ usuario BSTR**, **BSTR \_ UserMarshal**, **BSTR \_ UserUnmarshal** y **BSTR \_ UserFree**.</span><span class="sxs-lookup"><span data-stu-id="8d26e-110">This will let your stubs use the ready-made helper functions **BSTR\_UserSize**, **BSTR\_UserMarshal**, **BSTR\_UserUnmarshal**, and **BSTR\_UserFree**.</span></span>
-   <span data-ttu-id="8d26e-111">Para usar otros tipos de datos de automatización, como [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) y [**SAFEARRAY**](/windows/win32/api/oaidl/ns-oaidl-safearray), o tipos que usan esos tipos (por ejemplo, [**DISPPARAMS**](/windows/win32/api/oaidl/ns-oaidl-dispparams) y [**EXCEPINFO**](/windows/win32/api/oaidl/ns-oaidl-excepinfo)), importe el archivo objidl. idl en el archivo IDL y vincule a oleaut32. lib en tiempo de compilación.</span><span class="sxs-lookup"><span data-stu-id="8d26e-111">To use other Automation data types, such as [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) and [**SAFEARRAY**](/windows/win32/api/oaidl/ns-oaidl-safearray), or types that use those types (for example, [**DISPPARAMS**](/windows/win32/api/oaidl/ns-oaidl-dispparams) and [**EXCEPINFO**](/windows/win32/api/oaidl/ns-oaidl-excepinfo)), import the objidl.idl file into your IDL file and link to the oleaut32.lib at build time.</span></span> <span data-ttu-id="8d26e-112">Esto le permitirá usar las rutinas auxiliares adecuadas.</span><span class="sxs-lookup"><span data-stu-id="8d26e-112">This will allow you to use the appropriate helper routines.</span></span>
-   <span data-ttu-id="8d26e-113">Para usar tipos de datos OLE (como CLIPFORMAT, SNB, STGMEDIUM, ASYNC \_ STGMEDIUM) o identificadores del sistema (como HMETAFILE \_ PICT, HENHMETAFILE, HMETAFILE, hBitmap, HPALETTE y hglobal), importe el archivo objidl. idl en el archivo de definición de la interfaz y vincúlelo a ole32. lib en tiempo de compilación.</span><span class="sxs-lookup"><span data-stu-id="8d26e-113">To use OLE data types (such as CLIPFORMAT, SNB, STGMEDIUM, ASYNC\_STGMEDIUM), or system handles (such as HMETAFILE\_PICT, HENHMETAFILE, HMETAFILE, HBITMAP, HPALETTE, and HGLOBAL), import the objidl.idl file into your interface definition file and link to the ole32.lib at build time.</span></span>
-   <span data-ttu-id="8d26e-114">Los siguientes identificadores OLE también se definen con el atributo de **\[ \_ serialización \] de conexión** , pero solo como identificadores dentro de un equipo, ya que no se pueden usar en llamadas a procedimientos remotos a otros equipos en este momento: HWND, HMENU, HACCEL, HDC, HFONT, HICON, hbrush.</span><span class="sxs-lookup"><span data-stu-id="8d26e-114">The following OLE handles are also defined with the **\[wire\_marshal\]** attribute, but only as handles within a computer since they cannot be used in remote procedure calls to other computers at this time: HWND, HMENU, HACCEL, HDC, HFONT, HICON, HBRUSH.</span></span> <span data-ttu-id="8d26e-115">Importe el archivo objidl. idl en el archivo IDL y vincúlelo a ole32. lib en el momento de la compilación para utilizar estos identificadores en la comunicación entre procesos en un solo equipo.</span><span class="sxs-lookup"><span data-stu-id="8d26e-115">Import the objidl.idl file into your IDL file and link to ole32.lib at build time to use these handles in interprocess communication on a single computer.</span></span>

<span data-ttu-id="8d26e-116">Para obtener más información, vea [el \_ atributo de serialización](/windows/desktop/Rpc/the-wire-marshal-attribute)de la conexión, [la función de tipo de \_ usuario](/windows/desktop/Rpc/the-type-usersize-function), la función type [ \_ UserMarshal](/windows/desktop/Rpc/the-type-usermarshal-function), la función type [ \_ UserUnmarshal](/windows/desktop/Rpc/the-type-userunmarshal-function), [la \_ función type UserFree y el](/windows/desktop/Rpc/the-type-userfree-function) [código auxiliar de destino para plataformas específicas de 32 bits o 64](targeting-stubs-for-specific-32-bit-or-64-bit-platforms.md)bits.</span><span class="sxs-lookup"><span data-stu-id="8d26e-116">For more information, see [The wire\_marshal Attribute](/windows/desktop/Rpc/the-wire-marshal-attribute), [The type\_UserSize Function](/windows/desktop/Rpc/the-type-usersize-function), [The type\_UserMarshal Function](/windows/desktop/Rpc/the-type-usermarshal-function), [The type\_UserUnmarshal Function](/windows/desktop/Rpc/the-type-userunmarshal-function), [The type\_UserFree Function](/windows/desktop/Rpc/the-type-userfree-function), and [Targeting Stubs for Specific 32-bit or 64-bit Platforms](targeting-stubs-for-specific-32-bit-or-64-bit-platforms.md).</span></span>

 

 