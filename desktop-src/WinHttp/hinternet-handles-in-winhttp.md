---
description: Los servicios HTTP de Microsoft Windows (WinHTTP) usan identificadores para realizar un seguimiento de la configuración y la información necesaria cuando se usa el protocolo HTTP.
ms.assetid: 0bd82860-1347-40c8-ae77-c4d865c109be
title: Controladores HINTERNET en WinHTTP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bf374675ad6f2114dd48e0a3ff1db50cd0dd7f9c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "104563559"
---
# <a name="hinternet-handles-in-winhttp"></a><span data-ttu-id="b4c86-103">Controladores HINTERNET en WinHTTP</span><span class="sxs-lookup"><span data-stu-id="b4c86-103">HINTERNET Handles in WinHTTP</span></span>

<span data-ttu-id="b4c86-104">Los servicios HTTP de Microsoft Windows (WinHTTP) usan identificadores para realizar un seguimiento de la configuración y la información necesaria cuando se usa el protocolo HTTP.</span><span class="sxs-lookup"><span data-stu-id="b4c86-104">Microsoft Windows HTTP Services (WinHTTP) uses handles to keep track of settings and information required when using the HTTP protocol.</span></span> <span data-ttu-id="b4c86-105">Cada identificador mantiene la información pertinente a una sesión HTTP, una conexión con un servidor HTTP o un recurso específico.</span><span class="sxs-lookup"><span data-stu-id="b4c86-105">Each handle maintains information pertinent to an HTTP session, a connection with an HTTP server, or a specific resource.</span></span> <span data-ttu-id="b4c86-106">En este tema se describen los distintos tipos de identificadores, las convenciones de nomenclatura de estos identificadores y su estructura jerárquica.</span><span class="sxs-lookup"><span data-stu-id="b4c86-106">This topic describes the various types of handles, the naming conventions for these handles, and their hierarchical structure.</span></span>

-   [<span data-ttu-id="b4c86-107">Acerca de los identificadores de HINTERNET</span><span class="sxs-lookup"><span data-stu-id="b4c86-107">About HINTERNET Handles</span></span>](#about-hinternet-handles)
-   [<span data-ttu-id="b4c86-108">Controladores de nomenclatura</span><span class="sxs-lookup"><span data-stu-id="b4c86-108">Naming Handles</span></span>](#naming-handles)
-   [<span data-ttu-id="b4c86-109">Jerarquía de identificadores</span><span class="sxs-lookup"><span data-stu-id="b4c86-109">Handle Hierarchy</span></span>](#handle-hierarchy)
-   [<span data-ttu-id="b4c86-110">Explicación de la jerarquía de identificadores</span><span class="sxs-lookup"><span data-stu-id="b4c86-110">Explanation of the Handle Hierarchy</span></span>](#explanation-of-the-handle-hierarchy)

## <a name="about-hinternet-handles"></a><span data-ttu-id="b4c86-111">Acerca de los identificadores de HINTERNET</span><span class="sxs-lookup"><span data-stu-id="b4c86-111">About HINTERNET Handles</span></span>

<span data-ttu-id="b4c86-112">Los identificadores que se crean y usan en WinHTTP se denominan identificadores de **HINTERNET** .</span><span class="sxs-lookup"><span data-stu-id="b4c86-112">The handles that are created and used by WinHTTP are called **HINTERNET** handles.</span></span> <span data-ttu-id="b4c86-113">Las funciones WinHTTP devuelven identificadores **HINTERNET** que no son intercambiables con otros identificadores, por lo que no se pueden usar con funciones como [**readfile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) o [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle).</span><span class="sxs-lookup"><span data-stu-id="b4c86-113">The WinHTTP functions return **HINTERNET** handles that are not interchangeable with other handles, so they cannot be used with functions such as [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) or [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle).</span></span> <span data-ttu-id="b4c86-114">Del mismo modo, no se pueden usar otros identificadores con funciones WinHTTP.</span><span class="sxs-lookup"><span data-stu-id="b4c86-114">Similarly, other handles cannot be used with WinHTTP functions.</span></span> <span data-ttu-id="b4c86-115">Por ejemplo, un identificador devuelto por [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) no se puede pasar a [**WinHttpReadData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpreaddata).</span><span class="sxs-lookup"><span data-stu-id="b4c86-115">For example, a handle returned by [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) cannot be passed to [**WinHttpReadData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpreaddata).</span></span> <span data-ttu-id="b4c86-116">Estos identificadores de **HINTERNET** no se pueden cerrar mientras haya una llamada API que use el identificador en curso.</span><span class="sxs-lookup"><span data-stu-id="b4c86-116">These **HINTERNET** handles cannot be closed while an API call using the handle is in progress.</span></span> <span data-ttu-id="b4c86-117">Para evitar una condición de carrera, las aplicaciones deben proteger el identificador e impedir que se cierre mientras la llamada a la API esté en curso.</span><span class="sxs-lookup"><span data-stu-id="b4c86-117">To avoid a race condition, applications should protect the handle and prevent it from being closed for as long as the API call is in progress.</span></span>

<span data-ttu-id="b4c86-118">Las funciones de Microsoft Win32 Internet (WinInet) también usan identificadores de **HINTERNET** .</span><span class="sxs-lookup"><span data-stu-id="b4c86-118">Microsoft Win32 Internet (WinInet) functions also use **HINTERNET** handles.</span></span> <span data-ttu-id="b4c86-119">Sin embargo, los identificadores que se usan en las funciones WinInet no se pueden intercambiar con los identificadores utilizados en las funciones WinHTTP.</span><span class="sxs-lookup"><span data-stu-id="b4c86-119">However, the handles used in WinInet functions cannot be interchanged with the handles used in WinHTTP functions.</span></span> <span data-ttu-id="b4c86-120">Para obtener más información sobre WinInet, vea [About WinInet](/windows/desktop/WinInet/about-wininet).</span><span class="sxs-lookup"><span data-stu-id="b4c86-120">For more information about WinInet, see [About WinINet](/windows/desktop/WinInet/about-wininet).</span></span>

<span data-ttu-id="b4c86-121">La función [**WinHttpCloseHandle**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpclosehandle) cierra los identificadores de WinHTTP **HINTERNET** .</span><span class="sxs-lookup"><span data-stu-id="b4c86-121">The [**WinHttpCloseHandle**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpclosehandle) function closes WinHTTP **HINTERNET** handles.</span></span>

## <a name="naming-handles"></a><span data-ttu-id="b4c86-122">Controladores de nomenclatura</span><span class="sxs-lookup"><span data-stu-id="b4c86-122">Naming Handles</span></span>

<span data-ttu-id="b4c86-123">En la documentación de WinHTTP, las descripciones de las funciones de la interfaz de programación de aplicaciones (API) y el código de ejemplo muestran la creación y el uso de diversos tipos de identificadores de **HINTERNET** .</span><span class="sxs-lookup"><span data-stu-id="b4c86-123">Throughout the WinHTTP documentation, descriptions of functions in the application programming interface (API) and sample code show the creation and use of various types of **HINTERNET** handles.</span></span> <span data-ttu-id="b4c86-124">Para realizar un seguimiento de los distintos tipos de identificadores disponibles, la nomenclatura de estos identificadores es coherente.</span><span class="sxs-lookup"><span data-stu-id="b4c86-124">To keep track of the different types of handles available, the naming of these handles is consistent.</span></span> <span data-ttu-id="b4c86-125">En la tabla siguiente se muestran los identificadores usados por la Convención en la documentación de.</span><span class="sxs-lookup"><span data-stu-id="b4c86-125">The following table shows the identifiers used by convention in the documentation.</span></span>



| <span data-ttu-id="b4c86-126">Tipo de identificador</span><span class="sxs-lookup"><span data-stu-id="b4c86-126">Handle type</span></span>       | <span data-ttu-id="b4c86-127">Función que crea el controlador</span><span class="sxs-lookup"><span data-stu-id="b4c86-127">Function creating handle</span></span>                                                                                                          | <span data-ttu-id="b4c86-128">Identificador</span><span class="sxs-lookup"><span data-stu-id="b4c86-128">Identifier</span></span> |
|-------------------|-----------------------------------------------------------------------------------------------------------------------------------|------------|
| <span data-ttu-id="b4c86-129">Identificador genérico</span><span class="sxs-lookup"><span data-stu-id="b4c86-129">Generic handle</span></span>    | <span data-ttu-id="b4c86-130">[**WinHttpOpen**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopen), [**WinHttpConnect**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpconnect)o [**WinHttpOpenRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopenrequest)</span><span class="sxs-lookup"><span data-stu-id="b4c86-130">[**WinHttpOpen**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopen), [**WinHttpConnect**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpconnect), or [**WinHttpOpenRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopenrequest)</span></span> | <span data-ttu-id="b4c86-131">hInternet</span><span class="sxs-lookup"><span data-stu-id="b4c86-131">hInternet</span></span>  |
| <span data-ttu-id="b4c86-132">Identificador de sesión</span><span class="sxs-lookup"><span data-stu-id="b4c86-132">Session handle</span></span>    | [<span data-ttu-id="b4c86-133">**WinHttpOpen**</span><span class="sxs-lookup"><span data-stu-id="b4c86-133">**WinHttpOpen**</span></span>](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopen)                                                                                                | <span data-ttu-id="b4c86-134">hSession</span><span class="sxs-lookup"><span data-stu-id="b4c86-134">hSession</span></span>   |
| <span data-ttu-id="b4c86-135">Identificador de conexión</span><span class="sxs-lookup"><span data-stu-id="b4c86-135">Connection handle</span></span> | [<span data-ttu-id="b4c86-136">**WinHttpConnect**</span><span class="sxs-lookup"><span data-stu-id="b4c86-136">**WinHttpConnect**</span></span>](/windows/desktop/api/Winhttp/nf-winhttp-winhttpconnect)                                                                                          | <span data-ttu-id="b4c86-137">hConnect</span><span class="sxs-lookup"><span data-stu-id="b4c86-137">hConnect</span></span>   |
| <span data-ttu-id="b4c86-138">Identificador de solicitud</span><span class="sxs-lookup"><span data-stu-id="b4c86-138">Request handle</span></span>    | [<span data-ttu-id="b4c86-139">**WinHttpOpenRequest**</span><span class="sxs-lookup"><span data-stu-id="b4c86-139">**WinHttpOpenRequest**</span></span>](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopenrequest)                                                                                  | <span data-ttu-id="b4c86-140">hRequest</span><span class="sxs-lookup"><span data-stu-id="b4c86-140">hRequest</span></span>   |



 

## <a name="handle-hierarchy"></a><span data-ttu-id="b4c86-141">Jerarquía de identificadores</span><span class="sxs-lookup"><span data-stu-id="b4c86-141">Handle Hierarchy</span></span>

<span data-ttu-id="b4c86-142">Los identificadores de **HINTERNET** se mantienen en una jerarquía.</span><span class="sxs-lookup"><span data-stu-id="b4c86-142">The **HINTERNET** handles are maintained in a hierarchy.</span></span> <span data-ttu-id="b4c86-143">El identificador devuelto por [**WinHttpOpen**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopen) es el identificador de **HINTERNET** de la sesión.</span><span class="sxs-lookup"><span data-stu-id="b4c86-143">The handle returned by [**WinHttpOpen**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopen) is the session **HINTERNET** handle.</span></span> <span data-ttu-id="b4c86-144">La llamada a **WinHttpOpen** inicializa las funciones WinHTTP e inicia un contexto de sesión que mantiene la información y la configuración de usuario a lo largo de la vida del identificador de sesión.</span><span class="sxs-lookup"><span data-stu-id="b4c86-144">Calling **WinHttpOpen** initializes the WinHTTP functions and begins a session context that maintains user information and settings throughout the life of the session handle.</span></span> <span data-ttu-id="b4c86-145">[**WinHttpConnect**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpconnect) especifica un servidor http o https de destino y crea un identificador de **HINTERNET** de conexión.</span><span class="sxs-lookup"><span data-stu-id="b4c86-145">[**WinHttpConnect**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpconnect) specifies a target HTTP or HTTPS server and creates a connection **HINTERNET** handle.</span></span> <span data-ttu-id="b4c86-146">De forma predeterminada, el identificador de conexión hereda la configuración del identificador de sesión.</span><span class="sxs-lookup"><span data-stu-id="b4c86-146">By default, the connection handle inherits the settings for the session handle.</span></span> <span data-ttu-id="b4c86-147">A cada recurso especificado con una llamada a [**WinHttpOpenRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopenrequest) se le asigna un identificador de **HINTERNET** de solicitud.</span><span class="sxs-lookup"><span data-stu-id="b4c86-147">Each resource specified with a call to [**WinHttpOpenRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopenrequest) is assigned a request **HINTERNET** handle.</span></span>

<span data-ttu-id="b4c86-148">En el diagrama siguiente se ilustra la jerarquía de los identificadores de **HINTERNET** .</span><span class="sxs-lookup"><span data-stu-id="b4c86-148">The following diagram illustrates the hierarchy of **HINTERNET** handles.</span></span> <span data-ttu-id="b4c86-149">Cada cuadro del diagrama representa una función WinHTTP que devuelve un identificador **HINTERNET** .</span><span class="sxs-lookup"><span data-stu-id="b4c86-149">Each box in the diagram represents a WinHTTP function that returns an **HINTERNET** handle.</span></span>

![funciones que crean identificadores](images/art-winhttp2.png)

<span data-ttu-id="b4c86-151">Después de cerrar un identificador, la aplicación debe estar preparada para recibir notificaciones de devolución de llamada en el identificador hasta que se devuelva el valor **Closed del identificador de estado de devolución de llamada de WinHTTP \_ \_ \_ \_** final para indicar que el identificador está completamente cerrado.</span><span class="sxs-lookup"><span data-stu-id="b4c86-151">After closing a handle, the application must be prepared to receive callback notifications on the handle until the final **WINHTTP\_CALLBACK\_STATUS\_HANDLE\_CLOSED** value is returned to indicate that the handle is completely closed.</span></span>

<span data-ttu-id="b4c86-152">Un identificador de sesión se denomina elemento primario de cualquier identificador de conexión que se use para crear; del mismo modo, tanto el identificador de conexión como su identificador de sesión principal se denominan elementos primarios de cualquier identificador de solicitud que se utiliza para crear el identificador de conexión.</span><span class="sxs-lookup"><span data-stu-id="b4c86-152">A session handle is termed the parent of any connection handle it used to create; likewise, both the connection handle and its parent session handle are termed parents of any request handle that the connection handle is used to create.</span></span>

<span data-ttu-id="b4c86-153">Cuando se cierra un identificador primario, los elementos secundarios que tiene se invalidan indirectamente incluso si no se cierran, y las solicitudes posteriores que los usan se producen con el error de **\_ \_ identificador no válido**.</span><span class="sxs-lookup"><span data-stu-id="b4c86-153">When a parent handle is closed, any children it has are indirectly invalidated even if not closed themselves, and subsequent requests using them fail with the error **ERROR\_INVALID\_HANDLE**.</span></span> <span data-ttu-id="b4c86-154">No se puede confiar en las solicitudes asincrónicas pendientes para que se completen correctamente.</span><span class="sxs-lookup"><span data-stu-id="b4c86-154">Pending asynchronous requests cannot be relied on to complete correctly.</span></span>

<span data-ttu-id="b4c86-155">En el diagrama siguiente se muestran las funciones que utilizan el identificador **HINTERNET** creado por [**WinHttpOpenRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopenrequest).</span><span class="sxs-lookup"><span data-stu-id="b4c86-155">The following diagram shows the functions that use the **HINTERNET** handle created by [**WinHttpOpenRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopenrequest).</span></span> <span data-ttu-id="b4c86-156">Los cuadros sombreados representan funciones de WinHTTP que crean identificadores y los cuadros de texto simple muestran las funciones que usan esos manipuladores de **HINTERNET** .</span><span class="sxs-lookup"><span data-stu-id="b4c86-156">The shaded boxes represent WinHTTP functions that create handles, and the plain boxes show the functions that use those **HINTERNET** handles.</span></span> <span data-ttu-id="b4c86-157">El diagrama también se organiza para mostrar el orden en el que normalmente se llama a las funciones WinHTTP.</span><span class="sxs-lookup"><span data-stu-id="b4c86-157">The diagram is also organized to show the order in which WinHTTP functions are normally called.</span></span>

![funciones que crean identificadores](images/art-winhttp2.png)

## <a name="explanation-of-the-handle-hierarchy"></a><span data-ttu-id="b4c86-159">Explicación de la jerarquía de identificadores</span><span class="sxs-lookup"><span data-stu-id="b4c86-159">Explanation of the Handle Hierarchy</span></span>

<span data-ttu-id="b4c86-160">En primer lugar, se crea un identificador de sesión con [**WinHttpOpen**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopen).</span><span class="sxs-lookup"><span data-stu-id="b4c86-160">First, a session handle is created with [**WinHttpOpen**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopen).</span></span> <span data-ttu-id="b4c86-161">[**WinHttpConnect**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpconnect) requiere el identificador de sesión como primer parámetro y devuelve un identificador de conexión para un servidor especificado.</span><span class="sxs-lookup"><span data-stu-id="b4c86-161">[**WinHttpConnect**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpconnect) requires the session handle as its first parameter and returns a connection handle for a specified server.</span></span> <span data-ttu-id="b4c86-162">[**WinHttpOpenRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopenrequest)crea un identificador de solicitud que usa el identificador de conexión creado por [**WinHttpConnect**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpconnect).</span><span class="sxs-lookup"><span data-stu-id="b4c86-162">A request handle is created by [**WinHttpOpenRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpopenrequest), which uses the connection handle created by [**WinHttpConnect**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpconnect).</span></span> <span data-ttu-id="b4c86-163">Si la aplicación elige agregar encabezados adicionales a la solicitud, o si es necesario para que la aplicación establezca credenciales para la autenticación, se puede llamar a [**WinHttpAddRequestHeaders**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpaddrequestheaders) y [**WinHttpSetCredentials**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetcredentials) mediante este identificador de solicitud.</span><span class="sxs-lookup"><span data-stu-id="b4c86-163">If the application chooses to add additional headers to the request, or if is it necessary for the application to set credentials for authentication, [**WinHttpAddRequestHeaders**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpaddrequestheaders) and [**WinHttpSetCredentials**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetcredentials) can be called using this request handle.</span></span> <span data-ttu-id="b4c86-164">La solicitud se envía mediante [**WinHttpSendRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsendrequest), que usa el identificador de solicitud.</span><span class="sxs-lookup"><span data-stu-id="b4c86-164">The request is sent by [**WinHttpSendRequest**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsendrequest), which uses the request handle.</span></span> <span data-ttu-id="b4c86-165">Después de enviar la solicitud, se pueden enviar datos adicionales al servidor mediante [**WinHttpWriteData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpwritedata), o bien la aplicación puede omitir directamente [**WinHttpReceiveResponse**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpreceiveresponse) para especificar que no se envía más información al servidor.</span><span class="sxs-lookup"><span data-stu-id="b4c86-165">After sending the request, additional data can be sent to the server using [**WinHttpWriteData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpwritedata), or the application can skip directly to [**WinHttpReceiveResponse**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpreceiveresponse) to specify that no more information is sent to the server.</span></span> <span data-ttu-id="b4c86-166">En este punto, dependiendo del propósito de la aplicación, el identificador de solicitud se puede usar para llamar a [**WinHttpQueryHeaders**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryheaders), [**WinHttpQueryAuthSchemes**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryauthschemes)o recuperar un recurso con [**WinHttpQueryDataAvailable**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpquerydataavailable) y [**WinHttpReadData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpreaddata).</span><span class="sxs-lookup"><span data-stu-id="b4c86-166">At this point, depending on the purpose of the application, the request handle can be used to call [**WinHttpQueryHeaders**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryheaders), [**WinHttpQueryAuthSchemes**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryauthschemes), or retrieve a resource with [**WinHttpQueryDataAvailable**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpquerydataavailable) and [**WinHttpReadData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpreaddata).</span></span>

 

 
