---
description: En este tema se describe cómo implementar un archivo DLL para un filtro DirectShow mediante las clases base de DirectShow.
ms.assetid: d47980d1-6d0c-4b0d-a875-7b072562944a
title: Generadores de clases y plantillas de generador
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e02699a8ff0740ddcf1d86b8514fd45dac9e32ed
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/06/2021
ms.locfileid: "104555613"
---
# <a name="class-factories-and-factory-templates"></a><span data-ttu-id="2568f-103">Generadores de clases y plantillas de generador</span><span class="sxs-lookup"><span data-stu-id="2568f-103">Class Factories and Factory Templates</span></span>

<span data-ttu-id="2568f-104">En este tema se describe cómo implementar un archivo DLL para un filtro DirectShow mediante las [clases base de DirectShow](directshow-base-classes.md).</span><span class="sxs-lookup"><span data-stu-id="2568f-104">This topic describes how to implement a DLL for a DirectShow filter, using the [DirectShow Base Classes](directshow-base-classes.md).</span></span>

<span data-ttu-id="2568f-105">Antes de que un cliente cree una instancia de un objeto COM, crea una instancia del generador de clases del objeto mediante una llamada a la función [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) .</span><span class="sxs-lookup"><span data-stu-id="2568f-105">Before a client creates an instance of a COM object, it creates an instance of the object's class factory, using a call to the [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) function.</span></span> <span data-ttu-id="2568f-106">Después, el cliente llama al método **IClassFactory:: CreateInstance** del generador de clases.</span><span class="sxs-lookup"><span data-stu-id="2568f-106">The client then calls the class factory's **IClassFactory::CreateInstance** method.</span></span> <span data-ttu-id="2568f-107">Es el generador de clases que crea realmente el componente y devuelve un puntero a la interfaz solicitada.</span><span class="sxs-lookup"><span data-stu-id="2568f-107">It is the class factory that actually creates the component and returns a pointer to the requested interface.</span></span> <span data-ttu-id="2568f-108">(La función [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) combina estos pasos, dentro de la llamada de función).</span><span class="sxs-lookup"><span data-stu-id="2568f-108">(The [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) function combines these steps, inside the function call.)</span></span>

<span data-ttu-id="2568f-109">En la ilustración siguiente se muestra la secuencia de llamadas a métodos.</span><span class="sxs-lookup"><span data-stu-id="2568f-109">The following illustration shows the sequence of method calls.</span></span>

![llamadas al método para crear un generador de clases](images/classfactory.png)

<span data-ttu-id="2568f-111">[**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) llama a la función [**DllGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-dllgetclassobject) , que se define en el archivo dll.</span><span class="sxs-lookup"><span data-stu-id="2568f-111">[**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) calls the [**DllGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-dllgetclassobject) function, which is defined in the DLL.</span></span> <span data-ttu-id="2568f-112">Esta función crea el generador de clases y devuelve un puntero a una interfaz en el generador de clases.</span><span class="sxs-lookup"><span data-stu-id="2568f-112">This function creates the class factory and returns a pointer to an interface on the class factory.</span></span> <span data-ttu-id="2568f-113">DirectShow implementa **DllGetClassObject** , pero la función se basa en el código de una manera determinada.</span><span class="sxs-lookup"><span data-stu-id="2568f-113">DirectShow implements **DllGetClassObject** for you, but the function relies on your code in a specific way.</span></span> <span data-ttu-id="2568f-114">Para entender cómo funciona, debe entender cómo implementa DirectShow los generadores de clases.</span><span class="sxs-lookup"><span data-stu-id="2568f-114">To understand how it works, you must understand how DirectShow implements class factories.</span></span>

<span data-ttu-id="2568f-115">Un generador de clases es un objeto COM dedicado a la creación de otro objeto COM.</span><span class="sxs-lookup"><span data-stu-id="2568f-115">A class factory is a COM object dedicated to creating another COM object.</span></span> <span data-ttu-id="2568f-116">Cada generador de clases tiene un tipo de objeto que crea.</span><span class="sxs-lookup"><span data-stu-id="2568f-116">Each class factory has one type of object that it creates.</span></span> <span data-ttu-id="2568f-117">En DirectShow, cada generador de clases es una instancia de la misma clase de C++, **CClassFactory**.</span><span class="sxs-lookup"><span data-stu-id="2568f-117">In DirectShow, every class factory is an instance of the same C++ class, **CClassFactory**.</span></span> <span data-ttu-id="2568f-118">Los generadores de clases se especializan por medio de otra clase, [**CFactoryTemplate**](cfactorytemplate.md), también denominada *plantilla de fábrica*.</span><span class="sxs-lookup"><span data-stu-id="2568f-118">Class factories are specialized by means of another class, [**CFactoryTemplate**](cfactorytemplate.md), also called the *factory template*.</span></span> <span data-ttu-id="2568f-119">Cada generador de clases contiene un puntero a una plantilla de fábrica.</span><span class="sxs-lookup"><span data-stu-id="2568f-119">Each class factory holds a pointer to a factory template.</span></span> <span data-ttu-id="2568f-120">La plantilla de generador contiene información sobre un componente específico, como el identificador de clase (CLSID) del componente, y un puntero a una función que crea el componente.</span><span class="sxs-lookup"><span data-stu-id="2568f-120">The factory template contains information about a specific component, such as the component's class identifier (CLSID), and a pointer to a function that creates the component.</span></span>

<span data-ttu-id="2568f-121">El archivo DLL declara una matriz global de plantillas de fábrica, una para cada componente del archivo DLL.</span><span class="sxs-lookup"><span data-stu-id="2568f-121">The DLL declares a global array of factory templates, one for each component in the DLL.</span></span> <span data-ttu-id="2568f-122">Cuando [**DllGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-dllgetclassobject) crea un nuevo generador de clases, busca una plantilla con un CLSID coincidente en la matriz.</span><span class="sxs-lookup"><span data-stu-id="2568f-122">When [**DllGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-dllgetclassobject) makes a new class factory, it searches the array for a template with a matching CLSID.</span></span> <span data-ttu-id="2568f-123">Suponiendo que encuentra una, crea un generador de clases que contiene un puntero a la plantilla coincidente.</span><span class="sxs-lookup"><span data-stu-id="2568f-123">Assuming it finds one, it creates a class factory that holds a pointer to the matching template.</span></span> <span data-ttu-id="2568f-124">Cuando el cliente llama a **IClassFactory:: CreateInstance**, el generador de clases llama a la función de creación de instancias definida en la plantilla.</span><span class="sxs-lookup"><span data-stu-id="2568f-124">When the client calls **IClassFactory::CreateInstance**, the class factory calls the instantiation function defined in the template.</span></span>

<span data-ttu-id="2568f-125">En la ilustración siguiente se muestra la secuencia de llamadas a métodos.</span><span class="sxs-lookup"><span data-stu-id="2568f-125">The following illustration shows the sequence of method calls.</span></span>

![plantillas de generador de clases en un archivo dll](images/classfactory2.png)

<span data-ttu-id="2568f-127">La ventaja de esta arquitectura es que puede definir solo algunas cosas que son específicas del componente, como la función de creación de instancias, sin implementar el generador de clases completo.</span><span class="sxs-lookup"><span data-stu-id="2568f-127">The benefit of this architecture is that you can define just a few things that are specific to your component, such as the instantiation function, without implementing the entire class factory.</span></span>

## <a name="related-topics"></a><span data-ttu-id="2568f-128">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="2568f-128">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2568f-129">Cómo crear un archivo DLL de filtro de DirectShow</span><span class="sxs-lookup"><span data-stu-id="2568f-129">How to Create a DirectShow Filter DLL</span></span>](how-to-create-a-dll.md)
</dt> </dl>

 

 
