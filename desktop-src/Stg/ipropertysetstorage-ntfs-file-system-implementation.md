---
title: 'IPropertySetStorage: implementación del sistema de archivos NTFS'
description: NTFS versión 5,0 proporciona una implementación de IPropertySetStorage para los archivos de un volumen NTFS cuando los mismos archivos no son archivos compuestos.
ms.assetid: cd7290bb-bb4e-4dea-9bf6-2e1fdd0ebae8
keywords:
- IPropertySetStorage Strctd STG, implementaciones, sistema de archivos NTFS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9b0d647b9cb804376a9efeb687b1524585ee938d
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "105665830"
---
# <a name="ipropertysetstorage-ntfs-file-system-implementation"></a><span data-ttu-id="69017-104">IPropertySetStorage: implementación del sistema de archivos NTFS</span><span class="sxs-lookup"><span data-stu-id="69017-104">IPropertySetStorage-NTFS File System Implementation</span></span>

<span data-ttu-id="69017-105">NTFS versión 5,0 proporciona una implementación de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) para los archivos de un volumen NTFS cuando los mismos archivos no son archivos compuestos.</span><span class="sxs-lookup"><span data-stu-id="69017-105">NTFS version 5.0 provides an implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) for files on an NTFS volume when the files themselves are not compound files.</span></span> <span data-ttu-id="69017-106">La implementación de NTFS es equivalente a la [implementación de archivo compuesto](ipropertysetstorage-compound-file-implementation.md).</span><span class="sxs-lookup"><span data-stu-id="69017-106">The NTFS implementation is equivalent to the [compound file implementation](ipropertysetstorage-compound-file-implementation.md).</span></span> <span data-ttu-id="69017-107">Para obtener más información sobre las excepciones, vea la sección Comentarios.</span><span class="sxs-lookup"><span data-stu-id="69017-107">For more information about exceptions, see Remarks.</span></span>

<span data-ttu-id="69017-108">**Para obtener un puntero a la implementación de NTFS de IPropertySetStorage**</span><span class="sxs-lookup"><span data-stu-id="69017-108">**To get a pointer to the NTFS implementation of IPropertySetStorage**</span></span>

1.  <span data-ttu-id="69017-109">Llame a [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) y especifique el **\_ archivo STGFMT** en el parámetro *grfFlags* para crear un nuevo archivo.</span><span class="sxs-lookup"><span data-stu-id="69017-109">Call [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) and specify **STGFMT\_FILE** in the *grfFlags* parameter to create a new file.</span></span>
2.  <span data-ttu-id="69017-110">Llame a [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) y especifique el **\_ archivo STGFMT** o **STGFMT \_ cualquier** valor de enumeración en el parámetro *grfFlags* para abrir un archivo existente.</span><span class="sxs-lookup"><span data-stu-id="69017-110">Call [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) and specify either the **STGFMT\_FILE** or **STGFMT\_ANY** enumeration value in the *grfFlags* parameter to open an existing file.</span></span>

<span data-ttu-id="69017-111">Sin embargo, no se puede obtener la implementación NTFS de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) para un archivo compuesto.</span><span class="sxs-lookup"><span data-stu-id="69017-111">However, you cannot obtain the NTFS implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) for a compound file.</span></span> <span data-ttu-id="69017-112">Al abrir un archivo compuesto con [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage), si se especifica el valor de enumeración del **\_ archivo STGFMT** , se produce un error.</span><span class="sxs-lookup"><span data-stu-id="69017-112">When opening a compound file with [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage), specifying the **STGFMT\_FILE** enumeration value results in an error.</span></span>

<span data-ttu-id="69017-113">Además, no se pueden realizar transacciones en los conjuntos de propiedades simples.</span><span class="sxs-lookup"><span data-stu-id="69017-113">Also, simple property sets cannot be transacted.</span></span> <span data-ttu-id="69017-114">Es decir, no puede especificar **STGM \_ transaccionado** en el parámetro *Grfmode* de los métodos [**Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) y [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) a menos que también especifique **PROPSETFLAG \_ nonsimple** en el parámetro *grfFlags* .</span><span class="sxs-lookup"><span data-stu-id="69017-114">That is, you cannot specify **STGM\_TRANSACTED** in the *grfmode* parameter of the [**Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) and [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) methods unless you also specify **PROPSETFLAG\_NONSIMPLE** in the *grfFlags* parameter.</span></span> <span data-ttu-id="69017-115">El propio objeto de almacenamiento del conjunto de propiedades no admite el procesamiento de transacciones.</span><span class="sxs-lookup"><span data-stu-id="69017-115">The property set storage object itself does not support transaction processing.</span></span>

## <a name="when-to-use"></a><span data-ttu-id="69017-116">Cuándo usar</span><span class="sxs-lookup"><span data-stu-id="69017-116">When to Use</span></span>

<span data-ttu-id="69017-117">Llame a los métodos de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) para crear, abrir o eliminar conjuntos de propiedades en el almacenamiento del conjunto de propiedades NTFS actual.</span><span class="sxs-lookup"><span data-stu-id="69017-117">Call the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) methods to create, open, or delete property sets in the current NTFS property set storage.</span></span> <span data-ttu-id="69017-118">También hay un método, [**IPropertySetStorage:: enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum), que proporciona un puntero a un enumerador que se puede usar para enumerar los conjuntos de propiedades en el almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="69017-118">There is also a method, [**IPropertySetStorage::Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum), that supplies a pointer to an enumerator that can be used to enumerate the property sets in the storage.</span></span>

## <a name="compatibility"></a><span data-ttu-id="69017-119">Compatibilidad</span><span class="sxs-lookup"><span data-stu-id="69017-119">Compatibility</span></span>

<span data-ttu-id="69017-120">Las implementaciones de NTFS de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) y [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) están disponibles a partir de Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="69017-120">The NTFS implementations of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) and [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) are available starting with Windows 2000.</span></span> <span data-ttu-id="69017-121">Las versiones anteriores no pueden tener acceso a estos conjuntos de propiedades.</span><span class="sxs-lookup"><span data-stu-id="69017-121">Earlier versions cannot access these property sets.</span></span>

<span data-ttu-id="69017-122">La implementación de NTFS almacena conjuntos de propiedades en secuencias alternativas de un archivo NTFS.</span><span class="sxs-lookup"><span data-stu-id="69017-122">The NTFS implementation stores property sets in alternate streams of an NTFS file.</span></span> <span data-ttu-id="69017-123">Los flujos alternativos se deben copiar cuando se copia el archivo principal.</span><span class="sxs-lookup"><span data-stu-id="69017-123">The alternate streams must be copied when the main file is copied.</span></span>

> [!Caution]  
> <span data-ttu-id="69017-124">No todos los sistemas de archivos admiten tales flujos.</span><span class="sxs-lookup"><span data-stu-id="69017-124">Not all file systems support such streams.</span></span> <span data-ttu-id="69017-125">Si un archivo NTFS con conjuntos de propiedades se copia en un volumen FAT, solo se copian los datos del archivo; se pierde el conjunto de propiedades.</span><span class="sxs-lookup"><span data-stu-id="69017-125">If an NTFS file with property sets is copied to a FAT volume, only the data in the file is copied; the property set is lost.</span></span> <span data-ttu-id="69017-126">En este caso, la función [**CopyFile**](/windows/desktop/api/winbase/nf-winbase-copyfile) no devuelve un error.</span><span class="sxs-lookup"><span data-stu-id="69017-126">The [**CopyFile**](/windows/desktop/api/winbase/nf-winbase-copyfile) function does not return an error in this case.</span></span>

 

> [!Caution]  
> <span data-ttu-id="69017-127">Si el equipo que realiza la copia de archivos no es un equipo que se ejecuta en Windows 2000 o posterior, es posible que se pierdan los conjuntos de propiedades.</span><span class="sxs-lookup"><span data-stu-id="69017-127">If the computer performing the file copy is not a computer running on Windows 2000 or later, the property sets may be lost.</span></span> <span data-ttu-id="69017-128">Por ejemplo, si un equipo que ejecuta el sistema operativo Windows 95 copia un archivo NTFS, el conjunto de propiedades se pierde aunque el archivo de destino esté también en un volumen NTFS.</span><span class="sxs-lookup"><span data-stu-id="69017-128">For example, if a computer running on Windows 95 operating system copies an NTFS file, the property set is lost even if the destination file is also on an NTFS volume.</span></span>

 

## <a name="methods"></a><span data-ttu-id="69017-129">Métodos</span><span class="sxs-lookup"><span data-stu-id="69017-129">Methods</span></span>

<span data-ttu-id="69017-130">La implementación del sistema de archivos NTFS de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) admite los siguientes métodos.</span><span class="sxs-lookup"><span data-stu-id="69017-130">The NTFS file system implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) supports the following methods.</span></span>

<dl> <dt>

<span data-ttu-id="69017-131"><span id="IPropertySetStorage__Create"></span><span id="ipropertysetstorage__create"></span><span id="IPROPERTYSETSTORAGE__CREATE"></span>[**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)</span><span class="sxs-lookup"><span data-stu-id="69017-131"><span id="IPropertySetStorage__Create"></span><span id="ipropertysetstorage__create"></span><span id="IPROPERTYSETSTORAGE__CREATE"></span>[**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)</span></span>
</dt> <dd>

<span data-ttu-id="69017-132">Crea un nuevo conjunto de propiedades en el almacenamiento de archivos NTFS actual y, en la devolución, proporciona un puntero de interfaz a la implementación de archivos NTFS de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) .</span><span class="sxs-lookup"><span data-stu-id="69017-132">Creates a new property set in the current NTFS file storage and, on return, supplies an interface pointer to the [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) NTFS file implementation.</span></span> <span data-ttu-id="69017-133">El modo de uso compartido especificado en el parámetro *grfmode* debe ser **STGM \_ share \_ Exclusive**.</span><span class="sxs-lookup"><span data-stu-id="69017-133">The sharing mode specified in the *grfmode* parameter must be **STGM\_SHARE\_EXCLUSIVE**.</span></span>

</dd> <dt>

<span data-ttu-id="69017-134"><span id="IPropertySetStorage__Open"></span><span id="ipropertysetstorage__open"></span><span id="IPROPERTYSETSTORAGE__OPEN"></span>[**IPropertySetStorage:: Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open)</span><span class="sxs-lookup"><span data-stu-id="69017-134"><span id="IPropertySetStorage__Open"></span><span id="ipropertysetstorage__open"></span><span id="IPROPERTYSETSTORAGE__OPEN"></span>[**IPropertySetStorage::Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open)</span></span>
</dt> <dd>

<span data-ttu-id="69017-135">Abre un conjunto de propiedades existente en el almacenamiento de propiedades actual.</span><span class="sxs-lookup"><span data-stu-id="69017-135">Opens an existing property set in the current property storage.</span></span> <span data-ttu-id="69017-136">En la devolución, proporciona un puntero de interfaz a la implementación de archivos NTFS de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage).</span><span class="sxs-lookup"><span data-stu-id="69017-136">On return, it supplies an interface pointer to the NTFS file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage).</span></span> <span data-ttu-id="69017-137">El modo de uso compartido especificado en el parámetro *grfmode* debe ser **STGM \_ share \_ Exclusive**.</span><span class="sxs-lookup"><span data-stu-id="69017-137">The sharing mode specified in the *grfmode* parameter must be **STGM\_SHARE\_EXCLUSIVE**.</span></span>

</dd> <dt>

<span data-ttu-id="69017-138"><span id="IPropertySetStorage__Delete"></span><span id="ipropertysetstorage__delete"></span><span id="IPROPERTYSETSTORAGE__DELETE"></span>[**IPropertySetStorage::D iminar**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-delete)</span><span class="sxs-lookup"><span data-stu-id="69017-138"><span id="IPropertySetStorage__Delete"></span><span id="ipropertysetstorage__delete"></span><span id="IPROPERTYSETSTORAGE__DELETE"></span>[**IPropertySetStorage::Delete**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-delete)</span></span>
</dt> <dd>

<span data-ttu-id="69017-139">Elimina una propiedad establecida en el almacenamiento de propiedades actual.</span><span class="sxs-lookup"><span data-stu-id="69017-139">Deletes a property set in the current property storage.</span></span>

</dd> <dt>

<span data-ttu-id="69017-140"><span id="IPropertySetStorage__Enum"></span><span id="ipropertysetstorage__enum"></span><span id="IPROPERTYSETSTORAGE__ENUM"></span>[**IPropertySetStorage:: enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum)</span><span class="sxs-lookup"><span data-stu-id="69017-140"><span id="IPropertySetStorage__Enum"></span><span id="ipropertysetstorage__enum"></span><span id="IPROPERTYSETSTORAGE__ENUM"></span>[**IPropertySetStorage::Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum)</span></span>
</dt> <dd>

<span data-ttu-id="69017-141">Crea un objeto que se usa para enumerar las estructuras [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) .</span><span class="sxs-lookup"><span data-stu-id="69017-141">Creates an object used to enumerate [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures.</span></span> <span data-ttu-id="69017-142">Cada estructura **STATPROPSETSTG** proporciona datos sobre un conjunto de propiedades único.</span><span class="sxs-lookup"><span data-stu-id="69017-142">Each **STATPROPSETSTG** structure provides data about a single property set.</span></span>

</dd> </dl>

## <a name="remarks"></a><span data-ttu-id="69017-143">Observaciones</span><span class="sxs-lookup"><span data-stu-id="69017-143">Remarks</span></span>

<span data-ttu-id="69017-144">Las implementaciones de NTFS de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) y [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) almacenan los conjuntos de propiedades en un archivo sin que ello afecte al contenido de ese archivo.</span><span class="sxs-lookup"><span data-stu-id="69017-144">The NTFS implementations of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) and [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) store property sets in a file without affecting the contents of that file.</span></span> <span data-ttu-id="69017-145">Por ejemplo, si crea un conjunto de propiedades en un archivo HTML denominado Default.htm, ese archivo se mostrará correctamente en un explorador Web.</span><span class="sxs-lookup"><span data-stu-id="69017-145">For example, if you create a property set in an HTML file named Default.htm, that file still displays properly in a Web browser.</span></span> <span data-ttu-id="69017-146">Es decir, los cambios en un archivo mediante estas dos interfaces no se detectan al obtener acceso a un archivo con la función [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) .</span><span class="sxs-lookup"><span data-stu-id="69017-146">That is, changes to a file using these two interfaces are undetectable when accessing a file with the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function.</span></span>

<span data-ttu-id="69017-147">La implementación de NTFS de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) proporciona una implementación segura cuando se usa para escribir conjuntos de propiedades en un archivo en un volumen NTFS de la versión 5,0.</span><span class="sxs-lookup"><span data-stu-id="69017-147">The NTFS implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) provides a safe implementation when used to write property sets to a file on an NTFS version 5.0 volume.</span></span> <span data-ttu-id="69017-148">La implementación no puede dañar estos conjuntos de propiedades incluso en caso de que se produzca un error del sistema.</span><span class="sxs-lookup"><span data-stu-id="69017-148">Such property sets cannot be corrupted by the implementation even in the event of a system failure.</span></span> <span data-ttu-id="69017-149">Por ejemplo, si se produce un error en la alimentación de un sistema durante una llamada a [**IPropertyStorage:: commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) mientras el conjunto de propiedades se vacía en el disco, el conjunto de propiedades nunca se deja en un estado intermedio.</span><span class="sxs-lookup"><span data-stu-id="69017-149">For example, if the power to a system fails during a call to [**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) while the property set is flushed to the disk, the property set is never left in an intermediate state.</span></span> <span data-ttu-id="69017-150">La versión anterior del conjunto de propiedades permanece o se guardan todas las actualizaciones.</span><span class="sxs-lookup"><span data-stu-id="69017-150">Either the previous version of the property set remains or all of the updates are saved.</span></span>

<span data-ttu-id="69017-151">La implementación de NTFS de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) difiere de la implementación de archivo compuesto de las siguientes maneras:</span><span class="sxs-lookup"><span data-stu-id="69017-151">The NTFS implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) differs from the compound file implementation in the following ways:</span></span>

-   <span data-ttu-id="69017-152">Una estructura [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) obtenida de la interfaz [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) contiene un miembro **CLSID** cuyo valor siempre es cero (**CLSID \_ null**).</span><span class="sxs-lookup"><span data-stu-id="69017-152">A [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structure obtained from the [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) interface contains a **clsid** member whose value is always zero (**CLSID\_NULL**).</span></span> <span data-ttu-id="69017-153">Con la implementación de archivo compuesto, se devuelve el miembro **CLSID** correcto para los conjuntos de propiedades no simples (consulte [almacenamiento y objetos de secuencia para un conjunto de propiedades](storage-vs--stream-for-a-property-set.md)).</span><span class="sxs-lookup"><span data-stu-id="69017-153">With the compound file implementation, the correct **clsid** member is returned for non-simple (see [Storage and Stream Objects for a Property Set](storage-vs--stream-for-a-property-set.md)) property sets.</span></span>
-   <span data-ttu-id="69017-154">Al obtener una implementación NTFS del puntero de la interfaz [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) con la función [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) o [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) , el parámetro *grfmode* debe seguir las mismas reglas que para la implementación de archivo compuesto.</span><span class="sxs-lookup"><span data-stu-id="69017-154">When obtaining an NTFS implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface pointer using the [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) function, the *grfmode* parameter must follow the same rules as for the compound file implementation.</span></span>

    <span data-ttu-id="69017-155">Además, no se pueden usar las marcas siguientes:</span><span class="sxs-lookup"><span data-stu-id="69017-155">In addition, the following flags may not be used:</span></span>

    <span data-ttu-id="69017-156">**STGM \_ SIMPLE**, **STGM \_ transacción**, **STGM \_ Convert**, **STGM \_ Priority** y **STGM \_ DELETEONRELEASE**.</span><span class="sxs-lookup"><span data-stu-id="69017-156">**STGM\_SIMPLE**, **STGM\_TRANSACTED**, **STGM\_CONVERT**, **STGM\_PRIORITY**, and **STGM\_DELETEONRELEASE**.</span></span>

-   <span data-ttu-id="69017-157">Cuando las funciones [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) o [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) obtienen una interfaz [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) de NTFS, los modos de uso compartido se aplican principalmente a otras instancias de esa interfaz y no a las instancias de que abren el archivo.</span><span class="sxs-lookup"><span data-stu-id="69017-157">When an NTFS [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface is obtained by the [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) functions, the sharing modes primarily apply to other instances of that interface, and not to instances of opening the file itself.</span></span> <span data-ttu-id="69017-158">Por ejemplo, si se abre una interfaz **IPropertySetStorage** de NTFS mediante una llamada a la función **StgOpenStorageEx** , con el parámetro *grfmode* establecido en **STGM \_ ReadWrite \| STGM \_ share en \_ exclusiva**, es posible abrir el archivo con la función [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) .</span><span class="sxs-lookup"><span data-stu-id="69017-158">For example, if an NTFS **IPropertySetStorage** interface is opened by calling the **StgOpenStorageEx** function, with the *grfmode* parameter set to **STGM\_READWRITE\|STGM\_SHARE\_EXCLUSIVE**, it is possible to open the file with the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function.</span></span>

    <span data-ttu-id="69017-159">Estas instancias simultáneas de apertura de esta interfaz están sujetas a las siguientes restricciones: el parámetro *dwShareMode* de la función [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) debe especificar la marca de **\_ \_ lectura del recurso compartido de archivos** y el parámetro *dwAccess* no debe especificar la marca de **eliminación** .</span><span class="sxs-lookup"><span data-stu-id="69017-159">Such simultaneous instances of opening this interface are subject to the following constraints: the *dwShareMode* parameter in the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function must specify the **FILE\_SHARE\_READ** flag, and the *dwAccess* parameter must not specify the **DELETE** flag.</span></span> <span data-ttu-id="69017-160">Además, las funciones [**DeleteFile**](/windows/desktop/api/fileapi/nf-fileapi-deletefilea) y [**MoveFile**](/windows/desktop/api/winbase/nf-winbase-movefile) no deben llamarse en un archivo para el que estén abiertas estas interfaces de conjunto de propiedades, ya que estas funciones requieren acceso de **eliminación** al archivo.</span><span class="sxs-lookup"><span data-stu-id="69017-160">Also, the [**DeleteFile**](/windows/desktop/api/fileapi/nf-fileapi-deletefilea) and [**MoveFile**](/windows/desktop/api/winbase/nf-winbase-movefile) functions must not be called on a file for which these property set interfaces are open, as these functions require **DELETE** access to the file.</span></span>

-   <span data-ttu-id="69017-161">Si un método [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) de NTFS se abre como de solo lectura y el archivo no tiene ningún conjunto de propiedades, el objeto devuelto no conservará realmente el archivo.</span><span class="sxs-lookup"><span data-stu-id="69017-161">If an NTFS [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) method is opened as read-only, and the file currently has no property sets, the object returned will not actually hold open the file.</span></span> <span data-ttu-id="69017-162">Por consiguiente, otras aperturas de ese archivo se realizarán correctamente, incluso si el modo de uso compartido de la operación de apertura original lo rechazaría.</span><span class="sxs-lookup"><span data-stu-id="69017-162">Consequently, other openings of that file will succeed, even if the sharing mode of the original open operation would otherwise reject it.</span></span>

    <span data-ttu-id="69017-163">Ejemplo Si un [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) de NTFS se abre en el modo **STGM \_ Read \| STGM \_ share \_ Exclusive** y el archivo no tiene ningún conjunto de propiedades, se puede abrir simultáneamente el archivo **STGM \_ ReadWrite \| STGM \_ share \_**.</span><span class="sxs-lookup"><span data-stu-id="69017-163">Example; if an NTFS [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) is opened in the mode **STGM\_READ\|STGM\_SHARE\_EXCLUSIVE**, and the file has no property sets, it will be possible to simultaneously open the file **STGM\_READWRITE\|STGM\_SHARE\_EXCLUSIVE**.</span></span>

## <a name="related-topics"></a><span data-ttu-id="69017-164">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="69017-164">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="69017-165">IPropertyStorage: implementación del sistema de archivos NTFS</span><span class="sxs-lookup"><span data-stu-id="69017-165">IPropertyStorage-NTFS File System Implementation</span></span>](ipropertystorage-ntfs-file-system-implementation.md)
</dt> <dt>

[<span data-ttu-id="69017-166">**IPropertySetStorage**</span><span class="sxs-lookup"><span data-stu-id="69017-166">**IPropertySetStorage**</span></span>](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage)
</dt> <dt>

[<span data-ttu-id="69017-167">**IPropertyStorage**</span><span class="sxs-lookup"><span data-stu-id="69017-167">**IPropertyStorage**</span></span>](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage)
</dt> <dt>

[<span data-ttu-id="69017-168">**IStorage:: EnumElements**</span><span class="sxs-lookup"><span data-stu-id="69017-168">**IStorage::EnumElements**</span></span>](/windows/desktop/api/Objidl/nf-objidl-istorage-enumelements)
</dt> <dt>

[<span data-ttu-id="69017-169">**Constantes de PROPSETFLAG**</span><span class="sxs-lookup"><span data-stu-id="69017-169">**PROPSETFLAG Constants**</span></span>](propsetflag-constants.md)
</dt> <dt>

[<span data-ttu-id="69017-170">**STATPROPSETSTG**</span><span class="sxs-lookup"><span data-stu-id="69017-170">**STATPROPSETSTG**</span></span>](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)
</dt> </dl>

 

 