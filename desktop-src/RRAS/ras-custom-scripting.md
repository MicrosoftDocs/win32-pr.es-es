---
title: Scripting personalizado de RAS
description: Los programadores pueden crear un archivo DLL de scripting personalizado que resida en un equipo cliente RAS. Este archivo DLL puede comunicarse con el servidor durante el proceso de establecer una conexión.
ms.assetid: c27b8b02-6018-4441-a355-1fb890b9001c
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c625f020d9dafcb352c5f1b382014f9dba189330
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "103995363"
---
# <a name="ras-custom-scripting"></a><span data-ttu-id="aa8db-104">Scripting personalizado de RAS</span><span class="sxs-lookup"><span data-stu-id="aa8db-104">RAS Custom Scripting</span></span>

<span data-ttu-id="aa8db-105">Los programadores pueden crear un archivo DLL de scripting personalizado que resida en un equipo cliente RAS.</span><span class="sxs-lookup"><span data-stu-id="aa8db-105">Developers can create a custom-scripting DLL that resides on a RAS client computer.</span></span> <span data-ttu-id="aa8db-106">Este archivo DLL puede comunicarse con el servidor durante el proceso de establecer una conexión.</span><span class="sxs-lookup"><span data-stu-id="aa8db-106">This DLL can communicate with the server during the process of establishing a connection.</span></span>

<span data-ttu-id="aa8db-107">**Windows NT:** El scripting personalizado no está disponible.</span><span class="sxs-lookup"><span data-stu-id="aa8db-107">**Windows NT:** Custom scripting is not available.</span></span>

## <a name="setting-up-the-dll"></a><span data-ttu-id="aa8db-108">Configurar el archivo DLL</span><span class="sxs-lookup"><span data-stu-id="aa8db-108">Setting up the DLL</span></span>

<span data-ttu-id="aa8db-109">Para configurar el archivo DLL, cree un valor con el nombre **CustomScriptDllPath** en la siguiente clave del registro:</span><span class="sxs-lookup"><span data-stu-id="aa8db-109">To set up the DLL, create a value with the name **CustomScriptDllPath** under the following registry key:</span></span>

```
HKEY_LOCAL_MACHINE
   System
      CurrentControlSet
         Services
            Rasman
               Parameters
```

<span data-ttu-id="aa8db-110">Este valor debe ser de tipo **reg \_ Expand \_**.</span><span class="sxs-lookup"><span data-stu-id="aa8db-110">This value should be of type **REG\_EXPAND\_SZ**.</span></span> <span data-ttu-id="aa8db-111">El valor debe contener la ruta de acceso al archivo DLL de scripting personalizado.</span><span class="sxs-lookup"><span data-stu-id="aa8db-111">The value should contain the path to the custom-scripting DLL.</span></span> <span data-ttu-id="aa8db-112">Solo se admite un archivo DLL de scripting personalizado para cada equipo cliente RAS.</span><span class="sxs-lookup"><span data-stu-id="aa8db-112">Only one custom-scripting DLL is supported for each RAS client computer.</span></span>

## <a name="interaction-between-the-server-ras-and-the-custom-scripting-dll"></a><span data-ttu-id="aa8db-113">Interacción entre el servidor, el RAS y el Custom-Scripting DLL</span><span class="sxs-lookup"><span data-stu-id="aa8db-113">Interaction Between the Server, RAS, and the Custom-Scripting DLL</span></span>

<span data-ttu-id="aa8db-114">El archivo DLL de scripting personalizado debe exportar un único punto de entrada: [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn).</span><span class="sxs-lookup"><span data-stu-id="aa8db-114">The custom scripting DLL should export a single entry point: [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn).</span></span> <span data-ttu-id="aa8db-115">RAS llama a esta función durante el \_ Estado interactivo RASCS del proceso de conexión.</span><span class="sxs-lookup"><span data-stu-id="aa8db-115">RAS calls this function during the RASCS\_Interactive state of the connection process.</span></span> <span data-ttu-id="aa8db-116">El \_ Estado interactivo de RASCS es un estado de pausa, que permite al usuario interactuar con una interfaz de usuario presentada por el archivo dll de scripting personalizado.</span><span class="sxs-lookup"><span data-stu-id="aa8db-116">The RASCS\_Interactive state is a paused state, which allows the user to interact with a user interface presented by the custom-scripting DLL.</span></span> <span data-ttu-id="aa8db-117">Consulte [**RASCONNSTATE**](/previous-versions/windows/desktop/legacy/aa376727(v=vs.85)) para obtener más información sobre los Estados de conexión.</span><span class="sxs-lookup"><span data-stu-id="aa8db-117">See [**RASCONNSTATE**](/previous-versions/windows/desktop/legacy/aa376727(v=vs.85)) for more information about connection states.</span></span>

<span data-ttu-id="aa8db-118">RAS pasará como parámetros a la función [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) :</span><span class="sxs-lookup"><span data-stu-id="aa8db-118">RAS will pass as parameters to the [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) function:</span></span>

-   <span data-ttu-id="aa8db-119">Identificador del puerto en el equipo cliente que se utiliza para la conexión.</span><span class="sxs-lookup"><span data-stu-id="aa8db-119">A handle to the port on the client computer that is being used for the connection.</span></span>
-   <span data-ttu-id="aa8db-120">Cadenas que identifican la libreta de teléfonos y la entrada para la conexión.</span><span class="sxs-lookup"><span data-stu-id="aa8db-120">Strings that identify the phone book and entry for the connection.</span></span>
-   <span data-ttu-id="aa8db-121">RAS también pasa un identificador a una ventana para permitir que el archivo DLL presente una interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="aa8db-121">RAS also passes in a handle to a window to enable the DLL to present a user interface.</span></span>
-   <span data-ttu-id="aa8db-122">Un conjunto de punteros de función que el archivo DLL puede utilizar para comunicarse con el servidor.</span><span class="sxs-lookup"><span data-stu-id="aa8db-122">A set of function pointers that the DLL can use to communicate with the server.</span></span>

<span data-ttu-id="aa8db-123">Vea [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) para obtener más información sobre estos parámetros.</span><span class="sxs-lookup"><span data-stu-id="aa8db-123">See [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) for more information about these parameters.</span></span>

<span data-ttu-id="aa8db-124">RAS pasa un puntero a una estructura [**RASCUSTOMSCRIPTEXTENSIONS**](/previous-versions/windows/desktop/legacy/aa376738(v=vs.85)) como el último parámetro a [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn).</span><span class="sxs-lookup"><span data-stu-id="aa8db-124">RAS passes a pointer to a [**RASCUSTOMSCRIPTEXTENSIONS**](/previous-versions/windows/desktop/legacy/aa376738(v=vs.85)) structure as the last parameter to [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn).</span></span> <span data-ttu-id="aa8db-125">Esta estructura contiene un puntero a una función de tipo [**PFNRASSETCOMMSETTINGS**](/windows/desktop/api/Ras/nc-ras-pfnrassetcommsettings).</span><span class="sxs-lookup"><span data-stu-id="aa8db-125">This structure contains a pointer to a function of type [**PFNRASSETCOMMSETTINGS**](/windows/desktop/api/Ras/nc-ras-pfnrassetcommsettings).</span></span> <span data-ttu-id="aa8db-126">La DLL de scripting personalizado llama a esta función para modificar la configuración de comunicación en el puerto utilizado por la conexión.</span><span class="sxs-lookup"><span data-stu-id="aa8db-126">The custom-scripting DLL calls this function to modify the communication settings on the port being used by the connection.</span></span>

<span data-ttu-id="aa8db-127">RAS media la interacción entre el servidor y el archivo DLL de scripting personalizado.</span><span class="sxs-lookup"><span data-stu-id="aa8db-127">RAS mediates the interaction between the server and the custom-scripting DLL.</span></span> <span data-ttu-id="aa8db-128">Normalmente, el servidor inicia el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="aa8db-128">Typically, the server initiates the dialog.</span></span> <span data-ttu-id="aa8db-129">Por ejemplo, el servidor puede solicitar el nombre de usuario y la contraseña del usuario.</span><span class="sxs-lookup"><span data-stu-id="aa8db-129">For example, the server may request the user name and password of the user.</span></span>

<span data-ttu-id="aa8db-130">Al utilizar el script personalizado para establecer una conexión, el servidor no necesita ejecutar Windows NT 4,0 o Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="aa8db-130">When using custom-scripting to establish a connection, the server need not be running Windows NT 4.0 or Windows 2000.</span></span>

## <a name="custom-scripting-user-interface-must-support-idcancel"></a><span data-ttu-id="aa8db-131">La interfaz de usuario de scripting personalizado debe ser compatible con IDCANCEL</span><span class="sxs-lookup"><span data-stu-id="aa8db-131">Custom Scripting User Interface Must Support IDCANCEL</span></span>

<span data-ttu-id="aa8db-132">Si el marcador personalizado muestra una interfaz de usuario, la interfaz de usuario debe admitir \_ mensajes de comandos de WM en los que LOWORD (*wParam*) es igual a IDCANCEL.</span><span class="sxs-lookup"><span data-stu-id="aa8db-132">If the custom dialer displays a user interface, the user interface must support WM\_COMMAND messages where LOWORD(*wParam*) equals IDCANCEL.</span></span>

## <a name="configuring-the-connection"></a><span data-ttu-id="aa8db-133">Configuración de la conexión</span><span class="sxs-lookup"><span data-stu-id="aa8db-133">Configuring the Connection</span></span>

<span data-ttu-id="aa8db-134">El punto de entrada [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) se puede invocar desde [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga) o, en Windows XP, desde [**rasdial**](/windows/desktop/api/Ras/nf-ras-rasdiala).</span><span class="sxs-lookup"><span data-stu-id="aa8db-134">The [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) entry point can be invoked from [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga) or, on Windows XP, from [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala).</span></span>

<span data-ttu-id="aa8db-135">Para invocar [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) desde [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga), establezca la \_ opción RASEO CustomScript en la entrada de la libreta de teléfonos para la conexión.</span><span class="sxs-lookup"><span data-stu-id="aa8db-135">To invoke [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) from [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga), set the RASEO\_CustomScript option in the phone-book entry for the connection.</span></span> <span data-ttu-id="aa8db-136">Vea el miembro **dwfOptions** de [**RASENTRY**](/previous-versions/windows/desktop/legacy/aa377274(v=vs.85)) para obtener una descripción de las opciones de entrada de la libreta de teléfonos.</span><span class="sxs-lookup"><span data-stu-id="aa8db-136">See the **dwfOptions** member of [**RASENTRY**](/previous-versions/windows/desktop/legacy/aa377274(v=vs.85)) for a description of phone-book entry options.</span></span> <span data-ttu-id="aa8db-137">Use las funciones [**RasGetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rasgetentrypropertiesa) y [**RasSetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rassetentrypropertiesa) para establecer esta opción mediante programación.</span><span class="sxs-lookup"><span data-stu-id="aa8db-137">Use the [**RasGetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rasgetentrypropertiesa) and [**RasSetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rassetentrypropertiesa) functions to set this option programmatically.</span></span>

<span data-ttu-id="aa8db-138">**Windows XP:** Para invocar [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) desde [**rasdial**](/windows/desktop/api/Ras/nf-ras-rasdiala), la llamada a **rasdial** debe especificar una estructura [**RASDIALEXTENSIONS**](/previous-versions/windows/desktop/legacy/aa377029(v=vs.85)) y esta estructura debe especificar la \_ marca RDEOPT UseCustomScripting.</span><span class="sxs-lookup"><span data-stu-id="aa8db-138">**Windows XP:** To invoke [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) from [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala), the call to **RasDial** must specify a [**RASDIALEXTENSIONS**](/previous-versions/windows/desktop/legacy/aa377029(v=vs.85)) structure, and this structure must specify the RDEOPT\_UseCustomScripting flag.</span></span> <span data-ttu-id="aa8db-139">Además, la entrada de la libreta de teléfonos para la conexión debe especificar la \_ opción RASEO CustomScript, tal como se describe en el párrafo anterior.</span><span class="sxs-lookup"><span data-stu-id="aa8db-139">In addition, the phone-book entry for the connection must specify the RASEO\_CustomScript option as described in the preceding paragraph.</span></span>

## <a name="invoking-the-custom-scripting-dll"></a><span data-ttu-id="aa8db-140">Invocar el archivo DLL de scripting personalizado</span><span class="sxs-lookup"><span data-stu-id="aa8db-140">Invoking the Custom Scripting DLL</span></span>

<span data-ttu-id="aa8db-141">Si el usuario activa una conexión para una entrada de libreta de teléfonos que tiene RASEO \_ CustomScript establecido, Ras invoca el archivo dll de scripting personalizado.</span><span class="sxs-lookup"><span data-stu-id="aa8db-141">If the user activates a connection for a phone-book entry that has RASEO\_CustomScript set, RAS invokes the custom-scripting DLL.</span></span> <span data-ttu-id="aa8db-142">En este escenario, RAS invoca la DLL de scripting personalizado desde [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga).</span><span class="sxs-lookup"><span data-stu-id="aa8db-142">In this scenario, RAS invokes the custom-scripting DLL from [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga).</span></span>

<span data-ttu-id="aa8db-143">Para invocar el archivo DLL de scripts personalizados mediante programación, establezca la conexión con la función [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga) .</span><span class="sxs-lookup"><span data-stu-id="aa8db-143">To invoke the custom-scripting DLL programmatically, establish the connection using the [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga) function.</span></span> <span data-ttu-id="aa8db-144">En Windows XP, la función [**rasdial**](/windows/desktop/api/Ras/nf-ras-rasdiala) también invoca el archivo dll de scripting personalizado.</span><span class="sxs-lookup"><span data-stu-id="aa8db-144">On Windows XP, the [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) function also invokes the custom-scripting DLL.</span></span>

 

 