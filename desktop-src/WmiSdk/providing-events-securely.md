---
description: Puede impedir que usuarios no autorizados reciban eventos a los que no deberían tener acceso.
ms.assetid: 59788643-f57d-458f-91ab-26552218523b
ms.tgt_platform: multiple
title: Proporcionar eventos de forma segura
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d2c92ed1de08dde4891365440f559544a0b26de5
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "104278206"
---
# <a name="providing-events-securely"></a><span data-ttu-id="28d73-103">Proporcionar eventos de forma segura</span><span class="sxs-lookup"><span data-stu-id="28d73-103">Providing Events Securely</span></span>

<span data-ttu-id="28d73-104">Puede impedir que usuarios no autorizados reciban eventos a los que no deberían tener acceso.</span><span class="sxs-lookup"><span data-stu-id="28d73-104">You can prevent unauthorized users from receiving events to which they should not have access.</span></span> <span data-ttu-id="28d73-105">El proveedor de eventos puede proporcionar instancias de sus propias clases de eventos, del mismo modo que el [proveedor del registro del sistema](/previous-versions/windows/desktop/regprov/system-registry-provider) proporciona clases como [**RegistryKeyChangeEvent**](/previous-versions/windows/desktop/regprov/registrykeychangeevent).</span><span class="sxs-lookup"><span data-stu-id="28d73-105">Your event provider can supply instances of its own event classes, just as the [System Registry Provider](/previous-versions/windows/desktop/regprov/system-registry-provider) supplies classes such as [**RegistryKeyChangeEvent**](/previous-versions/windows/desktop/regprov/registrykeychangeevent).</span></span> <span data-ttu-id="28d73-106">El proveedor de eventos también puede ofrecer eventos intrínsecos como [**\_ \_ InstanceCreationEvent**](--instancecreationevent.md).</span><span class="sxs-lookup"><span data-stu-id="28d73-106">Your event provider can also deliver intrinsic events such as [**\_\_InstanceCreationEvent**](--instancecreationevent.md).</span></span> <span data-ttu-id="28d73-107">Para obtener más información, consulte [escribir un proveedor de eventos](writing-an-event-provider.md).</span><span class="sxs-lookup"><span data-stu-id="28d73-107">For more information, see [Writing an Event Provider](writing-an-event-provider.md).</span></span>

<span data-ttu-id="28d73-108">Un proveedor de eventos puede controlar el acceso a los destinatarios de eventos de las siguientes maneras:</span><span class="sxs-lookup"><span data-stu-id="28d73-108">An event provider can control access to event recipients in the following ways:</span></span>

-   <span data-ttu-id="28d73-109">El uso del control de acceso mediante la implementación de [**IWbemEventProviderSecurity:: AccessCheck**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovidersecurity) es la manera más eficaz.</span><span class="sxs-lookup"><span data-stu-id="28d73-109">Using access control by implementing [**IWbemEventProviderSecurity::AccessCheck**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovidersecurity) is the most efficient way.</span></span>

    <span data-ttu-id="28d73-110">El proveedor determina si el consumidor tiene privilegios para recibir un evento solicitado.</span><span class="sxs-lookup"><span data-stu-id="28d73-110">The provider determines whether the consumer has privileges to receive a requested event.</span></span> <span data-ttu-id="28d73-111">Si el consumidor no tiene suficientes privilegios para registrarse, WMI devuelve un error de acceso denegado.</span><span class="sxs-lookup"><span data-stu-id="28d73-111">If the consumer lacks sufficient privileges to register, WMI returns an access denied error.</span></span> <span data-ttu-id="28d73-112">Utilice este modo cuando el proveedor pueda tomar la decisión sobre quién puede recibir eventos.</span><span class="sxs-lookup"><span data-stu-id="28d73-112">Use this mode when the provider can make the decision about who can receive events.</span></span> <span data-ttu-id="28d73-113">Por ejemplo, un proveedor puede proporcionar eventos relacionados con la seguridad y puede requerir que el consumidor tenga privilegios de administrador con el privilegio **SeSecurityPrivilege** habilitado.</span><span class="sxs-lookup"><span data-stu-id="28d73-113">For example, a provider may supply security related events and can require that the consumer have administrator privileges with the **SeSecurityPrivilege** privilege enabled.</span></span>

-   <span data-ttu-id="28d73-114">La implementación de [**IWbemEventSink:: SetSinkSecurity**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventsink-setsinksecurity) en el receptor usado para generar eventos permite configurar un descriptor de seguridad (SD) en un receptor para todos los eventos que pasan a través.</span><span class="sxs-lookup"><span data-stu-id="28d73-114">Implementing [**IWbemEventSink::SetSinkSecurity**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventsink-setsinksecurity) on the sink used to raise events allows the setting of a security descriptor (SD) on a sink for all the events passing through.</span></span>

    <span data-ttu-id="28d73-115">WMI realiza comprobaciones de acceso basadas en SD.</span><span class="sxs-lookup"><span data-stu-id="28d73-115">WMI performs access checks based on the SD.</span></span> <span data-ttu-id="28d73-116">Utilice este modo cuando el proveedor no pueda tomar la decisión con respecto a quién tiene permiso para consumir sus eventos, pero puede decidir en un SD para un receptor específico.</span><span class="sxs-lookup"><span data-stu-id="28d73-116">Use this mode when the provider cannot make the decision regarding who is allowed to consume its events, but can decide on an SD for a specific sink.</span></span> <span data-ttu-id="28d73-117">Por ejemplo, use [**IWbemEventSink:: SetSinkSecurity**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventsink-setsinksecurity) si el proveedor de eventos obtuvo varios receptores mediante llamadas a [**IWbemEventSink:: GetRestrictedSink**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventsink-getrestrictedsink) y desea un descriptor de seguridad para cada receptor.</span><span class="sxs-lookup"><span data-stu-id="28d73-117">For example, use [**IWbemEventSink::SetSinkSecurity**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventsink-setsinksecurity) if your event provider obtained several sinks by calls to [**IWbemEventSink::GetRestrictedSink**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventsink-getrestrictedsink) and you want a security descriptor for each sink.</span></span>

-   <span data-ttu-id="28d73-118">El establecimiento de la propiedad **\_ descriptor de seguridad** de un evento permite la configuración de un SD para cada evento.</span><span class="sxs-lookup"><span data-stu-id="28d73-118">Setting the **SECURITY\_DESCRIPTOR** property of an event allows for the setting of an SD for each event.</span></span>

    <span data-ttu-id="28d73-119">Utilice este enfoque cuando cada evento entregado al receptor puede tener distintos descriptores de seguridad.</span><span class="sxs-lookup"><span data-stu-id="28d73-119">Use this approach when each event delivered to the sink can have different security descriptors.</span></span> <span data-ttu-id="28d73-120">Para usar este enfoque, derive cualquiera de las clases de eventos extrínsecos definidas por el proveedor de [**\_ \_ Event**](--event.md) o [**\_ \_ ExtrinsicEvent**](--extrinsicevent.md) , de modo que la clase contenga la propiedad del **\_ descriptor de seguridad** .</span><span class="sxs-lookup"><span data-stu-id="28d73-120">To use this approach, derive any of the extrinsic event classes defined by your provider from [**\_\_Event**](--event.md) or [**\_\_ExtrinsicEvent**](--extrinsicevent.md) so that your class contains the **SECURITY\_DESCRIPTOR** property.</span></span> <span data-ttu-id="28d73-121">Por ejemplo, el proveedor de eventos puede publicar eventos seguros y normales a través de un receptor.</span><span class="sxs-lookup"><span data-stu-id="28d73-121">For example, your event provider may publish both secure and normal events through a sink.</span></span> <span data-ttu-id="28d73-122">En este caso, utilice el descriptor de seguridad de la cuenta de administradores para eventos seguros y un descriptor de seguridad **null** para los eventos normales que puede recibir cualquier usuario.</span><span class="sxs-lookup"><span data-stu-id="28d73-122">In this case, use the Administrators account security descriptor for secure events and a **NULL** security descriptor for normal events that can be received by anyone.</span></span>

## <a name="securing-events-by-decoupled-event-providers"></a><span data-ttu-id="28d73-123">Protección de eventos por parte de proveedores de eventos desacoplados</span><span class="sxs-lookup"><span data-stu-id="28d73-123">Securing Events by Decoupled Event Providers</span></span>

<span data-ttu-id="28d73-124">Los proveedores de eventos desacoplados difieren de los proveedores de eventos nondecoupled en la forma en que se registran en WMI.</span><span class="sxs-lookup"><span data-stu-id="28d73-124">Decoupled event providers differ from nondecoupled event providers in the way that they register with WMI.</span></span> <span data-ttu-id="28d73-125">La llamada a [**IWbemEventProviderSecurity:: AccessCheck**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventprovidersecurity-accesscheck) para eventos de un proveedor desacoplado nunca propaga el token de acceso de cliente.</span><span class="sxs-lookup"><span data-stu-id="28d73-125">The call to [**IWbemEventProviderSecurity::AccessCheck**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventprovidersecurity-accesscheck) for events from a decoupled provider never propagates the client access token.</span></span> <span data-ttu-id="28d73-126">WMI controla el control de acceso de la misma manera que para los proveedores de eventos nondecoupled.</span><span class="sxs-lookup"><span data-stu-id="28d73-126">WMI handles the access control in the same manner as for nondecoupled event providers.</span></span> <span data-ttu-id="28d73-127">Para obtener más información sobre cómo escribir un proveedor desacoplado, vea [incorporación de un proveedor en una aplicación](incorporating-a-provider-in-an-application.md).</span><span class="sxs-lookup"><span data-stu-id="28d73-127">For more information about writing a decoupled provider, see [Incorporating a Provider in an Application](incorporating-a-provider-in-an-application.md).</span></span>

<span data-ttu-id="28d73-128">Solo los administradores con el privilegio de **\_ escritura completo** establecido en el **control WMI** del **Panel de control** pueden generar eventos para un espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="28d73-128">Only administrators with the **FULL\_WRITE** privilege set in **WMI Control** of the **Control Panel** are allowed to raise events for a namespace.</span></span> <span data-ttu-id="28d73-129">Para obtener más información, vea [establecer la seguridad del espacio de nombres con el control WMI](setting-namespace-security-with-the-wmi-control.md).</span><span class="sxs-lookup"><span data-stu-id="28d73-129">For more information, see [Setting Namespace Security with the WMI Control](setting-namespace-security-with-the-wmi-control.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="28d73-130">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="28d73-130">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="28d73-131">Proteger eventos WMI</span><span class="sxs-lookup"><span data-stu-id="28d73-131">Securing WMI Events</span></span>](securing-wmi-events.md)
</dt> </dl>

 

 
