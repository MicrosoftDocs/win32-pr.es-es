---
title: Opciones de Bluetooth y socket
description: Bluetooth para Windows admite las siguientes opciones de socket.
ms.assetid: e2e305c2-e749-4566-8e24-c07a7a29c612
keywords:
- Bluetooth y opciones de Socket Bluetooth
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 84040a98c3dae1fec292e4f0a7086f11d1ee546c
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "103995344"
---
# <a name="bluetooth-and-socket-options"></a><span data-ttu-id="c2cf4-104">Opciones de Bluetooth y socket</span><span class="sxs-lookup"><span data-stu-id="c2cf4-104">Bluetooth and Socket Options</span></span>

<span data-ttu-id="c2cf4-105">Bluetooth para Windows admite las siguientes opciones de socket.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-105">Bluetooth for Windows supports the following socket options.</span></span> <span data-ttu-id="c2cf4-106">Las opciones de socket se establecen y se consultan [**con las funciones de**](/windows/desktop/api/winsock/nf-winsock-setsockopt) [**getsockopt**](/windows/desktop/api/winsock/nf-winsock-getsockopt) , respectivamente.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-106">Socket options are set and queried using the [**setsockopt**](/windows/desktop/api/winsock/nf-winsock-setsockopt) and [**getsockopt**](/windows/desktop/api/winsock/nf-winsock-getsockopt) functions, respectively.</span></span> <span data-ttu-id="c2cf4-107">Todas las opciones siguientes se pueden usar **con la función de la** función de la función, pero solo la opción de **\_ \_ MTU BTH** está disponible para su uso con la función **getsockopt** .</span><span class="sxs-lookup"><span data-stu-id="c2cf4-107">All of the following options can be used with the **setsockopt** function, but only the **SO\_BTH\_MTU** option is available for use with the **getsockopt** function.</span></span>

<span data-ttu-id="c2cf4-108">Se requiere la siguiente configuración para trabajar con opciones de Socket Bluetooth:</span><span class="sxs-lookup"><span data-stu-id="c2cf4-108">The following settings are required for working with Bluetooth socket options:</span></span>

-   <span data-ttu-id="c2cf4-109">El parámetro *s* debe ser un Socket Bluetooth.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-109">The *s* parameter must be a Bluetooth socket.</span></span>
-   <span data-ttu-id="c2cf4-110">El parámetro *LEVEL* debe ser **sol \_ RFCOMM**.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-110">The *level* parameter must be **SOL\_RFCOMM**.</span></span>

## <a name="so_bth_authenticate"></a><span data-ttu-id="c2cf4-111">\_BTH \_ Authenticate</span><span class="sxs-lookup"><span data-stu-id="c2cf4-111">SO\_BTH\_AUTHENTICATE</span></span>

<span data-ttu-id="c2cf4-112">En el caso de los sockets desconectados, el **\_ BTH \_ Authenticate** especifica que se requiere autenticación para que una operación de [**conexión**](/windows/desktop/api/winsock2/nf-winsock2-connect) o [**aceptación**](/windows/desktop/api/winsock2/nf-winsock2-accept) se complete correctamente.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-112">For disconnected sockets, the **SO\_BTH\_AUTHENTICATE** specifies that authentication is required for a [**connect**](/windows/desktop/api/winsock2/nf-winsock2-connect) or [**accept**](/windows/desktop/api/winsock2/nf-winsock2-accept) operation to complete successfully.</span></span> <span data-ttu-id="c2cf4-113">La configuración de esta opción de socket inicia activamente la autenticación durante el establecimiento de la conexión, si los dos dispositivos Bluetooth no se autenticaron previamente.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-113">Setting this socket option actively initiates authentication during connection establishment, if the two Bluetooth devices were not previously authenticated.</span></span> <span data-ttu-id="c2cf4-114">La interfaz de usuario para el intercambio de claves de paso, si es necesario, la proporciona el sistema operativo fuera del contexto de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-114">The user interface for passkey exchange, if necessary, is provided by the operating system outside the application context.</span></span>

<span data-ttu-id="c2cf4-115">En el caso de las conexiones salientes que requieren autenticación, se produce un error en la operación de [**conexión**](/windows/desktop/api/winsock2/nf-winsock2-connect) con **WSAEACCES** si la autenticación no se realiza correctamente.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-115">For outgoing connections that require authentication, the [**connect**](/windows/desktop/api/winsock2/nf-winsock2-connect) operation fails with **WSAEACCES** if authentication is not successful.</span></span> <span data-ttu-id="c2cf4-116">En respuesta, la aplicación puede solicitar al usuario que autentique los dos dispositivos Bluetooth antes de la conexión.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-116">In response, the application may prompt the user to authenticate the two Bluetooth devices before connection.</span></span>

<span data-ttu-id="c2cf4-117">En el caso de las conexiones entrantes, se rechaza la conexión si no se puede establecer la autenticación y se devuelve un error **WSAEHOSTDOWN** .</span><span class="sxs-lookup"><span data-stu-id="c2cf4-117">For incoming connections, the connection is rejected if authentication cannot be established and returns a **WSAEHOSTDOWN** error.</span></span> <span data-ttu-id="c2cf4-118">Para obtener más información acerca de la autenticación de dispositivos Bluetooth, consulte [**BluetoothAuthenticateDevice**](/windows/desktop/api/BluetoothAPIs/nf-bluetoothapis-bluetoothauthenticatedevice).</span><span class="sxs-lookup"><span data-stu-id="c2cf4-118">For more information about authenticating Bluetooth devices, see [**BluetoothAuthenticateDevice**](/windows/desktop/api/BluetoothAPIs/nf-bluetoothapis-bluetoothauthenticatedevice).</span></span>

<span data-ttu-id="c2cf4-119">En el caso de la opción de socket **\_ BTH \_ Authenticate** , *OPTVAL* es un puntero a ulong bAuthenticate y debe ser **true**. *optlen* es equivalente a "SIZEOF (ulong)".</span><span class="sxs-lookup"><span data-stu-id="c2cf4-119">For the **SO\_BTH\_AUTHENTICATE** socket option, *optval* is a pointer to ULONG bAuthenticate and must be **TRUE**; *optlen* is equivalent to "sizeof(ULONG)".</span></span>

<span data-ttu-id="c2cf4-120">**Windows XP con SP2: \_ BTH \_ Authenticate** inicia la autenticación para los sockets conectados y fuerza la autenticación al conectarse a los sockets no conectados.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-120">**Windows XP with SP2:  SO\_BTH\_AUTHENTICATE** starts authentication for connected sockets, and forces authentication upon connection for unconnected sockets.</span></span> <span data-ttu-id="c2cf4-121">En el caso de las conexiones entrantes, se rechaza la conexión si no se puede realizar la autenticación.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-121">For incoming connections, the connection is rejected if authentication cannot be performed.</span></span>

## <a name="so_bth_encrypt"></a><span data-ttu-id="c2cf4-122">\_BTH \_ cifrar</span><span class="sxs-lookup"><span data-stu-id="c2cf4-122">SO\_BTH\_ENCRYPT</span></span>

<span data-ttu-id="c2cf4-123">En los sockets no conectados, la **opción \_ para \_ cifrar** el socket de BTH aplica el cifrado para establecer una conexión.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-123">On unconnected sockets, the **SO\_BTH\_ENCRYPT** socket option enforces encryption to establish a connection.</span></span> <span data-ttu-id="c2cf4-124">El cifrado solo está disponible para las conexiones autenticadas.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-124">Encryption is only available for authenticated connections.</span></span> <span data-ttu-id="c2cf4-125">En el caso de las conexiones entrantes, se rechaza automáticamente una conexión para la que no se puede establecer el cifrado y se devuelve **WSAEHOSTDOWN** como el error.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-125">For incoming connections, a connection for which encryption cannot be established is automatically rejected and returns **WSAEHOSTDOWN** as the error.</span></span> <span data-ttu-id="c2cf4-126">En el caso de las conexiones salientes, se produce un error en la función [**Connect**](/windows/desktop/api/winsock2/nf-winsock2-connect) con **WSAEACCES** si no se puede establecer el cifrado.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-126">For outgoing connections, the [**connect**](/windows/desktop/api/winsock2/nf-winsock2-connect) function fails with **WSAEACCES** if encryption cannot be established.</span></span> <span data-ttu-id="c2cf4-127">En respuesta, la aplicación puede solicitar al usuario que autentique los dos dispositivos Bluetooth antes de la conexión.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-127">In response, the application may prompt the user to authenticate the two Bluetooth devices before connection.</span></span> <span data-ttu-id="c2cf4-128">Para obtener más información acerca de la autenticación de dispositivos Bluetooth, consulte [**BluetoothAuthenticateDevice**](/windows/desktop/api/BluetoothAPIs/nf-bluetoothapis-bluetoothauthenticatedevice).</span><span class="sxs-lookup"><span data-stu-id="c2cf4-128">For more information about authenticating Bluetooth devices, see [**BluetoothAuthenticateDevice**](/windows/desktop/api/BluetoothAPIs/nf-bluetoothapis-bluetoothauthenticatedevice).</span></span>

<span data-ttu-id="c2cf4-129">Para la \_ opción de BTH \_ cifrar socket, *optval* es un puntero a ulong **bEncrypt** y debe ser **true**. *optlen* es equivalente a SIZEOF (ulong).</span><span class="sxs-lookup"><span data-stu-id="c2cf4-129">For the SO\_BTH\_ENCRYPT socket option, *optval* is a pointer to ULONG **bEncrypt** and must be **TRUE**; *optlen* is equivalent to sizeof(ULONG).</span></span>

<span data-ttu-id="c2cf4-130">**Windows XP con SP2:** Para un socket que está conectado y autenticado, **por lo que \_ BTH \_ Encrypt** inicia el cifrado.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-130">**Windows XP with SP2:** For a socket that is connected and authenticated, **SO\_BTH\_ENCRYPT** starts encryption.</span></span>

## <a name="so_bth_mtu"></a><span data-ttu-id="c2cf4-131">SO \_ BTH \_ MTU</span><span class="sxs-lookup"><span data-stu-id="c2cf4-131">SO\_BTH\_MTU</span></span>

<span data-ttu-id="c2cf4-132">La opción de socket de **\_ \_ MTU de BTH** es una opción avanzada que se usa principalmente para la validación.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-132">The **SO\_BTH\_MTU** socket option is an advanced option used primarily for validation.</span></span> <span data-ttu-id="c2cf4-133">La opción **so \_ BTH \_ MTU** obtiene o establece la MTU de RFCOMM predeterminada (unidad de transmisión máxima) para la negociación de la conexión a un valor distinto del valor predeterminado del protocolo RFCOMM.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-133">The **SO\_BTH\_MTU** option obtains or sets default RFCOMM MTU (maximum transmission unit) for connection negotiation to a value different than the RFCOMM protocol-default value.</span></span>

<span data-ttu-id="c2cf4-134">Dado que la MTU de RFCOMM se ve afectada por la MTU de L2CAP subyacente y los valores mínimos y máximos del protocolo y la aplicación, el valor predeterminado para la **\_ \_ MTU de BTH** es solo un punto de partida para la negociación con el elemento remoto del mismo nivel, y es probable que la MTU negociada final varíe del valor predeterminado.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-134">Because RFCOMM MTU is affected by the underlying L2CAP MTU, and protocol and application minimums and maximums, the default value for **SO\_BTH\_MTU** is only a starting point for negotiation with the remote peer, and the final negotiated MTU is likely to vary from the default.</span></span> <span data-ttu-id="c2cf4-135">Establecer el valor de **\_ \_ MTU de SO BTH** puede afectar negativamente al rendimiento y, como tal, se debe realizar cualquier modificación con conocimiento del protocolo Bluetooth subyacente.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-135">Setting the **SO\_BTH\_MTU** value may negatively affect throughput, and as such, any modification should be performed with knowledge of the underlying Bluetooth protocol.</span></span>

<span data-ttu-id="c2cf4-136">La opción de socket **\_ \_ MTU de BTH** se puede realizar en sockets conectados, pero no tiene ningún efecto si la negociación ya se ha completado.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-136">The **SO\_BTH\_MTU** socket option can be performed on connected sockets, but has no effect if the negotiation has already completed.</span></span> <span data-ttu-id="c2cf4-137">Su configuración en el socket de escucha (servidor) no tiene ningún efecto.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-137">Setting it on the listening (server) socket has no effect.</span></span>

<span data-ttu-id="c2cf4-138">La cantidad de datos que una aplicación puede enviar o recibir en una sola llamada de Socket no se ve afectada por la MTU; La MTU solo afecta al modo en que el proveedor de servicios de Windows Sockets subyacente segmenta los paquetes para el transporte.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-138">The amount of data that an application can send or receive in a single socket call is not affected by the MTU; MTU only affects how the underlying Windows Sockets service provider segments packets for transport.</span></span> <span data-ttu-id="c2cf4-139">Tanto la MTU propuesta como la MTU que se negocia en última instancia deben estar entre la MTU **mínima de RFCOMM \_ \_** y la MTU **máxima de RFCOMM \_ \_**, tal como se define en el archivo de encabezado Ws2bth. h.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-139">Both the proposed MTU and the MTU ultimately negotiated must be between **RFCOMM\_MIN\_MTU** and **RFCOMM\_MAX\_MTU**, as defined in the Ws2bth.h header file.</span></span>

<span data-ttu-id="c2cf4-140">Para la opción de socket de **\_ \_ MTU de BTH** , *optval* es un puntero a la MTU de ulong; *optlen* es equivalente a "SIZEOF (ulong)".</span><span class="sxs-lookup"><span data-stu-id="c2cf4-140">For the **SO\_BTH\_MTU** socket option, *optval* is a pointer to ULONG mtu; *optlen* is equivalent to "sizeof(ULONG)".</span></span>

## <a name="so_bth_mtu_max"></a><span data-ttu-id="c2cf4-141">SO \_ BTH \_ MTU \_ máx.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-141">SO\_BTH\_MTU\_MAX</span></span>

<span data-ttu-id="c2cf4-142">La opción de socket **\_ BTH \_ MTU \_ Max** es una opción avanzada que se usa principalmente para la validación.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-142">The **SO\_BTH\_MTU\_MAX** socket option is an advanced option used primarily for validation.</span></span> <span data-ttu-id="c2cf4-143">La opción de socket **\_ BTH \_ MTU \_ Max** establece la MTU máxima (unidad de transmisión máxima) de RFCOMM para la negociación de la conexión.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-143">The **SO\_BTH\_MTU\_MAX** socket option sets the maximum RFCOMM MTU (maximum transmission unit) for connection negotiation.</span></span> <span data-ttu-id="c2cf4-144">Las conexiones con una MTU de RFCOMM igual o mayor que este valor producen un error durante el proceso de aceptación de [**conexión**](/windows/desktop/api/winsock2/nf-winsock2-connect) / [](/windows/desktop/api/winsock2/nf-winsock2-accept) .</span><span class="sxs-lookup"><span data-stu-id="c2cf4-144">Connections with an RFCOMM MTU equal to or greater than this value fail during the [**connect**](/windows/desktop/api/winsock2/nf-winsock2-connect)/[**accept**](/windows/desktop/api/winsock2/nf-winsock2-accept) process.</span></span> <span data-ttu-id="c2cf4-145">Aunque se permite establecer esta opción de socket para un socket conectado, no tiene ningún efecto si se ha completado la negociación.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-145">While setting this socket option is allowed for a connected socket, it has no effect if the negotiation has completed.</span></span> <span data-ttu-id="c2cf4-146">Al establecer esta opción de socket en un socket de escucha, se propaga el valor de todas las conexiones entrantes.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-146">Setting this socket option on a listening socket propagates the value for all incoming connections.</span></span> <span data-ttu-id="c2cf4-147">El valor de MTU máximo debe estar entre la MTU **mínima de RFCOMM \_ \_** y la **\_ \_ MTU máxima de RFCOMM**, tal como se define en el archivo de encabezado Ws2bth. h.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-147">The MAX MTU value must be between **RFCOMM\_MIN\_MTU** and **RFCOMM\_MAX\_MTU**, as defined in the Ws2bth.h header file.</span></span>

<span data-ttu-id="c2cf4-148">En el caso de la opción de socket **\_ BTH \_ MTU \_ Max** , *optval* es un puntero a la MTU Max Max \_ ; *optlen* es equivalente a "SIZEOF (ulong)".</span><span class="sxs-lookup"><span data-stu-id="c2cf4-148">For the **SO\_BTH\_MTU\_MAX** socket option, *optval* is a pointer to ULONG max\_mtu; *optlen* is equivalent to "sizeof(ULONG)".</span></span>

## <a name="so_bth_mtu_min"></a><span data-ttu-id="c2cf4-149">SO \_ BTH \_ MTU \_ min</span><span class="sxs-lookup"><span data-stu-id="c2cf4-149">SO\_BTH\_MTU\_MIN</span></span>

<span data-ttu-id="c2cf4-150">La opción de socket **\_ min de \_ MTU \_ de BTH** es una opción avanzada que se usa principalmente para la validación.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-150">The **SO\_BTH\_MTU\_MIN** socket option is an advanced option used primarily for validation.</span></span> <span data-ttu-id="c2cf4-151">La opción de socket **\_ min de \_ MTU \_ de BTH** establece la MTU mínima de RFCOMM (unidad de transmisión máxima) para la negociación de la conexión.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-151">The **SO\_BTH\_MTU\_MIN** socket option sets the minimum RFCOMM MTU (maximum transmission unit) for connection negotiation.</span></span> <span data-ttu-id="c2cf4-152">Las conexiones con una MTU de RFCOMM menor que este valor producen un error durante el proceso de aceptación de [**conexión**](/windows/desktop/api/winsock2/nf-winsock2-connect) / [](/windows/desktop/api/winsock2/nf-winsock2-accept) .</span><span class="sxs-lookup"><span data-stu-id="c2cf4-152">Connections with an RFCOMM MTU smaller than this value fail during the [**connect**](/windows/desktop/api/winsock2/nf-winsock2-connect)/[**accept**](/windows/desktop/api/winsock2/nf-winsock2-accept) process.</span></span> <span data-ttu-id="c2cf4-153">Aunque se permite establecer esta opción de socket para un socket conectado, no tiene ningún efecto si se ha completado la negociación.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-153">While setting this socket option is allowed for a connected socket, it has no effect if the negotiation has completed.</span></span> <span data-ttu-id="c2cf4-154">Al establecer esta opción de socket en un socket de escucha, se propaga el valor de todas las conexiones entrantes.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-154">Setting this socket option on a listening socket propagates the value for all incoming connections.</span></span>

<span data-ttu-id="c2cf4-155">Solo un socket de escucha puede revisar la MTU hacia abajo, por lo que si el valor propuesto por el socket que se conecta es menor que el valor establecido para, por **lo que \_ BTH \_ MTU \_ min** en el socket de escucha, se rechaza la conexión.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-155">Only a listening socket can revise the MTU downward, therefore if the value proposed by the connecting socket is less than the value set for **SO\_BTH\_MTU\_MIN** on the listening socket, the connection is refused.</span></span> <span data-ttu-id="c2cf4-156">La MTU mínima debe estar entre la MTU mínima de **RFCOMM \_ \_** y la **\_ \_ MTU máxima de RFCOMM**, tal como se define en el archivo de encabezado Ws2bth. h.</span><span class="sxs-lookup"><span data-stu-id="c2cf4-156">The minimum MTU must be between **RFCOMM\_MIN\_MTU** and **RFCOMM\_MAX\_MTU**, as defined in the Ws2bth.h header file.</span></span>

<span data-ttu-id="c2cf4-157">En la \_ opción de BTH \_ MTU \_ min socket, *optval* es un puntero a ulong min \_ MTU; *optlen* es equivalente a "SIZEOF (ulong)".</span><span class="sxs-lookup"><span data-stu-id="c2cf4-157">For the SO\_BTH\_MTU\_MIN socket option, *optval* is a pointer to ULONG min\_mtu; *optlen* is equivalent to "sizeof(ULONG)".</span></span>

## <a name="related-topics"></a><span data-ttu-id="c2cf4-158">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="c2cf4-158">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c2cf4-159">Windows Sockets</span><span class="sxs-lookup"><span data-stu-id="c2cf4-159">Windows Sockets</span></span>](/windows/desktop/WinSock/windows-sockets-start-page-2)
</dt> <dt>

[<span data-ttu-id="c2cf4-160">**getsockopt**</span><span class="sxs-lookup"><span data-stu-id="c2cf4-160">**getsockopt**</span></span>](/windows/desktop/api/winsock/nf-winsock-getsockopt)
</dt> <dt>

[<span data-ttu-id="c2cf4-161">**setsockopt**</span><span class="sxs-lookup"><span data-stu-id="c2cf4-161">**setsockopt**</span></span>](/windows/desktop/api/winsock/nf-winsock-setsockopt)
</dt> <dt>

[<span data-ttu-id="c2cf4-162">**BluetoothAuthenticateDevice**</span><span class="sxs-lookup"><span data-stu-id="c2cf4-162">**BluetoothAuthenticateDevice**</span></span>](/windows/desktop/api/BluetoothAPIs/nf-bluetoothapis-bluetoothauthenticatedevice)
</dt> <dt>

[<span data-ttu-id="c2cf4-163">**conéctelo**</span><span class="sxs-lookup"><span data-stu-id="c2cf4-163">**connect**</span></span>](/windows/desktop/api/winsock2/nf-winsock2-connect)
</dt> <dt>

[<span data-ttu-id="c2cf4-164">**acept**</span><span class="sxs-lookup"><span data-stu-id="c2cf4-164">**accept**</span></span>](/windows/desktop/api/winsock2/nf-winsock2-accept)
</dt> </dl>

 

 