---
title: Acerca de Intercambio dinámico de datos
description: En este tema se describe la transferencia de datos entre aplicaciones.
ms.assetid: 0bcd8de4-a6f0-4f2a-8b9d-0b1b638925fb
keywords:
- Intercambio dinámico de datos (DDE), acerca de
- DDE (Intercambio dinámico de datos), acerca de
- intercambio de datos, Intercambio dinámico de datos (DDE)
- Intercambio dinámico de datos (DDE), vincular a datos en tiempo real
- DDE (Intercambio dinámico de datos), vincular a datos en tiempo real
- Intercambio dinámico de datos (DDE), crear documentos compuestos
- DDE (Intercambio dinámico de datos), crear documentos compuestos
- Intercambio dinámico de datos (DDE), consultas de datos
- DDE (Intercambio dinámico de datos), consultas de datos
- Intercambio dinámico de datos (DDE), ejemplos
- DDE (Intercambio dinámico de datos), ejemplos
- Intercambio dinámico de datos (DDE), suplantación
- DDE (Intercambio dinámico de datos), suplantación
- Intercambio dinámico de datos (DDE), mensajes
- DDE (Intercambio dinámico de datos), mensajes
- Intercambio dinámico de datos (DDE), átomos
- DDE (Intercambio dinámico de datos), átomos
- Intercambio dinámico de datos (DDE), objetos de memoria compartida
- DDE (Intercambio dinámico de datos), objetos de memoria compartida
- Intercambio dinámico de datos (DDE), funciones de empaquetado de parámetros
- DDE (Intercambio dinámico de datos), funciones de empaquetado de parámetros
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7d38574e9182255e8f6761520aea60575d8affbc
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104421213"
---
# <a name="about-dynamic-data-exchange"></a><span data-ttu-id="a474b-124">Acerca de Intercambio dinámico de datos</span><span class="sxs-lookup"><span data-stu-id="a474b-124">About Dynamic Data Exchange</span></span>

<span data-ttu-id="a474b-125">Windows proporciona varios métodos para transferir datos entre aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="a474b-125">Windows provides several methods for transferring data between applications.</span></span> <span data-ttu-id="a474b-126">Un método es usar el protocolo Intercambio dinámico de datos (DDE).</span><span class="sxs-lookup"><span data-stu-id="a474b-126">One method is to use the Dynamic Data Exchange (DDE) protocol.</span></span> <span data-ttu-id="a474b-127">El protocolo DDE es un conjunto de mensajes e instrucciones.</span><span class="sxs-lookup"><span data-stu-id="a474b-127">The DDE protocol is a set of messages and guidelines.</span></span> <span data-ttu-id="a474b-128">Envía mensajes entre aplicaciones que comparten datos y usa la memoria compartida para intercambiar datos entre aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="a474b-128">It sends messages between applications that share data and uses shared memory to exchange data between applications.</span></span> <span data-ttu-id="a474b-129">Las aplicaciones pueden usar el protocolo DDE para las transferencias de datos de un solo uso y para los intercambios continuos en los que las aplicaciones envían actualizaciones entre sí a medida que hay nuevos datos disponibles.</span><span class="sxs-lookup"><span data-stu-id="a474b-129">Applications can use the DDE protocol for one-time data transfers and for continuous exchanges in which applications send updates to one another as new data becomes available.</span></span>

<span data-ttu-id="a474b-130">Windows también es compatible con la biblioteca de administración de Intercambio dinámico de datos (DDEML).</span><span class="sxs-lookup"><span data-stu-id="a474b-130">Windows also supports the Dynamic Data Exchange Management Library (DDEML).</span></span> <span data-ttu-id="a474b-131">El archivo DDEML es una biblioteca de vínculos dinámicos (DLL) que las aplicaciones pueden usar para compartir datos.</span><span class="sxs-lookup"><span data-stu-id="a474b-131">The DDEML is a dynamic-link library (DLL) that applications can use to share data.</span></span> <span data-ttu-id="a474b-132">DDEML proporciona funciones y mensajes que simplifican la tarea de agregar funcionalidad DDE a una aplicación.</span><span class="sxs-lookup"><span data-stu-id="a474b-132">The DDEML provides functions and messages that simplify the task of adding DDE capability to an application.</span></span> <span data-ttu-id="a474b-133">En lugar de enviar, publicar y procesar directamente los mensajes DDE, una aplicación utiliza las funciones DDEML para administrar las conversaciones DDE.</span><span class="sxs-lookup"><span data-stu-id="a474b-133">Instead of sending, posting, and processing DDE messages directly, an application uses the DDEML functions to manage DDE conversations.</span></span> <span data-ttu-id="a474b-134">(Una conversación DDE es la interacción entre las aplicaciones cliente y servidor).</span><span class="sxs-lookup"><span data-stu-id="a474b-134">(A DDE conversation is the interaction between client and server applications.)</span></span>

<span data-ttu-id="a474b-135">DDEML también proporciona una utilidad para administrar las cadenas y los datos que comparten las aplicaciones DDE.</span><span class="sxs-lookup"><span data-stu-id="a474b-135">The DDEML also provides a facility for managing the strings and data that DDE applications share.</span></span> <span data-ttu-id="a474b-136">En lugar de usar átomos y punteros a objetos de memoria compartida, las aplicaciones DDE crean e intercambian los identificadores de cadena, que identifican cadenas, y los identificadores de datos, que identifican los objetos de memoria.</span><span class="sxs-lookup"><span data-stu-id="a474b-136">Instead of using atoms and pointers to shared memory objects, DDE applications create and exchange string handles, which identify strings, and data handles, which identify memory objects.</span></span> <span data-ttu-id="a474b-137">El DDEML también hace posible que una aplicación de servidor registre los nombres de servicio que admite.</span><span class="sxs-lookup"><span data-stu-id="a474b-137">The DDEML also makes it possible for a server application to register the service names it supports.</span></span> <span data-ttu-id="a474b-138">Los nombres se difunden a otras aplicaciones del sistema, que pueden usar los nombres para conectarse al servidor.</span><span class="sxs-lookup"><span data-stu-id="a474b-138">The names are broadcast to other applications in the system, which can use the names to connect to the server.</span></span> <span data-ttu-id="a474b-139">Además, el DDEML garantiza la compatibilidad entre las aplicaciones DDE obligando a implementar el protocolo DDE de una manera coherente.</span><span class="sxs-lookup"><span data-stu-id="a474b-139">Moreover, the DDEML ensures compatibility among DDE applications by forcing them to implement the DDE protocol in a consistent manner.</span></span>

<span data-ttu-id="a474b-140">Las aplicaciones existentes que utilizan el protocolo DDE basado en mensajes son totalmente compatibles con las que usan DDEML.</span><span class="sxs-lookup"><span data-stu-id="a474b-140">Existing applications that use the message-based DDE protocol are fully compatible with those that use the DDEML.</span></span> <span data-ttu-id="a474b-141">Es decir, una aplicación que utiliza DDE basado en mensajes puede establecer conversaciones y realizar transacciones con aplicaciones que usan el DDEML.</span><span class="sxs-lookup"><span data-stu-id="a474b-141">That is, an application that uses message-based DDE can establish conversations and perform transactions with applications that use the DDEML.</span></span> <span data-ttu-id="a474b-142">Debido a las numerosas ventajas de DDEML, las nuevas aplicaciones deben utilizarla en lugar de los mensajes DDE.</span><span class="sxs-lookup"><span data-stu-id="a474b-142">Because of the many advantages of the DDEML, new applications should use it rather than the DDE messages.</span></span> <span data-ttu-id="a474b-143">Para usar los elementos de la API de DDEML, debe incluir el archivo de encabezado DDEML en los archivos de código fuente, vincular con la biblioteca DDEML y asegurarse de que la biblioteca de vínculos dinámicos DDEML está en la ruta de acceso de búsqueda del sistema.</span><span class="sxs-lookup"><span data-stu-id="a474b-143">To use the API elements of the DDEML, you must include the DDEML header file in your source files, link with the DDEML library, and ensure that the DDEML dynamic-link library is in the system's search path.</span></span>

<span data-ttu-id="a474b-144">Los temas siguientes se describen en esta sección.</span><span class="sxs-lookup"><span data-stu-id="a474b-144">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="a474b-145">Protocolo Intercambio dinámico de datos</span><span class="sxs-lookup"><span data-stu-id="a474b-145">Dynamic Data Exchange Protocol</span></span>](#dynamic-data-exchange-protocol)
-   [<span data-ttu-id="a474b-146">Usos de Windows Intercambio dinámico de datos</span><span class="sxs-lookup"><span data-stu-id="a474b-146">Uses for Windows Dynamic Data Exchange</span></span>](#uses-for-windows-dynamic-data-exchange)
-   [<span data-ttu-id="a474b-147">Intercambio dinámico de datos desde el punto de vista del usuario</span><span class="sxs-lookup"><span data-stu-id="a474b-147">Dynamic Data Exchange from the User's Point of View</span></span>](#dynamic-data-exchange-from-the-users-point-of-view)
-   [<span data-ttu-id="a474b-148">Conceptos de Intercambio dinámico de datos</span><span class="sxs-lookup"><span data-stu-id="a474b-148">Dynamic Data Exchange Concepts</span></span>](#dynamic-data-exchange-concepts)
    -   [<span data-ttu-id="a474b-149">Cliente, servidor y conversación</span><span class="sxs-lookup"><span data-stu-id="a474b-149">Client, Server, and Conversation</span></span>](#client-server-and-conversation)
    -   [<span data-ttu-id="a474b-150">Nombres de aplicación, tema y elemento</span><span class="sxs-lookup"><span data-stu-id="a474b-150">Application, Topic, and Item Names</span></span>](#application-topic-and-item-names)
    -   [<span data-ttu-id="a474b-151">El tema sistema</span><span class="sxs-lookup"><span data-stu-id="a474b-151">The System Topic</span></span>](#the-system-topic)
    -   [<span data-ttu-id="a474b-152">Vínculos de datos permanentes</span><span class="sxs-lookup"><span data-stu-id="a474b-152">Permanent Data Links</span></span>](#permanent-data-links)
    -   [<span data-ttu-id="a474b-153">Átomos y objetos de memoria compartida</span><span class="sxs-lookup"><span data-stu-id="a474b-153">Atoms and Shared Memory Objects</span></span>](#atoms-and-shared-memory-objects)
-   [<span data-ttu-id="a474b-154">Información general sobre mensajes de Intercambio dinámico de datos</span><span class="sxs-lookup"><span data-stu-id="a474b-154">Dynamic Data Exchange Messages Overview</span></span>](#dynamic-data-exchange-messages-overview)
-   [<span data-ttu-id="a474b-155">Intercambio dinámico de datos flujo de mensajes</span><span class="sxs-lookup"><span data-stu-id="a474b-155">Dynamic Data Exchange Message Flow</span></span>](#dynamic-data-exchange-message-flow)
-   [<span data-ttu-id="a474b-156">Funciones de empaquetado de parámetros</span><span class="sxs-lookup"><span data-stu-id="a474b-156">Parameter Packing Functions</span></span>](#parameter-packing-functions)
-   [<span data-ttu-id="a474b-157">Intercambio dinámico de datos y suplantación</span><span class="sxs-lookup"><span data-stu-id="a474b-157">Dynamic Data Exchange and Impersonation</span></span>](#dynamic-data-exchange-and-impersonation)

## <a name="dynamic-data-exchange-protocol"></a><span data-ttu-id="a474b-158">Protocolo Intercambio dinámico de datos</span><span class="sxs-lookup"><span data-stu-id="a474b-158">Dynamic Data Exchange Protocol</span></span>

<span data-ttu-id="a474b-159">Dado que Windows tiene una arquitectura basada en mensajes, el paso de mensajes es el método más adecuado para la transferencia automática de información entre aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="a474b-159">Because Windows has a message-based architecture, passing messages is the most appropriate method for automatically transferring information between applications.</span></span> <span data-ttu-id="a474b-160">Sin embargo, los mensajes contienen solo dos parámetros (*wParam* y *lParam*) para pasar datos.</span><span class="sxs-lookup"><span data-stu-id="a474b-160">However, messages contain only two parameters (*wParam* and *lParam*) for passing data.</span></span> <span data-ttu-id="a474b-161">Como resultado, estos parámetros deben hacer referencia indirectamente a otros fragmentos de datos cuando se superan algunas palabras de información entre aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="a474b-161">As a result, these parameters must refer indirectly to other pieces of data when more than a few words of information pass between applications.</span></span> <span data-ttu-id="a474b-162">El protocolo DDE define exactamente el modo en que las aplicaciones deben usar los parámetros *wParam* e *lParam* para pasar partes más grandes de datos por medio de átomos globales y controladores de memoria compartida.</span><span class="sxs-lookup"><span data-stu-id="a474b-162">The DDE protocol defines exactly how applications should use the *wParam* and *lParam* parameters to pass larger pieces of data by means of global atoms and shared memory handles.</span></span> <span data-ttu-id="a474b-163">El protocolo DDE tiene reglas específicas para asignar y eliminar átomos globales y objetos de memoria compartida.</span><span class="sxs-lookup"><span data-stu-id="a474b-163">The DDE protocol has specific rules for allocating and deleting global atoms and shared memory objects.</span></span>

<span data-ttu-id="a474b-164">Un átomo global es una referencia a una cadena de caracteres.</span><span class="sxs-lookup"><span data-stu-id="a474b-164">A global atom is a reference to a character string.</span></span> <span data-ttu-id="a474b-165">En el protocolo DDE, los átomos identifican las aplicaciones que intercambian datos, la naturaleza de los datos que se intercambian y los propios elementos de datos.</span><span class="sxs-lookup"><span data-stu-id="a474b-165">In the DDE protocol, atoms identify the applications exchanging data, the nature of the data being exchanged, and the data items themselves.</span></span> <span data-ttu-id="a474b-166">Para obtener más información acerca de los átomos, vea acerca de los [átomos](about-atom-tables.md).</span><span class="sxs-lookup"><span data-stu-id="a474b-166">For more information about atoms, see [About Atoms](about-atom-tables.md).</span></span>

## <a name="uses-for-windows-dynamic-data-exchange"></a><span data-ttu-id="a474b-167">Usos de Windows Intercambio dinámico de datos</span><span class="sxs-lookup"><span data-stu-id="a474b-167">Uses for Windows Dynamic Data Exchange</span></span>

<span data-ttu-id="a474b-168">El DDE es más adecuado para los intercambios de datos que no requieren la interacción continua del usuario.</span><span class="sxs-lookup"><span data-stu-id="a474b-168">DDE is most appropriate for data exchanges that do not require ongoing user interaction.</span></span> <span data-ttu-id="a474b-169">Normalmente, una aplicación proporciona un método para que el usuario establezca el vínculo entre las aplicaciones que intercambian datos.</span><span class="sxs-lookup"><span data-stu-id="a474b-169">Usually, an application provides a method for the user to establish the link between the applications exchanging data.</span></span> <span data-ttu-id="a474b-170">Sin embargo, una vez establecido el vínculo, las aplicaciones intercambian datos sin la intervención del usuario.</span><span class="sxs-lookup"><span data-stu-id="a474b-170">Once that link is established, however, the applications exchange data without further user involvement.</span></span>

<span data-ttu-id="a474b-171">DDE se puede usar para implementar una amplia gama de características de la aplicación, por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="a474b-171">DDE can be used to implement a broad range of application features — for example:</span></span>

-   <span data-ttu-id="a474b-172">Vinculación a datos en tiempo real, como las actualizaciones del mercado de acciones, los instrumentos científicos o el control del proceso.</span><span class="sxs-lookup"><span data-stu-id="a474b-172">Linking to real-time data, such as to stock market updates, scientific instruments, or process control.</span></span>
-   <span data-ttu-id="a474b-173">Crear documentos compuestos, como un documento de procesamiento de texto que incluye un gráfico generado por una aplicación de gráficos.</span><span class="sxs-lookup"><span data-stu-id="a474b-173">Creating compound documents, such as a word processing document that includes a chart produced by a graphics application.</span></span> <span data-ttu-id="a474b-174">Con DDE, el gráfico cambiará cuando se cambien los datos de origen, mientras que el resto del documento seguirá siendo el mismo.</span><span class="sxs-lookup"><span data-stu-id="a474b-174">Using DDE, the chart will change when the source data is changed, while the rest of the document remains the same.</span></span>
-   <span data-ttu-id="a474b-175">Realizar consultas de datos entre aplicaciones, como una hoja de cálculo que consulta una base de datos para las cuentas vencidas.</span><span class="sxs-lookup"><span data-stu-id="a474b-175">Performing data queries between applications, such as a spreadsheet querying a database for accounts past due.</span></span>

## <a name="dynamic-data-exchange-from-the-users-point-of-view"></a><span data-ttu-id="a474b-176">Intercambio dinámico de datos desde el punto de vista del usuario</span><span class="sxs-lookup"><span data-stu-id="a474b-176">Dynamic Data Exchange from the User's Point of View</span></span>

<span data-ttu-id="a474b-177">En el ejemplo siguiente se muestra cómo pueden cooperar dos aplicaciones DDE, tal como se muestra en el punto de vista del usuario.</span><span class="sxs-lookup"><span data-stu-id="a474b-177">The following example illustrates how two DDE applications can cooperate, as seen from the user's point of view.</span></span>

<span data-ttu-id="a474b-178">Un usuario de hoja de cálculo desea usar Microsoft Excel para realizar el seguimiento del precio de una acción determinada en la bolsa de valores de Nueva York.</span><span class="sxs-lookup"><span data-stu-id="a474b-178">A spreadsheet user wants to use Microsoft Excel to track the price of a particular stock on the New York Stock Exchange.</span></span> <span data-ttu-id="a474b-179">El usuario tiene una aplicación denominada quote que, a su vez, tiene acceso a los datos de NYSE.</span><span class="sxs-lookup"><span data-stu-id="a474b-179">The user has an application called Quote that in turn has access to NYSE data.</span></span> <span data-ttu-id="a474b-180">La conversación DDE entre Excel y quote tiene lugar de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="a474b-180">The DDE conversation between Excel and Quote takes place as follows:</span></span>

-   <span data-ttu-id="a474b-181">El usuario inicia la conversación proporcionando el nombre de la aplicación (oferta) que proporcionará los datos y el tema concreto de interés (NYSE).</span><span class="sxs-lookup"><span data-stu-id="a474b-181">The user initiates the conversation by supplying the name of the application (Quote) that will supply the data and the particular topic of interest (NYSE).</span></span> <span data-ttu-id="a474b-182">La conversación DDE resultante se usa para solicitar ofertas en acciones específicas.</span><span class="sxs-lookup"><span data-stu-id="a474b-182">The resulting DDE conversation is used to request quotes on specific stocks.</span></span>
-   <span data-ttu-id="a474b-183">Excel difunde los nombres de aplicación y tema a todas las aplicaciones DDE que se ejecutan actualmente en el sistema.</span><span class="sxs-lookup"><span data-stu-id="a474b-183">Excel broadcasts the application and topic names to all DDE applications currently running in the system.</span></span> <span data-ttu-id="a474b-184">La oferta responde y establece una conversación con Excel sobre el tema NYSE.</span><span class="sxs-lookup"><span data-stu-id="a474b-184">Quote responds, establishing a conversation with Excel about the NYSE topic.</span></span>
-   <span data-ttu-id="a474b-185">A continuación, el usuario puede crear una fórmula de hoja de cálculo en una celda que solicite que la hoja de cálculo se actualice automáticamente cada vez que cambie una cotización bursátil determinada.</span><span class="sxs-lookup"><span data-stu-id="a474b-185">The user can then create a spreadsheet formula in a cell that requests that the spreadsheet be automatically updated whenever a particular stock quotation changes.</span></span> <span data-ttu-id="a474b-186">Por ejemplo, el usuario podría solicitar una actualización automática cada vez que se produzca un cambio en el precio de venta de ZAXX stock especificando la siguiente fórmula de Excel: = ' quote ' \| ' NYSE '! ZAXX</span><span class="sxs-lookup"><span data-stu-id="a474b-186">For example, the user could request an automatic update whenever a change occurs in the selling price of ZAXX stock by specifying the following Excel formula: ='Quote'\|'NYSE'!ZAXX</span></span>
-   <span data-ttu-id="a474b-187">El usuario puede finalizar la actualización automática de la cotización de acciones de ZAXX en cualquier momento.</span><span class="sxs-lookup"><span data-stu-id="a474b-187">The user can terminate the automatic updating of the ZAXX stock quotation at any time.</span></span> <span data-ttu-id="a474b-188">Otros vínculos de datos que se establecieron por separado (por ejemplo, para las cotizaciones de otros materiales) seguirán estando activos en la misma conversación NYSE.</span><span class="sxs-lookup"><span data-stu-id="a474b-188">Other data links that were established separately (such as for quotations for other stocks) still will remain active under the same NYSE conversation.</span></span>
-   <span data-ttu-id="a474b-189">El usuario también puede finalizar la conversación completa entre Excel y quote en el tema NYSE, de modo que no se pueda establecer ningún vínculo de datos específico en ese tema sin iniciar una conversación nueva.</span><span class="sxs-lookup"><span data-stu-id="a474b-189">The user can also terminate the entire conversation between Excel and Quote on the NYSE topic, so that no specific data links on that topic can be established without initiating a new conversation.</span></span>

## <a name="dynamic-data-exchange-concepts"></a><span data-ttu-id="a474b-190">Conceptos de Intercambio dinámico de datos</span><span class="sxs-lookup"><span data-stu-id="a474b-190">Dynamic Data Exchange Concepts</span></span>

<span data-ttu-id="a474b-191">En las secciones siguientes se explican los conceptos y la terminología importantes que son fundamentales para comprender el intercambio dinámico de datos.</span><span class="sxs-lookup"><span data-stu-id="a474b-191">The following sections explain the important concepts and terminology that are key to understanding dynamic data exchange.</span></span>

-   [<span data-ttu-id="a474b-192">Cliente, servidor y conversación</span><span class="sxs-lookup"><span data-stu-id="a474b-192">Client, Server, and Conversation</span></span>](#client-server-and-conversation)
-   [<span data-ttu-id="a474b-193">Nombres de aplicación, tema y elemento</span><span class="sxs-lookup"><span data-stu-id="a474b-193">Application, Topic, and Item Names</span></span>](#application-topic-and-item-names)
-   [<span data-ttu-id="a474b-194">El tema sistema</span><span class="sxs-lookup"><span data-stu-id="a474b-194">The System Topic</span></span>](#the-system-topic)
-   [<span data-ttu-id="a474b-195">Vínculos de datos permanentes</span><span class="sxs-lookup"><span data-stu-id="a474b-195">Permanent Data Links</span></span>](#permanent-data-links)
-   [<span data-ttu-id="a474b-196">Átomos y objetos de memoria compartida</span><span class="sxs-lookup"><span data-stu-id="a474b-196">Atoms and Shared Memory Objects</span></span>](#atoms-and-shared-memory-objects)

### <a name="client-server-and-conversation"></a><span data-ttu-id="a474b-197">Cliente, servidor y conversación</span><span class="sxs-lookup"><span data-stu-id="a474b-197">Client, Server, and Conversation</span></span>

<span data-ttu-id="a474b-198">Se dice que dos aplicaciones que participan en DDE están dedicadas a una conversación DDE.</span><span class="sxs-lookup"><span data-stu-id="a474b-198">Two applications participating in DDE are said to be engaged in a DDE conversation.</span></span> <span data-ttu-id="a474b-199">La aplicación que inicia la conversación es la aplicación cliente DDE; la aplicación que responde al cliente es la aplicación de servidor DDE.</span><span class="sxs-lookup"><span data-stu-id="a474b-199">The application that initiates the conversation is the DDE client application; the application that responds to the client is the DDE server application.</span></span> <span data-ttu-id="a474b-200">Una aplicación puede participar en varias conversaciones al mismo tiempo, actuando como el cliente en algunos y como el servidor en otros.</span><span class="sxs-lookup"><span data-stu-id="a474b-200">An application can engage in several conversations at the same time, acting as the client in some and as the server in others.</span></span>

<span data-ttu-id="a474b-201">Una conversación DDE se realiza entre dos ventanas, una para cada una de las aplicaciones participantes.</span><span class="sxs-lookup"><span data-stu-id="a474b-201">A DDE conversation takes place between two windows, one for each of the participating applications.</span></span> <span data-ttu-id="a474b-202">Una ventana puede ser la ventana principal de la aplicación; ventana asociada a un documento concreto, como en una aplicación de interfaz de múltiples documentos (MDI). o una ventana oculta (invisible) cuyo único propósito es procesar los mensajes DDE.</span><span class="sxs-lookup"><span data-stu-id="a474b-202">A window may be the main window of the application; a window associated with a specific document, as in a multiple-document interface (MDI) application; or a hidden (invisible) window whose only purpose is to process DDE messages.</span></span>

<span data-ttu-id="a474b-203">Dado que una conversación DDE se identifica mediante el par de identificadores para las ventanas configuradas en la conversación, no se debe usar ninguna ventana en más de una conversación con otra ventana.</span><span class="sxs-lookup"><span data-stu-id="a474b-203">Since a DDE conversation is identified by the pair of handles to the windows engaged in the conversation, no window should be engaged in more than one conversation with another window.</span></span> <span data-ttu-id="a474b-204">Tanto la aplicación cliente como la aplicación de servidor deben proporcionar una ventana diferente para cada una de sus conversaciones con una aplicación de servidor o cliente determinada.</span><span class="sxs-lookup"><span data-stu-id="a474b-204">Either the client application or the server application must provide a different window for each of its conversations with a particular server or client application.</span></span>

<span data-ttu-id="a474b-205">Una aplicación puede garantizar que un par de ventanas de cliente y de servidor nunca participa en más de una conversación creando una ventana oculta para cada conversación.</span><span class="sxs-lookup"><span data-stu-id="a474b-205">An application can ensure a pair of client and server windows is never involved in more than one conversation by creating a hidden window for each conversation.</span></span> <span data-ttu-id="a474b-206">El único propósito de esta ventana es procesar los mensajes DDE.</span><span class="sxs-lookup"><span data-stu-id="a474b-206">The sole purpose of this window is to process DDE messages.</span></span>

### <a name="application-topic-and-item-names"></a><span data-ttu-id="a474b-207">Nombres de aplicación, tema y elemento</span><span class="sxs-lookup"><span data-stu-id="a474b-207">Application, Topic, and Item Names</span></span>

<span data-ttu-id="a474b-208">El protocolo DDE identifica las unidades de datos que se pasan entre el cliente y el servidor con una jerarquía de tres niveles de nombres de aplicación, tema y elemento.</span><span class="sxs-lookup"><span data-stu-id="a474b-208">The DDE protocol identifies the units of data passed between the client and server with a three-level hierarchy of application, topic, and item names.</span></span>

<span data-ttu-id="a474b-209">Cada conversación DDE se define de forma única mediante el nombre de la aplicación y el tema.</span><span class="sxs-lookup"><span data-stu-id="a474b-209">Each DDE conversation is uniquely defined by the application name and topic.</span></span> <span data-ttu-id="a474b-210">Al principio de una conversación DDE, el cliente y el servidor determinan el nombre de la aplicación y el tema.</span><span class="sxs-lookup"><span data-stu-id="a474b-210">At the beginning of a DDE conversation, the client and server determine the application name and topic.</span></span> <span data-ttu-id="a474b-211">Normalmente, el nombre de la aplicación es el nombre de la aplicación de servidor.</span><span class="sxs-lookup"><span data-stu-id="a474b-211">The application name is usually the name of the server application.</span></span> <span data-ttu-id="a474b-212">Por ejemplo, cuando Excel actúa como el servidor en una conversación, el nombre de la aplicación es Excel.</span><span class="sxs-lookup"><span data-stu-id="a474b-212">For example, when Excel acts as the server in a conversation, the application name is Excel.</span></span>

<span data-ttu-id="a474b-213">El tema DDE es una clasificación general de los datos en los que se pueden "discutir" (intercambiar) varios elementos de datos durante la conversación.</span><span class="sxs-lookup"><span data-stu-id="a474b-213">The DDE topic is a general classification of data within which multiple data items may be "discussed" (exchanged) during the conversation.</span></span> <span data-ttu-id="a474b-214">En el caso de las aplicaciones que operan en documentos basados en archivos, el tema suele ser un nombre de archivo.</span><span class="sxs-lookup"><span data-stu-id="a474b-214">For applications that operate on file-based documents, the topic is usually a filename.</span></span> <span data-ttu-id="a474b-215">Para otras aplicaciones, el tema es un nombre específico de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a474b-215">For other applications, the topic is an application-specific name.</span></span>

<span data-ttu-id="a474b-216">Dado que la ventana de cliente y de servidor se encarga de identificar conjuntamente una conversación DDE, el nombre de la aplicación y el tema que definen una conversación no se pueden cambiar durante el transcurso de la conversación.</span><span class="sxs-lookup"><span data-stu-id="a474b-216">Because the client and server window handles together identify a DDE conversation, the application name and topic that define a conversation cannot be changed during the course of the conversation.</span></span>

<span data-ttu-id="a474b-217">Un elemento de datos DDE es información relacionada con el tema de conversación intercambiado entre las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="a474b-217">A DDE data item is information related to the conversation topic exchanged between the applications.</span></span> <span data-ttu-id="a474b-218">Los valores para el elemento de datos se pueden pasar desde el servidor al cliente o desde el cliente al servidor.</span><span class="sxs-lookup"><span data-stu-id="a474b-218">Values for the data item can be passed from the server to the client, or from the client to the server.</span></span> <span data-ttu-id="a474b-219">Los datos se pueden pasar con cualquiera de los formatos de Portapapeles estándar o con un formato de Portapapeles registrado.</span><span class="sxs-lookup"><span data-stu-id="a474b-219">Data can be passed with any of the standard clipboard formats or with a registered clipboard format.</span></span> <span data-ttu-id="a474b-220">Un formato registrado especial denominado Link identifica un elemento en una conversación DDE.</span><span class="sxs-lookup"><span data-stu-id="a474b-220">A special, registered format named Link identifies an item in a DDE conversation.</span></span> <span data-ttu-id="a474b-221">Para obtener más información sobre los formatos del portapapeles, vea [portapapeles](clipboard.md).</span><span class="sxs-lookup"><span data-stu-id="a474b-221">For more information about clipboard formats, see [Clipboard](clipboard.md).</span></span>

### <a name="the-system-topic"></a><span data-ttu-id="a474b-222">El tema sistema</span><span class="sxs-lookup"><span data-stu-id="a474b-222">The System Topic</span></span>

<span data-ttu-id="a474b-223">Las aplicaciones deben admitir el tema del sistema en todo momento.</span><span class="sxs-lookup"><span data-stu-id="a474b-223">Applications should support the system topic at all times.</span></span> <span data-ttu-id="a474b-224">En este tema se proporciona un contexto para la información que puede ser de interés general para otra aplicación.</span><span class="sxs-lookup"><span data-stu-id="a474b-224">This topic provides a context for information that may be of general interest to another application.</span></span>

<span data-ttu-id="a474b-225">Los valores de los elementos de datos se deben representar en el formato del portapapeles de [**\_ texto CF**](standard-clipboard-formats.md) .</span><span class="sxs-lookup"><span data-stu-id="a474b-225">Data-item values must be rendered in the [**CF\_TEXT**](standard-clipboard-formats.md) clipboard format.</span></span> <span data-ttu-id="a474b-226">Los elementos individuales de los valores de elemento de un tema del sistema deben estar delimitados por caracteres de tabulación.</span><span class="sxs-lookup"><span data-stu-id="a474b-226">Individual elements of item values for a system topic must be delimited by tab characters.</span></span> <span data-ttu-id="a474b-227">En la tabla siguiente se sugieren algunos elementos para el tema del sistema.</span><span class="sxs-lookup"><span data-stu-id="a474b-227">The following table suggests some items for the system topic.</span></span>



| <span data-ttu-id="a474b-228">Elemento</span><span class="sxs-lookup"><span data-stu-id="a474b-228">Item</span></span>          | <span data-ttu-id="a474b-229">Descripción</span><span class="sxs-lookup"><span data-stu-id="a474b-229">Description</span></span>                                                                                                                                                                                                                                                                                             |
|---------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="a474b-230">Formatos</span><span class="sxs-lookup"><span data-stu-id="a474b-230">Formats</span></span>       | <span data-ttu-id="a474b-231">Lista delimitada por tabuladores de los formatos de Portapapeles que puede representar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a474b-231">Tab-delimited list of clipboard formats the application can render.</span></span> <span data-ttu-id="a474b-232">Normalmente, **los \_ formatos CF** se muestran con la parte "**CF \_**" de los nombres que se han quitado (por ejemplo, el **\_ texto CF** aparece como "**texto**").</span><span class="sxs-lookup"><span data-stu-id="a474b-232">Typically, **CF\_** formats are listed with the "**CF\_**" portion of the names removed (for example, **CF\_TEXT** is listed as "**TEXT**").</span></span>                                                                                        |
| <span data-ttu-id="a474b-233">Ayuda</span><span class="sxs-lookup"><span data-stu-id="a474b-233">Help</span></span>          | <span data-ttu-id="a474b-234">Texto que explica brevemente cómo usar el servidor DDE.</span><span class="sxs-lookup"><span data-stu-id="a474b-234">Text that briefly explains how to use the DDE server.</span></span>                                                                                                                                                                                                                                                   |
| <span data-ttu-id="a474b-235">ReturnMessage</span><span class="sxs-lookup"><span data-stu-id="a474b-235">ReturnMessage</span></span> | <span data-ttu-id="a474b-236">Detalles de compatibilidad del mensaje de [**confirmación de \_ DDE \_ de WM**](wm-dde-ack.md) usado más recientemente.</span><span class="sxs-lookup"><span data-stu-id="a474b-236">Supporting detail for the most recently used [**WM\_DDE\_ACK**](wm-dde-ack.md) message.</span></span> <span data-ttu-id="a474b-237">Este elemento es útil cuando se requieren más de ocho bits de datos devueltos específicos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a474b-237">This item is useful when more than eight bits of application-specific return data are required.</span></span>                                                                                                                |
| <span data-ttu-id="a474b-238">Status</span><span class="sxs-lookup"><span data-stu-id="a474b-238">Status</span></span>        | <span data-ttu-id="a474b-239">Indicación del estado actual de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a474b-239">Indication of the current status of the application.</span></span> <span data-ttu-id="a474b-240">Cuando un servidor recibe un mensaje de [**\_ \_ solicitud de DDE de WM**](wm-dde-request.md) para este elemento de tema del sistema, debe responder mediante la publicación de un mensaje de [**\_ \_ datos de WM DDE**](wm-dde-data.md) con una cadena que contiene ocupado o listo, según corresponda.</span><span class="sxs-lookup"><span data-stu-id="a474b-240">When a server receives a [**WM\_DDE\_REQUEST**](wm-dde-request.md) message for this system-topic item, it should respond by posting a [**WM\_DDE\_DATA**](wm-dde-data.md) message with a string containing either Busy or Ready, as appropriate.</span></span> |
| <span data-ttu-id="a474b-241">SysItems</span><span class="sxs-lookup"><span data-stu-id="a474b-241">SysItems</span></span>      | <span data-ttu-id="a474b-242">Lista de elementos de tema del sistema admitidos por la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a474b-242">List of system-topic items the application supports.</span></span>                                                                                                                                                                                                                                                    |
| <span data-ttu-id="a474b-243">TopicItemList</span><span class="sxs-lookup"><span data-stu-id="a474b-243">TopicItemList</span></span> | <span data-ttu-id="a474b-244">Similar al elemento SysItems, excepto que se debe admitir TopicItemList para cada tema que no sea el tema del sistema.</span><span class="sxs-lookup"><span data-stu-id="a474b-244">Similar to the SysItems item, except that TopicItemList should be supported for each topic other than the system topic.</span></span> <span data-ttu-id="a474b-245">Esto permite examinar los elementos admitidos en cualquier tema.</span><span class="sxs-lookup"><span data-stu-id="a474b-245">This allows browsing of the items supported under any topic.</span></span> <span data-ttu-id="a474b-246">Si no se pueden enumerar los elementos, este elemento solo debe contener "TopicItemList".</span><span class="sxs-lookup"><span data-stu-id="a474b-246">If the items cannot be enumerated, this item should contain only "TopicItemList".</span></span>                                  |
| <span data-ttu-id="a474b-247">Temas</span><span class="sxs-lookup"><span data-stu-id="a474b-247">Topics</span></span>        | <span data-ttu-id="a474b-248">Lista de temas que la aplicación admite en el momento actual; Esta lista puede variar de un momento a un momento.</span><span class="sxs-lookup"><span data-stu-id="a474b-248">List of topics the application supports at the current time; this list can vary from moment to moment.</span></span>                                                                                                                                                                                                  |



 

### <a name="permanent-data-links"></a><span data-ttu-id="a474b-249">Vínculos de datos permanentes</span><span class="sxs-lookup"><span data-stu-id="a474b-249">Permanent Data Links</span></span>

<span data-ttu-id="a474b-250">Una vez iniciada una conversación DDE, el cliente puede establecer uno o más vínculos de datos permanentes con el servidor.</span><span class="sxs-lookup"><span data-stu-id="a474b-250">Once a DDE conversation has begun, the client can establish one or more permanent data links with the server.</span></span> <span data-ttu-id="a474b-251">Un vínculo de datos es un mecanismo de comunicaciones por el que el servidor notifica al cliente cada vez que cambia el valor de un elemento de datos especificado.</span><span class="sxs-lookup"><span data-stu-id="a474b-251">A data link is a communications mechanism by which the server notifies the client whenever the value of a specified data item changes.</span></span> <span data-ttu-id="a474b-252">El vínculo de datos es permanente en el sentido de que este proceso de notificación continúa hasta que se terminan el vínculo de datos o la propia conversación DDE.</span><span class="sxs-lookup"><span data-stu-id="a474b-252">The data link is permanent in the sense that this notification process continues until the data link or the DDE conversation itself is terminated.</span></span>

<span data-ttu-id="a474b-253">Hay dos tipos de vínculos de datos DDE permanentes: en caliente y en caliente.</span><span class="sxs-lookup"><span data-stu-id="a474b-253">There are two kinds of permanent DDE data links: warm and hot.</span></span> <span data-ttu-id="a474b-254">En un vínculo de datos semiactivos, el servidor notifica al cliente que el valor del elemento de datos ha cambiado, pero el servidor no envía el valor de los datos al cliente hasta que el cliente lo solicita.</span><span class="sxs-lookup"><span data-stu-id="a474b-254">In a warm data link, the server notifies the client that the value of the data item has changed, but the server does not send the data value to the client until the client requests it.</span></span> <span data-ttu-id="a474b-255">En un vínculo de datos activos, el servidor envía inmediatamente el valor de los datos modificados al cliente.</span><span class="sxs-lookup"><span data-stu-id="a474b-255">In a hot data link, the server immediately sends the changed data value to the client.</span></span>

<span data-ttu-id="a474b-256">Las aplicaciones que admiten vínculos de datos semiactivos o activos normalmente proporcionan un comando **copiar** o **pegar vínculo** en el menú **edición** para permitir al usuario establecer vínculos entre las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="a474b-256">Applications that support warm or hot data links typically provide a **Copy** or **Paste Link** command in their **Edit** menu to enable the user to establish links between applications.</span></span>

### <a name="atoms-and-shared-memory-objects"></a><span data-ttu-id="a474b-257">Átomos y objetos de memoria compartida</span><span class="sxs-lookup"><span data-stu-id="a474b-257">Atoms and Shared Memory Objects</span></span>

<span data-ttu-id="a474b-258">Algunos argumentos de los mensajes DDE son los átomos globales o los objetos de memoria compartida.</span><span class="sxs-lookup"><span data-stu-id="a474b-258">Certain arguments of DDE messages are global atoms or shared memory objects.</span></span> <span data-ttu-id="a474b-259">Las aplicaciones que usan estos argumentos deben seguir las reglas explícitas sobre cuándo se deben asignar y eliminar.</span><span class="sxs-lookup"><span data-stu-id="a474b-259">Applications using these arguments must follow explicit rules about when to allocate and delete them.</span></span> <span data-ttu-id="a474b-260">En todos los casos, el remitente del mensaje debe eliminar cualquier átomo o objeto de memoria compartida que el receptor previsto no recibirá debido a una condición de error, como el error de la función [**PostMessage**](/windows/desktop/api/winuser/nf-winuser-postmessagea) .</span><span class="sxs-lookup"><span data-stu-id="a474b-260">In all cases, the message sender must delete any atom or shared memory object that the intended receiver will not receive because of an error condition, such as failure of the [**PostMessage**](/windows/desktop/api/winuser/nf-winuser-postmessagea) function.</span></span>

<span data-ttu-id="a474b-261">DDE utiliza objetos de memoria compartida para tres propósitos:</span><span class="sxs-lookup"><span data-stu-id="a474b-261">DDE uses shared memory objects for three purposes:</span></span>

-   <span data-ttu-id="a474b-262">Para llevar un valor de elemento de datos que se va a intercambiar.</span><span class="sxs-lookup"><span data-stu-id="a474b-262">To carry a data-item value to be exchanged.</span></span> <span data-ttu-id="a474b-263">Se trata de un elemento al que hace referencia el parámetro *hData* en los mensajes de [**\_ \_ datos DDE de WM**](wm-dde-data.md) y de la función de consulta de [**\_ DDE \_ de WM**](wm-dde-poke.md) .</span><span class="sxs-lookup"><span data-stu-id="a474b-263">This is an item referenced by the *hData* parameter in the [**WM\_DDE\_DATA**](wm-dde-data.md) and [**WM\_DDE\_POKE**](wm-dde-poke.md) messages.</span></span>
-   <span data-ttu-id="a474b-264">Para llevar las opciones de un mensaje.</span><span class="sxs-lookup"><span data-stu-id="a474b-264">To carry options in a message.</span></span> <span data-ttu-id="a474b-265">Se trata de un elemento al que hace referencia el parámetro *hOptions* en un mensaje de [**notificación de \_ DDE \_ de WM**](wm-dde-advise.md) .</span><span class="sxs-lookup"><span data-stu-id="a474b-265">This is an item referenced by the *hOptions* parameter in a [**WM\_DDE\_ADVISE**](wm-dde-advise.md) message.</span></span>
-   <span data-ttu-id="a474b-266">Para llevar una cadena de ejecución de comandos.</span><span class="sxs-lookup"><span data-stu-id="a474b-266">To carry a command execution string.</span></span> <span data-ttu-id="a474b-267">Se trata de un elemento al que hace referencia el parámetro *hCommands* en el mensaje de [**ejecución de WM \_ DDE \_**](wm-dde-execute.md) y su correspondiente mensaje de [**confirmación de WM \_ DDE \_**](wm-dde-ack.md) .</span><span class="sxs-lookup"><span data-stu-id="a474b-267">This is an item referenced by the *hCommands* parameter in the [**WM\_DDE\_EXECUTE**](wm-dde-execute.md) message and its corresponding [**WM\_DDE\_ACK**](wm-dde-ack.md) message.</span></span>

<span data-ttu-id="a474b-268">Una aplicación que recibe un objeto de memoria compartida DDE debe tratarla como de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="a474b-268">An application that receives a DDE shared memory object must treat it as read only.</span></span> <span data-ttu-id="a474b-269">La aplicación no debe usar el objeto como un área de lectura y escritura mutua para el intercambio de datos libre.</span><span class="sxs-lookup"><span data-stu-id="a474b-269">The application must not use the object as a mutual read-write area for the free exchange of data.</span></span>

<span data-ttu-id="a474b-270">Como en el caso de un átomo DDE, una aplicación debe liberar un objeto de memoria compartida para administrar la memoria de forma eficaz.</span><span class="sxs-lookup"><span data-stu-id="a474b-270">As it does with a DDE atom, an application should free a shared memory object to manage memory effectively.</span></span> <span data-ttu-id="a474b-271">La aplicación también debe bloquear y desbloquear los objetos de memoria.</span><span class="sxs-lookup"><span data-stu-id="a474b-271">The application should also lock and unlock memory objects.</span></span>

## <a name="dynamic-data-exchange-messages-overview"></a><span data-ttu-id="a474b-272">Información general sobre mensajes de Intercambio dinámico de datos</span><span class="sxs-lookup"><span data-stu-id="a474b-272">Dynamic Data Exchange Messages Overview</span></span>

<span data-ttu-id="a474b-273">Dado que DDE es un protocolo basado en mensajes, no se emplean funciones o bibliotecas.</span><span class="sxs-lookup"><span data-stu-id="a474b-273">Because DDE is a message-based protocol, it employs no functions or libraries.</span></span> <span data-ttu-id="a474b-274">Todas las transacciones DDE se llevan a cabo pasando algunos mensajes DDE definidos entre las ventanas cliente y servidor.</span><span class="sxs-lookup"><span data-stu-id="a474b-274">All DDE transactions are conducted by passing certain defined DDE messages between the client and server windows.</span></span>

<span data-ttu-id="a474b-275">Hay nueve mensajes DDE; las constantes simbólicas de estos mensajes se definen en el archivo de encabezado DDE.</span><span class="sxs-lookup"><span data-stu-id="a474b-275">There are nine DDE messages; the symbolic constants for these messages are defined in the DDE header file.</span></span> <span data-ttu-id="a474b-276">También se definen ciertas estructuras para los distintos mensajes DDE en este archivo de encabezado.</span><span class="sxs-lookup"><span data-stu-id="a474b-276">Certain structures for the various DDE messages are also defined in this header file.</span></span>

<span data-ttu-id="a474b-277">En la tabla siguiente se resumen los mensajes DDE.</span><span class="sxs-lookup"><span data-stu-id="a474b-277">The following table summarizes the DDE messages.</span></span>



| <span data-ttu-id="a474b-278">Message</span><span class="sxs-lookup"><span data-stu-id="a474b-278">Message</span></span>                                        | <span data-ttu-id="a474b-279">Descripción</span><span class="sxs-lookup"><span data-stu-id="a474b-279">Description</span></span>                                                                                                                                      |
|------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="a474b-280">**\_confirmación de DDE de WM \_**</span><span class="sxs-lookup"><span data-stu-id="a474b-280">**WM\_DDE\_ACK**</span></span>](wm-dde-ack.md)             | <span data-ttu-id="a474b-281">Confirma la recepción o no recepción de un mensaje.</span><span class="sxs-lookup"><span data-stu-id="a474b-281">Acknowledges receiving or not receiving a message.</span></span>                                                                                               |
| [<span data-ttu-id="a474b-282">**\_aviso de DDE de WM \_**</span><span class="sxs-lookup"><span data-stu-id="a474b-282">**WM\_DDE\_ADVISE**</span></span>](wm-dde-advise.md)       | <span data-ttu-id="a474b-283">Solicita a la aplicación de servidor que proporcione una actualización o notificación para un elemento de datos cada vez que cambie.</span><span class="sxs-lookup"><span data-stu-id="a474b-283">Requests the server application to supply an update or notification for a data item whenever it changes.</span></span> <span data-ttu-id="a474b-284">Esto establece un vínculo de datos permanente.</span><span class="sxs-lookup"><span data-stu-id="a474b-284">This establishes a permanent data link.</span></span> |
| [<span data-ttu-id="a474b-285">**\_datos DDE de WM \_**</span><span class="sxs-lookup"><span data-stu-id="a474b-285">**WM\_DDE\_DATA**</span></span>](wm-dde-data.md)           | <span data-ttu-id="a474b-286">Envía un valor de elemento de datos a la aplicación cliente.</span><span class="sxs-lookup"><span data-stu-id="a474b-286">Sends a data-item value to the client application.</span></span>                                                                                               |
| [<span data-ttu-id="a474b-287">**ejecución de WM \_ DDE \_**</span><span class="sxs-lookup"><span data-stu-id="a474b-287">**WM\_DDE\_EXECUTE**</span></span>](wm-dde-execute.md)     | <span data-ttu-id="a474b-288">Envía una cadena a la aplicación de servidor, que se espera que procese la cadena como una serie de comandos.</span><span class="sxs-lookup"><span data-stu-id="a474b-288">Sends a string to the server application, which is expected to process the string as a series of commands.</span></span>                                       |
| [<span data-ttu-id="a474b-289">**Inicio de WM \_ DDE \_**</span><span class="sxs-lookup"><span data-stu-id="a474b-289">**WM\_DDE\_INITIATE**</span></span>](wm-dde-initiate.md)   | <span data-ttu-id="a474b-290">Inicia una conversación entre las aplicaciones cliente y servidor.</span><span class="sxs-lookup"><span data-stu-id="a474b-290">Initiates a conversation between the client and server applications.</span></span>                                                                             |
| [<span data-ttu-id="a474b-291">**hiperdinámico de WM \_ \_**</span><span class="sxs-lookup"><span data-stu-id="a474b-291">**WM\_DDE\_POKE**</span></span>](wm-dde-poke.md)           | <span data-ttu-id="a474b-292">Envía un valor de elemento de datos a la aplicación de servidor.</span><span class="sxs-lookup"><span data-stu-id="a474b-292">Sends a data-item value to the server application.</span></span>                                                                                               |
| [<span data-ttu-id="a474b-293">**\_solicitud de DDE de WM \_**</span><span class="sxs-lookup"><span data-stu-id="a474b-293">**WM\_DDE\_REQUEST**</span></span>](wm-dde-request.md)     | <span data-ttu-id="a474b-294">Solicita a la aplicación de servidor que proporcione el valor de un elemento de datos.</span><span class="sxs-lookup"><span data-stu-id="a474b-294">Requests the server application to provide the value of a data item.</span></span>                                                                             |
| [<span data-ttu-id="a474b-295">**\_finalización de WM DDE \_**</span><span class="sxs-lookup"><span data-stu-id="a474b-295">**WM\_DDE\_TERMINATE**</span></span>](wm-dde-terminate.md) | <span data-ttu-id="a474b-296">Finaliza una conversación.</span><span class="sxs-lookup"><span data-stu-id="a474b-296">Terminates a conversation.</span></span>                                                                                                                       |
| [<span data-ttu-id="a474b-297">**\_DESaconsejar DDE de WM \_**</span><span class="sxs-lookup"><span data-stu-id="a474b-297">**WM\_DDE\_UNADVISE**</span></span>](wm-dde-unadvise.md)   | <span data-ttu-id="a474b-298">Finaliza un vínculo de datos permanente.</span><span class="sxs-lookup"><span data-stu-id="a474b-298">Terminates a permanent data link.</span></span>                                                                                                                |



 

<span data-ttu-id="a474b-299">Una aplicación llama a [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) para emitir el mensaje de [**\_ \_ Inicio del DDE de WM**](wm-dde-initiate.md) o un mensaje de [**\_ \_ confirmación de WM DDE**](wm-dde-ack.md) enviado como respuesta a un **\_ \_ Inicio de WM DDE**.</span><span class="sxs-lookup"><span data-stu-id="a474b-299">An application calls [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) to issue the [**WM\_DDE\_INITIATE**](wm-dde-initiate.md) message or a [**WM\_DDE\_ACK**](wm-dde-ack.md) message sent in response to **WM\_DDE\_INITIATE**.</span></span> <span data-ttu-id="a474b-300">El resto de los mensajes se envían por [**PostMessage**](/windows/desktop/api/winuser/nf-winuser-postmessagea).</span><span class="sxs-lookup"><span data-stu-id="a474b-300">All other messages are sent by [**PostMessage**](/windows/desktop/api/winuser/nf-winuser-postmessagea).</span></span> <span data-ttu-id="a474b-301">El primer parámetro de estas llamadas es un identificador de la ventana receptora; el segundo parámetro contiene el mensaje que se va a enviar; el tercer parámetro identifica la ventana de envío; y el cuarto parámetro contiene los argumentos específicos del mensaje.</span><span class="sxs-lookup"><span data-stu-id="a474b-301">The first parameter of these calls is a handle to the receiving window; the second parameter contains the message to be sent; the third parameter identifies the sending window; and the fourth parameter contains the message-specific arguments.</span></span>

## <a name="dynamic-data-exchange-message-flow"></a><span data-ttu-id="a474b-302">Intercambio dinámico de datos flujo de mensajes</span><span class="sxs-lookup"><span data-stu-id="a474b-302">Dynamic Data Exchange Message Flow</span></span>

<span data-ttu-id="a474b-303">Una conversación DDE típica consta de los siguientes eventos:</span><span class="sxs-lookup"><span data-stu-id="a474b-303">A typical DDE conversation consists of the following events:</span></span>

1.  <span data-ttu-id="a474b-304">La aplicación cliente inicia la conversación y la aplicación de servidor responde.</span><span class="sxs-lookup"><span data-stu-id="a474b-304">The client application initiates the conversation, and the server application responds.</span></span>
2.  <span data-ttu-id="a474b-305">Las aplicaciones intercambian datos por cualquiera de los métodos siguientes:</span><span class="sxs-lookup"><span data-stu-id="a474b-305">The applications exchange data by any or all of the following methods:</span></span>
    -   -   <span data-ttu-id="a474b-306">La aplicación de servidor envía datos al cliente en la solicitud del cliente.</span><span class="sxs-lookup"><span data-stu-id="a474b-306">The server application sends data to the client at the client's request.</span></span>
        -   <span data-ttu-id="a474b-307">La aplicación cliente envía datos no solicitados a la aplicación de servidor.</span><span class="sxs-lookup"><span data-stu-id="a474b-307">The client application sends unsolicited data to the server application.</span></span>
        -   <span data-ttu-id="a474b-308">La aplicación cliente solicita a la aplicación de servidor que notifique al cliente cada vez que un elemento de datos cambia (vínculo de datos cálidos).</span><span class="sxs-lookup"><span data-stu-id="a474b-308">The client application requests the server application to notify the client whenever a data item changes (warm data link).</span></span>
        -   <span data-ttu-id="a474b-309">La aplicación cliente solicita a la aplicación de servidor que envíe datos cada vez que cambien los datos (vínculo de datos activo).</span><span class="sxs-lookup"><span data-stu-id="a474b-309">The client application requests the server application to send data whenever the data changes (hot data link).</span></span>
        -   <span data-ttu-id="a474b-310">La aplicación de servidor lleva a cabo un comando en la solicitud del cliente.</span><span class="sxs-lookup"><span data-stu-id="a474b-310">The server application carries out a command at the client's request.</span></span>

3.  <span data-ttu-id="a474b-311">La aplicación de cliente o de servidor finaliza la conversación.</span><span class="sxs-lookup"><span data-stu-id="a474b-311">Either the client or server application terminates the conversation.</span></span>

<span data-ttu-id="a474b-312">Una ventana de la aplicación que procesa las solicitudes de un cliente o servidor debe procesarlas estrictamente en el orden en que se reciben.</span><span class="sxs-lookup"><span data-stu-id="a474b-312">An application window that processes requests from a client or server must process them strictly in the order they are received.</span></span>

<span data-ttu-id="a474b-313">Un cliente puede establecer conversaciones con más de un servidor; un servidor puede tener conversaciones con más de un cliente.</span><span class="sxs-lookup"><span data-stu-id="a474b-313">A client can establish conversations with more than one server; a server can have conversations with more than one client.</span></span> <span data-ttu-id="a474b-314">Al controlar los mensajes de más de un origen, un cliente o servidor debe procesar los mensajes de una conversación sincrónicamente, pero no es necesario procesar todos los mensajes sincrónicamente.</span><span class="sxs-lookup"><span data-stu-id="a474b-314">When handling messages from more than one source, a client or server must process the messages of a conversation synchronously, but need not process all messages synchronously.</span></span> <span data-ttu-id="a474b-315">En otras palabras, puede desplazarse de una conversación a otra según sea necesario.</span><span class="sxs-lookup"><span data-stu-id="a474b-315">In other words, it can shift from one conversation to another as needed.</span></span>

<span data-ttu-id="a474b-316">Si una aplicación no puede procesar una solicitud entrante porque está esperando una respuesta DDE, debe evitar el interbloqueo mediante la publicación de un mensaje de [**\_ \_ confirmación de WM DDE**](wm-dde-ack.md) con el miembro **fBusy** de la estructura [**DDEACK**](/windows/desktop/api/Dde/ns-dde-ddeack) establecido en 1.</span><span class="sxs-lookup"><span data-stu-id="a474b-316">If an application is unable to process an incoming request because it is waiting for a DDE response, it must prevent deadlock by posting a [**WM\_DDE\_ACK**](wm-dde-ack.md) message with the **fBusy** member of the [**DDEACK**](/windows/desktop/api/Dde/ns-dde-ddeack) structure set to 1.</span></span> <span data-ttu-id="a474b-317">Una aplicación también puede enviar un mensaje **de \_ \_ confirmación de DDE de WM** ocupado si, por cualquier motivo, no puede procesar una solicitud entrante en un período de tiempo razonable.</span><span class="sxs-lookup"><span data-stu-id="a474b-317">An application can also send a busy **WM\_DDE\_ACK** message if, for any reason, it cannot process an incoming request within a reasonable amount of time.</span></span>

<span data-ttu-id="a474b-318">Una aplicación debe ser capaz de controlar el error de un cliente o servidor para responder a un mensaje dentro de un período de tiempo determinado.</span><span class="sxs-lookup"><span data-stu-id="a474b-318">An application should be able to handle the failure of a client or server to respond to a message within a certain time.</span></span> <span data-ttu-id="a474b-319">Dado que el intervalo de tiempo de espera puede variar en función de la naturaleza de la aplicación y de la configuración del sistema del usuario (incluido si está conectado a una red), la aplicación debe proporcionar una manera para que el usuario especifique el intervalo.</span><span class="sxs-lookup"><span data-stu-id="a474b-319">Since the time-out interval may vary depending on the nature of the application and the configuration of the user's system (including whether it is connected to a network), the application should provide a way for the user to specify the interval.</span></span>

## <a name="parameter-packing-functions"></a><span data-ttu-id="a474b-320">Funciones de empaquetado de parámetros</span><span class="sxs-lookup"><span data-stu-id="a474b-320">Parameter Packing Functions</span></span>

<span data-ttu-id="a474b-321">El parámetro *lParam* de muchos mensajes DDE contiene dos fragmentos de datos.</span><span class="sxs-lookup"><span data-stu-id="a474b-321">The *lParam* parameter of many DDE messages contains two pieces of data.</span></span> <span data-ttu-id="a474b-322">Por ejemplo, el *lParam* del mensaje [**de \_ \_ datos DDE de WM**](wm-dde-data.md) contiene un identificador de datos y un átomo.</span><span class="sxs-lookup"><span data-stu-id="a474b-322">For example, the *lParam* of the [**WM\_DDE\_DATA**](wm-dde-data.md) message contains a data handle and an atom.</span></span> <span data-ttu-id="a474b-323">Las aplicaciones deben usar la función [**PackDDElParam**](/windows/desktop/api/Dde/nf-dde-packddelparam) para empaquetar el identificador y Atom en un parámetro *lParam* y la función [**UnpackDDElParam**](/windows/desktop/api/Dde/nf-dde-unpackddelparam) para quitar los valores.</span><span class="sxs-lookup"><span data-stu-id="a474b-323">Applications must use the [**PackDDElParam**](/windows/desktop/api/Dde/nf-dde-packddelparam) function to pack the handle and atom into an *lParam* parameter, and the [**UnpackDDElParam**](/windows/desktop/api/Dde/nf-dde-unpackddelparam) function to remove the values.</span></span> <span data-ttu-id="a474b-324">Las aplicaciones DDE deben usar **PackDDElParam** y **UnpackDDElParam** para todos los mensajes publicados durante una conversación DDE.</span><span class="sxs-lookup"><span data-stu-id="a474b-324">DDE applications must use **PackDDElParam** and **UnpackDDElParam** for all messages posted during a DDE conversation.</span></span>

<span data-ttu-id="a474b-325">Las aplicaciones también pueden usar las funciones [**ReuseDDElParam**](/windows/desktop/api/Dde/nf-dde-reuseddelparam) y [**FreeDDElParam**](/windows/desktop/api/Dde/nf-dde-freeddelparam) .</span><span class="sxs-lookup"><span data-stu-id="a474b-325">Applications can also use the [**ReuseDDElParam**](/windows/desktop/api/Dde/nf-dde-reuseddelparam) and [**FreeDDElParam**](/windows/desktop/api/Dde/nf-dde-freeddelparam) functions.</span></span> <span data-ttu-id="a474b-326">**ReuseDDElParam** permite que una aplicación DDE reutilice un parámetro *lParam* empaquetado, lo que ayuda a reducir el número de reasignaciones de memoria que la aplicación debe realizar durante una conversación.</span><span class="sxs-lookup"><span data-stu-id="a474b-326">**ReuseDDElParam** allows a DDE application to reuse a packed *lParam* parameter, helping reduce the number of memory reallocations the application must perform during a conversation.</span></span> <span data-ttu-id="a474b-327">Una aplicación puede utilizar **FreeDDElParam** para liberar la memoria asociada a un identificador de datos recibido durante una conversación DDE.</span><span class="sxs-lookup"><span data-stu-id="a474b-327">An application can use **FreeDDElParam** to free the memory associated with a data handle received during a DDE conversation.</span></span>

## <a name="dynamic-data-exchange-and-impersonation"></a><span data-ttu-id="a474b-328">Intercambio dinámico de datos y suplantación</span><span class="sxs-lookup"><span data-stu-id="a474b-328">Dynamic Data Exchange and Impersonation</span></span>

<span data-ttu-id="a474b-329">Para permitir que un servidor suplante a un cliente, el cliente llama a la función [**DdeSetQualityOfService**](/windows/desktop/api/Dde/nf-dde-ddesetqualityofservice) .</span><span class="sxs-lookup"><span data-stu-id="a474b-329">To allow a server to impersonate a client, the client calls the [**DdeSetQualityOfService**](/windows/desktop/api/Dde/nf-dde-ddesetqualityofservice) function.</span></span> <span data-ttu-id="a474b-330">La estructura de [**\_ \_ nivel de suplantación de seguridad**](/windows/win32/api/winnt/ne-winnt-security_impersonation_level) se utiliza para controlar el nivel de suplantación que el servidor puede llevar a cabo.</span><span class="sxs-lookup"><span data-stu-id="a474b-330">The [**SECURITY\_IMPERSONATION\_LEVEL**](/windows/win32/api/winnt/ne-winnt-security_impersonation_level) structure is used to control the level of impersonation the server may perform.</span></span>

<span data-ttu-id="a474b-331">Un servidor DDE puede suplantar a un cliente DDE mediante una llamada a la función [**ImpersonateDdeClientWindow**](/windows/desktop/api/Dde/nf-dde-impersonateddeclientwindow) .</span><span class="sxs-lookup"><span data-stu-id="a474b-331">A DDE server can impersonate a DDE client by calling the [**ImpersonateDdeClientWindow**](/windows/desktop/api/Dde/nf-dde-impersonateddeclientwindow) function.</span></span> <span data-ttu-id="a474b-332">Un servidor DDEML debe utilizar la función [**DdeImpersonateClient**](/windows/desktop/api/Ddeml/nf-ddeml-ddeimpersonateclient) .</span><span class="sxs-lookup"><span data-stu-id="a474b-332">A DDEML server should use the [**DdeImpersonateClient**](/windows/desktop/api/Ddeml/nf-ddeml-ddeimpersonateclient) function.</span></span>

 

 