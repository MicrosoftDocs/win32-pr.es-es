---
description: La herramienta CTRPP es un preprocesador que analiza y valida el manifiesto de contadores.
ms.assetid: 3939f6a1-0a94-429d-a71e-b37f045fea13
title: CTRPP
ms.topic: reference
ms.date: 08/17/2020
topic_type:
- APIRef
- kbSyntax
api_name:
- CTRPP
api_type:
- NA
api_location: ''
ms.openlocfilehash: eacfbb83abd56becc579c6b9bbaedacda96f94b4
ms.sourcegitcommit: b32433cc0394159c7263809ae67615ab5792d40d
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/30/2021
ms.locfileid: "113119110"
---
# <a name="ctrpp"></a><span data-ttu-id="3668a-103">CTRPP</span><span class="sxs-lookup"><span data-stu-id="3668a-103">CTRPP</span></span>

<span data-ttu-id="3668a-104">La herramienta CTRPP es un preprocesador que analiza y valida el manifiesto para el proveedor V2.</span><span class="sxs-lookup"><span data-stu-id="3668a-104">The CTRPP tool is a pre-processor that parses and validates the manifest for your V2 provider.</span></span> <span data-ttu-id="3668a-105">La herramienta genera recursos con las cadenas necesarias para los consumidores del proveedor y genera un encabezado con código que se usa para proporcionar los `.rc` `.h` datos del contador.</span><span class="sxs-lookup"><span data-stu-id="3668a-105">The tool generates `.rc` resources with the strings needed by consumers of your provider, and it generates a `.h` header with code that you use to provide your counter data.</span></span> <span data-ttu-id="3668a-106">Debe ejecutar la herramienta CTRPP durante la compilación del proveedor.</span><span class="sxs-lookup"><span data-stu-id="3668a-106">You should run the CTRPP tool during the build of your provider.</span></span> <span data-ttu-id="3668a-107">Debe usar el código generado como punto de partida al desarrollar el proveedor en lugar de intentar generar este código usted mismo.</span><span class="sxs-lookup"><span data-stu-id="3668a-107">You should use the generated code as a starting point when developing your provider instead of trying to generate this code yourself.</span></span>

```syntax
ctrpp -o codeFile -rc rcFile [-legacy] [-MemoryRoutines] [-NotificationCallback] [-prefix prefix] [-ch symFile] [-backcompat] inputFile
```

## <a name="arguments"></a><span data-ttu-id="3668a-108">Argumentos</span><span class="sxs-lookup"><span data-stu-id="3668a-108">Arguments</span></span>

|<span data-ttu-id="3668a-109">Opción</span><span class="sxs-lookup"><span data-stu-id="3668a-109">Option</span></span>              |<span data-ttu-id="3668a-110">Descripción</span><span class="sxs-lookup"><span data-stu-id="3668a-110">Description</span></span>
|--------------------|-----------
|<span data-ttu-id="3668a-111">*inputFile*</span><span class="sxs-lookup"><span data-stu-id="3668a-111">*inputFile*</span></span>         |<span data-ttu-id="3668a-112">**Obligatorio:** Especifica el nombre del archivo `.man` (manifiesto XML) que define los contadores.</span><span class="sxs-lookup"><span data-stu-id="3668a-112">**Required:** Specifies the name of the `.man` (XML manifest) file that defines your counters.</span></span>
|<span data-ttu-id="3668a-113">**-o** *codeFile*</span><span class="sxs-lookup"><span data-stu-id="3668a-113">**-o** *codeFile*</span></span>   |<span data-ttu-id="3668a-114">**Obligatorio:** Especifica el nombre del archivo `.h` de código que va a generar CTRPP.</span><span class="sxs-lookup"><span data-stu-id="3668a-114">**Required:** Specifies the name of the `.h` code file to be generated by CTRPP.</span></span> <span data-ttu-id="3668a-115">Este archivo contendrá funciones auxiliares insertadas de C/C++ que simplifican la inicialización y la desinicialización del proveedor.</span><span class="sxs-lookup"><span data-stu-id="3668a-115">This file will contain C/C++ inline helper functions that simplify initializing and uninitializing your provider.</span></span>
|<span data-ttu-id="3668a-116">**-rc** *rcFile*</span><span class="sxs-lookup"><span data-stu-id="3668a-116">**-rc** *rcFile*</span></span>    |<span data-ttu-id="3668a-117">**Obligatorio:** Especifica el nombre del `.rc` (archivo de recursos) que va a generar CTRPP.</span><span class="sxs-lookup"><span data-stu-id="3668a-117">**Required:** Specifies the name of the `.rc` (resource file) to be generated by CTRPP.</span></span> <span data-ttu-id="3668a-118">Este archivo contendrá la tabla de cadenas del proveedor.</span><span class="sxs-lookup"><span data-stu-id="3668a-118">This file will contain the provider's string table.</span></span>
|<span data-ttu-id="3668a-119">**-ch** *symFile*</span><span class="sxs-lookup"><span data-stu-id="3668a-119">**-ch** *symFile*</span></span>   |<span data-ttu-id="3668a-120">Especifica el nombre del archivo de símbolos opcional que `.h` va a generar CTRPP.</span><span class="sxs-lookup"><span data-stu-id="3668a-120">Specifies the name of the optional `.h` symbol file to be generated by CTRPP.</span></span> <span data-ttu-id="3668a-121">Este archivo contendrá símbolos de C/C++ para los nombres y GUID de cada conjunto de contadores del proveedor.</span><span class="sxs-lookup"><span data-stu-id="3668a-121">This file will contain C/C++ symbols for the names and GUIDs of each counterset in the provider.</span></span>
|<span data-ttu-id="3668a-122">**Prefijo -prefix** </span><span class="sxs-lookup"><span data-stu-id="3668a-122">**-prefix** *prefix*</span></span>|<span data-ttu-id="3668a-123">Especifica el prefijo que se usará para las variables y funciones definidas en el archivo de encabezado generado.</span><span class="sxs-lookup"><span data-stu-id="3668a-123">Specifies the prefix to use for the variables and functions defined in the generated header file.</span></span>
|<span data-ttu-id="3668a-124">**-NotificationCallback**</span><span class="sxs-lookup"><span data-stu-id="3668a-124">**-NotificationCallback**</span></span>|<span data-ttu-id="3668a-125">Cambia la firma predeterminada de la función [**CounterInitialize**](counterinitialize.md) para incluir parámetros para especificar el nombre de las funciones de devolución de llamada [*ControlCallback*](/windows/desktop/api/Perflib/nc-perflib-perflibrequest), [*AllocateMemory*](/windows/desktop/api/Perflib/nc-perflib-perf_mem_alloc)y [*FreeMemory.*](/windows/desktop/api/Perflib/nc-perflib-perf_mem_free)</span><span class="sxs-lookup"><span data-stu-id="3668a-125">Changes the default signature of the [**CounterInitialize**](counterinitialize.md) function to include parameters for specifying the name of [*ControlCallback*](/windows/desktop/api/Perflib/nc-perflib-perflibrequest), [*AllocateMemory*](/windows/desktop/api/Perflib/nc-perflib-perf_mem_alloc), and [*FreeMemory*](/windows/desktop/api/Perflib/nc-perflib-perf_mem_free) callback functions.</span></span> <span data-ttu-id="3668a-126">Este argumento tiene el mismo efecto que incluir el `callback` atributo en el elemento [**provider.**](/windows/desktop/PerfCtrs/performance-counters-provider--counters--element)</span><span class="sxs-lookup"><span data-stu-id="3668a-126">This argument has the same effect as including the `callback` attribute in the [**provider**](/windows/desktop/PerfCtrs/performance-counters-provider--counters--element) element.</span></span>
|<span data-ttu-id="3668a-127">**-migrate** *outputFile*</span><span class="sxs-lookup"><span data-stu-id="3668a-127">**-migrate** *outputFile*</span></span>|<span data-ttu-id="3668a-128">En lugar de generar archivos y , actualiza el manifiesto inputFile a la versión más reciente y `.h` `.rc` lo guarda en *outputFile*  .</span><span class="sxs-lookup"><span data-stu-id="3668a-128">Instead of generating `.h` and `.rc` files, upgrades the *inputFile* manifest to the latest version and saves it to *outputFile*.</span></span> <span data-ttu-id="3668a-129">Este modificador no se puede usar con otros modificadores.</span><span class="sxs-lookup"><span data-stu-id="3668a-129">This switch cannot be used with other switches.</span></span> <span data-ttu-id="3668a-130">Uso: `CTRPP -migrate NewFile.man OldFile.man`</span><span class="sxs-lookup"><span data-stu-id="3668a-130">Usage: `CTRPP -migrate NewFile.man OldFile.man`</span></span>
|<span data-ttu-id="3668a-131">**-BackCompat**</span><span class="sxs-lookup"><span data-stu-id="3668a-131">**-BackCompat**</span></span>     |<span data-ttu-id="3668a-132">**En desuso:** Se agregó compatibilidad con proveedores de modo kernel en Windows 7.</span><span class="sxs-lookup"><span data-stu-id="3668a-132">**Deprecated:** Support for kernel-mode providers was added in Windows 7.</span></span> <span data-ttu-id="3668a-133">De forma predeterminada, el código generado por CTRPP para los proveedores de modo kernel será incompatible con versiones anteriores de Windows (el controlador no se cargará debido a que faltan `Pcw***` API).</span><span class="sxs-lookup"><span data-stu-id="3668a-133">By default, the code generated by CTRPP for kernel-mode providers will be incompatible with earlier versions of Windows (driver will fail to load due to missing `Pcw***` APIs).</span></span> <span data-ttu-id="3668a-134">Se `-BackCompat` establece para habilitar la compatibilidad con versiones anteriores de Windows.</span><span class="sxs-lookup"><span data-stu-id="3668a-134">Set `-BackCompat` to enable compatibility with earlier versions of Windows.</span></span> <span data-ttu-id="3668a-135">El controlador cargará dinámicamente las API necesarias y el código generado deshabilitará de forma silenciosa el proveedor si las API no están disponibles.</span><span class="sxs-lookup"><span data-stu-id="3668a-135">The driver will dynamically load the necessary APIs and the generated code will silently disable the provider if the APIs are not available.</span></span>
|<span data-ttu-id="3668a-136">**-MemoryRoutines**</span><span class="sxs-lookup"><span data-stu-id="3668a-136">**-MemoryRoutines**</span></span> |<span data-ttu-id="3668a-137">**En desuso:** Cuando se usa con el `-Legacy` modificador , incluye plantillas para rutinas de memoria en el código generado.</span><span class="sxs-lookup"><span data-stu-id="3668a-137">**Deprecated:** When used with the `-Legacy` switch, includes templates for memory routines in the generated code.</span></span> <span data-ttu-id="3668a-138">De lo contrario, este argumento tiene el mismo efecto que el `-NotificationCallback` modificador .</span><span class="sxs-lookup"><span data-stu-id="3668a-138">Otherwise, this argument has the same effect as the `-NotificationCallback` switch.</span></span>
|<span data-ttu-id="3668a-139">**-Legacy**</span><span class="sxs-lookup"><span data-stu-id="3668a-139">**-Legacy**</span></span>         |<span data-ttu-id="3668a-140">**En desuso:** Genera archivos , , y mediante las plantillas de código de `*.h` `*.c` Windows Vista `*.rc` `*_r.h` (genera PerfAutoInitialize y PerfAutoCleanup en lugar de CounterInitialize y CounterCleanup).</span><span class="sxs-lookup"><span data-stu-id="3668a-140">**Deprecated:** Generates `*.h`, `*.c`, `*.rc`, and `*_r.h` files using the Windows Vista code templates (generates PerfAutoInitialize and PerfAutoCleanup instead of CounterInitialize and CounterCleanup).</span></span> <span data-ttu-id="3668a-141">Este modificador se puede usar con **-MemoryRoutines** y **-NotificationCallback,** pero no se puede usar con ningún otro modificador.</span><span class="sxs-lookup"><span data-stu-id="3668a-141">This switch can be used with **-MemoryRoutines** and **-NotificationCallback** but cannot be used with any other switches.</span></span> <span data-ttu-id="3668a-142">No use los **modificadores -o** **o -rc** con este modificador.</span><span class="sxs-lookup"><span data-stu-id="3668a-142">Do not use the **-o** or **-rc** switches with this switch.</span></span> <span data-ttu-id="3668a-143">Los archivos generados se denominarán en función del nombre del manifiesto y se escribirán en el directorio que contiene el manifiesto.</span><span class="sxs-lookup"><span data-stu-id="3668a-143">The generated files will be named based on the name of the manifest and will be written to the directory that contained the manifest.</span></span> <span data-ttu-id="3668a-144">Uso: `CTRPP -legacy OldFile.man`</span><span class="sxs-lookup"><span data-stu-id="3668a-144">Usage: `CTRPP -legacy OldFile.man`</span></span>

## <a name="remarks"></a><span data-ttu-id="3668a-145">Observaciones</span><span class="sxs-lookup"><span data-stu-id="3668a-145">Remarks</span></span>

<span data-ttu-id="3668a-146">La herramienta CTRPP genera un archivo de código, un archivo `.h` de recursos y, opcionalmente, genera un `.rc` archivo de `.h` símbolos.</span><span class="sxs-lookup"><span data-stu-id="3668a-146">The CTRPP tool generates a `.h` code file, an `.rc` resource file, and optionally generates a `.h` symbol file.</span></span>

### <a name="using-the-generated-resource-file"></a><span data-ttu-id="3668a-147">Uso del archivo de recursos generado</span><span class="sxs-lookup"><span data-stu-id="3668a-147">Using the generated resource file</span></span>

<span data-ttu-id="3668a-148">La herramienta CTRPP generará un archivo de recursos que contiene las cadenas localizables que necesitan los consumidores de los contraconjuntos `.rc` del proveedor.</span><span class="sxs-lookup"><span data-stu-id="3668a-148">The CTRPP tool will generate a `.rc` resource file that contains the localizable strings needed by consumers of the provider's countersets.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="3668a-149">Los recursos de este archivo deben incluirse en el archivo binario del proveedor y la ruta de acceso completa al binario del proveedor debe registrarse durante la instalación del manifiesto del proveedor.</span><span class="sxs-lookup"><span data-stu-id="3668a-149">The resources from this file must be included into your provider binary and the full path to the provider binary must be registered during the installation of your provider's manifest.</span></span> <span data-ttu-id="3668a-150">Los consumidores que no puedan encontrar y cargar los recursos no podrán usar los contraconjuntos del proveedor.</span><span class="sxs-lookup"><span data-stu-id="3668a-150">Consumers that are unable to locate and load the resources will be unable to use your provider's countersets.</span></span>

<span data-ttu-id="3668a-151">Los recursos de cadena deben controlarse de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="3668a-151">The string resources should be handled as follows:</span></span>

- <span data-ttu-id="3668a-152">El desarrollador edita el archivo de manifiesto de proveedor ( ) para establecer el atributo del proveedor en el nombre de un binario de proveedor (.DLL, .SYS o .EXE) que contendrá los recursos de cadena para el proveedor y se instalará como parte del componente `.man` `applicationIdentity` del proveedor.</span><span class="sxs-lookup"><span data-stu-id="3668a-152">The developer edits the provider manifest (`.man`) file to set the `applicationIdentity` attribute of the provider to the name of a provider binary (.DLL, .SYS, or .EXE) that will contain the string resources for the provider and will be installed as part of the provider component.</span></span>
- <span data-ttu-id="3668a-153">La herramienta CTRPP lee el manifiesto del proveedor y genera un `.rc` archivo.</span><span class="sxs-lookup"><span data-stu-id="3668a-153">The CTRPP tool reads the provider manifest and generates an `.rc` file.</span></span>
- <span data-ttu-id="3668a-154">La [herramienta RC (compilador de recursos)](../menurc/resource-compiler.md) compila los datos del archivo generado por CTRPP para generar un archivo `.rc` que contiene los recursos `.res` binarios.</span><span class="sxs-lookup"><span data-stu-id="3668a-154">The [RC (resource compiler)](../menurc/resource-compiler.md) tool compiles the data from the CTRPP-generated `.rc` file to generate a `.res` file containing the binary resources.</span></span> <span data-ttu-id="3668a-155">Esto se puede hacer compilando directamente el archivo generado por CTRPP O compilando otro archivo que incluya el archivo generado por CTRPP a través de `.rc` `.rc` una directiva `.rc` `#include` .</span><span class="sxs-lookup"><span data-stu-id="3668a-155">This can be done either by directly compiling the CTRPP-generated `.rc` file OR by compiling another `.rc` file that includes the CTRPP-generated `.rc` file via an `#include` directive.</span></span>
- <span data-ttu-id="3668a-156">El vinculador inserta los datos del archivo generado por RC `.res` en el binario del proveedor.</span><span class="sxs-lookup"><span data-stu-id="3668a-156">The linker embeds the data from the RC-generated `.res` file into the provider binary.</span></span>
- <span data-ttu-id="3668a-157">Durante la instalación, el binario del proveedor se copia en el sistema del usuario y el manifiesto del proveedor se registra mediante [la herramienta lodctr](/windows-server/administration/windows-commands/lodctr).</span><span class="sxs-lookup"><span data-stu-id="3668a-157">During installation, the provider binary is copied onto the user's system and the provider manifest is registered using the [lodctr tool](/windows-server/administration/windows-commands/lodctr).</span></span> <span data-ttu-id="3668a-158">La herramienta lodctr convierte el atributo del manifiesto del proveedor en una ruta de acceso completa y registra la ruta de acceso completa al binario del `applicationIdentity` proveedor en el registro.</span><span class="sxs-lookup"><span data-stu-id="3668a-158">The lodctr tool converts the `applicationIdentity` attribute of the provider manifest into a full path and records the full path to the provider binary in the registry.</span></span>
  - <span data-ttu-id="3668a-159">Si el binario del proveedor está en el mismo directorio que el manifiesto, use: `lodctr.exe /m:"C:\full\manifest\path\manifest.man"` .</span><span class="sxs-lookup"><span data-stu-id="3668a-159">If the provider binary is in the same directory as the manifest, use: `lodctr.exe /m:"C:\full\manifest\path\manifest.man"`.</span></span> <span data-ttu-id="3668a-160">lodctr combinará la ruta de acceso del manifiesto especificada con el atributo `applicationIdentity` del manifiesto para formar la ruta de acceso completa.</span><span class="sxs-lookup"><span data-stu-id="3668a-160">lodctr will combine the specified manifest path with the manifest's `applicationIdentity` attribute to form the full path.</span></span>
  - <span data-ttu-id="3668a-161">De lo contrario, use `lodctr.exe /m:"C:\full\manifest\path\manifest.man" "c:\full\binary\path"`.</span><span class="sxs-lookup"><span data-stu-id="3668a-161">Otherwise, use `lodctr.exe /m:"C:\full\manifest\path\manifest.man" "c:\full\binary\path"`.</span></span> <span data-ttu-id="3668a-162">lodctr combinará la ruta de acceso binaria especificada con el atributo `applicationIdentity` del manifiesto para formar la ruta de acceso completa.</span><span class="sxs-lookup"><span data-stu-id="3668a-162">lodctr will combine the specified binary path with the manifest's `applicationIdentity` attribute to form the full path.</span></span>
  - <span data-ttu-id="3668a-163">Con fines de diagnóstico, puede inspeccionar la ruta de acceso completa registrada comprobando el `ApplicationIdentity` valor de la clave del Registro `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Perflib\_V2Providers\{<ProviderGuid>}` .</span><span class="sxs-lookup"><span data-stu-id="3668a-163">For diagnostic purposes, you can inspect the recorded full path by checking the `ApplicationIdentity` value of registry key `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Perflib\_V2Providers\{<ProviderGuid>}`.</span></span>
  - <span data-ttu-id="3668a-164">Si el archivo binario usa LAM para la localización, asegúrese de copiar el archivo DE LAN junto con el binario.</span><span class="sxs-lookup"><span data-stu-id="3668a-164">If the binary is using MUI for localization, be sure to copy the MUI file along with the binary.</span></span>
- <span data-ttu-id="3668a-165">Durante la recopilación de conjuntos de contadores, el consumidor usa la ruta de acceso completa registrada al binario del proveedor para buscar y cargar las cadenas necesarias desde los recursos binarios del proveedor.</span><span class="sxs-lookup"><span data-stu-id="3668a-165">During counterset collection, the consumer uses the recorded full path to the provider binary to locate and load the necessary strings from the provider binary's resources.</span></span>

### <a name="using-the-generated-code-file-in-a-user-mode-provider"></a><span data-ttu-id="3668a-166">Uso del archivo de código generado en un proveedor de modo de usuario</span><span class="sxs-lookup"><span data-stu-id="3668a-166">Using the generated code file in a user-mode provider</span></span>

<span data-ttu-id="3668a-167">La herramienta CTRPP generará un archivo `.h` de código de C/C++.</span><span class="sxs-lookup"><span data-stu-id="3668a-167">The CTRPP tool will generate a `.h` C/C++ code file.</span></span> <span data-ttu-id="3668a-168">Si el atributo del manifiesto del proveedor se establece en , el archivo de código generado contendrá las siguientes definiciones que son útiles para codificar `providerType` un proveedor en modo de `userMode` usuario:</span><span class="sxs-lookup"><span data-stu-id="3668a-168">If the provider manifest's `providerType` attribute is set to `userMode`, the generated code file will contain the following definitions that are helpful in coding a user-mode provider:</span></span>

- <span data-ttu-id="3668a-169">Una función de inicialización de proveedor [ \* **denominada prefix\*CounterInitialize**](counterinitialize.md).</span><span class="sxs-lookup"><span data-stu-id="3668a-169">An provider initialization function named [\***prefix\*CounterInitialize**](counterinitialize.md).</span></span>
- <span data-ttu-id="3668a-170">Una función de limpieza de proveedor [ \* **denominada prefix\*CounterCleanup**](countercleanup.md).</span><span class="sxs-lookup"><span data-stu-id="3668a-170">A provider cleanup function named [\***prefix\*CounterCleanup**](countercleanup.md).</span></span>
- <span data-ttu-id="3668a-171">Variable global \***provider** _ que almacena el identificador del proveedor abierto por la función _ \*_prefix_CounterInitialize\*\*.</span><span class="sxs-lookup"><span data-stu-id="3668a-171">A global ***provider** _ variable that stores the provider handle opened by the _ *_prefix_CounterInitialize** function.</span></span> <span data-ttu-id="3668a-172">El nombre de la variable es el valor del `symbol` atributo del elemento en el `provider` manifiesto.</span><span class="sxs-lookup"><span data-stu-id="3668a-172">The variable's name is the value of the `symbol` attribute of the `provider` element in the manifest.</span></span> <span data-ttu-id="3668a-173">Esta variable debe usarse en llamadas a `PerfCreateInstance` `PerfDeleteInstance` , y otras API para controlar los datos del proveedor.</span><span class="sxs-lookup"><span data-stu-id="3668a-173">This variable should be used in calls to `PerfCreateInstance`, `PerfDeleteInstance`, and other APIs for controlling your provider's data.</span></span>
- <span data-ttu-id="3668a-174">Para cada conjunto de contadores, una variable global \***counterset\*GUID** con el GUID del conjunto de contadores.</span><span class="sxs-lookup"><span data-stu-id="3668a-174">For each counterset, a global \***counterset\*GUID** variable with the counterset GUID.</span></span> <span data-ttu-id="3668a-175">El nombre de la variable es el valor del atributo del elemento más el `counterSet` `symbol` sufijo "GUID", por ejemplo, `MyCounterSetGUID` .</span><span class="sxs-lookup"><span data-stu-id="3668a-175">The variable's name is the value of the `counterSet` element's `symbol` attribute plus the suffix "GUID", e.g. `MyCounterSetGUID`.</span></span> <span data-ttu-id="3668a-176">Esta variable debe usarse en llamadas a `PerfCreateInstance` `PerfDeleteInstance` , y otras API para controlar los datos del proveedor.</span><span class="sxs-lookup"><span data-stu-id="3668a-176">This variable should be used in calls to `PerfCreateInstance`, `PerfDeleteInstance`, and other APIs for controlling your provider's data.</span></span>
- <span data-ttu-id="3668a-177">Para cada contador, una macro ***de*** contador con el valor del `id` contador.</span><span class="sxs-lookup"><span data-stu-id="3668a-177">For each counter, a ***counter*** macro with the counter's `id` value.</span></span> <span data-ttu-id="3668a-178">El nombre de la macro es el valor del `counter` atributo del `symbol` elemento.</span><span class="sxs-lookup"><span data-stu-id="3668a-178">The macro's name is the value of the `counter` element's `symbol` attribute.</span></span> <span data-ttu-id="3668a-179">Esta macro debe usarse en llamadas a `PerfSetCounterRefValue` `PerfSetULongLongCounterValue` , y otras API para establecer los datos del proveedor.</span><span class="sxs-lookup"><span data-stu-id="3668a-179">This macro should be used in calls to `PerfSetCounterRefValue`, `PerfSetULongLongCounterValue`, and other APIs for setting your provider's data.</span></span>

<span data-ttu-id="3668a-180">En los nombres de función, ***prefix*** hace referencia al valor del parámetro `-prefix` de línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="3668a-180">In the function names, ***prefix*** refers to the value of the `-prefix` command-line parameter.</span></span> <span data-ttu-id="3668a-181">Si no `-prefix` se usa el parámetro , las funciones se denominarán y `CounterInitialize` `CounterCleanup` .</span><span class="sxs-lookup"><span data-stu-id="3668a-181">If the `-prefix` parameter is not used the functions will be named `CounterInitialize` and `CounterCleanup`.</span></span>

### <a name="using-the-generated-code-file-in-a-kernel-mode-provider"></a><span data-ttu-id="3668a-182">Uso del archivo de código generado en un proveedor de modo kernel</span><span class="sxs-lookup"><span data-stu-id="3668a-182">Using the generated code file in a kernel-mode provider</span></span>

<span data-ttu-id="3668a-183">La herramienta CTRPP generará un archivo `.h` de código de C/C++.</span><span class="sxs-lookup"><span data-stu-id="3668a-183">The CTRPP tool will generate a `.h` C/C++ code file.</span></span> <span data-ttu-id="3668a-184">Si el atributo del manifiesto del proveedor se establece en , el archivo de código generado contendrá las siguientes definiciones que son útiles para codificar los conjuntos de contadores de un proveedor en modo `providerType` `kernelMode` kernel:</span><span class="sxs-lookup"><span data-stu-id="3668a-184">If the provider manifest's `providerType` attribute is set to `kernelMode`, the generated code file will contain the following definitions that are helpful in coding a kernel-mode provider's countersets:</span></span>

- <span data-ttu-id="3668a-185">Una función de inicialización de conjunto de <b> *contadores denominada prefix* Register *Counterset*</b>.</span><span class="sxs-lookup"><span data-stu-id="3668a-185">A counterset initialization function named <b>*prefix* Register *Counterset*</b>.</span></span> <span data-ttu-id="3668a-186">Esta función rellena una estructura [RegInfo](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_registration_information) y, a continuación, invoca [a PcwRegister,](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwregister)colocando el identificador de registro del conjunto de contadores resultante en la variable ***counterset*** global.</span><span class="sxs-lookup"><span data-stu-id="3668a-186">This function fills in a [RegInfo](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_registration_information) structure then invokes [PcwRegister](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwregister), putting the resulting counterset registration handle into the global ***Counterset*** variable.</span></span>
- <span data-ttu-id="3668a-187">Una función de limpieza del conjunto de <b> *contadores denominada prefix* Unregister *Counterset*</b>.</span><span class="sxs-lookup"><span data-stu-id="3668a-187">A counterset cleanup function named <b>*prefix* Unregister *Counterset*</b>.</span></span> <span data-ttu-id="3668a-188">Esta función invoca [PcwUnregister en](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwunregister) el identificador de registro del conjunto de contadores en la variable ***counterset*** global.</span><span class="sxs-lookup"><span data-stu-id="3668a-188">This function invokes [PcwUnregister](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwunregister) on the counterset registration handle in the global ***Counterset*** variable.</span></span>
- <span data-ttu-id="3668a-189">Una función de creación de instancias denominada <b> *prefix* Create *Counterset*</b>.</span><span class="sxs-lookup"><span data-stu-id="3668a-189">An instance creation function named <b>*prefix* Create *Counterset*</b>.</span></span> <span data-ttu-id="3668a-190">Esta función rellena una matriz de estructuras [PcwData](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_data) y, a continuación, invoca [PcwCreateInstance](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwcreateinstance) mediante el identificador de registro del conjunto de contadores en la variable ***counterset*** global.</span><span class="sxs-lookup"><span data-stu-id="3668a-190">This function fills in an array of [PcwData](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_data) structures then invokes [PcwCreateInstance](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwcreateinstance) using the counterset registration handle in the global ***Counterset*** variable.</span></span>
- <span data-ttu-id="3668a-191">Una función de limpieza de instancia denominada <b> *prefix* Close *Counterset*</b>.</span><span class="sxs-lookup"><span data-stu-id="3668a-191">An instance cleanup function named <b>*prefix* Close *Counterset*</b>.</span></span> <span data-ttu-id="3668a-192">Esta función invoca [a PcwCloseInstance.](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwcloseinstance)</span><span class="sxs-lookup"><span data-stu-id="3668a-192">This function invokes [PcwCloseInstance](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwcloseinstance).</span></span>
- <span data-ttu-id="3668a-193">Una función de informes de instancia denominada <b> *prefix\*\*Add Counterset*</b> que se usará desde la función de devolución de llamada del conjunto de contadores.</span><span class="sxs-lookup"><span data-stu-id="3668a-193">An instance reporting function named <b>*prefix* Add *Counterset*</b> to be used from the counterset callback function.</span></span> <span data-ttu-id="3668a-194">Esta función rellena una matriz de estructuras [PcwData](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_data) y, a continuación, invoca [a PcwAddInstance](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwaddinstance).</span><span class="sxs-lookup"><span data-stu-id="3668a-194">This function fills in an array of [PcwData](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_data) structures then invokes [PcwAddInstance](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwaddinstance).</span></span>
- <span data-ttu-id="3668a-195">**Windows SDK 20H1 y versiones posteriores:** Una función de inicialización RegInfo denominada <b> *prefix* InitRegistrationInformation *Counterset*</b> para su uso en escenarios avanzados.</span><span class="sxs-lookup"><span data-stu-id="3668a-195">**Windows SDK 20H1 and later:** A RegInfo initialization function named <b>*prefix* InitRegistrationInformation *Counterset*</b> for use in advanced scenarios.</span></span> <span data-ttu-id="3668a-196">Esta función rellena una [estructura RegInfo.](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_registration_information)</span><span class="sxs-lookup"><span data-stu-id="3668a-196">This function fills in a [RegInfo](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_registration_information) structure.</span></span> <span data-ttu-id="3668a-197">Esta función se puede usar en casos en los que el prefijo generado <b> Register *Counterset*</b> no satisface sus necesidades, por ejemplo, cuando desea personalizar los valores de la estructura RegInfo o cuando desea almacenar el identificador devuelto en otra variable.</span><span class="sxs-lookup"><span data-stu-id="3668a-197">This function can be used in cases where the generated <b>*prefix* Register *Counterset*</b> does not meet your needs, e.g. when you want to customize the values in the RegInfo structure or when you want to store the returned handle in another variable.</span></span>

<span data-ttu-id="3668a-198">En los nombres de función, ***prefix*** hace referencia al valor del parámetro `-prefix` de línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="3668a-198">In the function names, ***prefix*** refers to the value of the `-prefix` command-line parameter.</span></span> <span data-ttu-id="3668a-199">Si no `-prefix` se usa el parámetro , las funciones no tendrán ningún prefijo.</span><span class="sxs-lookup"><span data-stu-id="3668a-199">If the `-prefix` parameter is not used the functions will have no prefix.</span></span>

> [!NOTE]
> <span data-ttu-id="3668a-200">La función <b> *Add\*\*Counterset del*</b> prefijo generado se usa cuando se tiene una devolución de llamada de conjunto de contadores.</span><span class="sxs-lookup"><span data-stu-id="3668a-200">The generated <b>*prefix* Add *Counterset*</b> function is used when you have a counterset callback.</span></span> <span data-ttu-id="3668a-201">Las funciones <b> *Create\*\*Counterset (Crear conjunto de contadores)*</b> y <b> *Prefix\*\*Close Counterset*</b> (Cerrar conjunto de contadores) generados se usan cuando no tiene una devolución de llamada de conjunto de contadores.</span><span class="sxs-lookup"><span data-stu-id="3668a-201">The generated <b>*prefix* Create *Counterset*</b> and <b>*prefix* Close *Counterset*</b> functions are used when you do not have a counterset callback.</span></span>

### <a name="using-the-generated-symbol-file"></a><span data-ttu-id="3668a-202">Uso del archivo de símbolos generado</span><span class="sxs-lookup"><span data-stu-id="3668a-202">Using the generated symbol file</span></span>

<span data-ttu-id="3668a-203">Si el **parámetro -ch** se especifica en la línea de comandos, la herramienta CTRPP generará un archivo `.h` de símbolos.</span><span class="sxs-lookup"><span data-stu-id="3668a-203">If the **-ch** parameter is specified on the command line, the CTRPP tool will generate a `.h` symbol file.</span></span> <span data-ttu-id="3668a-204">Este archivo contiene los símbolos de C/C++ para los nombres y GUID de cada conjunto de contadores del proveedor.</span><span class="sxs-lookup"><span data-stu-id="3668a-204">This file contains the C/C++ symbols for the names and GUIDs of each counterset in the provider.</span></span> <span data-ttu-id="3668a-205">Los símbolos se pueden usar al escribir programas codificados de forma hard para consumir los datos de este contraconjunto mediante las funciones [perfLib V2 Consumer](using-the-perflib-functions-to-consume-counter-data.md).</span><span class="sxs-lookup"><span data-stu-id="3668a-205">The symbols can be used when writing programs that are hard-coded to consume the data from this counterset using the [PerfLib V2 Consumer functions](using-the-perflib-functions-to-consume-counter-data.md).</span></span>

## <a name="requirements"></a><span data-ttu-id="3668a-206">Requisitos</span><span class="sxs-lookup"><span data-stu-id="3668a-206">Requirements</span></span>

| <span data-ttu-id="3668a-207">Requisito</span><span class="sxs-lookup"><span data-stu-id="3668a-207">Requirement</span></span>             | <span data-ttu-id="3668a-208">Valor</span><span class="sxs-lookup"><span data-stu-id="3668a-208">Value</span></span> |
|-------------------------|-------|
| <span data-ttu-id="3668a-209">Cliente mínimo compatible</span><span class="sxs-lookup"><span data-stu-id="3668a-209">Minimum supported client</span></span>| <span data-ttu-id="3668a-210">Solo aplicaciones de escritorio de Windows Vista \[\]</span><span class="sxs-lookup"><span data-stu-id="3668a-210">Windows Vista \[desktop apps only\]</span></span>
| <span data-ttu-id="3668a-211">Servidor mínimo compatible</span><span class="sxs-lookup"><span data-stu-id="3668a-211">Minimum supported server</span></span>| <span data-ttu-id="3668a-212">Solo aplicaciones de escritorio de Windows Server 2008 \[\]</span><span class="sxs-lookup"><span data-stu-id="3668a-212">Windows Server 2008 \[desktop apps only\]</span></span>
