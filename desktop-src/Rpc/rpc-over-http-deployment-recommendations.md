---
title: Recomendaciones de implementación de RPC sobre HTTP
description: En esta sección se documentan los procedimientos recomendados y las configuraciones de implementación recomendadas para lograr la máxima seguridad y rendimiento cuando se usa RPC a través de HTTP.
ms.assetid: 83938a7d-77d0-45e8-b0a3-7b32ef768d83
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8871686d1fc8b87bcd6fb7ac4314b1977252f23a
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/16/2019
ms.locfileid: "104076179"
---
# <a name="rpc-over-http-deployment-recommendations"></a><span data-ttu-id="a883b-103">Recomendaciones de implementación de RPC sobre HTTP</span><span class="sxs-lookup"><span data-stu-id="a883b-103">RPC over HTTP Deployment Recommendations</span></span>

<span data-ttu-id="a883b-104">En esta sección se documentan los procedimientos recomendados y las configuraciones de implementación recomendadas para lograr la máxima seguridad y rendimiento cuando se usa RPC a través de HTTP.</span><span class="sxs-lookup"><span data-stu-id="a883b-104">This section documents best practices and recommended deployment configurations for achieving maximum security and performance when using RPC over HTTP.</span></span> <span data-ttu-id="a883b-105">Las distintas configuraciones que se encuentran en este documento se aplican a diferentes organizaciones en función de los distintos tamaños, presupuestos y requisitos de seguridad.</span><span class="sxs-lookup"><span data-stu-id="a883b-105">The various configurations found herein apply do different organizations based on various size, budget, and security requirements.</span></span> <span data-ttu-id="a883b-106">Cada configuración también proporciona consideraciones de implementación útiles para determinar cuál es la mejor opción para un escenario determinado.</span><span class="sxs-lookup"><span data-stu-id="a883b-106">Each configuration also provides deployment considerations useful in determining which is best for a given scenario.</span></span>

<span data-ttu-id="a883b-107">Para obtener información sobre escenarios de RPC a través de HTTP de gran volumen, consulte [equilibrio de carga de Microsoft RPC](rpc-load-balancing.md).</span><span class="sxs-lookup"><span data-stu-id="a883b-107">For information regarding high volume RPC over HTTP scenarios, please see [Microsoft RPC Load Balancing](rpc-load-balancing.md).</span></span>

<span data-ttu-id="a883b-108">Las siguientes recomendaciones se aplican a todas las configuraciones:</span><span class="sxs-lookup"><span data-stu-id="a883b-108">The following recommendations apply to all configurations:</span></span>

-   <span data-ttu-id="a883b-109">Usar versiones de Windows compatibles con RPC a través de HTTP V2.</span><span class="sxs-lookup"><span data-stu-id="a883b-109">Use versions of Windows that support RPC over HTTP v2.</span></span>
-   <span data-ttu-id="a883b-110">Ponga IIS en el equipo que ejecuta el proxy RPC en modo IIS 6,0.</span><span class="sxs-lookup"><span data-stu-id="a883b-110">Put IIS on the machine that runs the RPC Proxy in IIS 6.0 mode.</span></span>
-   <span data-ttu-id="a883b-111">No permitir el acceso anónimo al directorio virtual del proxy RPC.</span><span class="sxs-lookup"><span data-stu-id="a883b-111">Disallow anonymous access to the RPC Proxy virtual directory.</span></span>
-   <span data-ttu-id="a883b-112">No habilite nunca la clave del registro AllowAnonymous.</span><span class="sxs-lookup"><span data-stu-id="a883b-112">Never enable the AllowAnonymous registry key.</span></span>
-   <span data-ttu-id="a883b-113">Haga que los clientes RPC a través de HTTP usen **CertificateSubjectField** (consulte [**RpcBindingSetAuthInfoEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingsetauthinfoexa) para obtener más información) para comprobar que el proxy RPC al que se ha conectado es el proxy RPC que espera.</span><span class="sxs-lookup"><span data-stu-id="a883b-113">Make your RPC over HTTP clients use the **CertificateSubjectField** (see [**RpcBindingSetAuthInfoEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingsetauthinfoexa) for more information) to verify that the RPC Proxy you connected to is the RPC Proxy you expect.</span></span>
-   <span data-ttu-id="a883b-114">Configure la clave del registro **ValidPorts** para que contenga solo los equipos a los que se conectarán los clientes RPC a través de http.</span><span class="sxs-lookup"><span data-stu-id="a883b-114">Configure the **ValidPorts** registry key to contain only machines to which the RPC over HTTP clients will connect.</span></span>
-   <span data-ttu-id="a883b-115">No utilice caracteres comodín en la clave **ValidPorts** ; Si lo hace, puede ahorrar tiempo, pero un equipo completamente inesperado también puede ajustar el carácter comodín.</span><span class="sxs-lookup"><span data-stu-id="a883b-115">Do not use wildcards in the **ValidPorts** key; doing so can save time, but a completely unexpected machine may fit the wildcard as well.</span></span>
-   <span data-ttu-id="a883b-116">Usar SSL en clientes RPC a través de HTTP.</span><span class="sxs-lookup"><span data-stu-id="a883b-116">Use SSL on RPC over HTTP clients.</span></span> <span data-ttu-id="a883b-117">Si se siguen las directrices establecidas en estas secciones, el cliente RPC a través de HTTP no podrá conectarse sin usar SSL.</span><span class="sxs-lookup"><span data-stu-id="a883b-117">If the guidelines set forth in these sections are followed, the RPC over HTTP client will not be able to connect without using SSL.</span></span>
-   <span data-ttu-id="a883b-118">Configure los clientes RPC a través de HTTP para usar el cifrado RPC además de usar SSL.</span><span class="sxs-lookup"><span data-stu-id="a883b-118">Configure RPC over HTTP clients to use RPC Encryption in addition to using SSL.</span></span> <span data-ttu-id="a883b-119">Si el cliente RPC a través de HTTP no puede tener acceso al KDC, solo puede usar Negotiate y NTLM.</span><span class="sxs-lookup"><span data-stu-id="a883b-119">If the RPC over HTTP client cannot reach the KDC, it can use only Negotiate and NTLM.</span></span>
-   <span data-ttu-id="a883b-120">Configure los equipos cliente para que usen NTLMv2.</span><span class="sxs-lookup"><span data-stu-id="a883b-120">Configure client machines to use NTLMv2.</span></span> <span data-ttu-id="a883b-121">Establezca la clave del registro **LMCompatibilityLevel** en 2 o superior.</span><span class="sxs-lookup"><span data-stu-id="a883b-121">Set the **LMCompatibilityLevel** registry key to 2 or higher.</span></span> <span data-ttu-id="a883b-122">Vea **msdn.Microsoft.com** para obtener más información sobre la clave **LMCompatibilityLevel** .</span><span class="sxs-lookup"><span data-stu-id="a883b-122">See **msdn.microsoft.com** for more information on the **LMCompatibilityLevel** key.</span></span>
-   <span data-ttu-id="a883b-123">Ejecute una granja de servidores Web de máquinas proxy RPC con la configuración descrita anteriormente.</span><span class="sxs-lookup"><span data-stu-id="a883b-123">Run a web farm of RPC Proxy machines with the configuration outlined above.</span></span>
-   <span data-ttu-id="a883b-124">Implementar un firewall entre Internet y el proxy RPC.</span><span class="sxs-lookup"><span data-stu-id="a883b-124">Deploy a firewall between the Internet and the RPC Proxy.</span></span>
-   <span data-ttu-id="a883b-125">Para obtener un rendimiento óptimo, configure IIS para que envíe una respuesta corta para los códigos de error que no se hayan realizado correctamente.</span><span class="sxs-lookup"><span data-stu-id="a883b-125">For optimal performance, configure IIS to send a short response for non-success error codes.</span></span> <span data-ttu-id="a883b-126">Dado que el consumidor de la respuesta de IIS es un proceso automatizado, no es necesario que se envíen explicaciones fáciles de usar al cliente. simplemente se omitirán por el cliente RPC a través de HTTP.</span><span class="sxs-lookup"><span data-stu-id="a883b-126">Because the consumer of the IIS response is an automated process, there is no need for user friendly explanations to be sent to the client; they will simply be ignored by the RPC over HTTP client.</span></span>

<span data-ttu-id="a883b-127">Los objetivos básicos del proxy RPC desde el punto de vista de la seguridad, el rendimiento y la facilidad de administración son los siguientes:</span><span class="sxs-lookup"><span data-stu-id="a883b-127">The basic goals of the RPC Proxy from a security, performance and manageability perspective are the following:</span></span>

-   <span data-ttu-id="a883b-128">Proporcionar un único punto de entrada para el tráfico de RPC a través de HTTP en la red del servidor.</span><span class="sxs-lookup"><span data-stu-id="a883b-128">Provide a single point of entry for RPC over HTTP traffic into the server network.</span></span> <span data-ttu-id="a883b-129">Tener un único punto de entrada para el tráfico de RPC a través de HTTP en una red de servidor tiene dos ventajas principales.</span><span class="sxs-lookup"><span data-stu-id="a883b-129">Having a single point of entry for RPC over HTTP traffic into a server network has two main benefits.</span></span> <span data-ttu-id="a883b-130">En primer lugar, como el proxy RPC está orientado a Internet, la mayoría de las organizaciones aíslan esas máquinas en una red especial denominada red perimetral que no es de confianza, que es independiente de la red de la organización normal.</span><span class="sxs-lookup"><span data-stu-id="a883b-130">First, since the RPC Proxy is facing the Internet, most organizations isolate such machines in a special network called an untrusted perimeter network which is separate from the normal organizational network.</span></span> <span data-ttu-id="a883b-131">Los servidores de una red perimetral que no es de confianza se administran, configuran y supervisan cuidadosamente para poder resistir ataques de Internet.</span><span class="sxs-lookup"><span data-stu-id="a883b-131">Servers in an untrusted perimeter network are very carefully managed, configured and monitored to be able to withstand attacks from the Internet.</span></span> <span data-ttu-id="a883b-132">Cuanto menor sea el número de máquinas en una red perimetral que no sea de confianza, más fácil será configurar, administrar, supervisar y mantener la seguridad.</span><span class="sxs-lookup"><span data-stu-id="a883b-132">The fewer machines in an untrusted perimeter network, the easier it is to configure, manage, monitor and keep them secure.</span></span> <span data-ttu-id="a883b-133">En segundo lugar, puesto que una sola granja de servidores web con servidores proxy RPC instalados puede atender cualquier número de servidores RPC a través de HTTP que residan en la red corporativa, tiene mucho sentido separar el proxy RPC del servidor RPC a través de HTTP y hacer que el proxy RPC se encuentre en una red perimetral que no es de confianza.</span><span class="sxs-lookup"><span data-stu-id="a883b-133">Second, since a single Web Farm with RPC Proxies installed can service any number of RPC over HTTP Servers residing on the corporate network, it makes a lot of sense to separate the RPC Proxy from the RPC over HTTP Server and have the RPC Proxy reside in an untrusted perimeter network.</span></span> <span data-ttu-id="a883b-134">Si el proxy RPC estaba en el mismo equipo que el servidor RPC a través de HTTP, se forzaría a las organizaciones a poner todos los servidores back-end en una red perimetral que no sea de confianza, lo que dificultaría la protección de la red perimetral que no es de confianza.</span><span class="sxs-lookup"><span data-stu-id="a883b-134">If the RPC Proxy was on the same machine as the RPC over HTTP Server, organizations would be forced to put all of their back end servers into an untrusted perimeter network, which would make it much harder to keep the untrusted perimeter network secure.</span></span> <span data-ttu-id="a883b-135">Separar el rol del proxy RPC y el servidor RPC a través de HTTP ayuda a las organizaciones a mantener el número de equipos en una red perimetral que no es de confianza y, por tanto, más seguros.</span><span class="sxs-lookup"><span data-stu-id="a883b-135">Separating the role of the RPC Proxy and the RPC over HTTP server helps organizations keep the number of machines in an untrusted perimeter network manageable and therefore, more secure.</span></span>
-   <span data-ttu-id="a883b-136">Actúe como fusible de seguridad para la red del servidor.</span><span class="sxs-lookup"><span data-stu-id="a883b-136">Serve as a safety fuse for the server network.</span></span> <span data-ttu-id="a883b-137">El proxy RPC está diseñado como un fusible que se va a asignar a la red del servidor; si algo sale mal en el proxy RPC, simplemente se queda fuera y, por tanto, se protege el servidor RPC real a través de HTTP.</span><span class="sxs-lookup"><span data-stu-id="a883b-137">The RPC Proxy is designed as an expendable fuse for the server network – if something goes wrong on the RPC Proxy, it simply goes out and thus protects the real RPC over HTTP server.</span></span> <span data-ttu-id="a883b-138">Si se han seguido los procedimientos recomendados descritos en esta sección, el tráfico de RPC a través de HTTP se cifra con el cifrado RPC además de SSL.</span><span class="sxs-lookup"><span data-stu-id="a883b-138">If the outlined best practices outlined in this section have been followed thus far, the RPC over HTTP traffic is encrypted with RPC encryption in addition to SSL.</span></span> <span data-ttu-id="a883b-139">El propio cifrado RPC se encuentra entre el cliente y el servidor, no entre el cliente y el proxy.</span><span class="sxs-lookup"><span data-stu-id="a883b-139">The RPC Encryption itself is between the client and the server, not between the client and the proxy.</span></span> <span data-ttu-id="a883b-140">Esto significa que el proxy no entiende y no puede descifrar el tráfico RPC que recibe.</span><span class="sxs-lookup"><span data-stu-id="a883b-140">This means the proxy does not understand and cannot decrypt the RPC traffic it receives.</span></span> <span data-ttu-id="a883b-141">Solo entiende algunas secuencias de control que le envía el cliente que trabaja con el establecimiento de la conexión, el control de flujo y otros detalles de tunelización.</span><span class="sxs-lookup"><span data-stu-id="a883b-141">It only understands some control sequences sent to it by the client dealing with connection establishment, flow control and other tunneling details.</span></span> <span data-ttu-id="a883b-142">No tiene acceso a los datos que el cliente RPC a través de HTTP envía al servidor.</span><span class="sxs-lookup"><span data-stu-id="a883b-142">It has no access to the data the RPC over HTTP client sends to the server.</span></span> <span data-ttu-id="a883b-143">Además, el cliente RPC a través de HTTP debe autenticarse de forma independiente en el servidor proxy RPC y el servidor RPC a través de HTTP.</span><span class="sxs-lookup"><span data-stu-id="a883b-143">Furthermore, the RPC over HTTP client must independently authenticate to both the RPC Proxy and the RPC over HTTP server.</span></span> <span data-ttu-id="a883b-144">Esto proporciona una defensa en profundidad.</span><span class="sxs-lookup"><span data-stu-id="a883b-144">This provides defense in depth.</span></span> <span data-ttu-id="a883b-145">Si la máquina del proxy RPC se ve comprometida, debido a un error de configuración o a una infracción de seguridad de alguna ordenación, los datos que pasan a través de ella siguen siendo seguros contra la manipulación.</span><span class="sxs-lookup"><span data-stu-id="a883b-145">If the RPC Proxy machine becomes compromised, due to some configuration error or a security breach of some sort, the data that pass through it are still secure from tampering.</span></span> <span data-ttu-id="a883b-146">Un atacante que obtenga el control del proxy RPC puede, como máximo, interrumpir el tráfico, pero no leerlo ni manipularlo.</span><span class="sxs-lookup"><span data-stu-id="a883b-146">An attacker that would gain control of the RPC Proxy can at most interrupt the traffic, but not read it or tamper with it.</span></span> <span data-ttu-id="a883b-147">Aquí es donde entra en juego el rol del fusible del proxy RPC, es el que es más fácil sin la seguridad del tráfico de RPC a través de HTTP en peligro.</span><span class="sxs-lookup"><span data-stu-id="a883b-147">This is where the fuse role of the RPC Proxy comes into play – it is expendable without the security of the RPC over HTTP traffic being compromised.</span></span>
-   <span data-ttu-id="a883b-148">Distribuya algunas de las comprobaciones de acceso y el trabajo de descifrado entre varios equipos que ejecutan el proxy RPC en una granja de servidores Web.</span><span class="sxs-lookup"><span data-stu-id="a883b-148">Distribute some of the access checks and decryption work among multiple machines running RPC Proxy in a Web Farm.</span></span> <span data-ttu-id="a883b-149">Al funcionar bien en una granja de servidores Web, el proxy RPC permite a las organizaciones descargar el descifrado SSL y algunas de las comprobaciones de acceso, con lo que se libera más capacidad en el servidor back-end para su procesamiento.</span><span class="sxs-lookup"><span data-stu-id="a883b-149">By functioning well in a Web Farm, the RPC Proxy enables organizations to offload SSL decryption and some of the access checks, thus freeing more capacity on the back end server for processing.</span></span> <span data-ttu-id="a883b-150">El uso de una granja de servidores Web de máquinas proxy RPC también permite a una organización aumentar su capacidad para resistir ataques de denegación de servicio (DoS) al aumentar la capacidad en sus servidores front-end.</span><span class="sxs-lookup"><span data-stu-id="a883b-150">Using a Web Farm of RPC Proxy machines also enables an organization to increase its ability to withstand Denial of Service (DoS) attacks by increasing the capacity on its front end servers.</span></span>

<span data-ttu-id="a883b-151">Dentro de las directrices establecidas hasta el momento, las organizaciones todavía tienen opciones.</span><span class="sxs-lookup"><span data-stu-id="a883b-151">Within the guidelines set forth thus far, organizations still have choices.</span></span> <span data-ttu-id="a883b-152">Cada organización tiene opciones y peligros entre las molestias de los usuarios, la seguridad y el costo:</span><span class="sxs-lookup"><span data-stu-id="a883b-152">Each organization has choices and compromises between user inconvenience, security and cost:</span></span>

-   <span data-ttu-id="a883b-153">**¿Usar la autenticación básica o la autenticación integrada de Windows para autenticarse en el proxy RPC?**</span><span class="sxs-lookup"><span data-stu-id="a883b-153">**Use Basic Authentication or Windows Integrated Authentication to authenticate to the RPC Proxy?**</span></span> <span data-ttu-id="a883b-154">RPC a través de HTTP admite actualmente solo NTLM; no es compatible con Kerberos.</span><span class="sxs-lookup"><span data-stu-id="a883b-154">RPC over HTTP currently supports only NTLM – it doesn't support Kerberos.</span></span> <span data-ttu-id="a883b-155">Además, si hay un proxy HTTP o un firewall entre el cliente RPC a través de HTTP y el proxy RPC que inserta el *a través* de pragma en el encabezado HTTP, la autenticación NTLM no funcionará.</span><span class="sxs-lookup"><span data-stu-id="a883b-155">Also, if there is an HTTP Proxy or a firewall between the RPC over HTTP client and the RPC Proxy which inserts the *via* pragma in the HTTP header, NTLM authentication will not work.</span></span> <span data-ttu-id="a883b-156">Si no es así, las organizaciones pueden elegir entre la autenticación básica y NTLM.</span><span class="sxs-lookup"><span data-stu-id="a883b-156">When that is not the case, organizations can choose between Basic and NTLM authentication.</span></span> <span data-ttu-id="a883b-157">La ventaja de la autenticación básica es que es más rápida y más sencilla y, por lo tanto, ofrece menos oportunidades de ataques de denegación de servicio.</span><span class="sxs-lookup"><span data-stu-id="a883b-157">The advantage of Basic authentication is that it is faster and simpler, and therefore offers less opportunity for denial of service attacks.</span></span> <span data-ttu-id="a883b-158">Pero NTLM es más seguro.</span><span class="sxs-lookup"><span data-stu-id="a883b-158">But NTLM is more secure.</span></span> <span data-ttu-id="a883b-159">En función de las prioridades de la organización, puede elegir básico, NTLM o permitir que los usuarios elijan entre los dos.</span><span class="sxs-lookup"><span data-stu-id="a883b-159">Depending on an organization's priorities, it can choose Basic, NTLM, or allow its users to choose between the two.</span></span> <span data-ttu-id="a883b-160">Si solo se elige uno, es mejor desactivar el otro del directorio virtual del proxy RPC para reducir el riesgo de ataque.</span><span class="sxs-lookup"><span data-stu-id="a883b-160">If only one is chosen, it is best to turn off the other from the RPC Proxy virtual directory to reduce risk of attack.</span></span>
-   <span data-ttu-id="a883b-161">**¿Usar el mismo conjunto de credenciales para el proxy RPC y el servidor RPC a través de HTTP, o bien usar credenciales diferentes para cada uno?**</span><span class="sxs-lookup"><span data-stu-id="a883b-161">**Use the same set of credentials for both the RPC Proxy and the RPC over HTTP Server, or use different credentials for each?**</span></span> <span data-ttu-id="a883b-162">La desventaja de esta decisión es entre la comodidad y la seguridad del usuario.</span><span class="sxs-lookup"><span data-stu-id="a883b-162">The tradeoff for this decision is between user's convenience and security.</span></span> <span data-ttu-id="a883b-163">Pocos usuarios desean escribir varias credenciales.</span><span class="sxs-lookup"><span data-stu-id="a883b-163">Few users like to enter multiple credentials.</span></span> <span data-ttu-id="a883b-164">Sin embargo, si se produce una infracción de seguridad en una red perimetral que no es de confianza, tener conjuntos independientes de credenciales para el proxy RPC y el servidor RPC a través de HTTP proporciona protección adicional.</span><span class="sxs-lookup"><span data-stu-id="a883b-164">However, if a security breach occurs in an untrusted perimeter network, having separate sets of credentials for the RPC Proxy and the RPC over HTTP Server provides additional protection.</span></span> <span data-ttu-id="a883b-165">Tenga en cuenta que si se usan credenciales independientes y un conjunto de credenciales son las credenciales de dominio del usuario, es aconsejable utilizar las credenciales de dominio del usuario para el servidor RPC a través de HTTP y no para el proxy RPC.</span><span class="sxs-lookup"><span data-stu-id="a883b-165">Note that if separate credentials are used, and one set of credentials is the user's domain credentials, it is advisable to use the user's domain credentials for the RPC over HTTP Server and not for the RPC Proxy.</span></span>

 

 




