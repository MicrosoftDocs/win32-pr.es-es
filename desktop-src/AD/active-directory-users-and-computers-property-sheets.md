---
title: Hojas de propiedades de Active Directory usuarios y equipos
description: El complemento de MMC usuarios y equipos de Active Directory está diseñado para mostrar una hoja de propiedades de varios objetos en un servidor de Active Directory.
ms.assetid: 38032d89-9549-475c-90aa-dac5cfe11084
ms.tgt_platform: multiple
keywords:
- Active Directory de las hojas de propiedades usuarios y equipos en AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 30ea24f34e86f21af178e975852accb667bb69e4
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/17/2020
ms.locfileid: "103789651"
---
# <a name="active-directory-users-and-computers-property-sheets"></a><span data-ttu-id="dfa32-104">Hojas de propiedades de Active Directory usuarios y equipos</span><span class="sxs-lookup"><span data-stu-id="dfa32-104">Active Directory Users and Computers Property Sheets</span></span>

<span data-ttu-id="dfa32-105">El complemento de MMC usuarios y equipos de Active Directory está diseñado para mostrar una hoja de propiedades de varios objetos en un servidor de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="dfa32-105">The Active Directory Users and Computers MMC snap-in is designed to display a property sheet for various objects in an Active Directory server.</span></span> <span data-ttu-id="dfa32-106">La hoja de propiedades contiene una o varias páginas que se usan para ver y modificar los datos del objeto.</span><span class="sxs-lookup"><span data-stu-id="dfa32-106">The property sheet contains one or more pages that are used to view and modify object data.</span></span> <span data-ttu-id="dfa32-107">Se muestran diferentes conjuntos de páginas para los distintos tipos de objeto.</span><span class="sxs-lookup"><span data-stu-id="dfa32-107">Different object types have different sets of pages displayed for them.</span></span> <span data-ttu-id="dfa32-108">El complemento MMC usuarios y equipos de Active Directory también permite a los proveedores de terceros agregar páginas personalizadas a la hoja de propiedades de un tipo específico de objeto.</span><span class="sxs-lookup"><span data-stu-id="dfa32-108">The Active Directory Users and Computers MMC snap-in also enables third party vendors to add custom pages to the property sheet for a specific type of object.</span></span> <span data-ttu-id="dfa32-109">Para obtener más información, vea [páginas de propiedades para su uso con especificadores de presentación](property-pages-for-use-with-display-specifiers.md).</span><span class="sxs-lookup"><span data-stu-id="dfa32-109">For more information, see [Property Pages for Use with Display Specifiers](property-pages-for-use-with-display-specifiers.md).</span></span>

<span data-ttu-id="dfa32-110">Algunas aplicaciones, a excepción del complemento MMC de usuarios y equipos de Active Directory, deben proporcionar al usuario la posibilidad de ver y editar los atributos de un objeto en un servidor Active Directory.</span><span class="sxs-lookup"><span data-stu-id="dfa32-110">Some applications, other than the Active Directory Users and Computers MMC snap-in, must provide the user with the ability view and edit attributes for an object in an Active Directory server.</span></span> <span data-ttu-id="dfa32-111">La aplicación podría implementar sus propias hojas de propiedades, pero es mejor ofrecer una interfaz de usuario coherente para reducir la confusión y el tiempo de aprendizaje.</span><span class="sxs-lookup"><span data-stu-id="dfa32-111">The application could implement its own property sheets, but it is better to offer a consistent user interface to reduce confusion and learning time.</span></span> <span data-ttu-id="dfa32-112">Afortunadamente, el complemento de MMC usuarios y equipos de Active Directory permite que cualquier aplicación OLE COM muestre una hoja de propiedades para un objeto que es idéntica a la hoja de propiedades que se mostraría en el complemento MMC usuarios y equipos del Active Directory para el mismo objeto.</span><span class="sxs-lookup"><span data-stu-id="dfa32-112">Fortunately, the Active Directory Users and Computers MMC snap-in allows any OLE COM application to display a property sheet for an object that is identical to the property sheet that would be displayed by the Active Directory Users and Computers MMC snap-in for the same object.</span></span>

<span data-ttu-id="dfa32-113">Para obtener más información y un ejemplo de código que hospede una Active Directory hoja de propiedades usuarios y equipos, vea el ejemplo PropSheetHost en el kit de desarrollo de software (SDK) de la plataforma.</span><span class="sxs-lookup"><span data-stu-id="dfa32-113">For more information and a code example that hosts an Active Directory Users and Computers property sheet, see the PropSheetHost sample in the Platform Software Development Kit (SDK).</span></span>

## <a name="developer-audience"></a><span data-ttu-id="dfa32-114">Audiencia de los desarrolladores</span><span class="sxs-lookup"><span data-stu-id="dfa32-114">Developer Audience</span></span>

<span data-ttu-id="dfa32-115">En esta documentación se supone que el lector está familiarizado con el funcionamiento COM y el desarrollo de componentes mediante C++.</span><span class="sxs-lookup"><span data-stu-id="dfa32-115">This documentation assumes that the reader is familiar with COM operation and component development using C++.</span></span> <span data-ttu-id="dfa32-116">Actualmente, no es posible crear una extensión de hoja de propiedades Active Directory mediante Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="dfa32-116">Currently, it is not possible to create an Active Directory property sheet extension using Visual Basic.</span></span>

## <a name="hosting-an-active-directory-users-and-computers-property-sheet"></a><span data-ttu-id="dfa32-117">Hospedaje de una Active Directory hoja de propiedades usuarios y equipos</span><span class="sxs-lookup"><span data-stu-id="dfa32-117">Hosting an Active Directory Users and Computers Property Sheet</span></span>

<span data-ttu-id="dfa32-118">**Para mostrar una hoja de propiedades de un objeto en un servidor de Active Directory**</span><span class="sxs-lookup"><span data-stu-id="dfa32-118">**To display a property sheet for an object in an Active Directory server**</span></span>

1.  <span data-ttu-id="dfa32-119">Crea una ventana que se puede usar para procesar mensajes.</span><span class="sxs-lookup"><span data-stu-id="dfa32-119">Create a window that can be used to process messages.</span></span> <span data-ttu-id="dfa32-120">Puede tratarse de una ventana existente o una ventana de propósito especial.</span><span class="sxs-lookup"><span data-stu-id="dfa32-120">This can be an existing window or a special purpose window.</span></span> <span data-ttu-id="dfa32-121">Esto se conoce como la *ventana oculta*.</span><span class="sxs-lookup"><span data-stu-id="dfa32-121">This is known as the *hidden window*.</span></span>
2.  <span data-ttu-id="dfa32-122">Cree un objeto OLE COM que se derive de [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject).</span><span class="sxs-lookup"><span data-stu-id="dfa32-122">Create an OLE COM object that is derived from [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject).</span></span> <span data-ttu-id="dfa32-123">Este objeto de datos debe admitir los siguientes formatos de datos:</span><span class="sxs-lookup"><span data-stu-id="dfa32-123">This data object must support the following data formats:</span></span>

    -   <span data-ttu-id="dfa32-124">[**CFSTR \_ DSOBJECTNAMES**](cfstr-dsobjectnames.md) este formato de datos contiene un [**DSOBJECTNAMES**](/windows/desktop/api/Dsclient/ns-dsclient-dsobjectnames) que identifica el objeto al que se aplica la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="dfa32-124">[**CFSTR\_DSOBJECTNAMES**](cfstr-dsobjectnames.md) This data format contains a [**DSOBJECTNAMES**](/windows/desktop/api/Dsclient/ns-dsclient-dsobjectnames) that identifies the object that the property sheet applies to.</span></span> <span data-ttu-id="dfa32-125">Al hospedar una hoja de propiedades, los miembros más significativos de la estructura **DSOBJECTNAMES** se muestran en la lista siguiente.</span><span class="sxs-lookup"><span data-stu-id="dfa32-125">When hosting a property sheet, the more significant members of the **DSOBJECTNAMES** structure are shown in the following list.</span></span>

        <span data-ttu-id="dfa32-126">**clsidNamespace** Sector.</span><span class="sxs-lookup"><span data-stu-id="dfa32-126">**clsidNamespace** Reserved.</span></span> <span data-ttu-id="dfa32-127">Establezca este valor en un GUID para la aplicación en caso de que se use en el futuro.</span><span class="sxs-lookup"><span data-stu-id="dfa32-127">Set this to a GUID for your application here in case that it is used in the future.</span></span>
        
        <span data-ttu-id="dfa32-128">**aObjects** Contiene una matriz de estructuras [**DSBOJECT**](/windows/desktop/api/Dsclient/ns-dsclient-dsobject) .</span><span class="sxs-lookup"><span data-stu-id="dfa32-128">**aObjects** Contains an array of [**DSBOJECT**](/windows/desktop/api/Dsclient/ns-dsclient-dsobject) structures.</span></span> <span data-ttu-id="dfa32-129">Cada estructura **DSBOJECT** representa un objeto de directorio único.</span><span class="sxs-lookup"><span data-stu-id="dfa32-129">Each **DSBOJECT** structure represents a single directory object.</span></span> <span data-ttu-id="dfa32-130">El miembro **cItems** contiene el número de elementos de la matriz.</span><span class="sxs-lookup"><span data-stu-id="dfa32-130">The **cItems** member contains the number of elements in the array.</span></span> <span data-ttu-id="dfa32-131">Solo se usa el primer objeto de esta matriz.</span><span class="sxs-lookup"><span data-stu-id="dfa32-131">Only the first object in this array is used.</span></span> <span data-ttu-id="dfa32-132">Se omiten otros objetos.</span><span class="sxs-lookup"><span data-stu-id="dfa32-132">Other objects are ignored.</span></span>

    -   <span data-ttu-id="dfa32-133">[**CFSTR \_ DSDISPLAYSPECOPTIONS**](cfstr-ds-display-spec-options.md) este formato de datos contiene una estructura [**DSDISPLAYSPECOPTIONS**](/windows/desktop/api/Dsclient/ns-dsclient-dsdisplayspecoptions) que contiene los datos que usarán las páginas de propiedades, como dónde cargar las páginas de propiedades, el servidor y las credenciales que se van a usar, etc.</span><span class="sxs-lookup"><span data-stu-id="dfa32-133">[**CFSTR\_DSDISPLAYSPECOPTIONS**](cfstr-ds-display-spec-options.md) This data format contains a [**DSDISPLAYSPECOPTIONS**](/windows/desktop/api/Dsclient/ns-dsclient-dsdisplayspecoptions) structure that contains data that will be used by the property pages, such as where to load the property pages from, the server and credentials to use, and so on.</span></span> <span data-ttu-id="dfa32-134">Los miembros más importantes de **DSDISPLAYSPECOPTIONS** se muestran en la lista siguiente.</span><span class="sxs-lookup"><span data-stu-id="dfa32-134">The more significant members of the **DSDISPLAYSPECOPTIONS** are shown in the following list.</span></span>

        <span data-ttu-id="dfa32-135">**offsetAttribPrefix** La cadena de prefijo de atributo determina dónde se obtiene la lista de páginas de propiedades.</span><span class="sxs-lookup"><span data-stu-id="dfa32-135">**offsetAttribPrefix** The attribute prefix string determines where the list of property pages is obtained.</span></span> <span data-ttu-id="dfa32-136">Debe contener una de las siguientes cadenas.</span><span class="sxs-lookup"><span data-stu-id="dfa32-136">This must contain one of the following strings.</span></span>

        

        | <span data-ttu-id="dfa32-137">Cadena de prefijo de atributo</span><span class="sxs-lookup"><span data-stu-id="dfa32-137">Attribute prefix string</span></span> | <span data-ttu-id="dfa32-138">Descripción</span><span class="sxs-lookup"><span data-stu-id="dfa32-138">Description</span></span>                                              |
        |-------------------------|----------------------------------------------------------------------------------------------------------------------|
        | <span data-ttu-id="dfa32-139">administrar</span><span class="sxs-lookup"><span data-stu-id="dfa32-139">"admin"</span></span><br/>      | <span data-ttu-id="dfa32-140">Las páginas de propiedades se cargan desde el atributo [**adminPropertyPages**](/windows/desktop/ADSchema/a-adminpropertypages) .</span><span class="sxs-lookup"><span data-stu-id="dfa32-140">The property pages are loaded from the [**adminPropertyPages**](/windows/desktop/ADSchema/a-adminpropertypages) attribute.</span></span><br/> |
        | <span data-ttu-id="dfa32-141">interfaz</span><span class="sxs-lookup"><span data-stu-id="dfa32-141">"shell"</span></span><br/>      | <span data-ttu-id="dfa32-142">Las páginas de propiedades se cargan desde el atributo [**shellPropertyPages**](/windows/desktop/ADSchema/a-shellpropertypages) .</span><span class="sxs-lookup"><span data-stu-id="dfa32-142">The property pages are loaded from the [**shellPropertyPages**](/windows/desktop/ADSchema/a-shellpropertypages) attribute.</span></span><br/> |

        


    -   <span data-ttu-id="dfa32-143">[**CFSTR \_ \_PROPSHEETCONFIG DS**](cfstr-ds-propsheetconfig.md) este formato de datos contiene una estructura [**PROPSHEETCFG**](propsheetcfg.md) que contiene los datos del host de la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="dfa32-143">[**CFSTR\_DS\_PROPSHEETCONFIG**](cfstr-ds-propsheetconfig.md) This data format contains a [**PROPSHEETCFG**](propsheetcfg.md) structure that contains property sheet host data.</span></span> <span data-ttu-id="dfa32-144">Al hospedar una hoja de propiedades, los miembros más significativos de la estructura **PROPSHEETCFG** contienen los datos que se muestran en la lista siguiente.</span><span class="sxs-lookup"><span data-stu-id="dfa32-144">When hosting a property sheet, the more significant members of the **PROPSHEETCFG** structure contain the data shown in the following list.</span></span>

        <span data-ttu-id="dfa32-145">**lNotifyHandle** Debe ser cero.</span><span class="sxs-lookup"><span data-stu-id="dfa32-145">**lNotifyHandle** Must be zero.</span></span>
        <span data-ttu-id="dfa32-146">**hwndParentSheet**  Contiene el identificador de la ventana para recibir mensajes de [**\_ cambio de \_ notificación \_ de WM ADSPROP**](wm-adsprop-notify-change.md) cuando se cambia algo en una de las páginas y se aplica.</span><span class="sxs-lookup"><span data-stu-id="dfa32-146">**hwndParentSheet**  Contains the handle of the window to receive [**WM\_ADSPROP\_NOTIFY\_CHANGE**](wm-adsprop-notify-change.md) messages when something in one of the pages changes and is applied.</span></span> <span data-ttu-id="dfa32-147">Puede ser **null** si no se desea este mensaje.</span><span class="sxs-lookup"><span data-stu-id="dfa32-147">Can be **NULL** if this message is not desired.</span></span>

        <span data-ttu-id="dfa32-148">**hwndHidden** Contiene el identificador de la ventana para recibir los mensajes de notificación de la hoja de DSA de WM de la [**\_ creación de \_ \_ \_ notificaciones**](wm-dsa-sheet-create-notify.md) y de la [**\_ \_ hoja \_ \_ DSA de WM**](wm-dsa-sheet-close-notify.md) .</span><span class="sxs-lookup"><span data-stu-id="dfa32-148">**hwndHidden** Contains the handle of the window to receive [**WM\_DSA\_SHEET\_CREATE\_NOTIFY**](wm-dsa-sheet-create-notify.md) and [**WM\_DSA\_SHEET\_CLOSE\_NOTIFY**](wm-dsa-sheet-close-notify.md) messages.</span></span> <span data-ttu-id="dfa32-149">Establézcalo en el identificador de la ventana oculta.</span><span class="sxs-lookup"><span data-stu-id="dfa32-149">Set this to the handle of your hidden window.</span></span>

        <span data-ttu-id="dfa32-150">**wParamSheetClose** Contiene un identificador definido por la aplicación que se devuelve en el *wParam* en el mensaje de notificación de cierre de la [**\_ \_ hoja \_ \_ DSA de WM**](wm-dsa-sheet-close-notify.md) .</span><span class="sxs-lookup"><span data-stu-id="dfa32-150">**wParamSheetClose** Contains an application-defined identifier that is returned in the *wParam* in the [**WM\_DSA\_SHEET\_CLOSE\_NOTIFY**](wm-dsa-sheet-close-notify.md) message.</span></span> <span data-ttu-id="dfa32-151">Si este miembro es cero, el mensaje de notificación de cierre de la hoja del DSA de WM no se publicará en la ventana oculta. **\_ \_ \_ \_**</span><span class="sxs-lookup"><span data-stu-id="dfa32-151">If this member is zero, the **WM\_DSA\_SHEET\_CLOSE\_NOTIFY** message will not be posted to the hidden window.</span></span>


3.  <span data-ttu-id="dfa32-152">Cree una instancia del objeto [**CLSID \_ DsPropertyPages**](guids-of-user-interface-elements.md) y obtenga la interfaz [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) para el objeto.</span><span class="sxs-lookup"><span data-stu-id="dfa32-152">Create an instance of the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object and obtain the [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface for the object.</span></span> <span data-ttu-id="dfa32-153">También es posible duplicar el comportamiento del objeto **\_ DsPropertyPages de CLSID** .</span><span class="sxs-lookup"><span data-stu-id="dfa32-153">It is also possible to duplicate the behavior of the **CLSID\_DsPropertyPages** object.</span></span> <span data-ttu-id="dfa32-154">Para obtener más información, vea duplicar el comportamiento del \_ objeto DsPropertyPages de CLSID.</span><span class="sxs-lookup"><span data-stu-id="dfa32-154">For more information, see Duplicating the Behavior of the CLSID\_DsPropertyPages Object.</span></span>
4.  <span data-ttu-id="dfa32-155">Inicialice el objeto [**CLSID \_ DsPropertyPages**](guids-of-user-interface-elements.md) llamando al método [**IShellExtInit:: Initialize**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) .</span><span class="sxs-lookup"><span data-stu-id="dfa32-155">Initialize the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object by calling the [**IShellExtInit::Initialize**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) method.</span></span> <span data-ttu-id="dfa32-156">Los parámetros *pidlFolder* y *hkeyProgID* no se usan en este método.</span><span class="sxs-lookup"><span data-stu-id="dfa32-156">The *pidlFolder* and *hkeyProgID* parameters are not used in this method.</span></span> <span data-ttu-id="dfa32-157">El parámetro *pdtobj* es el puntero al objeto de datos creado en el paso 2.</span><span class="sxs-lookup"><span data-stu-id="dfa32-157">The *pdtobj* parameter is the pointer to the data object created in Step 2.</span></span> <span data-ttu-id="dfa32-158">Cuando se llama al método **IShellExtInit:: Initialize** , el **objeto \_ DsPropertyPages de CLSID** guardará una referencia al objeto de datos.</span><span class="sxs-lookup"><span data-stu-id="dfa32-158">When the **IShellExtInit::Initialize** method is called, the **CLSID\_DsPropertyPages** object will save a reference to the data object.</span></span>
5.  <span data-ttu-id="dfa32-159">Obtenga la interfaz [**IShellPropSheetExt**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext) para el [**objeto \_ DsPropertyPages de CLSID**](guids-of-user-interface-elements.md) y llame al método [**IShellPropSheetExt:: AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) .</span><span class="sxs-lookup"><span data-stu-id="dfa32-159">Obtain the [**IShellPropSheetExt**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext) interface for the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object and call the [**IShellPropSheetExt::AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) method.</span></span> <span data-ttu-id="dfa32-160">El parámetro *lpfnAddPage* es la dirección de una función de devolución de llamada que se debe implementar.</span><span class="sxs-lookup"><span data-stu-id="dfa32-160">The *lpfnAddPage* parameter is the address of a callback function that you must implement.</span></span> <span data-ttu-id="dfa32-161">A continuación se muestra el formato de esta función.</span><span class="sxs-lookup"><span data-stu-id="dfa32-161">The format of this function is shown below.</span></span> <span data-ttu-id="dfa32-162">Si la función de devolución de llamada se declara como un miembro de una clase de C++, la función de devolución de llamada se debe declarar como **estática**.</span><span class="sxs-lookup"><span data-stu-id="dfa32-162">If the callback function is declared as a member of a C++ class, the callback function must be declared as **static**.</span></span> <span data-ttu-id="dfa32-163">El parámetro *lParam* es un valor definido por la aplicación que se puede utilizar para identificar el objeto que implementa la función de devolución de llamada.</span><span class="sxs-lookup"><span data-stu-id="dfa32-163">The *lParam* parameter is an application-defined value that can be used to identify the object that implements the callback function.</span></span> <span data-ttu-id="dfa32-164">Cuando se llama al método **IShellPropSheetExt:: AddPages** , el **objeto \_ DsPropertyPages de CLSID** obtendrá los datos del objeto de datos y enumerará las páginas de propiedades registradas para los especificadores de presentación de objetos.</span><span class="sxs-lookup"><span data-stu-id="dfa32-164">When the **IShellPropSheetExt::AddPages** method is called, the **CLSID\_DsPropertyPages** object will obtain the data from the data object and enumerate the property pages registered for the object display specifiers.</span></span> <span data-ttu-id="dfa32-165">El objeto **CLSID \_ DsPropertyPages** enumerará los objetos de la página de propiedades, llamando al método **IShellPropSheetExt:: AddPages** de cada objeto.</span><span class="sxs-lookup"><span data-stu-id="dfa32-165">The **CLSID\_DsPropertyPages** object will then enumerate the property page objects, calling each object's **IShellPropSheetExt::AddPages** method.</span></span>

    ```C++
    BOOL CALLBACK AddPagesCallback(HPROPSHEETPAGE, LPARAM)
    ```

    

6.  <span data-ttu-id="dfa32-166">Cada página agregada por los objetos de la página de propiedades dará como resultado la llamada a la función de devolución de llamada con el identificador de la página de propiedades y el valor definido por la aplicación.</span><span class="sxs-lookup"><span data-stu-id="dfa32-166">Each page added by the property page objects will result in your callback function being called with the handle to the property page and the application-defined value.</span></span> <span data-ttu-id="dfa32-167">La función de devolución de llamada debe almacenar cada identificador de página de propiedades que se pasa.</span><span class="sxs-lookup"><span data-stu-id="dfa32-167">Your callback function must store each property page handle that is passed.</span></span> <span data-ttu-id="dfa32-168">Cuando el método [**IShellPropSheetExt:: AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) del objeto [**\_ DsPropertyPages CLSID**](guids-of-user-interface-elements.md) devuelva, se agregarán todas las páginas a través de la función de devolución de llamada.</span><span class="sxs-lookup"><span data-stu-id="dfa32-168">When the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object's [**IShellPropSheetExt::AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) method returns, all pages will have been added via your callback function.</span></span>
7.  <span data-ttu-id="dfa32-169">Rellene una estructura [**PROPSHEETHEADER**](/windows/win32/api/prsht/ns-prsht-propsheetheadera_v2) para mostrar la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="dfa32-169">Fill in a [**PROPSHEETHEADER**](/windows/win32/api/prsht/ns-prsht-propsheetheadera_v2) structure to display the property sheet.</span></span> <span data-ttu-id="dfa32-170">El miembro **phpage** recibe un puntero a una matriz de identificadores de página recopilados por la función de devolución de llamada.</span><span class="sxs-lookup"><span data-stu-id="dfa32-170">The **phpage** member receives a pointer to an array of page handles that were collected by your callback function.</span></span> <span data-ttu-id="dfa32-171">El miembro **nPages** recibe el número de páginas de la matriz de identificadores de página.</span><span class="sxs-lookup"><span data-stu-id="dfa32-171">The **nPages** member receives the number of pages in the page handle array.</span></span>
8.  <span data-ttu-id="dfa32-172">Para mostrar la hoja de propiedades, llame a la función [**hoja**](/windows/win32/api/prsht/nf-prsht-propertysheeta) .</span><span class="sxs-lookup"><span data-stu-id="dfa32-172">Display the property sheet by calling the [**PropertySheet**](/windows/win32/api/prsht/nf-prsht-propertysheeta) function.</span></span>

<span data-ttu-id="dfa32-173">Si se cambian los datos de cualquier página y se hace clic en los botones **Aceptar** o **aplicar** , la ventana identificada por el miembro **hwndParentSheet** de la estructura [**PROPSHEETCFG**](propsheetcfg.md) recibirá un mensaje de [**notificación de \_ \_ \_ cambio de WM ADSPROP**](wm-adsprop-notify-change.md) .</span><span class="sxs-lookup"><span data-stu-id="dfa32-173">If the data in any page is changed and the **OK** or **Apply** buttons are clicked, the window identified by the **hwndParentSheet** member of the [**PROPSHEETCFG**](propsheetcfg.md) structure will receive a [**WM\_ADSPROP\_NOTIFY\_CHANGE**](wm-adsprop-notify-change.md) message.</span></span> <span data-ttu-id="dfa32-174">Este mensaje es estrictamente una notificación y no requiere ninguna acción específica.</span><span class="sxs-lookup"><span data-stu-id="dfa32-174">This message is strictly a notification and requires no specific action.</span></span>

<span data-ttu-id="dfa32-175">Cuando se cierra la página, la ventana identificada por el miembro **hwndHidden** de la estructura [**PROPSHEETCFG**](propsheetcfg.md) recibirá un mensaje de notificación de [**\_ \_ \_ cierre \_ de hoja DSA de WM**](wm-dsa-sheet-close-notify.md) .</span><span class="sxs-lookup"><span data-stu-id="dfa32-175">When the page is closed, the window identified by the **hwndHidden** member of the [**PROPSHEETCFG**](propsheetcfg.md) structure will receive a [**WM\_DSA\_SHEET\_CLOSE\_NOTIFY**](wm-dsa-sheet-close-notify.md) message.</span></span> <span data-ttu-id="dfa32-176">Este mensaje es estrictamente una notificación y no requiere que se realice ninguna acción específica.</span><span class="sxs-lookup"><span data-stu-id="dfa32-176">This message is strictly a notification and requires no specific action to be performed.</span></span>

<span data-ttu-id="dfa32-177">En algunos casos, las hojas de propiedades existentes deberán mostrar una hoja de propiedades secundaria.</span><span class="sxs-lookup"><span data-stu-id="dfa32-177">In some cases, the existing property sheets will need to display a secondary property sheet.</span></span> <span data-ttu-id="dfa32-178">Por ejemplo, si muestra la hoja de propiedades de un objeto de usuario y selecciona el **miembro de** la página, se mostrará una lista de los grupos de los que el usuario es miembro.</span><span class="sxs-lookup"><span data-stu-id="dfa32-178">For example, if you display the property sheet for a user object and select the **Member Of** page, a list of groups that the user is a member of will be displayed.</span></span> <span data-ttu-id="dfa32-179">Si hace doble clic en uno de estos grupos de la lista, se mostrará la hoja de propiedades de ese grupo.</span><span class="sxs-lookup"><span data-stu-id="dfa32-179">If you double-click one of these groups in the list, the property sheet for that group will be displayed.</span></span> <span data-ttu-id="dfa32-180">La hoja de propiedades principal no muestra la hoja secundaria por sí misma.</span><span class="sxs-lookup"><span data-stu-id="dfa32-180">The primary property sheet does not display the secondary sheet by itself.</span></span> <span data-ttu-id="dfa32-181">Solicita que el host muestre la hoja secundaria mediante el envío de un mensaje de [**\_ \_ \_ \_ notificación**](wm-dsa-sheet-create-notify.md) de la hoja de datos de WM DSA a la ventana identificada por el miembro **hwndHidden** de la estructura [**PROPSHEETCFG**](propsheetcfg.md) .</span><span class="sxs-lookup"><span data-stu-id="dfa32-181">It requests that the host display the secondary sheet by sending a [**WM\_DSA\_SHEET\_CREATE\_NOTIFY**](wm-dsa-sheet-create-notify.md) message to the window identified by the **hwndHidden** member of the [**PROPSHEETCFG**](propsheetcfg.md) structure.</span></span> <span data-ttu-id="dfa32-182">El *wParam* de la **hoja de WM \_ DSA \_ \_ crear \_** mensaje de notificación es un puntero a una estructura de [**\_ información de \_ página \_ de DSA sec**](dsa-sec-page-info.md) que contiene información sobre la hoja de propiedades secundaria y el objeto que representa.</span><span class="sxs-lookup"><span data-stu-id="dfa32-182">The *wParam* of the **WM\_DSA\_SHEET\_CREATE\_NOTIFY** message is a pointer to a [**DSA\_SEC\_PAGE\_INFO**](dsa-sec-page-info.md) structure that contains information about the secondary property sheet and the object that it represents.</span></span> <span data-ttu-id="dfa32-183">En respuesta a este mensaje, el host de la hoja de propiedades debe mostrar la hoja de propiedades secundaria de la misma manera que se mostró anteriormente.</span><span class="sxs-lookup"><span data-stu-id="dfa32-183">In response to this message, the property sheet host must display the secondary property sheet in the same manner as shown above.</span></span> <span data-ttu-id="dfa32-184">Después de procesar el mensaje de **\_ \_ \_ \_ notificación** de la hoja de DSA de WM, el receptor del mensaje debe liberar la estructura de  **información de página de DSA \_ \_ \_ sec** pasando el valor de wParam a la función [**LocalFree**](/windows/desktop/api/winbase/nf-winbase-localfree) .</span><span class="sxs-lookup"><span data-stu-id="dfa32-184">After processing the **WM\_DSA\_SHEET\_CREATE\_NOTIFY** message, the message receiver must free the **DSA\_SEC\_PAGE\_INFO** structure by passing the *wParam* value to the [**LocalFree**](/windows/desktop/api/winbase/nf-winbase-localfree) function.</span></span>

## <a name="duplicating-the-behavior-of-the-clsid_dspropertypages-object"></a><span data-ttu-id="dfa32-185">Duplicar el comportamiento del objeto CLSID \_ DsPropertyPages</span><span class="sxs-lookup"><span data-stu-id="dfa32-185">Duplicating the Behavior of the CLSID\_DsPropertyPages Object</span></span>

<span data-ttu-id="dfa32-186">**Para duplicar el comportamiento del \_ objeto CLSID DsPropertyPages**</span><span class="sxs-lookup"><span data-stu-id="dfa32-186">**To duplicate the behavior of the CLSID\_DsPropertyPages object**</span></span>

1.  <span data-ttu-id="dfa32-187">Enumere los valores del atributo [**adminPropertyPages**](/windows/desktop/ADSchema/a-adminpropertypages) o [**shellPropertyPages**](/windows/desktop/ADSchema/a-shellpropertypages) para el especificador de presentación de la clase de objeto.</span><span class="sxs-lookup"><span data-stu-id="dfa32-187">Enumerate the values in the [**adminPropertyPages**](/windows/desktop/ADSchema/a-adminpropertypages) or [**shellPropertyPages**](/windows/desktop/ADSchema/a-shellpropertypages) attribute for the display specifier for the object class.</span></span> <span data-ttu-id="dfa32-188">Cada valor es una cadena que contiene un número, seguido de una coma, seguida de la representación de cadena del identificador de clase de la extensión de la página de propiedades.</span><span class="sxs-lookup"><span data-stu-id="dfa32-188">Each value is a string that contains a number, followed by a comma, followed by the string representation of the class identifier of the property page extension.</span></span> <span data-ttu-id="dfa32-189">Para obtener más información sobre el formato de los valores del especificador de presentación de las páginas de propiedades, vea [registrar la página de propiedades de un objeto com en un especificador de presentación](registering-the-property-page-com-object-in-a-display-specifier.md).</span><span class="sxs-lookup"><span data-stu-id="dfa32-189">For more information about the format of the property pages display specifier values, see [Registering the Property Page COM Object in a Display Specifier](registering-the-property-page-com-object-in-a-display-specifier.md).</span></span>
2.  <span data-ttu-id="dfa32-190">Convierta cada cadena de identificador de clase en un **CLSID** mediante la función [**CLSIDFromString**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) .</span><span class="sxs-lookup"><span data-stu-id="dfa32-190">Convert each class identifier string into a **CLSID** using the [**CLSIDFromString**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) function.</span></span>
3.  <span data-ttu-id="dfa32-191">Ordene los identificadores de clase de extensión por el número que precede a cada cadena de identificador de clase en el valor de atributo.</span><span class="sxs-lookup"><span data-stu-id="dfa32-191">Sort the extension class identifiers by the number that precedes each class identifier string in the attribute value.</span></span> <span data-ttu-id="dfa32-192">Si dos números son idénticos, ordene los identificadores de clase en el orden en que se obtienen los valores de atributo del servidor de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="dfa32-192">If two numbers are identical, sort the class identifiers in the order that the attribute values are obtained from the Active Directory server.</span></span>
4.  <span data-ttu-id="dfa32-193">Enumera los identificadores de clase de extensión y crea una instancia de cada extensión.</span><span class="sxs-lookup"><span data-stu-id="dfa32-193">Enumerate the extension class identifiers, creating an instance of each extension.</span></span>
5.  <span data-ttu-id="dfa32-194">Para cada extensión, en el orden anterior, llame a [**IShellExtInit:: Initialize**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) de la extensión con la misma información que se describe en el paso 4 del procedimiento de la hoja de propiedades Hosting a Active Directory Users and Computers.</span><span class="sxs-lookup"><span data-stu-id="dfa32-194">For each extension, in the order sorted above, call the extension's [**IShellExtInit::Initialize**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) with the same information described in Step 4 of the Hosting an Active Directory Users and Computers Property Sheet procedure.</span></span>
6.  <span data-ttu-id="dfa32-195">Para cada extensión, en el orden indicado anteriormente, llame a [**IShellPropSheetExt:: AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) de la extensión con la misma información que se describe en el paso 5 del procedimiento de la hoja de propiedades hospedar un Active Directory usuarios y equipos.</span><span class="sxs-lookup"><span data-stu-id="dfa32-195">For each extension, in the order sorted above, call the extension's [**IShellPropSheetExt::AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) with the same information described in Step 5 of the Hosting an Active Directory Users and Computers Property Sheet procedure.</span></span>

<span data-ttu-id="dfa32-196">Si es posible, use el objeto [**CLSID \_ DsPropertyPages**](guids-of-user-interface-elements.md) para crear las páginas en lugar de hacerlo manualmente.</span><span class="sxs-lookup"><span data-stu-id="dfa32-196">If possible, use the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object to create the pages rather than do this manually.</span></span> <span data-ttu-id="dfa32-197">El **\_ DsPropertyPages CLSID** se ha optimizado y controla correctamente los casos de error, como cuando no hay ningún especificador de pantalla disponible para la configuración regional actual.</span><span class="sxs-lookup"><span data-stu-id="dfa32-197">The **CLSID\_DsPropertyPages** has been optimized and will correctly handle failure cases, such as when no display specifier is available for the current locale.</span></span> <span data-ttu-id="dfa32-198">Además, el **objeto \_ DsPropertyPages CLSID** puede cambiar en el futuro, lo que significa que las hojas de propiedades pueden no coincidir exactamente con las mostradas por el complemento MMC usuarios y equipos de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="dfa32-198">Also, the **CLSID\_DsPropertyPages** object may change in the future, which means your property sheets may not exactly match those displayed by the Active Directory Users and Computers MMC snap-in.</span></span>

## <a name="special-programming-elements"></a><span data-ttu-id="dfa32-199">Elementos de programación especiales</span><span class="sxs-lookup"><span data-stu-id="dfa32-199">Special Programming Elements</span></span>

<span data-ttu-id="dfa32-200">Actualmente, los siguientes elementos de programación no se definen en un archivo de encabezado publicado.</span><span class="sxs-lookup"><span data-stu-id="dfa32-200">Currently, the following programming elements are not defined in a published header file.</span></span> <span data-ttu-id="dfa32-201">Para usar estos elementos, debe definirlos usted mismo en el formato exacto que se muestra en la página de referencia determinada.</span><span class="sxs-lookup"><span data-stu-id="dfa32-201">To use these elements, you must define them yourself in the exact format shown in the particular reference page.</span></span>

-   [<span data-ttu-id="dfa32-202">**CFSTR \_ DS \_ PROPSHEETCONFIG**</span><span class="sxs-lookup"><span data-stu-id="dfa32-202">**CFSTR\_DS\_PROPSHEETCONFIG**</span></span>](cfstr-ds-propsheetconfig.md)
-   [<span data-ttu-id="dfa32-203">**PROPSHEETCFG**</span><span class="sxs-lookup"><span data-stu-id="dfa32-203">**PROPSHEETCFG**</span></span>](propsheetcfg.md)
-   [<span data-ttu-id="dfa32-204">**\_notificación de \_ cierre de hoja DSA \_ de WM \_**</span><span class="sxs-lookup"><span data-stu-id="dfa32-204">**WM\_DSA\_SHEET\_CLOSE\_NOTIFY**</span></span>](wm-dsa-sheet-close-notify.md)
-   [<span data-ttu-id="dfa32-205">**\_ \_ \_ crear notificación de la hoja DSA de WM \_**</span><span class="sxs-lookup"><span data-stu-id="dfa32-205">**WM\_DSA\_SHEET\_CREATE\_NOTIFY**</span></span>](wm-dsa-sheet-create-notify.md)
-   [<span data-ttu-id="dfa32-206">**información de página de DSA \_ s \_ \_**</span><span class="sxs-lookup"><span data-stu-id="dfa32-206">**DSA\_SEC\_PAGE\_INFO**</span></span>](dsa-sec-page-info.md)

## <a name="example-code"></a><span data-ttu-id="dfa32-207">Código de ejemplo</span><span class="sxs-lookup"><span data-stu-id="dfa32-207">Example Code</span></span>

<span data-ttu-id="dfa32-208">En el ejemplo de código de C++ siguiente se muestra una manera segura de definir estos elementos que seguirán funcionando aunque estos elementos se hayan definido en un archivo de encabezado publicado en el futuro.</span><span class="sxs-lookup"><span data-stu-id="dfa32-208">The following C++ code example shows a safe way to define these elements that will continue to work even if these elements are defined in a published header file in the future.</span></span>


```C++
#ifndef CFSTR_DS_PROPSHEETCONFIG
    #define CFSTR_DS_PROPSHEETCONFIG_W L"DsPropSheetCfgClipFormat"
    #define CFSTR_DS_PROPSHEETCONFIG_A "DsPropSheetCfgClipFormat"

    #ifdef UNICODE
        #define CFSTR_DS_PROPSHEETCONFIG CFSTR_DS_PROPSHEETCONFIG_W
    #else
        #define CFSTR_DS_PROPSHEETCONFIG CFSTR_DS_PROPSHEETCONFIG_A
    #endif //UNICODE
#endif //CFSTR_DS_PROPSHEETCONFIG


#ifndef WM_ADSPROP_SHEET_CREATE
    #define WM_ADSPROP_SHEET_CREATE (WM_USER + 1108)
#endif


#ifndef WM_DSA_SHEET_CREATE_NOTIFY
    #define WM_DSA_SHEET_CREATE_NOTIFY (WM_USER + 6)
#endif


#ifndef WM_DSA_SHEET_CLOSE_NOTIFY
    #define WM_DSA_SHEET_CLOSE_NOTIFY (WM_USER + 5) 
#endif


#ifndef DSA_SEC_PAGE_INFO
    typedef struct _DSA_SEC_PAGE_INFO
    {
        HWND    hwndParentSheet;
        DWORD   offsetTitle;
        DSOBJECTNAMES dsObjectNames;
    } DSA_SEC_PAGE_INFO, *PDSA_SEC_PAGE_INFO;
#endif //DSA_SEC_PAGE_INFO

#ifndef PROPSHEETCFG
    typedef struct _PROPSHEETCFG
    {  
        LONG_PTR lNotifyHandle;  
        HWND hwndParentSheet;  
        HWND hwndHidden;  
        WPARAM wParamSheetClose;
    } PROPSHEETCFG, *PPROPSHEETCFG;
#endif //PROPSHEETCFG
```



 

