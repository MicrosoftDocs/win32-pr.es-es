---
title: Cadenas de intercambio
description: Las cadenas de intercambio controlan la rotación del búfer de reserva, formando la base de la animación de gráficos.
ms.assetid: AABF5FDE-DB49-4B29-BC0E-032E0C7DF9EB
ms.localizationpriority: high
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ebbc7ec1b62ba620b42bc85c1c1f491ff7ba952d
ms.sourcegitcommit: 5b98bf8c68922f8f03c14f793fbe17504900559c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 02/12/2021
ms.locfileid: "104549127"
---
# <a name="swap-chains"></a><span data-ttu-id="5f92d-103">Cadenas de intercambio</span><span class="sxs-lookup"><span data-stu-id="5f92d-103">Swap Chains</span></span>

<span data-ttu-id="5f92d-104">Las cadenas de intercambio controlan la rotación del búfer de reserva, formando la base de la animación de gráficos.</span><span class="sxs-lookup"><span data-stu-id="5f92d-104">Swap chains control the back buffer rotation, forming the basis of graphics animation.</span></span>

## <a name="overview"></a><span data-ttu-id="5f92d-105">Información general</span><span class="sxs-lookup"><span data-stu-id="5f92d-105">Overview</span></span>

<span data-ttu-id="5f92d-106">El modelo de programación para las cadenas de intercambio en Direct3D 12 no es idéntico al de las versiones anteriores de D3D.</span><span class="sxs-lookup"><span data-stu-id="5f92d-106">The programming model for swap chains in Direct3D 12 is not identical to that in earlier versions of D3D.</span></span> <span data-ttu-id="5f92d-107">La comodidad de la programación, por ejemplo, la compatibilidad con la rotación de recursos automática que se encontraba en D3D10 y D3D11 no se admite ahora.</span><span class="sxs-lookup"><span data-stu-id="5f92d-107">The programming convenience, for example, of supporting automatic resource rotation that was present in D3D10 and D3D11 is not now supported.</span></span> <span data-ttu-id="5f92d-108">Las aplicaciones habilitadas para la rotación automática de recursos para representar el mismo objeto de API mientras que la superficie real que se representa cambia cada fotograma.</span><span class="sxs-lookup"><span data-stu-id="5f92d-108">Automatic resource rotation enabled apps to render the same API object while the actual surface being rendered changes each frame.</span></span> <span data-ttu-id="5f92d-109">El comportamiento de las cadenas de intercambio cambia con Direct3D 12 para permitir que otras características de Direct3D 12 tengan una sobrecarga de CPU baja.</span><span class="sxs-lookup"><span data-stu-id="5f92d-109">The behavior of swap chains is changed with Direct3D 12 to enable other features of Direct3D 12 to have low CPU overhead.</span></span> <span data-ttu-id="5f92d-110">La clave de color automática y el muestreo múltiple no se admiten, aunque en particular la ampliación y la rotación siguen siendo.</span><span class="sxs-lookup"><span data-stu-id="5f92d-110">Automatic color key and multisampling are not supported, although notably stretching and rotation still are.</span></span>

### <a name="buffer-lifetime"></a><span data-ttu-id="5f92d-111">Duración del búfer</span><span class="sxs-lookup"><span data-stu-id="5f92d-111">Buffer lifetime</span></span>

<span data-ttu-id="5f92d-112">Las aplicaciones pueden almacenar descriptores creados previamente que hacen referencia a búferes de reserva que se habilitan al garantizar que el conjunto de búferes que pertenecen a una cadena de intercambio no cambia nunca durante la duración de la cadena de intercambio.</span><span class="sxs-lookup"><span data-stu-id="5f92d-112">Apps are allowed to store pre-created descriptors which reference back buffers This is enabled by ensuring that the set of buffers owned by a swap chain never changes for the lifetime of the swap chain.</span></span> <span data-ttu-id="5f92d-113">El conjunto de búferes devueltos por [**IDXGISwapChain:: getBuffer**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-getbuffer) no cambia hasta que se llama a determinadas API:</span><span class="sxs-lookup"><span data-stu-id="5f92d-113">The set of buffers returned by [**IDXGISwapChain::GetBuffer**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-getbuffer) doesn't change until certain APIs are called:</span></span>

-   [<span data-ttu-id="5f92d-114">**IDXGISwapChain::ResizeTarget**</span><span class="sxs-lookup"><span data-stu-id="5f92d-114">**IDXGISwapChain::ResizeTarget**</span></span>](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget)
-   [<span data-ttu-id="5f92d-115">**IDXGISwapChain::ResizeBuffers**</span><span class="sxs-lookup"><span data-stu-id="5f92d-115">**IDXGISwapChain::ResizeBuffers**</span></span>](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizebuffers)

<span data-ttu-id="5f92d-116">El orden de los búferes devueltos por [**getBuffer**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-getbuffer) nunca cambia.</span><span class="sxs-lookup"><span data-stu-id="5f92d-116">The order of buffers returned by [**GetBuffer**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-getbuffer) never changes.</span></span>

<span data-ttu-id="5f92d-117">[**IDXGISwapChain3:: GetCurrentBackBufferIndex**](/windows/desktop/api/dxgi1_4/nf-dxgi1_4-idxgiswapchain3-getcurrentbackbufferindex) devuelve el índice del búfer de retroceso actual a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="5f92d-117">[**IDXGISwapChain3::GetCurrentBackBufferIndex**](/windows/desktop/api/dxgi1_4/nf-dxgi1_4-idxgiswapchain3-getcurrentbackbufferindex) returns the index of the current back buffer to the app.</span></span>

### <a name="swap-effects"></a><span data-ttu-id="5f92d-118">Efectos de intercambio</span><span class="sxs-lookup"><span data-stu-id="5f92d-118">Swap effects</span></span>

<span data-ttu-id="5f92d-119">Los únicos efectos de intercambio admitidos son [**DXGI_SWAP_EFFECT_FLIP_SEQUENTIAL**](/windows/win32/api/dxgi/ne-dxgi-dxgi_swap_effect) y [**DXGI_SWAP_EFFECT_FLIP_DISCARD**](/windows/win32/api/dxgi/ne-dxgi-dxgi_swap_effect), que requiere que el número de búferes sea mayor que uno.</span><span class="sxs-lookup"><span data-stu-id="5f92d-119">The only supported swap effects are [**DXGI_SWAP_EFFECT_FLIP_SEQUENTIAL**](/windows/win32/api/dxgi/ne-dxgi-dxgi_swap_effect) and [**DXGI_SWAP_EFFECT_FLIP_DISCARD**](/windows/win32/api/dxgi/ne-dxgi-dxgi_swap_effect), which requires the buffer count to be greater than one.</span></span>

### <a name="transitioning-between-windowed-and-full-screen-modes"></a><span data-ttu-id="5f92d-120">Transición entre los modos de ventana y de pantalla completa</span><span class="sxs-lookup"><span data-stu-id="5f92d-120">Transitioning between windowed and full-screen modes</span></span>

<span data-ttu-id="5f92d-121">Direct3D 12 no es compatible con el modo exclusivo de pantalla completa (FSE).</span><span class="sxs-lookup"><span data-stu-id="5f92d-121">Direct3D 12 doesn't support full-screen exclusive mode (FSE).</span></span> <span data-ttu-id="5f92d-122">En su lugar, cuando un juego es la única aplicación visible en pantalla, el sistema operativo usa una estrategia denominada optimizaciones de pantalla completa (FSO) para lograr un efecto similar en FSE sin las desventajas de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="5f92d-122">Instead, when a game is the only visible application on-screen, the OS uses a strategy called full-screen optimisations (FSO) to achieve a similar effect to FSE without the performance drawbacks.</span></span> <span data-ttu-id="5f92d-123">Para obtener más información acerca de FSO, consulte [desmitificación de las optimizaciones de pantalla completa](https://devblogs.microsoft.com/directx/demystifying-full-screen-optimizations/).</span><span class="sxs-lookup"><span data-stu-id="5f92d-123">For more info about FSO, see [Demystifying Fullscreen Optimisations](https://devblogs.microsoft.com/directx/demystifying-full-screen-optimizations/).</span></span>

<span data-ttu-id="5f92d-124">Direct3D 12 mantiene la restricción de que las aplicaciones deben llamar a [**ResizeBuffers**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizebuffers) después de la transición entre los modos de ventana y de pantalla completa (las cadenas de intercambio de D3D11 Flip-Model tienen las mismas restricciones).</span><span class="sxs-lookup"><span data-stu-id="5f92d-124">Direct3D 12 maintains the restriction that applications must call [**ResizeBuffers**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizebuffers) after transitioning between windowed and full-screen modes (D3D11 flip-model swap chains have the same restrictions).</span></span>

<span data-ttu-id="5f92d-125">Las transiciones [**IDXGISwapChain:: SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate) no cambian el conjunto de búferes visibles para la aplicación en la cadena de intercambio.</span><span class="sxs-lookup"><span data-stu-id="5f92d-125">The [**IDXGISwapChain::SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate) transitions do not change the set of app-visible buffers in the swap chain.</span></span> <span data-ttu-id="5f92d-126">Solo las llamadas a [**ResizeBuffers**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizebuffers) y [**ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget) crean o destruyen búferes visibles para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="5f92d-126">Only the [**ResizeBuffers**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizebuffers) and [**ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget) calls create or destroy app-visible buffers.</span></span> <span data-ttu-id="5f92d-127">Sin embargo, en Direct3D 12 [**IDXGISwapChain:: SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate) no entra en modo exclusivo de pantalla completa y simplemente cambia las resoluciones y las tasas de actualización para permitir las optimizaciones de pantalla completa.</span><span class="sxs-lookup"><span data-stu-id="5f92d-127">However, in Direct3D 12 [**IDXGISwapChain::SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate) doesn't enter full-screen exclusive mode, and simply changes resolutions and refresh rates to allow full-screen optimisations.</span></span> <span data-ttu-id="5f92d-128">Estos cambios pueden realizarse mediante una aplicación sin el uso de este método.</span><span class="sxs-lookup"><span data-stu-id="5f92d-128">These changes can be made by an app without the use of this method</span></span>

<span data-ttu-id="5f92d-129">When o [**IDXGISwapChain::P reenviar**](/windows/win32/api/dxgi/nf-dxgi-idxgiswapchain-present) o IDXGISwapChain1: se llama a [**reenviar:P**](/windows/desktop/api/dxgi1_2/nf-dxgi1_2-idxgiswapchain1-present1) , el búfer de reserva que se va a presentar debe estar en el estado de la [**presentación de estado de recursos de D3D12 \_ \_ \_**](/windows/desktop/api/d3d12/ne-d3d12-d3d12_resource_states) .</span><span class="sxs-lookup"><span data-stu-id="5f92d-129">When or [**IDXGISwapChain::Present**](/windows/win32/api/dxgi/nf-dxgi-idxgiswapchain-present) or [**IDXGISwapChain1::Present**](/windows/desktop/api/dxgi1_2/nf-dxgi1_2-idxgiswapchain1-present1) is called, the back buffer to be presented must be in the [**D3D12\_RESOURCE\_STATE\_PRESENT**](/windows/desktop/api/d3d12/ne-d3d12-d3d12_resource_states) state.</span></span> <span data-ttu-id="5f92d-130">Present producirá un **error en la \_ \_ \_ llamada no válida de DXGI** si no es así.</span><span class="sxs-lookup"><span data-stu-id="5f92d-130">Present will fail with **DXGI\_ERROR\_INVALID\_CALL** if this is not the case.</span></span>

<span data-ttu-id="5f92d-131">Las cadenas de intercambio de pantalla completa continúan teniendo la restricción de que se debe llamar a [**SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate)(false, null) antes de la versión final de la cadena de intercambio.</span><span class="sxs-lookup"><span data-stu-id="5f92d-131">Full-screen swap chains continue to have the restriction that [**SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate)(FALSE, NULL) must be called before the final release of the swap chain.</span></span> <span data-ttu-id="5f92d-132">**SetFullscreenState**(false) se realiza correctamente en las cadenas de intercambio que se ejecutan en dispositivos de Direct3D 12.</span><span class="sxs-lookup"><span data-stu-id="5f92d-132">**SetFullscreenState**(FALSE) succeeds on swap chains running on Direct3D 12 devices.</span></span>

<span data-ttu-id="5f92d-133">Las operaciones de presentación se producen en la cola 3D proporcionada en la creación de intercambio y las aplicaciones pueden presentar simultáneamente varias cadenas de intercambio y grabar y ejecutar listas de comandos.</span><span class="sxs-lookup"><span data-stu-id="5f92d-133">Present operations occur on the 3D queue provided at swapchain creation, and apps are free to concurrently present multiple swap chains, and record and execute command lists.</span></span>

<span data-ttu-id="5f92d-134">Cuando la parte final del trabajo de gráficos (por ejemplo, el procesamiento de fotogramas) se realiza en una cola de proceso o no implica la cola de gráficos del dispositivo, la creación de una segunda cola 3D para presentarla puede ser beneficiosa y evitar que la latencia de la presentación retrase el inicio del fotograma siguiente.</span><span class="sxs-lookup"><span data-stu-id="5f92d-134">When the final part of the graphics work (for example, frame postprocessing) is done on a compute queue, or doesn't involve the device's graphics queue, creating a second 3D queue to present on can be beneficial and prevent the latency of presentation delaying the start of the next frame.</span></span> 

### <a name="example"></a><span data-ttu-id="5f92d-135">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="5f92d-135">Example</span></span>

<span data-ttu-id="5f92d-136">El siguiente código de ejemplo aparecería en el bucle de representación principal:</span><span class="sxs-lookup"><span data-stu-id="5f92d-136">The following example code would be present in the main rendering loop:</span></span>

```cpp
void Present()
{
    m_swapChain->Present(0, m_presentFlags);
    m_backBufferIndex = (m_backBufferIndex + 1) % m_backBufferCount;
}
```

### <a name="creating-swap-chains"></a><span data-ttu-id="5f92d-137">Crear cadenas de intercambio</span><span class="sxs-lookup"><span data-stu-id="5f92d-137">Creating swap chains</span></span>

<span data-ttu-id="5f92d-138">Al usar las llamadas a [**CreateSwapChainForHwnd**](/windows/desktop/api/dxgi1_2/nf-dxgi1_2-idxgifactory2-createswapchainforhwnd), [**CreateSwapChainForCoreWindow**](/windows/desktop/api/dxgi1_2/nf-dxgi1_2-idxgifactory2-createswapchainforcorewindow)o [**CreateSwapChainForComposition**](/windows/desktop/api/dxgi1_2/nf-dxgi1_2-idxgifactory2-createswapchainforcomposition) , tenga en cuenta que el parámetro *pDevice* realmente requiere un puntero a una cola de comandos directa en Direct3D 12, y no un dispositivo.</span><span class="sxs-lookup"><span data-stu-id="5f92d-138">When using the [**CreateSwapChainForHwnd**](/windows/desktop/api/dxgi1_2/nf-dxgi1_2-idxgifactory2-createswapchainforhwnd), [**CreateSwapChainForCoreWindow**](/windows/desktop/api/dxgi1_2/nf-dxgi1_2-idxgifactory2-createswapchainforcorewindow), or [**CreateSwapChainForComposition**](/windows/desktop/api/dxgi1_2/nf-dxgi1_2-idxgifactory2-createswapchainforcomposition) calls, note that the *pDevice* parameter actually requires a pointer to a direct command queue in Direct3D 12, and not a device.</span></span>

### <a name="presenting-on-windows-7"></a><span data-ttu-id="5f92d-139">Presentación en Windows 7</span><span class="sxs-lookup"><span data-stu-id="5f92d-139">Presenting on Windows 7</span></span>

<span data-ttu-id="5f92d-140">Cuando el destino es Direct3D 12 en Windows 7, los tipos de DXGI necesarios para Direct3D 12 no están presentes, por lo que debe usar el **ID3D12CommandQueueDownLevel** proporcionado por D3D12On7 (consultado fuera de la cola de comandos directa) para presentar.</span><span class="sxs-lookup"><span data-stu-id="5f92d-140">When targeting Direct3D 12 on Windows 7, the necessary DXGI types for Direct3D 12 are not present, so you must use the D3D12On7-provided **ID3D12CommandQueueDownLevel** (queried off of the direct command queue) to present.</span></span>

<span data-ttu-id="5f92d-141">Debe proporcionar una lista de comandos abierta al método de presentación de Windows 7, que se usará, se cerrará y se enviará automáticamente al dispositivo.</span><span class="sxs-lookup"><span data-stu-id="5f92d-141">You provide an open command list to the Windows 7 present method, which will then be used, closed, and automatically submitted to the device for you.</span></span> <span data-ttu-id="5f92d-142">Debe proporcionar un búfer de reserva que se debe crear en la aplicación, debe ser un recurso confirmado, tener una sola muestra y debe tener uno de los siguientes formatos.</span><span class="sxs-lookup"><span data-stu-id="5f92d-142">You must provide a back buffer which must be app-created, must be a committed resource, must be single-sampled, and must be one of the following formats.</span></span>

* <span data-ttu-id="5f92d-143">**DXGI_FORMAT_R16G16B16A16_FLOAT**</span><span class="sxs-lookup"><span data-stu-id="5f92d-143">**DXGI_FORMAT_R16G16B16A16_FLOAT**</span></span>
* <span data-ttu-id="5f92d-144">**DXGI_FORMAT_R10G10B10A2_UNORM**</span><span class="sxs-lookup"><span data-stu-id="5f92d-144">**DXGI_FORMAT_R10G10B10A2_UNORM**</span></span>
* <span data-ttu-id="5f92d-145">**DXGI_FORMAT_R8G8B8A8_UNORM**</span><span class="sxs-lookup"><span data-stu-id="5f92d-145">**DXGI_FORMAT_R8G8B8A8_UNORM**</span></span>
* <span data-ttu-id="5f92d-146">**DXGI_FORMAT_R8G8B8A8_UNORM_SRGB**</span><span class="sxs-lookup"><span data-stu-id="5f92d-146">**DXGI_FORMAT_R8G8B8A8_UNORM_SRGB**</span></span>
* <span data-ttu-id="5f92d-147">**DXGI_FORMAT_B8G8R8X8_UNORM**</span><span class="sxs-lookup"><span data-stu-id="5f92d-147">**DXGI_FORMAT_B8G8R8X8_UNORM**</span></span>
* <span data-ttu-id="5f92d-148">**DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM**</span><span class="sxs-lookup"><span data-stu-id="5f92d-148">**DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM**</span></span>
* <span data-ttu-id="5f92d-149">**DXGI_FORMAT_B8G8R8A8_UNORM**</span><span class="sxs-lookup"><span data-stu-id="5f92d-149">**DXGI_FORMAT_B8G8R8A8_UNORM**</span></span>
* <span data-ttu-id="5f92d-150">**DXGI_FORMAT_B8G8R8A8_UNORM_SRGB**</span><span class="sxs-lookup"><span data-stu-id="5f92d-150">**DXGI_FORMAT_B8G8R8A8_UNORM_SRGB**</span></span>

## <a name="related-topics"></a><span data-ttu-id="5f92d-151">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="5f92d-151">Related topics</span></span>

* [<span data-ttu-id="5f92d-152">D3D12_HEAP_FLAGS</span><span class="sxs-lookup"><span data-stu-id="5f92d-152">D3D12_HEAP_FLAGS</span></span>](/windows/win32/api/d3d12/ne-d3d12-d3d12_heap_flags)
* [<span data-ttu-id="5f92d-153">Tutoriales de vídeo de aprendizaje avanzado de DirectX: velocidad de fotogramas no limitada</span><span class="sxs-lookup"><span data-stu-id="5f92d-153">DirectX advanced learning video tutorials : Unthrottled Framerate</span></span>](https://www.youtube.com/watch?v=wn02zCXa9IU)
* [<span data-ttu-id="5f92d-154">Representación</span><span class="sxs-lookup"><span data-stu-id="5f92d-154">Rendering</span></span>](rendering.md)
