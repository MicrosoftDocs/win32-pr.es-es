---
title: Patrones de control Text y TextRange
description: Describe las directrices y convenciones para implementar ITextProvider, ITextProvider2 y ITextRangeProvider, incluida información sobre propiedades y métodos.
ms.assetid: 4d541c31-11f7-4d7e-a0e0-9ed1da873d07
keywords:
- Automatización de la interfaz de usuario, implementar el patrón de control Text
- Automatización de la interfaz de usuario, implementar el patrón de control TextRange
- Automatización de la interfaz de usuario, patrón de control Text
- Automatización de la interfaz de usuario, patrón de control TextRange
- Automatización de la interfaz de usuario, ITextProvider
- Automatización de la interfaz de usuario, ITextRangeProvider
- ITextProvider
- ITextRangeProvider
- implementar el patrón de control Text de UI Automation
- implementar el patrón de control TextRange de automatización de la interfaz de usuario
- Text (patrón de control)
- TextRange (patrón de control)
- patrones de control, ITextProvider
- patrones de control, ITextRangeProvider
- patrones de control, implementar texto de automatización de la interfaz de usuario
- patrones de control, implementar la automatización de la interfaz de usuario
- patrones de control, texto
- patrones de control, TextRange
- interfaces, ITextProvider
- interfaces, ITextRangeProvider
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f53429dc8ec137a83b6a40db377b5c84aeb36120
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104555463"
---
# <a name="text-and-textrange-control-patterns"></a><span data-ttu-id="2855a-123">Patrones de control Text y TextRange</span><span class="sxs-lookup"><span data-stu-id="2855a-123">Text and TextRange Control Patterns</span></span>

<span data-ttu-id="2855a-124">Describe las directrices y convenciones para implementar [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider), [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2)y [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider), incluida información sobre propiedades y métodos.</span><span class="sxs-lookup"><span data-stu-id="2855a-124">Describes guidelines and conventions for implementing [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider), [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2), and [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider), including information about properties and methods.</span></span> <span data-ttu-id="2855a-125">El patrón de control **Text** permite a las aplicaciones y los controles exponer un modelo de objetos de texto simple, lo que permite a los clientes recuperar contenido textual, atributos de texto y objetos incrustados de controles basados en texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-125">The **Text** control pattern enables applications and controls to expose a simple text object model, enabling clients to retrieve textual content, text attributes, and embedded objects from text-based controls.</span></span>

<span data-ttu-id="2855a-126">Para admitir el patrón de control **Text** , los controles implementan las interfaces [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) y [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) .</span><span class="sxs-lookup"><span data-stu-id="2855a-126">To support the **Text** control pattern, controls implement the [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) and [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) interfaces.</span></span> <span data-ttu-id="2855a-127">Los tipos de control que deben admitir el patrón de control **Text** incluyen los tipos de control de [edición](uiauto-supporteditcontroltype.md) y de [documento](uiauto-supportdocumentcontroltype.md) , así como cualquier otro tipo de control que permita al usuario escribir texto o seleccionar texto de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="2855a-127">Control types that should support the **Text** control pattern include the [Edit](uiauto-supporteditcontroltype.md) and [Document](uiauto-supportdocumentcontroltype.md) control types, and any other control type that enables the user to enter text or select read-only text.</span></span>

<span data-ttu-id="2855a-128">El patrón de control **Text** se puede usar con otros patrones de control de automatización de la interfaz de usuario de Microsoft para admitir varios tipos de objetos incrustados en el texto, como tablas, hipervínculos y botones de comando.</span><span class="sxs-lookup"><span data-stu-id="2855a-128">The **Text** control pattern can be used with other Microsoft UI Automation control patterns to support several types of embedded objects in the text, including tables, hyperlinks, and command buttons.</span></span>

<span data-ttu-id="2855a-129">Las interfaces [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) y [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) incluyen una serie de métodos para la adquisición de intervalos de texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-129">The [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) and [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) interfaces include a number of methods for acquiring text ranges.</span></span> <span data-ttu-id="2855a-130">Un *intervalo de texto* es un objeto que representa un intervalo contiguo de texto, o varios intervalos separados de texto, en un contenedor de texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-130">A *text range* is an object that represents a contiguous span of text—or multiple, disjoint spans of text—in a text container.</span></span> <span data-ttu-id="2855a-131">Un método **ITextProvider** adquiere un intervalo de texto que representa todo el documento, mientras que otros usuarios adquieren intervalos de texto que representan parte del documento, como el texto seleccionado, el texto visible o un objeto incrustado en el texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-131">One **ITextProvider** method acquires a text range that represents the entire document, while others acquire text ranges that represent some portion of the document, such as the selected text, the visible text, or an object embedded in the text.</span></span>

<span data-ttu-id="2855a-132">Un objeto de intervalo de texto se representa mediante el patrón de control **TextRange** , que se implementa a través de la interfaz [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) .</span><span class="sxs-lookup"><span data-stu-id="2855a-132">A text range object is represented by the **TextRange** control pattern, which is implemented through the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface.</span></span> <span data-ttu-id="2855a-133">El patrón de control **TextRange** proporciona métodos y propiedades que se usan para exponer información sobre el texto del intervalo, para desplazar los extremos del intervalo, seleccionar o anular la selección de texto, desplazar el rango a la vista, etc.</span><span class="sxs-lookup"><span data-stu-id="2855a-133">The **TextRange** control pattern provides methods and properties used to expose information about the text in the range, move the endpoints of the range, select or deselect text, scroll the range into view, and so on.</span></span>

<span data-ttu-id="2855a-134">Para obtener más información sobre los patrones de control **Text** y **TextRange** , vea [compatibilidad de UI Automation para el contenido textual](uiauto-ui-automation-textpattern-overview.md).</span><span class="sxs-lookup"><span data-stu-id="2855a-134">For more information about the **Text** and **TextRange** control patterns, see [UI Automation Support for Textual Content](uiauto-ui-automation-textpattern-overview.md).</span></span>

<span data-ttu-id="2855a-135">A partir de Windows 8.1 los proveedores pueden implementar la interfaz [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) .</span><span class="sxs-lookup"><span data-stu-id="2855a-135">Starting with Windows 8.1 providers can implement the [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) interface.</span></span> <span data-ttu-id="2855a-136">Esto permite invocar menús contextuales que están asociados a un intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-136">This enables invoking context menus that are associated with a text range.</span></span> <span data-ttu-id="2855a-137">Esto es compatible con escenarios como la corrección de texto o la selección candidata del editor de métodos de entrada (IME).</span><span class="sxs-lookup"><span data-stu-id="2855a-137">This supports scenarios such as text autocorrection or Input Method Editor (IME) candidate selection.</span></span>

<span data-ttu-id="2855a-138">En este tema se incluyen las siguientes secciones.</span><span class="sxs-lookup"><span data-stu-id="2855a-138">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="2855a-139">Directrices y convenciones de implementación</span><span class="sxs-lookup"><span data-stu-id="2855a-139">Implementation Guidelines and Conventions</span></span>](#implementation-guidelines-and-conventions)
-   [<span data-ttu-id="2855a-140">Miembros requeridos para **ITextProvider**</span><span class="sxs-lookup"><span data-stu-id="2855a-140">Required Members for **ITextProvider**</span></span>](#required-members-for-itextprovider)
-   [<span data-ttu-id="2855a-141">Miembros requeridos para **ITextRangeProvider**</span><span class="sxs-lookup"><span data-stu-id="2855a-141">Required Members for **ITextRangeProvider**</span></span>](#required-members-for-itextrangeprovider)
-   [<span data-ttu-id="2855a-142">Intervalos de texto compatibles</span><span class="sxs-lookup"><span data-stu-id="2855a-142">Supporting Text Ranges</span></span>](#supporting-text-ranges)
    -   [<span data-ttu-id="2855a-143">Manipular un intervalo de texto por unidad de texto</span><span class="sxs-lookup"><span data-stu-id="2855a-143">Manipulating a Text Range by Text Unit</span></span>](#manipulating-a-text-range-by-text-unit)
    -   [<span data-ttu-id="2855a-144">Seleccionar texto en un intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="2855a-144">Selecting Text in a Text Range</span></span>](#selecting-text-in-a-text-range)
    -   [<span data-ttu-id="2855a-145">Adquirir texto de un intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="2855a-145">Acquiring Text from a Text Range</span></span>](#acquiring-text-from-a-text-range)
    -   [<span data-ttu-id="2855a-146">Implementación de ShowContextMenu</span><span class="sxs-lookup"><span data-stu-id="2855a-146">Implementing ShowContextMenu</span></span>](#implementing-showcontextmenu)
-   [<span data-ttu-id="2855a-147">Interoperabilidad con el símbolo de intercalación del sistema</span><span class="sxs-lookup"><span data-stu-id="2855a-147">Interoperability with the System Caret</span></span>](#interoperability-with-the-system-caret)
-   [<span data-ttu-id="2855a-148">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="2855a-148">Related topics</span></span>](#related-topics)

## <a name="implementation-guidelines-and-conventions"></a><span data-ttu-id="2855a-149">Directrices y convenciones de implementación</span><span class="sxs-lookup"><span data-stu-id="2855a-149">Implementation Guidelines and Conventions</span></span>

<span data-ttu-id="2855a-150">Al implementar el patrón de control **Text** , tenga en cuenta las siguientes directrices y convenciones:</span><span class="sxs-lookup"><span data-stu-id="2855a-150">When implementing the **Text** control pattern, note the following guidelines and conventions:</span></span>

-   <span data-ttu-id="2855a-151">Cualquier control que permita el acceso a texto (por ejemplo, al escribir texto o seleccionar texto de solo lectura) debe admitir el patrón de control **Text** .</span><span class="sxs-lookup"><span data-stu-id="2855a-151">Any control that enables access to text (for example, entering text or selecting read-only text) should support the **Text** control pattern.</span></span>
-   <span data-ttu-id="2855a-152">El patrón de control **Text** se puede usar con cualquier elemento de la interfaz de usuario que presente texto, incluso una etiqueta estática en un control de botón estándar.</span><span class="sxs-lookup"><span data-stu-id="2855a-152">The **Text** control pattern can be used with any UI element that presents text, even a static label on a standard button control.</span></span> <span data-ttu-id="2855a-153">Sin embargo, no es necesario en los controles de texto estático que no se pueden seleccionar o no tienen un punto de inserción.</span><span class="sxs-lookup"><span data-stu-id="2855a-153">However, it is not required on static text controls that cannot be selected or do not have an insertion point.</span></span>
-   <span data-ttu-id="2855a-154">Para asegurarse de que el texto es totalmente accesible, los controles que implementan [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) también deben admitir la interfaz [**IValueProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider) .</span><span class="sxs-lookup"><span data-stu-id="2855a-154">To ensure that text is fully accessible, controls that implement [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) should also support the [**IValueProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider) interface.</span></span> <span data-ttu-id="2855a-155">**IValueProvider** complementa **ITextProvider** proporcionando una manera programática de cambiar el texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-155">**IValueProvider** complements **ITextProvider** by providing a programmatic way to change the text.</span></span> <span data-ttu-id="2855a-156">También ofrece mayor compatibilidad con las aplicaciones cliente de tecnología de asistencia, incluidas las basadas en tecnologías heredadas como Microsoft Active Accessibility.</span><span class="sxs-lookup"><span data-stu-id="2855a-156">It also offers greater compatibility with assistive technology client applications, including those based on legacy technologies such as Microsoft Active Accessibility.</span></span> <span data-ttu-id="2855a-157">Cuando se implementan ambos patrones de control, el evento **TextChanged** ([**UIA \_ Text \_ TextChangedEventId**](uiauto-event-ids.md)) y el evento **AutomationPropertyChanged** ([**UIA \_ AutomationPropertyChangedEventId**](uiauto-event-ids.md)) son equivalentes a la propiedad **Value** ([**UIA \_ ValueValuePropertyId**](uiauto-control-pattern-propids.md)).</span><span class="sxs-lookup"><span data-stu-id="2855a-157">When both control patterns are implemented, the **TextChanged** event ([**UIA\_Text\_TextChangedEventId**](uiauto-event-ids.md)) and **AutomationPropertyChanged** event ([**UIA\_AutomationPropertyChangedEventId**](uiauto-event-ids.md)) are equivalent for the **Value** property ([**UIA\_ValueValuePropertyId**](uiauto-control-pattern-propids.md)).</span></span> <span data-ttu-id="2855a-158">Ambos eventos deben ser compatibles.</span><span class="sxs-lookup"><span data-stu-id="2855a-158">Both events must be supported.</span></span>
-   <span data-ttu-id="2855a-159">El patrón de control **Text** solo admite un flujo de texto y una ventanilla por control.</span><span class="sxs-lookup"><span data-stu-id="2855a-159">The **Text** control pattern supports only one stream of text and one viewport per control.</span></span> <span data-ttu-id="2855a-160">Si la aplicación ofrece varias vistas de documento en paneles, cada vista (control) debe admitir [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) de forma independiente.</span><span class="sxs-lookup"><span data-stu-id="2855a-160">If the application offers multiple views of document in panes, each view (control) should support [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) independently.</span></span>
-   <span data-ttu-id="2855a-161">El método [**ITextProvider:: getSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) puede devolver un solo intervalo de texto que representa el texto seleccionado actualmente.</span><span class="sxs-lookup"><span data-stu-id="2855a-161">The [**ITextProvider::GetSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) method may return a single text range representing the currently selected text.</span></span> <span data-ttu-id="2855a-162">Si un control admite la selección de varios intervalos de texto no contiguos, el método **getSelection** debe devolver una matriz que contenga una interfaz [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) para cada intervalo de texto seleccionado.</span><span class="sxs-lookup"><span data-stu-id="2855a-162">If a control supports the selection of multiple, noncontiguous spans of text, the **GetSelection** method should return an array that contains one [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface for each selected span of text.</span></span>
-   <span data-ttu-id="2855a-163">El patrón de control **Text** representa el punto de inserción como un intervalo de texto degenerado (vacío).</span><span class="sxs-lookup"><span data-stu-id="2855a-163">The **Text** control pattern represents the insertion point as a degenerate (empty) text range.</span></span> <span data-ttu-id="2855a-164">El método [**ITextProvider:: getSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) debe devolver un intervalo de texto degenerado cuando el punto de inserción existe y no se ha seleccionado ningún texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-164">The [**ITextProvider::GetSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) method should return a degenerate text range when the insertion point exists and no text is selected.</span></span> <span data-ttu-id="2855a-165">Para obtener más información, consulte [interoperabilidad con el símbolo de intercalación del sistema](#interoperability-with-the-system-caret).</span><span class="sxs-lookup"><span data-stu-id="2855a-165">For more information, see [Interoperability with the System Caret](#interoperability-with-the-system-caret).</span></span>
-   <span data-ttu-id="2855a-166">El método [**ITextProvider:: GetVisibleRanges**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getvisibleranges) puede devolver un solo intervalo de texto si hay un intervalo de texto contiguo visible en la ventanilla, o puede devolver una matriz de intervalos de texto separados que representan varias líneas de texto visibles parcialmente.</span><span class="sxs-lookup"><span data-stu-id="2855a-166">The [**ITextProvider::GetVisibleRanges**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getvisibleranges) method may return a single text range if a contiguous range of text is visible in the viewport, or it may return an array of disjoint text ranges representing multiple, partially visible lines of text.</span></span>
-   <span data-ttu-id="2855a-167">El método [**ITextProvider:: RangeFromChild**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild) debe devolver un intervalo degenerado si el elemento secundario no contiene texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-167">The [**ITextProvider::RangeFromChild**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild) method should return a degenerate range if the child element contains no text.</span></span> <span data-ttu-id="2855a-168">Dado que un objeto incrustado puede incluir texto, el método **RangeFromChild** no siempre devuelve un intervalo de texto degenerado.</span><span class="sxs-lookup"><span data-stu-id="2855a-168">Because an embedded object can include text, the **RangeFromChild** method may not always return a degenerate text range.</span></span> <span data-ttu-id="2855a-169">Para obtener más información, vea [cómo la automatización de la interfaz de usuario expone objetos incrustados](uiauto-textpattern-and-embedded-objects-overview.md).</span><span class="sxs-lookup"><span data-stu-id="2855a-169">For more information, see [How UI Automation Exposes Embedded Objects](uiauto-textpattern-and-embedded-objects-overview.md).</span></span>
-   <span data-ttu-id="2855a-170">El método [**ITextProvider:: RangeFromPoint**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) realiza la prueba de posicionamiento en el área de documento usando las coordenadas de pantalla especificadas.</span><span class="sxs-lookup"><span data-stu-id="2855a-170">The [**ITextProvider::RangeFromPoint**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) method performs hit testing in the document area using the specified screen coordinates.</span></span> <span data-ttu-id="2855a-171">El intervalo de texto resultante debe ser coherente con el punto de inserción o la selección que resultaría de hacer clic en la ubicación en las coordenadas de pantalla especificadas.</span><span class="sxs-lookup"><span data-stu-id="2855a-171">The resulting text range should be consistent with the insertion point or selection that would result from clicking the location at the specified screen coordinates.</span></span> <span data-ttu-id="2855a-172">Por ejemplo, si una imagen se encuentra en las coordenadas de pantalla especificadas, el intervalo de texto resultante debe ser el mismo que el intervalo de texto que el método [**ITextProvider:: RangeFromChild**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild) adquiriría para la imagen.</span><span class="sxs-lookup"><span data-stu-id="2855a-172">For example, if an image resides at the specified screen coordinates, the resulting text range should be the same as the text range that the [**ITextProvider::RangeFromChild**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild) method would acquire for the image.</span></span> <span data-ttu-id="2855a-173">Del mismo modo, si una aplicación cliente solicita un intervalo de texto para la ubicación en el centro del símbolo de intercalación del sistema (punto de inserción), el intervalo de texto resultante debe ser el mismo que el de la ubicación del símbolo de intercalación del sistema.</span><span class="sxs-lookup"><span data-stu-id="2855a-173">Similarly, if a client application requests a text range for the location at the center of the system caret (the insertion point), the resulting text range should be the same as the system caret location.</span></span>
-   <span data-ttu-id="2855a-174">La propiedad [**ITextProvider::D ocumentrange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange) siempre debe proporcionar un intervalo de texto que incluya todo el texto admitido por la implementación [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) correspondiente.</span><span class="sxs-lookup"><span data-stu-id="2855a-174">The [**ITextProvider::DocumentRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange) property should always provide a text range that includes all of the text supported by the corresponding [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) implementation.</span></span>
-   <span data-ttu-id="2855a-175">El [**evento \_ \_ TextChangedEventId de texto de UIA**](uiauto-event-ids.md) debe generarse después de que se produzca cualquier cambio de texto, aunque el cambio no esté visible en la ventanilla.</span><span class="sxs-lookup"><span data-stu-id="2855a-175">The [**UIA\_Text\_TextChangedEventId**](uiauto-event-ids.md) event must be raised after any text change occurs, even if the change is not visible in the viewport.</span></span> <span data-ttu-id="2855a-176">Por ejemplo, el proveedor debe generar el evento incluso si el usuario pega exactamente el mismo texto sobre el texto seleccionado.</span><span class="sxs-lookup"><span data-stu-id="2855a-176">For example, the provider should raise the event even if the user pastes the exact same text over the selected text.</span></span>
-   <span data-ttu-id="2855a-177">El [**\_ \_ TextSelectionChangedEventId de texto de UIA**](uiauto-event-ids.md) debe generarse cada vez que cambie la selección de texto, o cada vez que el punto de inserción (símbolo de intercalación) se mueva entre el texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-177">The [**UIA\_Text\_TextSelectionChangedEventId**](uiauto-event-ids.md) must be raised whenever the selection of text changes, or whenever the insertion point (caret) moves among the text.</span></span>

<span data-ttu-id="2855a-178">Al implementar el patrón de control **TextRange** , tenga en cuenta las siguientes directrices y convenciones:</span><span class="sxs-lookup"><span data-stu-id="2855a-178">When implementing the **TextRange** control pattern, note the following guidelines and conventions:</span></span>

-   <span data-ttu-id="2855a-179">Todos los métodos del patrón de control **TextRange** deben realizar operaciones de texto independientemente del estado de visibilidad del texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-179">All methods of the **TextRange** control pattern should perform text operations regardless of the visibility state of the text.</span></span> <span data-ttu-id="2855a-180">La visibilidad de un intervalo de texto siempre se puede determinar consultando el atributo de texto **IsHidden** ([**UIA \_ IsHiddenAttributeId**](uiauto-textattribute-ids.md)).</span><span class="sxs-lookup"><span data-stu-id="2855a-180">The visibility of a text range can always be determined by querying the **IsHidden** text attribute ([**UIA\_IsHiddenAttributeId**](uiauto-textattribute-ids.md)).</span></span>
-   <span data-ttu-id="2855a-181">Si es posible, un proveedor debe asegurarse de que cualquier cambio de texto, como eliminaciones, inserciones y movimientos, se refleja en los objetos de intervalo de texto asociados (instancias de la interfaz [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) ) y genera un evento de [**\_ \_ TextChangedEventId de texto UIA**](uiauto-event-ids.md) .</span><span class="sxs-lookup"><span data-stu-id="2855a-181">If possible, a provider should ensure that any text changes, such as deletions, insertions, and moves, are reflected in the associated text range objects (instances of [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface) and raise a [**UIA\_Text\_TextChangedEventId**](uiauto-event-ids.md) event.</span></span> <span data-ttu-id="2855a-182">Los clientes pueden usar el evento como una sugerencia para confirmar los cambios editoriales realizados en el texto de un control.</span><span class="sxs-lookup"><span data-stu-id="2855a-182">Clients may use the event as a hint to confirm editorial changes made to the text of a control.</span></span>
-   <span data-ttu-id="2855a-183">Todos los objetos de intervalo de texto utilizados por los métodos [**ITextRangeProvider:: Compare**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compare), [**CompareEndpoints**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints)y [**MoveEndpointByRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange) deben ser del mismo nivel que la implementación del patrón de control **Text** .</span><span class="sxs-lookup"><span data-stu-id="2855a-183">All of the text range objects used by the [**ITextRangeProvider::Compare**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compare), [**CompareEndpoints**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints), and [**MoveEndpointByRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange) methods must be peers of the same **Text** control pattern implementation.</span></span>
-   <span data-ttu-id="2855a-184">Aunque no es necesario, el valor *pRetVal* recuperado por el método [**ITextRangeProvider:: CompareEndpoints**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints) puede indicar la distancia, en caracteres ([**\_ carácter TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)), entre los dos extremos.</span><span class="sxs-lookup"><span data-stu-id="2855a-184">Although not required, the *pRetVal* value retrieved by the [**ITextRangeProvider::CompareEndpoints**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints) method can indicate the distance, in characters ([**TextUnit\_Character**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)), between the two endpoints.</span></span> <span data-ttu-id="2855a-185">Sin embargo, las aplicaciones cliente no deben depender de la precisión de *pRetVal* más allá de su valor positivo o negativo.</span><span class="sxs-lookup"><span data-stu-id="2855a-185">However, client applications should not depend on the accuracy of *pRetVal* beyond its positive or negative value.</span></span>
-   <span data-ttu-id="2855a-186">Los métodos [**ITextRangeProvider:: ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit), [**Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move)y [**MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit) requieren una consideración cuidadosa de la unidad de texto especificada.</span><span class="sxs-lookup"><span data-stu-id="2855a-186">The [**ITextRangeProvider::ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit), [**Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move), and [**MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit) methods require careful consideration of the specified text unit.</span></span> <span data-ttu-id="2855a-187">Para obtener más información, vea manipular un TextRange por unidad de texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-187">For more information, see Manipulating a TextRange by Text Unit.</span></span>
-   <span data-ttu-id="2855a-188">Para conocer los requisitos de implementación relacionados con los métodos [**ITextRangeProvider:: SELECT**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select), [**AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection)y [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) , consulte Seleccionar texto en un intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-188">For implementation requirements related to the [**ITextRangeProvider::Select**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select), [**AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection), and [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) methods, see Selecting Text in a Text Range.</span></span>
-   <span data-ttu-id="2855a-189">Los métodos [**ITextRangeProvider:: FindText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findtext) y [**FindAttribute**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findattribute) buscan hacia delante o hacia atrás para una sola cadena de texto o atributo de texto coincidente.</span><span class="sxs-lookup"><span data-stu-id="2855a-189">The [**ITextRangeProvider::FindText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findtext) and [**FindAttribute**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findattribute) methods search forward or backward for a single matching text string or text attribute.</span></span> <span data-ttu-id="2855a-190">Deben devolver **null** si no se encuentra ninguna coincidencia.</span><span class="sxs-lookup"><span data-stu-id="2855a-190">They should return **NULL** if no match is found.</span></span>
-   <span data-ttu-id="2855a-191">El método [**ITextRangeProvider:: GetAttributeValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getattributevalue) debe devolver la dirección adquirida a partir de la función [**UiaGetReservedMixedAttributeValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservedmixedattributevalue) o [**UiaGetReservedNotSupportedValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservednotsupportedvalue) si el atributo asociado varía en el intervalo o si el control de texto no admite el atributo.</span><span class="sxs-lookup"><span data-stu-id="2855a-191">The [**ITextRangeProvider::GetAttributeValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getattributevalue) method must return the address acquired from the [**UiaGetReservedMixedAttributeValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservedmixedattributevalue) or [**UiaGetReservedNotSupportedValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservednotsupportedvalue) function if the associated attribute varies in the range, or if the attribute is not supported by the text control.</span></span> <span data-ttu-id="2855a-192">La especificación del patrón de control **TextRange** no permite agregar nuevos identificadores de atributo de texto ni cambiar la definición de los atributos existentes.</span><span class="sxs-lookup"><span data-stu-id="2855a-192">The **TextRange** control pattern specification does not allow adding new text-attribute identifiers or changing how the existing attributes are defined.</span></span>
-   <span data-ttu-id="2855a-193">Si es posible, el método [**ITextRangeProvider:: GetBoundingRectangles**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getboundingrectangles) debe devolver una matriz que contenga un rectángulo delimitador para cada línea de texto total o parcialmente visible en un intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-193">If possible, the [**ITextRangeProvider::GetBoundingRectangles**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getboundingrectangles) method should return an array that contains one bounding rectangle for each fully or partially visible line of text in a text range.</span></span> <span data-ttu-id="2855a-194">Si esto no es posible, el proveedor puede devolver una matriz que contenga los rectángulos delimitadores de solo líneas totalmente visibles; sin embargo, esto limita la capacidad de una aplicación cliente para describir con precisión el modo en que se presenta el texto en la pantalla.</span><span class="sxs-lookup"><span data-stu-id="2855a-194">If this is not possible, the provider can return an array that contains the bounding rectangles of only fully visible lines; however, this limits a client application's ability to accurately describe how the text is being presented on the screen.</span></span>
-   <span data-ttu-id="2855a-195">El método [**ITextRangeProvider:: GetChildren**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren) debe devolver todos los elementos secundarios incrustados en un intervalo de texto, pero no es necesario devolver ningún elemento secundario de los elementos secundarios.</span><span class="sxs-lookup"><span data-stu-id="2855a-195">The [**ITextRangeProvider::GetChildren**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren) method should return all child elements embedded in a text range, but it does not need to return any children of the child elements.</span></span> <span data-ttu-id="2855a-196">Por ejemplo, si un intervalo de texto contiene una tabla que tiene un número de celdas secundarias, el método **GetChildren** solo puede devolver el elemento TABLE y no los elementos Cell.</span><span class="sxs-lookup"><span data-stu-id="2855a-196">For example, if a text range contains a table that has a number of child cells, the **GetChildren** method may return just the table element and not the cell elements.</span></span> <span data-ttu-id="2855a-197">Por motivos de rendimiento o arquitectura, es posible que un proveedor no pueda exponer todos los objetos incrustados que se hospedan en un documento en el árbol de automatización.</span><span class="sxs-lookup"><span data-stu-id="2855a-197">For performance or architectural reasons, a provider may not be able to expose all embedded objects that are hosted in a document in the automation tree.</span></span> <span data-ttu-id="2855a-198">En este caso, el proveedor debe admitir al menos la enumeración de los objetos secundarios a través del método **GetChildren** y, como opción, admite el patrón de control [VirtualizedItem](uiauto-implementingvirtualizeditem.md) para la compatibilidad con la desvirtualización.</span><span class="sxs-lookup"><span data-stu-id="2855a-198">In this case, the provider should at least support the enumerating of child objects through the **GetChildren** method and, as an option, support the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern for de-virtualization support.</span></span>
-   <span data-ttu-id="2855a-199">El método [**ITextRangeProvider:: GetEnclosingElement**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getenclosingelement) devuelve normalmente el proveedor de texto que proporciona el intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-199">The [**ITextRangeProvider::GetEnclosingElement**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getenclosingelement) method typically returns the text provider that supplies the text range.</span></span> <span data-ttu-id="2855a-200">Sin embargo, si el proveedor de texto admite objetos secundarios como tablas o hipervínculos, el elemento envolvente podría ser un descendiente del proveedor de texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-200">However, if the text provider supports child objects such as tables or hyperlinks, the enclosing element could be a descendant of the text provider.</span></span> <span data-ttu-id="2855a-201">El elemento devuelto por **GetEnclosingElement** debe ser el elemento más cercano al intervalo de texto especificado.</span><span class="sxs-lookup"><span data-stu-id="2855a-201">The element returned by **GetEnclosingElement** should be the element closest to the given text range.</span></span> <span data-ttu-id="2855a-202">Por ejemplo, si el intervalo de texto está en una celda de una tabla, **GetEnclosingElement** debe devolver la celda que lo contiene en lugar del elemento TABLE.</span><span class="sxs-lookup"><span data-stu-id="2855a-202">For example, if the text range is in a cell of a table, **GetEnclosingElement** should return the containing cell instead of the table element.</span></span>
-   <span data-ttu-id="2855a-203">El método [**ITextRangeProvider:: gettext**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext) debe devolver el texto sin formato del intervalo.</span><span class="sxs-lookup"><span data-stu-id="2855a-203">The [**ITextRangeProvider::GetText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext) method should return the plain text in the range.</span></span> <span data-ttu-id="2855a-204">Para obtener más información, vea adquirir texto de un intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-204">For more information, see Acquiring Text from a Text Range.</span></span>
-   <span data-ttu-id="2855a-205">La llamada a [**ITextRangeProvider:: ScrollIntoView**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-scrollintoview) debe alinear el texto en la ventanilla del control de texto tal y como se especifica en el parámetro *alignToTop* .</span><span class="sxs-lookup"><span data-stu-id="2855a-205">Calling [**ITextRangeProvider::ScrollIntoView**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-scrollintoview) should align the text in the viewport of the text control as specified by the *alignToTop* parameter.</span></span> <span data-ttu-id="2855a-206">Aunque no hay ningún requisito en cuanto a la alineación horizontal, el intervalo de texto debe estar visible tanto horizontal como verticalmente.</span><span class="sxs-lookup"><span data-stu-id="2855a-206">Although there is no requirement in terms of horizontal alignment, the text range should be visible both horizontally and vertically.</span></span> <span data-ttu-id="2855a-207">Al evaluar el parámetro *alignToTop* , un proveedor debe tener en cuenta la orientación del control de texto y la dirección de flujo del texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-207">When evaluating the *alignToTop* parameter, a provider must take into account the orientation of the text control and the flow direction of the text.</span></span> <span data-ttu-id="2855a-208">Por ejemplo, si *alignToTop* es **true** para un control de texto orientado verticalmente que contiene texto que fluye de derecha a izquierda, el proveedor debe alinear el intervalo de texto con el lado derecho de la ventanilla.</span><span class="sxs-lookup"><span data-stu-id="2855a-208">For example, if *alignToTop* is **TRUE** for a vertically oriented text control containing text that flows from right to left, the provider should align the text range with the right side of the viewport.</span></span>
-   <span data-ttu-id="2855a-209">Al desplazarse por un documento por la [**\_ línea TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit), si el intervalo de texto entra en una tabla incrustada, cada línea de texto de una celda se debe tratar como una línea.</span><span class="sxs-lookup"><span data-stu-id="2855a-209">When moving through a document by [**TextUnit\_Line**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit), if the text range enters an embedded table, each line of text in a cell should be treated as a line.</span></span>

## <a name="required-members-for-itextprovider"></a><span data-ttu-id="2855a-210">Miembros requeridos para **ITextProvider**</span><span class="sxs-lookup"><span data-stu-id="2855a-210">Required Members for **ITextProvider**</span></span>

<span data-ttu-id="2855a-211">Se requieren las siguientes propiedades y métodos para implementar la interfaz [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) .</span><span class="sxs-lookup"><span data-stu-id="2855a-211">The following properties and methods are required for implementing the [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) interface.</span></span>



| <span data-ttu-id="2855a-212">Miembros requeridos</span><span class="sxs-lookup"><span data-stu-id="2855a-212">Required members</span></span>                                                                                        | <span data-ttu-id="2855a-213">Tipo de miembro</span><span class="sxs-lookup"><span data-stu-id="2855a-213">Member type</span></span> | <span data-ttu-id="2855a-214">Notas</span><span class="sxs-lookup"><span data-stu-id="2855a-214">Notes</span></span> |
|---------------------------------------------------------------------------------------------------------|-------------|-------|
| [<span data-ttu-id="2855a-215">**DocumentRange**</span><span class="sxs-lookup"><span data-stu-id="2855a-215">**DocumentRange**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange)                                             | <span data-ttu-id="2855a-216">Propiedad</span><span class="sxs-lookup"><span data-stu-id="2855a-216">Property</span></span>    | <span data-ttu-id="2855a-217">None</span><span class="sxs-lookup"><span data-stu-id="2855a-217">None</span></span>  |
| [<span data-ttu-id="2855a-218">**SupportedTextSelection**</span><span class="sxs-lookup"><span data-stu-id="2855a-218">**SupportedTextSelection**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection)                           | <span data-ttu-id="2855a-219">Propiedad</span><span class="sxs-lookup"><span data-stu-id="2855a-219">Property</span></span>    | <span data-ttu-id="2855a-220">None</span><span class="sxs-lookup"><span data-stu-id="2855a-220">None</span></span>  |
| [<span data-ttu-id="2855a-221">**GetSelection**</span><span class="sxs-lookup"><span data-stu-id="2855a-221">**GetSelection**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection)                                               | <span data-ttu-id="2855a-222">Método</span><span class="sxs-lookup"><span data-stu-id="2855a-222">Method</span></span>      | <span data-ttu-id="2855a-223">None</span><span class="sxs-lookup"><span data-stu-id="2855a-223">None</span></span>  |
| [<span data-ttu-id="2855a-224">**GetVisibleRanges**</span><span class="sxs-lookup"><span data-stu-id="2855a-224">**GetVisibleRanges**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getvisibleranges)                                       | <span data-ttu-id="2855a-225">Método</span><span class="sxs-lookup"><span data-stu-id="2855a-225">Method</span></span>      | <span data-ttu-id="2855a-226">None</span><span class="sxs-lookup"><span data-stu-id="2855a-226">None</span></span>  |
| [<span data-ttu-id="2855a-227">**RangeFromChild**</span><span class="sxs-lookup"><span data-stu-id="2855a-227">**RangeFromChild**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild)                                           | <span data-ttu-id="2855a-228">Método</span><span class="sxs-lookup"><span data-stu-id="2855a-228">Method</span></span>      | <span data-ttu-id="2855a-229">None</span><span class="sxs-lookup"><span data-stu-id="2855a-229">None</span></span>  |
| [<span data-ttu-id="2855a-230">**Tal**</span><span class="sxs-lookup"><span data-stu-id="2855a-230">**RangeFromPoint**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint)                                           | <span data-ttu-id="2855a-231">Método</span><span class="sxs-lookup"><span data-stu-id="2855a-231">Method</span></span>      | <span data-ttu-id="2855a-232">None</span><span class="sxs-lookup"><span data-stu-id="2855a-232">None</span></span>  |
| [<span data-ttu-id="2855a-233">**\_TextChangedEventId de texto de UIA \_**</span><span class="sxs-lookup"><span data-stu-id="2855a-233">**UIA\_Text\_TextChangedEventId**</span></span>](uiauto-event-ids.md)                   | <span data-ttu-id="2855a-234">Evento</span><span class="sxs-lookup"><span data-stu-id="2855a-234">Event</span></span>       | <span data-ttu-id="2855a-235">None</span><span class="sxs-lookup"><span data-stu-id="2855a-235">None</span></span>  |
| [<span data-ttu-id="2855a-236">**\_TextSelectionChangedEventId de texto de UIA \_**</span><span class="sxs-lookup"><span data-stu-id="2855a-236">**UIA\_Text\_TextSelectionChangedEventId**</span></span>](uiauto-event-ids.md) | <span data-ttu-id="2855a-237">Evento</span><span class="sxs-lookup"><span data-stu-id="2855a-237">Event</span></span>       | <span data-ttu-id="2855a-238">None</span><span class="sxs-lookup"><span data-stu-id="2855a-238">None</span></span>  |



 

<span data-ttu-id="2855a-239">Se requieren las siguientes propiedades y métodos adicionales para implementar la interfaz [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) .</span><span class="sxs-lookup"><span data-stu-id="2855a-239">The following additional properties and methods are required for implementing the [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) interface.</span></span>



| <span data-ttu-id="2855a-240">Miembros requeridos</span><span class="sxs-lookup"><span data-stu-id="2855a-240">Required members</span></span>                                                         | <span data-ttu-id="2855a-241">Tipo de miembro</span><span class="sxs-lookup"><span data-stu-id="2855a-241">Member type</span></span> | <span data-ttu-id="2855a-242">Notas</span><span class="sxs-lookup"><span data-stu-id="2855a-242">Notes</span></span> |
|--------------------------------------------------------------------------|-------------|-------|
| [<span data-ttu-id="2855a-243">**GetCaretRange**</span><span class="sxs-lookup"><span data-stu-id="2855a-243">**GetCaretRange**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-itextprovider2-getcaretrange)         | <span data-ttu-id="2855a-244">Método</span><span class="sxs-lookup"><span data-stu-id="2855a-244">Method</span></span>      | <span data-ttu-id="2855a-245">None</span><span class="sxs-lookup"><span data-stu-id="2855a-245">None</span></span>  |
| [<span data-ttu-id="2855a-246">**RangeFromAnnotation**</span><span class="sxs-lookup"><span data-stu-id="2855a-246">**RangeFromAnnotation**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider2-rangefromannotation) | <span data-ttu-id="2855a-247">Método</span><span class="sxs-lookup"><span data-stu-id="2855a-247">Method</span></span>      | <span data-ttu-id="2855a-248">None</span><span class="sxs-lookup"><span data-stu-id="2855a-248">None</span></span>  |



 

## <a name="required-members-for-itextrangeprovider"></a><span data-ttu-id="2855a-249">Miembros requeridos para **ITextRangeProvider**</span><span class="sxs-lookup"><span data-stu-id="2855a-249">Required Members for **ITextRangeProvider**</span></span>

<span data-ttu-id="2855a-250">Se requieren las siguientes propiedades y métodos para implementar la interfaz [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) .</span><span class="sxs-lookup"><span data-stu-id="2855a-250">The following properties and methods are required for implementing the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface.</span></span>



| <span data-ttu-id="2855a-251">Miembros requeridos</span><span class="sxs-lookup"><span data-stu-id="2855a-251">Required members</span></span>                                                                 | <span data-ttu-id="2855a-252">Tipo de miembro</span><span class="sxs-lookup"><span data-stu-id="2855a-252">Member type</span></span> | <span data-ttu-id="2855a-253">Notas</span><span class="sxs-lookup"><span data-stu-id="2855a-253">Notes</span></span> |
|----------------------------------------------------------------------------------|-------------|-------|
| [<span data-ttu-id="2855a-254">**AddToSelection**</span><span class="sxs-lookup"><span data-stu-id="2855a-254">**AddToSelection**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection)               | <span data-ttu-id="2855a-255">Método</span><span class="sxs-lookup"><span data-stu-id="2855a-255">Method</span></span>      | <span data-ttu-id="2855a-256">None</span><span class="sxs-lookup"><span data-stu-id="2855a-256">None</span></span>  |
| [<span data-ttu-id="2855a-257">**Clonar**</span><span class="sxs-lookup"><span data-stu-id="2855a-257">**Clone**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-clone)                                 | <span data-ttu-id="2855a-258">Método</span><span class="sxs-lookup"><span data-stu-id="2855a-258">Method</span></span>      | <span data-ttu-id="2855a-259">None</span><span class="sxs-lookup"><span data-stu-id="2855a-259">None</span></span>  |
| [<span data-ttu-id="2855a-260">**Comparar**</span><span class="sxs-lookup"><span data-stu-id="2855a-260">**Compare**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compare)                             | <span data-ttu-id="2855a-261">Método</span><span class="sxs-lookup"><span data-stu-id="2855a-261">Method</span></span>      | <span data-ttu-id="2855a-262">None</span><span class="sxs-lookup"><span data-stu-id="2855a-262">None</span></span>  |
| [<span data-ttu-id="2855a-263">**CompareEndpoints**</span><span class="sxs-lookup"><span data-stu-id="2855a-263">**CompareEndpoints**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints)           | <span data-ttu-id="2855a-264">Método</span><span class="sxs-lookup"><span data-stu-id="2855a-264">Method</span></span>      | <span data-ttu-id="2855a-265">None</span><span class="sxs-lookup"><span data-stu-id="2855a-265">None</span></span>  |
| [<span data-ttu-id="2855a-266">**ExpandToEnclosingUnit**</span><span class="sxs-lookup"><span data-stu-id="2855a-266">**ExpandToEnclosingUnit**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) | <span data-ttu-id="2855a-267">Método</span><span class="sxs-lookup"><span data-stu-id="2855a-267">Method</span></span>      | <span data-ttu-id="2855a-268">None</span><span class="sxs-lookup"><span data-stu-id="2855a-268">None</span></span>  |
| [<span data-ttu-id="2855a-269">**FindAttribute**</span><span class="sxs-lookup"><span data-stu-id="2855a-269">**FindAttribute**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findattribute)                 | <span data-ttu-id="2855a-270">Método</span><span class="sxs-lookup"><span data-stu-id="2855a-270">Method</span></span>      | <span data-ttu-id="2855a-271">None</span><span class="sxs-lookup"><span data-stu-id="2855a-271">None</span></span>  |
| [<span data-ttu-id="2855a-272">**FindText**</span><span class="sxs-lookup"><span data-stu-id="2855a-272">**FindText**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findtext)                           | <span data-ttu-id="2855a-273">Método</span><span class="sxs-lookup"><span data-stu-id="2855a-273">Method</span></span>      | <span data-ttu-id="2855a-274">None</span><span class="sxs-lookup"><span data-stu-id="2855a-274">None</span></span>  |
| [<span data-ttu-id="2855a-275">**GetAttributeValue**</span><span class="sxs-lookup"><span data-stu-id="2855a-275">**GetAttributeValue**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getattributevalue)         | <span data-ttu-id="2855a-276">Método</span><span class="sxs-lookup"><span data-stu-id="2855a-276">Method</span></span>      | <span data-ttu-id="2855a-277">None</span><span class="sxs-lookup"><span data-stu-id="2855a-277">None</span></span>  |
| [<span data-ttu-id="2855a-278">**GetBoundingRectangles**</span><span class="sxs-lookup"><span data-stu-id="2855a-278">**GetBoundingRectangles**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getboundingrectangles) | <span data-ttu-id="2855a-279">Método</span><span class="sxs-lookup"><span data-stu-id="2855a-279">Method</span></span>      | <span data-ttu-id="2855a-280">None</span><span class="sxs-lookup"><span data-stu-id="2855a-280">None</span></span>  |
| [<span data-ttu-id="2855a-281">**GetChildren**</span><span class="sxs-lookup"><span data-stu-id="2855a-281">**GetChildren**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren)                     | <span data-ttu-id="2855a-282">Método</span><span class="sxs-lookup"><span data-stu-id="2855a-282">Method</span></span>      | <span data-ttu-id="2855a-283">None</span><span class="sxs-lookup"><span data-stu-id="2855a-283">None</span></span>  |
| [<span data-ttu-id="2855a-284">**GetEnclosingElement**</span><span class="sxs-lookup"><span data-stu-id="2855a-284">**GetEnclosingElement**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getenclosingelement)     | <span data-ttu-id="2855a-285">Método</span><span class="sxs-lookup"><span data-stu-id="2855a-285">Method</span></span>      | <span data-ttu-id="2855a-286">None</span><span class="sxs-lookup"><span data-stu-id="2855a-286">None</span></span>  |
| [<span data-ttu-id="2855a-287">**GetText**</span><span class="sxs-lookup"><span data-stu-id="2855a-287">**GetText**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext)                             | <span data-ttu-id="2855a-288">Método</span><span class="sxs-lookup"><span data-stu-id="2855a-288">Method</span></span>      | <span data-ttu-id="2855a-289">None</span><span class="sxs-lookup"><span data-stu-id="2855a-289">None</span></span>  |
| [<span data-ttu-id="2855a-290">**Move**</span><span class="sxs-lookup"><span data-stu-id="2855a-290">**Move**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move)                                   | <span data-ttu-id="2855a-291">Método</span><span class="sxs-lookup"><span data-stu-id="2855a-291">Method</span></span>      | <span data-ttu-id="2855a-292">None</span><span class="sxs-lookup"><span data-stu-id="2855a-292">None</span></span>  |
| [<span data-ttu-id="2855a-293">**MoveEndpointByUnit**</span><span class="sxs-lookup"><span data-stu-id="2855a-293">**MoveEndpointByUnit**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit)       | <span data-ttu-id="2855a-294">Método</span><span class="sxs-lookup"><span data-stu-id="2855a-294">Method</span></span>      | <span data-ttu-id="2855a-295">None</span><span class="sxs-lookup"><span data-stu-id="2855a-295">None</span></span>  |
| [<span data-ttu-id="2855a-296">**MoveEndpointByRange**</span><span class="sxs-lookup"><span data-stu-id="2855a-296">**MoveEndpointByRange**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange)     | <span data-ttu-id="2855a-297">Método</span><span class="sxs-lookup"><span data-stu-id="2855a-297">Method</span></span>      | <span data-ttu-id="2855a-298">None</span><span class="sxs-lookup"><span data-stu-id="2855a-298">None</span></span>  |
| [<span data-ttu-id="2855a-299">**Seleccionar**</span><span class="sxs-lookup"><span data-stu-id="2855a-299">**Select**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select)                               | <span data-ttu-id="2855a-300">Método</span><span class="sxs-lookup"><span data-stu-id="2855a-300">Method</span></span>      | <span data-ttu-id="2855a-301">None</span><span class="sxs-lookup"><span data-stu-id="2855a-301">None</span></span>  |
| [<span data-ttu-id="2855a-302">**ScrollIntoView**</span><span class="sxs-lookup"><span data-stu-id="2855a-302">**ScrollIntoView**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-scrollintoview)               | <span data-ttu-id="2855a-303">Método</span><span class="sxs-lookup"><span data-stu-id="2855a-303">Method</span></span>      | <span data-ttu-id="2855a-304">None</span><span class="sxs-lookup"><span data-stu-id="2855a-304">None</span></span>  |



 

<span data-ttu-id="2855a-305">Se requieren las siguientes propiedades y métodos adicionales para implementar la interfaz [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) .</span><span class="sxs-lookup"><span data-stu-id="2855a-305">The following additional properties and methods are required for implementing the [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) interface.</span></span>



| <span data-ttu-id="2855a-306">Miembros requeridos</span><span class="sxs-lookup"><span data-stu-id="2855a-306">Required members</span></span>                                                      | <span data-ttu-id="2855a-307">Tipo de miembro</span><span class="sxs-lookup"><span data-stu-id="2855a-307">Member type</span></span> | <span data-ttu-id="2855a-308">Notas</span><span class="sxs-lookup"><span data-stu-id="2855a-308">Notes</span></span>                                      |
|-----------------------------------------------------------------------|-------------|--------------------------------------------|
| [<span data-ttu-id="2855a-309">**ShowContextMenu**</span><span class="sxs-lookup"><span data-stu-id="2855a-309">**ShowContextMenu**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) | <span data-ttu-id="2855a-310">Método</span><span class="sxs-lookup"><span data-stu-id="2855a-310">Method</span></span>      | <span data-ttu-id="2855a-311">Vea la sección "implementación de ShowContextMenu".</span><span class="sxs-lookup"><span data-stu-id="2855a-311">See "Implementing ShowContextMenu" section</span></span> |



 

<span data-ttu-id="2855a-312">El patrón de control **TextRange** no tiene eventos asociados.</span><span class="sxs-lookup"><span data-stu-id="2855a-312">The **TextRange** control pattern has no associated events.</span></span>

## <a name="supporting-text-ranges"></a><span data-ttu-id="2855a-313">Intervalos de texto compatibles</span><span class="sxs-lookup"><span data-stu-id="2855a-313">Supporting Text Ranges</span></span>

<span data-ttu-id="2855a-314">En esta sección se describe cómo un proveedor debe implementar varios métodos de las interfaces [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) y [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) para admitir el patrón de control **TextRange** .</span><span class="sxs-lookup"><span data-stu-id="2855a-314">This section describes how a provider should implement various methods of the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) and [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) interfaces to support the **TextRange** control pattern.</span></span>

### <a name="manipulating-a-text-range-by-text-unit"></a><span data-ttu-id="2855a-315">Manipular un intervalo de texto por unidad de texto</span><span class="sxs-lookup"><span data-stu-id="2855a-315">Manipulating a Text Range by Text Unit</span></span>

<span data-ttu-id="2855a-316">La interfaz [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) proporciona varios métodos para manipular y navegar por los intervalos de texto en un control basado en texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-316">The [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface provides several methods for manipulating and navigating text ranges in a text-based control.</span></span> <span data-ttu-id="2855a-317">Los métodos [**ITextRangeProvider:: Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move), [**MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit)y [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) mueven un intervalo de texto o uno de sus extremos por la unidad de texto especificada, como carácter, palabra, párrafo, etc.</span><span class="sxs-lookup"><span data-stu-id="2855a-317">The [**ITextRangeProvider::Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move), [**MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit), and [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) methods move a text range or one of its endpoints by the specified text unit, such as character, word, paragraph, and so on.</span></span> <span data-ttu-id="2855a-318">Para obtener más información, consulte [UI Automation Text Units](/windows/desktop/WinAuto/uiauto-uiautomationtextunits).</span><span class="sxs-lookup"><span data-stu-id="2855a-318">For more information, see [UI Automation Text Units](/windows/desktop/WinAuto/uiauto-uiautomationtextunits).</span></span>

<span data-ttu-id="2855a-319">A pesar de su nombre, el método [**ITextRangeProvider:: ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) no expande necesariamente un intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-319">Despite its name, the [**ITextRangeProvider::ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) method does not necessarily expand a text range.</span></span> <span data-ttu-id="2855a-320">En su lugar, "normaliza" un intervalo de texto moviendo los puntos de conexión para que el intervalo abarque la unidad de texto especificada.</span><span class="sxs-lookup"><span data-stu-id="2855a-320">Instead, it "normalizes" a text range by moving the endpoints so that the range encompasses the specified text unit.</span></span> <span data-ttu-id="2855a-321">El intervalo se expande si es menor que la unidad especificada o se acorta si es mayor que la unidad especificada.</span><span class="sxs-lookup"><span data-stu-id="2855a-321">The range is expanded if it is smaller than the specified unit, or shortened if it is longer than the specified unit.</span></span> <span data-ttu-id="2855a-322">Es fundamental que el método **ExpandToEnclosingUnit** siempre normalice los intervalos de texto de una manera coherente. de lo contrario, otros aspectos de la manipulación del intervalo de texto por unidad de texto serían imprevisibles.</span><span class="sxs-lookup"><span data-stu-id="2855a-322">It is critical that the **ExpandToEnclosingUnit** method always normalizes text ranges in a consistent manner; otherwise, other aspects of text range manipulation by text unit would be unpredictable.</span></span> <span data-ttu-id="2855a-323">En el diagrama siguiente se muestra cómo **ExpandToEnclosingUnit** normaliza un intervalo de texto moviendo los extremos del intervalo.</span><span class="sxs-lookup"><span data-stu-id="2855a-323">The following diagram shows how **ExpandToEnclosingUnit** normalizes a text range by moving the endpoints of the range.</span></span>

![diagrama que muestra las posiciones de punto de conexión del intervalo de texto antes y después de una llamada a expandtoenclosingunit](images/expandtoenclosingunit.jpg)

<span data-ttu-id="2855a-325">Si el intervalo de texto comienza al principio de una unidad de texto y termina al principio del límite de unidad de texto siguiente, o antes, el extremo final se mueve al siguiente límite de unidad de texto (vea 1 y 2 en el diagrama anterior).</span><span class="sxs-lookup"><span data-stu-id="2855a-325">If the text range starts at the beginning of a text unit and ends at the beginning of, or before, the next text unit boundary, the ending endpoint is moved to the next text unit boundary (see 1 and 2 in the previous diagram).</span></span>

<span data-ttu-id="2855a-326">Si el intervalo de texto comienza al principio de una unidad de texto y termina en el siguiente límite de unidad, o después, el extremo final permanece o se mueve hacia atrás hasta el siguiente límite de unidad después del punto de conexión de inicio (vea 3 y 4 en la ilustración anterior).</span><span class="sxs-lookup"><span data-stu-id="2855a-326">If the text range starts at the beginning of a text unit and ends at, or after, the next unit boundary, the ending endpoint stays or is moved backward to the next unit boundary after the starting endpoint (see 3 and 4 in the previous illustration).</span></span> <span data-ttu-id="2855a-327">Si hay más de un límite de unidad de texto entre los puntos de conexión inicial y final, el extremo final se desplaza hacia atrás hasta el siguiente límite de unidad después del punto de conexión de inicio, lo que da lugar a un intervalo de texto que es una unidad de texto de longitud.</span><span class="sxs-lookup"><span data-stu-id="2855a-327">If there is more than one text unit boundary between the starting and ending endpoints, the ending endpoint is moved backward to the next unit boundary after the starting endpoint, resulting in a text range that is one text unit in length.</span></span>

<span data-ttu-id="2855a-328">Si el intervalo de texto se inicia en medio de la unidad de texto, el punto de conexión inicial se desplaza hacia atrás hasta el principio de la unidad de texto y el extremo final se mueve hacia delante o hacia atrás, según sea necesario, al siguiente límite de unidad después del punto de conexión de inicio (vea 5 a 8 en el diagrama anterior).</span><span class="sxs-lookup"><span data-stu-id="2855a-328">If the text range starts in a middle of the text unit, the starting endpoint is moved backward to the beginning of the text unit, and the ending endpoint is moved forward or backward, as necessary, to the next unit boundary after the starting endpoint (see 5 through 8 in the previous diagram).</span></span>

<span data-ttu-id="2855a-329">Cuando se llama al método [**ITextRangeProvider:: Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move) , el proveedor normaliza el intervalo de texto por la unidad de texto especificada, usando la misma lógica de normalización que el método [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) .</span><span class="sxs-lookup"><span data-stu-id="2855a-329">When the [**ITextRangeProvider::Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move) method is called, the provider normalizes the text range by the specified text unit, using the same normalization logic as the [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) method.</span></span> <span data-ttu-id="2855a-330">A continuación, el proveedor mueve el intervalo hacia atrás o hacia delante el número especificado de unidades de texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-330">Then, the provider moves the range backward or forward by the specified number of text units.</span></span> <span data-ttu-id="2855a-331">Al mover el intervalo, el proveedor debe omitir los límites de cualquier objeto incrustado en el texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-331">When moving the range, the provider should ignore the boundaries of any embedded objects in the text.</span></span> <span data-ttu-id="2855a-332">(Sin embargo, el propio límite de unidad puede verse afectado por la existencia de un objeto incrustado).</span><span class="sxs-lookup"><span data-stu-id="2855a-332">(However, the unit boundary itself may be affected by the existence of an embedded object).</span></span> <span data-ttu-id="2855a-333">En el diagrama siguiente se muestra cómo el método **Move** mueve un intervalo de texto, unidad por unidad, entre los objetos incrustados y los límites de la unidad de texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-333">The following diagram demonstrates how the **Move** method moves a text range, unit by unit, across embedded objects and text unit boundaries.</span></span>

![diagrama que muestra cómo el método move mueve los extremos de intervalo entre los límites de unidad de texto y objeto](images/move.jpg)

<span data-ttu-id="2855a-335">El método [**ITextRangeProvider:: MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit) mueve uno de los extremos hacia delante o hacia atrás por la unidad de texto especificada, como se muestra en la ilustración siguiente.</span><span class="sxs-lookup"><span data-stu-id="2855a-335">The [**ITextRangeProvider::MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit) method moves one of the endpoints forward or backward by specified text unit, as the following illustration shows.</span></span>

![diagrama que muestra cómo moveendpointbyunit mueve el punto de conexión de un intervalo](images/moveendpointbyunit.gif)

<span data-ttu-id="2855a-337">El método [**ITextRangeProvider:: MoveEndpointByRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange) permite a una aplicación cliente establecer un punto de conexión de un intervalo de texto en la misma ubicación que el punto de conexión especificado de un segundo intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-337">The [**ITextRangeProvider::MoveEndpointByRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange) method enables a client application to set one endpoint of a text range to same location as the specified endpoint of a second text range.</span></span>

### <a name="selecting-text-in-a-text-range"></a><span data-ttu-id="2855a-338">Seleccionar texto en un intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="2855a-338">Selecting Text in a Text Range</span></span>

<span data-ttu-id="2855a-339">La interfaz [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) incluye varios métodos para controlar la selección de texto en un control basado en texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-339">The [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface includes several methods for controlling the selection of text in a text-based control.</span></span>

<span data-ttu-id="2855a-340">El método [**ITextRangeProvider:: SELECT**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select) debe seleccionar el texto que corresponde a un intervalo de texto y quitar la selección anterior, si existe, del control de texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-340">The [**ITextRangeProvider::Select**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select) method should select the text that corresponds to a text range, and remove the previous selection, if any, from the text control.</span></span> <span data-ttu-id="2855a-341">Si se llama a **Select** en un intervalo de texto degenerado, el proveedor debe trasladar el punto de inserción a la ubicación del intervalo de texto sin seleccionar ningún texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-341">If **Select** is called on a degenerate text range, the provider should move the insertion point to the location of the text range without selecting any text.</span></span>

<span data-ttu-id="2855a-342">Si un control admite la selección de varios intervalos separados de texto, los métodos [**ITextRangeProvider:: AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection) y [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) agregan intervalos de texto a y los quita de la colección de intervalos de texto seleccionados.</span><span class="sxs-lookup"><span data-stu-id="2855a-342">If a control supports the selection of multiple, disjoint spans of text, the [**ITextRangeProvider::AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection) and [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) methods add text ranges to, and remove them from, the collection of selected text ranges.</span></span> <span data-ttu-id="2855a-343">Si el control solo admite un intervalo de texto seleccionado cada vez, pero la operación de selección daría lugar a la selección de varios intervalos de texto disjuntos, el proveedor debe devolver un error **E \_ INVALIDOPERATION** , o bien debe extender o truncar la selección actual.</span><span class="sxs-lookup"><span data-stu-id="2855a-343">If the control only supports one selected text range at a time, but the selection operation would result in the selection of multiple disjoint text ranges, the provider should either return an **E\_INVALIDOPERATION** error, or should extend or truncate the current selection.</span></span> <span data-ttu-id="2855a-344">La propiedad [**ITextProvider:: SupportedTextSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection) debe indicar si un control admite la selección de uno o varios intervalos de texto o ninguno.</span><span class="sxs-lookup"><span data-stu-id="2855a-344">The [**ITextProvider::SupportedTextSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection) property should indicate whether a control supports the selection of single or multiple spans of text, or none at all.</span></span>

<span data-ttu-id="2855a-345">Si un control basado en texto admite inserciones de texto, al llamar a [**ITextRangeProvider:: AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection) o [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) en un intervalo de texto degenerado en el control, se debe desplace el punto de inserción pero no se debe seleccionar ningún texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-345">If a text-based control supports text insertions, calling [**ITextRangeProvider::AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection) or [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) on a degenerate text range in the control should move the insertion point but should not select any text.</span></span>

### <a name="acquiring-text-from-a-text-range"></a><span data-ttu-id="2855a-346">Adquirir texto de un intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="2855a-346">Acquiring Text from a Text Range</span></span>

<span data-ttu-id="2855a-347">El método [**ITextRangeProvider:: gettext**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext) debe devolver el texto sin formato de un intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-347">The [**ITextRangeProvider::GetText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext) method should return the plain text of a text range.</span></span> <span data-ttu-id="2855a-348">El texto sin formato debe incluir todos los caracteres de control que se encuentran en el texto de origen, como retornos de carro y la marca de izquierda a derecha (LRM) de Unicode.</span><span class="sxs-lookup"><span data-stu-id="2855a-348">The plain text should include all control characters found in the source text, such as carriage returns and the Unicode left-to-right mark (LRM).</span></span> <span data-ttu-id="2855a-349">El texto sin formato no debe incluir etiquetas de marcado, como HTML, que puedan estar presentes en el texto de origen.</span><span class="sxs-lookup"><span data-stu-id="2855a-349">The plain text should not include any markup tags such as HTML that may be present in the source text.</span></span> <span data-ttu-id="2855a-350">Además, los códigos de escape del texto de origen deben convertirse en los equivalentes de texto sin formato.</span><span class="sxs-lookup"><span data-stu-id="2855a-350">Also, any escape codes in the source text should be converted to the plain text equivalents.</span></span> <span data-ttu-id="2855a-351">Por ejemplo, " &nbsp; " se debe convertir en un carácter de espacio simple.</span><span class="sxs-lookup"><span data-stu-id="2855a-351">For example, "&nbsp;" should be converted to a simple space character.</span></span>

<span data-ttu-id="2855a-352">Si un objeto incrustado abarca un intervalo de texto, el texto sin formato debe incluir el texto interno del objeto, pero no el texto alternativo (la propiedad nombre del objeto incrustado) porque podría no ser coherente con el texto interno descriptivo.</span><span class="sxs-lookup"><span data-stu-id="2855a-352">If an embedded object spans a range of text, the plain text should include the inner text of the object, but not the alternative text (the name property of the embedded object) because it might be inconsistent with the descriptive inner text.</span></span> <span data-ttu-id="2855a-353">Para obtener más información, vea [cómo la automatización de la interfaz de usuario expone objetos incrustados](uiauto-textpattern-and-embedded-objects-overview.md).</span><span class="sxs-lookup"><span data-stu-id="2855a-353">For more information, see [How UI Automation Exposes Embedded Objects](uiauto-textpattern-and-embedded-objects-overview.md).</span></span>

### <a name="implementing-showcontextmenu"></a><span data-ttu-id="2855a-354">Implementación de ShowContextMenu</span><span class="sxs-lookup"><span data-stu-id="2855a-354">Implementing ShowContextMenu</span></span>

<span data-ttu-id="2855a-355">[**ITextRangeProvider2:: ShowContextMenu**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) siempre debe mostrar el menú contextual en el extremo inicial del intervalo.</span><span class="sxs-lookup"><span data-stu-id="2855a-355">[**ITextRangeProvider2::ShowContextMenu**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) should always show the context menu at the beginning end point of the range.</span></span> <span data-ttu-id="2855a-356">Debe ser equivalente a lo que sucedería si el usuario presionara la tecla del menú contextual o Mayús + F10 con el punto de inserción al principio del intervalo.</span><span class="sxs-lookup"><span data-stu-id="2855a-356">This should be equivalent to what would happen if the user pressed the context menu key or SHIFT + F10 with the insertion point at the beginning of the range.</span></span>

<span data-ttu-id="2855a-357">Si se muestra el menú contextual, por lo general, el punto de inserción se traslada a una ubicación determinada y, a continuación, debería hacerlo para invocar mediante programación [**ShowContextMenu**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) para la compatibilidad con la automatización de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="2855a-357">If showing the context menu would typically result in the insertion point moving to a given location, then it should do so for programmatically invoking [**ShowContextMenu**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) for UI Automation support also.</span></span>

## <a name="interoperability-with-the-system-caret"></a><span data-ttu-id="2855a-358">Interoperabilidad con el símbolo de intercalación del sistema</span><span class="sxs-lookup"><span data-stu-id="2855a-358">Interoperability with the System Caret</span></span>

<span data-ttu-id="2855a-359">La compatibilidad correcta con el punto de inserción es fundamental para muchas aplicaciones cliente, incluidas las que no se basan en la automatización de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="2855a-359">Correctly supporting the insertion point is critical to many client applications, including those not based on UI Automation.</span></span> <span data-ttu-id="2855a-360">En el patrón de control **Text** , el punto de inserción se representa mediante un intervalo de texto degenerado (vacío) en la posición del símbolo de intercalación del sistema.</span><span class="sxs-lookup"><span data-stu-id="2855a-360">In the **Text** control pattern, the insertion point is represented by a degenerate (empty) text range at the position of the system caret.</span></span> <span data-ttu-id="2855a-361">Cuando se mueve el punto de inserción, un control debe generar el evento **TextSelectionChanged** ([**UIA \_ Text \_ TextSelectionChangedEventId**](uiauto-event-ids.md)).</span><span class="sxs-lookup"><span data-stu-id="2855a-361">When the insertion point moves, a control should raise the **TextSelectionChanged** event ([**UIA\_Text\_TextSelectionChangedEventId**](uiauto-event-ids.md)).</span></span> <span data-ttu-id="2855a-362">Algunas aplicaciones cliente dependen de este evento para supervisar la ubicación del punto de inserción y para realizar un seguimiento de la selección de texto.</span><span class="sxs-lookup"><span data-stu-id="2855a-362">Some client applications depend on this event to monitor the location of the insertion point, and to keep track of the text selection.</span></span>

<span data-ttu-id="2855a-363">Cuando un control contiene texto seleccionado, el diseño actual del patrón de control **Text** no proporciona una manera de asociar directamente la ubicación del punto de inserción con un intervalo de texto determinado.</span><span class="sxs-lookup"><span data-stu-id="2855a-363">When a control contains selected text, the current design of the **Text** control pattern does not provide a way to directly associate the location of the insertion point with a particular text range.</span></span> <span data-ttu-id="2855a-364">El proveedor debe realizar un seguimiento de la selección de texto y establecer la ubicación del punto de inserción de forma adecuada.</span><span class="sxs-lookup"><span data-stu-id="2855a-364">The provider must keep track of the text selection and set the location of the insertion point appropriately.</span></span> <span data-ttu-id="2855a-365">Dado que la selección de texto se realiza normalmente moviendo el punto de inserción mientras mantiene presionada la tecla Mayús o CTRL, o ambos, un proveedor puede realizar el seguimiento de la selección de texto comprobando el estado de estas claves cada vez que cambie la selección.</span><span class="sxs-lookup"><span data-stu-id="2855a-365">Because selecting text is typically done by moving the insertion point while holding down the SHIFT or CTRL key, or both, a provider can track the text selection by checking the state of these keys whenever the selection changes.</span></span>

<span data-ttu-id="2855a-366">Dado que el marco de accesibilidad proporciona compatibilidad integrada para el símbolo de intercalación del sistema, pero no para un símbolo de intercalación personalizado, los controles basados en texto deben usar el símbolo de intercalación del sistema siempre que sea posible.</span><span class="sxs-lookup"><span data-stu-id="2855a-366">Because the accessibility framework provides built-in support for the system caret but not for a custom caret, text-based controls should use the system caret whenever possible.</span></span> <span data-ttu-id="2855a-367">Los controles que usan un símbolo de intercalación personalizado pueden asegurarse de que se puede obtener acceso al símbolo de intercalación creando un símbolo de intercalación del sistema que tenga las mismas dimensiones que el símbolo de intercalación personalizado y colocando el símbolo de intercalación del sistema en la misma ubicación en la interfaz de usuario del control que el símbolo de intercalación personalizado</span><span class="sxs-lookup"><span data-stu-id="2855a-367">Controls that use a custom caret can ensure that the caret is accessible by creating a system caret that has the same dimensions as the custom caret, and positioning the system caret at the same location in the UI of the control as the custom caret—that is, at the insertion point.</span></span> <span data-ttu-id="2855a-368">Como alternativa, un control que usa un símbolo de intercalación personalizado puede implementar un proveedor de Active Accessibility de Microsoft para el [**\_ símbolo de intercalación de OBJID**](object-identifiers.md) para proporcionar información de accesibilidad directamente para el símbolo de intercalación personalizado.</span><span class="sxs-lookup"><span data-stu-id="2855a-368">As an alternative, a control that uses a custom caret can implement a Microsoft Active Accessibility provider for [**OBJID\_CARET**](object-identifiers.md) to provide accessibility information directly for your custom caret.</span></span>

<span data-ttu-id="2855a-369">Para obtener más información sobre el símbolo de intercalación del sistema, consulte [Cares](/windows/desktop/menurc/carets).</span><span class="sxs-lookup"><span data-stu-id="2855a-369">For more information about the system caret, see [Carets](/windows/desktop/menurc/carets).</span></span>

<span data-ttu-id="2855a-370">Para probar si el control expone correctamente la ubicación del símbolo de intercalación del sistema, utilice las herramientas [inspeccionar](inspect-objects.md) y [monitor de eventos accesibles](accessible-event-watcher.md) .</span><span class="sxs-lookup"><span data-stu-id="2855a-370">To test whether your control properly exposes the location of the system caret, use the [Inspect](inspect-objects.md) and [Accessible Event Watcher](accessible-event-watcher.md) tools.</span></span>

<span data-ttu-id="2855a-371">Las coordenadas de pantalla del centro del mapa de bits del símbolo de intercalación del sistema siempre deben coincidir con la ubicación del punto de inserción.</span><span class="sxs-lookup"><span data-stu-id="2855a-371">The screen coordinates of the center of the system caret bitmap should always match the location of the insertion point.</span></span> <span data-ttu-id="2855a-372">De este modo, un cliente puede usar las coordenadas de la pantalla del símbolo de intercalación en una llamada a [**ITextProvider:: RangeFromPoint**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) para recuperar un intervalo de texto que represente con precisión la ubicación del punto de inserción.</span><span class="sxs-lookup"><span data-stu-id="2855a-372">That way, a client can use the caret screen coordinates in a call to [**ITextProvider::RangeFromPoint**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) to retrieve a text range that accurately represents the location of the insertion point.</span></span>

## <a name="related-topics"></a><span data-ttu-id="2855a-373">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="2855a-373">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2855a-374">Tipos de control y sus patrones de control admitidos</span><span class="sxs-lookup"><span data-stu-id="2855a-374">Control Types and Their Supported Control Patterns</span></span>](uiauto-controlpatternmapping.md)
</dt> <dt>

[<span data-ttu-id="2855a-375">Text (tipo de control)</span><span class="sxs-lookup"><span data-stu-id="2855a-375">Text Control Type</span></span>](uiauto-supporttextcontroltype.md)
</dt> <dt>

[<span data-ttu-id="2855a-376">Patrón de control TextEdit</span><span class="sxs-lookup"><span data-stu-id="2855a-376">TextEdit Control Pattern</span></span>](textedit-control-pattern.md)
</dt> <dt>

[<span data-ttu-id="2855a-377">Patrón de control TextChild</span><span class="sxs-lookup"><span data-stu-id="2855a-377">TextChild Control Pattern</span></span>](textchild-control-pattern.md)
</dt> <dt>

[<span data-ttu-id="2855a-378">Información general acerca de los patrones de control de UI Automation</span><span class="sxs-lookup"><span data-stu-id="2855a-378">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="2855a-379">Compatibilidad de UI Automation para el contenido textual</span><span class="sxs-lookup"><span data-stu-id="2855a-379">UI Automation Support for Textual Content</span></span>](uiauto-ui-automation-textpattern-overview.md)
</dt> <dt>

[<span data-ttu-id="2855a-380">Información general sobre el árbol de la UI Automation</span><span class="sxs-lookup"><span data-stu-id="2855a-380">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)
</dt> </dl>

 

 