---
title: Configuración de secuencias de audio
description: Configuración de secuencias de audio
ms.assetid: 6ddd9bc1-3fde-4098-afce-fdda461ced62
keywords:
- flujos, configurar secuencias de audio
- códecs, configurar secuencias de audio
- secuencias de audio, configurar
- códecs, formatos
- streams, interfaz IWMCodecInfo
- IWMCodecInfo, secuencias de audio
- flujos, sincronización A/V
- secuencias de audio, sincronización A/V
- Sincronización A/V
- flujos, sincronizar A/V
- secuencias de audio, sincronizar A/V
- flujos y formatos de audio de retraso reducido
- secuencias de audio, formatos de audio de retraso reducido
- códecs, formatos de audio de retraso reducido
- secuencias, velocidad de bits variable (VBR)
- secuencias de audio, velocidad de bits variable (VBR)
- códecs, velocidad de bits variable (VBR)
- velocidad de bits variable (VBR), configurar
- VBR (velocidad de bits variable), configurar
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3ad3931ec41e73c125417d39cdd177dc16056e9e
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "105714423"
---
# <a name="configuring-audio-streams"></a><span data-ttu-id="9d492-122">Configuración de secuencias de audio</span><span class="sxs-lookup"><span data-stu-id="9d492-122">Configuring Audio Streams</span></span>

<span data-ttu-id="9d492-123">Los flujos de audio suelen ser más fáciles de configurar.</span><span class="sxs-lookup"><span data-stu-id="9d492-123">Audio streams are generally the most straightforward to configure.</span></span> <span data-ttu-id="9d492-124">Obtenga una configuración de flujo del códec con los métodos de [**IWMCodecInfo**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmcodecinfo) tal y como se describe en [obtener información de configuración de la secuencia de los códecs](getting-stream-configuration-information-from-codecs.md).</span><span class="sxs-lookup"><span data-stu-id="9d492-124">Get a stream configuration from the codec using the methods of [**IWMCodecInfo**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmcodecinfo) as described in [Getting Stream Configuration Information from Codecs](getting-stream-configuration-information-from-codecs.md).</span></span> <span data-ttu-id="9d492-125">En la mayoría de los casos, no debe modificar la configuración de los recuperados.</span><span class="sxs-lookup"><span data-stu-id="9d492-125">Under most circumstances, you should not alter the settings from those retrieved.</span></span>

<span data-ttu-id="9d492-126">El formato de códec que seleccione de entre los enumerados depende del uso previsto de los archivos ASF realizados con el perfil.</span><span class="sxs-lookup"><span data-stu-id="9d492-126">The codec format that you select from those enumerated depends upon the intended use of the ASF files made with the profile.</span></span> <span data-ttu-id="9d492-127">La descripción del formato de códec recuperada por [**IWMCodecInfo2:: GetCodecFormatDesc**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmcodecinfo2-getcodecformatdesc) resume las características del formato.</span><span class="sxs-lookup"><span data-stu-id="9d492-127">The codec format description retrieved by [**IWMCodecInfo2::GetCodecFormatDesc**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmcodecinfo2-getcodecformatdesc) summarizes the characteristics of the format.</span></span> <span data-ttu-id="9d492-128">Si la aplicación no muestra las descripciones para elegir entre ellas, puede llamar a **QueryInterface** en la interfaz [**IWMStreamConfig**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmstreamconfig) del formato de códec para obtener la interfaz [**IWMMediaProps**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmmediaprops) .</span><span class="sxs-lookup"><span data-stu-id="9d492-128">If your application does not display the descriptions to choose between them, you can call **QueryInterface** on the [**IWMStreamConfig**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmstreamconfig) interface of the codec format to get the [**IWMMediaProps**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmmediaprops) interface.</span></span> <span data-ttu-id="9d492-129">Después, puede recuperar la estructura de [**\_ \_ tipo de medio de WM**](/previous-versions/windows/desktop/api/wmsdkidl/ns-wmsdkidl-wm_media_type) llamando a [**IWMMediaProps:: GetMediaType**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmmediaprops-getmediatype).</span><span class="sxs-lookup"><span data-stu-id="9d492-129">Then you can retrieve the [**WM\_MEDIA\_TYPE**](/previous-versions/windows/desktop/api/wmsdkidl/ns-wmsdkidl-wm_media_type) structure by calling [**IWMMediaProps::GetMediaType**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmmediaprops-getmediatype).</span></span> <span data-ttu-id="9d492-130">Mediante el examen de la estructura de **\_ \_ tipo de medio de WM** y la estructura [**WAVEFORMATEX**](/previous-versions/windows/desktop/legacy/dd757720(v=vs.85)) a la que apunta, puede determinar la configuración del formato de códec y compararla con sus requisitos.</span><span class="sxs-lookup"><span data-stu-id="9d492-130">By examining the **WM\_MEDIA\_TYPE** structure and the [**WAVEFORMATEX**](/previous-versions/windows/desktop/legacy/dd757720(v=vs.85)) structure it points to, you can determine the settings of the codec format and compare them to your requirements.</span></span>

## <a name="getting-audio-formats-for-av-synchronization"></a><span data-ttu-id="9d492-131">Obtener formatos de audio para una sincronización de/V</span><span class="sxs-lookup"><span data-stu-id="9d492-131">Getting Audio Formats for A/V Synchronization</span></span>

<span data-ttu-id="9d492-132">Los códecs Windows Media Audio y Windows Media Audio Professional admiten formatos para archivos de solo audio y para archivos de audio/vídeo.</span><span class="sxs-lookup"><span data-stu-id="9d492-132">The Windows Media Audio codec and Windows Media Audio Professional codec both support formats for audio-only files and for audio/video files.</span></span> <span data-ttu-id="9d492-133">Los formatos de solo audio están optimizados para archivos que solo contienen datos de audio, mientras que los formatos de audio y vídeo están optimizados para el audio que se encuentra en un archivo con una secuencia de vídeo.</span><span class="sxs-lookup"><span data-stu-id="9d492-133">The audio-only formats are optimized for files containing only audio data, while the audio/video formats are optimized for audio that is in a file with a video stream.</span></span> <span data-ttu-id="9d492-134">Al enumerar los formatos de códec de estos códecs, los formatos de audio y vídeo aparecen después de los formatos de solo audio.</span><span class="sxs-lookup"><span data-stu-id="9d492-134">When enumerating codec formats for these codecs, the audio/video formats come after the audio-only formats.</span></span> <span data-ttu-id="9d492-135">Todas las descripciones de formato de audio y vídeo contienen la cadena "(A/V)".</span><span class="sxs-lookup"><span data-stu-id="9d492-135">The audio/video format descriptions all contain the string "(A/V)".</span></span> <span data-ttu-id="9d492-136">Puede identificar los formatos diseñados para la sincronización de audio y vídeo mediante programación comprobando el número de paquetes por segundo.</span><span class="sxs-lookup"><span data-stu-id="9d492-136">You can identify the formats designed for audio/video synchronization programmatically by checking the number of packets per second.</span></span> <span data-ttu-id="9d492-137">Los formatos de sincronización tienen 5 o más paquetes por segundo si la velocidad de bits es mayor o igual que 32.000 bits por segundo.</span><span class="sxs-lookup"><span data-stu-id="9d492-137">Formats for synchronization have 5 or more packets per second if the bit rate is greater than or equal to 32,000 bits per second.</span></span> <span data-ttu-id="9d492-138">Los formatos con velocidades de bits inferiores a 32.000 bits por segundo se pueden usar con el vídeo sincronizado si usan 3 o más paquetes por segundo.</span><span class="sxs-lookup"><span data-stu-id="9d492-138">Formats with bit rates less than 32,000 bits per second can be used with synchronized video if they use 3 or more packets per second.</span></span> <span data-ttu-id="9d492-139">El ejemplo de código del tema [para buscar formatos de audio](to-find-audio-formats.md) contiene el código necesario para realizar esta comprobación:</span><span class="sxs-lookup"><span data-stu-id="9d492-139">The code example in the [To Find Audio Formats](to-find-audio-formats.md) topic contains the code required to make this check:</span></span>


```C++
if((pWave->nAvgBytesPerSec / pWave->nBlockAlign) >= 
       ((pWave->nAvgBytesPerSec >= 4000) ? 5.0 : 3.0))
{
    // Set this stream configuration as the new best match.
}
```



## <a name="getting-low-delay-audio-formats"></a><span data-ttu-id="9d492-140">Obtener Low-Delay formatos de audio</span><span class="sxs-lookup"><span data-stu-id="9d492-140">Getting Low-Delay Audio Formats</span></span>

<span data-ttu-id="9d492-141">El códec de Windows Media 9,1 y el códec profesional de Windows Media Audio 9,1 admiten formatos de retraso bajo.</span><span class="sxs-lookup"><span data-stu-id="9d492-141">The Windows Media 9.1 codec and the Windows Media Audio 9.1 Professional codec both support low-delay formats.</span></span> <span data-ttu-id="9d492-142">Estos formatos tienen una ventana de búfer más pequeña que otros formatos de audio.</span><span class="sxs-lookup"><span data-stu-id="9d492-142">These formats have a smaller buffer window than other audio formats.</span></span> <span data-ttu-id="9d492-143">El audio con retraso bajo está diseñado para mejorar el rendimiento en escenarios donde los archivos o secuencias se cambiarán con frecuencia; por ejemplo, una aplicación que muestra varias canciones para la transmisión por secuencias en la interfaz de usuario y permite a los usuarios cambiar arbitrariamente entre ellas.</span><span class="sxs-lookup"><span data-stu-id="9d492-143">Low-delay audio is intended to improve performance in scenarios where files or streams will be switched frequently; for example, an application that lists a number of songs for streaming in the user interface and allows users to arbitrarily switch between them.</span></span>

<span data-ttu-id="9d492-144">Los formatos de retraso bajo solo están disponibles en el modo CBR (una o dos pases).</span><span class="sxs-lookup"><span data-stu-id="9d492-144">Low-delay formats are available only in CBR mode (one-pass or two-pass).</span></span> <span data-ttu-id="9d492-145">Todas las descripciones de formato de retraso bajo contienen la cadena "Low Delay".</span><span class="sxs-lookup"><span data-stu-id="9d492-145">The low-delay format descriptions all contain the string "Low Delay".</span></span> <span data-ttu-id="9d492-146">Puede identificar los formatos mediante programación comprobando el valor de la velocidad de bits del formato.</span><span class="sxs-lookup"><span data-stu-id="9d492-146">You can identify the formats programmatically by checking the bit-rate value of the format.</span></span> <span data-ttu-id="9d492-147">A los formatos de retraso bajo se les asignan velocidades de bits que son de 1 Kilobit menos que las velocidades de bits del formato normal equivalente.</span><span class="sxs-lookup"><span data-stu-id="9d492-147">The low-delay formats are assigned bit rates that are 1 kilobit less than the bit rates of the equivalent normal format.</span></span> <span data-ttu-id="9d492-148">Por ejemplo, el códec Windows Media Audio 9,1 admite un formato CBR de un solo paso con una velocidad de bits de 192 kbps.</span><span class="sxs-lookup"><span data-stu-id="9d492-148">For example, the Windows Media Audio 9.1 codec supports a single-pass CBR format with a bit rate of 192 kbps.</span></span> <span data-ttu-id="9d492-149">El formato de retraso bajo equivalente tiene una velocidad de bits de 191 kbps.</span><span class="sxs-lookup"><span data-stu-id="9d492-149">The equivalent low-delay format has a bit rate of 191 kbps.</span></span> <span data-ttu-id="9d492-150">Además, con la excepción del formato mono de 5 Kbps compatible con el códec Windows Media Audio 9,1, los formatos de retraso bajo son los únicos formatos que tienen un valor de velocidad de bits impar.</span><span class="sxs-lookup"><span data-stu-id="9d492-150">In addition, with the exception of the 5 kbps mono format supported by the Windows Media Audio 9.1 codec, the low-delay formats are the only formats that have an odd bit-rate value.</span></span>

## <a name="configuring-variable-bit-rate-audio"></a><span data-ttu-id="9d492-151">Configuración de audio de velocidad de bits variable</span><span class="sxs-lookup"><span data-stu-id="9d492-151">Configuring Variable Bit Rate Audio</span></span>

<span data-ttu-id="9d492-152">Si necesita un formato de velocidad de bits variable (VBR) para uno de los códecs de audio de Windows Media, puede obtenerlo estableciendo la configuración de enumeración en el método [**IWMCodecInfo3:: SetCodecEnumerationSetting**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmcodecinfo3-setcodecenumerationsetting) .</span><span class="sxs-lookup"><span data-stu-id="9d492-152">When you need a variable bit rate (VBR) format for one of the Windows Media audio codecs, you can get it by setting the enumeration settings in the [**IWMCodecInfo3::SetCodecEnumerationSetting**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmcodecinfo3-setcodecenumerationsetting) method.</span></span> <span data-ttu-id="9d492-153">Establezca g \_ wszVBREnabled en true y establezca g \_ wszNumPasses en 1 para VBR basada en la calidad o 2 para VBR de dos pasos (restringido o sin restricciones).</span><span class="sxs-lookup"><span data-stu-id="9d492-153">Set g\_wszVBREnabled to True, and set g\_wszNumPasses to 1 for quality-based VBR or 2 for two-pass VBR (constrained or unconstrained).</span></span> <span data-ttu-id="9d492-154">Si usa VBR de dos pasos restringida, debe establecer manualmente la velocidad de bits máxima y la ventana de búfer para la secuencia mediante los métodos de [**IWMPropertyVault**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmpropertyvault) tal como se describe en [configuración de secuencias vbrs](configuring-vbr-streams.md).</span><span class="sxs-lookup"><span data-stu-id="9d492-154">If you are using constrained two-pass VBR, you must manually set the maximum bit rate and buffer window for the stream using the methods of [**IWMPropertyVault**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmpropertyvault) as described in [Configuring VBR Streams](configuring-vbr-streams.md).</span></span>

<span data-ttu-id="9d492-155">En los perfiles VBR basados en la calidad, el miembro **nAvgBytesPerSec** de la estructura **WAVEFORMATEX** contiene el nivel de calidad (del 1 al 100) en el byte de orden inferior y los tres bytes de orden superior se establecen en 0x7fffff.</span><span class="sxs-lookup"><span data-stu-id="9d492-155">In quality-based VBR profiles, the **nAvgBytesPerSec** member of the **WAVEFORMATEX** structure contains the quality level (1 through 100) in the low-order byte and the three high-order bytes are set to 0x7fffff.</span></span> <span data-ttu-id="9d492-156">No intente modificar la configuración de calidad modificando este valor manualmente. debe usar el formato que se recupera del códec.</span><span class="sxs-lookup"><span data-stu-id="9d492-156">Do not attempt to modify the quality setting by modifying this value manually; you must use the format as it is retrieved from the codec.</span></span> <span data-ttu-id="9d492-157">Para usar un valor de calidad diferente, debe enumerar los formatos hasta encontrar uno que satisfaga sus necesidades.</span><span class="sxs-lookup"><span data-stu-id="9d492-157">To use a different quality value, you must enumerate formats until you find one that meets your needs.</span></span> <span data-ttu-id="9d492-158">Además, **nAvgBytesPerSec** no se conservará en el archivo ASF; Cuando se obtiene la estructura **WAVEFORMATEX** de un archivo que se ha abierto con el objeto Reader, **nAvgBytesPerSec** contiene un valor aproximado que representa el número promedio de bytes por segundo.</span><span class="sxs-lookup"><span data-stu-id="9d492-158">Also, **nAvgBytesPerSec** will not be preserved in the ASF file; when you obtain the **WAVEFORMATEX** structure for a file that has been opened with the reader object, **nAvgBytesPerSec** contains an approximate value representing the average number of bytes per second.</span></span>

> [!Note]  
> <span data-ttu-id="9d492-159">Al configurar secuencias de audio, nunca debe tener un valor de ventana de búfer de audio mayor que el valor de las secuencias de vídeo del archivo.</span><span class="sxs-lookup"><span data-stu-id="9d492-159">When configuring audio streams, you should never have an audio buffer window value that is greater than the value for any video streams in the file.</span></span> <span data-ttu-id="9d492-160">Normalmente esto no es un problema, ya que los valores de la ventana de búfer de audio deben oscilar entre 1,5 y 3 segundos, y los valores de vídeo deben oscilar entre 3 y 5 segundos.</span><span class="sxs-lookup"><span data-stu-id="9d492-160">Normally this is not an issue, as audio buffer window values should range between 1.5 and 3 seconds and video values should range between 3 and 5 seconds.</span></span> <span data-ttu-id="9d492-161">Si una ventana de búfer de audio es mayor que una ventana de búfer de vídeo, el archivo se reproducirá con las secuencias ligeramente fuera de sincronización.</span><span class="sxs-lookup"><span data-stu-id="9d492-161">If an audio buffer window is greater than a video buffer window, the file will play back with the streams slightly out of synchronization.</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="9d492-162">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="9d492-162">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="9d492-163">**Configuración común para todos los flujos**</span><span class="sxs-lookup"><span data-stu-id="9d492-163">**Configuration Common to All Streams**</span></span>](configuration-common-to-all-streams.md)
</dt> <dt>

[<span data-ttu-id="9d492-164">**Configuración de secuencias**</span><span class="sxs-lookup"><span data-stu-id="9d492-164">**Configuring Streams**</span></span>](configuring-streams.md)
</dt> <dt>

[<span data-ttu-id="9d492-165">**Para buscar formatos de audio**</span><span class="sxs-lookup"><span data-stu-id="9d492-165">**To Find Audio Formats**</span></span>](to-find-audio-formats.md)
</dt> </dl>

 

 