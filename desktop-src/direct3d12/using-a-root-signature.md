---
title: Usar una firma raíz
description: La firma raíz es la definición de una colección de tablas de descriptores organizadas de forma arbitraria (incluido su diseño), constantes raíz y descriptores raíz.
ms.assetid: 0131CDE4-02DB-440A-92B8-B0933C6414B0
ms.localizationpriority: high
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3babe26dc06d4f85ce3d6fb771e18c78b54a3701
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/16/2019
ms.locfileid: "74104672"
---
# <a name="using-a-root-signature"></a><span data-ttu-id="23dfd-103">Usar una firma raíz</span><span class="sxs-lookup"><span data-stu-id="23dfd-103">Using a Root Signature</span></span>

<span data-ttu-id="23dfd-104">La firma raíz es la definición de una colección de tablas de descriptores organizadas de forma arbitraria (incluido su diseño), constantes raíz y descriptores raíz.</span><span class="sxs-lookup"><span data-stu-id="23dfd-104">The root signature is the definition of an arbitrarily arranged collection of descriptor tables (including their layout), root constants and root descriptors.</span></span> <span data-ttu-id="23dfd-105">Cada entrada tiene un costo hacia un límite máximo, por lo que la aplicación puede desplazarse por el equilibrio entre el número de cada tipo de entrada que contendrá la firma raíz.</span><span class="sxs-lookup"><span data-stu-id="23dfd-105">Each entry has a cost towards a maximum limit, so the application can trade off the balance between how many of each type of entry the root signature will contain.</span></span>

-   [<span data-ttu-id="23dfd-106">Semántica de la lista de comandos</span><span class="sxs-lookup"><span data-stu-id="23dfd-106">Command List Semantic</span></span>](#command-list-semantic)
-   [<span data-ttu-id="23dfd-107">Semántica de agrupación</span><span class="sxs-lookup"><span data-stu-id="23dfd-107">Bundle Semantics</span></span>](#bundle-semantics)
-   [<span data-ttu-id="23dfd-108">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="23dfd-108">Related topics</span></span>](#related-topics)

<span data-ttu-id="23dfd-109">La firma raíz es un objeto que se puede crear mediante la especificación manual en la API.</span><span class="sxs-lookup"><span data-stu-id="23dfd-109">The root signature is an object that can be created by manual specification at the API.</span></span> <span data-ttu-id="23dfd-110">Todos los sombreadores de un PSO deben ser compatibles con el diseño raíz especificado con el PSO o, de lo contrario, los sombreadores individuales deben incluir diseños raíz incrustados que coincidan entre sí. de lo contrario, se producirá un error en la creación de PSO.</span><span class="sxs-lookup"><span data-stu-id="23dfd-110">All shaders in a PSO must be compatible with the root layout specified with the PSO, or else the individual shaders must include embedded root layouts that match each other; otherwise, PSO creation will fail.</span></span> <span data-ttu-id="23dfd-111">Una propiedad de la firma raíz es que los sombreadores no tienen que conocerlo cuando se crean, aunque las firmas de raíz también se pueden crear directamente en los sombreadores si se desea.</span><span class="sxs-lookup"><span data-stu-id="23dfd-111">One property of the root signature is that shaders don't have to know about it when authored, although root signatures can also be authored directly in shaders if desired.</span></span> <span data-ttu-id="23dfd-112">Los recursos del sombreador existentes no requieren ningún cambio para ser compatibles con las firmas de raíz.</span><span class="sxs-lookup"><span data-stu-id="23dfd-112">Existing shader assets do not require any changes to be compatible with root signatures.</span></span> <span data-ttu-id="23dfd-113">El modelo de sombreador 5,1 se incluye para proporcionar una flexibilidad adicional (indexación dinámica de los descriptores de los sombreadores) y se puede adoptar incrementalmente a partir de los recursos del sombreador existentes, según sea necesario.</span><span class="sxs-lookup"><span data-stu-id="23dfd-113">Shader Model 5.1 is introduced to provide some extra flexibility (dynamic indexing of descriptors from within shaders), and can be incrementally adopted starting from existing shader assets as desired.</span></span>

## <a name="command-list-semantic"></a><span data-ttu-id="23dfd-114">Semántica de la lista de comandos</span><span class="sxs-lookup"><span data-stu-id="23dfd-114">Command List Semantic</span></span>

<span data-ttu-id="23dfd-115">Al principio de una lista de comandos, la firma raíz no está definida.</span><span class="sxs-lookup"><span data-stu-id="23dfd-115">At the beginning of a command list, the root signature is undefined.</span></span> <span data-ttu-id="23dfd-116">Los sombreadores de gráficos tienen una firma raíz independiente del sombreador de cálculo, cada una de las cuales se asigna de forma independiente en una lista de comandos.</span><span class="sxs-lookup"><span data-stu-id="23dfd-116">Graphics shaders have a separate root signature from the compute shader, each independently assigned on a command list.</span></span> <span data-ttu-id="23dfd-117">La firma raíz establecida en una lista de comandos o un lote también debe coincidir con el valor actual de PSO en Draw/Dispatch. de lo contrario, el comportamiento es indefinido.</span><span class="sxs-lookup"><span data-stu-id="23dfd-117">The root signature set on a command list or bundle must also match the currently set PSO at Draw/Dispatch; otherwise, the behavior is undefined.</span></span> <span data-ttu-id="23dfd-118">Las discrepancias de la firma raíz transitorias antes de Draw/Dispatch son correctas, como establecer un valor de PSO incompatible antes de cambiar a una firma raíz compatible (siempre que sean compatibles en el momento en que se llama a Draw/Dispatch).</span><span class="sxs-lookup"><span data-stu-id="23dfd-118">Transient root signature mismatches before Draw/Dispatch are fine - such as setting an incompatible PSO before switching to a compatible root signature (as long as these are compatible by the time Draw/Dispatch is called).</span></span> <span data-ttu-id="23dfd-119">La configuración de un PSO no cambia la firma raíz.</span><span class="sxs-lookup"><span data-stu-id="23dfd-119">Setting a PSO does not change the root signature.</span></span> <span data-ttu-id="23dfd-120">La aplicación debe llamar a una API dedicada para establecer la firma raíz.</span><span class="sxs-lookup"><span data-stu-id="23dfd-120">The application must call a dedicated API for setting the root signature.</span></span>

<span data-ttu-id="23dfd-121">Una vez que se ha establecido una firma raíz en una lista de comandos, el diseño define el conjunto de enlaces que se espera que proporcione la aplicación y qué PSO se puede usar (los compilados con el mismo diseño) para las siguientes llamadas a Draw/Dispatch.</span><span class="sxs-lookup"><span data-stu-id="23dfd-121">Once a root signature has been set on a command list, the layout defines the set of bindings that the application is expected to provide, and which PSOs can be used (those compiled with the same layout) for the next draw/dispatch calls.</span></span> <span data-ttu-id="23dfd-122">Por ejemplo, la aplicación podría definir una firma raíz para tener las siguientes entradas.</span><span class="sxs-lookup"><span data-stu-id="23dfd-122">For example, a root signature could be defined by the application to have the following entries.</span></span> <span data-ttu-id="23dfd-123">Cada entrada se denomina "espacio".</span><span class="sxs-lookup"><span data-stu-id="23dfd-123">Each entry is referred to as a "slot".</span></span>

-   <span data-ttu-id="23dfd-124">\[0 \] un descriptor de CBV insertado (descriptores raíz)</span><span class="sxs-lookup"><span data-stu-id="23dfd-124">\[0\] A CBV descriptor inline (root descriptors)</span></span>
-   <span data-ttu-id="23dfd-125">\[1 \] una tabla de descriptores que contiene 2 SRVs, 1 CBVs y 1 UAV</span><span class="sxs-lookup"><span data-stu-id="23dfd-125">\[1\] A descriptor table containing 2 SRVs, 1 CBVs, and 1 UAV</span></span>
-   <span data-ttu-id="23dfd-126">\[2 \] una tabla de descriptores que contiene 1 muestra</span><span class="sxs-lookup"><span data-stu-id="23dfd-126">\[2\] A descriptor table containing 1 sampler</span></span>
-   <span data-ttu-id="23dfd-127">\[3 \] una colección de 4x32 bits de constantes raíz</span><span class="sxs-lookup"><span data-stu-id="23dfd-127">\[3\] A 4x32-bit collection of root constants</span></span>
-   <span data-ttu-id="23dfd-128">\[4 \] una tabla de descriptores que contiene un número no especificado de SRVs</span><span class="sxs-lookup"><span data-stu-id="23dfd-128">\[4\] A descriptor table containing an unspecified number of SRVs</span></span>

<span data-ttu-id="23dfd-129">En este caso, antes de poder emitir un draw/Dispatch, se espera que la aplicación establezca el enlace adecuado en cada una de las ranuras \[ 0.. 4 \] que la aplicación ha definido con su firma raíz actual.</span><span class="sxs-lookup"><span data-stu-id="23dfd-129">In this case, before being able to issue a Draw/Dispatch, the application is expected to set the appropriate binding to each of the slots \[0..4\] that the application defined with its current root signature.</span></span> <span data-ttu-id="23dfd-130">Por ejemplo, en la ranura \[ 1 \] , una tabla de descriptores debe estar enlazada, que es una región contigua de un montón descriptor que contiene (o contendrá en ejecución) 2 SRVs, 1 CBVs y 1 UAV.</span><span class="sxs-lookup"><span data-stu-id="23dfd-130">For instance, at slot \[1\], a descriptor table must be bound, which is a contiguous region in a descriptor heap that contains (or will contain at execution) 2 SRVs, 1 CBVs, and 1 UAV.</span></span> <span data-ttu-id="23dfd-131">Del mismo modo, las tablas de descriptor deben establecerse en las ranuras \[ 2 \] y \[ 4 \] .</span><span class="sxs-lookup"><span data-stu-id="23dfd-131">Similarly, descriptor tables must be set at slots \[2\] and \[4\].</span></span>

<span data-ttu-id="23dfd-132">La aplicación puede cambiar parte de los enlaces de la firma raíz a la vez (el resto permanece sin cambios).</span><span class="sxs-lookup"><span data-stu-id="23dfd-132">The application can change part of the root signature bindings at a time (the rest remain unchanged).</span></span> <span data-ttu-id="23dfd-133">Por ejemplo, si lo único que debe cambiar entre dibujar es una de las constantes en la ranura \[ 2 \] , es necesario volver a enlazar todas las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="23dfd-133">For example, if the only thing that needs to change between draws is one of the constants at slot \[2\], that is all the application needs to rebind.</span></span> <span data-ttu-id="23dfd-134">Como se explicó anteriormente, las versiones del controlador o el hardware de todos los Estados enlazan la firma raíz a medida que se modifican automáticamente.</span><span class="sxs-lookup"><span data-stu-id="23dfd-134">As discussed previously, the driver/hardware versions all root signature bind state as it is modified automatically.</span></span> <span data-ttu-id="23dfd-135">Si se cambia una firma raíz en una lista de comandos, todos los enlaces de firma raíz anteriores se vuelven obsoletos y todos los enlaces que se esperan recientemente se deben establecer antes de Draw/Dispatch. de lo contrario, el comportamiento es indefinido.</span><span class="sxs-lookup"><span data-stu-id="23dfd-135">If a root signature is changed on a command list, all previous root signature bindings become stale and all newly expected bindings must be set before Draw/Dispatch; otherwise, the behavior is undefined.</span></span> <span data-ttu-id="23dfd-136">Si la firma raíz está establecida de forma redundante en la misma que está establecida actualmente, los enlaces de firma raíz existentes no se vuelven obsoletos.</span><span class="sxs-lookup"><span data-stu-id="23dfd-136">If the root signature is redundantly set to the same one currently set, existing root signature bindings do not become stale.</span></span>

## <a name="bundle-semantics"></a><span data-ttu-id="23dfd-137">Semántica de agrupación</span><span class="sxs-lookup"><span data-stu-id="23dfd-137">Bundle Semantics</span></span>

<span data-ttu-id="23dfd-138">Las agrupaciones heredan los enlaces de firma raíz de la lista de comandos (los enlaces a las distintas ranuras en el ejemplo anterior de la lista de comandos).</span><span class="sxs-lookup"><span data-stu-id="23dfd-138">Bundles inherit the command list's root signature bindings (the bindings to the various slots in the Command List example above).</span></span> <span data-ttu-id="23dfd-139">Si un paquete necesita cambiar algunos de los enlaces de la firma raíz heredada, primero debe establecer la firma raíz para que sea igual que la lista de comandos que realiza la llamada (los enlaces heredados no se vuelven obsoletos).</span><span class="sxs-lookup"><span data-stu-id="23dfd-139">If a bundle needs to change some of the inherited root signature bindings, it must first set the root signature to be the same as the calling command list (the inherited bindings do not become stale).</span></span> <span data-ttu-id="23dfd-140">Si la agrupación establece la firma raíz para que sea diferente de la lista de comandos que realiza la llamada, que tiene el mismo efecto que cambiar la firma raíz en la lista de comandos descrita anteriormente: todos los enlaces de firma raíz anteriores están obsoletos y los enlaces recién esperados se deben establecer antes de Draw/Dispatch; de lo contrario, el comportamiento es indefinido.</span><span class="sxs-lookup"><span data-stu-id="23dfd-140">If the bundle sets the root signature to be different than the calling command list, that has the same effect as changing the root signature on the command list described above: all previous root signature bindings are stale and newly expected bindings must be set before Draw/Dispatch; otherwise, the behavior is undefined.</span></span> <span data-ttu-id="23dfd-141">Si una agrupación no necesita cambiar ningún enlace de firma raíz, no es necesario establecer la firma raíz.</span><span class="sxs-lookup"><span data-stu-id="23dfd-141">If a bundle does not need to change any root signature bindings, it does not need to set the root signature.</span></span>

<span data-ttu-id="23dfd-142">En el código siguiente se muestra un flujo de llamadas de ejemplo en una agrupación.</span><span class="sxs-lookup"><span data-stu-id="23dfd-142">The following code shows an example call flow into a bundle.</span></span>

``` syntax
// Command List
...
pCmdList->SetGraphicsRootSignature(pRootSig); // new parameter space
MyEngine_SetTextures(); // bundle inherits descriptor table setting
MyEngine_SetAnimationFactor(fTime); // bundle inherits root constant
pCmdList->ExecuteBundle(...);
...
// Bundle
pBundle->SetGraphicsRootSignature(pRootSig); // same as caller, in order to inherits bindings
pBundle->SetPipelineState(pPS); 
pBundle->SetGraphicsRoot32BitConstant(drawConstantsSlot,0,drawIDOffset);
pBundle->Draw(...); // using inherited textures / animation factor
pBundle->SetGraphicsRoot32BitConstant(drawConstantsSlot,1,drawIDOffset);
pBundle->Draw(...);
...
```

<span data-ttu-id="23dfd-143">Al salir de un paquete, los cambios de diseño raíz y/o los cambios de enlace que realiza una agrupación se heredan de nuevo en la lista de comandos de llamada cuando finaliza la ejecución de una agrupación.</span><span class="sxs-lookup"><span data-stu-id="23dfd-143">Coming out of a bundle, any root layout changes and/or binding changes a bundle makes are inherited back to the calling command list when a bundle finishes executing.</span></span>

<span data-ttu-id="23dfd-144">Para obtener más información sobre la herencia, consulte la sección **herencia de estado de canalización de gráficos** de administración del [Estado de canalización de gráficos en Direct3D 12](managing-graphics-pipeline-state-in-direct3d-12.md).</span><span class="sxs-lookup"><span data-stu-id="23dfd-144">For more information on inheritance, refer to the **Graphics pipeline state inheritance** section of [Managing Graphics Pipeline State in Direct3D 12](managing-graphics-pipeline-state-in-direct3d-12.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="23dfd-145">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="23dfd-145">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="23dfd-146">Firmas raíz</span><span class="sxs-lookup"><span data-stu-id="23dfd-146">Root Signatures</span></span>](root-signatures.md)
</dt> </dl>

 

 




