---
title: Información general sobre las instrucciones de contenedor de control y control
description: Información general sobre las instrucciones de contenedor de control y control
ms.assetid: c4cf2409-0085-43e6-afa2-f9c03cc50565
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4fd72851775898f4fd140c7d101d72993c34e3eb
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/29/2020
ms.locfileid: "103785589"
---
# <a name="overview-of-control-and-control-container-guidelines"></a><span data-ttu-id="999b3-103">Información general sobre las instrucciones de contenedor de control y control</span><span class="sxs-lookup"><span data-stu-id="999b3-103">Overview of Control and Control Container Guidelines</span></span>

<span data-ttu-id="999b3-104">Un control ActiveX es esencialmente un objeto OLE simple que admite la interfaz [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) .</span><span class="sxs-lookup"><span data-stu-id="999b3-104">An ActiveX control is essentially a simple OLE object that supports the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface.</span></span> <span data-ttu-id="999b3-105">Normalmente, admite más interfaces para ofrecer funcionalidad, pero todas las interfaces adicionales se pueden ver como opcionales y, como tal, un contenedor de control no debe basarse en cualquier interfaz adicional que se admita.</span><span class="sxs-lookup"><span data-stu-id="999b3-105">It will usually support more interfaces in order to offer functionality, but all additional interfaces may be viewed as optional and as such, a control container should not rely on any additional interfaces being supported.</span></span> <span data-ttu-id="999b3-106">Si no se especifican interfaces adicionales que un control debe admitir, un control puede dirigirse eficazmente a un área determinada de funcionalidad sin tener que admitir interfaces determinadas para calificar como un control.</span><span class="sxs-lookup"><span data-stu-id="999b3-106">By not specifying additional interfaces that a control must support, a control may efficiently target a particular area of functionality without having to support particular interfaces to qualify as a control.</span></span> <span data-ttu-id="999b3-107">Como siempre con OLE, ya sea en un contenedor de control o de control, nunca se debe suponer que una interfaz está disponible y siempre deben seguirse las convenciones estándar de comprobación de devolución.</span><span class="sxs-lookup"><span data-stu-id="999b3-107">As always with OLE, whether in a control or a control container, it should never be assumed that an interface is available and standard return-checking conventions should always be followed.</span></span> <span data-ttu-id="999b3-108">Es importante que un contenedor de control o control se reduzca correctamente y ofrezca funcionalidad alternativa si no está disponible una interfaz necesaria.</span><span class="sxs-lookup"><span data-stu-id="999b3-108">It is important for a control or control container to degrade gracefully and offer alternative functionality if an interface required is not available.</span></span>

<span data-ttu-id="999b3-109">Un contenedor de controles ActiveX debe ser capaz de hospedar un control ActiveX mínimo; también admite varias interfaces adicionales, como se especifica en [contenedores](containers.md).</span><span class="sxs-lookup"><span data-stu-id="999b3-109">An ActiveX control container must be able to host a minimal ActiveX control; it will also support a number of additional interfaces as specified in [Containers](containers.md).</span></span> <span data-ttu-id="999b3-110">Hay una serie de interfaces y métodos que un contenedor puede admitir opcionalmente, que se agrupan en áreas funcionales conocidas como *categorías de componentes*.</span><span class="sxs-lookup"><span data-stu-id="999b3-110">There are a number of interfaces and methods that a container may optionally support, which are grouped into functional areas known as *component categories*.</span></span> <span data-ttu-id="999b3-111">Un contenedor puede admitir cualquier combinación de categorías de componentes, por ejemplo, existe una categoría de componente para el enlace de los DataBindings y un contenedor puede o no admitir la funcionalidad de enlace de los enlaces, en función de las necesidades de mercado del contenedor.</span><span class="sxs-lookup"><span data-stu-id="999b3-111">A container may support any combination of component categories, for example, a component category exists for databinding and a container may or may not support the databinding functionality, depending on the market needs of the container.</span></span> <span data-ttu-id="999b3-112">Si un control necesita compatibilidad con el enlace de los enlaces de un contenedor para que funcione, se especificará este requisito en el registro.</span><span class="sxs-lookup"><span data-stu-id="999b3-112">If a control needs databinding support from a container to function, then it will enter this requirement in the registry.</span></span> <span data-ttu-id="999b3-113">Esto permite que un contenedor de control solo ofrezca la inserción de aquellos controles que sepa que puede hospedar correctamente.</span><span class="sxs-lookup"><span data-stu-id="999b3-113">This allows a control container to only offer for insertion those controls that it knows it can successfully host.</span></span> <span data-ttu-id="999b3-114">Es importante tener en cuenta que las categorías de componentes se especifican como parte de OLE y no son específicas de los controles ActiveX, la arquitectura de los controles utiliza categorías de componentes para identificar las áreas de funcionalidad que puede admitir un componente OLE.</span><span class="sxs-lookup"><span data-stu-id="999b3-114">It is important to note that component categories are specified as part of OLE and are not specific to ActiveX controls, the controls architecture uses component categories to identify areas of functionality that an OLE component may support.</span></span> <span data-ttu-id="999b3-115">Las categorías de componentes no son acumulativas ni exclusivas, por lo que un contenedor de control puede admitir una categoría sin que sea necesaria la compatibilidad con otra.</span><span class="sxs-lookup"><span data-stu-id="999b3-115">Component categories are not cumulative or exclusive, so a control container can support one category without necessarily supporting another.</span></span>

<span data-ttu-id="999b3-116">Es importante para los controles que requieren características opcionales, o características específicas de un determinado contenedor que se van a empaquetar y comercializar claramente con esos requisitos.</span><span class="sxs-lookup"><span data-stu-id="999b3-116">It is important for controls that require optional features, or features specific to a certain container to be clearly packaged and marketed with those requirements.</span></span> <span data-ttu-id="999b3-117">De igual forma, los contenedores que ofrecen ciertas características o categorías de componentes deben comercializarse y empaquetarse como si ofrecieran los niveles de soporte técnico al hospedar controles ActiveX.</span><span class="sxs-lookup"><span data-stu-id="999b3-117">Similarly containers that offer certain features or component categories must be marketed and packaged as offering those levels of support when hosting ActiveX controls.</span></span> <span data-ttu-id="999b3-118">Se recomienda que controle el destino y la prueba con tantos contenedores como sea posible y que se reduzca correctamente para ofrecer una funcionalidad menos o alternativa si no están disponibles las interfaces o los métodos.</span><span class="sxs-lookup"><span data-stu-id="999b3-118">It is recommended that controls target and test with as many containers as possible and degrade gracefully to offer less or alternative functionality if interfaces or methods are not available.</span></span> <span data-ttu-id="999b3-119">En una situación en la que un control no puede realizar su función de trabajo designada sin la compatibilidad de una categoría de componente, esa categoría debe especificarse como un requisito en el registro para evitar que el control se inserte en un contenedor inadecuado.</span><span class="sxs-lookup"><span data-stu-id="999b3-119">In a situation where a control cannot perform its designated job function without the support of a component category, that category should be entered as a requirement in the registry in order to prevent the control being inserted in an inappropriate container.</span></span>

<span data-ttu-id="999b3-120">Estas instrucciones definen las interfaces y los métodos que un control puede esperar que admita un contenedor de control, aunque como siempre un control debe comprobar los valores devueltos cuando se usa [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) u otros métodos para obtener punteros a estas interfaces.</span><span class="sxs-lookup"><span data-stu-id="999b3-120">These guidelines define those interfaces and methods that a control may expect a control container to support, although as always a control should check the return values when using [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) or other methods to obtain pointers to these interfaces.</span></span> <span data-ttu-id="999b3-121">Un contenedor no debe esperar que un control admita algo más que la interfaz [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) , y estas instrucciones identifican qué interfaces puede admitir un control y qué significa la presencia de una interfaz determinada.</span><span class="sxs-lookup"><span data-stu-id="999b3-121">A container should not expect a control to support anything more than the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface, and these guidelines identify what interfaces a control may support and what the presence of a particular interface means.</span></span>

## <a name="why-the-activex-control-and-control-container-guidelines-are-important"></a><span data-ttu-id="999b3-122">¿Por qué son importantes las directrices del control ActiveX y del contenedor de controles?</span><span class="sxs-lookup"><span data-stu-id="999b3-122">Why the ActiveX Control and Control Container Guidelines Are Important</span></span>

<span data-ttu-id="999b3-123">Los controles ActiveX se han convertido en la arquitectura principal para el desarrollo de componentes de software programables para su uso en diversos contenedores distintos, desde herramientas de desarrollo de software hasta herramientas de productividad del usuario final.</span><span class="sxs-lookup"><span data-stu-id="999b3-123">ActiveX Controls have become the primary architecture for developing programmable software components for use in a variety of different containers ranging from software development tools to end-user productivity tools.</span></span> <span data-ttu-id="999b3-124">Para que un control funcione correctamente en varios contenedores, el control debe ser capaz de asumir el nivel mínimo de funcionalidad que puede utilizar en todos los contenedores.</span><span class="sxs-lookup"><span data-stu-id="999b3-124">In order for a control to operate well in a variety of containers, the control must be able to assume some minimum level of functionality that it can rely on in all containers.</span></span>

<span data-ttu-id="999b3-125">Siguiendo estas directrices, los desarrolladores de controles y contenedores hacen que sus controles y contenedores sean más confiables e interoperables y, en última instancia, componentes más útiles y más fáciles de usar para compilar soluciones basadas en componentes.</span><span class="sxs-lookup"><span data-stu-id="999b3-125">By following these guidelines, control and container developers make their controls and containers more reliable and interoperable, and ultimately, better and more usable components for building component-based solutions.</span></span>

## <a name="what-to-do-when-an-interface-you-need-is-not-available"></a><span data-ttu-id="999b3-126">Qué hacer cuando una interfaz que necesita no está disponible</span><span class="sxs-lookup"><span data-stu-id="999b3-126">What to Do When an Interface You Need Is Not Available</span></span>

<span data-ttu-id="999b3-127">Los programas OLE deben usar [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) para adquirir punteros de interfaz y deben comprobar el valor devuelto.</span><span class="sxs-lookup"><span data-stu-id="999b3-127">OLE programs should use [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) to acquire interface pointers, and must check the return value.</span></span> <span data-ttu-id="999b3-128">Las aplicaciones OLE no pueden suponer con seguridad que **QueryInterface** se realizará correctamente.</span><span class="sxs-lookup"><span data-stu-id="999b3-128">OLE applications cannot safely assume that **QueryInterface** will succeed.</span></span>

<span data-ttu-id="999b3-129">Este requisito se aplica a todas las aplicaciones OLE.</span><span class="sxs-lookup"><span data-stu-id="999b3-129">This requirement applies to all OLE applications.</span></span> <span data-ttu-id="999b3-130">Si la interfaz solicitada no está disponible (es decir, [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) devuelve E \_ nointerface), el control o el contenedor deben degradarse correctamente, incluso si eso significa que no puede realizar su función de trabajo designada.</span><span class="sxs-lookup"><span data-stu-id="999b3-130">If the requested interface is not available (that is, [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) returns E\_NOINTERFACE), the control or container must degrade gracefully, even if that means that it cannot perform its designated job function.</span></span>

## <a name="related-topics"></a><span data-ttu-id="999b3-131">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="999b3-131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="999b3-132">Directrices para el contenedor de controles y controles ActiveX</span><span class="sxs-lookup"><span data-stu-id="999b3-132">ActiveX Control and Control Container Guidelines</span></span>](activex-control-and-control-container-guidelines.md)
</dt> </dl>

 

 




