---
title: Composiciones
description: Una composición es un estado de entrada temporal que permite a un servicio de texto especificar tanto a la aplicación como al usuario que el texto de entrada sigue en un estado de cambio.
ms.assetid: 3d9da4f2-ceb9-4abc-8979-d3756d948a57
keywords:
- Text Services Framework (TSF), composiciones
- TSF (marco de trabajo de servicios de texto), composiciones
- servicios de texto, composiciones
- Aplicaciones habilitadas para TSF, composiciones
- compositions
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0b03f3e991f76ee7c6dca3830267796576c7b842
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104421188"
---
# <a name="compositions"></a><span data-ttu-id="22dd1-108">Composiciones</span><span class="sxs-lookup"><span data-stu-id="22dd1-108">Compositions</span></span>

<span data-ttu-id="22dd1-109">Una composición es un estado de entrada temporal que permite a un servicio de texto especificar tanto a la aplicación como al usuario que el texto de entrada sigue en un estado de cambio.</span><span class="sxs-lookup"><span data-stu-id="22dd1-109">A composition is a temporary input state that enables a text service to specify both to the application and the user that the input text is still in a state of change.</span></span> <span data-ttu-id="22dd1-110">Una aplicación puede y debe obtener información sobre el atributo de presentación sobre la composición y utilizar esta información para mostrar el estado de composición al usuario.</span><span class="sxs-lookup"><span data-stu-id="22dd1-110">An application can and should obtain display attribute information about the composition and use this information to display the composition state to the user.</span></span>

<span data-ttu-id="22dd1-111">Un ejemplo del uso de una composición es durante la entrada de voz.</span><span class="sxs-lookup"><span data-stu-id="22dd1-111">One example of the use of a composition is during speech input.</span></span> <span data-ttu-id="22dd1-112">Mientras el usuario está hablando, el servicio de texto de voz crea una composición.</span><span class="sxs-lookup"><span data-stu-id="22dd1-112">While the user is speaking, the speech text service creates a composition.</span></span> <span data-ttu-id="22dd1-113">Esta composición permanecerá intacta hasta que se complete toda la entrada de voz.</span><span class="sxs-lookup"><span data-stu-id="22dd1-113">This composition will remain intact until the entire speech input is complete.</span></span> <span data-ttu-id="22dd1-114">Cuando finaliza la sesión, el servicio de texto de voz finaliza la composición.</span><span class="sxs-lookup"><span data-stu-id="22dd1-114">When the session ends, the speech text service terminates the composition.</span></span>

<span data-ttu-id="22dd1-115">Una aplicación utiliza la presencia y la ausencia de una composición para determinar cómo mostrar texto y qué procesamiento se debe realizar en el texto.</span><span class="sxs-lookup"><span data-stu-id="22dd1-115">An application uses the presence and absence of a composition to determine how to display text and what, if any, processing should be performed on the text.</span></span> <span data-ttu-id="22dd1-116">Por ejemplo, si el usuario usa el motor de voz para introducir texto, la aplicación no debe realizar ninguna revisión ortográfica o gramatical en ningún texto de la composición.</span><span class="sxs-lookup"><span data-stu-id="22dd1-116">For example, if the user is using the speech engine to input text, the application should not perform any spelling or grammar checking on any composition text.</span></span> <span data-ttu-id="22dd1-117">El texto se considera incompleto hasta que se termina la composición.</span><span class="sxs-lookup"><span data-stu-id="22dd1-117">The text is considered incomplete until the composition is terminated.</span></span>

## <a name="text-services"></a><span data-ttu-id="22dd1-118">Servicios de texto</span><span class="sxs-lookup"><span data-stu-id="22dd1-118">Text Services</span></span>

<span data-ttu-id="22dd1-119">Un servicio de texto crea una composición mediante una llamada a [ITfContextComposition:: StartComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextcomposition-startcomposition).</span><span class="sxs-lookup"><span data-stu-id="22dd1-119">A text service creates a composition by calling [ITfContextComposition::StartComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextcomposition-startcomposition).</span></span> <span data-ttu-id="22dd1-120">El servicio de texto puede implementar opcionalmente un objeto [ITfCompositionSink](/windows/desktop/api/msctf/nn-msctf-itfcompositionsink) que recibe notificaciones de eventos de composición.</span><span class="sxs-lookup"><span data-stu-id="22dd1-120">The text service can optionally implement an [ITfCompositionSink](/windows/desktop/api/msctf/nn-msctf-itfcompositionsink) object that receives composition event notifications.</span></span> <span data-ttu-id="22dd1-121">StartComposition devuelve un objeto [ITfComposition](/windows/desktop/api/msctf/nn-msctf-itfcomposition) al que el servicio de texto mantiene una referencia y utiliza para modificar y finalizar la composición.</span><span class="sxs-lookup"><span data-stu-id="22dd1-121">StartComposition returns an [ITfComposition](/windows/desktop/api/msctf/nn-msctf-itfcomposition) object that the text service keeps a reference to and uses to modify and terminate the composition.</span></span> <span data-ttu-id="22dd1-122">El servicio de texto finaliza la composición mediante una llamada a [ITfComposition:: EndComposition](/windows/desktop/api/msctf/nf-msctf-itfcomposition-endcomposition).</span><span class="sxs-lookup"><span data-stu-id="22dd1-122">The text service terminates the composition by calling [ITfComposition::EndComposition](/windows/desktop/api/msctf/nf-msctf-itfcomposition-endcomposition).</span></span>

<span data-ttu-id="22dd1-123">Si un servicio de texto va a crear composiciones, también debe admitir atributos de presentación para permitir que una aplicación muestre texto que forma parte de una composición de forma distinta que el texto estándar.</span><span class="sxs-lookup"><span data-stu-id="22dd1-123">If a text service is going to create compositions, it should also support display attributes to enable an application to display text that is part of a composition differently than standard text.</span></span> <span data-ttu-id="22dd1-124">Para obtener más información, vea [proporcionar atributos para mostrar](providing-display-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="22dd1-124">For more information, see [Providing Display Attributes](providing-display-attributes.md).</span></span>

## <a name="applications"></a><span data-ttu-id="22dd1-125">APLICACIONES</span><span class="sxs-lookup"><span data-stu-id="22dd1-125">Applications</span></span>

<span data-ttu-id="22dd1-126">Una aplicación puede supervisar la creación, el cambio y la finalización de las composiciones mediante la instalación de un receptor de [ITfContextOwnerCompositionSink](/windows/desktop/api/msctf/nn-msctf-itfcontextownercompositionsink) .</span><span class="sxs-lookup"><span data-stu-id="22dd1-126">An application can monitor the creation, change and termination of compositions by installing an [ITfContextOwnerCompositionSink](/windows/desktop/api/msctf/nn-msctf-itfcontextownercompositionsink) sink.</span></span> <span data-ttu-id="22dd1-127">Cuando se inicia una composición, se llama a [ITfContextOwnerCompositionSink:: OnStartComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextownercompositionsink-onstartcomposition) .</span><span class="sxs-lookup"><span data-stu-id="22dd1-127">When a composition is started, [ITfContextOwnerCompositionSink::OnStartComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextownercompositionsink-onstartcomposition) is called.</span></span> <span data-ttu-id="22dd1-128">Del mismo modo, cuando se cambia o finaliza una composición, se llamará a [ITfContextOwnerCompositionSink:: OnUpdateComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextownercompositionsink-onupdatecomposition) y [ITfContextOwnerCompositionSink:: OnEndComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextownercompositionsink-onendcomposition) , respectivamente.</span><span class="sxs-lookup"><span data-stu-id="22dd1-128">Likewise, when a composition is changed or terminated, [ITfContextOwnerCompositionSink::OnUpdateComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextownercompositionsink-onupdatecomposition) and [ITfContextOwnerCompositionSink::OnEndComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextownercompositionsink-onendcomposition) will be called, respectively.</span></span>

<span data-ttu-id="22dd1-129">El siguiente es un procedimiento típico para actualizar un documento mediante una composición.</span><span class="sxs-lookup"><span data-stu-id="22dd1-129">The following is a typical procedure to update a document using a composition.</span></span>

1.  <span data-ttu-id="22dd1-130">[ITextStoreACP:: InsertTextAtSelection](/windows/desktop/api/Textstor/nf-textstor-itextstoreacp-inserttextatselection) o [ITextStoreAnchor:: InsertTextAtSelection](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-inserttextatselection) se usan normalmente para insertar el texto inicial en la composición.</span><span class="sxs-lookup"><span data-stu-id="22dd1-130">[ITextStoreACP::InsertTextAtSelection](/windows/desktop/api/Textstor/nf-textstor-itextstoreacp-inserttextatselection) or [ITextStoreAnchor::InsertTextAtSelection](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-inserttextatselection) are typically used to insert the initial text into the composition.</span></span>
2.  <span data-ttu-id="22dd1-131">La composición se inicia con una llamada a [ITfContextComposition:: StartComposition](/windows/desktop/api/Msctf/nf-msctf-itfcontextcomposition-startcomposition), utilizando el intervalo de texto devuelto por **InsertTextAtSelection**.</span><span class="sxs-lookup"><span data-stu-id="22dd1-131">The composition is started with a call to [ITfContextComposition::StartComposition](/windows/desktop/api/Msctf/nf-msctf-itfcontextcomposition-startcomposition), using the range of text returned by **InsertTextAtSelection**.</span></span>
3.  <span data-ttu-id="22dd1-132">Cuando recibe una entrada nueva, como la entrada de voz o el teclado, la aplicación actualiza la composición con [ITextStoreACP:: setText](/windows/desktop/api/Textstor/nf-textstor-itextstoreacp-settext) o [ITextStoreAnchor:: setText](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-settext).</span><span class="sxs-lookup"><span data-stu-id="22dd1-132">When it receives new input such as speech or keyboard entry, the application updates the composition with [ITextStoreACP::SetText](/windows/desktop/api/Textstor/nf-textstor-itextstoreacp-settext) or [ITextStoreAnchor::SetText](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-settext).</span></span>
4.  <span data-ttu-id="22dd1-133">Cuando la aplicación determina que es el momento de finalizar la composición, llama a [ITfComposition:: EndComposition](/windows/desktop/api/Msctf/nf-msctf-itfcomposition-endcomposition).</span><span class="sxs-lookup"><span data-stu-id="22dd1-133">When the application determines that it is time to end the composition, it calls [ITfComposition::EndComposition](/windows/desktop/api/Msctf/nf-msctf-itfcomposition-endcomposition).</span></span>

<span data-ttu-id="22dd1-134">La aplicación debe usar los atributos de presentación proporcionados por el servicio de texto para modificar la presentación de texto en todo momento y no solo cuando una composición está activa.</span><span class="sxs-lookup"><span data-stu-id="22dd1-134">The application should use the display attributes provided by the text service to modify the display of text at all times and not just when a composition is active.</span></span> <span data-ttu-id="22dd1-135">Para obtener más información, vea [using display Attributes](using-display-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="22dd1-135">For more information, see [Using Display Attributes](using-display-attributes.md).</span></span>

<span data-ttu-id="22dd1-136">Si es necesario, una aplicación puede finalizar una composición mediante una llamada a [ITfContextOwnerCompositionServices:: TerminateComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextownercompositionservices-terminatecomposition).</span><span class="sxs-lookup"><span data-stu-id="22dd1-136">If necessary, an application can terminate a composition by calling [ITfContextOwnerCompositionServices::TerminateComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextownercompositionservices-terminatecomposition).</span></span>

 

 