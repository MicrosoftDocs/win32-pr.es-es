---
title: Cómo crear asistentes
description: Un asistente es un tipo de hoja de propiedades que proporciona una manera sencilla y eficaz de guiar a los usuarios a través de un procedimiento.
ms.assetid: f8def159-0a68-4d7f-9840-c7b6b906ed08
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fedd35bd0454e0d78ddbe74d832543e58d0a8fc7
ms.sourcegitcommit: 11f52354f570aacaf1ba2a266b2e507abd73352a
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/19/2021
ms.locfileid: "105660107"
---
# <a name="how-to-create-wizards"></a><span data-ttu-id="745fb-103">Cómo crear asistentes</span><span class="sxs-lookup"><span data-stu-id="745fb-103">How to Create Wizards</span></span>

<span data-ttu-id="745fb-104">Un asistente es un tipo de hoja de propiedades que proporciona una manera sencilla y eficaz de guiar a los usuarios a través de un procedimiento.</span><span class="sxs-lookup"><span data-stu-id="745fb-104">A wizard is a type of property sheet that provides a simple and powerful way to guide users through a procedure.</span></span>

<span data-ttu-id="745fb-105">Los asistentes son una de las claves para simplificar la experiencia del usuario.</span><span class="sxs-lookup"><span data-stu-id="745fb-105">Wizards are one of the keys to simplifying the user experience.</span></span> <span data-ttu-id="745fb-106">Permiten realizar una operación compleja, como la configuración de una aplicación, y dividirla en una serie de pasos sencillos.</span><span class="sxs-lookup"><span data-stu-id="745fb-106">They allow you to take a complex operation, such as configuration of an application, and break it into a series of simple steps.</span></span> <span data-ttu-id="745fb-107">En cada punto del proceso, puede proporcionar una explicación de lo que se necesita y mostrar los controles que permiten al usuario realizar selecciones y escribir texto.</span><span class="sxs-lookup"><span data-stu-id="745fb-107">At each point in the process, you can provide an explanation of what is needed, and display controls that allow the user to make selections and enter text.</span></span>

<span data-ttu-id="745fb-108">Un asistente es realmente un tipo de hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="745fb-108">A wizard is actually a type of property sheet.</span></span> <span data-ttu-id="745fb-109">Una hoja de propiedades es esencialmente un contenedor para una colección de *páginas*, donde cada página es un cuadro de diálogo independiente.</span><span class="sxs-lookup"><span data-stu-id="745fb-109">A property sheet is essentially a container for a collection of *pages*, where each page is a separate dialog box.</span></span> <span data-ttu-id="745fb-110">Mientras que las hojas de propiedades normales permiten que el usuario tenga acceso a cualquier página en cualquier momento, los asistentes presentan las páginas en secuencia.</span><span class="sxs-lookup"><span data-stu-id="745fb-110">Whereas regular property sheets allow the user to access any page at any time, wizards present pages in sequence.</span></span> <span data-ttu-id="745fb-111">En lugar de pestañas, los botones se utilizan para navegar hacia delante y hacia atrás.</span><span class="sxs-lookup"><span data-stu-id="745fb-111">Instead of tabs, buttons are used to navigate forward and backward.</span></span> <span data-ttu-id="745fb-112">La aplicación controla el orden en que se muestran las páginas y se puede modificar en función de los datos proporcionados por el usuario.</span><span class="sxs-lookup"><span data-stu-id="745fb-112">The order in which pages are displayed is controlled by the application and can be modified based on user input.</span></span>

<span data-ttu-id="745fb-113">Hay dos estilos principales del asistente: el estilo Wizard97 anterior y el estilo Aero introducido en Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="745fb-113">There are two main styles of wizard: the older Wizard97 style, and the Aero style introduced in Windows Vista.</span></span> <span data-ttu-id="745fb-114">Para ver ilustraciones, consulte Acerca de las [hojas de propiedades](property-sheets.md).</span><span class="sxs-lookup"><span data-stu-id="745fb-114">For illustrations, see [About Property Sheets](property-sheets.md).</span></span> <span data-ttu-id="745fb-115">(Un tercer estilo, con solo el PSH \_ \_La marca Lite del asistente o del Asistente para PSH \_ muestra una secuencia simple de hojas de propiedades sin encabezados ni marcas de agua).</span><span class="sxs-lookup"><span data-stu-id="745fb-115">(A third style, using just the PSH\_WIZARD or PSH\_WIZARD\_LITE flag, presents a simple sequence of property sheets with no headers or watermarks.)</span></span>

> [!Note]  
> <span data-ttu-id="745fb-116">Una "marca de agua" en el contexto de los asistentes es un mapa de bits que aparece en el margen izquierdo de algunas páginas.</span><span class="sxs-lookup"><span data-stu-id="745fb-116">A "watermark" in the context of wizards is a bitmap that appears in the left margin of some pages.</span></span>

 

<span data-ttu-id="745fb-117">En la mayor parte de este documento se da por supuesto que está implementando un asistente para un sistema con la [versión 5,80](common-control-versions.md) o posterior de los controles comunes.</span><span class="sxs-lookup"><span data-stu-id="745fb-117">The discussion in most of this document assumes that you are implementing a wizard for a system with [version 5.80](common-control-versions.md) or later of the common controls.</span></span> <span data-ttu-id="745fb-118">Si intenta usar el estilo Wizard97 con versiones anteriores de los controles comunes, la aplicación puede compilarse pero no se mostrará correctamente.</span><span class="sxs-lookup"><span data-stu-id="745fb-118">If you attempt to use the Wizard97 style with earlier versions of the common controls, your application may compile but it will not display properly.</span></span> <span data-ttu-id="745fb-119">Para obtener una explicación sobre cómo crear un asistente compatible con Wizard97 en sistemas anteriores, vea asistentes compatibles con versiones anteriores en este tema.</span><span class="sxs-lookup"><span data-stu-id="745fb-119">For a discussion about how to create a Wizard97-compatible wizard on earlier systems, see Backward Compatible Wizards later in this topic.</span></span>

## <a name="what-you-need-to-know"></a><span data-ttu-id="745fb-120">Aspectos que debe saber</span><span class="sxs-lookup"><span data-stu-id="745fb-120">What you need to know</span></span>

### <a name="technologies"></a><span data-ttu-id="745fb-121">Tecnologías</span><span class="sxs-lookup"><span data-stu-id="745fb-121">Technologies</span></span>

-   [<span data-ttu-id="745fb-122">Controles de Windows</span><span class="sxs-lookup"><span data-stu-id="745fb-122">Windows Controls</span></span>](window-controls.md)

### <a name="prerequisites"></a><span data-ttu-id="745fb-123">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="745fb-123">Prerequisites</span></span>

-   <span data-ttu-id="745fb-124">C/C++</span><span class="sxs-lookup"><span data-stu-id="745fb-124">C/C++</span></span>
-   <span data-ttu-id="745fb-125">Programación de la interfaz de usuario de Windows</span><span class="sxs-lookup"><span data-stu-id="745fb-125">Windows User Interface Programming</span></span>

## <a name="instructions"></a><span data-ttu-id="745fb-126">Instrucciones</span><span class="sxs-lookup"><span data-stu-id="745fb-126">Instructions</span></span>

### <a name="wizard-implementation"></a><span data-ttu-id="745fb-127">Implementación del asistente</span><span class="sxs-lookup"><span data-stu-id="745fb-127">Wizard Implementation</span></span>

<span data-ttu-id="745fb-128">La implementación de un asistente es similar a la implementación de una hoja de propiedades normal.</span><span class="sxs-lookup"><span data-stu-id="745fb-128">Implementing a wizard is similar to implementing a regular property sheet.</span></span> <span data-ttu-id="745fb-129">En el nivel más básico, es cuestión de establecer una de las siguientes marcas o combinaciones de marcas en la estructura [**PROPSHEETHEADER**](pss-propsheetheader.md) que define la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="745fb-129">At the most basic level, it is a matter of setting one of the following flags or combinations of flags in the [**PROPSHEETHEADER**](pss-propsheetheader.md) structure that defines the property sheet.</span></span>



| <span data-ttu-id="745fb-130">Marca</span><span class="sxs-lookup"><span data-stu-id="745fb-130">Flag</span></span>                           | <span data-ttu-id="745fb-131">Estilo</span><span class="sxs-lookup"><span data-stu-id="745fb-131">Style</span></span>                                                                                                                                                 |
|--------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="745fb-132">\_Asistente para PSH</span><span class="sxs-lookup"><span data-stu-id="745fb-132">PSH\_WIZARD</span></span>                    | <span data-ttu-id="745fb-133">Un sencillo asistente sin encabezados ni mapas de bits.</span><span class="sxs-lookup"><span data-stu-id="745fb-133">A simple wizard with no headers or bitmaps.</span></span>                                                                                                           |
| <span data-ttu-id="745fb-134">\_Asistente para PSH \_ Lite</span><span class="sxs-lookup"><span data-stu-id="745fb-134">PSH\_WIZARD\_LITE</span></span>              | <span data-ttu-id="745fb-135">Similar al Asistente para PSH \_ , con algunas pequeñas diferencias de apariencia; por ejemplo, el divisor situado encima de los botones se establece en el ancho completo de la ventana.</span><span class="sxs-lookup"><span data-stu-id="745fb-135">Similar to PSH\_WIZARD, with some minor differences in appearance; for example, the divider above the buttons is set to the full width of the window.</span></span> |
| <span data-ttu-id="745fb-136">PSH \_ WIZARD97</span><span class="sxs-lookup"><span data-stu-id="745fb-136">PSH\_WIZARD97</span></span>                  | <span data-ttu-id="745fb-137">Un asistente de Wizard97 con encabezados (opcionales), mapas de bits de encabezado y marcas de agua.</span><span class="sxs-lookup"><span data-stu-id="745fb-137">A Wizard97 wizard with (optional) headers, header bitmaps, and watermarks.</span></span>                                                                            |
| <span data-ttu-id="745fb-138">\_Asistente para PSH \| PSH \_ AEROWIZARD</span><span class="sxs-lookup"><span data-stu-id="745fb-138">PSH\_WIZARD \| PSH\_AEROWIZARD</span></span> | <span data-ttu-id="745fb-139">Un asistente de Aero.</span><span class="sxs-lookup"><span data-stu-id="745fb-139">An Aero Wizard.</span></span> <span data-ttu-id="745fb-140">Los asistentes de Aero no utilizan marcas de agua ni mapas de bits de encabezado.</span><span class="sxs-lookup"><span data-stu-id="745fb-140">Aero Wizards do not use watermarks or header bitmaps.</span></span> <span data-ttu-id="745fb-141">Requieren el modelo de contenedor uniproceso (STA).</span><span class="sxs-lookup"><span data-stu-id="745fb-141">They require the single-threaded apartment (STA) model.</span></span>                         |



 

<span data-ttu-id="745fb-142">El procedimiento básico para implementar un asistente es el siguiente:</span><span class="sxs-lookup"><span data-stu-id="745fb-142">The basic procedure for implementing a wizard is as follows:</span></span>

1.  <span data-ttu-id="745fb-143">Cree una plantilla de cuadro de diálogo para cada página.</span><span class="sxs-lookup"><span data-stu-id="745fb-143">Create a dialog box template for each page.</span></span>
2.  <span data-ttu-id="745fb-144">Defina las páginas mediante la creación de una estructura [**PROPSHEETPAGE**](pss-propsheetpage.md) para cada página.</span><span class="sxs-lookup"><span data-stu-id="745fb-144">Define the pages by creating a [**PROPSHEETPAGE**](pss-propsheetpage.md) structure for each page.</span></span> <span data-ttu-id="745fb-145">Esta estructura define la página y contiene punteros a la plantilla de cuadro de diálogo y a cualquier mapa de bits u otros recursos.</span><span class="sxs-lookup"><span data-stu-id="745fb-145">This structure defines the page, and contains pointers to the dialog box template and any bitmaps or other resources.</span></span>
3.  <span data-ttu-id="745fb-146">Pase la estructura [**PROPSHEETPAGE**](pss-propsheetpage.md) que se creó en el paso anterior a la función [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) para crear el identificador HPROPSHEETPAGE de la página.</span><span class="sxs-lookup"><span data-stu-id="745fb-146">Pass the [**PROPSHEETPAGE**](pss-propsheetpage.md) structure that was created in the previous step to the [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) function to create the page's HPROPSHEETPAGE handle.</span></span>
4.  <span data-ttu-id="745fb-147">Defina el asistente mediante la creación de una estructura [**PROPSHEETHEADER**](pss-propsheetheader.md) para él.</span><span class="sxs-lookup"><span data-stu-id="745fb-147">Define the wizard by creating a [**PROPSHEETHEADER**](pss-propsheetheader.md) structure for it.</span></span>
5.  <span data-ttu-id="745fb-148">Pase la estructura [**PROPSHEETHEADER**](pss-propsheetheader.md) a la función [**hoja**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) para mostrar el asistente.</span><span class="sxs-lookup"><span data-stu-id="745fb-148">Pass the [**PROPSHEETHEADER**](pss-propsheetheader.md) structure to the [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) function to display the wizard.</span></span>
6.  <span data-ttu-id="745fb-149">Implemente procedimientos de cuadro de diálogo para cada página con el fin de controlar los mensajes de notificación de los controles de la página y los botones del asistente y para procesar otros mensajes de mensajería de Windows.</span><span class="sxs-lookup"><span data-stu-id="745fb-149">Implement dialog box procedures for each page to handle notification messages from the page's controls and the wizard's buttons and to process other Windows messaging.</span></span>

### <a name="create-the-dialog-box-templates"></a><span data-ttu-id="745fb-150">Crear las plantillas de cuadro de diálogo</span><span class="sxs-lookup"><span data-stu-id="745fb-150">Create the Dialog Box Templates</span></span>

<span data-ttu-id="745fb-151">Hay dos tipos básicos de página del asistente: exterior y interior.</span><span class="sxs-lookup"><span data-stu-id="745fb-151">There are two basic types of wizard page: exterior and interior.</span></span> <span data-ttu-id="745fb-152">Las páginas exteriores son la introducción (bienvenida) y las páginas de finalización.</span><span class="sxs-lookup"><span data-stu-id="745fb-152">Exterior pages are the introduction (welcome) and completion pages.</span></span> <span data-ttu-id="745fb-153">Todas las demás son páginas interiores.</span><span class="sxs-lookup"><span data-stu-id="745fb-153">All others are interior pages.</span></span>

<span data-ttu-id="745fb-154">**Plantillas de cuadro de diálogo de página exterior**</span><span class="sxs-lookup"><span data-stu-id="745fb-154">**Exterior Page Dialog Box Templates**</span></span>

<span data-ttu-id="745fb-155">El diseño básico de las páginas de introducción y finalización es idéntico.</span><span class="sxs-lookup"><span data-stu-id="745fb-155">The basic layout of the introduction and completion pages is identical.</span></span> <span data-ttu-id="745fb-156">En la ilustración siguiente se muestra una página de introducción de Wizard97 de ejemplo, con una marca de agua de marcador de posición.</span><span class="sxs-lookup"><span data-stu-id="745fb-156">The following illustration shows a sample Wizard97 introduction page, with a placeholder watermark.</span></span>

![captura de pantalla que muestra una página del asistente con un gráfico a la izquierda, el título y el texto del cuerpo de los botones derecho y atrás, siguiente y cancelar en la parte inferior](images/wiz97exterior.png)

<span data-ttu-id="745fb-158">En el caso de las páginas de Wizard97 exterior, la plantilla de cuadro de diálogo es 317x193 unidades de cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="745fb-158">For Wizard97 exterior pages, the dialog box template is 317x193 dialog units.</span></span> <span data-ttu-id="745fb-159">Rellena todo el asistente, excepto el título y la banda de la parte inferior que contiene los botones **atrás**, **siguiente** y **Cancelar** .</span><span class="sxs-lookup"><span data-stu-id="745fb-159">It fills all of the wizard, except for the caption and the band at the bottom that contains the **Back**, **Next**, and **Cancel** buttons.</span></span> <span data-ttu-id="745fb-160">El lado izquierdo de la plantilla, que está reservado para un mapa de bits de "marca de agua", no debe contener ningún control.</span><span class="sxs-lookup"><span data-stu-id="745fb-160">The left side of the template, which is reserved for a "watermark" bitmap, should not contain any controls.</span></span> <span data-ttu-id="745fb-161">La marca de agua se especifica en la estructura [**PROPSHEETHEADER**](pss-propsheetheader.md) del asistente y se agrega a la página automáticamente.</span><span class="sxs-lookup"><span data-stu-id="745fb-161">The watermark is specified in the wizard's [**PROPSHEETHEADER**](pss-propsheetheader.md) structure and is added to the page automatically.</span></span> <span data-ttu-id="745fb-162">Debe permitir el espacio al diseñar la plantilla de recursos.</span><span class="sxs-lookup"><span data-stu-id="745fb-162">You must allow space for it when designing the resource template.</span></span>

<span data-ttu-id="745fb-163">Al crear el mapa de bits de la marca de agua, tenga en cuenta que el cuadro de diálogo puede aumentar de tamaño si, por ejemplo, el usuario elige una fuente grande del sistema.</span><span class="sxs-lookup"><span data-stu-id="745fb-163">When you create the watermark bitmap, keep in mind that the dialog box may increase in size if, for example, the user chooses a large system font.</span></span> <span data-ttu-id="745fb-164">Otros idiomas también suelen tener distintas métricas de fuentes.</span><span class="sxs-lookup"><span data-stu-id="745fb-164">Different languages also tend to have different font metrics.</span></span> <span data-ttu-id="745fb-165">Cuando la página aumenta de tamaño, el área reservada para la marca de agua se obtiene proporcionalmente.</span><span class="sxs-lookup"><span data-stu-id="745fb-165">When the page grows, the area reserved for the watermark gets proportionately larger.</span></span> <span data-ttu-id="745fb-166">Sin embargo, no puede cambiar el mapa de bits de la marca de agua ni el mapa de bits estirado para rellenar el área más grande.</span><span class="sxs-lookup"><span data-stu-id="745fb-166">However, you cannot change the watermark bitmap, nor is the bitmap stretched to fill the larger area.</span></span> <span data-ttu-id="745fb-167">En su lugar, el mapa de bits se deja en su tamaño original en la parte superior izquierda del área reservada.</span><span class="sxs-lookup"><span data-stu-id="745fb-167">Instead, the bitmap is left in its original size in the upper-left portion of the reserved area.</span></span> <span data-ttu-id="745fb-168">La parte del área reservada más grande que no está incluida en la marca de agua se rellena automáticamente con el color del píxel superior izquierdo del mapa de bits.</span><span class="sxs-lookup"><span data-stu-id="745fb-168">The part of the larger reserved area that is not covered by the watermark is automatically filled with the color of the bitmap's upper-left pixel.</span></span>

<span data-ttu-id="745fb-169">Si necesita tener mapas de bits de una marca de agua de tamaño diferente para distintas métricas de fuente, existen dos soluciones posibles:</span><span class="sxs-lookup"><span data-stu-id="745fb-169">If you need to have different-sized watermark bitmaps for different font metrics, two possible solutions are:</span></span>

-   <span data-ttu-id="745fb-170">Obtenga las métricas de fuente antes de crear el asistente y especifique un mapa de bits de marca de agua de tamaño adecuado.</span><span class="sxs-lookup"><span data-stu-id="745fb-170">Get the font metrics before creating the wizard, and specify an appropriately sized watermark bitmap.</span></span>
-   <span data-ttu-id="745fb-171">No especifique un mapa de bits de marca de agua al crear el asistente.</span><span class="sxs-lookup"><span data-stu-id="745fb-171">Do not specify a watermark bitmap when you create the wizard.</span></span> <span data-ttu-id="745fb-172">Wizard97 dejará el área de marca de agua en blanco.</span><span class="sxs-lookup"><span data-stu-id="745fb-172">Wizard97 will leave the watermark area blank.</span></span> <span data-ttu-id="745fb-173">A continuación, dibuje un mapa de bits de tamaño adecuado en el área reservada para la marca de agua.</span><span class="sxs-lookup"><span data-stu-id="745fb-173">Then draw an appropriately sized bitmap on the area reserved for the watermark.</span></span>

<span data-ttu-id="745fb-174">Puede colocar controles en el área situada a la derecha de la marca de agua como lo haría con un cuadro de diálogo normal.</span><span class="sxs-lookup"><span data-stu-id="745fb-174">You can place controls in the area to the right of the watermark as you would for a regular dialog box.</span></span> <span data-ttu-id="745fb-175">El color de fondo de esta área viene determinado por el sistema y no requiere ninguna acción por su parte.</span><span class="sxs-lookup"><span data-stu-id="745fb-175">The background color of this area is determined by the system, and requires no action on your part.</span></span> <span data-ttu-id="745fb-176">Normalmente, se colocan dos controles estáticos en esta área.</span><span class="sxs-lookup"><span data-stu-id="745fb-176">You typically put two static controls in this area.</span></span> <span data-ttu-id="745fb-177">La parte superior contiene el título y utiliza una fuente Negrita grande (de 12 puntos Verdana negrita para Wizard97).</span><span class="sxs-lookup"><span data-stu-id="745fb-177">The upper one holds the title and uses a large bold font (12 point Verdana Bold for Wizard97).</span></span> <span data-ttu-id="745fb-178">El otro, que es para texto explicativo, usa la fuente del cuadro de diálogo estándar.</span><span class="sxs-lookup"><span data-stu-id="745fb-178">The other one, which is for explanatory text, uses the standard dialog box font.</span></span>

<span data-ttu-id="745fb-179">La diferencia principal entre las páginas introducción y finalización son los botones del asistente y el texto de los controles estáticos.</span><span class="sxs-lookup"><span data-stu-id="745fb-179">The main difference between the introduction and completion pages is the wizard buttons and the text in the static controls.</span></span> <span data-ttu-id="745fb-180">Normalmente, las páginas de introducción tienen un botón **siguiente** y otro **hacia atrás** , con solo el botón **siguiente** habilitado.</span><span class="sxs-lookup"><span data-stu-id="745fb-180">Introduction pages normally have a **Next** and a **Back** button, with only the **Next** button enabled.</span></span> <span data-ttu-id="745fb-181">Las páginas de finalización tienen el botón **atrás** habilitado y el botón **siguiente** se sustituye por un botón **Finalizar** .</span><span class="sxs-lookup"><span data-stu-id="745fb-181">Completion pages have the **Back** button enabled, and the **Next** button is replaced by a **Finish** button.</span></span>

> [!Note]  
> <span data-ttu-id="745fb-182">En los asistentes de Aero, el botón **atrás** se sustituye por un botón de flecha en la barra de título.</span><span class="sxs-lookup"><span data-stu-id="745fb-182">In Aero Wizards, the **Back** button is replaced by an arrow button in the caption bar.</span></span>

 

<span data-ttu-id="745fb-183">Puede modificar el texto del botón **Finalizar** mediante el envío del asistente a un [**mensaje \_ SETFINISHTEXT de PSM**](psm-setfinishtext.md) .</span><span class="sxs-lookup"><span data-stu-id="745fb-183">You can modify the text on the **Finish** button by sending the wizard a [**PSM\_SETFINISHTEXT**](psm-setfinishtext.md) message.</span></span> <span data-ttu-id="745fb-184">De forma predeterminada, el botón **Finalizar** no incluye una tecla de aceleración.</span><span class="sxs-lookup"><span data-stu-id="745fb-184">By default, the **Finish** button does not include a keyboard accelerator.</span></span> <span data-ttu-id="745fb-185">Para definir una tecla de aceleración, incluya una y comercial en la cadena de texto que pase a PSM \_ SETFINISHTEXT.</span><span class="sxs-lookup"><span data-stu-id="745fb-185">To define a keyboard accelerator, include an ampersand in the text string that you pass to PSM\_SETFINISHTEXT.</span></span> <span data-ttu-id="745fb-186">Por ejemplo, "&finalizar" define ' F ' como la tecla de aceleración.</span><span class="sxs-lookup"><span data-stu-id="745fb-186">For instance, "&Finish" defines 'F' as the keyboard accelerator.</span></span>

<span data-ttu-id="745fb-187">**Plantillas del cuadro de diálogo página interior**</span><span class="sxs-lookup"><span data-stu-id="745fb-187">**Interior Page Dialog Box Templates**</span></span>

<span data-ttu-id="745fb-188">Las páginas interiores tienen una apariencia algo diferente que las páginas exteriores.</span><span class="sxs-lookup"><span data-stu-id="745fb-188">Interior pages have a somewhat different appearance than exterior pages.</span></span> <span data-ttu-id="745fb-189">En la ilustración siguiente se muestra una página interior Wizard97 de ejemplo, con un mapa de bits de encabezado de marcador de posición.</span><span class="sxs-lookup"><span data-stu-id="745fb-189">The following illustration shows a sample Wizard97 interior page, with a placeholder header bitmap.</span></span>

![captura de pantalla de una página del asistente con texto de título y subtítulo y un gráfico en la parte superior, texto en el medio y botones en la parte inferior](images/wiz97interior.png)

<span data-ttu-id="745fb-191">La hoja de propiedades controla el área de encabezado de la parte superior de la página, por lo que no se incluye en la plantilla.</span><span class="sxs-lookup"><span data-stu-id="745fb-191">The header area at the top of the page is handled by the property sheet, so it is not included in the template.</span></span> <span data-ttu-id="745fb-192">El contenido del encabezado se especifica en la estructura [**PROPSHEETPAGE**](pss-propsheetpage.md) de la página y en la estructura [**PROPSHEETHEADER**](pss-propsheetheader.md) del asistente.</span><span class="sxs-lookup"><span data-stu-id="745fb-192">The contents of the header are specified in the page's [**PROPSHEETPAGE**](pss-propsheetpage.md) structure and the wizard's [**PROPSHEETHEADER**](pss-propsheetheader.md) structure.</span></span> <span data-ttu-id="745fb-193">Dado que la página interior debe encajar entre el encabezado y los botones, la plantilla del cuadro de diálogo Wizard97 es 317x143 unidades de cuadro de diálogo, algo más pequeñas que la plantilla para las páginas exteriores.</span><span class="sxs-lookup"><span data-stu-id="745fb-193">Because the interior page needs to fit between the header and the buttons, the Wizard97 dialog box template is 317x143 dialog units, somewhat smaller than the template for exterior pages.</span></span>

<span data-ttu-id="745fb-194">En la ilustración siguiente se muestra un asistente de Aero que se creó a partir de la misma plantilla.</span><span class="sxs-lookup"><span data-stu-id="745fb-194">The following illustration shows an Aero Wizard that was created from the same template.</span></span>

![captura de pantalla que difiere de la anterior al tener un área de título en la parte superior y los botones siguiente y cancelar en la parte inferior](images/wizardaerointerior.png)

### <a name="define-the-wizard-pages"></a><span data-ttu-id="745fb-196">Definir las páginas del asistente</span><span class="sxs-lookup"><span data-stu-id="745fb-196">Define the Wizard Pages</span></span>

<span data-ttu-id="745fb-197">Después de crear las plantillas de cuadro de diálogo y los recursos relacionados, como mapas de bits y tablas de cadenas, puede crear las páginas de la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="745fb-197">After you have created the dialog box templates and related resources such as bitmaps and string tables, you can create the property sheet pages.</span></span> <span data-ttu-id="745fb-198">El procedimiento es similar al de las hojas de propiedades estándar.</span><span class="sxs-lookup"><span data-stu-id="745fb-198">The procedure is similar to that for standard property sheets.</span></span> <span data-ttu-id="745fb-199">En primer lugar, rellene los miembros adecuados de una estructura [**PROPSHEETPAGE**](pss-propsheetpage.md) .</span><span class="sxs-lookup"><span data-stu-id="745fb-199">First, fill in the appropriate members of a [**PROPSHEETPAGE**](pss-propsheetpage.md) structure.</span></span> <span data-ttu-id="745fb-200">(Algunos miembros son específicos de los asistentes). Después, llame a la función [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) para crear el identificador HPROPSHEETPAGE de la página.</span><span class="sxs-lookup"><span data-stu-id="745fb-200">(Some members are specific to wizards.) Then call the [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) function to create the page's HPROPSHEETPAGE handle.</span></span>

<span data-ttu-id="745fb-201">Se pueden establecer las siguientes marcas relacionadas con el asistente en el miembro **dwFlags** de la estructura [**PROPSHEETPAGE**](pss-propsheetpage.md) .</span><span class="sxs-lookup"><span data-stu-id="745fb-201">The following wizard-related flags can be set in the **dwFlags** member of the [**PROPSHEETPAGE**](pss-propsheetpage.md) structure.</span></span>



| <span data-ttu-id="745fb-202">Marca</span><span class="sxs-lookup"><span data-stu-id="745fb-202">Flag</span></span>                   | <span data-ttu-id="745fb-203">Descripción</span><span class="sxs-lookup"><span data-stu-id="745fb-203">Description</span></span>                                                                                                                         |
|------------------------|-------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="745fb-204">PSP \_ HIDEHEADER</span><span class="sxs-lookup"><span data-stu-id="745fb-204">PSP\_HIDEHEADER</span></span>        | <span data-ttu-id="745fb-205">Establezca esta marca para las páginas exteriores en Wizard97.</span><span class="sxs-lookup"><span data-stu-id="745fb-205">Set this flag for exterior pages in Wizard97.</span></span> <span data-ttu-id="745fb-206">El encabezado no se muestra y se puede mostrar una marca de agua.</span><span class="sxs-lookup"><span data-stu-id="745fb-206">The header is not shown, and a watermark can be shown.</span></span>                                |
| <span data-ttu-id="745fb-207">PSP \_ USEHEADERTITLE</span><span class="sxs-lookup"><span data-stu-id="745fb-207">PSP\_USEHEADERTITLE</span></span>    | <span data-ttu-id="745fb-208">Establezca esta marca para las páginas interiores para colocar un título en el área de encabezado de Wizard97 o en la parte superior del área de cliente en un asistente de Aero.</span><span class="sxs-lookup"><span data-stu-id="745fb-208">Set this flag for interior pages to put a title in the header area in Wizard97, or at the top of the client area in an Aero Wizard.</span></span> |
| <span data-ttu-id="745fb-209">PSP \_ USEHEADERSUBTITLE</span><span class="sxs-lookup"><span data-stu-id="745fb-209">PSP\_USEHEADERSUBTITLE</span></span> | <span data-ttu-id="745fb-210">Establezca esta marca para que las páginas interiores colocan un subtítulo en el área de encabezado de Wizard97.</span><span class="sxs-lookup"><span data-stu-id="745fb-210">Set this flag for interior pages to put a subtitle in the header area in Wizard97.</span></span>                                                  |



 

<span data-ttu-id="745fb-211">Si ha establecido PSP \_ USEHEADERTITLE o PSP \_ USEHEADERSUBTITLE, asigne el texto del título y el subtítulo a los miembros **pszHeaderTitle** y **pszHeaderSubtitle** , respectivamente.</span><span class="sxs-lookup"><span data-stu-id="745fb-211">If you have set PSP\_USEHEADERTITLE or PSP\_USEHEADERSUBTITLE, assign the title and subtitle text to the **pszHeaderTitle** and **pszHeaderSubtitle** members, respectively.</span></span> <span data-ttu-id="745fb-212">Al asignar cadenas de texto a miembros de las estructuras [**PROPSHEETPAGE**](pss-propsheetpage.md) y [**PROPSHEETHEADER**](pss-propsheetheader.md) , puede asignar un puntero de cadena o utilizar la macro **MAKEINTRESOURCE** para asignar un valor de un recurso de cadena.</span><span class="sxs-lookup"><span data-stu-id="745fb-212">When you assign text strings to members of the [**PROPSHEETPAGE**](pss-propsheetpage.md) and [**PROPSHEETHEADER**](pss-propsheetheader.md) structures, you can either assign a string pointer or use the **MAKEINTRESOURCE** macro to assign a value from a string resource.</span></span> <span data-ttu-id="745fb-213">El recurso de cadena se carga desde el módulo especificado en el miembro **hInstance** de la estructura **PROPSHEETHEADER** del asistente.</span><span class="sxs-lookup"><span data-stu-id="745fb-213">The string resource is loaded from the module specified in the **hInstance** member of the wizard's **PROPSHEETHEADER** structure.</span></span>

<span data-ttu-id="745fb-214">Cuando llame a [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) para crear una página, asigne el resultado a un elemento de una matriz de identificadores de HPROPSHEETPAGE.</span><span class="sxs-lookup"><span data-stu-id="745fb-214">When you call [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) to create a page, assign the result to an element of an array of HPROPSHEETPAGE handles.</span></span> <span data-ttu-id="745fb-215">Esta matriz se utiliza al crear la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="745fb-215">This array is used when creating the property sheet.</span></span> <span data-ttu-id="745fb-216">El índice de matriz del identificador de una página determina el orden predeterminado en el que se muestra.</span><span class="sxs-lookup"><span data-stu-id="745fb-216">The array index of a page's handle determines the default order in which it is displayed.</span></span> <span data-ttu-id="745fb-217">Después de crear el identificador de HPROPSHEETPAGE de una página, puede volver a usar la misma estructura [**PROPSHEETPAGE**](pss-propsheetpage.md) para crear la siguiente página asignando nuevos valores a los miembros pertinentes.</span><span class="sxs-lookup"><span data-stu-id="745fb-217">After you have created a page's HPROPSHEETPAGE handle, you can reuse the same [**PROPSHEETPAGE**](pss-propsheetpage.md) structure to create the next page by assigning new values to the relevant members.</span></span>

<span data-ttu-id="745fb-218">Una manera alternativa de crear páginas es usar estructuras [**PROPSHEETPAGE**](pss-propsheetpage.md) independientes para cada página y crear una matriz de estructuras.</span><span class="sxs-lookup"><span data-stu-id="745fb-218">An alternative way to create pages is to use separate [**PROPSHEETPAGE**](pss-propsheetpage.md) structures for each page, and create an array of structures.</span></span> <span data-ttu-id="745fb-219">Esta matriz se usa en lugar de una matriz de identificadores de HPROPSHEETPAGE al crear la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="745fb-219">This array is used instead of an array of HPROPSHEETPAGE handles when creating the property sheet.</span></span> <span data-ttu-id="745fb-220">El uso de estructuras **PROPSHEETPAGE** independientes elimina la necesidad de llamar a [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) , pero utiliza más memoria.</span><span class="sxs-lookup"><span data-stu-id="745fb-220">Using separate **PROPSHEETPAGE** structures eliminates the need to call [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) but uses more memory.</span></span> <span data-ttu-id="745fb-221">De lo contrario, no hay ninguna diferencia significativa entre los dos enfoques.</span><span class="sxs-lookup"><span data-stu-id="745fb-221">Otherwise, there is no significant difference between the two approaches.</span></span>

<span data-ttu-id="745fb-222">En el ejemplo siguiente se define una página interior de Wizard97 asignando valores a una estructura [**PROPSHEETPAGE**](pss-propsheetpage.md) .</span><span class="sxs-lookup"><span data-stu-id="745fb-222">The following example defines an interior Wizard97 page by assigning values to a [**PROPSHEETPAGE**](pss-propsheetpage.md) structure.</span></span> <span data-ttu-id="745fb-223">En este ejemplo, el título, el subtítulo y la plantilla de cuadro de diálogo de la página se identifican por sus identificadores de recurso.</span><span class="sxs-lookup"><span data-stu-id="745fb-223">In this example, the page's title, subtitle, and dialog box template are all identified by their resource IDs.</span></span> <span data-ttu-id="745fb-224">A continuación, se llama a la función [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) para crear el identificador HPROPSHEETPAGE de la página.</span><span class="sxs-lookup"><span data-stu-id="745fb-224">The [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) function is then called to create the page's HPROPSHEETPAGE handle.</span></span> <span data-ttu-id="745fb-225">Dado que será la segunda página que aparece, el identificador se asigna a la matriz de identificadores, *ahpsp*, con un índice de 1.</span><span class="sxs-lookup"><span data-stu-id="745fb-225">Because it will be the second page to appear, the handle is assigned to the array of handles, *ahpsp*, with an index of 1.</span></span>


```C++
// g_hInstance is the global HINSTANCE of the application.
// IntPage1DlgProc is the dialog procedure for this page.
// ahpsp is an array of HPROPSHEETPAGE handles.

PROPSHEETPAGE psp = { sizeof(psp) };

psp.hInstance         = g_hInstance;
psp.dwFlags           = PSP_USEHEADERTITLE | PSP_USEHEADERSUBTITLE;
psp.lParam            = (LPARAM) &wizdata;
psp.pszHeaderTitle    = MAKEINTRESOURCE(IDS_TITLE1);
psp.pszHeaderSubTitle = MAKEINTRESOURCE(IDS_SUBTITLE1);
psp.pszTemplate       = MAKEINTRESOURCE(IDD_INTERIOR1);
psp.pfnDlgProc        = IntPage1DlgProc;

ahpsp[1] = CreatePropertySheetPage(&psp);
```



### <a name="custom-page-data"></a><span data-ttu-id="745fb-226">Datos de página personalizados</span><span class="sxs-lookup"><span data-stu-id="745fb-226">Custom Page Data</span></span>

<span data-ttu-id="745fb-227">Cuando se crea una página, se pueden asignar datos personalizados a ella mediante el miembro **lParam** de la estructura [**PROPSHEETPAGE**](pss-propsheetpage.md) , normalmente mediante la asignación de un puntero a una estructura definida por el usuario.</span><span class="sxs-lookup"><span data-stu-id="745fb-227">When you create a page, you can assign custom data to it by using the **lParam** member of the [**PROPSHEETPAGE**](pss-propsheetpage.md) structure, typically by assigning it a pointer to a user-defined structure.</span></span>

<span data-ttu-id="745fb-228">Cuando se selecciona la página por primera vez, el procedimiento del cuadro de diálogo recibe un mensaje de [**\_ INITDIALOG de WM**](/windows/desktop/dlgbox/wm-initdialog) .</span><span class="sxs-lookup"><span data-stu-id="745fb-228">When the page is first selected, its dialog box procedure receives a [**WM\_INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) message.</span></span> <span data-ttu-id="745fb-229">El valor *lParam* del mensaje apunta a una copia de de la estructura [**PROPSHEETPAGE**](pss-propsheetpage.md) de la página, desde la que puede recuperar los datos personalizados.</span><span class="sxs-lookup"><span data-stu-id="745fb-229">The message's *lParam* value points to a copy of of the page's [**PROPSHEETPAGE**](pss-propsheetpage.md) structure, from which you can retrieve the custom data.</span></span> <span data-ttu-id="745fb-230">Después, puede almacenar estos datos para su uso en mensajes posteriores mediante [**SetWindowLongPtr**](/windows/desktop/api/winuser/nf-winuser-setwindowlongptra) con GWL \_ USERDATA como parámetro de índice.</span><span class="sxs-lookup"><span data-stu-id="745fb-230">You can then store this data for use in subsequent messages by using [**SetWindowLongPtr**](/windows/desktop/api/winuser/nf-winuser-setwindowlongptra) with GWL\_USERDATA as the index parameter.</span></span> <span data-ttu-id="745fb-231">Varias páginas pueden tener un puntero a los mismos datos y cualquier cambio realizado en los datos de una página está disponible para las demás páginas de sus procedimientos de diálogo.</span><span class="sxs-lookup"><span data-stu-id="745fb-231">Multiple pages can have a pointer to the same data, and any change to the data made by one page is available to the other pages in their dialog procedures.</span></span>

### <a name="define-the-wizard-property-sheet"></a><span data-ttu-id="745fb-232">Definir la hoja de propiedades del asistente</span><span class="sxs-lookup"><span data-stu-id="745fb-232">Define the Wizard Property Sheet</span></span>

<span data-ttu-id="745fb-233">Al igual que con las hojas de propiedades normales, la hoja de propiedades del asistente se define rellenando los miembros de una estructura [**PROPSHEETHEADER**](pss-propsheetheader.md) .</span><span class="sxs-lookup"><span data-stu-id="745fb-233">As with ordinary property sheets, you define the wizard's property sheet by filling in members of a [**PROPSHEETHEADER**](pss-propsheetheader.md) structure.</span></span> <span data-ttu-id="745fb-234">Esta estructura le permite especificar las páginas que componen el asistente y el orden predeterminado en el que se muestran, junto con varios parámetros relacionados.</span><span class="sxs-lookup"><span data-stu-id="745fb-234">This structure allows you to specify the pages that make up the wizard and the default order in which they are displayed, along with several related parameters.</span></span> <span data-ttu-id="745fb-235">A continuación, inicie el asistente mediante una llamada a la función [**hoja**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) .</span><span class="sxs-lookup"><span data-stu-id="745fb-235">You then launch the wizard by calling the [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) function.</span></span>

<span data-ttu-id="745fb-236">En el estilo Wizard97, se omite el miembro **pszCaption** de la estructura [**PROPSHEETHEADER**](pss-propsheetheader.md) .</span><span class="sxs-lookup"><span data-stu-id="745fb-236">In the Wizard97 style, the **pszCaption** member of the [**PROPSHEETHEADER**](pss-propsheetheader.md) structure is ignored.</span></span> <span data-ttu-id="745fb-237">En su lugar, el asistente muestra el título que se especifica en la plantilla de cuadro de diálogo de la página actual.</span><span class="sxs-lookup"><span data-stu-id="745fb-237">Instead, the wizard displays the caption that is specified in the current page's dialog box template.</span></span> <span data-ttu-id="745fb-238">Si la plantilla no tiene un título, se muestra el título de la página anterior.</span><span class="sxs-lookup"><span data-stu-id="745fb-238">If the template lacks a caption, the caption from the previous page is displayed.</span></span> <span data-ttu-id="745fb-239">Por lo tanto, para mostrar el mismo título en todas las páginas, especifique el título en la plantilla para la página de introducción.</span><span class="sxs-lookup"><span data-stu-id="745fb-239">Thus, to display the same caption on all pages, specify the caption in the template for the introductory page.</span></span>

<span data-ttu-id="745fb-240">En el estilo del asistente de Aero, el título del cuadro de diálogo se toma de **pszCaption**.</span><span class="sxs-lookup"><span data-stu-id="745fb-240">In the Aero Wizard style, the dialog box caption is taken from **pszCaption**.</span></span>

<span data-ttu-id="745fb-241">Si ha creado una matriz de identificadores HPROPSHEETPAGE para las páginas, asigne la matriz al miembro **phpage** .</span><span class="sxs-lookup"><span data-stu-id="745fb-241">If you have created an array of HPROPSHEETPAGE handles for your pages, assign the array to the **phpage** member.</span></span> <span data-ttu-id="745fb-242">Si en su lugar ha creado una matriz de estructuras [**PROPSHEETPAGE**](pss-propsheetpage.md) , asigne la matriz al miembro **ppsp** y establezca la marca PSH \_ PROPSHEETPAGE en el miembro **dwFlags** .</span><span class="sxs-lookup"><span data-stu-id="745fb-242">If you have instead created an array of [**PROPSHEETPAGE**](pss-propsheetpage.md) structures, assign the array to the **ppsp** member and set the PSH\_PROPSHEETPAGE flag in the **dwFlags** member.</span></span>

<span data-ttu-id="745fb-243">En el ejemplo siguiente se asignan valores a *PSH*, una estructura [**PROPSHEETHEADER**](pss-propsheetheader.md) y se llama a la función [**hoja**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) para iniciar el asistente.</span><span class="sxs-lookup"><span data-stu-id="745fb-243">The following example assigns values to *psh*, a [**PROPSHEETHEADER**](pss-propsheetheader.md) structure, and calls the [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) function to launch the wizard.</span></span> <span data-ttu-id="745fb-244">El Asistente para Wizard97 tiene marcas de agua y gráficos de encabezado, especificados por sus identificadores de recursos.</span><span class="sxs-lookup"><span data-stu-id="745fb-244">The Wizard97-style wizard has both watermark and header graphics, specified by their resource IDs.</span></span> <span data-ttu-id="745fb-245">La matriz *ahpsp* contiene todos los identificadores de HPROPSHEETPAGE y define el orden predeterminado en el que se muestran.</span><span class="sxs-lookup"><span data-stu-id="745fb-245">The *ahpsp* array contains all the HPROPSHEETPAGE handles and defines the default order in which they are displayed.</span></span>


```C++
// g_hInstance is the global HINSTANCE of the application.
// ahpsp is an array of HPROPSHEETPAGE handles.

PROPSHEETHEADER psh = { sizeof(psh) };

psh.hInstance      = g_hInstance;
psh.hwndParent     = NULL;
psh.phpage         = ahpsp;
psh.dwFlags        = PSH_WIZARD97 | PSH_WATERMARK | PSH_HEADER;
psh.pszbmWatermark = MAKEINTRESOURCE(IDB_WATERMARK);
psh.pszbmHeader    = MAKEINTRESOURCE(IDB_BANNER);
psh.nStartPage     = 0;
psh.nPages         = 4;

PropertySheet(&psh);
```



### <a name="the-dialog-box-procedure"></a><span data-ttu-id="745fb-246">El procedimiento de cuadro de diálogo</span><span class="sxs-lookup"><span data-stu-id="745fb-246">The Dialog Box Procedure</span></span>

<span data-ttu-id="745fb-247">Cada página del asistente necesita un procedimiento de cuadro de diálogo para procesar los mensajes de Windows, especialmente las notificaciones de sus controles y del asistente.</span><span class="sxs-lookup"><span data-stu-id="745fb-247">Each page of the wizard needs a dialog box procedure to process Windows messages, particularly notifications from its controls and the wizard.</span></span> <span data-ttu-id="745fb-248">Los tres mensajes que casi todos los asistentes deben ser capaces de controlar son [**WM \_ INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog), [**WM \_ Destroy**](/windows/desktop/winmsg/wm-destroy)y [**WM \_ Notify**](wm-notify.md).</span><span class="sxs-lookup"><span data-stu-id="745fb-248">The three messages that almost all wizards must be able to handle are [**WM\_INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog), [**WM\_DESTROY**](/windows/desktop/winmsg/wm-destroy), and [**WM\_NOTIFY**](wm-notify.md).</span></span>

<span data-ttu-id="745fb-249">El mensaje de [**\_ notificación de WM**](wm-notify.md) se recibe antes de que se muestre la página y cuando se hace clic en cualquiera de los botones del asistente.</span><span class="sxs-lookup"><span data-stu-id="745fb-249">The [**WM\_NOTIFY**](wm-notify.md) message is received before the page is displayed and when any of the wizard's buttons are clicked.</span></span> <span data-ttu-id="745fb-250">El parámetro *lParam* del mensaje es un puntero a una estructura de encabezado [**NMHDR**](/windows/desktop/api/richedit/ns-richedit-nmhdr) .</span><span class="sxs-lookup"><span data-stu-id="745fb-250">The *lParam* parameter of the message is a pointer to a [**NMHDR**](/windows/desktop/api/richedit/ns-richedit-nmhdr) header structure.</span></span> <span data-ttu-id="745fb-251">El identificador de la notificación se encuentra en el miembro de **código** de la estructura.</span><span class="sxs-lookup"><span data-stu-id="745fb-251">The notification's ID is contained in the structure's **code** member.</span></span> <span data-ttu-id="745fb-252">Las cuatro notificaciones que la mayoría de los asistentes deben controlar son las siguientes.</span><span class="sxs-lookup"><span data-stu-id="745fb-252">The four notifications that most wizards need to handle are the following.</span></span>



| <span data-ttu-id="745fb-253">Código</span><span class="sxs-lookup"><span data-stu-id="745fb-253">Code</span></span>                                | <span data-ttu-id="745fb-254">Descripción</span><span class="sxs-lookup"><span data-stu-id="745fb-254">Description</span></span>                                 |
|-------------------------------------|---------------------------------------------|
| [<span data-ttu-id="745fb-255">PSN \_ SETACTIVE</span><span class="sxs-lookup"><span data-stu-id="745fb-255">PSN\_SETACTIVE</span></span>](psn-setactive.md) | <span data-ttu-id="745fb-256">Se envía antes de que se muestre la página.</span><span class="sxs-lookup"><span data-stu-id="745fb-256">Sent before the page is displayed.</span></span>          |
| [<span data-ttu-id="745fb-257">PSN \_ WIZBACK</span><span class="sxs-lookup"><span data-stu-id="745fb-257">PSN\_WIZBACK</span></span>](psn-wizback.md)     | <span data-ttu-id="745fb-258">Se envía cuando se hace clic en el botón **atrás** .</span><span class="sxs-lookup"><span data-stu-id="745fb-258">Sent when the **Back** button is clicked.</span></span>   |
| [<span data-ttu-id="745fb-259">PSN \_ WIZNEXT</span><span class="sxs-lookup"><span data-stu-id="745fb-259">PSN\_WIZNEXT</span></span>](psn-wiznext.md)     | <span data-ttu-id="745fb-260">Se envía cuando se hace clic en el botón **siguiente** .</span><span class="sxs-lookup"><span data-stu-id="745fb-260">Sent when the **Next** button is clicked.</span></span>   |
| [<span data-ttu-id="745fb-261">PSN \_ WIZFINISH</span><span class="sxs-lookup"><span data-stu-id="745fb-261">PSN\_WIZFINISH</span></span>](psn-wizfinish.md) | <span data-ttu-id="745fb-262">Se envía cuando se hace clic en el botón **Finalizar** .</span><span class="sxs-lookup"><span data-stu-id="745fb-262">Sent when the **Finish** button is clicked.</span></span> |



 

### <a name="handle-wm_initdialog-and-wm_destroy"></a><span data-ttu-id="745fb-263">Administrar WM \_ INITDIALOG y WM \_ Destroy</span><span class="sxs-lookup"><span data-stu-id="745fb-263">Handle WM\_INITDIALOG and WM\_DESTROY</span></span>

<span data-ttu-id="745fb-264">Cuando una página está a punto de mostrarse por primera vez, el procedimiento del cuadro de diálogo recibe un mensaje de [**\_ INITDIALOG de WM**](/windows/desktop/dlgbox/wm-initdialog) .</span><span class="sxs-lookup"><span data-stu-id="745fb-264">When a page is about to be displayed for the first time, its dialog box procedure receives a [**WM\_INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) message.</span></span> <span data-ttu-id="745fb-265">El control de este mensaje permite al asistente realizar las tareas de inicialización necesarias, como almacenar datos personalizados o establecer fuentes.</span><span class="sxs-lookup"><span data-stu-id="745fb-265">Handling this message allows the wizard to do any needed initialization tasks, such as storing custom data or setting fonts.</span></span>

<span data-ttu-id="745fb-266">Cuando se destruya la hoja de propiedades, recibirá un mensaje de [**\_ destrucción de WM**](/windows/desktop/winmsg/wm-destroy) .</span><span class="sxs-lookup"><span data-stu-id="745fb-266">When the property sheet is destroyed, you receive a [**WM\_DESTROY**](/windows/desktop/winmsg/wm-destroy) message.</span></span> <span data-ttu-id="745fb-267">El sistema destruye automáticamente el asistente, pero el control de este mensaje le permite realizar cualquier limpieza necesaria.</span><span class="sxs-lookup"><span data-stu-id="745fb-267">The wizard is automatically destroyed by the system, but handling this message allows you to do any needed cleanup.</span></span>

### <a name="handle-psn_setactive"></a><span data-ttu-id="745fb-268">Controlar PSN \_ SETACTIVE</span><span class="sxs-lookup"><span data-stu-id="745fb-268">Handle PSN\_SETACTIVE</span></span>

<span data-ttu-id="745fb-269">El código de notificación [PSN \_ SETACTIVE](psn-setactive.md) se envía cada vez que una página está a punto de ser visible.</span><span class="sxs-lookup"><span data-stu-id="745fb-269">The [PSN\_SETACTIVE](psn-setactive.md) notification code is sent each time a page is about to be made visible.</span></span> <span data-ttu-id="745fb-270">La primera vez que se visita una página, PSN \_ SETACTIVE sigue el mensaje de [**\_ INITDIALOG de WM**](/windows/desktop/dlgbox/wm-initdialog) .</span><span class="sxs-lookup"><span data-stu-id="745fb-270">The first time a page is visited, PSN\_SETACTIVE follows the [**WM\_INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) message.</span></span> <span data-ttu-id="745fb-271">Si posteriormente se vuelve a visitar la página, recibirá una notificación de PSN \_ SETACTIVE.</span><span class="sxs-lookup"><span data-stu-id="745fb-271">If the page is subsequently revisited, it receives only a PSN\_SETACTIVE notification.</span></span> <span data-ttu-id="745fb-272">Normalmente, esta notificación se controla para inicializar los datos de la página y habilitar los botones adecuados.</span><span class="sxs-lookup"><span data-stu-id="745fb-272">This notification is usually handled to initialize data for the page and enable the appropriate buttons.</span></span>

<span data-ttu-id="745fb-273">De forma predeterminada, el asistente muestra los botones **atrás**, **siguiente** y **Cancelar** , con todos los botones habilitados.</span><span class="sxs-lookup"><span data-stu-id="745fb-273">By default, the wizard displays **Back**, **Next**, and **Cancel** buttons, with all buttons enabled.</span></span> <span data-ttu-id="745fb-274">Para deshabilitar un botón o mostrar **Finalizar** en lugar de **siguiente**, debe enviar un mensaje de [**PSM \_ SETWIZBUTTONS**](psm-setwizbuttons.md) .</span><span class="sxs-lookup"><span data-stu-id="745fb-274">To disable a button or display **Finish** instead of **Next**, you must send a [**PSM\_SETWIZBUTTONS**](psm-setwizbuttons.md) message.</span></span> <span data-ttu-id="745fb-275">Después de enviar este mensaje, el estado de los botones se conserva hasta que otro mensaje de **PSM \_ SETWIZBUTTONS** lo modifique, incluso si se selecciona una nueva página.</span><span class="sxs-lookup"><span data-stu-id="745fb-275">After this message has been sent, the state of the buttons is preserved until it is modified by another **PSM\_SETWIZBUTTONS** message, even if a new page is selected.</span></span> <span data-ttu-id="745fb-276">Normalmente, todos los controladores de [ \_ SETACTIVE de PSN](psn-setactive.md) envían este mensaje para asegurarse de que cada página tiene el estado de botón correcto.</span><span class="sxs-lookup"><span data-stu-id="745fb-276">Typically, all [PSN\_SETACTIVE](psn-setactive.md) handlers send this message to ensure that each page has the correct button state.</span></span>

<span data-ttu-id="745fb-277">Puede cambiar el estado del botón con este mensaje en cualquier momento.</span><span class="sxs-lookup"><span data-stu-id="745fb-277">You can change the button state with this message at any time.</span></span> <span data-ttu-id="745fb-278">Por ejemplo, puede que desee que el botón **siguiente** esté deshabilitado inicialmente.</span><span class="sxs-lookup"><span data-stu-id="745fb-278">For example, you may want the **Next** button to be initially disabled.</span></span> <span data-ttu-id="745fb-279">Una vez que un usuario ha especificado toda la información necesaria, puede enviar otro mensaje de [**PSM \_ SETWIZBUTTONS**](psm-setwizbuttons.md) para habilitar el botón **siguiente** y permitir que el usuario pase a la página siguiente.</span><span class="sxs-lookup"><span data-stu-id="745fb-279">After a user has entered all the necessary information, you can send another [**PSM\_SETWIZBUTTONS**](psm-setwizbuttons.md) message to enable the **Next** button and let the user proceed to the next page.</span></span>

<span data-ttu-id="745fb-280">En el fragmento de código siguiente se usa la macro [**PropSheet \_ SetWizButtons**](/windows/desktop/api/Prsht/nf-prsht-propsheet_setwizbuttons) para habilitar los botones **atrás** y **siguiente** en una página interior antes de que se muestre.</span><span class="sxs-lookup"><span data-stu-id="745fb-280">The following code fragment uses the [**PropSheet\_SetWizButtons**](/windows/desktop/api/Prsht/nf-prsht-propsheet_setwizbuttons) macro to enable the **Back** and **Next** buttons on an interior page before it is displayed.</span></span>


```C++
case WM_NOTIFY :
    {
        LPNMHDR pnmh = (LPNMHDR)lParam;
        
        switch(pnmh->code)
        {
        
        ...
        
        case PSN_SETACTIVE :
        
            ...
            
            // This is an interior page.
            PropSheet_SetWizButtons(hwnd, PSWIZB_NEXT | PSWIZB_BACK);
            
            ...
        }
    ...
    
    }
```



### <a name="handle-psn_wiznext-psnwizback-and-psn_wizfinish"></a><span data-ttu-id="745fb-281">Administrar PSN \_ WIZNEXT, PSNWIZBACK y PSN \_ WIZFINISH</span><span class="sxs-lookup"><span data-stu-id="745fb-281">Handle PSN\_WIZNEXT, PSNWIZBACK, and PSN\_WIZFINISH</span></span>

<span data-ttu-id="745fb-282">Cuando se haga clic en un botón **siguiente** o **atrás** , recibirá un código de notificación [PSN \_ WIZNEXT](psn-wiznext.md) o [PSN \_ WIZBACK](psn-wizback.md) .</span><span class="sxs-lookup"><span data-stu-id="745fb-282">When a **Next** or **Back** button is clicked, you receive a [PSN\_WIZNEXT](psn-wiznext.md) or [PSN\_WIZBACK](psn-wizback.md) notification code.</span></span> <span data-ttu-id="745fb-283">De forma predeterminada, el asistente pasa automáticamente a la página siguiente o anterior en el orden definido al crear la hoja de propiedades.</span><span class="sxs-lookup"><span data-stu-id="745fb-283">By default, the wizard automatically goes to either the next or previous page in the order that is defined when the property sheet is created.</span></span> <span data-ttu-id="745fb-284">Una razón habitual para controlar estas notificaciones es evitar que el usuario cambie las páginas o invalide el orden de página predeterminado.</span><span class="sxs-lookup"><span data-stu-id="745fb-284">A common reason to handle these notifications is to prevent the user from switching pages, or to override the default page order.</span></span>

<span data-ttu-id="745fb-285">Para evitar que el usuario cambie de página, controle la notificación del botón, llame a la función [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) con el valor de DWL \_ MSGRESULT establecido en – 1 y devuelva **true**.</span><span class="sxs-lookup"><span data-stu-id="745fb-285">To prevent the user from switching pages, handle the button notification, call the [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) function with the DWL\_MSGRESULT value set to –1, and return **TRUE**.</span></span> <span data-ttu-id="745fb-286">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="745fb-286">For example:</span></span>


```C++
case PSN_WIZNEXT :

        ...
        
        // Do not go to the next page yet.
        SetWindowLong(hwnd, DWL_MSGRESULT, -1);
        
        return TRUE;
        
        ...
```



<span data-ttu-id="745fb-287">Para invalidar el orden estándar e ir a una página determinada, llame a [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) con el valor de DWL \_ MSGRESULT establecido en el identificador de recurso del cuadro de diálogo de la página y devuelva **true**.</span><span class="sxs-lookup"><span data-stu-id="745fb-287">To override the standard order and go to a particular page, call [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) with the DWL\_MSGRESULT value set to the page's dialog box resource ID, and return **TRUE**.</span></span> <span data-ttu-id="745fb-288">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="745fb-288">For example:</span></span>


```C++
case PSN_WIZNEXT :

        ...
        
        // Go straight to the completion page.
        SetWindowLong(hwnd, DWL_MSGRESULT, IDD_FINISH);
        
        return TRUE;
        
        ...
```



<span data-ttu-id="745fb-289">Cuando se haga clic en el botón **Finalizar** o **Cancelar** , recibirá un código de notificación [PSN \_ WIZFINISH](psn-wizfinish.md) o [PSN \_ RESET](psn-reset.md) , respectivamente.</span><span class="sxs-lookup"><span data-stu-id="745fb-289">When the **Finish** or **Cancel** button is clicked, you receive a [PSN\_WIZFINISH](psn-wizfinish.md) or [PSN\_RESET](psn-reset.md) notification code, respectively.</span></span> <span data-ttu-id="745fb-290">Cuando se hace clic en cualquiera de estos botones, el sistema lo destruye automáticamente.</span><span class="sxs-lookup"><span data-stu-id="745fb-290">When either of these buttons is clicked, the wizard is automatically destroyed by the system.</span></span> <span data-ttu-id="745fb-291">Sin embargo, puede controlar estas notificaciones si necesita realizar tareas de limpieza antes de que se destruya el asistente.</span><span class="sxs-lookup"><span data-stu-id="745fb-291">However, you can handle these notifications if you need to perform cleanup tasks before the wizard is destroyed.</span></span> <span data-ttu-id="745fb-292">Para evitar que el asistente se destruya cuando reciba una notificación de \_ WIZFINISH de PSN, llame a [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) con el valor de DWL \_ MSGRESULT establecido en **true** y devuelva **true**.</span><span class="sxs-lookup"><span data-stu-id="745fb-292">To prevent the wizard from being destroyed when you receive a PSN\_WIZFINISH notification, call [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) with the DWL\_MSGRESULT value set to **TRUE**, and return **TRUE**.</span></span> <span data-ttu-id="745fb-293">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="745fb-293">For example:</span></span>


```C++
case PSN_WIZFINISH :

        ...
        
        // Not finished yet.
        SetWindowLong(hwnd, DWL_MSGRESULT, TRUE);
        
        return TRUE;
        
        ...
```



### <a name="backward-compatible-wizards"></a><span data-ttu-id="745fb-294">Asistentes compatibles con versiones anteriores</span><span class="sxs-lookup"><span data-stu-id="745fb-294">Backward Compatible Wizards</span></span>

<span data-ttu-id="745fb-295">En la sección anterior se supone que está implementando un asistente para un sistema con la [versión 5](common-control-versions.md) o posterior de los controles comunes.</span><span class="sxs-lookup"><span data-stu-id="745fb-295">The preceding section assumes that you are implementing a wizard for a system with [version 5](common-control-versions.md) or later of the common controls.</span></span>

<span data-ttu-id="745fb-296">Si está escribiendo un asistente para sistemas con versiones anteriores de los controles comunes, muchas de las características descritas en la sección anterior no estarán disponibles.</span><span class="sxs-lookup"><span data-stu-id="745fb-296">If you are writing a wizard for systems with earlier versions of the common controls, many of the features discussed in the preceding section will not be available.</span></span> <span data-ttu-id="745fb-297">Varios de los miembros de las estructuras [**PROPSHEETHEADER**](pss-propsheetheader.md) y [**PROPSHEETPAGE**](pss-propsheetpage.md) que usa el estilo Wizard97 solo se admiten en los controles comunes versión 5 y posteriores.</span><span class="sxs-lookup"><span data-stu-id="745fb-297">A number of the members of the [**PROPSHEETHEADER**](pss-propsheetheader.md) and [**PROPSHEETPAGE**](pss-propsheetpage.md) structures that are used by the Wizard97 style are supported only by common controls version 5 and later.</span></span> <span data-ttu-id="745fb-298">Sin embargo, sigue siendo posible implementar un asistente *compatible con versiones anteriores* con una apariencia similar a la del estilo Wizard97.</span><span class="sxs-lookup"><span data-stu-id="745fb-298">However, it is still possible to implement a *backward compatible* wizard with an appearance similar to that of the Wizard97 style.</span></span> <span data-ttu-id="745fb-299">Para ello, debe implementar explícitamente lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="745fb-299">To do so, you must explicitly implement the following:</span></span>

-   <span data-ttu-id="745fb-300">Agregue el gráfico de marca de agua a la plantilla de cuadro de diálogo para las páginas introducción y finalización.</span><span class="sxs-lookup"><span data-stu-id="745fb-300">Add the watermark graphic to the dialog box template for your introduction and completion pages.</span></span>
-   <span data-ttu-id="745fb-301">Haga que todas las plantillas tengan el mismo tamaño.</span><span class="sxs-lookup"><span data-stu-id="745fb-301">Make all your templates the same size.</span></span> <span data-ttu-id="745fb-302">No hay ningún área de encabezado definida por el sistema independiente para las páginas interiores.</span><span class="sxs-lookup"><span data-stu-id="745fb-302">There is no separate system-defined header area for interior pages.</span></span>
-   <span data-ttu-id="745fb-303">Cree el área del encabezado de la página interior explícitamente en las plantillas.</span><span class="sxs-lookup"><span data-stu-id="745fb-303">Create the interior page's header area explicitly on your templates.</span></span>
-   <span data-ttu-id="745fb-304">No use un gráfico de encabezado porque puede entrar en conflicto con el título o el subtítulo si cambia el tamaño del asistente.</span><span class="sxs-lookup"><span data-stu-id="745fb-304">Do not use a header graphic because it may conflict with the title or subtitle if the wizard changes size.</span></span>

<span data-ttu-id="745fb-305">Para obtener más información sobre los asistentes compatibles con versiones anteriores, consulte Asistente para la compatibilidad con [versiones anteriores 97](/previous-versions//ms737910(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="745fb-305">For further discussion of backward-compatible wizards, see [Backward Compatible Wizard 97](/previous-versions//ms737910(v=vs.85)).</span></span>

## <a name="remarks"></a><span data-ttu-id="745fb-306">Observaciones</span><span class="sxs-lookup"><span data-stu-id="745fb-306">Remarks</span></span>

<span data-ttu-id="745fb-307">Para obtener una descripción completa de los problemas de diseño de Wizard97, vea la [especificación de Wizard97](/previous-versions//ms738248(v=vs.85)), en otra parte de la Windows SDK.</span><span class="sxs-lookup"><span data-stu-id="745fb-307">For a complete discussion of design issues for Wizard97, see the [Wizard97 Specification](/previous-versions//ms738248(v=vs.85)), elsewhere in the Windows SDK.</span></span> <span data-ttu-id="745fb-308">En este documento se proporcionan instrucciones para las dimensiones de los cuadros de diálogo, las dimensiones y los colores de los mapas de bits y la colocación de los controles.</span><span class="sxs-lookup"><span data-stu-id="745fb-308">This document has guidelines for such things as the dimensions for the dialog boxes, bitmap dimensions and colors, and the placement of controls.</span></span>

## <a name="related-topics"></a><span data-ttu-id="745fb-309">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="745fb-309">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="745fb-310">Usar hojas de propiedades</span><span class="sxs-lookup"><span data-stu-id="745fb-310">Using Property Sheets</span></span>](using-property-sheets.md)
</dt> <dt>

<span data-ttu-id="745fb-311">[Demostración de controles comunes de Windows (CppWindowsCommonControls)](https://github.com/microsoftarchive/msdn-code-gallery-microsoft/tree/master/OneCodeTeam/Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/%5BC++%5D-Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/C++/CppWindowsCommonControls)</span><span class="sxs-lookup"><span data-stu-id="745fb-311">[Windows common controls demo (CppWindowsCommonControls)](https://github.com/microsoftarchive/msdn-code-gallery-microsoft/tree/master/OneCodeTeam/Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/%5BC++%5D-Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/C++/CppWindowsCommonControls)</span></span>
</dt> </dl>

 

 