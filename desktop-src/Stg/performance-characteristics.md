---
title: Características de rendimiento
description: Una llamada a la implementación de archivo compuesto COM de la interfaz IPropertySetStorage para crear un conjunto de propiedades provoca la creación de una secuencia o almacenamiento a través de una llamada a IStorage CreateStream (o IStorage CreateStorage.
ms.assetid: 7773e649-19a4-4df2-84ed-027d73283140
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8597862602a367ed93a3d6e5e0bcac76035c337a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "103995405"
---
# <a name="performance-characteristics"></a><span data-ttu-id="08049-103">Características de rendimiento</span><span class="sxs-lookup"><span data-stu-id="08049-103">Performance Characteristics</span></span>

<span data-ttu-id="08049-104">Una llamada a la implementación de archivo compuesto COM de la interfaz [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) para crear un conjunto de propiedades provoca la creación de una secuencia o almacenamiento a través de una llamada a [**IStorage:: CreateStream (**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstream) o [**IStorage:: CreateStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstorage).</span><span class="sxs-lookup"><span data-stu-id="08049-104">A call to the COM compound file implementation of the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface to create a property set causes either a stream or storage to be created through a call to [**IStorage::CreateStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstream) or [**IStorage::CreateStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstorage).</span></span> <span data-ttu-id="08049-105">Un conjunto de propiedades predeterminado se crea en memoria, pero no se vacía en el disco.</span><span class="sxs-lookup"><span data-stu-id="08049-105">A default property set is created in memory, but not flushed to disk.</span></span> <span data-ttu-id="08049-106">Cuando hay una llamada a [**IPropertyStorage:: WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple), funciona dentro del búfer.</span><span class="sxs-lookup"><span data-stu-id="08049-106">When there is a call to [**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple), it operates within the buffer.</span></span>

<span data-ttu-id="08049-107">Cuando se abre un conjunto de propiedades, se usa [IStorage:: OpenStream](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) o [IStorage:: OpenStorage](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) .</span><span class="sxs-lookup"><span data-stu-id="08049-107">When a property set is opened, [IStorage::OpenStream](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) or [IStorage::OpenStorage](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) is used.</span></span> <span data-ttu-id="08049-108">La secuencia del conjunto de propiedades completo se lee en la memoria contigua.</span><span class="sxs-lookup"><span data-stu-id="08049-108">The entire property set stream is read into contiguous memory.</span></span> <span data-ttu-id="08049-109">A continuación, las operaciones [**IPropertyStorage:: ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) funcionan mediante la lectura del búfer de memoria.</span><span class="sxs-lookup"><span data-stu-id="08049-109">[**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) operations then operate by reading the memory buffer.</span></span> <span data-ttu-id="08049-110">Por lo tanto, el primer acceso es costoso en términos de tiempo (debido a las lecturas del disco), pero los accesos posteriores son muy eficaces.</span><span class="sxs-lookup"><span data-stu-id="08049-110">Therefore, the first access is expensive in terms of time (because of disk reads) but subsequent accesses are very efficient.</span></span> <span data-ttu-id="08049-111">Las escrituras pueden ser ligeramente más costosas porque es posible que sea necesario realizar operaciones en la secuencia subyacente para garantizar que el espacio en disco está disponible si se agregan datos.</span><span class="sxs-lookup"><span data-stu-id="08049-111">Writes may be slightly more expensive because SetSize operations on the underlying stream may be required to guarantee that disk space is available if data is added.</span></span>

<span data-ttu-id="08049-112">No se garantiza que [**IPropertyStorage:: WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) Vacíe las actualizaciones.</span><span class="sxs-lookup"><span data-stu-id="08049-112">No guarantees are made as to whether [**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) will flush updates.</span></span> <span data-ttu-id="08049-113">En general, el cliente debe suponer que **IPropertyStorage:: WriteMultiple** solo actualiza el búfer de memoria.</span><span class="sxs-lookup"><span data-stu-id="08049-113">In general, the client should assume that **IPropertyStorage::WriteMultiple** only updates the in memory buffer.</span></span> <span data-ttu-id="08049-114">Para vaciar los datos, se debe llamar a [**IPropertyStorage:: commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) o [**IUnknown:: Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) (última versión).</span><span class="sxs-lookup"><span data-stu-id="08049-114">To flush data, [**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) or [**IUnknown::Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) (last release) should be called.</span></span>

<span data-ttu-id="08049-115">Este diseño significa que [**WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) puede realizarse correctamente, pero los datos no se escriben realmente de forma persistente.</span><span class="sxs-lookup"><span data-stu-id="08049-115">This design means that [**WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) may succeed but the data is not actually persistently written.</span></span>

> [!Note]  
> <span data-ttu-id="08049-116">Este tamaño de la secuencia del conjunto de propiedades no puede superar los 256 k bytes.</span><span class="sxs-lookup"><span data-stu-id="08049-116">This size of the property set stream cannot exceed 256K bytes.</span></span>

 

 

 