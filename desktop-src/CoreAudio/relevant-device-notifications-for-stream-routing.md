---
description: Obtenga información sobre las notificaciones para el enrutamiento de flujos. Las API implementan el enrutamiento de flujos controlando el cambio de secuencia a un nuevo punto de conexión de audio predeterminado.
ms.assetid: caf831bb-b8de-467f-bdb4-f9f8991dc7a8
title: Notificaciones pertinentes para el enrutamiento de flujos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d1a843c1d8b5cfd740ada5049cb9428e7745072d
ms.sourcegitcommit: 51ef825fb48f15e1aa30e8795988f10dc2b2155c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/14/2021
ms.locfileid: "112068531"
---
# <a name="relevant-notifications-for-stream-routing"></a><span data-ttu-id="2690e-104">Notificaciones pertinentes para el enrutamiento de flujos</span><span class="sxs-lookup"><span data-stu-id="2690e-104">Relevant Notifications for Stream Routing</span></span>

<span data-ttu-id="2690e-105">En Windows 7, las API de plataforma de alto nivel que usan las API core audio, como las API de Media Foundation, Direct Sound y Wave, implementan la característica de enrutamiento de secuencias mediante el control de la conmutación de secuencias de un dispositivo existente a un nuevo punto de conexión de audio predeterminado.</span><span class="sxs-lookup"><span data-stu-id="2690e-105">In Windows 7, high-level platform APIs that use Core Audio APIs, such as Media Foundation, DirectSound, and Wave APIs, implement the stream routing feature by handling stream switching from an existing device to a new default audio endpoint.</span></span> <span data-ttu-id="2690e-106">Las aplicaciones multimedia que usan estas API usan el comportamiento de enrutamiento de flujos sin modificaciones en el origen.</span><span class="sxs-lookup"><span data-stu-id="2690e-106">Media applications that use these APIs use the stream routing behavior without any modifications to the source.</span></span> <span data-ttu-id="2690e-107">Los clientes WASAPI directos pueden usar las notificaciones enviadas por los componentes de Core Audio e implementar la característica de enrutamiento de secuencias.</span><span class="sxs-lookup"><span data-stu-id="2690e-107">Direct WASAPI clients can use the notifications sent by Core Audio components and implement the stream routing feature.</span></span>

<span data-ttu-id="2690e-108">Para implementar la característica de enrutamiento de flujos, un cliente debe escuchar dos tipos de eventos: notificaciones de cambio de dispositivo y notificaciones de desconexión de sesión.</span><span class="sxs-lookup"><span data-stu-id="2690e-108">To implement the stream routing feature, a client must listen for two types of events: device change notifications and session disconnect notifications.</span></span> <span data-ttu-id="2690e-109">En la implementación proporcionada por las API de alto nivel, estos eventos se envían para los puntos de conexión de dispositivo predeterminados creados mediante una llamada a [**IMMDeviceEnumerator::GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint).</span><span class="sxs-lookup"><span data-stu-id="2690e-109">In the implementation provided by the high-level APIs, these events are sent for default device endpoints created by calling [**IMMDeviceEnumerator::GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint).</span></span> <span data-ttu-id="2690e-110">Para obtener más información, consulte [Getting the Device Endpoint for Stream Routing](getting-the-default-device-endpoint-for-stream-routing.md).</span><span class="sxs-lookup"><span data-stu-id="2690e-110">For more information, see [Getting the Device Endpoint for Stream Routing](getting-the-default-device-endpoint-for-stream-routing.md).</span></span>

<span data-ttu-id="2690e-111">El componente de audio principal MMDeviceAPI entrega devoluciones de llamada de notificación cuando se agregan, quitan o modifican dispositivos de audio.</span><span class="sxs-lookup"><span data-stu-id="2690e-111">The Core Audio component MMDeviceAPI delivers notification callbacks when audio devices are added, removed, or modified.</span></span> <span data-ttu-id="2690e-112">Los cambios de formato y de sesión de audio se notifican como eventos a través de WASAPI.</span><span class="sxs-lookup"><span data-stu-id="2690e-112">The format and audio session changes are reported as events through WASAPI.</span></span>

## <a name="device-change-notifications"></a><span data-ttu-id="2690e-113">Notificaciones de cambio de dispositivo</span><span class="sxs-lookup"><span data-stu-id="2690e-113">Device Change Notifications</span></span>

<span data-ttu-id="2690e-114">MMDeviceAPI genera eventos cuando se agregan, quitan o modifican dispositivos de audio.</span><span class="sxs-lookup"><span data-stu-id="2690e-114">MMDeviceAPI raises events when audio devices are added, removed, or modified.</span></span> <span data-ttu-id="2690e-115">Si el cliente va a proporcionar la funcionalidad de enrutamiento de flujos, debe implementar la interfaz [**IMMNotificationClient**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) y registrar su implementación con MMDeviceAPI.</span><span class="sxs-lookup"><span data-stu-id="2690e-115">If the client is to provide stream routing functionality, it must implement the [**IMMNotificationClient**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) interface and register its implementation with MMDeviceAPI.</span></span>

<span data-ttu-id="2690e-116">Para obtener notificaciones de cambio de dispositivo, el cliente debe realizar las siguientes tareas:</span><span class="sxs-lookup"><span data-stu-id="2690e-116">To get device change notifications, the client must perform the following tasks:</span></span>

-   <span data-ttu-id="2690e-117">Implemente [**la interfaz IMMNotificationClient para**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) controlar las notificaciones de cambio de dispositivo enviadas por MMDeviceAPI.</span><span class="sxs-lookup"><span data-stu-id="2690e-117">Implement the [**IMMNotificationClient**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) interface to handle device change notifications sent by MMDeviceAPI.</span></span>
-   <span data-ttu-id="2690e-118">Registre la [**implementación de IMMNotificationClient**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) con MMDeviceAPI mediante una llamada al [**método IMMDeviceEnumerator::RegisterEndpointNotificationCallback.**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-registerendpointnotificationcallback)</span><span class="sxs-lookup"><span data-stu-id="2690e-118">Register the [**IMMNotificationClient**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) implementation with MMDeviceAPI by calling the [**IMMDeviceEnumerator::RegisterEndpointNotificationCallback**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-registerendpointnotificationcallback) method.</span></span>

<span data-ttu-id="2690e-119">Una vez registrada la implementación del cliente de estas interfaces, el cliente recibe notificaciones en forma de devoluciones de llamada a través de los métodos de estas interfaces.</span><span class="sxs-lookup"><span data-stu-id="2690e-119">After the client's implementation of these interfaces is registered, the client receives notifications in the form of callbacks through the methods of these interfaces.</span></span> <span data-ttu-id="2690e-120">MMDeviceAPI llama a los métodos [**IMMNotificationClient**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) cuando genera eventos de nivel de punto de conexión (cambios de estado de punto de conexión, llegadas de nuevos puntos de conexión, eliminaciones de puntos de conexión, cambios de punto de conexión predeterminados y cambios en las propiedades del punto de conexión).</span><span class="sxs-lookup"><span data-stu-id="2690e-120">[**IMMNotificationClient**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immnotificationclient) methods are called by MMDeviceAPI when it raises endpoint-level events (endpoint state changes, new endpoint arrivals, endpoint deletions, default endpoint changes, and endpoint property changes).</span></span>

<span data-ttu-id="2690e-121">Si el cliente desea proporcionar enrutamiento de secuencias para el dispositivo predeterminado, el cliente debe implementar el comportamiento de cambio del dispositivo cuando recibe la notificación a través de la devolución de llamada [**IMMNotificationClient::OnDefaultDeviceChanged.**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immnotificationclient-ondefaultdevicechanged)</span><span class="sxs-lookup"><span data-stu-id="2690e-121">If the client wants to provide stream routing for the default device, the client must implement the device change behavior when it receives the notification through the [**IMMNotificationClient::OnDefaultDeviceChanged**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immnotificationclient-ondefaultdevicechanged) callback.</span></span>

## <a name="audio-session-change-notifications"></a><span data-ttu-id="2690e-122">Notificaciones de cambio de sesión de audio</span><span class="sxs-lookup"><span data-stu-id="2690e-122">Audio Session Change Notifications</span></span>

<span data-ttu-id="2690e-123">Los cambios de sesión de audio y los cambios de formato se notifican como eventos de sesión de audio a través de WASAPI.</span><span class="sxs-lookup"><span data-stu-id="2690e-123">Audio session changes and format changes are reported as audio session events through WASAPI.</span></span> <span data-ttu-id="2690e-124">Un cliente WASAPI implementa la [**interfaz IAudioSessionEvents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) y registra la implementación con WASAPI.</span><span class="sxs-lookup"><span data-stu-id="2690e-124">A WASAPI client implements the [**IAudioSessionEvents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) interface and registers the implementation with WASAPI.</span></span>

<span data-ttu-id="2690e-125">Para obtener notificaciones de cambio de sesión de audio, el cliente debe realizar las siguientes tareas:</span><span class="sxs-lookup"><span data-stu-id="2690e-125">To get audio session change notifications, the client must perform the following tasks:</span></span>

-   <span data-ttu-id="2690e-126">Implemente la [**interfaz IAudioSessionEvents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) para controlar las notificaciones de cambio de formato enviadas por WASAPI.</span><span class="sxs-lookup"><span data-stu-id="2690e-126">Implement the [**IAudioSessionEvents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) interface to handle format change notifications sent by WASAPI.</span></span>
-   <span data-ttu-id="2690e-127">Registre la [**implementación de IAudioSessionEvents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) con WASAPI mediante una llamada al [**método IAudioSessionControl::RegisterAudioSessionNotification.**](/windows/desktop/api/Audiopolicy/nf-audiopolicy-iaudiosessioncontrol-registeraudiosessionnotification)</span><span class="sxs-lookup"><span data-stu-id="2690e-127">Register the [**IAudioSessionEvents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) implementation with WASAPI by calling the [**IAudioSessionControl::RegisterAudioSessionNotification**](/windows/desktop/api/Audiopolicy/nf-audiopolicy-iaudiosessioncontrol-registeraudiosessionnotification) method.</span></span>

<span data-ttu-id="2690e-128">[**WASAPI llama a los métodos IAudioSessionEvents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) cuando se producen cambios en la sesión de audio.</span><span class="sxs-lookup"><span data-stu-id="2690e-128">[**IAudioSessionEvents**](/windows/desktop/api/Audiopolicy/nn-audiopolicy-iaudiosessionevents) methods are called by WASAPI when audio session changes occur.</span></span> <span data-ttu-id="2690e-129">Estos eventos se genera cuando cambia el nombre para mostrar, la ruta de acceso del icono, el volumen, el parámetro de agrupación o el estado de la sesión.</span><span class="sxs-lookup"><span data-stu-id="2690e-129">These events are raised when the session's display name, icon path, volume, grouping parameter, or state changes.</span></span>

<span data-ttu-id="2690e-130">Para implementar la característica de enrutamiento de flujos, el cliente debe esperar a la notificación de desconexión de sesión.</span><span class="sxs-lookup"><span data-stu-id="2690e-130">To implement the stream routing feature, the client must wait for the session-disconnect notification.</span></span> <span data-ttu-id="2690e-131">Cuando se desconecta una sesión de audio o se cambia el formato de un dispositivo, WASAPI envía las notificaciones de cliente en forma de devoluciones de llamada a través de [**IAudioSessionEvents::OnSessionDisconnected**](/windows/desktop/api/Audiopolicy/nf-audiopolicy-iaudiosessionevents-onsessiondisconnected).</span><span class="sxs-lookup"><span data-stu-id="2690e-131">When an audio session is disconnected or a device's format is changed, WASAPI sends the client notifications in the form of callbacks through [**IAudioSessionEvents::OnSessionDisconnected**](/windows/desktop/api/Audiopolicy/nf-audiopolicy-iaudiosessionevents-onsessiondisconnected).</span></span> <span data-ttu-id="2690e-132">Con la notificación de desconexión, WASAPI también envía un valor que indica por qué se desconectó la sesión.</span><span class="sxs-lookup"><span data-stu-id="2690e-132">With the disconnection notification, WASAPI also sends a value that indicates why the session was disconnected.</span></span> <span data-ttu-id="2690e-133">Esto puede ocurrir por varios motivos, como que el dispositivo se quitó, el servidor se detuvo, y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="2690e-133">This can occur for several reasons, such as the device was removed, the server stopped, and so on.</span></span> <span data-ttu-id="2690e-134">Para obtener la lista completa de motivos, vea la **enumeración AudioSessionDisconnectReason** definida en AudioPolicy.h.</span><span class="sxs-lookup"><span data-stu-id="2690e-134">For the complete list of reasons, see the **AudioSessionDisconnectReason** enumeration defined in AudioPolicy.h.</span></span> <span data-ttu-id="2690e-135">Si cambia el dispositivo predeterminado, el cliente debe esperar las notificaciones (si aún no se han recibido) que van acompañadas de un valor **DisconnectReasonDeviceRemoval.**</span><span class="sxs-lookup"><span data-stu-id="2690e-135">If the default device changes, the client must wait for the notifications (if they have not already been received) that are accompanied with a **DisconnectReasonDeviceRemoval** value.</span></span> <span data-ttu-id="2690e-136">En respuesta a estas notificaciones, el cliente podría volver a abrir la secuencia en el nuevo dispositivo predeterminado.</span><span class="sxs-lookup"><span data-stu-id="2690e-136">In response to such notifications, the client might reopen the stream on the new default device.</span></span>

<span data-ttu-id="2690e-137">Dado que todas estas operaciones son asícrticas, no se puede predecir el orden en el que la aplicación recibe notificaciones.</span><span class="sxs-lookup"><span data-stu-id="2690e-137">Because all of these operations are asychronous, the order in which the application receives notifications cannnot be predicted.</span></span> <span data-ttu-id="2690e-138">Sin embargo, normalmente, la aplicación recibe el **valor AudioSessionDisconnect** antes de la notificación de cambio de dispositivo predeterminada.</span><span class="sxs-lookup"><span data-stu-id="2690e-138">However, typically, the application receives **AudioSessionDisconnect** value before the default device change notification.</span></span>

### <a name="format-change-notifications"></a><span data-ttu-id="2690e-139">Dar formato a las notificaciones de cambio</span><span class="sxs-lookup"><span data-stu-id="2690e-139">Format Change Notifications</span></span>

<span data-ttu-id="2690e-140">Los cambios de formato de audio se producen cuando cambia el formato de la secuencia.</span><span class="sxs-lookup"><span data-stu-id="2690e-140">Audio format changes occur when the format of the stream changes.</span></span> <span data-ttu-id="2690e-141">Esto puede ocurrir cuando el usuario selecciona un nuevo formato en el panel de **control** Sonido o el nuevo dispositivo predeterminado admite un nuevo formato (por ejemplo, HDMI o determinadas interfaces de audio profesionales con un ajuste manual de la frecuencia de muestreo).</span><span class="sxs-lookup"><span data-stu-id="2690e-141">This can occur when the user selects a new format in the **Sound** control panel or the new default device supports a new format (for example, HDMI or certain professional audio interfaces with a manual sample-rate adjustment).</span></span> <span data-ttu-id="2690e-142">Para notificar al cliente estos tipos de cambios de formato, WASAPI envía una notificación de sesión mediante la implementación registrada de [**IAudioSessionEvents::OnSessionDisconnected**](/windows/desktop/api/Audiopolicy/nf-audiopolicy-iaudiosessionevents-onsessiondisconnected) con un motivo de **desconexión de DisconnectReasonFormatChanged**.</span><span class="sxs-lookup"><span data-stu-id="2690e-142">To notify the client about these types of format changes, WASAPI sends a session notification by the registered implementation of [**IAudioSessionEvents::OnSessionDisconnected**](/windows/desktop/api/Audiopolicy/nf-audiopolicy-iaudiosessionevents-onsessiondisconnected) with a disconnect reason of **DisconnectReasonFormatChanged**.</span></span> <span data-ttu-id="2690e-143">El cliente puede controlar la notificación si vuelve a abrir la secuencia en el nuevo formato.</span><span class="sxs-lookup"><span data-stu-id="2690e-143">The client can handle the notification by reopening the stream in the new format.</span></span>

## <a name="related-topics"></a><span data-ttu-id="2690e-144">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="2690e-144">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2690e-145">Acerca de MMDevice API</span><span class="sxs-lookup"><span data-stu-id="2690e-145">About MMDevice API</span></span>](mmdevice-api.md)
</dt> <dt>

[<span data-ttu-id="2690e-146">Acerca de WASAPI</span><span class="sxs-lookup"><span data-stu-id="2690e-146">About WASAPI</span></span>](wasapi.md)
</dt> <dt>

[<span data-ttu-id="2690e-147">Enrutamiento de flujos</span><span class="sxs-lookup"><span data-stu-id="2690e-147">Stream Routing</span></span>](stream-routing.md)
</dt> </dl>

 

 



