---
title: Compatibilidad con menús emergentes
description: Compatibilidad con menús emergentes
ms.assetid: a8a1cf91-c18a-497f-89a7-b47536eaca0a
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 890d7eab6595200cb00e8422644b10f39807bab2
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/19/2020
ms.locfileid: "104358941"
---
# <a name="pop-up-menu-support"></a><span data-ttu-id="dc706-103">Compatibilidad con menús emergentes</span><span class="sxs-lookup"><span data-stu-id="dc706-103">Pop-up Menu Support</span></span>

<span data-ttu-id="dc706-104">\[Microsoft Agent está en desuso a partir de Windows 7 y puede que no esté disponible en versiones posteriores de Windows.\]</span><span class="sxs-lookup"><span data-stu-id="dc706-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="dc706-105">El agente de Microsoft incluye un menú emergente (también conocido como menú contextual) para cada carácter.</span><span class="sxs-lookup"><span data-stu-id="dc706-105">Microsoft Agent includes a pop-up menu (also known as a contextual menu) for each character.</span></span> <span data-ttu-id="dc706-106">El servidor muestra este menú emergente automáticamente cuando un usuario hace clic con el botón secundario en el carácter.</span><span class="sxs-lookup"><span data-stu-id="dc706-106">The server displays this pop-up menu automatically when a user right-clicks the character.</span></span> <span data-ttu-id="dc706-107">Puede Agregar comandos para la aplicación cliente al menú mediante la definición de una colección de [**comandos**](/windows/desktop/lwef/the-commands-collection-object) .</span><span class="sxs-lookup"><span data-stu-id="dc706-107">You can add commands for your client application to the menu by defining a [**Commands**](/windows/desktop/lwef/the-commands-collection-object) collection.</span></span> <span data-ttu-id="dc706-108">Para cada comando de la colección que defina, puede especificar el [**título**](caption-property.md) y las propiedades [**visibles**](visible-property.md) .</span><span class="sxs-lookup"><span data-stu-id="dc706-108">For each command in the collection that you define, you can specify [**Caption**](caption-property.md) and [**Visible**](visible-property.md) properties.</span></span> <span data-ttu-id="dc706-109">El **título** es el texto que aparece en el menú cuando la propiedad **visible** está establecida en **true**.</span><span class="sxs-lookup"><span data-stu-id="dc706-109">The **Caption** is the text that appears in the menu when the **Visible** property is set to **True**.</span></span> <span data-ttu-id="dc706-110">También puede usar la propiedad [**Enabled**](enabled-property.md) para mostrar el comando en el menú como Disabled y el [**HelpContextID**](helpcontextid-property.md) para admitir la compatibilidad con la propiedad.</span><span class="sxs-lookup"><span data-stu-id="dc706-110">You can also use the [**Enabled**](enabled-property.md) property to display the command in the menu as disabled and the [**HelpContextID**](helpcontextid-property.md) to support Help support for the property.</span></span> <span data-ttu-id="dc706-111">Defina la tecla de acceso para el texto del menú incluyendo una y comercial (&) antes del carácter de texto de la configuración del texto del **título** .</span><span class="sxs-lookup"><span data-stu-id="dc706-111">Define the access key for the menu text by including an ampersand (&) before the text character of the **Caption** text setting.</span></span>

<span data-ttu-id="dc706-112">El servidor agrega automáticamente los comandos de menú para abrir la ventana comandos de voz y oculta el carácter, así como los títulos de los [**comandos**](/windows/desktop/lwef/the-commands-collection-object) de otros clientes del carácter, a fin de permitir que los usuarios cambien de un cliente a otro.</span><span class="sxs-lookup"><span data-stu-id="dc706-112">The server automatically adds to the menu commands for opening the Voice Commands Window and hiding the character as well as the [**Commands**](/windows/desktop/lwef/the-commands-collection-object) captions of other clients of the character to enable users to switch between clients.</span></span> <span data-ttu-id="dc706-113">El servidor agrega automáticamente un separador al menú entre sus entradas de menú y las definidas por el cliente.</span><span class="sxs-lookup"><span data-stu-id="dc706-113">The server automatically adds a separator to the menu between its menu entries and those defined by the client.</span></span> <span data-ttu-id="dc706-114">Los separadores solo aparecen cuando hay elementos en el menú para separar.</span><span class="sxs-lookup"><span data-stu-id="dc706-114">Separators appear only when there are items in the menu to separate.</span></span>

<span data-ttu-id="dc706-115">Para quitar comandos de un menú, use el método [**Remove**](remove-method.md) .</span><span class="sxs-lookup"><span data-stu-id="dc706-115">To remove commands from a menu, use the [**Remove**](remove-method.md) method.</span></span> <span data-ttu-id="dc706-116">Tenga en cuenta que las entradas de menú no cambian mientras se muestra el menú.</span><span class="sxs-lookup"><span data-stu-id="dc706-116">Note that menu entries do not change while the menu displays.</span></span> <span data-ttu-id="dc706-117">Si agrega o quita comandos o cambia sus propiedades, el menú muestra los cambios cuando el usuario vuelve a mostrar el menú.</span><span class="sxs-lookup"><span data-stu-id="dc706-117">If you add or remove commands or change their properties, the menu displays the changes when the user redisplays the menu.</span></span>

<span data-ttu-id="dc706-118">Si prefiere proporcionar sus propios servicios de menú emergente para un carácter, puede usar la propiedad [**AutoPopupMenu**](autopopupmenu-property.md) para desactivar el control de servidor de la acción de clic con el botón secundario.</span><span class="sxs-lookup"><span data-stu-id="dc706-118">If you prefer to provide your own pop-up menu services for a character, you can use the [**AutoPopupMenu**](autopopupmenu-property.md) property to turn off server handling of the right-click action.</span></span> <span data-ttu-id="dc706-119">Después, puede usar la notificación de eventos [**click**](click-event.md) para crear su propio comportamiento de control de menús.</span><span class="sxs-lookup"><span data-stu-id="dc706-119">You can then use the [**Click**](click-event.md) event notification to create your own menu handling behavior.</span></span>

<span data-ttu-id="dc706-120">Cuando el usuario selecciona un comando en el menú emergente de un carácter o en la ventana comandos de voz, el servidor desencadena el evento de [**comando**](command-event.md) del cliente asociado y devuelve los parámetros de la entrada mediante el objeto [**UserInput**](/windows/desktop/lwef/iagentuserinput) .</span><span class="sxs-lookup"><span data-stu-id="dc706-120">When the user selects a command from a character's pop-up menu or the Voice Commands Window, the server triggers the [**Command**](command-event.md) event of the associated client and passes back the parameters of the input using the [**UserInput**](/windows/desktop/lwef/iagentuserinput) object.</span></span>

<span data-ttu-id="dc706-121">El servidor también proporciona un menú emergente para el icono de la barra de tareas del carácter.</span><span class="sxs-lookup"><span data-stu-id="dc706-121">The server also provides a pop-up menu for the character's taskbar icon.</span></span> <span data-ttu-id="dc706-122">Cuando el carácter esté visible, haga clic con el botón secundario en este menú para mostrar los mismos comandos que los que se muestran al hacer clic con el botón secundario en el carácter.</span><span class="sxs-lookup"><span data-stu-id="dc706-122">When the character is visible, right-clicking this menu displays the same commands as those displayed by right-clicking the character.</span></span> <span data-ttu-id="dc706-123">Sin embargo, cuando el carácter está oculto, solo se incluyen los comandos proporcionados por el servidor.</span><span class="sxs-lookup"><span data-stu-id="dc706-123">However, when the character is hidden, only the server-supplied commands are included.</span></span>

 

 