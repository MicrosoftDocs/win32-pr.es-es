---
description: Instmsi.exe es el paquete redistribuible para instalar Windows Installer&\# 160; 2.0 y versiones anteriores de Windows Installer. Consulte Windows Installer redistribuibles de los redistribuibles para Windows Installer&\# 160; 3.0 y versiones posteriores.
ms.assetid: 74ea4530-3a73-4169-b0b7-f0272229192d
title: Instmsi.exe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 229d748cda68731627a6af2af992e321755b5ca2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "105688330"
---
# <a name="instmsiexe"></a><span data-ttu-id="61527-104">Instmsi.exe</span><span class="sxs-lookup"><span data-stu-id="61527-104">Instmsi.exe</span></span>

<span data-ttu-id="61527-105">Instmsi.exe es el paquete redistribuible para instalar Windows Installer 2,0 y versiones anteriores de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="61527-105">Instmsi.exe is the redistributable package for installing Windows Installer 2.0, and earlier versions of Windows Installer.</span></span> <span data-ttu-id="61527-106">Consulte [Windows Installer redistribuibles](windows-installer-redistributables.md) de los redistribuibles para Windows Installer 3,0 y versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="61527-106">See [Windows Installer Redistributables](windows-installer-redistributables.md) for the redistributables for Windows Installer 3.0 and later versions.</span></span>

<span data-ttu-id="61527-107">Para obtener más información acerca de la versión de Windows Installer que se incluye con el sistema operativo, consulte [versiones publicadas de Windows Installer](released-versions-of-windows-installer.md).</span><span class="sxs-lookup"><span data-stu-id="61527-107">For more information about which version of the Windows Installer was shipped with your operating system, see [Released Versions of Windows Installer](released-versions-of-windows-installer.md).</span></span>

<span data-ttu-id="61527-108">Algunos redistribuibles no deben ejecutarse en determinadas versiones del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="61527-108">Some redistributables should not be run on certain versions of the operating system.</span></span> <span data-ttu-id="61527-109">En la tabla siguiente se describe qué Instmsi es compatible con qué sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="61527-109">The following table describes which Instmsi is compatible on which operating system.</span></span>



| <span data-ttu-id="61527-110">Si Instmsi.exe instala esta versión del Windows Installer</span><span class="sxs-lookup"><span data-stu-id="61527-110">If Instmsi.exe installs this version of the Windows Installer</span></span> | <span data-ttu-id="61527-111">Instmsi.exe se pueden ejecutar en estos sistemas operativos</span><span class="sxs-lookup"><span data-stu-id="61527-111">Instmsi.exe can be run on these operating systems</span></span>                    | <span data-ttu-id="61527-112">Instmsi.exe no se deben ejecutar en estos sistemas operativos</span><span class="sxs-lookup"><span data-stu-id="61527-112">Instmsi.exe must not be run on these operating systems</span></span>                                        |
|---------------------------------------------------------------|----------------------------------------------------------------------|-----------------------------------------------------------------------------------------------|
| <span data-ttu-id="61527-113">Windows Installer versión 1,0</span><span class="sxs-lookup"><span data-stu-id="61527-113">Windows Installer version 1.0</span></span>                                 | <span data-ttu-id="61527-114">Windows 95, Windows 98, Windows NT 4.0 + SP3</span><span class="sxs-lookup"><span data-stu-id="61527-114">Windows 95, Windows 98, Windows NT 4.0+SP3</span></span>                           | <span data-ttu-id="61527-115">Windows me, Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="61527-115">Windows Me, Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span></span> |
| <span data-ttu-id="61527-116">Windows Installer versión 1,1</span><span class="sxs-lookup"><span data-stu-id="61527-116">Windows Installer version 1.1</span></span>                                 | <span data-ttu-id="61527-117">Windows 95, Windows 98, Windows NT 4.0 + SP3</span><span class="sxs-lookup"><span data-stu-id="61527-117">Windows 95, Windows 98, Windows NT 4.0+SP3</span></span>                           | <span data-ttu-id="61527-118">Windows me, Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="61527-118">Windows Me, Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span></span> |
| <span data-ttu-id="61527-119">Windows Installer versión 1,2</span><span class="sxs-lookup"><span data-stu-id="61527-119">Windows Installer version 1.2</span></span>                                 | <span data-ttu-id="61527-120">Windows 95, Windows 98, Windows me, Windows NT 4.0 + SP3</span><span class="sxs-lookup"><span data-stu-id="61527-120">Windows 95, Windows 98, Windows Me, Windows NT 4.0+SP3</span></span>               | <span data-ttu-id="61527-121">Windows 2000, Windows XP, Windows Server 2003, Windows Vista y Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="61527-121">Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span></span>             |
| <span data-ttu-id="61527-122">Windows Installer versión 2,0</span><span class="sxs-lookup"><span data-stu-id="61527-122">Windows Installer version 2.0</span></span>                                 | <span data-ttu-id="61527-123">Windows 95, Windows 98, Windows me, Windows NT 4.0 + SP6, Windows 2000</span><span class="sxs-lookup"><span data-stu-id="61527-123">Windows 95, Windows 98, Windows Me, Windows NT 4.0+SP6, Windows 2000</span></span> | <span data-ttu-id="61527-124">Windows XP, Windows Server 2003, Windows Vista y Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="61527-124">Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span></span>                           |



 

<span data-ttu-id="61527-125">Por ejemplo, una aplicación que redistribuye Windows Installer versión 1,1 debe comprobar que el sistema operativo es Windows NT 4,0 SP3 o Windows 98/95 antes de ejecutar el paquete redistribuible.</span><span class="sxs-lookup"><span data-stu-id="61527-125">For example, an application that redistributes Windows Installer version 1.1 should check that the operating system is Windows NT 4.0 SP3 or Windows 98/95 before running the redistributable package.</span></span> <span data-ttu-id="61527-126">Las aplicaciones que usan el paquete redistribuible también deben asegurarse de que la versión ANSI del Windows Installer esté instalada en Windows 98/95 y que la versión de Unicode esté instalada en Windows NT o Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="61527-126">Applications using the redistributable package should also ensure that the ANSI version of the Windows Installer is installed on Windows 98/95, and that the Unicode version is installed on Windows NT or Windows 2000.</span></span> <span data-ttu-id="61527-127">Tenga en cuenta que algunas aplicaciones cambia el nombre de la versión Unicode a InstMsiW.</span><span class="sxs-lookup"><span data-stu-id="61527-127">Note that some applications rename the Unicode version to InstMsiW.</span></span>

## <a name="syntax"></a><span data-ttu-id="61527-128">Sintaxis</span><span class="sxs-lookup"><span data-stu-id="61527-128">Syntax</span></span>

<span data-ttu-id="61527-129"> *Opciones* de Instmsi</span><span class="sxs-lookup"><span data-stu-id="61527-129">**instmsi** *options*</span></span>

## <a name="command-line-options"></a><span data-ttu-id="61527-130">Opciones de la línea de comandos</span><span class="sxs-lookup"><span data-stu-id="61527-130">Command Line Options</span></span>

<span data-ttu-id="61527-131">Las opciones de la línea de comandos no distinguen mayúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="61527-131">The command line options are case-insensitive.</span></span>



| <span data-ttu-id="61527-132">Opción</span><span class="sxs-lookup"><span data-stu-id="61527-132">Option</span></span>                     | <span data-ttu-id="61527-133">Descripción</span><span class="sxs-lookup"><span data-stu-id="61527-133">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|----------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="61527-134">/q</span><span class="sxs-lookup"><span data-stu-id="61527-134">/q</span></span>                         | <span data-ttu-id="61527-135">Lo usan las aplicaciones que redistribuyen el Windows Installer como parte de una aplicación de arranque.</span><span class="sxs-lookup"><span data-stu-id="61527-135">For use by applications that redistribute the Windows Installer as part of a bootstrapping application.</span></span> <span data-ttu-id="61527-136">No se muestra ninguna interfaz de usuario al usuario.</span><span class="sxs-lookup"><span data-stu-id="61527-136">No UI is presented to the user.</span></span> <span data-ttu-id="61527-137">La aplicación de arranque debe comprobar el código de retorno para determinar si es necesario reiniciar para completar la instalación del Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="61527-137">The bootstrapping application should check the return code to determine whether a reboot is needed to complete the installation of the Windows Installer.</span></span>                                                                                                                                                                                                                          |
| <span data-ttu-id="61527-138">/t</span><span class="sxs-lookup"><span data-stu-id="61527-138">/t</span></span>                         | <span data-ttu-id="61527-139">Se usa solo con fines de depuración.</span><span class="sxs-lookup"><span data-stu-id="61527-139">Used for debugging purposes only.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="61527-140">/c: "msiinst/delayreboot"</span><span class="sxs-lookup"><span data-stu-id="61527-140">/c:"msiinst /delayreboot"</span></span>  | <span data-ttu-id="61527-141">Opción de reinicio retrasado.</span><span class="sxs-lookup"><span data-stu-id="61527-141">The delayed reboot option.</span></span> <span data-ttu-id="61527-142">Impide que Instmsi solicite al usuario un reinicio aunque tuviera que reemplazar los archivos que estaban en uso durante la instalación.</span><span class="sxs-lookup"><span data-stu-id="61527-142">Prevents Instmsi from prompting the user for a reboot even if it had to replace files that were in use during the installation.</span></span> <span data-ttu-id="61527-143">Si se invoca Instmsi con esta opción, devolverá un ERROR de \_ \_ reinicio correcto \_ necesario si tuviera que reemplazar los archivos que estaban en uso.</span><span class="sxs-lookup"><span data-stu-id="61527-143">If Instmsi is invoked with this option, it returns ERROR\_SUCCESS\_REBOOT\_REQUIRED if it had to replace files that were in use.</span></span> <span data-ttu-id="61527-144">Si no tuviera que reemplazar los archivos que estaban en uso, devolverá el ERROR \_ Success.</span><span class="sxs-lookup"><span data-stu-id="61527-144">If it did not have to replace files that were in use, it returns ERROR\_SUCCESS.</span></span> <span data-ttu-id="61527-145">Disponible con Instmsi para Windows Installer 2,0 o posterior.</span><span class="sxs-lookup"><span data-stu-id="61527-145">Available with Instmsi for Windows Installer  2.0 or later.</span></span> <span data-ttu-id="61527-146">Vea la sección Comentarios para obtener información adicional sobre los reinicios retrasados.</span><span class="sxs-lookup"><span data-stu-id="61527-146">See the remarks section for additional information on delayed reboots.</span></span><br/> |
| <span data-ttu-id="61527-147">/c: "msiinst/delayrebootq"</span><span class="sxs-lookup"><span data-stu-id="61527-147">/c:"msiinst /delayrebootq"</span></span> | <span data-ttu-id="61527-148">Versión silenciosa de la opción de reinicio retrasado.</span><span class="sxs-lookup"><span data-stu-id="61527-148">The quiet version of the delayed reboot option.</span></span> <span data-ttu-id="61527-149">No presenta ninguna interfaz de usuario para el usuario.</span><span class="sxs-lookup"><span data-stu-id="61527-149">It does not present any UI to the user.</span></span> <span data-ttu-id="61527-150">De lo contrario, el comportamiento es idéntico al de la opción anterior.</span><span class="sxs-lookup"><span data-stu-id="61527-150">Otherwise the behavior is identical to the previous option.</span></span> <span data-ttu-id="61527-151">Disponible con Instmsi para Windows Installer 2,0 o posterior.</span><span class="sxs-lookup"><span data-stu-id="61527-151">Available with Instmsi for Windows Installer 2.0 or later.</span></span> <span data-ttu-id="61527-152">Vea la sección Comentarios para obtener información adicional sobre los reinicios retrasados.</span><span class="sxs-lookup"><span data-stu-id="61527-152">See the remarks section for additional information on delayed reboots.</span></span><br/>                                                                                                                                                                                                                           |
| <span data-ttu-id="61527-153">/?</span><span class="sxs-lookup"><span data-stu-id="61527-153">/?</span></span>                         | <span data-ttu-id="61527-154">Muestra información de ayuda.</span><span class="sxs-lookup"><span data-stu-id="61527-154">Displays help.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |



 

## <a name="remarks"></a><span data-ttu-id="61527-155">Observaciones</span><span class="sxs-lookup"><span data-stu-id="61527-155">Remarks</span></span>

<span data-ttu-id="61527-156">Las aplicaciones de [arranque](bootstrapping.md) que usan Instmsi.exe para instalar el Windows Installer con otra aplicación pueden requerir un reinicio adicional del sistema.</span><span class="sxs-lookup"><span data-stu-id="61527-156">[Bootstrapping](bootstrapping.md) applications that use Instmsi.exe to install the Windows Installer with another application may require an extra system reboot.</span></span> <span data-ttu-id="61527-157">Es posible que se reinicie Adicionalmente además de los reinicios necesarios para instalar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="61527-157">This is potentially an extra reboot in addition to any reboots that are needed to install the application.</span></span>

<span data-ttu-id="61527-158">La opción retardo de reinicio solo se recomienda para los programadores de instalación que deseen eliminar un reinicio adicional debido al uso de Instmsi.exe con una aplicación de instalación que instala los archivos que están en uso.</span><span class="sxs-lookup"><span data-stu-id="61527-158">The delayed reboot option is only recommended for setup developers who want to eliminate an extra reboot caused by using Instmsi.exe with a setup application that installs files that are in use.</span></span>

<span data-ttu-id="61527-159">Los desarrolladores deben hacer lo siguiente en su aplicación de instalación para utilizar la opción de reinicio retrasado.</span><span class="sxs-lookup"><span data-stu-id="61527-159">Developers should do the following in their setup application to use the delayed reboot option.</span></span> <span data-ttu-id="61527-160">Esta opción no está disponible con Instmsi.exe versiones que instalan versiones de Windows Installer anteriores a la versión 2,0:</span><span class="sxs-lookup"><span data-stu-id="61527-160">This option is not available with Instmsi.exe versions that install Window Installer versions earlier than version 2.0:</span></span>

<span data-ttu-id="61527-161">**Para utilizar la opción de reinicio retrasado**</span><span class="sxs-lookup"><span data-stu-id="61527-161">**To use the delayed reboot option**</span></span>

1.  <span data-ttu-id="61527-162">Llame a Instmsi.exe con una de las opciones de línea de comandos de reinicio retrasado.</span><span class="sxs-lookup"><span data-stu-id="61527-162">Call Instmsi.exe with one of the delayed reboot command line options.</span></span>
2.  <span data-ttu-id="61527-163">Trate el resultado de que se \_ REinicien los errores correctos o correctos \_ \_ con éxito \_ , como lo que significa que es correcto.</span><span class="sxs-lookup"><span data-stu-id="61527-163">Treat the return of either ERROR\_SUCCESS or ERROR\_SUCCESS\_REBOOT\_REQUIRED as meaning success.</span></span>
3.  <span data-ttu-id="61527-164">Obtenga la ruta de acceso a la carpeta que contiene los archivos binarios de Windows Installer recién instalados del valor InstallerLocation en:</span><span class="sxs-lookup"><span data-stu-id="61527-164">Get the path to the folder containing the newly installed Windows Installer binaries from the InstallerLocation value under:</span></span>

    <span data-ttu-id="61527-165">**HKEY \_ Software de \_ equipo local** \\  \\  \\  \\  \\ **instalador** de CurrentVersion de Microsoft Windows</span><span class="sxs-lookup"><span data-stu-id="61527-165">**HKEY\_LOCAL\_MACHINE**\\**Software**\\**Microsoft**\\**Windows**\\**CurrentVersion**\\**Installer**</span></span>

    <span data-ttu-id="61527-166">Este valor es de tipo **reg \_ SZ**.</span><span class="sxs-lookup"><span data-stu-id="61527-166">This value is of type **REG\_SZ**.</span></span>

4.  <span data-ttu-id="61527-167">Establezca el directorio actual en la ruta de acceso obtenida en el paso 3.</span><span class="sxs-lookup"><span data-stu-id="61527-167">Set the current directory to the path obtained in step 3.</span></span>
5.  <span data-ttu-id="61527-168">Invoque msiexec en el paquete de la aplicación y ejecute otro código de instalación específico de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="61527-168">Invoke Msiexec on the application's package and run other setup code specific to the application.</span></span> <span data-ttu-id="61527-169">Si la aplicación de instalación usa [**MsiInstallProduct**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta), la aplicación debe cargar MSI.DLL desde la ubicación obtenida en el paso 3.</span><span class="sxs-lookup"><span data-stu-id="61527-169">If the setup application uses [**MsiInstallProduct**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta), then the application must load MSI.DLL from the location obtained in step 3.</span></span>
    > [!Note]  
    > <span data-ttu-id="61527-170">Las aplicaciones que llaman a **LoadLibrary** en el nuevo MSI.DLL en la ubicación obtenida en el paso 3 deben asegurarse de que no se haya cargado todavía una versión anterior de MSI.DLL en el proceso.</span><span class="sxs-lookup"><span data-stu-id="61527-170">Applications that call **LoadLibrary** on the new MSI.DLL in the location obtained in step 3 must ensure that an older version of MSI.DLL has not already been loaded within the process.</span></span> <span data-ttu-id="61527-171">Si se cargó una versión anterior de MSI.DLL dentro del proceso, se debe descargar del espacio de direcciones de proceso antes de la llamada **LoadLibrary** para el nuevo MSI.DLL.</span><span class="sxs-lookup"><span data-stu-id="61527-171">If an older version of MSI.DLL was loaded within the process, it must be unloaded from the process address space prior to the **LoadLibrary** call for the new MSI.DLL.</span></span>

     

6.  <span data-ttu-id="61527-172">Si el paso (5) no requiere un reinicio y si Instmsi.exe ha devuelto \_ el \_ reinicio \_ de error correcto necesario en el paso (1), pida al usuario que reinicie el equipo para completar la instalación de los archivos binarios de Windows Installer en el sistema.</span><span class="sxs-lookup"><span data-stu-id="61527-172">If step (5) does not require a reboot and if Instmsi.exe had returned ERROR\_SUCCESS\_REBOOT\_REQUIRED in step (1), prompt the user for a reboot to complete the setup of the Windows Installer binaries on the system.</span></span> <span data-ttu-id="61527-173">Sin embargo, si se produce un reinicio en el paso (5), no se requiere ningún paso adicional.</span><span class="sxs-lookup"><span data-stu-id="61527-173">However, if a reboot occurs in step (5), no additional steps are required.</span></span>

<span data-ttu-id="61527-174">Instmsi.exe está disponible en los [componentes de Windows SDK para Windows Installer desarrolladores](platform-sdk-components-for-windows-installer-developers.md).</span><span class="sxs-lookup"><span data-stu-id="61527-174">Instmsi.exe is available in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="61527-175">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="61527-175">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="61527-176">Arranque</span><span class="sxs-lookup"><span data-stu-id="61527-176">Bootstrapping</span></span>](bootstrapping.md)
</dt> <dt>

[<span data-ttu-id="61527-177">Arranque de descarga de Internet</span><span class="sxs-lookup"><span data-stu-id="61527-177">Internet Download Bootstrapping</span></span>](internet-download-bootstrapping.md)
</dt> <dt>

[<span data-ttu-id="61527-178">Versiones publicadas, herramientas y redistribuibles</span><span class="sxs-lookup"><span data-stu-id="61527-178">Released Versions, Tools, and Redistributables</span></span>](released-versions-tools-and-redistributables.md)
</dt> <dt>

[<span data-ttu-id="61527-179">Herramientas de desarrollo de Windows Installer</span><span class="sxs-lookup"><span data-stu-id="61527-179">Windows Installer Development Tools</span></span>](windows-installer-development-tools.md)
</dt> </dl>

 

 




