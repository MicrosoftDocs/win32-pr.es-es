---
title: Juegos con cuentas de usuario de Least-Privileged
description: En este artículo se describe cómo los desarrolladores de juegos pueden crear juegos de Microsoft Windows que funcionan bien con cuentas de usuario con privilegios mínimos (también conocidas como cuentas de usuario limitado).
ms.assetid: 1b7cc3c9-b180-14b1-53c8-57f9e545d009
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d4c44d94345462fc02ec649c5674ed88c38c12ee
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104487998"
---
# <a name="gaming-with-least-privileged-user-accounts"></a><span data-ttu-id="c1292-103">Juegos con cuentas de usuario de Least-Privileged</span><span class="sxs-lookup"><span data-stu-id="c1292-103">Gaming with Least-Privileged User Accounts</span></span>

<span data-ttu-id="c1292-104">En este artículo se describe cómo los desarrolladores de juegos pueden crear juegos de Microsoft Windows que funcionan bien con cuentas de usuario con privilegios mínimos (también conocidas como cuentas de usuario limitado).</span><span class="sxs-lookup"><span data-stu-id="c1292-104">This article describes how games developers can author Microsoft Windows games that work well with least-privileged user accounts (also known as limited-user accounts).</span></span>

-   [<span data-ttu-id="c1292-105">Introducción</span><span class="sxs-lookup"><span data-stu-id="c1292-105">Introduction</span></span>](#introduction)
-   [<span data-ttu-id="c1292-106">Acceso a archivos para cuentas de usuario de Least-Privileged</span><span class="sxs-lookup"><span data-stu-id="c1292-106">File Access for Least-Privileged User Accounts</span></span>](#file-access-for-least-privileged-user-accounts)
    -   [<span data-ttu-id="c1292-107">Escenario 1: archivos que los usuarios no necesitan ver ni modificar</span><span class="sxs-lookup"><span data-stu-id="c1292-107">Scenario 1: Files that do not need to be viewed or altered by users</span></span>](#scenario-1-files-that-do-not-need-to-be-viewed-or-altered-by-users)
    -   [<span data-ttu-id="c1292-108">Escenario 2: archivos que los usuarios deben ver o modificar</span><span class="sxs-lookup"><span data-stu-id="c1292-108">Scenario 2: Files that need to be viewed or altered by users</span></span>](#scenario-2-files-that-need-to-be-viewed-or-altered-by-users)
-   [<span data-ttu-id="c1292-109">Acceso al registro para cuentas de usuario de Least-Privileged</span><span class="sxs-lookup"><span data-stu-id="c1292-109">Registry Access for Least-Privileged User Accounts</span></span>](#registry-access-for-least-privileged-user-accounts)
-   [<span data-ttu-id="c1292-110">Aplicar revisiones con cuentas de usuario de Least-Privileged</span><span class="sxs-lookup"><span data-stu-id="c1292-110">Patching with Least-Privileged User Accounts</span></span>](#patching-with-least-privileged-user-accounts)

## <a name="introduction"></a><span data-ttu-id="c1292-111">Introducción</span><span class="sxs-lookup"><span data-stu-id="c1292-111">Introduction</span></span>

<span data-ttu-id="c1292-112">Windows administra sus usuarios con cuentas.</span><span class="sxs-lookup"><span data-stu-id="c1292-112">Windows manages its users with accounts.</span></span> <span data-ttu-id="c1292-113">En la actualidad, más del 80 por ciento de los usuarios del equipo en casa comparten su equipo con otros miembros de la familia.</span><span class="sxs-lookup"><span data-stu-id="c1292-113">Today, more than eighty percent of computer users at home share their computer with other family members.</span></span> <span data-ttu-id="c1292-114">Cuando varios usuarios comparten un equipo Windows, se crean varias cuentas de usuario y cada usuario inicia sesión con una cuenta individual para tener acceso al equipo.</span><span class="sxs-lookup"><span data-stu-id="c1292-114">When multiple users share a Windows computer, multiple user accounts are created, and each user logs in with an individual account to access the computer.</span></span> <span data-ttu-id="c1292-115">Con el mayor conocimiento de la seguridad, más personas trabajan con sus equipos con cuentas de usuario con privilegios mínimos, también conocidas como cuentas de usuario limitado, que no tienen control total sobre el sistema.</span><span class="sxs-lookup"><span data-stu-id="c1292-115">With the increasing awareness for security, more people operate their computers with least-privileged user accounts, also known as limited-user accounts, which do not have complete control over the system.</span></span> <span data-ttu-id="c1292-116">Normalmente, las cuentas de administrador tienen acceso sin restricciones a todas las partes del equipo.</span><span class="sxs-lookup"><span data-stu-id="c1292-116">Administrator accounts typically have unrestricted access to every part of the computer.</span></span> <span data-ttu-id="c1292-117">Esto puede afectar al funcionamiento de los juegos basados en Windows.</span><span class="sxs-lookup"><span data-stu-id="c1292-117">This can affect how Windows-based games work.</span></span>

<span data-ttu-id="c1292-118">Hay otras ventajas para los desarrolladores de juegos que escriben sus juegos para trabajar con cuentas de usuario con privilegios mínimos.</span><span class="sxs-lookup"><span data-stu-id="c1292-118">There are additional benefits for games developers who write their games to work with least-privileged user accounts.</span></span> <span data-ttu-id="c1292-119">En Windows Vista y versiones posteriores, se aplican las cuentas de usuario con privilegios mínimos, lo que significa que cada cuenta del sistema, con la excepción del administrador local, es una cuenta de usuario con privilegios mínimos.</span><span class="sxs-lookup"><span data-stu-id="c1292-119">In Windows Vista and later, least-privileged user accounts are enforced, which means that every account on the system, with the exception of the local administrator, is a least-privileged user account.</span></span> <span data-ttu-id="c1292-120">Esto afectará a la forma en que los juegos que no siguen la directriz (aplicaciones heredadas) se ejecutan en Windows Vista y versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="c1292-120">This will affect how games that do not follow the guideline (legacy applications) run on Windows Vista and later.</span></span> <span data-ttu-id="c1292-121">Por ejemplo, cuando una aplicación intenta escribir en una carpeta o un valor del registro para el que no tiene permiso, la escritura del archivo se redirige a un almacén de archivos virtual para el usuario.</span><span class="sxs-lookup"><span data-stu-id="c1292-121">For instance, when an application attempts to write to a folder or a registry value to which it does not have permission, the file write is redirected to a virtual file store for the user.</span></span> <span data-ttu-id="c1292-122">Este almacén de archivos virtual residirá en una carpeta en la que el usuario tenga acceso de escritura.</span><span class="sxs-lookup"><span data-stu-id="c1292-122">This virtual file store will reside in a folder to which the user has write access.</span></span> <span data-ttu-id="c1292-123">Es posible que este comportamiento no parezca tan catastrófico como la causa del error en el intento de escritura. sin embargo, las aplicaciones que crean archivos virtualizados pueden confundir a los usuarios, ya que los archivos no se escribirán en la ubicación que esperan los usuarios.</span><span class="sxs-lookup"><span data-stu-id="c1292-123">This behavior may not seem as catastrophic as outright failing the write attempt; however, applications that create virtualized files may confuse users because files will not be written to the location users expect.</span></span> <span data-ttu-id="c1292-124">Por ejemplo, los juegos que escriben archivos de puntuación alta en la misma carpeta que la carpeta ejecutable escribirán estos archivos en una carpeta virtualizada en su lugar.</span><span class="sxs-lookup"><span data-stu-id="c1292-124">For instance, games that write high score files to the same folder as the executable folder will write these files to a virtualized folder instead.</span></span> <span data-ttu-id="c1292-125">Por lo tanto, un usuario no puede ver la puntuación máxima que ha conseguido otro usuario porque cada usuario tiene un almacén de archivos virtualizado independiente.</span><span class="sxs-lookup"><span data-stu-id="c1292-125">Consequently, one user cannot see the high score achieved by another user because every user has a separate virtualized file store.</span></span>

<span data-ttu-id="c1292-126">Los juegos que siguen las instrucciones de este artículo se ejecutarán con cuentas de usuario con privilegios mínimos y, por consiguiente, mantendrán la compatibilidad con Windows Vista y versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="c1292-126">Games that follow the guidelines in this article will run with least-privileged user accounts, and consequently will maintain compatibility with Windows Vista and later.</span></span>

## <a name="file-access-for-least-privileged-user-accounts"></a><span data-ttu-id="c1292-127">Acceso a archivos para cuentas de usuario de Least-Privileged</span><span class="sxs-lookup"><span data-stu-id="c1292-127">File Access for Least-Privileged User Accounts</span></span>

<span data-ttu-id="c1292-128">Windows admite dos sistemas de archivos: FAT32 y NTFS.</span><span class="sxs-lookup"><span data-stu-id="c1292-128">Windows supports two file systems: FAT32 and NTFS.</span></span> <span data-ttu-id="c1292-129">FAT32 es un sistema de archivos heredado que solo se admite por compatibilidad con versiones anteriores; NTFS admite permisos de archivo más eficaces y sólidos.</span><span class="sxs-lookup"><span data-stu-id="c1292-129">FAT32 is a legacy file system supported only for backward compatibility; NTFS supports more powerful and robust file permissions.</span></span> <span data-ttu-id="c1292-130">El uso de NTFS se está expandiendo a medida que los distribuidores envían nuevos equipos con Windows preinstalado en una unidad de disco duro con particiones NTFS.</span><span class="sxs-lookup"><span data-stu-id="c1292-130">The use of NTFS is expanding as retailers are shipping new computers with Windows pre-installed on a NTFS-partitioned hard drive.</span></span> <span data-ttu-id="c1292-131">En un sistema Windows XP basado en NTFS, los usuarios con cuentas de usuario con privilegios mínimos solo tienen acceso limitado a varias carpetas.</span><span class="sxs-lookup"><span data-stu-id="c1292-131">On an NTFS-based Windows XP system, users with least-privileged user accounts have only limited access to several folders.</span></span> <span data-ttu-id="c1292-132">Sin embargo, tendrán acceso completo en un sistema de Windows XP basado en FAT32.</span><span class="sxs-lookup"><span data-stu-id="c1292-132">However, they would have complete access on a FAT32-based Windows XP system.</span></span>

<span data-ttu-id="c1292-133">En la tabla siguiente se muestra la ubicación predeterminada de estas carpetas y sus permisos.</span><span class="sxs-lookup"><span data-stu-id="c1292-133">The following table lists the default location of these folders and their permissions.</span></span>



| <span data-ttu-id="c1292-134">Ruta</span><span class="sxs-lookup"><span data-stu-id="c1292-134">Path</span></span>                                               | <span data-ttu-id="c1292-135">Contenido de la carpeta</span><span class="sxs-lookup"><span data-stu-id="c1292-135">Folder Contents</span></span>              | <span data-ttu-id="c1292-136">Lectura</span><span class="sxs-lookup"><span data-stu-id="c1292-136">Read</span></span> | <span data-ttu-id="c1292-137">Escritura</span><span class="sxs-lookup"><span data-stu-id="c1292-137">Write</span></span> | <span data-ttu-id="c1292-138">Crear/Eliminar</span><span class="sxs-lookup"><span data-stu-id="c1292-138">Create/Delete</span></span> |
|----------------------------------------------------|------------------------------|------|-------|---------------|
| <span data-ttu-id="c1292-139"><Drive>: \\ Windows</span><span class="sxs-lookup"><span data-stu-id="c1292-139"><Drive>:\\Windows</span></span>                            | <span data-ttu-id="c1292-140">El sistema operativo Windows</span><span class="sxs-lookup"><span data-stu-id="c1292-140">The Windows operating system</span></span> | <span data-ttu-id="c1292-141">X</span><span class="sxs-lookup"><span data-stu-id="c1292-141">X</span></span>    |       |               |
| <span data-ttu-id="c1292-142"><Drive>: \\ Archivos de programa</span><span class="sxs-lookup"><span data-stu-id="c1292-142"><Drive>:\\Program Files</span></span>                      | <span data-ttu-id="c1292-143">Archivos de aplicación ejecutable</span><span class="sxs-lookup"><span data-stu-id="c1292-143">Executable application files</span></span> | <span data-ttu-id="c1292-144">X</span><span class="sxs-lookup"><span data-stu-id="c1292-144">X</span></span>    |       |               |
| <span data-ttu-id="c1292-145"><Drive>: \\ Documents and Settings \\ nombre de usuario\*</span><span class="sxs-lookup"><span data-stu-id="c1292-145"><Drive>:\\Documents and Settings\\Username\*</span></span> | <span data-ttu-id="c1292-146">Archivos de cada usuario</span><span class="sxs-lookup"><span data-stu-id="c1292-146">Each user's files</span></span>            | <span data-ttu-id="c1292-147">X</span><span class="sxs-lookup"><span data-stu-id="c1292-147">X</span></span>    | <span data-ttu-id="c1292-148">X</span><span class="sxs-lookup"><span data-stu-id="c1292-148">X</span></span>     | <span data-ttu-id="c1292-149">X</span><span class="sxs-lookup"><span data-stu-id="c1292-149">X</span></span>             |
| <span data-ttu-id="c1292-150"><Drive>: \\ Documentos y configuraciones \\ todos los usuarios</span><span class="sxs-lookup"><span data-stu-id="c1292-150"><Drive>:\\Documents and Settings\\All Users</span></span>  | <span data-ttu-id="c1292-151">Todos los archivos de usuario</span><span class="sxs-lookup"><span data-stu-id="c1292-151">All user files</span></span>               | <span data-ttu-id="c1292-152">X</span><span class="sxs-lookup"><span data-stu-id="c1292-152">X</span></span>    | <span data-ttu-id="c1292-153">X</span><span class="sxs-lookup"><span data-stu-id="c1292-153">X</span></span>     | <span data-ttu-id="c1292-154">X</span><span class="sxs-lookup"><span data-stu-id="c1292-154">X</span></span>             |



 

<span data-ttu-id="c1292-155">\* Username es el nombre de inicio de sesión del usuario.</span><span class="sxs-lookup"><span data-stu-id="c1292-155">\* Username is the user's login name.</span></span>

<span data-ttu-id="c1292-156">En una cuenta de usuario con privilegios mínimos, puede leer, escribir, crear y eliminar archivos en cualquier carpeta: Documents and Settings \\ nombre de usuario o Documents and Settings \\ All Users.</span><span class="sxs-lookup"><span data-stu-id="c1292-156">In a least-privileged user account, you may read, write, create and delete files in either folder: Documents and Settings\\Username or Documents and Settings\\All Users.</span></span>

<span data-ttu-id="c1292-157">Esto significa que no debe colocar Save Games en \\ los archivos de programa, en lugar de hacerlo en una subcarpeta de \\ Mis documentos.</span><span class="sxs-lookup"><span data-stu-id="c1292-157">What this means is that you should not place save games in \\Program Files, instead they should go in a sub-folder in \\My Documents.</span></span> <span data-ttu-id="c1292-158">Además, no debe colocar datos de aplicación temporales en \\ archivos de programa o en \\ Mis documentos, sino que debe colocarse en la carpeta de datos de la aplicación (CSIDL \_ local \_ AppData).</span><span class="sxs-lookup"><span data-stu-id="c1292-158">Also you should not place temporary application data in \\Program Files or \\My Documents, instead it should be placed in Application Data folder (CSIDL\_LOCAL\_APPDATA).</span></span>

<span data-ttu-id="c1292-159">Más concretamente, hay dos escenarios que debe controlar cada juego:</span><span class="sxs-lookup"><span data-stu-id="c1292-159">More specifically, there are two scenarios that each game should handle:</span></span>

### <a name="scenario-1-files-that-do-not-need-to-be-viewed-or-altered-by-users"></a><span data-ttu-id="c1292-160">Escenario 1: archivos que los usuarios no necesitan ver ni modificar</span><span class="sxs-lookup"><span data-stu-id="c1292-160">Scenario 1: Files that do not need to be viewed or altered by users</span></span>

<span data-ttu-id="c1292-161">Un ejemplo típico sería el archivo de configuración del juego, los archivos temporales y los archivos de la memoria caché del juego.</span><span class="sxs-lookup"><span data-stu-id="c1292-161">A typical example would be the game's configuration file, temporary files, and game cache files.</span></span> <span data-ttu-id="c1292-162">Normalmente, estos archivos se conservan en la carpeta datos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c1292-162">These files are typically kept in the Application Data folder.</span></span> <span data-ttu-id="c1292-163">Para obtener esta ruta de acceso a la carpeta, llame a la función [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) con CSIDL \_ AppData o CSIDL \_ local \_ AppData, tal y como se muestra en el ejemplo de código siguiente.</span><span class="sxs-lookup"><span data-stu-id="c1292-163">To obtain this folder path, call the [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) function with CSIDL\_APPDATA or CSIDL\_LOCAL\_APPDATA as shown in the following code example.</span></span>

``` syntax
#include <shlobj.h>
#include <strsafe.h>

#define APPNAME L"MyApp"

WCHAR wszPath[MAX_PATH];

// Local Application Data
SHGetFolderPath( hWnd, CSIDL_LOCAL_APPDATA, NULL, SHGFP_TYPE_CURRENT, wszPath );
StringCchCatW( wszPath, MAX_PATH, L"\\" );
StringCchCatW( wszPath, MAX_PATH, APPNAME );

// Create the folder wszPath
// Then create files in wszPath
// Roaming Application Data
SHGetFolderPath( hWnd, CSIDL_APPDATA, NULL, SHGFP_TYPE_CURRENT, wszPath );
StringCchCatW( wszPath, MAX_PATH, L"\\" );
StringCchCatW( wszPath, MAX_PATH, APPNAME );

// Create the folder wszPath
// Then create files in wszPath
```

<span data-ttu-id="c1292-164">La diferencia entre las carpetas de datos de aplicaciones locales y móviles es que en Windows 2000 y Windows XP, el contenido móvil se copia en y desde el servidor durante el proceso de inicio y cierre de sesión, mientras que el contenido local no lo es.</span><span class="sxs-lookup"><span data-stu-id="c1292-164">The difference between local and roaming Application Data folders is that on Windows 2000 and Windows XP, roaming content is copied to and from the server during the logon/logoff process, while local content is not.</span></span> <span data-ttu-id="c1292-165">Para la mayoría de los juegos, los datos de aplicaciones locales son suficientes.</span><span class="sxs-lookup"><span data-stu-id="c1292-165">For most games, local Application Data is sufficient.</span></span>

### <a name="scenario-2-files-that-need-to-be-viewed-or-altered-by-users"></a><span data-ttu-id="c1292-166">Escenario 2: archivos que los usuarios deben ver o modificar</span><span class="sxs-lookup"><span data-stu-id="c1292-166">Scenario 2: Files that need to be viewed or altered by users</span></span>

<span data-ttu-id="c1292-167">Un ejemplo típico sería el de los archivos de juego guardados de un usuario.</span><span class="sxs-lookup"><span data-stu-id="c1292-167">A typical example would be a user's saved game files.</span></span> <span data-ttu-id="c1292-168">Almacene los archivos en la carpeta de documentos del usuario para que sean fácilmente visibles para el usuario.</span><span class="sxs-lookup"><span data-stu-id="c1292-168">Store the files in the user's document folder so that they are easily visible to the user.</span></span> <span data-ttu-id="c1292-169">Una aplicación obtiene la ruta de acceso de la carpeta de documentos del usuario mediante una llamada a [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) con CSIDL \_ personal, como se muestra en el ejemplo de código siguiente:</span><span class="sxs-lookup"><span data-stu-id="c1292-169">An application gets the user's document folder path by calling [**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) with CSIDL\_PERSONAL, as the following code example shows:</span></span>

``` syntax
#include <shlobj.h>
#include <strsafe.h>

#define APPNAME L"MyApp"

WCHAR wszPath[MAX_PATH];

SHGetFolderPath( hWnd, CSIDL_PERSONAL, NULL, SHGFP_TYPE_CURRENT, wszPath );
StringCchCatW( wszPath, MAX_PATH, L"\\" );
StringCchCatW( wszPath, MAX_PATH, APPNAME );

// Create the folder wszPath
// Then create files in wszPath
```

<span data-ttu-id="c1292-170">En ocasiones, es posible que un juego necesite almacenar archivos que todos los usuarios están diseñados para ver y usar.</span><span class="sxs-lookup"><span data-stu-id="c1292-170">At times, a game may need to store files that all users are meant to see and use.</span></span> <span data-ttu-id="c1292-171">Un ejemplo es el registro de puntuación alto, donde todos los usuarios escriben en el mismo archivo de registro para que las puntuaciones altas se mantengan en todo el sistema en lugar de una puntuación alta independiente para cada usuario.</span><span class="sxs-lookup"><span data-stu-id="c1292-171">One example is the high score record, where all users write to the same record file so that high scores are maintained system-wide instead of a separate high score for each user.</span></span> <span data-ttu-id="c1292-172">En otros ejemplos se descargan mapas, misiones y modificaciones de juegos.</span><span class="sxs-lookup"><span data-stu-id="c1292-172">Other examples are downloaded maps, missions, and game modifications.</span></span> <span data-ttu-id="c1292-173">Si se comparten, solo un usuario tiene que descargarlas en lugar de todos los usuarios.</span><span class="sxs-lookup"><span data-stu-id="c1292-173">If these are shared, then only one user has to download them instead of every user.</span></span> <span data-ttu-id="c1292-174">En este escenario, use la carpeta de documentos en la carpeta de perfil compartido, como se muestra en el código siguiente.</span><span class="sxs-lookup"><span data-stu-id="c1292-174">In this scenario, use the document folder under the shared profile folder, as demonstrated in the following code.</span></span>

``` syntax
#include <shlobj.h>
#include <strsafe.h>

#define APPNAME L"MyApp"

WCHAR wszPath[MAX_PATH];

SHGetFolderPath( hWnd, CSIDL_COMMON_DOCUMENTS, NULL, SHGFP_TYPE_CURRENT, wszPath );
StringCchCatW( wszPath, MAX_PATH, L"\\" );
StringCchCatW( wszPath, MAX_PATH, APPNAME );

// Create the folder wszPath
// Then create files in wszPath
```

## <a name="registry-access-for-least-privileged-user-accounts"></a><span data-ttu-id="c1292-175">Acceso al registro para cuentas de usuario de Least-Privileged</span><span class="sxs-lookup"><span data-stu-id="c1292-175">Registry Access for Least-Privileged User Accounts</span></span>

<span data-ttu-id="c1292-176">Es habitual que las aplicaciones usen el registro de Windows para almacenar información.</span><span class="sxs-lookup"><span data-stu-id="c1292-176">It is common for applications to use the Windows registry to store information.</span></span> <span data-ttu-id="c1292-177">Al igual que el acceso a archivos, el administrador y las cuentas de usuario con privilegios mínimos no tienen el mismo permiso en el registro.</span><span class="sxs-lookup"><span data-stu-id="c1292-177">Similar to file access, administrator and least-privileged user accounts do not have the same permission to the registry.</span></span> <span data-ttu-id="c1292-178">En el caso de las cuentas de usuario con privilegios mínimos, todo el nodo de la \_ máquina local HKEY \_ es de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="c1292-178">For least-privileged user accounts, the entire HKEY\_LOCAL\_MACHINE node is read-only.</span></span> <span data-ttu-id="c1292-179">Por ejemplo, un juego puede leer la información de configuración predeterminada, pero no puede escribir información nueva en este nodo.</span><span class="sxs-lookup"><span data-stu-id="c1292-179">For instance, a game can read the default configuration information, but may not write any new information to this node.</span></span> <span data-ttu-id="c1292-180">Por lo tanto, los juegos que se ejecutan en modo de usuario con privilegios mínimos que necesitan escribir en el registro deberán usar el \_ nodo de usuario actual HKEY \_ para almacenar información por usuario, como se muestra en el código siguiente.</span><span class="sxs-lookup"><span data-stu-id="c1292-180">Consequently, games running in least-privileged user mode that need to write to the registry will need to use the HKEY\_CURRENT\_USER node to store per-user information, as illustrated in the following code.</span></span>

``` syntax
#define APP_REGISTRY_KEY_PATH L"Software\\MyCompany\\MyApp"

LONG lRetVal;
HKEY hKey;

lRetVal = RegCreateKeyExW( HKEY_CURRENT_USER,
                           APP_REGISTRY_KEY_PATH,
                           0,
                           NULL,
                           REG_OPTION_NON_VOLATILE,
                           KEY_WRITE|KEY_READ,
                           NULL,
                           &hKey,
                           NULL );

if( ERROR_SUCCESS == lRetVal )
{
    // Store information in hKey
}
```

<span data-ttu-id="c1292-181">Merece la pena mencionar que, durante la instalación, la información del registro debe escribirse en el \_ equipo local HKEY \_ , no en el \_ \_ usuario actual.</span><span class="sxs-lookup"><span data-stu-id="c1292-181">It is worth noting that during installation, registry information should be written to HKEY\_LOCAL\_MACHINE, not HKEY\_CURRENT\_USER.</span></span> <span data-ttu-id="c1292-182">Esto se debe a que la persona que ejecuta la instalación es normalmente un administrador y puede que no sea la única persona que utiliza el programa.</span><span class="sxs-lookup"><span data-stu-id="c1292-182">This is because the person running the installation is usually an administrator, and may not be the only person to use the program.</span></span> <span data-ttu-id="c1292-183">En esta situación, la escritura en HKEY \_ Current \_ User hace que la información no esté disponible para otros usuarios.</span><span class="sxs-lookup"><span data-stu-id="c1292-183">In this situation, writing to HKEY\_CURRENT\_USER makes the information unavailable to other users.</span></span> <span data-ttu-id="c1292-184">Esto no suele ser un problema, ya que la información escrita en el registro durante la instalación es la configuración predeterminada y la configuración que se aplica a todos los usuarios del programa.</span><span class="sxs-lookup"><span data-stu-id="c1292-184">This is not usually an issue because the information written to the registry during installation is the configuration and default settings that apply to every user of the program.</span></span>

<span data-ttu-id="c1292-185">Al desinstalar el juego, es necesario realizar un esfuerzo adicional para quitar todos los valores que el juego ha escrito en el registro.</span><span class="sxs-lookup"><span data-stu-id="c1292-185">When uninstalling the game, extra effort is necessary to remove every value that the game has written to the registry.</span></span> <span data-ttu-id="c1292-186">Dado que el desinstalador es ejecutado por una persona, normalmente el administrador, simplemente eliminando la información relevante en HKEY \_ local \_ Machine y HKEY \_ Current \_ User no quitará los valores de otros usuarios.</span><span class="sxs-lookup"><span data-stu-id="c1292-186">Because the uninstaller is run by one person, usually the administrator, simply deleting the relevant information in HKEY\_LOCAL\_MACHINE and HKEY\_CURRENT\_USER will not remove values for other users.</span></span> <span data-ttu-id="c1292-187">Una manera de quitar la información por usuario en el registro es enumerar la \_ raíz del subárbol del registro HKEY users.</span><span class="sxs-lookup"><span data-stu-id="c1292-187">One way to remove the per-user information in the registry is to enumerate the HKEY\_USERS registry hive root.</span></span> <span data-ttu-id="c1292-188">Cada subclave de HKEY \_ users corresponde al \_ \_ subárbol del usuario HKEY actual para un usuario determinado del sistema.</span><span class="sxs-lookup"><span data-stu-id="c1292-188">Each subkey under HKEY\_USERS corresponds to the HKEY\_CURRENT\_USER hive for a particular user on the system.</span></span> <span data-ttu-id="c1292-189">Al enumerar \_ los usuarios de HKEY y quitar la información específica del juego en cada subclave, el desinstalador puede garantizar que no quede información.</span><span class="sxs-lookup"><span data-stu-id="c1292-189">By enumerating HKEY\_USERS and removing the game-specific information under each subkey, the uninstaller can ensure that no information is left behind.</span></span>

## <a name="patching-with-least-privileged-user-accounts"></a><span data-ttu-id="c1292-190">Aplicar revisiones con cuentas de usuario de Least-Privileged</span><span class="sxs-lookup"><span data-stu-id="c1292-190">Patching with Least-Privileged User Accounts</span></span>

<span data-ttu-id="c1292-191">La revisión de un juego implica actualizar los archivos del juego.</span><span class="sxs-lookup"><span data-stu-id="c1292-191">Patching a game involves updating the game's files.</span></span> <span data-ttu-id="c1292-192">Por lo tanto, normalmente es necesario tener acceso de escritura a la carpeta de programas del juego.</span><span class="sxs-lookup"><span data-stu-id="c1292-192">Therefore, it usually requires write access to the game's program folder.</span></span> <span data-ttu-id="c1292-193">La aplicación de revisiones a un juego es un proceso sencillo cuando lo hace un administrador porque tienen acceso sin restricciones a la carpeta de programas del juego.</span><span class="sxs-lookup"><span data-stu-id="c1292-193">Patching a game is a straightforward process when it is done by an administrator because they have unrestricted access to the game's program folder.</span></span> <span data-ttu-id="c1292-194">Por el contrario, tradicionalmente ha sido difícil, si no imposible, para un usuario con menos privilegios para aplicar revisiones a los juegos debido a la restricción de acceso.</span><span class="sxs-lookup"><span data-stu-id="c1292-194">Conversely, it has traditionally been difficult, if not impossible, for a least privileged user to patch games because of the access restriction.</span></span> <span data-ttu-id="c1292-195">Ahora, se ha mejorado [Windows Installer](/windows/desktop/Msi/windows-installer-portal) para hacer posible la revisión de la cuenta de usuario con privilegios mínimos.</span><span class="sxs-lookup"><span data-stu-id="c1292-195">Now, [Windows Installer](/windows/desktop/Msi/windows-installer-portal) has been enhanced to make least-privileged user account patching possible.</span></span> <span data-ttu-id="c1292-196">Para aprovechar esta característica, se recomienda que los juegos utilicen Windows Installer para la instalación y la revisión.</span><span class="sxs-lookup"><span data-stu-id="c1292-196">To take advantage of this feature, games are encouraged to utilize Windows Installer for installation and patching.</span></span>

<span data-ttu-id="c1292-197">A partir de Windows Installer 3,0, los usuarios con menos privilegios pueden aplicar las revisiones de aplicación cuando se cumplen determinadas condiciones.</span><span class="sxs-lookup"><span data-stu-id="c1292-197">Starting with Windows Installer 3.0, application patches can be applied by least privileged users when certain conditions are met.</span></span> <span data-ttu-id="c1292-198">Estas condiciones son:</span><span class="sxs-lookup"><span data-stu-id="c1292-198">These conditions are:</span></span>

-   <span data-ttu-id="c1292-199">La aplicación se instaló con Windows Installer 3,0.</span><span class="sxs-lookup"><span data-stu-id="c1292-199">The application was installed using Windows Installer 3.0.</span></span>
-   <span data-ttu-id="c1292-200">La aplicación se instaló originalmente por equipo.</span><span class="sxs-lookup"><span data-stu-id="c1292-200">The application was originally installed per-machine.</span></span>
-   <span data-ttu-id="c1292-201">La aplicación se instala desde un medio extraíble, como un CD-ROM o un disco de vídeo digital (DVD).</span><span class="sxs-lookup"><span data-stu-id="c1292-201">The application is installed from removable media, such a CD-ROM or digital video disc (DVD).</span></span>
-   <span data-ttu-id="c1292-202">Las revisiones están firmadas digitalmente por un certificado identificado por el paquete del instalador original (archivo. msi).</span><span class="sxs-lookup"><span data-stu-id="c1292-202">The patches are digitally signed by a certificate that is identified by the original installer package (.msi file).</span></span>
-   <span data-ttu-id="c1292-203">Las revisiones se pueden validar con la firma digital.</span><span class="sxs-lookup"><span data-stu-id="c1292-203">The patches can be validated against the digital signature.</span></span>
-   <span data-ttu-id="c1292-204">El paquete del instalador original no ha deshabilitado la revisión de la cuenta de usuario con privilegios mínimos.</span><span class="sxs-lookup"><span data-stu-id="c1292-204">The original installer package has not disabled least-privileged user account patching.</span></span>
-   <span data-ttu-id="c1292-205">El administrador del sistema no ha deshabilitado la revisión de cuentas de usuario con privilegios mínimos a través de la Directiva del sistema.</span><span class="sxs-lookup"><span data-stu-id="c1292-205">The system administrator has not disabled least-privileged user account patching via system policy.</span></span>

<span data-ttu-id="c1292-206">Normalmente, un usuario con privilegios mínimos no puede modificar los archivos de programa de un juego.</span><span class="sxs-lookup"><span data-stu-id="c1292-206">Normally, a least privileged user cannot modify a game's program files.</span></span> <span data-ttu-id="c1292-207">Sin embargo, cuando se cumplen las condiciones anteriores y la revisión de LUA está habilitada, Windows Installer puede actualizar los archivos del juego para que el usuario obtenga la versión más reciente.</span><span class="sxs-lookup"><span data-stu-id="c1292-207">However, when the above conditions are met and LUA patching is enabled, Windows Installer can update the game's files so that the user gets the latest version.</span></span>

> [!Note]  
> <span data-ttu-id="c1292-208">La información contenida en este artículo se relaciona con el producto de software de versión preliminar, que puede modificarse sustancialmente antes de la primera versión comercial.</span><span class="sxs-lookup"><span data-stu-id="c1292-208">The information contained in this article relates to pre-release software product, which may be substantially modified before its first commercial release.</span></span> <span data-ttu-id="c1292-209">En consecuencia, es posible que la información no describa o refleje con precisión el producto de software cuando se lance por primera vez.</span><span class="sxs-lookup"><span data-stu-id="c1292-209">Accordingly, the information may not accurately describe or reflect the software product when first commercially released.</span></span> <span data-ttu-id="c1292-210">Este artículo se proporciona solo con fines informativos y Microsoft no otorga ninguna garantía, ni expresa ni implícita, con respecto a este artículo o la información que contiene.</span><span class="sxs-lookup"><span data-stu-id="c1292-210">This article is provided for informational purposes only, and Microsoft makes no warranties, express or implied, with respect to this article or the information contained in it.</span></span>

 

 

 