---
title: Notificaciones de cambio en Active Directory Domain Services
description: Active Directory Domain Services proporcionar un mecanismo para que una aplicación cliente se registre en un controlador de dominio para recibir notificaciones de cambios.
ms.assetid: 27f6c7c1-b32e-457a-9be5-47836d097ab1
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ee564727cfbcb2bfdb367f822fdc137bca7c4e37
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/17/2020
ms.locfileid: "104077562"
---
# <a name="change-notifications-in-active-directory-domain-services"></a><span data-ttu-id="b743a-103">Notificaciones de cambio en Active Directory Domain Services</span><span class="sxs-lookup"><span data-stu-id="b743a-103">Change Notifications in Active Directory Domain Services</span></span>

<span data-ttu-id="b743a-104">Active Directory Domain Services proporcionar un mecanismo para que una aplicación cliente se registre en un controlador de dominio para recibir notificaciones de cambios.</span><span class="sxs-lookup"><span data-stu-id="b743a-104">Active Directory Domain Services provide a mechanism for a client application to register with a domain controller to receive change notifications.</span></span> <span data-ttu-id="b743a-105">Para ello, el cliente especifica el control de notificación de cambio LDAP en una operación de búsqueda LDAP asincrónica.</span><span class="sxs-lookup"><span data-stu-id="b743a-105">To do this, the client specifies the LDAP change notification control in an asynchronous LDAP search operation.</span></span> <span data-ttu-id="b743a-106">El cliente también especifica los siguientes parámetros de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b743a-106">The client also specifies the following search parameters.</span></span>



| <span data-ttu-id="b743a-107">Parámetro</span><span class="sxs-lookup"><span data-stu-id="b743a-107">Parameter</span></span>             | <span data-ttu-id="b743a-108">Descripción</span><span class="sxs-lookup"><span data-stu-id="b743a-108">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|-----------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="b743a-109">Ámbito</span><span class="sxs-lookup"><span data-stu-id="b743a-109">Scope</span></span><br/>      | <span data-ttu-id="b743a-110">Especifique una **\_ \_ base de ámbito LDAP** para supervisar solo el objeto o **el \_ ámbito LDAP \_ onelevel** para supervisar los elementos secundarios inmediatos del objeto, sin incluir el propio objeto.</span><span class="sxs-lookup"><span data-stu-id="b743a-110">Specify either **LDAP\_SCOPE\_BASE** to monitor just the object, or **LDAP\_SCOPE\_ONELEVEL** to monitor the immediate children of the object, not including the object itself.</span></span> <span data-ttu-id="b743a-111">No especifique el **\_ \_ subárbol del ámbito LDAP**.</span><span class="sxs-lookup"><span data-stu-id="b743a-111">Do not specify **LDAP\_SCOPE\_SUBTREE**.</span></span> <span data-ttu-id="b743a-112">Aunque se admite el ámbito de subárbol si el objeto base es la raíz de un contexto de nomenclatura, su uso puede afectar gravemente al rendimiento del servidor, ya que genera un mensaje de resultado de búsqueda LDAP cada vez que se modifica un objeto en el contexto de nomenclatura.</span><span class="sxs-lookup"><span data-stu-id="b743a-112">Although the subtree scope is supported if the base object is the root of a naming context, its use can severely impact server performance, because it generates an LDAP search result message every time an object in the naming context is modified.</span></span> <span data-ttu-id="b743a-113">No se puede especificar el **\_ \_ subárbol de ámbito LDAP** para un subárbol arbitrario.</span><span class="sxs-lookup"><span data-stu-id="b743a-113">You cannot specify **LDAP\_SCOPE\_SUBTREE** for an arbitrary subtree.</span></span><br/> |
| <span data-ttu-id="b743a-114">Filter</span><span class="sxs-lookup"><span data-stu-id="b743a-114">Filter</span></span><br/>     | <span data-ttu-id="b743a-115">Especifique un filtro de búsqueda de "(objectClass = \* )", lo que significa que recibirá notificaciones de cambios en cualquier objeto del ámbito especificado.</span><span class="sxs-lookup"><span data-stu-id="b743a-115">Specify a search filter of "(objectclass=\*)", which means you receive notifications for changes to any object in the specified scope.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="b743a-116">Atributos</span><span class="sxs-lookup"><span data-stu-id="b743a-116">Attributes</span></span><br/> | <span data-ttu-id="b743a-117">Especifique una lista de atributos que se devolverán cuando se produzca un cambio.</span><span class="sxs-lookup"><span data-stu-id="b743a-117">Specify a list of attributes to return when a change occurs.</span></span> <span data-ttu-id="b743a-118">Tenga en cuenta que recibirá notificaciones cuando se modifique algún atributo, no solo los atributos especificados.</span><span class="sxs-lookup"><span data-stu-id="b743a-118">Be aware that you receive notifications when any attribute is modified, not just the specified attributes.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                               |



 

<span data-ttu-id="b743a-119">Puede registrar hasta cinco solicitudes de notificación en una única conexión LDAP.</span><span class="sxs-lookup"><span data-stu-id="b743a-119">You can register up to five notification requests on a single LDAP connection.</span></span> <span data-ttu-id="b743a-120">Debe tener un subproceso dedicado que espera las notificaciones y las procesa rápidamente.</span><span class="sxs-lookup"><span data-stu-id="b743a-120">You must have a dedicated thread that waits for the notifications and processes them quickly.</span></span> <span data-ttu-id="b743a-121">Cuando se llama a la \_ función ext de búsqueda LDAP \_ para registrar una solicitud de notificación, la función devuelve un identificador de mensaje que identifica esa solicitud.</span><span class="sxs-lookup"><span data-stu-id="b743a-121">When you call the ldap\_search\_ext function to register a notification request, the function returns a message identifier that identifies that request.</span></span> <span data-ttu-id="b743a-122">A continuación, se usa la función de [**\_ resultado LDAP**](/previous-versions/windows/desktop/api/winldap/nf-winldap-ldap_result) para esperar las notificaciones de cambio.</span><span class="sxs-lookup"><span data-stu-id="b743a-122">You then use the [**ldap\_result**](/previous-versions/windows/desktop/api/winldap/nf-winldap-ldap_result) function to wait for change notifications.</span></span> <span data-ttu-id="b743a-123">Cuando se produce un cambio, el servidor envía un mensaje LDAP que contiene el identificador de mensaje para la solicitud de notificación que generó la notificación.</span><span class="sxs-lookup"><span data-stu-id="b743a-123">When a change occurs, the server sends you an LDAP message that contains the message identifier for the notification request that generated the notification.</span></span> <span data-ttu-id="b743a-124">Esto hace que la función de **\_ resultado LDAP** devuelva los resultados de búsqueda que identifican el objeto que ha cambiado.</span><span class="sxs-lookup"><span data-stu-id="b743a-124">This causes the **ldap\_result** function to return with search results that identify the object that changed.</span></span>

<span data-ttu-id="b743a-125">La aplicación cliente debe determinar el estado inicial del objeto supervisado.</span><span class="sxs-lookup"><span data-stu-id="b743a-125">The client application must determine the initial state of the object monitored.</span></span> <span data-ttu-id="b743a-126">Para ello, primero debe registrar la solicitud de notificación y luego leer el estado actual.</span><span class="sxs-lookup"><span data-stu-id="b743a-126">To do this, you must first register the notification request and then read the current state.</span></span>

<span data-ttu-id="b743a-127">La aplicación cliente también debe determinar la causa del cambio.</span><span class="sxs-lookup"><span data-stu-id="b743a-127">The client application must also determine the cause of the change.</span></span> <span data-ttu-id="b743a-128">En una búsqueda de nivel base, se produce una notificación cuando cambia cualquier atributo o cuando se elimina o se mueve el objeto.</span><span class="sxs-lookup"><span data-stu-id="b743a-128">For a base level search, a notification occurs when any attribute changes, or when the object is deleted or moved.</span></span> <span data-ttu-id="b743a-129">En una búsqueda de un solo nivel, se produce una notificación cuando se crea, se elimina, se mueve o se modifica un objeto secundario.</span><span class="sxs-lookup"><span data-stu-id="b743a-129">For a one-level search, a notification occurs when a child object is created, deleted, moved, or modified.</span></span> <span data-ttu-id="b743a-130">Tenga en cuenta que al mover o cambiar el nombre de un objeto en la jerarquía sobre un objeto de destino, no se genera una notificación aunque el nombre distintivo del destino cambie como resultado.</span><span class="sxs-lookup"><span data-stu-id="b743a-130">Be aware that moving or renaming an object in the hierarchy above a target object does not generate a notification even though the distinguished name of the target changed as a result.</span></span> <span data-ttu-id="b743a-131">Por ejemplo, si supervisa los cambios en los objetos secundarios de un contenedor, no recibirá notificaciones si el propio contenedor se mueve o se cambia de nombre.</span><span class="sxs-lookup"><span data-stu-id="b743a-131">For example, if monitoring changes to the child objects in a container, you will not receive notifications if the container itself is moved or renamed.</span></span>

<span data-ttu-id="b743a-132">Cuando el cliente procesa los resultados de la búsqueda, puede usar la \_ función LDAP Get \_ DN para obtener el nombre distintivo del objeto que cambió.</span><span class="sxs-lookup"><span data-stu-id="b743a-132">When the client processes the search results, it can use the ldap\_get\_dn function to get the distinguished name of the object that changed.</span></span> <span data-ttu-id="b743a-133">No confíe en nombres distintivos para identificar los objetos de los que se realiza un seguimiento, ya que los nombres distintivos pueden cambiar.</span><span class="sxs-lookup"><span data-stu-id="b743a-133">Do not rely on distinguished names to identify the objects tracked, because distinguished names can change.</span></span> <span data-ttu-id="b743a-134">En su lugar, incluya el atributo **objectGUID** en la lista de atributos que se van a recuperar.</span><span class="sxs-lookup"><span data-stu-id="b743a-134">Instead, include the **objectGUID** attribute in the list of attributes to retrieve.</span></span> <span data-ttu-id="b743a-135">**ObjectGUID** de cada objeto permanece sin modificar, independientemente de dónde se mueva el objeto dentro del bosque de la empresa.</span><span class="sxs-lookup"><span data-stu-id="b743a-135">Each object's **objectGUID** remains unchanged regardless of where the object is moved within the enterprise forest.</span></span>

<span data-ttu-id="b743a-136">Si se elimina un objeto dentro del ámbito de búsqueda, el cliente recibe una notificación de cambio y el atributo **IsDeleted** del objeto se establece en **true**.</span><span class="sxs-lookup"><span data-stu-id="b743a-136">If an object within the search scope is deleted, the client receives a change notification and the **isDeleted** attribute of the object is set to **TRUE**.</span></span> <span data-ttu-id="b743a-137">En este caso, los resultados de la búsqueda informan del nuevo nombre distintivo del objeto en el contenedor de objetos eliminados de su partición.</span><span class="sxs-lookup"><span data-stu-id="b743a-137">In this case, the search results report the new distinguished name of the object in the Deleted Objects container of its partition.</span></span> <span data-ttu-id="b743a-138">No es necesario especificar el control de marcadores de exclusión ([ \_ servidor LDAP \_ Mostrar \_ \_ OID eliminado](/previous-versions/windows/desktop/ldap/ldap-server-show-deleted-oid)) para obtener notificaciones de eliminaciones de objetos.</span><span class="sxs-lookup"><span data-stu-id="b743a-138">It is not necessary to specify the tombstone control ([LDAP\_SERVER\_SHOW\_DELETED\_OID](/previous-versions/windows/desktop/ldap/ldap-server-show-deleted-oid)) to get notifications of object deletions.</span></span> <span data-ttu-id="b743a-139">Para obtener más información, vea [recuperar objetos eliminados](retrieving-deleted-objects.md).</span><span class="sxs-lookup"><span data-stu-id="b743a-139">For more information, see [Retrieving Deleted Objects](retrieving-deleted-objects.md).</span></span>

<span data-ttu-id="b743a-140">Cuando un cliente ha registrado una solicitud de notificación, el cliente sigue recibiendo notificaciones hasta que se interrumpe la conexión o el cliente abandona la búsqueda mediante una llamada a la \_ función de abandono de LDAP.</span><span class="sxs-lookup"><span data-stu-id="b743a-140">When a client has registered a notification request, the client continues to receive notifications until the connection is broken or the client abandons the search by calling the ldap\_abandon function.</span></span> <span data-ttu-id="b743a-141">Si el cliente o el servidor se desconectan, por ejemplo, si se produce un error en el servidor, se finaliza la solicitud de notificación.</span><span class="sxs-lookup"><span data-stu-id="b743a-141">If the client or server disconnects, for example, if the server fails, the notification request is terminated.</span></span> <span data-ttu-id="b743a-142">Cuando el cliente se vuelve a conectar, debe registrarse para recibir notificaciones de nuevo y, a continuación, leer el estado actual de los objetos de interés en caso de que se hayan producido cambios mientras se desconectó el cliente.</span><span class="sxs-lookup"><span data-stu-id="b743a-142">When the client reconnects, it must register for notifications again, and then read the current state of the objects of interest in case there were changes while the client was disconnected.</span></span>

<span data-ttu-id="b743a-143">El cliente puede utilizar el valor del atributo **uSNChanged** de un objeto para determinar si el estado actual del objeto en el servidor refleja los cambios más recientes que el cliente ha recibido.</span><span class="sxs-lookup"><span data-stu-id="b743a-143">The client can use the value of an object's **uSNChanged** attribute to determine whether the current state of the object on the server reflects the latest changes that the client has received.</span></span> <span data-ttu-id="b743a-144">El sistema aumenta el atributo **uSNChanged** de un objeto cuando se mueve o se modifica el objeto.</span><span class="sxs-lookup"><span data-stu-id="b743a-144">The system increases an object's **uSNChanged** attribute when the object is moved or modified.</span></span> <span data-ttu-id="b743a-145">Por ejemplo, si se produce un error en el servidor y la partición de directorio se restaura a partir de una copia de seguridad, es posible que la réplica del servidor de un objeto no refleje los cambios previamente comunicados al cliente, en cuyo caso el valor de **uSNChanged** en el servidor será menor que el valor almacenado por el cliente.</span><span class="sxs-lookup"><span data-stu-id="b743a-145">For example, if the server fails and the directory partition is restored from a backup, the server's replica of an object may not reflect changes previously reported to the client, in which case the **uSNChanged** value on the server will be lower than the value stored by the client.</span></span>

<span data-ttu-id="b743a-146">Para obtener más información y un ejemplo de código que usa el control de notificación de cambios de LDAP en una operación de búsqueda LDAP asincrónica, vea el [código de ejemplo para recibir notificaciones de cambios](example-code-for-receiving-change-notifications.md).</span><span class="sxs-lookup"><span data-stu-id="b743a-146">For more information and a code example that uses the LDAP change notification control in an asynchronous LDAP search operation, see [Example Code for Receiving Change Notifications](example-code-for-receiving-change-notifications.md).</span></span>

<span data-ttu-id="b743a-147">Para obtener más información acerca de Cuándo usar el control de notificación de cambios de LDAP, vea [información general sobre las técnicas de Change Tracking](overview-of-change-tracking-techniques.md).</span><span class="sxs-lookup"><span data-stu-id="b743a-147">For more information about when to use the LDAP change notification control, see [Overview of Change Tracking Techniques](overview-of-change-tracking-techniques.md).</span></span>

 

