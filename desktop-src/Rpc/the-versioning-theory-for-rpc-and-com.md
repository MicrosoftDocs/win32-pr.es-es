---
title: La teoría de control de versiones de RPC y COM
description: Teoría de control de versiones para llamada a procedimiento remoto (RPC) y COM.
ms.assetid: c4df0a7b-e1be-481d-9149-317ffc9179b9
keywords:
- RPC llamada a procedimiento remoto, prácticas recomendadas, control de versiones
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7e03b23c91bf69fbc3c4f72366b80812fd54330d
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104149512"
---
# <a name="the-versioning-theory-for-rpc-and-com"></a><span data-ttu-id="1050a-104">La teoría de control de versiones de RPC y COM</span><span class="sxs-lookup"><span data-stu-id="1050a-104">The Versioning Theory for RPC and COM</span></span>

<span data-ttu-id="1050a-105">Solo dos métodos completamente infalibles admiten nuevas funcionalidades sin riesgo de problemas de compatibilidad de conexión:</span><span class="sxs-lookup"><span data-stu-id="1050a-105">Only two completely foolproof methods support new functionality without risk of wire compatibility problems:</span></span>

-   <span data-ttu-id="1050a-106">Cambie la versión de la interfaz de acuerdo con las reglas. Esto impide que los nuevos clientes se comuniquen con un servidor antiguo y puede o no impedir que un cliente anterior se comunique con el nuevo servidor.</span><span class="sxs-lookup"><span data-stu-id="1050a-106">Change the interface version according to the rules; this prevents new clients from communicating with an old server, and may or may not prevent an old client from communicating with the new server.</span></span> <span data-ttu-id="1050a-107">Esto se aclara más adelante en esta sección.</span><span class="sxs-lookup"><span data-stu-id="1050a-107">This is clarified later in this section.</span></span>
-   <span data-ttu-id="1050a-108">Introduzca una interfaz diferente que trabaje con la nueva funcionalidad.</span><span class="sxs-lookup"><span data-stu-id="1050a-108">Introduce a different interface dealing with the new functionality.</span></span>

<span data-ttu-id="1050a-109">Una interfaz RPC estándar se identifica mediante una combinación de número de versión y GUID; una interfaz COM se identifica mediante su GUID.</span><span class="sxs-lookup"><span data-stu-id="1050a-109">A standard RPC interface is identified by a GUID and version number combination; a COM interface is identified by its GUID.</span></span> <span data-ttu-id="1050a-110">La versión consta de las partes principales y secundarias.</span><span class="sxs-lookup"><span data-stu-id="1050a-110">The version consists of major and minor parts.</span></span> <span data-ttu-id="1050a-111">En el caso de las interfaces estándar con el mismo GUID y distintos números de versión, una conexión solo es posible cuando la versión principal es la misma y el cliente no es más alto que la versión secundaria del servidor.</span><span class="sxs-lookup"><span data-stu-id="1050a-111">For standard interfaces with the same GUID and different version numbers, a connection is possible only when the major version is the same, and the client is not higher than the minor version of the server.</span></span>

<span data-ttu-id="1050a-112">Una consecuencia es que cambiar el GUID de la interfaz RPC interrumpe la compatibilidad de conexión, mientras que cambiar el nombre de la interfaz no.</span><span class="sxs-lookup"><span data-stu-id="1050a-112">A consequence is that changing the RPC interface GUID breaks wire compatibility, while changing the interface name does not.</span></span>

<span data-ttu-id="1050a-113">En RPC estándar, una ruta de acceso para las actualizaciones y extensiones está bien definida y, básicamente, requiere que los nuevos métodos se agreguen al final de la interfaz, y que los nuevos tipos se usen solo en los nuevos métodos.</span><span class="sxs-lookup"><span data-stu-id="1050a-113">In standard RPC, a path for upgrades and extensions is well defined, and basically requires that new methods only be added at the end of the interface, and new types be used only in the new methods.</span></span> <span data-ttu-id="1050a-114">Si se necesitan estas adiciones, se debe aumentar la versión secundaria.</span><span class="sxs-lookup"><span data-stu-id="1050a-114">If such additions are needed, the minor version must be increased.</span></span> <span data-ttu-id="1050a-115">Cualquier otro cambio requiere un cambio en la versión principal, ya que el software de cliente y servidor sería incompatible en la conexión.</span><span class="sxs-lookup"><span data-stu-id="1050a-115">Any other change requires a change in the major version, because the client and server software would be incompatible on the wire.</span></span> <span data-ttu-id="1050a-116">Al cumplir estas reglas, se asegura siempre que haya una conexión entre un cliente nuevo y un servidor anterior, o viceversa, ambos lados son totalmente compatibles.</span><span class="sxs-lookup"><span data-stu-id="1050a-116">Adhering to these rules assures whenever there is a connection between a new client and old server, or vice-versa, both sides are fully compatible.</span></span>

<span data-ttu-id="1050a-117">En el caso de una interfaz COM, no se puede usar el atributo version.</span><span class="sxs-lookup"><span data-stu-id="1050a-117">For a COM interface, the version attribute cannot be used.</span></span> <span data-ttu-id="1050a-118">Crear nuevas interfaces y heredar de las interfaces antiguas es equivalente a manipular la versión en RPC.</span><span class="sxs-lookup"><span data-stu-id="1050a-118">Creating new interfaces and inheriting from the old interfaces is an equivalent of manipulating the version in RPC.</span></span> <span data-ttu-id="1050a-119">Normalmente, el mejor enfoque en COM es crear una nueva interfaz para la funcionalidad expandida.</span><span class="sxs-lookup"><span data-stu-id="1050a-119">Typically, the best approach in COM is to create a new interface for the expanded functionality.</span></span> <span data-ttu-id="1050a-120">Un equivalente de la versión secundaria es la nueva interfaz que hereda de la antigua.</span><span class="sxs-lookup"><span data-stu-id="1050a-120">An equivalent of the minor version is the new interface inheriting from the old one.</span></span> <span data-ttu-id="1050a-121">Cambiar los métodos anteriores o los tipos de datos antiguos requiere una interfaz COM completamente nueva, que es una interfaz que no se hereda de la antigua.</span><span class="sxs-lookup"><span data-stu-id="1050a-121">Changing old methods or old data types requires an entirely new COM interface—an interface that does not inherit from the old one.</span></span>

<span data-ttu-id="1050a-122">En el caso de COM, la función [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) es un método establecido para comprobar si un servidor admite una interfaz; por lo tanto, las situaciones en las que un cliente puede comunicarse con una versión anterior o una nueva de una interfaz se pueden resolver fácilmente.</span><span class="sxs-lookup"><span data-stu-id="1050a-122">For COM, the [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) function is an established method of checking whether a server supports an interface; hence, the situations where a client can talk to an old or a new version of an interface can be easily resolved.</span></span>

 

 