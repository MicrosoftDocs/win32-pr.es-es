---
description: A continuación se describe cómo crear un paquete de Windows Installer para instalar un ensamblado Win32.
ms.assetid: 1234e904-fc7f-4eb7-8c50-0c959bbf5261
title: Instalación de ensamblados Win32 para el uso compartido en paralelo
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ea72c9bcb7bd85ac38dfc8857030d6b9d6afbf23
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "105688450"
---
# <a name="installing-win32-assemblies-for-side-by-side-sharing"></a><span data-ttu-id="135ed-103">Instalación de ensamblados Win32 para el uso compartido en paralelo</span><span class="sxs-lookup"><span data-stu-id="135ed-103">Installing Win32 Assemblies for Side-by-Side Sharing</span></span>

<span data-ttu-id="135ed-104">A continuación se describe cómo crear un paquete de Windows Installer para instalar un ensamblado Win32.</span><span class="sxs-lookup"><span data-stu-id="135ed-104">The following describes how to create a Windows Installer package to install a Win32 assembly.</span></span> <span data-ttu-id="135ed-105">El paquete instala un ensamblado en paralelo en la carpeta WinSxS para el uso compartido de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="135ed-105">The package installs a side-by-side assembly in the Winsxs folder for the shared use of the application.</span></span> <span data-ttu-id="135ed-106">Después de instalar el paquete, el ensamblado compartido está disponible globalmente para cualquier aplicación que especifique una dependencia en el ensamblado en un archivo de manifiesto del ensamblado.</span><span class="sxs-lookup"><span data-stu-id="135ed-106">After installing the package, the shared assembly is globally available to any application that specifies a dependence on the assembly in an assembly manifest file.</span></span> <span data-ttu-id="135ed-107">El instalador no registra globalmente el ensamblado en paralelo en el sistema.</span><span class="sxs-lookup"><span data-stu-id="135ed-107">The installer does not globally register the side-by-side assembly on the system.</span></span>

<span data-ttu-id="135ed-108">Tenga en cuenta que puede instalar ensamblados en paralelo compartidos mediante [módulos de combinación](merge-modules.md).</span><span class="sxs-lookup"><span data-stu-id="135ed-108">Note that you may install shared side-by-side assemblies using [merge modules](merge-modules.md).</span></span>

<span data-ttu-id="135ed-109">Antes de continuar, debe comprender cómo crear un paquete de Windows Installer sin ensamblados.</span><span class="sxs-lookup"><span data-stu-id="135ed-109">Before continuing you should understand how to author a Windows Installer package without assemblies.</span></span> <span data-ttu-id="135ed-110">Para obtener un ejemplo de cómo crear una instalación simple, vea [un ejemplo de instalación](an-installation-example.md).</span><span class="sxs-lookup"><span data-stu-id="135ed-110">For an example of how to author a simple installation, see [An Installation Example](an-installation-example.md).</span></span>

<span data-ttu-id="135ed-111">**Para instalar un ensamblado compartido en paralelo**</span><span class="sxs-lookup"><span data-stu-id="135ed-111">**To install a shared assembly side-by-side**</span></span>

1.  <span data-ttu-id="135ed-112">Defina un componente de Windows Installer que incluya el ensamblado Win32.</span><span class="sxs-lookup"><span data-stu-id="135ed-112">Define a Windows Installer component that includes the Win32 assembly.</span></span> <span data-ttu-id="135ed-113">Este componente puede contener otros recursos que se deben instalar o quitar siempre con el ensamblado.</span><span class="sxs-lookup"><span data-stu-id="135ed-113">This component may contain other resources that should always be installed or removed with the assembly.</span></span> <span data-ttu-id="135ed-114">Todos los demás componentes de la aplicación se pueden crear como para una instalación sin ensamblados.</span><span class="sxs-lookup"><span data-stu-id="135ed-114">All the other components of the application can be authored just as for an installation without assemblies.</span></span> <span data-ttu-id="135ed-115">Agregue una fila a la [tabla de componentes](component-table.md) del componente que contiene el ensamblado Win32.</span><span class="sxs-lookup"><span data-stu-id="135ed-115">Add a row to the [Component table](component-table.md) for the component containing the Win32 assembly.</span></span> <span data-ttu-id="135ed-116">Escriba un [GUID](guid.md) de Windows Installer válido para este código de componente.</span><span class="sxs-lookup"><span data-stu-id="135ed-116">Enter a valid Windows Installer [GUID](guid.md) for this component code.</span></span> <span data-ttu-id="135ed-117">No use el archivo de manifiesto como la ruta de acceso de la clave para este componente.</span><span class="sxs-lookup"><span data-stu-id="135ed-117">Do not use the manifest file as the key path for this component.</span></span>
2.  <span data-ttu-id="135ed-118">Agregue una fila a la [tabla FeatureComponents](featurecomponents-table.md) que asocia el componente a una característica Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="135ed-118">Add a row to the [FeatureComponents table](featurecomponents-table.md) tying the component to a Windows Installer feature.</span></span> <span data-ttu-id="135ed-119">Para obtener información, vea [componentes y características](components-and-features.md).</span><span class="sxs-lookup"><span data-stu-id="135ed-119">For information see, [Components and Features](components-and-features.md).</span></span> <span data-ttu-id="135ed-120">Una característica Windows Installer debe ser una parte de la funcionalidad de la aplicación que sea reconocible para un usuario.</span><span class="sxs-lookup"><span data-stu-id="135ed-120">A Windows Installer feature should be a piece of the application's functionality that is recognizable to a user.</span></span> <span data-ttu-id="135ed-121">El ensamblado se activa cuando el usuario selecciona esta característica o la aplicación produce un error.</span><span class="sxs-lookup"><span data-stu-id="135ed-121">The assembly is activated when this feature is selected by a user or faulted in by an application.</span></span> <span data-ttu-id="135ed-122">Si el ensamblado define una característica adicional, agregue una fila adicional a la [tabla de características](feature-table.md) para los atributos de la característica.</span><span class="sxs-lookup"><span data-stu-id="135ed-122">If the assembly defines an additional feature, then add an additional row to the [Feature table](feature-table.md) for the feature's attributes.</span></span> <span data-ttu-id="135ed-123">Este paso no es necesario cuando se crea un módulo de combinación.</span><span class="sxs-lookup"><span data-stu-id="135ed-123">This step is not needed when authoring a merge module.</span></span>
3.  <span data-ttu-id="135ed-124">En el caso de los ensamblados en paralelo, la información de enlace y activación, como las clases COM, las interfaces y las bibliotecas de tipos, se almacena en archivos de manifiesto en lugar de en el registro.</span><span class="sxs-lookup"><span data-stu-id="135ed-124">For side-by-side assemblies, binding and activation information, such as COM classes, interfaces, and type libraries, is stored in manifest files rather than the registry.</span></span> <span data-ttu-id="135ed-125">Los ensamblados compartidos almacenan esta información en un manifiesto del ensamblado.</span><span class="sxs-lookup"><span data-stu-id="135ed-125">Shared assemblies store this information in an assembly manifest.</span></span> <span data-ttu-id="135ed-126">En los sistemas que admiten ensamblados en paralelo, el instalador omite el procesamiento de toda la información sobre el componente especificado en la tabla de [extensión](extension-table.md), la [tabla de verbos](verb-table.md), la [tabla typelib](typelib-table.md), la [tabla MIME](mime-table.md), la tabla de [clases](class-table.md), la [tabla ProgID](progid-table.md)y la [tabla AppID](appid-table.md).</span><span class="sxs-lookup"><span data-stu-id="135ed-126">On systems that support side-by-side assemblies, the installer skips processing any information about the component entered in the [Extension table](extension-table.md), [Verb table](verb-table.md), [TypeLib table](typelib-table.md), [MIME table](mime-table.md), [Class table](class-table.md), [ProgId table](progid-table.md), and [AppId table](appid-table.md).</span></span> <span data-ttu-id="135ed-127">La información de enlace y activación se puede incluir en estas tablas para que las usen los sistemas que no admiten el uso compartido de ensamblados en paralelo.</span><span class="sxs-lookup"><span data-stu-id="135ed-127">Binding and activation information may be entered into these tables for use by systems that do not support side-by-side assembly sharing.</span></span>
4.  <span data-ttu-id="135ed-128">La instalación en paralelo no registra el ensamblado globalmente, el instalador omite el registro automático del componente si se ha especificado información de registro automático en la [tabla SelfReg](selfreg-table.md).</span><span class="sxs-lookup"><span data-stu-id="135ed-128">Side-by-side installation does not globally register the assembly, the installer skips self-registering the component if any self-registration information has been entered in the [SelfReg table](selfreg-table.md).</span></span> <span data-ttu-id="135ed-129">La información de registro automático se puede escribir en la tabla SelfReg para el registro automático del componente en sistemas que no admiten el uso compartido de ensamblados en paralelo.</span><span class="sxs-lookup"><span data-stu-id="135ed-129">Self-registration information may be entered into the SelfReg table for self-registration of the component on systems that do not support side-by-side assembly sharing.</span></span>
5.  <span data-ttu-id="135ed-130">Agregue cualquier otra información del registro, exclusiva del enlace y activación o el registro automático del componente, a la tabla [del registro](registry-table.md), la [tabla RemoveRegistry](removeregistry-table.md)y la [tabla de entorno](environment-table.md).</span><span class="sxs-lookup"><span data-stu-id="135ed-130">Add any other registry information, exclusive of binding and activation or self-registration of the component, to the [Registry table](registry-table.md), [RemoveRegistry table](removeregistry-table.md), and [Environment table](environment-table.md).</span></span>
6.  <span data-ttu-id="135ed-131">Dado que se trata de un ensamblado compartido, no se genera un archivo. local.</span><span class="sxs-lookup"><span data-stu-id="135ed-131">Because this is a shared assembly do not generate a .local file.</span></span> <span data-ttu-id="135ed-132">No incluya información para este componente en la [tabla IsolatedComponent](isolatedcomponent-table.md).</span><span class="sxs-lookup"><span data-stu-id="135ed-132">Do not include information for this component in the [IsolatedComponent table](isolatedcomponent-table.md).</span></span> <span data-ttu-id="135ed-133">El instalador omite la tabla IsolatedComponent para este componente en los sistemas operativos que admiten el uso compartido en paralelo.</span><span class="sxs-lookup"><span data-stu-id="135ed-133">The installer skips the IsolatedComponent table for this component on operating systems that support side-by-side sharing.</span></span> <span data-ttu-id="135ed-134">Agregue información a la tabla IsolatedComponent si desea que el ensamblado sea privado en los sistemas que admiten archivos. local.</span><span class="sxs-lookup"><span data-stu-id="135ed-134">Add information to the IsolatedComponent table if you would like the assembly to be private on systems that support .local files.</span></span>
7.  <span data-ttu-id="135ed-135">Para habilitar el uso compartido simultáneo, el ensamblado Win32 debe instalarse en la carpeta WinSxS.</span><span class="sxs-lookup"><span data-stu-id="135ed-135">To enable side-by-side sharing, the Win32 assembly must be installed into the Winsxs folder.</span></span> <span data-ttu-id="135ed-136">Esto se logra al mantener la \_ columna de aplicación de archivo de la [tabla MsiAssembly](msiassembly-table.md) null para el ensamblado.</span><span class="sxs-lookup"><span data-stu-id="135ed-136">This is accomplished by leaving the File\_Application column of the [MsiAssembly table](msiassembly-table.md) null for the assembly.</span></span> <span data-ttu-id="135ed-137">Esto indica al instalador que instale el ensamblado en la carpeta WinSxS, en lugar de en la carpeta del componente.</span><span class="sxs-lookup"><span data-stu-id="135ed-137">This tells the installer to install the assembly to the WinSxS folder, instead of to the folder of the component.</span></span> <span data-ttu-id="135ed-138">Agregue una fila a la [tabla MsiAssembly](msiassembly-table.md) para el componente que contiene el ensamblado Win32.</span><span class="sxs-lookup"><span data-stu-id="135ed-138">Add a row to the [MsiAssembly table](msiassembly-table.md) for the component that contains the Win32 assembly.</span></span> <span data-ttu-id="135ed-139">Escriba un valor de 1 en el campo atributos de la tabla MsiAssembly para especificar que se trata de un ensamblado Win32.</span><span class="sxs-lookup"><span data-stu-id="135ed-139">Enter a value of 1 in the Attributes field of the MsiAssembly table to specify that this is a Win32 assembly.</span></span> <span data-ttu-id="135ed-140">Para un ensamblado compartido, deje vacío el campo de la aplicación de archivo \_ .</span><span class="sxs-lookup"><span data-stu-id="135ed-140">For a shared assembly, leave the File\_Application field empty.</span></span> <span data-ttu-id="135ed-141">Agregue la [acción MsiPublishAssemblies](msipublishassemblies-action.md) a la [tabla InstallExecuteSequence](installexecutesequence-table.md) o a la [tabla AdvtExecuteSequence](advtexecutesequence-table.md).</span><span class="sxs-lookup"><span data-stu-id="135ed-141">Add the [MsiPublishAssemblies action](msipublishassemblies-action.md) to the [InstallExecuteSequence table](installexecutesequence-table.md) or [AdvtExecuteSequence table](advtexecutesequence-table.md).</span></span> <span data-ttu-id="135ed-142">Agregue la [acción MsiUnpublishAssemblies](msiunpublishassemblies-action.md) a la tabla InstallExecuteSequence.</span><span class="sxs-lookup"><span data-stu-id="135ed-142">Add the [MsiUnpublishAssemblies action](msiunpublishassemblies-action.md) to the InstallExecuteSequence table.</span></span>
8.  <span data-ttu-id="135ed-143">Agregue filas a la [tabla MsiAssemblyName](msiassemblyname-table.md) para el componente.</span><span class="sxs-lookup"><span data-stu-id="135ed-143">Add rows to the [MsiAssemblyName table](msiassemblyname-table.md) for the component.</span></span> <span data-ttu-id="135ed-144">Agregue una fila para cada par de nombre y valor especificado en la sección assemblyIdentity del manifiesto.</span><span class="sxs-lookup"><span data-stu-id="135ed-144">Add one row for each name and value pair specified in the assemblyIdentity section of the manifest.</span></span> <span data-ttu-id="135ed-145">Para ver un ejemplo, consulte la [tabla MsiAssemblyName](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="135ed-145">For an example, see [MsiAssemblyName table](msiassemblyname-table.md).</span></span>

 

 



