---
description: 'En esta sección se enumera una lista de sugerencias, vinculadas a la documentación principal del SDK de Windows Installer, para ayudar a los desarrolladores de aplicaciones, los autores de la instalación, los profesionales de ti y los desarrolladores de infraestructura a detectar los procedimientos recomendados para usar el Windows Installer:'
ms.assetid: ff48d995-fe6f-4d1b-898d-67574ed3c5b7
title: Procedimientos recomendados de Windows Installer
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0ffaf6aae83afbe510f2b1eefc447e34754296ba
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "104082921"
---
# <a name="windows-installer-best-practices"></a><span data-ttu-id="04940-103">Procedimientos recomendados de Windows Installer</span><span class="sxs-lookup"><span data-stu-id="04940-103">Windows Installer Best Practices</span></span>

<span data-ttu-id="04940-104">En esta sección se enumera una lista de sugerencias, vinculadas a la documentación principal del SDK de Windows Installer, para ayudar a los desarrolladores de aplicaciones, los autores de la instalación, los profesionales de ti y los desarrolladores de infraestructura a detectar los procedimientos recomendados para usar el Windows Installer:</span><span class="sxs-lookup"><span data-stu-id="04940-104">This section enumerates a list of tips, linked to the main Windows Installer SDK documentation, to help Application Developers, Setup Authors, IT Professionals, and Infrastructure Developers discover best practices for using the Windows Installer:</span></span>

-   [<span data-ttu-id="04940-105">Actualice la versión de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="04940-105">Update the Windows Installer version.</span></span>](#update-the-windows-installer-version)
-   [<span data-ttu-id="04940-106">Cumplir los requisitos de certificación del logotipo de Windows.</span><span class="sxs-lookup"><span data-stu-id="04940-106">Meet the Windows Logo certification requirements.</span></span>](#meet-the-windows-logo-certification-requirements)
-   [<span data-ttu-id="04940-107">Preparar el paquete para la localización.</span><span class="sxs-lookup"><span data-stu-id="04940-107">Prepare the package for localization.</span></span>](#prepare-the-package-for-localization)
-   [<span data-ttu-id="04940-108">Actualice la documentación y las herramientas de desarrollo de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="04940-108">Update your Windows Installer development tools and documentation.</span></span>](#update-your-windows-installer-development-tools-and-documentation)
-   [<span data-ttu-id="04940-109">Si decide volver a empaquetar una aplicación de instalación heredada, siga las prácticas recomendadas para el empaquetado.</span><span class="sxs-lookup"><span data-stu-id="04940-109">If you decide to repackage a legacy setup application, follow good repackaging practices.</span></span>](#if-you-decide-to-repackage-a-legacy-setup-application-follow-good-repackaging-practices)
-   [<span data-ttu-id="04940-110">No intente reemplazar los recursos protegidos.</span><span class="sxs-lookup"><span data-stu-id="04940-110">Do not try to replace protected resources.</span></span>](#do-not-try-to-replace-protected-resources)
-   [<span data-ttu-id="04940-111">No dependa de recursos no críticos.</span><span class="sxs-lookup"><span data-stu-id="04940-111">Do not depend upon non-critical resources.</span></span>](#do-not-depend-upon-non-critical-resources)
-   [<span data-ttu-id="04940-112">Use la API para recuperar la información de configuración de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="04940-112">Use the API to retrieve Windows Installer configuration information.</span></span>](#use-the-api-to-retrieve-windows-installer-configuration-information)
-   [<span data-ttu-id="04940-113">Organice la instalación de la aplicación en torno a los componentes.</span><span class="sxs-lookup"><span data-stu-id="04940-113">Organize the installation of your application around components.</span></span>](#organize-the-installation-of-your-application-around-components)
-   [<span data-ttu-id="04940-114">Reduzca el tamaño de los paquetes de Windows Installer de gran tamaño.</span><span class="sxs-lookup"><span data-stu-id="04940-114">Reduce the size of large Windows Installer packages.</span></span>](#reduce-the-size-of-large-windows-installer-packages)
-   [<span data-ttu-id="04940-115">Si usa acciones personalizadas, siga las prácticas recomendadas para acciones personalizadas.</span><span class="sxs-lookup"><span data-stu-id="04940-115">If you use custom actions, follow good custom action practices.</span></span>](#if-you-use-custom-actions-follow-good-custom-action-practices)
-   [<span data-ttu-id="04940-116">Si utiliza ensamblados, siga las prácticas recomendadas para el ensamblado</span><span class="sxs-lookup"><span data-stu-id="04940-116">If you use assemblies, follow good assembly practices</span></span>](#if-you-use-assemblies-follow-good-assembly-practices)
-   [<span data-ttu-id="04940-117">No distribuir instalaciones simultáneas.</span><span class="sxs-lookup"><span data-stu-id="04940-117">Do not ship concurrent installations.</span></span>](#do-not-ship-concurrent-installations)
-   [<span data-ttu-id="04940-118">Mantener los nombres de paquete y los códigos de paquete coherentes.</span><span class="sxs-lookup"><span data-stu-id="04940-118">Keep package names and package codes consistent.</span></span>](#keep-package-names-and-package-codes-consistent)
-   [<span data-ttu-id="04940-119">No utilice las tablas SelfReg y TypeLib.</span><span class="sxs-lookup"><span data-stu-id="04940-119">Do not use the SelfReg and TypeLib tables.</span></span>](#do-not-use-the-selfreg-and-typelib-tables)
-   [<span data-ttu-id="04940-120">Proporcione la opción de instalación sin una interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="04940-120">Provide the option to install without a user interface.</span></span>](#provide-the-option-to-install-without-a-user-interface)
-   [<span data-ttu-id="04940-121">Evite el uso de la Directiva AlwaysInstallElevated.</span><span class="sxs-lookup"><span data-stu-id="04940-121">Avoid using the AlwaysInstallElevated policy.</span></span>](#avoid-using-the-alwaysinstallelevated-policy)
-   [<span data-ttu-id="04940-122">Habilite la Directiva DisableMedia para limitar la instalación no autorizada.</span><span class="sxs-lookup"><span data-stu-id="04940-122">Enable the DisableMedia policy to limit unauthorized installation.</span></span>](#enable-the-disablemedia-policy-to-limit-unauthorized-installation)
-   [<span data-ttu-id="04940-123">Mantenga los archivos de origen del paquete original seguros y disponibles para los usuarios.</span><span class="sxs-lookup"><span data-stu-id="04940-123">Keep the original package source files secure and available to users.</span></span>](#keep-the-original-package-source-files-secure-and-available-to-users)
-   [<span data-ttu-id="04940-124">Habilite el registro detallado en el equipo del usuario al solucionar problemas de implementación.</span><span class="sxs-lookup"><span data-stu-id="04940-124">Enable verbose logging on user's computer when troubleshooting deployment.</span></span>](#enable-verbose-logging-on-users-computer-when-troubleshooting-deployment)
-   [<span data-ttu-id="04940-125">La desinstalación deja el equipo del usuario en un estado limpio.</span><span class="sxs-lookup"><span data-stu-id="04940-125">Uninstallation leaves the user's computer in a clean state.</span></span>](#uninstallation-leaves-the-users-computer-in-a-clean-state)
-   [<span data-ttu-id="04940-126">Probar paquetes para la implementación de instalación por usuario y por equipo.</span><span class="sxs-lookup"><span data-stu-id="04940-126">Test packages for both per-user and per-machine installation deployment.</span></span>](#test-packages-for-both-per-user-and-per-machine-installation-deployment)
-   [<span data-ttu-id="04940-127">Planee y pruebe una estrategia de servicio antes de enviar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="04940-127">Plan and test a servicing strategy before shipping the application.</span></span>](#plan-and-test-a-servicing-strategy-before-shipping-the-application)
-   [<span data-ttu-id="04940-128">Reduzca la dependencia de las actualizaciones en los orígenes originales.</span><span class="sxs-lookup"><span data-stu-id="04940-128">Reduce the dependency of updates upon the original sources.</span></span>](#reduce-the-dependency-of-updates-upon-the-original-sources)
-   [<span data-ttu-id="04940-129">No distribuya módulos de combinación no redistribuibles.</span><span class="sxs-lookup"><span data-stu-id="04940-129">Do not distribute unserviceable merge modules.</span></span>](#do-not-distribute-unserviceable-merge-modules)
-   [<span data-ttu-id="04940-130">Evite aplicar revisiones a las instalaciones administrativas.</span><span class="sxs-lookup"><span data-stu-id="04940-130">Avoid patching administrative installations.</span></span>](#avoid-patching-administrative-installations)
-   [<span data-ttu-id="04940-131">Registra las actualizaciones para que se ejecuten con privilegios elevados.</span><span class="sxs-lookup"><span data-stu-id="04940-131">Register updates to run with elevated privilege.</span></span>](#register-updates-to-run-with-elevated-privilege)
-   [<span data-ttu-id="04940-132">Use la tabla MsiPatchSequence para secuenciar las revisiones.</span><span class="sxs-lookup"><span data-stu-id="04940-132">Use the MsiPatchSequence Table to sequence patches.</span></span>](#use-the-msipatchsequence-table-to-sequence-patches)
-   [<span data-ttu-id="04940-133">Pruebe el paquete de instalación exhaustivamente.</span><span class="sxs-lookup"><span data-stu-id="04940-133">Test the installation package thoroughly.</span></span>](#test-the-installation-package-thoroughly)
-   [<span data-ttu-id="04940-134">Corrija todos los errores de validación antes de implementar un paquete de instalación nuevo o revisado.</span><span class="sxs-lookup"><span data-stu-id="04940-134">Fix all validation errors before deploying a new or revised installation package.</span></span>](#fix-all-validation-errors-before-deploying-a-new-or-revised-installation-package)
-   [<span data-ttu-id="04940-135">Cree una instalación segura.</span><span class="sxs-lookup"><span data-stu-id="04940-135">Author a secure installation.</span></span>](#author-a-secure-installation)
-   [<span data-ttu-id="04940-136">Usar PMSIHANDLE en lugar de HANDLE</span><span class="sxs-lookup"><span data-stu-id="04940-136">Use PMSIHANDLE instead of HANDLE</span></span>](#use-pmsihandle-instead-of-handle)

## <a name="update-the-windows-installer-version"></a><span data-ttu-id="04940-137">Actualice la versión de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="04940-137">Update the Windows Installer version.</span></span>

-   <span data-ttu-id="04940-138">Use Windows Installer 5,0 en Windows Server 2008 R2 y Windows 7.</span><span class="sxs-lookup"><span data-stu-id="04940-138">Use Windows Installer 5.0 on Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="04940-139">Se trata de la versión de Windows Installer que se proporciona con el sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="04940-139">This is the Windows Installer version provided with the operating system.</span></span>
-   <span data-ttu-id="04940-140">Use Windows Installer 4,5 en Windows Server 2008, Windows Server 2003 con Service Pack 1 (SP1), Windows Vista con Service Pack 1 (SP1) o Windows XP con Service Pack 2 (SP2).</span><span class="sxs-lookup"><span data-stu-id="04940-140">Use Windows Installer 4.5 on Windows Server 2008, Windows Server 2003 with Service Pack 1 (SP1), Windows Vista with Service Pack 1 (SP1), or Windows XP with Service Pack 2 (SP2).</span></span> <span data-ttu-id="04940-141">Para obtener información sobre cómo obtener la última versión de Windows Installer, vea [Windows Installer redistribuibles](windows-installer-redistributables.md).</span><span class="sxs-lookup"><span data-stu-id="04940-141">For information about obtaining the latest Windows Installer version, see [Windows Installer Redistributables](windows-installer-redistributables.md).</span></span>
-   <span data-ttu-id="04940-142">Use Windows Installer 3,1 en Windows 2000 con Service Pack 3 (SP3).</span><span class="sxs-lookup"><span data-stu-id="04940-142">Use Windows Installer 3.1 on Windows 2000 with Service Pack 3 (SP3).</span></span> <span data-ttu-id="04940-143">Windows Installer versión 3,1 tiene características que facilitan el mantenimiento y la aplicación de [revisiones](patching.md)de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="04940-143">Windows Installer version 3.1 has features that facilitate better application servicing and [patching](patching.md).</span></span>
-   <span data-ttu-id="04940-144">Muchas características importantes se introdujeron con la versión 3,0 y se enumeran en la sección [no compatible con la versión 2,0 de Windows Installer](not-supported-in-windows-installer-version-2-0.md).</span><span class="sxs-lookup"><span data-stu-id="04940-144">Many important features were introduced with version 3.0 and are listed in the section [Not Supported in Windows Installer Version 2.0](not-supported-in-windows-installer-version-2-0.md).</span></span> <span data-ttu-id="04940-145">Los paquetes de instalación y las actualizaciones que se crearon para Windows Installer 2,0 se pueden instalar con Windows Installer 3,0 y versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="04940-145">Installation packages and updates that were created for Windows Installer 2.0 can be installed using Windows Installer 3.0 and later.</span></span> <span data-ttu-id="04940-146">Los paquetes de revisión que contienen las nuevas tablas utilizadas por Windows Installer 3,0 se pueden aplicar con versiones anteriores de Windows Installer pero sin la funcionalidad de aplicación de revisiones Windows Installer 3,0.</span><span class="sxs-lookup"><span data-stu-id="04940-146">Patch packages that contain the new tables used by Windows Installer 3.0 can still be applied using earlier versions of Windows Installer but without the Windows Installer 3.0 patching functionality.</span></span> <span data-ttu-id="04940-147">También es posible crear revisiones que requieran explícitamente el Windows Installer 3,0 que no se puede aplicar a versiones anteriores de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="04940-147">It is also possible to author patches that explicitly require the Windows Installer 3.0 that cannot be applied by earlier versions of Windows Installer.</span></span> <span data-ttu-id="04940-148">Si un usuario no puede actualizar la versión del instalador, asegúrese de que la aplicación o actualización será compatible con una actualización futura del Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="04940-148">If a user is unable to update the installer version, ensure that your application or update will be compatible with a future update of the Windows Installer.</span></span>
-   <span data-ttu-id="04940-149">Para obtener una lista de las características Windows Installer no compatibles con versiones anteriores de Windows Installer, consulte [novedades de Windows Installer](what-s-new-in-windows-installer.md).</span><span class="sxs-lookup"><span data-stu-id="04940-149">For a list of the Windows Installer features not supported by earlier versions of the Windows installer see [What's New in Windows Installer](what-s-new-in-windows-installer.md).</span></span>

## <a name="meet-the-windows-logo-certification-requirements"></a><span data-ttu-id="04940-150">Cumplir los requisitos de certificación del logotipo de Windows.</span><span class="sxs-lookup"><span data-stu-id="04940-150">Meet the Windows Logo certification requirements.</span></span>

-   <span data-ttu-id="04940-151">Incluso si no desea enviar su aplicación al programa del logotipo, siga las directrices de certificación del logotipo para que el paquete de Windows Installer sea mejor.</span><span class="sxs-lookup"><span data-stu-id="04940-151">Even if you do not intend to submit your application to the logo program, following the logo certification guidelines can help make your Windows Installer package better.</span></span> <span data-ttu-id="04940-152">Para obtener información general sobre los requisitos del logotipo y vínculos a programas de certificación de logotipo específicos, consulte [requisitos de Windows Installer y logotipo](windows-installer-and-logo-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="04940-152">For an overview of the logo requirements, and links to specific logo certification programs, see [Windows Installer and Logo Requirements](windows-installer-and-logo-requirements.md).</span></span>

## <a name="prepare-the-package-for-localization"></a><span data-ttu-id="04940-153">Preparar el paquete para la localización.</span><span class="sxs-lookup"><span data-stu-id="04940-153">Prepare the package for localization.</span></span>

-   <span data-ttu-id="04940-154">Es una buena práctica preparar la localización en el futuro al crear el paquete de instalación original.</span><span class="sxs-lookup"><span data-stu-id="04940-154">It is a good practice to prepare for future localization when authoring the original installation package.</span></span> <span data-ttu-id="04940-155">Puede seguir el procedimiento de localización de paquetes sugerido en [localizar un paquete de Windows Installer](localizing-a-windows-installer-package.md).</span><span class="sxs-lookup"><span data-stu-id="04940-155">You can follow the suggested package localization procedure in [Localizing a Windows Installer Package](localizing-a-windows-installer-package.md).</span></span>

## <a name="update-your-windows-installer-development-tools-and-documentation"></a><span data-ttu-id="04940-156">Actualice la documentación y las herramientas de desarrollo de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="04940-156">Update your Windows Installer development tools and documentation.</span></span>

-   <span data-ttu-id="04940-157">Las [herramientas de desarrollo de Windows Installer](windows-installer-development-tools.md) no son redistribuibles y solo se deben usar las versiones de estas herramientas disponibles en Microsoft.</span><span class="sxs-lookup"><span data-stu-id="04940-157">The [Windows Installer Development Tools](windows-installer-development-tools.md) are not redistributable, and you should only use the versions of these tools available from Microsoft.</span></span> <span data-ttu-id="04940-158">Están disponibles en los [componentes de Windows SDK para los desarrolladores de Windows Installer](platform-sdk-components-for-windows-installer-developers.md) en el kit de desarrollo de software (SDK) de Microsoft Windows.</span><span class="sxs-lookup"><span data-stu-id="04940-158">These are available in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md) in the Microsoft Windows Software Development Kit (SDK).</span></span>
-   <span data-ttu-id="04940-159">Varios proveedores de software independientes ofrecen herramientas para crear o modificar paquetes Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="04940-159">Several independent software vendors offer tools to create or modify Windows Installer packages.</span></span> <span data-ttu-id="04940-160">Estas herramientas pueden proporcionar un entorno de creación de paquetes que puede ser más fácil de usar que las herramientas proporcionadas en el SDK de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="04940-160">These tools can provide a package authoring environment that may be easier to use than the tools provided in the Windows Installer SDK.</span></span> <span data-ttu-id="04940-161">Puede obtener más información acerca de estas herramientas desde los recursos de información descritos en [otros orígenes de información de Windows Installer](other-sources-of-windows-installer-information.md).</span><span class="sxs-lookup"><span data-stu-id="04940-161">You can learn more about these tools from the information resources discussed in [Other Sources of Windows Installer Information](other-sources-of-windows-installer-information.md).</span></span>
-   <span data-ttu-id="04940-162">La capacidad de crear un paquete a partir de archivos de texto puede ser más intuitiva para algunos desarrolladores.</span><span class="sxs-lookup"><span data-stu-id="04940-162">The capability to build a package from text files may be more intuitive for some developers.</span></span> <span data-ttu-id="04940-163">El conjunto de herramientas de Windows Installer XML (WiX) disponible en [sourceforge.net](https://sourceforge.net/projects/wix) crea paquetes de instalación de Windows a partir del código fuente XML.</span><span class="sxs-lookup"><span data-stu-id="04940-163">The Windows Installer XML (WiX) toolset available on [Sourceforge.net](https://sourceforge.net/projects/wix) builds Windows installation packages from XML source code.</span></span>
-   <span data-ttu-id="04940-164">La documentación del [SDK de Windows Installer](./windows-installer-portal.md) Publicada en MSDN Online Library se actualiza con más frecuencia.</span><span class="sxs-lookup"><span data-stu-id="04940-164">The documentation in the [Windows Installer SDK](./windows-installer-portal.md) released in the MSDN Online Library is updated the most frequently.</span></span>
-   <span data-ttu-id="04940-165">Use la versión reciente de [Msizap.exe](msizap-exe.md) (versión 3.1.4000.2726 o superior) que está disponible en los [componentes de Windows SDK para Windows Installer desarrolladores](platform-sdk-components-for-windows-installer-developers.md) de Windows Vista o superior.</span><span class="sxs-lookup"><span data-stu-id="04940-165">Use the recent version of [Msizap.exe](msizap-exe.md) (version 3.1.4000.2726 or greater) that is available in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md) for Windows Vista or greater.</span></span> <span data-ttu-id="04940-166">Las versiones inferiores de Msizap.exe pueden quitar información acerca de todas las actualizaciones que se han aplicado a otras aplicaciones en el equipo del usuario.</span><span class="sxs-lookup"><span data-stu-id="04940-166">Lesser versions of Msizap.exe can remove information about all updates that have been applied to other applications on the user's computer.</span></span> <span data-ttu-id="04940-167">Si se quita esta información, es posible que sea necesario quitar y volver a instalar estas otras aplicaciones para recibir actualizaciones adicionales.</span><span class="sxs-lookup"><span data-stu-id="04940-167">If this information is removed, these other applications may need to be removed and reinstalled to receive additional updates.</span></span>
-   <span data-ttu-id="04940-168">El editor de tablas de base de datos [Orca.exe](orca-exe.md) es un editor de tablas de base de datos para crear y editar paquetes de Windows Installer y módulos de combinación.</span><span class="sxs-lookup"><span data-stu-id="04940-168">The database table editor [Orca.exe](orca-exe.md) is a database table editor for creating and editing Windows Installer packages and merge modules.</span></span> <span data-ttu-id="04940-169">Tiene una interfaz de GUI básica, pero admite la edición avanzada de bases de datos de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="04940-169">It has a basic GUI interface but supports advanced editing of Windows Installer databases.</span></span> <span data-ttu-id="04940-170">Incluso si utiliza otra aplicación como herramienta de desarrollo principal, puede que le resulte más práctico usar Orca.exe para solucionar problemas y probar un paquete.</span><span class="sxs-lookup"><span data-stu-id="04940-170">Even if you use another application as your primary development tool, you may find using Orca.exe is convenient when troubleshooting and testing a package.</span></span>
-   <span data-ttu-id="04940-171">Vea [otras fuentes de información Windows Installer](other-sources-of-windows-installer-information.md) para obtener información sobre Windows Installer actuales disponible en blogs, chats técnicos, grupos de noticias, artículos técnicos y sitios Web.</span><span class="sxs-lookup"><span data-stu-id="04940-171">See [Other Sources of Windows Installer Information](other-sources-of-windows-installer-information.md) for current Windows Installer information available in blogs, technical chats, newsgroups, technical articles, and websites.</span></span>

## <a name="if-you-decide-to-repackage-a-legacy-setup-application-follow-good-repackaging-practices"></a><span data-ttu-id="04940-172">Si decide volver a empaquetar una aplicación de instalación heredada, siga las prácticas recomendadas para el empaquetado.</span><span class="sxs-lookup"><span data-stu-id="04940-172">If you decide to repackage a legacy setup application, follow good repackaging practices.</span></span>

<span data-ttu-id="04940-173">Muchos proveedores de aplicaciones proporcionan paquetes de Windows Installer nativa para la instalación o sus productos.</span><span class="sxs-lookup"><span data-stu-id="04940-173">Many application vendors provide native Windows Installer packages for the installation or their products.</span></span> <span data-ttu-id="04940-174">El software que convierte una aplicación de instalación heredada existente en un paquete de Windows Installer se denomina herramienta de reempaquetado.</span><span class="sxs-lookup"><span data-stu-id="04940-174">Software that converts an existing legacy setup application into a Windows Installer package is referred to as a repackaging tool.</span></span> <span data-ttu-id="04940-175">La guía paso a paso de las notas del producto sobre la [creación de paquetes de Windows Installer y el reempaquetado del software para la Windows Installer](https://www.microsoft.com/technet/prodtechnol/windows2000serv/howto/winstall.mspx) describe una herramienta de reempaquetado disponible comercialmente.</span><span class="sxs-lookup"><span data-stu-id="04940-175">The whitepaper [Step-by-Step Guide to Creating Windows Installer Packages and Repackaging Software for the Windows Installer](https://www.microsoft.com/technet/prodtechnol/windows2000serv/howto/winstall.mspx) describes a commercially available repackaging tool.</span></span> <span data-ttu-id="04940-176">Volver a empaquetar una aplicación de instalación existente no es la mejor práctica de desarrollo.</span><span class="sxs-lookup"><span data-stu-id="04940-176">Repackaging an existing setup application is not the best development practice.</span></span> <span data-ttu-id="04940-177">Las aplicaciones que se han diseñado desde el principio para aprovechar las características de Windows Installer pueden ser más fáciles de instalar y de dar servicio a los usuarios.</span><span class="sxs-lookup"><span data-stu-id="04940-177">Applications that have been designed from the start to take advantage of Windows Installer features can be easier for users to install and service.</span></span> <span data-ttu-id="04940-178">Si decide usar un software de reempaquetado, las siguientes prácticas pueden ayudarle a generar un mejor Windows Installer paquete.</span><span class="sxs-lookup"><span data-stu-id="04940-178">If you decide to use a repackaging software the following practices can help you produce a better Windows Installer package.</span></span>

-   <span data-ttu-id="04940-179">Las herramientas de reempaquetado convierten las instalaciones heredadas en un paquete de Windows Installer tomando una imagen de un sistema de almacenamiento provisional antes y después de la instalación.</span><span class="sxs-lookup"><span data-stu-id="04940-179">Repackaging tools convert legacy installations into a Windows Installer package by taking a picture of a staging system before and after installation.</span></span> <span data-ttu-id="04940-180">Los cambios en el registro, los cambios de archivo o la configuración del sistema que se produce durante el proceso de captura se incluyen en la instalación de.</span><span class="sxs-lookup"><span data-stu-id="04940-180">Any registry changes, file changes, or system setting that occurs during the capture process is included in the installation.</span></span> <span data-ttu-id="04940-181">Configure el hardware y el software del equipo que se usa para volver a empaquetar la instalación lo más cerca posible del sistema del usuario previsto.</span><span class="sxs-lookup"><span data-stu-id="04940-181">Configure the hardware and software of the computer used to repackage the installation as close as possible to the intended user's system.</span></span> <span data-ttu-id="04940-182">Cree un paquete independiente para cada configuración de hardware diferente.</span><span class="sxs-lookup"><span data-stu-id="04940-182">Create a separate package for each different hardware configuration.</span></span> <span data-ttu-id="04940-183">Volver a empaquetar con un equipo de ensayo limpio.</span><span class="sxs-lookup"><span data-stu-id="04940-183">Repackage using a clean staging computer.</span></span> <span data-ttu-id="04940-184">Quite las aplicaciones innecesarias.</span><span class="sxs-lookup"><span data-stu-id="04940-184">Remove any unnecessary applications.</span></span> <span data-ttu-id="04940-185">Detenga todos los procesos innecesarios.</span><span class="sxs-lookup"><span data-stu-id="04940-185">Stop all unnecessary processes.</span></span> <span data-ttu-id="04940-186">Cierre todos los servicios del sistema no esenciales.</span><span class="sxs-lookup"><span data-stu-id="04940-186">Close all non-essential system services.</span></span>
-   <span data-ttu-id="04940-187">Realice siempre una copia de la instalación original antes de empezar a trabajar en ella.</span><span class="sxs-lookup"><span data-stu-id="04940-187">Always make a copy of the original installation before starting to work on it.</span></span> <span data-ttu-id="04940-188">Trabaje siempre en la copia.</span><span class="sxs-lookup"><span data-stu-id="04940-188">Always work on the copy.</span></span> <span data-ttu-id="04940-189">Nunca detenga un reempaquetador antes de que termine de compilar el paquete.</span><span class="sxs-lookup"><span data-stu-id="04940-189">Never stop a repackager before it finishes building the package.</span></span> <span data-ttu-id="04940-190">Si el reempaquetador daña el paquete, seguirá teniendo el original.</span><span class="sxs-lookup"><span data-stu-id="04940-190">If the repackager damages the package you will still have the original.</span></span>
-   <span data-ttu-id="04940-191">No volver a empaquetar las actualizaciones de software de Microsoft en un paquete de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="04940-191">Do not repackage Microsoft software updates into a Windows Installer package.</span></span> <span data-ttu-id="04940-192">Microsoft publica actualizaciones de software, como Service Packs, como archivos de extracción automática que ejecutan la instalación automáticamente.</span><span class="sxs-lookup"><span data-stu-id="04940-192">Microsoft releases software updates, such as service packs, as self-extracting files that automatically runs installation.</span></span> <span data-ttu-id="04940-193">Estas actualizaciones usan instaladores diferentes a los Windows Installer para reemplazar los recursos protegidos de Windows y no se pueden convertir en un paquete de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="04940-193">These updates use different installers than the Windows Installer to replace protected Windows resources and cannot be converted into a Windows Installer package.</span></span> <span data-ttu-id="04940-194">Para obtener información sobre cómo implementar los Service Pack de Windows, consulte la guía de implementación de Service Pack en [Microsoft TechNet](https://technet.microsoft.com/).</span><span class="sxs-lookup"><span data-stu-id="04940-194">For information about how to deploy Windows service packs, see the service pack's deployment guide on [Microsoft TechNet](https://technet.microsoft.com/).</span></span>
-   <span data-ttu-id="04940-195">No use una herramienta de reempaquetado para convertir un paquete de Windows Installer en un nuevo paquete.</span><span class="sxs-lookup"><span data-stu-id="04940-195">Do not use a repackaging tool to convert a Windows Installer package into a new package.</span></span> <span data-ttu-id="04940-196">El Windows Installer agrega información de configuración al sistema, así como a los recursos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="04940-196">The Windows Installer adds configuration information to the system as well as application resources.</span></span> <span data-ttu-id="04940-197">Cuando una herramienta de reempaquetado compara el sistema antes y después de la instalación, el reempaquetador interpreta erróneamente la información de configuración como parte de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="04940-197">When a repackaging tool compares the system before and after the installation, the repackager misinterprets the configuration information as part of the application.</span></span> <span data-ttu-id="04940-198">Normalmente, esto daña la aplicación reempaquetada.</span><span class="sxs-lookup"><span data-stu-id="04940-198">This usually damages the repackaged application.</span></span> <span data-ttu-id="04940-199">En su lugar, use las [transformaciones de personalización](a-customization-transform-example.md) para modificar un paquete de Windows Installer existente o crear un nuevo paquete.</span><span class="sxs-lookup"><span data-stu-id="04940-199">Instead use [customization transforms](a-customization-transform-example.md) to modify an existing Windows Installer package, or make an new package.</span></span> <span data-ttu-id="04940-200">Puede crear transformaciones de personalización con la herramienta [Msitran.exe](msitran-exe.md) .</span><span class="sxs-lookup"><span data-stu-id="04940-200">You can create customization transforms using the [Msitran.exe](msitran-exe.md) tool.</span></span>
-   <span data-ttu-id="04940-201">No use una herramienta de reempaquetado para consolidar varios paquetes de Windows Installer en un solo paquete.</span><span class="sxs-lookup"><span data-stu-id="04940-201">Do not use a repackaging tool to consolidate several Windows Installer packages into a single package.</span></span> <span data-ttu-id="04940-202">En su lugar, puede usar la herramienta [Msistuff.exe](msistuff-exe.md) para configurar el archivo ejecutable Setup.exe bootstrap para instalar los paquetes uno tras otro.</span><span class="sxs-lookup"><span data-stu-id="04940-202">Instead you can use the [Msistuff.exe](msistuff-exe.md) tool to configure the Setup.exe bootstrap executable to install the packages one after another.</span></span>
-   <span data-ttu-id="04940-203">Cree el paquete de Windows Installer para que el cliente pueda personalizarlo fácilmente.</span><span class="sxs-lookup"><span data-stu-id="04940-203">Make your Windows Installer package so that it can be easily customized by the customer.</span></span> <span data-ttu-id="04940-204">Las variables globales utilizadas por el Windows Installer durante una instalación se pueden establecer mediante [propiedades](properties.md) públicas o [transformaciones de personalización](a-customization-transform-example.md).</span><span class="sxs-lookup"><span data-stu-id="04940-204">Global variables used by the Windows Installer during an installation can be set using public [properties](properties.md) or [customization transforms](a-customization-transform-example.md).</span></span> <span data-ttu-id="04940-205">Proporcione documentación para el uso de esas propiedades y valores predeterminados prácticos para todos los valores personalizables.</span><span class="sxs-lookup"><span data-stu-id="04940-205">Provide documentation for the use of those properties and practical default values for all customizable values.</span></span> <span data-ttu-id="04940-206">Para obtener información sobre cómo obtener y establecer las propiedades, vea [usar propiedades](using-properties.md).</span><span class="sxs-lookup"><span data-stu-id="04940-206">For information about getting and setting properties see [Using Properties](using-properties.md).</span></span> <span data-ttu-id="04940-207">Para obtener un ejemplo de una transformación de personalización, vea [un ejemplo de transformación de personalización](a-customization-transform-example.md).</span><span class="sxs-lookup"><span data-stu-id="04940-207">For an example of a customization transform see [A Customization Transform Example](a-customization-transform-example.md).</span></span>

## <a name="do-not-try-to-replace-protected-resources"></a><span data-ttu-id="04940-208">No intente reemplazar los recursos protegidos.</span><span class="sxs-lookup"><span data-stu-id="04940-208">Do not try to replace protected resources.</span></span>

<span data-ttu-id="04940-209">Windows Installer paquetes no deben intentar reemplazar los recursos protegidos durante la instalación o actualización.</span><span class="sxs-lookup"><span data-stu-id="04940-209">Windows Installer packages should not attempt to replace protected resources during installation or update.</span></span> <span data-ttu-id="04940-210">En el Windows Installer no se quitan ni reemplazan estos recursos porque Windows evita la sustitución de archivos esenciales del sistema, carpetas y claves del registro.</span><span class="sxs-lookup"><span data-stu-id="04940-210">The Windows Installer does not remove or replace these resources because Windows prevents the replacement of essential system files, folders, and registry keys.</span></span> <span data-ttu-id="04940-211">La protección de estos recursos evita errores en la aplicación y en el sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="04940-211">Protecting these resources prevents application and operating system failures.</span></span>

-   <span data-ttu-id="04940-212">Cuando se ejecuta en Windows Server 2008 o Windows Vista, el Windows Installer omite la instalación de cualquier archivo o clave del registro que esté protegido por [protección de recursos de Windows](../wfp/windows-resource-protection-portal.md) (WRP), el instalador escribe una advertencia en el archivo de registro y continúa con el resto de la instalación sin un error.</span><span class="sxs-lookup"><span data-stu-id="04940-212">When running on Windows Server 2008 or Windows Vista, the Windows Installer skips the installation of any file or registry key that is protected by [Windows Resource Protection](../wfp/windows-resource-protection-portal.md) (WRP), the installer enters a warning in the log file, and continues with the remainder of the installation without an error.</span></span> <span data-ttu-id="04940-213">Para obtener más información, vea [usar Windows Installer y protección de recursos de Windows](windows-resource-protection-on-windows-vista.md).</span><span class="sxs-lookup"><span data-stu-id="04940-213">For information, see [Using Windows Installer and Windows Resource Protection](windows-resource-protection-on-windows-vista.md).</span></span>
-   <span data-ttu-id="04940-214">WRP es el nuevo nombre de protección de archivos de Windows (WFP).</span><span class="sxs-lookup"><span data-stu-id="04940-214">WRP is the new name for Windows File Protection (WFP).</span></span> <span data-ttu-id="04940-215">WRP protege las claves del registro y las carpetas, así como los archivos esenciales del sistema.</span><span class="sxs-lookup"><span data-stu-id="04940-215">WRP protects registry keys and folders as well as essential system files.</span></span> <span data-ttu-id="04940-216">En Windows Server 2003, Windows XP y Windows 2000, cuando el Windows Installer encontró un archivo protegido con WFP, el instalador solicitaría que WFP instalara el archivo.</span><span class="sxs-lookup"><span data-stu-id="04940-216">In Windows Server 2003, Windows XP, and Windows 2000, when the Windows Installer encountered a WFP-protected file, the installer would request that WFP install the file.</span></span> <span data-ttu-id="04940-217">Para obtener más información, vea [usar Windows Installer y protección de recursos de Windows](windows-resource-protection-on-windows-vista.md).</span><span class="sxs-lookup"><span data-stu-id="04940-217">For information, see [Using Windows Installer and Windows Resource Protection](windows-resource-protection-on-windows-vista.md).</span></span>

## <a name="do-not-depend-upon-non-critical-resources"></a><span data-ttu-id="04940-218">No dependa de recursos no críticos.</span><span class="sxs-lookup"><span data-stu-id="04940-218">Do not depend upon non-critical resources.</span></span>

<span data-ttu-id="04940-219">La instalación o actualización no debe depender de la instalación de recursos no críticos por los siguientes motivos.</span><span class="sxs-lookup"><span data-stu-id="04940-219">Your installation or update should not depend upon the installation of non-critical resources for the following reasons.</span></span>

-   <span data-ttu-id="04940-220">Se puede producir un error en las acciones personalizadas si dependen de un componente que pertenece a una característica que el usuario anuncia en lugar de instalarse.</span><span class="sxs-lookup"><span data-stu-id="04940-220">Custom actions can fail if they depend upon a component belonging to a feature that the user advertises rather than installs.</span></span>
-   <span data-ttu-id="04940-221">Acciones personalizadas secuenciadas antes de que se pueda producir un error en la acción [InstallFinalize](installfinalize-action.md) si dependen de un componente que contiene un ensamblado que se está instalando.</span><span class="sxs-lookup"><span data-stu-id="04940-221">Custom actions sequenced before the [InstallFinalize](installfinalize-action.md) action can fail if they depend on a component containing an assembly that is being installed.</span></span> <span data-ttu-id="04940-222">El Windows Installer no confirma los ensamblados en la caché de ensamblados global (GAC) hasta que se completa la acción InstallFinalize.</span><span class="sxs-lookup"><span data-stu-id="04940-222">The Windows Installer does not commit assemblies to the Global Assembly Cache (GAC) until the InstallFinalize action completes.</span></span>

## <a name="use-the-api-to-retrieve-windows-installer-configuration-information"></a><span data-ttu-id="04940-223">Use la API para recuperar la información de configuración de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="04940-223">Use the API to retrieve Windows Installer configuration information.</span></span>

<span data-ttu-id="04940-224">La instalación de la aplicación o actualización no debe depender del acceso directo a Windows Installer información de configuración guardada en el equipo.</span><span class="sxs-lookup"><span data-stu-id="04940-224">The installation of your application or update should not depend upon direct access to Windows Installer configuration information saved on your computer.</span></span> <span data-ttu-id="04940-225">En su lugar, use la interfaz de programación de aplicaciones de Windows Installer para recuperar la información de configuración.</span><span class="sxs-lookup"><span data-stu-id="04940-225">Instead use the Windows Installer application programming interface to retrieve configuration information.</span></span> <span data-ttu-id="04940-226">La ubicación y el formato de la información de configuración la administra el servicio de Windows Installer y puede cambiar.</span><span class="sxs-lookup"><span data-stu-id="04940-226">The location and format of configuration information is managed by the Windows Installer service and can change.</span></span>

-   <span data-ttu-id="04940-227">Las funciones de instalación y configuración de la API de Windows Installer se describen en la referencia de la [función de instalador](installer-function-reference.md).</span><span class="sxs-lookup"><span data-stu-id="04940-227">The Installation and Configuration Functions of the Windows Installer API are described in the [Installer Function Reference](installer-function-reference.md).</span></span>
-   <span data-ttu-id="04940-228">Las [propiedades de configuración](property-reference.md) se describen en la referencia de propiedad.</span><span class="sxs-lookup"><span data-stu-id="04940-228">The [Configuration Properties](property-reference.md) are described in the Property Reference.</span></span>
-   <span data-ttu-id="04940-229">Los métodos y propiedades de automatización se describen en la referencia de la [interfaz de automatización](automation-interface-reference.md).</span><span class="sxs-lookup"><span data-stu-id="04940-229">The automation methods and properties are described in the [Automation Interface Reference](automation-interface-reference.md).</span></span> <span data-ttu-id="04940-230">El script de ejemplo WiLstPrd.vbs se conecta a un objeto de instalador y enumera los productos registrados y la información del producto.</span><span class="sxs-lookup"><span data-stu-id="04940-230">The sample script WiLstPrd.vbs connects to an Installer object and enumerates registered products and product information.</span></span> <span data-ttu-id="04940-231">Para obtener información, consulte [lista de productos, propiedades, características y componentes](list-products-properties-features-and-components.md).</span><span class="sxs-lookup"><span data-stu-id="04940-231">For information see [List Products, Properties, Features, and Components](list-products-properties-features-and-components.md).</span></span>

## <a name="organize-the-installation-of-your-application-around-components"></a><span data-ttu-id="04940-232">Organice la instalación de la aplicación en torno a los componentes.</span><span class="sxs-lookup"><span data-stu-id="04940-232">Organize the installation of your application around components.</span></span>

<span data-ttu-id="04940-233">El servicio Windows Installer instala o quita colecciones de recursos a los que se hace referencia como [componentes](windows-installer-components.md)de.</span><span class="sxs-lookup"><span data-stu-id="04940-233">The Windows Installer service installs or removes collections of resources referred to as [components](windows-installer-components.md).</span></span> <span data-ttu-id="04940-234">Dado que los componentes suelen compartirse, el autor de un paquete de instalación debe cumplir las reglas al especificar los componentes de una característica o aplicación.</span><span class="sxs-lookup"><span data-stu-id="04940-234">Because components are commonly shared, the author of an installation package must follow rules when specifying the components of a feature or application.</span></span>

-   <span data-ttu-id="04940-235">Adhiere a las reglas de componentes al [organizar las aplicaciones en componentes](organizing-applications-into-components.md) para asegurarse de que los nuevos componentes, o nuevas versiones de los componentes, se pueden instalar y quitar sin dañar otras aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="04940-235">Adhere to the component rules when [Organizing Applications into Components](organizing-applications-into-components.md) to ensure that new components, or new versions of components, can be installed and removed without damaging other applications.</span></span> <span data-ttu-id="04940-236">Puede seguir el procedimiento descrito en [definir los componentes del instalador](defining-installer-components.md).</span><span class="sxs-lookup"><span data-stu-id="04940-236">You can follow the procedure described in [Defining Installer Components](defining-installer-components.md).</span></span>
-   <span data-ttu-id="04940-237">El instalador realiza un seguimiento de todos los componentes por el GUID del identificador de componente correspondiente especificado en la [tabla de componentes](component-table.md).</span><span class="sxs-lookup"><span data-stu-id="04940-237">The installer tracks every component by the respective component ID GUID specified in the [Component table](component-table.md).</span></span> <span data-ttu-id="04940-238">Es esencial para el funcionamiento del mecanismo de recuento de referencias Windows Installer que el GUID del identificador de componente es correcto.</span><span class="sxs-lookup"><span data-stu-id="04940-238">It is essential for the operation of the Windows Installer reference-counting mechanism that the component ID GUID is correct.</span></span> <span data-ttu-id="04940-239">Siga las instrucciones que se indican en [cambiar el código de componente](changing-the-component-code.md).</span><span class="sxs-lookup"><span data-stu-id="04940-239">Follow the guidelines in [Changing the Component Code](changing-the-component-code.md).</span></span>
-   <span data-ttu-id="04940-240">Si el paquete debe interrumpir las reglas de componentes, tenga en cuenta las posibles consecuencias y asegúrese de que la instalación nunca instala estos componentes en los que pueden dañar componentes en el sistema del usuario.</span><span class="sxs-lookup"><span data-stu-id="04940-240">If your package must break the component rules, be aware of the possible consequences and ensure that your installation never installs these components where they may damage components on the user's system.</span></span> <span data-ttu-id="04940-241">Para obtener información, consulte [¿Qué ocurre si se interrumpen las reglas de componentes?](what-happens-if-the-component-rules-are-broken.md)</span><span class="sxs-lookup"><span data-stu-id="04940-241">For information see [What happens if the component rules are broken?](what-happens-if-the-component-rules-are-broken.md).</span></span>
-   <span data-ttu-id="04940-242">Tenga en cuenta cómo el Windows Installer aplica las [reglas de control de versiones de archivo](file-versioning-rules.md) al [reemplazar los archivos existentes](replacing-existing-files.md).</span><span class="sxs-lookup"><span data-stu-id="04940-242">Be aware how the Windows Installer applies the [File Versioning Rules](file-versioning-rules.md) when [Replacing Existing Files](replacing-existing-files.md).</span></span> <span data-ttu-id="04940-243">El Windows Installer primero determina si el archivo de clave del componente ya está instalado antes de intentar instalar cualquiera de los archivos del componente.</span><span class="sxs-lookup"><span data-stu-id="04940-243">The Windows Installer first determines whether the component's key file is already installed before attempting to install any of the files of the component.</span></span> <span data-ttu-id="04940-244">Si el instalador encuentra un archivo con el mismo nombre que el archivo de clave del componente instalado en la ubicación de destino, compara la versión, la fecha y el idioma de los dos archivos de clave y utiliza reglas de control de versiones de archivo para determinar si se debe instalar el componente proporcionado por el paquete.</span><span class="sxs-lookup"><span data-stu-id="04940-244">If the installer finds a file with the same name as the component's key file installed in the target location, it compares the version, date, and language of the two key files and uses file versioning rules to determine whether to install the component provided by the package.</span></span> <span data-ttu-id="04940-245">Si el instalador determina que debe reemplazar la base del componente en el archivo de clave, utiliza las reglas de control de versiones de archivo en cada archivo instalado para determinar si se debe reemplazar el archivo.</span><span class="sxs-lookup"><span data-stu-id="04940-245">If the installer determines it needs to replace the component base upon the key file, then it uses the file versioning rules on each installed file to determine whether to replace the file.</span></span>

## <a name="reduce-the-size-of-large-windows-installer-packages"></a><span data-ttu-id="04940-246">Reduzca el tamaño de los paquetes de Windows Installer de gran tamaño.</span><span class="sxs-lookup"><span data-stu-id="04940-246">Reduce the size of large Windows Installer packages.</span></span>

<span data-ttu-id="04940-247">Los paquetes de Windows muy grandes tienen recursos del sistema y pueden ser difíciles de instalar.</span><span class="sxs-lookup"><span data-stu-id="04940-247">Very large Windows Packages take system resources and can be difficult for users to install.</span></span> <span data-ttu-id="04940-248">Se recomienda reducir el tamaño de los paquetes de Windows Installer muy grandes mediante los métodos siguientes.</span><span class="sxs-lookup"><span data-stu-id="04940-248">It is good practice to reduce the size of very large Windows Installer Packages by the following methods.</span></span>

-   <span data-ttu-id="04940-249">Comprima los archivos de la instalación y almacénelos en un archivo contenedor (. cab).</span><span class="sxs-lookup"><span data-stu-id="04940-249">Compress the files in the installation and store them in a cabinet (.cab) file .</span></span> <span data-ttu-id="04940-250">El instalador permite que el archivo. cab se almacene como un archivo externo independiente o como un flujo de datos en el propio paquete MSI.</span><span class="sxs-lookup"><span data-stu-id="04940-250">The Installer allows the .cab file to be stored as a separate external file, or as a data stream in the MSI package itself.</span></span> <span data-ttu-id="04940-251">Para obtener información [, consulte uso de archivadores y orígenes comprimidos](using-cabinets-and-compressed-sources.md).</span><span class="sxs-lookup"><span data-stu-id="04940-251">For information see [Using Cabinets and Compressed Sources](using-cabinets-and-compressed-sources.md).</span></span>
-   <span data-ttu-id="04940-252">Elimine el espacio de almacenamiento desperdiciado en el archivo. msi mediante una de las opciones descritas en [reducir el tamaño de un archivo. msi](reducing-the-size-of-an--msi-file.md).</span><span class="sxs-lookup"><span data-stu-id="04940-252">Remove wasted storage space in the .msi file using one of the options discussed in [Reducing the Size of an .msi File](reducing-the-size-of-an--msi-file.md).</span></span>
-   <span data-ttu-id="04940-253">Si el paquete de Windows Installer contiene más de 32767 archivos, debe cambiar el esquema de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="04940-253">If your Windows Installer package contains more than 32767 files, you must change the schema of the database.</span></span> <span data-ttu-id="04940-254">Para obtener información, consulte [crear un paquete de gran tamaño](authoring-a-large-package.md).</span><span class="sxs-lookup"><span data-stu-id="04940-254">For information see [Authoring a Large Package](authoring-a-large-package.md).</span></span>

## <a name="if-you-use-custom-actions-follow-good-custom-action-practices"></a><span data-ttu-id="04940-255">Si usa acciones personalizadas, siga las prácticas recomendadas para acciones personalizadas.</span><span class="sxs-lookup"><span data-stu-id="04940-255">If you use custom actions, follow good custom action practices.</span></span>

<span data-ttu-id="04940-256">El Windows Installer tiene muchas [acciones estándar](standard-actions-reference.md) integradas para la instalación y el mantenimiento de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="04940-256">The Windows Installer has many built-in [standard actions](standard-actions-reference.md) for the installation and maintenance of applications.</span></span> <span data-ttu-id="04940-257">Los desarrolladores deben intentar confiar en las acciones estándar tanto como sea práctico, en lugar de crear sus propias [acciones personalizadas](custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="04940-257">Developers should attempt to rely upon the standard actions as much as practical, rather than create their own [custom actions](custom-actions.md).</span></span> <span data-ttu-id="04940-258">Sin embargo, hay situaciones en las que el desarrollador de un paquete de instalación encuentra que es necesario escribir una acción personalizada.</span><span class="sxs-lookup"><span data-stu-id="04940-258">However, there are situations where the developer of an installation package finds it necessary to write a custom action.</span></span>

-   <span data-ttu-id="04940-259">Siga las instrucciones para el [uso de acciones personalizadas](using-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="04940-259">Follow the guidelines for [Using Custom Actions](using-custom-actions.md).</span></span>
-   <span data-ttu-id="04940-260">Siga las [directrices para proteger las acciones personalizadas](guidelines-for-securing-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="04940-260">Follow the [Guidelines for Securing Custom Actions](guidelines-for-securing-custom-actions.md).</span></span> <span data-ttu-id="04940-261">Las acciones personalizadas que utilizan información confidencial no deben escribir esta información en el registro.</span><span class="sxs-lookup"><span data-stu-id="04940-261">Custom actions that use sensitive information should not write this information into the log.</span></span> <span data-ttu-id="04940-262">Para obtener información, consulte Seguridad de la [acción personalizada](custom-action-security.md).</span><span class="sxs-lookup"><span data-stu-id="04940-262">For information see [Custom Action Security](custom-action-security.md).</span></span>
-   <span data-ttu-id="04940-263">Las acciones personalizadas no deben intentar establecer un punto de entrada de restauración del sistema desde una acción personalizada.</span><span class="sxs-lookup"><span data-stu-id="04940-263">Custom Actions must not attempt to set a System Restore entry point from within a custom action.</span></span> <span data-ttu-id="04940-264">Para obtener información, vea [establecer un punto de restauración desde una acción personalizada](setting-a-restore-point-from-a-custom-action.md).</span><span class="sxs-lookup"><span data-stu-id="04940-264">For information see [Setting a restore point from a Custom Action](setting-a-restore-point-from-a-custom-action.md).</span></span>
-   <span data-ttu-id="04940-265">Devuelva los mensajes de error de las acciones personalizadas y escríbalos en el registro para facilitar la solución de problemas de acciones personalizadas.</span><span class="sxs-lookup"><span data-stu-id="04940-265">Return error messages from custom actions and write them to the log to facilitate troubleshooting custom actions.</span></span> <span data-ttu-id="04940-266">Para obtener información, consulte [acciones personalizadas de mensajes de error](error-message-custom-actions.md) y [devolución de mensajes de error a partir de acciones personalizadas](returning-error-messages-from-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="04940-266">For information see [Error Message Custom Actions](error-message-custom-actions.md) and [Returning Error Messages from Custom Actions](returning-error-messages-from-custom-actions.md).</span></span>
-   <span data-ttu-id="04940-267">No cambie el estado del sistema de una acción personalizada inmediata.</span><span class="sxs-lookup"><span data-stu-id="04940-267">Do not change the system state from an immediate custom action.</span></span> <span data-ttu-id="04940-268">Las acciones personalizadas que cambian el sistema directamente o que llaman a otro servicio del sistema se deben diferir en el momento en que se ejecuta el script de instalación.</span><span class="sxs-lookup"><span data-stu-id="04940-268">Custom actions that change the system directly or call another system service must be deferred to the time when the installation script is executed.</span></span> <span data-ttu-id="04940-269">Cada [acción personalizada de ejecución aplazada](deferred-execution-custom-actions.md) que cambia el estado del sistema debe ir precedida de una [acción personalizada rollback](rollback-custom-actions.md) para deshacer el cambio de estado del sistema en una reversión de instalación.</span><span class="sxs-lookup"><span data-stu-id="04940-269">Every [deferred execution custom action](deferred-execution-custom-actions.md) that changes the system state must be preceded by a [rollback custom action](rollback-custom-actions.md) to undo the system state change on an installation rollback.</span></span> <span data-ttu-id="04940-270">Para obtener información, consulte [cambiar el estado del sistema mediante una acción personalizada](changing-the-system-state-using-a-custom-action.md).</span><span class="sxs-lookup"><span data-stu-id="04940-270">For information see [Changing the System State Using a Custom Action](changing-the-system-state-using-a-custom-action.md).</span></span>
-   <span data-ttu-id="04940-271">Las acciones personalizadas que realizan operaciones de instalación complejas deben ser un [archivo ejecutable](executable-files.md) o una [biblioteca de vínculos dinámicos](dynamic-link-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="04940-271">Custom actions that perform complex installation operations should be an [executable file](executable-files.md) or [dynamic-link library](dynamic-link-libraries.md).</span></span> <span data-ttu-id="04940-272">Limite el uso de acciones personalizadas basadas en [scripts](scripts.md) a operaciones de instalación sencillas.</span><span class="sxs-lookup"><span data-stu-id="04940-272">Limit the use of custom actions based on [scripts](scripts.md) to simple installation operations.</span></span>
-   <span data-ttu-id="04940-273">Facilite los detalles de lo que hace la acción personalizada al sistema para que los administradores del sistema puedan detectar fácilmente.</span><span class="sxs-lookup"><span data-stu-id="04940-273">Make the details of what your custom action does to the system easily discoverable to system administrators.</span></span> <span data-ttu-id="04940-274">Coloque los detalles de las entradas del registro y los archivos usados por la acción personalizada en una tabla personalizada y haga que la acción personalizada se lea desde esta tabla.</span><span class="sxs-lookup"><span data-stu-id="04940-274">Put the details of registry entries and files used by your custom action into a custom table and have the custom action read from this table.</span></span> <span data-ttu-id="04940-275">Esto se muestra en el ejemplo de [uso de una acción personalizada para crear cuentas de usuario en un equipo local](using-a-custom-action-to-create-user-accounts-on-a-local-computer.md).</span><span class="sxs-lookup"><span data-stu-id="04940-275">This is demonstrated by the example in [Using a Custom Action to Create User Accounts on a Local Computer](using-a-custom-action-to-create-user-accounts-on-a-local-computer.md).</span></span> <span data-ttu-id="04940-276">Para obtener información sobre cómo agregar tablas personalizadas a una base de datos, vea [trabajar con consultas](working-with-queries.md) y [ejemplos de consultas de base de datos mediante SQL y script](examples-of-database-queries-using-sql-and-script.md).</span><span class="sxs-lookup"><span data-stu-id="04940-276">For information on adding custom tables to a database, see [Working with Queries](working-with-queries.md) and [Examples of Database Queries Using SQL and Script](examples-of-database-queries-using-sql-and-script.md).</span></span>
-   <span data-ttu-id="04940-277">Una acción personalizada no debe mostrar un cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="04940-277">A custom actions should not display a dialog box.</span></span> <span data-ttu-id="04940-278">Las acciones personalizadas que requieren una interfaz de usuario pueden usar la función [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) en su lugar.</span><span class="sxs-lookup"><span data-stu-id="04940-278">Custom actions requiring a user interface can use the [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) function instead.</span></span> <span data-ttu-id="04940-279">Consulte [envío de mensajes a Windows Installer mediante MsiProcessMessage](sending-messages-to-windows-installer-using-msiprocessmessage.md).</span><span class="sxs-lookup"><span data-stu-id="04940-279">See [Sending Messages to Windows Installer Using MsiProcessMessage](sending-messages-to-windows-installer-using-msiprocessmessage.md).</span></span>
-   <span data-ttu-id="04940-280">Las acciones personalizadas no deben usar ninguna de las funciones enumeradas en la página: [funciones que no se usan en acciones personalizadas](functions-not-for-use-in-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="04940-280">Custom actions must not use any of the functions listed on the page: [Functions Not for Use in Custom Actions](functions-not-for-use-in-custom-actions.md).</span></span>
-   <span data-ttu-id="04940-281">Si la instalación está diseñada para ejecutarse en un servidor de Terminal Server, compruebe que todas las acciones personalizadas pueden ejecutarse en un servidor de Terminal Server.</span><span class="sxs-lookup"><span data-stu-id="04940-281">If the installation is intended to run on a terminal server, test that all your custom actions are capable of running on a terminal server.</span></span> <span data-ttu-id="04940-282">Para obtener más información, consulte propiedad [**TerminalServer**](terminalserver.md) .</span><span class="sxs-lookup"><span data-stu-id="04940-282">For more information see [**TerminalServer**](terminalserver.md) property.</span></span>
-   <span data-ttu-id="04940-283">Para que se ejecute una acción personalizada cuando se desinstale una revisión determinada, la acción personalizada debe estar presente en la aplicación original o debe estar en una revisión para el producto que siempre se aplica.</span><span class="sxs-lookup"><span data-stu-id="04940-283">To have a custom action run when a particular patch is uninstalled the custom action must either be present in the original application or be in a patch for the product that is always applied.</span></span> <span data-ttu-id="04940-284">Para obtener más información, consulte Revisión de la [desinstalación de acciones personalizadas](patch-uninstall-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="04940-284">For more information see [Patch Uninstall Custom Actions](patch-uninstall-custom-actions.md).</span></span>
-   <span data-ttu-id="04940-285">Las acciones personalizadas no deben usar el nivel de interfaz de usuario como condición para enviar mensajes de error al instalador, ya que esto puede interferir con el registro y los mensajes externos.</span><span class="sxs-lookup"><span data-stu-id="04940-285">Custom actions should not use the UI level as a condition for sending error messages to the installer because this can interfere with logging and external messages.</span></span> <span data-ttu-id="04940-286">Para obtener información, vea [determinar el nivel de interfaz de usuario desde una acción personalizada](determining-ui-level-from-a-custom-action.md).</span><span class="sxs-lookup"><span data-stu-id="04940-286">For information see [Determining UI Level from a Custom Action](determining-ui-level-from-a-custom-action.md).</span></span>
-   <span data-ttu-id="04940-287">Use instrucciones condicionales y la sintaxis de la [instrucción condicional](conditional-statement-syntax.md) para asegurarse de que el paquete ejecuta correctamente las acciones personalizadas, no ejecuta acciones personalizadas o ejecuta una acción personalizada alternativa cuando se desinstala el paquete.</span><span class="sxs-lookup"><span data-stu-id="04940-287">Use conditional statements and [Conditional Statement Syntax](conditional-statement-syntax.md) to ensure that your package correctly runs custom actions, does not run a custom actions, or runs alternate custom action when the package is uninstalled.</span></span> <span data-ttu-id="04940-288">Compruebe que el paquete funciona según lo previsto al [desinstalar acciones personalizadas](uninstalling-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="04940-288">Test that the package works as expected when [uninstalling custom actions](uninstalling-custom-actions.md).</span></span> <span data-ttu-id="04940-289">Para obtener información, consulte [operaciones de acondicionamiento que se ejecutan durante la eliminación](conditioning-actions-to-run-during-removal.md) .</span><span class="sxs-lookup"><span data-stu-id="04940-289">For information see [Conditioning Actions to Run During Removal](conditioning-actions-to-run-during-removal.md)</span></span>
-   <span data-ttu-id="04940-290">Si la instalación debe ser capaz de ser ejecutada por usuarios que no tienen privilegios de administrador, realice una prueba para asegurarse de que todas las acciones personalizadas se pueden ejecutar con privilegios que no son de administrador.</span><span class="sxs-lookup"><span data-stu-id="04940-290">If the installation must be capable of being run by users that do not have administrator privileges, test to ensure that all the custom actions can be run with non-administrator privileges.</span></span> <span data-ttu-id="04940-291">Las acciones personalizadas requieren privilegios elevados para modificar partes del sistema que no son específicas del usuario.</span><span class="sxs-lookup"><span data-stu-id="04940-291">Custom actions require elevated privileges to modify parts of the system that are not user specific.</span></span> <span data-ttu-id="04940-292">El instalador puede ejecutar acciones personalizadas con privilegios elevados si se instala una aplicación administrada o si se ha especificado la Directiva del sistema para privilegios elevados.</span><span class="sxs-lookup"><span data-stu-id="04940-292">The installer may run custom actions with elevated privileges if a managed application is being installed or if the system policy has been specified for elevated privileges.</span></span> <span data-ttu-id="04940-293">Todas las acciones personalizadas que requieren privilegios elevados deben incluir la acción personalizada msidbCustomActionTypeInScript y msidbCustomActionTypeNoImpersonate [In-Script las opciones de ejecución](custom-action-in-script-execution-options.md) en el tipo de acción personalizada.</span><span class="sxs-lookup"><span data-stu-id="04940-293">Any custom actions the require elevated privileges must include the msidbCustomActionTypeInScript and msidbCustomActionTypeNoImpersonate [Custom Action In-Script Execution Options](custom-action-in-script-execution-options.md) in the custom action type.</span></span> <span data-ttu-id="04940-294">Esto se muestra en el ejemplo de [uso de una acción personalizada para crear cuentas de usuario en un equipo local](using-a-custom-action-to-create-user-accounts-on-a-local-computer.md).</span><span class="sxs-lookup"><span data-stu-id="04940-294">This is demonstrated by the example in [Using a Custom Action to Create User Accounts on a Local Computer](using-a-custom-action-to-create-user-accounts-on-a-local-computer.md).</span></span>

## <a name="if-you-use-assemblies-follow-good-assembly-practices"></a><span data-ttu-id="04940-295">Si utiliza ensamblados, siga las prácticas recomendadas para el ensamblado</span><span class="sxs-lookup"><span data-stu-id="04940-295">If you use assemblies, follow good assembly practices</span></span>

<span data-ttu-id="04940-296">Si el paquete utiliza [ensamblados](assemblies.md)de software, siga las directrices para [Agregar ensamblados a un paquete](adding-assemblies-to-a-package.md), [Actualizar ensamblados](updating-assemblies.md)e [instalar y quitar ensamblados](installing-and-removing-assemblies.md).</span><span class="sxs-lookup"><span data-stu-id="04940-296">If your package uses software [assemblies](assemblies.md), follow the guidelines for [Adding Assemblies to a Package](adding-assemblies-to-a-package.md), [Updating Assemblies](updating-assemblies.md), and [Installing and Removing Assemblies](installing-and-removing-assemblies.md).</span></span>

## <a name="do-not-ship-concurrent-installations"></a><span data-ttu-id="04940-297">No distribuir instalaciones simultáneas.</span><span class="sxs-lookup"><span data-stu-id="04940-297">Do not ship concurrent installations.</span></span>

<span data-ttu-id="04940-298">Las [instalaciones simultáneas](concurrent-installations.md), también denominadas instalaciones anidadas, instalan otro paquete de Windows Installer durante una instalación en ejecución.</span><span class="sxs-lookup"><span data-stu-id="04940-298">[Concurrent Installations](concurrent-installations.md), also called Nested Installations, install another Windows Installer package during a currently running installation.</span></span> <span data-ttu-id="04940-299">El uso de instalaciones simultáneas no es una buena práctica porque son difíciles de atender a los clientes.</span><span class="sxs-lookup"><span data-stu-id="04940-299">The use of concurrent installations is not a good practice because they are difficult for customers to service.</span></span> <span data-ttu-id="04940-300">Es posible que la revisión y la actualización no funcionen con instalaciones simultáneas.</span><span class="sxs-lookup"><span data-stu-id="04940-300">Patching and upgrading may not work with concurrent installations.</span></span> <span data-ttu-id="04940-301">La alternativa recomendada al uso de instalaciones simultáneas es usar en su lugar una aplicación de instalación y un controlador de interfaz de usuario externo para instalar varios paquetes de Windows Installer de forma secuencial.</span><span class="sxs-lookup"><span data-stu-id="04940-301">The recommended alternative to using concurrent installations is to instead use a setup application and external UI handler to install several Windows Installer packages sequentially.</span></span>

<span data-ttu-id="04940-302">Para obtener más información sobre el uso de un controlador de interfaz de usuario externo, vea [supervisar una instalación mediante MsiSetExternalUI](monitoring-an-installation-using-msisetexternalui.md).</span><span class="sxs-lookup"><span data-stu-id="04940-302">For more information about using an external UI handler see [Monitoring an Installation Using MsiSetExternalUI](monitoring-an-installation-using-msisetexternalui.md).</span></span> <span data-ttu-id="04940-303">Para obtener más información sobre el uso de un controlador externo basado en registros, vea [supervisar una instalación mediante MsiSetExternalUIRecord](monitoring-an-installation-using-msisetexternaluirecord.md).</span><span class="sxs-lookup"><span data-stu-id="04940-303">For more information about using a record-based external handler, see [Monitoring an Installation Using MsiSetExternalUIRecord](monitoring-an-installation-using-msisetexternaluirecord.md).</span></span>

<span data-ttu-id="04940-304">Las instalaciones simultáneas se utilizan a veces en entornos corporativos controlados para instalar aplicaciones que no están pensadas para el público.</span><span class="sxs-lookup"><span data-stu-id="04940-304">Concurrent installations are sometimes used in controlled corporate environments to install applications that are not intended for the public.</span></span> <span data-ttu-id="04940-305">Siga estas instrucciones si decide usar instalaciones simultáneas.</span><span class="sxs-lookup"><span data-stu-id="04940-305">Follow these guidelines if you decide to use concurrent installations.</span></span>

-   <span data-ttu-id="04940-306">No use instalaciones simultáneas para instalar o actualizar un producto de envío.</span><span class="sxs-lookup"><span data-stu-id="04940-306">Do not use concurrent installations to install or update a shipping product.</span></span>
-   <span data-ttu-id="04940-307">Las instalaciones simultáneas no deben compartir componentes.</span><span class="sxs-lookup"><span data-stu-id="04940-307">Concurrent installations should not share components.</span></span>
-   <span data-ttu-id="04940-308">Una instalación administrativa no debe contener una instalación simultánea.</span><span class="sxs-lookup"><span data-stu-id="04940-308">An administrative installation should not contain a concurrent installation.</span></span>
-   <span data-ttu-id="04940-309">Los ProgressBar integrados no deben usarse con instalaciones simultáneas.</span><span class="sxs-lookup"><span data-stu-id="04940-309">Integrated ProgressBars should not be used with concurrent installations.</span></span>
-   <span data-ttu-id="04940-310">Los recursos que se van a anunciar no deben instalarse mediante una instalación simultánea.</span><span class="sxs-lookup"><span data-stu-id="04940-310">Resources that are to be advertised should not be installed by a concurrent installation.</span></span>
-   <span data-ttu-id="04940-311">Un paquete que realiza una instalación simultánea de una aplicación también debe desinstalar la aplicación simultánea cuando se desinstale el producto primario.</span><span class="sxs-lookup"><span data-stu-id="04940-311">A package that performs a concurrent installation of an application should also uninstall the concurrent application when the parent product is uninstalled.</span></span> <span data-ttu-id="04940-312">Existe una instalación anidada en el contexto del producto primario en Agregar o quitar programas en el panel de control.</span><span class="sxs-lookup"><span data-stu-id="04940-312">A nested installation exists under the context of the parent product in the Add/Remove Programs in Control Panel.</span></span>

## <a name="keep-package-names-and-package-codes-consistent"></a><span data-ttu-id="04940-313">Mantener los nombres de paquete y los códigos de paquete coherentes.</span><span class="sxs-lookup"><span data-stu-id="04940-313">Keep package names and package codes consistent.</span></span>

<span data-ttu-id="04940-314">El archivo. msi puede tener cualquier nombre que ayude a los usuarios a identificar el paquete, pero el nombre no debe cambiarse sin cambiar también el código de producto.</span><span class="sxs-lookup"><span data-stu-id="04940-314">The .msi file can be given any name that helps users identify the package, but the name should not be changed without also changing the product code.</span></span>

-   <span data-ttu-id="04940-315">Asigne al archivo. msi un nombre descriptivo que permita al usuario identificar el contenido del paquete de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="04940-315">Give your .msi file a user-friendly name that enables the user to identify the contents of the Windows Installer package.</span></span>
-   <span data-ttu-id="04940-316">El [código de producto](product-codes.md) es la identificación principal de una aplicación y debe cambiar siempre que haya una actualización completa de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="04940-316">The [product code](product-codes.md) is the principal identification of an application and must change whenever there is a comprehensive update to the application.</span></span> <span data-ttu-id="04940-317">Para obtener más información, vea [**ProductCode**](productcode.md) y [cambiar el código de producto](changing-the-product-code.md).</span><span class="sxs-lookup"><span data-stu-id="04940-317">For information, see [**ProductCode**](productcode.md) and [Changing the Product Code](changing-the-product-code.md).</span></span> <span data-ttu-id="04940-318">Cambiar el nombre del archivo. msi de la aplicación se considera un cambio completo y siempre requiere un cambio correspondiente del código del producto para mantener la coherencia.</span><span class="sxs-lookup"><span data-stu-id="04940-318">Changing the name of the application's .msi file is considered a comprehensive change and always requires a corresponding change of the product code to maintain consistency.</span></span>
-   <span data-ttu-id="04940-319">El [código del paquete](package-codes.md) es el identificador principal que usa el instalador para buscar y validar el paquete correcto para una instalación determinada.</span><span class="sxs-lookup"><span data-stu-id="04940-319">The [package code](package-codes.md) is the primary identifier used by the installer to search for and validate the correct package for a given installation.</span></span> <span data-ttu-id="04940-320">Dos archivos. msi no idénticos deben tener el mismo código de paquete.</span><span class="sxs-lookup"><span data-stu-id="04940-320">No two nonidentical .msi files should ever have the same package code.</span></span> <span data-ttu-id="04940-321">Si se cambia un paquete sin cambiar el código de paquete, es posible que el instalador no use el paquete más reciente si ambos siguen siendo accesibles para el instalador.</span><span class="sxs-lookup"><span data-stu-id="04940-321">If a package is changed without changing the package code, the installer may not use the newer package if both are still accessible to the installer.</span></span> <span data-ttu-id="04940-322">El código del paquete se almacena en la propiedad [**Resumen del número de revisión**](revision-number-summary.md) de la secuencia de información de [Resumen](summary-information-stream.md).</span><span class="sxs-lookup"><span data-stu-id="04940-322">The package code is stored in the [**Revision Number Summary**](revision-number-summary.md) Property of the [Summary Information Stream](summary-information-stream.md).</span></span>
-   <span data-ttu-id="04940-323">Tenga en cuenta que las letras del código de producto y los [GUID](guid.md) de código de paquete deben estar en mayúsculas.</span><span class="sxs-lookup"><span data-stu-id="04940-323">Note that letters in product code and package code [GUIDs](guid.md) must all be uppercase.</span></span>

## <a name="do-not-use-the-selfreg-and-typelib-tables"></a><span data-ttu-id="04940-324">No utilice las tablas SelfReg y TypeLib.</span><span class="sxs-lookup"><span data-stu-id="04940-324">Do not use the SelfReg and TypeLib tables.</span></span>

-   <span data-ttu-id="04940-325">Se recomienda encarecidamente a los autores de paquetes de instalación que utilicen el registro automático y la tabla [SelfReg](selfreg-table.md) .</span><span class="sxs-lookup"><span data-stu-id="04940-325">Installation package authors are strongly advised against using self registration and the [SelfReg](selfreg-table.md) table.</span></span> <span data-ttu-id="04940-326">En su lugar, deben registrar módulos mediante la creación de una o varias tablas en el [Grupo tablas del registro](registry-tables-group.md).</span><span class="sxs-lookup"><span data-stu-id="04940-326">Instead they should register modules by authoring one or more of the tables in the [Registry Tables Group](registry-tables-group.md).</span></span> <span data-ttu-id="04940-327">Muchas de las ventajas de los Windows Installer se pierden con el registro automático porque las rutinas de registro automático suelen ocultar la información de configuración crítica.</span><span class="sxs-lookup"><span data-stu-id="04940-327">Many of the benefits of the Windows Installer are lost with self registration because self-registration routines tend to hide critical configuration information.</span></span> <span data-ttu-id="04940-328">Para obtener una lista de las razones para evitar el registro propio, consulte [tabla SelfReg](selfreg-table.md).</span><span class="sxs-lookup"><span data-stu-id="04940-328">For a list of the reasons for avoiding self registration see [SelfReg table](selfreg-table.md).</span></span>
-   <span data-ttu-id="04940-329">Se recomienda encarecidamente a los autores de paquetes de instalación que utilicen la tabla [typelib](typelib-table.md) .</span><span class="sxs-lookup"><span data-stu-id="04940-329">Installation package authors are strongly advised against using the [TypeLib](typelib-table.md) table.</span></span> <span data-ttu-id="04940-330">En lugar de utilizar la tabla TypeLib, registre las bibliotecas de tipos mediante la tabla [del registro](registry-table.md) .</span><span class="sxs-lookup"><span data-stu-id="04940-330">Instead of using the TypeLib table, register type libraries by using [Registry](registry-table.md) table.</span></span> <span data-ttu-id="04940-331">Si se produce un error en una instalación con la tabla TypeLib y se debe revertir, es posible que la reversión no restaure el equipo al mismo estado que existía antes de la reversión.</span><span class="sxs-lookup"><span data-stu-id="04940-331">If an installation using the TypeLib table fails and must be rolled back, the rollback may not restore the computer to the same state that existed prior to the rollback.</span></span>

## <a name="provide-the-option-to-install-without-a-user-interface"></a><span data-ttu-id="04940-332">Proporcione la opción de instalación sin una interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="04940-332">Provide the option to install without a user interface.</span></span>

<span data-ttu-id="04940-333">A menudo, los administradores prefieren implementar aplicaciones dentro de una empresa sin necesidad de interacción del usuario.</span><span class="sxs-lookup"><span data-stu-id="04940-333">Administrators often prefer to deploy applications within a corporation without requiring user interaction.</span></span> <span data-ttu-id="04940-334">Se recomienda habilitar la aplicación para que proporcione la opción de instalar con el [nivel de interfaz de usuario](user-interface-levels.md) ninguno.</span><span class="sxs-lookup"><span data-stu-id="04940-334">It is good practice to enable your application to provide the option of being installed with the [user interface level](user-interface-levels.md) of None.</span></span>

-   <span data-ttu-id="04940-335">Use [las propiedades públicas](public-properties.md) para obtener información de configuración.</span><span class="sxs-lookup"><span data-stu-id="04940-335">Use [public properties](public-properties.md) for configuration information.</span></span> <span data-ttu-id="04940-336">Los administradores pueden proporcionar esta información en la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="04940-336">Administrators can provide this information on the command-line.</span></span>
-   <span data-ttu-id="04940-337">No es necesario que la instalación dependa de la información recopilada de la interacción del usuario con los cuadros de diálogo.</span><span class="sxs-lookup"><span data-stu-id="04940-337">Do not require that the installation depend upon information gathered from user interaction with dialog boxes.</span></span> <span data-ttu-id="04940-338">Esta información no está disponible durante una instalación silenciosa.</span><span class="sxs-lookup"><span data-stu-id="04940-338">This information is not available during a silent installation.</span></span>
-   <span data-ttu-id="04940-339">No reinicie automáticamente el equipo del usuario durante una instalación silenciosa.</span><span class="sxs-lookup"><span data-stu-id="04940-339">Do not automatically restart the user's computer during a silent installation.</span></span>
-   <span data-ttu-id="04940-340">Los administradores pueden establecer el [nivel](user-interface-levels.md) de la interfaz de usuario al instalar mediante la [opción de línea de comandos](command-line-options.md) "/q".</span><span class="sxs-lookup"><span data-stu-id="04940-340">Administrators can set the [user interface level](user-interface-levels.md) when installing by using the [command line option](command-line-options.md) "/q".</span></span> <span data-ttu-id="04940-341">El nivel de interfaz de usuario también se puede establecer mediante programación con una llamada a [**MsiSetInternalUI**](/windows/desktop/api/Msi/nf-msi-msisetinternalui).</span><span class="sxs-lookup"><span data-stu-id="04940-341">The user interface level can also be set programmatically with a call to [**MsiSetInternalUI**](/windows/desktop/api/Msi/nf-msi-msisetinternalui).</span></span>

## <a name="avoid-using-the-alwaysinstallelevated-policy"></a><span data-ttu-id="04940-342">Evite el uso de la Directiva AlwaysInstallElevated.</span><span class="sxs-lookup"><span data-stu-id="04940-342">Avoid using the AlwaysInstallElevated policy.</span></span>

<span data-ttu-id="04940-343">Si no se establece la directiva [AlwaysInstallElevated](alwaysinstallelevated.md) , las aplicaciones no distribuidas por el administrador se instalan con los privilegios del usuario y solo las aplicaciones administradas obtienen privilegios elevados.</span><span class="sxs-lookup"><span data-stu-id="04940-343">If the [AlwaysInstallElevated](alwaysinstallelevated.md) policy is not set, applications not distributed by the administrator are installed using the user's privileges and only managed applications get elevated privileges.</span></span> <span data-ttu-id="04940-344">La configuración de esta directiva indica a Windows Installer que use permisos del sistema cuando instale la aplicación en el sistema.</span><span class="sxs-lookup"><span data-stu-id="04940-344">Setting this policy directs Windows Installer to use system permissions when it installs the application on the system.</span></span> <span data-ttu-id="04940-345">Este método puede abrir un equipo a un riesgo de seguridad, porque cuando se establece esta Directiva, un usuario que no es administrador puede ejecutar instalaciones con privilegios [*elevados*](e-gly.md) y tener acceso a ubicaciones seguras en el equipo.</span><span class="sxs-lookup"><span data-stu-id="04940-345">This method can open a computer to a security risk, because when this policy is set, a non-administrator user can run installations with [*elevated*](e-gly.md) privileges and access secure locations on the computer.</span></span> <span data-ttu-id="04940-346">Es aconsejable usar otro método que la Directiva AlwaysInstallElevated al [instalar un paquete con privilegios elevados para una aplicación administrada que no sea de administración o de](installing-a-package-with-elevated-privileges-for-a-non-admin.md) [revisión Per-User](patching-per-user-managed-applications.md).</span><span class="sxs-lookup"><span data-stu-id="04940-346">It is a good practice to use another method than the AlwaysInstallElevated policy when [Installing a Package with Elevated Privileges for a Non-Admin](installing-a-package-with-elevated-privileges-for-a-non-admin.md) or [Patching Per-User Managed Applications](patching-per-user-managed-applications.md).</span></span>

## <a name="enable-the-disablemedia-policy-to-limit-unauthorized-installation"></a><span data-ttu-id="04940-347">Habilite la Directiva DisableMedia para limitar la instalación no autorizada.</span><span class="sxs-lookup"><span data-stu-id="04940-347">Enable the DisableMedia policy to limit unauthorized installation.</span></span>

<span data-ttu-id="04940-348">La directiva [DisableMedia](disablemedia.md) puede impedir la instalación no autorizada de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="04940-348">The [DisableMedia](disablemedia.md) policy can prevent unauthorized installation of applications.</span></span> <span data-ttu-id="04940-349">Cuando esta directiva está habilitada, los usuarios y administradores que ejecuten una instalación de mantenimiento de un producto no podrán usar el cuadro de diálogo examinar para buscar orígenes multimedia, como un CD-ROM, para los orígenes de otros productos instalables.</span><span class="sxs-lookup"><span data-stu-id="04940-349">When this policy is enabled, users and administrators running a maintenance installation of one product are prevented from using the Browse Dialog to browse media sources, such as CD-ROM, for the sources of other installable products.</span></span> <span data-ttu-id="04940-350">La exploración de otros productos se evita independientemente de si la instalación se realiza con privilegios elevados.</span><span class="sxs-lookup"><span data-stu-id="04940-350">Browsing for other products is prevented regardless of whether the installation is done with elevated privileges.</span></span> <span data-ttu-id="04940-351">Todavía es posible que el usuario vuelva a instalar el producto desde el medio si el usuario tiene un origen de medios correctamente etiquetado.</span><span class="sxs-lookup"><span data-stu-id="04940-351">It is still possible for the user to reinstall the product from media if the user has a correctly labeled media source.</span></span>

## <a name="keep-the-original-package-source-files-secure-and-available-to-users"></a><span data-ttu-id="04940-352">Mantenga los archivos de origen del paquete original seguros y disponibles para los usuarios.</span><span class="sxs-lookup"><span data-stu-id="04940-352">Keep the original package source files secure and available to users.</span></span>

<span data-ttu-id="04940-353">En algunos casos, es posible que se necesite el origen original del paquete de Windows Installer para instalarlo a petición, reparar o actualizar una aplicación.</span><span class="sxs-lookup"><span data-stu-id="04940-353">In some cases the original source of the Windows Installer package may be needed to install-on-demand, repair, or update an application.</span></span> <span data-ttu-id="04940-354">Si el instalador no puede encontrar un origen disponible, se pide al usuario que proporcione medios o que vaya a una ubicación de red que contenga los orígenes necesarios.</span><span class="sxs-lookup"><span data-stu-id="04940-354">If the installer is unable to locate an available source, the user is asked to provide media or to go to a network location containing the needed sources.</span></span> <span data-ttu-id="04940-355">Se recomienda asegurarse de que el instalador tenga los orígenes que necesita sin tener que preguntar al usuario.</span><span class="sxs-lookup"><span data-stu-id="04940-355">It is a good practice to ensure that the installer has the sources it needs without having to prompt the user.</span></span>

-   <span data-ttu-id="04940-356">Use las [firmas digitales y los archivos. cab externos](digital-signatures-and-external-cabinet-files.md) para asegurarse de que los orígenes origs que usa el instalador son seguros.</span><span class="sxs-lookup"><span data-stu-id="04940-356">Use [Digital Signatures and External Cabinet Files](digital-signatures-and-external-cabinet-files.md) to ensure that the origial sources being used by the installer are secure.</span></span> <span data-ttu-id="04940-357">Una imagen de origen sin comprimir almacenada en una ubicación pública no es segura.</span><span class="sxs-lookup"><span data-stu-id="04940-357">An uncompressed source image stored in an public location is not secure.</span></span>
-   <span data-ttu-id="04940-358">Incluya una lista completa de las rutas de acceso de origen de la red o dirección URL al paquete de instalación de la aplicación en la propiedad [**SourceList**](sourcelist.md) .</span><span class="sxs-lookup"><span data-stu-id="04940-358">Include a complete list of network or URL source paths to the application's installation package in the [**SOURCELIST**](sourcelist.md) property.</span></span>
-   <span data-ttu-id="04940-359">Use un recurso compartido de Sistema de archivos distribuido (DFS) para la ruta de acceso de origen.</span><span class="sxs-lookup"><span data-stu-id="04940-359">Use a Distributed File System (DFS) share for the source path.</span></span>
-   <span data-ttu-id="04940-360">Use la API de Windows Installer para recuperar y modificar la información de la lista de código fuente para las aplicaciones y revisiones de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="04940-360">Use the Windows Installer API to retrieve and modify source list information for Windows Installer applications and patches.</span></span> <span data-ttu-id="04940-361">Para obtener información, consulte [Administración de orígenes de instalación](managing-installation-sources.md).</span><span class="sxs-lookup"><span data-stu-id="04940-361">For information see [Managing Installation Sources](managing-installation-sources.md).</span></span>
-   <span data-ttu-id="04940-362">Use los métodos y las propiedades del [**objeto instalador**](installer-object.md), el [**objeto Product**](product-object.md)y el [**objeto patch**](patch-object.md) para recuperar y modificar la información de la lista de origen de Windows Installer Aplicaciones y revisiones.</span><span class="sxs-lookup"><span data-stu-id="04940-362">Use the methods and properties of the [**Installer Object**](installer-object.md), [**Product Object**](product-object.md), and [**Patch Object**](patch-object.md) to retrieve and modify source list information for Windows Installer applications and patches.</span></span>
-   <span data-ttu-id="04940-363">Adhiere a los puntos que se muestran en [impedir que una revisión requiera acceso a los puntos de origen de la instalación original](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md) para minimizar la posibilidad de que la revisión requiera acceso a los orígenes originales.</span><span class="sxs-lookup"><span data-stu-id="04940-363">Adhere to points listed in [Preventing a Patch from Requiring Access to the Original Installation Source](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md) points to minimize the possibility that your patch will require access to the original sources.</span></span>
-   <span data-ttu-id="04940-364">Almacene los archivos de origen del paquete en una ubicación que no sea la carpeta temporal del sistema.</span><span class="sxs-lookup"><span data-stu-id="04940-364">Store the package source files in a location that is not the system's temporary folder.</span></span> <span data-ttu-id="04940-365">Windows Installer archivos de origen almacenados en la carpeta temporal pueden dejar de estar disponibles para los usuarios.</span><span class="sxs-lookup"><span data-stu-id="04940-365">Windows Installer source files stored in the temporary folder can become unavailable to users.</span></span>

## <a name="enable-verbose-logging-on-users-computer-when-troubleshooting-deployment"></a><span data-ttu-id="04940-366">Habilite el registro detallado en el equipo del usuario al solucionar problemas de implementación.</span><span class="sxs-lookup"><span data-stu-id="04940-366">Enable verbose logging on user's computer when troubleshooting deployment.</span></span>

<span data-ttu-id="04940-367">El [registro de Windows Installer](windows-installer-logging.md) incluye una opción de registro detallado que se puede habilitar en el equipo de un usuario.</span><span class="sxs-lookup"><span data-stu-id="04940-367">[Windows Installer Logging](windows-installer-logging.md) includes a verbose logging option that can be enabled on a user's computer.</span></span> <span data-ttu-id="04940-368">La información de un registro detallado puede resultar útil al intentar solucionar problemas de la implementación del paquete Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="04940-368">The information in a verbose log can helpful when trying to troubleshoot Windows Installer package deployment.</span></span>

-   <span data-ttu-id="04940-369">Puede habilitar el registro detallado en el equipo del usuario mediante [las opciones](command-line-options.md)de la línea de comandos, la propiedad [**MsiLogging**](msilogging.md) , la [Directiva de registro](logging.md), [**MsiEnableLog**](/windows/desktop/api/Msi/nf-msi-msienableloga)y el método [**EnableLog**](installer-enablelog.md) .</span><span class="sxs-lookup"><span data-stu-id="04940-369">You can enable verbose logging on the user's computer by using [Command Line Options](command-line-options.md), the [**MsiLogging**](msilogging.md) property, [Logging policy](logging.md), [**MsiEnableLog**](/windows/desktop/api/Msi/nf-msi-msienableloga), and [**EnableLog**](installer-enablelog.md) method.</span></span>
-   <span data-ttu-id="04940-370">Se [Wilogutl.exe](wilogutl-exe.md)un recurso muy útil para interpretar Windows Installer archivos de registro.</span><span class="sxs-lookup"><span data-stu-id="04940-370">A very useful resource for interpreting Windows Installer log files is [Wilogutl.exe](wilogutl-exe.md).</span></span> <span data-ttu-id="04940-371">Esta herramienta ayuda a analizar los archivos de registro y muestra soluciones sugeridas a los errores que se encuentran en un archivo de registro.</span><span class="sxs-lookup"><span data-stu-id="04940-371">This tool assists the analysis of log files and displays suggested solutions to errors that are found in a log file.</span></span>
-   <span data-ttu-id="04940-372">Para obtener más información acerca de cómo interpretar Windows Installer archivos de registro, vea las notas del producto disponibles en el sitio de TechNet: [Windows Installer: Benefits and Implementation for System Administrators](https://www.microsoft.com/technet/prodtechnol/windows2000serv/maintain/featusability/winmsi.mspx).</span><span class="sxs-lookup"><span data-stu-id="04940-372">For more information about interpreting Windows Installer log files, see the white paper available on the TechNet site: [Windows Installer: Benefits and Implementation for System Administrators](https://www.microsoft.com/technet/prodtechnol/windows2000serv/maintain/featusability/winmsi.mspx).</span></span>
-   <span data-ttu-id="04940-373">La opción de registro detallado solo debe usarse para solucionar problemas y no debe dejarse activada porque puede tener efectos negativos en el rendimiento del sistema y en el espacio en disco.</span><span class="sxs-lookup"><span data-stu-id="04940-373">The verbose logging option should be used only for troubleshooting purposes and should not be left on because it can have adverse effects on system performance and disk space.</span></span> <span data-ttu-id="04940-374">Cada vez que se usa la herramienta Agregar o quitar programas del panel de control, se crea un nuevo archivo.</span><span class="sxs-lookup"><span data-stu-id="04940-374">Each time you use the Add/Remove Programs tool in Control Panel, a new file is created.</span></span>

## <a name="uninstallation-leaves-the-users-computer-in-a-clean-state"></a><span data-ttu-id="04940-375">La desinstalación deja el equipo del usuario en un estado limpio.</span><span class="sxs-lookup"><span data-stu-id="04940-375">Uninstallation leaves the user's computer in a clean state.</span></span>

<span data-ttu-id="04940-376">La eliminación de la aplicación es tan importante como la instalación.</span><span class="sxs-lookup"><span data-stu-id="04940-376">Application removal is as important as installation.</span></span> <span data-ttu-id="04940-377">Cuando se desinstala un paquete de Windows Installer, no debe dejar ninguna parte inútil en el equipo del usuario.</span><span class="sxs-lookup"><span data-stu-id="04940-377">When a Windows Installer package is uninstalled it should leave no useless parts of itself behind on the user's computer.</span></span>

-   <span data-ttu-id="04940-378">Si un archivo que se debería haber quitado del equipo del usuario permanece instalado después de ejecutar una desinstalación, es posible que el instalador no esté quitando el componente que contiene el archivo por una o varias de las razones descritas en [quitar archivos en desuso](removing-stranded-files.md).</span><span class="sxs-lookup"><span data-stu-id="04940-378">If a file that should have been removed from the user's computer remains installed after running an uninstall, the installer may not be removing the component containing the file for one or more of the reasons described in [Removing Stranded Files](removing-stranded-files.md).</span></span>
-   <span data-ttu-id="04940-379">Si se debe registrar una aplicación, cree el paquete para quitar la información del registro cuando se desinstale la aplicación.</span><span class="sxs-lookup"><span data-stu-id="04940-379">If an application must be registered, author the package to remove registry information when the application is uninstalled.</span></span> <span data-ttu-id="04940-380">Para obtener información, consulte [Agregar o quitar claves del registro en la instalación o eliminación de componentes](adding-or-removing-registry-keys-on-the-installation-or-removal-of-components.md).</span><span class="sxs-lookup"><span data-stu-id="04940-380">For information see [Adding or Removing Registry Keys on the Installation or Removal of Components](adding-or-removing-registry-keys-on-the-installation-or-removal-of-components.md).</span></span> <span data-ttu-id="04940-381">Si una aplicación no está registrada, la aplicación no aparece en la característica agregar o quitar programas del panel de control y no se puede administrar mediante el Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="04940-381">If an application is not registered, the application is not listed in the Add or Remove Programs feature in Control Panel and cannot be managed by using the Windows Installer.</span></span>
-   <span data-ttu-id="04940-382">Para ocultar una aplicación de la característica agregar o quitar programas del panel de control y seguir pudiendo usar el Windows Installer para administrar la aplicación, siga las instrucciones descritas en [Agregar y quitar una aplicación y no dejar ningún seguimiento en el registro](adding-and-removing-an-application-and-leaving-no-trace-in-the-registry.md).</span><span class="sxs-lookup"><span data-stu-id="04940-382">To hide an application from the Add or Remove Programs feature in Control Panel and still be able to use the Windows Installer to manage the application, follow the guidelines described in [Adding and Removing an Application and Leaving No Trace in the Registry](adding-and-removing-an-application-and-leaving-no-trace-in-the-registry.md).</span></span>
-   <span data-ttu-id="04940-383">Las acciones personalizadas deben estar condicionadas a ejecutarse o no según sea necesario durante la desinstalación.</span><span class="sxs-lookup"><span data-stu-id="04940-383">Custom actions should be conditioned to run or not as needed upon uninstallation.</span></span> <span data-ttu-id="04940-384">Es posible que sea necesario ejecutar diferentes acciones personalizadas al instalar y desinstalar.</span><span class="sxs-lookup"><span data-stu-id="04940-384">Different custom actions may need to run on install and uninstall.</span></span>
-   <span data-ttu-id="04940-385">La información de personalización específica del usuario se puede almacenar en un archivo de texto en el equipo.</span><span class="sxs-lookup"><span data-stu-id="04940-385">User-specific customization information can be stored in a text file on the computer.</span></span> <span data-ttu-id="04940-386">Esto tiene la ventaja de que el archivo se puede quitar cuando se desinstala la aplicación, incluso si el usuario de esta personalización no ha iniciado sesión actualmente.</span><span class="sxs-lookup"><span data-stu-id="04940-386">This has the advantage that the file can be removed when the application is uninstalled, even if the user of this customization is not currently logged on.</span></span>

## <a name="test-packages-for-both-per-user-and-per-machine-installation-deployment"></a><span data-ttu-id="04940-387">Probar paquetes para la implementación de instalación por usuario y por equipo.</span><span class="sxs-lookup"><span data-stu-id="04940-387">Test packages for both per-user and per-machine installation deployment.</span></span>

<span data-ttu-id="04940-388">Se recomienda que los clientes decidan si implementar un paquete para instalarlo en el [contexto de instalación](installation-context.md)por equipo o por usuario.</span><span class="sxs-lookup"><span data-stu-id="04940-388">It is good practice to enable customers to decide whether to deploy a package for installation in either the per-machine or per-user [installation context](installation-context.md).</span></span>

-   <span data-ttu-id="04940-389">Tenga en cuenta si la aplicación debe estar disponible solo para determinados usuarios o para todos los usuarios del equipo durante el proceso de desarrollo.</span><span class="sxs-lookup"><span data-stu-id="04940-389">Consider whether the application should be available to only particular users or all users of the computer during the development process.</span></span>
-   <span data-ttu-id="04940-390">Compruebe que el paquete funciona correctamente para los contextos de instalación por usuario y por equipo.</span><span class="sxs-lookup"><span data-stu-id="04940-390">Test that the package works correctly for both the per-user installation and per-machine installation contexts.</span></span>
-   <span data-ttu-id="04940-391">Facilite la personalización del paquete y permita a los clientes decidir si implementarlos por usuario o por equipo.</span><span class="sxs-lookup"><span data-stu-id="04940-391">Make the package easily customizable and let customers decide whether to deploy it per-user or per-machine.</span></span>

## <a name="plan-and-test-a-servicing-strategy-before-shipping-the-application"></a><span data-ttu-id="04940-392">Planee y pruebe una estrategia de servicio antes de enviar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="04940-392">Plan and test a servicing strategy before shipping the application.</span></span>

<span data-ttu-id="04940-393">Debe decidir cómo desea dar servicio a la aplicación antes de implementar la aplicación por primera vez.</span><span class="sxs-lookup"><span data-stu-id="04940-393">You should decide how you intend to service the application before deploying the application for the first time.</span></span>

-   <span data-ttu-id="04940-394">Tenga en cuenta los tipos de actualizaciones que espera usar para atender su aplicación en el futuro.</span><span class="sxs-lookup"><span data-stu-id="04940-394">Consider the types of updates you expect to use to service your application in the future.</span></span> <span data-ttu-id="04940-395">El Windows Installer proporciona tres tipos de actualizaciones: [Small Update, Small](small-updates.md) [upgrade](minor-upgrades.md)y [major upgrades](major-upgrades.md).</span><span class="sxs-lookup"><span data-stu-id="04940-395">The Windows Installer provides three types of updates: [Small Update](small-updates.md), [Minor Upgrade](minor-upgrades.md), and [Major Upgrades](major-upgrades.md).</span></span> <span data-ttu-id="04940-396">Las diferencias entre estos se describen en el tema [revisiones y actualizaciones](patching-and-upgrades.md) .</span><span class="sxs-lookup"><span data-stu-id="04940-396">The differences between these are described in [Patching and Upgrades](patching-and-upgrades.md) topic.</span></span>
-   <span data-ttu-id="04940-397">Antes de enviar la aplicación, compruebe que funciona según lo esperado después de dar servicio a cada tipo de actualización.</span><span class="sxs-lookup"><span data-stu-id="04940-397">Before shipping your application, test that it works as expected after servicing with each update type.</span></span>

## <a name="reduce-the-dependency-of-updates-upon-the-original-sources"></a><span data-ttu-id="04940-398">Reduzca la dependencia de las actualizaciones en los orígenes originales.</span><span class="sxs-lookup"><span data-stu-id="04940-398">Reduce the dependency of updates upon the original sources.</span></span>

<span data-ttu-id="04940-399">Si los archivos de origen originales son necesarios para actualizar la aplicación, esto puede dificultar el mantenimiento de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="04940-399">If the original source files are required to update your application, this can make servicing the application more difficult.</span></span> <span data-ttu-id="04940-400">Los métodos siguientes pueden ayudar a reducir la dependencia de las actualizaciones en los orígenes originales.</span><span class="sxs-lookup"><span data-stu-id="04940-400">The following methods can help reduce the dependence of updates upon the original sources.</span></span>

-   <span data-ttu-id="04940-401">Use una [*revisión diferencial*](d-gly.md) para actualizar las versiones de línea base de la aplicación, como la versión RTM y las versiones Service Pack.</span><span class="sxs-lookup"><span data-stu-id="04940-401">Use a [*delta patch*](d-gly.md) to update the baseline versions of your application, such as the RTM version and the service pack versions.</span></span> <span data-ttu-id="04940-402">Siga las instrucciones para usar las revisiones Delta descritas en el tema: [reducir el tamaño](reducing-patch-size.md)de la revisión.</span><span class="sxs-lookup"><span data-stu-id="04940-402">Follow the guidelines for using delta patches described in the topic: [Reducing Patch Size](reducing-patch-size.md).</span></span>
-   <span data-ttu-id="04940-403">Siga las recomendaciones que se indican en el tema: [impedir que una revisión requiera acceso al origen de la instalación original](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md).</span><span class="sxs-lookup"><span data-stu-id="04940-403">Follow the recommendations listed in the topic: [Preventing a Patch from Requiring Access to the Original Installation Source](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md).</span></span>

## <a name="do-not-distribute-unserviceable-merge-modules"></a><span data-ttu-id="04940-404">No distribuya módulos de combinación no redistribuibles.</span><span class="sxs-lookup"><span data-stu-id="04940-404">Do not distribute unserviceable merge modules.</span></span>

<span data-ttu-id="04940-405">Las aplicaciones no deben depender de [módulos de combinación](merge-modules.md) para la instalación de componentes si el propietario del módulo de combinación y el propietario de la aplicación son diferentes.</span><span class="sxs-lookup"><span data-stu-id="04940-405">Applications should not depend on [merge modules](merge-modules.md) for the installation of component if the owner of the merge module and the owner of the application are different.</span></span> <span data-ttu-id="04940-406">Esto puede dificultar el servicio de la aplicación porque ambos propietarios deben coordinar para actualizar la aplicación o el módulo.</span><span class="sxs-lookup"><span data-stu-id="04940-406">This can make it difficult to service the application because both owners need to coordinate to update the application or module.</span></span> <span data-ttu-id="04940-407">Sin conocer todas las aplicaciones que han usado el módulo de combinación, el propietario de la aplicación no puede actualizar el módulo de fusión mediante combinación sin que el riesgo de que la actualización sea incompatible con otra aplicación.</span><span class="sxs-lookup"><span data-stu-id="04940-407">Without knowing all the applications that have used the merge module, the owner of the application is unable update the merge module without risking that the update might be incompatible with another application.</span></span> <span data-ttu-id="04940-408">El propietario del módulo de combinación no tiene ningún método directo para actualizar Windows Installer paquetes que ya han instalado el módulo de combinación.</span><span class="sxs-lookup"><span data-stu-id="04940-408">The owner of the merge module has no direct method for updating Windows Installer packages that have already installed the merge module.</span></span>

-   <span data-ttu-id="04940-409">Considere la posibilidad de proporcionar los componentes necesarios a los usuarios como otro Windows Installer instalación.</span><span class="sxs-lookup"><span data-stu-id="04940-409">Consider providing the needed components to users as another Windows Installer installation.</span></span>

## <a name="avoid-patching-administrative-installations"></a><span data-ttu-id="04940-410">Evite aplicar revisiones a las instalaciones administrativas.</span><span class="sxs-lookup"><span data-stu-id="04940-410">Avoid patching administrative installations.</span></span>

<span data-ttu-id="04940-411">Proporcionar en una red una [instalación administrativa](administrative-installation.md) del paquete de Windows Installer original de la aplicación para permitir a los miembros de un grupo de trabajo instalar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="04940-411">Provide on a network an [administrative installation](administrative-installation.md) of your application's original Windows Installer package to enable members of a workgroup to install the application.</span></span> <span data-ttu-id="04940-412">Los usuarios de esta imagen administrativa deben aplicar las actualizaciones a la instancia local de la aplicación que se encuentra en su equipo.</span><span class="sxs-lookup"><span data-stu-id="04940-412">Users of this administrative image should then apply updates to the local instance of the application located on their computer.</span></span> <span data-ttu-id="04940-413">Esto impide que los usuarios se sincronizan con la imagen administrativa.</span><span class="sxs-lookup"><span data-stu-id="04940-413">This keeps users in synchronization with the administrative image.</span></span> <span data-ttu-id="04940-414">No se recomienda aplicar actualizaciones a la instalación administrativa por los siguientes motivos.</span><span class="sxs-lookup"><span data-stu-id="04940-414">Applying updates to the administrative installation is not recommended for the following reasons.</span></span>

-   <span data-ttu-id="04940-415">Se incrementa el tamaño y la latencia de la descarga necesaria para que los usuarios obtengan una actualización en comparación con la descarga de una revisión.</span><span class="sxs-lookup"><span data-stu-id="04940-415">The size and latency of the download required for users to obtain an update is increased compared to downloading a patch.</span></span> <span data-ttu-id="04940-416">Todos los archivos de código fuente y paquete de Windows Installer actualizados deben descargar, volver a almacenar en caché y reinstalar.</span><span class="sxs-lookup"><span data-stu-id="04940-416">The entire updated Windows Installer package and source files must download, recached, and reinstalled.</span></span>
-   <span data-ttu-id="04940-417">Los usuarios no pueden [instalar](installation-on-demand.md) las aplicaciones a petición y reparar desde una instalación administrativa actualizada hasta que vuelvan a almacenar en caché y reinstalen la aplicación.</span><span class="sxs-lookup"><span data-stu-id="04940-417">Users are unable to [installation-on-demand](installation-on-demand.md) and repair applications from an updated administrative installation until they recache and reinstall the application.</span></span>
-   <span data-ttu-id="04940-418">Al aplicar una revisión a una instalación administrativa, se quita la firma digital del paquete.</span><span class="sxs-lookup"><span data-stu-id="04940-418">Applying a patch to an administrative installation removes the digital signature from the package.</span></span> <span data-ttu-id="04940-419">Un administrador debe volver a firmar el paquete.</span><span class="sxs-lookup"><span data-stu-id="04940-419">An administrator must resign the package.</span></span> <span data-ttu-id="04940-420">Para obtener más información sobre el uso de firmas digitales, vea [firmas digitales y Windows Installer](digital-signatures-and-windows-installer.md).</span><span class="sxs-lookup"><span data-stu-id="04940-420">For more information about using digital signatures, see [Digital Signatures and Windows Installer](digital-signatures-and-windows-installer.md).</span></span>
-   <span data-ttu-id="04940-421">Muchas revisiones binarias tienen como destino la imagen RTM de la aplicación y requieren una versión anterior del archivo.</span><span class="sxs-lookup"><span data-stu-id="04940-421">Many binary patches target the RTM image of the application and require a previous file version.</span></span> <span data-ttu-id="04940-422">Es posible que la instancia local de una aplicación instalada desde una instalación administrativa actualizada no funcione con otras actualizaciones.</span><span class="sxs-lookup"><span data-stu-id="04940-422">The local instance of an application installed from an updated administrative installation may not work with other updates.</span></span> <span data-ttu-id="04940-423">Muchas aplicaciones de revisión binaria pueden producir errores.</span><span class="sxs-lookup"><span data-stu-id="04940-423">Many binary patch applications can fail.</span></span>
-   <span data-ttu-id="04940-424">Al aplicar una revisión a una instalación administrativa, se actualizan los archivos de origen y el archivo. msi, pero no se marca la imagen de red con información sobre la actualización.</span><span class="sxs-lookup"><span data-stu-id="04940-424">Applying a patch to an administrative installation updates the source files and the .msi file but does not stamp the network image with information about the update.</span></span> <span data-ttu-id="04940-425">Los usuarios no pueden determinar qué actualizaciones han recibido de la instalación administrativa.</span><span class="sxs-lookup"><span data-stu-id="04940-425">Users cannot determine which updates they have received from the administrative installation.</span></span> <span data-ttu-id="04940-426">Esto hace que sea imposible secuenciar las actualizaciones aplicadas en el lado del usuario con las que ya se han aplicado en el lado de la imagen administrativa.</span><span class="sxs-lookup"><span data-stu-id="04940-426">This makes it impossible to sequence updates applied on the user side with those already applied on the administrative image side.</span></span>
-   <span data-ttu-id="04940-427">Las revisiones aplicadas a una instalación administrativa no son revisiones que no se pueden [instalar](uninstallable-patches.md).</span><span class="sxs-lookup"><span data-stu-id="04940-427">Patches applied to an administrative installation are not [uninstallable patches](uninstallable-patches.md).</span></span> <span data-ttu-id="04940-428">Esto puede impedir que el código de paquete almacenado en caché en el equipo del usuario sea diferente del código del paquete en la instalación administrativa.</span><span class="sxs-lookup"><span data-stu-id="04940-428">This can prevent the package code cached on the user's computer from becoming different than the package code on the administrative installation.</span></span> <span data-ttu-id="04940-429">Si el código de paquete almacenado en memoria caché en el equipo del usuario se diferencia de los de la instalación administrativa, vuelva a instalar la aplicación desde la instalación administrativa y, a continuación, aplique una revisión al equipo cliente.</span><span class="sxs-lookup"><span data-stu-id="04940-429">If the package code cached on the user's computer becomes different from that on the administrative installation, reinstall the application from the administrative installation and then patch the client computer.</span></span>
-   <span data-ttu-id="04940-430">Si decide aplicar actualizaciones pequeñas mediante la aplicación de revisiones en una imagen administrativa, siga las directrices descritas en el tema: [aplicar actualizaciones pequeñas mediante la aplicación de revisiones en una imagen administrativa](applying-small-updates-by-patching-an-administrative-image.md).</span><span class="sxs-lookup"><span data-stu-id="04940-430">If you decide to apply small updates by patching an administrative image, follow the guidelines described in the topic: [Applying Small Updates by Patching an Administrative Image](applying-small-updates-by-patching-an-administrative-image.md).</span></span>

## <a name="register-updates-to-run-with-elevated-privilege"></a><span data-ttu-id="04940-431">Registra las actualizaciones para que se ejecuten con privilegios elevados.</span><span class="sxs-lookup"><span data-stu-id="04940-431">Register updates to run with elevated privilege.</span></span>

<span data-ttu-id="04940-432">A partir de Windows Installer 3,0, es posible aplicar revisiones a una aplicación que se ha instalado en un contexto administrado por el usuario, una vez que se ha registrado la revisión como con privilegios elevados.</span><span class="sxs-lookup"><span data-stu-id="04940-432">Beginning with Windows Installer 3.0, it is possible to apply patches to an application that has been installed in a per-user-managed context, after the patch has been registered as having elevated privileges.</span></span> <span data-ttu-id="04940-433">No se pueden aplicar revisiones a las aplicaciones que se instalan en un contexto administrado por usuario con versiones de Windows Installer anteriores a la versión 3,0.</span><span class="sxs-lookup"><span data-stu-id="04940-433">You cannot apply patches to applications that are installed in a per-user managed context using versions of Windows Installer earlier than version 3.0.</span></span>

-   <span data-ttu-id="04940-434">Use el método [**SourceListAddSource**](patch-sourcelistaddsource.md) o la función [**MsiSourceListAddSourceEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) para registrar un paquete de revisión como con privilegios elevados.</span><span class="sxs-lookup"><span data-stu-id="04940-434">Use the [**SourceListAddSource**](patch-sourcelistaddsource.md) method or [**MsiSourceListAddSourceEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) function to register a patch package as having elevated privileges.</span></span> <span data-ttu-id="04940-435">Siga las instrucciones y los ejemplos proporcionados en la [aplicación de revisiones Per-User aplicaciones administradas](patching-per-user-managed-applications.md).</span><span class="sxs-lookup"><span data-stu-id="04940-435">Follow the guidelines and examples provided in [Patching Per-User Managed Applications](patching-per-user-managed-applications.md).</span></span>
-   <span data-ttu-id="04940-436">Al ejecutar Windows Installer versión 4,0 en Windows Vista, también puede usar la aplicación de [revisiones del control de cuentas de usuario (UAC)](user-account-control--uac--patching.md) para permitir a los autores de instalaciones de Windows Installer identificar revisiones firmadas digitalmente que los usuarios que no son administradores pueden aplicar en el futuro.</span><span class="sxs-lookup"><span data-stu-id="04940-436">When running Windows Installer version 4.0 on Windows Vista you can also use [User Account Control (UAC) Patching](user-account-control--uac--patching.md) to enables the authors of Windows Installer installations to identify digitally-signed patches that can be applied in the future by non-administrator users.</span></span> <span data-ttu-id="04940-437">Esto solo está disponible con la instalación de paquetes en el [contexto de instalación](installation-context.md) por máquina (ALLUSERS = 1).</span><span class="sxs-lookup"><span data-stu-id="04940-437">This is only available with the installation of packages in the per-machine [installation context](installation-context.md) (ALLUSERS=1).</span></span>
-   <span data-ttu-id="04940-438">Asegúrese de que la revisión con privilegios mínimos no se ha deshabilitado mediante el establecimiento de la propiedad [**MSIDISABLELUAPATCHING**](msidisableluapatching.md) o de la directiva [DisableLUAPatching](disableluapatching.md) .</span><span class="sxs-lookup"><span data-stu-id="04940-438">Ensure that least-privilege patching has not been disabled by setting the [**MSIDISABLELUAPATCHING**](msidisableluapatching.md) property or the [DisableLUAPatching](disableluapatching.md) policy.</span></span>

## <a name="use-the-msipatchsequence-table-to-sequence-patches"></a><span data-ttu-id="04940-439">Use la tabla MsiPatchSequence para secuenciar las revisiones.</span><span class="sxs-lookup"><span data-stu-id="04940-439">Use the MsiPatchSequence Table to sequence patches.</span></span>

<span data-ttu-id="04940-440">Incluya una [tabla MsiPatchSequence](msipatchsequence-table.md) en el paquete y agregue la información de secuenciación de revisiones.</span><span class="sxs-lookup"><span data-stu-id="04940-440">Include a [MsiPatchSequence Table](msipatchsequence-table.md) in your package and add patch sequencing information.</span></span> <span data-ttu-id="04940-441">A partir de Windows Installer versión 3,0, el instalador puede usar la tabla MsiPatchSequence al [instalar varias revisiones](installing-multiple-patches.md) para determinar la mejor secuencia de aplicación de revisiones.</span><span class="sxs-lookup"><span data-stu-id="04940-441">Beginning with Windows Installer version 3.0, the installer can use the MsiPatchSequence Table when [installing multiple patches](installing-multiple-patches.md) to determine the best patch application sequence.</span></span> <span data-ttu-id="04940-442">Siga las instrucciones que se describen en las notas del producto de la [secuencia de revisión en Windows Installer versión 3,0](https://www.microsoft.com/downloads/details.aspx?FamilyID=ad7ac91e-2493-4549-ae6f-bf5e007c12a3) para definir familias de revisiones.</span><span class="sxs-lookup"><span data-stu-id="04940-442">Use the guidelines described in the [Patch Sequencing in Windows Installer version 3.0](https://www.microsoft.com/downloads/details.aspx?FamilyID=ad7ac91e-2493-4549-ae6f-bf5e007c12a3) white paper for defining patch families.</span></span>

-   <span data-ttu-id="04940-443">Si es práctico, especifique todas las revisiones como pertenecientes a una única familia de revisiones.</span><span class="sxs-lookup"><span data-stu-id="04940-443">If practical, specify all patches as belonging to a single patch family.</span></span> <span data-ttu-id="04940-444">En muchos casos, una sola familia de revisiones proporciona la flexibilidad suficiente para la secuencia de revisiones.</span><span class="sxs-lookup"><span data-stu-id="04940-444">In many cases a single patch family provides enough flexibility to sequence patches.</span></span> <span data-ttu-id="04940-445">La complejidad de la creación aumenta cuando se usan varias familias de revisiones.</span><span class="sxs-lookup"><span data-stu-id="04940-445">The complexity of authoring increases when multiple patch families are used.</span></span> <span data-ttu-id="04940-446">Asigne un nombre descriptivo a la familia de revisiones y asigne valores de secuencia en esa familia de revisiones que aumenten con el tiempo.</span><span class="sxs-lookup"><span data-stu-id="04940-446">Assign a meaningful name to the patch family and assign sequence values in that patch family that increase over time.</span></span> <span data-ttu-id="04940-447">Siga el ejemplo de aplicación de [revisiones múltiple](multiple-patching-example.md) para aplicar revisiones en el orden en que se han emitido.</span><span class="sxs-lookup"><span data-stu-id="04940-447">Follow the [Multiple Patching Example](multiple-patching-example.md) to apply patches in the order in which they have been issued.</span></span>
-   <span data-ttu-id="04940-448">Use la [tabla PatchSequence](patchsequence-table--patchwiz-dll-.md) de la [Patchwiz.dll](patchwiz-dll.md) para generar la información en la [tabla MsiPatchSequence](msipatchsequence-table.md).</span><span class="sxs-lookup"><span data-stu-id="04940-448">Use the [PatchSequence Table](patchsequence-table--patchwiz-dll-.md) in [Patchwiz.dll](patchwiz-dll.md) to generate the information in [MsiPatchSequence Table](msipatchsequence-table.md).</span></span> <span data-ttu-id="04940-449">La versión de PATCHWIZ.DLL que se lanzó con Windows Installer 3,0 puede generar automáticamente información de secuenciación de revisiones.</span><span class="sxs-lookup"><span data-stu-id="04940-449">The version of PATCHWIZ.DLL that was released with Windows Installer 3.0 can automatically generate patch sequencing information.</span></span> <span data-ttu-id="04940-450">Para obtener más información sobre cómo agregar una nueva revisión, vea [generar información de secuencia de revisión](generating-patch-sequence-information---patchwiz-dll-.md).</span><span class="sxs-lookup"><span data-stu-id="04940-450">For more information on how to add a new patch, see [Generating Patch Sequence Information](generating-patch-sequence-information---patchwiz-dll-.md).</span></span> <span data-ttu-id="04940-451">Para obtener más información sobre los escenarios de secuenciación de revisiones, vea las notas del producto: [secuencia de revisiones en Windows Installer versión 3,0](https://www.microsoft.com/downloads/details.aspx?FamilyID=ad7ac91e-2493-4549-ae6f-bf5e007c12a3).</span><span class="sxs-lookup"><span data-stu-id="04940-451">For more information about patch sequencing scenarios, see the whitepaper: [Patch Sequencing in Windows Installer version 3.0](https://www.microsoft.com/downloads/details.aspx?FamilyID=ad7ac91e-2493-4549-ae6f-bf5e007c12a3).</span></span>

## <a name="test-the-installation-package-thoroughly"></a><span data-ttu-id="04940-452">Pruebe el paquete de instalación exhaustivamente.</span><span class="sxs-lookup"><span data-stu-id="04940-452">Test the installation package thoroughly.</span></span>

<span data-ttu-id="04940-453">Compruebe si la instalación, la reparación y la eliminación del paquete de Windows Installer son correctas.</span><span class="sxs-lookup"><span data-stu-id="04940-453">Test for correct installation, repair, and removal of your Windows Installer package.</span></span> <span data-ttu-id="04940-454">Puede dividir el proceso de prueba en las siguientes partes.</span><span class="sxs-lookup"><span data-stu-id="04940-454">You can divide your testing process into the following parts.</span></span>

-   <span data-ttu-id="04940-455">Pruebas de instalación: Pruebe la instalación con todas las posibles combinaciones de características de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="04940-455">Installation Testing - Test the installation with all possible combinations of application features.</span></span> <span data-ttu-id="04940-456">Probar todos los tipos de instalación, incluida la instalación [administrativa](administrative-installation.md), la [instalación de reversión](rollback-installation.md)y [la instalación a petición](installation-on-demand.md).</span><span class="sxs-lookup"><span data-stu-id="04940-456">Test all types of installation, including [Administrative Installation](administrative-installation.md), [Rollback Installation](rollback-installation.md), and [Installation-On-Demand](installation-on-demand.md).</span></span> <span data-ttu-id="04940-457">Pruebe todos los posibles métodos de instalación, como hacer clic en el archivo. msi, opciones de la [línea de comandos](command-line-options.md)e instalar desde el panel de control.</span><span class="sxs-lookup"><span data-stu-id="04940-457">Try all possible methods of installation, including clicking on the .msi file, [command line options](command-line-options.md), and installing from the control panel.</span></span> <span data-ttu-id="04940-458">Compruebe que los usuarios pueden instalar el paquete en todos los contextos de privilegios posibles.</span><span class="sxs-lookup"><span data-stu-id="04940-458">Test that the package can be installed by users in all possible privilege contexts.</span></span> <span data-ttu-id="04940-459">Intente instalar el paquete después de haber sido implementado por todos los métodos posibles.</span><span class="sxs-lookup"><span data-stu-id="04940-459">Try installing the package after it has been deployed by all possible methods.</span></span> <span data-ttu-id="04940-460">Habilite el [registro de Windows Installer](windows-installer-logging.md) para cada prueba y resuelva todos los errores que se encuentren en el registro del instalador y en el registro de eventos.</span><span class="sxs-lookup"><span data-stu-id="04940-460">Enable [Windows Installer Logging](windows-installer-logging.md) for each test and resolve all errors found in the installer log and event log.</span></span>
-   <span data-ttu-id="04940-461">Pruebas de interfaz de usuario: prueba el paquete cuando se instala con todos los [niveles de interfaz de usuario](user-interface-levels.md)posibles.</span><span class="sxs-lookup"><span data-stu-id="04940-461">User Interface Testing - Test the package when installed with all possible [user interface levels](user-interface-levels.md).</span></span> <span data-ttu-id="04940-462">Pruebe el paquete instalado sin interfaz de usuario y con toda la información proporcionada a través de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="04940-462">Test the package installed with no user interface and with all information provided through the user interface.</span></span> <span data-ttu-id="04940-463">Asegúrese de que la interfaz de usuario tiene [accesibilidad](accessibility.md) y que la interfaz de usuario funciona según lo esperado para las diferentes resoluciones de pantalla y tamaños de fuente.</span><span class="sxs-lookup"><span data-stu-id="04940-463">Ensure the [Accessibility](accessibility.md) of the user interface and that the user interface functions as expected for different screen resolutions and font sizes.</span></span>
-   <span data-ttu-id="04940-464">Pruebas de mantenimiento y reparación: Compruebe que el paquete puede controlar la [revisión y las actualizaciones](patching-and-upgrades.md) entregadas por una [actualización pequeña](small-updates.md), una [actualización mínima](minor-upgrades.md)y [actualizaciones importantes](major-upgrades.md).</span><span class="sxs-lookup"><span data-stu-id="04940-464">Servicing and Repair Testing - Test that the package can handle [Patching and Upgrades](patching-and-upgrades.md) delivered by a [Small Update](small-updates.md), [Minor Upgrade](minor-upgrades.md), and [Major Upgrades](major-upgrades.md).</span></span> <span data-ttu-id="04940-465">Antes de implementar el paquete, escriba una actualización de prueba de cada tipo e intente aplicarla al paquete original.</span><span class="sxs-lookup"><span data-stu-id="04940-465">Before deploying the package, write a trial update of each type and try applying it to the original package.</span></span>
-   <span data-ttu-id="04940-466">Desinstalar pruebas: Compruebe que cuando se quita el paquete no deja ninguna parte no útil en el equipo del usuario y que solo se ha quitado la información que pertenece al paquete.</span><span class="sxs-lookup"><span data-stu-id="04940-466">Uninstall Testing - Verify that when the package is removed it leaves no useless parts of itself behind on the user's computer and that only information belonging to the package has been removed.</span></span> <span data-ttu-id="04940-467">Reinicie el equipo de pruebas después de desinstalar el paquete y comprobar la integridad de las herramientas comunes del sistema y otras aplicaciones estándar.</span><span class="sxs-lookup"><span data-stu-id="04940-467">Reboot the test computer after uninstalling the package and verify the integrity of common system tools and other standard applications.</span></span> <span data-ttu-id="04940-468">Compruebe que los usuarios pueden quitar el paquete en todos los contextos de privilegios posibles.</span><span class="sxs-lookup"><span data-stu-id="04940-468">Test that the package can be removed by users in all possible privilege contexts.</span></span> <span data-ttu-id="04940-469">Probar todos los métodos para quitar el paquete, haga clic en el archivo. msi, pruebe con las opciones de la [línea de comandos](command-line-options.md)y pruebe a quitar el paquete del panel de control.</span><span class="sxs-lookup"><span data-stu-id="04940-469">Test all methods to remove the package, click the .msi file, try the [command line options](command-line-options.md), and try removing the package from the control panel.</span></span> <span data-ttu-id="04940-470">Habilite el [registro de Windows Installer](windows-installer-logging.md) para cada prueba y resuelva todos los errores que se encuentren en el registro del instalador y en el registro de eventos.</span><span class="sxs-lookup"><span data-stu-id="04940-470">Enable [Windows Installer Logging](windows-installer-logging.md) for each test and resolve all errors found in the installer log and event log.</span></span>
-   <span data-ttu-id="04940-471">Pruebas de funcionalidad del producto: Asegúrese de que la aplicación funciona según lo esperado después de la instalación, reparación o eliminación del paquete.</span><span class="sxs-lookup"><span data-stu-id="04940-471">Product Functionality Testing - Ensure that the application functions as expected after the installation, repair, or removal of the package.</span></span>

## <a name="fix-all-validation-errors-before-deploying-a-new-or-revised-installation-package"></a><span data-ttu-id="04940-472">Corrija todos los errores de validación antes de implementar un paquete de instalación nuevo o revisado.</span><span class="sxs-lookup"><span data-stu-id="04940-472">Fix all validation errors before deploying a new or revised installation package.</span></span>

<span data-ttu-id="04940-473">Ejecute la [validación de paquetes](package-validation.md) en un paquete de Windows Installer nuevo o revisado antes de intentar instalarlo por primera vez.</span><span class="sxs-lookup"><span data-stu-id="04940-473">Run [package validation](package-validation.md) on a new or revised Windows Installer package before attempting to install it for the first time.</span></span> <span data-ttu-id="04940-474">La validación comprueba la base de datos de Windows Installer para los errores de creación.</span><span class="sxs-lookup"><span data-stu-id="04940-474">Validation checks the Windows Installer database for authoring errors.</span></span> <span data-ttu-id="04940-475">Si intenta instalar un paquete que no supera la validación, puede dañar el sistema del usuario.</span><span class="sxs-lookup"><span data-stu-id="04940-475">Attempting to install a package that does not pass validation can damage the user's system.</span></span>

-   <span data-ttu-id="04940-476">Puede validar el paquete mediante [Orca.exe](orca-exe.md) o [Msival2.exe](msival2-exe.md).</span><span class="sxs-lookup"><span data-stu-id="04940-476">You can validate your package using [Orca.exe](orca-exe.md) or [Msival2.exe](msival2-exe.md).</span></span> <span data-ttu-id="04940-477">Las dos herramientas se proporcionan con el Windows SDK.</span><span class="sxs-lookup"><span data-stu-id="04940-477">Both tools are provided with the Windows SDK.</span></span> <span data-ttu-id="04940-478">Los proveedores de terceros también pueden incorporar el sistema de validación de ICE en su entorno de creación.</span><span class="sxs-lookup"><span data-stu-id="04940-478">Third-party vendors may also incorporate the ICE validation system into their authoring environment.</span></span>
-   <span data-ttu-id="04940-479">Puede usar el conjunto estándar de [evaluadores de coherencia interna (CIEM)](internal-consistency-evaluators-ices.md) incluido en los archivos. Cub proporcionados con el SDK o personalizar la validación mediante la [creación de un ICE](building-an-ice.md) y su adición al archivo. Cub.</span><span class="sxs-lookup"><span data-stu-id="04940-479">You can use the standard set of [Internal Consistency Evaluators - ICEs](internal-consistency-evaluators-ices.md) included in the .cub files provided with the SDK, or customize validation by [Building an ICE](building-an-ice.md) and adding it to the .cub file.</span></span>
-   <span data-ttu-id="04940-480">Puede utilizar la Evalcom2.dll para implementar la [automatización](validation-automation.md) de la validación para los paquetes de instalación y los módulos de combinación.</span><span class="sxs-lookup"><span data-stu-id="04940-480">You can use the Evalcom2.dll to implement [Validation Automation](validation-automation.md) for installation packages and merge modules.</span></span>

## <a name="author-a-secure-installation"></a><span data-ttu-id="04940-481">Cree una instalación segura.</span><span class="sxs-lookup"><span data-stu-id="04940-481">Author a secure installation.</span></span>

<span data-ttu-id="04940-482">Siga estas instrucciones al desarrollar el paquete para ayudar a mantener un entorno seguro durante la instalación.</span><span class="sxs-lookup"><span data-stu-id="04940-482">Following these guidelines when developing your package to help maintain a secure environment during installation.</span></span>

-   [<span data-ttu-id="04940-483">Directrices para crear instalaciones seguras</span><span class="sxs-lookup"><span data-stu-id="04940-483">Guidelines for Authoring Secure Installations</span></span>](guidelines-for-authoring-secure-installations.md)
-   [<span data-ttu-id="04940-484">Directrices para proteger paquetes en equipos bloqueados</span><span class="sxs-lookup"><span data-stu-id="04940-484">Guidelines for Securing Packages on Locked-Down Computers</span></span>](guidelines-for-securing-packages-on-locked-down-computers.md)
-   [<span data-ttu-id="04940-485">Directrices para proteger las acciones personalizadas</span><span class="sxs-lookup"><span data-stu-id="04940-485">Guidelines for Securing Custom Actions</span></span>](guidelines-for-securing-custom-actions.md)

## <a name="use-pmsihandle-instead-of-handle"></a><span data-ttu-id="04940-486">Usar PMSIHANDLE en lugar de HANDLE</span><span class="sxs-lookup"><span data-stu-id="04940-486">Use PMSIHANDLE instead of HANDLE</span></span>

<span data-ttu-id="04940-487">Las variables de tipo **PMSIHANDLE** se definen en MSI. h.</span><span class="sxs-lookup"><span data-stu-id="04940-487">The **PMSIHANDLE** type variables is defined in msi.h.</span></span> <span data-ttu-id="04940-488">Se recomienda que la aplicación use el tipo **PMSIHANDLE** porque el instalador cierra los objetos **PMSIHANDLE** cuando salen del ámbito, mientras que la aplicación debe cerrar los objetos **MSIHANDLE** llamando a [**MsiCloseHandle**](/windows/desktop/api/Msi/nf-msi-msiclosehandle).</span><span class="sxs-lookup"><span data-stu-id="04940-488">It is recommended that your application use the **PMSIHANDLE** type because the installer closes **PMSIHANDLE** objects as they go out of scope, whereas your application must close **MSIHANDLE** objects by calling [**MsiCloseHandle**](/windows/desktop/api/Msi/nf-msi-msiclosehandle).</span></span>

<span data-ttu-id="04940-489">Por ejemplo, si utiliza código similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="04940-489">For example, if you use code like this:</span></span>

``` syntax
MSIHANDLE hRec = MsiCreateRecord(3);
```

<span data-ttu-id="04940-490">Cámbielo a:</span><span class="sxs-lookup"><span data-stu-id="04940-490">Change it to:</span></span>

``` syntax
PMSIHANDLE hRec = MsiCreateRecord(3);
```

 

 
