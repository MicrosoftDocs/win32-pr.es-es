---
description: Windows Update Agent (WUA) se actualiza automáticamente cuando se conecta a un servidor Windows Server Update Services (WSUS) o Windows Update.
ms.assetid: 829112ab-b240-4cc4-8053-18b484934886
title: Actualizando Windows Update agente
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b00fe439b1bea377e2699f6fe5714b208ac5d951
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "105715269"
---
# <a name="updating-windows-update-agent"></a><span data-ttu-id="109d0-103">Actualizando Windows Update agente</span><span class="sxs-lookup"><span data-stu-id="109d0-103">Updating Windows Update Agent</span></span>

<span data-ttu-id="109d0-104">Windows Update Agent (WUA) se actualiza a través de varios medios, en función de la versión de Windows que se ejecuta en el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="109d0-104">Windows Update Agent (WUA) updates itself through various means, depending on the version of Windows running on the device.</span></span> <span data-ttu-id="109d0-105">Es posible que las versiones anteriores de WUA no puedan conectarse a los servicios de actualización actuales, puede que no sean compatibles con todas las actualizaciones y puede que no sean compatibles con todas las API documentadas.</span><span class="sxs-lookup"><span data-stu-id="109d0-105">Old versions of WUA may not be able to connect to current update services, may not be compatible with all updates, and may not support all documented APIs.</span></span> <span data-ttu-id="109d0-106">Aquí se explica cómo asegurarse de que WUA está totalmente actualizado y es compatible.</span><span class="sxs-lookup"><span data-stu-id="109d0-106">Here is how to insure that WUA is fully updated and compatible.</span></span>

<span data-ttu-id="109d0-107">**En las versiones de Windows a partir de Windows 7 y Windows Server 2008 R2**</span><span class="sxs-lookup"><span data-stu-id="109d0-107">**On versions of Windows beginning with Windows 7 and Windows Server 2008 R2**</span></span>

<span data-ttu-id="109d0-108">Las actualizaciones periódicas del agente de Windows Update (WUA) se incluyen en las actualizaciones periódicas periódicas de Windows distribuidas a través de Windows Update o Windows Server Update Services (WSUS).</span><span class="sxs-lookup"><span data-stu-id="109d0-108">Windows Update Agent (WUA) updates are included in the regular periodic updates to Windows distributed through Windows Update or to Windows Server Update Services (WSUS).</span></span> <span data-ttu-id="109d0-109">No es necesario realizar ningún paso especial para actualizar WUA en estas versiones de Windows.</span><span class="sxs-lookup"><span data-stu-id="109d0-109">You do not need to take any special steps to update WUA on these Windows versions.</span></span>

<span data-ttu-id="109d0-110">**En versiones de Windows anteriores a Windows 7 y Windows Server 2008 R2**</span><span class="sxs-lookup"><span data-stu-id="109d0-110">**On versions of Windows prior to Windows 7 and Windows Server 2008 R2**</span></span>

<span data-ttu-id="109d0-111">WUA se actualiza automáticamente cuando Actualizaciones automáticas se conecta a Windows Update o a WSUS.</span><span class="sxs-lookup"><span data-stu-id="109d0-111">WUA automatically updates itself when Automatic Updates connects to Windows Update or to WSUS.</span></span>

<span data-ttu-id="109d0-112">Si Actualizaciones automáticas aún no se ha ejecutado correctamente, es posible que un dispositivo que ejecute estas versiones de Windows Ejecute una versión anterior de WUA que no admita todas las API documentadas.</span><span class="sxs-lookup"><span data-stu-id="109d0-112">If Automatic Updates has not yet successfully run, it is possible that a device running these Windows versions will be running an older version of WUA that does not support all the documented APIs.</span></span> <span data-ttu-id="109d0-113">Si recibe un WU_E_SELFUPDATE_REQUIRED resultado cuando usa la API de WUA para realizar un análisis, descarga o instalación, este error indica que la versión instalada de WUA es demasiado antigua para conectarse a los servicios de Windows Update actuales.</span><span class="sxs-lookup"><span data-stu-id="109d0-113">If you receive a WU_E_SELFUPDATE_REQUIRED result when you use the WUA API to perform a scan, download, or install, this error tells you that the installed version of WUA is too old to connect to current Windows Update services.</span></span> <span data-ttu-id="109d0-114">No se pueden usar las API de WUA normales para actualizar WUA en estos sistemas operativos.</span><span class="sxs-lookup"><span data-stu-id="109d0-114">You cannot use the normal WUA APIs to update WUA on these operating systems.</span></span> 

<span data-ttu-id="109d0-115">Un usuario puede actualizar de forma manual el WUA a una versión actual; para ello, abra el panel de control de Windows Update, seleccione Buscar actualizaciones y acepte la actualización automática que aparece.</span><span class="sxs-lookup"><span data-stu-id="109d0-115">A user can manually update WUA to a current version by opening the Windows Update control panel, selecting Check for Updates, then accepting the self-update that appears.</span></span> <span data-ttu-id="109d0-116">Como alternativa, puede actualizar WUA mediante programación.</span><span class="sxs-lookup"><span data-stu-id="109d0-116">Alternately, you can update WUA programmatically.</span></span>

<span data-ttu-id="109d0-117">**Para actualizar el WUA mediante programación en versiones de Windows anteriores a Windows 7 y Windows Server 2008 R2**</span><span class="sxs-lookup"><span data-stu-id="109d0-117">**To programmatically update WUA on versions of Windows prior to Windows 7 and Windows Server 2008 R2**</span></span>

1.  <span data-ttu-id="109d0-118">Use las API de [WinHTTP](../winhttp/winhttp-start-page.md) para descargar [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab).</span><span class="sxs-lookup"><span data-stu-id="109d0-118">Use the [WinHTTP](../winhttp/winhttp-start-page.md) APIs to download [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab).</span></span>
2.  <span data-ttu-id="109d0-119">Use las [funciones de criptografía](../seccrypto/cryptography-functions.md) para comprobar que la copia descargada de [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab) tiene una firma digital de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="109d0-119">Use the [Cryptography Functions](../seccrypto/cryptography-functions.md) to verify that the downloaded copy of [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab) has a digital signature from Microsoft.</span></span> <span data-ttu-id="109d0-120">Si no puede comprobar la firma digital, detenga.</span><span class="sxs-lookup"><span data-stu-id="109d0-120">If you can't verify the digital signature, stop.</span></span>
3.  <span data-ttu-id="109d0-121">Use las API de la [interfaz de descompresión de archivos](../devnotes/cabinet-api-functions.md) para extraer el archivo XML de [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab).</span><span class="sxs-lookup"><span data-stu-id="109d0-121">Use the [File Decompression Interface](../devnotes/cabinet-api-functions.md) APIs to extract the XML file from [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab).</span></span>
4.  <span data-ttu-id="109d0-122">Use las API de Microsoft XML Core Services ([MSXML](/previous-versions/windows/desktop/ms763742(v=vs.85))) para cargar el archivo XML y ubicar el nodo WURedist/StandaloneRedist/Architecture para la arquitectura del equipo.</span><span class="sxs-lookup"><span data-stu-id="109d0-122">Use the Microsoft XML Core Services ([MSXML](/previous-versions/windows/desktop/ms763742(v=vs.85))) APIs to load the XML file and locate the WURedist/StandaloneRedist/architecture node for the computer's architecture.</span></span> <span data-ttu-id="109d0-123">Por ejemplo, para x86, busque el nodo WURedist/StandaloneRedist/Architecture con el atributo **Name** de x86.</span><span class="sxs-lookup"><span data-stu-id="109d0-123">For example, for x86, locate the WURedist/StandaloneRedist/architecture node with the **name** attribute of x86.</span></span>
5.  <span data-ttu-id="109d0-124">Llame a [**IWindowsUpdateAgentInfo:: GetInfo**](/windows/desktop/api/Wuapi/nf-wuapi-iwindowsupdateagentinfo-getinfo) para determinar la versión actual de WUA.</span><span class="sxs-lookup"><span data-stu-id="109d0-124">Call [**IWindowsUpdateAgentInfo::GetInfo**](/windows/desktop/api/Wuapi/nf-wuapi-iwindowsupdateagentinfo-getinfo) to determine the current version of WUA.</span></span> <span data-ttu-id="109d0-125">Si **IWindowsUpdateAgentInfo:: GetInfo** devuelve un número de versión que es al menos tan alto como el atributo **clientVersion** en el nodo de arquitectura que encontró, detenga.</span><span class="sxs-lookup"><span data-stu-id="109d0-125">If **IWindowsUpdateAgentInfo::GetInfo** returns a version number that is at least as high as the **clientVersion** attribute in the architecture node you located, stop.</span></span>
6.  <span data-ttu-id="109d0-126">Use las API de [MSXML](/previous-versions/windows/desktop/ms763742(v=vs.85)) para leer el atributo **downloadUrl** del nodo de arquitectura que encontró.</span><span class="sxs-lookup"><span data-stu-id="109d0-126">Use the [MSXML](/previous-versions/windows/desktop/ms763742(v=vs.85)) APIs to read the **downloadUrl** attribute from the architecture node that you located.</span></span> <span data-ttu-id="109d0-127">**downloadUrl** proporciona la dirección URL de descarga para el instalador de WUA adecuado para la arquitectura del equipo.</span><span class="sxs-lookup"><span data-stu-id="109d0-127">**downloadUrl** gives you the download URL for the appropriate WUA installer for the computer's architecture.</span></span>
7.  <span data-ttu-id="109d0-128">Use las API de [WinHTTP](../winhttp/winhttp-start-page.md) para descargar el instalador adecuado.</span><span class="sxs-lookup"><span data-stu-id="109d0-128">Use the [WinHTTP](../winhttp/winhttp-start-page.md) APIs to download the appropriate installer.</span></span>
8.  <span data-ttu-id="109d0-129">Use la función [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) o una API similar para ejecutar el instalador descargado.</span><span class="sxs-lookup"><span data-stu-id="109d0-129">Use the [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) function or a similar API to execute the downloaded installer.</span></span>

 

 
