---
description: Orígenes en directo
ms.assetid: 571fe5e5-9616-463b-837c-f8dbb8adf1be
title: Orígenes en directo
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 43486cf3db797f493c9446bf782989b8beaae829
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/06/2021
ms.locfileid: "104495065"
---
# <a name="live-sources"></a><span data-ttu-id="81eab-103">Orígenes en directo</span><span class="sxs-lookup"><span data-stu-id="81eab-103">Live Sources</span></span>

<span data-ttu-id="81eab-104">Un origen en directo, también denominado *origen* de la extracción, recibe datos en tiempo real.</span><span class="sxs-lookup"><span data-stu-id="81eab-104">A live source, also called a *push source*, receives data in real time.</span></span> <span data-ttu-id="81eab-105">Algunos ejemplos son captura de vídeo y difusión de red.</span><span class="sxs-lookup"><span data-stu-id="81eab-105">Examples include video capture and network broadcasts.</span></span> <span data-ttu-id="81eab-106">En general, un origen en directo no puede controlar la velocidad a la que llegan los datos.</span><span class="sxs-lookup"><span data-stu-id="81eab-106">In general, a live source cannot control the rate at which data arrives.</span></span>

<span data-ttu-id="81eab-107">Se considera que un filtro es un origen en directo si se cumple alguna de las siguientes condiciones:</span><span class="sxs-lookup"><span data-stu-id="81eab-107">A filter is considered to be a live source if either of the following are true:</span></span>

-   <span data-ttu-id="81eab-108">El filtro devuelve la \_ marca AM Filter \_ Misc \_ Flags \_ es \_ Source del método [**IAMFilterMiscFlags:: GetMiscFlags**](/windows/desktop/api/Strmif/nf-strmif-iamfiltermiscflags-getmiscflags) y al menos uno de sus clavijas de salida expone la interfaz [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) .</span><span class="sxs-lookup"><span data-stu-id="81eab-108">The filter returns the AM\_FILTER\_MISC\_FLAGS\_IS\_SOURCE flag from the [**IAMFilterMiscFlags::GetMiscFlags**](/windows/desktop/api/Strmif/nf-strmif-iamfiltermiscflags-getmiscflags) method, AND at least one of its output pins exposes the [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) interface.</span></span>
-   <span data-ttu-id="81eab-109">El filtro expone la interfaz de [**IKsPropertySet**](ikspropertyset.md) y tiene un PIN de captura ( \_ captura de categoría de PIN \_ ).</span><span class="sxs-lookup"><span data-stu-id="81eab-109">The filter exposes the [**IKsPropertySet**](ikspropertyset.md) interface and has a capture pin (PIN\_CATEGORY\_CAPTURE).</span></span> <span data-ttu-id="81eab-110">Consulte [conjunto de propiedades de PIN](pin-property-set.md) para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="81eab-110">See [Pin Property Set](pin-property-set.md) for more information.</span></span>

<span data-ttu-id="81eab-111">Si un filtro de origen activo proporciona un reloj, el administrador de gráficos de filtros preferirá ese reloj cuando elija el reloj de referencia del gráfico.</span><span class="sxs-lookup"><span data-stu-id="81eab-111">If a live source filter provides a clock, the Filter Graph Manager will prefer that clock when it chooses the graph reference clock.</span></span> <span data-ttu-id="81eab-112">Consulte [relojes de referencia](reference-clocks.md) para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="81eab-112">See [Reference Clocks](reference-clocks.md) for more information.</span></span>

<span data-ttu-id="81eab-113">**Latency**</span><span class="sxs-lookup"><span data-stu-id="81eab-113">**Latency**</span></span>

<span data-ttu-id="81eab-114">La latencia de un filtro es la cantidad de tiempo que tarda el filtro en procesar un ejemplo.</span><span class="sxs-lookup"><span data-stu-id="81eab-114">A filter's latency is the amount of time it takes the filter to process a sample.</span></span> <span data-ttu-id="81eab-115">En el caso de los orígenes en directo, la latencia viene determinada por el tamaño del búfer usado para contener ejemplos.</span><span class="sxs-lookup"><span data-stu-id="81eab-115">For live sources, the latency is determined by the size of the buffer used to hold samples.</span></span> <span data-ttu-id="81eab-116">Por ejemplo, supongamos que el gráfico de filtros tiene un origen de vídeo con una latencia de 33 milisegundos (MS) y un origen de audio con una latencia de 500 ms.</span><span class="sxs-lookup"><span data-stu-id="81eab-116">For example, suppose the filter graph has a video source with a latency of 33 milliseconds (ms) and an audio source with a latency of 500 ms.</span></span> <span data-ttu-id="81eab-117">Cada fotograma de vídeo llega al representador de vídeo aproximadamente 470 MS antes de que el ejemplo de audio correspondiente llegue al representador de audio.</span><span class="sxs-lookup"><span data-stu-id="81eab-117">Each video frame arrives at the video renderer about 470 ms before the matching audio sample reaches the audio renderer.</span></span> <span data-ttu-id="81eab-118">A menos que el gráfico compense la diferencia, el audio y el vídeo no se sincronizarán.</span><span class="sxs-lookup"><span data-stu-id="81eab-118">Unless the graph compensates for the difference, the audio and video will not be synchronized.</span></span>

<span data-ttu-id="81eab-119">Los orígenes en directo se pueden sincronizar a través de la interfaz [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) .</span><span class="sxs-lookup"><span data-stu-id="81eab-119">Live sources can be synchronized through the [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) interface.</span></span> <span data-ttu-id="81eab-120">El administrador de gráficos de filtro no sincroniza los orígenes en directo a menos que la aplicación habilite la sincronización llamando al método [**IAMGraphStreams:: SyncUsingStreamOffset**](/windows/desktop/api/Strmif/nf-strmif-iamgraphstreams-syncusingstreamoffset) .</span><span class="sxs-lookup"><span data-stu-id="81eab-120">The Filter Graph Manager does not synchronize live sources unless the application enables synchronization by calling the [**IAMGraphStreams::SyncUsingStreamOffset**](/windows/desktop/api/Strmif/nf-strmif-iamgraphstreams-syncusingstreamoffset) method.</span></span> <span data-ttu-id="81eab-121">Si está habilitada la sincronización, el administrador de gráficos de filtros consulta cada filtro de origen de **IAMPushSource**.</span><span class="sxs-lookup"><span data-stu-id="81eab-121">If synchronization is enabled, the Filter Graph Manager queries each source filter for **IAMPushSource**.</span></span> <span data-ttu-id="81eab-122">Si el filtro admite **IAMPushSource**, el administrador de gráficos de filtros llama a [**IAMLatency:: GetLatency**](/windows/desktop/api/Strmif/nf-strmif-iamlatency-getlatency) para recuperar la latencia esperada del filtro.</span><span class="sxs-lookup"><span data-stu-id="81eab-122">If the filter supports **IAMPushSource**, the Filter Graph Manager calls [**IAMLatency::GetLatency**](/windows/desktop/api/Strmif/nf-strmif-iamlatency-getlatency) to retrieve the filter's expected latency.</span></span> <span data-ttu-id="81eab-123">(La interfaz **IAMPushSource** hereda [**IAMLatency**](/windows/desktop/api/Strmif/nn-strmif-iamlatency)). A partir de los valores de latencia combinada, el administrador de gráficos de filtro determina la latencia máxima esperada en el gráfico.</span><span class="sxs-lookup"><span data-stu-id="81eab-123">(The **IAMPushSource** interface inherits [**IAMLatency**](/windows/desktop/api/Strmif/nn-strmif-iamlatency).) From the combined latency values, the Filter Graph Manager determines the maximum expected latency in the graph.</span></span> <span data-ttu-id="81eab-124">Después llama a [**IAMPushSource:: SetStreamOffset**](/windows/desktop/api/Strmif/nf-strmif-iampushsource-setstreamoffset) para dar a cada filtro de origen un desplazamiento de flujo, que ese filtro agrega a las marcas de tiempo que genera.</span><span class="sxs-lookup"><span data-stu-id="81eab-124">It then calls [**IAMPushSource::SetStreamOffset**](/windows/desktop/api/Strmif/nf-strmif-iampushsource-setstreamoffset) to give each source filter a stream offset, which that filter adds to the time stamps that it generates.</span></span>

<span data-ttu-id="81eab-125">Este método está pensado principalmente para la vista previa dinámica.</span><span class="sxs-lookup"><span data-stu-id="81eab-125">This method is intended primarily for live preview.</span></span> <span data-ttu-id="81eab-126">Sin embargo, tenga en cuenta que un PIN de vista previa en un dispositivo de captura en directo (por ejemplo, una cámara) no establece marcas de tiempo en los ejemplos que entrega.</span><span class="sxs-lookup"><span data-stu-id="81eab-126">However, note that a preview pin on a live capture device (such as a camera) does not set time stamps on the samples it delivers.</span></span> <span data-ttu-id="81eab-127">Por lo tanto, para usar este método con un dispositivo de captura en directo, debe obtener una vista previa del PIN de captura.</span><span class="sxs-lookup"><span data-stu-id="81eab-127">Therefore, to use this method with a live capture device, you must preview from the capture pin.</span></span> <span data-ttu-id="81eab-128">Para obtener más información, consulte [filtros de captura de vídeo de DirectShow](directshow-video-capture-filters.md).</span><span class="sxs-lookup"><span data-stu-id="81eab-128">For more information, see [DirectShow Video Capture Filters](directshow-video-capture-filters.md).</span></span>

<span data-ttu-id="81eab-129">Actualmente, la interfaz [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) es compatible con el filtro de [captura VFW](vfw-capture-filter.md) y el filtro de [captura de audio](audio-capture-filter.md) .</span><span class="sxs-lookup"><span data-stu-id="81eab-129">Currently the [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) interface is supported by the [VFW Capture](vfw-capture-filter.md) filter and the [Audio Capture](audio-capture-filter.md) filter.</span></span>

<span data-ttu-id="81eab-130">**Coincidencia de velocidad**</span><span class="sxs-lookup"><span data-stu-id="81eab-130">**Rate Matching**</span></span>

<span data-ttu-id="81eab-131">Si un filtro de representador programa ejemplos con un reloj de referencia, pero el filtro de origen los genera mediante un reloj diferente, pueden producirse problemas en la reproducción.</span><span class="sxs-lookup"><span data-stu-id="81eab-131">If a renderer filter schedules samples using one reference clock, but the source filter produces them using a different clock, glitches can occur in playback.</span></span> <span data-ttu-id="81eab-132">El representador puede ejecutarse más rápido que el origen, lo que provoca huecos en los datos.</span><span class="sxs-lookup"><span data-stu-id="81eab-132">The renderer might run faster than the source, causing gaps in the data.</span></span> <span data-ttu-id="81eab-133">O podría ejecutarse más lentamente que el origen, lo que provocaría que los ejemplos se prohicieran, hasta el momento en el que el gráfico quitará los ejemplos.</span><span class="sxs-lookup"><span data-stu-id="81eab-133">Or it might run slower than the source, causing samples to "bunch up," until at some point the graph will drop samples.</span></span> <span data-ttu-id="81eab-134">Normalmente, un origen en directo no puede controlar su tasa de producción, por lo que el representador debe coincidir con las tarifas del origen.</span><span class="sxs-lookup"><span data-stu-id="81eab-134">Typically, a live source cannot control its production rate, so instead the renderer should match rates with the source.</span></span>

<span data-ttu-id="81eab-135">Actualmente, solo el procesador de audio realiza la búsqueda de coincidencias, ya que los problemas de reproducción de audio son más evidentes que los problemas de vídeo.</span><span class="sxs-lookup"><span data-stu-id="81eab-135">Currently, only the audio renderer performs rate matching, because glitches in audio playback are more noticeable than glitches in video.</span></span> <span data-ttu-id="81eab-136">Para realizar la coincidencia de velocidad, el representador de audio debe seleccionar algo con el que coincidirá con las tarifas.</span><span class="sxs-lookup"><span data-stu-id="81eab-136">To perform rate-matching, the audio renderer must select something against which it will match rates.</span></span> <span data-ttu-id="81eab-137">Usa el algoritmo siguiente:</span><span class="sxs-lookup"><span data-stu-id="81eab-137">It uses the following algorithm:</span></span>

-   <span data-ttu-id="81eab-138">Si el gráfico no usa un reloj de referencia, el representador de audio no intenta coincidir con las tasas.</span><span class="sxs-lookup"><span data-stu-id="81eab-138">If the graph is not using a reference clock, the audio renderer does not try to match rates.</span></span> <span data-ttu-id="81eab-139">(Cada vez que el gráfico no tiene ningún reloj de referencia, los ejemplos siempre se representan inmediatamente a medida que llegan).</span><span class="sxs-lookup"><span data-stu-id="81eab-139">(Whenever the graph has no reference clock, samples are always rendered immediately as they arrive.)</span></span>
-   <span data-ttu-id="81eab-140">De lo contrario, si hay un reloj de referencia para el gráfico, el representador de audio comprueba si hay un flujo ascendente de origen en directo, mediante los criterios descritos anteriormente.</span><span class="sxs-lookup"><span data-stu-id="81eab-140">Otherwise, if there is a reference clock for the graph, the audio renderer checks whether there is a live source upstream, using the criteria described previously.</span></span> <span data-ttu-id="81eab-141">En caso contrario, el representador de audio no coincide con las tasas.</span><span class="sxs-lookup"><span data-stu-id="81eab-141">If not, the audio renderer does not match rates.</span></span>
-   <span data-ttu-id="81eab-142">Si hay una conexión ascendente de origen en directo y ese origen expone la interfaz [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) en su PIN de salida, el representador de audio llama a [**IAMPushSource:: GetPushSourceFlags**](/windows/desktop/api/Strmif/nf-strmif-iampushsource-getpushsourceflags).</span><span class="sxs-lookup"><span data-stu-id="81eab-142">If there is a live source upstream, and that source exposes the [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) interface on its output pin, the audio renderer calls [**IAMPushSource::GetPushSourceFlags**](/windows/desktop/api/Strmif/nf-strmif-iampushsource-getpushsourceflags).</span></span> <span data-ttu-id="81eab-143">Busca una de las marcas siguientes:</span><span class="sxs-lookup"><span data-stu-id="81eab-143">It looks for one of the following flags:</span></span>
    -   <span data-ttu-id="81eab-144">\_PUSHSOURCECAPS a \_ . m \_ .</span><span class="sxs-lookup"><span data-stu-id="81eab-144">AM\_PUSHSOURCECAPS\_INTERNAL\_RM.</span></span> <span data-ttu-id="81eab-145">Esta marca significa que el filtro de origen tiene su propio mecanismo de coincidencia de velocidad, por lo que el representador de audio no coincide con las tasas.</span><span class="sxs-lookup"><span data-stu-id="81eab-145">This flag means the source filter has its own rate-matching mechanism, so the audio renderer does not match rates.</span></span>
    -   <span data-ttu-id="81eab-146">AM \_ PUSHSOURCECAPS \_ not \_ Live.</span><span class="sxs-lookup"><span data-stu-id="81eab-146">AM\_PUSHSOURCECAPS\_NOT\_LIVE.</span></span> <span data-ttu-id="81eab-147">Esta marca significa que el filtro de origen no es realmente un origen en directo, aunque expone la interfaz [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) .</span><span class="sxs-lookup"><span data-stu-id="81eab-147">This flag means the source filter is not really a live source, even though it exposes the [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) interface.</span></span> <span data-ttu-id="81eab-148">Por lo tanto, el representador de audio no coincide con las tasas.</span><span class="sxs-lookup"><span data-stu-id="81eab-148">Therefore, the audio renderer does not match rates.</span></span>
    -   <span data-ttu-id="81eab-149">\_ \_ reloj privado PUSHSOURCECAPS \_ .</span><span class="sxs-lookup"><span data-stu-id="81eab-149">AM\_PUSHSOURCECAPS\_PRIVATE\_CLOCK.</span></span> <span data-ttu-id="81eab-150">Esta marca significa que el filtro de origen usa un reloj privado para generar marcas de tiempo.</span><span class="sxs-lookup"><span data-stu-id="81eab-150">This flag means the source filter is using a private clock to generate time stamps.</span></span> <span data-ttu-id="81eab-151">En este caso, el representador de audio coincide con las tasas de las marcas de tiempo.</span><span class="sxs-lookup"><span data-stu-id="81eab-151">In this case, the audio renderer matches rates against the time stamps.</span></span> <span data-ttu-id="81eab-152">(Si los ejemplos no tienen marcas de tiempo, sin embargo, el representador omite este marcador).</span><span class="sxs-lookup"><span data-stu-id="81eab-152">(If the samples have no time stamps, however, the renderer ignores this flag.)</span></span>
-   <span data-ttu-id="81eab-153">Si [**GetPushSourceFlags**](/windows/desktop/api/Strmif/nf-strmif-iampushsource-getpushsourceflags) no devuelve marcas (cero), el comportamiento del representador de audio depende del reloj del gráfico y de si los ejemplos tienen marcas de tiempo:</span><span class="sxs-lookup"><span data-stu-id="81eab-153">If [**GetPushSourceFlags**](/windows/desktop/api/Strmif/nf-strmif-iampushsource-getpushsourceflags) returns no flags (zero), the audio renderer's behavior depends on the graph clock and whether the samples have time stamps:</span></span>
    -   <span data-ttu-id="81eab-154">Si el procesador de audio no es el reloj del gráfico y los ejemplos tienen marcas de tiempo, el representador de audio coincide con las tasas de las marcas de tiempo.</span><span class="sxs-lookup"><span data-stu-id="81eab-154">If the audio renderer is not the graph clock, AND the samples have time stamps, the audio renderer matches rates against the time stamps.</span></span>
    -   <span data-ttu-id="81eab-155">Si los ejemplos no tienen marcas de tiempo, el procesador de audio intenta coincidir con la velocidad de los datos de audio entrantes.</span><span class="sxs-lookup"><span data-stu-id="81eab-155">If the samples do not have time stamps, the audio renderer tries to match the rate of incoming audio data.</span></span>
    -   <span data-ttu-id="81eab-156">Si el procesador de audio es el reloj del gráfico, intenta coincidir con la velocidad de datos de entrada.</span><span class="sxs-lookup"><span data-stu-id="81eab-156">If the audio renderer is the graph clock, it tries to match the incoming data rate.</span></span>

<span data-ttu-id="81eab-157">El motivo del último caso es el siguiente: Si el procesador de audio es el reloj de referencia, y el filtro de origen usa el mismo reloj para generar marcas de tiempo, el representador de audio no puede coincidir con las tasas de las marcas de tiempo.</span><span class="sxs-lookup"><span data-stu-id="81eab-157">The reason for the last case is the following: If the audio renderer is the reference clock, and the source filter is using the same clock to generate time stamps, then the audio renderer cannot match rates against the time stamps.</span></span> <span data-ttu-id="81eab-158">Si lo hiciera, en efecto sería intentar hacer coincidir las tasas con sí misma, lo que podría provocar que el reloj se desplazara.</span><span class="sxs-lookup"><span data-stu-id="81eab-158">If it did, in effect it would be trying to match rates with itself, which could cause the clock to drift.</span></span> <span data-ttu-id="81eab-159">Por lo tanto, en este caso, el representador coincide con la tasa de datos de audio entrantes.</span><span class="sxs-lookup"><span data-stu-id="81eab-159">Therefore, in this case the renderer matches the rate of incoming audio data.</span></span>

## <a name="related-topics"></a><span data-ttu-id="81eab-160">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="81eab-160">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="81eab-161">Hora y relojes en DirectShow</span><span class="sxs-lookup"><span data-stu-id="81eab-161">Time and Clocks in DirectShow</span></span>](time-and-clocks-in-directshow.md)
</dt> </dl>

 

 



