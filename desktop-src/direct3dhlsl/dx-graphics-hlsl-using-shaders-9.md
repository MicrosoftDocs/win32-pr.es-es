---
title: Usar sombreadores en Direct3D 9
description: Usar sombreadores en Direct3D 9
ms.assetid: 8d8f5124-fbf3-4af5-8399-43ba28aa6eb9
ms.topic: article
ms.date: 05/31/2018
topic_type:
- kbArticle
api_name: ''
api_type: ''
api_location: ''
ms.openlocfilehash: 6455b47d24c1c83683ce8b85c48990bb32e221ae
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104997048"
---
# <a name="using-shaders-in-direct3d-9"></a><span data-ttu-id="5ff9b-103">Usar sombreadores en Direct3D 9</span><span class="sxs-lookup"><span data-stu-id="5ff9b-103">Using Shaders in Direct3D 9</span></span>

-   [<span data-ttu-id="5ff9b-104">Compilar un sombreador para hardware específico</span><span class="sxs-lookup"><span data-stu-id="5ff9b-104">Compiling a Shader for Specific Hardware</span></span>](#compiling-a-shader-for-specific-hardware)
-   [<span data-ttu-id="5ff9b-105">Inicializar constantes de sombreador</span><span class="sxs-lookup"><span data-stu-id="5ff9b-105">Initializing Shader Constants</span></span>](#initializing-shader-constants)
-   [<span data-ttu-id="5ff9b-106">Enlazar un parámetro de sombreador a un registro determinado</span><span class="sxs-lookup"><span data-stu-id="5ff9b-106">Binding a Shader Parameter to a Particular Register</span></span>](#binding-a-shader-parameter-to-a-particular-register)
-   [<span data-ttu-id="5ff9b-107">Representar un sombreador programable</span><span class="sxs-lookup"><span data-stu-id="5ff9b-107">Rendering a Programmable Shader</span></span>](#rendering-a-programmable-shader)
-   [<span data-ttu-id="5ff9b-108">Depurar sombreadores</span><span class="sxs-lookup"><span data-stu-id="5ff9b-108">Debugging Shaders</span></span>](#debugging-shaders)
-   [<span data-ttu-id="5ff9b-109">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="5ff9b-109">Related topics</span></span>](#related-topics)

## <a name="compiling-a-shader-for-specific-hardware"></a><span data-ttu-id="5ff9b-110">Compilar un sombreador para hardware específico</span><span class="sxs-lookup"><span data-stu-id="5ff9b-110">Compiling a Shader for Specific Hardware</span></span>

<span data-ttu-id="5ff9b-111">Los sombreadores se agregaron por primera vez a Microsoft DirectX en DirectX 8,0.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-111">Shaders were first added to Microsoft DirectX in DirectX 8.0.</span></span> <span data-ttu-id="5ff9b-112">En ese momento, se definieron varias máquinas de sombreador virtual, cada una de las cuales corresponde aproximadamente a un procesador de gráficos determinado producido por los principales proveedores de gráficos 3D.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-112">At that time, several virtual shader machines were defined, each roughly corresponding to a particular graphics processor produced by the top 3D graphics vendors.</span></span> <span data-ttu-id="5ff9b-113">Para cada uno de estos equipos de sombreador virtual, se diseñó un lenguaje de ensamblado.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-113">For each of these virtual shader machines, an assembly language was designed.</span></span> <span data-ttu-id="5ff9b-114">Los programas escritos en los modelos de sombreador (nombres frente a \_ 1 \_ 1 y PS 1 \_ \_ 1-PS \_ 1 \_ 4) fueron relativamente cortos y, por lo general, los escribieron los desarrolladores directamente en el lenguaje de ensamblado adecuado.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-114">Programs written to the shader models (names vs\_1\_1 and ps\_1\_1 - ps\_1\_4) were relatively short and were generally written by developers directly in the appropriate assembly language.</span></span> <span data-ttu-id="5ff9b-115">La aplicación pasaría este código de lenguaje de ensamblado legible a la biblioteca de D3DX mediante [**D3DXAssembleShader**](/windows/desktop/direct3d9/d3dxassembleshader) y obtener una representación binaria del sombreador que, a su vez, se pasaría con [**CreateVertexShader**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9-createvertexshader) o [**CreatePixelShader**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9-createpixelshader).</span><span class="sxs-lookup"><span data-stu-id="5ff9b-115">The application would pass this human-readable assembly language code to the D3DX library using [**D3DXAssembleShader**](/windows/desktop/direct3d9/d3dxassembleshader) and get back a binary representation of the shader which would in turn get passed using [**CreateVertexShader**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9-createvertexshader) or [**CreatePixelShader**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9-createpixelshader).</span></span> <span data-ttu-id="5ff9b-116">Para obtener más información, vea el kit de desarrollo de software (SDK) de.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-116">For more detail, see the software development kit (SDK).</span></span>

<span data-ttu-id="5ff9b-117">La situación en Direct3D 9 es similar.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-117">The situation in Direct3D 9 is similar.</span></span> <span data-ttu-id="5ff9b-118">Una aplicación pasa un sombreador HLSL a D3DX mediante [**D3DXCompileShader**](/windows/desktop/direct3d9/d3dxcompileshader) y devuelve una representación binaria del sombreador compilado que, a su vez, se pasa a Microsoft Direct3D mediante [**CreatePixelShader**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9-createpixelshader) o [**CreateVertexShader**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9-createvertexshader).</span><span class="sxs-lookup"><span data-stu-id="5ff9b-118">An application passes an HLSL shader to D3DX using [**D3DXCompileShader**](/windows/desktop/direct3d9/d3dxcompileshader) and gets back a binary representation of the compiled shader which in turn is passed to Microsoft Direct3D using [**CreatePixelShader**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9-createpixelshader) or [**CreateVertexShader**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9-createvertexshader).</span></span> <span data-ttu-id="5ff9b-119">El runtime no sabe nada sobre HLSL, solo los modelos de sombreador de ensamblados binarios.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-119">The runtime does not know anything about HLSL, only the binary assembly shader models.</span></span> <span data-ttu-id="5ff9b-120">Esto es muy útil porque significa que el compilador de HLSL se puede actualizar independientemente del tiempo de ejecución de Direct3D.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-120">This is nice because it means that the HLSL compiler can be updated independent of the Direct3D runtime.</span></span> <span data-ttu-id="5ff9b-121">También puede compilar sombreadores sin conexión mediante [FXC](/windows/desktop/direct3dtools/fxc).</span><span class="sxs-lookup"><span data-stu-id="5ff9b-121">You can also compile shaders offline using [fxc](/windows/desktop/direct3dtools/fxc).</span></span>

<span data-ttu-id="5ff9b-122">Además del desarrollo del compilador de HLSL, Direct3D 9 también incorporó los modelos de sombreador de nivel de ensamblado para exponer la funcionalidad de la última generación de hardware de gráficos.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-122">In addition to the development of the HLSL compiler, Direct3D 9 also introduced the assembly-level shader models to expose the functionality of the latest generation of graphics hardware.</span></span> <span data-ttu-id="5ff9b-123">Los desarrolladores de aplicaciones pueden trabajar en ensamblados para estos nuevos modelos (vs \_ 2 \_ 0, vs \_ 3 \_ 0, PS \_ 2 \_ 0, PS \_ 3 \_ 0), pero esperamos que la mayoría de los desarrolladores pasen a HLSL para el desarrollo del sombreador.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-123">Application developers can work in assembly for these new models (vs\_2\_0, vs\_3\_0, ps\_2\_0, ps\_3\_0) but we expect most developers to move to HLSL for shader development.</span></span>

<span data-ttu-id="5ff9b-124">Por supuesto, la capacidad de escribir un programa HLSL para expresar un algoritmo de sombreado determinado no permite que se ejecute automáticamente en ningún hardware determinado.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-124">Of course, the ability to write an HLSL program to express a particular shading algorithm does not automatically enable it to run on any given hardware.</span></span> <span data-ttu-id="5ff9b-125">Una aplicación llama a D3DX para compilar un sombreador en el código de ensamblado binario con [**D3DXCompileShader**](/windows/desktop/direct3d9/d3dxcompileshader).</span><span class="sxs-lookup"><span data-stu-id="5ff9b-125">An application calls D3DX to compile a shader into binary assembly code with [**D3DXCompileShader**](/windows/desktop/direct3d9/d3dxcompileshader).</span></span> <span data-ttu-id="5ff9b-126">Una de las limitaciones de este punto de entrada es un parámetro que define cuál de los modelos de nivel de ensamblado (o destinos de compilación) debe usar el compilador de HLSL para expresar el código del sombreador final.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-126">One of the limitations with this entry point is a parameter that defines which of the assembly-level models (or compilation targets) the HLSL compiler should use to express the final shader code.</span></span> <span data-ttu-id="5ff9b-127">Si una aplicación está realizando la compilación del sombreador HLSL en tiempo de ejecución (en lugar del tiempo de compilación o sin conexión), la aplicación podría examinar las capacidades del dispositivo Direct3D y seleccionar el destino de compilación para que coincida.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-127">If an application is doing HLSL shader compilation at run time (as opposed to compile time or offline), the application could examine the capabilities of the Direct3D device and select the compilation target to match.</span></span> <span data-ttu-id="5ff9b-128">Si el algoritmo expresado en el sombreador HLSL es demasiado complejo para ejecutarse en el destino de compilación seleccionado, se producirá un error en la compilación.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-128">If the algorithm expressed in the HLSL shader is too complex to execute on the selected compilation target, compilation will fail.</span></span> <span data-ttu-id="5ff9b-129">Esto significa que, aunque HLSL es una gran ventaja para el desarrollo del sombreador, no libera a los desarrolladores de las realidades de la entrega de juegos a una audiencia de destino con dispositivos gráficos de distintas funcionalidades.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-129">This means that while HLSL is a huge benefit to shader development, it does not free developers from the realities of shipping games to a target audience with graphics devices of varying capabilities.</span></span> <span data-ttu-id="5ff9b-130">Como desarrollador de juegos, todavía tiene que administrar un enfoque en capas para los objetos visuales; Esto significa que se escriben mejores sombreadores para tarjetas gráficas más capaces y se escriben versiones más básicas para tarjetas más antiguas.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-130">As a game developer, you still have to manage a tiered approach to your visuals; this means writing better shaders for more capable graphics cards and writing more basic versions for older cards.</span></span> <span data-ttu-id="5ff9b-131">Sin embargo, con HLSL bien escrito, esta carga se puede simplificar considerablemente.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-131">With well written HLSL, however, this burden can be eased significantly.</span></span>

<span data-ttu-id="5ff9b-132">En lugar de compilar sombreadores HLSL con D3DX en el equipo del cliente en el momento de la carga de la aplicación o al usarse por primera vez, muchos desarrolladores optan por compilar su sombreador de HLSL en código de ensamblado binario antes de que se envíen.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-132">Rather than compile HLSL shaders using D3DX on the customer's machine at application load time or on first use, many developers choose to compile their shader from HLSL to binary assembly code before they even ship.</span></span> <span data-ttu-id="5ff9b-133">Esto mantiene el código fuente de HLSL fuera de los ojos no contratados y también garantiza que todos los sombreadores que su aplicación ejecuten se han pasado por su proceso de control de calidad interno.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-133">This keeps their HLSL source code away from prying eyes and also ensures that all the shaders their application will ever run have gone through their internal quality assurance process.</span></span> <span data-ttu-id="5ff9b-134">Una utilidad adecuada para compilar sombreadores sin conexión es [FXC](/windows/desktop/direct3dtools/fxc).</span><span class="sxs-lookup"><span data-stu-id="5ff9b-134">A convenient utility for compiling shaders offline is [fxc](/windows/desktop/direct3dtools/fxc).</span></span> <span data-ttu-id="5ff9b-135">Esta herramienta tiene una serie de opciones que puede usar para compilar código para el destino de compilación especificado.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-135">This tool has a number of options that you can use to compile code for the specified compile target.</span></span> <span data-ttu-id="5ff9b-136">Estudiar la salida desensamblada puede ser muy educativo durante el desarrollo si desea optimizar los sombreadores o, por lo general, conocer las funcionalidades de la máquina del sombreador virtual en un nivel más detallado.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-136">Studying the disassembled output can be very educational during development if you want to optimize your shaders or just generally get to know the virtual shader machine's capabilities at a more detailed level.</span></span> <span data-ttu-id="5ff9b-137">Estas opciones se resumen a continuación:</span><span class="sxs-lookup"><span data-stu-id="5ff9b-137">These options are summarized below:</span></span>

## <a name="initializing-shader-constants"></a><span data-ttu-id="5ff9b-138">Inicializar constantes de sombreador</span><span class="sxs-lookup"><span data-stu-id="5ff9b-138">Initializing Shader Constants</span></span>

<span data-ttu-id="5ff9b-139">Las constantes de sombreador están contenidas en la tabla de constantes.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-139">Shader constants are contained in the constant table.</span></span> <span data-ttu-id="5ff9b-140">Se puede tener acceso a este a través de la interfaz [**ID3DXConstantTable**](/windows/desktop/direct3d9/id3dxconstanttable) .</span><span class="sxs-lookup"><span data-stu-id="5ff9b-140">This can be accessed with the [**ID3DXConstantTable**](/windows/desktop/direct3d9/id3dxconstanttable) interface.</span></span> <span data-ttu-id="5ff9b-141">Las variables de sombreador global se pueden inicializar en el código del sombreador.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-141">Global shader variables can be initialized in shader code.</span></span> <span data-ttu-id="5ff9b-142">Se inicializan en tiempo de ejecución mediante una llamada a [**SetDefaults**](/windows/desktop/direct3d9/id3dxconstanttable--setdefaults).</span><span class="sxs-lookup"><span data-stu-id="5ff9b-142">These are initialized at run time by calling [**SetDefaults**](/windows/desktop/direct3d9/id3dxconstanttable--setdefaults).</span></span>

## <a name="binding-a-shader-parameter-to-a-particular-register"></a><span data-ttu-id="5ff9b-143">Enlazar un parámetro de sombreador a un registro determinado</span><span class="sxs-lookup"><span data-stu-id="5ff9b-143">Binding a Shader Parameter to a Particular Register</span></span>

<span data-ttu-id="5ff9b-144">El compilador asignará automáticamente los registros a las variables globales.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-144">The compiler will automatically assign registers to global variables.</span></span> <span data-ttu-id="5ff9b-145">El compilador asignaría el entorno al registro de muestra S0, SparkleNoise al registro de muestra S1 y k \_ s al registro constante C0 (suponiendo que ya no se asignaron otros registros de muestra o de constantes) para las tres variables globales siguientes:</span><span class="sxs-lookup"><span data-stu-id="5ff9b-145">The compiler would assign Environment to sampler register s0, SparkleNoise to sampler register s1, and k\_s to constant register c0 (assuming no other sampler or constant registers were already assigned) for the following three global variables:</span></span>


```
sampler Environment;
sampler SparkleNoise;
float4 k_s;
```



<span data-ttu-id="5ff9b-146">También es posible enlazar variables a un registro específico.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-146">It is also possible to bind variables to a specific register.</span></span> <span data-ttu-id="5ff9b-147">Para forzar al compilador a que se asigne a un registro determinado, use la siguiente sintaxis:</span><span class="sxs-lookup"><span data-stu-id="5ff9b-147">To force the compiler to assign to a particular register, use the following syntax:</span></span>


```
register(RegisterName)
```



<span data-ttu-id="5ff9b-148">donde RegisterName es el nombre del registro específico.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-148">where RegisterName is the name of the specific register.</span></span> <span data-ttu-id="5ff9b-149">En los siguientes ejemplos se muestra la sintaxis de asignación de registro específica, en la que el entorno de muestra se enlazará al registro de muestra S1, SparkleNoise se enlazará al registro de muestra S0 y k \_ s se enlazará al registro constante C12:</span><span class="sxs-lookup"><span data-stu-id="5ff9b-149">The following examples demonstrate the specific register assignment syntax, where the sampler Environment will be bound to sampler register s1, SparkleNoise will be bound to sampler register s0, and k\_s will be bound to constant register c12:</span></span>


```
sampler Environment : register(s1);
sampler SparkleNoise : register(s0);
float4 k_s : register(c12);
```



## <a name="rendering-a-programmable-shader"></a><span data-ttu-id="5ff9b-150">Representar un sombreador programable</span><span class="sxs-lookup"><span data-stu-id="5ff9b-150">Rendering a Programmable Shader</span></span>

<span data-ttu-id="5ff9b-151">Un sombreador se representa estableciendo el sombreador actual en el dispositivo, Inicializando las constantes del sombreador, indicando el dispositivo del que proceden los distintos datos de entrada y, por último, la representación de los primitivos.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-151">A shader is rendered by setting the current shader in the device, initializing the shader constants, telling the device where the varying input data is coming from, and finally rendering the primitives.</span></span> <span data-ttu-id="5ff9b-152">Cada una de ellas se puede realizar mediante una llamada a los métodos siguientes, respectivamente:</span><span class="sxs-lookup"><span data-stu-id="5ff9b-152">Each of these can be accomplished by calling the following methods respectively:</span></span>

-   [<span data-ttu-id="5ff9b-153">**SetVertexShader**</span><span class="sxs-lookup"><span data-stu-id="5ff9b-153">**SetVertexShader**</span></span>](/windows/desktop/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setvertexshader)
-   [<span data-ttu-id="5ff9b-154">**SetVertexShaderConstantF**</span><span class="sxs-lookup"><span data-stu-id="5ff9b-154">**SetVertexShaderConstantF**</span></span>](/windows/desktop/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setvertexshaderconstantf)
-   [<span data-ttu-id="5ff9b-155">**SetStreamSource**</span><span class="sxs-lookup"><span data-stu-id="5ff9b-155">**SetStreamSource**</span></span>](/windows/desktop/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setstreamsource)
-   [<span data-ttu-id="5ff9b-156">**DrawPrimitive**</span><span class="sxs-lookup"><span data-stu-id="5ff9b-156">**DrawPrimitive**</span></span>](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9-drawprimitive)

## <a name="debugging-shaders"></a><span data-ttu-id="5ff9b-157">Depurar sombreadores</span><span class="sxs-lookup"><span data-stu-id="5ff9b-157">Debugging Shaders</span></span>

<span data-ttu-id="5ff9b-158">La extensión de DirectX para Microsoft Visual Studio .NET proporciona un depurador de HLSL totalmente integrado en el entorno de desarrollo integrado (IDE) de Visual Studio .NET.</span><span class="sxs-lookup"><span data-stu-id="5ff9b-158">The DirectX extension for Microsoft Visual Studio .NET is provides a fully integrated HLSL debugger within the Visual Studio .NET Integrated Development Environment (IDE).</span></span> <span data-ttu-id="5ff9b-159">Para preparar la depuración del sombreador, debe instalar las herramientas adecuadas en el equipo (consulte [depuración de sombreadores en Visual Studio (Direct3D 9)](dx-graphics-hlsl-debug-visual-studio.md)).</span><span class="sxs-lookup"><span data-stu-id="5ff9b-159">In order to prepare for shader debugging, you must install the right tools on your machine (see [Debugging Shaders in Visual Studio (Direct3D 9)](dx-graphics-hlsl-debug-visual-studio.md)).</span></span>

## <a name="related-topics"></a><span data-ttu-id="5ff9b-160">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="5ff9b-160">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="5ff9b-161">Guía de programación para HLSL</span><span class="sxs-lookup"><span data-stu-id="5ff9b-161">Programming Guide for HLSL</span></span>](dx-graphics-hlsl-pguide.md)
</dt> </dl>

 

 