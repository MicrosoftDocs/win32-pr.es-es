---
description: Un proveedor de eventos puede dedicar mucho tiempo a la creación de eventos.
ms.assetid: 5cf414f0-b3a8-4623-9aaa-08e2a28b40c0
ms.tgt_platform: multiple
title: Optimizar un proveedor de eventos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 70eaabfbbd462b831059b10590d7959bdef05cbc
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "105707210"
---
# <a name="optimizing-an-event-provider"></a><span data-ttu-id="7b176-103">Optimizar un proveedor de eventos</span><span class="sxs-lookup"><span data-stu-id="7b176-103">Optimizing an Event Provider</span></span>

<span data-ttu-id="7b176-104">Un proveedor de eventos puede dedicar mucho tiempo a la creación de eventos.</span><span class="sxs-lookup"><span data-stu-id="7b176-104">An event provider may devote a great deal of time to creating events.</span></span> <span data-ttu-id="7b176-105">Si ninguna aplicación cliente usa los eventos creados, el proveedor desperdicia recursos del sistema.</span><span class="sxs-lookup"><span data-stu-id="7b176-105">If no client applications use the created events, then the provider is wasting system resources.</span></span> <span data-ttu-id="7b176-106">Además, WMI dedica una cantidad considerable de recursos al análisis y el envío de consultas complejas al proveedor adecuado.</span><span class="sxs-lookup"><span data-stu-id="7b176-106">Further, WMI spends a considerable amount of resources parsing and sending complex queries to the appropriate provider.</span></span> <span data-ttu-id="7b176-107">Para evitar la pérdida de recursos del sistema y mejorar el rendimiento del proveedor de eventos, puede implementar la interfaz [**IWbemEventProviderQuerySink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink) .</span><span class="sxs-lookup"><span data-stu-id="7b176-107">To avoid the waste of system resources and to improve the performance of your event provider, you can implement the [**IWbemEventProviderQuerySink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink) interface.</span></span> <span data-ttu-id="7b176-108">**IWbemEventProviderQuerySink** supervisa las consultas que las aplicaciones cliente registran con WMI mediante los métodos [**NewQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-newquery) y [**CancelQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery) .</span><span class="sxs-lookup"><span data-stu-id="7b176-108">**IWbemEventProviderQuerySink** monitors the queries that client applications register with WMI by using the [**NewQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-newquery) and [**CancelQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery) methods.</span></span> <span data-ttu-id="7b176-109">Mediante la supervisión de las consultas de cliente registradas, el proveedor puede determinar qué sucede si se deben enviar mensajes a WMI.</span><span class="sxs-lookup"><span data-stu-id="7b176-109">By monitoring the registered client queries, your provider can determine what if any messages must be sent to WMI.</span></span>

<span data-ttu-id="7b176-110">WMI llama a [**NewQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-newquery) en un proveedor de eventos cuando un consumidor de cliente registra una consulta de filtro de eventos que contiene referencias a eventos admitidos por ese proveedor de eventos.</span><span class="sxs-lookup"><span data-stu-id="7b176-110">WMI calls [**NewQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-newquery) on an event provider when a client consumer registers an event filter query that contains references to events supported by that event provider.</span></span> <span data-ttu-id="7b176-111">Por lo tanto, el proveedor de eventos responsable de los eventos de modificación de instancias de la clase **EmailClass** puede configurarse para generar notificaciones solo para el **remitente**.</span><span class="sxs-lookup"><span data-stu-id="7b176-111">So the event provider responsible for instance modification events for the **EmailClass** class can be set up to generate notifications only for **sender**.</span></span> <span data-ttu-id="7b176-112">Cuando el proveedor recibe una consulta que solicita la notificación de los cambios en la propiedad de **asunto** , el proveedor puede empezar a generar esas notificaciones.</span><span class="sxs-lookup"><span data-stu-id="7b176-112">When the provider receives a query requesting notification of changes to the **subject** property, the provider can start generating those notifications.</span></span> <span data-ttu-id="7b176-113">En este escenario, no se requiere WMI para descartar las notificaciones que solo notifican los cambios de **destinatarios** .</span><span class="sxs-lookup"><span data-stu-id="7b176-113">In this scenario, WMI is not required to discard the notifications that report **recipient** changes only.</span></span>

<span data-ttu-id="7b176-114">Del mismo modo, WMI llama a [**CancelQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery) en un proveedor de eventos cuando un consumidor del cliente anula el registro de una consulta de filtro de eventos que contiene referencias a eventos admitidos por el proveedor de eventos.</span><span class="sxs-lookup"><span data-stu-id="7b176-114">Similarly, WMI calls [**CancelQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery) on an event provider when a client consumer deregisters an event filter query that contains references to events supported by the event provider.</span></span> <span data-ttu-id="7b176-115">El propósito de **CancelQuery** es que el proveedor de eventos actualice la lista de los eventos que se deben enviar.</span><span class="sxs-lookup"><span data-stu-id="7b176-115">The purpose of **CancelQuery** is for the event provider to update the list of what events should be sent out.</span></span>

> [!Note]  
> <span data-ttu-id="7b176-116">Si el proveedor es compatible con [**IWbemEventProvider**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider) y [**IWbemEventProviderQuerySink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink), asegúrese de que la implementación del método **IUnknown:: QueryInterface** devuelve punteros a ambas interfaces.</span><span class="sxs-lookup"><span data-stu-id="7b176-116">If your provider supports both [**IWbemEventProvider**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider) and [**IWbemEventProviderQuerySink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink), ensure that your implementation of the **IUnknown::QueryInterface** method returns pointers to both interfaces.</span></span>

 

 

 



