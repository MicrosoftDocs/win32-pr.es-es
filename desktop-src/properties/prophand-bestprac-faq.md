---
description: En este tema se explica cómo crear y registrar controladores de propiedades para trabajar con el sistema de propiedades de Windows.
ms.assetid: E583A00B-F615-41c8-AECF-061F1396DB9A
title: Prácticas recomendadas y preguntas más frecuentes sobre controladores de propiedades
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f5188e66f08f3c6cf449f8bc61feb6aac829d37c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "104278909"
---
# <a name="property-handler-best-practices-and-faq"></a><span data-ttu-id="6ad15-103">Prácticas recomendadas y preguntas más frecuentes sobre controladores de propiedades</span><span class="sxs-lookup"><span data-stu-id="6ad15-103">Property Handler Best Practices and FAQ</span></span>

<span data-ttu-id="6ad15-104">En este tema se explica cómo crear y registrar controladores de propiedades para trabajar con el sistema de propiedades de Windows.</span><span class="sxs-lookup"><span data-stu-id="6ad15-104">This topic explains how to create and register property handlers to work with the Windows property system.</span></span>

<span data-ttu-id="6ad15-105">Este tema se organiza de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="6ad15-105">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="6ad15-106">Procedimientos recomendados</span><span class="sxs-lookup"><span data-stu-id="6ad15-106">Best Practices</span></span>](#property-handler-best-practices-and-faq)
    -   [<span data-ttu-id="6ad15-107">Invalidar propiedades del sistema de archivos</span><span class="sxs-lookup"><span data-stu-id="6ad15-107">Overriding File System Properties</span></span>](#overriding-file-system-properties)
    -   [<span data-ttu-id="6ad15-108">Almacenar propiedades en formatos de archivo basados en XML</span><span class="sxs-lookup"><span data-stu-id="6ad15-108">Storing Properties in XML-based File Formats</span></span>](#storing-properties-in-xml-based-file-formats)
    -   [<span data-ttu-id="6ad15-109">Propiedades calculadas</span><span class="sxs-lookup"><span data-stu-id="6ad15-109">Computed Properties</span></span>](#computed-properties)
-   [<span data-ttu-id="6ad15-110">Preguntas más frecuentes</span><span class="sxs-lookup"><span data-stu-id="6ad15-110">Frequently Asked Questions</span></span>](#property-handler-best-practices-and-faq)
-   [<span data-ttu-id="6ad15-111">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="6ad15-111">Related topics</span></span>](#related-topics)

## <a name="best-practices"></a><span data-ttu-id="6ad15-112">Prácticas recomendadas</span><span class="sxs-lookup"><span data-stu-id="6ad15-112">Best Practices</span></span>

<span data-ttu-id="6ad15-113">Los procedimientos recomendados que se describen aquí proporcionan sugerencias de implementación útiles.</span><span class="sxs-lookup"><span data-stu-id="6ad15-113">The best practices outlined here provide useful implementation tips.</span></span>

### <a name="overriding-file-system-properties"></a><span data-ttu-id="6ad15-114">Invalidar propiedades del sistema de archivos</span><span class="sxs-lookup"><span data-stu-id="6ad15-114">Overriding File System Properties</span></span>

<span data-ttu-id="6ad15-115">El origen de datos del sistema de archivos proporciona algunas propiedades para los archivos, como:</span><span class="sxs-lookup"><span data-stu-id="6ad15-115">Some properties for files are provided by the file system data source, such as:</span></span>

-   <span data-ttu-id="6ad15-116">\_Nombre de archivo PKEY</span><span class="sxs-lookup"><span data-stu-id="6ad15-116">PKEY\_FileName</span></span>
-   <span data-ttu-id="6ad15-117">\_Extensión PKEY</span><span class="sxs-lookup"><span data-stu-id="6ad15-117">PKEY\_Extension</span></span>
-   <span data-ttu-id="6ad15-118">PKEY \_ ModifiedTime</span><span class="sxs-lookup"><span data-stu-id="6ad15-118">PKEY\_ModifiedTime</span></span>

<span data-ttu-id="6ad15-119">En general, los controladores de propiedad no pueden proporcionar valores para estas propiedades.</span><span class="sxs-lookup"><span data-stu-id="6ad15-119">In general, property handlers cannot provide values for these properties.</span></span> <span data-ttu-id="6ad15-120">Sin embargo, en algunos casos estas propiedades se pueden invalidar según la información de registro proporcionada por el controlador de propiedades.</span><span class="sxs-lookup"><span data-stu-id="6ad15-120">However, in some cases these properties can be overridden based on registration information provided by the property handler.</span></span> <span data-ttu-id="6ad15-121">Los controladores de propiedades rellenan **\_ las clases HKEY \_ raíz** \\ **CLSID** \\ *{handler}* \\ **OverrideFileSystemProperties** con los nombres de las propiedades que desea invalidar.</span><span class="sxs-lookup"><span data-stu-id="6ad15-121">Property handlers populate **HKEY\_CLASSES\_ROOT**\\**CLSID**\\ *{handler clsid}*\\**OverrideFileSystemProperties** with the names of properties that they want to override.</span></span> <span data-ttu-id="6ad15-122">Esto se limita a un conjunto fijo de propiedades que se muestran en la siguiente lista de la que el sistema tiene conocimiento.</span><span class="sxs-lookup"><span data-stu-id="6ad15-122">This is limited to a fixed set of properties shown in the following list of which the system has knowledge.</span></span>

<span data-ttu-id="6ad15-123">Se admite la invalidación para los siguientes valores de propiedad:</span><span class="sxs-lookup"><span data-stu-id="6ad15-123">Overriding is supported for the following property values:</span></span>

-   [<span data-ttu-id="6ad15-124">System. Kind</span><span class="sxs-lookup"><span data-stu-id="6ad15-124">System.Kind</span></span>](./props-system-kind.md)
-   [<span data-ttu-id="6ad15-125">System. FileName</span><span class="sxs-lookup"><span data-stu-id="6ad15-125">System.FileName</span></span>](./props-system-filename.md)
-   [<span data-ttu-id="6ad15-126">System. IsPinnedToNameSpaceTree</span><span class="sxs-lookup"><span data-stu-id="6ad15-126">System.IsPinnedToNameSpaceTree</span></span>](./props-system-ispinnedtonamespacetree.md)
-   [<span data-ttu-id="6ad15-127">System.ItemNameDisplay</span><span class="sxs-lookup"><span data-stu-id="6ad15-127">System.ItemNameDisplay</span></span>](./props-system-itemnamedisplay.md)
-   [<span data-ttu-id="6ad15-128">System. SFGAOFlags</span><span class="sxs-lookup"><span data-stu-id="6ad15-128">System.SFGAOFlags</span></span>](./props-system-sfgaoflags.md)
-   [<span data-ttu-id="6ad15-129">System. ItemPathDisplay</span><span class="sxs-lookup"><span data-stu-id="6ad15-129">System.ItemPathDisplay</span></span>](./props-system-itempathdisplay.md)
-   [<span data-ttu-id="6ad15-130">System. ItemPathDisplayNarrow</span><span class="sxs-lookup"><span data-stu-id="6ad15-130">System.ItemPathDisplayNarrow</span></span>](./props-system-itempathdisplaynarrow.md)
-   [<span data-ttu-id="6ad15-131">System. ItemFolderNameDisplay</span><span class="sxs-lookup"><span data-stu-id="6ad15-131">System.ItemFolderNameDisplay</span></span>](./props-system-itemfoldernamedisplay.md)
-   [<span data-ttu-id="6ad15-132">System. ItemFolderPathDisplay</span><span class="sxs-lookup"><span data-stu-id="6ad15-132">System.ItemFolderPathDisplay</span></span>](./props-system-itemfolderpathdisplay.md)
-   [<span data-ttu-id="6ad15-133">System. ItemFolderPathDisplayNarrow</span><span class="sxs-lookup"><span data-stu-id="6ad15-133">System.ItemFolderPathDisplayNarrow</span></span>](./props-system-itemfolderpathdisplaynarrow.md)

<span data-ttu-id="6ad15-134">Para obtener una lista completa de todas las propiedades de Shell, consulte [propiedades de Shell](./props.md).</span><span class="sxs-lookup"><span data-stu-id="6ad15-134">For a full list of all Shell properties, see [Shell Properties](./props.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="6ad15-135">Los valores de propiedad invalidados solo se usan cuando se indizan los archivos.</span><span class="sxs-lookup"><span data-stu-id="6ad15-135">The overridden property values are used only when the files are indexed.</span></span> <span data-ttu-id="6ad15-136">Por lo tanto, la exploración de archivos desde el origen de datos del sistema de archivos no revela los valores invalidados.</span><span class="sxs-lookup"><span data-stu-id="6ad15-136">Thus, browsing files from the file system data source does not reveal the overridden values.</span></span>

 

### <a name="storing-properties-in-xml-based-file-formats"></a><span data-ttu-id="6ad15-137">Almacenar propiedades en formatos de archivo basados en XML</span><span class="sxs-lookup"><span data-stu-id="6ad15-137">Storing Properties in XML-based File Formats</span></span>

<span data-ttu-id="6ad15-138">Hay dos opciones básicas disponibles para almacenar propiedades en formatos de archivo basados en XML:</span><span class="sxs-lookup"><span data-stu-id="6ad15-138">There are two basic options available for storing properties in XML-based file formats:</span></span>

-   <span data-ttu-id="6ad15-139">Almacene cada propiedad utilizando elementos y atributos XML según el esquema XML del documento.</span><span class="sxs-lookup"><span data-stu-id="6ad15-139">Store each property using XML elements and attributes according to the XML schema of the document.</span></span> <span data-ttu-id="6ad15-140">Este enfoque es más "descriptivo para XML".</span><span class="sxs-lookup"><span data-stu-id="6ad15-140">This approach is more "XML friendly".</span></span>
-   <span data-ttu-id="6ad15-141">Serialice el almacén de propiedades completo en un objeto binario grande (BLOB) de memoria, convierta el BLOB en una cadena codificada en Base64 y, a continuación, almacene esa cadena en el XML.</span><span class="sxs-lookup"><span data-stu-id="6ad15-141">Serialize the entire property store into a memory Binary large object (BLOB), convert the BLOB into a base64-encoded string, and then store that string in the XML.</span></span> <span data-ttu-id="6ad15-142">Este es el más sencillo de los dos enfoques y se puede usar para proporcionar de forma trivial compatibilidad con los metadatos abiertos.</span><span class="sxs-lookup"><span data-stu-id="6ad15-142">This is the simpler of the two approaches and can be used to trivially provide support for open metadata.</span></span>

<span data-ttu-id="6ad15-143">Algunos controladores pueden combinar estos enfoques, almacenar algunos valores importantes en formato XML estándar y almacenar el resto en un BLOB, por ejemplo.</span><span class="sxs-lookup"><span data-stu-id="6ad15-143">Some handlers might combine these approaches, storing some important values in standard XML format and storing the rest in a BLOB, for example.</span></span>

### <a name="computed-properties"></a><span data-ttu-id="6ad15-144">Propiedades calculadas</span><span class="sxs-lookup"><span data-stu-id="6ad15-144">Computed Properties</span></span>

<span data-ttu-id="6ad15-145">Algunas propiedades se derivan de atributos específicos de un archivo.</span><span class="sxs-lookup"><span data-stu-id="6ad15-145">Some properties are derived from specific attributes of a file.</span></span> <span data-ttu-id="6ad15-146">Por ejemplo, la propiedad [System. Image. Dimensions](./props-system-image-dimensions.md) viene determinada por las dimensiones reales de la imagen en un archivo de imagen.</span><span class="sxs-lookup"><span data-stu-id="6ad15-146">For example, the [System.Image.Dimensions](./props-system-image-dimensions.md) property is determined by the actual dimensions of the image in an image file.</span></span> <span data-ttu-id="6ad15-147">Dado que el controlador de la propiedad no puede cambiar estos valores de propiedad, se marcan por tanto `isInnate="true"` en la descripción de la propiedad.</span><span class="sxs-lookup"><span data-stu-id="6ad15-147">Because such property values cannot be changed by the property handler, they are thus marked `isInnate="true"` in the property description.</span></span> <span data-ttu-id="6ad15-148">Otras propiedades se calculan a partir de una parte de una propiedad específica o agregando los valores de varias propiedades.</span><span class="sxs-lookup"><span data-stu-id="6ad15-148">Other properties are computed from a part of a specific property or by aggregating the values of multiple properties.</span></span> <span data-ttu-id="6ad15-149">Debido a que las actualizaciones de estas propiedades "calculadas" deberían crear ambigüedad en lo que respecta al modo en que se deben cambiar los valores de "origen", las propiedades calculadas deben marcarse `isInnate="true"` en la descripción de la propiedad o se pueden informar como de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="6ad15-149">Because updates to these "computed" properties would create ambiguity as to how the "source" values should be changed, computed properties should be marked `isInnate="true"` in the property description or reported as read-only.</span></span> <span data-ttu-id="6ad15-150">Esta última opción está disponible indicando al controlador que devuelva S \_ false desde [**IPropertyStoreCapabilities:: IsPropertyWritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable).</span><span class="sxs-lookup"><span data-stu-id="6ad15-150">The latter option is available by instructing the handler to return S\_FALSE from [**IPropertyStoreCapabilities::IsPropertyWritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable).</span></span>

## <a name="frequently-asked-questions"></a><span data-ttu-id="6ad15-151">Preguntas más frecuentes</span><span class="sxs-lookup"><span data-stu-id="6ad15-151">Frequently Asked Questions</span></span>

<span data-ttu-id="6ad15-152">En esta sección se proporcionan respuestas a las preguntas más frecuentes sobre las propiedades y los controladores de propiedades, y las respuestas que lo acompañan.</span><span class="sxs-lookup"><span data-stu-id="6ad15-152">This section provides answers to frequently asked questions about properties and property handlers, and accompanying answers.</span></span>

-   <span data-ttu-id="6ad15-153">**Pregunta:** ¿Por qué el indizador de Windows Search no carga mi controlador de propiedades?</span><span class="sxs-lookup"><span data-stu-id="6ad15-153">**Question:** Why isn't my property handler being loaded by the Windows Search indexer?</span></span>

    <span data-ttu-id="6ad15-154">El indizador de Windows Search se ejecuta como un servicio del sistema y no puede cargar los archivos dll almacenados en el directorio del perfil de usuario.</span><span class="sxs-lookup"><span data-stu-id="6ad15-154">The Windows Search indexer runs as a system service and cannot load DLLs that are stored in the user profile directory.</span></span> <span data-ttu-id="6ad15-155">Si va a compilar y depurar mediante Microsoft Visual Studio, colocará el archivo DLL en el perfil de usuario (y, por tanto, el indexador no lo cargará).</span><span class="sxs-lookup"><span data-stu-id="6ad15-155">If you are building and debugging using Microsoft Visual Studio, it will place the DLL in your user profile (and therefore it won't be loaded by the indexer).</span></span> <span data-ttu-id="6ad15-156">Para solucionar este error, copie la DLL fuera de la carpeta de su perfil (por ejemplo, en **C: \\ archivos de programa \\ YourAppName**) y regístrela en ella.</span><span class="sxs-lookup"><span data-stu-id="6ad15-156">To work around this, copy your DLL outside of your profile folder (for example, into **C:\\Program Files\\YourAppName**) and register it there.</span></span>

    <span data-ttu-id="6ad15-157">Para obtener instrucciones más específicas sobre cómo desarrollar controladores de propiedades para trabajar con el indizador de Windows Search, vea [desarrollar controladores de propiedades para Windows Search](../search/-search-3x-wds-extidx-propertyhandlers.md).</span><span class="sxs-lookup"><span data-stu-id="6ad15-157">For more specific guidance on developing property handlers to work with the Windows Search indexer, see [Developing Property Handlers for Windows Search](../search/-search-3x-wds-extidx-propertyhandlers.md).</span></span>

-   <span data-ttu-id="6ad15-158">**Pregunta:** ¿Qué propiedades deben detectarse mediante los métodos de enumeración [**IPropertyStore:: GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) y [**IPropertyStore:: getadt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) ?</span><span class="sxs-lookup"><span data-stu-id="6ad15-158">**Question:** Which properties should be discoverable through the [**IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) and [**IPropertyStore::GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) enumeration methods?</span></span>

    <span data-ttu-id="6ad15-159">No todos los clientes de objetos de almacén de propiedades usan estos métodos.</span><span class="sxs-lookup"><span data-stu-id="6ad15-159">Not all clients of property store objects use these methods.</span></span> <span data-ttu-id="6ad15-160">Algunos clientes son conscientes de las propiedades que tienen previsto solicitar directamente (por nombre de PKEY) o recibir información de propiedades a través de una lista de descripción de propiedad.</span><span class="sxs-lookup"><span data-stu-id="6ad15-160">Some clients are aware of the properties they plan to request directly (by PKEY name), or receive property information through a property description list.</span></span> <span data-ttu-id="6ad15-161">Los métodos de detección de propiedades soporte técnico varios otros escenarios.</span><span class="sxs-lookup"><span data-stu-id="6ad15-161">The property discovery methods suppport several other scenarios.</span></span> <span data-ttu-id="6ad15-162">Si no es necesario que una propiedad participe en estos escenarios, no es necesario enumerarla.</span><span class="sxs-lookup"><span data-stu-id="6ad15-162">If a property does not need to participate in these scenarios, it does not need to be enumerated.</span></span> <span data-ttu-id="6ad15-163">Por lo tanto, un controlador de propiedades puede generar un valor vacío que no sea de VT \_ para las propiedades que no se detectan a través de los métodos [**IPropertyStore:: GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) y [**IPropertyStore:: GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="6ad15-163">Hence, a property handler can produce a non-VT\_EMPTY value for properties that are not discovered through the [**IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) and [**IPropertyStore::GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) methods.</span></span>

    <span data-ttu-id="6ad15-164">Sin embargo, las propiedades deberían estar visibles a través de estos métodos si se cumple alguna de las siguientes condiciones:</span><span class="sxs-lookup"><span data-stu-id="6ad15-164">However, properties should be visible via these methods if any of the following conditions are met:</span></span>

    -   <span data-ttu-id="6ad15-165">**Si la propiedad está indizada para poder realizar búsquedas:** Esto significa que se incluye en el almacén de propiedades de búsqueda de Windows (indicado por `isColumn = "true"` en el esquema de descripción de la propiedad) o disponible para búsquedas de texto completo ( `inInvertedIndex = "true"` ).</span><span class="sxs-lookup"><span data-stu-id="6ad15-165">**If the property is indexed so that it is searchable:** This means it is included in the Windows Search property store (denoted by `isColumn = "true"` in the property description schema) or available for full text searches (`inInvertedIndex = "true"`).</span></span> <span data-ttu-id="6ad15-166">En ausencia de estas marcas o de la ausencia de una descripción de propiedad, las propiedades de tipo "String" se agregarán automáticamente al índice invertido para habilitar la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="6ad15-166">In the absence of these flags or the absence of a property description, properties of type "string" will be added automatically to the inverted index to enable searching.</span></span> <span data-ttu-id="6ad15-167">Dado que la lista de propiedades conocidas (aquellas con las descripciones de propiedades instaladas) en el sistema de propiedades es muy grande (más de 800 propiedades), no sería práctico preguntar a cada controlador de propiedad para cada propiedad registrada en el sistema de propiedades.</span><span class="sxs-lookup"><span data-stu-id="6ad15-167">Because the list of known properties (those with installed property descriptions) in the property system is very large (more than 800 properties), it would be impractical to ask every property handler for every property registered in the property system.</span></span> <span data-ttu-id="6ad15-168">En su lugar, el proceso de indización enumera las propiedades pertinentes del controlador de propiedades para cada elemento que indexa y usa los valores de las propiedades enumeradas para generar el índice de texto completo.</span><span class="sxs-lookup"><span data-stu-id="6ad15-168">Instead, the indexing process enumerates the relevant properties from the property handler for each item it indexes, and it uses the values of the enumerated properties to build the full text index.</span></span>
    -   <span data-ttu-id="6ad15-169">**Si se debe copiar la propiedad cuando el conjunto de propiedades del elemento está duplicado:** Para implementar una función "copiar conjunto de propiedades", el elemento de origen hace que las propiedades que se deben copiar sean visibles a través de los métodos [**IPropertyStore:: GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) y [**IPropertyStore:: GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="6ad15-169">**If the property should be copied when the item's property set is duplicated:** To implement a "copy a property set" function, the source item makes the properties that should be copied visible through the [**IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) and [**IPropertyStore::GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) methods.</span></span> <span data-ttu-id="6ad15-170">No se deben incluir las propiedades que no es necesario copiar o que no tienen sentido copiar.</span><span class="sxs-lookup"><span data-stu-id="6ad15-170">Properties that do not need to be copied or do not make sense being copied should not be included.</span></span>
    -   <span data-ttu-id="6ad15-171">**Si el valor de la propiedad no está vacío (VT \_ vacío):** los valores de propiedad que están vacíos no son útiles para los clientes.</span><span class="sxs-lookup"><span data-stu-id="6ad15-171">**If the property value is not empty (VT\_EMPTY):** Property values that are empty are not useful for clients.</span></span> <span data-ttu-id="6ad15-172">Cuando los clientes intentan devolver valores de propiedad vacíos, se devuelve un valor de VT \_ Empty.</span><span class="sxs-lookup"><span data-stu-id="6ad15-172">When clients attempt to return empty property values, a value of VT\_EMPTY is returned.</span></span> <span data-ttu-id="6ad15-173">Por lo tanto, no se deben enumerar las propiedades con valores vacíos.</span><span class="sxs-lookup"><span data-stu-id="6ad15-173">Thus, properties with empty values should not be enumerated.</span></span>
    -   <span data-ttu-id="6ad15-174">**Si se debe quitar la propiedad al invocar la función "quitar propiedades":** Esta característica existe para proteger la privacidad; detecta todos los valores del controlador de propiedad a través de la enumeración y quita cada uno seleccionado para su eliminación por parte del usuario.</span><span class="sxs-lookup"><span data-stu-id="6ad15-174">**If the property should be removed when invoking the "remove properties" function:** This feature exists to protect privacy; it discovers all values from the property handler through enumeration and removes each one selected for removal by the user.</span></span>
        > [!Note]  
        > <span data-ttu-id="6ad15-175">Enumerar propiedades no comunica el conjunto de propiedades que admite un controlador de propiedad determinado si el controlador admite un esquema fijo (y no metadatos abiertos).</span><span class="sxs-lookup"><span data-stu-id="6ad15-175">Enumerating properties does not communicate the set of properties that a particular property handler supports if the handler supports a fixed schema (and not open metadata).</span></span> <span data-ttu-id="6ad15-176">En su lugar, estos controladores deben documentar el conjunto de propiedades que admiten.</span><span class="sxs-lookup"><span data-stu-id="6ad15-176">Instead, such handlers should document the set of properties that they support.</span></span>

         

-   <span data-ttu-id="6ad15-177">**Pregunta:** Cómo saber qué formatos de archivo admiten metadatos abiertos?</span><span class="sxs-lookup"><span data-stu-id="6ad15-177">**Question:** How do I know which file formats support open metadata?</span></span>

    <span data-ttu-id="6ad15-178">Para obtener información sobre la compatibilidad con los metadatos abiertos, vea "tipos de archivo que admiten metadatos abiertos" en [tipos de archivo](../shell/fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="6ad15-178">For information about support for open metadata, see "File Types that Support Open Metadata" in [File Types](../shell/fa-file-types.md).</span></span>

-   <span data-ttu-id="6ad15-179">**Pregunta:** ¿ \_ Se pueden almacenar valores NULL de VT mediante un controlador de propiedad?</span><span class="sxs-lookup"><span data-stu-id="6ad15-179">**Question:** Can VT\_NULL values be stored using a property handler?</span></span>

    <span data-ttu-id="6ad15-180">No.</span><span class="sxs-lookup"><span data-stu-id="6ad15-180">No.</span></span> <span data-ttu-id="6ad15-181">\_Los valores NULL de VT se convertirán en VT \_ vacío en las llamadas a [**IPropertyStore:: GetValue**](/previous-versions/windows/desktop/legacy/bb761473(v=vs.85)) y [**IPropertyStore:: SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="6ad15-181">VT\_NULL values will be converted to VT\_EMPTY on calls to [**IPropertyStore::GetValue**](/previous-versions/windows/desktop/legacy/bb761473(v=vs.85)) and [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span></span>

-   <span data-ttu-id="6ad15-182">**Pregunta:** ¿Qué formatos de cadena de fecha admite la función [**PropVariantChangeType**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) ?</span><span class="sxs-lookup"><span data-stu-id="6ad15-182">**Question:** Which date string formats are supported by the [**PropVariantChangeType**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) function?</span></span>

    <span data-ttu-id="6ad15-183">Por lo general, las propiedades que representan valores de fecha y hora se deben representar con VT \_ FILETIME.</span><span class="sxs-lookup"><span data-stu-id="6ad15-183">Generally, properties that represent date/time values should be represented using VT\_FILETIME.</span></span> <span data-ttu-id="6ad15-184">Sin embargo, muchos orígenes de datos proporcionan esta información en forma de cadena.</span><span class="sxs-lookup"><span data-stu-id="6ad15-184">However, many data sources provide this information in string form.</span></span> <span data-ttu-id="6ad15-185">La API de la aplicación auxiliar [**PropVariantChangeType**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) permite forzar algunos formatos de fecha de cadena en valores [**FILETIME**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) , tal como se muestra en la tabla siguiente.</span><span class="sxs-lookup"><span data-stu-id="6ad15-185">The [**PropVariantChangeType**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) helper API supports coercing some string date formats into [**FILETIME**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) values, as shown in the following table.</span></span>

    

    | <span data-ttu-id="6ad15-186">Formato</span><span class="sxs-lookup"><span data-stu-id="6ad15-186">Format</span></span>                  | <span data-ttu-id="6ad15-187">Windows Vista, Windows XP y Microsoft Windows Desktop Search (WDS)</span><span class="sxs-lookup"><span data-stu-id="6ad15-187">Windows Vista, Windows XP, and Microsoft Windows Desktop Search (WDS)</span></span> | <span data-ttu-id="6ad15-188">Windows 7</span><span class="sxs-lookup"><span data-stu-id="6ad15-188">Windows 7</span></span> | <span data-ttu-id="6ad15-189">Notas</span><span class="sxs-lookup"><span data-stu-id="6ad15-189">Notes</span></span>                                                                                                                                                                                                 |
    |-------------------------|-----------------------------------------------------------------------|-----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | <span data-ttu-id="6ad15-190">aaaa/mm/dd: HH: mm: SS. UUU</span><span class="sxs-lookup"><span data-stu-id="6ad15-190">yyyy/mm/dd:hh:mm:ss.uuu</span></span> | <span data-ttu-id="6ad15-191">Sí</span><span class="sxs-lookup"><span data-stu-id="6ad15-191">Yes</span></span>                                                                   | <span data-ttu-id="6ad15-192">Sí</span><span class="sxs-lookup"><span data-stu-id="6ad15-192">Yes</span></span>       | <span data-ttu-id="6ad15-193">UTC y = año, m = mes, d = fecha, h = horas (reloj de 24 horas), m = minutos, s = segundos, u = microsegundos</span><span class="sxs-lookup"><span data-stu-id="6ad15-193">UTC; y=year, m=month, d=date, h=hours (24-hour clock), m=minutes, s=seconds, u=microseconds</span></span>                                                                                                           |
    | <span data-ttu-id="6ad15-194">aaaa-mm-ddThh: mm: ssZ</span><span class="sxs-lookup"><span data-stu-id="6ad15-194">yyyy-mm-ddThh:mm:ssZ</span></span>    | <span data-ttu-id="6ad15-195">No</span><span class="sxs-lookup"><span data-stu-id="6ad15-195">No</span></span>                                                                    | <span data-ttu-id="6ad15-196">Sí</span><span class="sxs-lookup"><span data-stu-id="6ad15-196">Yes</span></span>       | <span data-ttu-id="6ad15-197">**Especificación de formato ISO8601** Hora UTC (indicada por el indicador de zona horaria "Z"); y = año, m = mes, d = fecha, h = horas (reloj de 24 horas), m = minutos, s = segundos; ' T ' es un delimitador para la parte de hora.</span><span class="sxs-lookup"><span data-stu-id="6ad15-197">**ISO8601 format specification** UTC (denoted by 'Z' time zone indicator); y=year, m=month, d=date, h=hours (24-hour clock), m=minutes, s=seconds; 'T' is a delimiter for the time portion.</span></span><br/> |

    

     

-   <span data-ttu-id="6ad15-198">**Pregunta:** ¿Es posible crear un controlador de propiedades de solo lectura?</span><span class="sxs-lookup"><span data-stu-id="6ad15-198">**Question:** Is it possible to create a read-only property handler?</span></span>

    <span data-ttu-id="6ad15-199">Sí.</span><span class="sxs-lookup"><span data-stu-id="6ad15-199">Yes.</span></span> <span data-ttu-id="6ad15-200">Algunas implementaciones del controlador de propiedad no admiten la escritura de valores de propiedad.</span><span class="sxs-lookup"><span data-stu-id="6ad15-200">Some property handler implementations do not support writing of property values.</span></span> <span data-ttu-id="6ad15-201">Estos controladores de propiedades deben devolver STGM \_ E \_ ACCESSDENIED en las llamadas a **IInitializeXXX:: Initialize** que pasan STGM \_ ReadWrite o en cualquier llamada a [**IPropertyStore:: SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="6ad15-201">These property handlers should return STGM\_E\_ACCESSDENIED on calls to **IInitializeXXX::Initialize** that pass STGM\_READWRITE, or on any call to [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span></span>

    <span data-ttu-id="6ad15-202">Todos los controladores de propiedad abiertos en el \_ modo de lectura STGM deben devolver STGM \_ E \_ ACCESSDENIED en las llamadas a [**IPropertyStore:: SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="6ad15-202">All property handlers opened in STGM\_READ mode should return STGM\_E\_ACCESSDENIED on calls to [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span></span>

-   <span data-ttu-id="6ad15-203">**Pregunta:** ¿Un controlador de propiedades puede tratar una propiedad como de solo lectura, aunque el esquema indique que la propiedad es grabable?</span><span class="sxs-lookup"><span data-stu-id="6ad15-203">**Question:** Can a property handler treat a property as read-only, even if the schema indicates that the property is writeable?</span></span>

    <span data-ttu-id="6ad15-204">Sí.</span><span class="sxs-lookup"><span data-stu-id="6ad15-204">Yes.</span></span> <span data-ttu-id="6ad15-205">En el sistema de esquema, las propiedades se anotan como de solo lectura (incluidas aquellas con `isInnate = "true"` ) o de lectura/escritura.</span><span class="sxs-lookup"><span data-stu-id="6ad15-205">In the schema system, properties are annotated as read-only (including those with `isInnate = "true"`) or read/write.</span></span> <span data-ttu-id="6ad15-206">Los controladores de propiedades que no admiten la escritura de una propiedad determinada que el esquema indica deben ser de escritura deben implementar [**IPropertyStoreCapabilities**](/windows/win32/api/propsys/nn-propsys-ipropertystorecapabilities) y devolver S \_ false en las llamadas a [**IPropertyStoreCapabilities:: IsPropertyWritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable) para esa propiedad.</span><span class="sxs-lookup"><span data-stu-id="6ad15-206">Property handlers that do not support writing a particular property that the schema says should be writeable should implement [**IPropertyStoreCapabilities**](/windows/win32/api/propsys/nn-propsys-ipropertystorecapabilities) and return S\_FALSE on calls to [**IPropertyStoreCapabilities::IsPropertyWritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable) for that property.</span></span> <span data-ttu-id="6ad15-207">Esto indica que en el contexto de este controlador y este archivo, la propiedad no es grabable.</span><span class="sxs-lookup"><span data-stu-id="6ad15-207">This indicates that in the context of this handler and this file, the property is not writeable.</span></span>

    > [!Note]  
    > <span data-ttu-id="6ad15-208">La acción inversa no es posible.</span><span class="sxs-lookup"><span data-stu-id="6ad15-208">The reverse action is not possible.</span></span> <span data-ttu-id="6ad15-209">No se puede habilitar un controlador de propiedades para escribir una propiedad marcada como de solo lectura en el esquema</span><span class="sxs-lookup"><span data-stu-id="6ad15-209">You cannot enable a property handler to write a property that is marked as read-only in the schema</span></span>

     

## <a name="related-topics"></a><span data-ttu-id="6ad15-210">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="6ad15-210">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="6ad15-211">Descripción de los controladores de propiedades</span><span class="sxs-lookup"><span data-stu-id="6ad15-211">Understanding Property Handlers</span></span>](./building-property-handlers-properties.md)
</dt> <dt>

[<span data-ttu-id="6ad15-212">Usar nombres de tipo</span><span class="sxs-lookup"><span data-stu-id="6ad15-212">Using Kind Names</span></span>](./building-property-handlers-user-friendly-kind-names.md)
</dt> <dt>

[<span data-ttu-id="6ad15-213">Usar listas de propiedades</span><span class="sxs-lookup"><span data-stu-id="6ad15-213">Using Property Lists</span></span>](./building-property-handlers-property-lists.md)
</dt> <dt>

[<span data-ttu-id="6ad15-214">Inicializar controladores de propiedades</span><span class="sxs-lookup"><span data-stu-id="6ad15-214">Initializing Property Handlers</span></span>](./building-property-handlers-property-handlers.md)
</dt> <dt>

[<span data-ttu-id="6ad15-215">Registrar y distribuir controladores de propiedades</span><span class="sxs-lookup"><span data-stu-id="6ad15-215">Registering and Distributing Property Handlers</span></span>](./prophand-reg-dist.md)
</dt> </dl>

 

 
