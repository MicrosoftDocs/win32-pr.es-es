---
title: Información general sobre WinEvents y Active Accessibility
description: Los servidores de Microsoft Active Accessibility generan WinEvents para notificar a los clientes cuando cambia un objeto accesible.
ms.assetid: a2d486ee-84ef-4c44-a832-dbc0dae81542
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b351b1ce7b6337c4ca0ac0827daff2978c6611af
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/29/2020
ms.locfileid: "103994897"
---
# <a name="winevents-and-active-accessibility"></a><span data-ttu-id="6eb87-103">WinEvents y Active Accessibility</span><span class="sxs-lookup"><span data-stu-id="6eb87-103">WinEvents and Active Accessibility</span></span>

<span data-ttu-id="6eb87-104">Los servidores de Microsoft Active Accessibility generan *WinEvents* para notificar a los clientes cuando cambia un objeto accesible.</span><span class="sxs-lookup"><span data-stu-id="6eb87-104">Microsoft Active Accessibility servers raise *WinEvents* to notify clients when an accessible object changes.</span></span> <span data-ttu-id="6eb87-105">Hay numerosas condiciones en las que un servidor notifica un cambio a un cliente.</span><span class="sxs-lookup"><span data-stu-id="6eb87-105">There are numerous conditions in which a server notifies a client of a change.</span></span> <span data-ttu-id="6eb87-106">Cada [constante de evento](event-constants.md) definida por Microsoft Active Accessibility describe una condición sobre la que se notifica a un cliente.</span><span class="sxs-lookup"><span data-stu-id="6eb87-106">Each [event constant](event-constants.md) defined by Microsoft Active Accessibility describes a condition about which a client is notified.</span></span> <span data-ttu-id="6eb87-107">Por ejemplo, WinEvents puede indicar:</span><span class="sxs-lookup"><span data-stu-id="6eb87-107">For example, WinEvents can signal:</span></span>

- <span data-ttu-id="6eb87-108">Cuando se crea o se destruye un objeto.</span><span class="sxs-lookup"><span data-stu-id="6eb87-108">When an object is created or destroyed.</span></span>
- <span data-ttu-id="6eb87-109">Cuando un objeto recibe o pierde el foco.</span><span class="sxs-lookup"><span data-stu-id="6eb87-109">When an object receives or loses focus.</span></span>
- <span data-ttu-id="6eb87-110">Cuando cambia el estado o la ubicación de un objeto.</span><span class="sxs-lookup"><span data-stu-id="6eb87-110">When the state or location of an object changes.</span></span>
- <span data-ttu-id="6eb87-111">Cuando cambia alguna propiedad de un objeto.</span><span class="sxs-lookup"><span data-stu-id="6eb87-111">When any property of an object changes.</span></span>

<span data-ttu-id="6eb87-112">Las aplicaciones cliente no reciben notificaciones de eventos de forma automática. deben especificar qué eventos desean recibir llamando a la función [**SetWinEventHook**](/windows/desktop/api/Winuser/nf-winuser-setwineventhook) .</span><span class="sxs-lookup"><span data-stu-id="6eb87-112">Client applications do not receive event notifications automatically; they must specify which events they want to receive by calling the [**SetWinEventHook**](/windows/desktop/api/Winuser/nf-winuser-setwineventhook) function.</span></span> <span data-ttu-id="6eb87-113">Con **SetWinEventHook**, un cliente se registra para recibir uno o más eventos y establece una función de enlace para controlar los eventos especificados.</span><span class="sxs-lookup"><span data-stu-id="6eb87-113">With **SetWinEventHook**, a client registers to receive one or more events and sets a hook function to handle the specified events.</span></span> <span data-ttu-id="6eb87-114">Los clientes pueden utilizar la misma función de enlace para controlar varios tipos de eventos o pueden usar las funciones de enlace varios.</span><span class="sxs-lookup"><span data-stu-id="6eb87-114">Clients can use the same hook function to handle multiple types of events, or it can use multipe hook functions.</span></span> <span data-ttu-id="6eb87-115">Los clientes llaman una vez a **SetWinEventHook** para cada función de enlace que debe registrar.</span><span class="sxs-lookup"><span data-stu-id="6eb87-115">Clients call the **SetWinEventHook** once for each hook function it needs to register.</span></span>

<span data-ttu-id="6eb87-116">Las funciones de enlace se encuentran dentro del cuerpo del código del cliente, en un archivo DLL asignado al proceso del cliente, o en un archivo DLL asignado al proceso del servidor.</span><span class="sxs-lookup"><span data-stu-id="6eb87-116">Hook functions are located within the client's code body, in a DLL mapped into the client's process, or in a DLL mapped into the server's process.</span></span> <span data-ttu-id="6eb87-117">Cada uno de estos métodos tiene ventajas y desventajas.</span><span class="sxs-lookup"><span data-stu-id="6eb87-117">Each of these methods has advantages and disadvantages.</span></span> <span data-ttu-id="6eb87-118">Para obtener más información, vea [funciones de enlace en contexto y fuera de contexto](in-context-and-out-of-context-hook-functions.md).</span><span class="sxs-lookup"><span data-stu-id="6eb87-118">For more information, see [In-Context and Out-of-Context Hook Functions](in-context-and-out-of-context-hook-functions.md).</span></span>

<span data-ttu-id="6eb87-119">Para notificar a los clientes la aparición de un evento, los servidores llaman a [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent).</span><span class="sxs-lookup"><span data-stu-id="6eb87-119">To notify clients of an event occurrence, servers call [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent).</span></span> <span data-ttu-id="6eb87-120">El sistema comprueba si alguna aplicación cliente tiene definidas funciones de enlace para el evento y llama a las funciones de enlace apropiadas según sea necesario.</span><span class="sxs-lookup"><span data-stu-id="6eb87-120">The system checks whether any client applications have set hook functions for the event and calls the appropriate hook functions as necessary.</span></span>

<span data-ttu-id="6eb87-121">Cuando se llama a la función de enlace del cliente, recibe una serie de parámetros que describen el evento y el objeto que generó el evento.</span><span class="sxs-lookup"><span data-stu-id="6eb87-121">When the client's hook function is called, it receives a number of parameters that describe the event and the object that generated the event.</span></span> <span data-ttu-id="6eb87-122">Para obtener acceso al objeto que generó el evento, la función de enlace de cliente llama a [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent).</span><span class="sxs-lookup"><span data-stu-id="6eb87-122">To gain access to the object that generated the event, the client hook function calls [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent).</span></span>

> [!NOTE]
> <span data-ttu-id="6eb87-123">Si no hay clientes registrados para recibir WinEvents, el impacto en el rendimiento de un servidor para llamar a [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) es insignificante.</span><span class="sxs-lookup"><span data-stu-id="6eb87-123">If no clients have registered to receive WinEvents, the performance impact on a server for calling [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) is negligible.</span></span>
>
> <span data-ttu-id="6eb87-124">Los servidores llaman a [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) para los cambios únicamente en sus propios objetos accesibles; no llaman a **NotifyWinEvent** para los cambios en los elementos de la interfaz de usuario proporcionados por el sistema.</span><span class="sxs-lookup"><span data-stu-id="6eb87-124">Servers call [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) for changes only in their own accessible objects; they do not call **NotifyWinEvent** for changes in system-provided user interface elements.</span></span>

## <a name="event-driven-communication"></a><span data-ttu-id="6eb87-125">Comunicación Event-Driven</span><span class="sxs-lookup"><span data-stu-id="6eb87-125">Event-Driven Communication</span></span>

<span data-ttu-id="6eb87-126">Los clientes deben registrar un enlace de WinEvent para poder recibir notificaciones de WinEvent.</span><span class="sxs-lookup"><span data-stu-id="6eb87-126">Clients must register a WinEvent hook before they can receive WinEvent notifications.</span></span> <span data-ttu-id="6eb87-127">Para evitar devoluciones de llamada innecesarias y mejorar el rendimiento, se recomienda que los clientes se registren solo para los eventos que necesitan recibir.</span><span class="sxs-lookup"><span data-stu-id="6eb87-127">To avoid unnecessary callbacks and improve performance, clients are advised to register only for the events they need to receive.</span></span>

<span data-ttu-id="6eb87-128">Dentro del procedimiento de enlace, el cliente puede llamar a [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent) para recuperar un objeto [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) para el elemento al que se aplica el evento.</span><span class="sxs-lookup"><span data-stu-id="6eb87-128">Inside the hook procedure, the client can call [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent) to retrieve an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) object for the element to which the event applies.</span></span> <span data-ttu-id="6eb87-129">Con este objeto, el cliente puede empezar a llamar a métodos **IAccessible** para recuperar información o interactuar con el elemento de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="6eb87-129">With this object, the client can begin calling **IAccessible** methods to retrieve information or interact with the UI element.</span></span>

## <a name="related-topics"></a><span data-ttu-id="6eb87-130">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="6eb87-130">Related topics</span></span>

[<span data-ttu-id="6eb87-131">WinEvents</span><span class="sxs-lookup"><span data-stu-id="6eb87-131">WinEvents</span></span>](winevents-infrastructure.md)
