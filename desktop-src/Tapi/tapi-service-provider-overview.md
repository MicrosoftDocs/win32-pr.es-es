---
description: Las aplicaciones TAPI residen en su propio espacio de proceso.
ms.assetid: 57dedad1-7264-48fc-9ac2-c6c72f7fee27
title: Información general del proveedor de servicios TAPI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7e847ed49879e9ff55662477a762fa7297443d12
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "104566334"
---
# <a name="tapi-service-provider-overview"></a><span data-ttu-id="c9501-103">Información general del proveedor de servicios TAPI</span><span class="sxs-lookup"><span data-stu-id="c9501-103">TAPI Service Provider Overview</span></span>

<span data-ttu-id="c9501-104">Las aplicaciones TAPI residen en su propio espacio de proceso.</span><span class="sxs-lookup"><span data-stu-id="c9501-104">TAPI applications reside in their own process space.</span></span> <span data-ttu-id="c9501-105">Las aplicaciones TAPI cargan el Tapi32.dll o Tapi3.dll en su proceso y TAPI se comunica con TAPISRV a través de una interfaz RPC privada.</span><span class="sxs-lookup"><span data-stu-id="c9501-105">TAPI applications load the Tapi32.dll or Tapi3.dll into their process, and TAPI communicates with TAPISRV through a private RPC interface.</span></span> <span data-ttu-id="c9501-106">Un TSP se ejecuta en el contexto de TAPISRV.</span><span class="sxs-lookup"><span data-stu-id="c9501-106">A TSP runs in the context of TAPISRV.</span></span> <span data-ttu-id="c9501-107">Un TSP determinado puede residir en un equipo que no sea el equipo del usuario y al que se tiene acceso mediante un TSP remoto.</span><span class="sxs-lookup"><span data-stu-id="c9501-107">A given TSP may reside on a machine other than the user's machine and is accessed using a remote TSP.</span></span> <span data-ttu-id="c9501-108">TAPISRV se implementa como un proceso de servicio en SVCHOST.</span><span class="sxs-lookup"><span data-stu-id="c9501-108">TAPISRV is implemented as a service process within SVCHOST.</span></span> <span data-ttu-id="c9501-109">Un MSP reside en el espacio de proceso de la aplicación y siempre es local.</span><span class="sxs-lookup"><span data-stu-id="c9501-109">An MSP lives within the process space of the application and is always local.</span></span>

<span data-ttu-id="c9501-110">Se puede considerar que un par de TSP/MSP tiene una ruta de comunicación privada virtual.</span><span class="sxs-lookup"><span data-stu-id="c9501-110">A TSP/MSP pair can be regarded as having a virtual private communication path.</span></span> <span data-ttu-id="c9501-111">La información se puede enviar entre los dos búferes opacos que no son interpretados por TAPISRV o por el archivo DLL de TAPI.</span><span class="sxs-lookup"><span data-stu-id="c9501-111">Information can be sent between the two using opaque buffers that are not interpreted by either TAPISRV or the TAPI DLL.</span></span>

<span data-ttu-id="c9501-112">Algunos proveedores de servicios implementan operaciones específicas del hardware implicado.</span><span class="sxs-lookup"><span data-stu-id="c9501-112">Some service providers implement operations specific to the hardware involved.</span></span> <span data-ttu-id="c9501-113">TAPI 2. x proporciona acceso a estas operaciones a través de la función [**lineDevSpecific**](/windows/win32/api/tapi/nf-tapi-linedevspecific) o [**phoneDevSpecific**](/windows/win32/api/tapi/nf-tapi-phonedevspecific) .</span><span class="sxs-lookup"><span data-stu-id="c9501-113">TAPI 2.x provides access to such operations through the [**lineDevSpecific**](/windows/win32/api/tapi/nf-tapi-linedevspecific) or [**phoneDevSpecific**](/windows/win32/api/tapi/nf-tapi-phonedevspecific) function.</span></span> <span data-ttu-id="c9501-114">TAPI 3. x expone [interfaces específicas del proveedor](./provider-specific-interfaces.md).</span><span class="sxs-lookup"><span data-stu-id="c9501-114">TAPI 3.x exposes [provider-specific Interfaces](./provider-specific-interfaces.md).</span></span>

<span data-ttu-id="c9501-115">En el diagrama siguiente se ilustra el flujo de controles e información, que muestra un TSP independiente (Unimodem) y un par de TSP/MSP (H. 323).</span><span class="sxs-lookup"><span data-stu-id="c9501-115">The following diagram illustrates the flow of controls and information, showing one stand-alone TSP (Unimodem) and one TSP/MSP pair (H.323).</span></span>

![inquilino independiente y flujo de control e información de TSP/MSP emparejado](images/tsp-msp1.png)

<span data-ttu-id="c9501-117">En el diagrama siguiente se muestra el progreso de una llamada entrante que implica un TSP y un MSP.</span><span class="sxs-lookup"><span data-stu-id="c9501-117">The following diagram illustrates the progress of an incoming call that involves both a TSP and an MSP.</span></span>

![llamada entrante con un TSP y un MSP](images/tspmspin.png)

## <a name="incoming-call-setup"></a><span data-ttu-id="c9501-119">Configuración de llamada entrante</span><span class="sxs-lookup"><span data-stu-id="c9501-119">Incoming Call Setup</span></span>

-   <span data-ttu-id="c9501-120">El TSP envía un mensaje [**line \_ NEWCALL**](line-newcall.md) a TAPISRV.</span><span class="sxs-lookup"><span data-stu-id="c9501-120">The TSP sends a [**LINE\_NEWCALL**](line-newcall.md) message to TAPISRV.</span></span> <span data-ttu-id="c9501-121">El [**Estado**](./linecallstate--constants.md) de la llamada es LINECALLSTATE \_ .</span><span class="sxs-lookup"><span data-stu-id="c9501-121">The [**call state**](./linecallstate--constants.md) is LINECALLSTATE\_OFFERING.</span></span>
-   <span data-ttu-id="c9501-122">TAPISRV notifica a los clientes de la llamada.</span><span class="sxs-lookup"><span data-stu-id="c9501-122">TAPISRV notifies clients of the call.</span></span>
-   <span data-ttu-id="c9501-123">TAPI3 crea el objeto de llamada TAPI y, a continuación, llama a [**ITMSPAddress:: CreateMSPCall**](/windows/win32/api/tapi3/nf-tapi3-itmspaddress-createmspcall), que se implementa mediante el MSP.</span><span class="sxs-lookup"><span data-stu-id="c9501-123">TAPI3 creates the TAPI Call object, then calls [**ITMSPAddress::CreateMSPCall**](/windows/win32/api/tapi3/nf-tapi3-itmspaddress-createmspcall), which is implemented by the MSP.</span></span>
-   <span data-ttu-id="c9501-124">El MSP crea un objeto de llamada MSP y flujos predeterminados en función de los [**tipos de medios**](./tapimediatype--constants.md) necesarios para la llamada.</span><span class="sxs-lookup"><span data-stu-id="c9501-124">The MSP creates an MSP Call object and default streams based on the [**media types**](./tapimediatype--constants.md) required for the call.</span></span> <span data-ttu-id="c9501-125">Devuelve un puntero IUnknown al objeto de llamada MSP.</span><span class="sxs-lookup"><span data-stu-id="c9501-125">It returns an IUnknown pointer to the MSP call object.</span></span>
-   <span data-ttu-id="c9501-126">TAPI3 agrega el objeto de llamada MSP en el objeto de llamada TAPI, haciendo que las interfaces como [**ITStreamControl**](/windows/win32/api/tapi3if/nn-tapi3if-itstreamcontrol) estén disponibles para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c9501-126">TAPI3 aggregates the MSP Call object into the TAPI Call object, making interfaces such as [**ITStreamControl**](/windows/win32/api/tapi3if/nn-tapi3if-itstreamcontrol) available to the application.</span></span> <span data-ttu-id="c9501-127">A continuación, notifica a la aplicación la nueva llamada.</span><span class="sxs-lookup"><span data-stu-id="c9501-127">It then notifies the application of the new call.</span></span>

<span data-ttu-id="c9501-128">A continuación, la aplicación puede usar métodos como [**ITStream:: SelectTerminal**](/windows/win32/api/tapi3if/nf-tapi3if-itstream-selectterminal) para completar los preparativos para la finalización de la llamada.</span><span class="sxs-lookup"><span data-stu-id="c9501-128">The application may then use methods such as [**ITStream::SelectTerminal**](/windows/win32/api/tapi3if/nf-tapi3if-itstream-selectterminal) to complete preparations for call completion.</span></span>

## <a name="incoming-call-completion"></a><span data-ttu-id="c9501-129">Finalización de llamada entrante</span><span class="sxs-lookup"><span data-stu-id="c9501-129">Incoming Call Completion</span></span>

-   <span data-ttu-id="c9501-130">La aplicación llama a [**ITBasicCallControl:: Answer**](/windows/win32/api/tapi3if/nf-tapi3if-itbasiccallcontrol-answer).</span><span class="sxs-lookup"><span data-stu-id="c9501-130">The application calls [**ITBasicCallControl::Answer**](/windows/win32/api/tapi3if/nf-tapi3if-itbasiccallcontrol-answer).</span></span>
-   <span data-ttu-id="c9501-131">TAPI3 llama a [**lineAnswer**](/windows/win32/api/tapi/nf-tapi-lineanswer).</span><span class="sxs-lookup"><span data-stu-id="c9501-131">TAPI3 calls [**lineAnswer**](/windows/win32/api/tapi/nf-tapi-lineanswer).</span></span>
-   <span data-ttu-id="c9501-132">TAPISERV llama a [**TSPI \_ lineAnswer**](/windows/win32/api/tspi/nf-tspi-tspi_lineanswer).</span><span class="sxs-lookup"><span data-stu-id="c9501-132">TAPISERV calls [**TSPI\_lineAnswer**](/windows/win32/api/tspi/nf-tspi-tspi_lineanswer).</span></span>
-   <span data-ttu-id="c9501-133">El TSP inicia el streaming de llamadas.</span><span class="sxs-lookup"><span data-stu-id="c9501-133">The TSP initiates call streaming.</span></span> <span data-ttu-id="c9501-134">Normalmente, el TSP envía un mensaje al MSP correspondiente y el MSP inicia las secuencias.</span><span class="sxs-lookup"><span data-stu-id="c9501-134">Usually, the TSP sends a message to the corresponding MSP, and the MSP starts the streams.</span></span> <span data-ttu-id="c9501-135">En algunas implementaciones de TSP/MSP, el proveedor TSP inicia las secuencias.</span><span class="sxs-lookup"><span data-stu-id="c9501-135">In some TSP/MSP implementations, the TSP starts the streams.</span></span>

## <a name="tspmsp-communication-during-call-progress"></a><span data-ttu-id="c9501-136">Comunicación de TSP/MSP durante el progreso de la llamada</span><span class="sxs-lookup"><span data-stu-id="c9501-136">TSP/MSP Communication During Call Progress</span></span>

<span data-ttu-id="c9501-137">Una vez que la llamada está en curso, el TSP y el MSP se comunican pasando búferes opacos a través de TAPISRV y TAPI3.</span><span class="sxs-lookup"><span data-stu-id="c9501-137">After the call is in progress, the TSP and the MSP communicate by passing opaque buffers through TAPISRV and TAPI3.</span></span>

-   <span data-ttu-id="c9501-138">El TSP envía información al MSP mediante el envío del mensaje [**line \_ SENDMSPDATA**](line-sendmspdata.md) a TAPISRV.</span><span class="sxs-lookup"><span data-stu-id="c9501-138">The TSP sends information to the MSP by sending the [**LINE\_SENDMSPDATA**](line-sendmspdata.md) message to TAPISRV.</span></span>
-   <span data-ttu-id="c9501-139">El MSP recibe información del TSP a través del método [**ITMSPAddress:: ReceiveTSPData**](/windows/win32/api/tapi3/nf-tapi3-itmspaddress-receivetspdata) .</span><span class="sxs-lookup"><span data-stu-id="c9501-139">The MSP receives information from the TSP through the [**ITMSPAddress::ReceiveTSPData**](/windows/win32/api/tapi3/nf-tapi3-itmspaddress-receivetspdata) method.</span></span> <span data-ttu-id="c9501-140">Si los datos están relacionados con un objeto de llamada MSP, se proporciona un puntero de interfaz al objeto de llamada MSP como parámetro de ese método.</span><span class="sxs-lookup"><span data-stu-id="c9501-140">If the data is related to a MSP call object, an interface pointer to the MSP call object is provided as a parameter of that method.</span></span>
-   <span data-ttu-id="c9501-141">El MSP envía información al TSP mediante el envío de un \_ evento de datos de MSP \_ en TAPI 3.</span><span class="sxs-lookup"><span data-stu-id="c9501-141">The MSP sends information to the TSP by sending a MSP\_TSP\_DATA event to TAPI 3.</span></span>
-   <span data-ttu-id="c9501-142">El TSP recibe información del MSP a través de la función [**TSPI \_ lineReceiveMSPData**](/windows/win32/api/tspi/nf-tspi-tspi_linereceivemspdata) .</span><span class="sxs-lookup"><span data-stu-id="c9501-142">The TSP receives information from the MSP through the [**TSPI\_lineReceiveMSPData**](/windows/win32/api/tspi/nf-tspi-tspi_linereceivemspdata) function.</span></span>

<span data-ttu-id="c9501-143">El proceso exacto y el contenido de la comunicación entre los proveedores de servicios es específico de un determinado conjunto de TSP/MSP.</span><span class="sxs-lookup"><span data-stu-id="c9501-143">The exact process and content of communication between service providers is specific to a given TSP/MSP set.</span></span>

> [!Note]  
> <span data-ttu-id="c9501-144">En el caso de las llamadas salientes, el MSP normalmente conoce la llamada antes que el TSP.</span><span class="sxs-lookup"><span data-stu-id="c9501-144">For outgoing calls, the MSP typically knows about the call before the TSP.</span></span> <span data-ttu-id="c9501-145">Si el MSP intenta comunicarse con el TSP antes de que se informe al TSP sobre una llamada, se producirá un error en la comunicación.</span><span class="sxs-lookup"><span data-stu-id="c9501-145">If the MSP tries to communicate with the TSP before the TSP is informed about a call, the communication will fail.</span></span> <span data-ttu-id="c9501-146">Cuando el MSP y el TSP necesitan intercambiar información relativa a una llamada específica, el TSP debe iniciar la comunicación.</span><span class="sxs-lookup"><span data-stu-id="c9501-146">When the MSP and the TSP need to exchange information concerning a specific call, the TSP should initiate communication.</span></span>

 

 

 
