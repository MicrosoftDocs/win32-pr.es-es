---
description: En la sección obtener el identificador de una carpeta se describen dos métodos para obtener el puntero de un objeto de espacio de nombres a una lista de identificadores de elementos (PIDL).
ms.assetid: c99a2f6c-3144-41ec-ad97-59a30bfec9ab
title: Obtener información sobre el contenido de una carpeta
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f7eb26e9df28af4811e74f2878eebb7af9d5c92a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104997209"
---
# <a name="getting-information-about-the-contents-of-a-folder"></a><span data-ttu-id="6a5cb-103">Obtener información sobre el contenido de una carpeta</span><span class="sxs-lookup"><span data-stu-id="6a5cb-103">Getting Information About the Contents of a Folder</span></span>

<span data-ttu-id="6a5cb-104">En la sección [obtener el identificador de una carpeta](folder-id.md) se describen dos métodos para obtener el puntero de un objeto de espacio de nombres a una lista de identificadores de elementos (PIDL).</span><span class="sxs-lookup"><span data-stu-id="6a5cb-104">The [Getting a Folder's ID](folder-id.md) section discussed two approaches to getting a namespace object's pointer to an item identifier list (PIDL).</span></span> <span data-ttu-id="6a5cb-105">Una pregunta obvia es: una vez que tenga un PIDL, ¿qué puede hacer con él?</span><span class="sxs-lookup"><span data-stu-id="6a5cb-105">One obvious question is: Once you have a PIDL, what can you do with it?</span></span> <span data-ttu-id="6a5cb-106">Una pregunta relacionada es: ¿Qué ocurre si no funciona o es adecuado para su aplicación?</span><span class="sxs-lookup"><span data-stu-id="6a5cb-106">A related question is: What if neither approach works, or is suitable for your application?</span></span> <span data-ttu-id="6a5cb-107">La respuesta a ambas preguntas requiere tener una visión más detallada de cómo se implementa el espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-107">The answer to both questions requires taking a closer look at how the namespace is implemented.</span></span> <span data-ttu-id="6a5cb-108">La clave es la interfaz [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="6a5cb-108">The key is the [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span>

-   [<span data-ttu-id="6a5cb-109">Uso de la interfaz IShellFolder</span><span class="sxs-lookup"><span data-stu-id="6a5cb-109">Using the IShellFolder Interface</span></span>](#using-the-ishellfolder-interface)
-   [<span data-ttu-id="6a5cb-110">Enumerar el contenido de una carpeta</span><span class="sxs-lookup"><span data-stu-id="6a5cb-110">Enumerating the Contents of a Folder</span></span>](#enumerating-the-contents-of-a-folder)
-   [<span data-ttu-id="6a5cb-111">Determinar los nombres para mostrar y otras propiedades</span><span class="sxs-lookup"><span data-stu-id="6a5cb-111">Determining Display Names and Other Properties</span></span>](#determining-display-names-and-other-properties)
-   [<span data-ttu-id="6a5cb-112">Obtener un puntero a la interfaz IShellFolder de una subcarpeta</span><span class="sxs-lookup"><span data-stu-id="6a5cb-112">Getting a Pointer to a Subfolder's IShellFolder Interface</span></span>](#getting-a-pointer-to-a-subfolders-ishellfolder-interface)
-   [<span data-ttu-id="6a5cb-113">Determinar la carpeta primaria de un objeto</span><span class="sxs-lookup"><span data-stu-id="6a5cb-113">Determining an Object's Parent Folder</span></span>](#determining-an-objects-parent-folder)

## <a name="using-the-ishellfolder-interface"></a><span data-ttu-id="6a5cb-114">Uso de la interfaz IShellFolder</span><span class="sxs-lookup"><span data-stu-id="6a5cb-114">Using the IShellFolder Interface</span></span>

<span data-ttu-id="6a5cb-115">Anteriormente en esta documentación, las carpetas de espacio de nombres se denominaban objetos.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-115">Earlier in this documentation, namespace folders were referred to as objects.</span></span> <span data-ttu-id="6a5cb-116">Aunque, en ese momento, el término se usó en un sentido flexible, en realidad también es cierto en un sentido estricto.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-116">Although, at that point, the term was used in a loose sense, it is actually true in a strict sense as well.</span></span> <span data-ttu-id="6a5cb-117">Cada carpeta de espacio de nombres se representa mediante un objeto de modelo de objetos componentes (COM).</span><span class="sxs-lookup"><span data-stu-id="6a5cb-117">Every namespace folder is represented by a Component Object Model (COM) object.</span></span> <span data-ttu-id="6a5cb-118">Cada objeto de carpeta expone una serie de interfaces que se pueden usar para una amplia variedad de tareas.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-118">Each folder object exposes a number of interfaces that can be used for a wide variety of tasks.</span></span> <span data-ttu-id="6a5cb-119">Es posible que algunas interfaces que son opcionales no se expongan en todas las carpetas.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-119">Some interfaces that are optional may not be exposed by all folders.</span></span> <span data-ttu-id="6a5cb-120">Sin embargo, todas las carpetas deben exponer la interfaz fundamental, [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder).</span><span class="sxs-lookup"><span data-stu-id="6a5cb-120">However, all folders must expose the fundamental interface, [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder).</span></span>

<span data-ttu-id="6a5cb-121">El primer paso en el uso de un objeto de carpeta es recuperar un puntero a su interfaz [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="6a5cb-121">The first step in using a folder object is to retrieve a pointer to its [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="6a5cb-122">Además de proporcionar acceso a las otras interfaces del objeto, **IShellFolder** expone un grupo de métodos que controlan varias tareas comunes, algunas de las cuales se describen en esta sección.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-122">In addition to providing access to the object's other interfaces, **IShellFolder** exposes a group of methods that handle a number of common tasks, several of which are discussed in this section.</span></span>

<span data-ttu-id="6a5cb-123">Para recuperar un puntero a la interfaz [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) de un objeto de espacio de nombres, primero debe llamar a [**SHGetDesktopFolder**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetdesktopfolder).</span><span class="sxs-lookup"><span data-stu-id="6a5cb-123">To retrieve a pointer to a namespace object's [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface, you must first call [**SHGetDesktopFolder**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetdesktopfolder).</span></span> <span data-ttu-id="6a5cb-124">Esta función devuelve un puntero a la interfaz **IShellFolder** de la raíz del espacio de nombres, el escritorio.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-124">This function returns a pointer to the **IShellFolder** interface of the namespace root, the desktop.</span></span> <span data-ttu-id="6a5cb-125">Una vez que tenga la interfaz **IShellFolder** del escritorio, hay varias formas de continuar.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-125">Once you have the desktop's **IShellFolder** interface, there a variety of ways to proceed.</span></span>

<span data-ttu-id="6a5cb-126">Si ya tiene el PIDL de la carpeta que le interesa, por ejemplo, mediante una llamada a [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation), puede recuperar su interfaz [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) llamando al método [**IShellFolder:: BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) del escritorio.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-126">If you already have the PIDL of the folder you are interested in—for instance, by calling [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation)—you can retrieve its [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface by calling the desktop's [**IShellFolder::BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) method.</span></span> <span data-ttu-id="6a5cb-127">Si tiene la ruta de acceso de un objeto del sistema de archivos, primero debe obtener su PIDL llamando al método [**IShellFolder::P arsedisplayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) de escritorio y, a continuación, llamar a **IShellFolder:: BindToObject**.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-127">If you have the path of a file system object, you must first obtain its PIDL by calling the desktop's [**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) method and then call **IShellFolder::BindToObject**.</span></span> <span data-ttu-id="6a5cb-128">Si ninguno de estos métodos es aplicable, puede usar otros métodos **IShellFolder** para navegar por el espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-128">If neither of these approaches is applicable, you can use other **IShellFolder** methods to navigate the namespace.</span></span> <span data-ttu-id="6a5cb-129">Para obtener más información, vea [navegar por el espacio de nombres](navigate.md).</span><span class="sxs-lookup"><span data-stu-id="6a5cb-129">For more information, see [Navigating the Namespace](navigate.md).</span></span>

## <a name="enumerating-the-contents-of-a-folder"></a><span data-ttu-id="6a5cb-130">Enumerar el contenido de una carpeta</span><span class="sxs-lookup"><span data-stu-id="6a5cb-130">Enumerating the Contents of a Folder</span></span>

<span data-ttu-id="6a5cb-131">Lo primero que normalmente desea hacer con una carpeta es averiguar lo que contiene.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-131">The first thing you usually want to do with a folder is to find out what it contains.</span></span> <span data-ttu-id="6a5cb-132">Primero debe llamar al método [**IShellFolder:: EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) de la carpeta.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-132">You must first call the folder's [**IShellFolder::EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) method.</span></span> <span data-ttu-id="6a5cb-133">La carpeta creará un objeto de enumeración OLE estándar y devolverá su interfaz [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) .</span><span class="sxs-lookup"><span data-stu-id="6a5cb-133">The folder will create a standard OLE enumeration object and return its [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) interface.</span></span> <span data-ttu-id="6a5cb-134">Esta interfaz expone cuatro métodos estándar ([**clonar**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-clone), [**siguiente**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next), [**restablecer**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-reset)y [**omitir**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-skip)) que se pueden usar para enumerar el contenido de la carpeta.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-134">This interface exposes four standard methods—[**Clone**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-clone), [**Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next), [**Reset**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-reset), and [**Skip**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-skip)—that can be used to enumerate the contents of the folder.</span></span>

<span data-ttu-id="6a5cb-135">El procedimiento básico para enumerar el contenido de una carpeta es:</span><span class="sxs-lookup"><span data-stu-id="6a5cb-135">The basic procedure for enumerating a folder's contents is:</span></span>

1.  <span data-ttu-id="6a5cb-136">Llame al método Folders [**IShellFolder:: EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) para recuperar un puntero a la interfaz [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) de un objeto de enumeración.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-136">Call the folders [**IShellFolder::EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) method to retrieve a pointer to an enumeration object's [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) interface.</span></span>
2.  <span data-ttu-id="6a5cb-137">Pase un PIDL sin asignar a [**IEnumIDList:: Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next).</span><span class="sxs-lookup"><span data-stu-id="6a5cb-137">Pass an unallocated PIDL to [**IEnumIDList::Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next).</span></span> <span data-ttu-id="6a5cb-138">A **continuación** se encarga de asignar el PIDL, pero la aplicación debe desasignarlo cuando ya no se necesite.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-138">**Next** takes care of allocating the PIDL, but the application must deallocate it when it is no longer needed.</span></span> <span data-ttu-id="6a5cb-139">Cuando **siguiente** devuelve, el PIDL contendrá solo el identificador de elemento del objeto y los caracteres **nulos** de terminación.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-139">When **Next** returns, the PIDL will contain just the object's item ID and the terminating **NULL** characters.</span></span> <span data-ttu-id="6a5cb-140">En otras palabras, se trata de una PIDL de un solo nivel, relativa a la carpeta, no a un PIDL completo.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-140">In other words, it is a single-level PIDL, relative to the folder, not a fully qualified PIDL.</span></span>
3.  <span data-ttu-id="6a5cb-141">Repita el paso 2 hasta que [**siguiente**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next) devuelva S \_ false para indicar que se han enumerado todos los elementos.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-141">Repeat step 2 until [**Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next) returns S\_FALSE to indicate that all items have been enumerated.</span></span>
4.  <span data-ttu-id="6a5cb-142">Llame a **IEnumIDList:: Release** para liberar el objeto de enumeración.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-142">Call **IEnumIDList::Release** to release the enumeration object.</span></span>

> [!Note]  
> <span data-ttu-id="6a5cb-143">Es importante realizar un seguimiento de si está trabajando con una PIDL completa o relativa.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-143">It is important to keep track of whether you are working with a full or relative PIDL.</span></span> <span data-ttu-id="6a5cb-144">Algunas funciones y métodos aceptarán, pero otros solo adoptarán uno u otro.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-144">Some functions and methods will accept either, but others will only take one or the other.</span></span>

 

<span data-ttu-id="6a5cb-145">Los tres métodos restantes de [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) ([**restablecer**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-reset), [**omitir**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-skip)y [**clonar**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-clone)) son útiles si necesita realizar enumeraciones repetidas de la carpeta.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-145">The remaining three [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) methods ([**Reset**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-reset), [**Skip**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-skip), and [**Clone**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-clone)) are useful if you need to do repeated enumerations of the folder.</span></span> <span data-ttu-id="6a5cb-146">Permiten restablecer la enumeración, omitir uno o más objetos y hacer una copia del objeto de enumeración para conservar su estado.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-146">They allow you to reset the enumeration, skip one or more objects, and make a copy of the enumeration object to preserve its state.</span></span>

## <a name="determining-display-names-and-other-properties"></a><span data-ttu-id="6a5cb-147">Determinar los nombres para mostrar y otras propiedades</span><span class="sxs-lookup"><span data-stu-id="6a5cb-147">Determining Display Names and Other Properties</span></span>

<span data-ttu-id="6a5cb-148">Una vez que ha enumerado todos los PIDL de elementos contenidos en una carpeta, puede averiguar qué tipo de objetos representan.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-148">Once you have enumerated all the PIDLs that are contained by a folder, you can find out what sort of objects they represent.</span></span> <span data-ttu-id="6a5cb-149">La interfaz [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) proporciona una serie de métodos útiles, dos de los cuales se describen aquí.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-149">The [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface provides a number of useful methods, two of which are discussed here.</span></span> <span data-ttu-id="6a5cb-150">Más adelante se explican otros métodos **IShellFolder** y otras interfaces de carpeta de Shell.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-150">Other **IShellFolder** methods and other Shell folder interfaces are discussed later.</span></span>

<span data-ttu-id="6a5cb-151">Una de las propiedades más útiles es el nombre para mostrar del objeto.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-151">One of the most useful properties is the object's display name.</span></span> <span data-ttu-id="6a5cb-152">Para recuperar el nombre para mostrar de un objeto, pase su PIDL a [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof).</span><span class="sxs-lookup"><span data-stu-id="6a5cb-152">To retrieve the display name of an object, pass its PIDL to [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof).</span></span> <span data-ttu-id="6a5cb-153">Aunque el objeto puede encontrarse en cualquier lugar debajo de la carpeta principal del espacio de nombres, su PIDL debe ser relativa a la carpeta.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-153">Although the object can be located anywhere below the parent folder in the namespace, its PIDL must be relative to the folder.</span></span>

<span data-ttu-id="6a5cb-154">[**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) devuelve el nombre para mostrar como parte de una estructura [**Strret**](/windows/desktop/api/Shtypes/ns-shtypes-strret) .</span><span class="sxs-lookup"><span data-stu-id="6a5cb-154">[**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) returns the display name as part of of a [**STRRET**](/windows/desktop/api/Shtypes/ns-shtypes-strret) structure.</span></span> <span data-ttu-id="6a5cb-155">Dado que extraer el nombre para mostrar de una estructura **Strret** puede ser un poco complicado, el Shell proporciona dos funciones que realizan el trabajo por usted, [**StrRetToStr**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettostra) y [**StrRetToBuf**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettobufa).</span><span class="sxs-lookup"><span data-stu-id="6a5cb-155">Because extracting the display name from a **STRRET** structure can be a little tricky, the Shell provides two functions that do the job for you, [**StrRetToStr**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettostra) and [**StrRetToBuf**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettobufa).</span></span> <span data-ttu-id="6a5cb-156">Ambas funciones toman una estructura **Strret** y devuelven el nombre para mostrar como una cadena normal.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-156">Both functions take a **STRRET** structure, and return the display name as a normal string.</span></span> <span data-ttu-id="6a5cb-157">Solo difieren en cómo se asigna la cadena.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-157">They differ only in how the string is allocated.</span></span>

<span data-ttu-id="6a5cb-158">Además de su nombre para mostrar, un objeto puede tener varios atributos, como, por ejemplo, si se trata de una carpeta o si puede moverse.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-158">In addition to its display name, an object can have a number of attributes, such as whether it is a folder or whether it can be moved.</span></span> <span data-ttu-id="6a5cb-159">Puede recuperar los atributos de un objeto pasando su PIDL a [**IShellFolder:: GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof).</span><span class="sxs-lookup"><span data-stu-id="6a5cb-159">You can retrieve an object's attributes by passing its PIDL to [**IShellFolder::GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof).</span></span> <span data-ttu-id="6a5cb-160">La lista completa de atributos es bastante grande, por lo que debería ver la referencia para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-160">The complete list of attributes is quite large, so you should see the reference for details.</span></span> <span data-ttu-id="6a5cb-161">Tenga en cuenta que el PIDL que pasa a **GetAttributesOf** debe ser de un solo nivel.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-161">Note that the PIDL that you pass to **GetAttributesOf** must be single-level.</span></span> <span data-ttu-id="6a5cb-162">En concreto, **IShellFolder:: GetAttributesOf** aceptará el PIDL devuelto por [**IEnumIDList:: Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next).</span><span class="sxs-lookup"><span data-stu-id="6a5cb-162">In particular, **IShellFolder::GetAttributesOf** will accept the PIDLs returned by [**IEnumIDList::Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next).</span></span> <span data-ttu-id="6a5cb-163">Puede pasar una matriz de PIDL y **GetAttributesOf** devolverá los atributos que todos los objetos de la matriz tengan en común.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-163">You can pass in an array of PIDLs, and **GetAttributesOf** will return those attributes that all objects in the array have in common.</span></span>

<span data-ttu-id="6a5cb-164">Si tiene la ruta de acceso completa o el PIDL de un objeto, [**SHGetFileInfo**](/windows/desktop/api/Shellapi/nf-shellapi-shgetfileinfoa) proporciona una manera sencilla de recuperar información sobre un objeto que es suficiente para muchos propósitos.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-164">If you have an object's fully qualified path or PIDL, [**SHGetFileInfo**](/windows/desktop/api/Shellapi/nf-shellapi-shgetfileinfoa) provides a simple way to retrieve information about an object that is sufficient for many purposes.</span></span> <span data-ttu-id="6a5cb-165">**SHGetFileInfo** toma una ruta de acceso completa o PIDL y devuelve una gran variedad de información sobre el objeto, incluidos:</span><span class="sxs-lookup"><span data-stu-id="6a5cb-165">**SHGetFileInfo** takes a fully qualified path or PIDL, and returns a variety of information about the object including:</span></span>

-   <span data-ttu-id="6a5cb-166">Nombre para mostrar del objeto</span><span class="sxs-lookup"><span data-stu-id="6a5cb-166">The object's display name</span></span>
-   <span data-ttu-id="6a5cb-167">Atributos del objeto</span><span class="sxs-lookup"><span data-stu-id="6a5cb-167">The object's attributes</span></span>
-   <span data-ttu-id="6a5cb-168">Identificadores de los iconos del objeto</span><span class="sxs-lookup"><span data-stu-id="6a5cb-168">Handles to the object's icons</span></span>
-   <span data-ttu-id="6a5cb-169">Identificador de la lista de imágenes del sistema</span><span class="sxs-lookup"><span data-stu-id="6a5cb-169">A handle to the system image list</span></span>
-   <span data-ttu-id="6a5cb-170">La ruta de acceso del archivo que contiene el icono del objeto.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-170">The path of the file containing the object's icon</span></span>

## <a name="getting-a-pointer-to-a-subfolders-ishellfolder-interface"></a><span data-ttu-id="6a5cb-171">Obtener un puntero a la interfaz IShellFolder de una subcarpeta</span><span class="sxs-lookup"><span data-stu-id="6a5cb-171">Getting a Pointer to a Subfolder's IShellFolder Interface</span></span>

<span data-ttu-id="6a5cb-172">Puede determinar si la carpeta contiene todas las subcarpetas llamando a [**IShellFolder:: GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) y comprobando si la marca de \_ carpeta SFGAO está establecida.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-172">You can determine whether your folder contains any subfolders by calling [**IShellFolder::GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) and checking to see if the SFGAO\_FOLDER flag is set.</span></span> <span data-ttu-id="6a5cb-173">Si un objeto es una carpeta, puede enlazar a él, lo que le proporciona un puntero a su interfaz [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="6a5cb-173">If an object is a folder, you can bind to it, which provides you with a pointer to its [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span>

<span data-ttu-id="6a5cb-174">Para enlazar a una subcarpeta, llame al método [**IShellFolder:: BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) de la carpeta principal.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-174">To bind to a subfolder, call the parent folder's [**IShellFolder::BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) method.</span></span> <span data-ttu-id="6a5cb-175">Este método toma el PIDL de la subcarpeta y devuelve un puntero a su interfaz [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="6a5cb-175">This method takes the subfolder's PIDL and returns a pointer to its [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="6a5cb-176">Una vez que tenga este puntero, puede usar los métodos **IShellFolder** para enumerar el contenido de las subcarpetas, determinar sus propiedades, etc.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-176">Once you have this pointer, you can use the **IShellFolder** methods to enumerate the subfolders contents, determine their properties, and so on.</span></span>

## <a name="determining-an-objects-parent-folder"></a><span data-ttu-id="6a5cb-177">Determinar la carpeta primaria de un objeto</span><span class="sxs-lookup"><span data-stu-id="6a5cb-177">Determining an Object's Parent Folder</span></span>

<span data-ttu-id="6a5cb-178">Si tiene PIDL de un objeto, es posible que necesite un identificador a una de las interfaces expuestas por su carpeta principal.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-178">If you have an object's PIDL, you may need a handle to one of the interfaces exposed by its parent folder.</span></span> <span data-ttu-id="6a5cb-179">Por ejemplo, si desea determinar el nombre para mostrar asociado a un PIDL mediante [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof), primero debe recuperar la interfaz [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) del elemento primario del objeto.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-179">For example, if you want to determine the display name associated with a PIDL by using [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof), you must first retrieve the [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface of the object's parent.</span></span> <span data-ttu-id="6a5cb-180">Es posible hacerlo con las técnicas descritas en las secciones anteriores.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-180">It is possible to do this with the techniques discussed in the previous sections.</span></span> <span data-ttu-id="6a5cb-181">Sin embargo, un enfoque mucho más sencillo es usar la función de Shell [**SHBindToParent**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbindtoparent).</span><span class="sxs-lookup"><span data-stu-id="6a5cb-181">However, a much simpler approach is to use the Shell function, [**SHBindToParent**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbindtoparent).</span></span> <span data-ttu-id="6a5cb-182">Esta función toma el PIDL completo de un objeto y devuelve un puntero de interfaz especificado en la carpeta principal.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-182">This function takes the fully qualified PIDL of an object and returns a specified interface pointer on the parent folder.</span></span> <span data-ttu-id="6a5cb-183">Opcionalmente, también devuelve el PIDL de nivel único del elemento para su uso en métodos como [**IShellFolder:: GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof).</span><span class="sxs-lookup"><span data-stu-id="6a5cb-183">Optionally, it also returns the item's single-level PIDL for use in methods such as [**IShellFolder::GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof).</span></span>

<span data-ttu-id="6a5cb-184">La siguiente aplicación de consola de ejemplo recupera el PIDL de la carpeta especial del sistema y devuelve su nombre para mostrar.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-184">The following sample console application retrieves the PIDL of the System special folder and returns its display name.</span></span>


```
#include <shlobj.h>
#include <shlwapi.h>
#include <iostream.h>
#include <objbase.h>

int main()
{
    IShellFolder *psfParent = NULL;
    LPITEMIDLIST pidlSystem = NULL;
    LPCITEMIDLIST pidlRelative = NULL;
    STRRET strDispName;
    TCHAR szDisplayName[MAX_PATH];
    HRESULT hr;

    hr = SHGetFolderLocation(NULL, CSIDL_SYSTEM, NULL, NULL, &pidlSystem);

    hr = SHBindToParent(pidlSystem, IID_IShellFolder, (void **) &psfParent, &pidlRelative);

    if(SUCCEEDED(hr))
    {
        hr = psfParent->GetDisplayNameOf(pidlRelative, SHGDN_NORMAL, &strDispName);
        hr = StrRetToBuf(&strDispName, pidlSystem, szDisplayName, sizeof(szDisplayName));
        cout << "SHGDN_NORMAL - " <<szDisplayName << '\n';
    }

    psfParent->Release();
    CoTaskMemFree(pidlSystem);

    return 0;
}
```



<span data-ttu-id="6a5cb-185">En primer lugar, la aplicación usa [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) para recuperar el PIDL de la carpeta del sistema.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-185">The application first uses [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) to retrieve the System folder's PIDL.</span></span> <span data-ttu-id="6a5cb-186">A continuación, llama a [**SHBindToParent**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbindtoparent), que devuelve un puntero a la interfaz [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) de la carpeta primaria y la PIDL de la carpeta del sistema en relación con su elemento primario.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-186">It then calls [**SHBindToParent**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbindtoparent), which returns a pointer to the parent folder's [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface, and the System folder's PIDL relative to its parent.</span></span> <span data-ttu-id="6a5cb-187">A continuación, usa el método [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) de la carpeta principal para recuperar el nombre para mostrar de la carpeta del sistema.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-187">It then uses the parent folder's [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) method to retrieve the display name of the System folder.</span></span> <span data-ttu-id="6a5cb-188">Dado que **GetDisplayNameOf** devuelve una estructura [**Strret**](/windows/desktop/api/Shtypes/ns-shtypes-strret) , [**StrRetToBuf**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettobufa) se usa para convertir el nombre para mostrar en una cadena normal.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-188">Because **GetDisplayNameOf** returns a [**STRRET**](/windows/desktop/api/Shtypes/ns-shtypes-strret) structure, [**StrRetToBuf**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettobufa) is used to convert the display name into a normal string.</span></span> <span data-ttu-id="6a5cb-189">Después de mostrar el nombre para mostrar, se liberan los punteros de interfaz y se libera PIDL del sistema.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-189">After displaying the display name, the interface pointers are released and the System PIDL freed.</span></span> <span data-ttu-id="6a5cb-190">Tenga en cuenta que no debe liberar el PIDL relativo devuelto por **SHBindToParent**.</span><span class="sxs-lookup"><span data-stu-id="6a5cb-190">Note that you must not free the relative PIDL returned by **SHBindToParent**.</span></span>

 

 
