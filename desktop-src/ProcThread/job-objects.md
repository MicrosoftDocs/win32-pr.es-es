---
description: Un objeto de trabajo permite administrar grupos de procesos como una unidad. Los objetos de trabajo son objetos Namable, protegibles y compartibles que controlan los atributos de los procesos asociados a ellos.
ms.assetid: 59296384-5e78-44dd-8019-f1df6668928b
title: Objetos de trabajo
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 07e6d9758faf2b66f047ca60dbba91601b202b4c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104360693"
---
# <a name="job-objects"></a><span data-ttu-id="825bd-104">Objetos de trabajo</span><span class="sxs-lookup"><span data-stu-id="825bd-104">Job Objects</span></span>

<span data-ttu-id="825bd-105">Un *objeto de trabajo* permite administrar grupos de procesos como una unidad.</span><span class="sxs-lookup"><span data-stu-id="825bd-105">A *job object* allows groups of processes to be managed as a unit.</span></span> <span data-ttu-id="825bd-106">Los objetos de trabajo son objetos Namable, protegibles y compartibles que controlan los atributos de los procesos asociados a ellos.</span><span class="sxs-lookup"><span data-stu-id="825bd-106">Job objects are namable, securable, sharable objects that control attributes of the processes associated with them.</span></span> <span data-ttu-id="825bd-107">Las operaciones realizadas en un objeto de trabajo afectan a todos los procesos asociados con el objeto de trabajo.</span><span class="sxs-lookup"><span data-stu-id="825bd-107">Operations performed on a job object affect all processes associated with the job object.</span></span> <span data-ttu-id="825bd-108">Entre los ejemplos se incluyen la aplicación de límites, como el tamaño del espacio de trabajo y la prioridad del proceso, o la finalización de todos los procesos asociados a un trabajo.</span><span class="sxs-lookup"><span data-stu-id="825bd-108">Examples include enforcing limits such as working set size and process priority or terminating all processes associated with a job.</span></span>

-   [<span data-ttu-id="825bd-109">Crear trabajos</span><span class="sxs-lookup"><span data-stu-id="825bd-109">Creating Jobs</span></span>](#creating-jobs)
-   [<span data-ttu-id="825bd-110">Administrar procesos en trabajos</span><span class="sxs-lookup"><span data-stu-id="825bd-110">Managing Processes in Jobs</span></span>](#managing-processes-in-jobs)
-   [<span data-ttu-id="825bd-111">Límites del trabajo y notificaciones</span><span class="sxs-lookup"><span data-stu-id="825bd-111">Job Limits and Notifications</span></span>](#job-limits-and-notifications)
-   [<span data-ttu-id="825bd-112">Contabilidad de recursos para trabajos</span><span class="sxs-lookup"><span data-stu-id="825bd-112">Resource Accounting for Jobs</span></span>](#resource-accounting-for-jobs)
-   [<span data-ttu-id="825bd-113">Administrar objetos de trabajo</span><span class="sxs-lookup"><span data-stu-id="825bd-113">Managing Job Objects</span></span>](#managing-job-objects)
-   [<span data-ttu-id="825bd-114">Administrar un árbol de procesos que usa objetos de trabajo</span><span class="sxs-lookup"><span data-stu-id="825bd-114">Managing a Process Tree that Uses Job Objects</span></span>](#managing-a-process-tree-that-uses-job-objects)

## <a name="creating-jobs"></a><span data-ttu-id="825bd-115">Crear trabajos</span><span class="sxs-lookup"><span data-stu-id="825bd-115">Creating Jobs</span></span>

<span data-ttu-id="825bd-116">Para crear un objeto de trabajo, utilice la función [**CreateJobObject**](/windows/desktop/api/WinBase/nf-winbase-createjobobjecta) .</span><span class="sxs-lookup"><span data-stu-id="825bd-116">To create a job object, use the [**CreateJobObject**](/windows/desktop/api/WinBase/nf-winbase-createjobobjecta) function.</span></span> <span data-ttu-id="825bd-117">Cuando se crea el trabajo, no se asocia ningún proceso con el trabajo.</span><span class="sxs-lookup"><span data-stu-id="825bd-117">When the job is created, no processes are associated with the job.</span></span>

<span data-ttu-id="825bd-118">Para asociar un proceso a un trabajo, use la función [**AssignProcessToJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject) .</span><span class="sxs-lookup"><span data-stu-id="825bd-118">To associate a process with a job, use the [**AssignProcessToJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject) function.</span></span> <span data-ttu-id="825bd-119">Una vez que un proceso está asociado a un trabajo, no se puede interrumpir la asociación.</span><span class="sxs-lookup"><span data-stu-id="825bd-119">After a process is associated with a job, the association cannot be broken.</span></span> <span data-ttu-id="825bd-120">Un proceso se puede asociar a más de un trabajo en una jerarquía de trabajos anidados.</span><span class="sxs-lookup"><span data-stu-id="825bd-120">A process can be associated with more than one job in a hierarchy of nested jobs.</span></span> <span data-ttu-id="825bd-121">Para obtener más información, vea [trabajos anidados](nested-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="825bd-121">For more information, see [Nested Jobs](nested-jobs.md).</span></span>

<span data-ttu-id="825bd-122">**Windows 7, Windows server 2008 R2, Windows XP con SP3, Windows server 2008, Windows Vista y Windows server 2003:** Un proceso solo se puede asociar a un trabajo.</span><span class="sxs-lookup"><span data-stu-id="825bd-122">**Windows 7, Windows Server 2008 R2, Windows XP with SP3, Windows Server 2008, Windows Vista and Windows Server 2003:** A process can be associated with only one job.</span></span> <span data-ttu-id="825bd-123">Los trabajos no se pueden anidar.</span><span class="sxs-lookup"><span data-stu-id="825bd-123">Jobs cannot be nested.</span></span> <span data-ttu-id="825bd-124">La capacidad de anidar trabajos se agregó en Windows 8 y Windows Server 2012.</span><span class="sxs-lookup"><span data-stu-id="825bd-124">The ability to nest jobs was added in Windows 8 and Windows Server 2012.</span></span>

<span data-ttu-id="825bd-125">Puede especificar un descriptor de seguridad para un objeto de trabajo cuando llame a la función [**CreateJobObject**](/windows/desktop/api/WinBase/nf-winbase-createjobobjecta) .</span><span class="sxs-lookup"><span data-stu-id="825bd-125">You can specify a security descriptor for a job object when you call the [**CreateJobObject**](/windows/desktop/api/WinBase/nf-winbase-createjobobjecta) function.</span></span> <span data-ttu-id="825bd-126">Para obtener más información, vea [seguridad de objetos de trabajo y derechos de acceso](job-object-security-and-access-rights.md).</span><span class="sxs-lookup"><span data-stu-id="825bd-126">For more information, see [Job Object Security and Access Rights](job-object-security-and-access-rights.md).</span></span>

## <a name="managing-processes-in-jobs"></a><span data-ttu-id="825bd-127">Administrar procesos en trabajos</span><span class="sxs-lookup"><span data-stu-id="825bd-127">Managing Processes in Jobs</span></span>

<span data-ttu-id="825bd-128">Una vez que un proceso está asociado a un trabajo, de forma predeterminada, todos los procesos secundarios que crea mediante [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) también se asocian con el trabajo.</span><span class="sxs-lookup"><span data-stu-id="825bd-128">After a process is associated with a job, by default any child processes it creates using [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) are also associated with the job.</span></span> <span data-ttu-id="825bd-129">(Los procesos secundarios creados mediante el [**proceso de Win32 \_ . Create**](../cimwin32prov/create-method-in-class-win32-process.md) no están asociados con el trabajo). Este comportamiento predeterminado se puede cambiar estableciendo el límite de objetos de trabajo de límite extendido \_ \_ \_ \_ Aceptar o \_ el \_ límite \_ de objetos de trabajo separación silenciosa \_ \_ correcto para el trabajo.</span><span class="sxs-lookup"><span data-stu-id="825bd-129">(Child processes created using [**Win32\_Process.Create**](../cimwin32prov/create-method-in-class-win32-process.md) are not associated with the job.) This default behavior can be changed by setting the extended limit JOB\_OBJECT\_LIMIT\_BREAKAWAY\_OK or JOB\_OBJECT\_LIMIT\_SILENT\_BREAKAWAY\_OK for the job.</span></span>

-   <span data-ttu-id="825bd-130">Si el trabajo tiene la separación del límite de objetos de trabajo de límite extendido \_ \_ \_ \_ correcto y el proceso primario se creó con la \_ marca crear separación \_ de \_ trabajo, los procesos secundarios del proceso primario no están asociados con el trabajo.</span><span class="sxs-lookup"><span data-stu-id="825bd-130">If the job has the extended limit JOB\_OBJECT\_LIMIT\_BREAKAWAY\_OK and the parent process was created with the CREATE\_BREAKAWAY\_FROM\_JOB flag, then child processes of the parent process are not associated with the job.</span></span>
-   <span data-ttu-id="825bd-131">Si el trabajo tiene la \_ \_ \_ separación silenciosa límite de objetos \_ de trabajo de límite extendido \_ correcto, los procesos secundarios de cualquier proceso primario asociado con el trabajo no están asociados con el trabajo.</span><span class="sxs-lookup"><span data-stu-id="825bd-131">If the job has the extended limit JOB\_OBJECT\_LIMIT\_SILENT\_BREAKAWAY\_OK, then child processes of any parent process associated with the job are not associated with the job.</span></span> <span data-ttu-id="825bd-132">No es necesario crear procesos primarios con la \_ marca crear separación desde el \_ \_ trabajo.</span><span class="sxs-lookup"><span data-stu-id="825bd-132">It is not necessary for parent processes to be created with the CREATE\_BREAKAWAY\_FROM\_JOB flag.</span></span>

<span data-ttu-id="825bd-133">Si el trabajo está anidado, la configuración de separación de los trabajos primarios de la jerarquía afecta a si los procesos secundarios están asociados a otro trabajo en la jerarquía.</span><span class="sxs-lookup"><span data-stu-id="825bd-133">If the job is nested, the breakaway settings of parent jobs in the hierarchy affect whether child processes are associated with another job in the hierarchy.</span></span> <span data-ttu-id="825bd-134">Para obtener más información, vea [trabajos anidados](nested-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="825bd-134">For more information, see [Nested Jobs](nested-jobs.md).</span></span>

<span data-ttu-id="825bd-135">Para determinar si un proceso se está ejecutando en un trabajo, utilice la función [**IsProcessInJob**](/windows/win32/api/jobapi/nf-jobapi-isprocessinjob) .</span><span class="sxs-lookup"><span data-stu-id="825bd-135">To determine if a process is running in a job, use the [**IsProcessInJob**](/windows/win32/api/jobapi/nf-jobapi-isprocessinjob) function.</span></span>

<span data-ttu-id="825bd-136">Para finalizar todos los procesos asociados actualmente a un objeto de trabajo, utilice la función [**TerminateJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-terminatejobobject) .</span><span class="sxs-lookup"><span data-stu-id="825bd-136">To terminate all processes currently associated with a job object, use the [**TerminateJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-terminatejobobject) function.</span></span>

## <a name="job-limits-and-notifications"></a><span data-ttu-id="825bd-137">Límites del trabajo y notificaciones</span><span class="sxs-lookup"><span data-stu-id="825bd-137">Job Limits and Notifications</span></span>

<span data-ttu-id="825bd-138">Un trabajo puede exigir límites, como el tamaño del espacio de trabajo, la prioridad del proceso y el límite de tiempo del trabajo final de cada proceso asociado con el trabajo.</span><span class="sxs-lookup"><span data-stu-id="825bd-138">A job can enforce limits such as working set size, process priority, and end-of-job time limit on each process that is associated with the job.</span></span> <span data-ttu-id="825bd-139">Si un proceso asociado a un trabajo intenta aumentar su tamaño de espacio de trabajo o la prioridad del proceso desde el límite establecido por el trabajo, las llamadas de función se realizan correctamente pero se omiten de forma silenciosa.</span><span class="sxs-lookup"><span data-stu-id="825bd-139">If a process associated with a job attempts to increase its working set size or process priority from the limit established by the job, the function calls succeed but are silently ignored.</span></span> <span data-ttu-id="825bd-140">Un trabajo también puede establecer los límites que desencadenan una notificación cuando se superan, pero permiten que el trabajo continúe ejecutándose.</span><span class="sxs-lookup"><span data-stu-id="825bd-140">A job can also set limits that trigger a notification when they are exceeded but allow the job to continue to run.</span></span>

<span data-ttu-id="825bd-141">Para establecer los límites de un trabajo, use la función [**SetInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject) .</span><span class="sxs-lookup"><span data-stu-id="825bd-141">To set limits for a job, use the [**SetInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject) function.</span></span> <span data-ttu-id="825bd-142">Para obtener una lista de posibles límites que se pueden establecer para un trabajo, vea los temas siguientes:</span><span class="sxs-lookup"><span data-stu-id="825bd-142">For a list of possible limits that can be set for a job, see the following topics:</span></span>

-   [<span data-ttu-id="825bd-143">**\_información de \_ límite \_ básico de JOBOBJECT**</span><span class="sxs-lookup"><span data-stu-id="825bd-143">**JOBOBJECT\_BASIC\_LIMIT\_INFORMATION**</span></span>](/windows/desktop/api/WinNT/ns-winnt-jobobject_basic_limit_information)
-   [<span data-ttu-id="825bd-144">**restricciones de la \_ \_ interfaz de usuario básica de JOBOBJECT \_**</span><span class="sxs-lookup"><span data-stu-id="825bd-144">**JOBOBJECT\_BASIC\_UI\_RESTRICTIONS**</span></span>](/windows/desktop/api/WinNT/ns-winnt-jobobject_basic_ui_restrictions)
-   [<span data-ttu-id="825bd-145">**\_información de \_ control de velocidad de CPU de JOBOBJECT \_ \_**</span><span class="sxs-lookup"><span data-stu-id="825bd-145">**JOBOBJECT\_CPU\_RATE\_CONTROL\_INFORMATION**</span></span>](/windows/desktop/api/Winnt/ns-winnt-jobobject_cpu_rate_control_information)
-   [<span data-ttu-id="825bd-146">**JOBOBJECT \_ \_ información de límite extendido \_**</span><span class="sxs-lookup"><span data-stu-id="825bd-146">**JOBOBJECT\_EXTENDED\_LIMIT\_INFORMATION**</span></span>](/windows/desktop/api/WinNT/ns-winnt-jobobject_extended_limit_information)
-   [<span data-ttu-id="825bd-147">**\_información de \_ límite de notificación de JOBOBJECT \_**</span><span class="sxs-lookup"><span data-stu-id="825bd-147">**JOBOBJECT\_NOTIFICATION\_LIMIT\_INFORMATION**</span></span>](/windows/desktop/api/WinNT/ns-winnt-jobobject_notification_limit_information)

<span data-ttu-id="825bd-148">Los límites de seguridad deben establecerse individualmente para cada proceso asociado a un objeto de trabajo.</span><span class="sxs-lookup"><span data-stu-id="825bd-148">Security limits must be set individually for each process associated with a job object.</span></span> <span data-ttu-id="825bd-149">Para obtener más información, consulte [seguridad de procesos y derechos de acceso](process-security-and-access-rights.md).</span><span class="sxs-lookup"><span data-stu-id="825bd-149">For more information, see [Process Security and Access Rights](process-security-and-access-rights.md).</span></span>

<span data-ttu-id="825bd-150">**Windows XP con SP3 y Windows Server 2003:** La función [**SetInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject) se puede usar para establecer limitaciones de seguridad para todos los procesos asociados a un objeto de trabajo.</span><span class="sxs-lookup"><span data-stu-id="825bd-150">**Windows XP with SP3 and Windows Server 2003:** The [**SetInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject) function can be used to set security limitations for all processes associated with a job object.</span></span> <span data-ttu-id="825bd-151">A partir de Windows Vista, los límites de seguridad se deben establecer individualmente para cada proceso asociado a un objeto de trabajo.</span><span class="sxs-lookup"><span data-stu-id="825bd-151">Starting with Windows Vista, security limits must be set individually for each process associated with a job object.</span></span>

<span data-ttu-id="825bd-152">Si el trabajo está anidado, los trabajos primarios de la jerarquía influyen en el límite que se aplica para el trabajo.</span><span class="sxs-lookup"><span data-stu-id="825bd-152">If the job is nested, parent jobs in the hierarchy influence the limit that is enforced for the job.</span></span> <span data-ttu-id="825bd-153">Para obtener más información, vea [trabajos anidados](nested-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="825bd-153">For more information, see [Nested Jobs](nested-jobs.md).</span></span>

<span data-ttu-id="825bd-154">Si el trabajo tiene un puerto de finalización de e/s asociado, puede recibir notificaciones cuando se superan determinados límites de trabajo.</span><span class="sxs-lookup"><span data-stu-id="825bd-154">If the job has an associated I/O completion port, it can receive notifications when certain job limits are exceeded.</span></span> <span data-ttu-id="825bd-155">El sistema envía mensajes al puerto de finalización cuando se supera un límite o cuando se producen otros eventos.</span><span class="sxs-lookup"><span data-stu-id="825bd-155">The system sends messages to the completion port when a limit is exceeded or certain other events occur.</span></span> <span data-ttu-id="825bd-156">Para asociar un puerto de finalización a un trabajo, use la función [**SetInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject) con la clase de información de objeto de trabajo **JobObjectAssociateCompletionPortInformation** y un puntero a una estructura de [**\_ \_ \_ Puerto de finalización de JOBOBJECT asociada**](/windows/desktop/api/WinNT/ns-winnt-jobobject_associate_completion_port) .</span><span class="sxs-lookup"><span data-stu-id="825bd-156">To associate a completion port with a job, use the [**SetInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject) function with the job object information class **JobObjectAssociateCompletionPortInformation** and a pointer to a [**JOBOBJECT\_ASSOCIATE\_COMPLETION\_PORT**](/windows/desktop/api/WinNT/ns-winnt-jobobject_associate_completion_port) structure.</span></span> <span data-ttu-id="825bd-157">Es mejor hacerlo cuando el trabajo está inactivo, para reducir la posibilidad de que falten notificaciones para los procesos cuyos Estados cambian durante la Asociación del puerto de finalización.</span><span class="sxs-lookup"><span data-stu-id="825bd-157">It is best to do this when the job is inactive, to reduce the chance of missing notifications for processes whose states change during the association of the completion port.</span></span>

<span data-ttu-id="825bd-158">Todos los mensajes se envían directamente desde el trabajo como si el trabajo hubiera llamado a la función [**PostQueuedCompletionStatus**](/windows/win32/api/ioapiset/nf-ioapiset-postqueuedcompletionstatus) .</span><span class="sxs-lookup"><span data-stu-id="825bd-158">All messages are sent directly from the job as if the job had called the [**PostQueuedCompletionStatus**](/windows/win32/api/ioapiset/nf-ioapiset-postqueuedcompletionstatus) function.</span></span> <span data-ttu-id="825bd-159">Un subproceso debe supervisar el puerto de finalización mediante la función [**GetQueuedCompletionStatus**](/windows/win32/api/ioapiset/nf-ioapiset-getqueuedcompletionstatus) para recoger los mensajes.</span><span class="sxs-lookup"><span data-stu-id="825bd-159">A thread must monitor the completion port using the [**GetQueuedCompletionStatus**](/windows/win32/api/ioapiset/nf-ioapiset-getqueuedcompletionstatus) function to pick up the messages.</span></span> <span data-ttu-id="825bd-160">Tenga en cuenta que, con la excepción de los límites establecidos con la clase de información **JobObjectNotificationLimitInformation** , no se garantiza la entrega de mensajes al puerto de finalización. el hecho de que llegue un mensaje no implica necesariamente que no se haya producido el evento.</span><span class="sxs-lookup"><span data-stu-id="825bd-160">Note that, with the exception of limits set with the **JobObjectNotificationLimitInformation** information class, delivery of messages to the completion port is not guaranteed; failure of a message to arrive does not necessarily mean that the event did not occur.</span></span> <span data-ttu-id="825bd-161">Se garantiza que las notificaciones de los límites establecidos con **JobObjectNotificationLimitInformation** llegan al puerto de finalización.</span><span class="sxs-lookup"><span data-stu-id="825bd-161">Notifications for limits set with **JobObjectNotificationLimitInformation** are guaranteed to arrive at the completion port.</span></span> <span data-ttu-id="825bd-162">Para obtener una lista de los posibles mensajes, consulte [**JOBOBJECT \_ Associate \_ Complete \_ Port**](/windows/desktop/api/WinNT/ns-winnt-jobobject_associate_completion_port).</span><span class="sxs-lookup"><span data-stu-id="825bd-162">For a list of possible messages, see [**JOBOBJECT\_ASSOCIATE\_COMPLETION\_PORT**](/windows/desktop/api/WinNT/ns-winnt-jobobject_associate_completion_port).</span></span>

## <a name="resource-accounting-for-jobs"></a><span data-ttu-id="825bd-163">Contabilidad de recursos para trabajos</span><span class="sxs-lookup"><span data-stu-id="825bd-163">Resource Accounting for Jobs</span></span>

<span data-ttu-id="825bd-164">El objeto de trabajo registra información básica de cuentas de todos sus procesos asociados, incluidos los que han terminado.</span><span class="sxs-lookup"><span data-stu-id="825bd-164">The job object records basic accounting information for all its associated processes, including those that have terminated.</span></span> <span data-ttu-id="825bd-165">Para recuperar esta información de cuentas, utilice la función [**QueryInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-queryinformationjobobject) .</span><span class="sxs-lookup"><span data-stu-id="825bd-165">To retrieve this accounting information, use the [**QueryInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-queryinformationjobobject) function.</span></span> <span data-ttu-id="825bd-166">Para obtener una lista de la información de cuentas que se mantiene para un trabajo, vea los temas siguientes:</span><span class="sxs-lookup"><span data-stu-id="825bd-166">For a list of the accounting information that is maintained for a job, see the following topics:</span></span>

-   [<span data-ttu-id="825bd-167">**\_información básica de \_ cuentas \_ de JOBOBJECT**</span><span class="sxs-lookup"><span data-stu-id="825bd-167">**JOBOBJECT\_BASIC\_ACCOUNTING\_INFORMATION**</span></span>](/windows/desktop/api/WinNT/ns-winnt-jobobject_basic_accounting_information)
-   [<span data-ttu-id="825bd-168">**\_ \_ información de cuentas básica y de \_ e/s de \_ JOBOBJECT \_**</span><span class="sxs-lookup"><span data-stu-id="825bd-168">**JOBOBJECT\_BASIC\_AND\_IO\_ACCOUNTING\_INFORMATION**</span></span>](/windows/desktop/api/WinNT/ns-winnt-jobobject_basic_and_io_accounting_information)

<span data-ttu-id="825bd-169">Si el objeto de trabajo está anidado, la información de cuentas de cada trabajo secundario se agrega en su trabajo primario.</span><span class="sxs-lookup"><span data-stu-id="825bd-169">If the job object is nested, accounting information for each child job is aggregated in its parent job.</span></span> <span data-ttu-id="825bd-170">Para obtener más información, vea [trabajos anidados](nested-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="825bd-170">For more information, see [Nested Jobs](nested-jobs.md).</span></span>

## <a name="managing-job-objects"></a><span data-ttu-id="825bd-171">Administrar objetos de trabajo</span><span class="sxs-lookup"><span data-stu-id="825bd-171">Managing Job Objects</span></span>

<span data-ttu-id="825bd-172">El estado de un objeto de trabajo se establece en señalizado cuando todos sus procesos finalizan porque se ha superado el límite de tiempo de final de trabajo especificado.</span><span class="sxs-lookup"><span data-stu-id="825bd-172">The state of a job object is set to signaled when all of its processes are terminated because the specified end-of-job time limit has been exceeded.</span></span> <span data-ttu-id="825bd-173">Use [**WaitForSingleObject**](/windows/win32/api/synchapi/nf-synchapi-waitforsingleobject) o [**WaitForSingleObjectEx**](/windows/win32/api/synchapi/nf-synchapi-waitforsingleobjectex) para supervisar el objeto de trabajo para este evento.</span><span class="sxs-lookup"><span data-stu-id="825bd-173">Use [**WaitForSingleObject**](/windows/win32/api/synchapi/nf-synchapi-waitforsingleobject) or [**WaitForSingleObjectEx**](/windows/win32/api/synchapi/nf-synchapi-waitforsingleobjectex) to monitor the job object for this event.</span></span>

<span data-ttu-id="825bd-174">Para obtener un identificador para un objeto de trabajo existente, use la función [**OpenJobObject**](/windows/desktop/api/WinBase/nf-winbase-openjobobjecta) y especifique el nombre asignado al objeto cuando se creó.</span><span class="sxs-lookup"><span data-stu-id="825bd-174">To obtain a handle for an existing job object, use the [**OpenJobObject**](/windows/desktop/api/WinBase/nf-winbase-openjobobjecta) function and specify the name given to the object when it was created.</span></span> <span data-ttu-id="825bd-175">Solo se pueden abrir objetos de trabajo con nombre.</span><span class="sxs-lookup"><span data-stu-id="825bd-175">Only named job objects can be opened.</span></span>

<span data-ttu-id="825bd-176">Para cerrar un identificador de objeto de trabajo, utilice la función [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle) .</span><span class="sxs-lookup"><span data-stu-id="825bd-176">To close a job object handle, use the [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle) function.</span></span> <span data-ttu-id="825bd-177">El trabajo se destruye cuando se ha cerrado su último identificador y se han finalizado todos los procesos asociados.</span><span class="sxs-lookup"><span data-stu-id="825bd-177">The job is destroyed when its last handle has been closed and all associated processes have been terminated.</span></span> <span data-ttu-id="825bd-178">Sin embargo, si el trabajo tiene la \_ \_ marca de límite \_ de objetos de trabajo para el \_ \_ cierre del trabajo \_ especificado, al cerrar el último identificador de objeto de trabajo se finalizan todos los procesos asociados y, a continuación, se destruye el propio objeto de trabajo.</span><span class="sxs-lookup"><span data-stu-id="825bd-178">However, if the job has the JOB\_OBJECT\_LIMIT\_KILL\_ON\_JOB\_CLOSE flag specified, closing the last job object handle terminates all associated processes and then destroys the job object itself.</span></span> <span data-ttu-id="825bd-179">Si un trabajo anidado tiene la \_ marca de \_ límite \_ de objetos de trabajo limitado en el cierre del \_ \_ trabajo \_ especificada, al cerrar el último identificador de objeto de trabajo se finalizan todos los procesos asociados con el trabajo y sus trabajos secundarios en la jerarquía.</span><span class="sxs-lookup"><span data-stu-id="825bd-179">If a nested job has the JOB\_OBJECT\_LIMIT\_KILL\_ON\_JOB\_CLOSE flag specified, closing the last job object handle terminates all processes associated with the job and its child jobs in the hierarchy.</span></span>

## <a name="managing-a-process-tree-that-uses-job-objects"></a><span data-ttu-id="825bd-180">Administrar un árbol de procesos que usa objetos de trabajo</span><span class="sxs-lookup"><span data-stu-id="825bd-180">Managing a Process Tree that Uses Job Objects</span></span>

<span data-ttu-id="825bd-181">A partir de Windows 8 y Windows Server 2012, una aplicación puede usar [trabajos anidados](nested-jobs.md) para administrar un árbol de procesos que usa más de un objeto de trabajo.</span><span class="sxs-lookup"><span data-stu-id="825bd-181">Starting with Windows 8 and Windows Server 2012, an application can use [nested jobs](nested-jobs.md) to manage a process tree that uses more than one job object.</span></span> <span data-ttu-id="825bd-182">Sin embargo, una aplicación que se debe ejecutar en Windows 7, Windows Server 2008 R2 o versiones anteriores de Windows que no admiten trabajos anidados debe administrar el árbol de procesos de otras maneras.</span><span class="sxs-lookup"><span data-stu-id="825bd-182">However, an application that must run on Windows 7, Windows Server 2008 R2, or earlier versions of Windows that do not support nested jobs must manage the process tree in other ways.</span></span>

<span data-ttu-id="825bd-183">Si una herramienta debe administrar un árbol de procesos que usa objetos de trabajo y no es posible utilizar trabajos anidados, la herramienta y los miembros del árbol de procesos deben cooperar.</span><span class="sxs-lookup"><span data-stu-id="825bd-183">If a tool must manage a process tree that uses job objects and it is not possible to use nested jobs, both the tool and the members of the process tree must cooperate.</span></span> <span data-ttu-id="825bd-184">Use una de las siguientes opciones:</span><span class="sxs-lookup"><span data-stu-id="825bd-184">Use one of the following options:</span></span>

-   <span data-ttu-id="825bd-185">Use el \_ límite de \_ \_ separación silenciosa del límite de objetos \_ de trabajo \_ .</span><span class="sxs-lookup"><span data-stu-id="825bd-185">Use the JOB\_OBJECT\_LIMIT\_SILENT\_BREAKAWAY\_OK limit.</span></span> <span data-ttu-id="825bd-186">Si la herramienta utiliza este límite, no puede supervisar un árbol de procesos completo.</span><span class="sxs-lookup"><span data-stu-id="825bd-186">If the tool uses this limit, it cannot monitor an entire process tree.</span></span> <span data-ttu-id="825bd-187">La herramienta solo puede supervisar los procesos que agrega al trabajo.</span><span class="sxs-lookup"><span data-stu-id="825bd-187">The tool can monitor only the processes it adds to the job.</span></span> <span data-ttu-id="825bd-188">Si estos procesos crean procesos secundarios, no se asocian con el trabajo.</span><span class="sxs-lookup"><span data-stu-id="825bd-188">If these processes create child processes, they are not associated with the job.</span></span> <span data-ttu-id="825bd-189">En esta opción, los procesos secundarios pueden asociarse a otros objetos de trabajo.</span><span class="sxs-lookup"><span data-stu-id="825bd-189">In this option, child processes can be associated with other job objects.</span></span>
-   <span data-ttu-id="825bd-190">Use el límite de separación de límite de objetos de trabajo \_ \_ \_ \_ correcto.</span><span class="sxs-lookup"><span data-stu-id="825bd-190">Use the JOB\_OBJECT\_LIMIT\_BREAKAWAY\_OK limit.</span></span> <span data-ttu-id="825bd-191">Si la herramienta utiliza este límite, puede supervisar el árbol de procesos completo, excepto aquellos procesos que cualquier miembro del árbol interrumpa explícitamente en el árbol.</span><span class="sxs-lookup"><span data-stu-id="825bd-191">If the tool uses this limit, it can monitor the entire process tree, except for those processes that any member of the tree explicitly breaks away from the tree.</span></span> <span data-ttu-id="825bd-192">Un miembro del árbol puede crear un proceso secundario en un nuevo objeto de trabajo mediante una llamada a la función [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) con la \_ marca crear separación desde el \_ \_ trabajo y, a continuación, llamar a la función [**AssignProcessToJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject) .</span><span class="sxs-lookup"><span data-stu-id="825bd-192">A member of the tree can create a child process in a new job object by calling the [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) function with the CREATE\_BREAKAWAY\_FROM\_JOB flag, then calling the [**AssignProcessToJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject) function.</span></span> <span data-ttu-id="825bd-193">De lo contrario, el miembro debe controlar los casos en los que **AssignProcessToJobObject** produce un error.</span><span class="sxs-lookup"><span data-stu-id="825bd-193">Otherwise, the member must handle cases in which **AssignProcessToJobObject** fails.</span></span>

    <span data-ttu-id="825bd-194">La \_ marca crear separación \_ de \_ trabajo no tiene ningún efecto si la herramienta no está supervisando el árbol.</span><span class="sxs-lookup"><span data-stu-id="825bd-194">The CREATE\_BREAKAWAY\_FROM\_JOB flag has no effect if the tree is not being monitored by the tool.</span></span> <span data-ttu-id="825bd-195">Por lo tanto, esta es la opción preferida, pero requiere un conocimiento avanzado de los procesos que se están supervisando.</span><span class="sxs-lookup"><span data-stu-id="825bd-195">Therefore, this is the preferred option, but it requires advance knowledge of the processes being monitored.</span></span>

-   <span data-ttu-id="825bd-196">Evite las escisión de cualquier tipo si no establece la \_ separación de límite de objetos de trabajo \_ \_ \_ correcta ni el límite de objetos de trabajo \_ límite de \_ \_ separación silenciosa \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="825bd-196">Prevent breakaways of any kind by setting neither the JOB\_OBJECT\_LIMIT\_BREAKAWAY\_OK nor the JOB\_OBJECT\_LIMIT\_SILENT\_BREAKAWAY\_OK limit.</span></span> <span data-ttu-id="825bd-197">En esta opción, la herramienta puede supervisar todo el árbol de procesos.</span><span class="sxs-lookup"><span data-stu-id="825bd-197">In this option, the tool can monitor the entire process tree.</span></span> <span data-ttu-id="825bd-198">Sin embargo, si un proceso secundario intenta asociarse a sí mismo o a otro proceso secundario con un trabajo mediante una llamada a [**AssignProcessToJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject), se producirá un error en la llamada.</span><span class="sxs-lookup"><span data-stu-id="825bd-198">However, if a child process attempts to associate itself or another child process with a job by calling [**AssignProcessToJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject), the call will fail.</span></span> <span data-ttu-id="825bd-199">Si el proceso se ha diseñado para asociarse a un trabajo específico, este error puede impedir que el proceso funcione correctamente.</span><span class="sxs-lookup"><span data-stu-id="825bd-199">If the process was designed to be associated with a specific job, this failure may prevent the process from working properly.</span></span>

 

 
