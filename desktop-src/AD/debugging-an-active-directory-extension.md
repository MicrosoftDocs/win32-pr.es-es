---
title: Depurar una extensión de Active Directory
description: La hoja de propiedades del servicio de directorio de Microsoft Active Directory, el menú contextual y las extensiones del Asistente para creación de objetos que se documentan en este tema se implementan como servidores COM en proceso.
ms.assetid: 8c280084-fd2f-4d34-a119-d4e925a68a5c
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4fc8d9646f4ccc2e8c740a81ddb48422881744f5
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/17/2020
ms.locfileid: "104077538"
---
# <a name="debugging-an-active-directory-extension"></a><span data-ttu-id="bc812-103">Depurar una extensión de Active Directory</span><span class="sxs-lookup"><span data-stu-id="bc812-103">Debugging an Active Directory Extension</span></span>

<span data-ttu-id="bc812-104">La hoja de propiedades del servicio de directorio de Microsoft Active Directory, el menú contextual y las extensiones del Asistente para creación de objetos que se documentan en este tema se implementan como servidores COM en proceso.</span><span class="sxs-lookup"><span data-stu-id="bc812-104">The Microsoft Active Directory directory service property sheet, context menu, and object creation wizard extensions documented in this topic are implemented as COM in-proc servers.</span></span> <span data-ttu-id="bc812-105">Es decir, cada extensión es un archivo DLL que se ejecuta en el contexto del proceso de host.</span><span class="sxs-lookup"><span data-stu-id="bc812-105">That is, each extension is a DLL that runs in the context of the host process.</span></span> <span data-ttu-id="bc812-106">Para depurar la extensión, es necesario asociar la extensión a una aplicación y ejecutar la aplicación en un depurador.</span><span class="sxs-lookup"><span data-stu-id="bc812-106">To debug the extension, it is necessary to associate the extension with an application and run the application in a debugger.</span></span>

## <a name="debugging-active-directory-extensions-displayed-in-the-windows-shell"></a><span data-ttu-id="bc812-107">Depurar extensiones de Active Directory mostradas en el shell de Windows</span><span class="sxs-lookup"><span data-stu-id="bc812-107">Debugging Active Directory Extensions Displayed in the Windows Shell</span></span>

<span data-ttu-id="bc812-108">Active Directory extensiones mostradas en el shell de Windows se cargan en el contexto del proceso de Explorer.exe.</span><span class="sxs-lookup"><span data-stu-id="bc812-108">Active Directory extensions displayed in the Windows shell are loaded in the context of the Explorer.exe process.</span></span> <span data-ttu-id="bc812-109">Estas extensiones se pueden depurar como una extensión de Shell estándar.</span><span class="sxs-lookup"><span data-stu-id="bc812-109">These extensions can be debugged like a standard shell extension.</span></span> <span data-ttu-id="bc812-110">Para obtener más información sobre cómo depurar extensiones de Shell, consulte [depuración con el shell](/previous-versions/windows/desktop/legacy/cc144064(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="bc812-110">For more information about debugging shell extensions, see [Debugging with the Shell](/previous-versions/windows/desktop/legacy/cc144064(v=vs.85)).</span></span>

## <a name="debugging-active-directory-extensions-displayed-in-the-active-directory-mmc-snap-ins"></a><span data-ttu-id="bc812-111">Depurar extensiones de Active Directory mostradas en el Active Directory MMC Snap-Ins</span><span class="sxs-lookup"><span data-stu-id="bc812-111">Debugging Active Directory Extensions Displayed in the Active Directory MMC Snap-Ins</span></span>

<span data-ttu-id="bc812-112">Active Directory extensiones mostradas en el Active Directory complementos de MMC administrativos se cargan en el contexto de Microsoft Management Console.</span><span class="sxs-lookup"><span data-stu-id="bc812-112">Active Directory extensions displayed in the Active Directory administrative MMC snap-ins are loaded in the context of the Microsoft Management Console.</span></span> <span data-ttu-id="bc812-113">Para depurar una extensión, busque Mmc.exe en el sistema local y establezca el depurador para utilizarlo como la aplicación para la depuración.</span><span class="sxs-lookup"><span data-stu-id="bc812-113">To debug an extension, locate Mmc.exe on the local system and set the debugger to use this as the application for debugging.</span></span> <span data-ttu-id="bc812-114">En la mayoría de los sistemas, Mmc.exe se encuentra en el directorio del sistema de Windows, por ejemplo, C: \\ WinNT \\ system32.</span><span class="sxs-lookup"><span data-stu-id="bc812-114">On most systems, Mmc.exe is located in the Windows system directory, for example, C:\\WINNT\\System32.</span></span> <span data-ttu-id="bc812-115">Dependiendo del depurador, puede o no tener que establecer el archivo DLL de extensión para que lo cargue también el depurador.</span><span class="sxs-lookup"><span data-stu-id="bc812-115">Depending on the debugger, you may or may not have to set the extension DLL to also be loaded by the debugger.</span></span> <span data-ttu-id="bc812-116">Muchos depuradores también permiten adjuntar el depurador a un proceso de MMC en ejecución.</span><span class="sxs-lookup"><span data-stu-id="bc812-116">Many debuggers also allow you to attach the debugger to a running MMC process.</span></span> <span data-ttu-id="bc812-117">Para obtener más información, vea el manual del usuario del depurador.</span><span class="sxs-lookup"><span data-stu-id="bc812-117">For more information, see your debugger User's Guide.</span></span>

<span data-ttu-id="bc812-118">Puede ser conveniente que MMC cargue automáticamente un complemento específico.</span><span class="sxs-lookup"><span data-stu-id="bc812-118">It can be convenient to have MMC automatically load a specific snap-in.</span></span> <span data-ttu-id="bc812-119">Para ello, establezca los argumentos de la aplicación en la ruta de acceso y el nombre de archivo de un archivo MSC.</span><span class="sxs-lookup"><span data-stu-id="bc812-119">To do this, set the application arguments to the path and file name of an MSC file.</span></span> <span data-ttu-id="bc812-120">Puede ser un archivo MSC instalado por el sistema o uno que cree.</span><span class="sxs-lookup"><span data-stu-id="bc812-120">This can either be a system-installed MSC file or one you create.</span></span> <span data-ttu-id="bc812-121">Se puede crear un archivo MSC siguiendo estos pasos.</span><span class="sxs-lookup"><span data-stu-id="bc812-121">An MSC file can be created by following these steps.</span></span>

1.  <span data-ttu-id="bc812-122">Ejecute Mmc.exe.</span><span class="sxs-lookup"><span data-stu-id="bc812-122">Run Mmc.exe.</span></span>
2.  <span data-ttu-id="bc812-123">Cargue el complemento deseado seleccionando **archivo**  -  **Agregar o quitar complemento...** en el menú MMC y seleccione el complemento que desee.</span><span class="sxs-lookup"><span data-stu-id="bc812-123">Load the desired snap-in by selecting **File** - **Add/Remove Snap-in...** in the MMC menu and select the desired snap-in.</span></span>
3.  <span data-ttu-id="bc812-124">Guarde el archivo MSC seleccionando **archivo**  -  **Guardar como...** en el menú MMC.</span><span class="sxs-lookup"><span data-stu-id="bc812-124">Save the MSC file by selecting **File** - **Save As...** in the MMC menu.</span></span>

<span data-ttu-id="bc812-125">Si no establece un archivo MSC de inicio, debe cargar manualmente el complemento deseado cuando ejecute la aplicación en el depurador.</span><span class="sxs-lookup"><span data-stu-id="bc812-125">If you do not set a start-up MSC file, you must manually load the desired snap-in when you run the application in the debugger.</span></span>

<span data-ttu-id="bc812-126">Cuando la aplicación host se ejecuta en el depurador, el depurador puede mostrar un mensaje de advertencia que indica que la aplicación que se está ejecutando no contiene símbolos de depuración.</span><span class="sxs-lookup"><span data-stu-id="bc812-126">When the host application is run in the debugger, the debugger may display a warning message stating that the application being run does not contain any debug symbols.</span></span> <span data-ttu-id="bc812-127">Esto es normal y se puede omitir sin ningún riesgo porque realmente está depurando el archivo DLL, no la aplicación host.</span><span class="sxs-lookup"><span data-stu-id="bc812-127">This is expected and can safely be ignored because you are actually debugging the DLL, not the host application.</span></span>

<span data-ttu-id="bc812-128">En la mayoría de los casos, no se llamará a la extensión hasta que el usuario realice alguna acción que provoque la carga y la inicialización de la extensión.</span><span class="sxs-lookup"><span data-stu-id="bc812-128">In most cases, the extension will not be called until the user performs some action that causes the extension to be loaded and initialized.</span></span> <span data-ttu-id="bc812-129">Por ejemplo, si está depurando una extensión de menú contextual que se muestra para los objetos de usuario, la extensión no se cargará hasta que se muestre el menú contextual de un objeto de usuario por primera vez.</span><span class="sxs-lookup"><span data-stu-id="bc812-129">For example, if you are debugging a context menu extension displayed for user objects, the extension will not load until the first time the context menu for a user object is displayed.</span></span>

<span data-ttu-id="bc812-130">Ahora debería poder establecer puntos de interrupción y ver los resultados de la depuración.</span><span class="sxs-lookup"><span data-stu-id="bc812-130">You should now be able to set breakpoints and view debug output.</span></span> <span data-ttu-id="bc812-131">Si no parece que la extensión se cargue, establezca un punto de interrupción en la función [**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) de la extensión.</span><span class="sxs-lookup"><span data-stu-id="bc812-131">If the extension does not appear to load, set a breakpoint in the extension's [**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) function.</span></span> <span data-ttu-id="bc812-132">Si no se llama a **DllGetClassObject** , es probable que la extensión no esté registrada correctamente.</span><span class="sxs-lookup"><span data-stu-id="bc812-132">If **DllGetClassObject** is not called, the extension is probably not registered correctly.</span></span>

<span data-ttu-id="bc812-133">Una vez finalizada la depuración, salga de MMC y el depurador debe descargarse con normalidad.</span><span class="sxs-lookup"><span data-stu-id="bc812-133">When the debug is complete, exit MMC and the debugger should unload normally.</span></span>

 

 