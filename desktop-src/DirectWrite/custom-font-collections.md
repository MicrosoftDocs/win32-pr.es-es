---
title: Colecciones de fuentes personalizadas (Windows 7/8)
description: DirectWrite proporciona acceso a la colección de fuentes del sistema mediante el método IDWriteFactory GetSystemFontCollection.
ms.assetid: ec892904-6778-4fbd-93b4-62d0db5b82ea
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 39aa764330f27b72051ef682c6ce5f1176c42c7d
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "103792663"
---
# <a name="custom-font-collections-windows-78"></a><span data-ttu-id="23e23-103">Colecciones de fuentes personalizadas (Windows 7/8)</span><span class="sxs-lookup"><span data-stu-id="23e23-103">Custom Font Collections (Windows 7/8)</span></span>

<span data-ttu-id="23e23-104">[DirectWrite](direct-write-portal.md) proporciona acceso a la colección de fuentes del sistema mediante el método [**IDWriteFactory:: GetSystemFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-getsystemfontcollection) .</span><span class="sxs-lookup"><span data-stu-id="23e23-104">[DirectWrite](direct-write-portal.md) provides access to the system font collection by using the [**IDWriteFactory::GetSystemFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-getsystemfontcollection) method.</span></span> <span data-ttu-id="23e23-105">Esta es la colección de fuentes que se usa con más frecuencia.</span><span class="sxs-lookup"><span data-stu-id="23e23-105">This is the font collection that is most frequently used.</span></span> <span data-ttu-id="23e23-106">Sin embargo, algunas aplicaciones tienen que usar fuentes que no están instaladas en el sistema, como los archivos de fuente incluidos o los archivos de fuentes incrustados en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="23e23-106">However some applications have to use fonts that are not installed on the system, such as from included font files or font files embedded in the application.</span></span>

<span data-ttu-id="23e23-107">Si las fuentes que desea no están en la colección de fuentes del sistema, puede crear una colección de fuentes personalizada derivada de [**IDWriteFontCollection**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollection).</span><span class="sxs-lookup"><span data-stu-id="23e23-107">If the fonts that you want are not in the system font collection, you can create a custom font collection derived from [**IDWriteFontCollection**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollection).</span></span>

<span data-ttu-id="23e23-108">Esta información general consta de las siguientes partes:</span><span class="sxs-lookup"><span data-stu-id="23e23-108">This overview consists of the following parts:</span></span>

-   [<span data-ttu-id="23e23-109">Registrar y anular el registro de un cargador de colecciones de fuentes</span><span class="sxs-lookup"><span data-stu-id="23e23-109">Registering and unregistering a Font Collection Loader</span></span>](#registering-and-unregistering-a-font-collection-loader)
-   [<span data-ttu-id="23e23-110">IDWriteFontCollectionLoader</span><span class="sxs-lookup"><span data-stu-id="23e23-110">IDWriteFontCollectionLoader</span></span>](#idwritefontcollectionloader)
-   [<span data-ttu-id="23e23-111">IDWriteFontFileEnumerator</span><span class="sxs-lookup"><span data-stu-id="23e23-111">IDWriteFontFileEnumerator</span></span>](#idwritefontfileenumerator)
-   [<span data-ttu-id="23e23-112">CreateCustomFontFileReference</span><span class="sxs-lookup"><span data-stu-id="23e23-112">CreateCustomFontFileReference</span></span>](#createcustomfontfilereference)
-   [<span data-ttu-id="23e23-113">IDWriteFontFileLoader</span><span class="sxs-lookup"><span data-stu-id="23e23-113">IDWriteFontFileLoader</span></span>](#idwritefontfileloader)
-   [<span data-ttu-id="23e23-114">IDWriteFontFileStream</span><span class="sxs-lookup"><span data-stu-id="23e23-114">IDWriteFontFileStream</span></span>](#idwritefontfilestream)

## <a name="registering-and-unregistering-a-font-collection-loader"></a><span data-ttu-id="23e23-115">Registrar y anular el registro de un cargador de colecciones de fuentes</span><span class="sxs-lookup"><span data-stu-id="23e23-115">Registering and unregistering a Font Collection Loader</span></span>

<span data-ttu-id="23e23-116">Registre un cargador de colección de fuentes mediante el método [**IDWriteFactory:: RegisterFontCollectionLoader**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-registerfontcollectionloader) y pasándole una interfaz [**IDWriteFontCollectionLoader**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollectionloader) implementada por la aplicación como un objeto singleton.</span><span class="sxs-lookup"><span data-stu-id="23e23-116">You register a font collection loader by using the [**IDWriteFactory::RegisterFontCollectionLoader**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-registerfontcollectionloader) method and passing it an [**IDWriteFontCollectionLoader**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollectionloader) interface implemented by the application as a singleton object.</span></span> <span data-ttu-id="23e23-117">Este objeto cargará las fuentes cuando se solicite la colección personalizada.</span><span class="sxs-lookup"><span data-stu-id="23e23-117">This object will load the fonts when the custom collection is requested.</span></span> <span data-ttu-id="23e23-118">Tanto la colección de fuentes del sistema como las colecciones de fuentes personalizadas se almacenan en caché, por lo que las fuentes solo se cargan una vez.</span><span class="sxs-lookup"><span data-stu-id="23e23-118">Both the system font collection and custom font collections are cached, so the fonts are only loaded one time.</span></span>

<span data-ttu-id="23e23-119">El cargador de la colección de fuentes se debe descargar finalmente mediante [**IDWriteFactory:: UnregisterFontCollectionLoader**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-unregisterfontcollectionloader).</span><span class="sxs-lookup"><span data-stu-id="23e23-119">The font collection loader must be unloaded eventually by using the [**IDWriteFactory::UnregisterFontCollectionLoader**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-unregisterfontcollectionloader).</span></span>

> [!Note]  
> <span data-ttu-id="23e23-120">El registro del cargador de la colección de fuentes se agrega al recuento de referencias; no llame a [**UnregisterFontCollectionLoader**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-unregisterfontcollectionloader) desde dentro del destructor o el objeto del cargador de la colección nunca se eliminará del registro.</span><span class="sxs-lookup"><span data-stu-id="23e23-120">Registering the font collection loader adds to the reference count; do not call [**UnregisterFontCollectionLoader**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-unregisterfontcollectionloader) from within the destructor or the collection loader object will never be unregistered.</span></span>

 

## <a name="idwritefontcollectionloader"></a><span data-ttu-id="23e23-121">IDWriteFontCollectionLoader</span><span class="sxs-lookup"><span data-stu-id="23e23-121">IDWriteFontCollectionLoader</span></span>

<span data-ttu-id="23e23-122">Cree un objeto [**IDWriteFontFileEnumerator**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfileenumerator) mediante [**IDWriteFactory:: CreateCustomFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontcollection) y pasándole una clave definida por la aplicación.</span><span class="sxs-lookup"><span data-stu-id="23e23-122">You create an [**IDWriteFontFileEnumerator**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfileenumerator) object by using the [**IDWriteFactory::CreateCustomFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontcollection) and passing it an application-defined key.</span></span> <span data-ttu-id="23e23-123">La clave es un puntero void y el tipo de datos, el formato y el significado están definidos por la aplicación y son opacos para el sistema de fuentes.</span><span class="sxs-lookup"><span data-stu-id="23e23-123">The key is a void pointer and the data type, format, and meaning are defined by the application and are opaque to the font system.</span></span>

<span data-ttu-id="23e23-124">Mientras que la clave puede ser cualquier cosa, [DirectWrite](direct-write-portal.md) requiere que cada clave sea:</span><span class="sxs-lookup"><span data-stu-id="23e23-124">Whereas the key can be anything, [DirectWrite](direct-write-portal.md) requires that each key is both:</span></span>

-   <span data-ttu-id="23e23-125">Es único para una colección de fuentes única dentro del ámbito del cargador.</span><span class="sxs-lookup"><span data-stu-id="23e23-125">Unique to a single font collection within the scope of the loader.</span></span>
-   <span data-ttu-id="23e23-126">Válido hasta que se anule el registro del cargador mediante el generador.</span><span class="sxs-lookup"><span data-stu-id="23e23-126">Valid until the loader is unregistered using the factory.</span></span>

<span data-ttu-id="23e23-127">Cuando se llama al método [**CreateCustomFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontcollection) , [DirectWrite](direct-write-portal.md) vuelve a llamar a una interfaz [**IDWriteFontCollectionLoader**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollectionloader) implementada como un objeto singleton por parte de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="23e23-127">When the [**CreateCustomFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontcollection) method is called, [DirectWrite](direct-write-portal.md) calls back to an [**IDWriteFontCollectionLoader**](/windows/win32/api/dwrite/nn-dwrite-idwritefontcollectionloader) interface implemented as a singleton object by the application.</span></span> <span data-ttu-id="23e23-128">DirectWrite usa el método de devolución de llamada [**IDWriteFontCollectionLoader:: CreateEnumeratorFromKey**](/windows/win32/api/dwrite/nf-dwrite-idwritefontcollectionloader-createenumeratorfromkey) para recuperar un objeto [**IDWriteFontFileEnumerator**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfileenumerator) implementado por la aplicación.</span><span class="sxs-lookup"><span data-stu-id="23e23-128">The [**IDWriteFontCollectionLoader::CreateEnumeratorFromKey**](/windows/win32/api/dwrite/nf-dwrite-idwritefontcollectionloader-createenumeratorfromkey) callback method is used by DirectWrite to retrieve an [**IDWriteFontFileEnumerator**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfileenumerator) object implemented by the application.</span></span> <span data-ttu-id="23e23-129">El objeto [**IDWriteFactory**](/windows/win32/api/dwrite/nn-dwrite-idwritefactory) que se usa para crear la colección se pasa a este método y debe ser utilizado por el enumerador de archivos de fuente para crear los objetos [**IDWriteFontFile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) que se van a incluir en la colección.</span><span class="sxs-lookup"><span data-stu-id="23e23-129">The [**IDWriteFactory**](/windows/win32/api/dwrite/nn-dwrite-idwritefactory) object that is being used to create the collection is passed to this method and should be used by the font file enumerator to create the [**IDWriteFontFile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) objects to be included in the collection.</span></span>

<span data-ttu-id="23e23-130">La clave pasada a este método identifica la colección de fuentes y es la misma clave que se pasa a [**CreateCustomFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontcollection).</span><span class="sxs-lookup"><span data-stu-id="23e23-130">The key passed to this method identifies the font collection and is the same key passed to [**CreateCustomFontCollection**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontcollection).</span></span>

## <a name="idwritefontfileenumerator"></a><span data-ttu-id="23e23-131">IDWriteFontFileEnumerator</span><span class="sxs-lookup"><span data-stu-id="23e23-131">IDWriteFontFileEnumerator</span></span>

<span data-ttu-id="23e23-132">El objeto [**IDWriteFontFileEnumerator**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfileenumerator) definido por la aplicación creado por el método [**CreateEnumeratorFromKey**](/windows/win32/api/dwrite/nf-dwrite-idwritefontcollectionloader-createenumeratorfromkey) se utiliza para enumerar los archivos de fuente de una colección, creando un objeto [**IDWriteFontFile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) para cada archivo.</span><span class="sxs-lookup"><span data-stu-id="23e23-132">The application-defined [**IDWriteFontFileEnumerator**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfileenumerator) object that was created by the [**CreateEnumeratorFromKey**](/windows/win32/api/dwrite/nf-dwrite-idwritefontcollectionloader-createenumeratorfromkey) method is used to enumerate the font files in a collection, creating an [**IDWriteFontFile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) object for each file.</span></span> <span data-ttu-id="23e23-133">El método [**IDWriteFontFileEnumerator:: MoveNext**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-movenext) cambia la posición al siguiente archivo de fuente.</span><span class="sxs-lookup"><span data-stu-id="23e23-133">The [**IDWriteFontFileEnumerator::MoveNext**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-movenext) method changes the position to the next font file.</span></span> <span data-ttu-id="23e23-134">Si hay un archivo en la posición, se establecerá el valor de *hasCurrentFile* en **true**.</span><span class="sxs-lookup"><span data-stu-id="23e23-134">If there is a file at the position, it will set the *hasCurrentFile* to **TRUE**.</span></span> <span data-ttu-id="23e23-135">De lo contrario, se establecerá en **false** y el método devolverá los valores **\_ correctos**.</span><span class="sxs-lookup"><span data-stu-id="23e23-135">Otherwise it will be set to **FALSE** and the method will return **S\_OK**.</span></span>

> [!Note]  
> <span data-ttu-id="23e23-136">El enumerador de archivo de fuente debe comenzar a colocarse antes del primer elemento y avanzado en la primera llamada a [**MoveNext**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-movenext).</span><span class="sxs-lookup"><span data-stu-id="23e23-136">The font file enumerator must start positioned before the first element and advanced at the first call to [**MoveNext**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-movenext).</span></span>

 

<span data-ttu-id="23e23-137">El método [**IDWriteFontFileEnumerator:: GetCurrentFontFile**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-getcurrentfontfile) genera un objeto [**IDWriteFontFile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) .</span><span class="sxs-lookup"><span data-stu-id="23e23-137">An [**IDWriteFontFile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) object is output by the [**IDWriteFontFileEnumerator::GetCurrentFontFile**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-getcurrentfontfile) method.</span></span> <span data-ttu-id="23e23-138">Si no hay ningún archivo de fuentes en la posición actual, ya que no se ha llamado a [**MoveNext**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-movenext) o hasCurrentFile se ha establecido en **false**, **GetCurrentFontFile** devolverá **E \_ producirá un error**.</span><span class="sxs-lookup"><span data-stu-id="23e23-138">If there is no font file at the current position, because [**MoveNext**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-movenext) has not yet been called or hasCurrentFile was set to **FALSE**, then **GetCurrentFontFile** will return **E\_FAIL**.</span></span>

## <a name="createcustomfontfilereference"></a><span data-ttu-id="23e23-139">CreateCustomFontFileReference</span><span class="sxs-lookup"><span data-stu-id="23e23-139">CreateCustomFontFileReference</span></span>

<span data-ttu-id="23e23-140">La salida del objeto [**IDWriteFontFile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) de [**GetCurrentFontFile**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-getcurrentfontfile) se puede crear llamando a [**IDWriteFactory:: CreateCustomFontFileReference**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontfilereference).</span><span class="sxs-lookup"><span data-stu-id="23e23-140">The [**IDWriteFontFile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) object output by [**GetCurrentFontFile**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileenumerator-getcurrentfontfile) can be created by calling [**IDWriteFactory::CreateCustomFontFileReference**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontfilereference).</span></span> <span data-ttu-id="23e23-141">La clave de referencia de archivo de fuente identifica una referencia de archivo de fuente específica y debe ser única en el cargador de archivos de fuentes que cargará el archivo.</span><span class="sxs-lookup"><span data-stu-id="23e23-141">The font file reference key identifies a specific font file reference and must be unique within the font file loader that will load the file.</span></span>

## <a name="idwritefontfileloader"></a><span data-ttu-id="23e23-142">IDWriteFontFileLoader</span><span class="sxs-lookup"><span data-stu-id="23e23-142">IDWriteFontFileLoader</span></span>

<span data-ttu-id="23e23-143">El método [**CreateCustomFontFileReference**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontfilereference) toma un objeto [**IDWriteFontFileLoader**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfileloader) implementado por la aplicación que se usa para cargar la fuente.</span><span class="sxs-lookup"><span data-stu-id="23e23-143">The [**CreateCustomFontFileReference**](/windows/win32/api/dwrite/nf-dwrite-idwritefactory-createcustomfontfilereference) method takes an [**IDWriteFontFileLoader**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfileloader) object implemented by the application that is used to load the font.</span></span> <span data-ttu-id="23e23-144">El método de devolución de llamada [**IDWriteFontFileLoader:: CreateStreamFromKey**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileloader-createstreamfromkey) pasa la clave y genera un objeto [**IDWriteFontFileStream**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfilestream) .</span><span class="sxs-lookup"><span data-stu-id="23e23-144">The [**IDWriteFontFileLoader::CreateStreamFromKey**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfileloader-createstreamfromkey) callback method is passed the key and outputs an [**IDWriteFontFileStream**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfilestream) object.</span></span>

## <a name="idwritefontfilestream"></a><span data-ttu-id="23e23-145">IDWriteFontFileStream</span><span class="sxs-lookup"><span data-stu-id="23e23-145">IDWriteFontFileStream</span></span>

<span data-ttu-id="23e23-146">El objeto [**IDWriteFontFileStream**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfilestream) implementado por la aplicación proporciona los datos de archivo de fuente para una referencia de archivo de fuente de un cargador de archivos de fuentes personalizado.</span><span class="sxs-lookup"><span data-stu-id="23e23-146">The application-implemented [**IDWriteFontFileStream**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfilestream) object provides the font file data for a font file reference from a custom font file loader.</span></span> <span data-ttu-id="23e23-147">Junto con el tamaño de archivo y la hora de la última escritura, proporciona un método ([**ReadFileFragment**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfilestream-readfilefragment)) para recuperar los fragmentos de archivo que se van a compilar en un objeto [**IDWriteFontFile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) .</span><span class="sxs-lookup"><span data-stu-id="23e23-147">Together with the file size and last write time, it provides a method ([**ReadFileFragment**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfilestream-readfilefragment)) for retrieving file fragments that are to be compiled into an [**IDWriteFontFile**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfile) object.</span></span>

> [!Note]  
> <span data-ttu-id="23e23-148">Las implementaciones de [**ReadFileFragment**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfilestream-readfilefragment) deben devolver un error si el fragmento solicitado está fuera de los límites del archivo.</span><span class="sxs-lookup"><span data-stu-id="23e23-148">[**ReadFileFragment**](/windows/win32/api/dwrite/nf-dwrite-idwritefontfilestream-readfilefragment) implementations should return an error if the requested fragment is outside the file bounds.</span></span>

 

<span data-ttu-id="23e23-149">Un [**IDWriteFontFileStream**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfilestream) puede obtener el contenido del archivo de fuente desde cualquier lugar, como la unidad de disco duro local o los recursos incrustados.</span><span class="sxs-lookup"><span data-stu-id="23e23-149">An [**IDWriteFontFileStream**](/windows/win32/api/dwrite/nn-dwrite-idwritefontfilestream) can get the font file contents from anywhere, such as the local hard disk drive, or embedded resources.</span></span>

 

 