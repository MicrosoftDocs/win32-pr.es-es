---
description: .
ms.assetid: CF3A427D-31D2-45FF-BE87-F192B758204E
title: Sesión de medios de PMP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5f0e14d9e403620d273bb4aeb3347cba523f304b
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/03/2021
ms.locfileid: "104361834"
---
# <a name="pmp-media-session"></a><span data-ttu-id="e194b-103">Sesión de medios de PMP</span><span class="sxs-lookup"><span data-stu-id="e194b-103">PMP Media Session</span></span>

<span data-ttu-id="e194b-104">Una aplicación puede crear la [sesión multimedia](media-session.md) en un proceso independiente denominado el proceso de la [ruta de acceso a medios protegidos](protected-media-path.md) (PMP).</span><span class="sxs-lookup"><span data-stu-id="e194b-104">An application can create the [Media Session](media-session.md) in a separate process called the [Protected Media Path](protected-media-path.md) (PMP) process.</span></span> <span data-ttu-id="e194b-105">El propósito principal del proceso de PMP es habilitar la reproducción de contenido protegido con administración de derechos digitales (DRM).</span><span class="sxs-lookup"><span data-stu-id="e194b-105">The main purpose of the PMP process is to enable playback of protected content using digital rights management (DRM).</span></span> <span data-ttu-id="e194b-106">De forma predeterminada, el proceso de PMP se crea dentro de un entorno protegido (PE).</span><span class="sxs-lookup"><span data-stu-id="e194b-106">By default, the PMP process is created inside a Protected Environment (PE).</span></span> <span data-ttu-id="e194b-107">Solo los componentes firmados de confianza se pueden cargar dentro de un PE.</span><span class="sxs-lookup"><span data-stu-id="e194b-107">Only trusted, signed components can be loaded inside a PE.</span></span> <span data-ttu-id="e194b-108">Una ventaja secundaria del proceso de PMP es que aísla el proceso de aplicación de la canalización multimedia.</span><span class="sxs-lookup"><span data-stu-id="e194b-108">A secondary benefit of the PMP process is that it isolates the application process from the media pipeline.</span></span> <span data-ttu-id="e194b-109">Para obtener más información sobre el proceso de PMP, vea [ruta de acceso a medios protegidos](protected-media-path.md).</span><span class="sxs-lookup"><span data-stu-id="e194b-109">For more information about the PMP process, see [Protected Media Path](protected-media-path.md).</span></span>

<span data-ttu-id="e194b-110">Para crear la sesión multimedia dentro del proceso de PMP, llame a la función [**MFCreatePMPMediaSession**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession) .</span><span class="sxs-lookup"><span data-stu-id="e194b-110">To create the Media Session inside the PMP process, call the [**MFCreatePMPMediaSession**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession) function.</span></span> <span data-ttu-id="e194b-111">Opcionalmente, puede pasar la marca de **\_ \_ proceso sin protección de MFPMPSESSION** .</span><span class="sxs-lookup"><span data-stu-id="e194b-111">Optionally, you can pass in the **MFPMPSESSION\_UNPROTECTED\_PROCESS** flag.</span></span> <span data-ttu-id="e194b-112">Si se establece esta marca, el proceso de PMP se crea dentro de un proceso sin protección y no en un proceso de PE.</span><span class="sxs-lookup"><span data-stu-id="e194b-112">If this flag is set, the PMP process is created inside an unprotected process, and not a PE process.</span></span> <span data-ttu-id="e194b-113">El proceso sin protección no se puede usar para la reproducción de DRM, pero ofrece las ventajas del aislamiento de procesos.</span><span class="sxs-lookup"><span data-stu-id="e194b-113">The unprotected process cannot be used for DRM playback, but does give you the benefits of process isolation.</span></span>

<span data-ttu-id="e194b-114">La función [**MFCreatePMPMediaSession**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession) devuelve un puntero a un objeto proxy para la sesión multimedia.</span><span class="sxs-lookup"><span data-stu-id="e194b-114">The [**MFCreatePMPMediaSession**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession) function returns a pointer to a proxy object for the Media Session.</span></span> <span data-ttu-id="e194b-115">La aplicación se comunica con la sesión multimedia a través del proxy.</span><span class="sxs-lookup"><span data-stu-id="e194b-115">The application communicates with the Media Session through the proxy.</span></span>

![Ilustración de la sesión multimedia dentro del proceso de PMP](images/pmp01.png)

<span data-ttu-id="e194b-117">De forma predeterminada, cuando la aplicación crea una topología, el origen de medios se crea dentro del proceso de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="e194b-117">By default, when the application creates a topology, the media source is created inside the application process.</span></span> <span data-ttu-id="e194b-118">En el proceso de PMP se crea un proxy para el origen de medios.</span><span class="sxs-lookup"><span data-stu-id="e194b-118">A proxy to the media source is created inside the PMP process.</span></span> <span data-ttu-id="e194b-119">El origen de medios puede crear objetos dentro del proceso de PMP mediante la interfaz [**IMFPMPHost**](/windows/desktop/api/mfidl/nf-mfidl-imfpmphost-createobjectbyclsid) .</span><span class="sxs-lookup"><span data-stu-id="e194b-119">The media source can create objects inside the PMP process by using the [**IMFPMPHost**](/windows/desktop/api/mfidl/nf-mfidl-imfpmphost-createobjectbyclsid) interface.</span></span> <span data-ttu-id="e194b-120">Por ejemplo, para admitir DRM, un origen multimedia crea un objeto denominado *autoridad de confianza de entrada* (ITA).</span><span class="sxs-lookup"><span data-stu-id="e194b-120">For example, to support DRM, a media source creates an object called an *input trust authority* (ITA).</span></span> <span data-ttu-id="e194b-121">La ITA debe crearse dentro del proceso de PMP.</span><span class="sxs-lookup"><span data-stu-id="e194b-121">The ITA must be created inside the PMP process.</span></span> <span data-ttu-id="e194b-122">(Para obtener más información sobre ITAs, vea [ruta de acceso de medios protegidos](protected-media-path.md)). Para usar la interfaz [**IMFPMPHost**](/windows/desktop/api/mfidl/nn-mfidl-imfpmphost) , haga lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="e194b-122">(For more information about ITAs, see [Protected Media Path](protected-media-path.md).) To use the [**IMFPMPHost**](/windows/desktop/api/mfidl/nn-mfidl-imfpmphost) interface, do the following:</span></span>

1.  <span data-ttu-id="e194b-123">El origen del medio debe implementar la interfaz [**IMFPMPClient**](/windows/desktop/api/mfidl/nn-mfidl-imfpmpclient) .</span><span class="sxs-lookup"><span data-stu-id="e194b-123">The media source must implement the [**IMFPMPClient**](/windows/desktop/api/mfidl/nn-mfidl-imfpmpclient) interface.</span></span>
2.  <span data-ttu-id="e194b-124">Durante la resolución de la topología, el proxy de la sesión multimedia llama al método [**IMFPMPClient:: SetPMPHost**](/windows/desktop/api/mfidl/nf-mfidl-imfpmpclient-setpmphost) en el origen del medio.</span><span class="sxs-lookup"><span data-stu-id="e194b-124">During topology resolution, the Media Session proxy calls the [**IMFPMPClient::SetPMPHost**](/windows/desktop/api/mfidl/nf-mfidl-imfpmpclient-setpmphost) method on the media source.</span></span>
3.  <span data-ttu-id="e194b-125">El origen multimedia llama a [**IMFPMPHost:: CreateObjectByCLSID**](/windows/desktop/api/mfidl/nf-mfidl-imfpmphost-createobjectbyclsid) para crear el objeto dentro del proceso de PMP.</span><span class="sxs-lookup"><span data-stu-id="e194b-125">The media source calls [**IMFPMPHost::CreateObjectByCLSID**](/windows/desktop/api/mfidl/nf-mfidl-imfpmphost-createobjectbyclsid) to create the object inside the PMP process.</span></span> <span data-ttu-id="e194b-126">El objeto debe tener un CLSID registrado.</span><span class="sxs-lookup"><span data-stu-id="e194b-126">The object must have a registered CLSID.</span></span> <span data-ttu-id="e194b-127">Además, para cargar dentro del PE, el objeto debe ser de confianza y estar firmado digitalmente.</span><span class="sxs-lookup"><span data-stu-id="e194b-127">Also, to load inside the PE, the object must be trusted and digitally signed.</span></span> <span data-ttu-id="e194b-128">Para obtener información acerca de los componentes multimedia protegidos de la firma de código, consulte las notas del producto [firma de código para componentes multimedia protegidos en Windows Vista](/windows-hardware/test/hlk/) .</span><span class="sxs-lookup"><span data-stu-id="e194b-128">For information about code signing protected media components, see the white paper [Code Signing for Protected Media Components in Windows Vista](/windows-hardware/test/hlk/)</span></span>

<span data-ttu-id="e194b-129">En la ilustración siguiente se muestra el origen de medios creado en el proceso de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="e194b-129">The following illustration shows the media source created in the application process.</span></span>

![Ilustración de un origen multimedia en el proceso de la aplicación.](images/pmp02.png)

<span data-ttu-id="e194b-131">Otra alternativa es crear el origen de medios dentro de la sesión de PMP.</span><span class="sxs-lookup"><span data-stu-id="e194b-131">Another alternative is to create the media source inside the PMP session.</span></span>

1.  <span data-ttu-id="e194b-132">Establezca el atributo de [**\_ \_ \_ \_ modo de origen remoto de la sesión MF**](mf-session-remote-source-mode-attribute.md) cuando cree la sesión multimedia.</span><span class="sxs-lookup"><span data-stu-id="e194b-132">Set the [**MF\_SESSION\_REMOTE\_SOURCE\_MODE**](mf-session-remote-source-mode-attribute.md) attribute when you create the Media Session.</span></span> <span data-ttu-id="e194b-133">Los atributos de configuración se especifican en el parámetro *pConfiguration* de la función [**MFCreatePMPMediaSession**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession) .</span><span class="sxs-lookup"><span data-stu-id="e194b-133">Configuration attributes are specified in the *pConfiguration* parameter of the [**MFCreatePMPMediaSession**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession) function.</span></span>
2.  <span data-ttu-id="e194b-134">Llame a [**MFGetService**](/windows/desktop/api/mfidl/nf-mfidl-mfgetservice) en la sesión de medios para obtener un puntero a la interfaz [**IMFPMPHost**](/windows/desktop/api/mfidl/nn-mfidl-imfpmphost) .</span><span class="sxs-lookup"><span data-stu-id="e194b-134">Call [**MFGetService**](/windows/desktop/api/mfidl/nf-mfidl-mfgetservice) on the Media Session to get a pointer to the [**IMFPMPHost**](/windows/desktop/api/mfidl/nn-mfidl-imfpmphost) interface.</span></span> <span data-ttu-id="e194b-135">El identificador del servicio es **MF \_ PMP \_ Service**.</span><span class="sxs-lookup"><span data-stu-id="e194b-135">The service identifier is **MF\_PMP\_SERVICE**.</span></span>
3.  <span data-ttu-id="e194b-136">Llame a [**IMFPMPHost:: CreateObjectByCLSID**](/windows/desktop/api/mfidl/nf-mfidl-imfpmphost-createobjectbyclsid) con el identificador de clase **CLSID \_ MFSourceResolver** para crear la resolución de origen dentro del proceso de PMP.</span><span class="sxs-lookup"><span data-stu-id="e194b-136">Call [**IMFPMPHost::CreateObjectByCLSID**](/windows/desktop/api/mfidl/nf-mfidl-imfpmphost-createobjectbyclsid) with the class identifier **CLSID\_MFSourceResolver** to create the source resolver inside the PMP process.</span></span> <span data-ttu-id="e194b-137">El método devuelve un puntero a un proxy para la resolución de origen.</span><span class="sxs-lookup"><span data-stu-id="e194b-137">The method returns a pointer to a proxy for the source resolver.</span></span>
4.  <span data-ttu-id="e194b-138">Llame a [**IMFSourceResolver:: BeginCreateObjectFromURL**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-begincreateobjectfromurl) o [**IMFSourceResolver:: BeginCreateObjectFromByteStream**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-begincreateobjectfrombytestream) para crear el origen de medios.</span><span class="sxs-lookup"><span data-stu-id="e194b-138">Call [**IMFSourceResolver::BeginCreateObjectFromURL**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-begincreateobjectfromurl) or [**IMFSourceResolver::BeginCreateObjectFromByteStream**](/windows/desktop/api/mfidl/nf-mfidl-imfsourceresolver-begincreateobjectfrombytestream) to create the media source.</span></span>
    > [!Note]  
    > <span data-ttu-id="e194b-139">En este caso, debe utilizar las versiones asincrónicas de estos métodos, ya que las versiones sincrónicas no son remotas.</span><span class="sxs-lookup"><span data-stu-id="e194b-139">In this case, you must use the asynchronous versions of these methods, because the synchronous versions are not remotable.</span></span>

     

<span data-ttu-id="e194b-140">En la ilustración siguiente se muestra el origen de medios creado en el proceso de PMP.</span><span class="sxs-lookup"><span data-stu-id="e194b-140">The following illustration shows the media source created in the PMP process.</span></span>

![Ilustración de un origen multimedia en el proceso de PMP.](images/pmp03.png)

## <a name="related-topics"></a><span data-ttu-id="e194b-142">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="e194b-142">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e194b-143">Cómo reproducir archivos multimedia protegidos</span><span class="sxs-lookup"><span data-stu-id="e194b-143">How to Play Protected Media Files</span></span>](how-to-play-protected-media-files.md)
</dt> <dt>

[<span data-ttu-id="e194b-144">Sesión de medios</span><span class="sxs-lookup"><span data-stu-id="e194b-144">Media Session</span></span>](media-session.md)
</dt> <dt>

[<span data-ttu-id="e194b-145">Ruta de acceso a medios protegidos</span><span class="sxs-lookup"><span data-stu-id="e194b-145">Protected Media Path</span></span>](protected-media-path.md)
</dt> </dl>

 

 
