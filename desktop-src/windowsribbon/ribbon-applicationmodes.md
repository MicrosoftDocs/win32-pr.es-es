---
title: Volver a configurar la cinta de opciones con modos de aplicación
description: El marco de la cinta de opciones de Windows admite la reconfiguración dinámica y la exposición de elementos básicos de la interfaz de usuario de la cinta de opciones en tiempo de ejecución, en función del estado de la aplicación (también conocido como contexto).
ms.assetid: 8e9d85c5-33e4-4212-b9e4-2fc3b492c273
keywords:
- Cinta de Windows, volver a configurar con modos de aplicación
- Cinta de opciones, reconfigurar con modos de aplicación
- volver a configurar la cinta de opciones de Windows con modos de aplicación
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 83d206c238e6fe7463562077daaa52a5522a79d9
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104420731"
---
# <a name="reconfiguring-the-ribbon-with-application-modes"></a><span data-ttu-id="27dd9-106">Volver a configurar la cinta de opciones con modos de aplicación</span><span class="sxs-lookup"><span data-stu-id="27dd9-106">Reconfiguring the Ribbon with Application Modes</span></span>

<span data-ttu-id="27dd9-107">El marco de la cinta de opciones de Windows admite la reconfiguración dinámica y la exposición de elementos básicos de la interfaz de usuario de la cinta de opciones en tiempo de ejecución, en función del estado de la aplicación (también conocido como contexto).</span><span class="sxs-lookup"><span data-stu-id="27dd9-107">The Windows Ribbon framework supports the dynamic reconfiguring and exposing of core elements of the Ribbon UI at run time, based on the application's state (also referred to as context).</span></span> <span data-ttu-id="27dd9-108">Declarado y asociado con elementos específicos en el marcado, los distintos Estados admitidos por una aplicación se conocen como modos de aplicación.</span><span class="sxs-lookup"><span data-stu-id="27dd9-108">Declared and associated with specific elements in markup, the various states supported by an application are referred to as application modes.</span></span>

-   [<span data-ttu-id="27dd9-109">Introducción</span><span class="sxs-lookup"><span data-stu-id="27dd9-109">Introduction</span></span>](#introduction)
-   [<span data-ttu-id="27dd9-110">Interfaz de usuario contextual</span><span class="sxs-lookup"><span data-stu-id="27dd9-110">Contextual User Interface</span></span>](#contextual-user-interface)
    -   [<span data-ttu-id="27dd9-111">Un escenario de modo de aplicación simple</span><span class="sxs-lookup"><span data-stu-id="27dd9-111">A Simple Application Mode Scenario</span></span>](#a-simple-application-mode-scenario)
-   [<span data-ttu-id="27dd9-112">Implementar modos de aplicación</span><span class="sxs-lookup"><span data-stu-id="27dd9-112">Implementing Application Modes</span></span>](#implementing-application-modes)
    -   [<span data-ttu-id="27dd9-113">Identificar los modos</span><span class="sxs-lookup"><span data-stu-id="27dd9-113">Identify the Modes</span></span>](#identify-the-modes)
    -   [<span data-ttu-id="27dd9-114">Asignación de controles a los modos de aplicación</span><span class="sxs-lookup"><span data-stu-id="27dd9-114">Assign Controls to Application Modes</span></span>](#assign-controls-to-application-modes)
    -   [<span data-ttu-id="27dd9-115">Cambiar los modos en tiempo de ejecución</span><span class="sxs-lookup"><span data-stu-id="27dd9-115">Switch Modes at Runtime</span></span>](#switch-modes-at-runtime)
-   [<span data-ttu-id="27dd9-116">Comentarios:</span><span class="sxs-lookup"><span data-stu-id="27dd9-116">Remarks</span></span>](#remarks)
-   [<span data-ttu-id="27dd9-117">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="27dd9-117">Related topics</span></span>](#related-topics)

## <a name="introduction"></a><span data-ttu-id="27dd9-118">Introducción</span><span class="sxs-lookup"><span data-stu-id="27dd9-118">Introduction</span></span>

<span data-ttu-id="27dd9-119">Los modos de aplicación constan de grupos lógicos de controles que exponen alguna funcionalidad básica de la aplicación en la interfaz de usuario de la cinta.</span><span class="sxs-lookup"><span data-stu-id="27dd9-119">Application modes consist of logical groups of controls that expose some core application functionality in the Ribbon UI.</span></span> <span data-ttu-id="27dd9-120">La aplicación habilita o deshabilita dinámicamente estos modos a través de una llamada al método de marco [**IUIFramework:: SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes), que activa o desactiva la visibilidad de uno o más modos de aplicación.</span><span class="sxs-lookup"><span data-stu-id="27dd9-120">These modes are dynamically enabled or disabled by the application through a call to the framework method [**IUIFramework::SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes), which turns the visibility of one or more application modes on or off.</span></span>

## <a name="contextual-user-interface"></a><span data-ttu-id="27dd9-121">Interfaz de usuario contextual</span><span class="sxs-lookup"><span data-stu-id="27dd9-121">Contextual User Interface</span></span>

<span data-ttu-id="27dd9-122">El marco de la cinta de opciones proporciona una experiencia de usuario enriquecida al incorporar controles dinámicos que responden sin problemas a la interacción del usuario y al contexto de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="27dd9-122">The Ribbon framework provides rich user experience by incorporating dynamic controls that respond seamlessly to user interaction and application context.</span></span> <span data-ttu-id="27dd9-123">Esta interfaz de usuario contextual enriquecida se entrega a través de una combinación de los siguientes mecanismos:</span><span class="sxs-lookup"><span data-stu-id="27dd9-123">This rich contextual UI is delivered through a combination of the following mechanisms:</span></span>

-   <span data-ttu-id="27dd9-124">Galerías: controles basados en colección que admiten la manipulación dinámica de sus colecciones de elementos.</span><span class="sxs-lookup"><span data-stu-id="27dd9-124">Galleries - collection-based controls that support the dynamic manipulation of their item collections.</span></span>
-   <span data-ttu-id="27dd9-125">Pestañas contextuales: pestañas de la cinta de opciones que tienen su visibilidad determinada por un cambio en el contexto del área de trabajo, como la selección de una imagen de un documento.</span><span class="sxs-lookup"><span data-stu-id="27dd9-125">Contextual tabs - ribbon tabs that have their visibility determined by a change in workspace context, such as the selection of an image in a document.</span></span>
-   <span data-ttu-id="27dd9-126">Modos de aplicación: funcionalidad básica de la aplicación que depende del contexto de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="27dd9-126">Application modes - core application functionality that is dependent on application context.</span></span>

<span data-ttu-id="27dd9-127">En algunos aspectos, los modos de aplicación parecen funcionalmente similares a las pestañas contextuales.</span><span class="sxs-lookup"><span data-stu-id="27dd9-127">In some respects, application modes appear functionally similar to contextual tabs.</span></span> <span data-ttu-id="27dd9-128">Sin embargo, la distinción fundamental radica en la intención y el ámbito de cada uno.</span><span class="sxs-lookup"><span data-stu-id="27dd9-128">However, the fundamental distinction lies in the intent and scope of each.</span></span>

<span data-ttu-id="27dd9-129">Los controles contextuales se activan en respuesta a un cambio de contexto dentro de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="27dd9-129">Contextual controls are activated in response to a change of context within an application.</span></span> <span data-ttu-id="27dd9-130">Por ejemplo, en Microsoft Paint para Windows 7, se muestra una pestaña contextual que contiene grupos de comandos relacionados con el texto cuando un usuario inserta un área de texto en el área de trabajo.</span><span class="sxs-lookup"><span data-stu-id="27dd9-130">For example, in Microsoft Paint for Windows 7, a contextual tab that contains groups of text-related commands is displayed when a user inserts a text area into the workspace.</span></span> <span data-ttu-id="27dd9-131">Esta pestaña contextual no contiene comandos básicos para la aplicación y solo se expone en la interfaz de usuario porque el contexto *dentro* de la aplicación ha cambiado.</span><span class="sxs-lookup"><span data-stu-id="27dd9-131">This contextual tab does not contain core commands for the application and is only exposed in the UI because the context *within* the application has changed.</span></span> <span data-ttu-id="27dd9-132">La funcionalidad básica de la aplicación (los comandos de edición de imágenes) sigue siendo relevante y está disponible para el usuario, incluso con la pestaña contextual visible.</span><span class="sxs-lookup"><span data-stu-id="27dd9-132">The core functionality of the application (the image editing commands) is still relevant and available to the user, even with the contextual tab visible.</span></span>

<span data-ttu-id="27dd9-133">Los modos de aplicación se diferencian de los controles contextuales en que reconfiguran la funcionalidad en respuesta a los cambios en el contexto en el que funciona la aplicación.</span><span class="sxs-lookup"><span data-stu-id="27dd9-133">Application modes differ from contextual controls in that they reconfigure functionality in response to changes in the context that the application is operating in.</span></span> <span data-ttu-id="27dd9-134">Los modos de aplicación se encuentran en un nivel más alto de abstracción; proporcionan una manera de volver a configurar la funcionalidad básica de una aplicación en lugar de exponer temporalmente la funcionalidad que no es un componente básico de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="27dd9-134">Application modes sit at a higher level of abstraction; they provide a way to reconfigure the core functionality of an application instead of temporarily exposing functionality that is not a core component of the UI.</span></span> <span data-ttu-id="27dd9-135">Por ejemplo, en Microsoft Paint para Windows 7, se produce un cambio en el modo de aplicación cuando se invoca el comando de **vista previa de impresión** .</span><span class="sxs-lookup"><span data-stu-id="27dd9-135">For example, in Microsoft Paint for Windows 7, a switch in application mode occurs when the **Print preview** command is invoked.</span></span> <span data-ttu-id="27dd9-136">Cuando Microsoft Paint cambia a la **vista previa de impresión**, el contexto en el que funciona la aplicación cambia de edición a vista previa.</span><span class="sxs-lookup"><span data-stu-id="27dd9-136">When Microsoft Paint switches to **Print preview**, the context that the application is operating in changes from editing to previewing.</span></span> <span data-ttu-id="27dd9-137">Como resultado, la funcionalidad básica de la aplicación cambia hasta que se cancela la **vista previa de impresión** y la aplicación vuelve a entrar en el contexto de edición.</span><span class="sxs-lookup"><span data-stu-id="27dd9-137">As a result, the core functionality of the application changes until the **Print preview** is canceled and the application enters the editing context again.</span></span>

### <a name="a-simple-application-mode-scenario"></a><span data-ttu-id="27dd9-138">Un escenario de modo de aplicación simple</span><span class="sxs-lookup"><span data-stu-id="27dd9-138">A Simple Application Mode Scenario</span></span>

<span data-ttu-id="27dd9-139">En el escenario siguiente se muestra cómo se usan los modos de aplicación, en una aplicación denominada RibbonApp, para exponer aspectos discretos de la funcionalidad básica.</span><span class="sxs-lookup"><span data-stu-id="27dd9-139">The following scenario demonstrates how application modes are used, in an application called RibbonApp, to expose discrete aspects of core functionality.</span></span>

<span data-ttu-id="27dd9-140">Dos modos de aplicación se definen en RibbonApp:</span><span class="sxs-lookup"><span data-stu-id="27dd9-140">Two application modes are defined in RibbonApp:</span></span>

-   <span data-ttu-id="27dd9-141">El modo **simple** expone comandos básicos a través de la interfaz de usuario de la cinta de opciones.</span><span class="sxs-lookup"><span data-stu-id="27dd9-141">**Simple** mode exposes basic commands throughout the Ribbon UI.</span></span> <span data-ttu-id="27dd9-142">Estos comandos aparecen en todo momento, independientemente del modo de aplicación que esté activo.</span><span class="sxs-lookup"><span data-stu-id="27dd9-142">These commands appear at all times, no matter which application mode is active.</span></span>
-   <span data-ttu-id="27dd9-143">El modo **avanzado** expone comandos complejos destinados a usuarios expertos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="27dd9-143">**Advanced** mode exposes complex commands intended for expert users of the application.</span></span> <span data-ttu-id="27dd9-144">Estos comandos avanzados aparecen en la interfaz de usuario de la cinta de opciones, además de los comandos sencillos.</span><span class="sxs-lookup"><span data-stu-id="27dd9-144">These advanced commands appear throughout the Ribbon UI, in addition to the simple commands.</span></span>

<span data-ttu-id="27dd9-145">De forma predeterminada, RibbonApp se establece en abierto en modo **simple** y los comandos que requieren los usuarios inexpertos se muestran en el **menú aplicación** y en la pestaña **Inicio** . Las capturas de pantalla siguientes muestran el menú de la **aplicación** RibbonApp y la pestaña **Inicio** en el modo **simple** , resaltando los controles modales.</span><span class="sxs-lookup"><span data-stu-id="27dd9-145">By default, RibbonApp is set to open in **Simple** mode, and the commands required by novice users are displayed in the **Application Menu** and the **Home** tab. The following screen shots show the RibbonApp **Application Menu** and **Home** tab in **Simple** mode, highlighting the modal controls.</span></span>

![captura de pantalla que muestra una pestaña para el modo de aplicación simple.](images/overviews/appmode-hometab.png)![captura de pantalla que muestra el menú de la aplicación para el modo de aplicación simple.](images/overviews/appmode-simpleappmenu.png)

<span data-ttu-id="27dd9-148">Aunque estos comandos pueden ser suficientes para usuarios inexpertos, el RibbonApp también admite usuarios expertos a través de un modo **avanzado** que, cuando se activa haciendo clic en el botón **cambiar a modo avanzado** en el **menú aplicación**, muestra la funcionalidad básica adicional.</span><span class="sxs-lookup"><span data-stu-id="27dd9-148">While these commands may be sufficient for novice users, the RibbonApp also supports expert users through an **Advanced** mode that, when activated by clicking the **Switch to Advanced Mode** button in the **Application Menu**, displays additional core functionality.</span></span>

<span data-ttu-id="27dd9-149">Este escenario se implementa fácilmente mediante el enlace de varios elementos en el marcado a modos de aplicación discretos que se pueden activar y desactivar según sea necesario.</span><span class="sxs-lookup"><span data-stu-id="27dd9-149">This scenario is easily implemented by binding various elements in markup to discrete application modes that can be turned on and off as required.</span></span> <span data-ttu-id="27dd9-150">Las capturas de pantalla siguientes muestran el menú de la **aplicación** RibbonApp y la pestaña **Inicio** en modo **avanzado** , resaltando los controles modales.</span><span class="sxs-lookup"><span data-stu-id="27dd9-150">The following screen shots show the RibbonApp **Application Menu** and **Home** tab in **Advanced** mode, highlighting the modal controls.</span></span>

![captura de pantalla que muestra una pestaña para el modo de aplicación avanzada.](images/overviews/appmode-advancedtab.png)![captura de pantalla que muestra el menú de la aplicación para el modo de aplicación avanzada.](images/overviews/appmode-advancedappmenu.png)

## <a name="implementing-application-modes"></a><span data-ttu-id="27dd9-153">Implementar modos de aplicación</span><span class="sxs-lookup"><span data-stu-id="27dd9-153">Implementing Application Modes</span></span>

<span data-ttu-id="27dd9-154">En esta sección se describen los tres pasos que suelen ser necesarios para la implementación de los modos de aplicación del marco de cinta.</span><span class="sxs-lookup"><span data-stu-id="27dd9-154">This section outlines the three steps typically required for the implementation of Ribbon framework application modes.</span></span> <span data-ttu-id="27dd9-155">RibbonApp se utiliza para proporcionar un ejemplo de cada paso.</span><span class="sxs-lookup"><span data-stu-id="27dd9-155">RibbonApp is used to provide an example for each step.</span></span>

### <a name="identify-the-modes"></a><span data-ttu-id="27dd9-156">Identificar los modos</span><span class="sxs-lookup"><span data-stu-id="27dd9-156">Identify the Modes</span></span>

<span data-ttu-id="27dd9-157">Cada modo de una aplicación debe representar un conjunto lógico de funcionalidad que depende del contexto en el que una aplicación puede operar.</span><span class="sxs-lookup"><span data-stu-id="27dd9-157">Each mode in an application should represent a logical set of functionality that depends on the context an application is able to operate in.</span></span> <span data-ttu-id="27dd9-158">Por ejemplo, si una aplicación muestra controles que solo son relevantes cuando se detecta una conexión de red, esos controles funcionan en un contexto de red que podría justificar la creación de un modo de **red** .</span><span class="sxs-lookup"><span data-stu-id="27dd9-158">For example, if an application displays controls that are only relevant when a network connection is detected, those controls operate within a networking context that might justify the creation of a **Network** mode.</span></span>

<span data-ttu-id="27dd9-159">RibbonApp tiene dos contextos que pueden estar activos en un momento dado: **simples** y **avanzados**.</span><span class="sxs-lookup"><span data-stu-id="27dd9-159">RibbonApp has two contexts that can be active at any given time: **Simple** and **Advanced**.</span></span> <span data-ttu-id="27dd9-160">Por lo tanto, RibbonApp requiere dos modos: **simple** y **avanzado**.</span><span class="sxs-lookup"><span data-stu-id="27dd9-160">Therefore, RibbonApp requires two modes: **Simple** and **Advanced**.</span></span>

### <a name="assign-controls-to-application-modes"></a><span data-ttu-id="27dd9-161">Asignación de controles a los modos de aplicación</span><span class="sxs-lookup"><span data-stu-id="27dd9-161">Assign Controls to Application Modes</span></span>

<span data-ttu-id="27dd9-162">Una vez identificados los modos de aplicación, asigne cada control de la cinta de opciones a un modo declarando un atributo *ApplicationModes* en el marcado para los elementos de control que admiten los modos de aplicación.</span><span class="sxs-lookup"><span data-stu-id="27dd9-162">Once the application modes have been identified, assign each Ribbon control to a mode by declaring an *ApplicationModes* attribute in markup for those control elements that support application modes.</span></span>

<span data-ttu-id="27dd9-163">La vista de cinta permite especificar los modos en los siguientes elementos de control:</span><span class="sxs-lookup"><span data-stu-id="27dd9-163">The Ribbon View allows modes to be specified on the following control elements:</span></span>

-   <span data-ttu-id="27dd9-164">Elementos de [**ficha**](windowsribbon-element-tab.md) principales.</span><span class="sxs-lookup"><span data-stu-id="27dd9-164">Core [**Tab**](windowsribbon-element-tab.md) elements.</span></span>
-   <span data-ttu-id="27dd9-165">Elementos de [**Grupo**](windowsribbon-element-group.md) que son elementos secundarios de un elemento de [**ficha**](windowsribbon-element-tab.md) principal.</span><span class="sxs-lookup"><span data-stu-id="27dd9-165">[**Group**](windowsribbon-element-group.md) elements that are child elements of a core [**Tab**](windowsribbon-element-tab.md) element.</span></span>
-   <span data-ttu-id="27dd9-166">Elementos [**Button**](windowsribbon-element-button.md), [**splitButton**](windowsribbon-element-splitbutton.md)y [**DropDownButton**](windowsribbon-element-dropdownbutton.md) asignados a un [**MenuGroup**](windowsribbon-element-menugroup.md) en el [menú](windowsribbon-controls-applicationmenu.md)de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="27dd9-166">[**Button**](windowsribbon-element-button.md), [**SplitButton**](windowsribbon-element-splitbutton.md), and [**DropDownButton**](windowsribbon-element-dropdownbutton.md) elements assigned to a [**MenuGroup**](windowsribbon-element-menugroup.md) within the [Application Menu](windowsribbon-controls-applicationmenu.md).</span></span>
    > [!Note]  
    > <span data-ttu-id="27dd9-167">Los elementos [**Button**](windowsribbon-element-button.md), [**splitButton**](windowsribbon-element-splitbutton.md)y [**DropDownButton**](windowsribbon-element-dropdownbutton.md) no se pueden asignar a un modo a menos que se hospeden en el menú de la [aplicación](windowsribbon-controls-applicationmenu.md).</span><span class="sxs-lookup"><span data-stu-id="27dd9-167">[**Button**](windowsribbon-element-button.md), [**SplitButton**](windowsribbon-element-splitbutton.md), and [**DropDownButton**](windowsribbon-element-dropdownbutton.md) elements cannot be assigned to a mode unless hosted in the [Application Menu](windowsribbon-controls-applicationmenu.md).</span></span>

     

<span data-ttu-id="27dd9-168">En el marco de la cinta de opciones, estos elementos de control se conocen como controles modales.</span><span class="sxs-lookup"><span data-stu-id="27dd9-168">In the Ribbon framework, these control elements are referred to as modal controls.</span></span> <span data-ttu-id="27dd9-169">Solo aparecen si un modo al que están enlazados está activo en la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="27dd9-169">They appear only if a mode to which they are bound is active in the UI.</span></span>

<span data-ttu-id="27dd9-170">Los elementos de control contenidos dentro de un control modal heredan el comportamiento del modo de aplicación.</span><span class="sxs-lookup"><span data-stu-id="27dd9-170">Control elements that are contained within a modal control inherit the application mode behavior.</span></span> <span data-ttu-id="27dd9-171">Por ejemplo, si un control modal de [**Grupo**](windowsribbon-element-group.md) se asigna a un modo **avanzado** y el modo **Avanzado** no está activo, el **Grupo** y los controles que contenga, modal o de otro tipo, no estarán visibles en la interfaz de usuario de la cinta de opciones.</span><span class="sxs-lookup"><span data-stu-id="27dd9-171">For example, if a [**Group**](windowsribbon-element-group.md) modal control is assigned to an **Advanced** mode and the **Advanced** mode is not active, then that **Group** and any controls in it, modal or otherwise, will not be visible in the Ribbon UI.</span></span>

<span data-ttu-id="27dd9-172">Con el uso del atributo *ApplicationModes* , los modos se asignan a los controles modales en una relación 1: N (uno a varios), donde un solo control modal puede asociarse a varios modos.</span><span class="sxs-lookup"><span data-stu-id="27dd9-172">With the use of the *ApplicationModes* attribute, modes are assigned to modal controls in a 1:N (one-to-many) relationship, where a single modal control can be associated with several modes.</span></span>

<span data-ttu-id="27dd9-173">El marco de la cinta de opciones hace referencia a los modos numéricamente, de 0 a 31, con el modo 0 considerado el modo predeterminado que se activa automáticamente cuando se inicia una aplicación de la cinta de opciones.</span><span class="sxs-lookup"><span data-stu-id="27dd9-173">The Ribbon framework refers to modes numerically, from 0 to 31, with mode 0 considered the default mode that is automatically activated when a Ribbon application starts.</span></span> <span data-ttu-id="27dd9-174">Cualquier control modal que no especifique un atributo *ApplicationModes* se considera un miembro del modo predeterminado.</span><span class="sxs-lookup"><span data-stu-id="27dd9-174">Any modal control that does not specify an *ApplicationModes* attribute is considered to be a member of the default mode.</span></span>

<span data-ttu-id="27dd9-175">En RibbonApp, **simple** es el modo predeterminado, con la funcionalidad de modo **avanzado** que solo se muestra cuando lo inicia el usuario.</span><span class="sxs-lookup"><span data-stu-id="27dd9-175">In RibbonApp, **Simple** is the default mode, with **Advanced** mode functionality displayed only when it is initiated by the user.</span></span>

<span data-ttu-id="27dd9-176">En el ejemplo siguiente se muestra el marcado necesario para RibbonApp.</span><span class="sxs-lookup"><span data-stu-id="27dd9-176">The following example demonstrates the markup required for RibbonApp.</span></span>


```C++
<Application.Views>
  <Ribbon>

    <!--Application Menu-->
    <Ribbon.ApplicationMenu>
      <ApplicationMenu CommandName='cmdAppMenu'>                    
        <MenuGroup>
          <Button CommandName='cmdSave'/>                        
          <Button CommandName='cmdExportMetadata' ApplicationModes='1'/>                   
        </MenuGroup>              
        <MenuGroup>
          <Button CommandName='cmdSwitchModes' ApplicationModes ='0,1'/>
          <Button CommandName='cmdExit'/>
        </MenuGroup>
      </ApplicationMenu>
    </Ribbon.ApplicationMenu>
            
    <!--Tabs-->
    <Ribbon.Tabs>
      <!--Home Tab-->
      <Tab CommandName='cmdHomeTab'>
                    
        <!--Scaling Policy for Home tab-->
        <Tab.ScalingPolicy>
          <ScalingPolicy>
            <ScalingPolicy.IdealSizes>
              <Scale Group='cmdSimpleControlsGroup' Size='Medium'/>                                
            </ScalingPolicy.IdealSizes>                     
          </ScalingPolicy>
        </Tab.ScalingPolicy>     
                    
        <!--Simple Controls Group-->
        <Group CommandName='cmdSimpleControlsGroup' SizeDefinition='ThreeButtons-OneBigAndTwoSmall'>                        
          <Button CommandName="cmdPaste" />
          <Button CommandName='cmdCut'/>                        
          <Button CommandName='cmdCopy'/>                        
        </Group>
      </Tab>
                
      <!--Advanced Tab-->
      <Tab CommandName='cmdAdvancedTab' ApplicationModes='1'>
        <!--Advanced Controls Group-->
        <Group CommandName='cmdMetadataGroup' ApplicationModes='1' SizeDefinition='TwoButtons'>
          <Button CommandName='cmdEditMetadata' />
          <Button CommandName='cmdCheckErrors' />
        </Group>
      </Tab>
    </Ribbon.Tabs>                   
                             
  </Ribbon>         
</Application.Views>
```



<span data-ttu-id="27dd9-177">En este ejemplo se muestra lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="27dd9-177">This example demonstrates the following:</span></span>

-   <span data-ttu-id="27dd9-178">No es necesario declarar explícitamente el modo predeterminado 0.</span><span class="sxs-lookup"><span data-stu-id="27dd9-178">Default mode 0 does not need to be explicitly declared.</span></span> <span data-ttu-id="27dd9-179">Dado que los controles modales que no especifican el atributo *ApplicationModes* se enlazan automáticamente al modo 0 (modo **simple** en el ejemplo RibbonApp), no es necesario declarar explícitamente el atributo para los controles modales predeterminados.</span><span class="sxs-lookup"><span data-stu-id="27dd9-179">Because modal controls that do not specify the *ApplicationModes* attribute are automatically bound to mode 0 (**Simple** mode in the RibbonApp example), there is no need to explicitly declare the attribute for default modal controls.</span></span>
-   <span data-ttu-id="27dd9-180">Los controles se pueden enlazar a varios modos.</span><span class="sxs-lookup"><span data-stu-id="27dd9-180">Controls can be bound to multiple modes.</span></span> <span data-ttu-id="27dd9-181">En el caso de RibbonApp, la única necesidad del atributo *ApplicationModes* en un control de modo **simple** es el `cmdSwitchModes` botón, ya que forma parte de los modos **simple** y **avanzado** .</span><span class="sxs-lookup"><span data-stu-id="27dd9-181">For RibbonApp, the only need for the *ApplicationModes* attribute in a **Simple** mode control is the `cmdSwitchModes` button , since it is a part of both **Simple** and **Advanced** modes.</span></span> <span data-ttu-id="27dd9-182">Si alguno de los modos está activo, este control aparecerá en el menú de la [aplicación](windowsribbon-controls-applicationmenu.md).</span><span class="sxs-lookup"><span data-stu-id="27dd9-182">If either mode is active, this control will appear in the [Application Menu](windowsribbon-controls-applicationmenu.md).</span></span>
-   <span data-ttu-id="27dd9-183">Los controles modales no heredan de sus elementos primarios.</span><span class="sxs-lookup"><span data-stu-id="27dd9-183">Modal controls do not inherit from their parents.</span></span> <span data-ttu-id="27dd9-184">La pestaña **Opciones avanzadas** de RibbonApp contiene un grupo de **metadatos** . ambos controles modales se asignan al modo 1 (modo **avanzado** ).</span><span class="sxs-lookup"><span data-stu-id="27dd9-184">The **Advanced** tab of RibbonApp contains a **Metadata** group; both of these modal controls are assigned to mode 1 (**Advanced** mode).</span></span> <span data-ttu-id="27dd9-185">Al asignar la pestaña **Opciones avanzadas** al modo 1, no se asignan automáticamente los controles secundarios, como el grupo de **metadatos** , al modo 1.</span><span class="sxs-lookup"><span data-stu-id="27dd9-185">Assigning the **Advanced** tab to mode 1 does not automatically assign child controls, such as the **Metadata** group, to mode 1.</span></span> <span data-ttu-id="27dd9-186">Esto permite que todos los grupos de una pestaña estén habilitados o deshabilitados de forma independiente en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="27dd9-186">This allows any group within a tab to be independently enabled or disabled at runtime.</span></span>
-   <span data-ttu-id="27dd9-187">Los controles no modales todavía pueden confiar en los modificadores de modo.</span><span class="sxs-lookup"><span data-stu-id="27dd9-187">Non-modal controls can still rely on mode switches.</span></span> <span data-ttu-id="27dd9-188">Los botones **editar metadatos** y **comprobar errores** de RibbonApp son para usuarios avanzados y solo están disponibles cuando el usuario cambia al modo **avanzado** .</span><span class="sxs-lookup"><span data-stu-id="27dd9-188">The **Edit Metadata** and **Check for Errors** buttons of RibbonApp are for advanced users and available only when the user switches to **Advanced** mode.</span></span> <span data-ttu-id="27dd9-189">Los controles de botón que no se hospedan dentro del menú de la [aplicación](windowsribbon-controls-applicationmenu.md) no son modales; sin embargo, dado que estos botones se hospedan en un control modal (el grupo de **metadatos** ), son visibles cuando el grupo está visible.</span><span class="sxs-lookup"><span data-stu-id="27dd9-189">Button controls that are not hosted inside the [Application Menu](windowsribbon-controls-applicationmenu.md) are non-modal; however, because these buttons are hosted inside a modal control (the **Metadata** group), they are visible when the group is visible.</span></span> <span data-ttu-id="27dd9-190">Por lo tanto, estos botones aparecen cuando se activa el modo avanzado y el grupo de **metadatos** se expone en la interfaz de usuario de la cinta.</span><span class="sxs-lookup"><span data-stu-id="27dd9-190">Therefore, these buttons appear when the advanced mode is activated and the **Metadata** group is exposed in the Ribbon UI.</span></span>

### <a name="switch-modes-at-runtime"></a><span data-ttu-id="27dd9-191">Cambiar los modos en tiempo de ejecución</span><span class="sxs-lookup"><span data-stu-id="27dd9-191">Switch Modes at Runtime</span></span>

<span data-ttu-id="27dd9-192">Después de definir los modos en el marcado, se pueden habilitar o deshabilitar con facilidad en respuesta a los eventos contextuales.</span><span class="sxs-lookup"><span data-stu-id="27dd9-192">After modes are defined in markup, they can be easily enabled or disabled in response to contextual events.</span></span> <span data-ttu-id="27dd9-193">Como se mencionó anteriormente, las aplicaciones de la cinta de opciones siempre se inician en el modo predeterminado 0.</span><span class="sxs-lookup"><span data-stu-id="27dd9-193">As mentioned previously, Ribbon applications always start in the default mode 0.</span></span> <span data-ttu-id="27dd9-194">Una vez que la aplicación se ha inicializado y el modo 0 está activo, se puede cambiar el conjunto de modos activos llamando a la función [**IUIFramework:: SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) .</span><span class="sxs-lookup"><span data-stu-id="27dd9-194">After the application has initialized and mode 0 is active, the set of active modes can be changed by calling the [**IUIFramework::SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) function.</span></span> <span data-ttu-id="27dd9-195">Esta función toma un entero de 32 bits como una representación bit a bit de los modos que deben estar activos; el bit menos significativo representa el modo 0 y el bit más significativo representa el modo 31.</span><span class="sxs-lookup"><span data-stu-id="27dd9-195">This function takes a 32-bit integer as a bitwise representation of the modes that should be active; the least significant bit represents mode 0 and the most significant bit represents mode 31.</span></span> <span data-ttu-id="27dd9-196">Si un bit se establece en cero, el modo no está activo en la interfaz de usuario de la cinta de opciones.</span><span class="sxs-lookup"><span data-stu-id="27dd9-196">If a bit is set to zero, the mode is not active in the Ribbon UI.</span></span>

<span data-ttu-id="27dd9-197">En RibbonApp, cuando un usuario habilita el modo **avanzado** , los comandos avanzados se muestran junto con los comandos sencillos.</span><span class="sxs-lookup"><span data-stu-id="27dd9-197">In RibbonApp, when a user enables **Advanced** mode, the advanced commands are displayed alongside the simple commands.</span></span> <span data-ttu-id="27dd9-198">El controlador de comandos del botón **cambiar a modo avanzado** llama a [**IUIFramework:: SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) para establecer los modos 0 (**simple**) y 1 (**avanzado**) como activo en la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="27dd9-198">The command handler for the **Switch to Advanced Mode** button calls [**IUIFramework::SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) in order to set modes 0 (**Simple**) and 1 (**Advanced**) as active in the UI.</span></span> <span data-ttu-id="27dd9-199">El ejemplo siguiente es el código de RibbonApp para esta llamada de función:</span><span class="sxs-lookup"><span data-stu-id="27dd9-199">The following example is the RibbonApp code for this function call :</span></span>


```C++
const int SIMPLE_MODE = 0;
const int ADVANCED_MODE = 1;
pFramework->SetModes( UI_MAKEAPPMODE(SIMPLE_MODE) | UI_MAKEAPPMODE(ADVANCED_MODE) );
```



> [!Note]  
> <span data-ttu-id="27dd9-200">La macro MAKEAPPMODE de la interfaz de usuario del marco de cinta \_ simplifica la tarea de establecer estos bits correctamente como preparación para la llamada a [**IUIFramework:: SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes).</span><span class="sxs-lookup"><span data-stu-id="27dd9-200">The Ribbon framework UI\_MAKEAPPMODE macro simplifies the task of setting these bits correctly in preparation for the call to [**IUIFramework::SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes).</span></span>

 

<span data-ttu-id="27dd9-201">En este ejemplo se muestra lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="27dd9-201">This example demonstrates the following:</span></span>

-   <span data-ttu-id="27dd9-202">Use la macro MAKEAPPMODE de la interfaz \_ de usuario para crear un conjunto de modos.</span><span class="sxs-lookup"><span data-stu-id="27dd9-202">Use the UI\_MAKEAPPMODE macro to build a mode set.</span></span>
-   <span data-ttu-id="27dd9-203">Los modos se establecen de forma explícita y atómica.</span><span class="sxs-lookup"><span data-stu-id="27dd9-203">Modes are set explicitly and atomically.</span></span> <span data-ttu-id="27dd9-204">El valor entero que se pasa a [**IUIFramework:: SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) representa los modos que estarán activos después de que se devuelva la función.</span><span class="sxs-lookup"><span data-stu-id="27dd9-204">The integer value that is passed to [**IUIFramework::SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) represents the modes that will be active after the function returns.</span></span> <span data-ttu-id="27dd9-205">Aunque el modo **simple** estaba activo anteriormente, **IUIFramework:: SetModes** debe indicar que el modo **simple** permanece activo cuando se activa el modo **avanzado** .</span><span class="sxs-lookup"><span data-stu-id="27dd9-205">Although the **Simple** mode was previously active, **IUIFramework::SetModes** must indicate that the **Simple** mode remain active when the **Advanced** mode is activated.</span></span>
-   <span data-ttu-id="27dd9-206">Se puede quitar el modo predeterminado.</span><span class="sxs-lookup"><span data-stu-id="27dd9-206">The default mode can be removed.</span></span> <span data-ttu-id="27dd9-207">Aunque en RibbonApp no se quita nunca el modo predeterminado (modo 0), se puede quitar con la siguiente llamada: `g_pFramework->SetModes(UI_MAKEAPPMODE(ADVANCED_MODE))` , exponiendo solo los comandos avanzados en la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="27dd9-207">Although in RibbonApp the default mode (mode 0) is never removed, it can be removed with the following call: `g_pFramework->SetModes(UI_MAKEAPPMODE(ADVANCED_MODE))`, exposing only the advanced commands in the UI.</span></span>

> [!Note]  
> <span data-ttu-id="27dd9-208">Cuando se reconfiguran los modos de una aplicación, la cinta de opciones intentará conservar la pestaña seleccionada anteriormente en la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="27dd9-208">When the modes of an application are reconfigured, the Ribbon will attempt to preserve the previously selected tab in the UI.</span></span> <span data-ttu-id="27dd9-209">Si el nuevo conjunto de modos ya no contiene la pestaña seleccionada antes de la llamada, la cinta de opciones seleccionará la pestaña en su diseño más cercano al menú de la [aplicación](windowsribbon-controls-applicationmenu.md).</span><span class="sxs-lookup"><span data-stu-id="27dd9-209">If the new set of modes no longer contains the tab that was selected before the call, the Ribbon will select the tab in its layout that is closest to the [Application Menu](windowsribbon-controls-applicationmenu.md).</span></span> <span data-ttu-id="27dd9-210">Esta pestaña está diseñada para contener los comandos que son más relevantes para el usuario.</span><span class="sxs-lookup"><span data-stu-id="27dd9-210">This tab is meant to contain the commands that are most relevant to the user.</span></span> <span data-ttu-id="27dd9-211">Para obtener más información, vea [directrices de la experiencia del usuario de la cinta](https://msdn.microsoft.com/library/cc872782.aspx).</span><span class="sxs-lookup"><span data-stu-id="27dd9-211">For more information, see [Ribbon User Experience Guidelines](https://msdn.microsoft.com/library/cc872782.aspx).</span></span>

 

## <a name="remarks"></a><span data-ttu-id="27dd9-212">Observaciones</span><span class="sxs-lookup"><span data-stu-id="27dd9-212">Remarks</span></span>

<span data-ttu-id="27dd9-213">La cinta de opciones debe tener al menos un modo activo en todo momento.</span><span class="sxs-lookup"><span data-stu-id="27dd9-213">The Ribbon must have at least one active mode at all times.</span></span> <span data-ttu-id="27dd9-214">Si una aplicación intenta desactivar todos los modos mediante una llamada a [**IUIFramework:: SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) con un valor de modo de 0, \_ se devuelve un error y el conjunto de modo activo permanece inalterado.</span><span class="sxs-lookup"><span data-stu-id="27dd9-214">If an application attempts to deactivate all modes by calling [**IUIFramework::SetModes**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes) with a mode value of 0, E\_FAIL is returned and the active mode set remains unchanged.</span></span>

<span data-ttu-id="27dd9-215">El marco de trabajo requiere que exista al menos una pestaña en la interfaz de usuario de la cinta de opciones en todo momento.</span><span class="sxs-lookup"><span data-stu-id="27dd9-215">The framework requires that at least one tab exist in the Ribbon UI at all times.</span></span> <span data-ttu-id="27dd9-216">Como resultado, debe haber al menos una pestaña expuesta por el modo predeterminado (modo 0) y después de cada cambio de modo.</span><span class="sxs-lookup"><span data-stu-id="27dd9-216">As a result, there must be at least one tab exposed by the default mode (mode 0) and after each mode switch.</span></span>

<span data-ttu-id="27dd9-217">No todas las áreas de la interfaz de usuario de la cinta de opciones se ven afectadas por los modos de aplicación.</span><span class="sxs-lookup"><span data-stu-id="27dd9-217">Not all areas of the Ribbon UI are affected by application modes.</span></span> <span data-ttu-id="27dd9-218">Por ejemplo, si al deshabilitar un modo se produce la desaparición de los botones de la cinta de opciones que se agregaron previamente a la [barra de herramientas de acceso rápido](windowsribbon-controls-quickaccesstoolbar.md), dichos botones permanecen en la barra de herramientas de acceso rápido, lo que permite a los usuarios ejecutar los comandos enlazados a los botones.</span><span class="sxs-lookup"><span data-stu-id="27dd9-218">For example, if disabling a mode causes the disappearance of buttons from the Ribbon that were previously added to the [Quick Access Toolbar](windowsribbon-controls-quickaccesstoolbar.md), those buttons remain in the Quick Access Toolbar, allowing users to execute the Commands bound to the buttons.</span></span> <span data-ttu-id="27dd9-219">Como norma general, si un comando pertenece a uno o varios modos inactivos, ese comando también debe deshabilitarse estableciendo la propiedad [ \_ PKEY \_ habilitada](windowsribbon-reference-properties-uipkey-enabled.md) de la interfaz de usuario en 0 (variante \_ false).</span><span class="sxs-lookup"><span data-stu-id="27dd9-219">As a general rule, if a Command belongs to one or more inactive modes, then that Command should also be disabled by setting the [UI\_PKEY\_Enabled](windowsribbon-reference-properties-uipkey-enabled.md) property to 0 (VARIANT\_FALSE) .</span></span>

## <a name="related-topics"></a><span data-ttu-id="27dd9-220">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="27dd9-220">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="27dd9-221">Instrucciones para la experiencia del usuario en cinta</span><span class="sxs-lookup"><span data-stu-id="27dd9-221">Ribbon User Experience Guidelines</span></span>](https://msdn.microsoft.com/library/cc872782.aspx)
</dt> <dt>

[<span data-ttu-id="27dd9-222">Mostrar pestañas contextuales</span><span class="sxs-lookup"><span data-stu-id="27dd9-222">Displaying Contextual Tabs</span></span>](ribbon-contextualtabs.md)
</dt> </dl>

 

 