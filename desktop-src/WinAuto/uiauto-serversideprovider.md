---
title: Implementar un proveedor de automatización de la interfaz de usuario de Server-Side
description: En este tema se describe cómo implementar un proveedor de automatización de la interfaz de usuario de Microsoft de servidor para un control personalizado escrito en C++.
ms.assetid: c3a919b2-8b8c-4dde-ad71-587f3845a9f5
keywords:
- Automatización de la interfaz de usuario, implementación del proveedor del lado servidor
- Automatización de la interfaz de usuario, implementación del proveedor
- Automatización de la interfaz de usuario, implementar proveedores del lado servidor
- Automatización de la interfaz de usuario, implementar proveedores
- proveedores del lado servidor, implementar
- proveedores del lado servidor, interfaces
- proveedores del lado servidor, valores de propiedad
- proveedores del lado servidor, eventos
- proveedores del lado servidor, asignar un nuevo elemento primario
- eventos, proveedores del lado servidor
- interfaces, proveedores del lado servidor
- proveedores, implementar
- implementación de proveedores del lado servidor
- implementar proveedores
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e7fafbb9d03a25eb2e4713330c0622c25d17f9ff
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "105676461"
---
# <a name="implement-a-server-side-ui-automation-provider"></a><span data-ttu-id="ffa69-117">Implementar un proveedor de automatización de la interfaz de usuario de Server-Side</span><span class="sxs-lookup"><span data-stu-id="ffa69-117">Implement a Server-Side UI Automation Provider</span></span>

<span data-ttu-id="ffa69-118">En este tema se describe cómo implementar un proveedor de automatización de la interfaz de usuario de Microsoft de servidor para un control personalizado escrito en C++.</span><span class="sxs-lookup"><span data-stu-id="ffa69-118">This topic describes how to implement a server-side Microsoft UI Automation provider for a custom control written in C++.</span></span> <span data-ttu-id="ffa69-119">Contiene las secciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="ffa69-119">It contains the following sections:</span></span>

-   [<span data-ttu-id="ffa69-120">Interfaces de proveedor</span><span class="sxs-lookup"><span data-stu-id="ffa69-120">Provider Interfaces</span></span>](#provider-interfaces)
-   [<span data-ttu-id="ffa69-121">Funcionalidad necesaria para los proveedores de automatización de la interfaz de usuario</span><span class="sxs-lookup"><span data-stu-id="ffa69-121">Required Functionality for UI Automation Providers</span></span>](#required-functionality-for-ui-automation-providers)
-   [<span data-ttu-id="ffa69-122">Valores de propiedad</span><span class="sxs-lookup"><span data-stu-id="ffa69-122">Property Values</span></span>](#property-values)
-   [<span data-ttu-id="ffa69-123">Eventos de proveedores</span><span class="sxs-lookup"><span data-stu-id="ffa69-123">Events from Providers</span></span>](#events-from-providers)
-   [<span data-ttu-id="ffa69-124">Navegación de proveedor</span><span class="sxs-lookup"><span data-stu-id="ffa69-124">Provider Navigation</span></span>](#provider-navigation)
-   [<span data-ttu-id="ffa69-125">Asignación de un nuevo elemento primario</span><span class="sxs-lookup"><span data-stu-id="ffa69-125">Assigning a New Parent</span></span>](#assigning-a-new-parent)
-   [<span data-ttu-id="ffa69-126">Reposición del proveedor</span><span class="sxs-lookup"><span data-stu-id="ffa69-126">Provider Repositioning</span></span>](#provider-repositioning)
-   [<span data-ttu-id="ffa69-127">Desconectar proveedores</span><span class="sxs-lookup"><span data-stu-id="ffa69-127">Disconnecting Providers</span></span>](#disconnecting-providers)
-   [<span data-ttu-id="ffa69-128">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="ffa69-128">Related topics</span></span>](#related-topics)

<span data-ttu-id="ffa69-129">Para ver ejemplos de código que muestran cómo implementar proveedores del lado servidor, consulte los [temas de procedimientos para los proveedores de automatización de la interfaz de usuario](uiauto-howto-topics-for-uiautomation-providers.md).</span><span class="sxs-lookup"><span data-stu-id="ffa69-129">For code examples that show how to implement server-side providers, see [How-To Topics for UI Automation Providers](uiauto-howto-topics-for-uiautomation-providers.md).</span></span>

## <a name="provider-interfaces"></a><span data-ttu-id="ffa69-130">Interfaces de proveedor</span><span class="sxs-lookup"><span data-stu-id="ffa69-130">Provider Interfaces</span></span>

<span data-ttu-id="ffa69-131">Las siguientes interfaces del modelo de objetos componentes (COM) proporcionan funcionalidad para los controles personalizados.</span><span class="sxs-lookup"><span data-stu-id="ffa69-131">The following Component Object Model (COM) interfaces provide functionality for custom controls.</span></span> <span data-ttu-id="ffa69-132">Para proporcionar la funcionalidad básica, cada proveedor de automatización de la interfaz de usuario debe implementar al menos la interfaz [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) .</span><span class="sxs-lookup"><span data-stu-id="ffa69-132">To provide basic functionality, every UI Automation provider must implement at least the [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interface.</span></span> <span data-ttu-id="ffa69-133">Las interfaces [**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) y [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot) son opcionales, pero se deben implementar para los elementos de un control complejo con el fin de proporcionar funcionalidad adicional.</span><span class="sxs-lookup"><span data-stu-id="ffa69-133">The [**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) and [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot) interfaces are optional, but should be implemented for elements in a complex control to provide additional functionality.</span></span>



| <span data-ttu-id="ffa69-134">Interfaz</span><span class="sxs-lookup"><span data-stu-id="ffa69-134">Interface</span></span>                                                                         | <span data-ttu-id="ffa69-135">Descripción</span><span class="sxs-lookup"><span data-stu-id="ffa69-135">Description</span></span>                                                                                                                                                                   |
|-----------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="ffa69-136">**IRawElementProviderSimple**</span><span class="sxs-lookup"><span data-stu-id="ffa69-136">**IRawElementProviderSimple**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple)             | <span data-ttu-id="ffa69-137">Proporciona la funcionalidad básica para un control hospedado en una ventana, incluida la compatibilidad con los patrones de control y las propiedades.</span><span class="sxs-lookup"><span data-stu-id="ffa69-137">Provides basic functionality for a control hosted in a window, including support for control patterns and properties.</span></span>                                                         |
| [<span data-ttu-id="ffa69-138">**IRawElementProviderFragment**</span><span class="sxs-lookup"><span data-stu-id="ffa69-138">**IRawElementProviderFragment**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment)         | <span data-ttu-id="ffa69-139">Agrega funcionalidad para un elemento de un control complejo, incluida la navegación en el fragmento, el establecimiento del foco y la devolución del rectángulo delimitador del elemento.</span><span class="sxs-lookup"><span data-stu-id="ffa69-139">Adds functionality for an element in a complex control, including navigating in the fragment, setting focus, and returning the bounding rectangle of the element.</span></span>             |
| [<span data-ttu-id="ffa69-140">**IRawElementProviderFragmentRoot**</span><span class="sxs-lookup"><span data-stu-id="ffa69-140">**IRawElementProviderFragmentRoot**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot) | <span data-ttu-id="ffa69-141">Agrega funcionalidad para el elemento raíz de un control complejo, incluida la ubicación de un elemento secundario en las coordenadas especificadas y el establecimiento del estado del foco global del control.</span><span class="sxs-lookup"><span data-stu-id="ffa69-141">Adds functionality for the root element in a complex control, including locating a child element at specified coordinates and setting the focus state for the entire control.</span></span> |



 

> [!Note]  
> <span data-ttu-id="ffa69-142">En la API de automatización de la interfaz de usuario para código administrado, estas interfaces forman una jerarquía de herencia.</span><span class="sxs-lookup"><span data-stu-id="ffa69-142">In the UI Automation API for managed code, these interfaces form an inheritance hierarchy.</span></span> <span data-ttu-id="ffa69-143">Este no es el caso en C++, donde las interfaces son completamente independientes.</span><span class="sxs-lookup"><span data-stu-id="ffa69-143">This is not the case in C++, where the interfaces are completely separate.</span></span>

 

<span data-ttu-id="ffa69-144">Las siguientes interfaces proporcionan funcionalidad agregada, pero la implementación es opcional.</span><span class="sxs-lookup"><span data-stu-id="ffa69-144">The following interfaces provide added functionality but implementation is optional.</span></span>



| <span data-ttu-id="ffa69-145">Interfaz</span><span class="sxs-lookup"><span data-stu-id="ffa69-145">Interface</span></span>                                                                         | <span data-ttu-id="ffa69-146">Descripción</span><span class="sxs-lookup"><span data-stu-id="ffa69-146">Description</span></span>                                                                             |
|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------|
| [<span data-ttu-id="ffa69-147">**IRawElementProviderAdviseEvents**</span><span class="sxs-lookup"><span data-stu-id="ffa69-147">**IRawElementProviderAdviseEvents**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovideradviseevents) | <span data-ttu-id="ffa69-148">Habilita al proveedor para realizar un seguimiento de las solicitudes de eventos.</span><span class="sxs-lookup"><span data-stu-id="ffa69-148">Enables the provider to track requests for events.</span></span>                                      |
| [<span data-ttu-id="ffa69-149">**IRawElementProviderHwndOverride**</span><span class="sxs-lookup"><span data-stu-id="ffa69-149">**IRawElementProviderHwndOverride**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderhwndoverride) | <span data-ttu-id="ffa69-150">Permite cambiar la posición de los elementos basados en ventanas en el árbol de automatización de la interfaz de usuario de un fragmento.</span><span class="sxs-lookup"><span data-stu-id="ffa69-150">Enables repositioning of window-based elements in the UI Automation tree of a fragment.</span></span> |



 

## <a name="required-functionality-for-ui-automation-providers"></a><span data-ttu-id="ffa69-151">Funcionalidad necesaria para los proveedores de automatización de la interfaz de usuario</span><span class="sxs-lookup"><span data-stu-id="ffa69-151">Required Functionality for UI Automation Providers</span></span>

<span data-ttu-id="ffa69-152">Para comunicarse con la automatización de la interfaz de usuario, el control debe implementar las áreas principales de funcionalidad descritas en la tabla siguiente.</span><span class="sxs-lookup"><span data-stu-id="ffa69-152">To communicate with UI Automation, your control must implement the main areas of functionality described in the following table.</span></span>



| <span data-ttu-id="ffa69-153">Funcionalidad</span><span class="sxs-lookup"><span data-stu-id="ffa69-153">Functionality</span></span>                                              | <span data-ttu-id="ffa69-154">Implementación</span><span class="sxs-lookup"><span data-stu-id="ffa69-154">Implementation</span></span>                                                                                                                                                                                                                                                                                                |
|------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="ffa69-155">Exponga el proveedor a la automatización de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="ffa69-155">Expose the provider to UI Automation.</span></span>                      | <span data-ttu-id="ffa69-156">En respuesta a un mensaje de [**WM \_ GETOBJECT**](wm-getobject.md) enviado a la ventana de control, devuelva el objeto que implementa [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple).</span><span class="sxs-lookup"><span data-stu-id="ffa69-156">In response to a [**WM\_GETOBJECT**](wm-getobject.md) message sent to the control window, return the object that implements [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple).</span></span> <span data-ttu-id="ffa69-157">En el caso de los fragmentos, debe ser el proveedor de las raíces correspondientes.</span><span class="sxs-lookup"><span data-stu-id="ffa69-157">For fragments, this must be the provider for the fragment root.</span></span>                                           |
| <span data-ttu-id="ffa69-158">Proporcione valores de propiedad.</span><span class="sxs-lookup"><span data-stu-id="ffa69-158">Provide property values.</span></span>                                   | <span data-ttu-id="ffa69-159">Implemente [**IRawElementProviderSimple:: GetPropertyValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpropertyvalue) para proporcionar o reemplazar valores.</span><span class="sxs-lookup"><span data-stu-id="ffa69-159">Implement [**IRawElementProviderSimple::GetPropertyValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpropertyvalue) to provide or override values.</span></span>                                                                                                                                                             |
| <span data-ttu-id="ffa69-160">Permite al cliente interactuar con el control.</span><span class="sxs-lookup"><span data-stu-id="ffa69-160">Enable the client to interact with the control.</span></span>            | <span data-ttu-id="ffa69-161">Implemente interfaces que admitan cada patrón de control adecuado, como [**IInvokeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iinvokeprovider).</span><span class="sxs-lookup"><span data-stu-id="ffa69-161">Implement interfaces that support each appropriate control pattern, such as [**IInvokeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iinvokeprovider).</span></span> <span data-ttu-id="ffa69-162">Devuelva estos proveedores de patrones de control en su implementación de [**IRawElementProviderSimple:: GetPatternProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpatternprovider).</span><span class="sxs-lookup"><span data-stu-id="ffa69-162">Return these control pattern providers in your implementation of [**IRawElementProviderSimple::GetPatternProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpatternprovider).</span></span> |
| <span data-ttu-id="ffa69-163">Generar eventos.</span><span class="sxs-lookup"><span data-stu-id="ffa69-163">Raise events.</span></span>                                              | <span data-ttu-id="ffa69-164">[**UiaRaiseAutomationEvent**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationevent), métodos de [**IProxyProviderWinEventSink**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iproxyproviderwineventsink).</span><span class="sxs-lookup"><span data-stu-id="ffa69-164">[**UiaRaiseAutomationEvent**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationevent), methods of [**IProxyProviderWinEventSink**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iproxyproviderwineventsink).</span></span>                                                                                                                                                |
| <span data-ttu-id="ffa69-165">Habilitar la navegación y el foco en un fragmento.</span><span class="sxs-lookup"><span data-stu-id="ffa69-165">Enable navigating and focusing in a fragment.</span></span>              | <span data-ttu-id="ffa69-166">Implemente [**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) para cada elemento del fragmento.</span><span class="sxs-lookup"><span data-stu-id="ffa69-166">Implement [**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) for each element within the fragment.</span></span> <span data-ttu-id="ffa69-167">No es necesario para los elementos que no forman parte de un fragmento.</span><span class="sxs-lookup"><span data-stu-id="ffa69-167">Not necessary for elements that are not part of a fragment.</span></span>                                                                                                                         |
| <span data-ttu-id="ffa69-168">Habilita el foco y la ubicación de los elementos secundarios en un fragmento.</span><span class="sxs-lookup"><span data-stu-id="ffa69-168">Enable focusing and locating child elements in a fragment.</span></span> | <span data-ttu-id="ffa69-169">Implemente [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot).</span><span class="sxs-lookup"><span data-stu-id="ffa69-169">Implement [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot).</span></span> <span data-ttu-id="ffa69-170">No es necesario para los elementos que no son raíces de fragmento.</span><span class="sxs-lookup"><span data-stu-id="ffa69-170">Not necessary for elements that are not fragment roots.</span></span>                                                                                                                                                          |



 

## <a name="property-values"></a><span data-ttu-id="ffa69-171">Valores de propiedad</span><span class="sxs-lookup"><span data-stu-id="ffa69-171">Property Values</span></span>

<span data-ttu-id="ffa69-172">Los proveedores de automatización de la interfaz de usuario para controles personalizados deben admitir ciertas propiedades que pueden usar la automatización de la interfaz de usuario y las aplicaciones cliente.</span><span class="sxs-lookup"><span data-stu-id="ffa69-172">UI Automation providers for custom controls must support certain properties that can be used by UI Automation and by client applications.</span></span> <span data-ttu-id="ffa69-173">En el caso de los elementos que se hospedan en Windows, la automatización de la interfaz de usuario puede recuperar algunas propiedades del proveedor de ventana predeterminado, pero debe obtener otras del proveedor personalizado.</span><span class="sxs-lookup"><span data-stu-id="ffa69-173">For elements that are hosted in windows, UI Automation can retrieve some properties from the default window provider, but must obtain others from the custom provider.</span></span>

<span data-ttu-id="ffa69-174">Normalmente, no es necesario que los proveedores de controles basados en ventanas proporcionen las siguientes propiedades que se identifican mediante **PROPERTYID**:</span><span class="sxs-lookup"><span data-stu-id="ffa69-174">Typically, providers for window-based controls do not need to provide the following properties that are identified by **PROPERTYID**:</span></span>

-   [<span data-ttu-id="ffa69-175">**UIA \_ BoundingRectanglePropertyId**</span><span class="sxs-lookup"><span data-stu-id="ffa69-175">**UIA\_BoundingRectanglePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="ffa69-176">**UIA \_ ClickablePointPropertyId**</span><span class="sxs-lookup"><span data-stu-id="ffa69-176">**UIA\_ClickablePointPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="ffa69-177">**UIA \_ ProcessIdPropertyId**</span><span class="sxs-lookup"><span data-stu-id="ffa69-177">**UIA\_ProcessIdPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="ffa69-178">**UIA \_ ClassNamePropertyId**</span><span class="sxs-lookup"><span data-stu-id="ffa69-178">**UIA\_ClassNamePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="ffa69-179">**UIA \_ HasKeyboardFocusPropertyId**</span><span class="sxs-lookup"><span data-stu-id="ffa69-179">**UIA\_HasKeyboardFocusPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="ffa69-180">**UIA \_ IsEnabledPropertyId**</span><span class="sxs-lookup"><span data-stu-id="ffa69-180">**UIA\_IsEnabledPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="ffa69-181">**UIA \_ IsKeyboardFocusablePropertyId**</span><span class="sxs-lookup"><span data-stu-id="ffa69-181">**UIA\_IsKeyboardFocusablePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="ffa69-182">**UIA \_ IsPasswordPropertyId**</span><span class="sxs-lookup"><span data-stu-id="ffa69-182">**UIA\_IsPasswordPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="ffa69-183">**UIA \_ NamePropertyId**</span><span class="sxs-lookup"><span data-stu-id="ffa69-183">**UIA\_NamePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="ffa69-184">**UIA \_ RuntimeIdPropertyId**</span><span class="sxs-lookup"><span data-stu-id="ffa69-184">**UIA\_RuntimeIdPropertyId**</span></span>](uiauto-automation-element-propids.md)

<span data-ttu-id="ffa69-185">La propiedad RuntimeId de un elemento simple o una raíz de fragmento hospedada en una ventana se obtiene de la ventana.</span><span class="sxs-lookup"><span data-stu-id="ffa69-185">The RuntimeId property of a simple element or fragment root hosted in a window is obtained from the window.</span></span> <span data-ttu-id="ffa69-186">Sin embargo, los elementos Fragment situados por debajo de la raíz, como los elementos de lista de un cuadro de lista, deben proporcionar sus propios identificadores.</span><span class="sxs-lookup"><span data-stu-id="ffa69-186">However, fragment elements below the root, such as list items in a list box, must provide their own identifiers.</span></span> <span data-ttu-id="ffa69-187">Para obtener más información, vea [**IRawElementProviderFragment:: GetRuntimeId**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-getruntimeid).</span><span class="sxs-lookup"><span data-stu-id="ffa69-187">For more information, see [**IRawElementProviderFragment::GetRuntimeId**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-getruntimeid).</span></span>

<span data-ttu-id="ffa69-188">La propiedad IsKeyboardFocusable debe devolverse para los proveedores hospedados en un control de Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="ffa69-188">The IsKeyboardFocusable property should be returned for providers hosted in a Windows Forms control.</span></span> <span data-ttu-id="ffa69-189">En este caso, es posible que el proveedor de ventana predeterminado no consiga recuperar el valor correcto.</span><span class="sxs-lookup"><span data-stu-id="ffa69-189">In this case, the default window provider may be unable to retrieve the correct value.</span></span>

<span data-ttu-id="ffa69-190">El proveedor de host suele proporcionar la propiedad Name.</span><span class="sxs-lookup"><span data-stu-id="ffa69-190">The Name property is usually supplied by the host provider.</span></span>

## <a name="events-from-providers"></a><span data-ttu-id="ffa69-191">Eventos de proveedores</span><span class="sxs-lookup"><span data-stu-id="ffa69-191">Events from Providers</span></span>

<span data-ttu-id="ffa69-192">Los proveedores de automatización de la interfaz de usuario deben generar eventos para notificar a las aplicaciones cliente los cambios en el estado de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="ffa69-192">UI Automation providers should raise events to notify client applications of changes in the state of the UI.</span></span> <span data-ttu-id="ffa69-193">Las siguientes funciones se usan para generar eventos.</span><span class="sxs-lookup"><span data-stu-id="ffa69-193">The following functions are used to raise events.</span></span>



| <span data-ttu-id="ffa69-194">Función</span><span class="sxs-lookup"><span data-stu-id="ffa69-194">Function</span></span>                                                                                   | <span data-ttu-id="ffa69-195">Descripción</span><span class="sxs-lookup"><span data-stu-id="ffa69-195">Description</span></span>                                                                                                              |
|--------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="ffa69-196">**UiaRaiseAutomationEvent**</span><span class="sxs-lookup"><span data-stu-id="ffa69-196">**UiaRaiseAutomationEvent**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationevent)                  | <span data-ttu-id="ffa69-197">Genera varios eventos, incluidos los que desencadenan los patrones de control.</span><span class="sxs-lookup"><span data-stu-id="ffa69-197">Raises various events, including events triggered by control patterns.</span></span>                                                   |
| [<span data-ttu-id="ffa69-198">**UiaRaiseAutomationPropertyChangedEvent**</span><span class="sxs-lookup"><span data-stu-id="ffa69-198">**UiaRaiseAutomationPropertyChangedEvent**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationpropertychangedevent) | <span data-ttu-id="ffa69-199">Genera un evento cuando una propiedad de automatización de la interfaz de usuario ha cambiado.</span><span class="sxs-lookup"><span data-stu-id="ffa69-199">Raises an event when a UI Automation property has changed.</span></span>                                                               |
| [<span data-ttu-id="ffa69-200">**UiaRaiseStructureChangedEvent**</span><span class="sxs-lookup"><span data-stu-id="ffa69-200">**UiaRaiseStructureChangedEvent**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraisestructurechangedevent)      | <span data-ttu-id="ffa69-201">Genera un evento cuando la estructura del árbol de automatización de la interfaz de usuario ha cambiado, por ejemplo, quitando o agregando un elemento.</span><span class="sxs-lookup"><span data-stu-id="ffa69-201">Raises an event when the structure of the UI Automation tree has changed, for example, by removing or adding an element.</span></span> |



 

<span data-ttu-id="ffa69-202">El propósito de un evento es notificar al cliente sobre algo que tiene lugar en la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="ffa69-202">The purpose of an event is to notify the client of something taking place in the UI.</span></span> <span data-ttu-id="ffa69-203">Los proveedores deben generar un evento independientemente de si el cambio se ha desencadenado por la entrada del usuario o por una aplicación cliente mediante la automatización de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="ffa69-203">Providers should raise an event regardless of whether the change was triggered by user input or by a client application using UI Automation.</span></span> <span data-ttu-id="ffa69-204">Por ejemplo, el evento que identifica [**UIA \_ Invoke \_ InvokedEventId**](uiauto-event-ids.md) debe generarse siempre que se invoca el control, ya sea a través de la entrada directa del usuario o de la aplicación cliente que llama a [**IUIAutomationInvokePattern:: Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke).</span><span class="sxs-lookup"><span data-stu-id="ffa69-204">For example, the event identified by [**UIA\_Invoke\_InvokedEventId**](uiauto-event-ids.md) should be raised whenever the control is invoked, either through direct user input or by the client application calling [**IUIAutomationInvokePattern::Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke).</span></span>

<span data-ttu-id="ffa69-205">Para optimizar el rendimiento, un proveedor puede generar eventos de forma selectiva o no generarlos en absoluto si no se registra ninguna aplicación cliente para recibirlos.</span><span class="sxs-lookup"><span data-stu-id="ffa69-205">To optimize performance, a provider can selectively raise events, or raise no events at all if no client application is registered to receive them.</span></span> <span data-ttu-id="ffa69-206">Los siguientes elementos de API se usan para la optimización.</span><span class="sxs-lookup"><span data-stu-id="ffa69-206">The following API elements are used for optimization.</span></span>



| <span data-ttu-id="ffa69-207">Elemento de API</span><span class="sxs-lookup"><span data-stu-id="ffa69-207">API Element</span></span>                                                                       | <span data-ttu-id="ffa69-208">Descripción</span><span class="sxs-lookup"><span data-stu-id="ffa69-208">Description</span></span>                                                                                                                                                       |
|-----------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="ffa69-209">**UiaClientsAreListening**</span><span class="sxs-lookup"><span data-stu-id="ffa69-209">**UiaClientsAreListening**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaclientsarelistening)           | <span data-ttu-id="ffa69-210">Esta función determina si las aplicaciones cliente se han suscrito a eventos de UI Automation.</span><span class="sxs-lookup"><span data-stu-id="ffa69-210">This function ascertains whether any client applications have subscribed to UI Automation events.</span></span>                                                                 |
| [<span data-ttu-id="ffa69-211">**IRawElementProviderAdviseEvents**</span><span class="sxs-lookup"><span data-stu-id="ffa69-211">**IRawElementProviderAdviseEvents**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovideradviseevents) | <span data-ttu-id="ffa69-212">La implementación de esta interfaz en una raíz de fragmento permite que se le advierta al proveedor cuando los clientes registran y anulan el registro de controladores de eventos para eventos del fragmento.</span><span class="sxs-lookup"><span data-stu-id="ffa69-212">Implementing this interface on a fragment root enables the provider to be advised when clients register and unregister event handlers for events on the fragment.</span></span> |



 

> [!Note]  
> <span data-ttu-id="ffa69-213">De forma similar a la implementación del recuento de referencias en la programación COM, es importante que los proveedores de automatización de la interfaz de usuario traten los métodos [**IRawElementProviderAdviseEvents:: AdviseEventAdded**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventadded) y [**AdviseEventRemoved**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventremoved) como los métodos [**IUnknown:: AddRef**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-addref) y [**Release**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) de la interfaz [**IUnknown**](/windows/desktop/api/unknwn/nn-unknwn-iunknown) .</span><span class="sxs-lookup"><span data-stu-id="ffa69-213">Similar to implementing reference counting in COM programming, it is important for UI Automation providers to treat the [**IRawElementProviderAdviseEvents::AdviseEventAdded**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventadded) and [**AdviseEventRemoved**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventremoved) methods like the [**IUnknown::AddRef**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-addref) and [**Release**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) methods of the [**IUnknown**](/windows/desktop/api/unknwn/nn-unknwn-iunknown) interface.</span></span> <span data-ttu-id="ffa69-214">Siempre y cuando se haya llamado a **AdviseEventAdded** más veces que **AdviseEventRemoved** para un evento o propiedad específicos, el proveedor debe continuar generando los eventos correspondientes, ya que algunos clientes todavía están escuchando.</span><span class="sxs-lookup"><span data-stu-id="ffa69-214">As long as **AdviseEventAdded** has been called more times than **AdviseEventRemoved** for a specific event or property, the provider should continue to raise corresponding events, because some clients are still listening.</span></span> <span data-ttu-id="ffa69-215">Como alternativa, los proveedores de automatización de la interfaz de usuario pueden usar la función [**UiaClientsAreListening**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaclientsarelistening) para determinar si al menos un cliente está escuchando y, si es así, generar todos los eventos adecuados.</span><span class="sxs-lookup"><span data-stu-id="ffa69-215">Alternatively, UI Automation providers can use the [**UiaClientsAreListening**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaclientsarelistening) function to determine whether at least one client is listening and, if so, raise all appropriate events.</span></span>

 

## <a name="provider-navigation"></a><span data-ttu-id="ffa69-216">Navegación de proveedor</span><span class="sxs-lookup"><span data-stu-id="ffa69-216">Provider Navigation</span></span>

<span data-ttu-id="ffa69-217">Los proveedores de controles simples, como los botones personalizados hospedados en una ventana, no necesitan admitir la navegación en el árbol de automatización de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="ffa69-217">Providers for simple controls, such as a custom button hosted in a window, do not need to support navigation in the UI Automation tree.</span></span> <span data-ttu-id="ffa69-218">La navegación hacia y desde el elemento se controla mediante el proveedor predeterminado de la ventana host, que se especifica en la implementación de [**IRawElementProviderSimple:: HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider).</span><span class="sxs-lookup"><span data-stu-id="ffa69-218">Navigation to and from the element is handled by the default provider for the host window, which is specified in the implementation of [**IRawElementProviderSimple::HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider).</span></span> <span data-ttu-id="ffa69-219">Sin embargo, cuando se implementa un proveedor para un control personalizado complejo, sí se debe admitir la navegación entre el nodo raíz del fragmento y sus descendientes, y entre los nodos del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="ffa69-219">When you implement a provider for a complex custom control, however, you must support navigation between the root node of the fragment and its descendants, and between sibling nodes.</span></span>

> [!Note]  
> <span data-ttu-id="ffa69-220">Los elementos de un fragmento que no sea la raíz deben devolver **null** de [**HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider), porque no se hospedan directamente en una ventana y ningún proveedor predeterminado admite la navegación hacia y desde ellos.</span><span class="sxs-lookup"><span data-stu-id="ffa69-220">Elements of a fragment other than the root must return **NULL** from [**HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider), because they are not directly hosted in a window, and no default provider can support navigation to and from them.</span></span>

 

<span data-ttu-id="ffa69-221">La estructura del fragmento viene determinada por la implementación de [**IRawElementProviderFragment:: Navigate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate).</span><span class="sxs-lookup"><span data-stu-id="ffa69-221">The structure of the fragment is determined by your implementation of [**IRawElementProviderFragment::Navigate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate).</span></span> <span data-ttu-id="ffa69-222">Este método devuelve el objeto de proveedor para el elemento en cada dirección posible, desde cada fragmento.</span><span class="sxs-lookup"><span data-stu-id="ffa69-222">For each possible direction from each fragment, this method returns the provider object for the element in that direction.</span></span> <span data-ttu-id="ffa69-223">Si no hay ningún elemento en esa dirección, el método devuelve **null**.</span><span class="sxs-lookup"><span data-stu-id="ffa69-223">If there is no element in that direction, the method returns **NULL**.</span></span>

<span data-ttu-id="ffa69-224">La raíz de fragmento solo permite navegar hacia los elementos secundarios.</span><span class="sxs-lookup"><span data-stu-id="ffa69-224">The fragment root supports navigation only to child elements.</span></span> <span data-ttu-id="ffa69-225">Por ejemplo, un cuadro de lista devuelve el primer elemento de la lista cuando la dirección es **NavigateDirection \_ FirstChild** y devuelve el último elemento cuando la dirección es **NavigateDirection \_ LastChild**.</span><span class="sxs-lookup"><span data-stu-id="ffa69-225">For example, a list box returns the first item in the list when the direction is **NavigateDirection\_FirstChild**, and returns the last item when the direction is **NavigateDirection\_LastChild**.</span></span> <span data-ttu-id="ffa69-226">La raíz del fragmento no admite la navegación a un elemento primario o a los elementos del mismo nivel. lo controla el proveedor de ventana host.</span><span class="sxs-lookup"><span data-stu-id="ffa69-226">The fragment root does not support navigation to a parent or to siblings; this is handled by the host window provider.</span></span>

<span data-ttu-id="ffa69-227">Los elementos de un fragmento que no son la raíz deben admitir la navegación hacia el elemento primario, sus elementos secundarios y los elementos del mismo nivel que estos contengan.</span><span class="sxs-lookup"><span data-stu-id="ffa69-227">Elements of a fragment that are not the root must support navigation to the parent, and to any siblings and children they have.</span></span>

## <a name="assigning-a-new-parent"></a><span data-ttu-id="ffa69-228">Asignación de un nuevo elemento primario</span><span class="sxs-lookup"><span data-stu-id="ffa69-228">Assigning a New Parent</span></span>

<span data-ttu-id="ffa69-229">Las ventanas emergentes son en realidad ventanas de nivel superior y, de forma predeterminada, aparecen en el árbol de automatización de la interfaz de usuario como elementos secundarios del escritorio.</span><span class="sxs-lookup"><span data-stu-id="ffa69-229">Pop-up windows are actually top-level windows, and by default, appear in the UI Automation tree as children of the desktop.</span></span> <span data-ttu-id="ffa69-230">No obstante, en muchos casos, las ventanas emergentes son, lógicamente, elementos secundarios de otros controles.</span><span class="sxs-lookup"><span data-stu-id="ffa69-230">In many cases, however, pop-up windows are logically children of some other control.</span></span> <span data-ttu-id="ffa69-231">Por ejemplo, la lista desplegable de un cuadro combinado es, lógicamente, un elemento secundario de dicho cuadro.</span><span class="sxs-lookup"><span data-stu-id="ffa69-231">For example, the drop-down list of a combo box is logically a child of the combo box.</span></span> <span data-ttu-id="ffa69-232">De forma similar, una ventana emergente de menú es, lógicamente, un elemento secundario de un menú.</span><span class="sxs-lookup"><span data-stu-id="ffa69-232">Similarly, a menu pop-up window is logically a child of the menu.</span></span> <span data-ttu-id="ffa69-233">La automatización de la interfaz de usuario proporciona compatibilidad para asignar un nuevo elemento primario a una ventana emergente para que parezca ser un elemento secundario del control asociado.</span><span class="sxs-lookup"><span data-stu-id="ffa69-233">UI Automation provides support to assign a new parent to a pop-up window so that it appears to be a child of the associated control.</span></span>

<span data-ttu-id="ffa69-234">Para asignar un nuevo elemento primario a una ventana emergente:</span><span class="sxs-lookup"><span data-stu-id="ffa69-234">To assign a new parent to a pop-up window:</span></span>

1.  <span data-ttu-id="ffa69-235">Cree un proveedor para la ventana emergente.</span><span class="sxs-lookup"><span data-stu-id="ffa69-235">Create a provider for the pop-up window.</span></span> <span data-ttu-id="ffa69-236">Esto requiere que la clase de la ventana emergente se sepa de antemano.</span><span class="sxs-lookup"><span data-stu-id="ffa69-236">This requires that the class of the pop-up window be known in advance.</span></span>
2.  <span data-ttu-id="ffa69-237">Implemente todas las propiedades y los patrones de control como de costumbre para los elementos emergentes, como si fuera un control en su propio derecho.</span><span class="sxs-lookup"><span data-stu-id="ffa69-237">Implement all properties and control patterns as usual for that pop-up, as though it were a control in its own right.</span></span>
3.  <span data-ttu-id="ffa69-238">Implemente la propiedad [**IRawElementProviderSimple:: HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider) para que devuelva el valor obtenido de [**UiaHostProviderFromHwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd), donde el parámetro es el identificador de ventana de la ventana emergente.</span><span class="sxs-lookup"><span data-stu-id="ffa69-238">Implement the [**IRawElementProviderSimple::HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider) property so that it returns the value obtained from [**UiaHostProviderFromHwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd), where the parameter is the window handle of the pop-up window.</span></span>
4.  <span data-ttu-id="ffa69-239">Implemente [**IRawElementProviderFragment:: Navigate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate) para la ventana emergente y su elemento primario, de modo que la navegación se controle correctamente desde el elemento primario lógico a los elementos secundarios lógicos y entre los elementos secundarios del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="ffa69-239">Implement [**IRawElementProviderFragment::Navigate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate) for the pop-up window and its parent so that navigation is handled properly from the logical parent to the logical children, and between sibling children.</span></span>

<span data-ttu-id="ffa69-240">Cuando la automatización de la interfaz de usuario encuentra la ventana emergente, reconoce que se está invalidando la navegación del valor predeterminado y omite la ventana emergente cuando se encuentra como elemento secundario del escritorio.</span><span class="sxs-lookup"><span data-stu-id="ffa69-240">When UI Automation encounters the pop-up window, it recognizes that navigation is being overridden from the default, and skips over the pop-up window when it is encountered as a child of the desktop.</span></span> <span data-ttu-id="ffa69-241">En su lugar, solo se puede tener acceso al nodo a través del fragmento.</span><span class="sxs-lookup"><span data-stu-id="ffa69-241">Instead, the node is reachable only through the fragment.</span></span>

<span data-ttu-id="ffa69-242">La asignación de un nuevo elemento primario no es adecuada para los casos en los que un control puede hospedar una ventana de cualquier clase.</span><span class="sxs-lookup"><span data-stu-id="ffa69-242">Assigning a new parent is not suitable for cases where a control can host a window of any class.</span></span> <span data-ttu-id="ffa69-243">Por ejemplo, un control rebar puede hospedar cualquier tipo de ventana en sus bandas.</span><span class="sxs-lookup"><span data-stu-id="ffa69-243">For example, a rebar control can host any type of window in its bands.</span></span> <span data-ttu-id="ffa69-244">Para controlar estos casos, la automatización de la interfaz de usuario admite una forma alternativa de reubicación de ventanas, como se describe en la sección siguiente.</span><span class="sxs-lookup"><span data-stu-id="ffa69-244">To handle these cases, UI Automation supports an alternative form of window relocation, as described in the next section.</span></span>

## <a name="provider-repositioning"></a><span data-ttu-id="ffa69-245">Reposición del proveedor</span><span class="sxs-lookup"><span data-stu-id="ffa69-245">Provider Repositioning</span></span>

<span data-ttu-id="ffa69-246">Los fragmentos de UI Automation pueden contener dos o más elementos contenidos en una ventana.</span><span class="sxs-lookup"><span data-stu-id="ffa69-246">UI Automation fragments may contain two or more elements that are each contained in a window.</span></span> <span data-ttu-id="ffa69-247">Dado que cada ventana tiene su propio proveedor predeterminado que considera que la ventana es un elemento secundario de una ventana contenedora, de forma predeterminada el árbol de automatización de la interfaz de usuario mostrará las ventanas del fragmento como elementos secundarios de la ventana primaria.</span><span class="sxs-lookup"><span data-stu-id="ffa69-247">Because each window has its own default provider that considers the window to be a child of a containing window, the UI Automation tree by default, will show the windows in the fragment as children of the parent window.</span></span> <span data-ttu-id="ffa69-248">En la mayoría de los casos, se trata de un comportamiento deseable, pero a veces puede llevar a confusión porque no coincide con la estructura lógica de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="ffa69-248">In most cases this is desirable behavior, but sometimes it can lead to confusion because it does not match the logical structure of the UI.</span></span>

<span data-ttu-id="ffa69-249">Un buen ejemplo de esto lo constituye un control rebar.</span><span class="sxs-lookup"><span data-stu-id="ffa69-249">A good example of this is a rebar control.</span></span> <span data-ttu-id="ffa69-250">Un control rebar contiene bandas, cada una de las cuales puede contener a su vez un control basado en ventanas, como una barra de herramientas, un cuadro de edición o un cuadro combinado.</span><span class="sxs-lookup"><span data-stu-id="ffa69-250">A rebar control contains bands, each of which can in turn contain a window-based control, such as a toolbar, an edit box, or a combo box.</span></span> <span data-ttu-id="ffa69-251">El proveedor de ventana predeterminado de la ventana rebar ve las ventanas de control de banda como elementos secundarios, y el proveedor rebar ve las bandas como elementos secundarios.</span><span class="sxs-lookup"><span data-stu-id="ffa69-251">The default window provider for the rebar window sees the band control windows as children, and the rebar provider sees the bands as children.</span></span> <span data-ttu-id="ffa69-252">Dado que el proveedor de ventana y el proveedor rebar funcionan en tándem y combinan sus elementos secundarios, tanto las bandas como los controles basados en ventanas aparecen como elementos secundarios del control rebar.</span><span class="sxs-lookup"><span data-stu-id="ffa69-252">Because the window provider and the rebar provider are working in tandem and combining their children, both the bands and the window-based controls appear as children of the rebar control.</span></span> <span data-ttu-id="ffa69-253">Sin embargo, lógicamente, solo deberían aparecer las bandas como elementos secundarios del control rebar y cada proveedor de banda debe acoplarse con el proveedor de ventana predeterminado para el control que contiene.</span><span class="sxs-lookup"><span data-stu-id="ffa69-253">Logically, however, only the bands should appear as children of the rebar control, and each band provider should be coupled with the default window provider for the control it contains.</span></span>

<span data-ttu-id="ffa69-254">Para ello, el proveedor de raíz de fragmento para el control rebar expone un conjunto de elementos secundarios que representan las bandas.</span><span class="sxs-lookup"><span data-stu-id="ffa69-254">To accomplish this, the fragment root provider for the rebar control exposes a set of children representing the bands.</span></span> <span data-ttu-id="ffa69-255">Cada banda tiene un proveedor único que puede exponer propiedades y patrones de control.</span><span class="sxs-lookup"><span data-stu-id="ffa69-255">Each band has a single provider that may expose properties and control patterns.</span></span> <span data-ttu-id="ffa69-256">En su implementación de [**IRawElementProviderSimple:: HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider), el proveedor de banda devuelve el proveedor de ventana predeterminado para la ventana de control, que obtiene llamando a [**UiaHostProviderFromHwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd), pasando el identificador de ventana del control (**hWnd**).</span><span class="sxs-lookup"><span data-stu-id="ffa69-256">In its implementation of [**IRawElementProviderSimple::HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider), the band provider returns the default window provider for the control window, which it obtains by calling [**UiaHostProviderFromHwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd), passing in the control's window handle (**HWND**).</span></span> <span data-ttu-id="ffa69-257">Por último, el proveedor de raíz de fragmento del rebar implementa la interfaz [**IRawElementProviderHwndOverride**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderhwndoverride) y en su implementación de [**IRawElementProviderHwndOverride:: GetOverrideProviderForHwnd**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderhwndoverride-getoverrideproviderforhwnd), devuelve el proveedor de banda adecuado para el control contenido en la ventana especificada.</span><span class="sxs-lookup"><span data-stu-id="ffa69-257">Finally, the fragment root provider for the rebar implements the [**IRawElementProviderHwndOverride**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderhwndoverride) interface, and in its implementation of [**IRawElementProviderHwndOverride::GetOverrideProviderForHwnd**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderhwndoverride-getoverrideproviderforhwnd), it returns the appropriate band provider for the control contained in the specified window.</span></span>

## <a name="disconnecting-providers"></a><span data-ttu-id="ffa69-258">Desconectar proveedores</span><span class="sxs-lookup"><span data-stu-id="ffa69-258">Disconnecting Providers</span></span>

<span data-ttu-id="ffa69-259">Normalmente, las aplicaciones crean controles a medida que son necesarios y los destruyen después.</span><span class="sxs-lookup"><span data-stu-id="ffa69-259">Applications typically create controls as they are needed and destroy them afterward.</span></span> <span data-ttu-id="ffa69-260">Después de destruir un control, los recursos del proveedor de automatización de la interfaz de usuario asociados al control deben liberarse llamando a [**UiaDisconnectProvider**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectprovider).</span><span class="sxs-lookup"><span data-stu-id="ffa69-260">After destroying a control, the UI Automation provider resources associated with the control should be released by calling the [**UiaDisconnectProvider**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectprovider).</span></span>

<span data-ttu-id="ffa69-261">Del mismo modo, una aplicación debe usar la función [**UiaDisconnectAllProviders**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectallproviders) para liberar todos los recursos de automatización de la interfaz de usuario retenidos por todos los proveedores en la aplicación antes de cerrarse.</span><span class="sxs-lookup"><span data-stu-id="ffa69-261">Similarly, an application should use the [**UiaDisconnectAllProviders**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectallproviders) function to release all UI Automation resources held by all providers in the application before shutting down.</span></span>

## <a name="related-topics"></a><span data-ttu-id="ffa69-262">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="ffa69-262">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ffa69-263">Guía del programador del proveedor de UI Automation</span><span class="sxs-lookup"><span data-stu-id="ffa69-263">UI Automation Provider Programmer's Guide</span></span>](uiauto-providerportal.md)
</dt> </dl>

 

 