---
description: Instrucciones de implementación para serializar la configuración de IWICDevelopRaw
ms.assetid: 4ecff5cc-24f3-4b89-b681-85c867b053e7
title: Instrucciones de implementación para serializar la configuración de IWICDevelopRaw
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 48cdc78f68e6d63ee7870b9296ae4cfa4f85547a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "103816083"
---
# <a name="implementation-guidelines-for-serializing-iwicdevelopraw-settings"></a><span data-ttu-id="17517-103">Instrucciones de implementación para serializar la configuración de IWICDevelopRaw</span><span class="sxs-lookup"><span data-stu-id="17517-103">Implementation Guidelines for Serializing IWICDevelopRaw Settings</span></span>

<span data-ttu-id="17517-104">La interfaz [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) expone valores que la aplicación puede usar para modificar el procesamiento de la imagen sin procesar.</span><span class="sxs-lookup"><span data-stu-id="17517-104">The [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) interface exposes settings that the application can use to modify the processing of the RAW image.</span></span> <span data-ttu-id="17517-105">La configuración se debe poder serializar para que persistan entre sesiones.</span><span class="sxs-lookup"><span data-stu-id="17517-105">The settings should be able to be serialized so that they persist across sessions.</span></span> <span data-ttu-id="17517-106">Aunque esto se puede hacer de varias maneras, se recomienda codificar estos datos de una manera coherente con otros metadatos.</span><span class="sxs-lookup"><span data-stu-id="17517-106">Although this can be done in several ways, it is recommended to encode this data in a manner that is consistent with other metadata.</span></span>

<span data-ttu-id="17517-107">A continuación se muestran algunas directrices generales de implementación:</span><span class="sxs-lookup"><span data-stu-id="17517-107">The following are some general implementation guidelines:</span></span>

-   <span data-ttu-id="17517-108">Cualquier configuración realizada a través de [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) (por ejemplo, rotación o balance de blanco) debe evitar sobrescribir la configuración de la cámara o los datos "tal cual" a menos que la etiqueta se use normalmente como "valor actual".</span><span class="sxs-lookup"><span data-stu-id="17517-108">Any settings made via [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) (such as rotation or white balance) should avoid overwriting camera setting or "as-shot" data unless the tag is commonly used as a "current setting."</span></span> <span data-ttu-id="17517-109">Por ejemplo, las etiquetas de orientación EXIF se pueden usar para conservar la rotación.</span><span class="sxs-lookup"><span data-stu-id="17517-109">For example, EXIF orientation tags can be used to persist rotation.</span></span>
-   <span data-ttu-id="17517-110">Es preferible no tener que guardar todo el archivo (incluidos los datos de píxeles de mosaico) cada vez que se solicita la serialización de la configuración de [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) .</span><span class="sxs-lookup"><span data-stu-id="17517-110">It is preferable not to have to save the entire file (including the mosaic pixel data) each time that the [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) settings are asked to be serialized.</span></span>
-   <span data-ttu-id="17517-111">El proceso de serialización de la configuración de [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) suele seguir este orden de eventos.</span><span class="sxs-lookup"><span data-stu-id="17517-111">The process of serializing [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) settings will generally follow this order of events.</span></span> <span data-ttu-id="17517-112">La aplicación:</span><span class="sxs-lookup"><span data-stu-id="17517-112">The application:</span></span>

    1.  <span data-ttu-id="17517-113">Crea una instancia de [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder) en un archivo sin formato.</span><span class="sxs-lookup"><span data-stu-id="17517-113">Instantiates an [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder) on a RAW file.</span></span>
    2.  <span data-ttu-id="17517-114">Llama a [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder)::[**GetFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapdecoder-getframe) para obtener un [**IWICBitmapFrameDecode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframedecode) para el fotograma sin formato.</span><span class="sxs-lookup"><span data-stu-id="17517-114">Calls [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder)::[**GetFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapdecoder-getframe) to get an [**IWICBitmapFrameDecode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframedecode) for the RAW frame.</span></span>
    3.  <span data-ttu-id="17517-115">Llama a QueryInterface en la interfaz IWICBitmapFrameDecode para la interfaz IWICDevelopRaw.</span><span class="sxs-lookup"><span data-stu-id="17517-115">Calls QueryInterface on the IWICBitmapFrameDecode interface for the IWICDevelopRaw interface.</span></span>
    4.  <span data-ttu-id="17517-116">Llama a [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw)::[**GetCurrentParameterSet**](/windows/desktop/api/Wincodec/nf-wincodec-iwicdevelopraw-getcurrentparameterset), que devuelve una interfaz IPropertyBag2 con todas las propiedades actuales almacenadas en él.</span><span class="sxs-lookup"><span data-stu-id="17517-116">Calls [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw)::[**GetCurrentParameterSet**](/windows/desktop/api/Wincodec/nf-wincodec-iwicdevelopraw-getcurrentparameterset), which returns an IPropertyBag2 interface with all of the current properties stored in it.</span></span>

        <span data-ttu-id="17517-117">En este punto del proceso, el objetivo es serializar la configuración de la interfaz IPropertyBag2 en el archivo sin formato.</span><span class="sxs-lookup"><span data-stu-id="17517-117">At this point of the process, the goal is to serialize the settings in the IPropertyBag2 interface into the RAW file.</span></span> <span data-ttu-id="17517-118">Para ello, se requiere la rotación de un codificador, etc., que se detalla en los pasos siguientes.</span><span class="sxs-lookup"><span data-stu-id="17517-118">To do so requires spinning up an encoder and so on, which is detailed in the following steps.</span></span>

    5.  <span data-ttu-id="17517-119">Crea un [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder) para el archivo sin formato.</span><span class="sxs-lookup"><span data-stu-id="17517-119">Creates an [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder) for the RAW file.</span></span>
    6.  <span data-ttu-id="17517-120">Llama a [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)::[**Initialize**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-initialize), pasando un nuevo flujo (en blanco) para codificar.</span><span class="sxs-lookup"><span data-stu-id="17517-120">Calls [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)::[**Initialize**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-initialize), passing in a new (blank) stream to encode.</span></span>
    7.  <span data-ttu-id="17517-121">Llama a [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)::[**CreateNewFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-createnewframe) para crear un nuevo IWICBitmapFrameEncode para el fotograma sin formato.</span><span class="sxs-lookup"><span data-stu-id="17517-121">Calls [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)::[**CreateNewFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-createnewframe) to create a new IWICBitmapFrameEncode for the RAW frame.</span></span>
    8.  <span data-ttu-id="17517-122">Llama a [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)::[**Initialize**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-initialize)y pasa la interfaz IPropertyBag2 del paso 4.</span><span class="sxs-lookup"><span data-stu-id="17517-122">Calls [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)::[**Initialize**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-initialize), and passes in the IPropertyBag2 interface from step 4.</span></span>
    9.  <span data-ttu-id="17517-123">Llama a [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)::[**WriteSource**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapframeencode-writesource) con [**IWICBitmapSource**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapsource) desde el fotograma de imagen sin procesar del descodificador.</span><span class="sxs-lookup"><span data-stu-id="17517-123">Calls [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)::[**WriteSource**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapframeencode-writesource) with [**IWICBitmapSource**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapsource) from decoder's RAW image frame.</span></span>
    10. <span data-ttu-id="17517-124">Llama a [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)::[**commit**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-commit).</span><span class="sxs-lookup"><span data-stu-id="17517-124">Calls [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)::[**Commit**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-commit).</span></span> <span data-ttu-id="17517-125">A continuación, el códec serializa las propiedades de IPropertyBag2 del paso 8 en el archivo.</span><span class="sxs-lookup"><span data-stu-id="17517-125">The codec then serializes the properties in the IPropertyBag2 from step 8 into the file.</span></span> <span data-ttu-id="17517-126">Se supone que el método más común de serialización de las propiedades se escribe como metadatos en el archivo.</span><span class="sxs-lookup"><span data-stu-id="17517-126">The most common method of serializing the properties is assumed to be by writing them out as metadata in the file.</span></span>
    11. <span data-ttu-id="17517-127">Llama a [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)::[**commit**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-commit).</span><span class="sxs-lookup"><span data-stu-id="17517-127">Calls [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)::[**Commit**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-commit).</span></span>
    12. <span data-ttu-id="17517-128">Llama a IStream:: commit en la secuencia del paso 6.</span><span class="sxs-lookup"><span data-stu-id="17517-128">Calls IStream::Commit on the stream in step 6.</span></span>

    <span data-ttu-id="17517-129">La configuración se serializa en el archivo.</span><span class="sxs-lookup"><span data-stu-id="17517-129">The settings are serialized in the file.</span></span>

    <span data-ttu-id="17517-130">Este método incurre en el costo de volver a escribir todo el archivo sin formato cada vez que se serializa la configuración.</span><span class="sxs-lookup"><span data-stu-id="17517-130">This method does incur the cost of rewriting the entire RAW file each time the settings are serialized.</span></span> <span data-ttu-id="17517-131">Esto se puede evitar si implementa [**IWICFastMetadataEncoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicfastmetadataencoder) o si el formato de archivo de imagen admite XMP o EXIF, ya que WIC proporciona [**IWICFastMetadataEncoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicfastmetadataencoder) para ambos formatos.</span><span class="sxs-lookup"><span data-stu-id="17517-131">This can be avoided if you implement [**IWICFastMetadataEncoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicfastmetadataencoder) or if your image file format supports XMP or EXIF, as WIC provides [**IWICFastMetadataEncoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicfastmetadataencoder) for both of these formats.</span></span> <span data-ttu-id="17517-132">Además, si el códec escribe cambios al final del archivo de imagen, no terminará de volver a escribir todo el archivo de imagen.</span><span class="sxs-lookup"><span data-stu-id="17517-132">Also, if your codec writes changes to the end of the image file, then you won't end up rewriting the entire image file.</span></span>

-   <span data-ttu-id="17517-133">Los conjuntos de parámetros se cargan desde el estado serializado cuando la aplicación establece la enumeración [**WICRawParameterSet. WICUserAdjustedParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) en el método [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw)::[**LoadParameterSet**](/windows/desktop/api/Wincodec/nf-wincodec-iwicdevelopraw-loadparameterset) .</span><span class="sxs-lookup"><span data-stu-id="17517-133">Parameter sets are loaded from the serialized state when the application sets the [**WICRawParameterSet.WICUserAdjustedParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) enumeration on the [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw)::[**LoadParameterSet**](/windows/desktop/api/Wincodec/nf-wincodec-iwicdevelopraw-loadparameterset) method.</span></span> <span data-ttu-id="17517-134">La marca [**WICRawParameterSet. WICUserAdjustedParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) hace referencia al último conjunto de parámetros guardado, por lo que una carga con esta marca debe tener como resultado la restauración de los parámetros en el último estado guardado.</span><span class="sxs-lookup"><span data-stu-id="17517-134">The [**WICRawParameterSet.WICUserAdjustedParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) flag refers to the last-saved parameter set, so a load with this flag should result in restoring parameters to the last-saved state.</span></span>
-   <span data-ttu-id="17517-135">Tras la carga inicial, se debe cargar el conjunto de parámetros guardado por última vez, si está disponible.</span><span class="sxs-lookup"><span data-stu-id="17517-135">Upon initial load, the last-saved parameter set should be loaded, if available.</span></span> <span data-ttu-id="17517-136">Si no es así, se debe usar la configuración "as-Shot" como valores preestablecidos en las variables de la interfaz [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) .</span><span class="sxs-lookup"><span data-stu-id="17517-136">If not, then the "as-shot" settings should be used as presets on the [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) interface variables.</span></span> <span data-ttu-id="17517-137">Estos valores de as-Shot también se pueden cargar mediante el uso de la marca [**WICRawParameterSet. WICAsShotParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) .</span><span class="sxs-lookup"><span data-stu-id="17517-137">These as-shot settings can also be loaded by using the [**WICRawParameterSet.WICAsShotParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) flag.</span></span>
-   <span data-ttu-id="17517-138">El identificador [**WICRawParameterSet. WICAutoAdjustedParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) se ha diseñado para representar un valor "auto".</span><span class="sxs-lookup"><span data-stu-id="17517-138">The identifier [**WICRawParameterSet.WICAutoAdjustedParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) is meant to represent an "Auto" setting.</span></span> <span data-ttu-id="17517-139">El diseñador de códecs puede elegir cualquiera de los siguientes métodos para establecer los parámetros de [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) cuando se realiza esta configuración:</span><span class="sxs-lookup"><span data-stu-id="17517-139">The codec designer can elect any of the following approaches on how to set [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) parameters when this setting is made:</span></span>

    -   <span data-ttu-id="17517-140">Realice una optimización algorítmica de algunos parámetros, como la exposición o el color.</span><span class="sxs-lookup"><span data-stu-id="17517-140">Perform an algorithmic optimization of some parameters, such as exposure or color.</span></span> <span data-ttu-id="17517-141">Así es como funciona la función auto en los editores de imágenes típicos y se basa principalmente en el análisis de datos de píxeles.</span><span class="sxs-lookup"><span data-stu-id="17517-141">This is how Auto functions in typical image editors and is based primarily on pixel data analysis.</span></span>
    -   <span data-ttu-id="17517-142">Establezca la configuración de la cámara de manera similar a como se habría comportado la configuración automática.</span><span class="sxs-lookup"><span data-stu-id="17517-142">Set camera settings similar to how an Auto setting would have behaved.</span></span> <span data-ttu-id="17517-143">Esto resulta útil si la imagen se ha captado en una configuración manual y permite que el usuario invalide la configuración manual.</span><span class="sxs-lookup"><span data-stu-id="17517-143">This is useful if the image was shot on a Manual setting and allows the user to override manual settings.</span></span>
    -   <span data-ttu-id="17517-144">No haga nada.</span><span class="sxs-lookup"><span data-stu-id="17517-144">Do nothing.</span></span> <span data-ttu-id="17517-145">No todos los controles deben establecerse cuando se selecciona automático y es correcto dejar la configuración sin cambios.</span><span class="sxs-lookup"><span data-stu-id="17517-145">Not all controls need to be set when Auto is selected, and it is OK to leave settings unchanged.</span></span>

<span data-ttu-id="17517-146">La Galería fotográfica de Windows Vista y las herramientas de edición de la Galería fotográfica de Windows Live y otras aplicaciones de edición usan la carga automática de parámetros [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) cuando el usuario selecciona corrección automática para todos los ajustes normales del control de códecs, como color y exposición, para obtener los mejores resultados.</span><span class="sxs-lookup"><span data-stu-id="17517-146">The Windows Vista Photo Gallery and Windows Live Photo Gallery editing tools and other editing applications use the [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) Auto parameter load when the user selects Auto Correct for all normal codec control adjustments such as color and exposure to get the best results.</span></span>

## <a name="related-topics"></a><span data-ttu-id="17517-147">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="17517-147">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="17517-148">**Vista**</span><span class="sxs-lookup"><span data-stu-id="17517-148">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="17517-149">Información general sobre componentes de Windows Imaging</span><span class="sxs-lookup"><span data-stu-id="17517-149">Windows Imaging Component Overview</span></span>](-wic-about-windows-imaging-codec.md)
</dt> <dt>

[<span data-ttu-id="17517-150">Instrucciones de WIC para formatos de imagen RAW de cámara</span><span class="sxs-lookup"><span data-stu-id="17517-150">WIC Guidelines for Camera RAW Image Formats</span></span>](-wic-rawguidelines.md)
</dt> <dt>

[<span data-ttu-id="17517-151">Cómo escribir un códec de WIC-Enabled</span><span class="sxs-lookup"><span data-stu-id="17517-151">How to Write a WIC-Enabled CODEC</span></span>](-wic-howtowriteacodec.md)
</dt> </dl>

 

 



