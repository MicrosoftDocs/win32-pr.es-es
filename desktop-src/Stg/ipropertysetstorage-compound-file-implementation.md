---
title: IPropertySetStorage-Compound la implementación de archivos
description: La implementación del objeto de almacenamiento de archivo compuesto COM incluye una implementación de IPropertyStorage, la interfaz que administra un único conjunto de propiedades persistentes y IPropertySetStorage, la interfaz que administra los grupos de conjuntos de propiedades persistentes.
ms.assetid: de2cb778-c6eb-4487-996b-87405674f603
keywords:
- IPropertySetStorage Strctd STG, implementaciones, archivo compuesto
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9053a7cf6bf1ae7e4230b15eb0117c428acb08da
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "103792963"
---
# <a name="ipropertysetstorage-compound-file-implementation"></a><span data-ttu-id="34894-104">IPropertySetStorage-Compound la implementación de archivos</span><span class="sxs-lookup"><span data-stu-id="34894-104">IPropertySetStorage-Compound File Implementation</span></span>

<span data-ttu-id="34894-105">La [implementación del objeto de almacenamiento de archivo compuesto com](ipropertystorage-compound-file-implementation.md) incluye una implementación de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), la interfaz que administra un único conjunto de propiedades persistentes y [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage), la interfaz que administra los grupos de conjuntos de propiedades persistentes.</span><span class="sxs-lookup"><span data-stu-id="34894-105">The [COM compound file storage object implementation](ipropertystorage-compound-file-implementation.md) includes an implementation of both [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), the interface that manages a single persistent property set, and [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage), the interface that manages groups of persistent property sets.</span></span>

<span data-ttu-id="34894-106">Para obtener un puntero a la implementación de archivo compuesto de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage), especifique el nombre definido por el encabezado para el identificador de IID de identificador \_ como parámetro *riid* , o bien use las funciones [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) o [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) .</span><span class="sxs-lookup"><span data-stu-id="34894-106">To get a pointer to the compound file implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage), specify the header-defined name for the identifier IID\_IStorage as the *riid* parameter, or use the [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) functions.</span></span> <span data-ttu-id="34894-107">En ambos casos, especifique \_ el almacenamiento de STGFMT como el parámetro *STGFMT* .</span><span class="sxs-lookup"><span data-stu-id="34894-107">In both cases, specify STGFMT\_STORAGE as the *stgfmt* parameter.</span></span> <span data-ttu-id="34894-108">(STGFMT \_ También se puede especificar ANY en el caso de **StgOpenStorageEx**). Además, especifique el nombre definido por el encabezado para el IID del identificador de interfaz (IID) \_ IPropertySetStorage como parámetro *riid* .</span><span class="sxs-lookup"><span data-stu-id="34894-108">(STGFMT\_ANY can alternatively be specified in the case of **StgOpenStorageEx**.) Also, specify the header-defined name for the interface identifier (IID) IID\_IPropertySetStorage as the *riid* parameter.</span></span> <span data-ttu-id="34894-109">Ambas funciones proporcionan un puntero a la interfaz **IPropertySetStorage** del objeto.</span><span class="sxs-lookup"><span data-stu-id="34894-109">Both functions supply a pointer to the object **IPropertySetStorage** interface.</span></span>

<span data-ttu-id="34894-110">Otra manera de obtener un puntero a la implementación de archivos compuestos es especificar el nombre definido por el encabezado para el identificador de IID de identificador \_ como parámetro *riid* , o para usar las funciones [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) o [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) .</span><span class="sxs-lookup"><span data-stu-id="34894-110">Another way to get a pointer to the compound file implementation is to specify the header-defined name for the identifier IID\_IStorage as the *riid* parameter, or to use the [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) or [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) functions.</span></span> <span data-ttu-id="34894-111">Esto proporcionará un puntero a la interfaz [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) de objetos.</span><span class="sxs-lookup"><span data-stu-id="34894-111">This will supply a pointer to the object [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) interface.</span></span> <span data-ttu-id="34894-112">Cuando desee trabajar con conjuntos de propiedades persistentes, llame a [**IStorage:: QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) para la interfaz [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) .</span><span class="sxs-lookup"><span data-stu-id="34894-112">When you want to deal with persistent property sets, call [**IStorage::QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) for the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface.</span></span>

## <a name="when-to-use-ipropertysetstorage"></a><span data-ttu-id="34894-113">Cuándo usar IPropertySetStorage</span><span class="sxs-lookup"><span data-stu-id="34894-113">When to Use IPropertySetStorage</span></span>

<span data-ttu-id="34894-114">Llame a los métodos de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) para crear, abrir o eliminar conjuntos de propiedades en el almacenamiento del conjunto de propiedades de archivo compuesto actual.</span><span class="sxs-lookup"><span data-stu-id="34894-114">Call the methods of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) to create, open, or delete property sets in the current compound-file property set storage.</span></span> <span data-ttu-id="34894-115">También hay un método, [**IPropertySetStorage:: enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum), que proporciona un puntero a un enumerador que se puede usar para enumerar los conjuntos de propiedades en el almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="34894-115">There is also a method, [**IPropertySetStorage::Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum), that supplies a pointer to an enumerator that can be used to enumerate the property sets in the storage.</span></span>

## <a name="methods"></a><span data-ttu-id="34894-116">Métodos</span><span class="sxs-lookup"><span data-stu-id="34894-116">Methods</span></span>

[<span data-ttu-id="34894-117">**IPropertySetStorage:: Create**</span><span class="sxs-lookup"><span data-stu-id="34894-117">**IPropertySetStorage::Create**</span></span>](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)

<span data-ttu-id="34894-118">Crea un nuevo conjunto de propiedades en el almacenamiento de archivos compuesto actual y, en la devolución, proporciona un puntero de interfaz a la implementación de archivo compuesto [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) .</span><span class="sxs-lookup"><span data-stu-id="34894-118">Creates a new property set in the current compound file storage and, on return, supplies an interface pointer to the [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) compound-file implementation.</span></span> <span data-ttu-id="34894-119">En esta implementación, los conjuntos de propiedades se pueden transaccionar solo si \_ se especifica PROPSETFLAG nonsimple.</span><span class="sxs-lookup"><span data-stu-id="34894-119">In this implementation, property sets may be transacted only if PROPSETFLAG\_NONSIMPLE is specified.</span></span> <span data-ttu-id="34894-120">Este método requiere que el modo de uso compartido especificado en el parámetro *grfMode* sea STGM \_ compartido \_ exclusivo y que el modo de acceso sea STGM \_ Read o STGM \_ ReadWrite ( \_ no se admite el modo de escritura STGM).</span><span class="sxs-lookup"><span data-stu-id="34894-120">This method requires that the sharing mode specified in the *grfMode* parameter be STGM\_SHARE\_EXCLUSIVE, and that the access mode be either STGM\_READ or STGM\_READWRITE (STGM\_WRITE mode is not supported).</span></span>

[<span data-ttu-id="34894-121">**IPropertySetStorage:: Open**</span><span class="sxs-lookup"><span data-stu-id="34894-121">**IPropertySetStorage::Open**</span></span>](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open)

<span data-ttu-id="34894-122">Abre un conjunto de propiedades existente en el almacenamiento de propiedades actual.</span><span class="sxs-lookup"><span data-stu-id="34894-122">Opens an existing property set in the current property storage.</span></span> <span data-ttu-id="34894-123">En la devolución, proporciona un puntero de interfaz a la implementación de archivo compuesto de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage).</span><span class="sxs-lookup"><span data-stu-id="34894-123">On return, it supplies an interface pointer to the compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage).</span></span> <span data-ttu-id="34894-124">Este método requiere que el modo de uso compartido especificado en el parámetro *grfMode* sea STGM \_ compartido \_ exclusivo y que el modo de acceso sea STGM \_ Read o STGM \_ ReadWrite ( \_ no se admite la escritura en STGM).</span><span class="sxs-lookup"><span data-stu-id="34894-124">This method requires that the sharing mode specified in the *grfMode* parameter be STGM\_SHARE\_EXCLUSIVE, and that the access mode be either STGM\_READ or STGM\_READWRITE (STGM\_WRITE is not supported).</span></span>

[<span data-ttu-id="34894-125">**IPropertySetStorage::D iminar**</span><span class="sxs-lookup"><span data-stu-id="34894-125">**IPropertySetStorage::Delete**</span></span>](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-delete)

<span data-ttu-id="34894-126">Elimina un conjunto de propiedades en este almacenamiento de propiedades.</span><span class="sxs-lookup"><span data-stu-id="34894-126">Deletes a property set in this property storage.</span></span>

[<span data-ttu-id="34894-127">**IPropertySetStorage:: enum**</span><span class="sxs-lookup"><span data-stu-id="34894-127">**IPropertySetStorage::Enum**</span></span>](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum)

<span data-ttu-id="34894-128">Crea un objeto que se usa para enumerar las estructuras [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) .</span><span class="sxs-lookup"><span data-stu-id="34894-128">Creates an object used to enumerate [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures.</span></span> <span data-ttu-id="34894-129">Cada estructura **STATPROPSETSTG** proporciona datos sobre un conjunto de propiedades único.</span><span class="sxs-lookup"><span data-stu-id="34894-129">Each **STATPROPSETSTG** structure provides data about a single property set.</span></span>

## <a name="remarks"></a><span data-ttu-id="34894-130">Observaciones</span><span class="sxs-lookup"><span data-stu-id="34894-130">Remarks</span></span>

<span data-ttu-id="34894-131">A partir de Windows 2000, la implementación de archivo compuesto de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) admite el modo simple.</span><span class="sxs-lookup"><span data-stu-id="34894-131">Starting with Windows 2000, the compound-file implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) supports simple mode.</span></span> <span data-ttu-id="34894-132">El modo simple se indica especificando la \_ marca de STGM simple para las funciones [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) y [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) .</span><span class="sxs-lookup"><span data-stu-id="34894-132">Simple mode is indicated by specifying the STGM\_SIMPLE flag for the [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) and [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) functions.</span></span> <span data-ttu-id="34894-133">Si el archivo compuesto se abre en modo simple, la implementación de **IPropertySetStorage** asociada se limita de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="34894-133">If the compound file is opened in simple mode, the associated **IPropertySetStorage** implementation is limited as follows:</span></span>

-   <span data-ttu-id="34894-134">Solo se pueden crear conjuntos de propiedades simples.</span><span class="sxs-lookup"><span data-stu-id="34894-134">Only simple property sets can be created.</span></span> <span data-ttu-id="34894-135">Es decir, si se especifica el \_ valor NONSIMPLE PROPSETFLAG en el parámetro *grfFlags* para el método [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) se produce un error.</span><span class="sxs-lookup"><span data-stu-id="34894-135">That is, specifying the PROPSETFLAG\_NONSIMPLE value in the *grfFlags* parameter for the [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) method results in an error.</span></span>
-   <span data-ttu-id="34894-136">Después de crear un archivo compuesto con [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) mediante STGM \_ simple y consultar la interfaz [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) , solo puede llamar una vez a [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) .</span><span class="sxs-lookup"><span data-stu-id="34894-136">After you create a compound file with [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) using STGM\_SIMPLE and query for the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface, you can only call [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) once.</span></span> <span data-ttu-id="34894-137">Después, debe liberar la interfaz [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) antes de volver a llamar al método **Create** .</span><span class="sxs-lookup"><span data-stu-id="34894-137">Then you must release the [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interface before calling the **Create** method again.</span></span> <span data-ttu-id="34894-138">Para obtener más información sobre el modo simple, vea [**constantes STGM**](stgm-constants.md).</span><span class="sxs-lookup"><span data-stu-id="34894-138">For more information about simple mode, see [**STGM Constants**](stgm-constants.md).</span></span>
-   <span data-ttu-id="34894-139">No se puede usar el método [**IPropertySetStorage:: Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) para abrir un conjunto de propiedades después de usar [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) para crear el objeto de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="34894-139">You cannot use the [**IPropertySetStorage::Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) method to open a property set after using [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) to create the storage object.</span></span> <span data-ttu-id="34894-140">En su lugar, debe usar [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) antes de consultar [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) y llamar al método **Open** .</span><span class="sxs-lookup"><span data-stu-id="34894-140">Instead you must use [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) before querying for [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) and calling the **Open** method.</span></span>
-   <span data-ttu-id="34894-141">Después de abrir un archivo compuesto con [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) mediante la \_ marca simple STGM y la consulta de la interfaz [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) , puede abrir un conjunto de propiedades a la vez mediante [**IPropertySetStorage:: Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open).</span><span class="sxs-lookup"><span data-stu-id="34894-141">After you open a compound file with [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) using the STGM\_SIMPLE flag and query for the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface, you can open one property set at a time using [**IPropertySetStorage::Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open).</span></span> <span data-ttu-id="34894-142">Además, es posible que no sea posible que el tamaño total del conjunto de propiedades aumente mientras el conjunto de propiedades esté abierto.</span><span class="sxs-lookup"><span data-stu-id="34894-142">Also, it may not be possible for the total size of the property set to be increased while the property set is open.</span></span>

<span data-ttu-id="34894-143">No se pueden realizar transacciones en conjuntos de propiedades simples.</span><span class="sxs-lookup"><span data-stu-id="34894-143">Simple property sets cannot be transacted.</span></span> <span data-ttu-id="34894-144">No se puede especificar STGM \_ TRANSaccionado en el parámetro *grfmode* de los métodos [**Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) y [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) , a menos que también se especifique PROPSETFLAG \_ nonsimple en el parámetro *grfFlags* .</span><span class="sxs-lookup"><span data-stu-id="34894-144">You cannot specify STGM\_TRANSACTED in the *grfmode* parameter of the [**Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) and [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) methods unless you also specify PROPSETFLAG\_NONSIMPLE in the *grfFlags* parameter.</span></span> <span data-ttu-id="34894-145">Tenga en cuenta que los conjuntos de propiedades simples y no simples no están relacionados con los conjuntos de propiedades de modo simple descritos anteriormente.</span><span class="sxs-lookup"><span data-stu-id="34894-145">Be aware that simple and non-simple property sets are unrelated to the simple-mode property sets described above.</span></span> <span data-ttu-id="34894-146">Para obtener más información sobre los conjuntos de propiedades simples y no simples, vea [almacenamiento y objetos de secuencia para un conjunto de propiedades](storage-vs--stream-for-a-property-set.md).</span><span class="sxs-lookup"><span data-stu-id="34894-146">For more information about simple and nonsimple property sets, see [Storage and Stream Objects for a Property Set](storage-vs--stream-for-a-property-set.md).</span></span>

> [!Note]  
> <span data-ttu-id="34894-147">Los conjuntos de propiedades DocumentSummaryInformation y UserDefined son únicos en que pueden tener dos secciones set de propiedad.</span><span class="sxs-lookup"><span data-stu-id="34894-147">The DocumentSummaryInformation and UserDefined property sets are unique in that they may have two property set sections.</span></span> <span data-ttu-id="34894-148">Para obtener más información, vea [los conjuntos de propiedades DocumentSummaryInformation y UserDefined](the-documentsummaryinformation-and-userdefined-property-sets.md).</span><span class="sxs-lookup"><span data-stu-id="34894-148">For more information, see [The DocumentSummaryInformation and UserDefined Property Sets](the-documentsummaryinformation-and-userdefined-property-sets.md).</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="34894-149">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="34894-149">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="34894-150">IPropertyStorage: implementación de archivos compuestos</span><span class="sxs-lookup"><span data-stu-id="34894-150">IPropertyStorage - Compound File Implementation</span></span>](ipropertystorage-compound-file-implementation.md)
</dt> <dt>

[<span data-ttu-id="34894-151">**IPropertySetStorage**</span><span class="sxs-lookup"><span data-stu-id="34894-151">**IPropertySetStorage**</span></span>](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage)
</dt> <dt>

[<span data-ttu-id="34894-152">**IPropertyStorage**</span><span class="sxs-lookup"><span data-stu-id="34894-152">**IPropertyStorage**</span></span>](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage)
</dt> <dt>

[<span data-ttu-id="34894-153">**IStorage:: EnumElements**</span><span class="sxs-lookup"><span data-stu-id="34894-153">**IStorage::EnumElements**</span></span>](/windows/desktop/api/Objidl/nf-objidl-istorage-enumelements)
</dt> <dt>

[<span data-ttu-id="34894-154">**Constantes de PROPSETFLAG**</span><span class="sxs-lookup"><span data-stu-id="34894-154">**PROPSETFLAG Constants**</span></span>](propsetflag-constants.md)
</dt> <dt>

[<span data-ttu-id="34894-155">**STATPROPSETSTG**</span><span class="sxs-lookup"><span data-stu-id="34894-155">**STATPROPSETSTG**</span></span>](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)
</dt> </dl>

 

 