---
description: Para crear una biblioteca de Dynamic-Link (DLL), debe crear uno o varios archivos de código fuente y, posiblemente, un archivo de vinculador para exportar las funciones.
ms.assetid: b66ea0e8-84c3-40be-bf02-765b9dd61f9f
title: Creación de la biblioteca Dynamic-Link
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c12d296b1494cfcedcdfa823eb1a3dd4d408427a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "103811485"
---
# <a name="dynamic-link-library-creation"></a><span data-ttu-id="380b1-103">Creación de la biblioteca Dynamic-Link</span><span class="sxs-lookup"><span data-stu-id="380b1-103">Dynamic-Link Library Creation</span></span>

<span data-ttu-id="380b1-104">Para crear una biblioteca de Dynamic-Link (DLL), debe crear uno o varios archivos de código fuente y, posiblemente, un archivo de vinculador para exportar las funciones.</span><span class="sxs-lookup"><span data-stu-id="380b1-104">To create a Dynamic-Link Library (DLL), you must create one or more source code files, and possibly a linker file for exporting the functions.</span></span> <span data-ttu-id="380b1-105">Si planea permitir que las aplicaciones que usan el archivo DLL utilicen la vinculación dinámica en tiempo de carga, también debe crear una biblioteca de importación.</span><span class="sxs-lookup"><span data-stu-id="380b1-105">If you plan to allow applications that use your DLL to use load-time dynamic linking, you must also create an import library.</span></span>

## <a name="creating-source-files"></a><span data-ttu-id="380b1-106">Crear archivos de código fuente</span><span class="sxs-lookup"><span data-stu-id="380b1-106">Creating Source Files</span></span>

<span data-ttu-id="380b1-107">Los archivos de código fuente de un archivo DLL contienen funciones y datos exportados, funciones internas y datos, y una [función de punto de entrada](dynamic-link-library-entry-point-function.md) opcional para el archivo dll.</span><span class="sxs-lookup"><span data-stu-id="380b1-107">The source files for a DLL contain exported functions and data, internal functions and data, and an optional [entry-point function](dynamic-link-library-entry-point-function.md) for the DLL.</span></span> <span data-ttu-id="380b1-108">Puede utilizar cualquier herramienta de desarrollo que admita la creación de archivos dll basados en Windows.</span><span class="sxs-lookup"><span data-stu-id="380b1-108">You may use any development tools that support the creation of Windows-based DLLs.</span></span>

<span data-ttu-id="380b1-109">Si una aplicación multiproceso puede utilizar la DLL, debe hacer que el archivo DLL sea "seguro para subprocesos".</span><span class="sxs-lookup"><span data-stu-id="380b1-109">If your DLL may be used by a multithreaded application, you should make your DLL "thread-safe".</span></span> <span data-ttu-id="380b1-110">Debe sincronizar el acceso a todos los datos globales del archivo DLL para evitar daños en los datos.</span><span class="sxs-lookup"><span data-stu-id="380b1-110">You must synchronize access to all of the DLL's global data to avoid data corruption.</span></span> <span data-ttu-id="380b1-111">También debe asegurarse de que solo vincula las bibliotecas que son seguras para subprocesos.</span><span class="sxs-lookup"><span data-stu-id="380b1-111">You must also ensure that you link only with libraries that are thread-safe as well.</span></span> <span data-ttu-id="380b1-112">Por ejemplo, Microsoft Visual C++ contiene varias versiones de la biblioteca en tiempo de ejecución de C, una que no es segura para subprocesos y dos que son.</span><span class="sxs-lookup"><span data-stu-id="380b1-112">For example, Microsoft Visual C++ contains multiple versions of the C Run-time Library, one that is not thread-safe and two that are.</span></span>

## <a name="exporting-functions"></a><span data-ttu-id="380b1-113">Exportar funciones</span><span class="sxs-lookup"><span data-stu-id="380b1-113">Exporting Functions</span></span>

<span data-ttu-id="380b1-114">La forma en que se especifican las funciones de un archivo DLL debe exportarse depende de las herramientas que se usan para el desarrollo.</span><span class="sxs-lookup"><span data-stu-id="380b1-114">How you specify which functions in a DLL should be exported depends on the tools that you are using for development.</span></span> <span data-ttu-id="380b1-115">Algunos compiladores permiten exportar una función directamente en el código fuente utilizando un modificador en la declaración de función.</span><span class="sxs-lookup"><span data-stu-id="380b1-115">Some compilers allow you to export a function directly in the source code by using a modifier in the function declaration.</span></span> <span data-ttu-id="380b1-116">Otras veces, debe especificar las exportaciones en un archivo que se pasa al enlazador.</span><span class="sxs-lookup"><span data-stu-id="380b1-116">Other times, you must specify exports in a file that you pass to the linker.</span></span>

<span data-ttu-id="380b1-117">Por ejemplo, con Visual C++, hay dos formas posibles de exportar funciones DLL: con el modificador [**\_ \_ declspec (dllexport)**](https://msdn.microsoft.com/library/3y1sfaz2(v=VS.71).aspx) o con un archivo de definición de módulo (. def).</span><span class="sxs-lookup"><span data-stu-id="380b1-117">For example, using Visual C++, there are two possible ways to export DLL functions: with the [**\_\_declspec(dllexport)**](https://msdn.microsoft.com/library/3y1sfaz2(v=VS.71).aspx) modifier or with a module-definition (.def) file.</span></span> <span data-ttu-id="380b1-118">Si utiliza el modificador **\_ \_ declspec (dllexport)** , no es necesario utilizar un archivo. def.</span><span class="sxs-lookup"><span data-stu-id="380b1-118">If you use the **\_\_declspec(dllexport)** modifier, it is not necessary to use a .def file.</span></span> <span data-ttu-id="380b1-119">Para obtener más información, vea [exportar desde un archivo dll](/cpp/build/exporting-from-a-dll?view=vs-2019).</span><span class="sxs-lookup"><span data-stu-id="380b1-119">For more information, see [Exporting from a DLL](/cpp/build/exporting-from-a-dll?view=vs-2019).</span></span>

## <a name="creating-an-import-library"></a><span data-ttu-id="380b1-120">Crear una biblioteca de importación</span><span class="sxs-lookup"><span data-stu-id="380b1-120">Creating an Import Library</span></span>

<span data-ttu-id="380b1-121">Un archivo de biblioteca de importación (. lib) contiene información que el vinculador necesita para resolver las referencias externas a las funciones de DLL exportadas, por lo que el sistema puede localizar la DLL especificada y las funciones de DLL exportadas en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="380b1-121">An import library (.lib) file contains information the linker needs to resolve external references to exported DLL functions, so the system can locate the specified DLL and exported DLL functions at run time.</span></span> <span data-ttu-id="380b1-122">Puede crear una biblioteca de importación para el archivo DLL al compilar el archivo DLL.</span><span class="sxs-lookup"><span data-stu-id="380b1-122">You can create an import library for your DLL when you build your DLL.</span></span>

<span data-ttu-id="380b1-123">Para obtener más información, vea [crear una biblioteca de importación y un archivo de exportación](/cpp/build/reference/building-an-import-library-and-export-file?view=vs-2019).</span><span class="sxs-lookup"><span data-stu-id="380b1-123">For more information, see [Building an Import Library and Export File](/cpp/build/reference/building-an-import-library-and-export-file?view=vs-2019).</span></span>

## <a name="using-an-import-library"></a><span data-ttu-id="380b1-124">Uso de una biblioteca de importación</span><span class="sxs-lookup"><span data-stu-id="380b1-124">Using an Import Library</span></span>

<span data-ttu-id="380b1-125">Por ejemplo, para llamar a la función [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa) , debe vincular el código con la biblioteca de importación user32. lib.</span><span class="sxs-lookup"><span data-stu-id="380b1-125">For example, to call the [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa) function, you must link your code with the import library User32.lib.</span></span> <span data-ttu-id="380b1-126">La razón es que **CreateWindow** reside en un archivo DLL del sistema denominado User32.dll y user32. lib es la biblioteca de importación que se usa para resolver las llamadas a las funciones exportadas en User32.dll en el código.</span><span class="sxs-lookup"><span data-stu-id="380b1-126">The reason is that **CreateWindow** resides in a system DLL named User32.dll, and User32.lib is the import library used to resolve the calls to exported functions in User32.dll in your code.</span></span> <span data-ttu-id="380b1-127">El vinculador crea una tabla que contiene la dirección de cada llamada de función.</span><span class="sxs-lookup"><span data-stu-id="380b1-127">The linker creates a table that contains the address of each function call.</span></span> <span data-ttu-id="380b1-128">Las llamadas a las funciones de un archivo DLL se corregirán cuando se cargue el archivo DLL.</span><span class="sxs-lookup"><span data-stu-id="380b1-128">Calls to functions in a DLL will be fixed up when the DLL is loaded.</span></span> <span data-ttu-id="380b1-129">Mientras el sistema está inicializando el proceso, carga User32.dll porque el proceso depende de las funciones exportadas en ese archivo DLL y actualiza las entradas de la tabla de direcciones de la función.</span><span class="sxs-lookup"><span data-stu-id="380b1-129">While the system is initializing the process, it loads User32.dll because the process depends on exported functions in that DLL, and it updates the entries in the function address table.</span></span> <span data-ttu-id="380b1-130">Todas las llamadas a **CreateWindow** invocan la función exportada desde User32.dll.</span><span class="sxs-lookup"><span data-stu-id="380b1-130">All calls to **CreateWindow** invoke the function exported from User32.dll.</span></span>

<span data-ttu-id="380b1-131">Para obtener más información, vea [vincular implícitamente con un archivo dll](/previous-versions/d14wsce5(v=vs.140)).</span><span class="sxs-lookup"><span data-stu-id="380b1-131">For information, see [Linking Implicitly with a DLL](/previous-versions/d14wsce5(v=vs.140)).</span></span>

## <a name="related-topics"></a><span data-ttu-id="380b1-132">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="380b1-132">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="380b1-133">Crear una biblioteca de vínculos dinámicos simple</span><span class="sxs-lookup"><span data-stu-id="380b1-133">Creating a Simple Dynamic-link Library</span></span>](creating-a-simple-dynamic-link-library.md)
</dt> <dt>

[<span data-ttu-id="380b1-134">DLL (Visual C++)</span><span class="sxs-lookup"><span data-stu-id="380b1-134">DLLs (Visual C++)</span></span>](/cpp/build/dlls-in-visual-cpp?view=vs-2019)
</dt> </dl>

 

 
