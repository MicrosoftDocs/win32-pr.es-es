---
title: Prácticas recomendadas para DirectComposition
description: En este tema se describen los procedimientos recomendados para usar Microsoft DirectComposition.
ms.assetid: D3A1ECD4-9358-44B9-8A84-7D901219D5CD
keywords:
- prácticas recomendadas para DirectComposition
- prácticas recomendadas para DirectComposition
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2f0d19b82b188105c7914e89282c08b12dd4bdc4
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "103793575"
---
# <a name="best-practices-for-directcomposition"></a><span data-ttu-id="6de98-105">Prácticas recomendadas para DirectComposition</span><span class="sxs-lookup"><span data-stu-id="6de98-105">Best practices for DirectComposition</span></span>

> [!NOTE]
> <span data-ttu-id="6de98-106">En el caso de las aplicaciones de Windows 10, se recomienda usar las API de Windows. UI. Composition en lugar de DirectComposition.</span><span class="sxs-lookup"><span data-stu-id="6de98-106">For apps on Windows 10, we recommend using Windows.UI.Composition APIs instead of DirectComposition.</span></span> <span data-ttu-id="6de98-107">Para obtener más información, consulte [modernice su aplicación de escritorio con el nivel de objetos visuales](/windows/uwp/composition/visual-layer-in-desktop-apps).</span><span class="sxs-lookup"><span data-stu-id="6de98-107">For more info, see [Modernize your desktop app using the Visual layer](/windows/uwp/composition/visual-layer-in-desktop-apps).</span></span>

<span data-ttu-id="6de98-108">En este tema se describen los procedimientos recomendados para usar Microsoft DirectComposition.</span><span class="sxs-lookup"><span data-stu-id="6de98-108">This topic describes best practices for using Microsoft DirectComposition.</span></span>

-   [<span data-ttu-id="6de98-109">procedimientos recomendados</span><span class="sxs-lookup"><span data-stu-id="6de98-109">Best practices</span></span>](#best-practices-for-directcomposition)
-   [<span data-ttu-id="6de98-110">Consideraciones de seguridad</span><span class="sxs-lookup"><span data-stu-id="6de98-110">Security considerations</span></span>](#security-considerations)
-   [<span data-ttu-id="6de98-111">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="6de98-111">Related topics</span></span>](#related-topics)

## <a name="best-practices"></a><span data-ttu-id="6de98-112">Procedimientos recomendados</span><span class="sxs-lookup"><span data-stu-id="6de98-112">Best practices</span></span>

<span data-ttu-id="6de98-113">En la tabla siguiente se presentan las prácticas recomendadas para trabajar con objetos visuales de Microsoft DirectComposition.</span><span class="sxs-lookup"><span data-stu-id="6de98-113">The following table presents the practices recommended for working with Microsoft DirectComposition visuals.</span></span>



| <span data-ttu-id="6de98-114">Práctica</span><span class="sxs-lookup"><span data-stu-id="6de98-114">Practice</span></span>                                                                                                                                                                                                                                                        | <span data-ttu-id="6de98-115">Descripción</span><span class="sxs-lookup"><span data-stu-id="6de98-115">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="6de98-116">Después de crear un dispositivo DirectComposition, llame al método [**IDCompositionDevice:: CheckDeviceState**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-checkdevicestate) en respuesta a cada mensaje de [**\_ dibujo de WM**](/windows/desktop/gdi/wm-paint) para asegurarse de que el dispositivo todavía es válido.</span><span class="sxs-lookup"><span data-stu-id="6de98-116">After creating a DirectComposition device, call the [**IDCompositionDevice::CheckDeviceState**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-checkdevicestate) method in response to each [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message to ensure that the device is still valid.</span></span><br/> | <span data-ttu-id="6de98-117">Si se pierde el dispositivo de infraestructura de gráficos de Microsoft DirectX (DXGI), también se pierde el dispositivo DirectComposition asociado con el dispositivo DXGI.</span><span class="sxs-lookup"><span data-stu-id="6de98-117">If the Microsoft DirectX Graphics Infrastructure (DXGI) device is lost, the DirectComposition device associated with the DXGI device is also lost.</span></span> <span data-ttu-id="6de98-118">Cuando detecta un dispositivo perdido, DirectComposition envía el mensaje de [**\_ dibujo de WM**](/windows/desktop/gdi/wm-paint) a todas las ventanas.</span><span class="sxs-lookup"><span data-stu-id="6de98-118">When it detects a lost device, DirectComposition sends the [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message to all windows.</span></span> <span data-ttu-id="6de98-119">Llamar a [**CheckDeviceState**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-checkdevicestate) en respuesta a cada mensaje de **\_ Paint de WM** le permite determinar si el objeto de dispositivo DirectComposition sigue siendo válido y, si no es así, realizar los pasos necesarios para recuperar el contenido.</span><span class="sxs-lookup"><span data-stu-id="6de98-119">Calling [**CheckDeviceState**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-checkdevicestate) in response to each **WM\_PAINT** message lets you determine whether the DirectComposition device object is still valid and, if not, take steps to recover content.</span></span> <br/> <span data-ttu-id="6de98-120">Para obtener más información, consulte [Device Object](basic-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="6de98-120">For more information, see [Device object](basic-concepts.md).</span></span><br/> |
| <span data-ttu-id="6de98-121">Cree solo el número de objetos visuales necesarios para una composición o animación y destruya los objetos visuales inmediatamente después de que DirectComposition termine de usarlos.</span><span class="sxs-lookup"><span data-stu-id="6de98-121">Create only the number of visuals needed for a composition or animation, and destroy the visuals immediately after DirectComposition finishes using them.</span></span><br/>                                                                                            | <span data-ttu-id="6de98-122">DirectComposition usa la unidad de procesamiento de gráficos (GPU), un recurso que la aplicación comparte con otras aplicaciones y el sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="6de98-122">DirectComposition uses the graphics processing unit (GPU), a resource that your application shares with other applications and the operating system.</span></span> <span data-ttu-id="6de98-123">Esta práctica garantiza que todas las aplicaciones y el sistema operativo reciban los recursos de GPU necesarios.</span><span class="sxs-lookup"><span data-stu-id="6de98-123">This practice ensures that all applications and the operating system receive adequate GPU resources.</span></span><br/> <span data-ttu-id="6de98-124">Para obtener más información, consulte [objetos visuales](basic-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="6de98-124">For more information, see [Visuals](basic-concepts.md).</span></span><br/>                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="6de98-125">No oculte los objetos visuales estableciendo la opacidad en 0%; en su lugar, quite los objetos visuales del árbol visual.</span><span class="sxs-lookup"><span data-stu-id="6de98-125">Do not hide visuals by setting opacity to 0%; instead, remove visuals from the visual tree.</span></span><br/>                                                                                                                                                          | <span data-ttu-id="6de98-126">Establecer la opacidad en 0% requiere más recursos del sistema que quitarlos del árbol visual.</span><span class="sxs-lookup"><span data-stu-id="6de98-126">Setting opacity to 0% requires more system resources than removing them from the visual tree.</span></span><br/> <span data-ttu-id="6de98-127">Para obtener más información, vea [opacidad](effects.md) y [árbol visual](basic-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="6de98-127">For more information, see [Opacity](effects.md) and [Visual tree](basic-concepts.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="6de98-128">No oculte un visual aplicando un rectángulo de recorte vacío (con tamaño cero) a un valor visual.</span><span class="sxs-lookup"><span data-stu-id="6de98-128">Do not hide a visual by applying an empty (zero sized) clip rectangle to a visual.</span></span> <span data-ttu-id="6de98-129">En su lugar, quite el visual del árbol visual.</span><span class="sxs-lookup"><span data-stu-id="6de98-129">Instead, remove the visual from the visual tree.</span></span> <br/>                                                                                                                 | <span data-ttu-id="6de98-130">Quitar un objetos visuales del árbol visual da como resultado un mejor rendimiento que aplicar un rectángulo de recorte vacío.</span><span class="sxs-lookup"><span data-stu-id="6de98-130">Removing a visual from the visual tree results in better performance than applying an empty clip rectangle.</span></span><br/> <span data-ttu-id="6de98-131">Para obtener más información, vea [recorte](clipping.md).</span><span class="sxs-lookup"><span data-stu-id="6de98-131">For more information, see [Clipping](clipping.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="6de98-132">No aplique un rectángulo de recorte a un visual si el rectángulo de recorte no es necesario, como un rectángulo de recorte que incluye todo el contenido del mapa de bits del visual.</span><span class="sxs-lookup"><span data-stu-id="6de98-132">Do not apply a clip rectangle to a visual if the clip rectangle is not needed, such as a clip rectangle that includes the entire bitmap content of the visual.</span></span><br/>                                                                                       | <span data-ttu-id="6de98-133">Los rectángulos de recorte innecesarios perjudican el rendimiento del sistema.</span><span class="sxs-lookup"><span data-stu-id="6de98-133">Unnecessary clip rectangles harm system performance.</span></span><br/> <span data-ttu-id="6de98-134">Para obtener más información, vea [recorte](clipping.md).</span><span class="sxs-lookup"><span data-stu-id="6de98-134">For more information, see [Clipping](clipping.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="6de98-135">Si necesita un mapa de bits grande de un solo color, cree una superficie de mapa de bits más pequeña y, a continuación, aplique una transformación de escala en lugar de crear una superficie de tamaño completo.</span><span class="sxs-lookup"><span data-stu-id="6de98-135">If you need a large, single-color bitmap, create a smaller bitmap surface and then apply a scale transform instead of creating a full-sized surface.</span></span> <br/>                                                                                                | <span data-ttu-id="6de98-136">Aplicar una transformación de escala a una superficie menor utiliza menos recursos del sistema que una superficie de tamaño completo.</span><span class="sxs-lookup"><span data-stu-id="6de98-136">Applying a scale transform to a smaller surface is uses fewer system resources than a full-size surface.</span></span><br/> <span data-ttu-id="6de98-137">Para obtener más información, vea [objetos de mapa de bits](bitmap-surfaces.md) y [transformaciones](transforms.md).</span><span class="sxs-lookup"><span data-stu-id="6de98-137">For more information, see [Bitmap objects](bitmap-surfaces.md) and [Transforms](transforms.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="6de98-138">Evite aplicar transformaciones 3D a varios niveles de un árbol visual, como a un elemento primario y a sus descendientes.</span><span class="sxs-lookup"><span data-stu-id="6de98-138">Avoid applying 3D transforms to multiple levels of a visual tree, such as to a parent and its descendent(s).</span></span> <br/>                                                                                                                                        | <span data-ttu-id="6de98-139">Aplicar transformaciones 3D a varios niveles de un árbol visual puede producir resultados imprevistos porque las transformaciones 3D no se multiplican en el árbol.</span><span class="sxs-lookup"><span data-stu-id="6de98-139">Applying 3D transforms to multiple levels of a visual tree can produce unintended results because 3D transformations are not multiplied out in the tree.</span></span> <span data-ttu-id="6de98-140">Por ejemplo, un giro de 90 grados alrededor del eje y de un elemento secundario, y un giro de 90 grados alrededor del eje y de un elemento primario, hace que ambos objetos visuales se roten en nada.</span><span class="sxs-lookup"><span data-stu-id="6de98-140">For example, a 90 degree rotation around the y-axis on a child, and a  90 degree rotation around the y-axis on a parent, results in both visuals being rotated away to nothing.</span></span><br/> <span data-ttu-id="6de98-141">Para obtener más información, consulte [Effects](effects.md) (Efectos).</span><span class="sxs-lookup"><span data-stu-id="6de98-141">For more information, see [Effects](effects.md).</span></span><br/>                                                                                                                                                                                                     |



 

## <a name="security-considerations"></a><span data-ttu-id="6de98-142">Consideraciones sobre la seguridad</span><span class="sxs-lookup"><span data-stu-id="6de98-142">Security considerations</span></span>

<span data-ttu-id="6de98-143">En los artículos siguientes se proporcionan instrucciones para escribir código de C++ seguro.</span><span class="sxs-lookup"><span data-stu-id="6de98-143">The following articles provide guidance for writing secure C++ code.</span></span>

-   [<span data-ttu-id="6de98-144">Prácticas recomendadas de seguridad para C++</span><span class="sxs-lookup"><span data-stu-id="6de98-144">Security Best Practices for C++</span></span>](/cpp/security/security-best-practices-for-cpp?view=vs-2019)
-   <span data-ttu-id="6de98-145">[Patterns & prácticas guía de seguridad para aplicaciones](/previous-versions/msp-n-p/ff650760(v=pandp.10))</span><span class="sxs-lookup"><span data-stu-id="6de98-145">[Patterns & Practices Security Guidance for Applications](/previous-versions/msp-n-p/ff650760(v=pandp.10))</span></span>

## <a name="related-topics"></a><span data-ttu-id="6de98-146">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="6de98-146">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="6de98-147">Cómo usar DirectComposition</span><span class="sxs-lookup"><span data-stu-id="6de98-147">How to Use DirectComposition</span></span>](how-to-use-directcomposition.md)
</dt> </dl>

 

