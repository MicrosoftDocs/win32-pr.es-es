---
description: Los componentes de aplicación usan el dispensador de recursos de COM+ para tener acceso y administrar información de estado compartida y no duradera, como conexiones entre componentes y un administrador de recursos determinado.
ms.assetid: 252c7180-61b1-485d-883d-36bf77357a29
title: Conceptos del dispensador de recursos COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8f0fcf281d6d7b8ed0e087b6d77e4d686e28e1fa
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "103807201"
---
# <a name="com-resource-dispenser-concepts"></a><span data-ttu-id="1494d-103">Conceptos del dispensador de recursos COM+</span><span class="sxs-lookup"><span data-stu-id="1494d-103">COM+ Resource Dispenser Concepts</span></span>

<span data-ttu-id="1494d-104">Los componentes de aplicación usan el dispensador de recursos de COM+ para tener acceso y administrar información de estado compartida y no duradera, como conexiones entre componentes y un administrador de recursos determinado.</span><span class="sxs-lookup"><span data-stu-id="1494d-104">Application components use the COM+ resource dispenser to access and manage shared, nondurable state information, such as connections between components and a given resource manager.</span></span> <span data-ttu-id="1494d-105">En tiempo de ejecución, los grupos dinámicos de recursos, como las conexiones de base de datos, las conexiones de red, las conexiones a las colas, los subprocesos, los objetos y los bloques de memoria, se ponen a disposición del dispensador de recursos.</span><span class="sxs-lookup"><span data-stu-id="1494d-105">At runtime, dynamic pools of resources, such as database connections, network connections, connections to queues, threads, objects, and memory blocks, are made available to the resource dispenser.</span></span> <span data-ttu-id="1494d-106">El proceso de aplicación consigue un alto rendimiento mediante el uso de un número mínimo de recursos usados con frecuencia.</span><span class="sxs-lookup"><span data-stu-id="1494d-106">The application process achieves high performance by using a minimum number of frequently used resources.</span></span> <span data-ttu-id="1494d-107">El dispensador de recursos también puede automatizar las transacciones y la recuperación.</span><span class="sxs-lookup"><span data-stu-id="1494d-107">The resource dispenser can also automate transactions and reclamation.</span></span> <span data-ttu-id="1494d-108">(Consulte [recuperación automática de recursos](automatic-resource-reclamation.md) para obtener más información acerca de esta característica).</span><span class="sxs-lookup"><span data-stu-id="1494d-108">(See [Automatic Resource Reclamation](automatic-resource-reclamation.md) for more information about this feature.)</span></span>

> [!Note]  
> <span data-ttu-id="1494d-109">Un *recurso* es todo lo que crea un dispensador de recursos.</span><span class="sxs-lookup"><span data-stu-id="1494d-109">A *resource* is anything a resource dispenser creates.</span></span> <span data-ttu-id="1494d-110">Por ejemplo, una conexión a un administrador de recursos es un recurso común.</span><span class="sxs-lookup"><span data-stu-id="1494d-110">For example, a connection to a resource manager is a common resource.</span></span> <span data-ttu-id="1494d-111">Los recursos residen en la memoria del dispensador de recursos y nunca se copian en el administrador dispensador.</span><span class="sxs-lookup"><span data-stu-id="1494d-111">Resources reside in the resource dispenser's memory and are never copied to the dispenser manager.</span></span> <span data-ttu-id="1494d-112">Un recurso solo lo conoce un identificador opaco (**Resid**) y puede o no ser capaz de realizar transacciones.</span><span class="sxs-lookup"><span data-stu-id="1494d-112">A resource is known only by an opaque handle (**RESID**) and may or may not be capable of performing transactions.</span></span> <span data-ttu-id="1494d-113">Aunque los recursos administrados suelen ser conexiones a un componente que administra un estado duradero, las propias conexiones no son duraderas.</span><span class="sxs-lookup"><span data-stu-id="1494d-113">Although the resources managed might often be connections to a component managing a durable state, the connections themselves are not durable.</span></span> <span data-ttu-id="1494d-114">Un dispensador de recursos suele usar un administrador de recursos relacionado para conservar el estado durable.</span><span class="sxs-lookup"><span data-stu-id="1494d-114">A resource dispenser often uses a related resource manager to retain the durable state.</span></span>

 

<span data-ttu-id="1494d-115">En la arquitectura, el sistema del dispensador de recursos COM+ está formado por distribuidores de recursos y un administrador dispensador.</span><span class="sxs-lookup"><span data-stu-id="1494d-115">Architecturally, the COM+ resource dispenser system consists of resource dispensers and a dispenser manager.</span></span> <span data-ttu-id="1494d-116">Los dispensadores de recursos son componentes proporcionados por el usuario que proporcionan a las aplicaciones interfaces simples para recursos compartidos.</span><span class="sxs-lookup"><span data-stu-id="1494d-116">Resource dispensers are user-supplied components that provide applications with simple interfaces to shared resources.</span></span> <span data-ttu-id="1494d-117">El gestor dispensador es un componente que proporciona COM+ y que coordina las actividades de los distintos distribuidores de recursos.</span><span class="sxs-lookup"><span data-stu-id="1494d-117">The dispenser manager is a component provided by COM+ that coordinates the activities of the various resource dispensers.</span></span>

<span data-ttu-id="1494d-118">Un dispensador de recursos es un componente de biblioteca de vínculos dinámicos (DLL) que proporciona al menos dos interfaces.</span><span class="sxs-lookup"><span data-stu-id="1494d-118">A resource dispenser is a dynamic-link library (DLL) component that provides at least two interfaces.</span></span> <span data-ttu-id="1494d-119">El primero, [**IDispenserDriver**](/windows/desktop/api/ComSvcs/nn-comsvcs-idispenserdriver), proporciona al administrador dispensador información básica sobre cómo crear, destruir y dar de alta los recursos que administra.</span><span class="sxs-lookup"><span data-stu-id="1494d-119">The first, [**IDispenserDriver**](/windows/desktop/api/ComSvcs/nn-comsvcs-idispenserdriver), provides the dispenser manager with basic information on how to create, destroy, and enlist the resources it manages.</span></span> <span data-ttu-id="1494d-120">La segunda se expone a las aplicaciones y puede ser una interfaz COM o un conjunto de interfaces o puede ser una interfaz de programación de aplicaciones (API) a la que se vincula un componente a través de una biblioteca de importación.</span><span class="sxs-lookup"><span data-stu-id="1494d-120">The second is exposed to the applications and can be a COM interface or set of interfaces or can be an application programming interface (API) to which a component is linked via an import library.</span></span> <span data-ttu-id="1494d-121">Una aplicación puede llamar a cualquier dispensador de recursos, que a su vez puede ofrecer cualquier API a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="1494d-121">An application can call any resource dispenser, which in turn may offer any API to the application.</span></span> <span data-ttu-id="1494d-122">Si el dispensador de recursos es un componente de automatización, se puede tener acceso a él desde Microsoft Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="1494d-122">If the resource dispenser is an Automation component, it can be accessed from Microsoft Visual Basic.</span></span> <span data-ttu-id="1494d-123">Se crea una instancia de un dispensador de recursos cuando un componente de aplicación hace referencia a él.</span><span class="sxs-lookup"><span data-stu-id="1494d-123">A resource dispenser is instantiated when an application component refers to it.</span></span>

<span data-ttu-id="1494d-124">El administrador dispensador proporcionado por COM+ realiza un seguimiento de los distribuidores de recursos y las coordenadas entre ellos.</span><span class="sxs-lookup"><span data-stu-id="1494d-124">The dispenser manager provided by COM+ tracks resource dispensers and coordinates among them.</span></span> <span data-ttu-id="1494d-125">Implementa dos interfaces: [**IDispenserManager**](/windows/desktop/api/ComSvcs/nn-comsvcs-idispensermanager) y [**IHolder**](/windows/desktop/api/ComSvcs/nn-comsvcs-iholder).</span><span class="sxs-lookup"><span data-stu-id="1494d-125">It implements two interfaces: [**IDispenserManager**](/windows/desktop/api/ComSvcs/nn-comsvcs-idispensermanager) and [**IHolder**](/windows/desktop/api/ComSvcs/nn-comsvcs-iholder).</span></span> <span data-ttu-id="1494d-126">los distribuidores de recursos se registran a sí mismos mediante la interfaz **IDispenserManager** .</span><span class="sxs-lookup"><span data-stu-id="1494d-126">resource dispensers register themselves using the **IDispenserManager** interface.</span></span> <span data-ttu-id="1494d-127">A continuación, el administrador dispensador les proporciona un puntero a un **IHolder** que usan para notificar a la Directora de sus actividades.</span><span class="sxs-lookup"><span data-stu-id="1494d-127">The dispenser manager then gives them a pointer to an **IHolder** that they use to notify the dispenser manager of their activities.</span></span>

<span data-ttu-id="1494d-128">Un dispensador de recursos transaccionales debe darse de alta en una transacción Coordinador de transacciones distribuidas (DTC).</span><span class="sxs-lookup"><span data-stu-id="1494d-128">A transactional resource dispenser must enlist in a Distributed Transaction Coordinator (DTC) transaction.</span></span> <span data-ttu-id="1494d-129">Esto implica el uso de un administrador de recursos interno o externo (para el dispensador de recursos) que es compatible con las transacciones OLE.</span><span class="sxs-lookup"><span data-stu-id="1494d-129">This implies use of either an internal or an external (to the resource dispenser) resource manager that is OLE transactions-compliant.</span></span>

> [!Note]  
> <span data-ttu-id="1494d-130">El modelo de programación COM+ incluye *transacciones declarativas*, que ayudan a proteger el trabajo realizado por un objeto de aplicación durante su duración.</span><span class="sxs-lookup"><span data-stu-id="1494d-130">The COM+ programming model includes *declarative transactions*, which help protect the work performed by an application object during its lifetime.</span></span> <span data-ttu-id="1494d-131">Cuando un objeto de aplicación utiliza un dispensador de recursos de COM+, el trabajo que realiza es automáticamente transaccional. es decir, el componente no tiene que declarar explícitamente las transacciones.</span><span class="sxs-lookup"><span data-stu-id="1494d-131">When an application object uses a COM+ resource dispenser, the work it performs is automatically transactional; that is, the component doesn't have to explicitly declare transactions.</span></span> <span data-ttu-id="1494d-132">Estas transacciones se definen en la especificación de transacciones OLE, implementadas por el DTC, y se inician en nombre del objeto de aplicación mediante COM+.</span><span class="sxs-lookup"><span data-stu-id="1494d-132">These transactions are defined in the OLE Transactions specification, implemented by the DTC, and initiated on behalf of the application object by COM+.</span></span> <span data-ttu-id="1494d-133">Para obtener más información, consulte la guía de desarrollo de DTC.</span><span class="sxs-lookup"><span data-stu-id="1494d-133">See the DTC Development Guide for more information.</span></span>

 

<span data-ttu-id="1494d-134">Los recursos no deben ser transaccionales.</span><span class="sxs-lookup"><span data-stu-id="1494d-134">Resources need not be transactional.</span></span> <span data-ttu-id="1494d-135">Un dispensador de recursos que agrupe recursos no transaccionales todavía puede lograr un alto rendimiento al permitir que los objetos de aplicación tengan acceso a un grupo compartido de estos recursos.</span><span class="sxs-lookup"><span data-stu-id="1494d-135">A resource dispenser that pools non-transactional resources can still achieve high performance by allowing application objects to access a shared pool of these resources.</span></span> <span data-ttu-id="1494d-136">Este tipo de dispensador de recursos devuelve S \_ false del método [**IDispenserDriver:: EnlistResource**](/windows/desktop/api/ComSvcs/nf-comsvcs-idispenserdriver-enlistresource) , lo que significa que el dispensador de recursos no ha dado de alta el recurso porque el recurso no es transaccional.</span><span class="sxs-lookup"><span data-stu-id="1494d-136">This type of resource dispenser returns S\_FALSE from the [**IDispenserDriver::EnlistResource**](/windows/desktop/api/ComSvcs/nf-comsvcs-idispenserdriver-enlistresource) method, which means that the resource dispenser did not enlist the resource because the resource is not transactional.</span></span>

<span data-ttu-id="1494d-137">El dispensador de recursos también puede funcionar independientemente de COM+, proporcionando únicamente capacidades de agrupación de recursos.</span><span class="sxs-lookup"><span data-stu-id="1494d-137">The resource dispenser can also function independently of COM+, providing only resource pooling capabilities.</span></span> <span data-ttu-id="1494d-138">Por ejemplo, si un dispensador de recursos expone una API (como ODBC), el dispensador de recursos podría ser un archivo DLL al que tenga acceso la aplicación a través de una biblioteca de importación (o mediante las funciones [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) y [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) ).</span><span class="sxs-lookup"><span data-stu-id="1494d-138">For example, if a resource dispenser exposes an API (such as ODBC), the resource dispenser might be a DLL that is accessed by the application through an import library (or using the [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) and [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) functions).</span></span> <span data-ttu-id="1494d-139">Un dispensador de recursos también podría ser un componente COM al que tiene acceso una aplicación mediante una llamada a [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance).</span><span class="sxs-lookup"><span data-stu-id="1494d-139">A resource dispenser might also be a COM component that an application accesses by calling [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance).</span></span> <span data-ttu-id="1494d-140">Sin COM+, nunca se puede llamar al método [**EnlistResource**](/windows/desktop/api/ComSvcs/nf-comsvcs-idispenserdriver-enlistresource) de un dispensador de recursos, ya que el administrador dispensador no tiene conocimiento de la transacción del componente actual.</span><span class="sxs-lookup"><span data-stu-id="1494d-140">Without COM+, a resource dispenser's [**EnlistResource**](/windows/desktop/api/ComSvcs/nf-comsvcs-idispenserdriver-enlistresource) method can never be called because the dispenser manager has no knowledge of the current component transaction.</span></span>

<span data-ttu-id="1494d-141">Al iniciarse, un archivo DLL de dispensador de recursos debe registrarse en el administrador del dispensador.</span><span class="sxs-lookup"><span data-stu-id="1494d-141">On startup, a resource dispenser DLL must register itself with the dispenser manager.</span></span> <span data-ttu-id="1494d-142">El gestor dispensador es el ejecutivo de control que administra la carga y descarga de los distribuidores de recursos, proporciona el contexto de COM+ y controla el administrador de estadísticas de inventario.</span><span class="sxs-lookup"><span data-stu-id="1494d-142">The dispenser manager is the controlling executive that manages the loading and unloading of resource dispensers, provides the COM+ context, and controls the inventory statistics manager.</span></span> <span data-ttu-id="1494d-143">(Para obtener más información, consulte [Administrador de dispensadores de com+](com--dispenser-manager.md)). El dispensador de recursos llama primero a la función [**GetDispenserManager**](/windows/desktop/api/MtxDM/nf-mtxdm-getdispensermanager) y, a continuación, llama al método [**IDispenserManager:: RegisterDispenser**](/windows/desktop/api/ComSvcs/nf-comsvcs-idispensermanager-registerdispenser) , pasando el puntero [**IDispenserDriver**](/windows/desktop/api/ComSvcs/nn-comsvcs-idispenserdriver) que implementa el dispensador de recursos.</span><span class="sxs-lookup"><span data-stu-id="1494d-143">(For more information, see [COM+ Dispenser Manager](com--dispenser-manager.md).) The resource dispenser first calls the [**GetDispenserManager**](/windows/desktop/api/MtxDM/nf-mtxdm-getdispensermanager) function and then calls the [**IDispenserManager::RegisterDispenser**](/windows/desktop/api/ComSvcs/nf-comsvcs-idispensermanager-registerdispenser) method, passing the [**IDispenserDriver**](/windows/desktop/api/ComSvcs/nn-comsvcs-idispenserdriver) pointer that the resource dispenser implements.</span></span> <span data-ttu-id="1494d-144">Esta llamada devuelve una referencia a [**IHolder**](/windows/desktop/api/ComSvcs/nn-comsvcs-iholder).</span><span class="sxs-lookup"><span data-stu-id="1494d-144">This call returns a reference to [**IHolder**](/windows/desktop/api/ComSvcs/nn-comsvcs-iholder).</span></span>

<span data-ttu-id="1494d-145">Para apagarse, un dispensador de recursos llama a [**IHolder:: Close**](/windows/desktop/api/ComSvcs/nf-comsvcs-iholder-close).</span><span class="sxs-lookup"><span data-stu-id="1494d-145">To shut down, a resource dispenser calls [**IHolder::Close**](/windows/desktop/api/ComSvcs/nf-comsvcs-iholder-close).</span></span> <span data-ttu-id="1494d-146">Para garantizar un cierre de un paquete limpio, un dispensador de recursos debe ser capaz de controlar la situación en la que las llamadas continúan llegando desde objetos empresariales después de que COM+ haya solicitado el cierre del dispensador.</span><span class="sxs-lookup"><span data-stu-id="1494d-146">To ensure a clean package shutdown, a resource dispenser must be able to handle the situation when calls continue to arrive from business objects after COM+ has asked the dispenser to shut down.</span></span>

<span data-ttu-id="1494d-147">En los siguientes temas de esta sección se proporciona información más detallada sobre el servicio dispensador de recursos COM+:</span><span class="sxs-lookup"><span data-stu-id="1494d-147">The following topics in this section provide more detailed information about the COM+ resource dispenser service:</span></span>

-   [<span data-ttu-id="1494d-148">Administrador del dispensador de COM+</span><span class="sxs-lookup"><span data-stu-id="1494d-148">COM+ Dispenser Manager</span></span>](com--dispenser-manager.md)
-   [<span data-ttu-id="1494d-149">Tipos de subprocesos del dispensador de recursos COM+</span><span class="sxs-lookup"><span data-stu-id="1494d-149">COM+ Resource Dispenser Thread Types</span></span>](com--resource-dispenser-thread-types.md)
-   [<span data-ttu-id="1494d-150">Estados de recursos agrupados disponibles para el dispensador de recursos COM+</span><span class="sxs-lookup"><span data-stu-id="1494d-150">Pooled Resource States Available to COM+ Resource Dispenser</span></span>](pooled-resource-states-available-to-com--resource-dispenser.md)
-   [<span data-ttu-id="1494d-151">Dar de alta un recurso en una transacción</span><span class="sxs-lookup"><span data-stu-id="1494d-151">Enlisting a Resource in a Transaction</span></span>](enlisting-a-resource-in-a-transaction.md)
-   [<span data-ttu-id="1494d-152">Proceso de asignación de recursos del dispensador de recursos</span><span class="sxs-lookup"><span data-stu-id="1494d-152">Resource Dispenser Resource Allocation Process</span></span>](resource-dispenser-resource-allocation-process.md)
-   [<span data-ttu-id="1494d-153">Seguimiento de recursos no asignados</span><span class="sxs-lookup"><span data-stu-id="1494d-153">Tracking Non-Allocated Resources</span></span>](tracking-non-allocated-resources.md)
-   [<span data-ttu-id="1494d-154">Recuperación automática de recursos</span><span class="sxs-lookup"><span data-stu-id="1494d-154">Automatic Resource Reclamation</span></span>](automatic-resource-reclamation.md)
-   [<span data-ttu-id="1494d-155">Tipos usados en las interfaces del dispensador de recursos COM+</span><span class="sxs-lookup"><span data-stu-id="1494d-155">Types Used in COM+ Resource Dispenser Interfaces</span></span>](types-used-in-com--resource-dispenser-interfaces.md)
-   [<span data-ttu-id="1494d-156">Interfaces dispensadoras de recursos COM+</span><span class="sxs-lookup"><span data-stu-id="1494d-156">COM+ Resource Dispenser Interfaces</span></span>](com--resource-dispenser-interfaces.md)

## <a name="related-topics"></a><span data-ttu-id="1494d-157">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="1494d-157">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1494d-158">Tareas del dispensador de recursos COM+</span><span class="sxs-lookup"><span data-stu-id="1494d-158">COM+ Resource Dispenser Tasks</span></span>](com--resource-dispenser-tasks.md)
</dt> </dl>

 

 
