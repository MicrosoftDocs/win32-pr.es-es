---
title: Mantenimiento automático (Programador de tareas)
description: La actividad de mantenimiento hace referencia a una aplicación o un proceso que ayuda a mantener el estado y el rendimiento de un equipo Windows.
ms.assetid: 1D38341B-15AA-422F-AED1-647FCDE69E2E
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 456383eeb75c3b29bf575357d4b17d5f8a66234b
ms.sourcegitcommit: 857e701bbd35004661bb047e1f24622af9ff1dd7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/19/2020
ms.locfileid: "104421562"
---
# <a name="automatic-maintenance"></a><span data-ttu-id="39854-103">Mantenimiento automático</span><span class="sxs-lookup"><span data-stu-id="39854-103">Automatic maintenance</span></span>

<span data-ttu-id="39854-104">La actividad de mantenimiento hace referencia a una aplicación o un proceso que ayuda a mantener el estado y el rendimiento de un equipo Windows.</span><span class="sxs-lookup"><span data-stu-id="39854-104">Maintenance activity refers to an application or process that helps maintain the health and performance of a Windows PC.</span></span> <span data-ttu-id="39854-105">El mantenimiento incluye mantener actualizados el sistema operativo Windows (SO) y las aplicaciones, comprobar la seguridad y ejecutar exámenes de malware.</span><span class="sxs-lookup"><span data-stu-id="39854-105">Maintenance includes keeping the Windows operating system (OS) and applications up-to-date, checking security, and running scans for malware.</span></span> <span data-ttu-id="39854-106">La administración automática de Windows (WAM) es un conjunto de mejoras en la API de Programador de tareas que puede usar para vincular las aplicaciones a la programación de mantenimiento de Windows.</span><span class="sxs-lookup"><span data-stu-id="39854-106">Windows Automatic Management (WAM) is a set of enhancements to the Task Scheduler API that you can use to link your applications into the Windows maintenance schedule.</span></span> <span data-ttu-id="39854-107">En concreto, el WAM le permite agregar actividades que requieren una programación normal, pero que no tienen requisitos de tiempo exactos.</span><span class="sxs-lookup"><span data-stu-id="39854-107">Specifically, WAM allows you to add activities that require regular scheduling, but that don't have exact time requirements.</span></span> <span data-ttu-id="39854-108">En su lugar, WAM se basa en el sistema operativo para elegir el momento adecuado para activar la tarea a lo largo del día.</span><span class="sxs-lookup"><span data-stu-id="39854-108">Instead, WAM relies on the operating system to choose the appropriate time to activate the task throughout the day.</span></span> <span data-ttu-id="39854-109">El sistema elige esas horas en función de un impacto mínimo en el usuario, el rendimiento del equipo y la eficacia energética.</span><span class="sxs-lookup"><span data-stu-id="39854-109">The system chooses those times based on minimal impact to the user, PC performance, and energy efficiency.</span></span>

## <a name="how-scheduled-maintenance-works"></a><span data-ttu-id="39854-110">Cómo funciona el mantenimiento programado</span><span class="sxs-lookup"><span data-stu-id="39854-110">How scheduled maintenance works</span></span>

<span data-ttu-id="39854-111">Programador de tareas tareas de mantenimiento son tareas oportunistas que se ejecutan cuando el equipo está inactivo y con corriente alterna.</span><span class="sxs-lookup"><span data-stu-id="39854-111">Task Scheduler maintenance tasks are opportunistic tasks that run when the machine is idle and on AC power.</span></span> <span data-ttu-id="39854-112">Uno de los principales objetivos de las tareas de mantenimiento es minimizar el impacto en el equipo mediante la programación de mantenimiento solo cuando el equipo está conectado a la corriente alterna e inactivo (es decir, cuando no se usa o se aleja del equipo).</span><span class="sxs-lookup"><span data-stu-id="39854-112">One of the major goals of maintenance tasks is to minimize impact to the PC by scheduling maintenance only when the PC is plugged in to AC power and idle (that is, when you're not using, or have stepped away from, the machine).</span></span> <span data-ttu-id="39854-113">Hoy en día, la idea del mantenimiento es que el equipo trabaje con la mínima interrupción para el usuario.</span><span class="sxs-lookup"><span data-stu-id="39854-113">The idea of maintenance today is for the machine to do work with the least disruption to the user.</span></span> <span data-ttu-id="39854-114">Por lo tanto, la hora de mantenimiento de estilo anterior (hablaremos más sobre esto en la sección reactivación **&mdash; diaria de mantenimiento automático** más adelante en este tema) se ha mejorado con el fin de aprovechar estos períodos inactivos.</span><span class="sxs-lookup"><span data-stu-id="39854-114">Hence the old-style maintenance hour (we talk more about this in the **Automatic maintenance&mdash;daily wakeup** section later in this topic) has been improved in order to take advantage of these idle periods.</span></span> <span data-ttu-id="39854-115">Aunque se puede seguir aprovechando la hora de mantenimiento, la ejecución del mantenimiento oportunista es mejor para el mantenimiento del sistema.</span><span class="sxs-lookup"><span data-stu-id="39854-115">While the maintenance hour can still be leveraged, running opportunistic maintenance is better for system health.</span></span>

<span data-ttu-id="39854-116">Es posible que la tarea se encuentre en caso de que el equipo no dedique mucho tiempo a estar inactivos y con corriente alterna.</span><span class="sxs-lookup"><span data-stu-id="39854-116">Your task may be starved if a machine doesn't spend much time both idle and on AC power.</span></span> <span data-ttu-id="39854-117">Asegúrese de que el escenario seguirá proporcionando valor al usuario, incluso si se retrasa.</span><span class="sxs-lookup"><span data-stu-id="39854-117">Make sure that your scenario will still provide value to the user, even if it is delayed.</span></span> <span data-ttu-id="39854-118">Si el usuario está utilizando activamente el equipo, el sistema aplaza el mantenimiento hasta un momento posterior.</span><span class="sxs-lookup"><span data-stu-id="39854-118">If the user is actively using the machine, then the system defers maintenance until a later time.</span></span> <span data-ttu-id="39854-119">El sistema también suspende cualquier tarea de mantenimiento en ejecución si el usuario vuelve a usar el equipo.</span><span class="sxs-lookup"><span data-stu-id="39854-119">The system also suspends any executing maintenance task if the user returns to using the PC.</span></span>

<span data-ttu-id="39854-120">El sistema reinicia una tarea de mantenimiento suspendida durante el siguiente período de inactividad; sin embargo, el sistema no suspenderá ninguna tarea marcada como crítica.</span><span class="sxs-lookup"><span data-stu-id="39854-120">The system restarts a suspended maintenance task during the next idle period; however, the system won't suspend any task marked as critical.</span></span> <span data-ttu-id="39854-121">En su lugar, el sistema permite que se complete una tarea crítica, independientemente de la acción del usuario.</span><span class="sxs-lookup"><span data-stu-id="39854-121">Instead, the system allows a critical task to complete, regardless of user action.</span></span>

<span data-ttu-id="39854-122">Debido a la naturaleza de la programación, es posible que algunas tareas programadas no finalicen: quizás haya demasiados eventos programados para caber en la ventana de mantenimiento de una hora, o quizás el equipo simplemente no esté encendido.</span><span class="sxs-lookup"><span data-stu-id="39854-122">Due to the nature of scheduling, some scheduled tasks may not finish: perhaps there are too many scheduled events to fit into the 1-hour maintenance window, or maybe the computer was simply not turned on.</span></span> <span data-ttu-id="39854-123">En tales casos, puede definir una tarea con una fecha límite.</span><span class="sxs-lookup"><span data-stu-id="39854-123">In such cases, you can define a task with a deadline.</span></span> <span data-ttu-id="39854-124">Una fecha límite se define como un período de tiempo periódico en el que el sistema debe realizar correctamente la tarea al menos una vez.</span><span class="sxs-lookup"><span data-stu-id="39854-124">A deadline is defined as a recurring timeframe in which the system must successfully perform the task at least once.</span></span>

<span data-ttu-id="39854-125">Si una tarea pierde una fecha límite, el programador de mantenimiento seguirá intentando ejecutar la tarea durante la ventana de mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="39854-125">If a task misses a deadline, then the maintenance scheduler will continue to attempt to execute the task during the maintenance window.</span></span> <span data-ttu-id="39854-126">Además, el programador no se limitará a un límite de tiempo de 1 hora normal.</span><span class="sxs-lookup"><span data-stu-id="39854-126">Further, the scheduler will not limit itself to the regular 1-hour time limit.</span></span> <span data-ttu-id="39854-127">En su lugar, el programador amplía la duración de la ventana de mantenimiento para completar la tarea retrasada.</span><span class="sxs-lookup"><span data-stu-id="39854-127">Instead, the scheduler extends the duration of the maintenance window in order to complete the delayed task.</span></span>

<span data-ttu-id="39854-128">Una vez que el sistema completa la tarea (incluso con un código de error de error), el intento se considera correcto.</span><span class="sxs-lookup"><span data-stu-id="39854-128">Once the system completes the task (even with a failure error code), the attempt is considered successful.</span></span> <span data-ttu-id="39854-129">Después de un intento correcto, Scheduler se restablece a la programación de mantenimiento normal e intentará realizar la tarea durante el siguiente período.</span><span class="sxs-lookup"><span data-stu-id="39854-129">After a successful attempt, the scheduler resets to the regular maintenance schedule, and will attempt the task during the next period.</span></span>

## <a name="automatic-maintenancemdashdaily-wakeup"></a><span data-ttu-id="39854-130">Activación diaria de mantenimiento automático &mdash;</span><span class="sxs-lookup"><span data-stu-id="39854-130">Automatic maintenance&mdash;daily wakeup</span></span>

<span data-ttu-id="39854-131">En Windows 7, una tarea de mantenimiento se ejecuta exclusivamente durante la *hora de mantenimiento*, el valor predeterminado es 3 AM y se puede configurar mediante Directiva de grupo.</span><span class="sxs-lookup"><span data-stu-id="39854-131">On Windows 7, a maintenance task runs exclusively during *maintenance hour*, defaulting to 3 AM, and configurable via Group Policy.</span></span> <span data-ttu-id="39854-132">El equipo se reactivará del modo de espera, ejecutará las tareas de mantenimiento y volverá a entrar en suspensión.</span><span class="sxs-lookup"><span data-stu-id="39854-132">The machine would wake up from standby, run maintenance tasks, and go back to sleep.</span></span> <span data-ttu-id="39854-133">Esta sesión diaria se limitó a una duración máxima de 1 hora por intento.</span><span class="sxs-lookup"><span data-stu-id="39854-133">This daily session was limited to a maximum duration of 1 hour per attempt.</span></span> <span data-ttu-id="39854-134">Esto permitiría que el sistema realizara el mantenimiento diariamente, a partir de las 3 AM de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="39854-134">This would allow the system to perform maintenance daily, starting at 3 AM by default.</span></span> <span data-ttu-id="39854-135">Tenga en cuenta que el usuario puede volver a programar la hora a la que se desencadena el mantenimiento mediante la configuración de estas opciones.</span><span class="sxs-lookup"><span data-stu-id="39854-135">Note that the user may re-schedule the time that the maintenance is triggered by configuring these settings.</span></span>

<span data-ttu-id="39854-136">Con la llegada de los equipos portátiles y el intenso enfoque en la duración de la batería, las máquinas ya no están configuradas para permitir la activación S3 en la mayoría de los casos y, por lo general, de Doze a S4 (hibernación) tan pronto como sea posible, para ahorrar batería.</span><span class="sxs-lookup"><span data-stu-id="39854-136">With the advent of laptops, and the heavy focus on battery life, machines are no longer configured to allow S3 wakeup in most circumstances, and generally Doze-To-S4 (hibernate) as soon as possible, to save battery.</span></span> <span data-ttu-id="39854-137">En respuesta a estos cambios, Programador de tareas (> Win7) ejecuta tareas de mantenimiento siempre que están pendientes y el equipo está inactivo y con corriente alterna.</span><span class="sxs-lookup"><span data-stu-id="39854-137">In response to these changes, Task Scheduler (> Win7) runs maintenance tasks whenever they are due, and the machine is idle and on AC power.</span></span>

<span data-ttu-id="39854-138">Esta configuración se puede configurar en el panel de control.</span><span class="sxs-lookup"><span data-stu-id="39854-138">This setting can be configured in Control Panel.</span></span>

<span data-ttu-id="39854-139">Abra el **Panel**  >  **de control sistema y**  >  **seguridad de seguridad y** mantenimiento  >  **mantenimiento automático**.</span><span class="sxs-lookup"><span data-stu-id="39854-139">Open **Control Panel** > **System and Security** > **Security and Maintenance** > **Automatic Maintenance**.</span></span>

<span data-ttu-id="39854-140">Por lo tanto, en función de cómo se configuran las máquinas y las tareas, es posible que el comportamiento de la activación diaria no se produzca de la manera esperada debido a esta nueva configuración.</span><span class="sxs-lookup"><span data-stu-id="39854-140">So based on how your machines and your tasks are configured, the daily wakeup behavior may not occur today as expected because of this new configuration.</span></span> <span data-ttu-id="39854-141">En primer lugar, puede determinar si el equipo es compatible con S3 o compatible con CS (modo de espera conectado).</span><span class="sxs-lookup"><span data-stu-id="39854-141">You can first determine whether your machine is S3 capable or CS (Connected Standby) capable.</span></span>
<span data-ttu-id="39854-142">Para ello, abra un símbolo del sistema de Power Shell con privilegios elevados y ejecute el siguiente comando.</span><span class="sxs-lookup"><span data-stu-id="39854-142">This can be done by opening an elevated power shell prompt, and running the following command.</span></span>

```console
powercfg /a
```

<span data-ttu-id="39854-143">Hora de mantenimiento, si la máquina está configurada correctamente, sigue funcionando, pero si no es así,</span><span class="sxs-lookup"><span data-stu-id="39854-143">Maintenance hour, if the machine is configured correctly, still works, but if it doesn't,</span></span>
  - <span data-ttu-id="39854-144">Compruebe la configuración del BIOS para la configuración de reactivación.</span><span class="sxs-lookup"><span data-stu-id="39854-144">Check your BIOS settings for Wake settings.</span></span> 
  - <span data-ttu-id="39854-145">Compruebe si permitir temporizador de activación está habilitado en las opciones de energía.</span><span class="sxs-lookup"><span data-stu-id="39854-145">Check whether Allow Wake Timer is enabled in Power Options.</span></span>
    <span data-ttu-id="39854-146">Vaya a **Panel de control**  >  opciones **de hardware y sonido**  >  **Opciones de energía**  >  **Editar configuración del plan**  >  **Cambiar configuración avanzada de energía** > haga clic en **suspender**  >  **permitir temporizador de activación**.</span><span class="sxs-lookup"><span data-stu-id="39854-146">Go to **Control Panel** > **Hardware and Sound** > **Power Options** > **Edit Plan Settings** > **Change advanced power settings** > click **Sleep** > **Allow Wake Timer**.</span></span>
  - <span data-ttu-id="39854-147">Compruebe si la tarea programada está configurada con lo siguiente.</span><span class="sxs-lookup"><span data-stu-id="39854-147">Check whether your scheduled task is configured with following.</span></span>
      * <span data-ttu-id="39854-148">MaintenanceSettings: la tarea debe configurarse con período, fecha límite.</span><span class="sxs-lookup"><span data-stu-id="39854-148">MaintenanceSettings: Task should be configured with Period, Deadline.</span></span>
      * <span data-ttu-id="39854-149">Habilitada: la tarea debe estar habilitada.</span><span class="sxs-lookup"><span data-stu-id="39854-149">Enabled: Task should be enabled.</span></span>
      * <span data-ttu-id="39854-150">WakeToRun: la tarea debe tener permiso para reactivar la máquina.</span><span class="sxs-lookup"><span data-stu-id="39854-150">WakeToRun: Task should be allowed to wake the machine.</span></span>
  - <span data-ttu-id="39854-151">Para programar las reactivaciones desde CS, el equipo debe ser compatible con AOAC.</span><span class="sxs-lookup"><span data-stu-id="39854-151">For scheduling wakes from CS, the machine should be AOAC capable.</span></span>
  - <span data-ttu-id="39854-152">Para programar activaciones en máquinas S3,</span><span class="sxs-lookup"><span data-stu-id="39854-152">For scheduling wakes in S3 machines,</span></span>
      * <span data-ttu-id="39854-153">Compruebe si el equipo entró en S3 con corriente alterna.</span><span class="sxs-lookup"><span data-stu-id="39854-153">Check whether the machine went into S3 on AC Power.</span></span>
      * <span data-ttu-id="39854-154">El sistema debe tener **habilitada la reactivación** en Directiva de grupo para el mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="39854-154">The system should have **Wake Enabled** in Group Policy for Maintenance.</span></span>
 
<span data-ttu-id="39854-155">El modo de espera conectado es el estado del sistema que puede escribir un sistema compatible con AOAC.</span><span class="sxs-lookup"><span data-stu-id="39854-155">Connected Standby is the system state that an AOAC-compliant system can enter.</span></span>

<span data-ttu-id="39854-156">Vea las diferencias entre el modo de espera moderno y S3 en el tema [modo de espera moderno frente a S3](/windows-hardware/design/device-experiences/modern-standby-vs-s3).</span><span class="sxs-lookup"><span data-stu-id="39854-156">See differences between Modern Standby and S3 in the topic [Modern Standby vs S3](/windows-hardware/design/device-experiences/modern-standby-vs-s3).</span></span>

## <a name="defining-an-automatic-maintenance-task"></a><span data-ttu-id="39854-157">Definir una tarea de mantenimiento automática</span><span class="sxs-lookup"><span data-stu-id="39854-157">Defining an Automatic Maintenance Task</span></span>

<span data-ttu-id="39854-158">Puede convertir cualquier Programador de tareas tarea en una tarea de mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="39854-158">You can convert any Task Scheduler task to a maintenance task.</span></span> <span data-ttu-id="39854-159">Para ello, debe confirmar que la aplicación se puede suspender.</span><span class="sxs-lookup"><span data-stu-id="39854-159">To do so, you must confirm that your application can be suspended.</span></span> <span data-ttu-id="39854-160">A continuación, debe extender la definición de tarea con los nuevos elementos [**MaintenanceSettings**](taskschedulerschema-maintenancesettings-maintenancesettingstype-element.md) y [**AllowStartOnDemand**](taskschedulerschema-allowstartondemand-settingstype-element.md) .</span><span class="sxs-lookup"><span data-stu-id="39854-160">Then, you must extend the task definition with the new [**MaintenanceSettings**](taskschedulerschema-maintenancesettings-maintenancesettingstype-element.md) and [**AllowStartOnDemand**](taskschedulerschema-allowstartondemand-settingstype-element.md) elements.</span></span>

<span data-ttu-id="39854-161">La principal preocupación de la creación de una tarea de mantenimiento es asegurarse de que el sistema puede suspender y reiniciar la tarea.</span><span class="sxs-lookup"><span data-stu-id="39854-161">The main concern with creating a maintenance task is ensuring that the system can suspend and restart the task.</span></span> <span data-ttu-id="39854-162">Probablemente, el sistema suspenderá una tarea de mantenimiento varias veces; por lo tanto, debe asegurarse de que la aplicación pueda guardar su propio estado y, a continuación, reanudar en un momento arbitrario.</span><span class="sxs-lookup"><span data-stu-id="39854-162">The system will likely suspend a maintenance task multiple times; therefore, you need to ensure that your application is able to save its own state, and then resume at an arbitrary time.</span></span> <span data-ttu-id="39854-163">Esto garantiza que el sistema no realiza la misma parte de la tarea varias veces.</span><span class="sxs-lookup"><span data-stu-id="39854-163">This ensures that the system does not perform the same part of your task repeatedly.</span></span>

<span data-ttu-id="39854-164">Una vez que se haya asegurado de que la aplicación se puede suspender y reanudar correctamente, puede usar los elementos **MaintenanceSettings** y **AllowStartOnDemand** para definir la programación.</span><span class="sxs-lookup"><span data-stu-id="39854-164">Once you have ensured that your application can be suspended and resumed gracefully, you can use the **MaintenanceSettings** and **AllowStartOnDemand** elements to define the schedule.</span></span> <span data-ttu-id="39854-165">**MaintenanceSettings** se define según el período, la fecha límite y la exclusividad.</span><span class="sxs-lookup"><span data-stu-id="39854-165">**MaintenanceSettings** is defined according to the period, deadline, and exclusivity.</span></span>

-   <span data-ttu-id="39854-166">El **período** es obligatorio y define la frecuencia con que se debe realizar la tarea.</span><span class="sxs-lookup"><span data-stu-id="39854-166">The **period** is mandatory, and defines how often the task should occur.</span></span> <span data-ttu-id="39854-167">Normalmente, esto se define en términos de un ciclo de varios días, como "una vez cada 5 días".</span><span class="sxs-lookup"><span data-stu-id="39854-167">Usually, this is defined in terms of a multi-day cycle, such as “once every 5 days”.</span></span> <span data-ttu-id="39854-168">Un período debe ser al menos un día, lo que significa que no se puede programar una tarea para que se produzca varias veces en un día.</span><span class="sxs-lookup"><span data-stu-id="39854-168">A period must be at least one day, meaning that you can't schedule a task to occur multiple times in a day.</span></span>
-   <span data-ttu-id="39854-169">La **fecha límite** es opcional y define cuánto tiempo puede no realizarse el programador para completar la tarea antes de notificar al usuario o realizar el mantenimiento de emergencia.</span><span class="sxs-lookup"><span data-stu-id="39854-169">The **deadline** is optional, and defines how long the scheduler can fail to complete the task before notifying the user or performing emergency maintenance.</span></span> <span data-ttu-id="39854-170">La fecha límite debe ser mayor que el período, lo que significa que el sistema debe tener la oportunidad de intentar la tarea al menos una vez antes de notificar al usuario.</span><span class="sxs-lookup"><span data-stu-id="39854-170">The deadline must be longer than the period, meaning that the system must have the opportunity to attempt the task at least once before notifying the user.</span></span>
-   <span data-ttu-id="39854-171">Además, una tarea de mantenimiento se puede definir opcionalmente como *exclusiva*.</span><span class="sxs-lookup"><span data-stu-id="39854-171">In addition, a maintenance task can optionally be defined as *exclusive*.</span></span> <span data-ttu-id="39854-172">Una tarea exclusiva se ejecuta de forma independiente de otras tareas de mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="39854-172">An exclusive task runs separate from other maintenance tasks.</span></span> <span data-ttu-id="39854-173">Normalmente, una tarea exclusiva es aquella que usa una gran cantidad de recursos, como una gran cantidad de tiempo de CPU o acceso exclusivo a una base de datos.</span><span class="sxs-lookup"><span data-stu-id="39854-173">Usually, an exclusive task is one that uses a great deal of resources, such as a large amount of CPU time, or exclusive access to a database.</span></span> <span data-ttu-id="39854-174">El sistema completa todas las tareas de mantenimiento no exclusivas antes de iniciar una tarea exclusiva.</span><span class="sxs-lookup"><span data-stu-id="39854-174">The system completes all non-exclusive maintenance tasks before starting an exclusive task.</span></span> <span data-ttu-id="39854-175">Por lo tanto, debe declarar una tarea como exclusiva solo cuando sea necesario.</span><span class="sxs-lookup"><span data-stu-id="39854-175">Therefore, you should declare a task as exclusive only when necessary.</span></span>

<span data-ttu-id="39854-176">En cambio, **AllowStartOnDemand** simplemente indica que el sistema o el usuario puede iniciar la tarea en cualquier momento.</span><span class="sxs-lookup"><span data-stu-id="39854-176">In contrast, **AllowStartOnDemand** merely indicates that the system or the user can start the task at any time.</span></span> <span data-ttu-id="39854-177">Esto permite al sistema iniciar la tarea durante el mantenimiento normal.</span><span class="sxs-lookup"><span data-stu-id="39854-177">This allows the system to start the task during regular maintenance.</span></span> <span data-ttu-id="39854-178">De lo contrario, tendría que establecer un desencadenador único para la tarea.</span><span class="sxs-lookup"><span data-stu-id="39854-178">Otherwise, you would have to set a unique trigger for the task.</span></span>
