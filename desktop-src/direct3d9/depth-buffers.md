---
description: Un búfer de profundidad, que a menudo se denomina búfer z o un búfer w, es una propiedad del dispositivo que almacena información de profundidad que se va a usar en Direct3D.
ms.assetid: vs|directx_sdk|~\depth_buffers.htm
title: Búferes de profundidad (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fc1ab41ba98ca5e3b08980ac90a572a19fc8a72a
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/06/2021
ms.locfileid: "104494915"
---
# <a name="depth-buffers-direct3d-9"></a><span data-ttu-id="3fef5-103">Búferes de profundidad (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="3fef5-103">Depth Buffers (Direct3D 9)</span></span>

<span data-ttu-id="3fef5-104">Un búfer de profundidad, que a menudo se denomina búfer z o un búfer w, es una propiedad del dispositivo que almacena información de profundidad que se va a usar en Direct3D.</span><span class="sxs-lookup"><span data-stu-id="3fef5-104">A depth buffer, often called a z-buffer or a w-buffer, is a property of the device that stores depth information to be used by Direct3D.</span></span> <span data-ttu-id="3fef5-105">Cuando Direct3D representa una escena en una superficie de destino, puede usar la memoria en una superficie de búfer de profundidad asociada como área de trabajo para determinar cómo se tapaba los píxeles de los polígonos rasterizados.</span><span class="sxs-lookup"><span data-stu-id="3fef5-105">When Direct3D renders a scene to a target surface, it can use the memory in an associated depth-buffer surface as a workspace to determine how the pixels of rasterized polygons occlude one another.</span></span> <span data-ttu-id="3fef5-106">Direct3D usa una superficie de Direct3D fuera de la pantalla como el destino en el que se escriben los valores finales de color.</span><span class="sxs-lookup"><span data-stu-id="3fef5-106">Direct3D uses an off-screen Direct3D surface as the target to which final color values are written.</span></span> <span data-ttu-id="3fef5-107">La superficie del búfer de profundidad que está asociada con la superficie de representación-destino se usa para almacenar información de profundidad que indica a Direct3D el grado de profundidad de cada píxel visible en la escena.</span><span class="sxs-lookup"><span data-stu-id="3fef5-107">The depth-buffer surface that is associated with the render-target surface is used to store depth information that tells Direct3D how deep each visible pixel is in the scene.</span></span>

<span data-ttu-id="3fef5-108">Cuando una escena se rasteriza con el almacenamiento en búfer de profundidad habilitado, se prueba cada punto de la superficie de representación.</span><span class="sxs-lookup"><span data-stu-id="3fef5-108">When a scene is rasterized with depth buffering enabled, each point on the rendering surface is tested.</span></span> <span data-ttu-id="3fef5-109">Los valores del búfer de profundidad pueden ser la coordenada z de un punto o su coordenada w homogénea, desde la ubicación del punto (x, y, z, w) en el espacio de proyección.</span><span class="sxs-lookup"><span data-stu-id="3fef5-109">The values in the depth buffer can be a point's z-coordinate or its homogeneous w-coordinate - from the point's (x,y,z,w) location in projection space.</span></span> <span data-ttu-id="3fef5-110">Un búfer de profundidad que usa valores z a menudo se denomina búfer z, y uno que usa valores w se denomina búfer w.</span><span class="sxs-lookup"><span data-stu-id="3fef5-110">A depth buffer that uses z values is often called a z-buffer, and one that uses w values is called a w-buffer.</span></span> <span data-ttu-id="3fef5-111">Cada tipo de búfer de profundidad tiene ventajas y desventajas, que se describen más adelante.</span><span class="sxs-lookup"><span data-stu-id="3fef5-111">Each type of depth buffer has advantages and disadvantages, which are discussed later.</span></span>

<span data-ttu-id="3fef5-112">Al principio de la prueba, el valor de profundidad en el búfer de profundidad se establece en el valor más grande posible para la escena.</span><span class="sxs-lookup"><span data-stu-id="3fef5-112">At the beginning of the test, the depth value in the depth buffer is set to the largest possible value for the scene.</span></span> <span data-ttu-id="3fef5-113">El valor de color de la superficie de representación se establece en el valor de color de fondo o en el valor de color de la textura de fondo en ese punto.</span><span class="sxs-lookup"><span data-stu-id="3fef5-113">The color value on the rendering surface is set to either the background color value or the color value of the background texture at that point.</span></span> <span data-ttu-id="3fef5-114">Cada polígono de la escena se prueba para ver si forma una intersección con la coordenada actual (x, y) en la superficie de representación.</span><span class="sxs-lookup"><span data-stu-id="3fef5-114">Each polygon in the scene is tested to see if it intersects with the current coordinate (x,y) on the rendering surface.</span></span> <span data-ttu-id="3fef5-115">Si es así, el valor de profundidad, que será la coordenada z en un búfer z, y la coordenada w en un búfer w-en el punto actual se probará para ver si es menor que el valor de profundidad almacenado en el búfer de profundidad.</span><span class="sxs-lookup"><span data-stu-id="3fef5-115">If it does, the depth value - which will be the z coordinate in a z-buffer, and the w coordinate in a w-buffer - at the current point is tested to see if it is smaller than the depth value stored in the depth buffer.</span></span> <span data-ttu-id="3fef5-116">Si la profundidad del valor de polígono es menor, se almacena en el búfer de profundidad y el valor de color del polígono se escribe en el punto actual de la superficie de representación.</span><span class="sxs-lookup"><span data-stu-id="3fef5-116">If the depth of the polygon value is smaller, it is stored in the depth buffer and the color value from the polygon is written to the current point on the rendering surface.</span></span> <span data-ttu-id="3fef5-117">Si el valor de profundidad del polígono en ese punto es mayor, se prueba el siguiente polígono de la lista.</span><span class="sxs-lookup"><span data-stu-id="3fef5-117">If the depth value of the polygon at that point is larger, the next polygon in the list is tested.</span></span> <span data-ttu-id="3fef5-118">Este proceso se muestra en el diagrama siguiente.</span><span class="sxs-lookup"><span data-stu-id="3fef5-118">This process is shown in the following diagram.</span></span>

![diagrama de valores de profundidad de la prueba](images/zbuffer.png)

> [!Note]  
> <span data-ttu-id="3fef5-120">Aunque la mayoría de las aplicaciones no usan esta característica, puede cambiar la comparación que Direct3D usa para determinar qué valores se colocan en el búfer de profundidad y, posteriormente, la superficie de representación-destino.</span><span class="sxs-lookup"><span data-stu-id="3fef5-120">Although most applications don't use this feature, you can change the comparison that Direct3D uses to determine which values are placed in the depth buffer and subsequently the render-target surface.</span></span> <span data-ttu-id="3fef5-121">Para ello, cambie el valor de D3DRS \_ ZFUNC Render State.</span><span class="sxs-lookup"><span data-stu-id="3fef5-121">To do so, change the value for the D3DRS\_ZFUNC render state.</span></span> <span data-ttu-id="3fef5-122">En el hardware, el cambio de la función de comparación puede deshabilitar las pruebas jerárquicas de z.</span><span class="sxs-lookup"><span data-stu-id="3fef5-122">On some hardware, changing the compare function may disable hierarchical z testing.</span></span>

 

<span data-ttu-id="3fef5-123">Casi todos los aceleradores del mercado admiten el almacenamiento en búfer z, lo que permite almacenar en búfer z el tipo más común de búfer de profundidad actualmente.</span><span class="sxs-lookup"><span data-stu-id="3fef5-123">Nearly all accelerators on the market support z-buffering, making z-buffers the most common type of depth buffer today.</span></span> <span data-ttu-id="3fef5-124">Sin embargo, los búferes z tienen sus desventajas.</span><span class="sxs-lookup"><span data-stu-id="3fef5-124">However ubiquitous, z-buffers have their drawbacks.</span></span> <span data-ttu-id="3fef5-125">Debido a las matemáticas implicadas, los valores z generados en un búfer z tienden a no distribuirse uniformemente en el intervalo del búfer z (normalmente de 0,0 a 1,0, ambos inclusive).</span><span class="sxs-lookup"><span data-stu-id="3fef5-125">Due to the mathematics involved, the generated z values in a z-buffer tend not to be distributed evenly across the z-buffer range (typically 0.0 to 1.0, inclusive).</span></span> <span data-ttu-id="3fef5-126">En concreto, la relación entre los planos de recorte Far y Near afecta de forma muy estricta al modo en que se distribuyen los valores z.</span><span class="sxs-lookup"><span data-stu-id="3fef5-126">Specifically, the ratio between the far and near clipping planes strongly affects how unevenly z values are distributed.</span></span> <span data-ttu-id="3fef5-127">El uso de una distancia de plano lejano a una relación de distancia cercana al plano de 100, 90 por ciento del intervalo del búfer de profundidad se emplea en el primer 10 por ciento del intervalo de profundidad de la escena.</span><span class="sxs-lookup"><span data-stu-id="3fef5-127">Using a far-plane distance to near-plane distance ratio of 100, 90 percent of the depth buffer range is spent on the first 10 percent of the scene depth range.</span></span> <span data-ttu-id="3fef5-128">Las aplicaciones típicas para el entretenimiento o las simulaciones visuales con escenas exteriores suelen requerir coeficientes en el margen o en el plano de un punto entre 1.000 y 10.000.</span><span class="sxs-lookup"><span data-stu-id="3fef5-128">Typical applications for entertainment or visual simulations with exterior scenes often require far-plane/near-plane ratios of anywhere between 1,000 to 10,000.</span></span> <span data-ttu-id="3fef5-129">Con una proporción de 1.000, el 98 por ciento del intervalo se emplea en el primer 2 por ciento del intervalo de profundidad y la distribución se vuelve peor con las proporciones más altas.</span><span class="sxs-lookup"><span data-stu-id="3fef5-129">At a ratio of 1,000, 98 percent of the range is spent on the first 2 percent of the depth range, and the distribution becomes worse with higher ratios.</span></span> <span data-ttu-id="3fef5-130">Esto puede producir artefactos de superficie ocultos en objetos distantes, especialmente cuando se usan búferes de profundidad de 16 bits, la profundidad de bits más admitida.</span><span class="sxs-lookup"><span data-stu-id="3fef5-130">This can cause hidden surface artifacts in distant objects, especially when using 16-bit depth buffers, the most commonly supported bit-depth.</span></span>

<span data-ttu-id="3fef5-131">Un búfer de profundidad basado en w, por otro lado, se distribuye a menudo más uniformemente entre los planos de clips cercanos y alejados que un búfer z.</span><span class="sxs-lookup"><span data-stu-id="3fef5-131">A w-based depth buffer, on the other hand, is often more evenly distributed between the near and far clip planes than a z-buffer.</span></span> <span data-ttu-id="3fef5-132">La principal ventaja es que la relación de las distancias para los planos de recorte lejanos y cercanos ya no es un problema.</span><span class="sxs-lookup"><span data-stu-id="3fef5-132">The key benefit is that the ratio of distances for the far and near clipping planes is no longer an issue.</span></span> <span data-ttu-id="3fef5-133">Esto permite que las aplicaciones admitan grandes intervalos máximos, al tiempo que se sigue obteniendo un almacenamiento en búfer de profundidad relativamente preciso cerca del punto de mira.</span><span class="sxs-lookup"><span data-stu-id="3fef5-133">This allows applications to support large maximum ranges, while still getting relatively accurate depth buffering close to the eye point.</span></span> <span data-ttu-id="3fef5-134">Un búfer de profundidad basado en w no es perfecto y a veces puede mostrar artefactos de superficie ocultos para objetos cercanos.</span><span class="sxs-lookup"><span data-stu-id="3fef5-134">A w-based depth buffer isn't perfect, and can sometimes exhibit hidden surface artifacts for near objects.</span></span> <span data-ttu-id="3fef5-135">Otro inconveniente del enfoque de w-buffered está relacionado con la compatibilidad de hardware: el almacenamiento en búfer de w no se admite en el hardware como almacenamiento en búfer de z.</span><span class="sxs-lookup"><span data-stu-id="3fef5-135">Another drawback to the w-buffered approach is related to hardware support: w-buffering isn't supported as widely in hardware as z-buffering.</span></span>

<span data-ttu-id="3fef5-136">El uso de un búfer z requiere sobrecarga durante la representación.</span><span class="sxs-lookup"><span data-stu-id="3fef5-136">Using a z-buffer requires overhead during rendering.</span></span> <span data-ttu-id="3fef5-137">Se pueden usar varias técnicas para optimizar la representación cuando se utilizan búferes z.</span><span class="sxs-lookup"><span data-stu-id="3fef5-137">Various techniques can be used to optimize rendering when using z-buffers.</span></span> <span data-ttu-id="3fef5-138">Para obtener más información, consulte [Z-buffer performance](performance-optimizations.md).</span><span class="sxs-lookup"><span data-stu-id="3fef5-138">For details, see [Z-Buffer Performance](performance-optimizations.md).</span></span>

> [!Note]  
> <span data-ttu-id="3fef5-139">La interpretación real de un valor de profundidad es específica del representador.</span><span class="sxs-lookup"><span data-stu-id="3fef5-139">The actual interpretation of a depth value is specific to the renderer.</span></span>

 

<span data-ttu-id="3fef5-140">En esta sección se ofrece información sobre el uso de búferes de profundidad para la eliminación de la línea oculta y oculta.</span><span class="sxs-lookup"><span data-stu-id="3fef5-140">This section presents information about using depth buffers for hidden line and hidden surface removal.</span></span>

-   [<span data-ttu-id="3fef5-141">Consultar la compatibilidad de búfer de profundidad (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="3fef5-141">Querying for Depth Buffer Support (Direct3D 9)</span></span>](querying-for-depth-buffer-support.md)
-   [<span data-ttu-id="3fef5-142">Crear un búfer de profundidad (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="3fef5-142">Creating a Depth Buffer (Direct3D 9)</span></span>](creating-a-depth-buffer.md)
-   [<span data-ttu-id="3fef5-143">Habilitar el almacenamiento en búfer de profundidad (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="3fef5-143">Enabling Depth Buffering (Direct3D 9)</span></span>](enabling-depth-buffering.md)
-   [<span data-ttu-id="3fef5-144">Recuperar un búfer de profundidad (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="3fef5-144">Retrieving a Depth Buffer (Direct3D 9)</span></span>](retrieving-a-depth-buffer.md)
-   [<span data-ttu-id="3fef5-145">Borrar búferes de profundidad (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="3fef5-145">Clearing Depth Buffers (Direct3D 9)</span></span>](clearing-depth-buffers.md)
-   [<span data-ttu-id="3fef5-146">Cambiar el acceso de escritura de búfer de profundidad (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="3fef5-146">Changing Depth Buffer Write Access (Direct3D 9)</span></span>](changing-depth-buffer-write-access.md)
-   [<span data-ttu-id="3fef5-147">Cambiar las funciones de comparación de búfer de profundidad (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="3fef5-147">Changing Depth Buffer Comparison Functions (Direct3D 9)</span></span>](changing-depth-buffer-comparison-functions.md)

## <a name="related-topics"></a><span data-ttu-id="3fef5-148">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="3fef5-148">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="3fef5-149">Representación en Direct3D</span><span class="sxs-lookup"><span data-stu-id="3fef5-149">Direct3D Rendering</span></span>](direct3d-rendering.md)
</dt> </dl>

 

 



