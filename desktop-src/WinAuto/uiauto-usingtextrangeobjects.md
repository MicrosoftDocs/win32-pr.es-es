---
title: Usar intervalos de texto
description: En este tema se describe cómo usar las propiedades y los métodos de la interfaz IUIAutomationTextRange para obtener acceso al contenido textual de un control basado en texto y manipularlo.
ms.assetid: 66BC7324-5322-4996-AF62-766936559F0E
keywords:
- clientes, usar objetos de intervalo de texto
- controles basados en texto
- clientes, intervalos de texto
- clients, patrón de control TextRange
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6a2aef7c23db6903e3492fec7c83ba7c14599c63
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "104420959"
---
# <a name="using-text-ranges"></a><span data-ttu-id="39820-107">Usar intervalos de texto</span><span class="sxs-lookup"><span data-stu-id="39820-107">Using Text Ranges</span></span>

<span data-ttu-id="39820-108">En este tema se describe cómo usar las propiedades y los métodos de la interfaz [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) para obtener acceso al contenido textual de un control basado en texto y manipularlo.</span><span class="sxs-lookup"><span data-stu-id="39820-108">This topic describes how to use the properties and methods of the [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) interface to access and manipulate the textual content of a text-based control.</span></span> <span data-ttu-id="39820-109">Contiene las secciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="39820-109">It contains the following sections:</span></span>

-   [<span data-ttu-id="39820-110">¿Qué es un intervalo de texto?</span><span class="sxs-lookup"><span data-stu-id="39820-110">What is a Text Range?</span></span>](#using-text-ranges)
-   [<span data-ttu-id="39820-111">Adquirir objetos de intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="39820-111">Acquiring Text Range Objects</span></span>](#acquiring-text-range-objects)
-   [<span data-ttu-id="39820-112">Seleccionar texto en un intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="39820-112">Selecting Text in a Text Range</span></span>](#selecting-text-in-a-text-range)
-   [<span data-ttu-id="39820-113">Recuperar texto de un intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="39820-113">Retrieving Text from a Text Range</span></span>](#retrieving-text-from-a-text-range)
-   [<span data-ttu-id="39820-114">Recuperación de atributos de texto de un intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="39820-114">Retrieving Text Attributes from a Text Range</span></span>](#retrieving-text-attributes-from-a-text-range)
-   [<span data-ttu-id="39820-115">Recuperar objetos incrustados de un intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="39820-115">Retrieving Embedded Objects from a Text Range</span></span>](#retrieving-embedded-objects-from-a-text-range)
-   [<span data-ttu-id="39820-116">Manipular un intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="39820-116">Manipulating a Text Range</span></span>](#manipulating-a-text-range)
-   [<span data-ttu-id="39820-117">Desplazar un intervalo de texto a la vista</span><span class="sxs-lookup"><span data-stu-id="39820-117">Scrolling a Text Range into View</span></span>](#scrolling-a-text-range-into-view)
-   [<span data-ttu-id="39820-118">Recuperar el elemento envolvente de un intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="39820-118">Retrieving the Enclosing Element of a Text Range</span></span>](#retrieving-the-enclosing-element-of-a-text-range)
-   [<span data-ttu-id="39820-119">Comparar y clonar intervalos de texto</span><span class="sxs-lookup"><span data-stu-id="39820-119">Comparing and Cloning Text Ranges</span></span>](#comparing-and-cloning-text-ranges)
-   [<span data-ttu-id="39820-120">Recuperar anotaciones</span><span class="sxs-lookup"><span data-stu-id="39820-120">Retrieving Annotations</span></span>](#retrieving-annotations)
    -   [<span data-ttu-id="39820-121">Recuperar tipos de anotaciones de un intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="39820-121">Retrieving Annotations Types from a Text Range</span></span>](#retrieving-annotations-types-from-a-text-range)
    -   [<span data-ttu-id="39820-122">Recuperar todas las anotaciones de un intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="39820-122">Retrieving All Annotations from a Text Range</span></span>](#retrieving-all-annotations-from-a-text-range)
    -   [<span data-ttu-id="39820-123">Recuperar información sobre una anotación determinada</span><span class="sxs-lookup"><span data-stu-id="39820-123">Retrieving Information About a Particular Annotation</span></span>](#retrieving-information-about-a-particular-annotation)
    -   [<span data-ttu-id="39820-124">Recuperar el texto de destino de la anotación</span><span class="sxs-lookup"><span data-stu-id="39820-124">Retrieving the Annotation Target Text</span></span>](#retrieving-the-annotation-target-text)
-   [<span data-ttu-id="39820-125">Recuperar estilos visuales</span><span class="sxs-lookup"><span data-stu-id="39820-125">Retrieving Visual Styles</span></span>](#retrieving-visual-styles)
-   [<span data-ttu-id="39820-126">Invocar menús contextuales desde intervalos de texto</span><span class="sxs-lookup"><span data-stu-id="39820-126">Invoking Context Menus From Text Ranges</span></span>](#invoking-context-menus-from-text-ranges)
-   [<span data-ttu-id="39820-127">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="39820-127">Related topics</span></span>](#related-topics)

## <a name="what-is-a-text-range"></a><span data-ttu-id="39820-128">¿Qué es un intervalo de texto?</span><span class="sxs-lookup"><span data-stu-id="39820-128">What is a Text Range?</span></span>

<span data-ttu-id="39820-129">El modelo de objetos de texto de automatización de la interfaz de usuario de Microsoft se basa en el concepto de *intervalo de texto*.</span><span class="sxs-lookup"><span data-stu-id="39820-129">The Microsoft UI Automation text object model is based on the concept of the *text range*.</span></span> <span data-ttu-id="39820-130">Un intervalo de texto es un objeto que expone la interfaz [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) y representa un intervalo contiguo de texto en un control basado en texto.</span><span class="sxs-lookup"><span data-stu-id="39820-130">A text range is an object that exposes the [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) interface, and represents a contiguous span of text in a text-based control.</span></span> <span data-ttu-id="39820-131">Cada intervalo de texto tiene un extremo inicial y un extremo final, y todo el contenido textual entre los dos extremos se considera parte del intervalo.</span><span class="sxs-lookup"><span data-stu-id="39820-131">Each text range has both a starting endpoint and an ending endpoint, and all textual content between the two endpoints is considered part of the range.</span></span> <span data-ttu-id="39820-132">Un intervalo de texto cuyo punto de conexión inicial y final se encuentran en la misma ubicación se denomina intervalo de texto *degenerado* (o vacío).</span><span class="sxs-lookup"><span data-stu-id="39820-132">A text range whose starting endpoint and ending endpoint are at the same location is called a *degenerate* (or empty) text range.</span></span> <span data-ttu-id="39820-133">Un intervalo de texto degenerado se usa para marcar una ubicación concreta en el texto de un control, como la ubicación del punto de inserción de texto.</span><span class="sxs-lookup"><span data-stu-id="39820-133">A degenerate text range is used to mark a specific location within the text of a control, such as the location of the text insertion point.</span></span>

## <a name="acquiring-text-range-objects"></a><span data-ttu-id="39820-134">Adquirir objetos de intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="39820-134">Acquiring Text Range Objects</span></span>

<span data-ttu-id="39820-135">Las aplicaciones cliente adquieren objetos de intervalo de texto mediante las propiedades y los métodos de la interfaz [**IUIAutomationTextPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextpattern) .</span><span class="sxs-lookup"><span data-stu-id="39820-135">Client applications acquire text range objects by using the properties and methods of the [**IUIAutomationTextPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextpattern) interface.</span></span> <span data-ttu-id="39820-136">La propiedad [**IUIAutomationTextRangePattern::D ocumentrange**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-get_documentrange) recupera un intervalo de texto que representa todo el contenido textual de un control basado en texto, mientras que otros métodos adquieren intervalos de texto que representan parte del contenido, como el texto seleccionado, el texto visible o un objeto incrustado en el texto.</span><span class="sxs-lookup"><span data-stu-id="39820-136">The [**IUIAutomationTextRangePattern::DocumentRange**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-get_documentrange) property retrieves a text range that represents the entire textual content of a text-based control, while other methods acquire text ranges that represent some portion of the content, such as the selected text, the visible text, or an object embedded in the text.</span></span>

<span data-ttu-id="39820-137">Los métodos [**IUIAutomationTextRangePattern:: GetVisibleRanges**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-getvisibleranges) y [**getSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-getselection) pueden recuperar matrices de objetos de intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="39820-137">The [**IUIAutomationTextRangePattern::GetVisibleRanges**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-getvisibleranges) and [**GetSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-getselection) methods can retrieve arrays of text range objects.</span></span> <span data-ttu-id="39820-138">Si un control está parcialmente oculto en una ventana superpuesta u otro objeto, **GetVisibleRanges** devuelve una matriz que contiene un objeto de intervalo de texto para cada línea de texto visible parcialmente.</span><span class="sxs-lookup"><span data-stu-id="39820-138">If a control is partially obscured by an overlapping window or other object, **GetVisibleRanges** returns an array containing a text range object for each partially visible line of text.</span></span> <span data-ttu-id="39820-139">Del mismo modo, si un control basado en texto admite la selección de varios intervalos separados de texto, **getSelection** devuelve una matriz que contiene un objeto de intervalo de texto para cada intervalo seleccionado.</span><span class="sxs-lookup"><span data-stu-id="39820-139">Similarly, if a text-based control supports the selection of multiple, disjoint spans of text, **GetSelection** returns an array that contains a text range object for each selected span.</span></span>

<span data-ttu-id="39820-140">El método [**IUIAutomationTextRangePattern:: RangeFromChild**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild) permite a una aplicación cliente recuperar un intervalo de texto que incluye un objeto incrustado en el contenido textual.</span><span class="sxs-lookup"><span data-stu-id="39820-140">The [**IUIAutomationTextRangePattern::RangeFromChild**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild) method enables a client application to retrieve a text range that encloses an object that is embedded in the textual content.</span></span> <span data-ttu-id="39820-141">El cliente especifica el puntero de interfaz [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) de un objeto incrustado, como una imagen, una tabla o un hipervínculo, y el método devuelve un intervalo de texto que incluye el objeto.</span><span class="sxs-lookup"><span data-stu-id="39820-141">The client specifies the [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface pointer of an embedded object, such as an image, a table, or a hyperlink, and the method returns a text range that encloses the object.</span></span> <span data-ttu-id="39820-142">Sin embargo, si el objeto incrustado no tiene ningún texto asociado, el método devuelve un intervalo de texto degenerado.</span><span class="sxs-lookup"><span data-stu-id="39820-142">However, if the embedded object has no text associated with it, the method returns a degenerate text range.</span></span>

<span data-ttu-id="39820-143">Una aplicación cliente puede utilizar el método [**IUIAutomationTextRangePattern:: RangeFromPoint**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) para recuperar un intervalo de texto para el texto visible o el objeto incrustado más próximo a las coordenadas de pantalla especificadas.</span><span class="sxs-lookup"><span data-stu-id="39820-143">A client application can use the [**IUIAutomationTextRangePattern::RangeFromPoint**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) method to retrieve a text range for the visible text or embedded object that is nearest to the specified screen coordinates.</span></span>

## <a name="selecting-text-in-a-text-range"></a><span data-ttu-id="39820-144">Seleccionar texto en un intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="39820-144">Selecting Text in a Text Range</span></span>

<span data-ttu-id="39820-145">La interfaz [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) incluye una serie de métodos que permiten a una aplicación cliente controlar la selección de texto en un control basado en texto.</span><span class="sxs-lookup"><span data-stu-id="39820-145">The [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) interface includes a number of methods that enable a client application to control the selection of text in a text-based control.</span></span>

<span data-ttu-id="39820-146">Las aplicaciones cliente pueden utilizar el método [**IUIAutomationTextRange:: SELECT**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-select) para seleccionar el texto que corresponde a un intervalo de texto y para quitar la selección anterior, si la hubiera, del control de texto.</span><span class="sxs-lookup"><span data-stu-id="39820-146">Client applications can use the [**IUIAutomationTextRange::Select**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-select) method to select the text that corresponds to a text range, and to remove the previous selection, if any, from the text control.</span></span> <span data-ttu-id="39820-147">Al llamar a **Select** con un intervalo de texto degenerado, el punto de inserción se mueve a la ubicación del intervalo de texto sin seleccionar ningún texto.</span><span class="sxs-lookup"><span data-stu-id="39820-147">Calling **Select** with a degenerate text range moves the insertion point to the location of the text range without selecting any text.</span></span>

<span data-ttu-id="39820-148">Si un control admite la selección de varios intervalos separados de texto, un cliente puede usar los métodos [**IUIAutomationTextRange:: AddToSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-addtoselection) y [**RemoveFromSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-removefromselection) para agregar intervalos de texto a y quitarlos de la colección de intervalos de texto seleccionados.</span><span class="sxs-lookup"><span data-stu-id="39820-148">If a control supports the selection of multiple, disjoint spans of text, a client can use the [**IUIAutomationTextRange::AddToSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-addtoselection) and [**RemoveFromSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-removefromselection) methods to add text ranges to, and remove them from, the collection of selected text ranges.</span></span> <span data-ttu-id="39820-149">Si el control solo admite un intervalo de texto seleccionado cada vez, pero la operación de selección produciría la selección de varios intervalos de texto disjuntos, el método devolverá un error **E \_ INVALIDOPERATION** , o bien ampliará o truncará la selección actual.</span><span class="sxs-lookup"><span data-stu-id="39820-149">If the control supports only one selected text range at a time, but the selection operation would result in the selection of multiple disjoint text ranges, the method returns either an **E\_INVALIDOPERATION** error, or extends or truncates the current selection.</span></span> <span data-ttu-id="39820-150">Una aplicación cliente puede detectar si un control admite la selección de uno o varios intervalos de texto, o ninguno, mediante la comprobación de la propiedad [**IUIAutomationTextPattern:: SupportedTextSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-get_supportedtextselection) .</span><span class="sxs-lookup"><span data-stu-id="39820-150">A client application can discover whether a control supports the selection of single or multiple spans of text, or none at all, by checking the [**IUIAutomationTextPattern::SupportedTextSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-get_supportedtextselection) property.</span></span>

<span data-ttu-id="39820-151">Si un control basado en texto admite inserciones de texto, al llamar a [**IUIAutomationTextRange:: AddToSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-addtoselection) o [**RemoveFromSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-removefromselection) en un intervalo de texto degenerado en el control, se mueve el punto de inserción, pero no se selecciona ningún texto.</span><span class="sxs-lookup"><span data-stu-id="39820-151">If a text-based control supports text insertions, calling [**IUIAutomationTextRange::AddToSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-addtoselection) or [**RemoveFromSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-removefromselection) on a degenerate text range in the control moves the insertion point but does not select any text.</span></span>

## <a name="retrieving-text-from-a-text-range"></a><span data-ttu-id="39820-152">Recuperar texto de un intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="39820-152">Retrieving Text from a Text Range</span></span>

<span data-ttu-id="39820-153">Las aplicaciones cliente pueden utilizar el método [**IUIAutomationTextRange:: gettext**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext) para recuperar el texto sin formato de un intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="39820-153">Client applications can use the [**IUIAutomationTextRange::GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext) method to retrieve the plain text of a text range.</span></span> <span data-ttu-id="39820-154">El texto sin formato incluye todos los caracteres de control que se encuentran en el texto de origen, como retornos de carro y la marca de izquierda a derecha (LRM) de Unicode.</span><span class="sxs-lookup"><span data-stu-id="39820-154">The plain text includes all control characters found in the source text, such as carriage returns and the Unicode left-to-right mark (LRM).</span></span> <span data-ttu-id="39820-155">El texto sin formato no incluye etiquetas de marcado, como HTML, que puedan estar presentes en el texto de origen.</span><span class="sxs-lookup"><span data-stu-id="39820-155">The plain text does not include any markup tags such as HTML that may be present in the source text.</span></span> <span data-ttu-id="39820-156">Además, los códigos de escape del texto de origen se convierten en los equivalentes de texto sin formato.</span><span class="sxs-lookup"><span data-stu-id="39820-156">Also, any escape codes in the source text are converted to the plain text equivalents.</span></span> <span data-ttu-id="39820-157">Por ejemplo, " &nbsp; " se convierte en un carácter de espacio simple.</span><span class="sxs-lookup"><span data-stu-id="39820-157">For example, "&nbsp;" is converted to a simple space character.</span></span>

<span data-ttu-id="39820-158">Si un objeto incrustado abarca un intervalo de texto, el texto sin formato incluye el texto interno del objeto, pero no el texto alternativo (la propiedad nombre del objeto incrustado).</span><span class="sxs-lookup"><span data-stu-id="39820-158">If an embedded object spans a range of text, the plain text includes the inner text of the object, but not the alternative text (the name property of the embedded object).</span></span> <span data-ttu-id="39820-159">Para obtener más información, vea [cómo la automatización de la interfaz de usuario expone objetos incrustados](uiauto-textpattern-and-embedded-objects-overview.md).</span><span class="sxs-lookup"><span data-stu-id="39820-159">For more information, see [How UI Automation Exposes Embedded Objects](uiauto-textpattern-and-embedded-objects-overview.md).</span></span>

<span data-ttu-id="39820-160">El método [**IUIAutomationTextRange:: FindText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-findtext) busca en un intervalo de texto una cadena determinada y, si se encuentra, devuelve un nuevo intervalo de texto que abarca la cadena.</span><span class="sxs-lookup"><span data-stu-id="39820-160">The [**IUIAutomationTextRange::FindText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-findtext) method searches a text range for a particular string and, if it is found, returns a new text range that encompasses the string.</span></span>

## <a name="retrieving-text-attributes-from-a-text-range"></a><span data-ttu-id="39820-161">Recuperación de atributos de texto de un intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="39820-161">Retrieving Text Attributes from a Text Range</span></span>

<span data-ttu-id="39820-162">Los atributos de texto determinan el estilo de formato del texto en un control basado en texto e incluyen elementos como el color de primer plano, el estilo de viñeta, el tamaño de fuente, etc.</span><span class="sxs-lookup"><span data-stu-id="39820-162">Text attributes determine the formatting style of the text in a text-based control, and include such things as foreground color, bullet style, font size, and so on.</span></span> <span data-ttu-id="39820-163">La automatización de la interfaz de usuario admite varios atributos de texto y define un identificador para cada atributo admitido.</span><span class="sxs-lookup"><span data-stu-id="39820-163">UI Automation supports a number of text attributes, and defines an identifier for each supported attribute.</span></span> <span data-ttu-id="39820-164">Una aplicación cliente puede consultar un intervalo de texto para el valor de un atributo de texto determinado especificando un identificador de atributo en una llamada al método [**IUIAutomationTextRange:: GetAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue) , junto con un puntero a una estructura [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) que recibe el valor de atributo.</span><span class="sxs-lookup"><span data-stu-id="39820-164">A client application can query a text range for the value of a particular text attribute by specifying an attribute identifier in a call to the [**IUIAutomationTextRange::GetAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue) method, along with a pointer to a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) structure that receives the attribute value.</span></span> <span data-ttu-id="39820-165">Para obtener información detallada sobre cada atributo de texto que admite la automatización de la interfaz de usuario, vea [identificadores de atributos de texto](uiauto-textattribute-ids.md).</span><span class="sxs-lookup"><span data-stu-id="39820-165">For detailed information about each text attribute that UI Automation supports, see [Text Attribute Identifiers](uiauto-textattribute-ids.md).</span></span>

<span data-ttu-id="39820-166">El valor recuperado por [**GetAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue) representa el valor del atributo en todo el intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="39820-166">The value retrieved by [**GetAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue) represents the value of the attribute across the entire text range.</span></span> <span data-ttu-id="39820-167">Si todo el texto del intervalo comparte el mismo valor para el atributo especificado, **GetAttributeValue** devuelve ese valor.</span><span class="sxs-lookup"><span data-stu-id="39820-167">If all text in the range shares the same value for the specified attribute, that value is returned by **GetAttributeValue**.</span></span> <span data-ttu-id="39820-168">Sin embargo, si el valor del atributo varía en el intervalo de texto, **GetAttributeValue** devuelve un puntero [**IUnknown**](/windows/desktop/api/unknwn/nn-unknwn-iunknown) a un objeto de token estático denominado el objeto **ReservedMixedAttribute** .</span><span class="sxs-lookup"><span data-stu-id="39820-168">However, if the value of the attribute varies across the text range, **GetAttributeValue** returns an [**IUnknown**](/windows/desktop/api/unknwn/nn-unknwn-iunknown) pointer to a static token object called the **ReservedMixedAttribute** object.</span></span> <span data-ttu-id="39820-169">Para detectar si el valor de un atributo varía en un intervalo de texto, una aplicación cliente debe comparar los resultados de **GetAttributeValue** con el objeto **ReservedMixedAttribute** recuperado de la propiedad [**IUIAutomation:: ReservedMixedAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_reservedmixedattributevalue) .</span><span class="sxs-lookup"><span data-stu-id="39820-169">To discover whether the value of an attribute varies across a text range, a client application should compare the results of **GetAttributeValue** with the **ReservedMixedAttribute** object retrieved from the [**IUIAutomation::ReservedMixedAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_reservedmixedattributevalue) property.</span></span>

<span data-ttu-id="39820-170">No es necesario un control basado en texto para admitir todos los atributos de texto de automatización de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="39820-170">A text-based control is not required to support all UI Automation text attributes.</span></span> <span data-ttu-id="39820-171">Si un cliente llama al método [**IUIAutomationTextRange:: GetAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue) y pasa el identificador de un atributo no admitido, el método devuelve un puntero [**IUnknown**](/windows/desktop/api/unknwn/nn-unknwn-iunknown) a un objeto de token estático denominado el objeto **ReservedNotSupported** .</span><span class="sxs-lookup"><span data-stu-id="39820-171">If a client calls the [**IUIAutomationTextRange::GetAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue) method and passes the identifier of an unsupported attribute, the method returns an [**IUnknown**](/windows/desktop/api/unknwn/nn-unknwn-iunknown) pointer to a static token object called the **ReservedNotSupported** object.</span></span> <span data-ttu-id="39820-172">Para detectar si se admite un atributo determinado, una aplicación cliente debe comparar los resultados de **GetAttributeValue** con el objeto **ReservedNotSupported** recuperado de la propiedad [**IUIAutomation:: ReservedNotSupportedValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_reservednotsupportedvalue) .</span><span class="sxs-lookup"><span data-stu-id="39820-172">To discover whether a particular attribute is supported, a client application should compare the results of **GetAttributeValue** with the **ReservedNotSupported** object retrieved from the [**IUIAutomation::ReservedNotSupportedValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_reservednotsupportedvalue) property.</span></span>

<span data-ttu-id="39820-173">Las aplicaciones cliente pueden usar el método [**IUIAutomationTextRange:: FindAttribute**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-findattribute) para buscar texto en un intervalo de texto que tiene un atributo de texto determinado.</span><span class="sxs-lookup"><span data-stu-id="39820-173">Client applications can use the [**IUIAutomationTextRange::FindAttribute**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-findattribute) method to search a text range for text that has a particular text attribute.</span></span> <span data-ttu-id="39820-174">Si se encuentra, el método devuelve un nuevo intervalo de texto que abarca el texto coincidente.</span><span class="sxs-lookup"><span data-stu-id="39820-174">If found, the method returns a new text range that encompasses the matching text.</span></span> <span data-ttu-id="39820-175">Tenga en cuenta que **FindAttribute** devuelve un intervalo de texto para buscar texto coincidente aunque el texto no esté visible.</span><span class="sxs-lookup"><span data-stu-id="39820-175">Note that **FindAttribute** returns a text range for matching text even if the text is not visible.</span></span>

## <a name="retrieving-embedded-objects-from-a-text-range"></a><span data-ttu-id="39820-176">Recuperar objetos incrustados de un intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="39820-176">Retrieving Embedded Objects from a Text Range</span></span>

<span data-ttu-id="39820-177">Un intervalo de texto puede incluir objetos incrustados como tablas, imágenes, hipervínculos, etc.</span><span class="sxs-lookup"><span data-stu-id="39820-177">A text range can include embedded objects such as tables, images, hyperlinks, and so on.</span></span> <span data-ttu-id="39820-178">Una aplicación cliente puede recuperar una colección de todos los objetos incrustados en un intervalo llamando al método [**IUIAutomationTextRange:: GetChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren) .</span><span class="sxs-lookup"><span data-stu-id="39820-178">A client application can retrieve a collection of all embedded objects in a range by calling the [**IUIAutomationTextRange::GetChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren) method.</span></span> <span data-ttu-id="39820-179">Los objetos incrustados que se superponen con el intervalo pero que no están totalmente incluidos en él también se incluyen en la colección.</span><span class="sxs-lookup"><span data-stu-id="39820-179">Embedded objects that overlap with the range but are not entirely enclosed by it are also included in the collection.</span></span> <span data-ttu-id="39820-180">Si el intervalo no contiene ningún objeto incrustado, **GetChildren** recupera una colección vacía.</span><span class="sxs-lookup"><span data-stu-id="39820-180">If the range contains no embedded objects, **GetChildren** retrieves an empty collection.</span></span>

<span data-ttu-id="39820-181">Aunque depende del proveedor del control basado en texto, el método [**GetChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren) no devuelve normalmente ningún elemento secundario de los elementos incrustados.</span><span class="sxs-lookup"><span data-stu-id="39820-181">Although it depends on the provider of the text-based control, the [**GetChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren) method typically does not return any children of the embedded elements.</span></span> <span data-ttu-id="39820-182">Por ejemplo, si un intervalo de texto contiene una tabla que tiene un número de celdas secundarias, el método **GetChildren** normalmente solo devuelve el elemento TABLE y no los elementos Cell.</span><span class="sxs-lookup"><span data-stu-id="39820-182">For example, if a text range contains a table that has a number of child cells, the **GetChildren** method typically returns just the table element and not the cell elements.</span></span>

<span data-ttu-id="39820-183">Por motivos de rendimiento o de arquitectura, [**GetChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren) no puede recuperar objetos [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) para todos los objetos incrustados en un intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="39820-183">For performance or architectural reasons, [**GetChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren) may not be able to retrieve [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) objects for all embedded objects in a text range.</span></span> <span data-ttu-id="39820-184">En su lugar, el proveedor puede devolver una colección que incluye elementos virtualizados.</span><span class="sxs-lookup"><span data-stu-id="39820-184">Instead, the provider might return a collection that includes virtualized items.</span></span> <span data-ttu-id="39820-185">Para obtener más información, vea [trabajar con elementos virtualizados](uiauto-workingwithvirtualizeditems.md).</span><span class="sxs-lookup"><span data-stu-id="39820-185">For more information, see [Working with Virtualized Items](uiauto-workingwithvirtualizeditems.md).</span></span>

## <a name="manipulating-a-text-range"></a><span data-ttu-id="39820-186">Manipular un intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="39820-186">Manipulating a Text Range</span></span>

<span data-ttu-id="39820-187">La interfaz [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) proporciona varios métodos para manipular y navegar por los intervalos de texto en un control basado en texto.</span><span class="sxs-lookup"><span data-stu-id="39820-187">The [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) interface provides several methods for manipulating and navigating text ranges in a text-based control.</span></span> <span data-ttu-id="39820-188">Los métodos [**IUIAutomationTextRange:: Move**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move), [**MoveEndpointByUnit**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-moveendpointbyunit)y [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-expandtoenclosingunit) mueven un intervalo de texto o uno de sus extremos por la unidad de texto especificada, como carácter, palabra, párrafo, etc.</span><span class="sxs-lookup"><span data-stu-id="39820-188">The [**IUIAutomationTextRange::Move**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move), [**MoveEndpointByUnit**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-moveendpointbyunit), and [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-expandtoenclosingunit) methods move a text range or one of its endpoints by the specified text unit, such as character, word, paragraph, and so on.</span></span> <span data-ttu-id="39820-189">Para obtener más información, consulte [UI Automation Text Units](/windows/desktop/WinAuto/uiauto-uiautomationtextunits).</span><span class="sxs-lookup"><span data-stu-id="39820-189">For more information, see [UI Automation Text Units](/windows/desktop/WinAuto/uiauto-uiautomationtextunits).</span></span>

<span data-ttu-id="39820-190">A pesar de su nombre, el método [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-expandtoenclosingunit) no expande necesariamente un intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="39820-190">Despite its name, the [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-expandtoenclosingunit) method does not necessarily expand a text range.</span></span> <span data-ttu-id="39820-191">En su lugar, "normaliza" un intervalo de texto moviendo los puntos de conexión para que el intervalo abarque exactamente la unidad de texto especificada.</span><span class="sxs-lookup"><span data-stu-id="39820-191">Instead, it "normalizes" a text range by moving the endpoints so that the range encompasses the specified text unit exactly.</span></span> <span data-ttu-id="39820-192">El intervalo se expande si es menor que la unidad especificada o se acorta si es mayor que la unidad especificada.</span><span class="sxs-lookup"><span data-stu-id="39820-192">The range is expanded if it is smaller than the specified unit, or shortened if it is longer than the specified unit.</span></span> <span data-ttu-id="39820-193">En el diagrama siguiente se muestra cómo **ExpandToEnclosingUnit** normaliza un intervalo de texto moviendo los extremos del intervalo.</span><span class="sxs-lookup"><span data-stu-id="39820-193">The following diagram shows how **ExpandToEnclosingUnit** normalizes a text range by moving the endpoints of the range.</span></span>

![diagrama que muestra las posiciones de punto de conexión antes y después de una llamada a expandtoenclosingunit](images/expandtoenclosingunit.jpg)

<span data-ttu-id="39820-195">Si el intervalo de texto comienza al principio de una unidad de texto y termina al principio del límite de unidad de texto siguiente, o antes, el extremo final se mueve al siguiente límite de unidad de texto (vea 1 y 2 en la ilustración anterior).</span><span class="sxs-lookup"><span data-stu-id="39820-195">If the text range starts at the beginning of a text unit and ends at the beginning of, or before, the next text unit boundary, the ending endpoint is moved to the next text unit boundary (see 1 and 2 in the previous illustration).</span></span>

<span data-ttu-id="39820-196">Si el intervalo de texto comienza al principio de una unidad de texto y termina en el siguiente límite de unidad, o después, el extremo final permanece o se mueve hacia atrás hasta el siguiente límite de unidad después del punto de conexión de inicio (vea 3 y 4 en la ilustración anterior).</span><span class="sxs-lookup"><span data-stu-id="39820-196">If the text range starts at the beginning of a text unit and ends at, or after, the next unit boundary, the ending endpoint stays or is moved backward to the next unit boundary after the starting endpoint (see 3 and 4 in the previous illustration).</span></span> <span data-ttu-id="39820-197">Si hay más de un límite de unidad de texto entre los puntos de conexión inicial y final, el extremo final se desplaza hacia atrás hasta el siguiente límite de unidad después del punto de conexión de inicio, lo que da lugar a un intervalo de texto que es una unidad de texto de longitud.</span><span class="sxs-lookup"><span data-stu-id="39820-197">If there is more than one text unit boundary between the starting and ending endpoints, the ending endpoint is moved backward to the next unit boundary after the starting endpoint, resulting in a text range that is one text unit in length.</span></span>

<span data-ttu-id="39820-198">Si el intervalo de texto se inicia en medio de una unidad de texto, el punto de conexión inicial se desplaza hacia atrás hasta el principio de la unidad de texto y el extremo final se mueve hacia delante o hacia atrás, según sea necesario, al siguiente límite de unidad después del punto de conexión de inicio (vea 5 a 8 en la ilustración anterior).</span><span class="sxs-lookup"><span data-stu-id="39820-198">If the text range starts in the middle of a text unit, the starting endpoint is moved backward to the beginning of the text unit, and the ending endpoint is moved forward or backward, as necessary, to the next unit boundary after the starting endpoint (see 5 through 8 in the previous illustration).</span></span>

<span data-ttu-id="39820-199">Cuando se llama al método [**IUIAutomationTextRange:: Move**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move) , el proveedor normaliza el intervalo de texto por la unidad de texto especificada.</span><span class="sxs-lookup"><span data-stu-id="39820-199">When the [**IUIAutomationTextRange::Move**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move) method is called, the provider normalizes the text range by the specified text unit.</span></span> <span data-ttu-id="39820-200">A continuación, el proveedor mueve el intervalo hacia atrás o hacia delante el número especificado de unidades de texto.</span><span class="sxs-lookup"><span data-stu-id="39820-200">Then, the provider moves the range backward or forward by the specified number of text units.</span></span> <span data-ttu-id="39820-201">Al mover el intervalo, el proveedor omite los límites de los objetos incrustados en el texto.</span><span class="sxs-lookup"><span data-stu-id="39820-201">When moving the range, the provider ignores the boundaries of any embedded objects in the text.</span></span> <span data-ttu-id="39820-202">(Sin embargo, el propio límite de unidad puede verse afectado por la existencia de un objeto incrustado).</span><span class="sxs-lookup"><span data-stu-id="39820-202">(However, the unit boundary itself may be affected by the existence of an embedded object).</span></span> <span data-ttu-id="39820-203">En el diagrama siguiente se muestra cómo el método **Move** mueve un intervalo de texto, unidad por unidad, entre los objetos incrustados y los límites de la unidad de texto.</span><span class="sxs-lookup"><span data-stu-id="39820-203">The following diagram demonstrates how the **Move** method moves a text range, unit by unit, across embedded objects and text unit boundaries.</span></span>

![diagrama que muestra cómo el método move mueve los extremos de intervalo entre los límites de unidad de texto y objeto](images/move.jpg)

<span data-ttu-id="39820-205">El método [**IUIAutomationTextRange:: MoveEndpointByUnit**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-moveendpointbyunit) mueve uno de los extremos hacia delante o hacia atrás por la unidad de texto especificada.</span><span class="sxs-lookup"><span data-stu-id="39820-205">The [**IUIAutomationTextRange::MoveEndpointByUnit**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-moveendpointbyunit) method moves one of the endpoints forward or backward by specified text unit.</span></span> <span data-ttu-id="39820-206">En la ilustración siguiente se muestra cómo se mueve un punto de conexión hacia delante.</span><span class="sxs-lookup"><span data-stu-id="39820-206">The following illustration shows how an endpoint moves forward.</span></span>

![diagrama que muestra cómo moveendpointbyunit mueve el punto de conexión de un intervalo](images/moveendpointbyunit.gif)

<span data-ttu-id="39820-208">El método [**IUIAutomationTextRange:: MoveEndpointByRange**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-moveendpointbyrange) permite a una aplicación cliente establecer un punto de conexión de un intervalo de texto en la misma ubicación que el punto de conexión especificado de un segundo intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="39820-208">The [**IUIAutomationTextRange::MoveEndpointByRange**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-moveendpointbyrange) method enables a client application to set one endpoint of a text range to same location as the specified endpoint of a second text range.</span></span>

## <a name="scrolling-a-text-range-into-view"></a><span data-ttu-id="39820-209">Desplazar un intervalo de texto a la vista</span><span class="sxs-lookup"><span data-stu-id="39820-209">Scrolling a Text Range into View</span></span>

<span data-ttu-id="39820-210">El método [**IUIAutomationTextRange:: ScrollIntoView**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-scrollintoview) desplaza un intervalo de texto para que el texto esté visible en la ventanilla del control basado en texto.</span><span class="sxs-lookup"><span data-stu-id="39820-210">The [**IUIAutomationTextRange::ScrollIntoView**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-scrollintoview) method scrolls a text range so that the text is visible in the viewport of the text-based control.</span></span> <span data-ttu-id="39820-211">Al llamar a **ScrollIntoView**, un cliente puede especificar si el texto debe estar alineado con la parte superior o inferior de la ventanilla.</span><span class="sxs-lookup"><span data-stu-id="39820-211">When calling **ScrollIntoView**, a client can specify whether the text should be aligned with the top or bottom of the viewport.</span></span>

## <a name="retrieving-the-enclosing-element-of-a-text-range"></a><span data-ttu-id="39820-212">Recuperar el elemento envolvente de un intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="39820-212">Retrieving the Enclosing Element of a Text Range</span></span>

<span data-ttu-id="39820-213">Una aplicación cliente puede usar el método [**IUIAutomationTextRange:: GetEnclosingElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement) para recuperar el puntero de interfaz [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) del elemento más interno que incluye un intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="39820-213">A client application can use the [**IUIAutomationTextRange::GetEnclosingElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement) method to retrieve the [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) interface pointer of the innermost element that encloses a text range.</span></span> <span data-ttu-id="39820-214">Normalmente, el elemento envolvente es el proveedor de texto que proporciona el intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="39820-214">The enclosing element is typically the text provider that supplies the text range.</span></span> <span data-ttu-id="39820-215">Sin embargo, si el proveedor de texto admite elementos secundarios como tablas o hipervínculos, el elemento envolvente podría ser un descendiente del proveedor de texto.</span><span class="sxs-lookup"><span data-stu-id="39820-215">However, if the text provider supports child elements such as tables or hyperlinks, the enclosing element could be a descendant of the text provider.</span></span>

## <a name="comparing-and-cloning-text-ranges"></a><span data-ttu-id="39820-216">Comparar y clonar intervalos de texto</span><span class="sxs-lookup"><span data-stu-id="39820-216">Comparing and Cloning Text Ranges</span></span>

<span data-ttu-id="39820-217">La interfaz [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) incluye dos métodos para comparar los intervalos de texto.</span><span class="sxs-lookup"><span data-stu-id="39820-217">The [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) interface includes two methods for comparing text ranges.</span></span> <span data-ttu-id="39820-218">El método [**IUIAutomationTextRange:: Compare**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-compareendpoints) compara los extremos inicial y final de dos intervalos de texto y devuelve **true** si ambos extremos son iguales.</span><span class="sxs-lookup"><span data-stu-id="39820-218">The [**IUIAutomationTextRange::Compare**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-compareendpoints) method compares the starting and ending endpoints of two text ranges and returns **TRUE** if both endpoints are the same.</span></span> <span data-ttu-id="39820-219">El método **IUIAutomationTextRange:: CompareEndpoints** compara el punto de conexión inicial o final de los dos intervalos.</span><span class="sxs-lookup"><span data-stu-id="39820-219">The **IUIAutomationTextRange::CompareEndpoints** method compares either the start or the ending endpoint of the two ranges.</span></span> <span data-ttu-id="39820-220">El valor devuelto es cero si los extremos son iguales, o un valor positivo o negativo que indica las posiciones relativas de los dos extremos.</span><span class="sxs-lookup"><span data-stu-id="39820-220">The return value is zero if the endpoints are the same, or a positive value or negative value that indicates the relative positions of the two endpoints.</span></span>

<span data-ttu-id="39820-221">Las aplicaciones cliente pueden utilizar el método [**IUIAutomationTextRange:: Clone**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-clone) para crear una copia exacta del intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="39820-221">Client applications can use the [**IUIAutomationTextRange::Clone**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-clone) method to create an exact copy of text range.</span></span> <span data-ttu-id="39820-222">El nuevo intervalo de texto se puede manipular independientemente del intervalo de texto original.</span><span class="sxs-lookup"><span data-stu-id="39820-222">The new text range can be manipulated independently of the original text range.</span></span>

## <a name="retrieving-annotations"></a><span data-ttu-id="39820-223">Recuperar anotaciones</span><span class="sxs-lookup"><span data-stu-id="39820-223">Retrieving Annotations</span></span>

<span data-ttu-id="39820-224">Un intervalo de texto puede incluir anotaciones si el control basado en texto las admite.</span><span class="sxs-lookup"><span data-stu-id="39820-224">A text range can include annotations if the text-based control supports them.</span></span> <span data-ttu-id="39820-225">Hay muchos tipos diferentes de anotaciones.</span><span class="sxs-lookup"><span data-stu-id="39820-225">There are many different kinds of annotations.</span></span> <span data-ttu-id="39820-226">El archivo de encabezado UIAutomationClient. h define un conjunto de valores constantes con nombre que identifican los tipos de anotaciones que admite la automatización de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="39820-226">The UIAutomationClient.h header file defines a set of named constant values that identify the types of annotations that UI Automation supports.</span></span> <span data-ttu-id="39820-227">Para obtener más información, vea [**identificadores de tipo de anotación**](uiauto-annotation-type-identifiers.md).</span><span class="sxs-lookup"><span data-stu-id="39820-227">For more information, see [**Annotation Type Identifiers**](uiauto-annotation-type-identifiers.md).</span></span>

<span data-ttu-id="39820-228">Algunos tipos de anotaciones se representan mediante un elemento de automatización que admite el patrón de control [Annotation](uiauto-implementingannotation.md) (interfaz [**IUIAutomationAnnotationPattern**](/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationannotationpattern) ).</span><span class="sxs-lookup"><span data-stu-id="39820-228">Some kinds of annotations are represented by an automation element that supports the [Annotation](uiauto-implementingannotation.md) control pattern ([**IUIAutomationAnnotationPattern**](/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationannotationpattern) interface).</span></span> <span data-ttu-id="39820-229">Otros tipos de anotaciones se exponen a través del patrón de control [TextRange](uiauto-about-text-and-textrange-patterns.md) .</span><span class="sxs-lookup"><span data-stu-id="39820-229">Other kinds of annotations are exposed through the [TextRange](uiauto-about-text-and-textrange-patterns.md) control pattern.</span></span> <span data-ttu-id="39820-230">Por ejemplo, un proveedor podría exponer un indicador de error ortográfico simple al hacer que el método [**IUIAutomationTextRange:: GetAttributeValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getattributevalue) devuelva un atributo de texto [**AnnotationTypes**](uiauto-textattribute-ids.md) de [**AnnotationType \_ SpellingError**](uiauto-annotation-type-identifiers.md)y un valor null para el atributo de texto [**AnnotationObjects**](uiauto-textattribute-ids.md) .</span><span class="sxs-lookup"><span data-stu-id="39820-230">For example, a provider could expose a simple spelling-error indicator by having the [**IUIAutomationTextRange::GetAttributeValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getattributevalue) method return an [**AnnotationTypes**](uiauto-textattribute-ids.md) text attribute of [**AnnotationType\_SpellingError**](uiauto-annotation-type-identifiers.md), and a null value for the [**AnnotationObjects**](uiauto-textattribute-ids.md) text attribute.</span></span>

### <a name="retrieving-annotations-types-from-a-text-range"></a><span data-ttu-id="39820-231">Recuperar tipos de anotaciones de un intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="39820-231">Retrieving Annotations Types from a Text Range</span></span>

<span data-ttu-id="39820-232">Puede recuperar una lista de los tipos de anotaciones que se encuentran en un intervalo de texto mediante el método [**IUIAutomationTextRange:: GetAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue) .</span><span class="sxs-lookup"><span data-stu-id="39820-232">You can retrieve a list of the types of annotations that are present in a text range by using the [**IUIAutomationTextRange::GetAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue) method.</span></span> <span data-ttu-id="39820-233">Al llamar al método, especifique un identificador de atributo de texto de [**UIA \_ AnnotationTypesAttributeId**](uiauto-textattribute-ids.md) y un puntero a un parámetro de tipo [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant).</span><span class="sxs-lookup"><span data-stu-id="39820-233">When calling the method, specify a text attribute ID of [**UIA\_AnnotationTypesAttributeId**](uiauto-textattribute-ids.md) and a pointer to a parameter of type [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant).</span></span> <span data-ttu-id="39820-234">Cuando el método devuelve, el parámetro **Variant** contiene una lista de identificadores de tipo de anotación, uno para cada tipo de anotación en el intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="39820-234">When the method returns, the **VARIANT** parameter contains a list of annotation type identifiers, one for each type of annotation in the text range.</span></span> <span data-ttu-id="39820-235">Para obtener más información, vea [**identificadores de tipo de anotación**](uiauto-annotation-type-identifiers.md).</span><span class="sxs-lookup"><span data-stu-id="39820-235">For more information, see [**Annotation Type Identifiers**](uiauto-annotation-type-identifiers.md).</span></span>

### <a name="retrieving-all-annotations-from-a-text-range"></a><span data-ttu-id="39820-236">Recuperar todas las anotaciones de un intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="39820-236">Retrieving All Annotations from a Text Range</span></span>

<span data-ttu-id="39820-237">Para recuperar las anotaciones de un intervalo de texto, llame al método [**IUIAutomationTextRange:: GetAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue) , especificando un identificador de atributo de texto de [**UIA \_ AnnotationObjectsAttributeId**](uiauto-textattribute-ids.md) y un puntero a un parámetro de tipo [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant).</span><span class="sxs-lookup"><span data-stu-id="39820-237">To retrieve the annotations from a text range, call the [**IUIAutomationTextRange::GetAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue) method, specifying a text attribute ID of [**UIA\_AnnotationObjectsAttributeId**](uiauto-textattribute-ids.md) and a pointer to a parameter of type [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant).</span></span> <span data-ttu-id="39820-238">Cuando el método devuelve un valor, el parámetro **Variant** contiene una interfaz [**IUIAutomationElementArray**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelementarray) que representa una matriz de elementos de automatización, uno para cada anotación en el intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="39820-238">When the method returns, the **VARIANT** parameter contains an [**IUIAutomationElementArray**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelementarray) interface that represents an array of automation elements, one for each annotation in the text range.</span></span> <span data-ttu-id="39820-239">La propiedad [**IUIAutomationElementArray:: length**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelementarray-get_length) indica el número de elementos de la matriz y el método [**IUIAutomationElementArray:: GetElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelementarray-getelement) recupera la interfaz [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) para un elemento determinado.</span><span class="sxs-lookup"><span data-stu-id="39820-239">The [**IUIAutomationElementArray::Length**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelementarray-get_length) property indicates the number of elements in the array, and the [**IUIAutomationElementArray::GetElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelementarray-getelement) method retrieves the [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface for a particular element.</span></span>

### <a name="retrieving-information-about-a-particular-annotation"></a><span data-ttu-id="39820-240">Recuperar información sobre una anotación determinada</span><span class="sxs-lookup"><span data-stu-id="39820-240">Retrieving Information About a Particular Annotation</span></span>

<span data-ttu-id="39820-241">Para recuperar información sobre una anotación determinada, recupere primero la interfaz [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) para el elemento Annotation tal y como se describe en la sección anterior.</span><span class="sxs-lookup"><span data-stu-id="39820-241">To retrieve information about a particular annotation, first retrieve the [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface for the annotation element as described in the previous section.</span></span> <span data-ttu-id="39820-242">A continuación, recupere la interfaz [**IUIAutomationAnnotationPattern**](/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationannotationpattern) para la anotación llamando al método [**IUIAutomationElement:: GETCURRENTPATTERNAS**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpatternas) con un identificador de patrón de control de [**UIA \_ AnnotationPatternId**](uiauto-controlpattern-ids.md), un identificador de interfaz de IID \_ IUIAutomationAnnotationPattern y la dirección de una variable que recibe el puntero **IUIAutomationAnnotation** para la anotación.</span><span class="sxs-lookup"><span data-stu-id="39820-242">Next, retrieve the [**IUIAutomationAnnotationPattern**](/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationannotationpattern) interface for the annotation by calling the [**IUIAutomationElement::GetCurrentPatternAs**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpatternas) method with a control pattern ID of [**UIA\_AnnotationPatternId**](uiauto-controlpattern-ids.md), an interface identifier of IID\_IUIAutomationAnnotationPattern, and the address of a variable that receives the **IUIAutomationAnnotation** pointer for the annotation.</span></span> <span data-ttu-id="39820-243">Consulte las propiedades de la interfaz **IUIAutomationAnnotation** para recuperar el nombre del tipo de anotación y el identificador de tipo, el nombre del autor de la anotación, la fecha y hora de la anotación y la interfaz **IUIAutomationElement** para el elemento que se va a anotar.</span><span class="sxs-lookup"><span data-stu-id="39820-243">Query the properties of the **IUIAutomationAnnotation** interface to retrieve the annotation type name and type ID, the name of the annotation author, the date and time of the annotation, and the **IUIAutomationElement** interface for the element that is being annotated.</span></span>

### <a name="retrieving-the-annotation-target-text"></a><span data-ttu-id="39820-244">Recuperar el texto de destino de la anotación</span><span class="sxs-lookup"><span data-stu-id="39820-244">Retrieving the Annotation Target Text</span></span>

<span data-ttu-id="39820-245">Normalmente, una anotación se aplica a algún subconjunto del texto de un intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="39820-245">Typically, an annotation applies to some subset of the text in a text range.</span></span> <span data-ttu-id="39820-246">Después de recuperar la interfaz [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) para una anotación, puede pasar la interfaz al método [**IUIAutomationTextRange2:: RangeFromAnnotation**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider2-rangefromannotation) para recuperar un intervalo de texto que contiene el texto que es el destino de la anotación.</span><span class="sxs-lookup"><span data-stu-id="39820-246">After you retrieve the [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface for an annotation, you can pass the interface to the [**IUIAutomationTextRange2::RangeFromAnnotation**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider2-rangefromannotation) method to retrieve a text range that contains the text that is the target of the annotation.</span></span>

## <a name="retrieving-visual-styles"></a><span data-ttu-id="39820-247">Recuperar estilos visuales</span><span class="sxs-lookup"><span data-stu-id="39820-247">Retrieving Visual Styles</span></span>

<span data-ttu-id="39820-248">Un proveedor implementa el patrón de control de [estilos](/windows/desktop/WinAuto/uiauto-implementingstyles) para describir un elemento de la interfaz de usuario que tiene un estilo, color de relleno, patrón de relleno o forma específicos.</span><span class="sxs-lookup"><span data-stu-id="39820-248">A provider implements the [Styles](/windows/desktop/WinAuto/uiauto-implementingstyles) control pattern to describe a UI element that has a specific style, fill color, fill pattern, or shape.</span></span> <span data-ttu-id="39820-249">Esto es especialmente útil cuando se describen los elementos de un documento, que suelen tener tales estilos.</span><span class="sxs-lookup"><span data-stu-id="39820-249">This is especially useful when describing elements in a document, which frequently have such styles.</span></span> <span data-ttu-id="39820-250">Los estilos como esto suelen llevar información útil para los clientes con discapacidades. por ejemplo, los estilos pueden describir una cadena determinada como título de un documento o un objeto de diagrama de flujo determinado como un rombo o un círculo.</span><span class="sxs-lookup"><span data-stu-id="39820-250">Styles like this often carry information that is useful for customers with disabilities; for example, styles can describe a certain string as the title of a document, or a certain flowchart object as a diamond or a circle.</span></span>

<span data-ttu-id="39820-251">Puede usar el método [**IUIAutomationTextRange:: GetAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue) para recuperar los nombres y los identificadores de los estilos visuales que se usan en un intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="39820-251">You can use the [**IUIAutomationTextRange::GetAttributeValue**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getattributevalue) method to retrieve the names and identifiers of the visual styles that are used in a text range.</span></span> <span data-ttu-id="39820-252">Use el atributo de texto [**UIA \_ StyleNameAttributeId**](uiauto-textattribute-ids.md) para recuperar los nombres de estilo y [**UIA \_ StyleIdAttributeId**](uiauto-textattribute-ids.md) para recuperar los identificadores de estilo.</span><span class="sxs-lookup"><span data-stu-id="39820-252">Use the [**UIA\_StyleNameAttributeId**](uiauto-textattribute-ids.md) text attribute to retrieve the style names, and [**UIA\_StyleIdAttributeId**](uiauto-textattribute-ids.md) to retrieve the style identifiers.</span></span>

<span data-ttu-id="39820-253">Un control basado en texto que admite estilos visuales puede implementar el patrón de control [styles](/windows/desktop/WinAuto/uiauto-implementingstyles) para permitir que los clientes tengan acceso a información sobre un estilo visual utilizado por el control.</span><span class="sxs-lookup"><span data-stu-id="39820-253">A text-based control that supports visual styles can implement the [Styles](/windows/desktop/WinAuto/uiauto-implementingstyles) control pattern to enable clients to access information about a visual style used by the control.</span></span> <span data-ttu-id="39820-254">Los clientes acceden al patrón de control de estilos a través de la interfaz [**IUIAutomationStylesPattern**](/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationstylespattern) .</span><span class="sxs-lookup"><span data-stu-id="39820-254">Clients access the Styles control pattern through the [**IUIAutomationStylesPattern**](/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationstylespattern) interface.</span></span> <span data-ttu-id="39820-255">Puede recuperar esta interfaz llamando al método [**IUIAutomationElement:: GetCurrentPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpattern) o [**GetCurrentPatternAs**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpatternas) , especificando [**UIA \_ StylesPatternId**](uiauto-controlpattern-ids.md) como identificador de patrón de control.</span><span class="sxs-lookup"><span data-stu-id="39820-255">You can retrieve this interface by calling the [**IUIAutomationElement::GetCurrentPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpattern) or [**GetCurrentPatternAs**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpatternas) method, specifying [**UIA\_StylesPatternId**](uiauto-controlpattern-ids.md) as the control pattern identifier.</span></span>

<span data-ttu-id="39820-256">La interfaz [**IUIAutomationStylesPattern**](/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationstylespattern) incluye propiedades y métodos que proporcionan la siguiente información sobre un estilo visual:</span><span class="sxs-lookup"><span data-stu-id="39820-256">The [**IUIAutomationStylesPattern**](/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationstylespattern) interface includes properties and methods that provide the following information about a visual style:</span></span>

-   <span data-ttu-id="39820-257">Nombre del estilo visual, como "normal" o "título 1".</span><span class="sxs-lookup"><span data-stu-id="39820-257">The name of the visual style, such as "Normal" or "Heading 1".</span></span>
-   <span data-ttu-id="39820-258">Identificador del estilo visual.</span><span class="sxs-lookup"><span data-stu-id="39820-258">The identifier of the visual style.</span></span> <span data-ttu-id="39820-259">Para obtener más información, vea [**identificadores de estilo**](uiauto-style-identifiers.md).</span><span class="sxs-lookup"><span data-stu-id="39820-259">For more information, see [**Style Identifiers**](uiauto-style-identifiers.md).</span></span>
-   <span data-ttu-id="39820-260">Color usado para rellenar el control basado en texto.</span><span class="sxs-lookup"><span data-stu-id="39820-260">The color used to fill the text-based control.</span></span>
-   <span data-ttu-id="39820-261">Color del patrón que se usa para rellenar el control basado en texto.</span><span class="sxs-lookup"><span data-stu-id="39820-261">The color of the pattern used to fill the text-based control.</span></span>
-   <span data-ttu-id="39820-262">Forma del control basado en texto.</span><span class="sxs-lookup"><span data-stu-id="39820-262">The shape of the text-based control.</span></span>
-   <span data-ttu-id="39820-263">Propiedades extendidas; es decir, una lista de nombres y valores de estilo específicos del control.</span><span class="sxs-lookup"><span data-stu-id="39820-263">The extended properties; that is, a list of control-specific style names and values.</span></span>

## <a name="invoking-context-menus-from-text-ranges"></a><span data-ttu-id="39820-264">Invocar menús contextuales desde intervalos de texto</span><span class="sxs-lookup"><span data-stu-id="39820-264">Invoking Context Menus From Text Ranges</span></span>

<span data-ttu-id="39820-265">A partir de Windows 8.1, los intervalos de texto pueden admitir la interfaz [**IUIAutomationTextRange2**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange2) .</span><span class="sxs-lookup"><span data-stu-id="39820-265">Starting with Windows 8.1, text ranges may support the [**IUIAutomationTextRange2**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange2) interface.</span></span> <span data-ttu-id="39820-266">Esta interfaz admite el método [**ShowContextMenu**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange2-showcontextmenu) .</span><span class="sxs-lookup"><span data-stu-id="39820-266">This interface supports the [**ShowContextMenu**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange2-showcontextmenu) method.</span></span> <span data-ttu-id="39820-267">Puede llamar a este método para invocar cualquier menú contextual asociado a un intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="39820-267">You can call this method to invoke any context menu that is associated with a text range.</span></span> <span data-ttu-id="39820-268">El escenario para esto es la corrección de intervalos de texto o la selección de IME Candidate.</span><span class="sxs-lookup"><span data-stu-id="39820-268">The scenario for this is autocorrection of text ranges or IME candidate selection.</span></span> <span data-ttu-id="39820-269">En estos casos, aparece un menú contextual que admite la interacción con el usuario.</span><span class="sxs-lookup"><span data-stu-id="39820-269">In these cases a context menu appears that supports user interaction.</span></span>

## <a name="related-topics"></a><span data-ttu-id="39820-270">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="39820-270">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="39820-271">Patrones de control Text y TextRange</span><span class="sxs-lookup"><span data-stu-id="39820-271">Text and TextRange Control Patterns</span></span>](uiauto-implementingtextandtextrange.md)
</dt> <dt>

[<span data-ttu-id="39820-272">Compatibilidad de UI Automation para el contenido textual</span><span class="sxs-lookup"><span data-stu-id="39820-272">UI Automation Support for Textual Content</span></span>](uiauto-ui-automation-textpattern-overview.md)
</dt> <dt>

[<span data-ttu-id="39820-273">Trabajar con controles basados en texto</span><span class="sxs-lookup"><span data-stu-id="39820-273">Working with Text-based Controls</span></span>](uiauto-workingwithtextbasedcontrols.md)
</dt> </dl>

 

 