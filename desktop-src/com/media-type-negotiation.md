---
title: Negociación de Media-Type
description: Muchos protocolos de Internet de la capa de aplicación se basan en el intercambio de mensajes en un formato simple y flexible denominado Extensiones multipropósito de correo Internet (MIME).
ms.assetid: 7a2c9d8f-639a-4865-a62b-63330175f5f0
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb145fa3a76da6574172ddd24888f3b5da7ad85e
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/21/2020
ms.locfileid: "104421471"
---
# <a name="media-type-negotiation"></a><span data-ttu-id="2ca77-103">Negociación de Media-Type</span><span class="sxs-lookup"><span data-stu-id="2ca77-103">Media-Type Negotiation</span></span>

<span data-ttu-id="2ca77-104">Muchos protocolos de Internet de la capa de aplicación se basan en el intercambio de mensajes en un formato simple y flexible denominado Extensiones multipropósito de correo Internet (MIME).</span><span class="sxs-lookup"><span data-stu-id="2ca77-104">Many application-layer Internet protocols are based on the exchange of messages in a simple, flexible format called Multipurpose Internet Mail Extensions (MIME).</span></span> <span data-ttu-id="2ca77-105">Aunque MIME se originó como estándar para intercambiar mensajes de correo electrónico, se usa hoy en una amplia variedad de aplicaciones para especificar formatos de datos comprendidos mutuamente como tipos MIME o multimedia.</span><span class="sxs-lookup"><span data-stu-id="2ca77-105">Although MIME originated as a standard for exchanging electronic mail messages, it is used today by a wide variety of applications to specify mutually understood data formats as MIME, or media, types.</span></span> <span data-ttu-id="2ca77-106">El proceso se denomina *negociación de tipo de medio*.</span><span class="sxs-lookup"><span data-stu-id="2ca77-106">The process is called *media-type negotiation*.</span></span>

<span data-ttu-id="2ca77-107">Los tipos de medios son cadenas simples que denotan un tipo y un subtipo (como "texto/sin formato" o "texto/HTML").</span><span class="sxs-lookup"><span data-stu-id="2ca77-107">Media types are simple strings that denote a type and subtype (such as "text/plain" or "text/HTML").</span></span> <span data-ttu-id="2ca77-108">Se usan para etiquetar datos o calificar una solicitud.</span><span class="sxs-lookup"><span data-stu-id="2ca77-108">They are used to label data or qualify a request.</span></span> <span data-ttu-id="2ca77-109">Un explorador Web, por ejemplo, como parte de una solicitud HTTP-for-Data o de Request-for-info, especifica que está solicitando tipos de medios "image/gif" o "image/JPEG", a los que un servidor web responde devolviendo el tipo de medio adecuado y, si la llamada era una solicitud de datos, los propios datos en el formato solicitado.</span><span class="sxs-lookup"><span data-stu-id="2ca77-109">A Web browser, for example, as part of an HTTP request-for-data or request-for-info, specifies that it is requesting "image/gif" or "image/jpeg" Media Types, to which a web server responds by returning the appropriate media type and, if the call was a request-for-data, the data itself in the requested format.</span></span>

<span data-ttu-id="2ca77-110">La negociación del tipo de medio suele ser similar a la forma en que las aplicaciones de escritorio existentes negocian con el Portapapeles del sistema para determinar qué formato de datos se debe pegar cuando un usuario elige editar/pegar o consultas para formatos al recibir un puntero [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) durante una operación de arrastrar y colocar.</span><span class="sxs-lookup"><span data-stu-id="2ca77-110">Media-type negotiation is often similar to how existing desktop applications negotiate with the system clipboard to determine which data format to paste when a user chooses Edit/Paste or queries for formats when receiving an [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) pointer during a drag-and-drop operation.</span></span> <span data-ttu-id="2ca77-111">La sutil diferencia en la negociación del tipo de medio HTTP es que el cliente no conoce con anterioridad el tiempo que tiene disponible el formato del servidor.</span><span class="sxs-lookup"><span data-stu-id="2ca77-111">The subtle difference in HTTP media-type negotiation is that the client does not know ahead of time which formats the server has available.</span></span> <span data-ttu-id="2ca77-112">Por lo tanto, el cliente especifica los tipos de medios que admite, en orden de mayor fidelidad, y el servidor responde con el mejor formato disponible.</span><span class="sxs-lookup"><span data-stu-id="2ca77-112">Therefore, the client specifies up-front the media types it supports, in order of greatest fidelity, and the server responds with the best available format.</span></span>

<span data-ttu-id="2ca77-113">Los monikers de dirección URL admiten la negociación de tipo de medio para que los clientes y servidores de Internet acepten los formatos que se van a usar al descargar datos en operaciones de [**BindToStorage**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtostorage) .</span><span class="sxs-lookup"><span data-stu-id="2ca77-113">URL monikers support media-type negotiation as a way for Internet clients and servers to agree upon formats to be used when downloading data in [**BindToStorage**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtostorage) operations.</span></span> <span data-ttu-id="2ca77-114">Para admitir la negociación de tipo de medio, un cliente implementa la interfaz [**IEnumFORMATETC**](/windows/desktop/api/ObjIdl/nn-objidl-ienumformatetc) y llama a la función [**RegisterFormatEnumerator**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775116(v=vs.85)) para registrarla con el contexto de enlace.</span><span class="sxs-lookup"><span data-stu-id="2ca77-114">To support media-type negotiation, a client implements the [**IEnumFORMATETC**](/windows/desktop/api/ObjIdl/nn-objidl-ienumformatetc) interface and calls the [**RegisterFormatEnumerator**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775116(v=vs.85)) function to register it with the bind context.</span></span> <span data-ttu-id="2ca77-115">El enumerador de formato muestra los formatos que el cliente puede aceptar.</span><span class="sxs-lookup"><span data-stu-id="2ca77-115">The format enumerator lists the formats the client can accept.</span></span> <span data-ttu-id="2ca77-116">Un moniker de dirección URL traduce estos formatos en tipos de medios al enlazar con direcciones URL HTTP.</span><span class="sxs-lookup"><span data-stu-id="2ca77-116">A URL moniker translates these formats into media types when binding to HTTP URLs.</span></span>

<span data-ttu-id="2ca77-117">Los posibles tipos de medios solicitados por el cliente se representan como moniker de dirección URL a través de las estructuras [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) disponibles en el enumerador [**IEnumFORMATETC**](/windows/desktop/api/ObjIdl/nn-objidl-ienumformatetc) registrado por el autor de la llamada en el contexto de enlace: cada **FORMATETC** especifica un formato de Portapapeles que identifica el tipo de medio.</span><span class="sxs-lookup"><span data-stu-id="2ca77-117">The possible media types requested by the client are represented to URL monikers through [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structures available from the [**IEnumFORMATETC**](/windows/desktop/api/ObjIdl/nn-objidl-ienumformatetc) enumerator registered by the caller on the bind context: Each **FORMATETC** specifies a clipboard format identifying the media type.</span></span> <span data-ttu-id="2ca77-118">Por ejemplo, el fragmento de código siguiente especifica que el tipo de medio es PostScript.</span><span class="sxs-lookup"><span data-stu-id="2ca77-118">For example, the following code fragment specifies that the media type is PostScript.</span></span>

``` syntax
FORMATETC fmtetc;
fmtetc.cfFormat = RegisterClipboardFormat(CF_MIME_POSTSCRIPT);
. . .
```

<span data-ttu-id="2ca77-119">Un cliente puede establecer el formato del portapapeles en el tipo de medio especial CF \_ null para indicar que debe recuperarse el tipo de medio predeterminado del recurso al que apunta la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="2ca77-119">A client can set the clipboard format to the special media type CF\_NULL to indicate that the default media type of the resource pointed to by the URL should be retrieved.</span></span> <span data-ttu-id="2ca77-120">Normalmente, este formato es el último en el que el cliente está interesado.</span><span class="sxs-lookup"><span data-stu-id="2ca77-120">This format is usually the last one in which the client is interested.</span></span> <span data-ttu-id="2ca77-121">Cuando no se registra ningún enumerador con el contexto de enlace, un moniker de dirección URL funciona como si un enumerador que contiene un solo [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) con **cfFormat**= CF \_ null está disponible, y descarga automáticamente el tipo de medio predeterminado.</span><span class="sxs-lookup"><span data-stu-id="2ca77-121">When no enumerator is registered with the bind context, a URL moniker works as if an enumerator containing a single [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) with **cfFormat**=CF\_NULL is available, automatically downloading the default media-type.</span></span>

<span data-ttu-id="2ca77-122">Sea cual sea el tipo de medio que se va a usar, el cliente recibe una notificación de la opción por medio del argumento *pformatetc* en su método [**IBindStatusCallback:: ondataavailable**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775061(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="2ca77-122">Whatever media type is to be used, the client is notified of the choice by means of the *pformatetc* argument on its [**IBindStatusCallback::OnDataAvailable**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775061(v=vs.85)) method.</span></span> <span data-ttu-id="2ca77-123">La devolución de llamada se produce en el contexto de la llamada del cliente a [**BindToStorage**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtostorage).</span><span class="sxs-lookup"><span data-stu-id="2ca77-123">The callback occurs within the context of the client's call to [**BindToStorage**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtostorage).</span></span>

> [!Note]  
> <span data-ttu-id="2ca77-124">Si el contenido recibido es de un tipo de medio no reconocido, el cliente llama automáticamente a [**RegisterMediaTypes**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775118(v=vs.85)) para registrar el nuevo tipo.</span><span class="sxs-lookup"><span data-stu-id="2ca77-124">If received content is of an unrecognized media-type, the client automatically calls [**RegisterMediaTypes**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775118(v=vs.85)) to register the new type.</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="2ca77-125">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="2ca77-125">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2ca77-126">Monikers de URL</span><span class="sxs-lookup"><span data-stu-id="2ca77-126">URL Monikers</span></span>](url-monikers.md)
</dt> </dl>

 

 