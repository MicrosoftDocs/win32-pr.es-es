---
description: Las aplicaciones pueden depender de una versión específica de un archivo DLL compartido y comenzar a producir un error si se instala otra aplicación con una versión más reciente o anterior del mismo archivo DLL.
ms.assetid: 3b426b6c-1ad5-43b9-81ea-5e6d3c6588c8
title: Redirección de la biblioteca Dynamic-Link
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6b575d566231058cca13c10a067a3c2e20078073
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "105687146"
---
# <a name="dynamic-link-library-redirection"></a><span data-ttu-id="74861-103">Redirección de la biblioteca Dynamic-Link</span><span class="sxs-lookup"><span data-stu-id="74861-103">Dynamic-Link Library Redirection</span></span>

<span data-ttu-id="74861-104">Las aplicaciones pueden depender de una versión específica de un archivo DLL compartido y comenzar a producir un error si se instala otra aplicación con una versión más reciente o anterior del mismo archivo DLL.</span><span class="sxs-lookup"><span data-stu-id="74861-104">Applications can depend on a specific version of a shared DLL and start to fail if another application is installed with a newer or older version of the same DLL.</span></span> <span data-ttu-id="74861-105">Hay dos maneras de asegurarse de que la aplicación usa el archivo DLL correcto: redirección de DLL y componentes en paralelo.</span><span class="sxs-lookup"><span data-stu-id="74861-105">There are two ways to ensure that your application uses the correct DLL: DLL redirection and side-by-side components.</span></span> <span data-ttu-id="74861-106">Los desarrolladores y administradores deben usar el redireccionamiento de DLL para las aplicaciones existentes, ya que no requiere ningún cambio en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="74861-106">Developers and administrators should use DLL redirection for existing applications, because it does not require any changes to the application.</span></span> <span data-ttu-id="74861-107">Si está creando una nueva aplicación o actualizando una aplicación y desea aislar la aplicación de posibles problemas, cree un [componente en paralelo](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal).</span><span class="sxs-lookup"><span data-stu-id="74861-107">If you are creating a new application or updating an application and want to isolate your application from potential problems, create a [side-by-side component](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal).</span></span>

<span data-ttu-id="74861-108">Para habilitar la redirección de archivos DLL en todo el equipo, debe crear una nueva clave del registro.</span><span class="sxs-lookup"><span data-stu-id="74861-108">To enable DLL redirection machine-wide, you must create a new registry key.</span></span> <span data-ttu-id="74861-109">Cree una nueva clave DWORD denominada **DevOverrideEnable** en **las opciones de ejecución de archivo HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image** y establézcala en 1.</span><span class="sxs-lookup"><span data-stu-id="74861-109">Create a new DWORD key called **DevOverrideEnable** at **HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options** and set it to 1.</span></span> <span data-ttu-id="74861-110">Después, debe reiniciar el equipo para ver los efectos.</span><span class="sxs-lookup"><span data-stu-id="74861-110">After this, you must restart your computer to see the effects.</span></span>

<span data-ttu-id="74861-111">Para usar el redireccionamiento de DLL, cree un *archivo de redireccionamiento* para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="74861-111">To use DLL redirection, create a *redirection file* for your application.</span></span> <span data-ttu-id="74861-112">El archivo de redireccionamiento debe tener el nombre siguiente: *\_ nombre* de la aplicación. local.</span><span class="sxs-lookup"><span data-stu-id="74861-112">The redirection file must be named as follows: *App\_name*.local.</span></span> <span data-ttu-id="74861-113">Por ejemplo, si el nombre de la aplicación es Editor.exe, el archivo de redireccionamiento se debe denominar Editor.exe. local.</span><span class="sxs-lookup"><span data-stu-id="74861-113">For example, if the application name is Editor.exe, the redirection file should be named Editor.exe.local.</span></span> <span data-ttu-id="74861-114">Debe instalar el archivo. local en el directorio de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="74861-114">You must install the .local file in the application directory.</span></span> <span data-ttu-id="74861-115">También debe instalar los archivos dll en el directorio de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="74861-115">You must also install the DLLs in the application directory.</span></span>

<span data-ttu-id="74861-116">El contenido de un archivo de redireccionamiento se omite, pero su presencia hace que Windows Compruebe el directorio de la aplicación en primer lugar cada vez que carga un archivo DLL, independientemente de la ruta de acceso especificada a [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) o [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa).</span><span class="sxs-lookup"><span data-stu-id="74861-116">The contents of a redirection file are ignored, but its presence causes Windows to check the application directory first whenever it loads a DLL, regardless of the path specified to [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) or [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa).</span></span> <span data-ttu-id="74861-117">Si el archivo DLL no se encuentra en el directorio de la aplicación, estas funciones usan su orden de búsqueda habitual.</span><span class="sxs-lookup"><span data-stu-id="74861-117">If the DLL is not found in the application directory, then these functions use their usual search order.</span></span> <span data-ttu-id="74861-118">Por ejemplo, si la aplicación c: \\ myapp \\myapp.exe llama a **LoadLibrary** mediante la siguiente ruta de acceso:</span><span class="sxs-lookup"><span data-stu-id="74861-118">For example, if the application c:\\myapp\\myapp.exe calls **LoadLibrary** using the following path:</span></span>

<span data-ttu-id="74861-119">c: archivos de \\ programa archivos \\ comunes \\ sistema \\mydll.dll</span><span class="sxs-lookup"><span data-stu-id="74861-119">c:\\program files\\common files\\system\\mydll.dll</span></span>

<span data-ttu-id="74861-120">Y, si tanto c: \\ myapp \\myapp.exe. local como c: \\ MyApp \\mydll.dll existen, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) carga c: \\ MyApp \\mydll.dll.</span><span class="sxs-lookup"><span data-stu-id="74861-120">And, if both c:\\myapp\\myapp.exe.local and c:\\myapp\\mydll.dll exist, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) loads c:\\myapp\\mydll.dll.</span></span> <span data-ttu-id="74861-121">De lo contrario, **LoadLibrary** carga c: \\ archivos de programa \\ Common file \\ System \\mydll.dll.</span><span class="sxs-lookup"><span data-stu-id="74861-121">Otherwise, **LoadLibrary** loads c:\\program files\\common files\\system\\mydll.dll.</span></span>

<span data-ttu-id="74861-122">Como alternativa, si un directorio denominado c: \\ myapp \\myapp.exe. local existe y contiene mydll.dll, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) carga c: \\ MyApp \\myapp.exe. local \\mydll.dll.</span><span class="sxs-lookup"><span data-stu-id="74861-122">Alternatively, if a directory named c:\\myapp\\myapp.exe.local exists and contains mydll.dll, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) loads c:\\myapp\\myapp.exe.local\\mydll.dll.</span></span>

<span data-ttu-id="74861-123">Si la aplicación tiene un manifiesto, se omiten los archivos. local.</span><span class="sxs-lookup"><span data-stu-id="74861-123">If the application has a manifest, then any .local files are ignored.</span></span>

<span data-ttu-id="74861-124">Si usa el redireccionamiento de DLL y la aplicación no tiene acceso a todas las unidades y directorios en el orden de búsqueda, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) dejará de buscar en cuanto se deniegue el acceso.</span><span class="sxs-lookup"><span data-stu-id="74861-124">If you are using DLL redirection and the application does not have access to all drives and directories in the search order, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) stops searching as soon as access is denied.</span></span> <span data-ttu-id="74861-125">(Si no usa el redireccionamiento de DLL, **LoadLibrary** omite los directorios a los que no puede tener acceso y, a continuación, continúa con la búsqueda).</span><span class="sxs-lookup"><span data-stu-id="74861-125">(If you are not using DLL redirection, **LoadLibrary** skips directories that it cannot access and then continues searching.)</span></span>

<span data-ttu-id="74861-126">Es recomendable instalar los archivos dll de la aplicación en el mismo directorio que contiene la aplicación, incluso si no está utilizando el redireccionamiento de DLL.</span><span class="sxs-lookup"><span data-stu-id="74861-126">It is good practice to install application DLLs in the same directory that contains the application, even if you are not using DLL redirection.</span></span> <span data-ttu-id="74861-127">Esto garantiza que al instalar la aplicación no se sobrescriban otras copias del archivo DLL y que se produzca un error en otras aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="74861-127">This ensures that installing the application does not overwrite other copies of the DLL and cause other applications to fail.</span></span> <span data-ttu-id="74861-128">Además, si sigue este procedimiento recomendado, otras aplicaciones no sobrescribirán su copia del archivo DLL y provocarán un error en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="74861-128">Also, if you follow this good practice, other applications do not overwrite your copy of the DLL and cause your application to fail.</span></span>

 

 
