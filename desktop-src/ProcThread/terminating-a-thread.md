---
description: 'La terminación de un subproceso tiene los siguientes resultados: se liberan todos los recursos que pertenecen al subproceso, como ventanas y enlaces. Se establece el código de salida del subproceso. Se señala el objeto de subproceso. Si el subproceso es el único subproceso activo en el proceso, el proceso se termina. Para obtener más información, vea finalizar un proceso.'
ms.assetid: 633e5d0c-e9d8-4f9a-9411-17cbe9e2e6e4
title: Finalización de un subproceso
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ada421356666316072aabff8281787cc140ad114
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "105677826"
---
# <a name="terminating-a-thread"></a><span data-ttu-id="a22f4-104">Finalización de un subproceso</span><span class="sxs-lookup"><span data-stu-id="a22f4-104">Terminating a Thread</span></span>

<span data-ttu-id="a22f4-105">La terminación de un subproceso tiene los siguientes resultados:</span><span class="sxs-lookup"><span data-stu-id="a22f4-105">Terminating a thread has the following results:</span></span>

-   <span data-ttu-id="a22f4-106">Se liberan todos los recursos que pertenecen al subproceso, como ventanas y enlaces.</span><span class="sxs-lookup"><span data-stu-id="a22f4-106">Any resources owned by the thread, such as windows and hooks, are freed.</span></span>
-   <span data-ttu-id="a22f4-107">Se establece el código de salida del subproceso.</span><span class="sxs-lookup"><span data-stu-id="a22f4-107">The thread exit code is set.</span></span>
-   <span data-ttu-id="a22f4-108">Se señala el objeto de subproceso.</span><span class="sxs-lookup"><span data-stu-id="a22f4-108">The thread object is signaled.</span></span>
-   <span data-ttu-id="a22f4-109">Si el subproceso es el único subproceso activo en el proceso, el proceso se termina.</span><span class="sxs-lookup"><span data-stu-id="a22f4-109">If the thread is the only active thread in the process, the process is terminated.</span></span> <span data-ttu-id="a22f4-110">Para obtener más información, vea [finalizar un proceso](terminating-a-process.md).</span><span class="sxs-lookup"><span data-stu-id="a22f4-110">For more information, see [Terminating a Process](terminating-a-process.md).</span></span>

<span data-ttu-id="a22f4-111">La función [**GetExitCodeThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getexitcodethread) devuelve el estado de finalización de un subproceso.</span><span class="sxs-lookup"><span data-stu-id="a22f4-111">The [**GetExitCodeThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getexitcodethread) function returns the termination status of a thread.</span></span> <span data-ttu-id="a22f4-112">Mientras se ejecuta un subproceso, su estado de finalización sigue siendo \_ activo.</span><span class="sxs-lookup"><span data-stu-id="a22f4-112">While a thread is executing, its termination status is STILL\_ACTIVE.</span></span> <span data-ttu-id="a22f4-113">Cuando un subproceso finaliza, su estado de finalización cambia de todavía \_ activo al código de salida del subproceso.</span><span class="sxs-lookup"><span data-stu-id="a22f4-113">When a thread terminates, its termination status changes from STILL\_ACTIVE to the exit code of the thread.</span></span>

<span data-ttu-id="a22f4-114">Cuando finaliza un subproceso, el estado del objeto de subproceso cambia a señalado y libera cualquier otro subproceso que haya estado esperando a que el subproceso finalice.</span><span class="sxs-lookup"><span data-stu-id="a22f4-114">When a thread terminates, the state of the thread object changes to signaled, releasing any other threads that had been waiting for the thread to terminate.</span></span> <span data-ttu-id="a22f4-115">Para obtener más información sobre la sincronización, vea [sincronizar la ejecución de varios subprocesos](synchronizing-execution-of-multiple-threads.md).</span><span class="sxs-lookup"><span data-stu-id="a22f4-115">For more about synchronization, see [Synchronizing Execution of Multiple Threads](synchronizing-execution-of-multiple-threads.md).</span></span>

<span data-ttu-id="a22f4-116">Cuando un subproceso finaliza, su objeto de subproceso no se libera hasta que se cierran todos los identificadores abiertos al subproceso.</span><span class="sxs-lookup"><span data-stu-id="a22f4-116">When a thread terminates, its thread object is not freed until all open handles to the thread are closed.</span></span>

## <a name="how-threads-are-terminated"></a><span data-ttu-id="a22f4-117">Cómo se finalizan los subprocesos</span><span class="sxs-lookup"><span data-stu-id="a22f4-117">How Threads are Terminated</span></span>

<span data-ttu-id="a22f4-118">Un subproceso se ejecuta hasta que se produce uno de los siguientes eventos:</span><span class="sxs-lookup"><span data-stu-id="a22f4-118">A thread executes until one of the following events occurs:</span></span>

-   <span data-ttu-id="a22f4-119">El subproceso llama a la función [**ExitThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitthread) .</span><span class="sxs-lookup"><span data-stu-id="a22f4-119">The thread calls the [**ExitThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitthread) function.</span></span>
-   <span data-ttu-id="a22f4-120">Cualquier subproceso del proceso llama a la función [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess) .</span><span class="sxs-lookup"><span data-stu-id="a22f4-120">Any thread of the process calls the [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess) function.</span></span>
-   <span data-ttu-id="a22f4-121">La función Thread devuelve.</span><span class="sxs-lookup"><span data-stu-id="a22f4-121">The thread function returns.</span></span>
-   <span data-ttu-id="a22f4-122">Cualquier subproceso llama a la función [**TerminateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminatethread) con un identificador al subproceso.</span><span class="sxs-lookup"><span data-stu-id="a22f4-122">Any thread calls the [**TerminateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminatethread) function with a handle to the thread.</span></span>
-   <span data-ttu-id="a22f4-123">Cualquier subproceso llama a la función [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess) con un identificador para el proceso.</span><span class="sxs-lookup"><span data-stu-id="a22f4-123">Any thread calls the [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess) function with a handle to the process.</span></span>

<span data-ttu-id="a22f4-124">El código de salida de un subproceso es el valor especificado en la llamada a [**ExitThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitthread), [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess), [**TerminateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminatethread)o [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess), o el valor devuelto por la función de subproceso.</span><span class="sxs-lookup"><span data-stu-id="a22f4-124">The exit code for a thread is either the value specified in the call to [**ExitThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitthread), [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess), [**TerminateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminatethread), or [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess), or the value returned by the thread function.</span></span>

<span data-ttu-id="a22f4-125">Si se termina un subproceso por [**ExitThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitthread), el sistema llama a la función de punto de entrada de cada dll asociada con un valor que indica que el subproceso se está desasociando del archivo DLL (a menos que se llame a la función [**DisableThreadLibraryCalls**](/windows/win32/api/libloaderapi/nf-libloaderapi-disablethreadlibrarycalls) ).</span><span class="sxs-lookup"><span data-stu-id="a22f4-125">If a thread is terminated by [**ExitThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitthread), the system calls the entry-point function of each attached DLL with a value indicating that the thread is detaching from the DLL (unless you call the [**DisableThreadLibraryCalls**](/windows/win32/api/libloaderapi/nf-libloaderapi-disablethreadlibrarycalls) function).</span></span> <span data-ttu-id="a22f4-126">Si [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess)termina un subproceso, las funciones de punto de entrada de dll se invocan una vez para indicar que el proceso se está desasociando.</span><span class="sxs-lookup"><span data-stu-id="a22f4-126">If a thread is terminated by [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess), the DLL entry-point functions are invoked once, to indicate that the process is detaching.</span></span> <span data-ttu-id="a22f4-127">No se notifica a los archivos dll cuando se termina un subproceso mediante [**TerminateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminatethread) o [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess).</span><span class="sxs-lookup"><span data-stu-id="a22f4-127">DLLs are not notified when a thread is terminated by [**TerminateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminatethread) or [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess).</span></span> <span data-ttu-id="a22f4-128">Para obtener más información acerca de los archivos dll, consulte [bibliotecas de vínculos dinámicos](../dlls/dynamic-link-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="a22f4-128">For more information about DLLs, see [Dynamic-Link Libraries](../dlls/dynamic-link-libraries.md).</span></span>

<span data-ttu-id="a22f4-129">Las funciones [**TerminateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminatethread) y [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess) deben usarse solo en circunstancias extremas, ya que no permiten que los subprocesos se limpien, no notifican a las DLL adjuntas y no liberan la pila inicial.</span><span class="sxs-lookup"><span data-stu-id="a22f4-129">The [**TerminateThread**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminatethread) and [**TerminateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess) functions should be used only in extreme circumstances, since they do not allow threads to clean up, do not notify attached DLLs, and do not free the initial stack.</span></span> <span data-ttu-id="a22f4-130">Además, los identificadores de los objetos que son propiedad del subproceso no se cierran hasta que finaliza el proceso.</span><span class="sxs-lookup"><span data-stu-id="a22f4-130">In addition, handles to objects owned by the thread are not closed until the process terminates.</span></span> <span data-ttu-id="a22f4-131">Los pasos siguientes proporcionan una solución mejor:</span><span class="sxs-lookup"><span data-stu-id="a22f4-131">The following steps provide a better solution:</span></span>

-   <span data-ttu-id="a22f4-132">Cree un objeto de evento mediante la función [**CreateEvent**](/windows/win32/api/synchapi/nf-synchapi-createeventa) .</span><span class="sxs-lookup"><span data-stu-id="a22f4-132">Create an event object using the [**CreateEvent**](/windows/win32/api/synchapi/nf-synchapi-createeventa) function.</span></span>
-   <span data-ttu-id="a22f4-133">Cree los subprocesos.</span><span class="sxs-lookup"><span data-stu-id="a22f4-133">Create the threads.</span></span>
-   <span data-ttu-id="a22f4-134">Cada subproceso supervisa el estado del evento mediante una llamada a la función [**WaitForSingleObject**](/windows/win32/api/synchapi/nf-synchapi-waitforsingleobject) .</span><span class="sxs-lookup"><span data-stu-id="a22f4-134">Each thread monitors the event state by calling the [**WaitForSingleObject**](/windows/win32/api/synchapi/nf-synchapi-waitforsingleobject) function.</span></span> <span data-ttu-id="a22f4-135">Use un intervalo de tiempo de espera de espera de cero.</span><span class="sxs-lookup"><span data-stu-id="a22f4-135">Use a wait time-out interval of zero.</span></span>
-   <span data-ttu-id="a22f4-136">Cada subproceso finaliza su propia ejecución cuando el evento se establece en el estado señalado ([**WaitForSingleObject**](/windows/win32/api/synchapi/nf-synchapi-waitforsingleobject) devuelve el \_ objeto 0 de espera \_ ).</span><span class="sxs-lookup"><span data-stu-id="a22f4-136">Each thread terminates its own execution when the event is set to the signaled state ([**WaitForSingleObject**](/windows/win32/api/synchapi/nf-synchapi-waitforsingleobject) returns WAIT\_OBJECT\_0).</span></span>

 

 
