---
description: Proceso de conexión de CBasePin
ms.assetid: 4b3a9023-0267-4caa-9d89-88237009df05
title: Proceso de conexión de CBasePin
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1441b0daba58857e00da0139d3312fb277287fc2
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/06/2021
ms.locfileid: "103997815"
---
# <a name="cbasepin-connection-process"></a><span data-ttu-id="3b72d-103">Proceso de conexión de CBasePin</span><span class="sxs-lookup"><span data-stu-id="3b72d-103">CBasePin Connection Process</span></span>

<span data-ttu-id="3b72d-104">En esta sección se describe cómo la clase [**CBasePin**](cbasepin.md) implementa el proceso de conexión del PIN.</span><span class="sxs-lookup"><span data-stu-id="3b72d-104">This section describes how the [**CBasePin**](cbasepin.md) class implements the pin connection process.</span></span>

<span data-ttu-id="3b72d-105">El administrador de gráficos de filtro inicia todas las conexiones de PIN.</span><span class="sxs-lookup"><span data-stu-id="3b72d-105">The Filter Graph Manager initiates all pin connections.</span></span> <span data-ttu-id="3b72d-106">Llama al método [**IPin:: Connect**](/windows/desktop/api/Strmif/nf-strmif-ipin-connect) del terminal de salida, especificando el PIN de entrada.</span><span class="sxs-lookup"><span data-stu-id="3b72d-106">It calls the output pin's [**IPin::Connect**](/windows/desktop/api/Strmif/nf-strmif-ipin-connect) method, specifying the input pin.</span></span> <span data-ttu-id="3b72d-107">El PIN de salida completa la conexión llamando al método [**IPin:: ReceiveConnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection) del PIN de entrada.</span><span class="sxs-lookup"><span data-stu-id="3b72d-107">The output pin completes the connection by calling the input pin's [**IPin::ReceiveConnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection) method.</span></span> <span data-ttu-id="3b72d-108">El PIN de entrada puede aceptar o rechazar la conexión.</span><span class="sxs-lookup"><span data-stu-id="3b72d-108">The input pin can accept or reject the connection.</span></span>

<span data-ttu-id="3b72d-109">El administrador de gráficos de filtro también puede especificar un tipo de medio para la conexión.</span><span class="sxs-lookup"><span data-stu-id="3b72d-109">The Filter Graph Manager can also specify a media type for the connection.</span></span> <span data-ttu-id="3b72d-110">Si es así, los pin intentan conectarse con ese tipo.</span><span class="sxs-lookup"><span data-stu-id="3b72d-110">If so, the pins try to connect with that type.</span></span> <span data-ttu-id="3b72d-111">De lo contrario, los pin deben negociar el tipo.</span><span class="sxs-lookup"><span data-stu-id="3b72d-111">If not, the pins must negotiate the type.</span></span> <span data-ttu-id="3b72d-112">El administrador de gráficos de filtro también puede especificar un tipo de medio *parcial* , que tiene el valor GUID \_ null para el tipo principal, el subtipo o el tipo de formato.</span><span class="sxs-lookup"><span data-stu-id="3b72d-112">The Filter Graph Manager may also specify a *partial* media type, which has the value GUID\_NULL for either the major type, subtype, or format type.</span></span> <span data-ttu-id="3b72d-113">En ese caso, los pin intentan coincidir con las partes del tipo de medio que se hayan especificado. el valor null de GUID \_ actúa como carácter comodín.</span><span class="sxs-lookup"><span data-stu-id="3b72d-113">In that case, the pins try to match whichever portions of the media type were specified; the value GUID\_NULL acts as a wildcard.</span></span>

<span data-ttu-id="3b72d-114">El método [**CBasePin:: Connect**](cbasepin-connect.md) se inicia comprobando que el pin puede aceptar una conexión.</span><span class="sxs-lookup"><span data-stu-id="3b72d-114">The [**CBasePin::Connect**](cbasepin-connect.md) method starts by verifying that the pin can accept a connection.</span></span> <span data-ttu-id="3b72d-115">Por ejemplo, comprueba que el PIN no está ya conectado.</span><span class="sxs-lookup"><span data-stu-id="3b72d-115">For example, it checks that the pin is not already connected.</span></span> <span data-ttu-id="3b72d-116">Delega el resto del proceso de conexión al método [**CBasePin:: AgreeMediaType**](cbasepin-agreemediatype.md) .</span><span class="sxs-lookup"><span data-stu-id="3b72d-116">It delegates the rest of the connection process to the [**CBasePin::AgreeMediaType**](cbasepin-agreemediatype.md) method.</span></span> <span data-ttu-id="3b72d-117">**AgreeMediaType** realiza todo lo siguiente.</span><span class="sxs-lookup"><span data-stu-id="3b72d-117">Everything that follows is performed by **AgreeMediaType**.</span></span>

<span data-ttu-id="3b72d-118">Si el tipo de medio se especifica por completo, el PIN llama al método [**CBasePin:: AttemptConnection**](cbasepin-attemptconnection.md) para intentar la conexión.</span><span class="sxs-lookup"><span data-stu-id="3b72d-118">If the media type is fully specified, the pin calls the [**CBasePin::AttemptConnection**](cbasepin-attemptconnection.md) method to attempt the connection.</span></span> <span data-ttu-id="3b72d-119">De lo contrario, prueba los tipos de medios en el orden siguiente:</span><span class="sxs-lookup"><span data-stu-id="3b72d-119">Otherwise, it tries media types in the following order:</span></span>

1.  <span data-ttu-id="3b72d-120">Los tipos preferidos del PIN de entrada.</span><span class="sxs-lookup"><span data-stu-id="3b72d-120">The input pin's preferred types.</span></span>
2.  <span data-ttu-id="3b72d-121">Los tipos preferidos del PIN de salida.</span><span class="sxs-lookup"><span data-stu-id="3b72d-121">The output pin's preferred types.</span></span>

<span data-ttu-id="3b72d-122">Puede revertir este orden estableciendo la marca [**CBasePin:: m \_ BTryMyTypesFirst**](cbasepin-m-btrymytypesfirst.md) en **true**.</span><span class="sxs-lookup"><span data-stu-id="3b72d-122">You can reverse this order by setting the [**CBasePin::m\_bTryMyTypesFirst**](cbasepin-m-btrymytypesfirst.md) flag to **TRUE**.</span></span>

<span data-ttu-id="3b72d-123">En cada caso, el PIN llama a [**IPin:: EnumMediaTypes**](/windows/desktop/api/Strmif/nf-strmif-ipin-enummediatypes) para enumerar los tipos de medios.</span><span class="sxs-lookup"><span data-stu-id="3b72d-123">In each case, the pin calls [**IPin::EnumMediaTypes**](/windows/desktop/api/Strmif/nf-strmif-ipin-enummediatypes) to enumerate the media types.</span></span> <span data-ttu-id="3b72d-124">Este método recupera un objeto de enumerador, que se pasa al método [**CBasePin:: TryMediaTypes**](cbasepin-trymediatypes.md) .</span><span class="sxs-lookup"><span data-stu-id="3b72d-124">This method retrieves an enumerator object, which is passed to the [**CBasePin::TryMediaTypes**](cbasepin-trymediatypes.md) method.</span></span> <span data-ttu-id="3b72d-125">El método **TryMediaTypes** recorre en bucle cada tipo de medio y llama a [**AttemptConnection**](cbasepin-attemptconnection.md) para cada tipo.</span><span class="sxs-lookup"><span data-stu-id="3b72d-125">The **TryMediaTypes** method loops through each media type and calls [**AttemptConnection**](cbasepin-attemptconnection.md) for each type.</span></span>

<span data-ttu-id="3b72d-126">Dentro del método [**AttemptConnection**](cbasepin-attemptconnection.md) , el PIN de salida llama a los métodos siguientes:</span><span class="sxs-lookup"><span data-stu-id="3b72d-126">Within the [**AttemptConnection**](cbasepin-attemptconnection.md) method, the output pin calls the following methods:</span></span>

-   <span data-ttu-id="3b72d-127">Llama a [**CBasePin:: CheckConnect**](cbasepin-checkconnect.md) en sí mismo para comprobar si el PIN de entrada es adecuado.</span><span class="sxs-lookup"><span data-stu-id="3b72d-127">It calls [**CBasePin::CheckConnect**](cbasepin-checkconnect.md) on itself, to check whether the input pin is suitable.</span></span>
-   <span data-ttu-id="3b72d-128">Llama a [**CBasePin:: CheckMediaType**](cbasepin-checkmediatype.md) en sí mismo, para validar el tipo de medio.</span><span class="sxs-lookup"><span data-stu-id="3b72d-128">It calls [**CBasePin::CheckMediaType**](cbasepin-checkmediatype.md) on itself, to validate the media type.</span></span>
-   <span data-ttu-id="3b72d-129">Llama a [**IPin:: ReceiveConnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection) en el PIN de entrada.</span><span class="sxs-lookup"><span data-stu-id="3b72d-129">It calls [**IPin::ReceiveConnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection) on the input pin.</span></span> <span data-ttu-id="3b72d-130">El PIN de entrada usa este método para determinar si debe aceptar la conexión.</span><span class="sxs-lookup"><span data-stu-id="3b72d-130">The input pin uses this method to determine whether it should accept the connection.</span></span>
-   <span data-ttu-id="3b72d-131">Llama a [**CBasePin:: CompleteConnect**](cbasepin-completeconnect.md) en sí mismo para completar la conexión.</span><span class="sxs-lookup"><span data-stu-id="3b72d-131">It calls [**CBasePin::CompleteConnect**](cbasepin-completeconnect.md) on itself to completes the connection.</span></span>

<span data-ttu-id="3b72d-132">Tenga en cuenta lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="3b72d-132">Note the following:</span></span>

-   <span data-ttu-id="3b72d-133">[**CheckConnect**](cbasepin-checkconnect.md) es un método virtual.</span><span class="sxs-lookup"><span data-stu-id="3b72d-133">[**CheckConnect**](cbasepin-checkconnect.md) is a virtual method.</span></span> <span data-ttu-id="3b72d-134">En la clase base, este método comprueba si las direcciones del PIN son compatibles.</span><span class="sxs-lookup"><span data-stu-id="3b72d-134">In the base class, this method checks whether the pin directions are compatible.</span></span> <span data-ttu-id="3b72d-135">Los pin de salida deben conectarse a los pin de entrada y viceversa.</span><span class="sxs-lookup"><span data-stu-id="3b72d-135">Output pins must connect to input pins, and vice versa.</span></span> <span data-ttu-id="3b72d-136">La clase de PIN derivada normalmente invalidará este método para realizar otras comprobaciones.</span><span class="sxs-lookup"><span data-stu-id="3b72d-136">The derived pin class will typically override this method to perform other checks.</span></span> <span data-ttu-id="3b72d-137">Por ejemplo, podría consultar el otro PIN para obtener una interfaz necesaria para la conexión.</span><span class="sxs-lookup"><span data-stu-id="3b72d-137">For example, it might query the other pin for an interface that is required for the connection.</span></span> <span data-ttu-id="3b72d-138">Si la clase derivada invalida **CheckConnect**, debe llamar también al método [**CBasePin**](cbasepin.md) .</span><span class="sxs-lookup"><span data-stu-id="3b72d-138">If the derived class overrides **CheckConnect**, it should also call the [**CBasePin**](cbasepin.md) method.</span></span>
-   <span data-ttu-id="3b72d-139">[**CheckMediaType**](cbasepin-checkmediatype.md) es un método virtual puro, que la clase derivada debe implementar.</span><span class="sxs-lookup"><span data-stu-id="3b72d-139">[**CheckMediaType**](cbasepin-checkmediatype.md) is a pure virtual method, which the derived class must implement.</span></span>
-   <span data-ttu-id="3b72d-140">[**CompleteConnect**](cbasepin-completeconnect.md) es un método virtual que no hace nada en la clase base.</span><span class="sxs-lookup"><span data-stu-id="3b72d-140">[**CompleteConnect**](cbasepin-completeconnect.md) is a virtual method that does nothing in the base class.</span></span> <span data-ttu-id="3b72d-141">Las clases derivadas pueden invalidar este método para realizar cualquier trabajo adicional necesario para completar la conexión, por ejemplo, para decidir un asignador de memoria.</span><span class="sxs-lookup"><span data-stu-id="3b72d-141">Derived classes can override this method to perform any additional work needed to complete the connection, such as deciding a memory allocator.</span></span>

<span data-ttu-id="3b72d-142">Si se produce un error en cualquiera de estos pasos, el PIN de salida llama al método [**CBasePin:: BreakConnect**](cbasepin-breakconnect.md) para deshacer los pasos que haya tomado [**CheckConnect**](cbasepin-checkconnect.md).</span><span class="sxs-lookup"><span data-stu-id="3b72d-142">If any of these steps fails, the output pin calls the [**CBasePin::BreakConnect**](cbasepin-breakconnect.md) method to undo whatever steps were taken by [**CheckConnect**](cbasepin-checkconnect.md).</span></span>

<span data-ttu-id="3b72d-143">El método [**ReceiveConnection**](cbasepin-receiveconnection.md) del PIN de entrada llama a los métodos [**CheckConnect**](cbasepin-checkconnect.md), [**CheckMediaType**](cbasepin-checkmediatype.md)y [**CompleteConnect**](cbasepin-completeconnect.md) del PIN de entrada.</span><span class="sxs-lookup"><span data-stu-id="3b72d-143">The input pin's [**ReceiveConnection**](cbasepin-receiveconnection.md) method calls the input pin's [**CheckConnect**](cbasepin-checkconnect.md), [**CheckMediaType**](cbasepin-checkmediatype.md), and [**CompleteConnect**](cbasepin-completeconnect.md) methods.</span></span> <span data-ttu-id="3b72d-144">Si se produce un error en cualquiera de estos, el intento de conexión también produce un error.</span><span class="sxs-lookup"><span data-stu-id="3b72d-144">If any of these fail, the connection attempt also fails.</span></span>

<span data-ttu-id="3b72d-145">En el siguiente diagrama se muestra el proceso de conexión en [**CBasePin**](cbasepin.md):</span><span class="sxs-lookup"><span data-stu-id="3b72d-145">The following diagram shows the connection process in [**CBasePin**](cbasepin.md):</span></span>

![proceso de conexión de cbasepin](images/cbasepin-connect.png)

## <a name="related-topics"></a><span data-ttu-id="3b72d-147">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="3b72d-147">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="3b72d-148">**CBasePin**</span><span class="sxs-lookup"><span data-stu-id="3b72d-148">**CBasePin**</span></span>](cbasepin.md)
</dt> </dl>

 

 



