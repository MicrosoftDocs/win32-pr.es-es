---
title: Eventos de objetos COM y conectables
description: Cuando un programa detecta algo que ha sucedido, puede notificar a sus clientes.
ms.assetid: f6ffbd1d-4bc1-4dc2-b3ed-ee12359e3d75
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aa5115cfd08d57658eec879d44b4361e88965b3c
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/29/2020
ms.locfileid: "104077236"
---
# <a name="events-in-com-and-connectable-objects"></a><span data-ttu-id="83d20-103">Eventos de objetos COM y conectables</span><span class="sxs-lookup"><span data-stu-id="83d20-103">Events in COM and Connectable Objects</span></span>

<span data-ttu-id="83d20-104">Cuando un programa detecta algo que ha sucedido, puede notificar a sus clientes.</span><span class="sxs-lookup"><span data-stu-id="83d20-104">When a program detects something that has happened, it can notify its clients.</span></span> <span data-ttu-id="83d20-105">Por ejemplo, si un programa de cotización bursátil detecta un cambio en el precio de una acción, puede notificar a todos los clientes el cambio.</span><span class="sxs-lookup"><span data-stu-id="83d20-105">For example, if a stock ticker program detects a change in the price of a stock, it can notify all clients of the change.</span></span> <span data-ttu-id="83d20-106">Este proceso de notificación se conoce como *activación de un evento*.</span><span class="sxs-lookup"><span data-stu-id="83d20-106">This notification process is referred to as *firing an event*.</span></span>

<span data-ttu-id="83d20-107">Con COM, los objetos de servidor pueden utilizar eventos COM para desencadenar eventos sin información sobre los objetos a los que se va a notificar.</span><span class="sxs-lookup"><span data-stu-id="83d20-107">With COM, server objects can use COM events to fire events without any information about what objects will be notified.</span></span> <span data-ttu-id="83d20-108">Los objetos también pueden usar *objetos conectables* para mantener información detallada acerca de los clientes que han solicitado las notificaciones.</span><span class="sxs-lookup"><span data-stu-id="83d20-108">Objects can also use *connectable objects* to maintain detailed information about clients who have requested notifications.</span></span>

<span data-ttu-id="83d20-109">Los objetos conectables COM proporcionan interfaces de salida a sus clientes además de las interfaces de entrada.</span><span class="sxs-lookup"><span data-stu-id="83d20-109">COM connectable objects provide outgoing interfaces to their clients in addition to their incoming interfaces.</span></span> <span data-ttu-id="83d20-110">Como resultado, los objetos y sus clientes pueden interactuar en la comunicación bidireccional.</span><span class="sxs-lookup"><span data-stu-id="83d20-110">As a result, objects and their clients can engage in bidirectional communication.</span></span> <span data-ttu-id="83d20-111">Las interfaces de entrada se implementan en un objeto y reciben llamadas de clientes externos de un objeto, mientras que las interfaces salientes se implementan en el receptor del cliente y reciben llamadas del objeto.</span><span class="sxs-lookup"><span data-stu-id="83d20-111">Incoming interfaces are implemented on an object and receive calls from external clients of an object, while outgoing interfaces are implemented on the client's sink and receive calls from the object.</span></span> <span data-ttu-id="83d20-112">El objeto define una interfaz que desea usar y el cliente la implementa.</span><span class="sxs-lookup"><span data-stu-id="83d20-112">The object defines an interface it would like to use, and the client implements it.</span></span>

<span data-ttu-id="83d20-113">Un objeto define sus interfaces de entrada y proporciona implementaciones de estas interfaces.</span><span class="sxs-lookup"><span data-stu-id="83d20-113">An object defines its incoming interfaces and provides implementations of these interfaces.</span></span> <span data-ttu-id="83d20-114">Las interfaces de entrada están disponibles para los clientes a través del método [**IUnknown:: QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) del objeto.</span><span class="sxs-lookup"><span data-stu-id="83d20-114">Incoming interfaces are available to clients through the object's [**IUnknown::QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) method.</span></span> <span data-ttu-id="83d20-115">Los clientes llaman a los métodos de una interfaz entrante en el objeto y el objeto realiza las acciones deseadas en nombre del cliente.</span><span class="sxs-lookup"><span data-stu-id="83d20-115">Clients call the methods of an incoming interface on the object, and the object performs desired actions on behalf of the client.</span></span>

<span data-ttu-id="83d20-116">Las interfaces de salida también se definen mediante un objeto, pero el cliente proporciona las implementaciones de las interfaces de salida en un objeto receptor que crea el cliente.</span><span class="sxs-lookup"><span data-stu-id="83d20-116">Outgoing interfaces are also defined by an object, but the client provides the implementations of the outgoing interfaces on a sink object that the client creates.</span></span> <span data-ttu-id="83d20-117">A continuación, el objeto llama a los métodos de la interfaz de salida en el objeto receptor para notificar al cliente los cambios en el objeto, para desencadenar eventos en el cliente, para solicitar algo del cliente o, de hecho, para cualquier propósito con el que se encuentre el creador del objeto.</span><span class="sxs-lookup"><span data-stu-id="83d20-117">The object then calls methods of the outgoing interface on the sink object to notify the client of changes in the object, to trigger events in the client, to request something from the client, or, in fact, for any purpose the object creator comes up with.</span></span>

<span data-ttu-id="83d20-118">Un ejemplo de una interfaz de salida es una interfaz IButtonSink definida por un control de botón de control para notificar sus eventos a sus clientes.</span><span class="sxs-lookup"><span data-stu-id="83d20-118">An example of an outgoing interface is an IButtonSink interface defined by a push button control to notify its clients of its events.</span></span> <span data-ttu-id="83d20-119">Por ejemplo, el objeto de botón llama a IButtonSink:: OnClick en el objeto receptor del cliente cuando el usuario hace clic en el botón de la pantalla.</span><span class="sxs-lookup"><span data-stu-id="83d20-119">For example, the button object calls IButtonSink::OnClick on the client's sink object when the user clicks the button on the screen.</span></span> <span data-ttu-id="83d20-120">El control de botón define la interfaz de salida.</span><span class="sxs-lookup"><span data-stu-id="83d20-120">The button control defines the outgoing interface.</span></span> <span data-ttu-id="83d20-121">Para que un cliente del botón controle el evento, el cliente debe implementar esa interfaz de salida en un objeto receptor y, a continuación, conectar ese receptor al control de botón.</span><span class="sxs-lookup"><span data-stu-id="83d20-121">For a client of the button to handle the event, the client must implement that outgoing interface on a sink object and then connect that sink to the button control.</span></span> <span data-ttu-id="83d20-122">A continuación, cuando se produzcan eventos en el botón, el botón llamará al receptor, momento en el cual el cliente puede ejecutar cualquier acción que desee asignar a ese botón.</span><span class="sxs-lookup"><span data-stu-id="83d20-122">Then, when events occur in the button, the button will call the sink, at which time the client can execute whatever action it wishes to assign to that button click.</span></span>

<span data-ttu-id="83d20-123">Los objetos conectables proporcionan un mecanismo general para la comunicación de objeto a cliente.</span><span class="sxs-lookup"><span data-stu-id="83d20-123">Connectable objects provide a general mechanism for object-to-client communication.</span></span> <span data-ttu-id="83d20-124">Cualquier objeto que desee exponer eventos o notificaciones de cualquier tipo puede utilizar esta tecnología.</span><span class="sxs-lookup"><span data-stu-id="83d20-124">Any object that wishes to expose events or notifications of any kind can use this technology.</span></span> <span data-ttu-id="83d20-125">Además de la tecnología de objetos conectables generales, COM proporciona muchas interfaces de sitio y receptor de propósito especial usadas por los objetos para notificar a los clientes de eventos específicos de interés para el cliente.</span><span class="sxs-lookup"><span data-stu-id="83d20-125">In addition to the general connectable object technology, COM provides many special purpose sink and site interfaces used by objects to notify clients of specific events of interest to the client.</span></span> <span data-ttu-id="83d20-126">Por ejemplo, se puede usar [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) en los objetos para notificar a los clientes los datos y ver los cambios en el objeto.</span><span class="sxs-lookup"><span data-stu-id="83d20-126">For example, [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) may be used by objects to notify clients of data and view changes in the object.</span></span>

<span data-ttu-id="83d20-127">Para obtener más información, vea los temas siguientes:</span><span class="sxs-lookup"><span data-stu-id="83d20-127">For more information, see the following topics:</span></span>

-   [<span data-ttu-id="83d20-128">Arquitectura de objetos conectables</span><span class="sxs-lookup"><span data-stu-id="83d20-128">Architecture of Connectable Objects</span></span>](architecture-of-connectable-objects.md)
-   [<span data-ttu-id="83d20-129">Interfaces de objeto conectables</span><span class="sxs-lookup"><span data-stu-id="83d20-129">Connectable Object Interfaces</span></span>](connectable-object-interfaces.md)

 

 




