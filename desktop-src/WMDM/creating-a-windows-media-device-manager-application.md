---
title: Crear una aplicación de Windows Media Administrador de dispositivos
description: Crear una aplicación de Windows Media Administrador de dispositivos
ms.assetid: 6a200bd9-19dd-4130-acb4-e038b469c334
keywords:
- Windows Media Administrador de dispositivos, creación de aplicaciones
- Administrador de dispositivos, creación de aplicaciones
- Windows Media Administrador de dispositivos, guía de programación
- Administrador de dispositivos, guía de programación
- Guía de programación, aplicaciones de escritorio
- Guía de programación, Administrador de dispositivos de Windows Media
- Guía de programación, Complementos
- Guía de programación, creación de aplicaciones
- Windows Media Administrador de dispositivos, aplicaciones de escritorio
- Administrador de dispositivos, aplicaciones de escritorio
- Administrador de dispositivos de Windows Media, Complementos
- Administrador de dispositivos, INSP
- complementos, crear
- complementos, guía de programación
- aplicaciones de escritorio, crear
- crear aplicaciones de Windows Media Administrador de dispositivos, acerca de
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1b50a2dfce057b993f84c0aca4c8f45796f67ba8
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/16/2019
ms.locfileid: "105695278"
---
# <a name="creating-a-windows-media-device-manager-application"></a><span data-ttu-id="e8db3-119">Crear una aplicación de Windows Media Administrador de dispositivos</span><span class="sxs-lookup"><span data-stu-id="e8db3-119">Creating a Windows Media Device Manager Application</span></span>

<span data-ttu-id="e8db3-120">En esta sección se describe cómo usar Administrador de dispositivos de Windows Media en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="e8db3-120">This section describes how to use Windows Media Device Manager in your application.</span></span> <span data-ttu-id="e8db3-121">El término "aplicación" aquí significa un archivo ejecutable, como un reproductor de media o un complemento COM, como un complemento de medición.</span><span class="sxs-lookup"><span data-stu-id="e8db3-121">The term "application" here means either an executable, such as a media player, or a COM plug-in, such as a metering plug-in.</span></span>

<span data-ttu-id="e8db3-122">Microsoft incluye varios proveedores de servicios con Windows XP y Windows Media Player 10, incluido un proveedor de servicios de MTP, un proveedor de servicios Windows CE (para dispositivos que ejecutan Windows CE y el uso del protocolo RAPI, como Pocket PC) y un proveedor de servicios para dispositivos de categoría de almacenamiento masivo (MSC).</span><span class="sxs-lookup"><span data-stu-id="e8db3-122">Microsoft includes several service providers with Windows XP and Windows Media Player 10, including an MTP service provider, a Windows CE service provider (for devices running Windows CE and using the RAPI protocol, such as the Pocket PC), and a service provider for mass-storage category (MSC) devices.</span></span> <span data-ttu-id="e8db3-123">También puede crear su propio proveedor de servicios para garantizar la comunicación con su propio dispositivo; para obtener más información, vea [crear un proveedor de servicios](creating-a-service-provider.md).</span><span class="sxs-lookup"><span data-stu-id="e8db3-123">You can also create your own service provider to ensure communication with your own device; for more information, see [Creating a Service Provider](creating-a-service-provider.md).</span></span>

<span data-ttu-id="e8db3-124">Hay una serie de proveedores de servicios heredados de terceros que abordan un dispositivo no MTP, no RAPI o no es un fabricante determinado.</span><span class="sxs-lookup"><span data-stu-id="e8db3-124">There are a number of third-party legacy service providers that address a particular manufacturer's non-MTP, non-RAPI, or non-MSC device.</span></span> <span data-ttu-id="e8db3-125">Estos proveedores de servicios se incluyen en el disco del controlador incluido con estos dispositivos.</span><span class="sxs-lookup"><span data-stu-id="e8db3-125">These service providers are included on the driver disk shipped with these devices.</span></span>

<span data-ttu-id="e8db3-126">Una aplicación que utiliza Windows Media Administrador de dispositivos debe realizar los pasos siguientes.</span><span class="sxs-lookup"><span data-stu-id="e8db3-126">An application that uses Windows Media Device Manager must perform the following steps.</span></span>

1.  <span data-ttu-id="e8db3-127">**Tenga en cuenta los problemas de privacidad implicados en el desarrollo de una aplicación.**</span><span class="sxs-lookup"><span data-stu-id="e8db3-127">**Become aware of privacy issues involved with developing an application.**</span></span> <span data-ttu-id="e8db3-128">Vea la [declaración de privacidad](privacy-statement.md) para obtener información sobre algunos problemas de privacidad relacionados con el desarrollo de una aplicación de Windows Media administrador de dispositivos.</span><span class="sxs-lookup"><span data-stu-id="e8db3-128">See [Privacy Statement](privacy-statement.md) to learn about some privacy issues involving developing a Windows Media Device Manager application.</span></span>
2.  <span data-ttu-id="e8db3-129">**Incluya los archivos de encabezado y de biblioteca necesarios para la aplicación.**</span><span class="sxs-lookup"><span data-stu-id="e8db3-129">**Include the required library and header files for your application.**</span></span> <span data-ttu-id="e8db3-130">Vea [archivos de encabezado y biblioteca necesarios para que una aplicación](required-library-and-header-files-for-an-application.md) obtenga información sobre qué archivos necesita incluir en el proyecto.</span><span class="sxs-lookup"><span data-stu-id="e8db3-130">See [Required Library and Header Files for an Application](required-library-and-header-files-for-an-application.md) to learn what files you will need to include in your project.</span></span>
3.  <span data-ttu-id="e8db3-131">**Autentique la aplicación y adquiera la interfaz IWMDMDevice raíz.**</span><span class="sxs-lookup"><span data-stu-id="e8db3-131">**Authenticate the application and acquire the root IWMDMDevice interface.**</span></span> <span data-ttu-id="e8db3-132">La primera tarea que debe realizar una aplicación para usar Windows Media Administrador de dispositivos es autenticarse.</span><span class="sxs-lookup"><span data-stu-id="e8db3-132">The first task an application must do to use Windows Media Device Manager is to authenticate itself.</span></span> <span data-ttu-id="e8db3-133">Este proceso comprueba la identidad de la aplicación en Windows Media Administrador de dispositivos mediante un certificado ficticio para la funcionalidad limitada de Administrador de dispositivos de Windows Media o el uso de un certificado oficial para una funcionalidad completa.</span><span class="sxs-lookup"><span data-stu-id="e8db3-133">This process verifies the identity of the application to Windows Media Device Manager using a dummy certificate for limited Windows Media Device Manager functionality, or using an official certificate for full functionality.</span></span> <span data-ttu-id="e8db3-134">Para obtener más información, consulte [autenticar la aplicación](authenticating-the-application.md).</span><span class="sxs-lookup"><span data-stu-id="e8db3-134">For more information, see [Authenticating the Application](authenticating-the-application.md).</span></span>
4.  <span data-ttu-id="e8db3-135">**Enumerar los dispositivos conectados.**</span><span class="sxs-lookup"><span data-stu-id="e8db3-135">**Enumerate the connected devices.**</span></span> <span data-ttu-id="e8db3-136">El primer paso para comunicarse con los dispositivos es averiguar qué dispositivos están conectados y accesibles para Windows Media Administrador de dispositivos.</span><span class="sxs-lookup"><span data-stu-id="e8db3-136">The first step in communicating with devices is to find out what devices are connected and accessible to Windows Media Device Manager.</span></span> <span data-ttu-id="e8db3-137">Para obtener más información, vea [enumerar dispositivos](enumerating-devices.md).</span><span class="sxs-lookup"><span data-stu-id="e8db3-137">For more information, see [Enumerating Devices](enumerating-devices.md).</span></span>
5.  <span data-ttu-id="e8db3-138">**Compruebe el estado de los componentes de DRM del dispositivo.**</span><span class="sxs-lookup"><span data-stu-id="e8db3-138">**Check the status of the device's DRM components.**</span></span> <span data-ttu-id="e8db3-139">Para usar archivos protegidos con DRM, se debe crear un dispositivo en alguna versión de DRM de Windows Media para dispositivos portátiles, y los componentes de DRM deben estar actualizados.</span><span class="sxs-lookup"><span data-stu-id="e8db3-139">To use DRM-protected files, a device must be built on some version of Windows Media DRM for Portable Devices, and the DRM components must be up to date.</span></span> <span data-ttu-id="e8db3-140">Antes de empezar a controlar archivos en el dispositivo, es mejor ver si el dispositivo admite archivos protegidos con DRM y si es necesario actualizar el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="e8db3-140">Before you begin handling files on the device, it is best to see if the device supports DRM-protected files, and whether the device needs to be updated.</span></span> <span data-ttu-id="e8db3-141">Para obtener más información, consulte [control del contenido protegido en la aplicación](handling-protected-content-in-the-application.md).</span><span class="sxs-lookup"><span data-stu-id="e8db3-141">For more information, see [Handling Protected Content in the Application](handling-protected-content-in-the-application.md).</span></span>
6.  <span data-ttu-id="e8db3-142">**Explore un dispositivo.**</span><span class="sxs-lookup"><span data-stu-id="e8db3-142">**Explore a device.**</span></span> <span data-ttu-id="e8db3-143">Una vez que haya encontrado el dispositivo que desea, puede explorar el contenido de dicho dispositivo.</span><span class="sxs-lookup"><span data-stu-id="e8db3-143">After you have found the device you want, you can explore the contents of that device.</span></span> <span data-ttu-id="e8db3-144">Para obtener más información, consulte [explorar un dispositivo](exploring-a-device.md).</span><span class="sxs-lookup"><span data-stu-id="e8db3-144">For more information, see [Exploring a Device](exploring-a-device.md).</span></span>
7.  <span data-ttu-id="e8db3-145">**Leer archivos del dispositivo y escribir archivos en el dispositivo.**</span><span class="sxs-lookup"><span data-stu-id="e8db3-145">**Read files from the device, and write files to the device.**</span></span> <span data-ttu-id="e8db3-146">Una vez que conozca el diseño del dispositivo, puede empezar a transferir archivos hacia y desde el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="e8db3-146">After you know about the layout of the device, you can begin transferring files to and from the device.</span></span> <span data-ttu-id="e8db3-147">Para obtener más información, consulte [leer archivos del dispositivo](reading-files-from-the-device.md) y [escribir archivos en el dispositivo](writing-files-to-the-device.md).</span><span class="sxs-lookup"><span data-stu-id="e8db3-147">For more information, see [Reading Files from the Device](reading-files-from-the-device.md) and [Writing Files to the Device](writing-files-to-the-device.md).</span></span>
8.  <span data-ttu-id="e8db3-148">**Cree listas de reproducción en el dispositivo.**</span><span class="sxs-lookup"><span data-stu-id="e8db3-148">**Create playlists on the device.**</span></span> <span data-ttu-id="e8db3-149">Un tipo de archivo que se puede escribir en el dispositivo es un archivo abstracto, que es una colección de referencias a otros archivos.</span><span class="sxs-lookup"><span data-stu-id="e8db3-149">One kind of file you can write to the device is an abstract file, which is a collection of references to other files.</span></span> <span data-ttu-id="e8db3-150">Aunque la capacidad de escribir archivos abstractos en un dispositivo depende del proveedor de servicios y del dispositivo, generalmente solo los dispositivos MTP tienen esta capacidad.</span><span class="sxs-lookup"><span data-stu-id="e8db3-150">Although the ability to write abstract files to a device depends on the service provider and the device, generally only MTP devices have this capability.</span></span> <span data-ttu-id="e8db3-151">Para obtener más información, consulte [crear una lista de reproducción en el dispositivo](creating-a-playlist-on-the-device.md).</span><span class="sxs-lookup"><span data-stu-id="e8db3-151">For more information, see [Creating a Playlist on the Device](creating-a-playlist-on-the-device.md).</span></span>

<span data-ttu-id="e8db3-152">Además de estos pasos, hay varias características más que puede habilitar en la aplicación:</span><span class="sxs-lookup"><span data-stu-id="e8db3-152">In addition to these steps, there are several more features that you can enable in your application:</span></span>

-   <span data-ttu-id="e8db3-153">**Notificaciones**:</span><span class="sxs-lookup"><span data-stu-id="e8db3-153">**Notifications.**</span></span> <span data-ttu-id="e8db3-154">Puede permitir que la aplicación reciba notificaciones cuando los dispositivos se conectan o desconectan del equipo.</span><span class="sxs-lookup"><span data-stu-id="e8db3-154">You can enable your application to receive notifications when devices connect or disconnect from the computer.</span></span> <span data-ttu-id="e8db3-155">Para obtener más información, consulte [habilitación de notificaciones](enabling-notifications.md).</span><span class="sxs-lookup"><span data-stu-id="e8db3-155">For more information, see [Enabling Notifications](enabling-notifications.md).</span></span>
-   <span data-ttu-id="e8db3-156">**Registro.**</span><span class="sxs-lookup"><span data-stu-id="e8db3-156">**Logging.**</span></span> <span data-ttu-id="e8db3-157">Windows Media Administrador de dispositivos usa un objeto de registro que guarda un registro de sus acciones en un archivo de texto local.</span><span class="sxs-lookup"><span data-stu-id="e8db3-157">Windows Media Device Manager uses a logging object that saves a record of its actions to a local text file.</span></span> <span data-ttu-id="e8db3-158">Puede agregar mensajes a este registro para ayudarle a analizar los errores o el rendimiento de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="e8db3-158">You can add messages to this log to help you analyze errors or performance in your application.</span></span> <span data-ttu-id="e8db3-159">Para obtener más información, vea [Habilitar el registro](enabling-logging.md).</span><span class="sxs-lookup"><span data-stu-id="e8db3-159">For more information, see [Enabling Logging](enabling-logging.md).</span></span>
-   <span data-ttu-id="e8db3-160">**Uso de contenido de disponibilidad.**</span><span class="sxs-lookup"><span data-stu-id="e8db3-160">**Metering content usage.**</span></span> <span data-ttu-id="e8db3-161">Puede recuperar estadísticas de uso de contenido para las licencias que conceden este derecho.</span><span class="sxs-lookup"><span data-stu-id="e8db3-161">You can retrieve content usage statistics for licenses that grant this right.</span></span> <span data-ttu-id="e8db3-162">Estas estadísticas se pueden enviar a un servidor web para calcular los pagos de regalías a los propietarios de contenido.</span><span class="sxs-lookup"><span data-stu-id="e8db3-162">These statistics can then be sent up to a Web server to calculate royalty payments to content owners.</span></span> <span data-ttu-id="e8db3-163">Para obtener más información, vea [uso de contenido de medición](metering-content-usage.md).</span><span class="sxs-lookup"><span data-stu-id="e8db3-163">For more information, see [Metering Content Usage](metering-content-usage.md).</span></span>

<span data-ttu-id="e8db3-164">**Nota de precaución**</span><span class="sxs-lookup"><span data-stu-id="e8db3-164">**A note of caution**</span></span>

<span data-ttu-id="e8db3-165">Es posible que la aplicación tenga que trabajar con una variedad de dispositivos, incluidos algunos que no ha desarrollado y que nunca ha probado el código.</span><span class="sxs-lookup"><span data-stu-id="e8db3-165">Your application may need to work with a variety of devices, including some that you have not developed and have never tested your code against.</span></span> <span data-ttu-id="e8db3-166">Estos dispositivos pueden o no responder con precisión a las consultas y comandos, o implementar MTP u otras especificaciones.</span><span class="sxs-lookup"><span data-stu-id="e8db3-166">These devices might or might not accurately respond to queries and commands, or implement MTP or other specifications.</span></span> <span data-ttu-id="e8db3-167">Asegúrese de incluir una sólida comprobación de errores y una funcionalidad de reserva para tratar con el inesperado.</span><span class="sxs-lookup"><span data-stu-id="e8db3-167">Be sure to include robust error checking and fallback functionality to deal with the unexpected.</span></span> <span data-ttu-id="e8db3-168">Programe la defensa.</span><span class="sxs-lookup"><span data-stu-id="e8db3-168">Program defensively.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e8db3-169">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="e8db3-169">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e8db3-170">**Guía de programación**</span><span class="sxs-lookup"><span data-stu-id="e8db3-170">**Programming Guide**</span></span>](programming-guide.md)
</dt> </dl>

 

 




