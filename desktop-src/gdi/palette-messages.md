---
description: Los cambios en la paleta del sistema para el dispositivo de pantalla pueden tener efectos drásticos y a veces no deseados en los colores utilizados en Windows en el escritorio.
ms.assetid: 9c470b6f-c0d3-462e-9649-1f39b06bd543
title: Mensajes de la paleta
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9f19a5458ec89d8d9a0524fd2ec383de740c0179
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104984886"
---
# <a name="palette-messages"></a><span data-ttu-id="77190-103">Mensajes de la paleta</span><span class="sxs-lookup"><span data-stu-id="77190-103">Palette Messages</span></span>

<span data-ttu-id="77190-104">Los cambios en la paleta del sistema para el dispositivo de pantalla pueden tener efectos drásticos y a veces no deseados en los colores utilizados en Windows en el escritorio.</span><span class="sxs-lookup"><span data-stu-id="77190-104">Changes to the system palette for the display device can have dramatic and sometimes undesirable effects on the colors used in windows on the desktop.</span></span> <span data-ttu-id="77190-105">Para minimizar el impacto de estos cambios, el sistema proporciona un conjunto de mensajes que ayudan a las aplicaciones a administrar sus paletas lógicas, a la vez que garantizan que los colores de la ventana activa sean lo más cercanos posible a los colores previstos.</span><span class="sxs-lookup"><span data-stu-id="77190-105">To minimize the impact of these changes, the system provides a set of messages that help applications manage their logical palettes while ensuring that colors in the active window are as close as possible to the colors intended.</span></span>

<span data-ttu-id="77190-106">El sistema envía un mensaje de [**WM \_ QUERYNEWPALETTE**](wm-querynewpalette.md) a una ventana de nivel superior o superpuesta justo antes de activar la ventana.</span><span class="sxs-lookup"><span data-stu-id="77190-106">The system sends a [**WM\_QUERYNEWPALETTE**](wm-querynewpalette.md) message to a top-level or overlapped window just before activating the window.</span></span> <span data-ttu-id="77190-107">Este mensaje proporciona a una aplicación la oportunidad de seleccionar y observar su paleta lógica para que reciba la mejor asignación posible de colores para su paleta lógica.</span><span class="sxs-lookup"><span data-stu-id="77190-107">This message gives an application the opportunity to select and realize its logical palette so that it receives the best possible mapping of colors for its logical palette.</span></span> <span data-ttu-id="77190-108">Cuando la aplicación recibe el mensaje, debe usar las funciones [**SelectPalette**](/windows/desktop/api/Wingdi/nf-wingdi-selectpalette), [**UnrealizeObject**](/windows/desktop/api/Wingdi/nf-wingdi-unrealizeobject)y [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) para seleccionar y obtener la paleta lógica.</span><span class="sxs-lookup"><span data-stu-id="77190-108">When the application receives the message, it should use the [**SelectPalette**](/windows/desktop/api/Wingdi/nf-wingdi-selectpalette), [**UnrealizeObject**](/windows/desktop/api/Wingdi/nf-wingdi-unrealizeobject), and [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) functions to select and realize the logical palette.</span></span> <span data-ttu-id="77190-109">Al hacerlo, se indica al sistema que actualice los colores de la paleta del sistema para que sus colores coincidan con tantos colores en la paleta lógica como sea posible.</span><span class="sxs-lookup"><span data-stu-id="77190-109">Doing so directs the system to update colors in the system palette so that its colors match as many colors in the logical palette as possible.</span></span>

<span data-ttu-id="77190-110">Cuando una aplicación provoca cambios en la paleta del sistema como resultado de la realidad de la paleta lógica, el sistema envía un mensaje de [**WM \_ PALETTECHANGED**](wm-palettechanged.md) a todas las ventanas superpuestas y de nivel superior.</span><span class="sxs-lookup"><span data-stu-id="77190-110">When an application causes changes to the system palette as a result of realizing its logical palette, the system sends a [**WM\_PALETTECHANGED**](wm-palettechanged.md) message to all top-level and overlapped windows.</span></span> <span data-ttu-id="77190-111">Este mensaje proporciona a las aplicaciones la oportunidad de actualizar los colores de las áreas de cliente de sus ventanas, reemplazando los colores que han cambiado con los colores que coinciden más estrechamente con los colores previstos.</span><span class="sxs-lookup"><span data-stu-id="77190-111">This message gives applications the opportunity to update the colors in the client areas of their windows, replacing colors that have changed with colors that more closely match the intended colors.</span></span> <span data-ttu-id="77190-112">Una aplicación que recibe el mensaje de **\_ PALETTECHANGED de WM** debe usar [**UnrealizeObject**](/windows/desktop/api/Wingdi/nf-wingdi-unrealizeobject) y [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) para restablecer las paletas lógicas asociadas a todas las ventanas inactivas y, a continuación, actualizar los colores del área cliente para cada ventana inactiva mediante la función [**UpdateColors**](/windows/desktop/api/Wingdi/nf-wingdi-updatecolors) .</span><span class="sxs-lookup"><span data-stu-id="77190-112">An application that receives the **WM\_PALETTECHANGED** message should use [**UnrealizeObject**](/windows/desktop/api/Wingdi/nf-wingdi-unrealizeobject) and [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) to reset the logical palettes associated with all inactive windows and then update the colors in the client area for each inactive window by using the [**UpdateColors**](/windows/desktop/api/Wingdi/nf-wingdi-updatecolors) function.</span></span> <span data-ttu-id="77190-113">Esta técnica no garantiza el mayor número de coincidencias exactas de color; sin embargo, garantiza que los colores de la paleta lógica estén asignados a colores razonables en la paleta del sistema.</span><span class="sxs-lookup"><span data-stu-id="77190-113">This technique does not guarantee the greatest number of exact color matches; however, it does ensure that colors in the logical palette are mapped to reasonable colors in the system palette.</span></span>

> [!Note]  
> <span data-ttu-id="77190-114">Para evitar la creación de un bucle infinito, una aplicación nunca debe obtener la paleta de la ventana cuyo identificador coincide con el identificador pasado en el parámetro *wParam* del mensaje de [**\_ PALETTECHANGED de WM**](wm-palettechanged.md) .</span><span class="sxs-lookup"><span data-stu-id="77190-114">To avoid creating an infinite loop, an application should never realize the palette for the window whose handle matches the handle passed in the *wParam* parameter of the [**WM\_PALETTECHANGED**](wm-palettechanged.md) message.</span></span>

 

<span data-ttu-id="77190-115">Normalmente, la función [**UpdateColors**](/windows/desktop/api/Wingdi/nf-wingdi-updatecolors) actualiza un área cliente de una ventana inactiva más rápido que volver a dibujar el área.</span><span class="sxs-lookup"><span data-stu-id="77190-115">The [**UpdateColors**](/windows/desktop/api/Wingdi/nf-wingdi-updatecolors) function typically updates a client area of an inactive window faster than redrawing the area.</span></span> <span data-ttu-id="77190-116">Sin embargo, dado que **UpdateColors** realiza la traducción de color en función del color de cada píxel antes de que cambie la paleta del sistema, cada llamada a esta función provoca la pérdida de alguna precisión del color.</span><span class="sxs-lookup"><span data-stu-id="77190-116">However, because **UpdateColors** performs color translation based on the color of each pixel before the system palette changed, each call to this function results in the loss of some color accuracy.</span></span> <span data-ttu-id="77190-117">Esto significa que **UpdateColors** no se puede usar para actualizar los colores cuando la ventana se activa.</span><span class="sxs-lookup"><span data-stu-id="77190-117">This means **UpdateColors** cannot be used to update colors when the window becomes active.</span></span> <span data-ttu-id="77190-118">En tales casos, la aplicación debe volver a dibujar el área cliente.</span><span class="sxs-lookup"><span data-stu-id="77190-118">In such cases, the application should redraw the client area.</span></span>

<span data-ttu-id="77190-119">El sistema puede enviar el mensaje de [**\_ QUERYNEWPALETTE de WM**](wm-querynewpalette.md) cuando se realizan cambios en la paleta lógica.</span><span class="sxs-lookup"><span data-stu-id="77190-119">The system may send the [**WM\_QUERYNEWPALETTE**](wm-querynewpalette.md) message when changes to the logical palette are made.</span></span> <span data-ttu-id="77190-120">Además, el sistema puede enviar el mensaje de [**\_ PALETTEISCHANGING de WM**](wm-paletteischanging.md) a todas las ventanas superpuestas y de nivel superior cuando la paleta del sistema está a punto de cambiar.</span><span class="sxs-lookup"><span data-stu-id="77190-120">Also, the system may send the [**WM\_PALETTEISCHANGING**](wm-paletteischanging.md) message to all top-level and overlapped windows when the system palette is about to change.</span></span>

 

 



