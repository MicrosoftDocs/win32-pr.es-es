---
description: Hay situaciones en las que los datos de un escritor dependen de datos administrados por otro escritor. En estos casos, debe realizar una copia de seguridad o restaurar los datos de ambos escritores.
ms.assetid: 0413c289-74b7-4e83-a227-00bfb264e56e
title: Dependencias entre los componentes administrados por escritores diferentes
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 91ba3be6a2c2f0a722c4c5f06ca95351e004e1cd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "104361453"
---
# <a name="dependencies-between-components-managed-by-different-writers"></a><span data-ttu-id="4f6a1-104">Dependencias entre los componentes administrados por escritores diferentes</span><span class="sxs-lookup"><span data-stu-id="4f6a1-104">Dependencies between Components Managed by Different Writers</span></span>

<span data-ttu-id="4f6a1-105">Hay situaciones en las que los datos de un escritor dependen de datos administrados por otro escritor.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-105">There are situations where data from one writer depends on data managed by another writer.</span></span> <span data-ttu-id="4f6a1-106">En estos casos, debe realizar una copia de seguridad o restaurar los datos de ambos escritores.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-106">In these cases, you should back up or restore data from both writers.</span></span>

<span data-ttu-id="4f6a1-107">VSS controla este problema a través de la noción de una dependencia de componente de escritor explícita y la interfaz [**IVssWMDependency**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmdependency) .</span><span class="sxs-lookup"><span data-stu-id="4f6a1-107">VSS handles this problem through the notion of an explicit writer-component dependency and the [**IVssWMDependency**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmdependency) interface.</span></span>

<span data-ttu-id="4f6a1-108">Un escritor agrega una o más dependencias al crear el documento de metadatos del escritor mediante el método [**IVssCreateWriterMetadata:: AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency) .</span><span class="sxs-lookup"><span data-stu-id="4f6a1-108">A writer adds one or more dependencies while creating the Writer Metadata Document using the [**IVssCreateWriterMetadata::AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency) method.</span></span> <span data-ttu-id="4f6a1-109">El escritor pasa al método el nombre y la ruta de acceso lógica del componente dependiente (que administra), así como el nombre y la ruta de acceso lógica y el [*identificador de clase del escritor*](vssgloss-w.md) (el GUID que identifica la clase) del componente del que depende.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-109">The writer passes the method the name and logical path of the dependent component (which it manages), as well as the name and logical path and the [*writer class ID*](vssgloss-w.md) (the GUID identifying the class) of the component upon which it depends.</span></span>

<span data-ttu-id="4f6a1-110">Una vez establecida, esta dependencia informa al solicitante de que, durante cualquier operación de copia de seguridad o restauración, debe participar el componente dependiente y los destinos de sus dependencias.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-110">Once established, this dependency informs the requester that during any backup or restore operation both the dependent component and the targets of its dependencies must participate.</span></span>

<span data-ttu-id="4f6a1-111">Un componente determinado puede tener varias dependencias, lo que requiere que todos los destinos dependientes participen en la copia de seguridad y se restauren juntos.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-111">A given component can have multiple dependencies, which requires that it and all its dependent targets participate in the backup and restore together.</span></span>

<span data-ttu-id="4f6a1-112">El componente dependiente y/o los destinos de sus dependencias se pueden incluir [*explícita*](vssgloss-e.md) o [*implícitamente*](vssgloss-i.md) en las operaciones de copia de seguridad o restauración.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-112">The dependent component and/or the target(s) of its dependencies can be included either [*explicitly*](vssgloss-e.md) or [*implicitly*](vssgloss-i.md) in a backup or restore operations.</span></span>

<span data-ttu-id="4f6a1-113">El mecanismo de dependencia del componente de escritor explícito no debe usarse para crear una dependencia entre dos componentes en el mismo sistema de escritura.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-113">The explicit writer component dependency mechanism should not be used to create a dependency between two components on the same writer.</span></span> <span data-ttu-id="4f6a1-114">Las reglas de selección pueden proporcionar la misma funcionalidad de forma más eficaz sin riesgo de dependencias circulares.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-114">The selection rules can supply the same functionality more efficiently without risk of circular dependencies.</span></span>

<span data-ttu-id="4f6a1-115">Como ejemplo, se podría usar [**IVssCreateWriterMetadata:: AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency) para definir la dependencia del componente writerData (con la ruta de acceso lógica "") del escritor alwriter en el componente internetData (con una ruta de acceso lógica de "Connections") de un escritor denominado InternetConnector con un identificador de clase X del escritor. (aunque es posible que varios escritores con el mismo identificador de clase estén en el sistema simultáneamente, se evitará la confusión porque la combinación de nombre de componente y ruta de acceso lógica es única en el sistema en VSS).</span><span class="sxs-lookup"><span data-stu-id="4f6a1-115">As an example, [**IVssCreateWriterMetadata::AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency) could be used to define the dependency of the component writerData (with logical path "") of the writer MyWriter on component internetData (with a logical path of "Connections") of a writer named InternetConnector with a writer Class ID X. (While it is possible for multiple writers with the same class ID to be on the system simultaneously, confusion will be avoided because the combination of logical path and component name is unique on the system under VSS.)</span></span>

<span data-ttu-id="4f6a1-116">Un escritor agrega varias dependencias a un componente determinado mediante una llamada a [**IVssCreateWriterMetadata:: AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency) que se repite con distintos componentes de escritores distintos.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-116">A writer adds multiple dependencies to a given component simply by calling [**IVssCreateWriterMetadata::AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency) repeated with different components from different writers.</span></span> <span data-ttu-id="4f6a1-117">El número de componentes de los que depende un componente determinado se puede encontrar examinando el miembro **cDependencies** de la [**estructura \_ COMPONENTINFO de VSS**](/windows/desktop/api/VsBackup/ns-vsbackup-vss_componentinfo) .</span><span class="sxs-lookup"><span data-stu-id="4f6a1-117">The number of other components a given component depends on can be found by examining the **cDependencies** member of the [**VSS\_COMPONENTINFO**](/windows/desktop/api/VsBackup/ns-vsbackup-vss_componentinfo) structure.</span></span>

<span data-ttu-id="4f6a1-118">Un escritor o solicitante recupera las instancias de la interfaz [**IVssWMDependency**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmdependency) con [**IVssWMComponent:: GetDependency**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdependency).</span><span class="sxs-lookup"><span data-stu-id="4f6a1-118">A writer or requester retrieves instances of the [**IVssWMDependency**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmdependency) interface with [**IVssWMComponent::GetDependency**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdependency).</span></span> <span data-ttu-id="4f6a1-119">**IVssWMDependency** devuelve el nombre del componente, la ruta de acceso lógica y el ID. de clase del escritor que administra el componente que es el destino de la dependencia.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-119">The **IVssWMDependency** returns the component name, logical path, and class ID of the writer managing the component that is the target of the dependency.</span></span>

<span data-ttu-id="4f6a1-120">El mecanismo de dependencia no prescribe ningún orden de preferencia determinado entre el componente dependiente y los destinos de sus dependencias.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-120">The dependency mechanism does not prescribe any particular order of preference between the dependent component and the targets of its dependencies.</span></span> <span data-ttu-id="4f6a1-121">Como se indicó anteriormente, todas las dependencias indican que cada vez que se realiza una copia de seguridad o se restaura un componente determinado, también se debe realizar una copia de seguridad o restauración del componente o los componentes de los que depende.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-121">As noted above, all a dependency indicates is that whenever a given component is either backed up or restored, the component or components it depends on must be backed up or restored as well.</span></span> <span data-ttu-id="4f6a1-122">La implementación exacta de la dependencia depende de la aplicación de copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-122">The exact implementation of dependency is at the discretion of the backup application.</span></span>

<span data-ttu-id="4f6a1-123">Por ejemplo, en el caso anterior, el componente writerData (ruta de acceso lógica "") depende del componente InternetConnector (ruta de acceso lógica "Connections").</span><span class="sxs-lookup"><span data-stu-id="4f6a1-123">For example, in the case above, the component writerData (logical path "") depends on component InternetConnector (logical path "Connections").</span></span> <span data-ttu-id="4f6a1-124">Un solicitante puede interpretarlo de una de las siguientes maneras:</span><span class="sxs-lookup"><span data-stu-id="4f6a1-124">A requester is free to interpret this in either of the following ways:</span></span>

-   <span data-ttu-id="4f6a1-125">Si el componente dependiente, writerData, está seleccionado (implícita o explícitamente) para la copia de seguridad o la restauración, el solicitante debe seleccionar (implícita o explícitamente) el destino de su dependencia, internetData</span><span class="sxs-lookup"><span data-stu-id="4f6a1-125">If the dependent component, writerData, is selected (implicitly or explicitly) for backup or restore, the requester must select (either implicitly or explicitly) the target of its dependency, internetData</span></span>
-   <span data-ttu-id="4f6a1-126">Si el destino de su dependencia, internetData, no se selecciona para la copia de seguridad, no se debe seleccionar el componente dependiente, writerData.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-126">If the target of its dependency, internetData, is not selected for backup, then the dependent component, writerData, should not be selected.</span></span>

<span data-ttu-id="4f6a1-127">Sin embargo, al desarrollar compatibilidad para las dependencias, los desarrolladores del solicitante deben tener en cuenta que no hay ninguna manera en que un escritor puede determinar si uno de sus componentes es un destino de una dependencia.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-127">However, when developing support for dependencies, requester developers should be aware that there is no way a writer can determine if one of its components is a target of a dependency.</span></span>

## <a name="declaring-remote-dependencies"></a><span data-ttu-id="4f6a1-128">Declarar dependencias remotas</span><span class="sxs-lookup"><span data-stu-id="4f6a1-128">Declaring Remote Dependencies</span></span>

<span data-ttu-id="4f6a1-129">Una aplicación distribuida es una aplicación que puede configurarse para usar uno o varios equipos a la vez.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-129">A distributed application is an application that can be configured to use one or more computers at a time.</span></span> <span data-ttu-id="4f6a1-130">Normalmente, la aplicación se ejecuta en uno o más equipos de servidor de aplicaciones y se comunica con (pero que en realidad puede ejecutarse en) uno o más equipos de servidor de bases de datos.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-130">Typically the application runs on one or more application server computers and communicates with (but may or may not actually run on) one or more database server computers.</span></span> <span data-ttu-id="4f6a1-131">Esta configuración se conoce a veces como una implementación de varios sistemas.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-131">This configuration is sometimes referred to as a multi-system deployment.</span></span> <span data-ttu-id="4f6a1-132">A menudo, la misma aplicación también puede configurarse para ejecutarse en un único equipo que ejecute un servidor de aplicaciones y un servidor de base de datos.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-132">Often the same application can also be configured to run on a single computer that runs both an application server and a database server.</span></span> <span data-ttu-id="4f6a1-133">Este tipo de configuración se denomina implementación de un solo sistema.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-133">Such a configuration is called a single-system deployment.</span></span> <span data-ttu-id="4f6a1-134">En ambas configuraciones, el servidor de aplicaciones y el servidor de base de datos tienen sus propios escritores de VSS independientes.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-134">In both configurations, the application server and database server each have their own independent VSS writers.</span></span>

<span data-ttu-id="4f6a1-135">En una implementación de varios sistemas, si un componente administrado por el sistema de escritura de la aplicación depende de un componente remoto administrado por el sistema de escritura del servidor de bases de datos, esto se denomina dependencia remota.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-135">In a multi-system deployment, if a component managed by the application's writer depends on a remote component managed by the database server's writer, this is called a remote dependency.</span></span> <span data-ttu-id="4f6a1-136">(En cambio, una implementación de un solo sistema solo tiene dependencias locales).</span><span class="sxs-lookup"><span data-stu-id="4f6a1-136">(A single-system deployment, in contrast, has only local dependencies.)</span></span>

<span data-ttu-id="4f6a1-137">Como ejemplo de una implementación de varios sistemas, considere la posibilidad de usar un servidor de aplicaciones que use un servidor de SQL Server Database como almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-137">As an example of a multi-system deployment, consider an application server that uses a SQL Server database server as a data store.</span></span> <span data-ttu-id="4f6a1-138">Los datos específicos de la aplicación, que incluyen los elementos Web, los archivos de contenido web y la metabase de IIS, residen en uno o varios equipos, denominados servidores front-end web.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-138">The application-specific data, which includes the web parts, web content files, and the IIS metabase, resides on one or more computers, called front-end web servers.</span></span> <span data-ttu-id="4f6a1-139">El almacén de datos SQL real, que incluye la base de datos de configuración y varias bases de datos de contenido, reside en uno o varios equipos, denominados servidores de base de datos back-end.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-139">The actual SQL data store, which includes the Config database and multiple Content databases, resides on one or more other computers, called back-end database servers.</span></span> <span data-ttu-id="4f6a1-140">Cada uno de los servidores front-end web contiene el mismo contenido y configuración específicos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-140">Each of the front-end web servers contains the same application-specific content and configuration.</span></span> <span data-ttu-id="4f6a1-141">Cada uno de los servidores de bases de datos back-end puede hospedar cualquiera de las bases de datos de contenido o la base de datos de configuración.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-141">Each of the back-end database servers can host any of the Content databases or the Config database.</span></span> <span data-ttu-id="4f6a1-142">El software de aplicación solo se ejecuta en los servidores front-end web, no en los servidores de bases de datos.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-142">The application software runs only on the front-end web servers, not on the database servers.</span></span> <span data-ttu-id="4f6a1-143">En esta configuración, el VSS Writer de la aplicación tiene dependencias remotas en los componentes administrados por el escritor SQL.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-143">In this configuration, the application's VSS writer has remote dependencies on the components managed by the SQL writer.</span></span>

<span data-ttu-id="4f6a1-144">Un sistema de escritura puede declarar una dependencia remota mediante una llamada al método [**AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency) , anteponiendo " \\ \\ *nombreDeEquipoRemoto* \\ ", donde *nombreDeEquipoRemoto* es el nombre del equipo en el que reside el componente remoto, en la ruta de acceso lógica del parámetro *wszOnLogicalPath* .</span><span class="sxs-lookup"><span data-stu-id="4f6a1-144">A writer can declare a remote dependency by calling the [**AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency) method, prepending "\\\\*RemoteComputerName*\\", where *RemoteComputerName* is the name of the computer where the remote component resides, to the logical path in the *wszOnLogicalPath* parameter.</span></span> <span data-ttu-id="4f6a1-145">El valor de *nombreDeEquipoRemoto* puede ser una dirección IP o un nombre de equipo devuelto por la función [**GetComputerNameEx**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-getcomputernameexa) .</span><span class="sxs-lookup"><span data-stu-id="4f6a1-145">The value of *RemoteComputerName* can be an IP address or a computer name returned by the [**GetComputerNameEx**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-getcomputernameexa) function.</span></span>

<span data-ttu-id="4f6a1-146">**Windows Server 2003:** Un escritor no puede declarar dependencias remotas hasta Windows Server 2003 con Service Pack 1 (SP1).</span><span class="sxs-lookup"><span data-stu-id="4f6a1-146">**Windows Server 2003:** A writer cannot declare remote dependencies until Windows Server 2003 with Service Pack 1 (SP1).</span></span>

<span data-ttu-id="4f6a1-147">Para identificar una dependencia, un solicitante llama a los métodos [**GetWriterId**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmdependency-getwriterid), [**GetLogicalPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getlogicalpath)y [**GetComponentName**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmdependency-getcomponentname) de la interfaz [**IVssWMDependency**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmdependency) .</span><span class="sxs-lookup"><span data-stu-id="4f6a1-147">To identify a dependency, a requester calls the [**GetWriterId**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmdependency-getwriterid), [**GetLogicalPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getlogicalpath), and [**GetComponentName**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmdependency-getcomponentname) methods of the [**IVssWMDependency**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmdependency) interface.</span></span> <span data-ttu-id="4f6a1-148">El solicitante debe examinar el nombre del componente que devuelve **GetComponentName** en el parámetro *pbstrComponentName* .</span><span class="sxs-lookup"><span data-stu-id="4f6a1-148">The requester must examine the component name that **GetComponentName** returns in the *pbstrComponentName* parameter.</span></span> <span data-ttu-id="4f6a1-149">Si el nombre del componente comienza por " \\ \\ ", el solicitante debe asumir que especifica una dependencia remota y que el primer componente que sigue a " \\ \\ " es el *nombreDeEquipoRemoto* que se especificó cuando el escritor llamó a [**AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency).</span><span class="sxs-lookup"><span data-stu-id="4f6a1-149">If the component name begins with "\\\\", the requester must assume that it specifies a remote dependency and that the first component following "\\\\" is the *RemoteComputerName* that was specified when the writer called [**AddComponentDependency**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponentdependency).</span></span> <span data-ttu-id="4f6a1-150">Si el nombre del componente no comienza por " \\ \\ ", el solicitante debe suponer que especifica una dependencia local.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-150">If the component name does not begin with "\\\\", the requester should assume that it specifies a local dependency.</span></span>

<span data-ttu-id="4f6a1-151">Si hay una dependencia remota, el solicitante debe hacer una copia de seguridad del componente remoto cuando realiza una copia de seguridad del componente local.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-151">If there is a remote dependency, the requester must back up the remote component when it backs up the local component.</span></span> <span data-ttu-id="4f6a1-152">Para realizar una copia de seguridad del componente remoto, el solicitante debe tener un agente en el equipo remoto y debe iniciar la copia de seguridad en el equipo remoto.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-152">To back up the remote component, the requester should have an agent on the remote computer and should initiate the backup on the remote computer.</span></span>

## <a name="structuring-remote-dependencies"></a><span data-ttu-id="4f6a1-153">Estructuración de dependencias remotas</span><span class="sxs-lookup"><span data-stu-id="4f6a1-153">Structuring Remote Dependencies</span></span>

<span data-ttu-id="4f6a1-154">Es importante comprender que una dependencia no es un componente de sí mismo.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-154">It is important to understand that a dependency is not a component in and of itself.</span></span> <span data-ttu-id="4f6a1-155">Un componente es necesario para contener la dependencia.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-155">A component is necessary to hold the dependency.</span></span>

<span data-ttu-id="4f6a1-156">En los siguientes ejemplos se muestran dos maneras de estructurar un conjunto de dependencias.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-156">The following examples show two ways to structure a set of dependencies.</span></span>

``` syntax
Example 1:
    Writer 1
        Component A
            File A
            File B
            Dependency (SQL/MSDE Writer, Component X, "\")
            Dependency (SQL/MSDE Writer, Component Y, "\")

Example 2:
    Writer 2
        Component A
            File A
            File B
        Component B
            Dependency (SQL/MSDE Writer, Component X, "\")
            Dependency (SQL/MSDE Writer, Component Y, "\")
```

<span data-ttu-id="4f6a1-157">En el ejemplo 1, las dependencias están retenidas por el componente A. Dado que solo se pueden seleccionar los componentes, no los archivos individuales, la estructura de las dependencias de los componentes A de esta manera requeriría que todo el componente, tanto los archivos como las dependencias, siempre se debe hacer una copia de seguridad y restaurar juntos.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-157">In example 1, the dependencies are held by Component A. Because only components can be selected, not individual files, structuring Component A's dependencies this way would require that the entire component, both the files and the dependencies, must always be backed up and restored together.</span></span> <span data-ttu-id="4f6a1-158">No se puede realizar una copia de seguridad ni restaurar individualmente.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-158">They cannot be backed up or restored individually.</span></span>

<span data-ttu-id="4f6a1-159">En el ejemplo 2, los componentes independientes (los componentes A y B) contienen cada una de las dependencias.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-159">In example 2, separate components (Components A and B) hold each of the dependencies.</span></span> <span data-ttu-id="4f6a1-160">En este caso, los dos componentes pueden seleccionarse de forma independiente y, por tanto, realizar una copia de seguridad y restaurarse de forma independiente.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-160">In this case, the two components can be selected independently, and therefore backed up and restored independently.</span></span> <span data-ttu-id="4f6a1-161">La estructura de las dependencias de este modo proporciona a una aplicación distribuida mucha más flexibilidad en la administración de sus dependencias remotas.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-161">Structuring the dependencies this way gives a distributed application much more flexibility in managing its remote dependencies.</span></span>

## <a name="supporting-remote-dependencies"></a><span data-ttu-id="4f6a1-162">Compatibilidad con dependencias remotas</span><span class="sxs-lookup"><span data-stu-id="4f6a1-162">Supporting Remote Dependencies</span></span>

<span data-ttu-id="4f6a1-163">Un solicitante puede proporcionar compatibilidad completa o parcial para las dependencias remotas.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-163">A requester can provide full or partial support for remote dependencies.</span></span>

<span data-ttu-id="4f6a1-164">Para proporcionar soporte completo, el solicitante debe hacer lo siguiente en el momento de la copia de seguridad y la restauración.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-164">To provide full support, the requester should do the following at backup and restore time.</span></span>

<span data-ttu-id="4f6a1-165">En el momento de la copia de seguridad, el solicitante debe iniciar la copia de seguridad en el equipo front-end (local), determinar las dependencias que existen y poner en cola trabajos de copia de seguridad adicionales para capturar las bases de datos de back-end.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-165">At backup time, the requester must start the backup on the front-end (local) computer, determine the dependencies that exist, and spool additional backup jobs to capture the back-end databases.</span></span> <span data-ttu-id="4f6a1-166">El solicitante debe esperar hasta que se hayan completado los trabajos de copia de seguridad de back-end en el equipo remoto antes de llamar a los métodos [**ivssbackupcomponents:: SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded) y [**Ivssbackupcomponents:: BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete) .</span><span class="sxs-lookup"><span data-stu-id="4f6a1-166">The requester must wait until after the back-end backup jobs on the remote computer have completed before calling the [**IVssBackupComponents::SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded) and [**IVssBackupComponents::BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete) methods.</span></span> <span data-ttu-id="4f6a1-167">Si el solicitante espera hasta que se complete la copia de seguridad de los componentes de back-end antes de llamar a **BackupComplete**, se generará una copia de seguridad más fácil de recuperar para un escritor que implementa mejoras adicionales, como el bloqueo de topología, por ejemplo, durante la copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-167">If the requester waits until the backup of back-end components is complete before calling **BackupComplete**, this will produce a more easily recoverable backup for a writer that implements additional enhancements—such as topology locking, for example—during the backup.</span></span> <span data-ttu-id="4f6a1-168">En el procedimiento siguiente se describe lo que debe hacer el solicitante:</span><span class="sxs-lookup"><span data-stu-id="4f6a1-168">The following procedure outlines what the requester should do:</span></span>

1.  <span data-ttu-id="4f6a1-169">En el equipo local, el solicitante llama a los métodos [**ivssbackupcomponents:: InitializeForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforbackup), [**Ivssbackupcomponents:: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), [**Ivssbackupcomponents::P Repareforbackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup)y [**IVssBackupComponents::D osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) .</span><span class="sxs-lookup"><span data-stu-id="4f6a1-169">On the local computer, the requester calls the [**IVssBackupComponents::InitializeForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforbackup), [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), [**IVssBackupComponents::PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup), and [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) methods.</span></span>
2.  <span data-ttu-id="4f6a1-170">Una vez completada la instantánea local, pero antes de que se complete la copia de seguridad, el solicitante pone en cola los trabajos de copia de seguridad adicionales mediante el envío de una solicitud a su agente en el equipo remoto.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-170">After the local shadow copy is completed, but before the backup is completed, the requester spools additional backup jobs by sending a request to its agent on the remote computer.</span></span>
3.  <span data-ttu-id="4f6a1-171">En el equipo remoto, el agente del solicitante realiza la secuencia de copia de seguridad en cola mediante una llamada a [**InitializeForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforbackup), [**GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup), [**DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), [**SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded)y [**BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete).</span><span class="sxs-lookup"><span data-stu-id="4f6a1-171">On the remote computer, the requester's agent performs the spooled backup sequence by calling [**InitializeForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforbackup), [**GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup), [**DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), [**SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded), and [**BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete).</span></span>
4.  <span data-ttu-id="4f6a1-172">Cuando el agente del solicitante ha completado los trabajos en cola en el equipo remoto, el solicitante completa la secuencia de copia de seguridad mediante una llamada a [**SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded) y [**BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete).</span><span class="sxs-lookup"><span data-stu-id="4f6a1-172">When the requester's agent has completed the spooled jobs on the remote computer, the requester completes the backup sequence by calling [**SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded) and [**BackupComplete**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-backupcomplete).</span></span>

<span data-ttu-id="4f6a1-173">En el momento de la restauración, el solicitante debe iniciar la restauración relacionada con el equipo front-end (local), seleccionar los componentes y sus dependencias que se van a restaurar y, a continuación, enviar el evento de [**prerestauración**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) llamando al método **IVssBackupComponents::P rerestore** .</span><span class="sxs-lookup"><span data-stu-id="4f6a1-173">At restore time, the requester must start the restore involving the front-end (local) computer, select the components and their dependencies to be restored, and then send the [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) event by calling the **IVssBackupComponents::PreRestore** method.</span></span> <span data-ttu-id="4f6a1-174">Después, el solicitante debe poner en cola los trabajos de restauración de back-end en el equipo remoto y llamar al método [**IVssBackupComponents::P ostrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore) cuando se completen las restauraciones de back-end.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-174">The requester should then spool the back-end restore jobs on the remote computer and call the [**IVssBackupComponents::PostRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore) method when the back-end restores are complete.</span></span> <span data-ttu-id="4f6a1-175">Este requisito proporciona al escritor de front-end más control sobre la experiencia de restauración y una mejor experiencia de usuario de administrador global.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-175">This requirement gives the front-end writer more control over the restore experience and a better administrator user experience overall.</span></span> <span data-ttu-id="4f6a1-176">Dado que las copias de seguridad en cada uno de los sistemas no se producen en el mismo momento, el escritor de front-end tendrá que realizar alguna limpieza de los datos de back-end.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-176">Because the backups across each of the systems do not occur at the same point in time, the front-end writer will need to perform some cleanup of the back-end data.</span></span> <span data-ttu-id="4f6a1-177">En la aplicación de ejemplo que se describe en la sección anterior "declarar dependencias remotas", el escritor debe iniciar una reasignación de sitio o volver a indexar después de que se haya completado una restauración de una de las bases de datos de back-end.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-177">In the example application discussed in the preceding "Declaring Remote Dependencies", the writer should initiate a site remapping or reindexing after a restore of one of the back-end databases has completed.</span></span> <span data-ttu-id="4f6a1-178">Para ello, el escritor debe recibir eventos en el servidor front-end.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-178">To do this, the writer must receive events on the front-end server.</span></span> <span data-ttu-id="4f6a1-179">En el procedimiento siguiente se describe lo que debe hacer el solicitante:</span><span class="sxs-lookup"><span data-stu-id="4f6a1-179">The following procedure outlines what the requester should do:</span></span>

1.  <span data-ttu-id="4f6a1-180">En el equipo local, el solicitante llama a [**IVssBackupComponents:: InitializeForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore), [**GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), [**IVssBackupComponents:: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) (o [**IVssBackupComponentsEx:: SetSelectedForRestoreEx**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex-setselectedforrestoreex)) y [**prerestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore).</span><span class="sxs-lookup"><span data-stu-id="4f6a1-180">On the local computer, the requester calls [**IVssBackupComponents::InitializeForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore), [**GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) (or [**IVssBackupComponentsEx::SetSelectedForRestoreEx**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex-setselectedforrestoreex)), and [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore).</span></span>
2.  <span data-ttu-id="4f6a1-181">Una vez completada la fase de [**prerestauración**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) , pero antes de que se inicie la fase de [**postrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore) , el solicitante pone en cola los trabajos de restauración adicionales mediante el envío de una solicitud a su agente en el equipo remoto.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-181">After the [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) phase is completed, but before the [**PostRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore) phase begins, the requester spools additional restore jobs by sending a request to its agent on the remote computer.</span></span>
3.  <span data-ttu-id="4f6a1-182">En el equipo remoto, el agente del solicitante realiza los trabajos de restauración en cola mediante una llamada a [**InitializeForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore), [**GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), [**SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore), [**prerestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore), [**SetFileRestoreStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setfilerestorestatus) (o [**SetSelectedForRestoreEx**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex-setselectedforrestoreex)) y [**postrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore).</span><span class="sxs-lookup"><span data-stu-id="4f6a1-182">On the remote computer, the requester's agent performs the spooled restore jobs by calling [**InitializeForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-initializeforrestore), [**GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), [**SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore), [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore), [**SetFileRestoreStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setfilerestorestatus) (or [**SetSelectedForRestoreEx**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex-setselectedforrestoreex)), and [**PostRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore).</span></span>
4.  <span data-ttu-id="4f6a1-183">Cuando el agente del solicitante ha completado los trabajos en cola en el equipo remoto, el solicitante completa la secuencia de restauración mediante una llamada a [**IVssBackupComponents:: SetFileRestoreStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setfilerestorestatus) y [**postrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore).</span><span class="sxs-lookup"><span data-stu-id="4f6a1-183">When the requester's agent has completed the spooled jobs on the remote computer, the requester completes the restore sequence by calling [**IVssBackupComponents::SetFileRestoreStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setfilerestorestatus) and [**PostRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore).</span></span>

<span data-ttu-id="4f6a1-184">Para proporcionar compatibilidad parcial con dependencias remotas, el solicitante debe seguir las dependencias remotas e incluirlas como parte de la copia de seguridad, pero el orden de los eventos en los sistemas front-end y back-end, tal como se detalla en los dos procedimientos anteriores, no sería necesario.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-184">To provide partial support for remote dependencies, the requester must follow remote dependencies and include them as part of the backup, but the ordering of events on front-end and back-end systems as detailed in the previous two procedures would not be required.</span></span> <span data-ttu-id="4f6a1-185">Para un solicitante que implementa solo compatibilidad parcial, el solicitante debe hacer referencia a la documentación de copia de seguridad o restauración de la aplicación de escritura para comprender qué escenarios se pueden admitir.</span><span class="sxs-lookup"><span data-stu-id="4f6a1-185">For a requester that implements only partial support, the requester should refer to the writer application's backup/restore documentation to understand what scenarios can be supported.</span></span>

 

 
