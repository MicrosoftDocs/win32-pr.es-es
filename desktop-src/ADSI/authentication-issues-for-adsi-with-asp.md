---
title: Problemas de autenticación para ADSI con ASP
description: En función de la configuración de la intranet, pueden producirse problemas de autenticación cuando se ejecuta código ADSI desde una página ASP.
ms.assetid: 287e2e19-7da9-497b-bf46-595ff4755261
ms.tgt_platform: multiple
keywords:
- ADSI, páginas ASP, problemas de autenticación
- ADSI, autenticación, problemas de ASP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 423d1aa39006f89ca366423da9d135e00af45693
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/21/2020
ms.locfileid: "103793803"
---
# <a name="authentication-issues-for-adsi-with-asp"></a><span data-ttu-id="7cc3e-105">Problemas de autenticación para ADSI con ASP</span><span class="sxs-lookup"><span data-stu-id="7cc3e-105">Authentication Issues for ADSI with ASP</span></span>

<span data-ttu-id="7cc3e-106">En función de la configuración de la intranet, pueden producirse problemas de autenticación cuando se ejecuta código ADSI desde una página ASP.</span><span class="sxs-lookup"><span data-stu-id="7cc3e-106">Depending on the configuration of your intranet, authentication issues may occur when ADSI code is run from an ASP page.</span></span>

<span data-ttu-id="7cc3e-107">La autenticación para tener acceso al controlador de dominio se puede conceder mediante la delegación.</span><span class="sxs-lookup"><span data-stu-id="7cc3e-107">Authentication to access the domain controller can be given using delegation.</span></span> <span data-ttu-id="7cc3e-108">La delegación permite a un servicio actuar como usuario, por lo que puede tener acceso a un recurso de red mediante el uso de esas credenciales de usuario.</span><span class="sxs-lookup"><span data-stu-id="7cc3e-108">Delegation permits a service to act as the user, so it can access a network resource using that user credentials.</span></span> <span data-ttu-id="7cc3e-109">Si la intranet sigue esta configuración, debe configurar IIS para utilizar la delegación.</span><span class="sxs-lookup"><span data-stu-id="7cc3e-109">If your intranet follows this configuration, you must set up IIS to use delegation.</span></span> <span data-ttu-id="7cc3e-110">Establezca el mecanismo de autenticación de IIS como anónimo o NTLM.</span><span class="sxs-lookup"><span data-stu-id="7cc3e-110">Set the IIS Authentication mechanism as Anonymous or NTLM.</span></span> <span data-ttu-id="7cc3e-111">Si elige anónimo, el contexto de seguridad se asignará a la \_ cuenta de equipo IUSR.</span><span class="sxs-lookup"><span data-stu-id="7cc3e-111">If you choose anonymous, your security context will be mapped to IUSR\_MACHINE account.</span></span> <span data-ttu-id="7cc3e-112">Si selecciona NTLM, el contexto de seguridad cambiará en función del usuario que inicie sesión en su sitio Web.</span><span class="sxs-lookup"><span data-stu-id="7cc3e-112">If you select NTLM, the security context will change, depending on which user logs on to your website.</span></span> <span data-ttu-id="7cc3e-113">Para obtener más información e instrucciones para configurar el servidor IIS para la delegación, vea [Kit de recursos de Windows 2000](https://support.microsoft.com/kb/927229).</span><span class="sxs-lookup"><span data-stu-id="7cc3e-113">For more information and instructions for setting up the IIS server for delegation, see [Windows 2000 Resource Kit](https://support.microsoft.com/kb/927229).</span></span>

<span data-ttu-id="7cc3e-114">Si usa un servidor IIS que usa el desafío/respuesta NT, o un cliente de explorador que no admite Kerberos, no se admite la autenticación de doble salto.</span><span class="sxs-lookup"><span data-stu-id="7cc3e-114">If you are using a an IIS server that uses the NT challenge/response, or a browser client that does not support Kerberos, then double-hop authentication is not supported.</span></span> <span data-ttu-id="7cc3e-115">La autenticación de doble salto significa que las credenciales del usuario se pasan desde el cliente del explorador al servidor IIS y, a continuación, el servidor IIS pasa las credenciales al servidor back-end.</span><span class="sxs-lookup"><span data-stu-id="7cc3e-115">Double-hop authentication means that the user credentials are passed from the browser client to the IIS server, and then the IIS server passes the credentials to the backend server.</span></span> <span data-ttu-id="7cc3e-116">En esta situación, puede usar una de las siguientes soluciones para permitir el acceso al directorio desde la página ASP:</span><span class="sxs-lookup"><span data-stu-id="7cc3e-116">In this situation, you can use one of the following solutions to allow access to the directory from the ASP page:</span></span>

-   <span data-ttu-id="7cc3e-117">Use [**IADsOpenDSObject:: OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) o [**ADsOpenObject**](binding-with-adsopenobject-and-iadsopendsobject-opendsobject.md) para pasar credenciales a Active Directory.</span><span class="sxs-lookup"><span data-stu-id="7cc3e-117">Use [**IADsOpenDSObject::OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) or [**ADsOpenObject**](binding-with-adsopenobject-and-iadsopendsobject-opendsobject.md) to pass credentials to Active Directory.</span></span> <span data-ttu-id="7cc3e-118">La página web autentica al usuario conectado con el servidor IIS.</span><span class="sxs-lookup"><span data-stu-id="7cc3e-118">The webpage authenticates the connected user against the IIS server.</span></span> <span data-ttu-id="7cc3e-119">Cuando el usuario se ha autenticado, la página web puede usar OpenDSObject o ADsOpenObject para pasar un nombre de usuario y una contraseña al servicio de directorio para obtener la autenticación en el servidor back-end.</span><span class="sxs-lookup"><span data-stu-id="7cc3e-119">When the user has been authenticated, the webpage can use OpenDSObject or ADsOpenObject to pass a user name and password to the directory service to obtain authentication to the backend server.</span></span> <span data-ttu-id="7cc3e-120">La página web puede tener acceso a los datos desde el directorio.</span><span class="sxs-lookup"><span data-stu-id="7cc3e-120">The webpage can then access data from the directory.</span></span>
-   <span data-ttu-id="7cc3e-121">Agregue el código a un objeto COM y colóquelo en una [aplicación com+](../cossdk/com--application-overview.md) (anteriormente denominada paquete mts).</span><span class="sxs-lookup"><span data-stu-id="7cc3e-121">Add your code to a COM object and put this object into a [COM+ application](../cossdk/com--application-overview.md) (previously called an MTS package).</span></span> <span data-ttu-id="7cc3e-122">La aplicación COM+ puede ejecutarse como una [cuenta de usuario de dominio](/windows/desktop/AD/domain-user-accounts).</span><span class="sxs-lookup"><span data-stu-id="7cc3e-122">The COM+ application can then be run as a [domain user account](/windows/desktop/AD/domain-user-accounts).</span></span>
-   <span data-ttu-id="7cc3e-123">Usar varias páginas ASP, donde una página autentica al cliente y otra página pasa credenciales al directorio mediante la autenticación anónima en una cuenta de usuario de dominio.</span><span class="sxs-lookup"><span data-stu-id="7cc3e-123">Use multiple ASP pages, where one page authenticates the client and another page passes credentials to the directory using anonymous authentication on a domain user account.</span></span>

<span data-ttu-id="7cc3e-124">Estos métodos implican la autenticación del cliente web y el cambio de las credenciales al ponerse en contacto con el directorio, ya que no es posible la autenticación de doble salto con las mismas credenciales.</span><span class="sxs-lookup"><span data-stu-id="7cc3e-124">These methods involve authenticating the web client and then changing the credentials when contacting the directory because double-hop authentication, with the same credentials, is not possible.</span></span>

 

 