---
title: Realizar y procesar llamadas asincrónicas
description: Los objetos COM pueden admitir llamadas asincrónicas.
ms.assetid: bf7f9f8e-66ce-41a4-854c-62dbe840a89e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 059f55cc64a70f130e7fb654426803edbe8b7209
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/21/2020
ms.locfileid: "105695766"
---
# <a name="making-and-processing-asynchronous-calls"></a><span data-ttu-id="864b8-103">Realizar y procesar llamadas asincrónicas</span><span class="sxs-lookup"><span data-stu-id="864b8-103">Making and Processing Asynchronous Calls</span></span>

<span data-ttu-id="864b8-104">Los objetos COM pueden admitir llamadas asincrónicas.</span><span class="sxs-lookup"><span data-stu-id="864b8-104">COM objects can support asynchronous calling.</span></span> <span data-ttu-id="864b8-105">Cuando un cliente realiza una llamada asincrónica, el control vuelve al cliente inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="864b8-105">When a client makes an asynchronous call, control returns to the client immediately.</span></span> <span data-ttu-id="864b8-106">Mientras el servidor procesa la llamada, el cliente es gratuito para realizar otro trabajo.</span><span class="sxs-lookup"><span data-stu-id="864b8-106">While the server processes the call, the client is free to do other work.</span></span> <span data-ttu-id="864b8-107">Cuando el cliente ya no puede continuar sin los resultados de la llamada, puede obtener los resultados de la llamada en ese momento.</span><span class="sxs-lookup"><span data-stu-id="864b8-107">When the client can no longer proceed without the results of the call, it can get the results of the call at that time.</span></span>

<span data-ttu-id="864b8-108">Por ejemplo, una solicitud para un conjunto de registros grande o complejo puede llevar mucho tiempo.</span><span class="sxs-lookup"><span data-stu-id="864b8-108">For example, a request for a large or complex recordset can be time-consuming.</span></span> <span data-ttu-id="864b8-109">Un cliente puede solicitar el conjunto de registros mediante una llamada asincrónica y, a continuación, realizar otro trabajo.</span><span class="sxs-lookup"><span data-stu-id="864b8-109">A client can request the recordset by an asynchronous call and then do other work.</span></span> <span data-ttu-id="864b8-110">Cuando el conjunto de registros está disponible, el cliente puede obtenerlo rápidamente sin bloqueos.</span><span class="sxs-lookup"><span data-stu-id="864b8-110">When the recordset is available, the client can obtain it quickly without blocking.</span></span>

<span data-ttu-id="864b8-111">Los clientes no realizan llamadas asincrónicas directamente en el objeto de servidor.</span><span class="sxs-lookup"><span data-stu-id="864b8-111">Clients do not make asynchronous calls directly on the server object.</span></span> <span data-ttu-id="864b8-112">En su lugar, obtienen un objeto de llamada que implementa una versión asincrónica de una interfaz sincrónica en el objeto de servidor.</span><span class="sxs-lookup"><span data-stu-id="864b8-112">Instead, they obtain a call object that implements an asynchronous version of a synchronous interface on the server object.</span></span> <span data-ttu-id="864b8-113">La interfaz asincrónica en el objeto Call tiene un nombre con el formato Async *interfacename*.</span><span class="sxs-lookup"><span data-stu-id="864b8-113">The asynchronous interface on the call object has a name of the form Async *InterfaceName*.</span></span> <span data-ttu-id="864b8-114">Por ejemplo, si un objeto de servidor implementa una interfaz sincrónica denominada IMyInterface, habrá un objeto de llamada que implementa una interfaz asincrónica denominada AsyncIMyInterface.</span><span class="sxs-lookup"><span data-stu-id="864b8-114">For example, if a server object implements a synchronous interface named IMyInterface, there will be a call object that implements an asynchronous interface named AsyncIMyInterface.</span></span>

> [!Note]  
> <span data-ttu-id="864b8-115">La compatibilidad asincrónica no está disponible para **IDispatch** o para interfaces que heredan **IDispatch**.</span><span class="sxs-lookup"><span data-stu-id="864b8-115">Asynchronous support is not available for **IDispatch** or for interfaces that inherit **IDispatch**.</span></span>

 

<span data-ttu-id="864b8-116">Los objetos de servidor que admiten llamadas asincrónicas implementan la interfaz [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory) .</span><span class="sxs-lookup"><span data-stu-id="864b8-116">Server objects that support asynchronous calls implement the [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory) interface.</span></span> <span data-ttu-id="864b8-117">Esta interfaz expone un método único, [**CreateCall**](/windows/win32/api/objidlbase/nf-objidlbase-icallfactory-createcall), que crea una instancia de un objeto de llamada especificado.</span><span class="sxs-lookup"><span data-stu-id="864b8-117">This interface exposes a single method, [**CreateCall**](/windows/win32/api/objidlbase/nf-objidlbase-icallfactory-createcall), which creates an instance of a specified call object.</span></span> <span data-ttu-id="864b8-118">Los clientes pueden consultar **ICallFactory** para determinar si un objeto admite llamadas asincrónicas.</span><span class="sxs-lookup"><span data-stu-id="864b8-118">Clients can query for **ICallFactory** to determine whether an object supports asynchronous calling.</span></span>

<span data-ttu-id="864b8-119">Para cada método en una interfaz sincrónica, la interfaz asincrónica correspondiente implementa dos métodos.</span><span class="sxs-lookup"><span data-stu-id="864b8-119">For each method on a synchronous interface, the corresponding asynchronous interface implements two methods.</span></span> <span data-ttu-id="864b8-120">Estos métodos adjuntan los prefijos Begin \_ y Finish \_ al nombre del método sincrónico.</span><span class="sxs-lookup"><span data-stu-id="864b8-120">These methods attach the prefixes Begin\_ and Finish\_ to the name of the synchronous method.</span></span> <span data-ttu-id="864b8-121">Por ejemplo, si una interfaz denominada ISimpleStream tiene un método de lectura, la interfaz AsyncISimpleStream tendrá un método de lectura Begin \_ y de finalización \_ .</span><span class="sxs-lookup"><span data-stu-id="864b8-121">For example, if an interface named ISimpleStream has a Read method, the AsyncISimpleStream interface will have a Begin\_Read and a Finish\_Read method.</span></span> <span data-ttu-id="864b8-122">Para comenzar una llamada asincrónica, el cliente llama al método Begin \_ .</span><span class="sxs-lookup"><span data-stu-id="864b8-122">To begin an asynchronous call, the client calls the Begin\_ method.</span></span>

<span data-ttu-id="864b8-123">Cuando se implementa un objeto de servidor, no es necesario proporcionar un objeto de llamada para cada interfaz que implementa el objeto.</span><span class="sxs-lookup"><span data-stu-id="864b8-123">When you implement a server object, you do not have to provide a call object for every interface the object implements.</span></span> <span data-ttu-id="864b8-124">Si el objeto de servidor implementa la interfaz [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory) y usa el cálculo de referencias estándar, un cliente con cálculo de referencias siempre puede obtener un objeto de llamada de proxy, incluso si no hay ningún objeto de llamada en el lado del servidor.</span><span class="sxs-lookup"><span data-stu-id="864b8-124">If the server object implements the [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory) interface and uses standard marshaling, a marshaled client can always obtain a proxy call object, even if there is no call object on the server side.</span></span> <span data-ttu-id="864b8-125">Este proxy serializará el \_ método Begin como una llamada sincrónica, el servidor procesará la llamada de forma sincrónica y el cliente puede obtener los parámetros out llamando al método Finish \_ .</span><span class="sxs-lookup"><span data-stu-id="864b8-125">This proxy will marshal the Begin\_ method as a synchronous call, the server will process the call synchronously, and the client can obtain the out parameters by calling the Finish\_ method.</span></span>

<span data-ttu-id="864b8-126">Por el contrario, si un cliente realiza una llamada sincrónica de serialización en una interfaz para la que hay un objeto de llamada en el lado servidor, el servidor siempre procesará la llamada de forma asincrónica.</span><span class="sxs-lookup"><span data-stu-id="864b8-126">Conversely, if a client makes a marshaled synchronous call on an interface for which there is a call object on the server side, the server will always process the call asynchronously.</span></span> <span data-ttu-id="864b8-127">Este comportamiento no será aparente para el cliente, ya que el cliente recibirá los mismos parámetros out y el mismo valor devuelto que habría recibido del método sincrónico.</span><span class="sxs-lookup"><span data-stu-id="864b8-127">This behavior will not be apparent to the client, because the client will receive the same out parameters and the same return value it would have received from the synchronous method.</span></span>

<span data-ttu-id="864b8-128">En cualquier caso, la interacción entre el cliente y el servidor se calcula como si la llamada fuera sincrónica: la salida de los proxies sincrónicos y asincrónicos es indistinguible, como es la salida del código auxiliar correspondiente.</span><span class="sxs-lookup"><span data-stu-id="864b8-128">In either case, the interaction between client and server is marshaled as if the call were synchronous: The output of synchronous and asynchronous proxies is indistinguishable, as is the output of the corresponding stubs.</span></span> <span data-ttu-id="864b8-129">Este comportamiento simplifica considerablemente el modelo de programación de los clientes y de los servidores.</span><span class="sxs-lookup"><span data-stu-id="864b8-129">This behavior greatly simplifies the programming model both of clients and of servers.</span></span> <span data-ttu-id="864b8-130">Si un objeto de servidor implementa [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory), un cliente serializado no tiene que intentar crear un objeto de llamada que puede no estar disponible; para el cliente, siempre está disponible un objeto de llamada.</span><span class="sxs-lookup"><span data-stu-id="864b8-130">If a server object implements [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory), a marshaled client does not have to attempt to create a call object that may not be available — to the client, a call object is always available.</span></span>

<span data-ttu-id="864b8-131">Cuando el cliente y el servidor están en el mismo apartamento, el objeto de servidor procesará la llamada que realice el cliente.</span><span class="sxs-lookup"><span data-stu-id="864b8-131">When client and server are in the same apartment, the server object will process whichever call the client makes.</span></span> <span data-ttu-id="864b8-132">Si un objeto de llamada no está disponible, el cliente debe obtener explícitamente la interfaz sincrónica y hacer una llamada sincrónica.</span><span class="sxs-lookup"><span data-stu-id="864b8-132">If a call object is not available, the client must explicitly obtain the synchronous interface and make a synchronous call.</span></span>

<span data-ttu-id="864b8-133">Para obtener más información, vea los temas siguientes:</span><span class="sxs-lookup"><span data-stu-id="864b8-133">For more information, see the following topics:</span></span>

-   [<span data-ttu-id="864b8-134">Realización de una llamada asincrónica</span><span class="sxs-lookup"><span data-stu-id="864b8-134">Making an Asynchronous Call</span></span>](making-an-asynchronous-call.md)
-   [<span data-ttu-id="864b8-135">Cancelar una llamada asincrónica</span><span class="sxs-lookup"><span data-stu-id="864b8-135">Canceling an Asynchronous Call</span></span>](canceling-an-asynchronous-call.md)
-   [<span data-ttu-id="864b8-136">Cancelar llamadas a métodos</span><span class="sxs-lookup"><span data-stu-id="864b8-136">Canceling Method Calls</span></span>](canceling-method-calls.md)
-   [<span data-ttu-id="864b8-137">Sincronización de llamadas</span><span class="sxs-lookup"><span data-stu-id="864b8-137">Call Synchronization</span></span>](call-synchronization.md)

 

 