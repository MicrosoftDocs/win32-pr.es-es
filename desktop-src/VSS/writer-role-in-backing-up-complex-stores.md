---
description: Como con todas las operaciones importantes de VSS, las copias de seguridad incrementales y diferenciales requieren una estrecha colaboración entre los solicitantes y los escritores.
ms.assetid: 3cf5dd1f-dc58-42bc-925f-fee7d34053c5
title: Rol de escritor en copias de seguridad de almacenes complejos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 80864256b9a19c25a2f0dce0d0c929ed19fd7269
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104154321"
---
# <a name="writer-role-in-backing-up-complex-stores"></a><span data-ttu-id="064d2-103">Rol de escritor en copias de seguridad de almacenes complejos</span><span class="sxs-lookup"><span data-stu-id="064d2-103">Writer Role in Backing Up Complex Stores</span></span>

<span data-ttu-id="064d2-104">Como con todas las operaciones importantes de VSS, las copias de seguridad [*incrementales*](vssgloss-i.md) y [*diferenciales*](vssgloss-d.md) requieren una estrecha colaboración entre los solicitantes y los escritores.</span><span class="sxs-lookup"><span data-stu-id="064d2-104">As with all important operations under VSS, [*incremental*](vssgloss-i.md) and [*differential*](vssgloss-d.md) backups require close cooperation between requesters and writers.</span></span>

## <a name="backup-types"></a><span data-ttu-id="064d2-105">Tipos de copia de seguridad</span><span class="sxs-lookup"><span data-stu-id="064d2-105">Backup Types</span></span>

<span data-ttu-id="064d2-106">La infraestructura proporciona compatibilidad especial para cinco tipos de copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="064d2-106">The infrastructure provides special support for five types of backup.</span></span> <span data-ttu-id="064d2-107">A continuación se detalla la descripción de estos pasos:</span><span class="sxs-lookup"><span data-stu-id="064d2-107">They are described as follows:</span></span>

-   <span data-ttu-id="064d2-108">Completo (**VSS \_ BT \_ completo**).</span><span class="sxs-lookup"><span data-stu-id="064d2-108">Full (**VSS\_BT\_FULL**).</span></span> <span data-ttu-id="064d2-109">Se realizará una copia de seguridad de los archivos, independientemente de la fecha de la última copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="064d2-109">Files will be backed up regardless of their last backup date.</span></span> <span data-ttu-id="064d2-110">Se actualizará el historial de copia de seguridad de cada archivo y este tipo de copia de seguridad se puede usar como base de una copia de seguridad incremental o diferencial.</span><span class="sxs-lookup"><span data-stu-id="064d2-110">The backup history of each file will be updated, and this type of backup can be used as the basis of an incremental or differential backup.</span></span> <span data-ttu-id="064d2-111">Si hay archivos de registro, se pueden truncar como resultado de esta copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="064d2-111">If there are log files, they may be truncated as a result of this backup.</span></span>

    <span data-ttu-id="064d2-112">La restauración de una copia de seguridad completa requiere una sola imagen de copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="064d2-112">Restoring a full backup requires only a single backup image.</span></span>

-   <span data-ttu-id="064d2-113">Diferencial (**\_ \_ diferencial de VSS BT**).</span><span class="sxs-lookup"><span data-stu-id="064d2-113">Differential (**VSS\_BT\_DIFFERENTIAL**).</span></span> <span data-ttu-id="064d2-114">La API de VSS se usa para garantizar que solo los archivos que se han cambiado o agregado desde la última copia de seguridad completa se copien en un medio de almacenamiento. se omite toda la información de copia de seguridad intermedia.</span><span class="sxs-lookup"><span data-stu-id="064d2-114">The VSS API is used to ensure that only files that have been changed or added since the last full backup are to be copied to a storage medium; all intermediate backup information is ignored.</span></span> <span data-ttu-id="064d2-115">Esto puede incluir archivos completos o intervalos específicos dentro de los archivos.</span><span class="sxs-lookup"><span data-stu-id="064d2-115">This may include entire files, or specific ranges within files.</span></span> <span data-ttu-id="064d2-116">Una copia de seguridad diferencial está asociada a una copia de seguridad completa y, por lo general, no se puede restaurar hasta que se haya restaurado la copia de seguridad completa.</span><span class="sxs-lookup"><span data-stu-id="064d2-116">A differential backup is associated with a full backup, and generally cannot be restored until the full backup has been restored.</span></span> <span data-ttu-id="064d2-117">Si hay archivos de registro, normalmente no se truncarán como resultado de esta copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="064d2-117">If there are log files, they will usually not be truncated as a result of this backup.</span></span>

    <span data-ttu-id="064d2-118">La restauración de una copia de seguridad diferencial requiere la imagen de copia de seguridad original y la imagen de copia de seguridad diferencial más reciente realizada desde la última copia de seguridad completa.</span><span class="sxs-lookup"><span data-stu-id="064d2-118">Restoring a differential backup requires the original backup image and the most recent differential backup image made since the last full backup.</span></span>

-   <span data-ttu-id="064d2-119">Incremental (**se \_ \_ incremental de VSS BT**).</span><span class="sxs-lookup"><span data-stu-id="064d2-119">Incremental (**VSS\_BT\_INCREMENTAL**).</span></span> <span data-ttu-id="064d2-120">La API de VSS se usa para asegurarse de que solo los archivos que se han cambiado o agregado desde la última copia de seguridad completa o incremental se copiarán en un medio de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="064d2-120">The VSS API is used to ensure that only files that have been changed or added since the last full or incremental backup are to be copied to a storage medium.</span></span> <span data-ttu-id="064d2-121">Esto puede incluir archivos completos o intervalos específicos dentro de los archivos.</span><span class="sxs-lookup"><span data-stu-id="064d2-121">This may include entire files, or specific ranges within files.</span></span> <span data-ttu-id="064d2-122">Algunos escritores no permiten mezclar copias de seguridad incrementales con copias de seguridad diferenciales.</span><span class="sxs-lookup"><span data-stu-id="064d2-122">Some writers do not allow incremental backups to be mixed with differential backups.</span></span> <span data-ttu-id="064d2-123">Si hay archivos de registro, se pueden truncar como resultado de esta copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="064d2-123">If there are log files, they may be truncated as a result of this backup.</span></span>

    <span data-ttu-id="064d2-124">La restauración de una copia de seguridad incremental requiere la imagen de copia de seguridad original y todas las imágenes de copia de seguridad incremental realizadas desde la copia de seguridad inicial.</span><span class="sxs-lookup"><span data-stu-id="064d2-124">Restoring an incremental backup requires the original backup image and all incremental backup images made since the initial backup.</span></span>

-   <span data-ttu-id="064d2-125">Copia de seguridad de registros (**\_ \_ registro de VSS BT**).</span><span class="sxs-lookup"><span data-stu-id="064d2-125">Log Backup (**VSS\_BT\_LOG**).</span></span> <span data-ttu-id="064d2-126">Solo se realizará una copia de seguridad de los archivos de registro de un escritor (los archivos agregados a un componente con el método [**IVssCreateWriterMetadata:: AddDataBaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) y recuperados mediante una llamada a [**IVssWMComponent:: GetDatabaseLogFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabaselogfile)).</span><span class="sxs-lookup"><span data-stu-id="064d2-126">Only a writer's log files (files added to a component with the [**IVssCreateWriterMetadata::AddDataBaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) method, and retrieved by a call to [**IVssWMComponent::GetDatabaseLogFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabaselogfile)) will be backed up.</span></span> <span data-ttu-id="064d2-127">Este tipo de copia de seguridad es específico de VSS.</span><span class="sxs-lookup"><span data-stu-id="064d2-127">This backup type is specific to VSS.</span></span> <span data-ttu-id="064d2-128">Las copias de seguridad de registros tienden a realizarse con mucha frecuencia.</span><span class="sxs-lookup"><span data-stu-id="064d2-128">Log backups tend to be taken quite frequently.</span></span> <span data-ttu-id="064d2-129">Normalmente, el archivo de registro se truncará como resultado de esta copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="064d2-129">Typically, the log file will be truncated as a result of this backup.</span></span>
-   <span data-ttu-id="064d2-130">Copia de seguridad (copia de **VSS \_ BT \_**).</span><span class="sxs-lookup"><span data-stu-id="064d2-130">Copy Backup (**VSS\_BT\_COPY**).</span></span> <span data-ttu-id="064d2-131">Al igual que el \_ tipo de copia de seguridad completa de VSS BT, se realizará \_ una copia de seguridad de los archivos, independientemente de su fecha de última copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="064d2-131">Like the VSS\_BT\_FULL backup type, files will be backed up regardless of their last backup date.</span></span> <span data-ttu-id="064d2-132">Sin embargo, el historial de copia de seguridad de cada archivo no se actualizará y este tipo de copia de seguridad no se puede usar como base de una copia de seguridad incremental o diferencial.</span><span class="sxs-lookup"><span data-stu-id="064d2-132">However, the backup history of each file will not be updated, and this type of backup cannot be used as the basis of an incremental or differential backup.</span></span> <span data-ttu-id="064d2-133">Los archivos de registro nunca se deben truncar como resultado de una copia de seguridad de copia.</span><span class="sxs-lookup"><span data-stu-id="064d2-133">Log files should never be truncated as a result of a copy backup.</span></span>

<dl> <dt>

<span data-ttu-id="064d2-134"><span id="Partial_File_Support"></span><span id="partial_file_support"></span><span id="PARTIAL_FILE_SUPPORT"></span>Compatibilidad con archivos parciales</span><span class="sxs-lookup"><span data-stu-id="064d2-134"><span id="Partial_File_Support"></span><span id="partial_file_support"></span><span id="PARTIAL_FILE_SUPPORT"></span>Partial File Support</span></span>
</dt> <dd>

<span data-ttu-id="064d2-135">Algunos escritores admiten la restauración de archivos a través de la sobrescritura de partes de los archivos que administran.</span><span class="sxs-lookup"><span data-stu-id="064d2-135">Some writers support file restoration through the overwriting of parts of the files they manage.</span></span> <span data-ttu-id="064d2-136">Un solicitante puede estar diseñado para aprovecharse de esto y, si es así, lo indica estableciendo la información en [**IVssBackupComponents:: SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span><span class="sxs-lookup"><span data-stu-id="064d2-136">A requester may be designed to take advantage of this, and if so it indicates this by setting the information in [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span></span>

</dd> </dl>

<span data-ttu-id="064d2-137">Los escritores indican qué tipo de copias de seguridad se admiten mediante una llamada a [**IVssCreateWriterMetadata:: SetBackupSchema**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setbackupschema) mientras se procesa el evento de [*identificación*](vssgloss-i.md) .</span><span class="sxs-lookup"><span data-stu-id="064d2-137">The writers indicate what type of backups are supported by calling [**IVssCreateWriterMetadata::SetBackupSchema**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setbackupschema) while processing the [*Identify*](vssgloss-i.md) event.</span></span> <span data-ttu-id="064d2-138">El parámetro *dsSchemaMask* para el método **IVssCreateWriterMetadata:: SetBackupSchema** es una máscara de bits que indica qué tipos de copia de seguridad se admiten.</span><span class="sxs-lookup"><span data-stu-id="064d2-138">The *dsSchemaMask* parameter to the **IVssCreateWriterMetadata::SetBackupSchema** method is a bit mask indicating what types of backup are supported.</span></span> <span data-ttu-id="064d2-139">Todos los escritores deben admitir copias de seguridad completas.</span><span class="sxs-lookup"><span data-stu-id="064d2-139">All writers must support full backups.</span></span>

<dl> <dt>

<span data-ttu-id="064d2-140"><span id="VSS_BS_DIFFERENTIAL"></span><span id="vss_bs_differential"></span>**diferencial de VSS \_ BS \_**</span><span class="sxs-lookup"><span data-stu-id="064d2-140"><span id="VSS_BS_DIFFERENTIAL"></span><span id="vss_bs_differential"></span>**VSS\_BS\_DIFFERENTIAL**</span></span>
</dt> <dd>

<span data-ttu-id="064d2-141">Indica la compatibilidad con copias de seguridad diferenciales.</span><span class="sxs-lookup"><span data-stu-id="064d2-141">Indicates support for differential backups.</span></span>

</dd> <dt>

<span data-ttu-id="064d2-142"><span id="VSS_BS_INCREMENTAL"></span><span id="vss_bs_incremental"></span>**de VSS \_ BS \_ incremental**</span><span class="sxs-lookup"><span data-stu-id="064d2-142"><span id="VSS_BS_INCREMENTAL"></span><span id="vss_bs_incremental"></span>**VSS\_BS\_INCREMENTAL**</span></span>
</dt> <dd>

<span data-ttu-id="064d2-143">Indica la compatibilidad con copias de seguridad incrementales.</span><span class="sxs-lookup"><span data-stu-id="064d2-143">Indicates support for incremental backups.</span></span>

</dd> <dt>

<span data-ttu-id="064d2-144"><span id="VSS_BS_LOG"></span><span id="vss_bs_log"></span>**registro de VSS \_ BS \_**</span><span class="sxs-lookup"><span data-stu-id="064d2-144"><span id="VSS_BS_LOG"></span><span id="vss_bs_log"></span>**VSS\_BS\_LOG**</span></span>
</dt> <dd>

<span data-ttu-id="064d2-145">Indica la compatibilidad con las copias de seguridad de registros.</span><span class="sxs-lookup"><span data-stu-id="064d2-145">Indicates support for log backups.</span></span>

</dd> <dt>

<span data-ttu-id="064d2-146"><span id="VSS_BS_COPY"></span><span id="vss_bs_copy"></span>**copia de VSS \_ BS \_**</span><span class="sxs-lookup"><span data-stu-id="064d2-146"><span id="VSS_BS_COPY"></span><span id="vss_bs_copy"></span>**VSS\_BS\_COPY**</span></span>
</dt> <dd>

<span data-ttu-id="064d2-147">Indica la compatibilidad con copias de seguridad de copia.</span><span class="sxs-lookup"><span data-stu-id="064d2-147">Indicates support for copy backups.</span></span>

</dd> <dt>

<span data-ttu-id="064d2-148"><span id="VSS_BS_EXCLUSIVE_INCREMENTAL_DIFFERENTIAL"></span><span id="vss_bs_exclusive_incremental_differential"></span>**\_ \_ \_ diferencial incremental exclusivo de VSS BS \_**</span><span class="sxs-lookup"><span data-stu-id="064d2-148"><span id="VSS_BS_EXCLUSIVE_INCREMENTAL_DIFFERENTIAL"></span><span id="vss_bs_exclusive_incremental_differential"></span>**VSS\_BS\_EXCLUSIVE\_INCREMENTAL\_DIFFERENTIAL**</span></span>
</dt> <dd>

<span data-ttu-id="064d2-149">Indica que un escritor no admite la combinación de copias de seguridad incrementales con copias de seguridad diferenciales.</span><span class="sxs-lookup"><span data-stu-id="064d2-149">Indicates that a writer does not support mixing incremental backups with differential backups.</span></span>

</dd> </dl>

<span data-ttu-id="064d2-150">El escritor puede determinar qué tipo de copia de seguridad se realiza mediante una llamada a [**CVssWriter:: GetBackupType**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getbackuptype).</span><span class="sxs-lookup"><span data-stu-id="064d2-150">The writer can determine what type of backup is being performed by calling [**CVssWriter::GetBackupType**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getbackuptype).</span></span> <span data-ttu-id="064d2-151">El primer punto en el que se puede realizar esto es mientras se procesa el evento PrepareForBackup.</span><span class="sxs-lookup"><span data-stu-id="064d2-151">The earliest point when this can be performed is while processing the PrepareForBackup event.</span></span> <span data-ttu-id="064d2-152">**CVssWriter:: GetBackupType** devolverá un miembro de la enumeración de [**\_ \_ tipos de copia de seguridad de VSS**](/windows/desktop/api/Vss/ne-vss-vss_backup_type) .</span><span class="sxs-lookup"><span data-stu-id="064d2-152">**CVssWriter::GetBackupType** will return a member of the [**VSS\_BACKUP\_TYPE**](/windows/desktop/api/Vss/ne-vss-vss_backup_type) enumeration.</span></span> <span data-ttu-id="064d2-153">Si el escritor no admite el tipo de copia de seguridad, el escritor debe tratar la copia de seguridad como una copia de seguridad completa.</span><span class="sxs-lookup"><span data-stu-id="064d2-153">If the backup type is not supported by the writer, then the writer should treat the backup as a full backup.</span></span>

## <a name="backup-stamps"></a><span data-ttu-id="064d2-154">Marcas de copia de seguridad</span><span class="sxs-lookup"><span data-stu-id="064d2-154">Backup Stamps</span></span>

<span data-ttu-id="064d2-155">Las copias de seguridad incrementales y diferenciales siempre están ligadas a una copia de seguridad anterior.</span><span class="sxs-lookup"><span data-stu-id="064d2-155">Incremental and differential backups are always tied to a previous backup.</span></span> <span data-ttu-id="064d2-156">Hay dos formas de asociar las copias de seguridad.</span><span class="sxs-lookup"><span data-stu-id="064d2-156">There are two ways to tie backups.</span></span> <span data-ttu-id="064d2-157">En el caso de los almacenes de datos simples, el solicitante puede realizar un seguimiento de la correlación entre las copias de seguridad.</span><span class="sxs-lookup"><span data-stu-id="064d2-157">For simple data stores, the requester can keep track of the correlation between backups.</span></span> <span data-ttu-id="064d2-158">Sin embargo, para almacenes de datos más complejos, el escritor deberá mantener su propia marca de tiempo con la copia de seguridad; esta marca de tiempo puede realizar un seguimiento de la posición del registro, la información del punto de comprobación, etc.</span><span class="sxs-lookup"><span data-stu-id="064d2-158">However, for more complex data stores, the writer will need to maintain its own timestamp with the backup; this timestamp may keep track of log position, checkpoint information, and so on.</span></span> <span data-ttu-id="064d2-159">Un escritor indica que necesita sus propias marcas de tiempo estableciendo el bit **de \_ \_ marca** de tiempo de VSS BS cuando llama a [**IVssCreateWriterMetadata:: SetBackupSchema**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setbackupschema).</span><span class="sxs-lookup"><span data-stu-id="064d2-159">A writer indicates that it needs its own timestamps by setting the **VSS\_BS\_TIMESTAMPED** bit when it calls [**IVssCreateWriterMetadata::SetBackupSchema**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setbackupschema).</span></span>

<span data-ttu-id="064d2-160">Un escritor puede almacenar una marca de tiempo con cada componente del que se realiza una copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="064d2-160">A writer can store a timestamp with each component that is being backed up.</span></span> <span data-ttu-id="064d2-161">El escritor almacena la marca de tiempo mediante una llamada a [**IVssComponent:: SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp)y pasando una representación de cadena de la marca para el parámetro *wszBackupStamp* .</span><span class="sxs-lookup"><span data-stu-id="064d2-161">The writer stores the timestamp by calling [**IVssComponent::SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp), and passing in a string representation of the stamp for the *wszBackupStamp* parameter.</span></span> <span data-ttu-id="064d2-162">Normalmente, un escritor llamará a este método mientras se procesa el evento [*postsnapshot*](vssgloss-p.md) .</span><span class="sxs-lookup"><span data-stu-id="064d2-162">Generally, a writer will call this method while processing the [*PostSnapshot*](vssgloss-p.md) event.</span></span> <span data-ttu-id="064d2-163">Sin embargo, para las copias de seguridad que no impliquen una instantánea, no se enviará el evento de instantáneas.</span><span class="sxs-lookup"><span data-stu-id="064d2-163">However, for backups that do not involve a shadow copy, the PostSnapshot event will not be sent.</span></span> <span data-ttu-id="064d2-164">En este caso, se debe llamar a **IVssComponent:: SetBackupStamp** mientras se procesa el evento [*PrepareForBackup*](vssgloss-p.md) .</span><span class="sxs-lookup"><span data-stu-id="064d2-164">In this case, **IVssComponent::SetBackupStamp** must be called while processing the [*PrepareForBackup*](vssgloss-p.md) event.</span></span>

<span data-ttu-id="064d2-165">Cuando se realiza una copia de seguridad incremental o diferencial, el solicitante indicará al escritor el sello de copia de seguridad de la copia de seguridad anterior que actúa como base para esta copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="064d2-165">When an incremental or differential backup is being performed, the requester will indicate to the writer the backup stamp of the previous backup that is serving as a base for this backup.</span></span> <span data-ttu-id="064d2-166">El escritor puede tener acceso a esta marca de copia de seguridad anterior mientras procesa el evento PrepareForBackup o postsnapshot llamando a [**IVssComponent:: GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp).</span><span class="sxs-lookup"><span data-stu-id="064d2-166">The writer can access this previous backup stamp while processing either the PrepareForBackup or PostSnapshot event, by calling [**IVssComponent::GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp).</span></span> <span data-ttu-id="064d2-167">El escritor puede usar la marca devuelta para determinar de qué se debe hacer una copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="064d2-167">The writer can use the returned stamp to determine what needs to be backed up.</span></span>

## <a name="backup-strategies"></a><span data-ttu-id="064d2-168">Estrategias de copia de seguridad</span><span class="sxs-lookup"><span data-stu-id="064d2-168">Backup Strategies</span></span>

### <a name="file-backup-files-strategies"></a><span data-ttu-id="064d2-169">Estrategias de archivos de copia de seguridad de archivos</span><span class="sxs-lookup"><span data-stu-id="064d2-169">File Backup Files Strategies</span></span>

<span data-ttu-id="064d2-170">A menudo, solo es necesario hacer una copia de seguridad de determinados archivos de los metadatos del escritor al realizar determinados tipos de copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="064d2-170">Often, certain files reported in the writer metadata need only be backed up when performing certain types of backup.</span></span> <span data-ttu-id="064d2-171">Es posible que algunos archivos solo sean necesarios cuando se realiza una copia de seguridad completa.</span><span class="sxs-lookup"><span data-stu-id="064d2-171">Some files may only be required when performing a full backup.</span></span> <span data-ttu-id="064d2-172">Es posible que otros archivos solo sean necesarios al realizar una copia de seguridad incremental o diferencial.</span><span class="sxs-lookup"><span data-stu-id="064d2-172">Other files may only be required when performing an incremental or differential backup.</span></span> <span data-ttu-id="064d2-173">VSS proporciona un método para que los escritores indiquen esta información al solicitante.</span><span class="sxs-lookup"><span data-stu-id="064d2-173">VSS provides a method for the writers to indicate this information to the requester.</span></span> <span data-ttu-id="064d2-174">Al agregar archivos a componentes mediante [**IVssCreateWriterMetadata:: AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles), [**IVssCreateWriterMetadata:: AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles)o [**IVssCreateWriterMetadata:: AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup), el parámetro *dwBackupTypeMask* indica para qué tipos de copia de seguridad se debe realizar una copia de seguridad de estos archivos.</span><span class="sxs-lookup"><span data-stu-id="064d2-174">When adding files to components using [**IVssCreateWriterMetadata::AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles), [**IVssCreateWriterMetadata::AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles), or [**IVssCreateWriterMetadata::AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup), the *dwBackupTypeMask* parameter indicates for which backup types these files must be backed up.</span></span> <span data-ttu-id="064d2-175">La máscara puede contener uno o varios de los valores siguientes:</span><span class="sxs-lookup"><span data-stu-id="064d2-175">The mask can contain one or more of the following values:</span></span>

<dl> <dt>

<span data-ttu-id="064d2-176"><span id="VSS_FSBT_FULL_BACKUP_REQUIRED"></span><span id="vss_fsbt_full_backup_required"></span>**se \_ \_ requiere la \_ copia de seguridad completa de FSBT de VSS \_**</span><span class="sxs-lookup"><span data-stu-id="064d2-176"><span id="VSS_FSBT_FULL_BACKUP_REQUIRED"></span><span id="vss_fsbt_full_backup_required"></span>**VSS\_FSBT\_FULL\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="064d2-177">Necesario para copias de seguridad completas.</span><span class="sxs-lookup"><span data-stu-id="064d2-177">Required for full backups.</span></span>

</dd> <dt>

<span data-ttu-id="064d2-178"><span id="VSS_FSBT_DIFFERENTIAL_BACKUP_REQUIRED"></span><span id="vss_fsbt_differential_backup_required"></span>**se \_ \_ requiere la \_ copia de seguridad diferencial FSBT \_ de VSS**</span><span class="sxs-lookup"><span data-stu-id="064d2-178"><span id="VSS_FSBT_DIFFERENTIAL_BACKUP_REQUIRED"></span><span id="vss_fsbt_differential_backup_required"></span>**VSS\_FSBT\_DIFFERENTIAL\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="064d2-179">Se requiere para las copias de seguridad diferenciales.</span><span class="sxs-lookup"><span data-stu-id="064d2-179">Required for differential backups.</span></span>

</dd> <dt>

<span data-ttu-id="064d2-180"><span id="VSS_FSBT_INCREMENTAL_BACKUP_REQUIRED"></span><span id="vss_fsbt_incremental_backup_required"></span>**se \_ \_ requiere la copia de seguridad incremental FSBT de VSS \_ \_**</span><span class="sxs-lookup"><span data-stu-id="064d2-180"><span id="VSS_FSBT_INCREMENTAL_BACKUP_REQUIRED"></span><span id="vss_fsbt_incremental_backup_required"></span>**VSS\_FSBT\_INCREMENTAL\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="064d2-181">Se requiere para las copias de seguridad incrementales.</span><span class="sxs-lookup"><span data-stu-id="064d2-181">Required for incremental backups.</span></span>

</dd> <dt>

<span data-ttu-id="064d2-182"><span id="VSS_FSBT_LOG_BACKUP_REQUIRED"></span><span id="vss_fsbt_log_backup_required"></span>**se \_ \_ requiere la \_ copia de seguridad de registros FSBT \_ de VSS**</span><span class="sxs-lookup"><span data-stu-id="064d2-182"><span id="VSS_FSBT_LOG_BACKUP_REQUIRED"></span><span id="vss_fsbt_log_backup_required"></span>**VSS\_FSBT\_LOG\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="064d2-183">Se requiere para las copias de seguridad de registros.</span><span class="sxs-lookup"><span data-stu-id="064d2-183">Required for log backups.</span></span>

</dd> <dt>

<span data-ttu-id="064d2-184"><span id="VSS_FSBT_ALL_BACKUP_REQUIRED"></span><span id="vss_fsbt_all_backup_required"></span>**VSS \_ FSBT \_ todas las \_ copias de seguridad \_ necesarias**</span><span class="sxs-lookup"><span data-stu-id="064d2-184"><span id="VSS_FSBT_ALL_BACKUP_REQUIRED"></span><span id="vss_fsbt_all_backup_required"></span>**VSS\_FSBT\_ALL\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="064d2-185">Obligatorio para todos los tipos de copia de seguridad; Este es el valor predeterminado.</span><span class="sxs-lookup"><span data-stu-id="064d2-185">Required for all backup types; this is the default.</span></span>

</dd> </dl>

<span data-ttu-id="064d2-186">Esta especificación invalida la especificación de selectividad del componente.</span><span class="sxs-lookup"><span data-stu-id="064d2-186">This specification overrides the component's selectivity specification.</span></span> <span data-ttu-id="064d2-187">Por ejemplo, considere un componente cuyos archivos están marcados con **la \_ copia \_ de \_ seguridad \_ de registros de VSS FSBT** , pero no con la **copia de \_ seguridad completa de VSS FSBT \_ \_ \_ necesaria**.</span><span class="sxs-lookup"><span data-stu-id="064d2-187">For example, consider a component whose files are all marked with **VSS\_FSBT\_LOG\_BACKUP\_REQUIRED** but not with **VSS\_FSBT\_FULL\_BACKUP\_REQUIRED**.</span></span> <span data-ttu-id="064d2-188">Supongamos que este componente no es seleccionable para copia de seguridad (*bSelectable* era false cuando se llamó a [**IVssCreateWriterMetadata:: AddComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponent) ).</span><span class="sxs-lookup"><span data-stu-id="064d2-188">Suppose this component is not selectable for backup (*bSelectable* was false when [**IVssCreateWriterMetadata::AddComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponent) was called).</span></span> <span data-ttu-id="064d2-189">En el caso de una copia de seguridad de registros, esto significa que siempre se debe hacer una copia de seguridad de todos los archivos de este componente.</span><span class="sxs-lookup"><span data-stu-id="064d2-189">In the case of a log backup, this means that all the files in this component must always be backed up.</span></span> <span data-ttu-id="064d2-190">Sin embargo, en el caso de una copia de seguridad completa, no es necesario hacer una copia de seguridad de ninguno de los archivos, a pesar de que la selectividad del componente implica que se debe hacer una copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="064d2-190">However, in the case of a full backup, none of the files need to be backed up, despite the fact that the component's selectivity implies it should be backed up.</span></span>

### <a name="backup-by-last-modify-time"></a><span data-ttu-id="064d2-191">Copia de seguridad por hora de última modificación</span><span class="sxs-lookup"><span data-stu-id="064d2-191">Backup By Last Modify Time</span></span>

<span data-ttu-id="064d2-192">Una manera de que un escritor indique qué archivos han cambiado es mediante el mecanismo de archivos diferenciados.</span><span class="sxs-lookup"><span data-stu-id="064d2-192">One way for a writer to indicate what files have changed is by using the differenced file mechanism.</span></span> <span data-ttu-id="064d2-193">Un escritor puede especificar que solo se debe realizar una copia de seguridad de determinados archivos de un componente si se han modificado desde un momento determinado.</span><span class="sxs-lookup"><span data-stu-id="064d2-193">A writer can specify that certain files in a component should only be backed up if they have been modified since a certain time.</span></span> <span data-ttu-id="064d2-194">El escritor llama a [**IVssComponent:: AddDifferencedFilesByLastModifyTime**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddifferencedfilesbylastmodifytime) con una especificación de archivo y una hora de última modificación.</span><span class="sxs-lookup"><span data-stu-id="064d2-194">The writer calls [**IVssComponent::AddDifferencedFilesByLastModifyTime**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddifferencedfilesbylastmodifytime) with a file specification and a last modify time.</span></span> <span data-ttu-id="064d2-195">Se suele llamar a **IVssComponent:: AddDifferencedFilesByLastModifyTime** mientras se procesa el evento de instantáneas, aunque se puede llamar mientras se procesa el evento PrepareForBackup.</span><span class="sxs-lookup"><span data-stu-id="064d2-195">**IVssComponent::AddDifferencedFilesByLastModifyTime** is typically called while processing the PostSnapshot event, although it can be called while processing the PrepareForBackup event.</span></span> <span data-ttu-id="064d2-196">Después, el solicitante debe hacer una copia de seguridad de todos los archivos que coincidan con la especificación de archivo que han cambiado desde la hora especificada.</span><span class="sxs-lookup"><span data-stu-id="064d2-196">The requester must then back up all files matching the file specification that have changed since the specified time.</span></span> <span data-ttu-id="064d2-197">Si el sistema de escritura usa el mecanismo de marca de copia de seguridad, esta hora de última modificación se determinará en función de la marca de copia de seguridad anterior en el documento de copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="064d2-197">If the writer is using the backup stamp mechanism, this last modify time will be determined based on the previous backup stamp in the backup document.</span></span> <span data-ttu-id="064d2-198">El escritor también puede pasar el valor cero para la hora de la última modificación, lo que indica que el solicitante es responsable de determinar la hora de la última copia de seguridad y los archivos que han cambiado desde ese momento.</span><span class="sxs-lookup"><span data-stu-id="064d2-198">The writer can also pass in zero for the last modify time, which indicates that the requester is responsible for determining the time of the last backup and the files changed since that time.</span></span>

### <a name="partial-file-backup"></a><span data-ttu-id="064d2-199">Copia de seguridad de archivos parcial</span><span class="sxs-lookup"><span data-stu-id="064d2-199">Partial File Backup</span></span>

<span data-ttu-id="064d2-200">Otra forma de que un escritor indique que los cambios se han realizado en el solicitante es mediante el mecanismo de archivos parciales.</span><span class="sxs-lookup"><span data-stu-id="064d2-200">Another way for a writer to indicate changes to the requester is by using the partial-file mechanism.</span></span> <span data-ttu-id="064d2-201">Un escritor puede especificar intervalos de bytes dentro de archivos de componentes de los que es necesario hacer una copia de seguridad; el escritor puede especificar estos intervalos de archivos al procesar el evento postsnapshot o PrepareForBackup.</span><span class="sxs-lookup"><span data-stu-id="064d2-201">A writer can specify byte ranges within component files that need to be backed up; the writer may specify these file ranges while processing either the PostSnapshot or PrepareForBackup event.</span></span> <span data-ttu-id="064d2-202">El escritor llama a [**IVssComponent:: AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile) para agregar especificaciones de archivo parciales a la copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="064d2-202">The writer calls [**IVssComponent::AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile) to add partial file specifications to the backup.</span></span> <span data-ttu-id="064d2-203">Una especificación de archivo parcial consta de una ruta de acceso y un nombre de archivo junto con información sobre los intervalos en los que es necesario hacer una copia de seguridad del archivo.</span><span class="sxs-lookup"><span data-stu-id="064d2-203">A partial file specification consists of a path and file name together with information about what ranges in the file need to be backed up.</span></span>

### <a name="file-specification-rules"></a><span data-ttu-id="064d2-204">Reglas de especificación de archivo</span><span class="sxs-lookup"><span data-stu-id="064d2-204">File Specification Rules</span></span>

<span data-ttu-id="064d2-205">[**IVssComponent:: AddDifferencedFilesByLastModifyTime**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddifferencedfilesbylastmodifytime) o [**IVssComponent:: AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile) se pueden usar para modificar las especificaciones de archivo proporcionadas durante el evento de identificación o para agregar archivos completamente nuevos a la especificación.</span><span class="sxs-lookup"><span data-stu-id="064d2-205">[**IVssComponent::AddDifferencedFilesByLastModifyTime**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddifferencedfilesbylastmodifytime) or [**IVssComponent::AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile) can both be used to modify file specifications given during the Identify event, or to add completely new files to the specification.</span></span> <span data-ttu-id="064d2-206">Si el escritor modifica la información establecida durante el evento de identificación mediante **IVssComponent:: AddDifferencedFilesByLastModifyTime**, la especificación de archivo debe coincidir exactamente con una de las especificaciones de archivo del componente actual.</span><span class="sxs-lookup"><span data-stu-id="064d2-206">If the writer is modifying information set during the Identify event using **IVssComponent::AddDifferencedFilesByLastModifyTime**, then the file specification must exactly match one of the file specifications in the current component.</span></span> <span data-ttu-id="064d2-207">La especificación del archivo no debe superponerse parcialmente a los archivos del componente actual y no debe coincidir con los archivos de otros componentes.</span><span class="sxs-lookup"><span data-stu-id="064d2-207">The file specification must not partially overlap files in the current component, and it must not match files in any other components.</span></span> <span data-ttu-id="064d2-208">Los archivos especificados mediante **IVssComponent:: AddPartialFile** pueden superponerse parcialmente a otra especificación de archivo.</span><span class="sxs-lookup"><span data-stu-id="064d2-208">Files specified using **IVssComponent::AddPartialFile** can, however, partially overlap another file specification.</span></span> <span data-ttu-id="064d2-209">La información establecida por **IVssComponent:: AddDifferencedFilesByLastModifyTime** o **IVssComponent:: AddPartialFile** invalida el conjunto de información anterior mediante la interfaz [**IVssCreateWriterMetadata**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata) en respuesta al evento de identificación.</span><span class="sxs-lookup"><span data-stu-id="064d2-209">Information set by **IVssComponent::AddDifferencedFilesByLastModifyTime** or **IVssComponent::AddPartialFile** overrides the information set earlier using the [**IVssCreateWriterMetadata**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscreatewritermetadata) interface in response to the Identify event.</span></span>

<span data-ttu-id="064d2-210">Las especificaciones de archivo generales pueden tener un valor de ubicación alternativa (establecido por el parámetro *wszAlternateLocation* de [**IVssCreateWriterMetadata:: AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup)) que indica una ubicación alternativa en la que obtener el archivo en el momento de la copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="064d2-210">General file specifications can have an alternate-location value (set by the *wszAlternateLocation* parameter of [**IVssCreateWriterMetadata::AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup)) that indicates an alternate location to obtain the file from at backup time.</span></span> <span data-ttu-id="064d2-211">Si la especificación de archivo establecida a través de los mecanismos de archivos diferenciados o parciales coincide con una especificación de archivo existente que tiene una ubicación alternativa, la aplicación de copia de seguridad obtendrá los datos de esta ubicación alternativa.</span><span class="sxs-lookup"><span data-stu-id="064d2-211">If the file specification set through the differenced-file or partial-file mechanisms matches an existing file specification that has an alternate location, the backup application will obtain the data from this alternate location.</span></span>

<span data-ttu-id="064d2-212">Si la especificación de archivo establecida en [**IVssComponent:: AddDifferencedFilesByLastModifyTime**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddifferencedfilesbylastmodifytime) o en [**IVssComponent:: AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile) no coincide con los archivos del componente del que se realiza la copia de seguridad, se agregan ahora todos los archivos coincidentes a la copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="064d2-212">If the file specification set in [**IVssComponent::AddDifferencedFilesByLastModifyTime**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddifferencedfilesbylastmodifytime) or in [**IVssComponent::AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile) does not match and files in the component that are being backed up, then all matching files are now added to the backup.</span></span> <span data-ttu-id="064d2-213">Se debe tener cuidado de que el escritor solo agregue los archivos que existen en un volumen del que ya se están realizando instantáneas mientras lo hace. de lo contrario, es posible que el solicitante no pueda realizar una copia de seguridad de estos archivos.</span><span class="sxs-lookup"><span data-stu-id="064d2-213">Care must be taken that the writer only adds files that exist on a volume that is already being shadow copied while doing this; otherwise, the requester may fail to back up these files.</span></span> <span data-ttu-id="064d2-214">Si se llama a estas funciones mientras se procesa el evento de instantáneas, se puede determinar mediante el método [**CVssWriter:: IsPathAffected**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-ispathaffected) .</span><span class="sxs-lookup"><span data-stu-id="064d2-214">If these functions are called while processing the PostSnapshot event, this can be determined by using the [**CVssWriter::IsPathAffected**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-ispathaffected) method.</span></span> <span data-ttu-id="064d2-215">Si se llama mientras se controla el evento PrepareForBackup, el escritor debe tomar esta determinación mediante otro método.</span><span class="sxs-lookup"><span data-stu-id="064d2-215">If called while handling the PrepareForBackup event, the writer must make this determination using another method.</span></span>

### <a name="backup-without-a-shadow-copy"></a><span data-ttu-id="064d2-216">Copia de seguridad sin una instantánea</span><span class="sxs-lookup"><span data-stu-id="064d2-216">Backup Without a Shadow Copy</span></span>

<span data-ttu-id="064d2-217">Es posible que no sea necesario hacer una copia de seguridad de determinados tipos de archivos en un volumen de instantáneas.</span><span class="sxs-lookup"><span data-stu-id="064d2-217">Certain types of files may not need to be backed up off of a shadow copy volume.</span></span> <span data-ttu-id="064d2-218">Por ejemplo, esto suele ser cierto en los archivos de registro de base de datos.</span><span class="sxs-lookup"><span data-stu-id="064d2-218">For example, this will often be true of database log files.</span></span> <span data-ttu-id="064d2-219">Dado que los archivos de registro crecen de forma monotónica, y un escritor puede especificar exactamente qué partes del archivo se van a incluir en la copia de seguridad mediante archivos parciales, a menudo es posible realizar una copia de seguridad del volumen original.</span><span class="sxs-lookup"><span data-stu-id="064d2-219">Since log files grow monotonically, and a writer can specify exactly what portions of the file to back up using partial files, it will often be possible to back up the log off the original volume.</span></span> <span data-ttu-id="064d2-220">Como optimización, un escritor puede marcar qué archivos requieren instantáneas para diferentes tipos de copia de seguridad mediante las marcas establecidas en el parámetro *dwBackupTypeMask* de [**IVssCreateWriterMetadata:: AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles), [**IVssCreateWriterMetadata:: AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles)o [**IVssCreateWriterMetadata:: AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup).</span><span class="sxs-lookup"><span data-stu-id="064d2-220">As an optimization, a writer can mark which files require shadow copies for different backup types using the flags set in the *dwBackupTypeMask* parameter of [**IVssCreateWriterMetadata::AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles), [**IVssCreateWriterMetadata::AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles), or [**IVssCreateWriterMetadata::AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup).</span></span> <span data-ttu-id="064d2-221">Entre las marcas admitidas se incluyen las siguientes:</span><span class="sxs-lookup"><span data-stu-id="064d2-221">Supported flags include the following:</span></span>

<dl> <dt>

<span data-ttu-id="064d2-222"><span id="VSS_FSBT_FULL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_full_snapshot_required"></span>**se \_ \_ requiere una \_ instantánea \_ completa de FSBT de VSS**</span><span class="sxs-lookup"><span data-stu-id="064d2-222"><span id="VSS_FSBT_FULL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_full_snapshot_required"></span>**VSS\_FSBT\_FULL\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="064d2-223">Instantánea necesaria para las copias de seguridad completas.</span><span class="sxs-lookup"><span data-stu-id="064d2-223">Shadow copy required for full backups.</span></span>

</dd> <dt>

<span data-ttu-id="064d2-224"><span id="VSS_FSBT_DIFFERENTIAL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_differential_snapshot_required"></span>**se \_ \_ requiere la \_ instantánea \_ diferencial FSBT de VSS**</span><span class="sxs-lookup"><span data-stu-id="064d2-224"><span id="VSS_FSBT_DIFFERENTIAL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_differential_snapshot_required"></span>**VSS\_FSBT\_DIFFERENTIAL\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="064d2-225">Instantánea necesaria para las copias de seguridad diferenciales.</span><span class="sxs-lookup"><span data-stu-id="064d2-225">Shadow copy required for differential backups.</span></span>

</dd> <dt>

<span data-ttu-id="064d2-226"><span id="VSS_FSBT_INCREMENTAL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_incremental_snapshot_required"></span>**se \_ \_ requiere la instantánea incremental FSBT de VSS \_ \_**</span><span class="sxs-lookup"><span data-stu-id="064d2-226"><span id="VSS_FSBT_INCREMENTAL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_incremental_snapshot_required"></span>**VSS\_FSBT\_INCREMENTAL\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="064d2-227">Instantánea necesaria para las copias de seguridad incrementales.</span><span class="sxs-lookup"><span data-stu-id="064d2-227">Shadow copy required for incremental backups.</span></span>

</dd> <dt>

<span data-ttu-id="064d2-228"><span id="VSS_FSBT_LOG_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_log_snapshot_required"></span>**se \_ \_ requiere la \_ instantánea de registro FSBT de VSS \_**</span><span class="sxs-lookup"><span data-stu-id="064d2-228"><span id="VSS_FSBT_LOG_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_log_snapshot_required"></span>**VSS\_FSBT\_LOG\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="064d2-229">Instantánea necesaria para las copias de seguridad de registros.</span><span class="sxs-lookup"><span data-stu-id="064d2-229">Shadow copy required for log backups.</span></span>

</dd> <dt>

<span data-ttu-id="064d2-230"><span id="VSS_FSBT_ALL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_all_snapshot_required"></span>**VSS \_ FSBT \_ todas las \_ instantáneas \_ necesarias**</span><span class="sxs-lookup"><span data-stu-id="064d2-230"><span id="VSS_FSBT_ALL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_all_snapshot_required"></span>**VSS\_FSBT\_ALL\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="064d2-231">Instantánea necesaria para todos los tipos de copia de seguridad; Este es el valor predeterminado.</span><span class="sxs-lookup"><span data-stu-id="064d2-231">Shadow copy required for all backup types; this is the default.</span></span>

</dd> </dl>

<span data-ttu-id="064d2-232">Si un volumen específico solo contiene componentes que no requieren una instantánea para esta copia de seguridad, el solicitante puede omitir el paso de crear una instantánea para este volumen.</span><span class="sxs-lookup"><span data-stu-id="064d2-232">If a specific volume contains only components that do not require a shadow copy for this backup, the requester can skip the step of creating a shadow copy for this volume.</span></span> <span data-ttu-id="064d2-233">Todos los datos de este volumen se pueden copiar directamente en el medio de copia de seguridad desde el volumen original.</span><span class="sxs-lookup"><span data-stu-id="064d2-233">All the data on this volume can be copied to the backup media directly from the original volume.</span></span>

## <a name="backup-cleanup"></a><span data-ttu-id="064d2-234">Limpieza de copias de seguridad</span><span class="sxs-lookup"><span data-stu-id="064d2-234">Backup Cleanup</span></span>

<span data-ttu-id="064d2-235">Si el escritor necesita realizar el truncamiento del registro u otra limpieza posterior a la copia de seguridad, el lugar adecuado para hacerlo es mientras se procesa el evento [*BackupComplete*](vssgloss-b.md) .</span><span class="sxs-lookup"><span data-stu-id="064d2-235">If the writer needs to perform log truncation or other post-backup cleanup, the proper place to do this is while processing the [*BackupComplete*](vssgloss-b.md) event.</span></span> <span data-ttu-id="064d2-236">El evento [*BackupShutdown*](vssgloss-b.md) se enviará algún tiempo después de BackupComplete, por lo que también puede realizarse una limpieza en el controlador de eventos BackupShutdown.</span><span class="sxs-lookup"><span data-stu-id="064d2-236">The [*BackupShutdown*](vssgloss-b.md) event will be sent some time after BackupComplete, so some cleanup may also be done in the BackupShutdown event handler.</span></span>

<span data-ttu-id="064d2-237">El evento BackupShutdown siempre se envía después de la finalización de una copia de seguridad.</span><span class="sxs-lookup"><span data-stu-id="064d2-237">The BackupShutdown event is always sent after termination of a backup.</span></span> <span data-ttu-id="064d2-238">Si el solicitante finaliza de forma anómala mientras realiza una copia de seguridad, BackupShutdown se enviará inmediatamente, sin enviar primero BackupComplete.</span><span class="sxs-lookup"><span data-stu-id="064d2-238">If the requester terminates abnormally while performing a backup, BackupShutdown will be sent immediately, without first sending BackupComplete.</span></span> <span data-ttu-id="064d2-239">Si el escritor necesita limpiar cualquier Estado, esto se puede hacer aquí; sin embargo, el truncamiento del registro no debería producirse en este evento porque la copia de seguridad no se completó necesariamente.</span><span class="sxs-lookup"><span data-stu-id="064d2-239">If the writer needs to clean up any state, that may be done here; however, log truncation should not happen in this event because the backup did not necessarily complete.</span></span>

## <a name="restore-strategies"></a><span data-ttu-id="064d2-240">Estrategias de restauración</span><span class="sxs-lookup"><span data-stu-id="064d2-240">Restore Strategies</span></span>

<span data-ttu-id="064d2-241">Las tareas básicas de los escritores en la restauración son para comprobar que la restauración se puede realizar en el control del evento de prerestauración y que la restauración se ha producido en el control del evento postrestore.</span><span class="sxs-lookup"><span data-stu-id="064d2-241">The basic tasks of writers at restore are to verify that the restore can happen in handling the PreRestore event, and that the restore has happened in handling the PostRestore event.</span></span> <span data-ttu-id="064d2-242">Los almacenes más complejos también realizarán un proceso de recuperación en el controlador de postrestore.</span><span class="sxs-lookup"><span data-stu-id="064d2-242">More complex stores will also perform a recovery process in the PostRestore handler.</span></span> <span data-ttu-id="064d2-243">Si la restauración es parte de una restauración incremental o diferencial, el escritor normalmente querrá retrasar este proceso de recuperación hasta que se hayan completado todas las restauraciones incrementales o diferenciales.</span><span class="sxs-lookup"><span data-stu-id="064d2-243">If the restore is part of an incremental or differential restore, the writer will generally want to delay this recovery process until all incremental or differential restores have been completed.</span></span> <span data-ttu-id="064d2-244">[**IVssComponent:: GetAdditionalRestores**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getadditionalrestores) indicará si se trata de la restauración final de este componente o si hay más restauraciones.</span><span class="sxs-lookup"><span data-stu-id="064d2-244">[**IVssComponent::GetAdditionalRestores**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getadditionalrestores) will indicate whether this is the final restore of this component, or whether there are more restores to come.</span></span> <span data-ttu-id="064d2-245">Si **IVssComponent:: GetAdditionalRestores** devuelve **true**, el escritor no debe realizar su procedimiento de recuperación en ese componente.</span><span class="sxs-lookup"><span data-stu-id="064d2-245">If **IVssComponent::GetAdditionalRestores** returns **true**, the writer should not perform its recovery procedure on that component.</span></span>

## <a name="new-targets"></a><span data-ttu-id="064d2-246">Nuevos destinos</span><span class="sxs-lookup"><span data-stu-id="064d2-246">New Targets</span></span>

<span data-ttu-id="064d2-247">Si es compatible con el escritor, el solicitante puede restaurar los archivos de datos en una ubicación distinta de la ubicación de la copia de seguridad original.</span><span class="sxs-lookup"><span data-stu-id="064d2-247">If supported by the writer, the requester can restore data files to a location other than the original backup-time location.</span></span> <span data-ttu-id="064d2-248">Un escritor indica compatibilidad con este modo de restauración al establecer **el \_ escritor de VSS BS admite el \_ \_ \_ nuevo \_** bit de destino en el parámetro *dsSchemaMask* al llamar a [**IVssCreateWriterMetadata:: SetBackupSchema**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setbackupschema).</span><span class="sxs-lookup"><span data-stu-id="064d2-248">A writer indicates support for this restore mode by setting the **VSS\_BS\_WRITER\_SUPPORTS\_NEW\_TARGET** bit in the *dsSchemaMask* parameter when calling [**IVssCreateWriterMetadata::SetBackupSchema**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setbackupschema).</span></span> <span data-ttu-id="064d2-249">Un escritor obtiene las nuevas ubicaciones de los archivos de componentes en el momento de la restauración mediante una llamada a [**IVssComponent:: GetNewTargetCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtargetcount) y [**IVssComponent:: GetNewTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget).</span><span class="sxs-lookup"><span data-stu-id="064d2-249">A writer obtains the new locations for component files at restore time by calling [**IVssComponent::GetNewTargetCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtargetcount) and [**IVssComponent::GetNewTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget).</span></span>

## <a name="directed-targets"></a><span data-ttu-id="064d2-250">Destinos dirigidos</span><span class="sxs-lookup"><span data-stu-id="064d2-250">Directed Targets</span></span>

<span data-ttu-id="064d2-251">En escenarios de restauración complicados, es posible que un escritor desee asignar los intervalos de un archivo de copia de seguridad en distintos intervalos del mismo archivo o de otro diferente.</span><span class="sxs-lookup"><span data-stu-id="064d2-251">For complicated restore scenarios, a writer may want to map ranges of a backed-up file onto different ranges of the same or a different file.</span></span> <span data-ttu-id="064d2-252">Esto puede realizarse mediante el mecanismo de destino dirigido.</span><span class="sxs-lookup"><span data-stu-id="064d2-252">This can be done by using the directed-target mechanism.</span></span> <span data-ttu-id="064d2-253">Para ello, un escritor debe indicar primero que esto está ocurriendo llamando a [**IVssComponent:: SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget), pasando **VSS \_ RT \_ dirigido** al parámetro de *destino* .</span><span class="sxs-lookup"><span data-stu-id="064d2-253">To do this, a writer must first indicate this is happening by calling [**IVssComponent::SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget), passing in **VSS\_RT\_DIRECTED** for the *target* parameter.</span></span> <span data-ttu-id="064d2-254">A continuación, para cada asignación, el escritor llama a [**IVssComponent:: AddDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget).</span><span class="sxs-lookup"><span data-stu-id="064d2-254">Then, for each mapping, the writer calls [**IVssComponent::AddDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget).</span></span> <span data-ttu-id="064d2-255">Este método toma una ruta de acceso completa a un archivo de origen en la copia de seguridad y una ruta de acceso completa a un archivo de destino que se restaurará en.</span><span class="sxs-lookup"><span data-stu-id="064d2-255">This method takes a full path to a source file on the backup and a full path to a destination file that will be restored to.</span></span> <span data-ttu-id="064d2-256">También toma una lista de intervalos para cada uno de estos archivos.</span><span class="sxs-lookup"><span data-stu-id="064d2-256">It also takes a ranges list for each of these files.</span></span> <span data-ttu-id="064d2-257">El escritor llama a estas funciones al controlar el evento prerestore y el solicitante es responsable de restaurar los intervalos especificados en el archivo de código fuente a los intervalos asignados en el archivo de destino.</span><span class="sxs-lookup"><span data-stu-id="064d2-257">The writer calls these functions while handling the PreRestore event, and the requester is then responsible for restoring the specified ranges in the source file to the mapped ranges in the destination file.</span></span> <span data-ttu-id="064d2-258">El formato de la cadena de rangos es el mismo que en [ **IVssComponent:: AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile)</span><span class="sxs-lookup"><span data-stu-id="064d2-258">The format of the ranges string is the same as in [**IVssComponent::AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile)</span></span>

## <a name="private-writer-metadata"></a><span data-ttu-id="064d2-259">Metadatos de escritor privados</span><span class="sxs-lookup"><span data-stu-id="064d2-259">Private Writer Metadata</span></span>

<span data-ttu-id="064d2-260">A menudo resulta útil que un escritor mantenga metadatos privados con una copia de seguridad para realizar correctamente una restauración incremental o diferencial.</span><span class="sxs-lookup"><span data-stu-id="064d2-260">It is often useful for a writer to maintain private metadata with a backup to properly perform an incremental or differential restore.</span></span> <span data-ttu-id="064d2-261">Un escritor puede llamar a [**IVssComponent:: SetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata) mientras controla PrepareForBackup o postsnapshot para almacenar los metadatos.</span><span class="sxs-lookup"><span data-stu-id="064d2-261">A writer may call [**IVssComponent::SetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata) while handling either PrepareForBackup or PostSnapshot to store metadata.</span></span> <span data-ttu-id="064d2-262">El escritor puede tener acceso a estos metadatos durante la restauración o postrestore mediante una llamada a [**IVssComponent:: GetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupmetadata).</span><span class="sxs-lookup"><span data-stu-id="064d2-262">This metadata can be accessed by the writer during either PreRestore or PostRestore by calling [**IVssComponent::GetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupmetadata).</span></span> <span data-ttu-id="064d2-263">Los metadatos también se pueden almacenar con la especificación de archivo parcial mediante el parámetro *wszMetadata* de [**IVssComponent:: AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile); se tiene acceso a estos metadatos a través del parámetro *pbstrMetadata* de [**IVssComponent:: GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span><span class="sxs-lookup"><span data-stu-id="064d2-263">Metadata can also be stored with partial file specification by using the *wszMetadata* parameter of [**IVssComponent::AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile); this metadata is accessed through the *pbstrMetadata* parameter of [**IVssComponent::GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span></span> <span data-ttu-id="064d2-264">El escritor también puede pasar metadatos a sí mismo entre [**CVssWriter:: OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore) y [**CVssWriter:: OnPostRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostrestore).</span><span class="sxs-lookup"><span data-stu-id="064d2-264">The writer can also pass metadata to itself between [**CVssWriter::OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore) and [**CVssWriter::OnPostRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostrestore).</span></span> <span data-ttu-id="064d2-265">En **CVssWriter:: OnPreRestore**, los metadatos se establecen mediante una llamada a [**IVssComponent:: SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata).</span><span class="sxs-lookup"><span data-stu-id="064d2-265">In **CVssWriter::OnPreRestore**, the metadata is set by calling [**IVssComponent::SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata).</span></span> <span data-ttu-id="064d2-266">En **CVssWriter:: OnPostRestore**, los metadatos se recuperan llamando a [**IVssComponent:: GetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoremetadata).</span><span class="sxs-lookup"><span data-stu-id="064d2-266">In **CVssWriter::OnPostRestore**, the metadata is retrieved by calling [**IVssComponent::GetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoremetadata).</span></span>

-   [<span data-ttu-id="064d2-267">Rol de escritor en copias de seguridad incrementales y diferenciales de VSS</span><span class="sxs-lookup"><span data-stu-id="064d2-267">Writer Role in VSS Incremental and Differential Backups</span></span>](writer-role-in-vss-incremental-and-differential-backups.md)
-   [<span data-ttu-id="064d2-268">Rol de solicitante en copias de seguridad incrementales y diferenciales de VSS</span><span class="sxs-lookup"><span data-stu-id="064d2-268">Requester Role in VSS Incremental and Differential Backups</span></span>](requestor-role-in-vss-incremental-and-differential-backups.md)

 

 



