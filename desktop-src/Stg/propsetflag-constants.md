---
title: Constantes PROPSETFLAG (Propidl. h)
description: Definir características de un conjunto de propiedades.
ms.assetid: 6f865c8f-bbca-4122-b076-14f2bc56f292
topic_type:
- apiref
api_name:
- PROPSETFLAG_DEFAULT
- PROPSETFLAG_NONSIMPLE
- PROPSETFLAG_ANSI
- PROPSETFLAG_UNBUFFERED
- PROPSETFLAG_CASE_SENSITIVE
api_location:
- Propidl.h
api_type:
- HeaderDef
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: e8f31d7b2659eeaa003c1a0d15103e94ad1a5c89
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 12/12/2020
ms.locfileid: "103996444"
---
# <a name="propsetflag-constants"></a>Constantes de PROPSETFLAG

Las constantes PROPSETFLAG definen las características de un conjunto de propiedades. Los valores enumerados en la tabla siguiente se usan en el parámetro *grfFlags* de los métodos [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) , la función [**StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) y la función [**StgOpenPropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg) .



| Constante o valor                                                                                                                                                                                                                                               | Descripción                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="PROPSETFLAG_DEFAULT"></span><span id="propsetflag_default"></span><dl> <dt>**PROPSETFLAG \_ Valor predeterminado**</dt> <dt>0</dt> </dl>                       | Si se deja sin especificar, de forma predeterminada solo se pueden escribir valores de propiedad simples en el conjunto de propiedades. El uso de valores de propiedad simples evita que los conjuntos de propiedades se transfieran en el archivo compuesto y las implementaciones independientes de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage). Para este fin, se deben usar valores de propiedad que no sean e.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| <span id="PROPSETFLAG_NONSIMPLE"></span><span id="propsetflag_nonsimple"></span><dl> <dt>**PROPSETFLAG \_ No SIMPLE**</dt> <dt>1</dt> </dl>                 | Si se especifica, los valores de propiedad no simples se pueden escribir en el conjunto de propiedades y el conjunto de propiedades se guarda en un objeto de almacenamiento. Los valores de propiedad no simples incluyen los que tienen un VARTYPE de \_ almacenamiento VT, un \_ flujo VT, un \_ objeto almacenado VT o un \_ \_ objeto VT transmitido \_ . Si no se especifica esta marca, no se pueden escribir tipos no simples en el conjunto de propiedades. En el archivo compuesto y las implementaciones independientes, los conjuntos de propiedades solo se pueden transaccionar si se especifica **PROPSETFLAG \_ nonsimple** .<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span id="PROPSETFLAG_ANSI"></span><span id="propsetflag_ansi"></span><dl> <dt>**PROPSETFLAG \_ ANSI**</dt> <dt>2</dt> </dl>                                | Si se especifica, todos los valores de cadena del conjunto de propiedades que no son explícitamente Unicode, es decir, los que no sean VT \_ LPWStr, se almacenan con la página de códigos ANSI del sistema actual. Para obtener más información, vea [**GetACP**](/windows/desktop/api/winnls/nf-winnls-getacp). No se recomienda el uso de este valor. Para obtener más información, vea la sección Comentarios.<br/> Si este valor está ausente, los valores de cadena del nuevo conjunto de propiedades se almacenan en Unicode. El grado de control que proporciona este valor es necesario para que los clientes que usan las interfaces relacionadas con propiedades puedan interoperar con los conjuntos de propiedades estándar, como la información de Resumen de OLE2, que puede existir en la página de códigos ANSI.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| <span id="PROPSETFLAG_UNBUFFERED"></span><span id="propsetflag_unbuffered"></span><dl> <dt>**PROPSETFLAG \_ No almacenado en búfer**</dt> <dt>4</dt> </dl>              | Solo se usa con las funciones [**StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) y [**StgOpenPropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg) . es decir, en las implementaciones independientes de las interfaces de conjunto de propiedades. Si se especifica en estas funciones, no se almacenan en búfer los cambios realizados en el conjunto de propiedades. En su lugar, los cambios siempre se escriben directamente en el conjunto de propiedades. Las llamadas a los métodos [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) de un conjunto de propiedades lo cambiarán. Sin embargo, de forma predeterminada, los cambios se almacenan en búfer en una memoria caché de conjunto de propiedades interno y posteriormente se escriben en el conjunto de propiedades cuando se llama al método [**IPropertyStorage:: commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) . <br/> Establecer **PROPSETFLAG sin \_ almacenar en búfer** reduce el rendimiento porque el búfer interno del conjunto de propiedades se vacía automáticamente después de cada cambio en el conjunto de propiedades. Sin embargo, la escritura de cambios directamente impedirá problemas de coordinación. Por ejemplo, si el objeto de almacenamiento se abre en modo de transacción y el conjunto de propiedades se almacena en búfer. A continuación, si llama al método [**IStorage:: commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit) en el objeto de almacenamiento, los cambios del conjunto de propiedades no se seleccionarán como parte de la transacción, porque están en un búfer que aún no se ha vaciado. Debe llamar a [**IPropertyStorage:: commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) antes de llamar a **IStorage:: commit** para vaciar el búfer del conjunto de propiedades antes de confirmar los cambios en el almacenamiento. Como alternativa a realizar dos llamadas, puede establecer PROPSETFLAG sin **\_ almacenar en búfer** para que los cambios se escriban siempre directamente en el conjunto de propiedades y nunca se almacenen en búfer en la caché interna del conjunto de propiedades. Después, los cambios se seleccionarán cuando se confirme el almacenamiento de transacciones.<br/> |
| <span id="PROPSETFLAG_CASE_SENSITIVE"></span><span id="propsetflag_case_sensitive"></span><dl> <dt>**PROPSETFLAG \_ \_Distingue mayúsculas de minúsculas**</dt> <dt>8</dt> </dl> | Si se especifica, los nombres de propiedad distinguen mayúsculas de minúsculas. Los nombres de propiedad que distinguen mayúsculas de minúsculas solo son posibles en el formato de serialización del conjunto de propiedades versión 1. Para obtener más información, vea [serialización de conjuntos de propiedades](version-0-vs--version-1-property-set-serialization.md).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |



## <a name="remarks"></a>Observaciones

Estos valores se pueden establecer y comprobar mediante operaciones bit a bit que determinan cómo se crean y se abren los conjuntos de propiedades. Los conjuntos de propiedades se crean mediante el método [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) o la función [**StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) . Se abren con el método [**IPropertySetStorage:: Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) o la función [**StgOpenPropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg) .

Se recomienda crear conjuntos de propiedades como Unicode si no se establece la marca **\_ ANSI PROPSETFLAG** en el parámetro *grfFlags* . También se recomienda evitar el uso de \_ valores de VT LPSTR y usar valores de VT \_ LPWStr en su lugar. Cuando la página de códigos del conjunto de propiedades es Unicode, \_ los valores de cadena de VT LPSTR se convierten a Unicode cuando se almacenan y se convierten de nuevo en valores de cadena multibyte cuando se recuperan. Cuando la página de códigos de la propiedad establecida no es Unicode, los nombres de propiedad, las \_ cadenas VT BSTR y los valores de propiedad no simples se convierten en cadenas multibyte cuando se almacenan y se convierten de nuevo a Unicode cuando se recuperan, todo el uso de la página de códigos ANSI del sistema actual.

## <a name="requirements"></a>Requisitos



| Requisito | Value |
|-------------------------------------|--------------------------------------------------------------------------------------|
| Cliente mínimo compatible<br/> | \[Solo aplicaciones de escritorio\] de Windows 2000 Professional<br/>                           |
| Servidor mínimo compatible<br/> | \[Solo aplicaciones de escritorio\] de Windows 2000 Server<br/>                                 |
| Encabezado<br/>                   | <dl> <dt>Propidl. h</dt> </dl> |



## <a name="see-also"></a>Vea también

<dl> <dt>

[**FmtIdToPropStgName**](/windows/desktop/api/coml2api/nf-coml2api-fmtidtopropstgname)
</dt> <dt>

[**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)
</dt> <dt>

[**IPropertySetStorage:: Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open)
</dt> <dt>

[**PropStgNameToFmtId**](/windows/desktop/api/coml2api/nf-coml2api-propstgnametofmtid)
</dt> <dt>

[**StgCreatePropSetStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropsetstg)
</dt> <dt>

[**StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg)
</dt> <dt>

[**StgOpenPropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg)
</dt> </dl>

 

