---
title: Llamando a SRSetRestorePoint
description: Una aplicación puede crear un punto de restauración antes de que se produzca un cambio significativo en el sistema, como una instalación, desinstalación o actualización de características.
ms.assetid: 77981e75-8c3f-4ecc-82f4-e88d68df661a
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b877c4fe73bcedad363bb4c9cc770a9638550dbd
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/16/2019
ms.locfileid: "103778517"
---
# <a name="calling-srsetrestorepoint"></a><span data-ttu-id="ccd60-103">Llamando a SRSetRestorePoint</span><span class="sxs-lookup"><span data-stu-id="ccd60-103">Calling SRSetRestorePoint</span></span>

<span data-ttu-id="ccd60-104">Una aplicación puede crear un punto de restauración antes de que se produzca un cambio significativo en el sistema, como una instalación, desinstalación o actualización de características.</span><span class="sxs-lookup"><span data-stu-id="ccd60-104">An application can create a restore point before it causes a significant system change, such as an install, uninstall, or feature update.</span></span>

<span data-ttu-id="ccd60-105">Los instaladores deben crear un punto de restauración justo antes de la instalación mediante una llamada a la función [**SRSetRestorePoint**](/windows/desktop/api/SRRestorePtAPI/nf-srrestoreptapi-srsetrestorepointa) con el miembro **dwEventType** de la estructura [**RESTOREPOINTINFO**](/windows/win32/api/srrestoreptapi/ns-srrestoreptapi-restorepointinfoa) establecida para comenzar el \_ cambio del sistema \_ .</span><span class="sxs-lookup"><span data-stu-id="ccd60-105">Installers should create a restore point just prior to installation by calling the [**SRSetRestorePoint**](/windows/desktop/api/SRRestorePtAPI/nf-srrestoreptapi-srsetrestorepointa) function with the **dwEventType** member of the [**RESTOREPOINTINFO**](/windows/win32/api/srrestoreptapi/ns-srrestoreptapi-restorepointinfoa) structure set to BEGIN\_SYSTEM\_CHANGE.</span></span> <span data-ttu-id="ccd60-106">Para notificar a la restauración del sistema que la instalación se ha completado, llame a **SRSetRestorePoint** con **DWEVENTTYPE** establecido en finalizar el \_ cambio del sistema \_ .</span><span class="sxs-lookup"><span data-stu-id="ccd60-106">To notify System Restore that the installation has been completed, call **SRSetRestorePoint** with **dwEventType** set to END\_SYSTEM\_CHANGE.</span></span>

<span data-ttu-id="ccd60-107">Si el usuario cancela la instalación de la aplicación, el instalador puede quitar el punto de restauración que creó cuando comenzó la instalación.</span><span class="sxs-lookup"><span data-stu-id="ccd60-107">If the user cancels the application installation, the installer may remove the restore point it created when the installation began.</span></span> <span data-ttu-id="ccd60-108">Quitar el punto de restauración es opcional y puede impedir que el usuario se recupere de cambios accidentales realizados por el instalador durante la cancelación.</span><span class="sxs-lookup"><span data-stu-id="ccd60-108">Removing the restore point is optional and can prevent the user from recovering from unintentional changes made by the installer during the cancellation.</span></span> <span data-ttu-id="ccd60-109">Si el instalador va a quitar un punto de restauración, puede llamar a la función [**SRRemoveRestorePoint**](/windows/desktop/api/SRRestorePtAPI/nf-srrestoreptapi-srremoverestorepoint) o llamar a [**SRSetRestorePoint**](/windows/desktop/api/SRRestorePtAPI/nf-srrestoreptapi-srsetrestorepointa) con **dwRestorePointType** establecido en operación cancelada \_ , **dwEventType** establecer en end \_ System \_ Change y **LlSequenceNumber** establecido en el valor devuelto por la llamada inicial a **SRSetRestorePoint**.</span><span class="sxs-lookup"><span data-stu-id="ccd60-109">If the installer is to remove a restore point, it can call the [**SRRemoveRestorePoint**](/windows/desktop/api/SRRestorePtAPI/nf-srrestoreptapi-srremoverestorepoint) function, or call [**SRSetRestorePoint**](/windows/desktop/api/SRRestorePtAPI/nf-srrestoreptapi-srsetrestorepointa) with **dwRestorePointType** set to CANCELLED\_OPERATION, **dwEventType** set to END\_SYSTEM\_CHANGE, and **llSequenceNumber** set to the value returned by the initial call to **SRSetRestorePoint**.</span></span>

<span data-ttu-id="ccd60-110">**Windows 8:  **</span><span class="sxs-lookup"><span data-stu-id="ccd60-110">**Windows 8:  **</span></span>

<span data-ttu-id="ccd60-111">Una nueva clave del registro permite a los desarrolladores de aplicaciones cambiar la frecuencia de creación de puntos de restauración.</span><span class="sxs-lookup"><span data-stu-id="ccd60-111">A new registry key enables application developers to change the frequency of restore-point creation.</span></span>

<span data-ttu-id="ccd60-112">Las aplicaciones deben crear esta clave para usarla, ya que no existirá en el sistema.</span><span class="sxs-lookup"><span data-stu-id="ccd60-112">Applications should create this key to use it because it will not preexist in the system.</span></span> <span data-ttu-id="ccd60-113">De forma predeterminada, se aplicará lo siguiente si la clave no existe.</span><span class="sxs-lookup"><span data-stu-id="ccd60-113">The following will apply by default if the key does not exist.</span></span> <span data-ttu-id="ccd60-114">Si una aplicación llama a la función **SRSetRestorePoint** para crear un punto de restauración, Windows omite la creación de este nuevo punto de restauración si se ha creado algún punto de restauración en las últimas 24 horas.</span><span class="sxs-lookup"><span data-stu-id="ccd60-114">If an application calls the **SRSetRestorePoint** function to create a restore point, Windows skips creating this new restore point if any restore points have been created in the last 24 hours.</span></span> <span data-ttu-id="ccd60-115">Restaurar sistema establece el miembro **IISequenceNumber** de la estructura [**STATEMGRSTATUS**](/windows/win32/api/srrestoreptapi/ns-srrestoreptapi-statemgrstatus) en el número de secuencia del punto de restauración creado anteriormente en el día y establece el valor del miembro **nStatus** en **error \_**.</span><span class="sxs-lookup"><span data-stu-id="ccd60-115">System Restore sets the **IISequenceNumber** member of the [**STATEMGRSTATUS**](/windows/win32/api/srrestoreptapi/ns-srrestoreptapi-statemgrstatus) structure to the sequence number for the restore point created previously in the day and sets the value of the **nStatus** member to **ERROR\_SUCCESS**.</span></span> <span data-ttu-id="ccd60-116">La función **SRSetRestorePoint** devuelve **true**.</span><span class="sxs-lookup"><span data-stu-id="ccd60-116">The **SRSetRestorePoint** function returns **TRUE**.</span></span>

<span data-ttu-id="ccd60-117">Los desarrolladores pueden escribir aplicaciones que creen el valor **DWORD** **SystemRestorePointCreationFrequency** en la clave del registro **HKLM \\ software \\ Microsoft \\ Windows NT \\ CurrentVersion \\ SystemRestore**.</span><span class="sxs-lookup"><span data-stu-id="ccd60-117">Developers can write applications that create the **DWORD** value **SystemRestorePointCreationFrequency** under the registry key **HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\SystemRestore**.</span></span> <span data-ttu-id="ccd60-118">El valor de esta clave del registro puede cambiar la frecuencia de creación de puntos de restauración.</span><span class="sxs-lookup"><span data-stu-id="ccd60-118">The value of this registry key can change the frequency of restore point creation.</span></span> <span data-ttu-id="ccd60-119">El valor de esta clave del registro puede cambiar la frecuencia de creación de puntos de restauración.</span><span class="sxs-lookup"><span data-stu-id="ccd60-119">The value of this registry key can change the frequency of restore point creation.</span></span>

<span data-ttu-id="ccd60-120">Si la aplicación llama a **SRSetRestorePoint** para crear un punto de restauración y el valor de la clave del registro es 0, Restaurar sistema no omite la creación del nuevo punto de restauración.</span><span class="sxs-lookup"><span data-stu-id="ccd60-120">If the application calls **SRSetRestorePoint** to create a restore point, and the registry key value is 0, system restore does not skip creating the new restore point.</span></span>

<span data-ttu-id="ccd60-121">Si la aplicación llama a **SRSetRestorePoint** para crear un punto de restauración y el valor de la clave del registro es el entero n, Restaurar sistema omite la creación de un nuevo punto de restauración si se crearon puntos de restauración en los N minutos anteriores.</span><span class="sxs-lookup"><span data-stu-id="ccd60-121">If the application calls **SRSetRestorePoint** to create a restore point, and the registry key value is the integer N, system restore skips creating a new restore point if any restore points were created in the previous N minutes.</span></span>

<span data-ttu-id="ccd60-122">**Windows 8:  **</span><span class="sxs-lookup"><span data-stu-id="ccd60-122">**Windows 8:  **</span></span>

<span data-ttu-id="ccd60-123">La restauración del sistema que se ejecuta en Windows 8 supervisa los archivos del volumen de arranque que solo son relevantes para restaurar el sistema.</span><span class="sxs-lookup"><span data-stu-id="ccd60-123">System Restore running on Windows 8 monitors files in the boot volume that are relevant for system restore only.</span></span> <span data-ttu-id="ccd60-124">Es posible que se eliminen las instantáneas del volumen de arranque creado por la restauración del sistema en Windows 8 Si la instantánea se expone posteriormente en una versión anterior de Windows.</span><span class="sxs-lookup"><span data-stu-id="ccd60-124">Snapshots of the boot volume created by System Restore running on Windows 8 may be deleted if the snapshot is subsequently exposed by an earlier version of Windows.</span></span> <span data-ttu-id="ccd60-125">Tenga en cuenta que, aunque solo hay un volumen del sistema, hay un volumen de arranque para cada sistema operativo en un sistema de arranque múltiple.</span><span class="sxs-lookup"><span data-stu-id="ccd60-125">Note that although there is only one system volume, there is one boot volume for each operating system in a multi-boot system.</span></span>

<span data-ttu-id="ccd60-126">Los desarrolladores pueden escribir aplicaciones que creen el valor **DWORD** **ScopeSnapshots** en la clave del registro **HKLM \\ software \\ Microsoft \\ Windows NT \\ CurrentVersion \\ SystemRestore**.</span><span class="sxs-lookup"><span data-stu-id="ccd60-126">Developers can write applications that create the **DWORD** value **ScopeSnapshots** under the registry key **HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\SystemRestore**.</span></span> <span data-ttu-id="ccd60-127">Si el valor de la clave del registro es 0, Restaurar sistema crea instantáneas del volumen de arranque de la misma manera que en versiones anteriores de Windows.</span><span class="sxs-lookup"><span data-stu-id="ccd60-127">If this registry key value is 0, System Restore creates snapshots of the boot volume in the same way as in earlier versions of Windows.</span></span> <span data-ttu-id="ccd60-128">Si se elimina este valor, la restauración del sistema que se ejecuta en Windows 8 reanuda la creación de instantáneas que supervisen los archivos del volumen de arranque que solo son relevantes para restaurar el sistema.</span><span class="sxs-lookup"><span data-stu-id="ccd60-128">If this value is deleted, System Restore running on Windows 8 resumes creating snapshots that monitor files in the boot volume that are relevant for system restore only.</span></span>

<span data-ttu-id="ccd60-129">Para obtener un ejemplo, vea [usar Restaurar sistema](using-system-restore.md).</span><span class="sxs-lookup"><span data-stu-id="ccd60-129">For an example, see [Using System Restore](using-system-restore.md).</span></span>

 

 




