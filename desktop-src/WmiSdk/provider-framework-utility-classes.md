---
description: Las clases de C++ de WMI que forman parte del marco de trabajo del proveedor de WMI ya no se recomiendan para su uso.
ms.assetid: d2414a72-3435-4035-bcd9-b3ec87f5709c
ms.tgt_platform: multiple
title: Clases de utilidad de Framework de proveedor
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cab09c99fe2597cacd81e55a4ed18bd4e286ff16
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "105707283"
---
# <a name="provider-framework-utility-classes"></a><span data-ttu-id="063d1-103">Clases de utilidad de Framework de proveedor</span><span class="sxs-lookup"><span data-stu-id="063d1-103">Provider Framework Utility Classes</span></span>

<span data-ttu-id="063d1-104">\[Las clases de C++ de WMI que forman parte del marco de trabajo del proveedor de WMI que ahora se consideran en estado final y no estarán disponibles más desarrollo, mejoras o actualizaciones para problemas no relacionados con la seguridad que afecten a estas bibliotecas.</span><span class="sxs-lookup"><span data-stu-id="063d1-104">\[WMI C++ classes that are part of the WMI Provider Framework which is now considered in final state, and no further development, enhancements, or updates will be available for non-security related issues affecting these libraries.</span></span> <span data-ttu-id="063d1-105">Las [API de mi](/previous-versions/windows/desktop/wmi_v2/windows-management-infrastructure) deben usarse para todo el desarrollo nuevo.\]</span><span class="sxs-lookup"><span data-stu-id="063d1-105">The [MI APIs](/previous-versions/windows/desktop/wmi_v2/windows-management-infrastructure) should be used for all new development.\]</span></span>

<span data-ttu-id="063d1-106">Las bibliotecas del marco de trabajo del proveedor Framedyd.dll (versión de depuración) y Framedyn.dll (versión de lanzamiento) implementan varias clases auxiliares de proveedor.</span><span class="sxs-lookup"><span data-stu-id="063d1-106">The provider framework libraries Framedyd.dll (debug version) and Framedyn.dll (release version) implement several provider helper classes.</span></span> <span data-ttu-id="063d1-107">Algunas funciones de Framedyn.dll se han quitado de los archivos de encabezado.</span><span class="sxs-lookup"><span data-stu-id="063d1-107">Some functions in Framedyn.dll have been removed from the header files.</span></span> <span data-ttu-id="063d1-108">Para seguir usando estas funciones, agregue `#define FRAMEWORK_ALLOW_DEPRECATED` al código antes de incluir Fwcommon. h.</span><span class="sxs-lookup"><span data-stu-id="063d1-108">To continue to use these functions, add `#define FRAMEWORK_ALLOW_DEPRECATED` to your code before including Fwcommon.h.</span></span>

<span data-ttu-id="063d1-109">Puede descargar proveedores individuales que ya no son necesarios.</span><span class="sxs-lookup"><span data-stu-id="063d1-109">You can unload individual providers that are no longer required.</span></span>

<span data-ttu-id="063d1-110">Para usar esta funcionalidad, debe realizar los tres cambios siguientes en el proveedor en MainDll. cpp:</span><span class="sxs-lookup"><span data-stu-id="063d1-110">To use this capability, you must make the three following changes to your provider in MainDll.cpp:</span></span>

-   <span data-ttu-id="063d1-111">En la función **DllMain** en la que se llama a [**CWbemProviderGlue:: FrameworkLoginDLL**](/windows/desktop/api/WbemGlue/nf-wbemglue-cwbemproviderglue-frameworklogindll(lpcwstr_plong)), se debe agregar un segundo parámetro que sea un puntero a un Long.</span><span class="sxs-lookup"><span data-stu-id="063d1-111">In the function **DllMain** where you call [**CWbemProviderGlue::FrameworkLoginDLL**](/windows/desktop/api/WbemGlue/nf-wbemglue-cwbemproviderglue-frameworklogindll(lpcwstr_plong)), you must add a second parameter which is a pointer to a long.</span></span>
-   <span data-ttu-id="063d1-112">En la función **DllCanUnloadNow** donde se llama a [**CWbemProviderGlue:: FrameworkLogoffDLL**](/windows/desktop/api/WbemGlue/nf-wbemglue-cwbemproviderglue-frameworklogoffdll(lpcwstr_plong)), debe agregar un segundo parámetro que sea un puntero a un Long.</span><span class="sxs-lookup"><span data-stu-id="063d1-112">In the function **DllCanUnloadNow** where you call [**CWbemProviderGlue::FrameworkLogoffDLL**](/windows/desktop/api/WbemGlue/nf-wbemglue-cwbemproviderglue-frameworklogoffdll(lpcwstr_plong)), you must add a second parameter which is a pointer to a long.</span></span>
-   <span data-ttu-id="063d1-113">En la función **DllGetClassObject** donde cree una instancia de **CWbemGlueFactory**, debe agregar un parámetro que sea un puntero a un Long.</span><span class="sxs-lookup"><span data-stu-id="063d1-113">In the function **DllGetClassObject** where you create an instance of **CWbemGlueFactory**, you must add a parameter which is a pointer to a long.</span></span>

<span data-ttu-id="063d1-114">En los tres casos, el puntero a un Long debe ser el mismo puntero.</span><span class="sxs-lookup"><span data-stu-id="063d1-114">In all three cases, the pointer to a long must be the same pointer.</span></span>

> [!Note]  
> <span data-ttu-id="063d1-115">En las rutinas Maindll. cpp, **DllGetClassObject**, **DllCanUnloadNow**, **DllRegisterServer**, **DllUnregisterServer** y **DllMain** se deben encapsular en un bloque try/catch.</span><span class="sxs-lookup"><span data-stu-id="063d1-115">In Maindll.cpp, **DllGetClassObject**, **DllCanUnloadNow**, **DllRegisterServer**, **DllUnregisterServer** and **DllMain** routines must be wrapped in a try/catch block.</span></span>

 

> [!Caution]  
> <span data-ttu-id="063d1-116">Las compilaciones de depuración del proveedor vinculan con Framedyd. lib para Framedyd.dll.</span><span class="sxs-lookup"><span data-stu-id="063d1-116">Provider debug builds link with Framedyd.lib for Framedyd.dll.</span></span> <span data-ttu-id="063d1-117">Framedyd.dll está en el directorio bin del kit de desarrollo de software (SDK) de Microsoft Windows, \\ que no se incluye en la ruta de acceso del sistema.</span><span class="sxs-lookup"><span data-stu-id="063d1-117">Framedyd.dll is in the Microsoft Windows Software Development Kit (SDK) \\bin directory which is not included in the system path.</span></span> <span data-ttu-id="063d1-118">Cuando se prueba una compilación de depuración de un proveedor con el servicio de administración de Windows, el proveedor de .NET Framework no se cargará porque no se encontrará Framedyd.dll o una de sus dependencias.</span><span class="sxs-lookup"><span data-stu-id="063d1-118">When a debug build of a provider is tested with the Windows Management service, the framework provider will fail to load because Framedyd.dll or one of its dependencies will not be located.</span></span> <span data-ttu-id="063d1-119">Por lo tanto, debe copiar Framedyd.dll del directorio Windows SDK \\ bin en el \\ directorio system32 \\ WBEM o agregar el directorio Windows SDK \\ bin a la ruta de acceso de búsqueda del sistema.</span><span class="sxs-lookup"><span data-stu-id="063d1-119">Therefore, you must either copy Framedyd.dll from the Windows SDK \\bin directory to the \\system32\\wbem directory or add the Windows SDK \\bin directory to the system search path.</span></span>

 

<span data-ttu-id="063d1-120">En la tabla siguiente se enumeran las clases de la utilidad del marco del proveedor.</span><span class="sxs-lookup"><span data-stu-id="063d1-120">The following table lists the provider framework utility classes.</span></span>



| <span data-ttu-id="063d1-121">Clase de utilidad</span><span class="sxs-lookup"><span data-stu-id="063d1-121">Utility class</span></span>                                          | <span data-ttu-id="063d1-122">Descripción</span><span class="sxs-lookup"><span data-stu-id="063d1-122">Description</span></span>                                                                                                                     |
|--------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="063d1-123">**CHString**</span><span class="sxs-lookup"><span data-stu-id="063d1-123">**CHString**</span></span>](chstring.md)                           | <span data-ttu-id="063d1-124">Proporciona funciones de comparación y manipulación de cadenas para WMI.</span><span class="sxs-lookup"><span data-stu-id="063d1-124">Provides string comparison and manipulation functions for WMI.</span></span>                                                                  |
| [<span data-ttu-id="063d1-125">**CHStringArray**</span><span class="sxs-lookup"><span data-stu-id="063d1-125">**CHStringArray**</span></span>](/windows/desktop/api/ChStrArr/nl-chstrarr-chstringarray)                 | <span data-ttu-id="063d1-126">Contiene para crear y manipular matrices de CHString.</span><span class="sxs-lookup"><span data-stu-id="063d1-126">Contains for creating and manipulating arrays of CHString.</span></span>                                                                      |
| [<span data-ttu-id="063d1-127">**TRefPointerCollection**</span><span class="sxs-lookup"><span data-stu-id="063d1-127">**TRefPointerCollection**</span></span>](/windows/desktop/api/RefPtrCo/nl-refptrco-trefpointercollection) | <span data-ttu-id="063d1-128">Concede acceso a una clase contenedora para los punteros.</span><span class="sxs-lookup"><span data-stu-id="063d1-128">Grants access to a container class for pointers.</span></span>                                                                                |
| [<span data-ttu-id="063d1-129">**WBEMTime**</span><span class="sxs-lookup"><span data-stu-id="063d1-129">**WBEMTime**</span></span>](wbemtime.md)                           | <span data-ttu-id="063d1-130">Facilita las conversiones entre varios formatos de tiempo de ejecución de Windows y ANSI C.</span><span class="sxs-lookup"><span data-stu-id="063d1-130">Facilitates conversions between various Windows and ANSI C run-time time formats.</span></span>                                               |
| [<span data-ttu-id="063d1-131">**WBEMTimeSpan**</span><span class="sxs-lookup"><span data-stu-id="063d1-131">**WBEMTimeSpan**</span></span>](/windows/desktop/api/WbemTime/nl-wbemtime-wbemtimespan)                   | <span data-ttu-id="063d1-132">Contiene funciones auxiliares que se usan para calcular y mantener la diferencia de intervalo de tiempo entre dos objetos [**WBEMTime**](wbemtime.md) .</span><span class="sxs-lookup"><span data-stu-id="063d1-132">Contains helper functions used to calculate and hold the time span difference between two [**WBEMTime**](wbemtime.md) objects.</span></span> |



 

> [!Note]  
> <span data-ttu-id="063d1-133">Las clases [**CHString**](chstring.md) y [**CHStringArray**](/windows/desktop/api/ChStrArr/nl-chstrarr-chstringarray) son similares a las Microsoft Foundation Classes (MFC) **CString** y **CStringArray**.</span><span class="sxs-lookup"><span data-stu-id="063d1-133">The [**CHString**](chstring.md) and [**CHStringArray**](/windows/desktop/api/ChStrArr/nl-chstrarr-chstringarray) classes are similar to the Microsoft Foundation Classes (MFC) **CString** and **CStringArray**.</span></span> <span data-ttu-id="063d1-134">Las versiones de WMI existen para que los programadores puedan tener acceso a los métodos de manipulación y comparación de cadenas sin tener que tener acceso a MFC.</span><span class="sxs-lookup"><span data-stu-id="063d1-134">The WMI versions exist so that developers can access to string manipulation and comparison methods without having to access MFC.</span></span> <span data-ttu-id="063d1-135">Las clases [**WBEMTime**](wbemtime.md) y [**WBEMTimeSpan**](/windows/desktop/api/WbemTime/nl-wbemtime-wbemtimespan) también son similares a las clases **ctime** y **CTimeSpan** de MFC.</span><span class="sxs-lookup"><span data-stu-id="063d1-135">The [**WBEMTime**](wbemtime.md) and [**WBEMTimeSpan**](/windows/desktop/api/WbemTime/nl-wbemtime-wbemtimespan) classes are also similar to the MFC **CTime** and **CTimeSpan** classes.</span></span> <span data-ttu-id="063d1-136">Las versiones de WMI son capaces de almacenar el tiempo en la precisión de nanosegundos y también se pueden convertir en **BSTR** y desde este.</span><span class="sxs-lookup"><span data-stu-id="063d1-136">The WMI versions are capable of storing time to nanosecond accuracy, and can also convert to and from **BSTR**.</span></span> <span data-ttu-id="063d1-137">Para obtener más información acerca de las clases CString, CStringArray, CTime y CTimeSpan, vea el [Microsoft Foundation Classes](https://msdn.microsoft.com/library/d06h2x6e(VS.71).aspx) en MSDN.</span><span class="sxs-lookup"><span data-stu-id="063d1-137">For more information about the CString, CStringArray, CTime, and CTimeSpan classes, see the [Microsoft Foundation Classes](https://msdn.microsoft.com/library/d06h2x6e(VS.71).aspx) on MSDN.</span></span>

 

<span data-ttu-id="063d1-138">Los valores **BSTR** devueltos por los métodos [**WBEMTime**](wbemtime.md) están en [formato de fecha y hora](date-and-time-format.md): "aaaammddhhmmss. mmmmmmsUUU"</span><span class="sxs-lookup"><span data-stu-id="063d1-138">**BSTR** values returned by [**WBEMTime**](wbemtime.md) methods are in [Date and Time Format](date-and-time-format.md): "yyyymmddHHMMSS.mmmmmmsUUU"</span></span>

<span data-ttu-id="063d1-139">Los valores **BSTR** devueltos por los métodos [**WBEMTimeSpan**](/windows/desktop/api/WbemTime/nl-wbemtime-wbemtimespan) están en [formato de intervalo](interval-format.md): "ddddddddHHMMSS. mmmmmm: 000"</span><span class="sxs-lookup"><span data-stu-id="063d1-139">**BSTR** values returned by [**WBEMTimeSpan**](/windows/desktop/api/WbemTime/nl-wbemtime-wbemtimespan) methods are in [Interval Format](interval-format.md): "ddddddddHHMMSS.mmmmmm:000"</span></span>

<span data-ttu-id="063d1-140">Aunque las horas y los intervalos de tiempo se almacenan internamente como nanosegundos, no se almacenan necesariamente con una precisión de nanosegundos.</span><span class="sxs-lookup"><span data-stu-id="063d1-140">Although times and time spans are stored internally as nanoseconds, they are not necessarily stored with nanosecond accuracy.</span></span> <span data-ttu-id="063d1-141">Esto se debe a que los objetos [**WBEMTime**](wbemtime.md) se pueden construir con formatos de hora con una precisión de un segundo (**struct TM** y **Time \_ t**).</span><span class="sxs-lookup"><span data-stu-id="063d1-141">This is because [**WBEMTime**](wbemtime.md) objects can be constructed using time formats that are accurate to a second (**struct tm**, and **time\_t**).</span></span> <span data-ttu-id="063d1-142">La adición de posiciones decimales artificiales no aumenta la precisión.</span><span class="sxs-lookup"><span data-stu-id="063d1-142">Adding artificial decimal places does not increase the accuracy.</span></span>

 

 
