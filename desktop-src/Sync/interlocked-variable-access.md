---
description: Las aplicaciones deben sincronizar el acceso a las variables compartidas por varios subprocesos.
ms.assetid: 729c0e68-ef52-4d6c-b771-a89043a937e6
title: Acceso a variables entrelazadas
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ca2e083d3e3420e870ad9781b0d262df3d0786f1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/08/2021
ms.locfileid: "105667977"
---
# <a name="interlocked-variable-access"></a><span data-ttu-id="e0720-103">Acceso a variables entrelazadas</span><span class="sxs-lookup"><span data-stu-id="e0720-103">Interlocked Variable Access</span></span>

<span data-ttu-id="e0720-104">Las aplicaciones deben sincronizar el acceso a las variables compartidas por varios subprocesos.</span><span class="sxs-lookup"><span data-stu-id="e0720-104">Applications must synchronize access to variables that are shared by multiple threads.</span></span> <span data-ttu-id="e0720-105">Las aplicaciones también deben asegurarse de que las operaciones en estas variables se realizan de forma atómica (se realizan en su totalidad o no).</span><span class="sxs-lookup"><span data-stu-id="e0720-105">Applications must also ensure that operations on these variables are performed atomically (performed in their entirety or not at all.)</span></span>

<span data-ttu-id="e0720-106">Las lecturas y escrituras simples en las variables de 32 bits con una alineación correcta son operaciones atómicas.</span><span class="sxs-lookup"><span data-stu-id="e0720-106">Simple reads and writes to properly-aligned 32-bit variables are atomic operations.</span></span> <span data-ttu-id="e0720-107">En otras palabras, no terminará con solo una parte de la variable actualizada; todos los bits se actualizan de forma atómica.</span><span class="sxs-lookup"><span data-stu-id="e0720-107">In other words, you will not end up with only one portion of the variable updated; all bits are updated in an atomic fashion.</span></span> <span data-ttu-id="e0720-108">Sin embargo, no se garantiza que el acceso esté sincronizado.</span><span class="sxs-lookup"><span data-stu-id="e0720-108">However, access is not guaranteed to be synchronized.</span></span> <span data-ttu-id="e0720-109">Si dos subprocesos leen y escriben desde la misma variable, no puede determinar si un subproceso realizará su operación de lectura antes de que el otro realice su operación de escritura.</span><span class="sxs-lookup"><span data-stu-id="e0720-109">If two threads are reading and writing from the same variable, you cannot determine if one thread will perform its read operation before the other performs its write operation.</span></span>

<span data-ttu-id="e0720-110">Las lecturas y escrituras simples en las variables de 64 bits alineadas correctamente son atómicas en Windows de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="e0720-110">Simple reads and writes to properly aligned 64-bit variables are atomic on 64-bit Windows.</span></span> <span data-ttu-id="e0720-111">No se garantiza que las lecturas y escrituras en valores de 64 bits sean atómicas en Windows de 32 bits.</span><span class="sxs-lookup"><span data-stu-id="e0720-111">Reads and writes to 64-bit values are not guaranteed to be atomic on 32-bit Windows.</span></span> <span data-ttu-id="e0720-112">No se garantiza que las lecturas y escrituras en variables de otros tamaños sean atómicas en ninguna plataforma.</span><span class="sxs-lookup"><span data-stu-id="e0720-112">Reads and writes to variables of other sizes are not guaranteed to be atomic on any platform.</span></span>

## <a name="the-interlocked-api"></a><span data-ttu-id="e0720-113">La API entrelazada</span><span class="sxs-lookup"><span data-stu-id="e0720-113">The Interlocked API</span></span>

<span data-ttu-id="e0720-114">Las funciones entrelazadas proporcionan un mecanismo sencillo para sincronizar el acceso a una variable compartida por varios subprocesos.</span><span class="sxs-lookup"><span data-stu-id="e0720-114">The interlocked functions provide a simple mechanism for synchronizing access to a variable that is shared by multiple threads.</span></span> <span data-ttu-id="e0720-115">También realizan operaciones en variables de una manera atómica.</span><span class="sxs-lookup"><span data-stu-id="e0720-115">They also perform operations on variables in an atomic manner.</span></span> <span data-ttu-id="e0720-116">Los subprocesos de diferentes procesos pueden usar estas funciones si la variable está en la memoria compartida.</span><span class="sxs-lookup"><span data-stu-id="e0720-116">The threads of different processes can use these functions if the variable is in shared memory.</span></span>

<span data-ttu-id="e0720-117">Las funciones [**InterlockedIncrement**](/windows/win32/api/winnt/nf-winnt-interlockedincrement) y [**InterlockedDecrement**](/windows/win32/api/winnt/nf-winnt-interlockeddecrement) combinan los pasos necesarios para aumentar o disminuir una variable en una operación atómica.</span><span class="sxs-lookup"><span data-stu-id="e0720-117">The [**InterlockedIncrement**](/windows/win32/api/winnt/nf-winnt-interlockedincrement) and [**InterlockedDecrement**](/windows/win32/api/winnt/nf-winnt-interlockeddecrement) functions combine the steps involved in incrementing or decrementing a variable into an atomic operation.</span></span> <span data-ttu-id="e0720-118">Esta característica es útil en un sistema operativo multitarea, en el que el sistema puede interrumpir la ejecución de un subproceso para conceder un segmento de tiempo de procesador a otro subproceso.</span><span class="sxs-lookup"><span data-stu-id="e0720-118">This feature is useful in a multitasking operating system, in which the system can interrupt one thread's execution to grant a slice of processor time to another thread.</span></span> <span data-ttu-id="e0720-119">Sin esta sincronización, dos subprocesos podrían leer el mismo valor, incrementarlo en 1 y almacenar el nuevo valor para un aumento total de 1 en lugar de 2.</span><span class="sxs-lookup"><span data-stu-id="e0720-119">Without such synchronization, two threads could read the same value, increment it by 1, and store the new value for a total increase of 1 instead of 2.</span></span> <span data-ttu-id="e0720-120">Las funciones de acceso variable entrelazadas protegen frente a este tipo de error.</span><span class="sxs-lookup"><span data-stu-id="e0720-120">The interlocked variable-access functions protect against this kind of error.</span></span>

<span data-ttu-id="e0720-121">Las funciones [**InterlockedExchange**](/windows/win32/api/winnt/nf-winnt-interlockedexchange) y [**InterlockedExchangePointer**](/windows/win32/api/winnt/nf-winnt-interlockedexchangepointer) intercambian atómicamente los valores de las variables especificadas.</span><span class="sxs-lookup"><span data-stu-id="e0720-121">The [**InterlockedExchange**](/windows/win32/api/winnt/nf-winnt-interlockedexchange) and [**InterlockedExchangePointer**](/windows/win32/api/winnt/nf-winnt-interlockedexchangepointer) functions atomically exchange the values of the specified variables.</span></span> <span data-ttu-id="e0720-122">La función [**InterlockedExchangeAdd**](/windows/win32/api/winnt/nf-winnt-interlockedexchangeadd) combina dos operaciones: agregar dos variables juntas y almacenar el resultado en una de las variables.</span><span class="sxs-lookup"><span data-stu-id="e0720-122">The [**InterlockedExchangeAdd**](/windows/win32/api/winnt/nf-winnt-interlockedexchangeadd) function combines two operations: adding two variables together and storing the result in one of the variables.</span></span>

<span data-ttu-id="e0720-123">Las funciones [**InterlockedCompareExchange**](/windows/win32/api/winnt/nf-winnt-interlockedcompareexchange), [**InterlockedCompare64Exchange128**](/previous-versions/windows/desktop/legacy/ms683553(v=vs.85))y [**InterlockedCompareExchangePointer**](/windows/win32/api/winnt/nf-winnt-interlockedcompareexchangepointer) combinan dos operaciones: comparar dos valores y almacenar un tercer valor en una de las variables, en función del resultado de la comparación.</span><span class="sxs-lookup"><span data-stu-id="e0720-123">The [**InterlockedCompareExchange**](/windows/win32/api/winnt/nf-winnt-interlockedcompareexchange), [**InterlockedCompare64Exchange128**](/previous-versions/windows/desktop/legacy/ms683553(v=vs.85)), and [**InterlockedCompareExchangePointer**](/windows/win32/api/winnt/nf-winnt-interlockedcompareexchangepointer) functions combine two operations: comparing two values and storing a third value in one of the variables, based on the outcome of the comparison.</span></span>

<span data-ttu-id="e0720-124">Las [](/windows/win32/api/winnt/nf-winnt-interlockedand)funciones InterlockedAnd [**, interlocker**](/windows/win32/api/winnt/nf-winnt-interlockedor)y [**InterlockedXor**](/windows/win32/api/winnt/nf-winnt-interlockedxor) realizan atómicamente las operaciones and, or y XOR, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="e0720-124">The [**InterlockedAnd**](/windows/win32/api/winnt/nf-winnt-interlockedand), [**InterlockedOr**](/windows/win32/api/winnt/nf-winnt-interlockedor), and [**InterlockedXor**](/windows/win32/api/winnt/nf-winnt-interlockedxor) functions atomically perform AND, OR, and XOR operations, respectively.</span></span>

<span data-ttu-id="e0720-125">Hay funciones que se han diseñado específicamente para realizar el acceso a variables entrelazadas en las direcciones y valores de memoria de 64 bits y se optimizan para su uso en Windows de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="e0720-125">There are functions that are specifically designed to perform interlocked variable access on 64-bit memory values and addresses, and are optimized for use on 64-bit Windows.</span></span> <span data-ttu-id="e0720-126">Cada una de estas funciones contiene "64" en el nombre; por ejemplo, [**InterlockedDecrement64**](/windows/win32/api/winnt/nf-winnt-interlockeddecrement64) y [**InterlockedCompareExchangeAcquire64**](/previous-versions/windows/desktop/legacy/ms683566(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="e0720-126">Each of these functions contains "64" in the name; for example, [**InterlockedDecrement64**](/windows/win32/api/winnt/nf-winnt-interlockeddecrement64) and [**InterlockedCompareExchangeAcquire64**](/previous-versions/windows/desktop/legacy/ms683566(v=vs.85)).</span></span>

<span data-ttu-id="e0720-127">La mayoría de las funciones entrelazadas proporcionan barreras de memoria completas en todas las plataformas de Windows.</span><span class="sxs-lookup"><span data-stu-id="e0720-127">Most of the interlocked functions provide full memory barriers on all Windows platforms.</span></span> <span data-ttu-id="e0720-128">También hay funciones que combinan las operaciones básicas de acceso variable de interbloqueo con la semántica de orden de la memoria de adquisición y liberación que admiten determinados procesadores.</span><span class="sxs-lookup"><span data-stu-id="e0720-128">There are also functions that combine the basic interlocked variable access operations with the acquire and release memory ordering semantics supported by certain processors.</span></span> <span data-ttu-id="e0720-129">Cada una de estas funciones contiene la palabra "adquire" o "release" en sus nombres; por ejemplo, [**InterlockedDecrementAcquire**](/previous-versions/windows/desktop/legacy/ms683583(v=vs.85)) y [**InterlockedDecrementRelease**](/previous-versions/windows/desktop/legacy/ms683586(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="e0720-129">Each of these functions contains the word "Acquire" or "Release" in their names; for example, [**InterlockedDecrementAcquire**](/previous-versions/windows/desktop/legacy/ms683583(v=vs.85)) and [**InterlockedDecrementRelease**](/previous-versions/windows/desktop/legacy/ms683586(v=vs.85)).</span></span> <span data-ttu-id="e0720-130">Adquirir la semántica de memoria especifique que la operación de memoria que realiza el subproceso actual será visible antes de que se intenten otras operaciones de memoria.</span><span class="sxs-lookup"><span data-stu-id="e0720-130">Acquire memory semantics specify that the memory operation being performed by the current thread will be visible before any other memory operations are attempted.</span></span> <span data-ttu-id="e0720-131">La semántica de liberación de memoria especifica que la operación de memoria que realiza el subproceso actual será visible una vez completadas todas las demás operaciones de memoria.</span><span class="sxs-lookup"><span data-stu-id="e0720-131">Release memory semantics specify that the memory operation being performed by the current thread will be visible after all other memory operations have been completed.</span></span> <span data-ttu-id="e0720-132">Esta semántica permite forzar la realización de operaciones de memoria en un orden específico.</span><span class="sxs-lookup"><span data-stu-id="e0720-132">These semantics allow you to force memory operations to be performed in a specific order.</span></span> <span data-ttu-id="e0720-133">Use la semántica de adquisición al entrar en una región protegida y liberar la semántica cuando la deje.</span><span class="sxs-lookup"><span data-stu-id="e0720-133">Use acquire semantics when entering a protected region and release semantics when leaving it.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e0720-134">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="e0720-134">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e0720-135">Intrínsecos del controlador</span><span class="sxs-lookup"><span data-stu-id="e0720-135">Compiler Intrinsics</span></span>](/cpp/intrinsics/compiler-intrinsics?view=vs-2019)
</dt> <dt>

[<span data-ttu-id="e0720-136">Problemas de sincronización y multiprocesador</span><span class="sxs-lookup"><span data-stu-id="e0720-136">Synchronization and Multiprocessor Issues</span></span>](synchronization-and-multiprocessor-issues.md)
</dt> </dl>

 

 
