---
title: Registrar una clase durante la instalación
description: Si una clase está pensada para estar disponible para los clientes en cualquier momento, como la mayoría de las aplicaciones, normalmente la registra a través de un programa de instalación y configuración.
ms.assetid: 6d78c2ce-56d8-4866-9801-35125ec9cac4
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4253c40cb3feb7e737368c947c0b20715f5becbd
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/21/2020
ms.locfileid: "104359446"
---
# <a name="registering-a-class-at-installation"></a><span data-ttu-id="bf9bb-103">Registrar una clase durante la instalación</span><span class="sxs-lookup"><span data-stu-id="bf9bb-103">Registering a Class at Installation</span></span>

<span data-ttu-id="bf9bb-104">Si una clase está pensada para estar disponible para los clientes en cualquier momento, como la mayoría de las aplicaciones, normalmente la registra a través de un programa de instalación y configuración.</span><span class="sxs-lookup"><span data-stu-id="bf9bb-104">If a class is intended to be available to clients at any time, as most applications are, you usually register it through an installation and setup program.</span></span> <span data-ttu-id="bf9bb-105">Esto significa incluir información sobre la aplicación en el registro, lo que incluye cómo y dónde se crearán instancias de sus objetos.</span><span class="sxs-lookup"><span data-stu-id="bf9bb-105">This means putting information about the application into the registry, including how and where its objects are to be instantiated.</span></span> <span data-ttu-id="bf9bb-106">Esta información debe registrarse para todos los CLSID.</span><span class="sxs-lookup"><span data-stu-id="bf9bb-106">This information must be registered for all CLSIDs.</span></span> <span data-ttu-id="bf9bb-107">Otra información es opcional.</span><span class="sxs-lookup"><span data-stu-id="bf9bb-107">Other information is optional.</span></span> <span data-ttu-id="bf9bb-108">Las herramientas como regsvr32 facilitan la escritura de un programa de instalación que registra los servidores durante la instalación.</span><span class="sxs-lookup"><span data-stu-id="bf9bb-108">Tools such as Regsvr32 make it simple to write a setup program that registers servers at installation.</span></span>

<span data-ttu-id="bf9bb-109">Si no se basa en los valores predeterminados del sistema, hay dos claves importantes en el registro: el CLSID y el AppID.</span><span class="sxs-lookup"><span data-stu-id="bf9bb-109">If you are not relying on system defaults, there are two important keys in the registry: the CLSID and the AppID.</span></span> <span data-ttu-id="bf9bb-110">Entre las partes importantes de la información que se encuentran en estas claves, se explica cómo se crea una instancia del objeto.</span><span class="sxs-lookup"><span data-stu-id="bf9bb-110">Among the important pieces of information under these keys is how the object is to be instantiated.</span></span> <span data-ttu-id="bf9bb-111">Los objetos se pueden designar como en proceso, locales fuera de proceso o remotos fuera de proceso.</span><span class="sxs-lookup"><span data-stu-id="bf9bb-111">Objects can be designated as in-process, out-of-process local, or out-of-process remote.</span></span>

<span data-ttu-id="bf9bb-112">En la clave AppID hay varios valores que definen la información específica de esa aplicación.</span><span class="sxs-lookup"><span data-stu-id="bf9bb-112">Under the AppID key are several values that define information specific to that application.</span></span> <span data-ttu-id="bf9bb-113">Entre ellas se encuentran [RemoteServerName](remoteservername.md) y [ActivateAtStorage](activateatstorage.md), que se pueden usar para permitir a un cliente crear un objeto, con el cliente sin conocimiento integrado de la ubicación del servidor.</span><span class="sxs-lookup"><span data-stu-id="bf9bb-113">Among these are [RemoteServerName](remoteservername.md) and [ActivateAtStorage](activateatstorage.md), both of which can be used to permit a client to create an object, with the client having no built-in knowledge of the location of the server.</span></span> <span data-ttu-id="bf9bb-114">(Para obtener más información acerca de la creación de instancias remotas, vea [localizar un objeto remoto](locating-a-remote-object.md) y [funciones auxiliares](instance-creation-helper-functions.md)para la creación de instancias).</span><span class="sxs-lookup"><span data-stu-id="bf9bb-114">(For more information about remote instantiation, see [Locating a Remote Object](locating-a-remote-object.md) and [Instance Creation Helper Functions](instance-creation-helper-functions.md).)</span></span>

<span data-ttu-id="bf9bb-115">Un servidor también se puede instalar como un servicio o para ejecutarse en una cuenta de usuario específica.</span><span class="sxs-lookup"><span data-stu-id="bf9bb-115">A server can also be installed as a service, or to run under a specific user account.</span></span> <span data-ttu-id="bf9bb-116">Para obtener más información, vea [instalar como aplicación de servicio](installing-as-a-service-application.md).</span><span class="sxs-lookup"><span data-stu-id="bf9bb-116">For more information, see [Installing as a Service Application](installing-as-a-service-application.md).</span></span>

<span data-ttu-id="bf9bb-117">Un servidor o un objeto ROT que no sea un servicio o que se ejecute en una cuenta de usuario específica se puede denominar servidor "activar como activador".</span><span class="sxs-lookup"><span data-stu-id="bf9bb-117">A server or ROT object that is not a service or running under a specific user account can be referred to as an "activate as activator" server.</span></span> <span data-ttu-id="bf9bb-118">Para estos servidores, el contexto de seguridad y la estación de ventana/escritorio del cliente deben coincidir con los del servidor.</span><span class="sxs-lookup"><span data-stu-id="bf9bb-118">For these servers, the security context and the window station/desktop of the client must match the server's.</span></span> <span data-ttu-id="bf9bb-119">Un cliente que intenta conectarse a un servidor remoto se considera que tiene un escritorio o estación de ventana **null** , por lo que solo se compara el contexto de seguridad del servidor en esta instancia.</span><span class="sxs-lookup"><span data-stu-id="bf9bb-119">A client attempting to connect to a remote server is considered to have a **NULL** window station/desktop, so only the server security context is compared in this instance.</span></span> <span data-ttu-id="bf9bb-120">(Para obtener más información acerca de los SID, vea [seguridad en com](security-in-com.md)). COM almacena en caché la estación de ventana o el escritorio de un proceso cuando el proceso se conecta por primera vez al servicio COM distribuido.</span><span class="sxs-lookup"><span data-stu-id="bf9bb-120">(For more information about SIDs, see [Security in COM](security-in-com.md).) COM caches the window station/desktop of a process when the process first connects to the distributed COM service.</span></span> <span data-ttu-id="bf9bb-121">Por lo tanto, los clientes y servidores COM no deben cambiar su estación de ventana o escritorios de subprocesos del proceso después de llamar a [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) o [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex).</span><span class="sxs-lookup"><span data-stu-id="bf9bb-121">Therefore, COM clients and servers should not change their window station or thread desktops of the process after calling [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) or [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex).</span></span>

<span data-ttu-id="bf9bb-122">Cuando una clase se registra como in-Process, COM pasa automáticamente una llamada a [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) para crear su objeto de clase a la función [**DllGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-dllgetclassobject) , que la clase debe implementar para dar al objeto que realiza la llamada un puntero a su objeto de clase.</span><span class="sxs-lookup"><span data-stu-id="bf9bb-122">When a class is registered as in-process, a call to [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) to create its class object is automatically passed by COM to the [**DllGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-dllgetclassobject) function, which the class must implement to give the calling object a pointer to its class object.</span></span>

<span data-ttu-id="bf9bb-123">Las clases implementadas en archivos ejecutables pueden especificar que COM debe ejecutar su proceso y esperar a que el proceso registre la interfaz [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) del objeto de clase a través de una llamada a la función [**CoRegisterClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-coregisterclassobject) .</span><span class="sxs-lookup"><span data-stu-id="bf9bb-123">Classes implemented in executables can specify that COM should execute their process and wait for the process to register their class object's [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) interface through a call to the [**CoRegisterClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-coregisterclassobject) function.</span></span>

## <a name="related-topics"></a><span data-ttu-id="bf9bb-124">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="bf9bb-124">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="bf9bb-125">Claves del registro COM</span><span class="sxs-lookup"><span data-stu-id="bf9bb-125">COM Registry Keys</span></span>](com-registry-keys.md)
</dt> <dt>

[<span data-ttu-id="bf9bb-126">Instalar como una aplicación de servicio</span><span class="sxs-lookup"><span data-stu-id="bf9bb-126">Installing as a Service Application</span></span>](installing-as-a-service-application.md)
</dt> <dt>

[<span data-ttu-id="bf9bb-127">Registrar un servidor EXE en ejecución</span><span class="sxs-lookup"><span data-stu-id="bf9bb-127">Registering a Running EXE Server</span></span>](registering-a-running-exe-server.md)
</dt> <dt>

[<span data-ttu-id="bf9bb-128">Registrar componentes</span><span class="sxs-lookup"><span data-stu-id="bf9bb-128">Registering Components</span></span>](registering-components.md)
</dt> <dt>

[<span data-ttu-id="bf9bb-129">Registrar objetos en la tabla ROT</span><span class="sxs-lookup"><span data-stu-id="bf9bb-129">Registering Objects in the ROT</span></span>](registering-objects-in-the-rot.md)
</dt> <dt>

[<span data-ttu-id="bf9bb-130">Registro automático</span><span class="sxs-lookup"><span data-stu-id="bf9bb-130">Self-Registration</span></span>](self-registration.md)
</dt> </dl>

 

 