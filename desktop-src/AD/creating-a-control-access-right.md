---
title: Crear un derecho de acceso a control
description: Para agregar un derecho de acceso de control a un servidor de Active Directory, cree un objeto controlAccessRight en el contenedor Extended-Rights de la partición de configuración.
ms.assetid: dacd42c6-17d9-4dfe-8f51-e4a470766494
ms.tgt_platform: multiple
keywords:
- Creación de un anuncio de derechos de control de acceso
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 11bdc764b09f0fe5bd165e87e23a89db7d368bfe
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/17/2020
ms.locfileid: "103789597"
---
# <a name="creating-a-control-access-right"></a><span data-ttu-id="6eb89-104">Crear un derecho de acceso a control</span><span class="sxs-lookup"><span data-stu-id="6eb89-104">Creating a Control Access Right</span></span>

<span data-ttu-id="6eb89-105">Para agregar un derecho de acceso de control a un servidor de Active Directory, cree un objeto [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) en el contenedor Extended-Rights de la partición de configuración.</span><span class="sxs-lookup"><span data-stu-id="6eb89-105">To add a control access right to an Active Directory server, create a [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) object in the Extended-Rights container of the Configuration partition.</span></span> <span data-ttu-id="6eb89-106">Para obtener más información y un ejemplo de código, vea [ejemplo de código para crear un derecho de acceso de control](example-code-for-creating-a-control-access-right.md).</span><span class="sxs-lookup"><span data-stu-id="6eb89-106">For more information and a code example, see [Example Code for Creating a Control Access Right](example-code-for-creating-a-control-access-right.md).</span></span> <span data-ttu-id="6eb89-107">Para usar el derecho controlar acceso, debe completar algunos pasos más, en función de si el derecho controlar acceso es para una operación especial o para un conjunto de propiedades.</span><span class="sxs-lookup"><span data-stu-id="6eb89-107">To use the control access right, you must complete a few more steps, depending on whether the control access right is for a special operation or a property set.</span></span>

<span data-ttu-id="6eb89-108">Si define un derecho de acceso de control para un conjunto de propiedades, use el **rightsGUID** del objeto [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) para identificar las propiedades del conjunto.</span><span class="sxs-lookup"><span data-stu-id="6eb89-108">If you define a control access right for a property set, use the **rightsGUID** of the [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) object to identify the properties in the set.</span></span> <span data-ttu-id="6eb89-109">Cada propiedad se define mediante un objeto [**attributeSchema**](/windows/desktop/ADSchema/c-attributeschema) en el esquema de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="6eb89-109">Every property is defined by an [**attributeSchema**](/windows/desktop/ADSchema/c-attributeschema) object in the Active Directory schema.</span></span> <span data-ttu-id="6eb89-110">La propiedad [**attributeSecurityGUID**](/windows/desktop/ADSchema/a-attributesecurityguid) de un objeto **attributeSchema** identifica el conjunto de propiedades, si hay alguno, al que pertenece la propiedad.</span><span class="sxs-lookup"><span data-stu-id="6eb89-110">The [**attributeSecurityGUID**](/windows/desktop/ADSchema/a-attributesecurityguid) property of an **attributeSchema** object identifies the property set, if any, that the property belongs to.</span></span> <span data-ttu-id="6eb89-111">Tenga en cuenta que la propiedad **attributeSecurityGUID** tiene un único valor y almacena el GUID en formato binario (sintaxis de cadena de octeto).</span><span class="sxs-lookup"><span data-stu-id="6eb89-111">Be aware that the **attributeSecurityGUID** property is single-valued and stores the GUID in binary format (octet string syntax).</span></span>

<span data-ttu-id="6eb89-112">Si define un derecho de acceso de control para aplicar restricciones en el acceso a una operación determinada, la aplicación debe realizar la comprobación de acceso cuando un usuario intente la operación.</span><span class="sxs-lookup"><span data-stu-id="6eb89-112">If you define a control access right to place restrictions on access to a particular operation, your application must perform the access check when a user attempts the operation.</span></span>

<span data-ttu-id="6eb89-113">**Para configurar la comprobación de acceso**</span><span class="sxs-lookup"><span data-stu-id="6eb89-113">**To set up access check**</span></span>

1.  <span data-ttu-id="6eb89-114">Cree un derecho de acceso de control que defina el tipo de acceso a la aplicación o servicio.</span><span class="sxs-lookup"><span data-stu-id="6eb89-114">Create a control access right that defines the type of access to the application or service.</span></span> <span data-ttu-id="6eb89-115">Para obtener más información, vea el siguiente ejemplo de código.</span><span class="sxs-lookup"><span data-stu-id="6eb89-115">For more information, see the following code example.</span></span>
2.  <span data-ttu-id="6eb89-116">Cree un objeto Active Directory Domain Services que represente la aplicación, el servicio o el recurso que va a proteger.</span><span class="sxs-lookup"><span data-stu-id="6eb89-116">Create an Active Directory Domain Services object that represents the application, service, or resource that you are protecting.</span></span>
3.  <span data-ttu-id="6eb89-117">Agregue ACE de objeto a la DACL en el descriptor de seguridad de objeto para conceder o denegar a los usuarios o grupos el derecho de acceso de control en ese objeto.</span><span class="sxs-lookup"><span data-stu-id="6eb89-117">Add object ACEs to the DACL in the object security descriptor to grant or deny users or groups the control access right on that object.</span></span> <span data-ttu-id="6eb89-118">Para obtener más información, vea [establecer una ACE right de control de acceso en la ACL de un objeto](setting-a-control-access-right-ace-in-an-objectampaposs-acl.md).</span><span class="sxs-lookup"><span data-stu-id="6eb89-118">For more information, see [Setting a Control Access Right ACE in an Object's ACL](setting-a-control-access-right-ace-in-an-objectampaposs-acl.md).</span></span>
4.  <span data-ttu-id="6eb89-119">Cuando un usuario intenta realizar la operación, compruebe los derechos de usuario pasando el descriptor de seguridad del objeto y el token de acceso del usuario a la función [**AccessCheckByTypeResultList**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-accesscheckbytyperesultlist) .</span><span class="sxs-lookup"><span data-stu-id="6eb89-119">When a user attempts to perform the operation, verify the user rights by passing the object security descriptor and the user access token to the [**AccessCheckByTypeResultList**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-accesscheckbytyperesultlist) function.</span></span> <span data-ttu-id="6eb89-120">Para obtener más información, vea [comprobar un derecho de acceso a un control en la ACL de un objeto](checking-a-control-access-right-in-an-objectampaposs-acl.md).</span><span class="sxs-lookup"><span data-stu-id="6eb89-120">For more information, see [Checking a Control Access Right in an Object's ACL](checking-a-control-access-right-in-an-objectampaposs-acl.md).</span></span>

<span data-ttu-id="6eb89-121">Según el resultado de la comprobación de acceso en el objeto, la aplicación o servicio puede permitir o denegar el acceso del usuario a la aplicación o servicio.</span><span class="sxs-lookup"><span data-stu-id="6eb89-121">Based on the result of the access check on the object, the application or service can allow or deny the user access to the application or service.</span></span>

<span data-ttu-id="6eb89-122">Al crear un objeto [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) , establezca los atributos que se enumeran en la tabla siguiente para convertir el objeto en un derecho de acceso de control legal reconocido por Active Directory Domain Services y los sistemas de seguridad de Windows.</span><span class="sxs-lookup"><span data-stu-id="6eb89-122">When you create a [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) object, set the attributes, listed in the following table, to make the object a legal control access right that is recognized by Active Directory Domain Services and the Windows security systems.</span></span>



| <span data-ttu-id="6eb89-123">Atributo</span><span class="sxs-lookup"><span data-stu-id="6eb89-123">Attribute</span></span>                                     | <span data-ttu-id="6eb89-124">Descripción</span><span class="sxs-lookup"><span data-stu-id="6eb89-124">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|-----------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="6eb89-125">**CN**</span><span class="sxs-lookup"><span data-stu-id="6eb89-125">**cn**</span></span>](/windows/desktop/ADSchema/a-cn)                       | <span data-ttu-id="6eb89-126">Propiedad de un solo valor que es el nombre distintivo relativo (RDN) del objeto en el contenedor de Extended-Rights.</span><span class="sxs-lookup"><span data-stu-id="6eb89-126">A single-valued property that is the object's relative distinguished name (RDN) in the Extended-Rights container.</span></span> <span data-ttu-id="6eb89-127">El **CN** es el nombre del derecho de control de acceso en Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="6eb89-127">The **cn** is the name of the access control right in Active Directory Domain Services.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [<span data-ttu-id="6eb89-128">**appliesTo**</span><span class="sxs-lookup"><span data-stu-id="6eb89-128">**appliesTo**</span></span>](/windows/desktop/ADSchema/a-appliesto)         | <span data-ttu-id="6eb89-129">Una propiedad con varios valores que enumera las clases de objetos a las que se aplica el derecho de control de acceso.</span><span class="sxs-lookup"><span data-stu-id="6eb89-129">A multi-valued property that lists the object classes that the access control right applies to.</span></span> <span data-ttu-id="6eb89-130">Por ejemplo, el derecho de control de acceso [**Enviar como**](/windows/desktop/ADSchema/r-send-as) muestra las clases de objetos de [**usuario**](/windows/desktop/ADSchema/c-user) y [**equipo**](/windows/desktop/ADSchema/c-computer) en la propiedad **appliesTo** .</span><span class="sxs-lookup"><span data-stu-id="6eb89-130">For example, the [**Send-As**](/windows/desktop/ADSchema/r-send-as) access control right lists the [**user**](/windows/desktop/ADSchema/c-user) and [**computer**](/windows/desktop/ADSchema/c-computer) object classes in its **appliesTo** property.</span></span> <span data-ttu-id="6eb89-131">En la lista, cada clase de objeto se identifica mediante el [**schemaIDGUID**](/windows/desktop/ADSchema/a-schemaidguid) de su objeto [**ClassSchema**](/windows/desktop/ADSchema/c-classschema) .</span><span class="sxs-lookup"><span data-stu-id="6eb89-131">In the list, each object class is identified by the [**schemaIDGUID**](/windows/desktop/ADSchema/a-schemaidguid) of its [**classSchema**](/windows/desktop/ADSchema/c-classschema) object.</span></span> <span data-ttu-id="6eb89-132">Los GUID se almacenan como cadenas con el formato generado por la función [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) en la biblioteca com, pero sin las llaves de inicio y finalización ({}).</span><span class="sxs-lookup"><span data-stu-id="6eb89-132">The GUIDs are stored as strings of the form produced by the [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) function in the COM library but without the starting and terminating braces ({ }).</span></span> <span data-ttu-id="6eb89-133">Por ejemplo, el siguiente GUID es el **schemaIDGUID** para la clase [**Computer**](/windows/desktop/ADSchema/c-computer) : bf967a86-0de6-11d0-A285-00aa003049e2.</span><span class="sxs-lookup"><span data-stu-id="6eb89-133">For example, the following GUID is the **schemaIDGUID** for the [**computer**](/windows/desktop/ADSchema/c-computer) class: bf967a86-0de6-11d0-a285-00aa003049e2.</span></span><br/> <span data-ttu-id="6eb89-134">Tenga en cuenta que la propiedad [**schemaIDGUID**](/windows/desktop/ADSchema/a-schemaidguid) de un objeto [**ClassSchema**](/windows/desktop/ADSchema/c-classschema) se almacena como un GUID binario mediante la sintaxis de la cadena de octeto.</span><span class="sxs-lookup"><span data-stu-id="6eb89-134">Be aware that the [**schemaIDGUID**](/windows/desktop/ADSchema/a-schemaidguid) property of a [**classSchema**](/windows/desktop/ADSchema/c-classschema) object is stored as a binary GUID using the octet string syntax.</span></span> <span data-ttu-id="6eb89-135">Para convertir este formato de cadena de octeto en el formato de cadena que se usa en la propiedad [**appliesTo**](/windows/desktop/ADSchema/a-appliesto) , utilice la función [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) y quite las llaves de la cadena devuelta.</span><span class="sxs-lookup"><span data-stu-id="6eb89-135">To convert this octet string format to the string format used in the [**appliesTo**](/windows/desktop/ADSchema/a-appliesto) property, use the [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) function and remove the braces from the returned string.</span></span><br/> <span data-ttu-id="6eb89-136">Para obtener más información sobre la propiedad [**schemaIDGUID**](/windows/desktop/ADSchema/a-schemaidguid) de una de las clases de objeto predefinidas, como [**usuario**](/windows/desktop/ADSchema/c-user) o [**equipo**](/windows/desktop/ADSchema/c-computer), consulte la página de referencia de la clase en la referencia de esquema de Active Directory en la [referencia de Active Directory Domain Services](active-directory-domain-services-reference.md).</span><span class="sxs-lookup"><span data-stu-id="6eb89-136">For more information about the [**schemaIDGUID**](/windows/desktop/ADSchema/a-schemaidguid) property of one of the predefined object classes, such as [**user**](/windows/desktop/ADSchema/c-user) or [**computer**](/windows/desktop/ADSchema/c-computer), see the class reference page in the Active Directory Schema Reference in the [Active Directory Domain Services Reference](active-directory-domain-services-reference.md).</span></span> <span data-ttu-id="6eb89-137">Para obtener más información y un ejemplo de código que recupera un **schemaIDGUID** de un objeto ClassSchema, vea [leer objetos attributeSchema y ClassSchema](reading-attributeschema-and-classschema-objects.md).</span><span class="sxs-lookup"><span data-stu-id="6eb89-137">For more information and a code example that retrieves a **schemaIDGUID** from a classSchema object, see [Reading attributeSchema and classSchema Objects](reading-attributeschema-and-classschema-objects.md).</span></span><br/> |
| [<span data-ttu-id="6eb89-138">**Mostrar**</span><span class="sxs-lookup"><span data-stu-id="6eb89-138">**displayName**</span></span>](/windows/desktop/ADSchema/a-displayname)     | <span data-ttu-id="6eb89-139">La cadena usada para mostrar el derecho de control de acceso en las interfaces de usuario, como la página de propiedades **seguridad** y otros lugares del complemento MMC usuarios y equipos Active Directory.</span><span class="sxs-lookup"><span data-stu-id="6eb89-139">The string used to display the access control right in user interfaces such as the **Security** property page and other places in the Active Directory Users and Computers MMC snap-in.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [<span data-ttu-id="6eb89-140">**rightsGuid**</span><span class="sxs-lookup"><span data-stu-id="6eb89-140">**rightsGuid**</span></span>](/windows/desktop/ADSchema/a-rightsguid)       | <span data-ttu-id="6eb89-141">GUID que identifica el derecho de acceso de control en una ACE.</span><span class="sxs-lookup"><span data-stu-id="6eb89-141">A GUID that identifies the control access right in an ACE.</span></span> <span data-ttu-id="6eb89-142">El GUID se almacena como una cadena con el formato generado por la función [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) , pero sin las llaves de inicio y de finalización.</span><span class="sxs-lookup"><span data-stu-id="6eb89-142">The GUID is stored as a string of the form produced by the [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) function, but without the starting and terminating braces.</span></span> <span data-ttu-id="6eb89-143">Use Uuidgen.exe para que otra utilidad genere un GUID para el derecho de acceso de control. Si define un nuevo conjunto de propiedades, use el [**rightsGuid**](/windows/desktop/ADSchema/a-rightsguid) del objeto [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) para identificar las propiedades del conjunto.</span><span class="sxs-lookup"><span data-stu-id="6eb89-143">Use Uuidgen.exe for some other utility to generate a GUID for the control access right.If you define a new property set, you use the [**rightsGuid**](/windows/desktop/ADSchema/a-rightsguid) of the [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) object to identify the properties in the set.</span></span> <span data-ttu-id="6eb89-144">Para cada propiedad del conjunto de propiedades, establezca el valor de [**attributeSecurityGUID**](/windows/desktop/ADSchema/a-attributesecurityguid) de la propiedad en el valor de **rightsGUID** del conjunto de propiedades.</span><span class="sxs-lookup"><span data-stu-id="6eb89-144">For each property in the property set, set the property's [**attributeSecurityGUID**](/windows/desktop/ADSchema/a-attributesecurityguid) value to the value of the property set's **rightsGUID**.</span></span> <span data-ttu-id="6eb89-145">El valor de **attributeSecurityGUID** de una propiedad se almacena en la definición de [**attributeSchema**](/windows/desktop/ADSchema/c-attributeschema) de la propiedad en el esquema de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="6eb89-145">A property's **attributeSecurityGUID** value is stored in the property's [**attributeSchema**](/windows/desktop/ADSchema/c-attributeschema) definition in the Active Directory schema.</span></span> <span data-ttu-id="6eb89-146">La propiedad **attributeSecurityGUID** tiene un único valor y almacena el GUID en formato binario (sintaxis de cadena de octeto).</span><span class="sxs-lookup"><span data-stu-id="6eb89-146">The **attributeSecurityGUID** property is single-valued and stores the GUID in binary format (octet string syntax).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [<span data-ttu-id="6eb89-147">**objectClass**</span><span class="sxs-lookup"><span data-stu-id="6eb89-147">**objectClass**</span></span>](/windows/desktop/ADSchema/a-objectclass)     | <span data-ttu-id="6eb89-148">Este atributo especifica [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) como la clase de objeto.</span><span class="sxs-lookup"><span data-stu-id="6eb89-148">This attribute specifies [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) as the object class.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="6eb89-149">**validAccesses**</span><span class="sxs-lookup"><span data-stu-id="6eb89-149">**validAccesses**</span></span>](/windows/desktop/ADSchema/a-validaccesses) | <span data-ttu-id="6eb89-150">En el caso de los conjuntos de propiedades, establezca este atributo en 0x30 (**ADS \_ right \_ DS \_ Read \_ prop** \| **ADS \_ right \_ DS \_ Write \_ prop**).</span><span class="sxs-lookup"><span data-stu-id="6eb89-150">For property sets, set this attribute to 0x30 (**ADS\_RIGHT\_DS\_READ\_PROP** \| **ADS\_RIGHT\_DS\_WRITE\_PROP**).</span></span> <span data-ttu-id="6eb89-151">En derechos de acceso de control, establezca este atributo en 0x100 (**ad \_ right \_ DS \_ control \_ Access**).</span><span class="sxs-lookup"><span data-stu-id="6eb89-151">For control access rights, set this attribute to 0x100 (**ADS\_RIGHT\_DS\_CONTROL\_ACCESS**).</span></span> <span data-ttu-id="6eb89-152">La página de propiedades seguridad reconoce los derechos de acceso de control solo si el atributo [**validAccesses**](/windows/desktop/ADSchema/a-validaccesses) está establecido en el valor adecuado.</span><span class="sxs-lookup"><span data-stu-id="6eb89-152">The security property page recognizes control access rights only if the [**validAccesses**](/windows/desktop/ADSchema/a-validaccesses) attribute is set to the appropriate value.</span></span> <span data-ttu-id="6eb89-153">Si es cero, el derecho de acceso de control se omite o no se muestra en la página de propiedades de seguridad.</span><span class="sxs-lookup"><span data-stu-id="6eb89-153">If zero, the control access right is ignored or not displayed by the security property page.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |



 

<span data-ttu-id="6eb89-154">Tenga en cuenta que las clases de esquema predefinidas usan el atributo **localizationDisplayId** de un objeto [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) para especificar un identificador de mensaje que se usa para recuperar un nombre para mostrar localizado de Dssec.dll.</span><span class="sxs-lookup"><span data-stu-id="6eb89-154">Be aware that the predefined schema classes use the **localizationDisplayId** attribute of a [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) object to specify a message identifier used to retrieve a localized display name from Dssec.dll.</span></span> <span data-ttu-id="6eb89-155">No establezca el atributo **localizationDisplayId** si define un nuevo objeto **controlAccessRight** .</span><span class="sxs-lookup"><span data-stu-id="6eb89-155">Do not set the **localizationDisplayId** attribute if you define a new **controlAccessRight** object.</span></span>

 

