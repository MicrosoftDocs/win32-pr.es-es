---
description: En COM+, cada objeto COM se crea con un contexto asociado.
ms.assetid: e5602af2-5852-4c34-a792-6742e90b7d41
title: Activación de contexto
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a652615d6c1288887085c857817e32e3a3b4081c
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/07/2021
ms.locfileid: "104153262"
---
# <a name="context-activation"></a><span data-ttu-id="a99a0-103">Activación de contexto</span><span class="sxs-lookup"><span data-stu-id="a99a0-103">Context Activation</span></span>

<span data-ttu-id="a99a0-104">En COM+, cada objeto COM se crea con un contexto asociado.</span><span class="sxs-lookup"><span data-stu-id="a99a0-104">In COM+, every COM object is created with an associated context.</span></span> <span data-ttu-id="a99a0-105">Esto significa que se debe crear e inicializar un nuevo contexto, o usar un contexto existente adecuado.</span><span class="sxs-lookup"><span data-stu-id="a99a0-105">This means that either a new context must be created and initialized or an appropriate existing context is used.</span></span> <span data-ttu-id="a99a0-106">Este proceso se conoce como *activación*.</span><span class="sxs-lookup"><span data-stu-id="a99a0-106">This process is known as *activation*.</span></span> <span data-ttu-id="a99a0-107">En COM+, un objeto se activa en su propio contexto o en el de su creador (un objeto que ha solicitado que se active el objeto, por ejemplo, llamando a [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance)).</span><span class="sxs-lookup"><span data-stu-id="a99a0-107">In COM+, an object is activated either in its own context or in that of its creator (an object that has requested that the object be activated—for example, by calling [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance)).</span></span>

<span data-ttu-id="a99a0-108">En algunas circunstancias, como con la [agrupación de objetos](com--object-pooling.md), un objeto se activa sin crearse desde cero.</span><span class="sxs-lookup"><span data-stu-id="a99a0-108">In some circumstances, such as with [object pooling](com--object-pooling.md), an object is activated without being created from scratch.</span></span> <span data-ttu-id="a99a0-109">En este caso, una instancia en ejecución se activa dentro de un contexto.</span><span class="sxs-lookup"><span data-stu-id="a99a0-109">In this case, a running instance is activated within a context.</span></span> <span data-ttu-id="a99a0-110">A lo largo de su duración, se puede activar repetidamente en contextos diferentes.</span><span class="sxs-lookup"><span data-stu-id="a99a0-110">Over its lifetime, it may be repeatedly activated in different contexts.</span></span>

<span data-ttu-id="a99a0-111">El mecanismo básico es el mismo en cualquier caso: un objeto está asociado a un contexto y ese contexto se inicializa correctamente para representar las necesidades de tiempo de ejecución del objeto.</span><span class="sxs-lookup"><span data-stu-id="a99a0-111">The basic mechanism is the same in either case—an object is associated with a context and that context is properly initialized to represent the run-time needs of the object.</span></span>

## <a name="flowing-of-context-properties"></a><span data-ttu-id="a99a0-112">Flujo de propiedades de contexto</span><span class="sxs-lookup"><span data-stu-id="a99a0-112">Flowing of Context Properties</span></span>

<span data-ttu-id="a99a0-113">Cuando un objeto se activa en respuesta a una solicitud de creación de otro objeto, COM+ debe mediar entre ellos para activar correctamente el objeto de nivel inferior.</span><span class="sxs-lookup"><span data-stu-id="a99a0-113">When an object is being activated in response to a creation request from another object, COM+ needs to mediate between them to properly activate the downstream object.</span></span> <span data-ttu-id="a99a0-114">COM+ tiene que comparar el contexto del llamador con la configuración del componente llamado y, a continuación, decidir dónde activar el componente de nivel inferior y cómo inicializar sus propiedades de contexto.</span><span class="sxs-lookup"><span data-stu-id="a99a0-114">COM+ has to compare the context of the caller with the configuration of the called component and then decide where to activate the downstream component and how to initialize its context properties.</span></span>

<span data-ttu-id="a99a0-115">Para detectar la configuración del componente, COM+ lo busca en la base de datos de registro de clase COM+, que está optimizada para búsquedas de tiempo de ejecución extremadamente rápidas.</span><span class="sxs-lookup"><span data-stu-id="a99a0-115">To discover the component's configuration, COM+ looks it up in the COM+ class registration database, which is optimized for extremely fast run-time lookups.</span></span> <span data-ttu-id="a99a0-116">(Esto viene determinado por el modo en que configuró un componente al instalarlo en una aplicación COM+). A continuación, la configuración del componente se examina con el estado de las propiedades de contexto del llamador.</span><span class="sxs-lookup"><span data-stu-id="a99a0-116">(This is determined by how you configured a component when installing it into a COM+ application.) The component's configuration is then examined against the state of the caller's context properties.</span></span>

<span data-ttu-id="a99a0-117">En algunos casos, la configuración es coherente con el contexto del autor de la llamada y el componente se puede activar en el contexto del llamador.</span><span class="sxs-lookup"><span data-stu-id="a99a0-117">In some cases, the configuration is consistent with the context of the caller and the component can be activated within the caller's context.</span></span> <span data-ttu-id="a99a0-118">Esto solo puede ocurrir si el contexto del autor de la llamada cumple todos los requisitos de tiempo de ejecución del nuevo objeto.</span><span class="sxs-lookup"><span data-stu-id="a99a0-118">This can happen only if the caller's context satisfies all the run-time requirements of the new object.</span></span>

<span data-ttu-id="a99a0-119">Cuando el componente de nivel inferior no se puede activar en el contexto del autor de la llamada, se activa en su propio contexto en un apartamento adecuado.</span><span class="sxs-lookup"><span data-stu-id="a99a0-119">When the downstream component cannot be activated within the caller's context, it is activated in its own context in an appropriate apartment.</span></span> <span data-ttu-id="a99a0-120">Cuando esto ocurre, algunas propiedades de contexto pueden fluir del llamador al destinatario.</span><span class="sxs-lookup"><span data-stu-id="a99a0-120">When this occurs, certain context properties may flow from caller to callee.</span></span> <span data-ttu-id="a99a0-121">Por ejemplo, si el autor de la llamada está asociado a una transacción y el destinatario admite transacciones, el nuevo objeto obtiene su propio contexto (para votar en la transacción, debe tener su propia marca coherente) y hereda el ID. de la transacción del llamador y el ID. de actividad (que residen en la misma transacción y dominio de sincronización).</span><span class="sxs-lookup"><span data-stu-id="a99a0-121">For example, if the caller is associated with a transaction and the callee supports transactions, the new object gets its own context (to vote in the transaction, it needs to have its own consistent flag) and inherits the caller's transaction ID and activity ID (which reside within the same transaction and synchronization domain).</span></span>

## <a name="ignored-context-properties"></a><span data-ttu-id="a99a0-122">Propiedades de contexto omitidas</span><span class="sxs-lookup"><span data-stu-id="a99a0-122">Ignored Context Properties</span></span>

<span data-ttu-id="a99a0-123">Dependiendo de cómo se configure un componente, algunas propiedades de contexto pueden no desempeñar ningún rol para determinar si está activada en el contexto del creador o en su propio contexto.</span><span class="sxs-lookup"><span data-stu-id="a99a0-123">Depending on how a component is configured, some context properties may play no role in determining whether it is activated in the creator's context or its own context.</span></span> <span data-ttu-id="a99a0-124">Por ejemplo, las transacciones deshabilitadas y la sincronización deshabilitada, que indican la presencia de una transacción o un dominio de sincronización, no reproducirán ningún rol en la activación del componente.</span><span class="sxs-lookup"><span data-stu-id="a99a0-124">For example, the Transactions Disabled and Synchronization Disabled settings, indicating the presence of a transaction or a synchronization domain, will play no role whatsoever in the component's activation.</span></span> <span data-ttu-id="a99a0-125">Estas propiedades se omiten fundamentalmente cuando se fluye el contexto.</span><span class="sxs-lookup"><span data-stu-id="a99a0-125">These properties are fundamentally ignored when context is flowed.</span></span> <span data-ttu-id="a99a0-126">O bien, si un componente solo usa la comprobación de acceso de nivel de proceso, se omite su propiedad de contexto de seguridad; la configuración de seguridad del componente nunca reproducirá un rol en su activación.</span><span class="sxs-lookup"><span data-stu-id="a99a0-126">Or if a component uses only process-level access checking, its security context property is ignored—the component's security configuration will never play a role in its activation.</span></span>

## <a name="forcing-activation-in-the-callers-context"></a><span data-ttu-id="a99a0-127">Forzar la activación en el contexto del autor de la llamada</span><span class="sxs-lookup"><span data-stu-id="a99a0-127">Forcing Activation in the Caller's Context</span></span>

<span data-ttu-id="a99a0-128">En algunas circunstancias, es posible que quiera que un objeto se active solo en el contexto del autor de la llamada, es decir, nunca se active en su propio contexto.</span><span class="sxs-lookup"><span data-stu-id="a99a0-128">In some circumstances, you might want an object to be activated only in its caller's context—that is, never activated in its own context.</span></span> <span data-ttu-id="a99a0-129">Por ejemplo, puede que desee controlar el comportamiento del objeto cuando se llama a través de un límite de contexto.</span><span class="sxs-lookup"><span data-stu-id="a99a0-129">For example, you might want to control the object's behavior when it's called across a context boundary.</span></span>

<span data-ttu-id="a99a0-130">Puede asegurarse de que un objeto no se puede activar en su propio contexto seleccionando la opción **debe activarse en el contexto de llamadores** en la pestaña **activación** de la página de **propiedades** del componente, mediante la herramienta administrativa Servicios de componentes.</span><span class="sxs-lookup"><span data-stu-id="a99a0-130">You can ensure that an object cannot be activated in its own context by selecting the **Must be activated in callers context** option on the **Activation** tab of the component **Properties** page, using the Component Services administrative tool.</span></span> <span data-ttu-id="a99a0-131">(Vea [forzar la activación en el contexto del autor de la llamada](enforcing-activation-in-the-caller-s-context.md) para obtener instrucciones paso a paso). Cuando se selecciona esta opción, si el objeto no se puede activar en el contexto del autor de la llamada, se produce un error de [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) y se devuelve el \_ intento de crear un conjunto de \_ \_ \_ \_ clientes fuera del \_ \_ contexto.</span><span class="sxs-lookup"><span data-stu-id="a99a0-131">(See [Enforcing Activation in the Caller's Context](enforcing-activation-in-the-caller-s-context.md) for step-by-step instructions.) When you select this option, if the object cannot be activated in the caller's context, [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) fails, returning CO\_E\_ATTEMPT\_TO\_CREATE\_OUTSIDE\_CLIENT\_CONTEXT.</span></span>

## <a name="default-context"></a><span data-ttu-id="a99a0-132">Contexto predeterminado</span><span class="sxs-lookup"><span data-stu-id="a99a0-132">Default Context</span></span>

<span data-ttu-id="a99a0-133">Existen contextos predeterminados para admitir componentes sin configurar, es decir, componentes COM no instalados en aplicaciones COM+ y no registrados en la base de datos de registro de clases COM+.</span><span class="sxs-lookup"><span data-stu-id="a99a0-133">Default contexts exist to support unconfigured components—that is, COM components not installed in COM+ applications and not registered in the COM+ class registration database.</span></span> <span data-ttu-id="a99a0-134">Si los componentes sin configurar tienen un modelo de subprocesos compatible, se activan en el contexto del autor de la llamada.</span><span class="sxs-lookup"><span data-stu-id="a99a0-134">If unconfigured components have a compatible threading model, they are activated in the caller's context.</span></span> <span data-ttu-id="a99a0-135">De lo contrario, se activan en un contexto predeterminado en el apartamento adecuado.</span><span class="sxs-lookup"><span data-stu-id="a99a0-135">Otherwise, they are activated in a default context in the appropriate apartment.</span></span> <span data-ttu-id="a99a0-136">Cada apartamento tiene un contexto predeterminado para admitir objetos COM que no utilizan servicios COM+.</span><span class="sxs-lookup"><span data-stu-id="a99a0-136">Each apartment has a default context to support COM objects that do not use COM+ services.</span></span>

## <a name="hooking-activation"></a><span data-ttu-id="a99a0-137">Activación de enlace</span><span class="sxs-lookup"><span data-stu-id="a99a0-137">Hooking Activation</span></span>

<span data-ttu-id="a99a0-138">Mediante la implementación de [**IObjectControl:: Activate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) y [**IObjectControl::D eactivate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate), puede enlazar la activación y desactivación juntas para realizar una inicialización especial en el nuevo contexto.</span><span class="sxs-lookup"><span data-stu-id="a99a0-138">By implementing [**IObjectControl::Activate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) and [**IObjectControl::Deactivate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate), you can hook activation and deactivation together to perform special initialization in the new context.</span></span> <span data-ttu-id="a99a0-139">COM+ llama a estos métodos en determinados puntos del ciclo de vida de un objeto, cuando el objeto está configurado para usar la activación JIT o la agrupación de objetos.</span><span class="sxs-lookup"><span data-stu-id="a99a0-139">These methods are called by COM+ at certain points in an object's lifecycle, when the object is configured to use JIT-activation or object pooling.</span></span> <span data-ttu-id="a99a0-140">Consulte [activación Just-in-Time de com+](com--just-in-time-activation.md) y [agrupación de objetos com+](com--object-pooling.md) para obtener más detalles.</span><span class="sxs-lookup"><span data-stu-id="a99a0-140">See [COM+ Just-in-Time Activation](com--just-in-time-activation.md) and [COM+ Object Pooling](com--object-pooling.md) for more detail.</span></span>

## <a name="related-topics"></a><span data-ttu-id="a99a0-141">Temas relacionados</span><span class="sxs-lookup"><span data-stu-id="a99a0-141">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a99a0-142">Interceptación de llamadas entre contextos</span><span class="sxs-lookup"><span data-stu-id="a99a0-142">Interception of Cross-Context Calls</span></span>](interception-of-cross-context-calls.md)
</dt> </dl>

 

 
